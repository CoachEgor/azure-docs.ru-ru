---
title: Планирование общедоступной среды Azure Time Series Insights | Документация Майкрософт
description: Рекомендации по подготовке, настройке и развертыванию общедоступной среды службы "аналитика временных рядов Azure".
services: time-series-insights
ms.service: time-series-insights
author: deepakpalled
ms.author: dpalled
manager: cshankar
ms.devlang: csharp
ms.workload: big-data
ms.topic: conceptual
ms.date: 04/13/2020
ms.custom: seodec18
ms.openlocfilehash: 85910ee5467ecc9f4fe3c1a8bc13110b6f218e5c
ms.sourcegitcommit: 849bb1729b89d075eed579aa36395bf4d29f3bd9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2020
ms.locfileid: "81272718"
---
# <a name="plan-your-azure-time-series-insights-ga-environment"></a>Планирование общедоступной среды службы "аналитика временных рядов Azure"

В этой статье описывается, как спланировать среду общедоступной версии службы "аналитика временных рядов Azure" в зависимости от ожидаемой скорости входящего трафика и требований к хранению данных.

## <a name="video"></a>Видеоролик

**Просмотрите это видео, чтобы узнать больше о хранении данных в службе "аналитика временных рядов Azure" и о том, как спланировать его**.<br /><br />

> [!VIDEO https://www.youtube.com/embed/03x6zKDQ6DU]

## <a name="best-practices"></a>Рекомендации

Чтобы приступить к работе со службой "аналитика временных рядов Azure", лучше всего знать, сколько данных вы планируете отправить в минуту, а также сколько времени нужно хранить данные.  

Дополнительные сведения о емкости и хранении для номеров SKU временных рядов аналитики см. в статье [цены на аналитику временных рядов](https://azure.microsoft.com/pricing/details/time-series-insights/).

Чтобы лучше спланировать среду "аналитика временных рядов" для долгосрочного успеха, рассмотрите следующие атрибуты:

- [Емкость хранилища](#storage-capacity)
- [Срок хранения данных](#data-retention)
- [Объем входящих данных](#ingress-capacity)
- [Формирование событий](#shape-your-events)
- [Обеспечение ссылочных данных на месте](#ensure-that-you-have-reference-data)

## <a name="storage-capacity"></a>Емкость хранилища

По умолчанию Time Series Insights оставляет данные на основе объема создаваемой памяти (единицы &#215; объем хранилища на единицу) и входящего трафика.

## <a name="data-retention"></a>Хранение данных

Параметр **времени хранения данных** можно изменить в среде службы "аналитика временных рядов Azure". Вы можете включить период удержания до 400 дней. 

Служба "аналитика временных рядов Azure" имеет два режима:

* Один режим оптимизирует для наиболее актуальных данных. Она обеспечивает политику для **очистки старых данных** , которые покидает последние данные, доступные в экземпляре. Этот режим включен, по умолчанию. 
* Другой оптимизирует данные, чтобы они оставались ниже настроенных пределов хранения. **Приостановить** входящий трафик предотвращает входящий новых данных, если он выбран в качестве **поведения при превышении лимита хранилища**.

Вы можете настроить хранение и переключение между двумя режимами на странице настройки среды в портал Azure.

> [!IMPORTANT]
> В среде Azure Time Series Insights можно настроить не более 400 дней хранения данных.

### <a name="configure-data-retention"></a>Настройка срока хранения данных

1. Выберите нужную среду Аналитики временных рядов на [портале Azure](https://portal.azure.com).

1. В области **Среда "аналитика временных рядов** " в разделе " **Параметры**" выберите **Конфигурация хранилища**.

1. В поле **время хранения данных (в днях)** введите значение от 1 до 400.

   [![Настройка времени хранения](media/data-retention/configure-data-retention.png)](media/data-retention/configure-data-retention.png#lightbox)

> [!TIP]
> Дополнительные сведения о реализации соответствующей политики хранения данных см. в статье [Настройка хранения](./time-series-insights-how-to-configure-retention.md).

## <a name="ingress-capacity"></a>Объем входящих данных

[!INCLUDE [Azure Time Series Insights GA limits](../../includes/time-series-insights-ga-limits.md)]

### <a name="environment-planning"></a>Планирование среды

Вторая область, в которой основное внимание уделяется планированию среды "аналитика временных рядов", является входной емкостью. Ежедневное хранилище и емкость событий измеряются в минуту в блоках по 1 КБ. Максимально допустимый размер пакета — 32 КБ. Пакеты данных размером более 32 КБ усекаются.

В одной среде допускается до 10 единиц SKU S1 и S2. Невозможно выполнить миграцию из среды S1 в S2. Миграция из среды S2 в S1 невозможна.

Для емкости входящих данных сначала определите общее количество входящих данных, которое требуется для каждого месяца. Затем определите, что требуется в течение минуты. 

Регулирование и задержка играют роль в поминутной мощности. Если у вас есть Пиковая скорость передачи данных, которая длится менее 24 часов, то аналитика временных рядов может "перехватить" по скорости входящего трафика, которая в два раза превышает указанные в предыдущей таблице ставки.

Например, при наличии одного SKU S1 данные повышаются в 720 событий в минуту, а скорость передачи данных составляет менее одного часа с частотой 1 440 событий или меньше, в среде нет заметной задержки. Однако если превышено 1 440 событий в минуту в течение более одного часа, то, скорее всего, будут возникать задержки в данных, отображаемых и доступных для запросов в вашей среде.

Возможно, вы не заранее понимаете объем данных, которые предполагается отправить. В этом случае вы можете найти данные телеметрии для [центра Интернета вещей Azure](../iot-hub/iot-hub-metrics.md) и [концентраторов событий Azure](https://blogs.msdn.microsoft.com/cloud_solution_architect/2016/05/25/using-the-azure-rest-apis-to-retrieve-event-hub-metrics/) в портал Azure подписке. Данные телеметрии помогут вам определить, как подготавливать среду. Используйте панель **метрик** в портал Azure для соответствующего источника событий, чтобы просмотреть его данные телеметрии. Изучив метрики для источника событий вы сможете более эффективно спланировать и подготовить среду Аналитики временных рядов.

### <a name="calculate-ingress-requirements"></a>Расчет требований к объему входящих данных

Чтобы рассчитать требования к входящему каналу:

- Убедитесь, что объем входящих данных превышает среднюю частоту в минуту, и что ваша среда достаточно велика для обработки ожидаемого входящего трафика, который в два раза больше, чем один час.

- При наступлении пиковых нагрузок, которые выполнялись дольше, чем за 1 час, используйте частоту пик в качестве среднего. Подготавливает среду с емкостью, подготовой к пиковому темпу.

### <a name="mitigate-throttling-and-latency"></a>Устранение регулирования и задержек

Сведения о том, как предотвратить регулирование и задержку, см. в статье [снижение задержки и регулирование](time-series-insights-environment-mitigate-latency.md).

## <a name="shape-your-events"></a>Формирование ваших событий

Важно убедиться, что способ отправки событий в "аналитика временных рядов" поддерживает размер создаваемой среды. (И наоборот, вы можете сопоставлять размер среды с количеством событий, прочитанных по времени и размером каждого события.) Также важно подумать об атрибутах, которые вы можете использовать для среза и фильтрации при выполнении запросов к данным.

> [!TIP]
> Ознакомьтесь с документацией по формированию JSON в статье [Отправка событий](time-series-insights-send-events.md).

## <a name="ensure-that-you-have-reference-data"></a>Убедитесь, что у вас есть справочные данные

*Ссылочный набор данных* — это коллекция элементов, которые дополняют события из источника событий. Обработчик входящего трафика "аналитика временных рядов" присоединяет каждое событие из источника событий к соответствующей строке данных в эталонном наборе данных. Дополненное событие затем доступно для запроса. Соединение основано на **первичных ключевых** столбцах, которые определены в эталонном наборе данных.

> [!NOTE]
> Ссылочные данные не присоединены к задним числом. Только текущие и будущие входящие данные сопоставляются и соединяются с эталонным набором данных после его настройки и отправки. Если вы планируете отправлять большие объемы исторических данных в аналитику временных рядов и не будете сначала отправлять или создавать эталонные данные в аналитике временных рядов, может потребоваться повторить вашу работу (указание: неприятности).  

Дополнительные сведения о создании, передаче эталонных данных и управлении ими в службе "аналитика временных рядов" см. в [документации по эталонному набору данных](time-series-insights-add-reference-data-set.md).

[!INCLUDE [business-disaster-recover](../../includes/time-series-insights-business-recovery.md)]

## <a name="next-steps"></a>Дальнейшие шаги

- Начните с создания [новой среды "аналитика временных рядов" в портал Azure](time-series-insights-get-started.md).

- Узнайте, как [Добавить источник событий концентраторов событий](time-series-insights-how-to-add-an-event-source-eventhub.md) в аналитику временных рядов.

- Узнайте, как [настроить источник событий центра Интернета вещей](time-series-insights-how-to-add-an-event-source-iothub.md).
