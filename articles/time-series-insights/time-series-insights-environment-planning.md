---
title: Подготовка к масштабированию среды Аналитики временных рядов Azure | Документация Майкрософт
description: Эта статья описывает, как при планировании среды Аналитики временных рядов Azure учесть все рекомендации в отношении емкости хранилища, хранения данных, объема входящих данных, мониторинга, а также непрерывности бизнес-процессов и аварийного восстановления (BCDR).
services: time-series-insights
ms.service: time-series-insights
author: ashannon7
ms.author: dpalled
manager: cshankar
ms.reviewer: v-mamcge, jasonh, kfile, anshan
ms.devlang: csharp
ms.workload: big-data
ms.topic: conceptual
ms.date: 04/29/2019
ms.custom: seodec18
ms.openlocfilehash: 1c6e8ef9effdb5cf31aee1603de28bed0d894cbb
ms.sourcegitcommit: 509e1583c3a3dde34c8090d2149d255cb92fe991
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/27/2019
ms.locfileid: "66239090"
---
# <a name="plan-your-azure-time-series-insights-ga-environment"></a>Планирование среды времени серии Azure Insights-общедоступной версии

В этой статье описывается планирование среды Azure Time Series Insights общедоступная (GA), на основе скорости передачи ожидаемого объема входящих данных и требуемого срока хранения данных.

## <a name="video"></a>Видео

### <a name="learn-more-about-data-retention-in-azuretime-series-insights-and-how-to-plan-for-itbr"></a>Дополнительные сведения о хранении данных в AzureTime Series Insights, а также планирование для него.</br>

> [!VIDEO https://www.youtube.com/embed/03x6zKDQ6DU]

## <a name="best-practices"></a>Рекомендации

Чтобы приступить к работе с Аналитикой временных рядов, желательно знать ожидаемый объем передаваемых данных в минуту и срок хранения этих данных.  

Дополнительные сведения о емкости и сроках хранения для двух предложений Аналитики временных рядов см. в описании [цен на Аналитику временных рядов](https://azure.microsoft.com/pricing/details/time-series-insights/).

Чтобы планирование привело к долгосрочному успеху, учтите следующие важные характеристики:

- <a href="#understand-storage-capacity">Емкость хранилища</a>
- <a href="#understand-data-retention">Срок хранения данных</a>
- <a href="#understand-ingress-capacity">Объем входящих данных</a>
- <a href="#shape-your-events">Формирование событий</a>
- <a href="#ensure-you-have-reference-data">Обеспечение наличия эталонных данных</a>

## <a name="understand-storage-capacity"></a>Концепция емкости хранилища

По умолчанию аналитика временных рядов Azure сохраняет данные, основанные на объем хранилища, который вы подготовили (единицы времени объем хранилища на единицу) и входящих данных.

## <a name="understand-data-retention"></a>Концепция срока хранения данных

В среде Аналитики временных рядов можно настроить параметр **Время хранения данных** с максимальным значением 400 дней хранения. Аналитика временных рядов поддерживает два режима. В одном из них (который используется по умолчанию) среда обеспечивает наличие самых свежих данных, а во втором — соблюдение требований по срокам хранения. Во втором режиме прием входящих данных приостанавливается, когда достигается предел предоставленной емкости хранилища.  Время хранения и режим работы можно настроить на странице конфигурации среды на портале Azure.

В среде Аналитики временных рядов вы можете указать время хранения не более 400 дней.

### <a name="configure-data-retention"></a>Настройка времени хранения данных

1. Выберите нужную среду Аналитики временных рядов на [портале Azure](https://portal.azure.com).

1. На **странице среды Аналитики временных рядов** в разделе **Параметры** выберите действие **Настройка**.

1. В поле **Время хранения данных (в днях)** введите значение от 1 до 400.

   [![Настройка хранения](media/environment-mitigate-latency/configure-retention.png)](media/environment-mitigate-latency/configure-retention.png#lightbox)

> [!TIP]
> Дополнительные сведения о реализации соответствующую политику хранения данных, просмотрев [как настроить период удержания](./time-series-insights-how-to-configure-retention.md).

## <a name="understand-ingress-capacity"></a>Концепция объема входящих данных

Также при планировании важно учесть объем входящих данных, который вычисляется на основе поминутного распределения.

С точки зрения регулирования входящий пакет данных размером 32 КБ рассматривается как 32 события размером по 1 КБ каждое. Максимальный допустимый размер события составляет 32 КБ. Пакеты данных, размер которых превышает 32 КБ, усекаются.

В следующей таблице указан объем входящих данных для каждого номера SKU.

|SKU  |Количество событий / месяц / единица  |Размер события / месяц / единица  |Количество событий в минуту / единица  | Размер / мин / единица   |
|---------|---------|---------|---------|---------|
|S1     |   30 млн     |  30 ГБ     |  720    |  720 КБ   |
|S2     |   300 млн    |   300 ГБ   | 7200   | 7200 КБ  |

В одной среде допускается до 10 единиц SKU S1 и S2. Миграция среды с SKU S1 на S2 или с SKU S2 на S1 не поддерживается.

Чтобы оценить объем входящих данных, сначала следует вычислить общий объем данных за весь месяц. Далее определите требуемую скорость в минуту, так как задержки и регулирование применяются именно с такими показателями.

Если вплески скорости поступления данных продолжаются не более 24 часов, Аналитика временных рядов позволяет "догнать" такой поток, временно вдвое увеличивая указанную выше скорость входящих данных.

Например, если вы используете один номер SKU S1, а объем входящих данных составляет 720 событий в минуту с отдельными всплесками длительностью 1 час и объемом не более 1440 событий в минуту, то вы не заметите никаких задержек в такой среде. Но если скорость превысит 1440 событий на период более одного часа, вы столкнетесь с задержками в получении данных для визуализации и запросов в такой среде.

Возможно, вы заранее не знаете точный объем передаваемых данных. В этом случае вы можете применить телеметрию данных для [Центра Интернета вещей Azure](https://docs.microsoft.com/azure/iot-hub/iot-hub-metrics) и [Центров событий Azure](https://blogs.msdn.microsoft.com/cloud_solution_architect/2016/05/25/using-the-azure-rest-apis-to-retrieve-event-hub-metrics/) на портале Azure. Данные телеметрии помогут вам определить параметры для подготовки среды. На портале Azure откройте страницу **Метрики** для соответствующего источника, чтобы просмотреть данные телеметрии для него. Изучив метрики для источника событий вы сможете более эффективно спланировать и подготовить среду Аналитики временных рядов.

### <a name="calculate-ingress-requirements"></a>Расчет требований к объему входящих данных

- Убедитесь, что среда имеет объем входящих данных, превышающий вашу среднюю скорость поступления данных, и способна выдержать пиковые значения скорости, вдвое превышающие этот объем на период не более одного часа.

- Если пиковые значения скорости сохраняются на период более одного часа, используйте при расчетах пиковое значение в качестве среднего, чтобы среда имела достаточную производительность для этих пиковых периодов.

### <a name="mitigate-throttling-and-latency"></a>Устранение регулирования и задержек

Сведения о том, как избежать регулирования и задержек в статье о том, как [снижения задержки и регулирования](time-series-insights-environment-mitigate-latency.md).

## <a name="shape-your-events"></a>Формирование ваших событий

Очень важно обеспечить способ отправки событий в TSI поддерживал размер подготавливаемой среды (и наоборот, можно сопоставить размер среды с количеством событий, считываемых TSI и размер каждого события). Также важно думать об атрибутах, по которым необходимо выполнять срез и фильтрацию во время отправки запросов данных.

> [!TIP]
> Просмотрите документацию в формировании JSON [отправки событий](https://docs.microsoft.com/azure/time-series-insights/time-series-insights-send-events).

## <a name="ensure-you-have-reference-data"></a>Убедитесь, что у вас есть эталонные данные

Объект **эталонного набора данных** является коллекцией элементов, которые дополняют события из источника событий. Обработчик входящего трафика аналитики временных рядов соединяет каждое событие из вашего источника событий с соответствующей строкой данных в вашем эталонном наборе данных. Это дополненное событие становится доступным для запроса. Это соединение основано на столбцах первичного ключа, определенных в эталонном наборе данных.

Обратите внимание, что ретроактивное объединение с эталонными данными не поддерживается. Это означает, что сопоставляются и присоединяются к эталонному набору данных после его настройки и загрузки только текущие и будущие входящие данные.  Если вы планируете отправлять большой объем исторических данных в TSI, но не будете сначала создавать или передать эталонные данные в TSI, вам может потребоваться переделывать всю работу (не очень забавно).  

Дополнительные сведения о создании, передаче эталонных данных и управлении ими в TSI см. в [документации по набору эталонных данных](https://docs.microsoft.com/azure/time-series-insights/time-series-insights-add-reference-data-set).

[!INCLUDE [business-disaster-recover](../../includes/time-series-insights-business-recovery.md)]

## <a name="next-steps"></a>Дальнейшие действия

- Начните работу с создания [новой среды Time Series Insights на портале Azure](time-series-insights-get-started.md).

- Узнайте, как [добавить источник событий концентратора событий](time-series-insights-how-to-add-an-event-source-eventhub.md) для Time Series Insights.

- Читать о том, как [настроить источник событий центра Интернета вещей](time-series-insights-how-to-add-an-event-source-iothub.md).
