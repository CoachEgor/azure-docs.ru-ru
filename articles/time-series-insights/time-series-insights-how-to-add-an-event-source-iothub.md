---
title: Как добавить источник событий концентратора IoT - Исследования серии времени Azure Документы Майкрософт
description: Узнайте, как добавить источник событий концентратора IoT в среду Time Series Insights.
ms.service: time-series-insights
services: time-series-insights
author: deepakpalled
ms.author: dpalled
manager: cshankar
ms.reviewer: v-mamcge, jasonh, kfile
ms.workload: big-data
ms.topic: conceptual
ms.date: 04/16/2020
ms.custom: seodec18
ms.openlocfilehash: a0a2f703d9224b8b9dd77c80b2b6a7faee70f5bb
ms.sourcegitcommit: 31ef5e4d21aa889756fa72b857ca173db727f2c3
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/16/2020
ms.locfileid: "81538109"
---
# <a name="add-an-iot-hub-event-source-to-your-time-series-insights-environment"></a>Добавление в среду службы "Аналитика временных рядов Azure" источник событий центра Интернета вещей

Из этой статьи вы узнаете, как с помощью портала Azure добавить в среду службы "Аналитика временных рядов Azure" источник события, который считывает данные из центра Интернета вещей Azure.

> [!NOTE]
> Инструкции в этой статье применяются к средам "Аналитика временных рядов" общедоступной и предварительной версий.

## <a name="prerequisites"></a>Предварительные требования

* Создайте [среду исследования временных серий Azure.](time-series-insights-update-create-environment.md)
* Создайте [центр Интернета вещей с помощью портала Azure](../iot-hub/iot-hub-create-through-portal.md).
* В центр Интернета вещей должны отправляться активные события сообщений.
* Создайте в центре Интернета вещей выделенную группу объектов-получателей, из которой среда службы "Аналитика временных рядов" будет получать информацию. Каждый источник событий Аналитики временных рядов должен иметь собственную выделенную группу объектов-получателей, не используемую другими объектами-получателями. Если несколько читателей потребляют события из одной и той же группы потребителей, все читатели, скорее всего, проявляют сбои. Для получения подробной информации прочитайте [руководство разработчика Azure IoT Hub.](../iot-hub/iot-hub-devguide.md)

### <a name="add-a-consumer-group-to-your-iot-hub"></a>Добавление группы потребителей в Центр Интернета вещей

Группы объектов-получателей используются приложениями для извлечения данных из Центра Интернета вещей Azure. Чтобы надежно считывать данные из концентратора IoT, предоставьте специальную группу потребителей, которая используется только в этой среде Time Series Insights.

Чтобы добавить группу объектов-получателей в центр Интернета вещей:

1. На [портале Azure](https://portal.azure.com)найдите и откройте свой концентратор IoT.

1. В **настройках**выберите **встроенные конечные точки,** а затем выберите конечную точку **событий.**

   [![На странице встроенных конечных точек нажмите кнопку "События"](media/time-series-insights-how-to-add-an-event-source-iothub/tsi-connect-iot-hub.png)](media/time-series-insights-how-to-add-an-event-source-iothub/tsi-connect-iot-hub.png#lightbox)

1. В разделе **Группы потребителей** введите уникальное имя для группы объектов-получателей. Укажите это же имя при создании нового источника событий в среде службы "Аналитика временных рядов".

1. Щелкните **Сохранить**.

## <a name="add-a-new-event-source"></a>Добавление нового источника событий

1. Войдите на [портал Azure](https://portal.azure.com).

1. В меню слева выберите **Все ресурсы**. Выберите среду Time Series Insights.

1. В **настройках**выберите **Источники событий,** а затем выберите **Добавить.**

   [![Выберите источники событий, а затем нажмите кнопку "Добавить"](media/time-series-insights-how-to-add-an-event-source-iothub/tsi-add-event-source.png)](media/time-series-insights-how-to-add-an-event-source-iothub/tsi-add-event-source.png#lightbox)

1. В области **Новый источник событий** в поле **Имя источника событий** введите имя, которое является уникальным для этой среды службы "Аналитика временных рядов". Например, введите **event-stream**.

1. Для **источника** выберите **Центр Интернета вещей**.

1. Выберите значение для параметра **Вариант импорта**:

   * Выберите **Использовать Центр Интернета вещей в доступных подписках**, если в одной из ваших подписок уже есть центр Интернета вещей. Этот вариант — самый простой подход.
   
     [![Выберите параметры в области нового источника событий](media/time-series-insights-how-to-add-an-event-source-iothub/tsi-select-an-import-option.png)](media/time-series-insights-how-to-add-an-event-source-iothub/tsi-select-an-import-option.png#lightbox)

    * В следующей таблице описаны обязательные свойства для варианта **Использовать Центр Интернета вещей в доступных подписках**:

       [![Область нового источника событий — свойства, которые нужно задать при выборе варианта "Использовать Центр Интернета вещей в доступных подписках".](media/time-series-insights-how-to-add-an-event-source-iothub/tsi-create-configure-confirm.png)](media/time-series-insights-how-to-add-an-event-source-iothub/tsi-create-configure-confirm.png#lightbox)

       | Свойство | Описание |
       | --- | --- |
       | Подписка | Подписка, к которой принадлежит желаемый концентратор йот. |
       | IoT hub name (Имя Центра Интернета вещей) | Название выбранного концентратора йота. |
       | IoT hub policy name (Имя политики Центра Интернета вещей) | Выберите политику общего доступа. Вы можете найти политику общего доступа на вкладке настройки концентратора IoT. Каждая общая политика доступа имеет имя, установленные разрешения и ключи доступа. Политика общего доступа для источника событий *должна* иметь разрешения на **подключение службы**. |
       | Ключ политики Центра Интернета вещей | Ключ указывается автоматически. |

    * Выберите **Указать параметры Центра Интернета вещей вручную**, если центр Интернета вещей не входит в вашу подписку или для него нужно указать дополнительные параметры.

      В следующей таблице описаны обязательные свойства при выборе варианта **Указать параметры Центра Интернета вещей вручную**:

       | Свойство | Описание |
       | --- | --- |
       | Идентификатор подписки | Подписка, к которой принадлежит желаемый концентратор йот. |
       | Группа ресурсов | Имя группы ресурсов, в которой создан центр Интернета вещей. |
       | IoT hub name (Имя Центра Интернета вещей) | Имя центра Интернета вещей. При создании центра Интернета вещей вы ввели имя для него. |
       | IoT hub policy name (Имя политики Центра Интернета вещей) | Политика общего доступа. Можно создать политику общего доступа на вкладке концентратора IoT. Каждая общая политика доступа имеет имя, установленные разрешения и ключи доступа. Политика общего доступа для источника событий *должна* иметь разрешения на **подключение службы**. |
       | Ключ политики Центра Интернета вещей | Ключ общего доступа, используемый для аутентификации доступа к пространству имен Служебной шины Azure. Введите первичный или вторичный ключ здесь. |

    * Оба варианта имеют следующие параметры конфигурации:

       | Свойство | Описание |
       | --- | --- |
       | Группа потребителей Центра Интернета вещей | Группа объектов-получателей, которая считывает события из центра Интернета вещей. Мы настоятельно рекомендуем использовать выделенную группу объектов-получателей для источника событий. |
       | Формат сериализации событий | В настоящее время JSON — это единственный доступный формат сериализации. Сообщения событий должны быть в этом формате, иначе данные не удастся прочитать. |
       | Имя свойства для метки времени | Чтобы определить это значение, необходимо иметь представление о формате данных сообщений, отправляемых в центр Интернета вещей. Это значение представляет собой **имя** определенного свойства события в данных сообщения, которое нужно использовать в качестве метки времени для события. Для этого значения учитывается регистр. Если оставить значение пустым, в качестве метки времени события будет использоваться **время постановки события в очередь** в пределах источника событий. |


1. Добавьте имя отдельной группы объектов-получателей службы "Аналитика временных рядов", которое вы добавили в центр Интернета вещей.

1. Нажмите кнопку **создания**.

1. После создания источника событий служба "Аналитика временных рядов" автоматически запустит потоковую передачу данных в среду.

## <a name="next-steps"></a>Следующие шаги

* [Определите политики доступа к данным](time-series-insights-data-access.md), чтобы защитить ваши данные.

* [Отправка событий](time-series-insights-send-events.md) в исходный исход события.

* Получите доступ к своей среде в [обозревателе службы "Аналитика временных рядов"](https://insights.timeseries.azure.com).
