---
title: Как добавить источник событий центра Интернета вещей в службу "Аналитика временных рядов Azure" | Документация Майкрософт
description: Из этой статьи вы узнаете, как добавить в среду службы "Аналитика временных рядов" источник событий, подключенный к центру Интернета вещей.
ms.service: time-series-insights
services: time-series-insights
author: ashannon7
ms.author: anshan
manager: cshankar
ms.reviewer: v-mamcge, jasonh, kfile, anshan
ms.workload: big-data
ms.topic: conceptual
ms.date: 05/01/2019
ms.custom: seodec18
ms.openlocfilehash: 258b603b8cd2e0cdfcc72ca17cd3cb0d034caf5b
ms.sourcegitcommit: f6ba5c5a4b1ec4e35c41a4e799fb669ad5099522
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/06/2019
ms.locfileid: "65143353"
---
# <a name="add-an-iot-hub-event-source-to-your-time-series-insights-environment"></a>Добавление в среду службы "Аналитика временных рядов Azure" источник событий центра Интернета вещей

Из этой статьи вы узнаете, как с помощью портала Azure добавить в среду службы "Аналитика временных рядов Azure" источник события, который считывает данные из центра Интернета вещей Azure.

> [!NOTE]
> Инструкции в этой статье применяются к средам "Аналитика временных рядов" общедоступной и предварительной версий.

## <a name="prerequisites"></a>Технические условия

* Создайте [среду службы "Аналитика временных рядов Azure"](time-series-insights-update-create-environment.md).
* Создайте [центр Интернета вещей с помощью портала Azure](../iot-hub/iot-hub-create-through-portal.md).
* В центр Интернета вещей должны отправляться активные события сообщений.
* Создайте в центре Интернета вещей выделенную группу объектов-получателей, из которой среда службы "Аналитика временных рядов" будет получать информацию. Каждый источник событий Аналитики временных рядов должен иметь собственную выделенную группу объектов-получателей, не используемую другими объектами-получателями. Если несколько модулей чтения используют события из одной группы потребителей, как правило, во всех модулях могут произойти сбои. Дополнительные сведения см. в статье [Руководство разработчика для Центра Интернета вещей Azure](../iot-hub/iot-hub-devguide.md).

### <a name="add-a-consumer-group-to-your-iot-hub"></a>Добавление группы потребителей в Центр Интернета вещей

Группы объектов-получателей используются приложениями для извлечения данных из Центра Интернета вещей Azure. Создайте отдельную группу объектов-получателей, которая будет использоваться только в этой среде службы "Аналитика временных рядов", чтобы обеспечить надежность чтения данных с центром Интернета вещей.

Чтобы добавить группу объектов-получателей в центр Интернета вещей:

1. На портале Azure найдите и откройте центр Интернета вещей.

1. В меню в разделе **Параметры** выберите **Встроенные конечные точки**, а затем выберите конечную точку **События**.

   [![На странице сборки в конечные точки выберите "события"](media/time-series-insights-how-to-add-an-event-source-iothub/iothub_one.png)](media/time-series-insights-how-to-add-an-event-source-iothub/iothub_one.png#lightbox)

1. В разделе **Группы потребителей** введите уникальное имя для группы объектов-получателей. Укажите это же имя при создании нового источника событий в среде службы "Аналитика временных рядов".

1. Щелкните **Сохранить**.

## <a name="add-a-new-event-source"></a>Добавление нового источника событий

1. Войдите на [портале Azure](https://portal.azure.com).

1. В меню слева выберите **Все ресурсы**. Выберите среду Time Series Insights.

1. В разделе **Топология окружения** выберите **Источники событий**, а затем щелкните **Добавить**.

   [![Выберите источники событий, а затем выберите «Добавить»](media/time-series-insights-how-to-add-an-event-source-iothub/iothub_two.png)](media/time-series-insights-how-to-add-an-event-source-iothub/iothub_two.png#lightbox)

1. В области **Новый источник событий** в поле **Имя источника событий** введите имя, которое является уникальным для этой среды службы "Аналитика временных рядов". Например, введите **event-stream**.

1. Для **источника** выберите **Центр Интернета вещей**.

1. Выберите значение для параметра **Вариант импорта**:

   * Выберите **Использовать Центр Интернета вещей в доступных подписках**, если в одной из ваших подписок уже есть центр Интернета вещей. Этот вариант — самый простой подход.
   * Выберите **Указать параметры Центра Интернета вещей вручную**, если центр Интернета вещей не входит в вашу подписку или для него нужно указать дополнительные параметры.

   [![Выберите параметры в области нового источника событий](media/time-series-insights-how-to-add-an-event-source-iothub/iothub_three.png)](media/time-series-insights-how-to-add-an-event-source-iothub/iothub_three.png#lightbox)

1. В следующей таблице описаны обязательные свойства для варианта **Использовать Центр Интернета вещей в доступных подписках**:

   [![Новая область источника событий - свойства для указания в использовать центр Интернета вещей из доступных подписок параметр](media/time-series-insights-how-to-add-an-event-source-iothub/iothub_four.png)](media/time-series-insights-how-to-add-an-event-source-iothub/iothub_four.png#lightbox)

   | Свойство | ОПИСАНИЕ |
   | --- | --- |
   | Идентификатор подписки | Выберите подписку, в которой был создан центр Интернета вещей.
   | IoT hub name (Имя Центра Интернета вещей) | Выберите имя центра Интернета вещей.
   | IoT hub policy name (Имя политики Центра Интернета вещей) | Выберите политику общего доступа. Можно найти политику общего доступа на вкладке параметров центра Интернета вещей. Каждой политике общего доступа присваивается имя, а также для нее задаются разрешения и ключи доступа. Политика общего доступа для источника событий *должна* иметь разрешения на **подключение службы**.
   | Ключ политики Центра Интернета вещей | Ключ указывается автоматически.
   | Группа потребителей Центра Интернета вещей | Группа объектов-получателей, которая считывает события из центра Интернета вещей. Мы настоятельно рекомендуем использовать выделенную группу объектов-получателей для источника событий.
   | Формат сериализации событий | В настоящее время JSON — это единственный доступный формат сериализации. Сообщения событий должны быть в этом формате, иначе данные не удастся прочитать. |
   | Имя свойства для метки времени | Чтобы определить это значение, необходимо иметь представление о формате данных сообщений, отправляемых в центр Интернета вещей. Это значение представляет собой **имя** определенного свойства события в данных сообщения, которое нужно использовать в качестве метки времени для события. Для этого значения учитывается регистр. Если оставить значение пустым, в качестве метки времени события будет использоваться **время постановки события в очередь** в пределах источника событий. |

1. В следующей таблице описаны обязательные свойства при выборе варианта **Указать параметры Центра Интернета вещей вручную**:

   | Свойство | ОПИСАНИЕ |
   | --- | --- |
   | Идентификатор подписки | Подписка, в которой был создан центр Интернета вещей.
   | Группа ресурсов | Имя группы ресурсов, в которой создан центр Интернета вещей.
   | IoT hub name (Имя Центра Интернета вещей) | Имя центра Интернета вещей. При создании центра Интернета вещей вы ввели имя для него.
   | IoT hub policy name (Имя политики Центра Интернета вещей) | Политика общего доступа. Можно создать политику общего доступа на вкладке параметров центра Интернета вещей. Каждой политике общего доступа присваивается имя, а также для нее задаются разрешения и ключи доступа. Политика общего доступа для источника событий *должна* иметь разрешения на **подключение службы**.
   | Ключ политики Центра Интернета вещей | Ключ общего доступа, используемый для аутентификации доступа к пространству имен Служебной шины Azure. Введите первичный или вторичный ключ здесь.
   | Группа потребителей Центра Интернета вещей | Группа объектов-получателей, которая считывает события из центра Интернета вещей. Мы настоятельно рекомендуем использовать выделенную группу объектов-получателей для источника событий.
   | Формат сериализации событий | В настоящее время JSON — это единственный доступный формат сериализации. Сообщения событий должны быть в этом формате, иначе данные не удастся прочитать. |
   | Имя свойства для метки времени | Чтобы определить это значение, необходимо иметь представление о формате данных сообщений, отправляемых в центр Интернета вещей. Это значение представляет собой **имя** определенного свойства события в данных сообщения, которое нужно использовать в качестве метки времени для события. Для этого значения учитывается регистр. Если оставить значение пустым, в качестве метки времени события будет использоваться **время постановки события в очередь** в пределах источника событий. |

1. Добавьте имя отдельной группы объектов-получателей службы "Аналитика временных рядов", которое вы добавили в центр Интернета вещей.

1. Нажмите кнопку **Создать**.

   [![«Создать»](media/time-series-insights-how-to-add-an-event-source-iothub/iothub_five.png)](media/time-series-insights-how-to-add-an-event-source-iothub/iothub_five.png#lightbox)

1. После создания источника событий служба "Аналитика временных рядов" автоматически запустит потоковую передачу данных в среду.

## <a name="next-steps"></a>Дальнейшие действия

* [Определите политики доступа к данным](time-series-insights-data-access.md), чтобы защитить ваши данные.

* [Отправьте события](time-series-insights-send-events.md) в источник событий.

* Получите доступ к своей среде в [обозревателе службы "Аналитика временных рядов"](https://insights.timeseries.azure.com).
