---
title: Как добавить источник событий центра Интернета вещей в службу "аналитика временных рядов Azure" | Документация Майкрософт
description: Узнайте, как добавить источник событий центра Интернета вещей в среду "аналитика временных рядов".
ms.service: time-series-insights
services: time-series-insights
author: deepakpalled
ms.author: dpalled
manager: cshankar
ms.reviewer: v-mamcge, jasonh, kfile
ms.workload: big-data
ms.topic: conceptual
ms.date: 04/16/2020
ms.custom: seodec18
ms.openlocfilehash: a0a2f703d9224b8b9dd77c80b2b6a7faee70f5bb
ms.sourcegitcommit: 877491bd46921c11dd478bd25fc718ceee2dcc08
ms.contentlocale: ru-RU
ms.lasthandoff: 07/02/2020
ms.locfileid: "81538109"
---
# <a name="add-an-iot-hub-event-source-to-your-time-series-insights-environment"></a>Добавление в среду службы "Аналитика временных рядов Azure" источник событий центра Интернета вещей

Из этой статьи вы узнаете, как с помощью портала Azure добавить в среду службы "Аналитика временных рядов Azure" источник события, который считывает данные из центра Интернета вещей Azure.

> [!NOTE]
> Инструкции в этой статье применяются к средам "Аналитика временных рядов" общедоступной и предварительной версий.

## <a name="prerequisites"></a>Предварительные условия

* Создание среды службы " [аналитика временных рядов Azure](time-series-insights-update-create-environment.md)".
* Создайте [центр Интернета вещей с помощью портала Azure](../iot-hub/iot-hub-create-through-portal.md).
* В центр Интернета вещей должны отправляться активные события сообщений.
* Создайте в центре Интернета вещей выделенную группу объектов-получателей, из которой среда службы "Аналитика временных рядов" будет получать информацию. Каждый источник событий Аналитики временных рядов должен иметь собственную выделенную группу объектов-получателей, не используемую другими объектами-получателями. Если несколько модулей чтения используют события из одной группы потребителей, все читатели, скорее всего, будут работать с ошибками. Дополнительные сведения см. в статье [Azure IOT для разработчиков](../iot-hub/iot-hub-devguide.md).

### <a name="add-a-consumer-group-to-your-iot-hub"></a>Добавление группы потребителей в Центр Интернета вещей

Группы объектов-получателей используются приложениями для извлечения данных из Центра Интернета вещей Azure. Чтобы надежно считывать данные из центра Интернета вещей, укажите выделенную группу потребителей, используемую только в этой среде "аналитика временных рядов".

Чтобы добавить группу объектов-получателей в центр Интернета вещей:

1. В [портал Azure](https://portal.azure.com)найдите и откройте центр Интернета вещей.

1. В разделе **Параметры**выберите **встроенные конечные точки**, а затем выберите конечную точку **события** .

   [![На странице встроенных конечных точек нажмите кнопку "События"](media/time-series-insights-how-to-add-an-event-source-iothub/tsi-connect-iot-hub.png)](media/time-series-insights-how-to-add-an-event-source-iothub/tsi-connect-iot-hub.png#lightbox)

1. В разделе **Группы потребителей** введите уникальное имя для группы объектов-получателей. Укажите это же имя при создании нового источника событий в среде службы "Аналитика временных рядов".

1. Нажмите кнопку **Сохранить**.

## <a name="add-a-new-event-source"></a>Добавление нового источника событий

1. Войдите на [портал Azure](https://portal.azure.com).

1. В меню слева выберите **Все ресурсы**. Выберите среду Time Series Insights.

1. В разделе **Параметры**выберите **источники событий**, а затем нажмите кнопку **добавить**.

   [![Выберите источники событий, а затем нажмите кнопку "Добавить"](media/time-series-insights-how-to-add-an-event-source-iothub/tsi-add-event-source.png)](media/time-series-insights-how-to-add-an-event-source-iothub/tsi-add-event-source.png#lightbox)

1. В области **Новый источник событий** в поле **Имя источника событий** введите имя, которое является уникальным для этой среды службы "Аналитика временных рядов". Например, введите **event-stream**.

1. Для **источника** выберите **Центр Интернета вещей**.

1. Выберите значение для параметра **Вариант импорта**:

   * Выберите **Использовать Центр Интернета вещей в доступных подписках**, если в одной из ваших подписок уже есть центр Интернета вещей. Этот вариант — самый простой подход.
   
     [![Выберите параметры в области нового источника событий](media/time-series-insights-how-to-add-an-event-source-iothub/tsi-select-an-import-option.png)](media/time-series-insights-how-to-add-an-event-source-iothub/tsi-select-an-import-option.png#lightbox)

    * В следующей таблице описаны обязательные свойства для варианта **Использовать Центр Интернета вещей в доступных подписках**:

       [![Область нового источника событий — свойства, которые нужно задать при выборе варианта "Использовать Центр Интернета вещей в доступных подписках".](media/time-series-insights-how-to-add-an-event-source-iothub/tsi-create-configure-confirm.png)](media/time-series-insights-how-to-add-an-event-source-iothub/tsi-create-configure-confirm.png#lightbox)

       | Свойство. | Описание |
       | --- | --- |
       | Подписка | Подписка, к которой принадлежит нужный центр Интернета вещей. |
       | IoT hub name (Имя Центра Интернета вещей) | Имя выбранного центра Интернета вещей. |
       | IoT hub policy name (Имя политики Центра Интернета вещей) | Выберите политику общего доступа. Политику общего доступа можно найти на вкладке Параметры центра Интернета вещей. Каждая политика общего доступа имеет имя, разрешения, заданные пользователем, и ключи доступа. Политика общего доступа для источника событий *должна* иметь разрешения на **подключение службы**. |
       | Ключ политики Центра Интернета вещей | Ключ указывается автоматически. |

    * Выберите **Указать параметры Центра Интернета вещей вручную**, если центр Интернета вещей не входит в вашу подписку или для него нужно указать дополнительные параметры.

      В следующей таблице описаны обязательные свойства при выборе варианта **Указать параметры Центра Интернета вещей вручную**:

       | Свойство. | Описание: |
       | --- | --- |
       | Идентификатор подписки | Подписка, к которой принадлежит нужный центр Интернета вещей. |
       | Группа ресурсов | Имя группы ресурсов, в которой создан центр Интернета вещей. |
       | IoT hub name (Имя Центра Интернета вещей) | Имя центра Интернета вещей. При создании центра Интернета вещей вы ввели имя для него. |
       | IoT hub policy name (Имя политики Центра Интернета вещей) | Политика общего доступа. Политику общего доступа можно создать на вкладке Параметры центра Интернета вещей. Каждая политика общего доступа имеет имя, разрешения, заданные пользователем, и ключи доступа. Политика общего доступа для источника событий *должна* иметь разрешения на **подключение службы**. |
       | Ключ политики Центра Интернета вещей | Ключ общего доступа, используемый для аутентификации доступа к пространству имен Служебной шины Azure. Введите первичный или вторичный ключ здесь. |

    * Оба параметра имеют следующие параметры конфигурации:

       | Свойство. | Описание: |
       | --- | --- |
       | Группа потребителей Центра Интернета вещей | Группа объектов-получателей, которая считывает события из центра Интернета вещей. Мы настоятельно рекомендуем использовать выделенную группу объектов-получателей для источника событий. |
       | Формат сериализации событий | В настоящее время JSON — это единственный доступный формат сериализации. Сообщения событий должны быть в этом формате, иначе данные не удастся прочитать. |
       | Имя свойства для метки времени | Чтобы определить это значение, необходимо иметь представление о формате данных сообщений, отправляемых в центр Интернета вещей. Это значение представляет собой **имя** определенного свойства события в данных сообщения, которое нужно использовать в качестве метки времени для события. Для этого значения учитывается регистр. Если оставить значение пустым, в качестве метки времени события будет использоваться **время постановки события в очередь** в пределах источника событий. |


1. Добавьте имя отдельной группы объектов-получателей службы "Аналитика временных рядов", которое вы добавили в центр Интернета вещей.

1. Выберите **Создать**.

1. После создания источника событий служба "Аналитика временных рядов" автоматически запустит потоковую передачу данных в среду.

## <a name="next-steps"></a>Дальнейшие шаги

* [Определите политики доступа к данным](time-series-insights-data-access.md), чтобы защитить ваши данные.

* [Отправка событий](time-series-insights-send-events.md) в источник событий.

* Получите доступ к своей среде в [обозревателе службы "Аналитика временных рядов"](https://insights.timeseries.azure.com).
