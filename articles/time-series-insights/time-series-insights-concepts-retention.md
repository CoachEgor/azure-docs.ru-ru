---
title: Понимание хранения данных в среде - Azure Time Series Insight Документы Майкрософт
description: В этой статье описываются две параметра, которые контролируют хранение данных в среде службы "Аналитика временных рядов Azure".
ms.service: time-series-insights
services: time-series-insights
author: deepakpalled
ms.author: dpalled
manager: cshankar
ms.reviewer: jasonh, kfile
ms.workload: big-data
ms.topic: conceptual
ms.date: 04/14/2020
ms.custom: seodec18
ms.openlocfilehash: fd34595d5ea942602efc920904ff326fc203c088
ms.sourcegitcommit: ea006cd8e62888271b2601d5ed4ec78fb40e8427
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81380687"
---
# <a name="understand-data-retention-in-azure-time-series-insights"></a>Понимание хранения данных в исследованиях временных рядов Azure

В этой статье описаны две основные параметры, влияющие на хранение данных в среде Исследования времени Azure.

## <a name="video"></a>Видеоролик

### <a name="the-following-video-summarizes-time-series-insights-data-retention-and-how-to-plan-for-itbr"></a>В следующем видео кратко излагается время серии Исследования хранения данных и как планировать для него.</br>

> [!VIDEO https://www.youtube.com/embed/03x6zKDQ6DU]

Каждая из ваших сред Исследования времени Azure имеет параметр, который контролирует **время хранения данных.** Это значение охватывает период от 1 до 400 дней. Данные удаляются в зависимости от емкости хранилища среды или продолжительности хранения, в зависимости от того, что наступит равой.

Кроме того, в среде Исследования времени Azure **имеется превышение лимита на поведение.** Он контролирует поведение входа и очистки при максимальной емкости среды. При настройке есть два поведения на выбор:

- **Очистка старых данных** (по умолчанию).  
- **Остановка приема данных**.

> [!NOTE]
> По умолчанию при создании среды для периода удержания настроена **очистка старых данных**. Эта настройка может быть переключена по мере необходимости после создания с помощью портала Azure на странице **Настройка** среды Time Series Insights.
> * Для получения информации о том, как настроить политики удержания, прочитайте [Настройка удержания в Time Series Insights](time-series-insights-how-to-configure-retention.md).

Обе политики хранения данных описаны более подробно ниже.

## <a name="purge-old-data"></a>Очистка старых данных

- **Очистка старых данных** — это параметр по умолчанию для сред Azure Time Series Insights.  
- **Очистка старых данных** предпочтительнее, когда пользователи хотят всегда иметь свои *самые последние данные* в среде Time Series Insights.
- **Очистка старых данных** *настройки очищает* данные, как только ограничения среды (время хранения, размер, или количество, в зависимости от того, приходит первым) достигаются. По умолчанию установлено хранение до 30 дней.
- Самые старые проглоченные данные сначала удалены (подход "Первый в первом выходе").

### <a name="example-one"></a>Пример один

Обратите внимание на пример среды, в которой настроена реакция на событие хранения **Продолжить прием и очищать старые данные**.

**Время хранения данных** установлено на 400 дней. Значение **емкости** равно единице S1, которая содержит 30 ГБ общей емкости. Предположим, что входящие данные накапливаются в среднем до 500 МБ каждый день. Эта среда может сохранять данные только 60 дней, учитывая скорость входящих данных, так как максимальная емкость достигается через 60 дней. Входящие данные накапливаются следующим образом: 500 МБ каждый день x 60 дней = 30 ГБ.

На 61-й день, окружающая среда показывает самые свежие данные, но очищает самые старые данные, старше 60 дней. Очистка позволяет принимать новые потоки данных для изучения. Если пользователь хочет сохранить данные дольше, необходимо увеличить размер среды, добавив дополнительные единицы или отправив меньшее количество данных.  

### <a name="example-two"></a>Пример второй

Обратите внимание на то, что в среде также настроена реакция на событие хранения **Продолжить прием и очищать старые данные**. В этом примере для **времени хранения данных** установлено меньшее значение — 180 дней. Значение **емкости** равно единице S1, которая содержит 30 ГБ общей емкости. Чтобы хранить данные в течение 180 дней, ежедневный прием данных не должен превышать 0,166 ГБ (166 МБ).  

Всякий раз, когда суточная скорость входа в эту среду превышает 0,166 ГБ в день, данные не могут храниться в течение 180 дней, так как некоторые данные продувается. Рассмотрим эту же среду в насыщенный интервал времени. Предположим, что скорость входа в окружающую среду может увеличиться в среднем до 0,189 ГБ в день. В таком интервале времени сохраняются данные за 158 дней (30 ГБ / 0,189 = 158,73 дней хранения). Это меньше желаемого интервала времени хранения данных.

## <a name="pause-ingress"></a>Остановка приема данных

- Настройка **входа в паузу** предназначена для обеспечения того, чтобы данные не удалялись, если пределы размера и подсчета были достигнуты до периода их хранения.  
- **Вход паузы** предоставляет пользователям дополнительное время для увеличения емкости среды до того, как данные будут удалены из-за нарушения периода хранения.
- Это помогает защитить вас от потери данных, но может создать возможность для потери ваших последних данных, если вход приостанавливается после периода хранения источника событий.
- Однако, как только максимальная емкость среды достигнута, среда приостанавливает проникновение данных до тех пор, пока не произойдут следующие дополнительные действия:

   - Вы увеличиваете максимальную емкость среды для добавления большего количества единиц масштаба, как описано в [среде Time Series Insights.](time-series-insights-how-to-scale-your-environment.md)
   - Период хранения данных достигается и данные удаляется, в результате чего окружающая среда ниже максимальной мощности.

### <a name="example-three"></a>Пример третий

Рассмотрим среду с реакцией хранения на событие, настроенную на **остановку приема данных**. В этом примере **срок хранения данных** составляет 60 дней. **Вместимость** установлена на три (3) единицы S1. Предположим, что в эту среду ежедневно поступает 2 ГБ данных. Прием данных приостанавливается после достижения максимальной емкости.

В то время среда показывает тот же набор данных до тех пор, пока не возобновится вход или пока не будет **включена походе** (что позволит очистить старые данные, чтобы освободить место для новых данных).

Когда прием данных возобновляется:

- Данные передаются в том порядке, в котором они были получены источником событий.
- События индексируются на основе метки времени, если политики хранения в источнике событий не превышены. Дополнительные сведения о конфигурации хранения источника событий см. в статье [Часто задаваемые вопросы о Центрах событий](../event-hubs/event-hubs-faq.md)

> [!IMPORTANT]
> Необходимо установить предупреждения во избежание остановки приема данных. Возможна потеря данных, так как для источников событий Azure хранение по умолчанию составляет 1 день. Поэтому как только прием данных приостановится, самые последние данные будут утеряны. Чтобы это не произошло, сделайте следующее. Увеличьте емкость или переключитесь на реакцию на событие **Очистка старых данных**.

Для затронутых концентраторов событий можно настроить свойство **Хранение сообщений**, чтобы минимизировать потерю данных при остановке приема данных в службе "Аналитика временных рядов".

[![Хранение сообщений концентратора событий.](media/time-series-insights-concepts-retention/event-hub-retention.png)](media/time-series-insights-concepts-retention/event-hub-retention.png#lightbox)

Если свойства не настроены на`timeStampPropertyName`источник событий (), Time Series Insights по умолчанию влияет на метку времени прибытия в концентратор события как X-оси. Если `timeStampPropertyName` настроен как что-то другое, среда `timeStampPropertyName` ищет настроенный в пакете данных при разборе событий.

Прочитайте [Как масштабировать среду Time Series Insights](time-series-insights-how-to-scale-your-environment.md) для масштабирования среды для размещения дополнительной емкости или увеличения продолжительности удержания.

## <a name="next-steps"></a>Следующие шаги

- Для получения информации о настройке или изменении параметров хранения данных просмотрите [настройку удержания в Time Series Insights.](time-series-insights-how-to-configure-retention.md)

- Узнайте о задержках в области смягчения последствий [в исследованиях серии времени Azure.](time-series-insights-environment-mitigate-latency.md)
