---
title: Модель временных рядов Azure "аналитика временных рядов" | Документация Майкрософт
description: Сведения о модели временных рядов в предварительной версии службы "аналитика временных рядов Azure".
author: deepakpalled
ms.author: dpalled
manager: cshankar
ms.workload: big-data
ms.service: time-series-insights
services: time-series-insights
ms.topic: conceptual
ms.date: 10/25/2019
ms.custom: seodec18
ms.openlocfilehash: 5c045a4b5ccda47b786d86f1c004e9da4c8d85f3
ms.sourcegitcommit: 598c5a280a002036b1a76aa6712f79d30110b98d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/15/2019
ms.locfileid: "74112296"
---
# <a name="time-series-model-in-azure-time-series-insights-preview"></a>Модель временных рядов в предварительной версии службы "аналитика временных рядов Azure"

В этой статье описывается модель временных рядов, возможности и начало создания и обновления собственных моделей в среде предварительной версии службы "аналитика временных рядов Azure".

> [!TIP]
>  * Перейдите к [демонстрационной среде фермы "Ветер Contoso](https://insights.timeseries.azure.com/preview/samples) " для примера модели рабочего ряда в реальном времени.
> * Дополнительные сведения о навигации по пользовательскому интерфейсу модели временных рядов см. в статье Обзор [обозревателя "аналитика временных рядов Azure](time-series-insights-update-explorer.md) ".

## <a name="summary"></a>summary

В большинстве случаев данные, собираемые с устройств Интернета вещей, не содержат контекстных сведений, что усложняет поиск и не позволяет быстро анализировать датчики. Основной мотивацией модели временных рядов является упрощение поиска и анализа данных из Интернета вещей или временных рядов. Эта цель достигается за счет включения контроль, обслуживания и обогащения данных временных рядов, чтобы помочь подготовить готовые к отправке наборам данные для анализа.

## <a name="scenario-contosos-new-smart-oven"></a>Сценарий: Новая смарт-печь компании Contoso

**Рассмотрим вымышленный сценарий использования компании Contoso Smart печь.** В этом сценарии предположим, что каждая Интеллектуальная микросхема Contoso имеет пять датчиков температуры, по одному для каждого из четырех ведущих единиц записи и один для самой печь. До последнего времени каждый датчик температуры Contoso отправил, хранит и наглядно выдает данные по отдельности. Для наблюдения за устройством кухни компания Contoso основывалась на базовых диаграммах, по одной на каждый отдельный датчик.

Хотя компания Contoso была удовлетворена первоначальным решением для работы с данными и визуализацией, некоторые ограничения стали очевидными:

* Клиенты хотят узнать, насколько горячий в целом печь, когда в большинстве случаев будут включены самые популярные устройства. Компания Contoso имела больше сложностей при анализе и представлении единого ответа о условиях общей печь.
* Инженеры компании Contoso хотят убедиться, что самые популярные запущенные службы запускаются одновременно, не приведут к неэффективному отображению энергии. Возникли трудности с перекрестным связыванием, какие датчики температуры и напряжения связаны друг с другом и как их можно разместить в хранилище.
* Группа специалистов по контролю качества Contoso хотела проводить аудит и сравнение истории между двумя версиями датчика. Возникли трудности при определении того, какие данные принадлежали к версии датчика.

Без возможности структурировать, упорядочивать и определять модель временных рядов «Smart печь», каждый датчик температуры поддерживает ненайденные, изолированные и менее информативные точки данных. Включение этих точек данных в ценную аналитику было сложнее, так как каждый набор данных был создан независимо от других.

Эти ограничения выявили важность средств агрегирования и визуализации интеллектуальных данных, сопровождающих новую печь компании Contoso:

* Визуализация данных оказывается полезной, если вы можете связать и объединить данные в удобном для просмотра виде. Примером является отображение датчиков напряжения и датчиков температуры.
* Управление многомерными данными для нескольких сущностей вместе с функциями сравнения, масштабирования и временных диапазонов может быть трудно выполнить.

**Модель временных рядов предоставляет удобное решение** для многих сценариев, встречающихся в этом вымышленном примере:

[Диаграмма модели временных рядов ![](media/v2-update-tsm/tsi-charting.png)](media/v2-update-tsm/tsi-charting.png#lightbox)

* Модель временных рядов играет важную роль в запросах и навигации, так как она контекстуализес данные, позволяя выполнять сравнения в пределах временных диапазонов, а также между датчиками и типами устройств.
* Данные в дальнейшем контекстуальны, поскольку данные, сохраняемые в модели временных рядов, сохраняют вычисления запросов временных рядов в виде переменных и используют их во время выполнения запроса.
* Модель временных рядов упорядочивает и объединяет данные для улучшения возможностей визуализации и управления.

### <a name="key-capabilities"></a>Ключевые возможности

Чтобы упростить и облегчить управление контекстуализацией временного ряда, модель временного ряда дает следующие возможности в среде "Аналитика временных рядов (предварительная версия)". Она поможет вам в следующих аспектах.

* Создание и Управление вычислениями или формулами с использованием скалярных функций, агрегатных операций и т. д.
* Определите связи типа «родители-потомки», чтобы включить навигацию, Поиск и ссылку.
* Определите свойства, связанные с экземплярами, определенные как *поля экземпляров*, и используйте их для создания иерархий.

### <a name="components"></a>Компоненты

Модель временных рядов включает в себя три основных компонента:

* [Экземпляры модели временных рядов](#time-series-model-instances)
* [Иерархии моделей временных рядов](#time-series-model-hierarchies)
* [Типы моделей временных рядов](#time-series-model-types)

Эти компоненты объединяются, чтобы указать модель временных рядов и упорядочить данные аналитики временных рядов Azure.

[Общие сведения о модели временных рядов ![](media/v2-update-tsm/tsm.png)](media/v2-update-tsm/tsm.png#lightbox)

Модель временных рядов можно создать и управлять через интерфейс [предварительного просмотра аналитики временных рядов](time-series-insights-update-how-to-tsm.md) . Параметрами модели временных рядов можно управлять через [API параметров модели](https://docs.microsoft.com/rest/api/time-series-insights/preview-model#model-settings-api).

## <a name="time-series-model-instances"></a>Экземпляры моделей временных рядов

*Экземпляры* модели временных рядов являются виртуальными представлениями временных рядов.

В большинстве случаев экземпляры уникально идентифицируются по **deviceId** или **assetId**, которые сохраняются как идентификаторы временных рядов.

Экземпляры имеют описательные сведения, связанные с ними, называемые *свойствами экземпляра*, например идентификатор временных рядов, тип, имя, описание, иерархии и поля экземпляра. Свойства экземпляр содержат, как минимум, сведения об иерархии.

*Поля экземпляра* представляют собой коллекцию описательных сведений, которые могут включать значения для уровней иерархии, а также для производителей, операторов и т. д.

После настройки источника событий для среды "аналитика временных рядов" экземпляры автоматически обнаруживаются и создаются в модели временных рядов. Экземпляры можно создавать или обновлять с помощью обозревателя "аналитика временных рядов" с помощью запросов модели временных рядов.

[Демонстрационная версия фермы "Ветер Contoso](https://insights.timeseries.azure.com/preview/samples) " предоставляет несколько примеров динамических экземпляров.

[экземпляры модели временных рядов ![](media/v2-update-tsm/instance.png)](media/v2-update-tsm/instance.png#lightbox)

### <a name="instance-properties"></a>Свойства экземпляра

Экземпляры определяются с помощью **тимесериесид**, **typeId**, **Name**, **Description**, **хиерарчидс**и **инстанцефиелдс**. Каждый экземпляр сопоставляется только с одним *типом*и одной или несколькими *иерархиями*.

| Свойство | ОПИСАНИЕ |
| --- | ---|
| тимесериесид | UUID временного ряда, с которым связан экземпляр. |
| Типа | UUID типа модели временных рядов, с которым связан экземпляр. По умолчанию все обнаруженные новые экземпляры связываются с типом по умолчанию.
| Имя | Свойство **name** является необязательным, и в нем учитывается регистр. Если **имя** недоступно, по умолчанию используется значение **тимесериесид**. Если указано имя, **тимесериесид** [также](time-series-insights-update-explorer.md#4-time-series-well)остается доступным в. |
| Описание | Текстовое описание экземпляра. |
| хиерарчидс | Определяет, к каким иерархиям принадлежит экземпляр. |
| инстанцефиелдс | Свойства экземпляра и любые статические данные, определяющие экземпляр. Они определяют значения свойств иерархии или неиерархические свойства и в то же время обеспечивают индексацию для выполнения операций поиска. |

> [!NOTE]
> Иерархии строятся с помощью полей экземпляров. Дополнительные **инстанцефиелдс** можно добавить для дальнейших определений свойств экземпляров.

Экземпляры имеют следующее представление JSON:

```JSON
{
    "timeSeriesId": ["PU2"],
    "typeId": "545314a5-7166-4b90-abb9-fd93966fa39b",
    "hierarchyIds": ["95f0a8d1-a3ef-4549-b4b3-f138856b3a12"],
    "description": "Pump #2",
    "instanceFields": {
        "Location": "Redmond",
        "Fleet": "Fleet 5",
        "Unit": "Pump Unit 3",
        "Manufacturer": "Contoso",
        "ScalePres": "0.54",
        "scaleTemp": "0.54"
    }
}
```

> [!TIP]
> API экземпляра службы "аналитика временных рядов" и поддержку создания, чтения, обновления и удаления (CRUD) см. в статье о [запросах данных](time-series-insights-update-tsq.md#time-series-model-query-tsm-q-apis) и [документации по API экземпляра](https://docs.microsoft.com/rest/api/time-series-insights/preview-model#instances-api).

## <a name="time-series-model-hierarchies"></a>Иерархии моделей временных рядов

*Иерархии* модели временных рядов упорядочивают экземпляры, указывая имена свойств и их связи.

В определенной среде "аналитика временных рядов" можно настроить несколько иерархий. Экземпляр модели временных рядов может сопоставляться с одной или несколькими иерархиями (отношение "многие ко многим").

Демонстрационный клиентский интерфейс [фермы "обмотка Contoso](https://insights.timeseries.azure.com/preview/samples) " отображает стандартный экземпляр и иерархию типов.

[иерархии моделей временных рядов ![](media/v2-update-tsm/hierarchy.png)](media/v2-update-tsm/hierarchy.png#lightbox)

### <a name="hierarchy-definition"></a>Определение иерархии

Иерархии определяются по **идентификатору**иерархии, **имени**и **источнику**.

| Свойство | ОПИСАНИЕ |
| ---| ---|
| id | Уникальный идентификатор иерархии, используемый, например, при определении экземпляра. |
| Имя | Строка, используемая для предоставления имени иерархии. |
| источник | Указывает организационную иерархию или путь, который является порядком "родители-потомки" в нисходящей иерархии, который пользователи хотят создать. Поля экземпляра сопоставляют свойства "родители-потомки". |

Иерархии представлены в формате JSON следующим образом:

```JSON
{
  "hierarchies": [
    {
      "id": "6e292e54-9a26-4be1-9034-607d71492707",
      "name": "Location",
      "source": {
        "instanceFieldNames": [
          "state",
          "city"
        ]
      }
    },
    {
      "id": "a28fd14c-6b98-4ab5-9301-3840f142d30e",
      "name": "ManufactureDate",
      "source": {
        "instanceFieldNames": [
          "year",
          "month"
        ]
      }
    }
  ]
}
```

В предыдущем примере JSON:

* `Location` определяет иерархию с родительским `states` и дочерними `cities`. Каждый `location` может иметь несколько `states`, которые, в свою очередь, могут иметь несколько `cities`.
* `ManufactureDate` определяет иерархию с родительским `year` и дочерними `month`. Каждый `ManufactureDate` может иметь несколько `years`, которые, в свою очередь, могут иметь несколько `months`.

> [!TIP]
> API экземпляра службы "аналитика временных рядов" и поддержка CRUD см. в статье о [запросах данных](time-series-insights-update-tsq.md#time-series-model-query-tsm-q-apis) и [документации по API-интерфейсам иерархии](https://docs.microsoft.com/rest/api/time-series-insights/preview-model#hierarchies-api).

### <a name="hierarchy-example"></a>Пример иерархии

Рассмотрим пример, где в иерархии **H1** находится `building`, `floor`и `room` как часть определения **инстанцефиелднамес** :

```JSON
{
  "id": "aaaaaa-bbbbb-ccccc-ddddd-111111",
  "name": "H1",
  "source": {
    "instanceFieldNames": [
      "building",
      "floor",
      "room"
    ]
  }
}
```

Учитывая поля экземпляра, используемые в предыдущем определении, и несколько временных рядов, атрибуты и значения иерархии отображаются, как показано в следующей таблице.

| Идентификатор временного ряда | Поля экземпляров |
| --- | --- |
| ID1 | "здание" = "1000", "этаж" = "10", "комната" = "55"  |
| ID2 | "здание" = "1000", "комната" = "55" |
| ID3 | "этаж" = "10" |
| ID4 | "здание" = "1000", "этаж" = "10"  |
| ID5 | Не задано ни "сборка", "этаж" или "комната". |

Временные ряды **id1** и **ID4** отображаются как часть иерархии **H1** в обозревателе службы " [аналитика временных рядов Azure](time-series-insights-update-explorer.md) ", так как они полностью определены и правильно упорядочены в *зданиях*, *этажах*и *комнатах* . Вход.

Другие классифицируются по *неродительским экземплярам* , так как они не соответствуют указанной иерархии данных.

## <a name="time-series-model-types"></a>Типы моделей временных рядов

*Типы* моделей временных рядов помогают определить переменные или формулы для выполнения вычислений. Типы связаны с конкретным экземпляром "аналитика временных рядов".

Один тип может содержать одну или несколько переменных. Например, экземпляр модели временных рядов может иметь тип *датчик температуры*, который состоит из переменных *Средняя температура*, *Минимальная температура*и *Максимальная температура*.

[Демонстрация фермы "Ветер Contoso](https://insights.timeseries.azure.com/preview/samples) " визуализирует несколько типов временных рядов, связанных с соответствующими экземплярами.

[типы моделей временных рядов ![](media/v2-update-tsm/types.png)](media/v2-update-tsm/types.png#lightbox)

> [!TIP]
> API экземпляра службы "аналитика временных рядов" и поддержка CRUD см. в статье о [запросах данных](time-series-insights-update-tsq.md#time-series-model-query-tsm-q-apis) и [документации по API типа](https://docs.microsoft.com/rest/api/time-series-insights/preview-model#types-api).

### <a name="type-properties"></a>Свойства типа

Типы моделей временных рядов определяются по **идентификатору**, **имени**, **описанию**и **переменным**.

| Свойство | ОПИСАНИЕ |
| ---| ---|
| id | UUID типа. |
| Имя | Строка, используемая для предоставления имени типа. |
| Описание | Строковое описание типа. |
| variables | Укажите переменные, связанные с типом. |

Типы соответствуют следующему примеру JSON:

```JSON
{
  "types": [
    {
      "id": "1be09af9-f089-4d6b-9f0b-48018b5f7393",
      "name": "DefaultType",
      "description": "Default type",
      "variables": {
        "EventCount": {
          "kind": "aggregate",
          "value": null,
          "filter": null,
          "aggregation": {
            "tsx": "count()"
          }
        },
        "Interpolated Speed": {
          "kind": "numeric",
          "value": {
              "tsx": "$event.[speed].Double"
          },
          "filter": null,
          "interpolation": {
              "kind": "step",
              "boundary": {
                  "span": "P1D"
              }
          },
          "aggregation": {
              "tsx": "left($value)"
          }
        }
      }
    }
  ]
}
```

### <a name="variables"></a>variables

Типы "аналитика временных рядов" могут иметь множество переменных, задающих правила формулы и вычисления для событий.

Каждая переменная может иметь один из трех *типов*: *numeric*, *категоризация*и *Aggregate*.

* **Числовые** типы работают с непрерывными значениями. 
* Типы **категорий** работают с определенным набором дискретных значений.
* **Агрегатные** значения объединяют несколько переменных одного типа (либо все числовые, либо все категории).

В следующей таблице показано, какие свойства важны для каждого типа переменной.

[типы моделей временных рядов ![](media/v2-update-tsm/variable-table.png)](media/v2-update-tsm/variable-table.png#lightbox)

#### <a name="numeric-variables"></a>Числовые переменные

| Свойство переменной | ОПИСАНИЕ |
| --- | ---|
| Фильтр переменной | Фильтры являются необязательными условными предложениями для ограничения количества строк, учитываемых при вычислении. |
| Значение переменной | Значения телеметрии, используемые для вычислений, поступающих от устройства или датчиков или преобразованных с помощью выражений временных рядов. Числовые переменные типа должны иметь тип *Double*.|
| Интерполяция переменных | Интерполяция указывает, как воссоздать сигнал с помощью существующих данных. Для числовых переменных доступны параметры *Step* и *линейной* интерполяции. |
| Объединение переменных | Поддержка вычислений с помощью операторов *AVG*, *min*, *Max*, *Sum*, *Count*, *First*, *Last* и Time-взвешенных (*AVG*, *min*, *Max*, *Sum*, *Left*). |

Переменные соответствуют следующему примеру JSON:

```JSON
"Interpolated Speed": {
  "kind": "numeric",
  "value": {
    "tsx": "$event.[speed].Double"
  },
  "filter": null,
  "interpolation": {
    "kind": "step",
    "boundary": {
      "span": "P1D"
    }
  },
  "aggregation": {
    "tsx": "left($value)"
  }
}
```

#### <a name="categorical-variables"></a>Переменные категорий

| Свойство переменной | ОПИСАНИЕ |
| --- | ---|
| Фильтр переменной | Фильтры являются необязательными условными предложениями для ограничения количества строк, учитываемых при вычислении. |
| Значение переменной | Значения телеметрии, используемые для вычислений, поступающих от устройства или датчиков. Переменные вида категорий должны быть *длинными* или *строковыми*. |
| Интерполяция переменных | Интерполяция указывает, как воссоздать сигнал с помощью существующих данных. Параметр "интерполяция *шагов* " доступен для переменных категории. |
| Категории переменных | Категории создают сопоставление значений, поступающих от устройства или датчиков, к метке. |
| Переменная категории по умолчанию | Категория по умолчанию предназначена для всех значений, которые не сопоставляются в свойстве Categories. |

Переменные соответствуют следующему примеру JSON:

```JSON
"Status": {
  "kind": "categorical",
  "value": "toLong($event.[Status].Double)",
  "interpolation": {
    "kind": "step",
    "boundary": {
      "span" : "PT1M"
    }
  },
  "categories": [
    {
      "values": [0, 1, 2, 3],
      "label": "Good"
    },
    {
      "values": [3],
      "label": "Bad"
    }
  ],
  "defaultCategory": {
    "label": "Not Applicable"
  }
}
```

#### <a name="aggregate-variables"></a>Статистические переменные

| Свойство переменной | ОПИСАНИЕ |
| --- | ---|
| Фильтр переменной | Фильтры являются необязательными условными предложениями для ограничения количества строк, учитываемых при вычислении. |
| Объединение переменных | Поддержка вычислений с помощью функций *AVG*, *min*, *Max*, *Sum*, *Count*, *First*и *Last*. |

Переменные соответствуют следующему примеру JSON:

```JSON
"Aggregate Speed": {
  "kind": "aggregate",
  "filter": null,
  "aggregation": {
    "tsx": "avg($event.Speed.Double)"
  }
}
```

Переменные хранятся в определении типа модели временных рядов и могут быть предоставлены встроенными средствами [API запросов](time-series-insights-update-tsq.md) для переопределения хранимого определения.

## <a name="next-steps"></a>Дополнительная информация

- См. [Data storage and ingress in Azure Time Series Insights Preview](./time-series-insights-update-storage-ingress.md) (Хранилище данных и входящий трафик в службе "Аналитика временных рядов Azure (предварительная версия)").
- Сведения об общих операциях с моделями временных рядов при [моделировании данных в предварительной версии службы "аналитика временных рядов Azure](./time-series-insights-update-how-to-tsm.md) "
- Ознакомьтесь с новой справочной документацией по [модели временных рядов](https://docs.microsoft.com/rest/api/time-series-insights/preview-model) .
