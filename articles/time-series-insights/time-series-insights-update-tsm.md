---
title: Моделирование временных рядов с помощью службы "Аналитика временных рядов Azure" (предварительная версия) | Документация Майкрософт
description: Основные сведения о модели временного ряда в службе "Аналитика временных рядов".
author: ashannon7
ms.author: anshan
ms.workload: big-data
manager: cshankar
ms.service: time-series-insights
services: time-series-insights
ms.topic: conceptual
ms.date: 04/29/2019
ms.custom: seodec18
ms.openlocfilehash: a9de28c96c2833033a3811835f57cffcccdf4619
ms.sourcegitcommit: 0568c7aefd67185fd8e1400aed84c5af4f1597f9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/06/2019
ms.locfileid: "65190331"
---
# <a name="time-series-model"></a>Модель временных рядов

В этой статье описывается модель временного ряда, используемая в службе "Аналитика временных рядов Azure (предварительная версия)". Здесь рассматривается сама модель, ее возможности и то, как начать ее использовать, создавая и изменяя собственную модель.

В большинстве случаев данные, собираемые с устройств Интернета вещей, не содержат контекстных сведений, что усложняет поиск и не позволяет быстро анализировать датчики. Модель временного ряда призвана упростить поиск и анализ данных Интернета вещей. Она позволяет достичь этой цели, обеспечивая чтение, обслуживание и наполнение данных временных рядов для подготовки готовых наборов данных для получателя.

Модели временных рядов играют важную роль в запросах и навигации, так как они выполняют контекстуализацию сущностей устройств и не связанных с устройствами сущностей. Данные в модели временных рядов служат для вычислений запросов временных рядов на основе заложенной в них формулы.

[![Общие сведения о модели ряда времени](media/v2-update-tsm/tsm.png)](media/v2-update-tsm/tsm.png#lightbox)

## <a name="key-capabilities"></a>Ключевые возможности

Чтобы упростить и облегчить управление контекстуализацией временного ряда, модель временного ряда дает следующие возможности в среде "Аналитика временных рядов (предварительная версия)". Она поможет вам в следующих аспектах.

* Создание вычислений или формул, а также и управление ими, преобразование данных с использованием скалярных функций, статистические операции и т. д.
* Определение родительско-дочерних отношений для включения навигации и ссылок, а также обеспечение контекста для телеметрии на основе временных рядов.
* Определение свойств, которые связаны с экземплярами в составе *полей экземпляров* и использование их для создания иерархий.

## <a name="entity-components"></a>Компоненты сущности

Модели временных рядов содержат трех основных компонентов:

* <a href="#time-series-model-types">Типы модели рядов времени</a>
* <a href="#time-series-model-hierarchies">Временные модели рядов иерархии</a>
* <a href="#time-series-model-instances">Экземпляры серии модели времени</a>

Эти компоненты объединяются для указания модели временных рядов и организовать данные Azure Time Series Insights.

## <a name="time-series-model-types"></a>Типы моделей временных рядов

*Типы* моделей временных рядов помогают определить переменные или формулы для выполнения вычислений. Типы связаны с определенным экземпляром службы "Аналитика временных рядов". Один тип может содержать одну или несколько переменных. Например, экземпляр службы "Аналитика временных рядов" может иметь тип *датчик температуры*, который состоит из переменных *ср_температура*, *мин_температура*и *макс_температура*. Мы создаем тип по умолчанию, когда данные начинают поступать в службу "Аналитика временных рядов". Тип по умолчанию можно получить и обновить из параметров модели. По умолчанию типы имеют переменную, которая подсчитывает количество событий.

### <a name="time-series-model-type-json-example"></a>Пример JSON для типа модели временного ряда

Пример:

```JSON
{
    "name": "SampleType",
    "description": "This is sample type",
    "variables": {
        "Avg Temperature": {
            "kind": "numeric",
            "filter": null,
            "value": { "tsx": "$event.temperature.Double" },
            "aggregation": {"tsx": "avg($value)"}
        },
        "Count Temperature": {
            "kind": "aggregate",
            "filter": null,
            "value": null,
            "aggregation": {"tsx": "count()"}
        }
    }
}
```

Дополнительные сведения о типах в моделях временных рядов см. в [Справочной документации](https://docs.microsoft.com/rest/api/time-series-insights/preview-model#types-api).

### <a name="variables"></a>Переменные

Типы в службе "Аналитика временных рядов" содержат переменные, которые являются именованными вычислениями над значениями из событий. Определения переменных времени в службе "Аналитика временных рядов" содержат формулу и правила вычислений. Определения переменных содержат параметры *тип*, *значение*, *фильтр*, *упрощение* и *границы*. Переменные хранятся в определении типа в модели временного ряда и могут быть использованы через API для запросов, чтобы переопределить хранимое определение.

Таблица ниже содержит условные обозначения для определения переменных:

[![Определение переменной типа table](media/v2-update-tsm/table.png)](media/v2-update-tsm/table.png#lightbox)

| Определение | ОПИСАНИЕ |
| --- | ---|
| Тип переменной |  *Числовые* и *агрегатные* поддерживаются типы |
| Фильтр переменной | Фильтр переменной определяет необязательное предложение фильтра для ограничения числа строк, которые предполагается использовать для вычисления на основе условий. |
| Значение переменной | Значения переменных используются при вычислениях. Соответствующее поле для ссылки для рассматриваемого точки данных. |
| Объединение переменных | Функция объединения переменных активирует часть вычисления. Аналитика временных рядов поддерживает обычные вычисления (а именно: *min*, *max*, *avg*, *sum* и *count*). |

## <a name="time-series-model-hierarchies"></a>Иерархии моделей временных рядов

Иерархии организуют экземпляры, определяя имена свойств и их связи. Иерархий может быть несколько. Им не нужно быть частью имеющихся данных, но каждый экземпляр должен принадлежать иерархии. Экземпляр модели временного ряда можно сопоставить с одной или несколькими иерархиями.

Иерархии определяются *идентификатором*, *именем* и *источником* иерархии. Иерархии содержат нисходящий путь от родителей к потомкам, который по своему усмотрению создают пользователи. Карта связей родителей и потомков определяет *поле экземпляров*.

### <a name="time-series-model-hierarchy-json-example"></a>Пример JSON для иерархии модели временного ряда

Пример:

```JSON
{
    "id": "4c6f1231-f632-4d6f-9b63-e366d04175e3",
    "name": "Location",
    "source": {
        "instanceFieldNames": [
                "state",
                "city"
            ]
    }
}
```

Дополнительные сведения об иерархиях в моделях временных рядов см. в [Справочной документации](https://docs.microsoft.com/rest/api/time-series-insights/preview-model#hierarchies-api).

### <a name="hierarchy-definition-behavior"></a>Поведение определения иерархии

Рассмотрим следующий пример, где иерархия H1 содержит определения *здание*, *этаж* и *комната*.

```plaintext
 H1 = [“building”, “floor”, “room”]
```

В зависимости от *полей экземпляров*, атрибуты и значения иерархии отображаются так, как показано в таблице ниже.

| Идентификатор временного ряда | Поля экземпляров |
| --- | --- |
| ID1 | "здание" = "1000", "этаж" = "10", "комната" = "55"  |
| ID2 | "здание" = "1000", "комната" = "55" |
| ID3 | "этаж" = "10" |
| ID4 | "здание" = "1000", "этаж" = "10"  |
| ID5 | Значения "здание", "этаж" и "комната" не заданы |

В приведенном выше примере **ID1** и **касается и маршрута 4** Показать как часть иерархии H1 в обозревателе Azure Time Series Insights и rest, относятся *без родительского элемента экземпляров* так как они не соответствует иерархии указанных данных.

## <a name="time-series-model-instances"></a>Экземпляры моделей временных рядов

Экземпляры — это собственно временные ряды. В большинстве случаев они представляют собой *DeviceID* или *AssetID* — уникальный идентификатор ресурса в среде. Экземпляры содержат описательные сведения, связанные с ними так называемыми свойствами экземпляра. Свойства экземпляр содержат, как минимум, сведения об иерархии. Они также могут содержать полезные, описательные данные, например сведения о производителе, операторе или дату последнего обновления.

Экземпляры определяются переменными *typeId*, *timeSeriesId*, *name*, *description*, *hierarchyIds* и *instanceFields*. Каждый экземпляр сопоставляется только с одним *типом* и одной или несколькими иерархиями. Экземпляры наследуют все свойства из иерархий и для дальнейшего определения свойства экземпляра можно добавить новые параметры *instanceFields*.

*instanceFields* — это свойства экземпляра и любые статические данные, определяющие этот экземпляр. Они определяют значения свойств иерархии или неиерархические свойства и в то же время обеспечивают индексацию для выполнения операций поиска.

*Имя* свойство является необязательным и с учетом регистра. Если *name* недоступно, по умолчанию будет использоваться ИД временного ряда. Если *name* предоставлено, ИД временного ряда будет доступен в резервуаре (сетка, которая находится под диаграммами в проводнике).

### <a name="time-series-model-instance-json-example"></a>Пример JSON для экземпляра модели временного ряда

Пример:

```JSON
{
    "typeId": "1be09af9-f089-4d6b-9f0b-48018b5f7393",
    "timeSeriesId": ["sampleTimeSeriesId"],
    "name": "sampleName",
    "description": "Sample Instance",
    "hierarchyIds": [
        "1643004c-0a84-48a5-80e5-7688c5ae9295"
    ],
    "instanceFields": {
        "state": "California",
        "city": "Los Angeles"
    }
}
```

Дополнительные сведения об экземплярах в моделях временных рядов см. в [Справочной документации](https://docs.microsoft.com/rest/api/time-series-insights/preview-model#instances-api).

### <a name="time-series-model-settings-example"></a>Пример параметров модели временного ряда

Пример:

```JSON
{
    "modelSettings": {
        "name": "DefaultModel",
        "timeSeriesIdProperties": [
            {
                "name": "id",
                "type": "String"
            }
        ],
        "defaultTypeId": "1be09af9-f089-4d6b-9f0b-48018b5f7393"
    }
}
```

Дополнительные сведения о параметрах моделей временных рядов см. в [Справочной документации](https://docs.microsoft.com/rest/api/time-series-insights/preview-model#model-settings-api).

## <a name="next-steps"></a>Дальнейшие действия

- См. [Data storage and ingress in Azure Time Series Insights Preview](./time-series-insights-update-storage-ingress.md) (Хранилище данных и входящий трафик в службе "Аналитика временных рядов Azure (предварительная версия)").

- См. новый раздел [Time Series Model](https://docs.microsoft.com/rest/api/time-series-insights/preview-model) (Модель временного ряда).