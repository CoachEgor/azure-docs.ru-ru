---
title: Установите лазурный кэш hPC
description: Как подключить клиентов к службе Azure HPC Cache
author: ekpgh
ms.service: hpc-cache
ms.topic: conceptual
ms.date: 04/03/2020
ms.author: rohogue
ms.openlocfilehash: f176e30cfaf9a52e4f58091b7fc76098a4c88a48
ms.sourcegitcommit: 62c5557ff3b2247dafc8bb482256fef58ab41c17
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/03/2020
ms.locfileid: "80657364"
---
# <a name="mount-the-azure-hpc-cache"></a>Mount the Azure HPC Cache (Подключение Azure HPC Cache)

После создания кэша клиенты NFS могут `mount` получить к нему доступ с помощью простой команды. Команда соединяет определенный целевой путь хранения в кэше HPC Azure с локальным каталогом на клиентской машине.

Команда крепления состоит из следующих элементов:

* Один из адресов крепления кэша (перечислен на странице обзора кэша)
* Виртуальный путь пространства имен, установленный при создании цели хранения
* Локальный путь для использования на клиенте
* Параметры команды, которые оптимизируют успех такого рода nFS монтировать

Страница **инструкций Mount** для кэша собирает информацию и рекомендуемые варианты для вас и создает команду крепления прототипа, которую можно скопировать. Прочитайте [Используйте утилиту инструкций крепления](#use-the-mount-instructions-utility) для деталей.

## <a name="prepare-clients"></a>Подготовка клиентов

Убедитесь, что ваши клиенты могут смонтировать кэш Azure HPC, следуя рекомендациям в этом разделе.

### <a name="provide-network-access"></a>Обеспечить доступ к сети

Клиентские машины должны иметь сетевой доступ к виртуальной сети кэша и частной подсети.

Например, создать клиентские виртуальные в рамках одной виртуальной сети или использовать конечную точку, шлюз или другое решение в виртуальной сети для доступа извне. (Помните, что ничего, кроме самого кэша, не должно размещаться в подсети кэша.)

### <a name="install-utilities"></a>Установка утилит

Установите соответствующее программное обеспечение утилиты Linux для поддержки команды установки NFS:

* Для Red Hat Enterprise Linux или SuSE:`sudo yum install -y nfs-utils`
* Для Ubuntu или Debian:`sudo apt-get install nfs-common`

### <a name="create-a-local-path"></a>Создание локального пути

Создайте локальный путь каталога для подключения к кэшу. Создайте путь для каждой цели хранения, которую вы хотите смонтировать.

Например, `sudo mkdir -p /mnt/hpc-cache-1/target3`.

## <a name="use-the-mount-instructions-utility"></a>Использование утилиты инструкций крепления

Откройте страницу **инструкций «Гора»** из раздела **«Настройка»** представления кэша на портале Azure.

![скриншот экземпляра кэша Azure HPC на портале с загруженной страницей инструкций >](media/mount-instructions.png)

Страница команды крепления содержит информацию о процессе установки клиента и предпосылки, а также поля, которые можно использовать для создания копируемой команды крепления.

Чтобы использовать эту страницу, следуйте этой процедуре:

<!--1.  In step one of **Mounting your file system**, enter the path that the client will use to access the Azure HPC Cache storage target.

   * This path is local to the client.
   * After you provide the directory name, the field populates with a command you can copy. Use this command on the client directly or in a setup script to create the directory path on the client VM. -->

1. Просмотрите предпосылки клиента и установите утилиты, необходимые для использования команды NFS, `mount` как описано выше в [подготовии клиентов.](#prepare-clients)

1. Шаг первый **монтаж файловой системы**<!-- label will change --> дает пример команды для создания локального пути на клиенте. Это путь, который клиент будет использовать для доступа к содержимому из кэша HPC Azure.

   Обратите внимание на имя пути, чтобы при необходимости изменить его в команде.

1. На второй шаг выберите один из доступных IP-адресов. Все [точки крепления клиента](#find-mount-command-components) кэша перечислены здесь. Убедитесь, что у вас есть система, чтобы сбалансировать нагрузку между всеми IP-адресами.

1. Поле в шаге 3 автоматически заполняется командой крепления прототипа. Нажмите символ копии в правой части поля, чтобы автоматически скопировать его на буфер обмена.

   > [!NOTE]
   > Проверьте команду копирования перед ее использованием. Возможно, потребуется настроить траекторию крепления клиента и целевой путь виртуального пространства имен, который еще не выбран в этом интерфейсе. Также следует обновить параметры команды крепления, чтобы отразить [рекомендуемые варианты](#mount-command-options) ниже. Read [Поймите смонтированный синтаксис команды](#understand-mount-command-syntax) для справки.

1. Используйте скопированную команду крепления (с помощью детект, при необходимости) на клиентской машине, чтобы подключить ее к цели хранения в кэше Azure HPC. Вы можете выдать команду непосредственно из строки команды клиента или включить команду крепления в сценарий или шаблон настройки клиента.

## <a name="understand-mount-command-syntax"></a>Понимание синтаксиса команды крепления

Команда крепления имеет следующую форму:

> sudo монтаж *cache_mount_address*:/*namespace_path* *local_path local_path* *варианты*

Пример

```bash
root@test-client:/tmp# mkdir hpccache
root@test-client:/tmp# sudo mount 10.0.0.28:/blob-demo-0722 ./hpccache/ -o hard,proto=tcp,mountproto=tcp,retry=30
root@test-client:/tmp#
```

После успеха этой команды содержимое экспорта хранилища будет ``hpccache`` видно в каталоге клиента.

### <a name="mount-command-options"></a>Параметры команды маунт

Для надежного крепления клиента передайте эти настройки и аргументы в команде крепления:

> mount -o hard,proto'tcp,mountpro'tcp,retry -30 $'CACHE_IP_ADDRESS:/$, NAMESPACE_PATH $LOCAL_FILESYSTEM_MOUNT_POINT

| Рекомендуемые настройки команды крепления | |
--- | ---
``hard`` | Мягкие крепления к кэшу Azure HPC связаны со сбоями приложений и возможной потерей данных.
``proto=tcp`` | Этот параметр поддерживает соответствующую обработку сетевых ошибок NFS.
``mountproto=tcp`` | Этот параметр поддерживает соответствующую обработку сетевых ошибок для операций подключения.
``retry=<value>`` | Задайте значение ``retry=30``, чтобы избежать временных ошибок при подключении. (При подключении переднего плана рекомендуется использовать другое значение.)

### <a name="find-mount-command-components"></a>Поиск компонентов команды крепления

Если вы хотите создать команду крепления без использования **страницы инструкций Mount,** вы можете найти адреса крепления на странице **обзора** кэша и виртуальные пути пространства имен на странице **целей хранения.**

![скриншот страницы обзоров экземпляра Azure HPC Cache с полем выделения вокруг списка адресов крепления в правом нижнем правом](media/hpc-cache-mount-addresses.png)

> [!NOTE]
> Адреса крепления кэша соответствуют сетевым интерфейсам в подсети кэша. В группе ресурсов эти NICs перечислены `-cluster-nic-` с именами, заканчивающимися и номером. Не изменяйте и не удаляйте эти интерфейсы, иначе кэш станет недоступен.

Пути виртуального пространства имен отображаются на странице **целей хранилища.** Нажмите на индивидуальное целевое имя хранилища, чтобы увидеть его детали, включая агрегированные пути пространства имен, связанные с ним.

![скриншот целевой панели хранения кэша, с полем выделения вокруг входа в столбце Пути таблицы](media/hpc-cache-view-namespace-paths.png)

## <a name="next-steps"></a>Дальнейшие действия

* Чтобы переместить данные в целевые показатели хранения кэша, [прочитайте новое хранилище Azure Blob.](hpc-cache-ingest.md)
