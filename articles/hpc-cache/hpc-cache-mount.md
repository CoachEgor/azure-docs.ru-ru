---
title: Установите лазурный кэш hPC
description: Как подключить клиентов к службе Azure HPC Cache
author: ekpgh
ms.service: hpc-cache
ms.topic: conceptual
ms.date: 04/15/2020
ms.author: v-erkel
ms.openlocfilehash: a44232f06b455e20530271723e816c2117b339a0
ms.sourcegitcommit: b55d7c87dc645d8e5eb1e8f05f5afa38d7574846
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/16/2020
ms.locfileid: "81458405"
---
# <a name="mount-the-azure-hpc-cache"></a>Mount the Azure HPC Cache (Подключение Azure HPC Cache)

После создания кэша клиенты NFS могут `mount` получить к нему доступ с помощью простой команды. Команда соединяет определенный целевой путь хранения в кэше HPC Azure с локальным каталогом на клиентской машине.

Команда крепления состоит из следующих элементов:

* Один из адресов крепления кэша (перечислен на странице обзора кэша)
* Виртуальный путь пространства имен, установленный при создании цели хранения
* Локальный путь для использования на клиенте
* Параметры команды, которые оптимизируют успех такого рода nFS монтировать

Страница **инструкций Mount** для кэша собирает информацию и рекомендуемые варианты для вас и создает команду крепления прототипа, которую можно скопировать. Прочитайте [Используйте утилиту инструкций крепления](#use-the-mount-instructions-utility) для деталей.

## <a name="prepare-clients"></a>Подготовка клиентов

Убедитесь, что ваши клиенты могут смонтировать кэш Azure HPC, следуя рекомендациям в этом разделе.

### <a name="provide-network-access"></a>Обеспечить доступ к сети

Клиентские машины должны иметь сетевой доступ к виртуальной сети кэша и частной подсети.

Например, создать клиентские виртуальные в рамках одной виртуальной сети или использовать конечную точку, шлюз или другое решение в виртуальной сети для доступа извне. (Помните, что ничего, кроме самого кэша, не должно размещаться в подсети кэша.)

### <a name="install-utilities"></a>Установка утилит

Установите соответствующее программное обеспечение утилиты Linux для поддержки команды установки NFS:

* Для Red Hat Enterprise Linux или SuSE:`sudo yum install -y nfs-utils`
* Для Ubuntu или Debian:`sudo apt-get install nfs-common`

### <a name="create-a-local-path"></a>Создание локального пути

Создайте локальный путь каталога для подключения к кэшу. Создайте путь для каждого пути пространства имен, который вы хотите смонтировать.

Пример: `sudo mkdir -p /mnt/hpc-cache-1/target3`

Страница [инструкций Mount](#use-the-mount-instructions-utility) на портале Azure содержит команду прототипа, которую можно скопировать.

При подключении клиентской машины к кэшу вы свяжете этот путь с виртуальным путем пространства имен, представляющим собой экспорт целевого хранилища. Создавайте каталоги для каждого из виртуальных путей пространства имен, которые будет использовать клиент.

## <a name="use-the-mount-instructions-utility"></a>Использование утилиты инструкций крепления

Для создания копируемой команды крепления можно использовать страницу **инструкций Mount** на портале Azure. Откройте страницу из раздела **Настройка** представления кэша на портале.

Прежде чем использовать команду на клиента, убедитесь, что клиент отвечает предпосылок и имеет программное обеспечение, необходимое для использования команды NFS, `mount` как описано выше в [Подготовьте клиентов.](#prepare-clients)

![скриншот экземпляра кэша Azure HPC на портале с загруженной страницей инструкций >](media/mount-instructions.png)

Следуйте этой процедуре, чтобы создать команду крепления.

1. Настройте поле **пути клиента.** В этом поле приводится пример команды, которую можно использовать для создания локального пути на клиенте. Клиент получает доступ к содержимому из кэша Azure HPC локально в этом каталоге.

   Нажмите на поле и отодевите команду, чтобы содержать нужное имя каталога. Имя появляется в конце строки после`sudo mkdir -p`

   ![скриншот поля пути клиента с курсором, расположенным в конце](media/mount-edit-client.png)

   После завершения редактирования поля команда крепления в нижней части страницы обновляется с новым клиентом.

1. Выберите **адрес крепления кэша** из списка. В этом меню перечислены все [точки крепления клиента](#find-mount-command-components)кэша.

   Баланс наяза клиента по всем доступным адресам крепления для повышения производительности кэша.

   ![скриншот поля кэша монтировать адрес, с селектора с указанием трех IP-адресов на выбор](media/mount-select-ip.png)

1. Выберите **путь виртуального пространства имен** для клиента. Эти пути связаны с экспортом на бэк-энд системы хранения.

   ![скриншот поля траекторий пространства имен с открытым селектора](media/mount-select-target.png)

   Вы можете просматривать и изменять виртуальные пути пространства имен на странице портала целей хранения. Прочтите [целевые показатели хранения,](hpc-cache-add-storage.md) чтобы узнать, как это сделать.

   Чтобы узнать больше о агрегированной функции пространства имен Azure HPC Cache, прочитайте [агрегированное пространство имен.](hpc-cache-namespace.md)

1. Поле **командования Mount** в третьей ступени автоматически заполняется настраиваемым командом крепления, использующее адрес крепления, виртуальный путь пространства имен и путь клиента, установленный в предыдущих полях.

   Нажмите символ копии в правой части поля, чтобы автоматически скопировать его на буфер обмена.

   ![скриншот поля траекторий пространства имен с открытым селектора](media/mount-command-copy.png)

1. Используйте скопированную команду крепления на клиентской машине, чтобы подключить ее к кэшу Azure HPC. Вы можете выдать команду непосредственно из строки команды клиента или включить команду крепления в сценарий или шаблон настройки клиента.

## <a name="understand-mount-command-syntax"></a>Понимание синтаксиса команды крепления

Команда крепления имеет следующую форму:

> sudo монтажа и*вариантов* *cache_mount_address*:/*namespace_path* *local_path*

Пример

```bash
root@test-client:/tmp# mkdir hpccache
root@test-client:/tmp# sudo mount -o hard,proto=tcp,mountproto=tcp,retry=30 10.0.0.28:/blob-demo-0722 hpccache
root@test-client:/tmp#
```

После успеха этой команды содержимое экспорта хранилища будет ``hpccache`` видно в каталоге клиента.

### <a name="mount-command-options"></a>Параметры команды маунт

Для надежного крепления клиента передайте эти настройки и аргументы в команде крепления:

> mount -o hard,proto'tcp,mountpro'tcp,retry -30 $'CACHE_IP_ADDRESS:/$, NAMESPACE_PATH $LOCAL_FILESYSTEM_MOUNT_POINT

| Рекомендуемые настройки команды крепления | |
--- | ---
``hard`` | Мягкие крепления к кэшу Azure HPC связаны со сбоями приложений и возможной потерей данных.
``proto=tcp`` | Этот параметр поддерживает соответствующую обработку сетевых ошибок NFS.
``mountproto=tcp`` | Этот параметр поддерживает соответствующую обработку сетевых ошибок для операций подключения.
``retry=<value>`` | Задайте значение ``retry=30``, чтобы избежать временных ошибок при подключении. (При подключении переднего плана рекомендуется использовать другое значение.)

### <a name="find-mount-command-components"></a>Поиск компонентов команды крепления

Если вы хотите создать команду крепления без использования **страницы инструкций Mount,** вы можете найти адреса крепления на странице **обзора** кэша и виртуальные пути пространства имен на целевой странице **Хранилища.**

![скриншот страницы обзоров экземпляра Azure HPC Cache с полем выделения вокруг списка адресов крепления в правом нижнем правом](media/hpc-cache-mount-addresses.png)

> [!NOTE]
> Адреса крепления кэша соответствуют сетевым интерфейсам в подсети кэша. В группе ресурсов эти NICs перечислены `-cluster-nic-` с именами, заканчивающимися и номером. Не изменяйте и не удаляйте эти интерфейсы, иначе кэш станет недоступен.

Пути виртуального пространства имен отображаются на странице данных каждой цели хранения. Нажмите на индивидуальное целевое имя хранилища, чтобы увидеть его детали, включая агрегированные пути пространства имен, связанные с ним.

![скриншот страницы детали цели хранилища (заголовок "Цель хранения обновлений"). Существует поле выделения вокруг записи в виртуальном пространстве имен столбец таблицы](media/hpc-cache-view-namespace-paths.png)

## <a name="next-steps"></a>Следующие шаги

* Чтобы переместить данные в целевые показатели хранения кэша, [прочитайте новое хранилище Azure Blob.](hpc-cache-ingest.md)
