---
title: Перемещение данных в облачный контейнер Azure HPC Cache
description: Как заполнить хранилище Azure Blob для использования с помощью кэша Azure HPC
author: ekpgh
ms.service: hpc-cache
ms.topic: conceptual
ms.date: 10/30/2019
ms.author: rohogue
ms.openlocfilehash: a5625341e3dd279d93a59c57cd3325245351723e
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "79271880"
---
# <a name="move-data-to-azure-blob-storage"></a>Перемещение данных в хранилище Azure Blob

Если рабочий процесс включает перемещение данных в хранилище Azure Blob, убедитесь, что вы используете эффективную стратегию. Вы можете либо предварительно загрузить данные в новом контейнере Blob, прежде чем определить их в качестве цели хранения, либо добавить контейнер, а затем скопировать данные с помощью Azure HPC Cache.

В этой статье объясняется наилучшие способы перемещения данных в хранилище Blob для использования в Azure HPC Cache.

Имейте в виду эти факты:

* Azure HPC Cache использует специализированный формат хранения для организации данных в хранилище Blob. Поэтому целью хранения Blob должен быть либо новый, пустой контейнер, либо контейнер Blob, который ранее использовался для данных Azure HPC Cache. <!--([Avere vFXT for Azure](https://azure.microsoft.com/services/storage/avere-vfxt/) also uses this cloud file system.)-->

* Копирование данных через кэш Azure HPC для целевой системы хранения данных более эффективно при использовании нескольких клиентов и параллельных операций. Простая команда копирования от одного клиента будет медленно перемещать данные.

Утилита на основе Python доступна для загрузки содержимого в контейнер для хранения blob. Прочитайте [предварительные данные о загрузке в хранилище Blob,](#pre-load-data-in-blob-storage-with-clfsload) чтобы узнать больше.

Если вы не хотите использовать утилиту загрузки или хотите добавить содержимое в существующую цель хранения, следуйте параллельным советам data ingest в [copy data через Кэш HPC Azure.](#copy-data-through-the-azure-hpc-cache)

## <a name="pre-load-data-in-blob-storage-with-clfsload"></a>Предварительная загрузка данных в хранилище Blob с помощью CLFSLoad

Параметры <!--[Avere CLFSLoad](https://aka.ms/avere-clfsload)--> Утилита Avere CLFSLoad для копирования данных в новый контейнер для хранения данных Blob перед добавлением их в качестве цели хранения. Эта утилита работает на единой системе Linux и записывает данные в запатентованный формат, необходимый для Azure HPC Cache. CLFSLoad является наиболее эффективным способом заполнения контейнера для хранения Blob для использования с кэшем.

Утилита Avere CLFSLoad доступна по запросу вашей команды Azure HPC Cache. Попросите свою команду связаться с ней или открыть [билет поддержки,](hpc-cache-support-ticket.md) чтобы запросить помощь.

Эта опция работает только с новыми пустыми контейнерами. Создайте контейнер перед использованием Avere CLFSLoad.

Подробная информация включена в дистрибутив Avere CLFSLoad, который доступен по запросу команды Azure HPC Cache. <!-- [Avere CLFSLoad readme](https://github.com/microsoft/Avere-CLFSLoad/blob/master/README.md). --><!-- caution literal link -->

Общий обзор процесса:

1. Подготовьте систему Linux (VM или physical) с версией Python 3.6 или позже. Python 3.7 рекомендуется для повышения производительности.
1. Установите программное обеспечение Avere-CLFSLoad в систему Linux.
1. Выполните передачу из командной строки Linux.

Утилита Avere CLFSLoad нуждается в следующей информации:

* Идентификатор учетной записи хранилища, содержащий ваш контейнер для хранения Blob
* Название пустого контейнера для хранения Blob
* Токен общей подписи доступа (SAS), позволяющий утилите записываться в контейнер
* Локальный путь к источнику данных - либо локальный каталог, содержащий данные для копирования, либо локальный путь к установленной удаленной системе с данными

<!-- The requirements are explained in detail in the [Avere CLFSLoad readme](https://aka.ms/avere-clfsload). -->

## <a name="copy-data-through-the-azure-hpc-cache"></a>Копирование данных через кэш HPC Azure

Если вы не хотите использовать утилиту Avere CLFSLoad, или если вы хотите добавить большой объем данных в существующую цель хранения Blob, вы можете скопировать их через кэш. Кэш Azure HPC предназначен для обслуживания нескольких клиентов одновременно, поэтому для копирования данных через кэш следует использовать параллельные записи от нескольких клиентов.

![Схема, показывающая многопоточное перемещение данных с несколькими клиентами. В левом верхнем углу из значка локального аппаратного хранилища исходят несколько стрелок. Стрелки указывают на четыре клиентских компьютера. Из каждой клиентской машины три стрелки указывают на кэш HPC Azure. Из кэша Azure HPC несколько стрелок указывают на хранилище Blob.](media/hpc-cache-parallel-ingest.png)

Команды ``cp`` ``copy`` или команды, которые обычно используются для передачи данных из одной системы хранения в другую, являются однопотечными процессами, которые копируют только один файл за один раз. Это означает, что файловый сервер глотает только один файл за один раз, что является пустой тратой ресурсов кэша.

В этом разделе разъясняются стратегии создания многоклиентской многопоточной системы копирования файлов для перемещения данных в хранилище Blob с помощью Кэша HPC Azure. В ней описываются концепции передачи файлов и точки принятия решений, которые можно использовать для эффективного копирования данных с использованием нескольких клиентов и простых команд копирования.

Здесь также описываются некоторые служебные программы, которые могут помочь. С помощью служебной программы ``msrsync`` можно частично автоматизировать процесс разделения набора данных на группы и применение команд rsync. Сценарий ``parallelcp`` — это другая служебная программа, которая считывает исходный каталог и выдает команды копирования автоматически.

### <a name="strategic-planning"></a>Стратегическое планирование

При составлении стратегии для копирования данных в параллельном режиме следует учитывать компромиссы между размерами файлов, их количеством и глубиной каталогов.

* Если файлы малы, нужная метрика — количество файлов в секунду.
* Если файлы большие (10 MБ или больше), нужная метрика — число байт в секунду.

Каждый процесс копирования имеет пропускную способность и скорость передачи файлов, которые можно измерять по времени команды копирования с учетом размера и количества файлов. Объяснение того, как измерять скорость, выходит за рамки этого документа, но важно понять, с файлами какого размера вы будете работать.

Стратегии параллельного ухищрения данных с Кэшем высокой высочешие кэша Azure включают:

* Ручное копирование - Вы можете вручную создать многопонительную копию на клиенте, запустив несколько копий команды одновременно в фоновом режиме на фоне предопределенных наборов файлов или путей. Прочитайте [данные Azure HPC Cache - ручной метод копирования](hpc-cache-ingest-manual.md) для деталей.

* Частично автоматизированное ``msrsync``  -  ``msrsync`` копирование с утилитой обертки, которая выполняет несколько параллельных ``rsync`` процессов. Для получения подробной информации прочитайте [метод Azure HPC Cache - метод msrsync](hpc-cache-ingest-msrsync.md).

* Копирование по ``parallelcp`` сценарию с помощью - Узнайте, как создать и запустить параллельный сценарий копирования в [данных Azure HPC Cache ingest - параллельный метод сценария копирования.](hpc-cache-ingest-parallelcp.md)

## <a name="next-steps"></a>Дальнейшие действия

После настройки хранилища узнайте, как клиенты могут смонтировать кэш.

* [Доступ к системе Кэша Высокой Азии](hpc-cache-mount.md)
