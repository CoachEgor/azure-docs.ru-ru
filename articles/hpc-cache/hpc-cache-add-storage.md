---
title: Добавление хранилища в кэш HPC Azure (Предварительная версия)
description: Определение целевых объектов хранилища, чтобы кэш Azure HPC мог использовать локальную систему NFS или контейнеры больших двоичных объектов Azure для долгосрочного хранения файлов.
author: ekpgh
ms.service: hpc-cache
ms.topic: conceptual
ms.date: 09/24/2019
ms.author: v-erkell
ms.openlocfilehash: 7df0727a58f3d70289c5060175572dac1bbb4abb
ms.sourcegitcommit: 29880cf2e4ba9e441f7334c67c7e6a994df21cfe
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/26/2019
ms.locfileid: "71300031"
---
# <a name="add-storage-targets"></a>Добавление целевых объектов хранилища

*Целевые объекты хранилища* — это серверное хранилище для файлов, доступ к которым осуществляется через экземпляр кэша Azure HPC. Вы можете добавить хранилище NFS, например локальную аппаратную систему, или сохранить данные в большом двоичном объекте Azure.

Можно определить до десяти различных целевых объектов хранилища для одного кэша. Кэш представляет все целевые объекты хранилища в одном объединенном пространстве имен.

Помните, что экспорты хранилища должны быть доступны из виртуальной сети кэша. Для локального хранилища оборудования может потребоваться настроить DNS-сервер, который может разрешать имена узлов для доступа к хранилищу NFS. Дополнительные сведения см. в статье [доступ к DNS](hpc-cache-prereqs.md#dns-access).

Вы можете добавить целевые объекты хранилища при создании кэша или позже. Процедура немного отличается в зависимости от того, добавляется ли хранилище BLOB-объектов Azure или экспорт NFS. Сведения для каждого из них приведены ниже.

## <a name="add-storage-targets-while-creating-the-cache"></a>Добавление целевых объектов хранилища при создании кэша

Используйте вкладку **целевые объекты хранилища** мастера создания кэша Azure HPC, чтобы определить хранилище одновременно с созданием экземпляра кэша.

![снимок экрана: страница целевых объектов хранилища](media/hpc-cache-storage-targets-pop.png)

Щелкните ссылку **добавить целевой объект хранилища** , чтобы добавить хранилище.

## <a name="add-storage-targets-from-the-cache"></a>Добавление целевых объектов хранилища из кэша

В портал Azure откройте экземпляр кэша и щелкните **целевые объекты хранилища** на левой боковой панели. На странице целевой объект хранилища перечисляются все существующие целевые объекты и добавляется ссылка для добавления новой.

![снимок экрана: ссылка на целевые объекты хранилища на боковой панели под заголовком Настройка, между параметрами заголовков категорий и мониторингом](media/hpc-cache-storage-targets-sidebar.png)

## <a name="add-a-new-azure-blob-storage-target"></a>Добавление нового целевого объекта хранилища BLOB-объектов Azure

Для нового целевого объекта хранилища BLOB-объектов требуется пустой контейнер больших двоичных объектов или контейнер, заполненный данными в формате облачной файловой системы Azure HPC. Дополнительные сведения о предварительной загрузке контейнера больших двоичных объектов см. в статье [Перемещение данных в хранилище BLOB-объектов Azure](hpc-cache-ingest.md).

Чтобы определить контейнер больших двоичных объектов Azure, введите эти сведения.

![снимок экрана: страница "Добавление целевого объекта хранилища", заполненная данными для нового целевого объекта хранилища BLOB-объектов Azure](media/hpc-cache-add-blob.png)

<!-- need to replace screenshot after note text is updated with both required RBAC roles -->

* **Имя целевого объекта хранилища** — задайте имя, идентифицирующее этот целевой объект хранилища в кэше HPC Azure.
* **Тип целевого объекта** — выберите **BLOB-объект**.
* **Учетная запись хранения** — выберите учетную запись, на которую будет ссылаться контейнер.

  Необходимо авторизовать экземпляр кэша для доступа к учетной записи хранения, как описано в разделе [Добавление ролей доступа](#add-the-access-control-roles-to-your-account).
* **Контейнер хранилища** — выберите контейнер больших двоичных объектов для этого целевого объекта.

* **Путь к виртуальному пространству имен** — задает путь к файлу для клиента для этого целевого объекта хранилища. Дополнительные сведения о функции виртуального пространства имен см. в статье [Настройка агрегированного пространства имен](hpc-cache-namespace.md) .

По завершении нажмите кнопку **ОК** , чтобы добавить целевой объект хранилища.

### <a name="add-the-access-control-roles-to-your-account"></a>Добавление ролей контроля доступа в учетную запись

Кэш Azure HPC использует [Управление доступом на основе ролей (RBAC)](https://docs.microsoft.com/azure/role-based-access-control/index) для авторизации приложения кэша на доступ к учетной записи хранения для целевых объектов хранилища BLOB-объектов Azure.

Владелец учетной записи хранения должен явным образом добавить [участника учетной записи хранения](https://docs.microsoft.com/azure/role-based-access-control/built-in-roles#storage-account-contributor) ролей и [участника данных большого двоичного объекта хранилища](https://docs.microsoft.com/azure/role-based-access-control/built-in-roles#storage-blob-data-contributor) для пользователя "поставщик ресурсов сторажекаче".

Это можно сделать заранее или щелкнув ссылку на странице, где вы добавите целевой объект хранилища BLOB-объектов.

Шаги для добавления ролей RBAC:

1. Откройте страницу **управления доступом (IAM)** для учетной записи хранения. (Ссылка на странице **Добавление целевого объекта хранилища** автоматически открывает эту страницу для выбранной учетной записи.)

1. Щелкните в верхней части страницы и выберите **добавить назначение роли.** **+**

1. Выберите роль "участник учетной записи хранения" из списка.

1. В поле **назначить доступ к** оставьте значение по умолчанию ("пользователь Azure AD, группа или субъект-служба").  

1. В поле **выбора** выполните поиск по запросу "сторажекаче".  Эта строка должна соответствовать одному субъекту безопасности с именем "поставщик ресурсов кэша HPC". Щелкните этот субъект, чтобы выбрать его.

1. Нажмите кнопку **сохранить** , чтобы добавить назначение роли в учетную запись хранения.

1. Повторите эту процедуру, чтобы назначить роль "участник данных BLOB-объекта хранилища".  

![снимок экрана: Добавление графического пользовательского интерфейса назначения ролей](media/hpc-cache-add-role.png)

## <a name="add-a-new-nfs-storage-target"></a>Добавление нового целевого объекта хранилища NFS

В целевом объекте хранилища NFS есть некоторые дополнительные поля, указывающие, как достичь экспорта хранилища и как эффективно кэшировать его данные. Кроме того, можно создать несколько путей к пространству имен с одного узла NFS, если доступно несколько экспортов.

![Снимок экрана: страница добавления целевого объекта хранилища с определенным целевым объектом NFS](media/hpc-cache-add-nfs-target.png)

Укажите эти сведения для целевого объекта хранилища с поддержкой NFS:

* **Имя целевого объекта хранилища** — задайте имя, идентифицирующее этот целевой объект хранилища в кэше HPC Azure.

* **Тип целевого объекта** — выберите **NFS**.

* **Имя узла** — введите IP-адрес или полное доменное имя для системы хранения NFS. (Используйте доменное имя, только если ваш кэш имеет доступ к DNS-серверу, который может разрешить это имя.)

* **Модель использования** — выберите один из профилей кэширования данных на основе рабочего процесса, описанный в разделе [Выбор модели использования ниже](#choose-a-usage-model).

### <a name="nfs-namespace-paths"></a>Пути к пространству имен NFS

Целевой объект хранилища NFS может иметь несколько виртуальных путей, если каждый путь представляет отдельный экспорт или подкаталог в одной системе хранения.

Создайте все пути из одного целевого объекта хранилища.
<!-- You can create multiple namespace paths to represent different exports on the same NFS storage system, but you must create them all from one storage target. -->

Заполните эти значения для каждого пути к пространству имен: 

* **Путь к виртуальному пространству имен** — задает путь к файлу для клиента для этого целевого объекта хранилища. Дополнительные сведения о функции виртуального пространства имен см. в статье [Настройка агрегированного пространства имен](hpc-cache-namespace.md) .

<!--  The virtual path should start with a slash ``/``. -->

* **Путь экспорта NFS** — введите путь к экспорту NFS.

* **Путь к подкаталогу** . Если вы хотите подключить конкретный подкаталог экспорта, введите его здесь. Если нет, оставьте это поле пустым. 

По завершении нажмите кнопку **ОК** , чтобы добавить целевой объект хранилища.

### <a name="choose-a-usage-model"></a>Выбор модели использования
<!-- referenced from GUI - update aka.ms link if you change this heading -->

При создании целевого объекта хранилища, указывающего на систему хранения NFS, необходимо выбрать *модель использования* для этого целевого объекта. Эта модель определяет, как кэшируются данные.

* Высокая скорость чтения. Если вы в основном используете кэш для ускорения доступа на чтение данных, выберите этот параметр. 

* Чтение и запись. Если клиенты используют кэш для чтения и записи, выберите этот параметр.

* Клиенты, минуя кэш — выберите этот параметр, если клиенты записывают данные непосредственно в систему хранения, не записывая их в кэш.

## <a name="next-steps"></a>Следующие шаги

После создания целевых объектов хранилища рассмотрите одну из следующих задач.

* [Mount the Azure HPC Cache](hpc-cache-mount.md) (Подключение Azure HPC Cache)
* [Перемещение данных в хранилище BLOB-объектов Azure](hpc-cache-ingest.md)