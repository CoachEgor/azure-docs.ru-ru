---
title: Обновление целевых объектов хранилища кэша HPC для Azure
description: Как изменить целевые объекты хранилища кэша HPC для Azure
author: ekpgh
ms.service: hpc-cache
ms.topic: how-to
ms.date: 07/02/2020
ms.author: v-erkel
ms.openlocfilehash: f11e12c4f30977514e04b09c7e1c3012eb7888a7
ms.sourcegitcommit: 3d79f737ff34708b48dd2ae45100e2516af9ed78
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/23/2020
ms.locfileid: "87092462"
---
# <a name="edit-storage-targets"></a>Изменение целевых расположений хранилищ

Вы можете удалить или изменить целевой объект хранилища на странице портала **целевых объектов хранилища** кэша или с помощью Azure CLI.

> [!TIP]
> В [видеоролике Управление кэшем Azure HPC](https://azure.microsoft.com/resources/videos/managing-hpc-cache/) показано, как изменить целевой объект хранилища в портал Azure.

## <a name="remove-a-storage-target"></a>Удаление целевого объекта хранилища

### <a name="portal"></a>[Портал](#tab/azure-portal)

Чтобы удалить целевой объект хранилища, выберите его в списке и нажмите кнопку **Удалить** .

### <a name="azure-cli"></a>[Azure CLI](#tab/azure-cli)

[!INCLUDE [cli-reminder.md](includes/cli-reminder.md)]

Чтобы удалить целевой объект хранилища из кэша, используйте команду [AZ HPC-Cache Storage — Remove](/cli/azure/ext/hpc-cache/hpc-cache/storage-target#ext-hpc-cache-az-hpc-cache-storage-target-remove) .

```azurecli
$ az hpc-cache storage-target remove --resource-group cache-rg --cache-name doc-cache0629 --name blob1

{- Finished ..
  "endTime": "2020-07-09T21:45:06.1631571+00:00",
  "name": "2f95eac1-aded-4860-b19c-3f089531a7ec",
  "startTime": "2020-07-09T21:43:38.5461495+00:00",
  "status": "Succeeded"
}
```

---

Это действие удаляет сопоставление целевого объекта хранилища с этой системой кэша HPC Azure, но не изменяет серверную систему хранения. Например, если вы использовали контейнер хранилища BLOB-объектов Azure, контейнер и его содержимое все еще существуют после удаления из кэша. Вы можете добавить контейнер в другой кэш HPC Azure, повторно добавить его в этот кэш или удалить с портал Azure.

Все изменения файлов, хранящиеся в кэше, записываются в систему хранения серверной части перед удалением целевого объекта хранилища. Этот процесс может занять час или более, если в кэше находится большой объем измененных данных.

## <a name="update-storage-targets"></a>Обновление целевых объектов хранилища

Можно изменить целевые объекты хранилища, чтобы изменить некоторые из их свойств. Различные свойства могут быть изменены для разных типов хранилища:

* Для целевых объектов хранилища BLOB-объектов можно изменить путь к пространству имен.

* Для целевых объектов хранилища NFS можно изменить следующие свойства:

  * Путь к пространству имен
  * Модель использования
  * Экспорт
  * Экспорт подкаталога

Нельзя изменить имя, тип или систему хранения серверной части хранилища (контейнер больших двоичных объектов или имя узла или IP-адрес NFS). Если необходимо изменить эти свойства, удалите целевой объект хранилища и создайте замену новым значением.

В портал Azure можно увидеть, какие поля доступны для редактирования, щелкнув имя целевого объекта хранилища и открыв страницу сведений о нем. Целевые объекты хранилища также можно изменить с помощью Azure CLI.

![снимок экрана со страницей "Изменить" для целевого объекта хранилища NFS](media/hpc-cache-edit-storage-nfs.png)

## <a name="update-an-nfs-storage-target"></a>Обновление целевого объекта хранилища NFS

Для целевого объекта хранилища NFS можно обновить несколько свойств. (Пример страницы редактирования см. на снимке экрана выше).

* **Модель использования** . модель использования влияет на то, как кэш будет хранить данные. Дополнительные сведения см. в статье [Выбор модели использования](hpc-cache-add-storage.md#choose-a-usage-model) .
* **Путь к виртуальному пространству имен** — путь, используемый клиентами для подключения этого целевого объекта хранилища. Дополнительные сведения см. [в статье Планирование обобщенного пространства имен](hpc-cache-namespace.md) .
* **Путь экспорта NFS** — экспорт системы хранения, используемый для этого пути к пространству имен.
* **Путь к вложенному каталогу** — подкаталог (под экспортом), связываемый с этим путем к пространству имен. Оставьте это поле пустым, если не нужно указывать подкаталог.

Каждому пути к пространству имен требуется уникальное сочетание экспорта и подкаталога. То есть нельзя создать два разных пути, ориентированных на клиента, в точно тот же каталог в серверной системе хранения данных.

### <a name="portal"></a>[Портал](#tab/azure-portal)

После внесения изменений нажмите кнопку **ОК** , чтобы обновить целевой объект хранилища, или нажмите кнопку **Отмена** , чтобы отменить изменения.

### <a name="azure-cli"></a>[Azure CLI](#tab/azure-cli)

[!INCLUDE [cli-reminder.md](includes/cli-reminder.md)]

Используйте команду [AZ NFS-Storage-Target](/cli/azure/ext/hpc-cache/hpc-cache/nfs-storage-target) , чтобы изменить модель использования, путь к виртуальному пространству имен и значения экспорта или подкаталога NFS для целевого объекта хранилища.

* Чтобы изменить модель использования, используйте ``--nfs3-usage-model`` параметр. Пример: ``--nfs3-usage-model WRITE_WORKLOAD_15``

* Чтобы изменить путь к пространству имен, экспорт или экспорт подкаталога, используйте ``--junction`` параметр.

  ``--junction``Параметр использует следующие значения:

  * ``namespace-path``— Путь к виртуальному файлу клиента.
  * ``nfs-export``— Экспорт системы хранения, связываемый с путем, ориентированным на клиента
  * ``target-path``(необязательно) — подкаталог экспорта (при необходимости).

  Пример: ``--junction namespace-path="/nas-1" nfs-export="/datadisk1" target-path="/test"``

Имя кэша, имя целевого объекта хранилища и группа ресурсов требуются во всех командах обновления.

Пример команды: <!-- having problem testing this -->

```azurecli
az hpc-cache nfs-storage-target update --cache-name mycache \
    --name rivernfs0 --resource-group doc-rg0619 \
    --nfs3-usage-model READ_HEAVY_INFREQ
```

Если кэш остановлен или находится в неработоспособном состоянии, обновление применяется после того, как кэш будет работоспособен.

---

## <a name="update-an-azure-blob-storage-target"></a>Обновление целевого объекта хранилища BLOB-объектов Azure

Для целевого объекта хранилища BLOB-объектов можно изменить путь к виртуальному пространству имен.

### <a name="portal"></a>[Портал](#tab/azure-portal)

Страница сведений для целевого объекта хранилища BLOB-объектов позволяет изменить путь к виртуальному пространству имен.

![снимок экрана со страницей "Изменить" для целевого объекта хранилища BLOB-объектов](media/hpc-cache-edit-storage-blob.png)

По завершении нажмите кнопку **ОК** , чтобы обновить целевой объект хранилища, или кнопку **Отмена** , чтобы отменить изменения.

### <a name="azure-cli"></a>[Azure CLI](#tab/azure-cli)

[!INCLUDE [cli-reminder.md](includes/cli-reminder.md)]

Чтобы обновить путь к пространству имен целевого объекта, используйте команду [AZ HPC-Cache BLOB-хранилище — обновление целевого](/cli/azure/ext/hpc-cache/hpc-cache/blob-storage-target#ext-hpc-cache-az-hpc-cache-blob-storage-target-update) расположения.

```azurecli
az hpc-cache blob-storage-target update --cache-name cache-name --name target-name \
    --resource-group rg --storage-account "/subscriptions/<subscription_ID>/resourceGroups/erinazcli/providers/Microsoft.Storage/storageAccounts/rg"  \
    --container-name "container-name" --virtual-namespace-path "/new-path"
```

Если кэш остановлен или находится в неработоспособном состоянии, обновление будет применено после того, как кэш станет работоспособным.

---

## <a name="next-steps"></a>Дальнейшие действия

* Дополнительные сведения об этих параметрах см. в статье [Добавление целевых объектов хранилища](hpc-cache-add-storage.md) .
* Дополнительные советы по использованию виртуальных путей см. [в статье Планирование обобщенного пространства имен](hpc-cache-namespace.md) .
