---
title: Подключение к FTP-серверу
description: Автоматизировать задачи и рабочие процессы, которые создают, отслеживают и управляют файлами на сервере FTP с помощью приложений Azure Logic Apps
services: logic-apps
ms.suite: integration
ms.reviewer: klam, logicappspm
ms.topic: conceptual
ms.date: 12/15/2019
tags: connectors
ms.openlocfilehash: 5b61b51e79c71736e18aaa63ab032c05c512c8d7
ms.sourcegitcommit: 62c5557ff3b2247dafc8bb482256fef58ab41c17
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/03/2020
ms.locfileid: "80656335"
---
# <a name="create-monitor-and-manage-ftp-files-by-using-azure-logic-apps"></a>Создание и отслеживание FTP-файлов, а также управление ими с помощью Azure Logic Apps

С помощью Azure Logic Apps и соединителя FTP можно создать автоматизированные задачи и рабочие процессы, которые создают, отслеживают, отправляют и получают файлы, а также управляют ими в вашей учетной записи, на сервере FTP. Они также выполняют и другие действия, например:

* мониторинг добавления или изменения файлов;
* получение, создание, копирование, перечисление, обновление и удаление файлов;
* получение содержимого и метаданных файлов;
* извлечение архивов в папки.

Вы можете использовать триггеры, которые получают ответы из сервера FTP и делают выходные данные доступными для других действий. Вы можете использовать действия запуска в своих приложениях логики для управления файлами на сервере FTP. Кроме того, выходные данные от действий FTP могут использоваться другими действиями. Например, если вы регулярно извлекаете файлы с сервера FTP, вы можете отправлять сообщения об этих файлах и их содержимое с помощью соединителя Office 365 Outlook или соединителя Outlook.com. Если вы не знакомы с приложениями логики, ознакомьтесь со статьей [Что такое Azure Logic Apps](../logic-apps/logic-apps-overview.md).

## <a name="limitations"></a>Ограничения

* Разъем FTP поддерживает только явный FTP над TLS/SSL (FTPS) и не совместим с неявной FTPS.

* По умолчанию действия FTP могут читать или писать файлы размером *50 МБ или меньше.* Для обработки файлов больше, чем 50 МБ, действия FTP поддерживают [сообщение chunking.](../logic-apps/logic-apps-handle-large-messages.md) Действие **содержимого файла** Get неявно использует chunking.

* FTP триггеры не поддерживают chunking. При запросе содержимого файла триггеры выбирают только файлы, которые 50 МБ или меньше. Чтобы получить файлы размером более 50 МБ, следуйте приведенному ниже шаблону:

  * Используйте триггер FTP, который возвращает свойства файлов, **например, при добавлении или изменении файла (только свойства).**

  * Следуйте спусковой крючок с FTP **Получить файл содержание** действий, который читает полный файл и неявно использует chunking.

* Если у вас есть внутренний сервер FTP, рассмотрите возможность создания [среды служб интеграции (ISE)](../logic-apps/connect-virtual-network-vnet-isolated-environment-overview.md) или использования [гибридных соединений Службы приложений Azure,](../app-service/app-service-hybrid-connections.md)которые позволяют получить доступ к информационным источникам данных без использования шлюза данных.

## <a name="how-ftp-triggers-work"></a>Как работает FTP-триггеры

FTP запускает работу, опрашивая файловую систему FTP и ища любой файл, который был изменен после последнего опроса. При изменении файлов некоторые средства позволяют сохранить метку времени. В этом случае необходимо отключить эту функцию, чтобы триггер мог работать. Ниже приведены некоторые распространенные параметры:

| Клиент SFTP | Действие |
|-------------|--------|
| Winscp | Перейти к >  **опционам** > **Предпочтения**Передача**Сохранить** > **Edit** > **Timestamp** > **Отключить** |
| FileZilla | Перейти к **передаче** > **Сохранить временные метки переданных файлов** > **отключить** |
|||

Найдя новый файл, триггер проверяет, записан ли файл полностью, а не частично. Например, во время проверки файлового сервера триггером в файл могут вноситься изменения. Чтобы избежать возврата частично записанного файла, триггер отмечает метку времени для файла с последними изменениями и не возвращает его сразу. Он возвращает его только при повторном опросе сервера. Иногда такое поведение может вызвать задержку, которая удваивает интервал опроса триггера.

## <a name="prerequisites"></a>Предварительные требования

* Подписка Azure. Если у вас еще нет подписки Azure, [зарегистрируйтесь для получения бесплатной учетной записи Azure](https://azure.microsoft.com/free/).

* Адрес сервера узла FTP и учетные данные учетной записи

  Для соединителя FTP требуется доступный через Интернет FTP-сервер, который настроен для работы в *пассивном режиме*. Ваши учетные данные позволяют приложению логики создавать подключение и предоставлять доступ к вашей учетной записи FTP.

* Основные знания о [том, как создавать логические приложения](../logic-apps/quickstart-create-first-logic-app-workflow.md)

* Приложение логики, из которого необходимо получить доступ к учетной записи FTP. Чтобы начать работу с триггером FTP, [создайте пустое приложение логики](../logic-apps/quickstart-create-first-logic-app-workflow.md). Чтобы использовать действие FTP, запустите приложение логики с другим триггером, например триггером **Периодичность**.

## <a name="connect-to-ftp"></a>Подключение к FTP

[!INCLUDE [Create connection general intro](../../includes/connectors-create-connection-general-intro.md)]

1. Вопийте на [портале Azure](https://portal.azure.com)и откройте приложение логики в Logic App Designer.

1. Для пустых приложений логики, `ftp` в поле поиска, введите как ваш фильтр. Из списка **триггеров** выберите нужный триггер.

   -или-

   Для существующих логических приложений, под последним шагом, где вы хотите добавить действие, выберите **Новый шаг,** а затем выберите **Добавить действие.** В поле поиска введите `ftp` в качестве фильтра. Из списка **действий** выберите нужное действие.

   Чтобы добавить действие между шагами, переместите указатель на стрелку между шагами. Выберите знак**+** плюс (), который появляется, а затем выберите **Добавить действие.**

1. Предоставьте информацию о подключении и выберите **Создать**.

1. Предоставьте информацию для выбранного триггера или действия и продолжайте строить рабочий процесс приложения логики.

## <a name="examples"></a>Примеры

<a name="file-added-modified"></a>

### <a name="add-ftp-trigger"></a>Добавить триггер FTP

**При добавлении или изменении файла (только для свойств)** триггер запускает рабочий процесс приложения логики, когда триггер обнаруживает, что файл добавлен или изменен на сервере FTP. Например, можно добавить условие, которое проверяет содержимое файла и решает, следует ли получить это содержимое, на основе того, соответствует ли это содержимое определенному условию. Наконец, можно добавить действие, которое получает содержимое файла, и поместить его в другую папку на сервере SFTP.

Например, этот триггер можно использовать для мониторинга папки FTP для новых файлов, описывающие заказы клиентов. Затем можно использовать действие FTP, такое как **метаданные файлов Get,** чтобы получить свойства для этого нового файла, а затем использовать **Содержимое Get file,** чтобы получить содержимое из этого файла для дальнейшей обработки и хранения этого заказа в базе данных заказов.

Вот пример, который показывает, как использовать **при добавлении или изменении файла (только свойства)** триггера.

1. Войдите на [портал Azure](https://portal.azure.com) и откройте свое приложение логики в конструкторе приложений логики, если оно еще не открыто.

1. Для пустых приложений логики, `ftp` в поле поиска, введите как ваш фильтр. Под списком триггеров выберите этот триггер: **При добавлении или изменении заявки (только свойства)**

   ![Найти и выбрать триггер FTP](./media/connectors-create-api-ftp/select-ftp-trigger-logic-app.png)

1. Предоставьте необходимые сведения для подключения, а затем выберите **Create.**

   По умолчанию этот соединитель передает файлы в текстовом формате. Для передачи файлов в двоичном формате, например, когда и где используется кодирование, выберите **Binary Transport** (Двоичная транспортировка).

   ![Создание соединения с FTP-сервером](./media/connectors-create-api-ftp/create-ftp-connection-trigger.png)

1. В поле **Folder** выберите значок папки так, чтобы появился список. Чтобы найти папку, которую вы хотите контролировать для новых**>** или отредактированных файлов, выберите стрелку под прямым углом (), просмотрев эту папку, а затем выберите папку.

   ![Найдите и выберите папку для отслеживания](./media/connectors-create-api-ftp/select-folder-ftp-trigger.png)

   Выбранная папка отображается в поле **Folder**.

   ![Выбранная папка отображается в свойстве "Folder"](./media/connectors-create-api-ftp/selected-folder-ftp-trigger.png)

1. Сохраните приложение логики. На панели инструментов конструктора щелкните **Сохранить**.

После того как логическое приложение получило триггер, добавьте действия, которые необходимо запустить, когда логическое приложение находит новый или отредактированный файл. В этом примере вы можете добавить действие FTP, которое получает новое или обновленное содержимое.

<a name="get-content"></a>

### <a name="add-ftp-action"></a>Добавить действие FTP

Действие **метаданных файла** получает свойства для файла, который находится на вашем сервере FTP, и действие **Содержимого файла получает** содержимое файла на основе информации об этом файле на вашем сервере FTP. Например, можно добавить триггер из предыдущего примера и эти действия, чтобы получить содержимое файла после добавления или редактирования этого файла.

1. Под спусковым крючком или любыми другими действиями выберите **новый шаг.**

1. В поле поиска введите `ftp` в качестве фильтра. Под списком действий выберите это действие: **Получите метаданные файлов**

   ![Выберите действие "Получить метаданные файла"](./media/connectors-create-api-ftp/select-get-file-metadata-ftp-action.png)

1. Если у вас уже есть соединение с вашим FTP-сервером и учетной записью, перейдите к следующему шагу. В противном случае предоставьте необходимые сведения для этого соединения, а затем выберите **Create.**

   ![Создание подключения к FTP-серверу](./media/connectors-create-api-ftp/create-ftp-connection-action.png)

1. После того, как появится действие **метаданных файлов Get,** щелкните внутри **файла,** чтобы отображается список динамических содержимого. Теперь можно выбрать свойства для выходных данных из предыдущих шагов. В динамическом списке содержимого, под **метаданными файлов Get,** выберите **свойство «Список файлов id»,** в котором отсылается коллекция, в которой файл был добавлен или обновлен.

   ![Найти и выбрать свойство "Список идентификатора файлов"](./media/connectors-create-api-ftp/select-list-of-files-id-output.png)

   **Список** свойств Файлов Id теперь отображается в **файле.**

   ![Выбранное свойство "Список идентификатора файлов"](./media/connectors-create-api-ftp/selected-list-file-ids-ftp-action.png)

1. Теперь добавьте это действие FTP: **Получить содержимое файла**

   ![Найти и выбрать действие "Получить содержимое файла"](./media/connectors-create-api-ftp/select-get-file-content-ftp-action.png)

1. После того, как появится действие **содержимого файла** Get, щелкните внутри **файла,** чтобы отображается список динамических содержимого. Теперь можно выбрать свойства для выходных данных из предыдущих шагов. В динамическом списке содержимого под **метаданными файлов Get**выберите свойство **Id,** которое ссылается на добавленный или обновленный файл.

   ![Найти и выбрать свойство "Id"](./media/connectors-create-api-ftp/get-file-content-id-output.png)

   Свойство **Id** теперь отображается в поле **файла.**

   ![Выбранное свойство "Id"](./media/connectors-create-api-ftp/selected-get-file-content-id-ftp-action.png)

1. Сохраните приложение логики.

## <a name="test-your-logic-app"></a>Тестирование приложения логики

Чтобы проверить, возвращает ли ваш рабочий процесс ожидаемое содержимое, добавьте еще одно действие, которое отправляет вам содержимое из загруженного или обновленного файла.

1. В рамках действия **Get File content** добавьте действие, которое может отправить вам содержимое файла. Этот пример добавляет действие **Отправить сообщение по электронной почте** для Office 365 Outlook.

   ![Добавить действие для отправки электронной почты](./media/connectors-create-api-ftp/select-send-email-action.png)

1. После отоступления действия предоставьте информацию и включите свойства, которые вы хотите проверить. Например, включите свойство **содержимого файла,** которое появляется в списке динамического содержимого после выбора **Подробнее** в разделе **Содержимое файла Get.**

   ![Предоставление сведений о действии электронной почты](./media/connectors-create-api-ftp/selected-send-email-action.png)

1. Сохраните приложение логики. Чтобы запустить и вызвать приложение логики, на панели инструментов, выберите **Выполнить,** а затем добавить файл в папку FTP, что ваше приложение логики теперь контролирует.

## <a name="connector-reference"></a>Справочник по соединителям

Для получения более подробной информации об этом разъеме, таких как триггеры, действия и ограничения, описанные в файле Swagger разъема, смотрите [страницу ссылки разъема.](https://docs.microsoft.com/connectors/ftpconnector/)

> [!NOTE]
> Для логических приложений в [среде служб интеграции (ISE)](../logic-apps/connect-virtual-network-vnet-isolated-environment-overview.md)эта версия с маркировкой ISE разъема использует вместо этого [ограничения сообщений ISE.](../logic-apps/logic-apps-limits-and-config.md#message-size-limits)

## <a name="next-steps"></a>Дальнейшие действия

* См. дополнительные сведения о других [соединителях Logic Apps](../connectors/apis-list.md).
