---
title: Подключение к FTP-серверу — Azure Logic Apps
description: Создавайте, контролируйте файлы на сервере FTP и управляйте ими с помощью Azure Logic Apps.
services: logic-apps
ms.service: logic-apps
ms.suite: integration
author: ecfan
ms.author: estfan
manager: carmonm
ms.reviewer: divswa, klam, LADocs
ms.topic: conceptual
ms.date: 06/19/2019
tags: connectors
ms.openlocfilehash: ac6ae1a3b00a4e7568bd7967105f202fbf2e4f9b
ms.sourcegitcommit: a678f00c020f50efa9178392cd0f1ac34a86b767
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/26/2019
ms.locfileid: "74547487"
---
# <a name="create-monitor-and-manage-ftp-files-by-using-azure-logic-apps"></a>Создание и отслеживание FTP-файлов, а также управление ими с помощью Azure Logic Apps

С помощью Azure Logic Apps и соединителя FTP можно создать автоматизированные задачи и рабочие процессы, которые создают, отслеживают, отправляют и получают файлы, а также управляют ими в вашей учетной записи, на сервере FTP. Они также выполняют и другие действия, например:

* мониторинг добавления или изменения файлов;
* получение, создание, копирование, перечисление, обновление и удаление файлов;
* получение содержимого и метаданных файлов.
* извлечение архивов в папки.

Вы можете использовать триггеры, которые получают ответы из сервера FTP и делают выходные данные доступными для других действий. Вы можете использовать действия запуска в своих приложениях логики для управления файлами на сервере FTP. Кроме того, выходные данные от действий FTP могут использоваться другими действиями. Например, если вы регулярно извлекаете файлы с сервера FTP, вы можете отправлять сообщения об этих файлах и их содержимое с помощью соединителя Office 365 Outlook или соединителя Outlook.com. Если вы не знакомы с приложениями логики, ознакомьтесь со статьей [Что такое Azure Logic Apps](../logic-apps/logic-apps-overview.md).

## <a name="limits"></a>Ограничения

* Соединитель FTP поддерживает только явный FTP через SSL (FTPS) и не совместим с неявным FTPS.

* По умолчанию действия FTP могут считывать или записывать файлы размером *50 МБ или меньше*. Для работы с файлами, размер которых превышает 50 МБ, действия FTP поддерживают [фрагментацию сообщений](../logic-apps/logic-apps-handle-large-messages.md). Действие **получить содержимое файла** неявно использует фрагментацию.

* Триггеры FTP не поддерживают фрагментацию. При запросе содержимого файла триггеры выбирают только файлы размером 50 МБ или меньше. Чтобы получить файлы размером более 50 МБ, следуйте приведенному ниже шаблону:

  * Используйте триггер FTP, возвращающий свойства файла, например **при добавлении или изменении файла (только свойства)** .

  * Выполните триггер с действием FTP **Get File Content** , которое считывает полный файл и неявно использует фрагментацию.

## <a name="how-ftp-triggers-work"></a>Как работают триггеры FTP

Триггеры FTP работают путем опроса файловой системы FTP и поиска файла, который был изменен с момента последнего опроса. При изменении файлов некоторые средства позволяют сохранить метку времени. В этом случае необходимо отключить эту функцию, чтобы триггер мог работать. Ниже приведены некоторые распространенные параметры:

| Клиент SFTP | Действия |
|-------------|--------|
| Winscp | Выберите **Параметры** > **Настройки** > **Перенос** > **Изменить** > **Сохранение метки времени** > **Отключить** |
| FileZilla | Выберите **Перенос** > **Preserve timestamps of transferred files** (Сохранение метки времени перенесенных файлов)  > **Отключить**. |
|||

Найдя новый файл, триггер проверяет, записан ли файл полностью, а не частично. Например, во время проверки файлового сервера триггером в файл могут вноситься изменения. Чтобы избежать возврата частично записанного файла, триггер отмечает метку времени для файла с последними изменениями и не возвращает его сразу. Он возвращает его только при повторном опросе сервера. Иногда такое поведение может вызвать задержку, которая удваивает интервал опроса триггера.

## <a name="prerequisites"></a>Технические условия

* Подписка Azure. Если у вас еще нет подписки Azure, [зарегистрируйтесь для получения бесплатной учетной записи Azure](https://azure.microsoft.com/free/).

* Адрес сервера узла FTP и учетные данные учетной записи

  Для соединителя FTP требуется доступный через Интернет FTP-сервер, который настроен для работы в *пассивном режиме*. Ваши учетные данные позволяют приложению логики создавать подключение и предоставлять доступ к вашей учетной записи FTP.

* Базовые знания [создания приложений логики](../logic-apps/quickstart-create-first-logic-app-workflow.md).

* Приложение логики, из которого необходимо получить доступ к учетной записи FTP. Чтобы начать работу с триггером FTP, [создайте пустое приложение логики](../logic-apps/quickstart-create-first-logic-app-workflow.md). Чтобы использовать действие FTP, запустите приложение логики с другим триггером, например триггером **Периодичность**.

## <a name="connect-to-ftp"></a>Подключение к FTP

[!INCLUDE [Create connection general intro](../../includes/connectors-create-connection-general-intro.md)]

1. Войдите на [портал Azure](https://portal.azure.com) и откройте свое приложение логики в конструкторе приложений логики, если оно еще не открыто.

1. Для пустых приложений логики в поле поиска в качестве фильтра введите ftp. В списке триггеров выберите нужный триггер.

   -или-

   В имеющихся приложениях логики на последнем шаге, в котором необходимо добавить действие, выберите **Новый шаг**, а затем нажмите **Добавить действие**. В поле поиска введите слово ftp в качестве фильтра. В списке действий выберите любое необходимое действие.

   Чтобы добавить действие между шагами, переместите указатель на стрелку между шагами. Выберите отображаемый знак «плюс» ( **+** ) и щелкните **Добавить действие**.

1. Укажите необходимые сведения для вашего подключения, а затем выберите **Создать**.

1. Укажите необходимые сведения для выбранного триггера или действия и продолжайте создание рабочего процесса приложения логики.

## <a name="examples"></a>Примеры

<a name="file-added-modified"></a>

### <a name="ftp-trigger-when-a-file-is-added-or-modified"></a>Триггер FTP. When a file is added or modified (При добавлении или изменении файла)

Если этот триггер обнаруживает, что на сервере FTP добавлен или изменен файл, он запускает рабочий процесс приложения логики. Так, например, вы можете добавить условие, которое проверяет содержимое файла и решает, получать ли его, в зависимости от того, соответствует ли содержимое указанному условию. Наконец, вы можете добавить действие, которое получает содержимое файла и помещает его в папку на сервере SFTP.

**Пример Enterprise**. Этот триггер можно использовать для наблюдения за папкой FTP для новых файлов, описывающих заказы клиентов. Также вы можете использовать действие FTP **Получить содержимое файла**, чтобы получить содержимое заказа для дальнейшей обработки и хранения этого заказа в базе данных заказов.

Вот пример, который показывает этот триггер: **Когда файл добавлен или изменен**

1. Войдите на [портал Azure](https://portal.azure.com) и откройте свое приложение логики в конструкторе приложений логики, если оно еще не открыто.

1. Для пустых приложений логики в поле поиска в качестве фильтра введите ftp. В списке триггеров выберите триггер **Когда добавляется или изменяется файл — FTP**

   ![Найдите и выберите триггер FTP](./media/connectors-create-api-ftp/select-ftp-trigger.png)  

1. Укажите необходимые сведения для вашего подключения, а затем выберите **Создать**.

   По умолчанию этот соединитель передает файлы в текстовом формате. Для передачи файлов в двоичном формате, например, где и когда используется кодировка, выберите **двоичный транспорт**.

   ![Создание подключения к FTP-серверу](./media/connectors-create-api-ftp/create-ftp-connection-trigger.png)  

1. Выберите значок папки рядом с полем **Folder**, чтобы отобразить список. Чтобы найти эту папку, чтобы отслеживать для новых или измененных файлов, щелкните кнопку со стрелкой вправо ( **>** ), перейдите к этой папке и выберите ее.

   ![Найдите и выберите папку для отслеживания](./media/connectors-create-api-ftp/select-folder.png)  

   Выбранная папка отображается в поле **Folder**.

   ![Выбранная папка](./media/connectors-create-api-ftp/selected-folder.png)  

После того как логическое приложение получило триггер, добавьте действия, которые необходимо запустить, когда логическое приложение находит новый или отредактированный файл. В этом примере вы можете добавить действие FTP, которое получает новое или обновленное содержимое.

<a name="get-content"></a>

### <a name="ftp-action-get-content"></a>Действие FTP: получить содержимое

Это действие получает содержимое из файла на FTP-сервере, при добавлении или обновлении этого файла. Например, вы можете добавить триггер из предыдущего примера и действие, которое получает содержимое файла после добавления или редактирования этого файла.

Ниже приведен пример, демонстрирующий это действие: **получить содержимое**

1. В разделе "Триггер" или "Другие действия" выберите **Новый шаг**.

1. В поле поиска введите слово ftp в качестве фильтра. В списке действий выберите действие **Получить содержимое файла (FTP)**

   ![Выбор действия FTP](./media/connectors-create-api-ftp/select-ftp-action.png)  

1. Если у вас уже есть соединение с вашим FTP-сервером и учетной записью, перейдите к следующему шагу. В противном случае укажите необходимые сведения для подключения, а затем выберите **Создать**.

   ![Создание подключения к FTP-серверу](./media/connectors-create-api-ftp/create-ftp-connection-action.png)

1. После открытия действия **Получить содержимое файла** щелкните поле **Файл**, чтобы отобразить список динамического содержимого. Теперь можно выбрать свойства для выходных данных из предыдущих шагов. В списке динамического содержимого выберите свойство **Содержимое файла**, которое содержит добавленные или обновленные файлы.  

   ![Поиск и выбор файла](./media/connectors-create-api-ftp/ftp-action-get-file-content.png)

   **Содержимое файла** теперь отображается в поле**Файл**.

   ![Выбранное свойство "Содержимое файла"](./media/connectors-create-api-ftp/ftp-action-selected-file-content-property.png)

1. Сохраните приложение логики. Чтобы протестировать рабочий процесс, добавьте файл в папку FTP, которую теперь отслеживает ваше логическое приложение.

## <a name="connector-reference"></a>Справочник по соединителям

Технические сведения о триггерах, действиях и ограничениях, которые описаны в описании OpenAPI (ранее — Swagger) соединителя, см. на [странице справочника по соединителю](/connectors/ftpconnector/).

## <a name="next-steps"></a>Дальнейшие действия

* См. дополнительные сведения о других [соединителях Logic Apps](../connectors/apis-list.md).