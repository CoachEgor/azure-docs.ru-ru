---
title: Подключение к FTP-сервер — Azure Logic Apps
description: Создавайте, контролируйте файлы на сервере FTP и управляйте ими с помощью Azure Logic Apps.
services: logic-apps
ms.service: logic-apps
ms.suite: integration
author: ecfan
ms.author: estfan
ms.reviewer: divswa, klam, LADocs
ms.topic: article
ms.date: 06/19/2019
tags: connectors
ms.openlocfilehash: 66f1d726dcfa1a077abbff0d9f028036db43cc25
ms.sourcegitcommit: 2d3b1d7653c6c585e9423cf41658de0c68d883fa
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/20/2019
ms.locfileid: "67293091"
---
# <a name="create-monitor-and-manage-ftp-files-by-using-azure-logic-apps"></a>Создание и отслеживание FTP-файлов, а также управление ими с помощью Azure Logic Apps

С помощью Azure Logic Apps и соединителя FTP можно создать автоматизированные задачи и рабочие процессы, которые создают, отслеживают, отправляют и получают файлы, а также управляют ими в вашей учетной записи, на сервере FTP. Они также выполняют и другие действия, например:

* мониторинг добавления или изменения файлов;
* получение, создание, копирование, перечисление, обновление и удаление файлов;
* получение содержимого и метаданных файлов;
* извлечение архивов в папки.

Вы можете использовать триггеры, которые получают ответы из сервера FTP и делают выходные данные доступными для других действий. Вы можете использовать действия запуска в своих приложениях логики для управления файлами на сервере FTP. Кроме того, выходные данные от действий FTP могут использоваться другими действиями. Например, если вы регулярно извлекаете файлы с сервера FTP, вы можете отправлять сообщения об этих файлах и их содержимое с помощью соединителя Office 365 Outlook или соединителя Outlook.com. Если вы не знакомы с приложениями логики, ознакомьтесь со статьей [Что такое Azure Logic Apps](../logic-apps/logic-apps-overview.md).

## <a name="limits"></a>Ограничения

* Соединитель FTP поддерживает только явные FTP через SSL (FTPS) и не поддерживает неявную конфигурацию FTPS.

* По умолчанию действия FTP можно считывать или записывать файлы, которые являются *50 МБ или меньше*. Для обработки файлов, размер которых превышает 50 МБ, FTP-поддержка действий [фрагментацию сообщения](../logic-apps/logic-apps-handle-large-messages.md). **Получить содержимое файла** действие неявно использует фрагментации.

* Триггеры FTP не поддерживает фрагментацию. При запросе содержимого файла, триггеры выберите только те файлы, которые являются 50 МБ или меньше. Чтобы получить файлы размером более 50 МБ, следуйте приведенному ниже шаблону:

  * Использование триггера FTP, возвращающего свойства файла, например **при добавлении или изменении (только свойства) файла**.

  * Триггер с помощью FTP, выполните **получить содержимое файла** действие, которое считывает полный файл и неявно использует фрагментации.

## <a name="how-ftp-triggers-work"></a>Как FTP активирует работы

Работа триггеры FTP путем опроса FTP файловой системы и ищете любой файл, который был изменен с момента последнего опроса. При изменении файлов некоторые средства позволяют сохранить метку времени. В этом случае необходимо отключить эту функцию, чтобы триггер мог работать. Ниже приведены некоторые распространенные параметры:

| Клиент SFTP | Действие |
|-------------|--------|
| Winscp | Выберите **Параметры** > **Настройки** > **Перенос** > **Изменить** > **Сохранение метки времени** > **Отключить** |
| FileZilla | Выберите **Перенос** > **Preserve timestamps of transferred files** (Сохранение метки времени перенесенных файлов)  > **Отключить**. |
|||

Найдя новый файл, триггер проверяет, записан ли файл полностью, а не частично. Например, во время проверки файлового сервера триггером в файл могут вноситься изменения. Чтобы избежать возврата частично записанного файла, триггер отмечает метку времени для файла с последними изменениями и не возвращает его сразу. Он возвращает его только при повторном опросе сервера. Иногда такое поведение может вызвать задержку, которая удваивает интервал опроса триггера.

## <a name="prerequisites"></a>Технические условия

* Подписка Azure. Если у вас еще нет подписки Azure, [зарегистрируйтесь для получения бесплатной учетной записи Azure](https://azure.microsoft.com/free/).

* Адрес сервера узла FTP и учетные данные учетной записи

  Для соединителя FTP требуется доступный через Интернет FTP-сервер, который настроен для работы в *пассивном режиме*. Ваши учетные данные позволяют приложению логики создавать подключение и предоставлять доступ к вашей учетной записи FTP.

* Базовые знания [создания приложений логики](../logic-apps/quickstart-create-first-logic-app-workflow.md).

* Приложение логики, из которого необходимо получить доступ к учетной записи FTP. Чтобы начать работу с триггером FTP, [создайте пустое приложение логики](../logic-apps/quickstart-create-first-logic-app-workflow.md). Чтобы использовать действие FTP, запустите приложение логики с другим триггером, например триггером **Периодичность**.

## <a name="connect-to-ftp"></a>Подключение к FTP

[!INCLUDE [Create connection general intro](../../includes/connectors-create-connection-general-intro.md)]

1. Войдите на [портал Azure](https://portal.azure.com) и откройте свое приложение логики в конструкторе приложений логики, если оно еще не открыто.

1. Для пустых приложений логики в поле поиска в качестве фильтра введите ftp. В списке триггеров выберите нужный триггер.

   -или-

   В имеющихся приложениях логики на последнем шаге, в котором необходимо добавить действие, выберите **Новый шаг**, а затем нажмите **Добавить действие**. В поле поиска введите слово ftp в качестве фильтра. В списке действий выберите любое необходимое действие.

   Чтобы добавить действие между шагами, переместите указатель на стрелку между шагами. Нажмите знак плюса ( **+** ), находящуюся и выберите **добавить действие**.

1. Укажите необходимые сведения для вашего подключения, а затем выберите **Создать**.

1. Укажите необходимые сведения для выбранного триггера или действия и продолжайте создание рабочего процесса приложения логики.

## <a name="examples"></a>Примеры

<a name="file-added-modified"></a>

### <a name="ftp-trigger-when-a-file-is-added-or-modified"></a>Триггер FTP: When a file is added or modified (При добавлении или изменении файла)

Если этот триггер обнаруживает, что на сервере FTP добавлен или изменен файл, он запускает рабочий процесс приложения логики. Так, например, вы можете добавить условие, которое проверяет содержимое файла и решает, получать ли его, в зависимости от того, соответствует ли содержимое указанному условию. Наконец, вы можете добавить действие, которое получает содержимое файла и помещает его в папку на сервере SFTP.

**Пример Enterprise**. Вы можете использовать этот триггер, чтобы отслеживать папку FTP на наличие новых файлов, представляющих заказы клиентов. Также вы можете использовать действие FTP **Получить содержимое файла**, чтобы получить содержимое заказа для дальнейшей обработки и хранения этого заказа в базе данных заказов.

Ниже указан пример, в котором продемонстрирован триггер: **When a file is added or modified**

1. Войдите на [портал Azure](https://portal.azure.com) и откройте свое приложение логики в конструкторе приложений логики, если оно еще не открыто.

1. Для пустых приложений логики в поле поиска в качестве фильтра введите ftp. В списке триггеров выберите триггер: **When a filed is added or modified — FTP** (При добавлении или изменении файла — FTP)

   ![Найдите и выберите триггер FTP](./media/connectors-create-api-ftp/select-ftp-trigger.png)  

1. Укажите необходимые сведения для вашего подключения, а затем выберите **Создать**.

   По умолчанию этот соединитель передает файлы в текстовом формате. Для передачи файлов в двоичном файле форматирования, например, where и если используется кодировка, выберите **двоичный транспорт**.

   ![Создание подключения к FTP-серверу](./media/connectors-create-api-ftp/create-ftp-connection-trigger.png)  

1. Выберите значок папки рядом с полем **Folder**, чтобы отобразить список. Чтобы найти эту папку, чтобы отслеживать для новых или измененных файлов, щелкните кнопку со стрелкой вправо ( **>** ), перейдите к этой папке и выберите ее.

   ![Найдите и выберите папку для отслеживания](./media/connectors-create-api-ftp/select-folder.png)  

   Выбранная папка отображается в поле **Folder**.

   ![Выбранная папка](./media/connectors-create-api-ftp/selected-folder.png)  

После того как логическое приложение получило триггер, добавьте действия, которые необходимо запустить, когда логическое приложение находит новый или отредактированный файл. В этом примере вы можете добавить действие FTP, которое получает новое или обновленное содержимое.

<a name="get-content"></a>

### <a name="ftp-action-get-content"></a>Действие FTP. Получить содержимое

Это действие получает содержимое из файла на FTP-сервере, при добавлении или обновлении этого файла. Например, вы можете добавить триггер из предыдущего примера и действие, которое получает содержимое файла после добавления или редактирования этого файла.

Ниже указан пример, в котором продемонстрировано действие: **получение содержимого**.

1. В разделе "Триггер" или "Другие действия" выберите **Новый шаг**.

1. В поле поиска введите слово ftp в качестве фильтра. В списке действий выберите действие **Get file content — FTP** (Получить содержимое файла — FTP)

   ![Выбор действия FTP](./media/connectors-create-api-ftp/select-ftp-action.png)  

1. Если у вас уже есть соединение с вашим FTP-сервером и учетной записью, перейдите к следующему шагу. В противном случае укажите необходимые сведения для подключения, а затем выберите **Создать**.

   ![Создание подключения к FTP-серверу](./media/connectors-create-api-ftp/create-ftp-connection-action.png)

1. После открытия действия **Получить содержимое файла** щелкните поле **Файл**, чтобы отобразить список динамического содержимого. Теперь можно выбрать свойства для выходных данных из предыдущих шагов. В списке динамического содержимого выберите свойство **Содержимое файла**, которое содержит добавленные или обновленные файлы.  

   ![Поиск и выбор файла](./media/connectors-create-api-ftp/ftp-action-get-file-content.png)

   **Содержимое файла** теперь отображается в поле**Файл**.

   ![Выбранное свойство "Содержимое файла"](./media/connectors-create-api-ftp/ftp-action-selected-file-content-property.png)

1. Сохраните приложение логики. Чтобы протестировать рабочий процесс, добавьте файл в папку FTP, которую теперь отслеживает ваше логическое приложение.

## <a name="connector-reference"></a>Справочник по соединителям

Дополнительные технические сведения о триггерах, действиях и ограничения, которые описаны соединителя OpenAPI (прежнее название — Swagger) описания, просмотрите [соединителя справочной странице](/connectors/ftpconnector/).

## <a name="next-steps"></a>Дальнейшие действия

* См. дополнительные сведения о других [соединителях Logic Apps](../connectors/apis-list.md).
