---
title: Планирование и выполнение рабочих процессов и задач с помощью Azure Logic Apps | Документация Майкрософт
description: Автоматизация запланированных и периодических задач с помощью соединителя повторения в Azure Logic Apps
services: logic-apps
ms.service: logic-apps
ms.suite: integration
author: ecfan
ms.author: estfan
ms.reviewer: klam, LADocs
ms.assetid: 51dd4f22-7dc5-41af-a0a9-e7148378cd50
tags: connectors
ms.topic: article
ms.date: 01/08/2019
ms.openlocfilehash: eb22539d1f433e396935f82e4cb3786d5699d21a
ms.sourcegitcommit: 3102f886aa962842303c8753fe8fa5324a52834a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "60447519"
---
# <a name="create-and-run-recurring-tasks-and-workflows-with-azure-logic-apps"></a>Создание и выполнение повторяющихся задач и рабочих процессов с помощью Azure Logic Apps

Для планирования регулярно выполняемых действий, рабочих нагрузок или процессов создайте рабочий процесс приложения логики, который запускается [триггером](../logic-apps/logic-apps-overview.md#logic-app-concepts) **Расписание — повторение**. Вы можете задать дату и время начала рабочего процесса и расписание повторения для выполнения следующих задач и многих других.

* Получение внутренних данных: ежедневный [запуск хранимой процедуры SQL](../connectors/connectors-create-api-sqlazure.md).
* Получение внешних данных: получение сводки о погоде от NOAA каждые 15 минут.
* Сообщение данных: отправление по почте сводки всех заказов за прошлую неделю, которые превышают определенную сумму.
* Обработка данных: сжатие переданных изображений каждый день в часы наименьшей нагрузки.
* Очистка данных: удаление всех твитов старше трех месяцев.
* Архивация данных: ежемесячное создание резервной копии счетов.

Этот триггер поддерживает множество шаблонов, например:

* Незамедлительное выполнение и повторение каждые *n* секунд, минут, часов, дней, недель или месяцев.
* Запуск в определенное время, а затем запуск и повторение каждые *n* секунд, минут, часов, дней, недель или месяцев.
* Запуск и повторение один или несколько раз каждый день, например в 8:00 или 17:00.
* Запуск и повторение каждую неделю, но только в определенные дни, например в субботу и воскресенье.
* Запуск и повторение каждую неделю, но только в определенные дни и время, например с понедельника по пятницу с 8:00 до 17:00.

При каждом срабатывании триггера повторения Logic Apps создает и выполняет экземпляр рабочего процесса приложения логики. 

Чтобы активировать приложение логики и выполнять его только один раз в будущем, ознакомьтесь с разделом [Выполнение заданий только один раз](#run-once) далее в этой статье.

## <a name="prerequisites"></a>Технические условия

* Подписка Azure. Если у вас нет подписки, вы можете [создать бесплатную пробную версию учетной записи Azure](https://azure.microsoft.com/free/). В противном случае вы можете [зарегистрироваться на получение подписки с оплатой по мере использования](https://azure.microsoft.com/pricing/purchase-options/).

* Базовые знания [создания приложений логики](../logic-apps/quickstart-create-first-logic-app-workflow.md). 

## <a name="add-a-recurrence-trigger-to-your-logic-app"></a>Добавление триггера повторения в приложение логики

1. Войдите на [портале Azure](https://portal.azure.com). Создайте пустое приложение логики. Сведения о создании пустого приложения логики см. в [этой статье](../logic-apps/quickstart-create-first-logic-app-workflow.md).

2. После появления конструктора Logic Apps под полем поиска выберите **Все**. В поле поиска введите слово "повторение" в качестве фильтра. В списке триггеров выберите триггер: **Recurrence — Schedule** (Повторение — запланированное). 

   ![Выбор триггера "Recurrence — Schedule" (Повторение — запланированное)](./media/connectors-native-recurrence/add-recurrence-trigger.png)

   Этот триггер теперь является первым шагом в приложении логики.

3. Задайте интервал повторения и единицу времени. В этом примере задайте запуск рабочего процесса каждый день. 

   ![Установка интервала и частоты](./media/connectors-native-recurrence/recurrence-trigger-details.png)

4. Чтобы просмотреть дополнительные параметры планирования, выберите **Show advanced options** (Показать дополнительные параметры). 

   ![Дополнительные параметры](./media/connectors-native-recurrence/recurrence-trigger-more-options.png)

5. Теперь можно задать следующие параметры: 

   * Задайте дату и время, когда триггер будет срабатывать. 
   Если вы указали дату и время начала, можно также применить часовой пояс. 

   * Если для частоты установлено значение "День" или "Неделя", можно выбрать определенное время повторения. 

   * Если выбрано значение Week, вы также можете выбрать определенные дни недели.
   
   ![Расширенные параметры планирования](./media/connectors-native-recurrence/recurrence-trigger-more-options-details.png)

   Например, предположим, что сегодня понедельник, 4 сентября 2017 г. 
   Следующий триггер повторения сработает *не раньше*, чем наступит дата и время начала, которыми являются понедельник, 18 сентября 2017 г., в 8:00 по тихоокеанскому времени. 
   Тем не менее для расписания повторения заданы значения 10:30, 12:30 и 14:30 только по понедельникам. Таким образом, впервые триггер срабатывает и создает экземпляр рабочего процесса приложения логики в 10:30. 
   Дополнительные сведения о времени начала см. в этих [примерах](#start-time).
   Последующие запуски будут выполняться в 12:30 и 14:30 в тот же день. 
   Каждое повторение создает собственный экземпляр рабочего процесса. После этого весь этот процесс повторяется снова в следующий понедельник. 
   [*Какие еще существуют примеры повторений?*](#example-recurrences)

   ![Расширенный пример планирования](./media/connectors-native-recurrence/recurrence-trigger-more-options-advanced-schedule.png)

   > [!NOTE]
   > Триггер отображает предварительную версию определенного повторения, только если в качестве частоты установлено значение "День" или "Неделя".
   
6. Теперь можно создать оставшийся рабочий процесс с действиями или инструкциями управления потоком. Дополнительные сведения о действиях, которые можно добавить, см. в статье [Список соединителей](../connectors/apis-list.md). 

## <a name="trigger-details"></a>Сведения о триггере

Эти свойства можно настроить для триггера повторения.

| Name | Обязательно для заполнения | Имя свойства | type | ОПИСАНИЕ | 
|----- | -------- | ------------- | ---- | ----------- | 
| **Frequency** | Yes | frequency | String | Единица измерения времени, используемая для повторения: **Second** (секунда), **Minute** (минута), **Hour** (час), **Day** (день), **Week** (неделя) или **Month** (месяц). | 
| **Интервал** | Yes | interval | Целое число  | Положительное целое число, которое описывает, как часто выполняется рабочий процесс с учетом заданной частоты. <p>Значение по умолчанию — 1. Ниже приведены минимальный и максимальный интервалы. <p>— Месяц: 1–16 месяцев. </br>— День: 1–500 дней. </br>— Час: 1–12 000 часов. </br>— Минута: 1–72 000 минут. </br>— Секунда: 1–9 999 999 секунд.<p>Например, если интервал равен 6, а значение частоты — "Месяц", то повтор будет происходить каждые 6 месяцев. | 
| **Часовой пояс** | Нет  | timeZone | String | Применяется только при указании времени начала, так как этот триггер не принимает [смещение от UTC](https://en.wikipedia.org/wiki/UTC_offset). Выберите часовой пояс, который необходимо применить. | 
| **Время начала** | Нет  | startTime | String | Укажите время начала в следующем формате: <p>ГГГГ-ММ-ДДTчч:мм:сс, если выбран часовой пояс <p>-или- <p>ГГГГ-ММ-ДДTчч:мм:ссZ, если часовой пояс не выбран. <p>Например, если требуется указать 18 сентября 2017 г. в 14:00, то используйте 2017-09-18T14:00:00 и выберите часовой пояс, например "Тихоокеанское время". Или укажите 2017-09-18T14:00:00Z без часового пояса. <p>**Примечание.** Это время начала должно соответствовать [спецификации даты и времени ISO 8601](https://en.wikipedia.org/wiki/ISO_8601#Combined_date_and_time_representations) в [формате UTC](https://en.wikipedia.org/wiki/Coordinated_Universal_Time), но без [смещения от UTC](https://en.wikipedia.org/wiki/UTC_offset). Если вы не выберите часовой пояс, то необходимо в конце добавить букву Z без пробелов. Эта буква Z ссылается на соответствующее [судовое время](https://en.wikipedia.org/wiki/Nautical_time). <p>В простых расписаниях время начала определяет первый случай выполнения задания, а в сложных расписаниях триггер срабатывает не раньше, чем наступит время начала. [*Как можно использовать дату и время начала?*](#start-time) | 
| **В эти дни** | Нет  | weekDays | Строка или массив строк | Если вы выбрали значение Week, вы можете выбрать один или больше дней, когда необходимо выполнять рабочий процесс: **Monday** (понедельник), **Tuesday** (вторник), **Wednesday** (среда), **Thursday** (четверг), **Friday** (пятница), **Saturday** (суббота) и **Sunday** (воскресенье). | 
| **В эти часы** | Нет  | hours | Целое число или массив целых чисел | Если вы выбрали значение "День" или "Неделя", то можно выбрать одно или несколько целых чисел от 0 до 23. В эти часы будет запускаться рабочий процесс. <p>Например, если указать 10, 12 и 14, вы получите часовые метки 10:00, 12:00 и 14:00. | 
| **В эти минуты** | Нет  | minutes | Целое число или массив целых чисел | Если вы выбрали значение "День" или "Неделя", то можно выбрать одно или несколько целых чисел от 0 до 59. В эти минуты часа будет запускаться рабочий процесс. <p>Например, если указать 30 минут и использовать предыдущий пример для часов, то вы получите 10:30, 12:30 и 14:30. | 
||||| 

## <a name="json-example"></a>Пример JSON-файла

Пример [определения триггера повторения](../logic-apps/logic-apps-workflow-actions-triggers.md#recurrence-trigger):

``` json
"triggers": {
   "Recurrence": {
      "type": "Recurrence",
      "recurrence": {
         "frequency": "Week",
         "interval": 1,
         "schedule": {
            "hours": [
               10,
               12,
               14
            ],
            "minutes": [
               30
            ],
            "weekDays": [
               "Monday"
            ]
         },
         "startTime": "2017-09-07T14:00:00",
         "timeZone": "Pacific Standard Time"
      }
   }
}
```

## <a name="faq"></a>Часто задаваемые вопросы

<a name="run-once"></a>

**Вопрос.** Что делать, если хотите выполнить приложение логики только один раз в будущем? </br>
**Ответ.** Чтобы вызвать приложение логики и выполнить его один раз без повтора, можно использовать шаблон **Scheduler: Run once jobs** (Планировщик: одноразовые задания). После создания приложения логики, но перед открытием конструктора Logic Apps, в разделе **Шаблоны** в списке **Категория** выберите **Расписание**, а затем — шаблон:

![Выбор шаблона "Scheduler: Run once jobs" (Планировщик: одноразовые задания).](./media/connectors-native-recurrence/choose-run-once-template.png)

Если вы используете пустой шаблон приложения логики, запустите свое приложение логики с помощью триггера **При получении HTTP-запроса — запрос**. Передайте время запуска триггера в качестве параметра. На следующем шаге добавьте действие **Delay until — Schedule** (Задержка до — расписание) и предоставьте время начала следующего выполнения действия.

<a name="example-recurrences"></a>

**Вопрос.** Какие еще существуют примеры расписания повторений? </br>
**Ответ.** Ниже приведены некоторые примеры.

| Периодичность | Interval | Frequency | Время начала | В эти дни | В эти часы | В эти минуты | Примечание |
| ---------- | -------- | --------- | ---------- | ------------- | -------------- | ---------------- | ---- |
| Выполняется каждые 15 минут (нет даты и времени начала) | 15 | Минута | {нет} | {недоступно} | {нет} | {нет} | Это расписание начинается немедленно, а затем вычисляются будущие повторения на основе последнего времени выполнения. | 
| Выполняется каждые 15 минут (с датой и временем начала) | 15 | Минута | *startDate*T*startTime*Z | {недоступно} | {нет} | {нет} | Выполнение расписания начнется *не раньше*, чем наступит дата и время начала. Затем будут вычислены будущие повторения на основе последнего времени выполнения. | 
| Выполняется с наступлением каждого часа (с датой и временем начала) | 1 | Hour | *startDate*Thh:00:00Z | {недоступно} | {нет} | {нет} | Выполнение расписания начнется *не раньше*, чем наступит дата и время начала. Будущие повторения выполняются каждый час в 00 минут. <p>Если для частоты задано "Неделя" или "Месяц", это расписание соответственно выполняется один раз в неделю или в месяц. | 
| Выполняется каждый час, каждый день (нет даты и времени начала) | 1 | Hour | {нет} | {недоступно} | {нет} | {нет} | Это расписание начинается немедленно, а затем вычисляются будущие повторения на основе последнего времени выполнения. <p>Если для частоты задано "Неделя" или "Месяц", это расписание соответственно выполняется один раз в неделю или в месяц. | 
| Выполняется каждый час, каждый день (с датой и временем начала) | 1 | Hour | *startDate*T*startTime*Z | {недоступно} | {нет} | {нет} | Выполнение расписания начнется *не раньше*, чем наступит дата и время начала. Затем будут вычислены будущие повторения на основе последнего времени выполнения. <p>Если для частоты задано "Неделя" или "Месяц", это расписание соответственно выполняется один раз в неделю или в месяц. | 
| Выполняется через 15 минут после наступления каждого часа (с датой и временем начала) | 1 | Hour | *startDate*T00:15:00Z | {недоступно} | {нет} | {нет} | Выполнение расписания начнется *не раньше*, чем наступит дата и время начала. Выполняется в 00:15, 1:15, 2:15 и т. д. | 
| Выполняется через 15 минут после наступления каждого часа (нет даты и времени начала) | 1 | День | {нет} | {недоступно} | 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23 | 15 | Расписание выполняется в 00:15, 1:15, 2:15 и т. д. Кроме того, это расписание эквивалентно частоте "Час" и времени начала 15 минут. | 
| Выполняется каждые 15 минут с меткой времени 15 минут (нет даты и времени начала) | 1 | День | {нет} | {недоступно} | 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23 | 0, 15, 30, 45 | Выполнение расписания начнется не раньше следующей указанной метки времени 15 минут. | 
| Выполняется в 8:00 каждый день (нет даты и времени начала) | 1 | День | {нет} | {недоступно} | 8 | {нет} | Расписание выполняется в 8:00 каждый день по указанному расписанию. | 
| Выполняется в 8:00 каждый день (с датой и временем начала) | 1 | День | *startDate*T08:00:00Z | {недоступно} | {нет} | {нет} | Расписание выполняется в 8:00 каждый день в указанное время начала. | 
| Выполняется в 8:30 каждый день (нет даты и времени начала) | 1 | День | {нет} | {недоступно} | 8 | 30 | Расписание выполняется в 8:30 каждый день по указанному расписанию. | 
| Выполняется в 8:30 каждый день (с датой и временем начала) | 1 | День | *startDate*T08:30:00Z | {недоступно} | {нет} | {нет} | Выполнение расписания начинается в указанную дату начала в 8:30. | 
| Выполняется каждый день в 8:30 и 16:30. | 1 | День | {нет} | {недоступно} | 8, 16 | 30 | | 
| Выполняется каждый день в 8:30, 8:45, 16:30 и 16:45. | 1 | День | {нет} | {недоступно} | 8, 16 | 30, 45 | | 
| Выполняется каждую субботу в 17:00 (нет даты и времени начала) | 1 | Неделя | {нет} | Суббота | 17 | 00 | Расписание выполняется каждую субботу в 17:00. | 
| Выполняется каждую субботу в 17: 00 (с датой и временем начала) | 1 | Неделя | *startDate*T17:00:00Z | Суббота | {нет} | {нет} | Выполнение расписания начнется *не раньше*, чем наступит дата и время начала. В этом случае 9 сентября 2017 г. в 17:00. Будущие повторения выполняются каждую субботу в 17:00. | 
| Выполняется каждый вторник и четверг в 17:00 | 1 | Неделя | {нет} | Вторник, четверг | 17 | {нет} | Расписание выполняется каждый вторник и четверг в 17:00. | 
| Выполнять каждый час в рабочее время | 1 | Неделя | {нет} | Выберите все дни, кроме субботы и воскресенья. | Выберите необходимые часы дня. | Выберите необходимое минуты часа. | Например, если ваше рабочее время с 8:00 до 17:00, выберите 8, 9, 10, 11, 12, 13, 14, 15, 16, 17 в качестве часов дня. <p>Если ваше рабочее время с 8:30 до 17:30, выберите предыдущие часы дня и добавьте 30 в качестве минут часа. | 
| Выполняется один раз в день в выходные дни | 1 | Неделя | {нет} | Суббота, воскресенье | Выберите необходимые часы дня. | Выберите необходимые минуты часа. | Расписание выполняется каждую субботу и воскресенье по указанной схеме. | 
| Выполняется каждые 15 минут, каждые две недели только по понедельникам | 2 | Неделя | {нет} | Понедельник | 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23 | 0, 15, 30, 45 | Это расписание выполняется каждый второй понедельник каждые 15 минут. | 
| Выполнять каждый час один день в месяц | 1 | Месяц | {см. примечание} | {недоступно} | 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23 | {см. примечание} | Если не указать дату и время начала, это расписание использует дату и время создания. Чтобы контролировать минуты расписания повторения, укажите минуты часа, время начала или используйте время создания. Например, если время начала или создания — 8:25, расписание выполняется в 8:25, 9:25, 10:25 и т. д. | 
||||||||| 

<a name="start-time"></a>

**Вопрос.** Как можно использовать дату и время начала? </br>
**Ответ.** Ниже приведены некоторые шаблоны, показывающие, как можно управлять повторением, используя дату и время начала, а также как обработчик Logic Apps выполняет эти повторения.

| Время начала | Повторение без расписания | Повторение с расписанием | 
| ---------- | --------------------------- | ------------------------ | 
| {нет} | Выполняет первую рабочую нагрузку мгновенно. <p>Выполняет будущие рабочие нагрузки на основе последнего времени выполнения. | Выполняет первую рабочую нагрузку мгновенно. <p>Выполняет будущие рабочие нагрузки по указанному расписанию. | 
| Время начала в прошлом | Вычисляет время выполнения на основе указанного времени начала и отклоняет время выполнения в прошлом. Выполняет первую рабочую нагрузку при последующем времени выполнения. <p>Выполняет будущие рабочие нагрузки на основе вычисления последнего времени выполнения. <p>Чтобы получить дополнительные сведения, ознакомьтесь с примерами под этой таблицей. | Выполняет первую рабочую нагрузку *не раньше* времени начала на основе расписания, которое отсчитывается от времени начала. <p>Выполняет будущие рабочие нагрузки по указанному расписанию. <p>**Примечание.** Если указать повторение с расписанием, но не указать часы или минуты расписания, то будущее время выполнения вычисляется с помощью часов или минут первого времени выполнения соответственно. | 
| Текущее или будущее время выполнения | Выполняет первую рабочую нагрузку в указанное время начала. <p>Выполняет будущие рабочие нагрузки на основе вычисления последнего времени выполнения. | Выполняет первую рабочую нагрузку *не раньше* времени начала на основе расписания, которое отсчитывается от времени начала. <p>Выполняет будущие рабочие нагрузки по указанному расписанию. <p>**Примечание.** Если указать повторение с расписанием, но не указать часы или минуты расписания, то будущее время выполнения вычисляется с помощью часов или минут первого времени выполнения соответственно. | 
||||

**Примеры для времени начала в прошлом с повторением, но без расписания** 

| Время начала | Текущее время | Периодичность | Расписание |
| ---------- | ------------ | ---------- | -------- | 
| 2017-09-**07**T14:00:00Z | 2017-09-**08**T13:00:00Z | Каждые 2 дня | {нет} | 
||||| 

В этом сценарии обработчик Logic Apps вычисляет время выполнения на основе времени начала, отклоняет время выполнения в прошлом и использует последующее время начала для первого выполнения. После первого выполнения последующие выполнения производятся по расписанию, которое отсчитывается от времени начала. Вот как выглядит это повторение:

| Время начала | Первое время выполнения | Последующее время выполнения | 
| ---------- | ------------ | ---------- | 
| 2017-09-**07** в 14:00 | 2017-09-**09** в 14:00 | 2017-09-**11** в 14:00 </br>2017-09-**13** в 14:00 </br>2017-09-**15** в 14:00 </br>и т. д.
||||

Поэтому для этого сценария, независимо от того, насколько далеко в прошлом вы указали время начала, например 2017-09-**05** в 14:00 или 2017-09-**01** в 14:00, ваше первое время выполнения будет одинаковым.

## <a name="next-steps"></a>Дальнейшие действия

* [Действия и триггеры рабочего процесса](../logic-apps/logic-apps-workflow-actions-triggers.md#recurrence-trigger)
* [Соединители](../connectors/apis-list.md)
