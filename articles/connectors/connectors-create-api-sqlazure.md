---
title: Подключение к базе данных S'L-сервера или базы данных Azure S'L
description: Автоматизировать задачи для баз данных S'L в помещениях или в облаке с помощью приложений Azure Logic Apps
services: logic-apps
ms.suite: integration
ms.reviewer: klam; logicappspm
ms.topic: conceptual
ms.date: 11/08/2019
tags: connectors
ms.openlocfilehash: 93b63d332f00c31a352c11e483fc3ce5cb45a922
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/27/2020
ms.locfileid: "74789207"
---
# <a name="automate-workflows-for-sql-server-or-azure-sql-database-by-using-azure-logic-apps"></a>Автоматизировать рабочие процессы для сервера S'L или базы данных Azure S'L с помощью приложений логики Azure

В этой статье описано, как получить доступ к данным в базе данных SQL из приложения логики с помощью соединителя SQL Server. Таким образом, можно автоматизировать задачи, процессы или рабочие процессы, которые управляют данными и ресурсами s'L, создавая логические приложения. Разъем сервера S'L работает как для [внутреннего сервера S'L,](https://docs.microsoft.com/sql/sql-server/sql-server-technical-documentation) так и для [облачной базы данных Azure S'L.](https://docs.microsoft.com/azure/sql-database/sql-database-technical-overview)

Вы можете создавать приложения логики, которые активируются событиями в базе данных SQL или в других системах, таких как Dynamics CRM Online. Приложения с логикой также могут получать, вставлять и удалять данные вместе с выполнением запросов и сохраненных процедур. Например, можно создать логическое приложение, которое автоматически проверяет новые записи в Dynamics CRM Online, добавляет элементы в базу данных S'L для любых новых записей, а затем отправляет оповещения по электронной почте о добавленных элементах.

Если вы не работали с приложениями логики, см. руководства по [Azure Logic Apps](../logic-apps/logic-apps-overview.md) и [созданию первого приложения логики](../logic-apps/quickstart-create-first-logic-app-workflow.md). Для получения специальной технической информации, ограничений [SQL Server connector reference page](https://docs.microsoft.com/connectors/sql/)и известных проблем см.

## <a name="prerequisites"></a>Предварительные требования

* Подписка Azure. Если у вас нет ее, вы можете [зарегистрироваться для получения бесплатной учетной записи Azure](https://azure.microsoft.com/free/).

* [База данных сервера S'L](https://docs.microsoft.com/sql/relational-databases/databases/create-a-database) или [база данных Azure S'L](../sql-database/sql-database-get-started-portal.md)

  Чтобы при вызове операций приложение логики могло вернуть результаты, таблицы должны содержать данные. Если вы создаете базу данных SQL Azure, вы также можете использовать предоставляемые примеры баз данных.

* Имя сервера SQL, имя базы данных, а также имя пользователя и пароль. Эти учетные данные используются для авторизации приложения логики и получения доступа к серверу SQL.

  * Для Базы данных SQL Server эти сведения можно найти в строке подключения:

    `Server={your-server-address};Database={your-database-name};User Id={your-user-name};Password={your-password};`

  * Для Базы данных Azure SQL эти сведения можно найти в строке подключения или на портале Azure в свойствах базы данных SQL:

    `Server=tcp:{your-server-name}.database.windows.net,1433;Initial Catalog={your-database-name};Persist Security Info=False;User ID={your-user-name};Password={your-password};MultipleActiveResultSets=False;Encrypt=True;TrustServerCertificate=False;Connection Timeout=30;`

* Локальный [шлюз данных,](../logic-apps/logic-apps-gateway-install.md) установленный на локальном компьютере, и [ресурс шлюза данных Azure, созданный на портале Azure](../logic-apps/logic-apps-gateway-connection.md) для следующих сценариев:

  * Ваши логические приложения не работают в [среде интеграционных служб (ISE).](../logic-apps/connect-virtual-network-vnet-isolated-environment-overview.md)

  * Ваши логические приложения *работают* в среде служб интеграции, но для подключения к серверу S'L необходимо использовать windows. Для этого сценария используйте разъем разъем сервера S'L, не являющийся ISE, а также шлюз данных, поскольку версия ISE не поддерживает аутентификацию Windows.

* Приложения логики с возможностью доступа к базе данных SQL. Чтобы запустить приложение логики с помощью триггера SQL, требуется [пустое приложение логики](../logic-apps/quickstart-create-first-logic-app-workflow.md).

<a name="add-sql-trigger"></a>

## <a name="add-a-sql-trigger"></a>Добавление триггера S'L

В Azure Logic Apps каждое приложение логики должно запускаться по [триггеру](../logic-apps/logic-apps-overview.md#logic-app-concepts), который активируется, когда происходит определенное событие или если выполняются заданные условия. Каждый раз, когда срабатывает триггер, движок Logic Apps создает экземпляр приложения логики и запускает рабочий процесс приложения логики.

1. На портале Azure или в Visual Studio создайте пустое приложение логики. Откроется конструктор Logic Apps. В этом примере используется портал Azure.

1. На дизайнере, в поле поиска, введите "sql сервер" в качестве фильтра. В списке триггеров выберите нужный триггер SQL.

   В этом примере используется триггер **при создании элемента.**

   ![Выберите триггер "Когда создается элемент"](./media/connectors-create-api-sqlazure/select-sql-server-trigger.png)

1. Если вам предложено создать соединение, [создайте соединение s'L сейчас.](#create-connection) Если соединение существует, выберите **имя таблицы**.

   ![Выберите захотевную таблицу](./media/connectors-create-api-sqlazure/azure-sql-database-table.png)

1. Задайте **интервал** и **частоту**, с которыми приложение логики будет проверять таблицу.

   Этот триггер возвращает только одну строку из выбранной таблицы, ничего больше. Для выполнения других задач добавьте другие действия, выполняющие захотете задач. Например, для просмотра данных в этой строке можно добавить другие действия, которые создают файл, который включает поля из возвращенной строки, а затем отправить оповещения по электронной почте. Чтобы узнать о других доступных действиях для этого разъема, смотрите [страницу ссылки разъема.](https://docs.microsoft.com/connectors/sql/)

1. Когда вы закончите, на панели инструментов дизайнера, выберите **Сохранить**.

   Этот шаг автоматически включает и публикует приложение логики в Azure в реальном времени.

<a name="add-sql-action"></a>

## <a name="add-a-sql-action"></a>Добавить действие S'L

В Azure Logic Apps [действие](../logic-apps/logic-apps-overview.md#logic-app-concepts) — это шаг в рамках рабочего процесса, выполняемый после срабатывания триггера или другого действия. В этом примере приложение логики запускается при срабатывании [триггера повторения](../connectors/connectors-native-recurrence.md). Оно вызывает действие, которое получает строку из базы данных SQL.

1. На портале Azure или в Visual Studio откройте приложение логики в конструкторе Logic Apps. В этом примере используется портал Azure.

1. Под триггером или действием, в котором вы хотите добавить действие S'L, выберите **Новый шаг.**

   ![Добавление нового шага в приложение логики](./media/connectors-create-api-sqlazure/select-new-step-logic-app.png)

   Чтобы добавить действие между существующими шагами, наведите указатель мыши на соединяющую стрелку. Выберите знак**+** плюс (), который появляется, а затем выберите **Добавить действие.**

1. При **выборе действия,** в поле поиска, введите "sql сервер" в качестве фильтра. Из списка действий выберите захотевано действие s'L.

   В этом примере используется действие **строки Get,** которое получает одну запись.

   ![Найдите и выберите действие «Получить строку»](./media/connectors-create-api-sqlazure/find-select-sql-get-row-action.png)

   Это действие возвращает только одну строку из выбранной таблицы, ничего больше. Для просмотра данных в этой строке можно добавить другие действия, которые создают файл, включающий поля из возвращенной строки, и хранить этот файл в учетной записи облачного хранилища. Чтобы узнать о других доступных действиях для этого разъема, смотрите [страницу ссылки разъема.](https://docs.microsoft.com/connectors/sql/)

1. Если вам предложено создать соединение, [создайте соединение s'L сейчас.](#create-connection) Если соединение существует, выберите **имя таблицы**и введите **идентификатор строки** для записи, которую вы хотите.

   ![Ввод имени таблицы и идентификатора строки](./media/connectors-create-api-sqlazure/specify-table-row-id-property-value.png)

1. Когда вы закончите, на панели инструментов дизайнера, выберите **Сохранить**.

   Этот шаг автоматически включает и публикует приложение логики в Azure в реальном времени.

<a name="create-connection"></a>

## <a name="connect-to-your-database"></a>Подключение к базе данных

[!INCLUDE [Create connection general intro](../../includes/connectors-create-connection-general-intro.md)]

[!INCLUDE [Create a connection to SQL Server or Azure SQL Database](../../includes/connectors-create-api-sqlazure.md)]

## <a name="handle-bulk-data"></a>Обработка объемных данных

Иногда приходится работать с наборами результатов настолько большими, что разъем не возвращает все результаты одновременно, или вы хотите лучше контролировать размер и структуру для наборов результатов. Вот несколько способов, которые можно обрабатывать такие большие наборы результатов:

* Чтобы помочь вам управлять результатами в виде небольших наборов, включите *pagination.* Для получения дополнительной информации [см. Получить объемные данные, записи и элементы с помощью pagination](../logic-apps/logic-apps-exceed-default-page-size-with-pagination.md).

* Создайте сохраненную процедуру, которая организует результаты так, как вы хотите.

  При получении или вставке нескольких строк приложение логики может итерировать эти строки, используя [*цикл до цикла*](../logic-apps/logic-apps-control-flow-loops.md#until-loop) в пределах этих [ограничений.](../logic-apps/logic-apps-limits-and-config.md) Однако, когда приложение логики должно работать с наборами записей настолько большими, например, тысячами или миллионами строк, что необходимо свести к минимуму затраты, связанные с вызовами в базу данных.

  Чтобы организовать результаты так, как вы хотите, можно создать [*сохраненную процедуру,*](https://docs.microsoft.com/sql/relational-databases/stored-procedures/stored-procedures-database-engine) которая выполняется в экземпляре S'L и использует выписку **SELECT - ORDER BY.** Это решение позволяет управлять размером и структурой полученных результатов. Приложение логики вызывает хранимую процедуру с помощью действия **выполнения хранимой процедуры** соединителя SQL Server.

  Для получения более подробной информации о решении см.

  * [Разбиение на страницы в SQL для массовой передачи данных с помощью Logic Apps](https://social.technet.microsoft.com/wiki/contents/articles/40060.sql-pagination-for-bulk-data-transfer-with-logic-apps.aspx)

  * [SELECT — предложение ORDER BY](https://docs.microsoft.com/sql/t-sql/queries/select-order-by-clause-transact-sql)

## <a name="connector-specific-details"></a>Сведения о соединителях

Для получения технической информации о триггерах, действиях и ограничениях этого разъема смотрите [страницу ссылки разъема.](https://docs.microsoft.com/connectors/sql/)

## <a name="next-steps"></a>Дальнейшие действия

* Узнайте о других [разъемах для приложений логики Azure](../connectors/apis-list.md)
