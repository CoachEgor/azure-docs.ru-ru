---
title: Подключение к серверу IBM M
description: Отправка и получение сообщений с помощью сервера Azure или внутреннего сервера IBM M и приложений логики Azure
services: logic-apps
ms.suite: integration
author: ChristopherHouser
ms.author: chrishou
ms.reviewer: valthom, logicappspm
ms.topic: article
ms.date: 03/31/2020
tags: connectors
ms.openlocfilehash: 737c5b90b216156ca08346f4a64fd0b421ad6c19
ms.sourcegitcommit: 27bbda320225c2c2a43ac370b604432679a6a7c0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/31/2020
ms.locfileid: "80410246"
---
# <a name="connect-to-an-ibm-mq-server-from-azure-logic-apps"></a>Подключение к серверу IBM МЗ из приложений логики Azure

Разъем IBM M' отправляет и извлекает сообщения, хранящиеся на сервере IBM M' в помещениях или в Azure. Этот соединитель включает в себя клиент Microsoft MQ для взаимодействия с удаленным сервером IBM MQ по сети TCP/IP. В этой статье содержится стартовое руководство по использованию разъема МЗ. Вы можете начать с просмотра одного сообщения в очереди, а затем попробовать другие действия.

Разъем IBM M's включает в себя эти действия, но не предоставляет триггеров:

- Просмотрите одно сообщение без удаляния сообщения с сервера IBM M.
- Просматривайте пакет сообщений без удаляния сообщений с сервера IBM M.
- Получите одно сообщение и удалите сообщение с сервера IBM M.
- Получайте пакет сообщений и удаляйте сообщения с сервера IBM M.
- Отправить одно сообщение на сервер IBM M.'.

Вот официально поддерживаемые версии IBM WebSphere M:

  * MQ 7.5
  * MQ 8.0
  * МЗ 9,0

## <a name="prerequisites"></a>Предварительные требования

* Если вы используете наемный сервер МЗ, [установите шлюз данных](../logic-apps/logic-apps-gateway-install.md) на сервере в вашей сети. Сервер, на котором установлен внутренний шлюз данных, также должен иметь .NET Framework 4.6, установленный для работы разъема МЗ.

  После завершения установки шлюза необходимо создать ресурс в Azure для шлюза данных. Для получения дополнительной информации [см.](../logic-apps/logic-apps-gateway-connection.md)

  Если ваш сервер МЗ является общедоступным или доступным в Azure, вам не нужно использовать шлюз данных.

* Логическое приложение, где вы хотите добавить действие МЗ. Это приложение логики должно использовать то же место, что и подключение шлюза к локальным данным, и уже должно иметь триггер, который запускает рабочий процесс.

  Разъем МЗ не имеет никаких триггеров, поэтому сначала необходимо добавить триггер в приложение логики. Например, можно использовать триггер Recurrence. Если вы новичок в логических приложениях, попробуйте этот [быстрый запуск, чтобы создать свое первое приложение логики.](../logic-apps/quickstart-create-first-logic-app-workflow.md)

<a name="create-connection"></a>

## <a name="create-mq-connection"></a>Создание соединения МЗ

Если при добавлении действия МЗ у вас еще нет подключения к МЗ, вам предлагается создать соединение, например:

![Предоставление информации о подключении](media/connectors-create-api-mq/connection-properties.png)

1. Если вы подключаетесь к предприимительному серверу МЗ, выберите **Connect через шлюз данных.**

1. Предоставьте информацию о подключении для вашего сервера МЗ.

   * В поле **Сервер** укажите имя сервера MQ или введите IP-адрес, после него поставьте двоеточие, а затем укажите номер порта.

   * Для использования безопасных разъемов слой (SSL), выберите **Включить SSL?**.

     В настоящее время разъем МЗ поддерживает только проверку подлинности сервера, а не проверку подлинности клиента. Для получения дополнительной информации [см.](#connection-problems)

1. В разделе **шлюз** выполните следующие действия:

   1. Из списка **подписки** выберите подписку Azure, связанную с ресурсом шлюза Azure.

   1. Из списка **шлюзов подключения** выберите ресурс шлюза Azure, который вы хотите использовать.

1. Когда все будет готово, выберите **Создать**.

<a name="connection-problems"></a>

### <a name="connection-and-authentication-problems"></a>Проблемы подключения и аутентификации

При попытке подключения к вашему наемным серверу M-сервера может возникнуть ошибка:

`"MQ: Could not Connect the Queue Manager '<queue-manager-name>': The Server was expecting an SSL connection."`

* Если вы используете разъем МЗ непосредственно в Azure, серверу МЗ необходимо использовать сертификат, выданный доверенным [органом сертификата.](https://www.ssl.com/faqs/what-is-a-certificate-authority/)

* Если вы используете шлюз данных, попробуйте использовать сертификат, который выдается доверенным [органом сертификата,](https://www.ssl.com/faqs/what-is-a-certificate-authority/) когда это возможно. Однако, если эта опция невозможна, можно использовать сертификат, подписанный самостоятельно, который не выдается доверенным [органом сертификата](https://www.ssl.com/faqs/what-is-a-certificate-authority/) и считается менее безопасным.

  Для установки сертификата, подписанного самим сервером, можно использовать инструмент **«Менеджер сертификации Windows»** (certmgr.msc). Для этого сценария на локальном компьютере, где работает служба шлюза локальных данных, необходимо установить сертификат в хранилище **сертификатов локального компьютера** на уровне **Trusted Root Certification Authorities.**

  1. На компьютере, где работает служба шлюза на припредении данных, откройте меню «Пуск», найдите и выберите **сертификаты пользователя Manage.**

  1. После открытия инструмента менеджера сертификации Windows перейдите в **папку «Сертификаты - местные органы** >  по**сертификации** корней в области компьютера» и установите сертификат.

     > [!IMPORTANT]
     > Убедитесь, что вы устанавливаете сертификат в **сертификаты - Местный компьютер** > **Trusted Root Сертификация органов** магазина.

* Сервер МЗ требует, чтобы вы определили спецификацию шифра, которую вы хотите использовать для SSL-соединений. Однако SsLStream в .NET не позволяет указать заказ на спецификации шифра. Чтобы обойти это ограничение, можно изменить конфигурацию сервера МЗ, чтобы соответствовать первой спецификации шифра в наборе, который разъем отправляет в переговорах SSL.

  При попытке подключения сервер МЗ регистрирует сообщение события, указывав о стомоте соединения, поскольку другой конец использовал неправильную спецификацию шифра. Сообщение события содержит спецификацию шифра, которая отображается первой в списке. Обновление спецификации шифра в конфигурации канала, чтобы соответствовать спецификации шифра в сообщении события.

## <a name="browse-single-message"></a>Просмотр одного сообщения

1. В приложении логики под триггером или другим действием выберите **новый шаг.**

1. В поле поиска `mq`введите и выберите действие **сообщения «Просмотр».**

   ![Выберите действие "Просмотр сообщения"](media/connectors-create-api-mq/browse-message.png)

1. Если вы еще не создали соединение МЗ, вам предлагается [создать это соединение.](#create-connection)

1. После создания соединения настройте свойства действия **сообщения Browse:**

   | Свойство | Описание |
   |----------|-------------|
   | **Очередь** | Если она отличается от очереди, указанной в соединении, укажите эту очередь. |
   | **MessageId**, **CorrelationId,** **GroupId**и другие свойства | Просмотр сообщения, основанного на различных свойствах m-сообщений |
   | **ВключитьИнфо** | Чтобы включить дополнительную информацию о сообщениях в вывод, выберите **истину.** Чтобы опустить дополнительную информацию о сообщении в выводе, выберите **ложное**. |
   | **Времени ожидания** | Введите значение, чтобы определить, сколько времени ждать сообщения, чтобы прибыть в пустую очередь. Если это значение не задано, то извлекается первое сообщение в очереди, и, следовательно, время на ожидание сообщения не тратится. |
   |||

   Пример:

   ![Свойства для действий "Просмотр сообщения"](media/connectors-create-api-mq/browse-message-properties.png)

1. Когда вы закончите, на панели инструментов дизайнера, выберите **Сохранить**. Чтобы протестировать приложение, выберите **Выполнить**.

   После завершения выполнения дизайнер показывает шаги рабочего процесса и их состояние, чтобы можно было просмотреть вывод.

1. Чтобы просмотреть сведения о каждом шаге, щелкните заголовок шага. Чтобы просмотреть более подробную информацию о выходе шага, выберите **Показать необработанные выходы.**

   ![Просмотр сообщения: выходные данные](media/connectors-create-api-mq/browse-message-output.png)

   Вот некоторые образцы сырья выход:

   ![Просмотр сообщения: необработанные выходные данные](media/connectors-create-api-mq/browse-message-raw-output.png)

1. Если вы **установите IncludeInfo** на **истину,** дополнительный выход отображается:

   ![Просмотр сообщения: IncludeInfo](media/connectors-create-api-mq/browse-message-include-info.png)

## <a name="browse-multiple-messages"></a>Просмотр нескольких сообщений

Действие **сообщений «Просмотр»** включает опцию **BatchSize,** чтобы указать, сколько сообщений нужно вернуть из очереди. Если **BatchSize** не имеет значения, все сообщения возвращаются. Возвращаемые выходные данные представляют собой массив сообщений.

1. Следуйте предыдущим шагам, но вместо этого добавьте действие **сообщений «Обзор».**

1. Если вы еще не создали соединение МЗ, вам предлагается [создать это соединение.](#create-connection) В противном случае по умолчанию используется первое ранее настроенное соединение. Чтобы создать новое соединение, выберите **соединение Изменения.** Или выберите другое соединение.

1. Предоставьте информацию для действия.

1. Сохранить и запустить логическое приложение.

   После завершения работы приложения логики приведены в действие, вот некоторые выходные примеры из действия **сообщений Browse:**

   ![Пример вывода "Сообщения просмотра"](media/connectors-create-api-mq/browse-messages-output.png)

## <a name="receive-single-message"></a>Получение одного сообщения

Действие **Получить сообщение** имеет такие входные и выходные данные, что и действие **Browse message** (Просмотреть сообщение). При использовании **сообщения Receive**сообщение удаляется из очереди.

## <a name="receive-multiple-messages"></a>Получение нескольких сообщений

Действие **Получить сообщения** имеет такие входные и выходные данные, что и действие **Browse messages** (Просмотреть сообщения). При использовании **сообщений Receive**сообщения удаляются из очереди.

> [!NOTE]
> При запуске просмотра или получения действия в очереди, которая не имеет никаких сообщений, действие завершается сбой с этим выводом:
>
> ![Ошибка "без сообщения"](media/connectors-create-api-mq/mq-no-message-error.png)

## <a name="send-message"></a>Отправить сообщение

1. Следуйте предыдущим шагам, но вместо этого добавьте действие **сообщения «Отправить».**

1. Если вы еще не создали соединение МЗ, вам предлагается [создать это соединение.](#create-connection) В противном случае по умолчанию используется первое ранее настроенное соединение. Чтобы создать новое соединение, выберите **соединение Изменения.** Или выберите другое соединение.

1. Предоставьте информацию для действия. Для **MessageType**выберите действительный тип сообщения: **Datagram,** **Ответ**или **Запрос**

   ![Свойства для "Отправить сообщение действий"](media/connectors-create-api-mq/send-message-properties.png)

1. Сохранить и запустить логическое приложение.

   После завершения работы приложения логики приведены в действие, вот некоторые выходные примеры из действия **отправки сообщений:**

   ![Вывод примера "Отправить сообщение"](media/connectors-create-api-mq/send-message-output.png)

## <a name="connector-reference"></a>Справочник по соединителям

Для получения технических сведений о действиях и ограничениях, описанных в описании Swagger разъема, просмотрите [справочную страницу](/connectors/mq/)разъема.

## <a name="next-steps"></a>Следующие шаги

* См. дополнительные сведения о других [соединителях Logic Apps](../connectors/apis-list.md).
