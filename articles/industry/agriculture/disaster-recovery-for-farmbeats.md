---
title: Аварийное восстановление для FarmBeats
description: В этой статье описывается, как восстановление данных защищает от потери данных.
author: uhabiba04
ms.topic: article
ms.date: 04/13/2020
ms.author: v-umha
ms.openlocfilehash: fbda28ce588aad5f6bc0d89de60069c4220fa523
ms.sourcegitcommit: 8dc84e8b04390f39a3c11e9b0eaf3264861fcafc
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/13/2020
ms.locfileid: "81266179"
---
# <a name="disaster-recovery-for-farmbeats"></a>Аварийное восстановление для FarmBeats

Восстановление данных защищает вас от потери данных в случае, например, в сворачивании региона Azure. В таком случае можно начать сбой и восстановить данные, хранящиеся в развертывании FarmBeats.

Восстановление данных не является функцией по умолчанию в Azure FarmBeats. Эту функцию можно настроить вручную, нанастройки необходимых ресурсов Azure, которые используются FarmBeats для хранения данных в парном регионе Azure. Используйте Active - Пассивный подход для обеспечения восстановления.

В следующих разделах приводится информация о том, как можно настроить процесс восстановления данных в Azure FarmBeats:

- [Включить избыточность данных](#enable-data-redundancy)
- [Восстановление сервиса из резервного копирования в режиме онлайн](#restore-service-from-online-backup)


## <a name="enable-data-redundancy"></a>Включить избыточность данных

FarmBeats хранит данные в трех службах первой партии Azure, которые являются **хранилищем Azure,** **Cosmos DB** и **Time Series Insights.** Используйте следующие шаги, чтобы включить избыточность данных для этих служб в парную область Azure:

1.  **Хранилище Azure** - Следуйте этому руководству, чтобы обеспечить избыточность данных для каждой учетной записи хранения в развертывании FarmBbeats.
2.  **Azure Cosmos DB** - Следуйте этому руководству, чтобы обеспечить избыточность данных для учетной записи Cosmos DB вашего развертывания FarmBeats.
3.  **Azure Time Series Insights (TSI)** - TSI в настоящее время не предлагает избыточности данных. Чтобы восстановить данные Time Series Insights, перейдите к своему партнеру по датчику/погоде и снова нажмите данные на развертывание FarmBeats.

## <a name="restore-service-from-online-backup"></a>Восстановление сервиса из резервного копирования в режиме онлайн

Вы можете инициировать сбой и восстановление хранящихся данных, для которых каждый из вышеупомянутых хранилий данных для развертывания FarmBeats. После восстановления данных для хранения данных Azure и Cosmos DB создайте еще одно развертывание FarmBeats в парном регионе Azure, а затем направите новое развертывание для использования данных из восстановленных хранилищ данных (т.е. Azure Storage и Cosmos DB) с помощью нижеприведенных шагов:

1. [Настройка Cosmos DB](#configure-cosmos-db)
2. [Настройка учетной записи хранения](#configure-storage-account)


### <a name="configure-cosmos-db"></a>Настройка Cosmos DB

Копируйте ключ доступа восстановленного Cosmos DB и обновите новый ключевой vault FarmBeats Datahub.


  ![Аварийное восстановление](./media/disaster-recovery-for-farmbeats/keyvault-secrets.png)

> [!NOTE]
> Копируйте URL восстановленного Cosmos DB и обновляйте его в новой конфигурации приложения FarmBeats Datahub. Теперь вы можете удалить учетную запись Cosmos DB в новом развертывании FarmBeats.

  ![Аварийное восстановление](./media/disaster-recovery-for-farmbeats/northeu-ehub-api-configuration.png)

### <a name="configure-storage-account"></a>Настройка учетной записи хранения

Копируйте ключ доступа восстановленной учетной записи хранилища и обновляйте его в новом хранилище ключей FarmBeats Datahub.

![Аварийное восстановление](./media/disaster-recovery-for-farmbeats/keyvault-7udqm-secrets.png)

>[!NOTE]
> Убедитесь в обновлении имени учетной записи хранилища в новом файле конфигурации FarmBeats Batch VM.

![Аварийное восстановление](./media/disaster-recovery-for-farmbeats/batch-prep-files.png)

Аналогичным образом, если вы включили восстановление данных для вашей учетной записи хранения accelerator, следуйте шагу 2, чтобы обновить ключ доступа к учетной записи и имя учетной записи акселератора, в новом экземпляре FarmBeats.
