---
title: Установка Azure FarmBeats
description: В этой статье описывается, как установить Azure Фармбеатс в подписке Azure.
author: usha-rathnavel
ms.topic: article
ms.date: 12/11/2019
ms.author: usrathna
ms.openlocfilehash: d1a6bdfb38431e18eb305b223ce8ee2467804052
ms.sourcegitcommit: f4f626d6e92174086c530ed9bf3ccbe058639081
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/25/2019
ms.locfileid: "75482456"
---
# <a name="install-azure-farmbeats"></a>Установка Azure FarmBeats

В этой статье описывается, как установить Azure Фармбеатс в подписке Azure.

Azure Фармбеатс — это предложение "бизнес — бизнес", доступное в Azure Marketplace. Она позволяет объединять наборы данных сельское хозяйство в поставщиках и создавать ценные сведения, позволяющие предпринимать практические действия. Azure Фармбеатс делает это, позволяя создавать модели искусственного интеллекта (ии) или машинного обучения (ML) на основе наборов данных с предохранителем. Два основных компонента Azure Фармбеатс:

- **Датахуб**: уровень API, обеспечивающий агрегирование, нормализацию и контекстуальность различных наборов данных сельское хозяйство в разных поставщиках.

- **Accelerator**— пример веб-приложения, созданного на основе датахуб. Он запускает разработку и визуализацию модели. Ускоритель использует API-интерфейсы Фармбеатс Azure для демонстрации визуализации полученных данных датчика в виде диаграмм и визуализации вывода модели в виде карт.

## <a name="before-you-start"></a>Перед началом работы
### <a name="components-installed"></a>Установленные компоненты

При установке Azure Фармбеатс в подписке Azure подготавливаются следующие ресурсы.

| Установленные ресурсы Azure  | Компонент Azure Фармбеатс  |
|---------|---------|
| Application Insights   |      Ускоритель & датахуб      |
| App Service     |     Ускоритель & датахуб     |
| План обслуживания приложения   | Ускоритель & датахуб  |
| API подключения    |  датахуб       |
| Кэш Azure для Redis       | датахуб      |
| Azure Cosmos DB   |  датахуб       |
| Фабрика данных Azure версии 2       |     Ускоритель & датахуб      |
| Учетная запись пакетной службы Azure    | датахуб   |
| Azure Key Vault. |  Ускоритель & датахуб        |
| Учетная запись Azure Maps       |     Accelerator    |
| Пространство имен концентратора событий    |     датахуб      |
| Логическое приложение      |  датахуб       |
| Учетная запись хранения      |     Ускоритель & датахуб      |
| Time Series Insights     |    датахуб    |

### <a name="costs-incurred"></a>Затраты

Стоимость Azure Фармбеатс — это совокупная стоимость базовых служб Azure. Сведения о ценах на службы Azure можно рассчитать с помощью [калькулятора цен](https://azure.microsoft.com/pricing/calculator). Фактические затраты на общую установку будут зависеть от использования. Устойчивое состояние для двух компонентов:

* Датахуб — менее $10 в день
* Ускоритель — менее $2 в день

### <a name="regions-supported"></a>Поддерживаемые регионы

Сейчас Azure Фармбеатс поддерживается в общедоступных облачных средах в следующих регионах:
* Восточная Австралия
* Центральная часть США
* Восточная часть США
* Восточная часть США 2
* Западная часть США
* Западная часть США 2
* Северная Европа
* Западная Европа
* Юго-Восточная Азия

### <a name="time-taken"></a>Затраченное время

Полная настройка Azure Фармбеатс, включая подготовку и установку, займет меньше часа.

## <a name="prerequisites"></a>Технические условия    

Прежде чем начать фактическую установку Azure Фармбеатс, вам потребуется выполнить следующие действия:

### <a name="create-sentinel-account"></a>Создать учетную запись Sentinel
Программа установки Azure Фармбеатс позволяет получить бесплатный вспомогательный образ от Европейской задачи Агентства « [Sentinel-2](https://scihub.copernicus.eu/) » в вашей ферме. Чтобы настроить эту настройку, требуется учетная запись Sentinel.

Выполните действия, чтобы создать бесплатную учетную запись с Sentinel:

1. Перейдите на официальную страницу [регистрации](https://scihub.copernicus.eu/dhus/#/self-registration) .
2. Укажите необходимые сведения (имя, фамилию, имя пользователя, пароль и идентификатор электронной почты) и заполните форму.
3. Ссылка на проверку будет отправлена на зарегистрированный идентификатор электронной почты. Выберите ссылку, указанную в сообщении электронной почты, и завершите проверку.

Процесс регистрации завершится после завершения проверки. Запишите **имя пользователя** и **пароль**Sentinel.

### <a name="decide-subscription-and-region"></a>Выбор подписки и региона

Вам потребуется идентификатор подписки Azure и регион, где вы хотите установить Azure Фармбеатс. Выберите один из регионов, перечисленных в разделе [Поддерживаемые регионы](#regions-supported) .

Запишите **идентификатор подписки Azure** и **регион Azure**.

### <a name="verify-permissions"></a>Проверка разрешений

Необходимо проверить, достаточно ли прав и разрешений в клиенте Azure, где вы хотите установить Azure Фармбеатс.

Вы можете проверить разрешения на доступ в портал Azure, следуя инструкциям в разделе [Управление доступом на основе ролей](https://docs.microsoft.com/azure/role-based-access-control/check-access) .

Для установки Azure Фармбеатс вам потребуются следующие разрешения:
- Клиент — доступ для чтения
- Подписка — участник или владелец
- Группа ресурсов — владелец.

Кроме того, для Azure Фармбеатс требуется регистрация приложений Azure Active Directory. Существует два способа выполнить требуемую установку Azure AD:

**Вариант 1**. у вас есть разрешения на **запись** в клиенте Azure, на который выполняется установка. Это означает, что у вас есть необходимые разрешения на динамическое создание регистрации приложения AAD во время установки.

Вы можете перейти непосредственно к разделу " [Завершение регистрации в Marketplace"](#complete-azure-marketplace-sign-up) .


**Вариант 2**. у вас нет разрешений на **запись** в клиенте Azure. Это распространенный случай, когда вы пытаетесь установить Azure Фармбеатс в подписке Azure, а доступ на **запись** ограничен только той группой ресурсов, которой вы владеете.
В этом случае попросите администратора ИТ выполнить действия, описанные ниже, чтобы автоматически создать и завершить регистрацию приложения Azure AD в портал Azure.

1. Скачайте и извлеките [Скрипт генератора приложений AAD](https://aka.ms/FarmBeatsAADScript) на локальный компьютер.
2. Войдите в портал Azure и выберите свою подписку и клиент Azure AD.
3. Запустите Cloud Shell на панели инструментов в верхней части портал Azure.

    ![Проект Фармбеатс](./media/install-azure-farmbeats/navigation-bar-1.png)

4. Выберите PowerShell в качестве предпочтительного интерфейса оболочки. В первый раз пользователям будет предложено выбрать подписку и создать учетную запись хранения. Завершите установку согласно указаниям.
5. Передайте сценарий (из шага 1) в Cloud Shell и запишите расположение отправленного файла.

    > [!NOTE]
    > По умолчанию файл отправляется в домашний каталог.

6. Перейдите в корневой каталог с помощью команды "CD" и выполните следующий скрипт:

      ```azurepowershell-interactive
            ./create_aad_script.ps1
      ```
7. Введите имя **веб-сайта датахуб** и имя **веб-сайта ускорителя** . Запишите выходные данные скрипта и поделитесь им с пользователем, устанавливающим Azure Фармбеатс.

Когда ИТ-администратор предоставит необходимые сведения, запишите **идентификатор клиента AAD, секрет клиента AAD, имя веб-сайта датахуб & название веб-сайта ускорителя**.

   > [!NOTE]
   > Если вы выполните инструкции из варианта 2, не забудьте добавить идентификатор клиента AAD & секрет клиента AAD в качестве отдельных параметров в [файле параметров](#prepare-parameters-file) .

Теперь у вас есть вся информация, необходимая для перехода к следующему разделу.

### <a name="complete-azure-marketplace-sign-up"></a>Завершение регистрации в Azure Marketplace

Прежде чем начать процесс установки на основе облачной оболочки, необходимо завершить регистрацию в предложении Azure Фармбеатс в Azure Marketplace. Выполните следующие действия, чтобы завершить регистрацию.

1.  Войдите на портал Azure. Выберите свою учетную запись в правом верхнем углу и перейдите в клиент Azure AD, где вы хотите установить Azure Фармбеатс.

2.  Перейдите в Azure Marketplace на портале и выполните поиск по запросу **Azure фармбеатс** в Marketplace.

3.  Откроется новое окно с обзором Azure Фармбеатс. Нажмите **Создать**.

4.  Откроется новое окно. Завершите процесс регистрации, выбрав подходящую подписку, группу ресурсов и расположение, в которое вы хотите установить Azure Фармбеатс.

5.  После проверки указанных сведений нажмите кнопку **ОК**. Откроется страница Условия использования. Ознакомьтесь с условиями и нажмите кнопку **создать** , чтобы завершить процесс регистрации.

Этот шаг завершает процесс регистрации в Azure Marketplace. Теперь вы готовы начать подготовку файла параметров.

### <a name="prepare-parameters-file"></a>Подготовка файла параметров
Последний шаг на этапе предварительных требований — создание JSON-файла, который будет использоваться в качестве входных данных во время установки Cloud Shell. Параметры в JSON File необходимо заменить соответствующими значениями.

Ниже приведен пример JSON-файла. Скачайте пример и обновите необходимые сведения.

```json
{  
    "sku":"both",
    "subscriptionId":"da9xxxec-dxxf-4xxc-xxx21-xxx3ee7xxxxx",
    "datahubResourceGroup":"dummy-test-dh1",
    "location":"westus2",
    "datahubWebsiteName":"dummy-test-dh1",
    "acceleratorResourceGroup":"dummy-test-acc1",
    "acceleratorWebsiteName":"dummy-test-acc1",
    "sentinelUsername":"dummy-dev",
    "notificationEmailAddress":"dummy@yourorg.com",
    "updateIfExists":true
}
```

Дополнительные сведения о каждом из параметров см. в приведенной ниже таблице параметров.

| Параметр | Значение|
|--- | ---|
|sku  | Предоставляет пользователю возможность установить Датахуб, ускоритель или только Датахуб. Чтобы установить только Датахуб, используйте "датахуб". Чтобы установить Датахуб и Accelerator, используйте "both".|
|subscriptionId | Указывает подписку Azure для установки Azure Фармбеатс|
|датахубресаурцеграуп| Указывает имя группы ресурсов для ресурсов Датахуб. Введите имя группы ресурсов, созданной в Azure Marketplace, здесь|
|location |Расположение или регион Azure, в которых вы хотите установить Azure Фармбеатс|
|датахубвебситенаме  | Уникальный префикс URL-адреса Датахуб |
|акцелераторресаурцеграуп  | Указывает имя группы ресурсов для ресурсов ускорителя|
|акцелераторвебситенаме |Уникальный префикс URL для веб-приложения ускорителя|
|сентинелусернаме | Имя пользователя для получения вспомогательных изображений Sentinel|
|нотификатионемаиладдресс  | Адрес электронной почты для получения уведомлений обо всех оповещениях, которые вы настраиваете в Датахуб|
|упдатеифексистс| Используемых Параметр, включаемый в файл параметров только в том случае, если требуется обновить существующий экземпляр Azure Фармбеатс. Для обновления другие сведения, такие как имена и расположения групп ресурсов должны быть одинаковыми.|
|аадаппклиентид | Используемых Параметр, включаемый в файл параметров только при использовании предварительно созданного приложения AAD. Дополнительные сведения см. в разделе вариант [проверки разрешений](#verify-permissions) . |
|аадаппклиентсекрет  | Используемых Используемых Параметр, включаемый в файл параметров только при использовании предварительно созданного приложения AAD. Дополнительные сведения см. в разделе вариант [проверки разрешений](#verify-permissions) .|

Создайте файл параметров JSON и сохраните его на локальном компьютере, основываясь на приведенной выше таблице и файле примера JSON.

## <a name="install"></a>Установка

Фактическая установка ресурсов Azure Фармбеатс происходит в Cloud Shell интерфейсе командной строки на основе браузера с помощью среды bash. Чтобы установить Azure Фармбеатс, следуйте приведенным ниже инструкциям.

1. Войдите на портал Azure. Выберите подписку Azure и клиент, для которого вы хотите установить Azure Фармбеатс.
2. Запустите **Cloud Shell** на панели инструментов в правом верхнем углу портал Azure.
3. Выберите Bash в качестве предпочтительного интерфейса оболочки. Нажмите кнопку **Отправить** (выделено на рисунке ниже) и отправьте ПОДГОТОВЛЕНный JSON-файл параметров.

      ![Проект Фармбеатс](./media/install-azure-farmbeats/bash-2-1.png)

4. **Скопируйте** приведенную ниже команду и **замените \<username >** правильным значением, чтобы команда указывала на правильный путь отправленного файла.

    ```bash
          wget -O farmbeats-installer.sh https://aka.ms/AzureFarmbeatsInstallerScript && bash farmbeats-installer.sh /home/<username>/input.json
    ```
5. Выполните команду Modified, чтобы начать процесс установки. Вам будет предложено следующее:
 - Примите условия **лицензии Azure фармбеатс** . Введите "Y", чтобы перейти к следующему шагу, если вы согласны с Условия использования. Если вы не согласны с условиями использования, введите "N", чтобы завершить установку.

 - Далее вам будет предложено ввести маркер доступа для установки. Скопируйте созданный код и войдите на [страницу входа в устройство](https://microsoft.com/devicelogin) с помощью **учетных данных Azure**.

 - После успешного завершения входа установщик запросит пароль учетной записи-метки. Введите **пароль для учетной записи Sentinel**.

6. Файл параметров проверяется, и начинается установка ресурсов Azure. Выполнение установки займет около **25 минут** .    
> [!NOTE]
> Срок действия неактивных сеансов Cloud Shell истекает через **20 минут**. При развертывании ресурсов Azure установщик должен оставаться активным Cloud Shell сеансе. Если время ожидания сеанса истекло, потребуется перезапустить процесс установки.

После завершения установки вы получите следующие выходные ссылки:
* **URL-адрес датахуб**: ссылка Swagger для доступа к API датахуб.
* **URL-адрес ускорителя**: веб-приложение для изучения ускорителя Azure фармбеатс.
* **Файл журнала установщика**: файл журнала, содержащий сведения об установке. Этот файл журнала можно использовать для устранения неполадок при установке, если это необходимо.

Вы можете проверить завершение установки Azure Фармбеатс, выполнив следующие проверки:

**датахуб**
1. Войдите в указанный URL-адрес ускорителя (в формате **https://\<йоурдатахуб-website-name >. azurewebsites. NET/Swagger**) с учетными данными Azure.
2. Вы должны видеть различные объекты API Фармбеатс и выполнять операции RESTFUL в API-интерфейсах.

**Accelerator**
1. Войдите в указанный URL-адрес ускорителя (в формате **https://\<йоуракцелератор-website-name >. azurewebsites. NET/Swagger**) с учетными данными Azure.
2. Вы можете увидеть пользовательский интерфейс ускорителя с возможностью создания ферм в браузере.

Возможность выполнения указанных выше операций означает успешную установку Azure Фармбеатс.

## <a name="upgrade"></a>Обновление
В общедоступной предварительной версии для обновления существующей установки Azure Фармбеатс необходимо снова запустить команду установки в Cloud Shell с дополнительным параметром "**упдатеифексистс**" в файле параметров, для которого задано значение "**true**". Обратитесь к последней строке приведенного ниже примера JSON для параметра обновления.

```json
{
    "sku":"both",
    "subscriptionId":"da9xxxec-dxxf-4xxc-xxx21-xxx3ee7xxxxx",
    "datahubResourceGroup":"dummy-test-dh1",
    "location":"westus2",
    "datahubWebsiteName":"dummy-test-dh1",
    "acceleratorResourceGroup":" dummy-test-acc1",
    "acceleratorWebsiteName":" dummy-test-acc1",
    "sentinelUsername":"dummy-dev",
    "notificationEmailAddress":"dummy@yourorg.com",
    "updateIfExists":true
}
```
Команда обновляет существующую установку Azure Фармбеатс до последней версии и предоставляет выходные ссылки.

## <a name="uninstall"></a>Удаление

Чтобы удалить Azure Фармбеатс Датахуб или ускоритель, выполните следующие действия.

1.  Войдите в портал Azure и **удалите группы ресурсов** , в которых установлены эти компоненты.

2.  Перейдите в Azure Active Directory & **удалить приложение Azure AD** , связанное с установкой Azure фармбеатс. Это приведет к удалению установки Azure Фармбеатс из подписки Azure.

## <a name="next-steps"></a>Дальнейшие действия
Вы узнали, как установить Azure Фармбеатс в подписке Azure. Теперь Узнайте, как [Добавить пользователей](manage-users-in-azure-farmbeats.md#manage-users) в экземпляр Azure фармбеатс.
