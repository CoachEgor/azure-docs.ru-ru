---
title: Ссылки
description: ''
author: sunasing
ms.topic: article
ms.date: 11/04/2019
ms.author: sunasing
ms.openlocfilehash: 717a09d8377a7b95fe24300cc65222f307e7419f
ms.sourcegitcommit: ced98c83ed25ad2062cc95bab3a666b99b92db58
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/31/2020
ms.locfileid: "80437526"
---
# <a name="references"></a>Ссылки

В этой статье описаны AA-иносы Azure FarmBeats.

## <a name="rest-api"></a>REST API

AA AIS Azure FarmBeats предоставляет сельскохозяйственным предприятиям стандартизированный интерфейс RESTful с ответами на основе JSON, чтобы помочь вам воспользоваться возможностями Azure FarmBeats, такими как:

- AA, чтобы получить датчик, камера, беспилотный летательный аппарат, погода, спутник, и куратор наземных данных.
- Нормализация и контекстуализация данных между общими поставщиками данных.
- Схематизированные возможности доступа и запроса на всех проглатынных данных.
- Автоматическое генерирование метаданных, которые могут быть запрошены, на основе агрономических особенностей.
- Автоматически генерируемые агрегаты последовательности времени для быстрого построения модели.
- Интегрированный движок Azure Data Factory для легкого построения пользовательских конвейеров обработки данных.

## <a name="application-development"></a>Разработка приложений

AA-аБИ FarmBeats содержат техническую документацию Swagger. Для получения информации обо всех AA и их соответствующих запросах или ответах [см.](https://aka.ms/FarmBeatsDatahubSwagger)

В следующей таблице приведены итоги всех объектов и ресурсов в FarmBeats Datahub:

| Объекты и ресурсы | Описание
--- | ---|
ферма; | Ферма соответствует физическому расположению интереса в системе FarmBeats. Каждая ферма имеет название фермы и уникальный идентификатор фермы. |
Устройство  | Устройство соответствует физическому устройству, присутствуютму на ферме. Каждое устройство имеет уникальный идентификатор устройства. Устройство обычно приспозывало к ферме с идентификатором фермы.
DeviceModel  | DeviceModel соответствует метаданным устройства, таким как производитель и тип устройства, которое является либо шлюзом, либо узла.
Датчик  | Датчик соответствует физическому датчику, который записывает значения. Датчик обычно подключается к устройству с идентификатором устройства.
SensorModel  | SensorModel соответствует метаданным датчика, таким как производитель, типу датчика, который является либо аналоговым, либо цифровым, и измерению датчика, таким как температура окружающей среды и давление.
Телеметрия  | Телеметрия обеспечивает возможность чтения телеметрических сообщений для определенного датчика и диапазона времени.
Задание  | Задание соответствует любому рабочему процессу действий, выполняемых в системе FarmBeats для получения желаемого результата. Каждое задание связано с идентификатором задания и типом задания.
JobType  | JobType соответствует различным типам задания, поддерживаемым системой. Включены системные и пользовательские типы заданий.
ExtendedType  | ExtendedType соответствует списку системных и пользовательских типов в системе. ExtendedType помогает настроить новый тип файла, сцены или сцены в системе FarmBeats.
Партнер  | Партнер соответствует партнеру по интеграции датчиков и изображений для FarmBeats.
Сцена  | Сцена соответствует любому генерируемому выходу в контексте фермы. Каждая сцена имеет идентификатор сцены, источник сцены, тип сцены и идентификатор фермы, связанный с ней. Каждый идентификатор сцены может иметь несколько файлов сцены, связанных с ним.
SceneFile |SceneFile соответствует всем файлам, которые генерируются для одной сцены. Один идентификатор сцены может иметь несколько идентификаторов SceneFile, связанных с ним.
Правило  |Правило соответствует условию, при чем данные, связанные с фермой, для запуска оповещения. Каждое правило находится в контексте данных фермы.
Предупреждение  | Предупреждение соответствует уведомлению, которое генерируется при соответствии условия правила. Каждое оповещение находится в контексте правила.
RoleDefinition  | РолевыеОпределение определяет допустимые и запрещенные действия для роли.
RoleAssignment  |Назначение ролей соответствует назначению роли пользователю или руководителю службы.

### <a name="data-format"></a>Формат данных

JSON является общим форматом данных, независимым от языка, который обеспечивает простое текстовое представление произвольных структур данных. Для получения дополнительной информации, [см.](https://www.json.org/)

## <a name="authentication-and-authorization"></a>Аутентификация и авторизация

Запросы HTTP на API REST защищены активным каталогом Azure (Azure AD).
Чтобы сделать аутентифицированный запрос на АДИ-аДИ REST, клиентский код требует аутентификации с действительными учетными данными, прежде чем вы сможете позвонить в API. Аутентификация координируется между различными субъектами Azure AD. Он предоставляет вашему клиенту токен доступа в качестве доказательства проверки подлинности. Затем токен отправляется в заголовке авторизации HTTP запросов REST API. Чтобы узнать больше об аутентификации Azure AD, смотрите [active Directory Для разработчиков.](https://portal.azure.com)

Токен доступа должен быть отправлен в последующих запросах API в разделе заголовок, как:

```
headers = {"Authorization": "Bearer " + **access_token**}
```

### <a name="http-request-headers"></a>Заголовки запросов HTTP

Вот наиболее распространенные заголовки запросов, которые необходимо указать при вызове API в Datahub Azure FarmBeats.


**Заголовка** | **Описание и пример**
--- | ---
Content-Type  | Формат запроса (Content-Type:<format>application/ ). Для AIS Azure FarmBeats Datahub формат jSON. Content-Type: application/json
Авторизация  | Опознавательный маркер доступа, необходимый для вызова API. Авторизация:> <доступа
Принять | Формат ответа. Для AIS Azure FarmBeats Datahub формат jSON. Принять: приложение/json

### <a name="api-requests"></a>Запросы API

Чтобы сделать запрос REST API, вы объедините метод HTTP (GET, POST, PUT или DELETE), URL-адрес службы API, URI для запроса, отправки данных, обновления или удаления, а затем добавления одного или нескольких заголовков запросов HTTP.

URL-адрес службы API — это url-адрес\<Datahub, например, https:// yourdatahub-сайт-имя>.azurewebsites.net.

Дополнительно можно включить параметры запроса в вызовы GET для фильтрации, ограничения размера и сортировки данных в ответах.

Следующий запрос образца используется для получения списка устройств:

```bash
curl -X GET "https://microsoft-farmbeats.azurewebsites.net/Device" -H "Content-Type: application/json" -H "Authorization: Bearer <Access-Token>”
```

Большинство вызовов GET, POST и PUT требуют органа запроса JSON.

Следующий запрос образца создает устройство. Этот запрос имеет ввод JSON с органом запроса.

```bash
curl -X POST "https://microsoft-farmbeats.azurewebsites.net/Device" -H  "accept: application/json" -H  "Content-Type: application/json" -H "Authorization: Bearer <Access-Token>" -d "{  \"deviceModelId\": \"ID123\",  \"hardwareId\": \"MHDN123\",  \"reportingInterval\": 900,  \"name\": \"Device123\",  \"description\": \"Test Device 123\",}"
```

### <a name="query-parameters"></a>Параметры запроса

Для вызовов REST GET можно фильтровать, ограничивать размер и сортировать данные в ответе API, включив один или несколько параметров запроса в uri запроса. Для параметров запроса см.
Например, при запросе списка устройств (GET call on/Device) можно указать следующие параметры запроса:

![Список устройств](./media/references-for-azure-farmbeats/query-parameters-device-1.png)

### <a name="error-handling"></a>Обработка ошибок

ApIs Azure FarmBeats Datahub возвращают стандартные ошибки HTTP. Наиболее распространенными кодами ошибок являются следующие:

 |Код ошибки             | Описание |
 |---                    | --- |
 |200                    | Успешно |
 |201                    | Создание (Почта) Успех |
 |400                    | Недопустимый запрос. В запросе есть ошибка. |
 |401                    | Не авторизовано. Звонящее API не имеет права на доступ к ресурсу. |
 |404                    | Ресурс не найден |
 |5XX                    | Ошибка внутреннего сервера. Коды ошибок, начинающимся с 5XX, означают, что на сервере есть некоторая ошибка. Для получения более подробной информации обратитесь к журналам серверов и следующему разделу. |


В дополнение к стандартным ошибкам HTTP, ApIs Azure FarmBeats Datahub также возвращают внутренние ошибки в следующем формате:

```json
    {
      "message": "<More information on the error>",
      "status": "<error code>”,
      "code": "<InternalErrorCode>",
      "moreInfo": "<Details of the error>"
    }
```

В этом примере при создании фермы обязательное поле "Имя" не было указано в полезной нагрузке ввода. В результате сообщение об ошибке будет:

 ```json    
    {
      "message": "Model validation failed",
      "status": 400,
      "code": "ModelValidationFailed",
      "moreInfo": "[\"The Name field is required.\"]"
    }
  ```

## <a name="add-users-or-app-registrations-to-azure-active-directory"></a>Добавление регистраций пользователей или приложений в Active Directory Azure

ApIs Azure FarmBeats можно получить пользователю или регистрации приложений в Active Directory Azure. Чтобы создать регистрацию приложения в Active Directory Azure, выполните следующие действия:

1. Перейдите на [портал Azure](https://portal.azure.com)и выберите**регистрацию** >  **приложения Azure Active Directory** > **App.** Кроме того, можно использовать существующую учетную запись.
2. Для новой учетной записи сделайте следующее:

    - Введите имя.
    - Выберите **учетные записи только в этом каталоге организации (Единый арендатор).**
    - Используйте значения по умолчанию в остальных полях.
    - Выберите **Зарегистрировать**.

3. На новой и существующей панели регистрации приложений **Обзор,** сделать следующее:

    - Захват **идентификатора клиента** и **идентификатора клиента**.
    - Перейти к **сертификатам и секретам** для создания нового клиента секрет и захватить **клиент-секрет**.
    - Вернитесь к **Обзору**и выберите ссылку рядом с **приложением Manage в локальном каталоге.**
    - Перейдите к **свойствам,** чтобы захватить **идентификатор объекта.**

4. Перейти к Datahub Swagger (https://<yourdatahub>.azurewebsites.net/swagger/index.html) и сделать следующее:
    - Перейдите на **API ролевой назначения**.
    - Выполните POST для создания объекта **назначения ролей** для только что созданного **объекта.**

  > [!NOTE]
  > Для получения дополнительной информации о том, как [Azure Active Directory](https://docs.microsoft.com/azure/active-directory/develop/howto-create-service-principal-portal)добавить пользователей и регистрацию Active Directory, см.

После завершения предыдущих шагов регистрация (клиент) приложения может вызывать AI Azure FarmBeats, используя токен доступа с помощью проверки подлинности носителя.

Используйте маркер доступа для отправки его в последующих запросах API в разделе заголовка следующим образом:

```
headers = {"Authorization": "Bearer " + **access_token**, "Content-Type" : "application/json" }
```
