---
title: Устранение неполадок в Azure FarmBeats
description: В этой статье описывается, как устранить неполадки Azure FarmBeats.
author: uhabiba04
ms.topic: article
ms.date: 11/04/2019
ms.author: v-umha
ms.openlocfilehash: a429a1e454e73a1a9d544e308e5b2d60052d91a9
ms.sourcegitcommit: 8a9c54c82ab8f922be54fb2fcfd880815f25de77
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/27/2020
ms.locfileid: "80349775"
---
# <a name="troubleshoot"></a>Устранение неполадок

В этой статье приведены решения общих проблем Azure FarmBeats.

Для получения дополнительной помощи свяжитесь с нами по адресу farmbeatssupport@microsoft.com. Убедитесь в том, что файл **deployer.log** будет включен в электронную почту.

Чтобы загрузить файл **deployer.log,** сделайте следующее:

1. Вопийте на **портале Azure** и выберите подписку и aD-арендатор Azure.
2. Запустите Cloud Shell с верхней панели навигации портала Azure.
3. Выберите **Bash** в качестве предпочтительного опыта облачной оболочки.
4. Выберите выделенную иконку, а затем, в списке выпадающих, выберите **Скачать.**

    ![Проект ФермаБитс](./media/troubleshoot-azure-farmbeats/download-deployer-log-1.png)

5. В следующем стекол введите путь к файлу **deployer.log.** Например, введите **farmbeats-deployer.log**.

## <a name="sensor-telemetry"></a>Сенсорная телеметрия

### <a name="cant-view-telemetry-data"></a>Не уклониться от просмотра телеметрических данных

**Симптом :** Устройства или датчики развернуты, и вы связали FarmBeats с вашим партнером устройства, но вы не можете получить или просмотреть телеметрические данные на FarmBeats.

**Корректирующее действие**:

1. Перейдите в группу ресурсов FarmBeats Datahub.   
2. Выберите **концентратор событий** (DatafeedEventHubNamespace), а затем проверьте количество входящих сообщений.
3. Выполните одно из приведенных ниже действий.   
   - Если *нет входящих сообщений,* свяжитесь с вашим партнером устройства.  
   - Если есть *входящие сообщения,* свяжитесь с нами. farmbeatssupport@microsoft.com Прикрепите журналы Datahub и Accelerator и запечатлейте телеметрию.

Чтобы понять, как загружать журналы, перейдите в раздел ["Сбор журналов вручную".](#collect-logs-manually)  

### <a name="cant-view-telemetry-data-after-ingesting-historicalstreaming-data-from-your-sensors"></a>Не уклониться от просмотра телеметрических данных после попавания исторических/потоковых данных с датчиков

**Симптом**: Устройства или датчики развернуты, и вы создали устройства / датчики на FarmBeats и попадает телеметрии в EventHub, но вы не можете получить или просмотреть телеметрические данные на FarmBeats.

**Корректирующее действие**:

1. Убедитесь, что вы сделали регистрацию партнера правильно - вы можете проверить это, перейдя к datahub чванство, перейдите на / Партнер API, Do Получить и проверить, если партнер зарегистрирован. Если нет, следуйте [шагам здесь,](get-sensor-data-from-sensor-partner.md#enable-device-integration-with-farmbeats) чтобы добавить партнера.
2. Убедитесь, что вы использовали правильный формат сообщения Телеметрии:

```json
{
"deviceid": "<id of the Device created>",
"timestamp": "<timestamp in ISO 8601 format>",
"version" : "1",
"sensors": [
    {
      "id": "<id of the sensor created>",
      "sensordata": [
        {
          "timestamp": "< timestamp in ISO 8601 format >",
          "<sensor measure name (as defined in the Sensor Model)>":"<value>"
        },
        {
          "timestamp": "<timestamp in ISO 8601 format>",
          "<sensor measure name (as defined in the Sensor Model)>": "<value>"
        }
      ]
    }
 ]
}
```

### <a name="dont-have-the-azure-event-hubs-connection-string"></a>У вас нет строки подключения кцентров azure Event

**Корректирующее действие**:

1. В Datahub Swagger перейдите на API-партнер.
2. Выберите **Получить Попробуйте** > **выполнить** > **Execute**.
3. Обратите внимание на идентификатор партнера датчика, который вас интересует.
4. Вернитесь к API-партнеру и выберите **Get/\<ID>. **
5. Укажите идентификатор партнера со ступени 3, а затем выберите **Execute.**

   Ответ API должен иметь строку соединения концентраторов событий.

### <a name="device-appears-offline"></a>Устройство отображается в автономном режиме

**Симптомы**: Устройства установлены, и вы связали FarmBeats с вашим партнером устройства. Устройства находятся в режиме онлайн и отправляют телеметрические данные, но они отображаются в автономном режиме.

**Исправление действия**: Интервал отчетности не настроен для этого устройства. Чтобы установить интервал отчетности, свяжитесь с производителем устройства. 

### <a name="error-deleting-a-device"></a>Ошибка удаляемого устройства

При удаление устройства можно столкнуться с одним из следующих распространенных сценариев ошибок:  

**Сообщение**: "Устройство ссылается на датчики: Есть один или несколько датчиков, связанных с устройством. Удалите датчики, а затем удалите устройство».  

**Значение**: Устройство связано с несколькими датчиками, которые развернуты на ферме.   

**Корректирующее действие**:  

1. Удалите датчики, связанные с устройством, через ускоритель.  
2. Если вы хотите связать датчики с другим устройством, попросите партнера по устройству сделать то же самое.  
3. Удалите устройство `DELETE API` с помощью вызова и установите параметр силы как *верный.*  

**Сообщение**: "Устройство ссылается на устройства, как ParentDeviceId: Есть один или несколько устройств, которые связаны с этим устройством в качестве детских устройств. Удалите их, а затем удалите это устройство»...  

**Значение**: Ваше устройство имеет другие устройства, связанные с ним.  

**Действие по исправлению**

1. Удалите устройства, связанные с этим конкретным устройством.  
2. Удалите конкретное устройство.  

    > [!NOTE]
    > Вы не можете удалить устройство, если с ним связаны датчики. Для получения дополнительной информации о том, как [Get sensor data from sensor partners](get-sensor-data-from-sensor-partner.md)удалить связанные датчики, **см.**

    > Партнеры не имеют доступа к удалению устройства или датчика. Только у админов есть доступ к тому же.


## <a name="issues-with-jobs"></a>Проблемы с заданиями

### <a name="farmbeats-internal-error"></a>Внутренняя ошибка FarmBeats

**Сообщение**: "FarmBeats внутренней ошибки, см устранение неполадок руководство для более подробной информации".

**Корректирующие действия**: Эта проблема может возникнуть в результате временного сбоя в конвейере данных. Создайте работу снова. Если ошибка сохраняется, добавьте сообщение об ошибке в публикации FarmBeatsSupport@microsoft.comна форуме FarmBeats или свяжитесь с нами.

## <a name="accelerator-troubleshooting"></a>Устранение неполадок ускорителя

### <a name="access-control"></a>Управление доступом

**Выпуск**: Вы получаете ошибку при добавлении назначения ролей.

**Сообщение:**"Не найдено подходящих пользователей".

**Исправление действий**: Проверьте идентификатор электронной почты, для которого вы пытаетесь добавить назначение роли. Идентификатор электронной почты должен точно совпадать с идентификатором, который зарегистрирован для этого пользователя в Active Directory. Если ошибка сохраняется, добавьте сообщение об ошибке в публикации FarmBeatsSupport@microsoft.comна форуме FarmBeats или свяжитесь с нами.

### <a name="unable-to-log-in-to-accelerator"></a>Не удается войти в систему на акселератор

**Сообщение**: "Ошибка: Вы не уполномочены звонить в службу. Свяжитесь с администратором для получения разрешения»...

**Корректирующие действия**: Попросите администратора разрешить вам доступ к развертыванию FarmBeats. Это можно сделать, сделав POST AAP RoleAssignment или через контроль доступа в панели **настроек** в accelerator.  

Если вы уже получили доступ и столкнулись с этой ошибкой, повторите попытку обновить страницу. Если ошибка сохраняется, добавьте сообщение об ошибке в публикации FarmBeatsSupport@microsoft.comна форуме FarmBeats или свяжитесь с нами.

![Проект ФермаБитс](./media/troubleshoot-azure-farmbeats/accelerator-troubleshooting-1.png)

### <a name="accelerator-issues"></a>Проблемы с ускорителем  

**Выпуск**: Вы получили ошибку ускорителя неустановленной причины.

**Сообщение**: "Ошибка: произошла неизвестная ошибка".

**Исправление действий**: Эта ошибка возникает, если вы оставите страницу простоя слишком долго. Обновите страницу.  

Если ошибка сохраняется, добавьте сообщение об ошибке в публикации FarmBeatsSupport@microsoft.comна форуме FarmBeats или свяжитесь с нами.

**Выпуск**: FarmBeats Accelerator не показывает последнюю версию, даже после того, как вы обновили FarmBeatsDeployment.

**Исправление действий**: Эта ошибка возникает из-за настойчивости работника службы в браузере. Выполните следующие действия.

1. Закройте все вкладки браузера с открытым ускорителем и закройте окно браузера.
2. Запустите новый экземпляр браузера и перезагрузите ускоритель URI. Это действие загружает новую версию ускорителя.

## <a name="sentinel-imagery-related-issues"></a>Sentinel: Вопросы, связанные с изображениями

### <a name="wrong-username-or-password"></a>Неправильное имя пользователя или пароль

**Сообщение о сбое работы:**"Для доступа к этому ресурсу требуется полная аутентификация".

**Корректирующее действие**:

Выполните одно из следующих действий.

- Повторное запуск установки для обновления Datahub с правильным именем пользователя и паролем.
- Повторное задание с невыполненным или запуск задания спутниковых индексов для диапазона дат от 5 до 7 дней, а затем проверьте, является ли задание успешным.

### <a name="sentinel-hub-wrongurlor-site-not-accessible"></a>Sentinel концентратор: Неправильный URL или сайт недоступен 

**Сообщение о сбое в работе:**"Ой, что-то пошло не так. Страница, к доступу к ней вы пытались получить доступ, (временно) недоступна». 

**Корректирующее действие**:
1. Откройте [Sentinel](https://scihub.copernicus.eu/dhus/) в вашем браузере, чтобы узнать, доступен ли веб-сайт. 
2. Если веб-сайт недоступен, проверьте, не мешает ли какой-либо брандмауэр, сеть компании или другое блокирующее программное обеспечение доступ к веб-сайту, а затем примите необходимые меры для предоставления URL-адреса Sentinel. 
3. Повторное задание с невыполненным или запуск задания спутниковых индексов для диапазона дат от 5 до 7 дней, а затем проверьте, является ли задание успешным.  

### <a name="sentinel-server-down-for-maintenance"></a>Sentinel сервер: Вниз для обслуживания

**Сообщение о сбое в работе:**"Концентратор открытого доступа Коперника скоро вернется! Извините за неудобства, мы выполняем некоторые обслуживания в данный момент. Мы вернемся в сети в ближайшее время! 

**Корректирующее действие**:

Эта проблема может возникнуть, если какие-либо действия по техническому обслуживанию выполняются на сервере Sentinel.

1. Если какое-либо задание или конвейер не выполняется из-за выполнения технического обслуживания, повторно отправьте задание через некоторое время. 

   Для получения информации о любых запланированных или незапланированных мероприятиях по техническому обслуживанию Sentinel, перейдите на сайт [новостей Copernicus Open Access Hub.](https://scihub.copernicus.eu/news/)  

2. Повторное задание с невыполненным или запуск задания спутниковых индексов для диапазона дат от 5 до 7 дней, а затем проверьте, является ли задание успешным.

### <a name="sentinel-maximum-number-of-connections-reached"></a>Sentinel: Максимальное количество подключений достигло

**Сообщение о сбое в работе:**"Максимальное\<количество двух одновременных потоков, достигаемых пользователем "имя пользователя>".

**Значение**: Если задание завершается неудачей из-за максимального количества подключений, та же учетная запись Sentinel используется в другом развертывании программного обеспечения.

**Корректирующее действие**: Попробуйте любой из следующих:

* Создайте новую учетную запись Sentinel, а затем перезапустите установщик для обновления Datahub с помощью нового имени пользователя Sentinel и пароля.  
* Повторное выполнения неудавшейся работы или запуск задания спутниковых индексов для диапазона дат от 5 до 7 дней, а затем проверьте, является ли задание успешным.

### <a name="sentinel-server-refused-connection"></a>Сервер Sentinel: Отказ от подключения 

**Сообщение о сбое в** http://172.30.175.69:8983/solr/dhusработе : "Сервер отказался от подключения по адресу: ." 

**Корректирующие действия**: Эта проблема может возникнуть, если какие-либо действия по техническому обслуживанию выполняются на сервере Sentinel. 
1. Если какое-либо задание или конвейер не выполняется из-за выполнения технического обслуживания, повторно отправьте задание через некоторое время. 

   Для получения информации о любых запланированных или незапланированных мероприятиях по техническому обслуживанию Sentinel, перейдите на сайт [новостей Copernicus Open Access Hub.](https://scihub.copernicus.eu/news/)  

2. Повторное задание с невыполненным или запуск задания спутниковых индексов для диапазона дат от 5 до 7 дней, а затем проверьте, является ли задание успешным.

### <a name="soil-moisture-map-has-white-areas"></a>Карта влажности почвы имеет белые области 

**Выпуск**: Карта влажности почвы была создана, но карта имеет в основном белые области.

**Корректирующее действие**: Эта проблема может возникнуть, если спутниковые индексы, генерируемые на время, за которое была запрошена карта, имеют значения NDVI, которые меньше 0,3. Для получения дополнительной информации, пожалуйста, посетите [Техническое руководство от Sentinel](https://earth.esa.int/web/sentinel/technical-guides/sentinel-2-msi/level-2a/algorithm).
1. Повторное задание для другого диапазона дат и проверьте, являются ли значения NDVI в индексах спутника более 0,3

## <a name="collect-logs-manually"></a>Сбор журналов вручную

[Установка и развертывание Azure Storage Explorer.]( https://docs.microsoft.com/azure/vs-azure-tools-storage-manage-with-storage-explorer?tabs=windows)

### <a name="collect-azure-data-factory-job-logs-in-datahub"></a>Сбор журналов задания Фабрики данных Azure в Datahub

1. Войдите на [портал Azure](https://portal.azure.com).
2. В поле **поиска** ищите группу ресурсов FarmBeats Datahub.

    > [!NOTE]
    > Выберите группу ресурсов Datahub, указанную во время установки FarmBeats.

3. На панели мониторинга **Группы ресурсов** ищите учетную запись хранения *\* данных.* Например, поиск **datahublogsmvxmq**.  
4. В столбце **«Имя»** выберите учетную запись хранилища для просмотра панели **мониторинга.**
5. В панели **datahubblogs\* ** выберите **Open in Explorer** для просмотра приложения Open **Azure Storage Explorer.**
6. В левой панели выберите **контейнеры Blob,** а затем выберите **журналы вакансий.**
7. В панели **журналов работ** выберите **Download**.
8. Загрузите журналы в локальную папку на компьютере.
9. Отправьте загруженный файл farmbeatssupport@microsoft.com.zip по электронной почте .

    ![Проект ФермаБитс](./media/troubleshoot-azure-farmbeats/collecting-logs-manually-1.png)

### <a name="collect-azure-data-factory-job-logs-in-accelerator"></a>Сбор журналов вакансий Фабрики данных Azure в accelerator

1. Войдите на [портал Azure](https://portal.azure.com).
2. В поле **поиска** ищите группу ресурсов FarmBeats Accelerator.

    > [!NOTE]
    > Выберите группу ресурсов Accelerator, указанную во время установки FarmBeats.

3. На панели мониторинга **Группы ресурсов** ищите учетную запись *\* хранилища.* Например, поиск **для storagedop4k\***.
4. Выберите учетную запись хранилища в столбце **«Имя»** для просмотра панели мониторинга **учетной записи хранения.**
5. В панели **хранения\* ** выберите **Открыть в Explorer,** чтобы открыть приложение Azure Storage Explorer.
6. В левой панели выберите **контейнеры Blob,** а затем выберите **журналы вакансий.**
7. В панели **журналов работ** выберите **Download**.
8. Загрузите журналы в локальную папку на компьютере.
9. Отправьте загруженный файл farmbeatssupport@microsoft.com.zip по электронной почте .


### <a name="collect-datahub-app-service-logs"></a>Сбор журналов служб приложений Datahub

1. Войдите на [портал Azure](https://portal.azure.com).
2. В поле **поиска** ищите группу ресурсов FarmBeats Datahub.

    > [!NOTE]
    > Выберите группу ресурсов Datahub, указанную во время установки FarmBeats.

3. В группе ресурсов ищите учетную запись хранения *данных.\* * Например, поиск **fordatahublogsmvxmq\***.
4. Выберите учетную запись хранилища в столбце **«Имя»** для просмотра панели мониторинга **учетной записи хранения.**
5. В панели **datahubblogs\* ** выберите **Open in Explorer,** чтобы открыть приложение Azure Storage Explorer.
6. В левой панели выберите **контейнеры Blob,** а затем выберите **приложения-журналы.**
7. В **панели appinsights-logs** выберите **Download**.
8. Загрузите журналы в локальную папку на компьютере.
9. Отправьте загруженный файл farmbeatssupport@microsoft.com.zip по электронной почте .

### <a name="collect-accelerator-app-service-logs"></a>Сбор журналов приложений accelerator

1. Войдите на [портал Azure](https://portal.azure.com).
2. В поле **поиска** ищите группу ресурсов FarmBeats Accelerator.

    > [!NOTE]
    > Выберите группу ресурсов FarmBeats Accelerator, которая была предоставлена во время установки FarmBeats.

3. В группе ресурсов ищите учетную запись *хранения.\* * Например, поиск **для storagedop4k\***.
4. Выберите учетную запись хранилища в столбце **«Имя»** для просмотра панели мониторинга **учетной записи хранения.**
5. В панели **хранения\* ** выберите **Открыть в Explorer,** чтобы открыть приложение Azure Storage Explorer.
6. В левой панели выберите **контейнеры Blob,** а затем выберите **приложения-журналы.**
7. В **панели appinsights-logs** выберите **Download**.
8. Загрузите журналы в локальную папку на компьютере.
9. Отправьте загруженную папку по электронной farmbeatssupport@microsoft.comпочте.

## <a name="known-issues"></a>Известные проблемы

## <a name="batch-related-issues"></a>Проблемы, связанные с пакетом

**Сообщение об ошибке:**"Достигнута региональная квота счетов пакетных счетов для указанной подписки".

**Корректирующие действия:** Увеличение квоты или удаление неиспользованных учетных записей пакетов и повторное развертывание.

### <a name="azure-active-directory-azure-ad-related-issues"></a>Проблемы, связанные с активным каталогом Azure (Azure AD)

**Сообщение об ошибке**: "Не удалось обновить необходимые настройки для Azure AD App d41axx40-xx21-4fbd-8xxf-97xxx9e2xxc0: Недостаточно привилегий для завершения операции. Убедитесь, что приведенные выше настройки настроены должным образом для приложения Azure AD.

**Значение:** Конфигурация регистрации приложения Azure AD не была завершена должным образом.  

**Корректирующие действия:** Попросите ИТ-администратора (лицо с доступом к чтению арендатора) использовать наш [скрипт](https://github.com/Azure-Samples/active-directory-dotnet-webapp-openidconnect/tree/master/AppCreationScripts) для создания регистрации приложений Azure AD. Этот скрипт автоматически заботится о шагах конфигурации, а также.

**Сообщение об ошибке:**"Не удалось\<создать\>новое имя приложения Active Directory' в этом арендаторе: Другой объект с таким же значением для идентификатора свойств УРИ уже существует".

**Значение**: Регистрация приложения Azure AD с тем же именем уже существует.

**Исправление действий**: Удалите существующую регистрацию приложения Azure AD или повторно используйте его для установки. Если вы повторно используете существующую регистрацию приложения Azure AD, передайте идентификатор приложения и секрет клиента установщику и передислоцируете.

## <a name="issues-with-the-inputjson-file"></a>Проблемы с файлом input.json

**Ошибка**: Вход чтения ошибок из файла *input.json.*

**Исправление действий**: Эта проблема обычно возникает из-за ошибки в указании правильного пути файла *ввода.json* или имени установщика. Внести соответствующие коррективы и повторить попытку развертывания.

**Ошибка**: В файле *input.json* есть значения разбора ошибок.

**Исправление действий**: Эта проблема в основном возникает из-за неправильных значений в файле *input.json.* Внести соответствующие коррективы и повторить попытку развертывания.

## <a name="high-cpu-usage"></a>Высокая загрузка ЦП

**Ошибка**: Вы получаете оповещение по электронной почте, которое относится к **предупреждению об использовании процессора.** 

**Корректирующее действие**: 
1. Перейдите в группу ресурсов FarmBeats Datahub.
2. Выберите **службу app.**  
3. Перейдите на страницу повышения [цен Службы App,](https://azure.microsoft.com/pricing/details/app-service/windows/)а затем выберите соответствующий уровень ценообразования.

## <a name="next-steps"></a>Дальнейшие действия

Если вы все еще сталкиваетесь с проблемами FarmBeats, свяжитесь с нами [форум поддержки](https://aka.ms/farmbeatssupport).
