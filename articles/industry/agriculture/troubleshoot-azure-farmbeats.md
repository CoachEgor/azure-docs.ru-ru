---
title: Устранение неполадок в Azure FarmBeats
description: В этой статье описывается, как устранять неполадки Azure Фармбеатс.
author: uhabiba04
ms.topic: article
ms.date: 11/04/2019
ms.author: v-umha
ms.openlocfilehash: f017b19ef8bd8e4c44d9e2885da6fbaf172808a1
ms.sourcegitcommit: f4f626d6e92174086c530ed9bf3ccbe058639081
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/25/2019
ms.locfileid: "75485979"
---
# <a name="troubleshoot"></a>Устранение неполадок

В этой статье приводятся решения распространенных проблем Azure Фармбеатс.

Для получения дополнительной помощи свяжитесь с нами по адресу farmbeatssupport@microsoft.com. Не забудьте включить файл **deploy. log** в сообщение электронной почты.

Чтобы скачать файл **deploy. log** , выполните следующие действия.

1. Войдите в **портал Azure** и выберите свою подписку и клиент Azure AD.
2. Запустите Cloud Shell с верхней панели навигации портала Azure.
3. Выберите **Bash** в качестве предпочтительного интерфейса Cloud Shell.
4. Выберите выделенный значок, а затем в раскрывающемся списке выберите **скачать**.

    ![Проект Фармбеатс](./media/troubleshoot-azure-farmbeats/download-deployer-log-1.png)

5. На следующей панели введите путь к файлу **развертывания. log** . Например, введите **фармбеатс-деплойер. log**.

## <a name="sensor-telemetry"></a>Телеметрии датчика

### <a name="cant-view-telemetry-data"></a>Не удается просмотреть данные телеметрии

**Симптом**: устройства или датчики развернуты и вы связали фармбеатс с партнером по устройствам, но вы не можете получать или просматривать данные телеметрии в фармбеатс.

**Корректирующее действие**:

1. Перейдите в группу ресурсов Фармбеатс Датахуб.   
2. Выберите **концентратор событий** (датафидевенсубнамеспаце), а затем проверьте количество входящих сообщений.
3. Выполните одно из приведенных ниже действий.   
   - Если *Входящие сообщения*отсутствуют, обратитесь к партнеру по устройствам.  
   - Если имеются *Входящие сообщения*, обратитесь в службу farmbeatssupport@microsoft.com. Прикрепите журналы Датахуб и ускорителя и захваченные данные телеметрии.

Чтобы узнать, как скачать журналы, перейдите к разделу ["получение журналов вручную"](#collect-logs-manually) .  

### <a name="dont-have-the-azure-event-hubs-connection-string"></a>Нет строки подключения концентраторов событий Azure

**Корректирующее действие**:

1. В Датахуб Swagger перейдите к API партнера.
2. Выберите **получить** > **попробуйте** > **выполнить**.
3. Запишите идентификатор партнера датчика, которого вы заинтересованы.
4. Вернитесь к API-партнеру и выберите **Get/\<ID >** .
5. Укажите идентификатор партнера из шага 3, а затем нажмите кнопку **выполнить**.

   Ответ API должен иметь строку подключения концентраторов событий.

### <a name="device-appears-offline"></a>Устройство отображается в автономном режиме

**Симптомы**: устройства установлены и вы связали фармбеатс с вашим партнером по устройствам. Устройства находятся в сети и отправляют данные телеметрии, но отображаются в автономном режиме.

**Корректирующее действие**: интервал отчетов не настроен для этого устройства. Чтобы задать интервал отчетов, обратитесь к изготовителю устройства. 

### <a name="error-deleting-a-device"></a>Ошибка при удалении устройства

При удалении устройства может возникнуть одна из следующих распространенных ситуаций:  

**Сообщение**: "на устройстве имеются ссылки в датчиках: имеется один или несколько датчиков, связанных с устройством. Удалите датчики, а затем удалите устройство. "  

**Это означает**, что устройство связано с несколькими датчиками, развернутыми в ферме.   

**Корректирующее действие**:  

1. Удалите датчики, связанные с устройством с помощью ускорителя.  
2. Если вы хотите связать датчики с другим устройством, попросите партнера устройства сделать то же самое.  
3. Удалите устройство с помощью вызова `DELETE API` и задайте для параметра Force значение *true*.  

**Сообщение**: "на устройстве имеется ссылка на устройство как парентдевицеид: в качестве дочерних устройств есть одно или несколько устройств, связанных с этим устройством. Удалите их, а затем удалите это устройство ".  

**Это означает**: устройство имеет связанные с ним другие устройства.  

**Корректирующее действие**

1. Удалите устройства, связанные с этим устройством.  
2. Удаление конкретного устройства.  

    > [!NOTE]
    > Вы не можете удалить устройство, если с ним связаны датчики. Дополнительные сведения об удалении связанных датчиков см. в разделе "Удаление датчика" статьи [Получение данных датчика от партнеров датчиков](get-sensor-data-from-sensor-partner.md).


## <a name="issues-with-jobs"></a>Проблемы с заданиями

### <a name="farmbeats-internal-error"></a>Внутренняя ошибка Фармбеатс

**Сообщение**: "Внутренняя ошибка фармбеатс. Дополнительные сведения см. в разделе" Руководство по устранению неполадок ".

**Корректирующее действие**. Эта проблема может возникать из-за временного сбоя в конвейере данных. Создайте задание еще раз. Если ошибка повторяется, добавьте сообщение об ошибке в запись на форуме Фармбеатс или обратитесь в FarmBeatsSupport@microsoft.com.

## <a name="accelerator-troubleshooting"></a>Устранение неполадок ускорителя

### <a name="access-control"></a>Управление доступом

**Причина**. при добавлении назначения ролей появляется сообщение об ошибке.

**Сообщение**: "не найдены соответствующие пользователи".

**Корректирующее действие**. Проверьте идентификатор электронной почты, для которого вы пытаетесь добавить назначение ролей. Идентификатор электронной почты должен быть точным совпадением с ИДЕНТИФИКАТОРом, зарегистрированным для этого пользователя в Active Directory. Если ошибка повторяется, добавьте сообщение об ошибке в запись на форуме Фармбеатс или обратитесь в FarmBeatsSupport@microsoft.com.

### <a name="unable-to-log-in-to-accelerator"></a>Не удается войти в ускоритель

**Сообщение**: "ошибка: у вас нет права на вызов службы. Обратитесь к администратору для авторизации.

**Корректирующее действие**: попросите администратора авторизовать вас для доступа к развертыванию фармбеатс. Это можно сделать, выполнив POST of API RoleAssignment или с помощью элемента управления доступом на панели **параметров** в ускорителе.  

Если вы уже предоставили доступ и столкнулись с этой ошибкой, повторите попытку, обновив страницу. Если ошибка повторяется, добавьте сообщение об ошибке в запись на форуме Фармбеатс или обратитесь в FarmBeatsSupport@microsoft.com.

![Проект Фармбеатс](./media/troubleshoot-azure-farmbeats/accelerator-troubleshooting-1.png)

### <a name="accelerator-issues"></a>Проблемы ускорителя  

Причина **. Вы**получили сообщение об ошибке ускорителя неопределенной причины.

**Сообщение**: "ошибка: произошла неизвестная ошибка".

**Корректирующее действие**. Эта ошибка возникает, если время бездействия страницы слишком велико. Обновите страницу.  

Если ошибка повторяется, добавьте сообщение об ошибке в запись на форуме Фармбеатс или обратитесь в FarmBeatsSupport@microsoft.com.

**Причина**: ускоритель фармбеатс не отображает последнюю версию, даже после обновления фармбеатсдеплоймент.

**Корректирующее действие**. Эта ошибка возникает из-за сохраняемости рабочего процесса службы в браузере. Выполните следующие действия.
1. Закройте все вкладки браузера, в которых открыт ускоритель, и закройте окно браузера.
2. Запустите новый экземпляр браузера и перезагрузите URI ускорителя. Это действие загружает новую версию ускорителя.

## <a name="sentinel-imagery-related-issues"></a>Sentinel: проблемы, связанные с изображениями

### <a name="wrong-username-or-password"></a>Неправильное имя пользователя или пароль

**Сообщение об ошибке задания**: "для доступа к этому ресурсу требуется полная проверка подлинности".

**Корректирующее действие**:

Выполните одно из следующих действий.
- Повторно запустите установщик для обновления Датахуб с правильным именем пользователя и паролем.
- Перезапустите невыполненное задание или выполните задание вспомогательных индексов для диапазона дат от 5 до 7 дней, а затем проверьте, успешно ли задано это задание.

### <a name="sentinel-hub-wrongurlor-site-not-accessible"></a>Концентратор Sentinel: неправильный URL-адрес или сайт недоступен 

**Сообщение об ошибке задания**: "Ой, что-то пошло не так. Страница, к которой вы пытаетесь получить доступ, является (временно) недоступна ". 

**Корректирующее действие**:
1. Откройте [метку](https://scihub.copernicus.eu/dhus/) в браузере, чтобы узнать, доступен ли веб-сайт. 
2. Если веб-сайт недоступен, проверьте, не блокирует ли какой-либо брандмауэр, сеть компании или другое программное обеспечение для блокировки доступ к веб-сайту, а затем выполните необходимые действия, чтобы разрешить этот параметр. 
3. Перезапустите невыполненное задание или выполните задание вспомогательных индексов для диапазона дат от 5 до 7 дней, а затем проверьте, успешно ли задано это задание.  

### <a name="sentinel-server-down-for-maintenance"></a>Сервер Sentinel: отключено для обслуживания

**Сообщение об ошибке задания**: "в ближайшее время откроется центр Коперникус Open Access! К сожалению, в данный момент выполняется некоторое обслуживание. Вскоре мы вернемся к сети. 

**Корректирующее действие**:

Эта проблема может возникать, если на сервере Sentinel выполняются какие бы то ни было действия по обслуживанию.

1. Если выполнение какого-либо задания или конвейера завершится сбоем, так как выполняется обслуживание, повторно отправьте задание через некоторое время. 

   Сведения о плановых или незапланированных действиях по обслуживанию Sentinel см. на веб-сайте [Коперникус Open Access](https://scihub.copernicus.eu/news/) .  
2. Перезапустите невыполненное задание или выполните задание вспомогательных индексов для диапазона дат от 5 до 7 дней, а затем проверьте, успешно ли задано это задание.

### <a name="sentinel-maximum-number-of-connections-reached"></a>Sentinel: достигнуто максимальное число подключений

**Сообщение об ошибке задания**: "максимальное число одновременных потоков, достигнутых пользователем"\<username > ".

**Значение**. Если задание завершается сбоем из-за достижения максимального количества подключений, то одна и та же учетная запись-метка используется в другом развертывании программного обеспечения.

**Корректирующее действие**: выполните одно из следующих действий.
* Создайте новую учетную запись-Sentinel, а затем повторно запустите установщик, чтобы обновить Датахуб с помощью нового имени пользователя и пароля Sentinel.  
* Перезапустите невыполненное задание или выполните задание вспомогательных индексов для диапазона дат от 5 до 7 дней, а затем проверьте, успешно ли задано это задание.

### <a name="sentinel-server-refused-connection"></a>Сервер Sentinel: отклоненное подключение 

**Сообщение об ошибке задания**: "Сервер отклонил подключение в: http://172.30.175.69:8983/solr/dhus". 

**Корректирующее действие**. Эта проблема может возникать, если на сервере Sentinel выполняются какие бы то ни было действия по обслуживанию. 
1. Если выполнение какого-либо задания или конвейера завершится сбоем, так как выполняется обслуживание, повторно отправьте задание через некоторое время. 

   Сведения о плановых или незапланированных действиях по обслуживанию Sentinel см. на веб-сайте [Коперникус Open Access](https://scihub.copernicus.eu/news/) .  
2. Перезапустите невыполненное задание или выполните задание вспомогательных индексов для диапазона дат от 5 до 7 дней, а затем проверьте, успешно ли задано это задание.

## <a name="collect-logs-manually"></a>Собирайте журналы вручную

[Установите и разверните обозреватель службы хранилища Azure]( https://docs.microsoft.com/azure/vs-azure-tools-storage-manage-with-storage-explorer?tabs=windows).

### <a name="collect-azure-data-factory-job-logs-in-datahub"></a>Получение журналов заданий фабрики данных Azure в Датахуб
1. Войдите на [портал Azure](https://portal.azure.com).
2. В поле **поиска** найдите группу ресурсов фармбеатс датахуб.

    > [!NOTE]
    > Выберите группу ресурсов Датахуб, указанную во время установки Фармбеатс.

3. На панели мониторинга **группы ресурсов** найдите учетную запись хранения *датахублогс\** . Например, выполните поиск по запросу **датахублогсмвксмк**.  
4. В столбце **имя** выберите учетную запись хранения, чтобы просмотреть панель мониторинга **учетной записи хранения** .
5. В области **\*датахубблогс** выберите **Открыть в обозревателе** , чтобы просмотреть приложение **Open обозреватель службы хранилища Azure** .
6. В левой области выберите **контейнеры больших двоичных объектов**, а затем выберите **журналы заданий**.
7. В области **журналы заданий** выберите **скачать**.
8. Скачайте журналы в локальную папку на компьютере.
9. Отправьте скачанный ZIP-файл по электронной почте в farmbeatssupport@microsoft.com.

    ![Проект Фармбеатс](./media/troubleshoot-azure-farmbeats/collecting-logs-manually-1.png)

### <a name="collect-azure-data-factory-job-logs-in-accelerator"></a>Получение журналов заданий фабрики данных Azure в ускорителе

1. Войдите на [портал Azure](https://portal.azure.com).
2. В поле **поиска** найдите группу ресурсов ускорителя фармбеатс.

    > [!NOTE]
    > Выберите группу ресурсов ускорителя, указанную во время установки Фармбеатс.

3. На панели мониторинга **группы ресурсов** найдите учетную запись хранения *\** хранилища. Например, выполните поиск по запросу **storagedop4k\*** .
4. Выберите учетную запись хранения в столбце **имя** , чтобы просмотреть панель мониторинга **учетной записи хранения** .
5. В области **\*хранилища** выберите **Открыть в обозревателе** , чтобы открыть приложение обозреватель службы хранилища Azure.
6. В левой области выберите **контейнеры больших двоичных объектов**, а затем выберите **журналы заданий**.
7. В области **журналы заданий** выберите **скачать**.
8. Скачайте журналы в локальную папку на компьютере.
9. Отправьте скачанный ZIP-файл по электронной почте в farmbeatssupport@microsoft.com.


### <a name="collect-datahub-app-service-logs"></a>Получение журналов службы приложений Датахуб

1. Войдите на [портал Azure](https://portal.azure.com).
2. В поле **поиска** найдите группу ресурсов фармбеатс датахуб.

    > [!NOTE]
    > Выберите группу ресурсов Датахуб, указанную во время установки Фармбеатс.

3. В группе ресурсов найдите учетную запись хранения *датахублогс\** . Например, выполните поиск по запросу **фордатахублогсмвксмк\*** .
4. Выберите учетную запись хранения в столбце **имя** , чтобы просмотреть панель мониторинга **учетной записи хранения** .
5. В области **\*датахубблогс** выберите **Открыть в обозревателе** , чтобы открыть приложение обозреватель службы хранилища Azure.
6. В левой области щелкните **контейнеры больших двоичных объектов**, а затем выберите **appinsights-logs**.
7. В области **appinsights-logs (журналы** ) выберите **Download (скачать**).
8. Скачайте журналы в локальную папку на компьютере.
9. Отправьте скачанный ZIP-файл по электронной почте в farmbeatssupport@microsoft.com.

### <a name="collect-accelerator-app-service-logs"></a>Получение журналов службы приложений ускорителя

1. Войдите на [портал Azure](https://portal.azure.com).
2. В поле **поиска** найдите группу ресурсов ускорителя фармбеатс.

    > [!NOTE]
    > Выберите группу ресурсов ускорителя Фармбеатс, которая была предоставлена во время установки Фармбеатс.

3. В группе ресурсов найдите учетную запись хранения *\** хранилища. Например, выполните поиск по запросу **storagedop4k\*** .
4. Выберите учетную запись хранения в столбце **имя** , чтобы просмотреть панель мониторинга **учетной записи хранения** .
5. В области **\*хранилища** выберите **Открыть в обозревателе** , чтобы открыть приложение обозреватель службы хранилища Azure.
6. В левой области щелкните **контейнеры больших двоичных объектов**, а затем выберите **appinsights-logs**.
7. В области **appinsights-logs (журналы** ) выберите **Download (скачать**).
8. Скачайте журналы в локальную папку на компьютере.
9. Отправьте скачанную папку по электронной почте farmbeatssupport@microsoft.com.

## <a name="known-issues"></a>Известные проблемы

## <a name="batch-related-issues"></a>Проблемы, связанные с пакетами

**Сообщение об ошибке**: "была достигнута квота на региональные учетные записи пакетной службы для указанной подписки".

**Корректирующее действие**: Увеличьте квоту или удалите неиспользуемые учетные записи пакетной службы и повторно запустите развертывание.

### <a name="azure-active-directory-azure-ad-related-issues"></a>Azure Active Directory (Azure AD) — вопросы, связанные с

**Сообщение об ошибке**: "не удалось обновить необходимые параметры для Azure AD App d41axx40-xx21-4fbd-8xxf-97Xxx9e2xxc0: недостаточно прав для завершения операции. Убедитесь, что указанные выше параметры правильно настроены для Azure AD App ".

**Это означает**, что конфигурация регистрации приложения Azure AD не была выполнена должным образом.  

**Корректирующее действие**. обратитесь к ИТ-администратору (у человека с правами на чтение клиента), чтобы использовать наш [сценарий](https://github.com/Azure-Samples/active-directory-dotnet-webapp-openidconnect/tree/master/AppCreationScripts) для создания регистрации приложения Azure AD. Этот сценарий также автоматически предпринимает меры по настройке.

**Сообщение об ошибке**: "не удалось создать новое Active Directory приложение"\<имя приложения\>"в этом клиенте: другой объект с таким же значением для URI идентификатора свойства уже существует".

**Это означает, что**регистрация приложения Azure AD с таким именем уже существует.

**Корректирующее действие**. Удалите существующую регистрацию приложения Azure AD или повторно используйте ее для установки. Если вы повторно используете существующую регистрацию приложения Azure AD, передайте в установщик и повторное развертывание идентификатор приложения и секрет клиента.

## <a name="issues-with-the-inputjson-file"></a>Проблемы с входным файлом. JSON

**Ошибка**: ошибка при чтении входных данных из файла *input. JSON* .

**Корректирующее действие**. обычно эта проблема возникает из-за ошибки при указании пути или имени файла *input. JSON* в установщике. Внесите соответствующие исправления и повторите развертывание.

**Ошибка**: ошибка при анализе значений в файле *input. JSON* .

**Корректирующее действие**. Эта проблема в основном возникает из-за неверных значений в файле *input. JSON* . Внесите соответствующие исправления и повторите развертывание.

## <a name="high-cpu-usage"></a>Высокая загрузка ЦП

**Ошибка**. Вы получаете оповещение по электронной почте, которое ссылается на **оповещение о высокой загрузке ЦП**. 

**Корректирующее действие**: 
1. Перейдите в группу ресурсов Фармбеатс Датахуб.
2. Выберите **службу приложений**.  
3. Перейдите на [страницу цен масштабирования службы приложений](https://azure.microsoft.com/pricing/details/app-service/windows/)и выберите соответствующую ценовую категорию.

## <a name="next-steps"></a>Дальнейшие действия

Если вы по-прежнему сталкиваетесь с Фармбеатс проблемами, обратитесь к нашему [форуму службы поддержки](https://social.msdn.microsoft.com/Forums/home?forum=ProjectFarmBeats).
