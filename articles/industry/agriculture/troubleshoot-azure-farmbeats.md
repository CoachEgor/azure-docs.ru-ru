---
title: Устранение неполадок в Azure FarmBeats
description: В этой статье описывается, как устранить неполадки Azure FarmBeats.
author: uhabiba04
ms.topic: article
ms.date: 11/04/2019
ms.author: v-umha
ms.openlocfilehash: a40c64910260a2d63a529d25e1089fb618fcec1b
ms.sourcegitcommit: fb23286d4769442631079c7ed5da1ed14afdd5fc
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/10/2020
ms.locfileid: "81113493"
---
# <a name="troubleshoot"></a>Диагностика

В этой статье приведены решения общих проблем Azure FarmBeats. Для получения дополнительной помощи свяжитесь farmbeatssupport@microsoft.comс нами [форум поддержки](https://social.msdn.microsoft.com/Forums/home?forum=ProjectFarmBeats) или напишите нам по адресу .

> [!NOTE]
  > Если вы установили FarmBeats в апреле и ваши рабочие места не сдаются с пустым сообщением об ошибке, ваша установка, возможно, не была выделена какой-либо пакетной квоты для определения приоритетов поддержки для критически важных организаций по охране здоровья и безопасности. Более подробную информацию можно узнать [здесь.](https://azure.microsoft.com/blog/update-2-on-microsoft-cloud-services-continuity/) Для успешного выполнения заданий необходимо запросить выделение ввоза в пакет.

## <a name="install-issues"></a>Установка проблем

  > [!NOTE]
  > Если вы перезапускаете установку из-за ошибки, убедитесь, что удалите **группу ресурсов** или удалите все ресурсы из группы ресурсов перед повторной запуском установки.

### <a name="invalid-sentinel-credentials"></a>Недействительные учетные данные Sentinel

Учетные данные Sentinel, предоставленные при установке, неверны. Перезапустите установку с помощью правильных учетных данных.

### <a name="the-regional-account-quota-of-batch-accounts-for-the-specified-subscription-has-been-reached"></a>Достигнута региональная квота на счета пакетных счетов для указанной подписки

Увеличьте квоту или удалите неиспользованные учетные записи и перезапустите установку.

### <a name="invalid-resource-group-location"></a>Местоположение недействительной группы ресурсов

Убедитесь, что **Группа ресурсов** находится в том же месте, что и **Регион,** указанный во время установки.

### <a name="other-install-issues"></a>Другие проблемы с установкой

Свяжитесь с нами со следующими подробностями:

- Идентификатор подписки
- Имя группы ресурсов
- Следуйте ниже шаги, чтобы прикрепить файл журнала для сбоя развертывания:

    1. Перейдите к **группе ресурсов** на портале Azure.

    2. Выберите **развертывания** под **разделом «Настройки»** на левой стороне.

    3. Для каждого развертывания, отображаемого **не удалось,** выберите детали и загрузите детали развертывания. Прикрепите этот файл к почте.

## <a name="sensor-telemetry"></a>Сенсорная телеметрия

### <a name="cant-view-telemetry-data"></a>Не уклониться от просмотра телеметрических данных

**Симптом :** Устройства или датчики развернуты, и вы связали FarmBeats с вашим партнером устройства, но вы не можете получить или просмотреть телеметрические данные на FarmBeats.

**Действие по исправлению**

1. Перейдите в группу ресурсов FarmBeats Datahub.
2. Выберите **концентратор событий** (DatafeedEventHubNamespace), а затем проверьте количество входящих сообщений.
3. Выполните одно из приведенных ниже действий.

   - Если *нет входящих сообщений,* свяжитесь с вашим партнером устройства.  
   - Если есть *входящие сообщения,* свяжитесь с нами с вашими журналами Datahub и Accelerator и захваченными телеметрией.

Чтобы понять, как загружать журналы, перейдите в раздел ["Сбор журналов вручную".](#collect-logs-manually)  

### <a name="cant-view-telemetry-data-after-ingesting-historicalstreaming-data-from-your-sensors"></a>Не уклониться от просмотра телеметрических данных после попавания исторических/потоковых данных с датчиков

**Симптом**: Устройства или датчики развернуты, и вы создали устройства / датчики на FarmBeats и попадает телеметрии в EventHub, но вы не можете получить или просмотреть телеметрические данные на FarmBeats.

**Действие по исправлению**

1. Убедитесь, что вы сделали регистрацию партнера правильно - вы можете проверить это, перейдя к datahub чванство, перейдите на / Партнер API, Do Получить и проверить, если партнер зарегистрирован. Если нет, выполните эти [шаги,](get-sensor-data-from-sensor-partner.md#enable-device-integration-with-farmbeats) чтобы добавить партнера.

2. Убедитесь, что вы использовали правильный формат сообщения Телеметрии:

```json
{
"deviceid": "<id of the Device created>",
"timestamp": "<timestamp in ISO 8601 format>",
"version" : "1",
"sensors": [
    {
      "id": "<id of the sensor created>",
      "sensordata": [
        {
          "timestamp": "< timestamp in ISO 8601 format >",
          "<sensor measure name (as defined in the Sensor Model)>":"<value>"
        },
        {
          "timestamp": "<timestamp in ISO 8601 format>",
          "<sensor measure name (as defined in the Sensor Model)>": "<value>"
        }
      ]
    }
 ]
}
```

### <a name="dont-have-the-azure-event-hubs-connection-string"></a>У вас нет строки подключения кцентров azure Event

**Действие по исправлению**

1. В Datahub Swagger перейдите на API-партнер.
2. Выберите **Получить Попробуйте** > **выполнить** > **Execute**.

> [!NOTE]
> Идентификатор партнера-партнера датчика, который вас интересует.

3. Вернитесь к API-партнеру и выберите **Get/\<ID>. **
4. Укажите идентификатор партнера со ступени 3, а затем выберите **Execute.**

   Ответ API должен иметь строку соединения концентраторов событий.

### <a name="device-appears-offline"></a>Устройство отображается в автономном режиме

**Симптомы**: Устройства установлены, и вы связали FarmBeats с вашим партнером устройства. Устройства находятся в режиме онлайн и отправляют телеметрические данные, но они отображаются в автономном режиме.

**Корректирующие действия** Интервал отчетности не настроен для этого устройства. Чтобы установить интервал отчетности, свяжитесь с производителем устройства. 

### <a name="error-deleting-a-device"></a>Ошибка удаляемого устройства

При удаление устройства можно столкнуться с одним из следующих распространенных сценариев ошибок:  

**Сообщение**: "Устройство ссылается на датчики: Есть один или несколько датчиков, связанных с устройством. Удалите датчики, а затем удалите устройство».  

**Значение**: Устройство связано с несколькими датчиками, которые развернуты на ферме.

**Действие по исправлению**  

1. Удалите датчики, связанные с устройством, через ускоритель.  
2. Если вы хотите связать датчики с другим устройством, попросите партнера по устройству сделать то же самое.  
3. Удалите устройство `DELETE API` с помощью вызова и установите параметр силы как *верный.*  

**Сообщение**: "Устройство ссылается на устройства, как ParentDeviceId: Есть один или несколько устройств, которые связаны с этим устройством в качестве детских устройств. Удалите их, а затем удалите это устройство»...  

**Значение**: Ваше устройство имеет другие устройства, связанные с ним.  

**Действие по исправлению**

1. Удалите устройства, связанные с этим конкретным устройством.  
2. Удалите конкретное устройство.  

    > [!NOTE]
    > Вы не можете удалить устройство, если с ним связаны датчики. Для получения дополнительной информации о том, как [Get sensor data from sensor partners](get-sensor-data-from-sensor-partner.md)удалить связанные датчики, **см.**
    > Партнеры не имеют разрешения на удаление устройства или датчика. Только у админов есть разрешение на удаление.

## <a name="issues-with-jobs"></a>Проблемы с заданиями

### <a name="farmbeats-internal-error"></a>Внутренняя ошибка FarmBeats

**Сообщение**: "FarmBeats внутренней ошибки, см устранение неполадок руководство для более подробной информации".

**Корректирующие действия** Эта проблема может возникнуть в результате временного сбоя в конвейере данных. Создайте работу снова. Если ошибка сохраняется, свяжитесь с нами с сообщением об ошибке/ журналами.

## <a name="accelerator-troubleshooting"></a>Устранение неполадок ускорителя

### <a name="access-control"></a>Управление доступом

**Выпуск**: Вы получаете ошибку при добавлении назначения ролей.

**Сообщение:**"Не найдено подходящих пользователей".

**Корректирующие действия** Проверьте идентификатор электронной почты, для которого вы пытаетесь добавить назначение роли. Идентификатор электронной почты должен точно совпадать с идентификатором, который зарегистрирован для этого пользователя в Active Directory. Если ошибка сохраняется, свяжитесь с нами с сообщением об ошибке/ журналами.

### <a name="unable-to-log-in-to-accelerator"></a>Не удается войти в систему на акселератор

**Сообщение**: "Ошибка: Вы не уполномочены звонить в службу. Свяжитесь с администратором для получения разрешения»...

**Корректирующие действия** Попросите администратора разрешить вам доступ к развертыванию FarmBeats. Это можно сделать, сделав POST AAP RoleAssignment или через контроль доступа в панели **настроек** в accelerator.  

Если вы уже получили доступ и столкнулись с этой ошибкой, повторите попытку обновить страницу. Если ошибка сохраняется, свяжитесь с нами с сообщением об ошибке/ журналами.

![Проект ФермаБитс](./media/troubleshoot-azure-farmbeats/accelerator-troubleshooting-1.png)

### <a name="accelerator-issues"></a>Проблемы с ускорителем  

**Выпуск**: Вы получили ошибку ускорителя неустановленной причины.

**Сообщение**: "Ошибка: произошла неизвестная ошибка".

**Корректирующие действия** Эта ошибка возникает, если вы слишком долго оставляете страницу на холостом ходу. Обновите страницу. Если ошибка сохраняется, свяжитесь с нами с сообщением об ошибке/ журналами.

**Выпуск**: FarmBeats Accelerator не показывает последнюю версию, даже после того, как вы обновили FarmBeatsDeployment.

**Корректирующие действия** Эта ошибка возникает из-за настойчивости работника службы в браузере. Выполните следующие действия.

1. Закройте все вкладки браузера с открытым ускорителем и закройте окно браузера.
2. Запустите новый экземпляр браузера и перезагрузите ускоритель URI. Это действие загружает новую версию ускорителя.

## <a name="sentinel-imagery-related-issues"></a>Sentinel: Вопросы, связанные с изображениями

### <a name="wrong-username-or-password"></a>Неправильное имя пользователя или пароль

**Сообщение о сбое работы:**"Для доступа к этому ресурсу требуется полная аутентификация".

**Корректирующее действие**: Сделайте одно из следующих:

- Обновление FarmBeats с правильным именем пользователя / пароль, используя ниже шаги и повторить работу.

  **Обновление имени пользователя Sentinel**

    1. Войдите на [портал Azure](https://portal.azure.com).
    2. В поле **поиска** ищите группу ресурсов FarmBeats Datahub.
    3. Выберите хранилище учетной записи хранения данных > **контейнеры** > **пакетные препи-файлы** > **to_vm** > **config.ini**
    4. Выберите **edit**
    5. Обновление имени пользователя в разделе sentinel_account

  **Обновление паролей Sentinel**

    1. Войдите на [портал Azure](https://portal.azure.com).
    2. В поле **поиска** ищите группу ресурсов FarmBeats Datahub.
    3. Выберите keyvault-'
    4. Выберите политики доступа в настройках
    5. Выберите **политику добавления доступа**
    6. Используйте **секретное управление** для настройки из шаблона и добавьте себя к директору
    7. Выберите **Добавить,** а затем выберите **Сохранить** на странице **политики доступа**
    8. Выберите **секреты** под **настройками**
    9. Выберите **Sentinel-пароль**
    10. Создайте новую версию значения и включите его.

- Повторное задание с невыполненным или запуск задания спутниковых индексов для диапазона дат от 5 до 7 дней, а затем проверьте, является ли задание успешным.

### <a name="sentinel-hub-wrongurlor-site-not-accessible"></a>Sentinel концентратор: Неправильный URL или сайт недоступен

**Сообщение о сбое в работе:**"Ой, что-то пошло не так. Страница, к доступу к ней вы пытались получить доступ, (временно) недоступна».

**Корректирующее действие**:

1. Откройте [Sentinel](https://scihub.copernicus.eu/dhus/) в вашем браузере, чтобы узнать, доступен ли веб-сайт.
2. Если веб-сайт недоступен, проверьте, не мешает ли какой-либо брандмауэр, сеть компании или другое блокирующее программное обеспечение доступ к веб-сайту, а затем примите необходимые меры для предоставления URL-адреса Sentinel. 
3. Повторное задание с невыполненным или запуск задания спутниковых индексов для диапазона дат от 5 до 7 дней, а затем проверьте, является ли задание успешным.  

### <a name="sentinel-server-down-for-maintenance"></a>Sentinel сервер: Вниз для обслуживания

**Сообщение о сбое в работе:**"Концентратор открытого доступа Коперника скоро вернется! Извините за неудобства, мы выполняем некоторые обслуживания в данный момент. Мы вернемся в сети в ближайшее время! 

**Корректирующее действие**:

Эта проблема может возникнуть, если какие-либо действия по техническому обслуживанию выполняются на сервере Sentinel.

1. Если какое-либо задание или конвейер не выполняется из-за выполнения технического обслуживания, повторно отправьте задание через некоторое время. 

   Для получения информации о любых запланированных или незапланированных мероприятиях по техническому обслуживанию Sentinel, перейдите на сайт [новостей Copernicus Open Access Hub.](https://scihub.copernicus.eu/news/)  

2. Повторное задание с невыполненным или запуск задания спутниковых индексов для диапазона дат от 5 до 7 дней, а затем проверьте, является ли задание успешным.

### <a name="sentinel-maximum-number-of-connections-reached"></a>Sentinel: Максимальное количество подключений достигло

**Сообщение о сбое в работе:**"Максимальное\<количество двух одновременных потоков, достигаемых пользователем "имя пользователя>".

**Значение**: Если задание не удается, потому что максимальное количество соединений было достигнуто, та же учетная запись Sentinel используется в нескольких заданиях.

**Корректирующее действие**: Попробуйте любой из следующих:

* Подождите, пока другие задания закончатся, прежде чем повторно запустить неудавшуюся работу.
* Создайте новую учетную запись Sentinel, а затем обновите имя пользователя sentinel и пароль в FarmBeats.

### <a name="sentinel-server-refused-connection"></a>Сервер Sentinel: Отказ от подключения

**Сообщение о сбое в** http://172.30.175.69:8983/solr/dhusработе : "Сервер отказался от подключения по адресу: ."

**Корректирующие действия**: Эта проблема может возникнуть, если какие-либо действия по техническому обслуживанию выполняются на сервере Sentinel.

1. Если какое-либо задание или конвейер не выполняется из-за выполнения технического обслуживания, повторно отправьте задание через некоторое время.

   Для получения информации о любых запланированных или незапланированных мероприятиях по техническому обслуживанию Sentinel, перейдите на сайт [новостей Copernicus Open Access Hub.](https://scihub.copernicus.eu/news/)  

2. Повторное задание с невыполненным или запуск задания спутниковых индексов для диапазона дат от 5 до 7 дней, а затем проверьте, является ли задание успешным.

### <a name="soil-moisture-map-has-white-areas"></a>Карта влажности почвы имеет белые области

**Выпуск**: **Карта влажности почвы** была создана, но карта имеет в основном белые области.

**Корректирующее действие**: Эта проблема может возникнуть, если спутниковые индексы, генерируемые на время, за которое была запрошена карта, имеют значения NDVI, которые меньше 0,3. Для получения дополнительной информации посетите [Технический гид от Sentinel](https://earth.esa.int/web/sentinel/technical-guides/sentinel-2-msi/level-2a/algorithm).

1. Повторное задание для другого диапазона дат и проверьте, являются ли значения NDVI в индексах спутника более 0,3.

## <a name="collect-logs-manually"></a>Сбор журналов вручную

[Установка и развертывание Azure Storage Explorer.]( https://docs.microsoft.com/azure/vs-azure-tools-storage-manage-with-storage-explorer?tabs=windows)

### <a name="collect-azure-data-factory-job-logs-or-app-service-logs-in-datahub"></a>Соберите журналы задания Azure Data Factory или журналы службы приложений в Datahub

1. Войдите на [портал Azure](https://portal.azure.com).
2. В поле **поиска** ищите группу ресурсов FarmBeats Datahub.
3. На панели мониторинга **Группы ресурсов** ищите учетную запись хранения *\* данных.* Например, *datahublogsmvxmq*.  
4. В столбце **«Имя»** выберите учетную запись хранилища для просмотра панели **мониторинга.**
5. В панели **datahubblogs\* ** выберите **Open in Explorer** для просмотра приложения Open **Azure Storage Explorer.**
6. В левой панели выберите **контейнеры Blob,** а затем выберите **журналы вакансий** для журналов Azure Data Factory или **журналов appinsights** для журналов Службы приложений.
7. Выберите **Скачать** и загрузить журналы в локальную папку на вашем компьютере.

    ![Проект ФермаБитс](./media/troubleshoot-azure-farmbeats/collecting-logs-manually-1.png)

### <a name="collect-azure-data-factory-job-logs-or-app-service-logs-for-accelerator"></a>Соберите журналы вакансий Azure Data Factory или журналы служб приложений для акселератора

1. Войдите на [портал Azure](https://portal.azure.com).
2. В поле **поиска** ищите группу ресурсов FarmBeats Accelerator.
3. На панели мониторинга **Группы ресурсов** ищите учетную запись *\* хранилища.* Например, *storagedop4k\**.
4. Выберите учетную запись хранилища в столбце **«Имя»** для просмотра панели мониторинга **учетной записи хранения.**
5. В панели **хранения\* ** выберите **Открыть в Explorer,** чтобы открыть приложение Azure Storage Explorer.
6. В левой панели выберите **контейнеры Blob,** а затем выберите **журналы вакансий** для журналов Azure Data Factory или **журналов appinsights** для журналов Службы приложений.
7. Выберите **Скачать** и загрузить журналы в локальную папку на вашем компьютере.

## <a name="high-cpu-usage"></a>Высокая загрузка ЦП

**Ошибка**: Вы получаете оповещение по электронной почте, которое относится к **предупреждению об использовании процессора.**

**Корректирующее действие**:

1. Перейдите в группу ресурсов FarmBeats Datahub.
2. Выберите **службу app.**  
3. Перейдите на страницу повышения [цен Службы App,](https://azure.microsoft.com/pricing/details/app-service/windows/)а затем выберите соответствующий уровень ценообразования.
