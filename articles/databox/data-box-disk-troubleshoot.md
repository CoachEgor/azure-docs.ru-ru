---
title: Устранение неполадок диска Azure Data Box | Документация Майкрософт
description: В этой статье описывается, как устранить проблемы, обнаруженные на диске Azure Data Box.
services: databox
author: alkohli
ms.service: databox
ms.subservice: disk
ms.topic: article
ms.date: 04/2/2019
ms.author: alkohli
ms.openlocfilehash: f9d01b56da2650be395878ce07e4aae73495061f
ms.sourcegitcommit: c53a800d6c2e5baad800c1247dce94bdbf2ad324
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/30/2019
ms.locfileid: "64939640"
---
# <a name="troubleshoot-issues-in-azure-data-box-disk"></a>Устранение неполадок с Диском Azure Data Box

Эта статья применяется к Диску Microsoft Azure Data Box и описывает рабочие процессы, используемые для устранения любых неполадок, возникающих при развертывании этого решения. 

В этой статье содержатся следующие разделы:

- Загрузка журналов диагностики
- Запрос журналов действий
- Ошибки средства разблокировки диска Data Box
- Ошибки средства Data Box Disk Split Copy

## <a name="download-diagnostic-logs"></a>Загрузка журналов диагностики

Если во время процесса копирования данных имеются какие-либо ошибки, портал покажет путь к папке, в которой находятся журналы диагностики. 

Журналы диагностики делятся на две группы.
- Журналы ошибок
- Журналы подробных сведений  

Чтобы перейти к пути для копирования журнала, перейдите в учетную запись хранения, связанную с заказом Data Box. 

1.  Перейдите в **Общие > Сведения о заказе** и отметьте учетную запись хранения, связанную с заказом.
 

2.  Перейдите в раздел **Все ресурсы** и найдите учетную запись хранения, указанную на предыдущем шаге. Выберите и щелкните учетную запись хранения.

    ![Копирование журналов 1](./media/data-box-disk-troubleshoot/data-box-disk-copy-logs1.png)

3.  Перейдите в раздел **Служба BLOB-объектов > Просмотреть BLOB-объекты** и найдите BLOB-объект, соответствующий учетной записи хранения. Перейдите к **diagnosticslogcontainer > waies**. 

    ![Копирование журналов 2](./media/data-box-disk-troubleshoot/data-box-disk-copy-logs2.png)

    Вы увидите как журналы ошибок, так и подробные журналы для копирования данных. Выберите и щелкните каждый файл, а затем загрузите локальную копию.

## <a name="query-activity-logs"></a>Запрос журналов действий

Журналы действий используются для поиска ошибки при устранении неполадок, а также для наблюдения за тем, как пользователь организации изменяет ресурс. С помощью журналов действий можно определить:

- Какие операции выполнялись с ресурсами в подписке.
- Сторона, инициировавшая операцию.
- Когда была выполнена операция.
- Состояние операции.
- Значения других свойств, которые могут помочь в анализе операции.

Журнал действий содержит все операции записи (PUT, POST, DELETE), выполняемые с ресурсами, но не содержит операций чтения (таких как GET).

Журналы изменений сохраняются в течение 90 дней. Вы можете запросить любой диапазон дат, при условии, что дата начала не старше 90 дней в прошлом. Также можно фильтровать один из встроенных запросов в аналитических сведениях. Например, щелкните ошибку, а затем выберите и щелкните конкретные ошибки, чтобы понять основную причину.

## <a name="data-box-disk-unlock-tool-errors"></a>Ошибки средства разблокировки диска Data Box


| Сообщение об ошибке/Режимы работы средства      | Рекомендации                                                                                               |
|-------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------|
| Нет<br><br>Аварийное завершение средства разблокировки диска Data Box.                                                                            | Bitlocker не установлен. Убедитесь, что на главном компьютере, на котором установлено средство разблокировки диска Data Box, установлен BitLocker.                                                                            |
| Текущая платформа .NET не поддерживается. Поддерживаемые версии — 4.5 и более поздние.<br><br>Средство завершит свою работу с сообщением.  | Платформа .NET версии 4.5 не установлена. Установите .NET 4.5 или более поздней версии на главном компьютере, на котором запущено средство разблокировки диска Data Box.                                                                            |
| Не удалось разблокировать или проверить какие-либо тома. Обратитесь в службу технической поддержки Майкрософт.  <br><br>Средство не может разблокировать или проверить заблокированный диск. | Средству не удалось разблокировать ни один из заблокированных дисков с помощью поставляемого ключа доступа. Обратитесь в службу поддержки Майкрософт, чтобы узнать, что делать дальше.                                                |
| Следующие тома разблокированы и проверены. <br>Буквы диска тома: E.<br>Не удалось разблокировать все тома со следующими ключами доступа: werwerqomnf, qwerwerqwdfda <br><br>Средство разблокирует некоторые диски и перечислит успешные и неудачные буквы дисков.| Частично удалось. Не удалось разблокировать некоторые диски с помощью поставляемого ключа доступа. Обратитесь в службу поддержки Майкрософт, чтобы узнать, что делать дальше. |
| Не удалось найти заблокированные тома. Проверьте, что диск, полученный от Microsoft, подключен правильно и находится в заблокированном состоянии.          | Средству не удается найти заблокированные диски. Либо диски уже разблокированы или не обнаружены. Убедитесь, что диски подключены и заблокированы.                                                           |
| Неустранимая ошибка: недопустимый параметр.<br>Имя параметра: invalid_arg<br>Использование.<br>DataBoxDiskUnlock /Ключи доступа:<passkey_list_separated_by_semicolon><br><br>Пример: DataBoxDiskUnlock /PassKeys:passkey1;passkey2;passkey3.<br>Пример: DataBoxDiskUnlock /SystemCheck.<br>Пример: DataBoxDiskUnlock /Help.<br><br>/PassKeys:       получите этот ключ доступа из заказа Диска Azure Data Box. Ключ доступа разблокирует диски.<br>/Help:           этот параметр предоставляет справку об использовании командлета и примеры.<br>/SystemCheck:    этот параметр проверяет, соответствует ли система требованиям для запуска средства.<br><br>Нажмите любую клавишу, чтобы выйти. | Недопустимый ввод параметра. Только разрешенные параметры являются /SystemCheck /PassKey и/Help.                                                                            |

## <a name="data-box-disk-split-copy-tool-errors"></a>Ошибки средства Data Box Disk Split Copy

|Сообщение об ошибке и предупреждения  |Рекомендации |
|---------|---------|
|[Сведения] Получение пароля BitLocker для тома: m <br>[Ошибка] При получении ключа BitLocker для тома m: Перехвачено исключение<br> В последовательности нет элементов.|Эта ошибка возникает в том случае, если целевой диск Data Box находятся в автономном режиме. <br> Используйте средство `diskmgmt.msc` для подключенных дисков.|
|[Ошибка] Возникло исключение. Операция WMI завершилась со сбоем:<br> Method=UnlockWithNumericalPassword, ReturnValue=2150694965, <br>Win32Message=недопустимый формат восстановления пароля. <br>Пароли восстановления BitLocker состоят из 48 цифр. <br>Убедитесь, что пароль восстановления установлен в правильном формате, и повторите попытку.|Используйте средство разблокировки диска Data Box, чтобы открыть диск, затем повторите команду. Дополнительные сведения см. в следующих разделах: <li> [Разблокировка дисков на клиенте Windows](data-box-disk-deploy-set-up.md#unlock-disks-on-windows-client). </li><li> [Разблокировка дисков на клиенте Linux](data-box-disk-deploy-set-up.md#unlock-disks-on-linux-client). </li>|
|[Ошибка] Возникло исключение. Файл DriveManifest.xml существует на целевом диске. <br> Это означает, что целевой диск был подготовлен с помощью другого файла журнала. <br>Чтобы добавить больше данных на тот же диск, используйте предыдущий файл журнала. Чтобы удалить имеющиеся данные и повторно использовать целевой диск для нового задания импорта, удалите DriveManifest.xml с диска. Повторно выполните команду с использованием нового файла журнала.| Эта ошибка возникает, если вы пытались использовать один и тот же набор дисков для нескольких сеансов импорта. <br> Используйте один набор дисков только для одного сеанса разделения и копирования.|
|[Ошибка] Возникло исключение. Данные импорта CopySessionId importdata-sept-test-1 ссылаются на предыдущий сеанс копирования, и их нельзя использовать повторно для нового сеанса копирования.|Эта ошибка возникает, если вы пытаетесь использовать то же имя задания, которое уже использовали для успешно выполненного задания.<br> Укажите уникальное имя для нового задания.|
|[Сведения] Имя конечного файла или каталога превышает ограничение по длине NTFS. |Это сообщение возникает, если конечный файл был переименован из-за длинного пути.<br> Измените расположение параметра в файле `config.json` для управления действиями такого типа.|
|[Ошибка] Возникло исключение. Неверная escape-последовательность JSON. |Это сообщение возникает, если файлу config.json назначен недопустимый формат. <br> Проверьте файл `config.json`, используя [JSONlint](https://jsonlint.com/), перед его сохранением.|

## <a name="deployment-issues-for-linux"></a>Проблемы с развертыванием для Linux

В этом разделе подробно рассматриваются некоторые из основных проблем, которые возникают при развертывании Диска Data Box в случае использования клиента Linux для копирования данных.

### <a name="issue-drive-getting-mounted-as-read-only"></a>Проблема Диск подключается как доступный только для чтения
 
**Причина** 

Это может быть вызвано некорректной работой файловой системы. 

Повторное подключение диска как доступного для чтения и записи не работает с Дисками Data Box. Этот сценарий не поддерживается для дисков, расшифрованных с помощью DisLocker. Вам может удастся повторно подключить устройство с помощью следующей команды:

    `# mount -o remount, rw /mnt/DataBoxDisk/mountVol1`

Хотя повторное подключение прошло успешно, данные не будут сохраняться.

**Способы устранения:**

Выполните следующие действия на компьютере Linux:

1. Установка `ntfsprogs` пакета для ntfsfix служебной программы.
2. Отключение точки подключения, предоставляемым средством unlock для диска. Число точек подключения будет изменяться для дисков.

    ```
    unmount /mnt/DataBoxDisk/mountVol1
    ```

3. Запустите `ntfsfix` на соответствующий путь. Выделенное число следует использовать тот же шаг 2.

    ```
    ntfsfix /mnt/DataBoxDisk/bitlockerVol1/dislocker-file
    ```

4. Выполните следующую команду для удаления метаданных спящего режима, который может вызвать проблемы подключения.

    ```
    ntfs-3g -o remove_hiberfile /mnt/DataBoxDisk/bitlockerVol1/dislocker-file /mnt/DataBoxDisk/mountVol1
    ```

5. Сделайте чистого отключения.

    ```
    ./DataBoxDiskUnlock_x86_64 /unmount
    ```

6. Выполните чистую unlock и подключения.
7. Тестировать точке подключения путем создания файла.
8. Отключите и снова подключить проверить сохраняемость файлов.
9. Продолжите копирование данных.
 
### <a name="issue-error-with-data-not-persisting-after-copy"></a>Проблема Ошибка с данными, не сохраняющимися после копирования
 
**Причина** 

Если вы видите, что на вашем диске нет данных после того, как он был отключен (хотя на него были скопированы данные), тогда, возможно, вы повторно подключили диск в качестве доступного для чтения и записи после того, как он был подключен как доступный только для чтения.

**Способы устранения:**
 
В этом случае просмотрите разрешения для [дисков, подключаемых как доступные только для чтения](#issue-drive-getting-mounted-as-read-only).

Если это не так, скопируйте журналы из папки, которая содержит средство разблокировки Диска Data Box, и [обратитесь в службу поддержки Майкрософт](data-box-disk-contact-microsoft-support.md).

## <a name="deployment-issues-for-windows"></a>Проблемы с развертыванием для Windows

В этом разделе подробно рассматриваются некоторые из основных проблем, которые возникают при развертывании Диска Data Box в случае использования клиента Windows для копирования данных.

### <a name="issue-could-not-unlock-drive-from-bitlocker"></a>Проблема Не удалось разблокировать диск из BitLocker
 
**Причина** 

Вы использовали пароль в диалоговом окне BitLocker и пытались разблокировать диск с помощью диалогового окна разблокировки в BitLocker. Это не будет работать. 

**Способы устранения:**

Чтобы разблокировать Диски Data Box, необходимо использовать средство разблокирования Дисков Data Box и предоставить пароль с портала Azure. Дополнительные сведения см. в статье [Руководство. Распаковка, подключение и разблокировка Диска Azure Data Box](data-box-disk-deploy-set-up.md#connect-to-disks-and-get-the-passkey).
 
### <a name="issue-could-not-unlock-or-verify-some-volumes-contact-microsoft-support"></a>Проблема Не удалось разблокировать или проверить некоторые тома. Обратитесь в службу технической поддержки Майкрософт.
 
**Причина** 

Вы можете увидеть следующую ошибку в журнале ошибок и не иметь возможности разблокировать или проверить некоторые тома.

`Exception System.IO.FileNotFoundException: Could not load file or assembly 'Microsoft.Management.Infrastructure, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35' or one of its dependencies. The system cannot find the file specified.`
 
Это означает, что в вашем клиенте Windows, скорее всего, отсутствует соответствующая версия Windows PowerShell.

**Способы устранения:**

Вы можете установить [Windows PowerShell версии 5.0](https://www.microsoft.com/download/details.aspx?id=54616) и повторить операцию.
 
Если тома по-прежнему не удается разблокировать, скопируйте журналы из папки, которая содержит средство разблокировки Диска Data Box, и [обратитесь в службу поддержки Майкрософт](data-box-disk-contact-microsoft-support.md).

## <a name="next-steps"></a>Дальнейшие действия

- Узнайте, как [управлять диском Data Box с помощью портала Azure](data-box-portal-ui-admin.md).
