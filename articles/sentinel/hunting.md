---
title: Возможности охоты в Azure Sentinel Документы Майкрософт
description: В этой статье описывается, как использовать возможности охоты Azure Sentinel.
services: sentinel
documentationcenter: na
author: yelevin
manager: rkarlin
editor: ''
ms.assetid: 6aa9dd27-6506-49c5-8e97-cc1aebecee87
ms.service: azure-sentinel
ms.subservice: azure-sentinel
ms.devlang: na
ms.topic: conceptual
ms.custom: mvc
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 09/10/2019
ms.author: yelevin
ms.openlocfilehash: 54ddf6818b95a4037188ab222501ddfa69b28149
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "77587904"
---
# <a name="hunt-for-threats-with-azure-sentinel"></a>Охота на угрозы с Azure Sentinel

Если вы исследователь, который хочет активно искать угрозы безопасности, Azure Sentinel мощно ищет поисковые запросы и инструменты поиска запросов для поиска угроз безопасности в источниках данных организации. Но ваши системы и устройства безопасности генерируют горы данных, которые могут быть трудно разобрать и фильтровать в значимые события. Чтобы помочь аналитикам безопасности активно искать новые аномалии, которые не были обнаружены вашими приложениями безопасности, встроенные охотничьи запросы Azure Sentinel помогут вам задать правильные вопросы, чтобы найти проблемы в данных, которые у вас уже есть в вашей сети. 

Например, один встроенный запрос предоставляет данные о самых необычных процессах, работающих на вашей инфраструктуре - вы не хотели бы оповещения о каждом разе их выполнения, они могут быть полностью невинными, но иногда можно посмотреть на запрос, чтобы увидеть, если есть что-то необычное. 



С охотой на Azure Sentinel вы можете воспользоваться следующими возможностями:

- Встроенные запросы: Для запуска стартовая страница предоставляет предустановленные примеры запросов, предназначенные для того, чтобы вы начали работу и ознакомились с таблицами и языком запросов. Эти встроенные охотничьи запросы разрабатываются исследователями безопасности Microsoft на постоянной основе, добавляя новые запросы и настраивая существующие запросы, чтобы предоставить вам точку входа для поиска новых обнаружений и выяснить, с чего начать охоту начала новых атак. 

- Мощный язык запросов с IntelliSense: Построенный на языке запросов, который дает вам гибкость, необходимую для того, чтобы вывести охоту на новый уровень.

- Создайте свои собственные закладки: Во время охоты вы можете встретить спички или выводы, панели мониторинга или действия, которые выглядят необычно или подозрительно. Для того, чтобы отметить эти элементы, чтобы вы могли вернуться к ним в будущем, используйте функциональность закладки. Закладки позволяют сохранять элементы на потом, чтобы использовать сява для создания инцидента для исследования. Для получения дополнительной информации о закладках, [см.](hunting.md)
- Используйте ноутбуки для автоматизации расследования: Ноутбуки, как шаг за шагом playbooks, которые можно построить, чтобы пройти через шаги расследования и охоты.  Ноутбуки инкапсулируют все охотничьи шаги в многоразовом игровом сборнике, которым можно поделиться с другими пользователями вашей организации. 
- Запрос хранимых данных: Данные доступны в таблицах для запроса. Например, можно запросить создание процесса, события DNS и многие другие типы событий.

- Ссылки на сообщество: Используйте возможности большего сообщества, чтобы найти дополнительные запросы и источники данных.
 
## <a name="get-started-hunting"></a>Начать охоту

1. На портале Azure Sentinel нажмите **«Охота».**
  ![Лазурный Сентинель начинает охоту](media/tutorial-hunting/hunting-start.png)

2. При открытии страницы **«Охота»** все охотничьи запросы отображаются в одной таблице. В таблице перечислены все запросы, написанные группой аналитиков безопасности корпорации Майкрософт, а также любой дополнительный запрос, который вы создали или модифицировали. Каждый запрос содержит описание того, за чем он охотится, и какие данные он работает на. Эти шаблоны сгруппированы по их различным тактикам - значки справа классифицируют тип угрозы, такие как первоначальный доступ, настойчивость и эксфильтрация. Вы можете отфильтровать эти шаблоны охотничьего запроса, используя любое из полей. Вы можете сохранить любой запрос для ваших избранных. Сохраняя запрос для избранного, запрос автоматически выполняется при каждом доступе к странице **«Охота».** Вы можете создать свой собственный охотничий запрос или клонировать и настроить существующий шаблон охотничьего запроса. 
 
2. Нажмите **запрос Run** на странице подробностей охотничьего запроса, чтобы выполнить любой запрос, не покидая страницу охоты.  Количество совпадений отображается в таблице. Просмотрите список охотничьих запросов и их совпадений. Проверьте, с какой стадией в цепочке убийства связанматч.

3. Выполните краткий обзор базового запроса в панели деталей запроса или **нажмите результат запроса просмотра,** чтобы открыть запрос в журнале Analytics. В нижней части просмотрите совпадения для запроса.

4.  Нажмите на строку и выберите **Добавить закладку,** чтобы добавить строки, которые будут исследованы - вы можете сделать это за все, что выглядит подозрительно. 

5. Затем вернитесь на главную страницу **Охота** и нажмите на вкладку **Закладки,** чтобы увидеть все подозрительные действия. 

6. Выберите закладку, а затем нажмите **Провести расследование,** чтобы открыть опыт расследования. Вы можете фильтровать закладки. Например, если вы изучаете кампанию, можно создать тег для кампании, а затем отфильтровать все закладки на основе кампании.

1. После обнаружения запроса охоты обеспечивает высокое значение информации о возможных атаках, можно также создать правила пользовательского обнаружения на основе вашего запроса и вскрыть эти идеи в качестве предупреждений для ваших служб реагирования на инциденты безопасности.

 

## <a name="query-language"></a>Язык запросов 

Охота в Azure Sentinel основана на языке запросов Kusto. Для получения дополнительной информации о языке запроса и поддерживаемых [операторах](https://docs.loganalytics.io/docs/Language-Reference/)см.

## <a name="public-hunting-query-github-repository"></a>Публичный охотничий запрос GitHub

Ознакомьтесь [с репозиторием запроса Охота.](https://github.com/Azure/Orion) Вносить и использовать примеры запросов, которыми делятся наши клиенты.

 

## <a name="sample-query"></a>Пример запроса

Типичный запрос содержит имя таблицы и ряд операторов, разделенных символом \|.

В приведенном выше примере начните с названия таблицы SecurityEvent и добавьте по мере необходимости элементы с трубами.

1. Определите временной фильтр для просмотра только записей за предыдущие семь дней.

2. Добавьте фильтр в запрос, чтобы показать только id события 4688.

3. Добавьте фильтр в запрос еможно в CommandLine, чтобы содержать только экземпляры cscript.exe.

4. Проектировать только столбцы, которые вы заинтересованы в изучении и ограничить результаты до 1000 и нажмите **Выполнить запрос**.
5. Нажмите на зеленый треугольник и запустите запрос. Вы можете протестировать запрос и запустить его для поиска аномального поведения.

## <a name="useful-operators"></a>Полезные операторы

Язык запроса является мощным и имеет много доступных операторов, некоторые полезные операторы перечислены здесь:

**где** - Фильтр стол и подмножество строк, которые удовлетворяют предикат.

**резюмировать** - Создать таблицу, которая агрегирует содержимое таблицы ввода.

**присоединиться** - Слияние строк двух таблиц, чтобы сформировать новую таблицу, сопоставив значения указанного столбца (ы) из каждой таблицы.

**подсчет** - Верните количество записей в наборе входных записей.

**сверху** - Верните первые n-записи, отсортированные по указанным столбикам.

**лимит** - Возврат до указанного количества строк.

**проект** - Выберите столбцы, чтобы включить, переименовать или упасть, и вставить новые вычисленные столбцы.

**extend** - Создайте расчетные столбцы и приложите их к набору результатов.

**makeset** - Вернуть динамический (JSON) массив набора различных значений, которые Expr принимает в группе

**find** - Найти строки, которые соответствуют предикат через набор таблиц.

## <a name="save-a-query"></a>Сохранение запроса

Вы можете создать или изменить запрос и сохранить его в качестве собственного запроса или поделиться им с пользователями, которые находятся в том же арендаторе.

   ![Сохранение запроса](./media/tutorial-hunting/save-query.png)

Создайте новый охотничий запрос:

1. Нажмите **Новый запрос** и выберите **Сохранить**.
2. Заполните все пустые поля и выберите **Сохранить**.

   ![Создать запрос](./media/tutorial-hunting/new-query.png)

Клонировать и изменять существующий охотничий запрос:

1. Выберите запрос на охоту в таблице, которая требуется изменить.
2. Выберите эллипсис (...) в строке запроса, который вы хотите изменить, и выберите **запрос клона.**

   ![клон запрос](./media/tutorial-hunting/clone-query.png)
 

3. Измените запрос и выберите **Создать**.

   ![пользовательский запрос](./media/tutorial-hunting/custom-query.png)

## <a name="next-steps"></a>Дальнейшие действия
В этой статье вы узнали, как вести охотничий расследование с Помощью Azure Sentinel. Ознакомьтесь с дополнительными сведениями об Azure Sentinel в соответствующих статьях.


- [Используйте ноутбуки для автоматического охотничьего похода](notebooks.md)
- [Используйте закладки для сохранения интересной информации во время охоты](bookmarks.md)
