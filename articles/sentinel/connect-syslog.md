---
title: Подключите данные Syslog к Azure Sentinel Документы Майкрософт
description: Узнайте, как подключить данные Syslog к Azure Sentinel.
services: sentinel
documentationcenter: na
author: yelevin
manager: rkarlin
editor: ''
ms.service: azure-sentinel
ms.subservice: azure-sentinel
ms.devlang: na
ms.topic: conceptual
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 12/30/2019
ms.author: yelevin
ms.openlocfilehash: 73fd55fc24fd94dc88bba2f591c32480f77c7d5d
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "77588082"
---
# <a name="connect-your-external-solution-using-syslog"></a>Подключите внешнее решение с помощью Syslog

Можно подключить любой штатный прибор, поддерживающий Syslog, к Azure Sentinel. Это делается с помощью агента, основанного на машине Linux между прибором и Azure Sentinel. Если машина Linux находится в Azure, вы можете передавать журналы с прибора или приложения в специальное рабочее пространство, которое вы создаете в Azure, и подключать его. Если ваша машина Linux не находится в Azure, вы можете передавать журналы с вашего прибора на выделенную на помещение VM или машину, на которую вы устанавливаете агента для Linux. 

> [!NOTE]
> Если ваш прибор поддерживает Syslog CEF, подключение является более полным, и вы должны выбрать этот вариант и следовать инструкциям в [подключении данных из CEF.](connect-common-event-format.md)

## <a name="how-it-works"></a>Принцип работы

Системный журнал (Syslog) — это протокол ведения журнала событий, который обычно используется в Linux. Приложения отправляют сообщения, которые могут храниться на локальном компьютере или передаваться в сборщик системного журнала. При установке агента Log Analytics для Linux он настраивает локальную управляющую программу Syslog для пересылки сообщений в агент. Затем агент отправляет сообщение в Azure Monitor, где создается соответствующая запись.

Для получения дополнительной информации смотрите [источники данных Syslog в Azure Monitor](../azure-monitor/platform/data-sources-syslog.md).

> [!NOTE]
> - Агент может собирать журналы из нескольких источников, но должен быть установлен на выделенную машину прокси.
> - Если вы хотите поддерживать разъемы для CEF и Syslog на одном и том же VM, выполните следующие действия, чтобы избежать дублирования данных:
>    1. Следуйте инструкциям, чтобы [подключить ваш CEF](connect-common-event-format.md).
>    2. Чтобы подключить данные Syslog, перейдите в**настройки** > рабочего пространства **Настроек Настройки** > **Расширенные настройки** > **Data** > **Syslog** и установите возможности и их приоритеты таким образом, чтобы они не были теми же удобствами и свойствами, которые вы использовали в конфигурации CEF. <br></br>Если вы выберете **Применить ниже конфигурации для моих машин,** он применяет эти настройки для всех VMs, подключенных к этому рабочему пространству.


## <a name="connect-your-syslog-appliance"></a>Подключите прибор Syslog

1. В Azure Sentinel выберите **разъемы данных,** а затем выберите разъем **Syslog.**

2. На лезвии **Syslog** выберите **страницу Open connector.**

3. Установите агент Linux:
    
    - Если виртуальная машина Linux находится в Azure, выберите **Download и установите агент на виртуальной машине Azure Linux.** В **лезвии виртуальных машин** выберите виртуальные машины для установки агента, а затем нажмите **Connect.**
    - Если ваша машина Linux не в Azure, выберите **Download и установите агент на машине Linux non-Azure.** В лезвии **прямого агента** скопируйте команду DOWNLOAD **AND ONBOARD AGENT FOR LINUX** и запустите ее на компьютере. 
    
   > [!NOTE]
   > Убедитесь, что вы настраиваете параметры безопасности для этих компьютеров в соответствии с политикой безопасности организации. Например, можно настроить настройки сети в соответствии с политикой сетевой безопасности организации, а также изменить порты и протоколы в daemon в соответствии с требованиями безопасности.

4. Выберите **Открыть конфигурацию расширенных настроек рабочего пространства.**

5. На **лезвии Расширенных настроек** выберите **Data** > **Syslog.** Затем добавьте средства для разъема для сбора.
    
    Добавьте средства, которые ваш слог овтерное приложение включает в свои заголовки журналов. Эту конфигурацию можно увидеть в приборе Syslog в **Syslog-d** в `/etc/rsyslog.d/security-config-omsagent.conf` папке и `/etc/syslog-ng/security-config-omsagent.conf`в **r-Syslog** от .
    
    Если вы хотите использовать аномальное обнаружение входа SSH с данными, которые вы собираете, добавьте **auth** и **authpriv.** Дополнительную информацию можно узнать в [следующем разделе.](#configure-the-syslog-connector-for-anomalous-ssh-login-detection)

6. Когда вы добавили все средства, которые вы хотите контролировать, и скорректированы любые параметры серьезности для каждого из них, выберите флажок **Применить ниже конфигурации для моих машин.**

7. Нажмите кнопку **Сохранить**. 

8. На вашем слоге прибор, убедитесь, что вы отправляете средства, которые вы указали.

9. Чтобы использовать соответствующую схему в Azure Monitor для журналов syslog, ищите **Syslog.**

10. Функцию Kusto, описанную в [функциях «Использование» в запросах журналов Azure Monitor,](../azure-monitor/log-query/functions.md) можно использовать для разбора сообщений Syslog. Затем их можно сохранить в качестве новой функции log Analytics для использования в качестве нового типа данных.

### <a name="configure-the-syslog-connector-for-anomalous-ssh-login-detection"></a>Налажить разъем Syslog для аномального обнаружения входа SSH

> [!IMPORTANT]
> Аномальное обнаружение входа SSH в настоящее время находится в открытом предварительном просмотре.
> Эта функция предоставляется без соглашения об уровне обслуживания, и она не рекомендуется для производственных нагрузок.
> Дополнительные сведения см. в статье [Дополнительные условия использования предварительных выпусков Microsoft Azure](https://azure.microsoft.com/support/legal/preview-supplemental-terms/).

Azure Sentinel может применять машинное обучение (ML) к данным syslog для выявления аномальной активности входа в Систему безопасности (SSH). Сценарии включают в себя:

- Невозможное путешествие – когда два успешных события входа происходят из двух мест, которые невозможно достичь в течение двух событий входа.
- Неожиданное местоположение - место, откуда произошло успешное событие входа, подозрительно. Например, местоположение не было замечено в последнее время.
 
Это обнаружение требует определенной конфигурации разъема данных Syslog: 

1. Для шага 5 в предыдущей процедуре убедитесь, что как **auth,** так и **authpriv** выбраны в качестве средств для мониторинга. Сохраняйте параметры по умолчанию для параметров серьезности, чтобы все они были выбраны. Пример:
    
    > [!div class="mx-imgBorder"]
    > ![Средства, необходимые для аномального обнаружения входа SSH](./media/connect-syslog/facilities-ssh-detection.png)

2. Дайте достаточно времени для сбора информации syslog. Затем перейдите на **Azure Sentinel - Logs,** и скопируйте и вставьте следующий запрос:
    
        Syslog |  where Facility in ("authpriv","auth")| extend c = extract( "Accepted\\s(publickey|password|keyboard-interactive/pam)\\sfor ([^\\s]+)",1,SyslogMessage)| where isnotempty(c) | count 
    
    При необходимости измените **диапазон времени** и выберите **Run.**
    
    Если полученный отсчет равен нулю, подтвердите конфигурацию разъема и что контролируемые компьютеры имеют успешную активность входа в течение периода времени, указанного для запроса.
    
    Если количество полученных данных превышает ноль, данные syslog подходят для аномального обнаружения входа в SSH. Вы позволяете это обнаружение из**шаблонов правил** >  **аналитики** >  **(Preview) Аномальные SSH Обнаружение входа sSH**.

## <a name="next-steps"></a>Дальнейшие действия
В этом документе вы узнали, как подключить к приборам Syslog к Azure Sentinel. Ознакомьтесь с дополнительными сведениями об Azure Sentinel в соответствующих статьях.
- Узнайте, как [отслеживать свои данные и потенциальные угрозы](quickstart-get-visibility.md).
- Узнайте, как приступить к [обнаружению угроз с помощью Azure Sentinel](tutorial-detect-threats-built-in.md).
- [Используйте трудовые книжки](tutorial-monitor-your-data.md) для мониторинга данных.

