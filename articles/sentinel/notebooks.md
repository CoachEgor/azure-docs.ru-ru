---
title: Используйте ноутбуки с Azure Sentinel для охоты на безопасность
description: В этой статье описывается, как использовать ноутбуки с возможностями охоты Azure Sentinel.
services: sentinel
author: yelevin
ms.author: yelevin
ms.assetid: 1721d0da-c91e-4c96-82de-5c7458df566b
ms.service: azure-sentinel
ms.subservice: azure-sentinel
ms.topic: conceptual
ms.custom: mvc
ms.date: 11/25/2019
ms.openlocfilehash: 84b72a71ed2de910bce44b0c3f3309782f096680
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "77581843"
---
# <a name="use-jupyter-notebooks-to-hunt-for-security-threats"></a>Используйте ноутбуки Jupyter для охоты на угрозы безопасности

Основой Azure Sentinel является хранилище данных; он сочетает в себе высокопроизводительные запросы, динамическую схему и масштабы с огромными объемами данных. Портал Azure и все инструменты Azure Sentinel используют общий API для доступа к этому хранилищу данных. Тот же API также доступен для внешних инструментов, таких как ноутбуки [Jupyter](https://jupyter.org/) и Python. В то время как многие общие задачи могут быть выполнены на портале, Jupyter расширяет область, что вы можете сделать с этими данными. Он сочетает в себе полную программируемость с огромной коллекцией библиотек для машинного обучения, визуализации и анализа данных. Эти атрибуты делают Jupyter убедительным инструментом для расследования безопасности и охоты.

![пример ноутбука](./media/notebooks/sentinel-notebooks-map.png)

Мы интегрировали опыт Jupyter в портал Azure, что упростит для вас создание и запуск ноутбуков для анализа ваших данных. Библиотека *Kqlmagic* предоставляет клей, который позволяет принимать запросы от Azure Sentinel и запускать их непосредственно в блокноте. Запросы используют [язык запросов Kusto](https://kusto.azurewebsites.net/docs/query/index.html). Несколько ноутбуков, разработанных некоторыми аналитиками безопасности Корпорации Майкрософт, упакованы с Azure Sentinel. Некоторые из этих блокнотов построены для конкретного сценария и могут быть использованы как есть. Другие предназначены в качестве образцов для иллюстрации методов и функций, которые можно скопировать или адаптировать для использования в собственных ноутбуках. Другие блокноты также могут быть импортированы из сообщества Azure Sentinel GitHub.

Интегрированный опыт Jupyter использует [ноутбуки Azure](https://notebooks.azure.com/) для хранения, обмена и выполнения ноутбуков. Вы также можете запустить эти блокноты локально, если на компьютере есть среда Python и Jupyter, или в других средах JupterHub, таких как Azure Databricks.

Ноутбуки имеют два компонента:

- Интерфейс на основе браузера, в котором вы вводите и запускаете запросы и код, и где отображаются результаты выполнения.
- *Ядро,* отвечающее за разбор и выполнение самого кода. 

В ноутбуках Azure по умолчанию это ядро работает на *бесплатных облачных вычислениях и хранении Azure.* Если ваши ноутбуки включают сложные модели машинного обучения или визуализации, подумайте об использовании более мощных, специализированных вычислительных ресурсов, таких как [Data Science Virtual Machines](https://azure.microsoft.com/services/virtual-machines/data-science-virtual-machines/) (DSVM). Ноутбуки в вашей учетной записи хранятся в тайне, если вы не решите поделиться ими.

В тетрадах Azure Sentinel используется множество популярных библиотек Python, таких как панды, матплотиб, боке и другие. Есть очень много других пакетов Python для вас на выбор, охватывающих такие области, как:

- Визуализации и графика
- Обработка и анализ данных
- Статистика и численные вычисления
- Машинное обучение и глубокое обучение

Мы также выпустили некоторые с открытым исходным кодом Jupyter инструментов безопасности в пакете под названием [msticpy](https://github.com/Microsoft/msticpy/). Этот пакет используется во многих включенных ноутбуках. Инструменты Msticpy разработаны специально, чтобы помочь с созданием ноутбуков для охоты и исследования, и мы активно работаем над новыми функциями и улучшениями.

Первоначальные ноутбуки включают в себя:

- **Руководство исследованием - Process Alerts**: Позволяет быстро сортировать оповещения, анализируя активность на пораженном узеле или хостах.
- **Экскурсия по поиску - исследователь хоста Windows**: Позволяет исследовать активность учетной записи, процесс выполнения, сетевую активность и другие события на хосте.
- **Экскурсия по охоте - Office365-Exploring**: Охота за подозрительной деятельностью Office 365 в нескольких наборах данных Office 365.

[Репозиторий сообщества Azure Sentinel GitHub](https://github.com/Azure/Azure-Sentinel) — это место для любых будущих ноутбуков Azure Sentinel, созданных корпорацией Майкрософт или внесенных из сообщества.

Чтобы использовать блокноты, необходимо иметь учетную запись Azure Notebooks. Для получения дополнительной информации [см.](https://docs.microsoft.com/azure/notebooks/quickstart-sign-in-azure-notebooks) Для создания этой учетной записи можно использовать опцию **«Регистрация на лазурные ноутбуки»** из панели команд в **Azure Sentinel - Ноутбуки:**

> [!div class="mx-imgBorder"]
>![Подпишитесь на опцию ноутбуков Azure](./media/notebooks/sentinel-azure-sign-up-azure-notebooks.png)

Вы можете запустить блокнот прямо из Azure Sentinel или клонировать все блокноты Azure Sentinel в новый проект Блокнотов Azure.

## <a name="run-a-notebook-from-azure-sentinel"></a>Выполнить блокнот от Azure Sentinel
 
1. С портала Azure перейдите на**блокноты****управления угрозами** >  **Azure Sentinel,** > где можно увидеть блокноты, которые предоставляет Azure Sentinel. 

2. Выберите отдельные блокноты для чтения их описаний, требуемых типов данных и источников данных. Пример:
    
    > [!div class="mx-imgBorder"]
    > ![запуск ноутбука](./media/notebooks/sentinel-azure-notebooks-launch.png)

3. Выберите нужный книжку ноутбука, а затем выберите **Launch Notebook (Preview),** чтобы клонировать и настроить ноутбук в новый проект Ноутбуков Azure, который подключается к рабочему пространству Azure Sentinel. Когда процесс завершен, блокнот открывается в блокнотах Azure для запуска.

## <a name="clone-azure-sentinel-notebooks-to-a-new-azure-notebooks-project"></a>Ноутбуки Clone Azure Sentinel для нового проекта Ноутбуков Azure

Эта процедура создает для вас проект Azure Notebooks, содержащий блокноты Azure Sentinel. Затем можно запустить тетради как есть, или внести в них изменения, а затем запустить их.

1. С портала Azure перейдите на**блокноты** **управления угрозами** >  **Azure Sentinel,** > а затем выберите **записные книжки клонов** из панели команд:
  
    > [!div class="mx-imgBorder"]
    >![Опция клонов ноутбуков](./media/notebooks/sentinel-azure-clone-notebooks.png)

2. При пояснении следующего диалога выберите **«Импорт»,** чтобы клонировать репо GitHub в проект Azure Notebooks. Если у вас нет существующей учетной записи Azure Notebooks, вам будет предложено создать ее и войти в систему.

   ![Импортный ноутбук](./media/notebooks/sentinel-notebooks-clone.png)

3. На поле диалога **Загружая GitHub Repository** не выбирайте **клон ажиотаж,** потому что эта опция относится к связанному репогу GitHub. Для имени проекта используйте имя по умолчанию или введите новое. Затем нажмите **«Импорт»,** чтобы начать клонирование содержимого GitHub, что может занять несколько минут.

   ![Импортный ноутбук](./media/notebooks/sentinel-create-project.png)

4. Откройте только что созданный проект, а затем откройте папку **ноутбуков,** чтобы просмотреть блокноты. Пример:

   ![Импортре](./media/notebooks/sentinel-open-notebook1.png)

Затем можно запускать блокноты из блокнотов Azure. Чтобы вернуться к этим записным книжким из Azure Sentinel, выберите **Перейдите в блокноты** из панели команд в **Azure Sentinel - Ноутбуки**:

> [!div class="mx-imgBorder"]
>![Перейти к опции ноутбуков](./media/notebooks/sentinel-azure-to-go-notebooks.png)


## <a name="using-notebooks-to-hunt"></a>Использование ноутбуков для охоты

Каждый блокнот идет вас через шаги для проведения охоты или расследования. Библиотеки и другие зависимости, необходимые для ноутбука, могут быть установлены из самого ноутбука или с помощью простой процедуры конфигурации. Конфигурация, связав проект ноутбука с подпиской Azure Sentinel, автоматически предоставляется в предыдущих шагах.

1. Если вы еще не в Ноутбуках Azure, вы можете использовать **опцию «Перейти на ноутбуки»** из панели команд в **Azure Sentinel - Ноутбуки:**
    
    > [!div class="mx-imgBorder"]
    >![Перейти к опции ноутбуков](./media/notebooks/sentinel-azure-to-go-notebooks.png)
    
    В блокнотах Azure выберите **My Projects,** затем проект, содержащий блокноты Azure Sentinel, и, наконец, папку **тетрад.**
    
2. Прежде чем открыть блокнот, имейте в виду, что по умолчанию free Compute выбран для запуска ноутбуков:
    
   ![выберите блокнот](./media/notebooks/sentinel-open-notebook2.png)
    
    Если вы настроили виртуальные машины Data Science (DSVM) для использования, как это объясняется во введении, выберите DSVM и проверь подлинность перед открытием первого ноутбука. 

3. Выберите блокнот, чтобы открыть его.
    
    При первом открытии ноутбука может быть предложено выбрать версию ядра. Если вы не вызваны, вы можете выбрать версию ядра из**ядра изменения ядра,** **Kernel** >  а затем выбрать версию, которая по крайней мере 3.6. Выбранная версия ядра отображается в правом верхнем виде окна ноутбука:
    
   ![выберите блокнот](./media/notebooks/sentinel-select-kernel.png)

4. Прежде чем вносить какие-либо изменения в ноутбук, который вы скачали, рекомендуется сделать копию оригинального ноутбука и поработать над копией. Для этого выберите **Файл** > **Сделать копию**. Работа над копиями позволяет безопасно обновлять будущие версии ноутбуков без перезаписи каких-либо ваших данных.
    
    Теперь вы готовы к запуску или отображированию выбранного блокнота.

Рекомендации

- Для краткого введения в запрос данных в Azure Sentinel просмотрите блокнот [GetStarted](https://github.com/Azure/Azure-Sentinel/blob/master/Notebooks/Get%20Started.ipynb) в основной **папке Ноутбуков.** 

- Дополнительные образцы ноутбуков вы найдете в подфолдере **Sample-Notebooks.** Эти образцы ноутбуков были сохранены с данными, так что легче увидеть предполагаемый вывод. Мы рекомендуем просматривать эти ноутбуки в [nbviewer](https://nbviewer.jupyter.org/). 

- Папка **HowTos** содержит блокноты, описывающие, например: настройка версии Python по умолчанию, настройка DSVM, создание закладок Azure Sentinel из блокнота и другие темы.

Предоставленные ноутбуки предназначены как как полезные инструменты, так и как иллюстрации и образцы кода, которые можно использовать при разработке собственных ноутбуков.

Мы приветствуем обратную связь, будь то предложения, запросы на функции, внесенные ноутбуки, отчеты об ошибках или улучшения и дополнения к существующим ноутбукам. Перейдите в [сообщество Azure Sentinel GitHub,](https://github.com/Azure/Azure-Sentinel) чтобы создать проблему или вилку и загрузить вклад.

## <a name="next-steps"></a>Дальнейшие действия

В этой статье вы узнали, как начать использовать блокноты Jupyter в Azure Sentinel. Ознакомьтесь с дополнительными сведениями об Azure Sentinel в соответствующих статьях.

- [Проактивная охота на угрозы](hunting.md)
- [Используйте закладки для сохранения интересной информации во время охоты](bookmarks.md)
