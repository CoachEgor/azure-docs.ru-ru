---
title: Использование записных книжек с Sentinel Azure для подсистемы безопасности
description: В этой статье описывается, как использовать записные книжки с возможностями Поиск Sentinel маркеров Azure.
services: sentinel
author: rkarlin
ms.author: rkarlin
ms.assetid: 1721d0da-c91e-4c96-82de-5c7458df566b
ms.service: azure-sentinel
ms.subservice: azure-sentinel
ms.topic: conceptual
ms.custom: mvc
ms.date: 11/25/2019
ms.openlocfilehash: 44a37fb8d06040b0d872f15ab25bdd2c7ff685b8
ms.sourcegitcommit: 5925df3bcc362c8463b76af3f57c254148ac63e3
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/31/2019
ms.locfileid: "75563706"
---
# <a name="use-jupyter-notebooks-to-hunt-for-security-threats"></a>Использование записных книжек Jupyter для поиска угроз безопасности

Основой Azure Sentinel является хранилище данных. Он сочетает высокопроизводительные запросы, динамическую схему и масштабируется до больших объемов данных. Портал Azure и все средства Azure Sentinel используют общий API для доступа к этому хранилищу данных. Этот API также доступен для внешних средств, таких как записные книжки [Jupyter](https://jupyter.org/) и Python. Хотя многие распространенные задачи могут быть выполнены на портале, Jupyter расширяет область действия, с помощью которых можно выполнять эти данные. Она сочетает полную программируемость с огромным набором библиотек для машинного обучения, визуализации и анализа данных. Эти атрибуты делают Jupyter привлекательным инструментом для расследования и исследования безопасности.

![Пример записной книжки](./media/notebooks/sentinel-notebooks-map.png)

Мы включили Jupyter интерфейс в портал Azure, что упрощает создание и запуск записных книжек для анализа данных. Библиотека *кклмагик* предоставляет связующий объект, который позволяет выполнять запросы из Azure Sentinel и запускать их непосредственно внутри записной книжки. Запросы используют [язык запросов Kusto](https://kusto.azurewebsites.net/docs/query/index.html). Несколько записных книжек, разработанных некоторыми аналитиками корпорации Майкрософт по безопасности, упаковываются с помощью Azure Sentinel. Некоторые из этих записных книжек созданы для конкретного сценария и могут использоваться "как есть". Другие предназначены в качестве примеров для демонстрации методов и функций, которые можно копировать или адаптировать для использования в записных книжках. Другие записные книжки также могут быть импортированы из сообщества Azure Sentinel Community.

Интегрированный интерфейс Jupyter использует [записные книжки Azure](https://notebooks.azure.com/) для хранения, совместного использования и выполнения записных книжек. Эти записные книжки также можно запускать локально, если у вас есть среда Python и Jupyter на компьютере или в других средах Жуптерхуб, таких как Azure Databricks.

В записных книжках есть два компонента:

- Интерфейс на основе браузера, в котором вводятся и запускаются запросы и код, а также место отображения результатов выполнения.
- *Ядро* , ответственное за синтаксический анализ и выполнение самого кода. 

В записных книжках Azure по умолчанию этот ядро работает в *бесплатном расчете и хранилище облачных*ресурсов Azure. Если записные книжки содержат сложные модели машинного обучения или визуализации, рассмотрите возможность использования более мощных выделенных вычислительных ресурсов, таких как виртуальные машины для обработки и [анализа данных](https://azure.microsoft.com/services/virtual-machines/data-science-virtual-machines/) (DSVM). Записные книжки в вашей учетной записи остаются частными, если вы не решили поделиться ими.

В записных книжках Azure Sentinel используются многие популярные библиотеки Python, такие как Pandas, Matplotlib, Боке и др. Существует большое количество других пакетов Python для выбора, охватывающих такие области, как:

- Визуализации и графика
- Обработка и анализ данных
- Статистика и числовые вычисления
- Машинное обучение и глубокое обучение

Мы также выпустили некоторые средства безопасности Jupyter с открытым кодом в пакете с именем [мстикпи](https://github.com/Microsoft/msticpy/). Этот пакет используется во многих включенных записных книжках. Средства мстикпи предназначены специально для создания записных книжек для получения и исследования и активно работают над новыми функциями и улучшениями.

В число исходных записных книжек входят следующие:

- **Интерактивное исследование — обработка оповещений**. позволяет быстро рассматривать предупреждения путем анализа действий на затронутом узле или узлах.
- **Интерактивное Поиск — обозреватель узлов Windows**: позволяет просматривать действия с учетной записью, выполнения процессов, сетевые операции и другие события на узле.
- Поиск подозрительных действий Office 365 в нескольких наборах данных Office **365.**

[Репозиторий сообщества Azure Sentinel Community](https://github.com/Azure/Azure-Sentinel) — это расположение для всех будущих записных книжек Azure Sentinel, созданных корпорацией Майкрософт или предоставляемых сообществом.

Чтобы использовать записные книжки, необходимо иметь учетную запись записных книжек Azure. Дополнительные сведения см. в разделе [Краткое руководство. вход и указание идентификатора пользователя](https://docs.microsoft.com/azure/notebooks/quickstart-sign-in-azure-notebooks) в документации по записным книжкам Azure. Чтобы создать эту учетную запись, можно использовать параметр **Регистрация в записных книжках Azure** на панели команд в **Azure Sentinel-Notebooks**:

> [!div class="mx-imgBorder"]
>![подписаться на записные книжки Azure](./media/notebooks/sentinel-azure-sign-up-azure-notebooks.png)

Вы можете запустить записную книжку прямо из Azure Sentinel или клонировать все записные книжки Azure Sentinel в новый проект записных книжек Azure.

## <a name="run-a-notebook-from-azure-sentinel"></a>Запуск записной книжки из Azure Sentinel
 
1. В портал Azure перейдите в раздел **Azure sentinel** > **управление угрозами** > **записные книжки**, где можно просмотреть записные книжки, предоставляемые Azure Sentinel. 

2. Выберите отдельные записные книжки, чтобы прочитать их описания, необходимые типы данных и источники данных. Пример.
    
    > [!div class="mx-imgBorder"]
    > ![запустить записную книжку](./media/notebooks/sentinel-azure-notebooks-launch.png)

3. Выберите записную книжку, которую хотите использовать, а затем щелкните **запустить записную книжку (Предварительная версия)** , чтобы клонировать и настроить записную книжку в новый проект записных книжек Azure, который подключается к рабочей области Sentinel. После завершения процесса Записная книжка откроется в записных книжках Azure для запуска.

## <a name="clone-azure-sentinel-notebooks-to-a-new-azure-notebooks-project"></a>Клонирование записных книжек Azure в новый проект записных книжек Azure

Эта процедура создает проект записных книжек Azure, который содержит записные книжки Azure Sentinel. Затем можно запустить записные книжки "как есть" или внести в них изменения, а затем запустить их.

1. В портал Azure перейдите к **Azure Sentinel** > **управление угрозами** > **записные книжки** , а затем выберите **клонировать записные книжки** на панели команд:
  
    > [!div class="mx-imgBorder"]
    >параметр ![клонировать записные книжки](./media/notebooks/sentinel-azure-clone-notebooks.png)

2. Когда появится следующее диалоговое окно, выберите **Импорт** , чтобы клонировать репозиторий GitHub в проект записных книжек Azure. Если у вас нет учетной записи записных книжек Azure, вам будет предложено создать ее и выполнить вход.

   ![Импорт записной книжки](./media/notebooks/sentinel-notebooks-clone.png)

3. В диалоговом окне **Отправка репозитория GitHub** не выбирайте параметр **клонировать рекурсивно** , так как этот вариант относится к связанному репозиториев GitHub. В качестве имени проекта используйте имя или тип по умолчанию в новом. Затем нажмите кнопку **Импорт** , чтобы начать клонирование содержимого GitHub, что может занять несколько минут.

   ![Импорт записной книжки](./media/notebooks/sentinel-create-project.png)

4. Откройте только что созданный проект, а затем откройте папку " **записные книжки** ", чтобы просмотреть записные книжки. Пример.

   ![Импорт репозитория](./media/notebooks/sentinel-open-notebook1.png)

Затем можно запустить записные книжки из записных книжек Azure. Чтобы вернуться к этим записным книжкам из Azure Sentinel, выберите **"переход к записным книжкам** " на панели команд в **Azure Sentinel-Notebooks**:

> [!div class="mx-imgBorder"]
>![перейдите к параметру записных книжек](./media/notebooks/sentinel-azure-to-go-notebooks.png)


## <a name="using-notebooks-to-hunt"></a>Использование записных книжек для поиска

В каждой записной книжке рассматриваются шаги по выполнению поиска или исследования. Библиотеки и другие зависимости, необходимые для записной книжки, можно установить из самой записной книжки или с помощью простой процедуры настройки. Конфигурация, связывающая проект записной книжки с подпиской Azure Sentinel, автоматически подготавливается на предыдущих шагах.

1. Если вы еще не находитесь в записных книжках Azure, вы можете использовать команду **"переход к записным книжкам** " на панели команд в **Azure Sentinel-Notebooks**:
    
    > [!div class="mx-imgBorder"]
    >![перейдите к параметру записных книжек](./media/notebooks/sentinel-azure-to-go-notebooks.png)
    
    В записных книжках Azure выберите **Мои проекты**, проект, который содержит записные книжки Azure, и, наконец, папку **записных книжек** .
    
2. Перед открытием записной книжки имейте в виду, что по умолчанию для запуска записных книжек выбрано свободное вычисление:
    
   ![выбрать записную книжку](./media/notebooks/sentinel-open-notebook2.png)
    
    Если вы настроили виртуальные машины для обработки и анализа данных (DSVM) для использования, как описано во введении, выберите DSVM и выполните проверку подлинности перед открытием первой записной книжки. 

3. Выберите записную книжку, чтобы открыть ее.
    
    При первом открытии записной книжки может быть предложено выбрать версию ядра. Если запрос не выводится, можно выбрать **версию ядра в ядре >  ** **изменить ядро**, а затем выбрать версию, которая не ниже 3,6. Выбранная версия ядра отображается в правом верхнем углу окна записной книжки:
    
   ![выбрать записную книжку](./media/notebooks/sentinel-select-kernel.png)

4. Перед внесением каких-либо изменений в скачанную записную книжку рекомендуется создать копию исходной записной книжки и работать с копией. Для этого выберите **файл** > **создать копию**. Работа с копиями позволяет безопасно обновлять будущие версии записных книжек без перезаписи каких бы то ни было данных.
    
    Теперь вы готовы к запуску или редактированию выбранной записной книжки.

Рекомендации

- Для быстрого ознакомления с запросом данных в Azure Sentinel просмотрите записную книжку в папке "главные **записные книжки** [".](https://github.com/Azure/Azure-Sentinel/blob/master/Notebooks/Get%20Started.ipynb) 

- Дополнительные примеры записных книжек можно найти в подпапке **Sample-Notebooks** . Эти примеры записных книжек были сохранены вместе с данными, чтобы упростить просмотр предполагаемых выходных данных. Рекомендуется просмотреть эти записные книжки в [нбвиевер](https://nbviewer.jupyter.org/). 

- Папка **руководств** содержит записные книжки, описывающие, например, настройку версии Python по умолчанию, настройку DSVM, создание закладок Azure Sentinel из записной книжки и другие темы.

Указанные записные книжки предназначены как полезные средства, а также иллюстрации и примеры кода, которые можно использовать при разработке собственных записных книжек.

Мы ждем отзывов, предложений, запросов на функции, предоставленных записных книжек, отчетов об ошибках, улучшений и дополнений к существующим записным книжкам. Перейдите на портал [Azure Sentinel Community GitHub](https://github.com/Azure/Azure-Sentinel) , чтобы создать вопрос или вилку и отправить публикацию.

## <a name="next-steps"></a>Дальнейшие действия

В этой статье вы узнали, как приступить к использованию записных книжек Jupyter в Azure Sentinel. Ознакомьтесь с дополнительными сведениями об Azure Sentinel в соответствующих статьях.

- [Упреждающее слежение за угрозами](hunting.md)
- [Использование закладок для сохранения интересных сведений при поиске](bookmarks.md)
