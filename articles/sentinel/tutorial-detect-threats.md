---
title: Анализ оповещений с предварительной версией Azure Sentinel | Документация Майкрософт
description: Используйте этот учебник, чтобы узнать, как исследовать оповещения с помощью Azure Sentinel.
services: sentinel
documentationcenter: na
author: rkarlin
manager: rkarlin
editor: ''
ms.assetid: b5fbc5ac-68b2-4024-9c1b-bd3cc41a66d0
ms.service: azure-sentinel
ms.subservice: azure-sentinel
ms.devlang: na
ms.topic: conceptual
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 07/20/2019
ms.author: rkarlin
ms.openlocfilehash: ad9c752898733286701db2d0f0b1fc40029b7521
ms.sourcegitcommit: c71306fb197b433f7b7d23662d013eaae269dc9c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/22/2019
ms.locfileid: "68370718"
---
# <a name="tutorial-detect-threats-with-azure-sentinel-preview"></a>Учебник. Обнаружение угроз с помощью предварительной версии Azure Sentinel

> [!IMPORTANT]
> Сейчас Azure Sentinel предоставляется в общедоступной предварительной версии.
> Эта предварительная версия предоставляется без соглашения об уровне обслуживания и не рекомендована для использования рабочей среде. Некоторые функции могут не поддерживаться или их возможности могут быть ограничены. Дополнительные сведения см. в статье [Дополнительные условия использования предварительных выпусков Microsoft Azure](https://azure.microsoft.com/support/legal/preview-supplemental-terms/).

После [подключения источников данных](quickstart-onboard.md) к Sentinel Azure вы будете получать уведомления о подозрительных событиях. Чтобы сделать это, Azure Sentinel позволяет создавать расширенные правила генерации оповещений, которые создают варианты, которые можно назначить и использовать для глубокого анализа аномалий и угроз в вашей среде. 

Этот учебник поможет обнаружить угрозы с помощью Azure Sentinel.
> [!div class="checklist"]
> * Создание правил обнаружения
> * Автоматизация реагирования на угрозы

## <a name="create-detection-rules"></a>Создание правил обнаружения

Для изучения вариантов необходимо сначала создать правила обнаружения. 

> [!NOTE]
> Оповещения, созданные в Azure Sentinel, доступны через [Microsoft Graph безопасность](https://aka.ms/securitygraphdocs). Дополнительные сведения и партнеры по интеграции см. в [документации по оповещениям системы безопасности Microsoft Graph](https://aka.ms/graphsecurityreferencebetadocs) .

Правила обнаружения основаны на типах угроз и аномалий, которые могут быть подозрительны в вашей среде и должны быть хорошо осведомлены о том, что они отображаются, изучаются и устраняются. 

1. В портал Azure в разделе Azure Sentinel выберите **аналитика**.

   ![Аналитика](./media/tutorial-detect-threats/alert-rules.png)

2. В верхней строке меню щелкните **+ Добавить**.  

   ![Создать правило генерации оповещений](./media/tutorial-detect-threats/create-alert-rule.png)

3. В разделе **Создание правила генерации оповещений**введите описательное имя и при необходимости задайте **уровень серьезности** . 

4. Создайте запрос в Log Analytics и вставьте его в поле **Задание правила оповещения** . Ниже приведен пример запроса, который выдаст предупреждение при создании аномального числа ресурсов в действии Azure.

        AzureActivity
        | where OperationName == "Create or Update Virtual Machine" or OperationName == "Create Deployment"
        | where ActivityStatus == "Succeeded"
        | make-series dcount(ResourceId)  default=0 on EventSubmissionTimestamp in range(ago(7d), now(), 1d) by Caller

   > [!NOTE]
   > Длина запроса должна составлять от 1 до 10000 символов и не может содержать символы "Search *" и "Union *".


5. В разделе **Сопоставление сущностей** используйте поля в разделе **тип сущности** , чтобы сопоставить столбцы запроса с полями сущностей, распознаваемыми в Azure Sentinel. Для каждого поля сопоставьте соответствующий столбец в запросе, созданном в Log Analytics, с соответствующим полем сущности. Выберите соответствующее имя столбца в свойстве . Каждая сущность содержит несколько полей, например SID, GUID и т. д. Сущность можно сопоставлять в соответствии с любыми полями, а не только с сущностью верхнего уровня.

6. Определите условия триггера предупреждений в разделе **триггер оповещения**. Определяет условия, которые активируют оповещение. 

7. Задайте **частоту** запуска запроса, как часто каждые 5 минут или как нечастое как раз в день. 

8. Задайте **период** управления интервалом времени, в течение которого выполняется запрос. Например, он может выполняться каждый час в течение 60 минут с данными.

9. Можно также задать подавление . Подавление можно использовать, если необходимо предотвратить срабатывание повторяющихся оповещений для одного инцидента. Таким образом можно предотвратить срабатывание оповещений в течение определенного периода времени. Это поможет избежать дублирования оповещений для одного инцидента и позволяет подавлять последовательные предупреждения в течение определенного периода времени. Например, если для частоты **планирования предупреждений**  задано значение 60 минут, а для параметра **период планирования предупреждений** задано значение 2 часа, а результаты запроса превысили заданное пороговое значение, то предупреждение будет вызываться дважды, когда оно было обнаружено первым. за последние 60 минут и снова, когда в течение первых 60 минут из 2-часовых данных выдаются выборка. Если оповещение активировано, то подавление должно быть в течение времени, установленного в период оповещения. В нашем примере может потребоваться установить подавление в течение 60 минут, чтобы оповещения запускались только для событий, произошедших за последний час.

8. После вставки запроса в поле **задать правило оповещения** можно сразу же увидеть имитацию оповещения в разделе **моделирование логики оповещений** , чтобы вы могли получить представление о том, сколько данных будет создано за определенный интервал времени для предупреждения. Вы создали. Это будет зависеть от того, что задано для параметра **Частота** и пороговое **значение**. Если вы видите, что оповещение будет вызываться слишком часто, вы захотите увеличить число результатов, чтобы оно превышало среднюю базовую базу.

9. Нажмите кнопку **создать** , чтобы инициализировать правило генерации оповещений. После создания оповещения создается обращение, содержащее оповещение. Определенные правила обнаружения можно просмотреть в виде строк на вкладке " **аналитика безопасности** ". Вы также можете увидеть число совпадений для каждого правила — оповещений, которые инициируются. В этом списке можно включить, отключить или удалить каждое правило. Можно также щелкнуть правой кнопкой мыши многоточие (...) в конце строки для каждого оповещения, чтобы изменить, отключить, клонировать, отобразить совпадения или удалить правило. Страница **аналитики** — это коллекция всех активных правил генерации оповещений, включая включенные шаблоны и правила генерации оповещений, созданные на основе шаблонов.

1. Результаты правил генерации оповещений можно просмотреть на странице " **варианты** ", где можно рассмотреть, [исследовать варианты](tutorial-investigate-cases.md)и исправить угрозы.



## <a name="automate-threat-responses"></a>Автоматизация реагирования на угрозы

Команды SIEM/SOC могут быть засыпаны на регулярной основе оповещений системы безопасности. Объем созданных предупреждений настолько велик, что доступные Администраторы безопасности могут быть перегружены. Это приводит к слишком частому результату в ситуациях, когда не удается исследовать много предупреждений, в результате чего Организация становится уязвимой для атак, которые не были замечены. 

Многие (если не большинство) этих предупреждений соответствуют повторяющимся шаблонам, которые могут быть решены определенными и определенными действиями по исправлению. Azure Sentinel уже позволяет определить ваше исправление в модули PlayBook. Кроме того, можно задать автоматизацию в реальном времени как часть определения сборник тренировочных заданий, чтобы можно было полностью автоматизировать определенный ответ на определенные оповещения системы безопасности. Используя автоматизацию в реальном времени, группы реагирования могут значительно сократить рабочую нагрузку, полностью автоматизируя подпрограммы для регулярных типов оповещений, позволяя сосредоточиться на уникальных оповещениях, анализе шаблонов, поиске угроз и т. д.

Для автоматизации ответов:

1. Выберите предупреждение, для которого необходимо автоматизировать ответ.
1. В меню навигации рабочей области Sentinel Azure выберите **аналитика**.
1. Выберите оповещение, которое необходимо автоматизировать. 
1. На странице **Изменение правила генерации оповещений** в разделе **Автоматизация в режиме реального времени**выберите **активируемый сборник тренировочных заданий** , который нужно запустить при сопоставлении этого правила оповещения.
1. Щелкните **Сохранить**.

   ![Автоматизация в реальном времени](./media/tutorial-detect-threats/rt-configuration.png)


Кроме того, вы можете вручную исправить предупреждение, запустив сборник тренировочных заданий из оповещения, нажав кнопку **View модули PlayBook (Просмотр** ), а затем выбрав сборник тренировочных заданий для запуска. Чтобы узнать, как создать новый сборник тренировочных заданий или изменить существующий, см. статью [Работа с модули Playbook в Azure Sentinel](tutorial-respond-threats-playbook.md).



## <a name="next-steps"></a>Следующие шаги
В этом руководстве вы узнали, как приступить к обнаружению угроз с помощью Sentinel Azure. 

Чтобы узнать, как автоматизировать ответы на угрозы, [как реагировать на угрозы с помощью автоматизированного модули PlayBook](tutorial-respond-threats-playbook.md).
> [!div class="nextstepaction"]
> [Реагирование на угрозы](tutorial-respond-threats-playbook.md) для автоматизации реагирования на угрозы.

