---
title: Включить Azure Monitor для обзора св.м
description: Узнайте, как развертывать и настраивать Azure Monitor для вс-миноносов. Узнайте о требованиях системы.
ms.subservice: ''
ms.topic: conceptual
author: bwren
ms.author: bwren
ms.date: 03/27/2020
ms.openlocfilehash: 26ed33e967aff1714d2a6fb174eab623e71534c2
ms.sourcegitcommit: e040ab443f10e975954d41def759b1e9d96cdade
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/29/2020
ms.locfileid: "80382738"
---
# <a name="enable-azure-monitor-for-vms-overview"></a>Включить Azure Monitor для обзора св.м

В этой статье представлен обзор доступных опций для включения Azure Monitor для виртуальных компьютеров для мониторинга работоспособности и производительности. Откройте для себя приложения,зависимые от виртуальных машин Azure (VMs) и виртуальных наборов масштабов машин, наемных вмов или виртуальных компьютеров, размещенных в другой облачной среде.  

Чтобы настроить Azure Monitor для vMs:

* Включите один Azure VM или виртуальную шкалу машины, выбрав **Insights** непосредственно из набора VM или виртуальной машины.
* Включите два или более комплектов Azure ИВ-технологий и виртуальные наборы машин с помощью политики Azure. Этот метод гарантирует, что на существующих и новых вс-да и наборов масштаба, необходимые зависимости установлены и правильно настроены. Сообщается о несовместимых с ними вс-бра и наборах масштабов, так что вы можете решить, включать ли их и исправления.
* Включите две или несколько виртуальных машин или масштабируемых наборов виртуальных машин Azure в определенной подписке или группе ресурсов с помощью PowerShell.
* Включите Azure Monitor для вс-миноносов для мониторинга вс-миноносов или физических компьютеров, размещенных в корпоративной сети или другой облачной среде.

## <a name="prerequisites"></a>Предварительные требования

Прежде чем начинать работу, убедитесь, что вы понимаете сведения, содержащиеся в следующих разделах. 

>[!NOTE]
>Следующая информация, описанная в этом разделе, также применима к [решению Service Map.](service-map.md)  

### <a name="log-analytics"></a>Log Analytics

Azure Monitor для ВМ поддерживает рабочее пространство Log Analytics в следующих регионах:

- центрально-западная часть США
- западная часть США
- западная часть США 2
- Центрально-южная часть США
- Восточная часть США
- восточная часть США 2
- Центральная часть США
- Центрально-северная часть США
- Центральная Канада
- южная часть Соединенного Королевства
- Северная Европа
- Западная Европа
- Восточная Азия
- Юго-Восточная Азия
- Центральная Индия
- Восточная Япония
- Восточная Австралия
- Юго-Восточная часть Австралии

>[!NOTE]
>Вы можете следить за M Ms Azure в любом регионе. Сами вс-м внеспыхивают не только в регионах, поддерживаемых рабочим пространством Log Analytics.
>

Если у вас нет рабочего пространства Log Analytics, его можно создать с помощью одного из ресурсов:
* [Лазурный CLI](../../azure-monitor/learn/quick-create-workspace-cli.md)
* [PowerShell](../../azure-monitor/learn/quick-create-workspace-posh.md)
* [Портал Azure](../../azure-monitor/learn/quick-create-workspace.md)
* [Azure Resource Manager](../../azure-monitor/platform/template-workspace-configuration.md)

Можно также создать рабочее пространство, в то время как вы позволяете осуществлять мониторинг для одного VM Azure или виртуального масштаба машины, установленного на портале Azure.

Настройка в масштабе сценария, используюго шаблоны Azure PowerShell или менеджер ресурсов Azure, в рабочем пространстве аналитики:

* Установите решения *ServiceMap* и *InfrastructureInsights.* Вы можете завершить эту установку с помощью предоставленного шаблона управления ресурсами Azure. Или на вкладке **Get Started** на портале Azure выберите Рабочее пространство для **настройки.**
* Настройте рабочую область Log Analytics для сбора данных счетчиков производительности.

Для настройки рабочего пространства для сценария по масштабу используйте один из следующих методов:

* Используйте [Azure PowerShell](vminsights-enable-at-scale-powershell.md#set-up-a-log-analytics-workspace).
* На странице Azure Monitor для покрытия [**политики**](vminsights-enable-at-scale-policy.md#manage-policy-coverage-feature-overview) ВМ выберите **рабочее пространство для настройки.** 

### <a name="supported-operating-systems"></a>Поддерживаемые операционные системы

В следующей таблице перечислены операционные системы Windows и Linux, которые поддерживает Azure Monitor для вс-кодов. Позже в этом разделе вы найдете полный список, в который подробно описаны основные и незначительные версии Linux OS и поддерживаемые версии ядра.

|Версия ОС |Производительность |Maps |
|-----------|------------|-----|
|Windows Server 2019 | X | X |
|Windows Server 2016 1803 | X | X |
|Windows Server 2016 | X | X |
|Windows Server 2012 R2 | X | X |
|Windows Server 2012 | X | X |
|Windows Server 2008 R2 | X | X|
|Windows 10 1803 | X | X |
|Windows 8.1 | X | X |
|Windows 8 | X | X |
|Windows 7 с пакетом обновления 1 (SP1) | X | X |
|Red Hat Enterprise Linux (RHEL) 6, 7| X | X| 
|Ubuntu 18.04, 16.04 | X | X |
|CentOS Linux 7, 6 | X | X |
|SUSE Linux Enterprise Server (SLES) 12 | X | X |
|Debian 9.4, 8 | X<sup>1</sup> | |

<sup>1</sup> Функция "Производительность" Azure Monitor для виртуальных машин доступна только в Azure Monitor. Он недоступен непосредственно из левого стекла Azure VM.

>[!NOTE]
>В операционной системе Linux:
> - Поддерживаются только версии ядра по умолчанию и SMP для Linux.
> - Нестандартные версии ядра, такие как расширение физических адресов (PAE) и Xen, не поддерживаются ни в одном дистрибутиве Linux. Например, система со строкой версии *2.6.16.21-0.8-xen* не поддерживается.
> - Пользовательские ядра, включая перекомпиляции стандартных ядер, не поддерживаются.
> - Ядро CentOSPlus поддерживается.
> - Ядро Linux должно быть исправлено для уязвимости Spectre. Пожалуйста, проконсультируйтесь с поставщиком дистрибуции Linux для получения более подробной информации.

#### <a name="red-hat-linux-7"></a>Red Hat Linux 7

| Версия ОС | Версия ядра |
|:--|:--|
| 7.6 | 3.10.0-957 |
| 7.5 | 3.10.0-862 |
| 7.4 | 3.10.0-693 |

#### <a name="red-hat-linux-6"></a>Red Hat Linux 6

| Версия ОС | Версия ядра |
|:--|:--|
| 6.10 | 2.6.32-754 |
| 6.9 | 2.6.32-696 |

#### <a name="centosplus"></a>CentOSPlus

| Версия ОС | Версия ядра |
|:--|:--|
| 6.10 | 2.6.32-754.3.5<br>2.6.32-696.30.1 |
| 6.9 | 2.6.32-696.30.1<br>2.6.32-696.18.7 |

#### <a name="ubuntu-server"></a>Сервер Ubuntu

| Версия ОС | Версия ядра |
|:--|:--|
| 18,04 | 5.0 (включает ядро, настроенное Лазурным тоном)<br>4.18*<br>4.15* |
| 16.04.3 | 4.15.* |
| 16.04 | 4.13.\*<br>4.11.\*<br>4.10.\*<br>4.8.\*<br>4.4.\* |

#### <a name="suse-linux-12-enterprise-server"></a>SUSE Linux 12 Enterprise Server

| Версия ОС | Версия ядра |
|:--|:--|
|12 SP4 | 4.12.» (включает ядро, настроенное лазурным тоном) |
|12 с пакетом обновления 3 | 4.4.* |
|12 с пакетом обновления 2 | 4.4.* |

#### <a name="debian"></a>Debian 

| Версия ОС | Версия ядра |
|:--|:--|
| 9 | 4.9 | 

### <a name="the-microsoft-dependency-agent"></a>Microsoft Dependency Agent

Функция Карта в Azure Monitor для VMs получает свои данные от агента зависимости Майкрософт. Dependency Agent является зависимым от агента Log Analytics для создания подключений к Log Analytics. Таким образом, в вашей системе должен быть установлен и настроен агент Log Analytics с агентом зависимости.

Независимо от того, используете ли вы Azure Monitor для ВМ для одного VM Azure или используете метод развертывания в масштабе, используйте расширение агента зависимости Azure VM для [Windows](../../virtual-machines/extensions/agent-dependency-windows.md) или [Linux](../../virtual-machines/extensions/agent-dependency-linux.md) для установки агента как части интерфейса.

>[!NOTE]
>Следующая информация, описанная в этом разделе, также применима к [решению Service Map.](service-map.md)  

В гибридной среде можно загрузить и установить агент зависимости вручную или с помощью автоматизированного метода.

В приведенной ниже таблице описаны подключенные источники, которые функция схемы поддерживает в гибридной среде.

| Подключенный источник | Поддерживается | Описание |
|:--|:--|:--|
| Агенты Windows | Да | Наряду с [агентом Log Analytics для Windows](../../azure-monitor/platform/log-analytics-agent.md)агентам Windows нужен агент зависимости. Для получения дополнительной информации [см.](#supported-operating-systems) |
| Агенты Linux | Да | Наряду с [агентом Log Analytics для Linux,](../../azure-monitor/platform/log-analytics-agent.md)linux-агентам нужен агент зависимости. Для получения дополнительной информации [см.](#supported-operating-systems) |
| Группа управления System Center Operations Manager | нет | |

Вы можете скачать агент зависимости из следующих местоположений:

| Файл | OS | Версия | SHA-256 |
|:--|:--|:--|:--|
| [InstallDependencyAgent-Windows.exe](https://aka.ms/dependencyagentwindows) | Windows | 9.10.2.9060 | B7725B6B205CF8c336D9d95636c816412740E9d649BCACB6f862ae3896  |
| [InstallDependencyAgent-Linux64.bin](https://aka.ms/dependencyagentlinux) | Linux | 9.10.2.9060 | C6995A67A7782AEC312647D74A99C3C323F68F5FFA490F4B4B6006A2FF2941B0 |

## <a name="role-based-access-control"></a>Управление доступом на основе ролей

Для включения и доступа к функциям в Azure Monitor для вс-м высожганных объектов необходимо иметь роль *участника журнала Analytics.* Для просмотра данных о производительности, работоспособности и картах необходимо иметь роль *считывателя мониторинга* для Azure VM. Необходимо настроить рабочую область Log Analytics для Azure Monitor для виртуальных машин.

Дополнительные сведения о том, как управлять доступом к рабочей области Log Analytics, см. в статье [Управление рабочими областями](../../azure-monitor/platform/manage-access.md).

## <a name="how-to-enable-azure-monitor-for-vms"></a>Как включить Azure Monitor для св.

Включите Azure Monitor для вс-бай-а с помощью одного из методов, описанных в этой таблице:

| Состояние развертывания | Метод | Описание |
|------------------|--------|-------------|
| Единый набор Azure VM или виртуальный набор масштабов машин | [Включить из VM](vminsights-enable-single-vm.md) | Вы можете включить один Azure VM, выбрав **Insights** непосредственно из набора VM или виртуальной машины. |
| Несколько виртуальных машинных компьютеров Azure или виртуальных наборов машин | [Включить через политику Azure](vminsights-enable-at-scale-policy.md) | Можно включить несколько VMs Azure, используя политику Azure и доступные определения политики. |
| Несколько виртуальных машинных компьютеров Azure или виртуальных наборов машин | [Включить через шаблоны Azure PowerShell или менеджер ресурсов Azure](vminsights-enable-at-scale-powershell.md) | Вы можете включить несколько наборов Azure VMs или виртуальной шкалы машин в определенной группе подписки или ресурса, используя шаблоны Azure PowerShell или Azure Resource Manager. |
| Гибридное облачное решение | [Включить для гибридной среды](vminsights-enable-hybrid-cloud.md) | Можно развернуть на ввои-порикахили или физические компьютеры, размещенные в центре обработки данных или других облачных средах. |

## <a name="management-packs"></a>Пакеты управления

Когда Azure Monitor для вс-м ввоза включен и настроен с помощью рабочего пространства Log Analytics, пакет управления перенаправляется на все компьютеры Windows, сообщающие об этом рабочем пространстве. Если вы [интегрировали группу управления управлением операциями ВИС](../../azure-monitor/platform/om-agents.md) с рабочим пространством Log Analytics, пакет управления картами обслуживания развертывается из группы управления в компьютеры Windows, сообщающие группе управления.  

Пакет управления называется *Microsoft.IntelligencePacks.ApplicationDependencyMonitor*. Его написано в `%Programfiles%\Microsoft Monitoring Agent\Agent\Health Service State\Management Packs\` папку. Источник данных, который использует `%Program files%\Microsoft Monitoring Agent\Agent\Health Service State\Resources\<AutoGeneratedID>\Microsoft.EnterpriseManagement.Advisor.ApplicationDependencyMonitorDataSource.dll`пакет управления, .

## <a name="diagnostic-and-usage-data"></a>Данные диагностики и использования

Корпорация Майкрософт автоматически собирает данные об использовании и производительности при работе службы Azure Monitor. Корпорация Майкрософт использует эти данные для повышения качества, безопасности и целостности службы. 

Чтобы обеспечить точные и эффективные возможности устранения неполадок, функция Карта включает данные о конфигурации программного обеспечения. Данные содержат такие сведения, как операционная система и версия, IP-адрес, имя DNS и название рабочей станции. Корпорация Майкрософт не собирает сведения об именах, адресах и другую контактную информацию.

Дополнительные сведения о сборе и использовании данных см. в [заявлении о конфиденциальности служб Microsoft Online Services](https://go.microsoft.com/fwlink/?LinkId=512132).

[!INCLUDE [GDPR-related guidance](../../../includes/gdpr-dsr-and-stp-note.md)]

Теперь, когда вы включили мониторинг для вашего VM, информация о мониторинге доступна для анализа в Azure Monitor для VMs.

## <a name="next-steps"></a>Дальнейшие действия

Чтобы узнать, как использовать функцию мониторинга производительности, смотрите [Посмотреть монитор Azure для производительности выв.,](vminsights-performance.md)выемкуЮ. Для просмотра обнаруженных зависимостей приложений см. статью о [просмотре схемы Azure Monitor для виртуальных машин](vminsights-maps.md).
