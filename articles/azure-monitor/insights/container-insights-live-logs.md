---
title: Представление журналов контейнеров в реальном времени в Azure Monitor | Документация Майкрософт
description: В этой статье описывается в режиме реального времени представление контейнера журналы (stdout и stderr) и событий без использования kubectl с Azure Monitor для контейнеров.
services: azure-monitor
documentationcenter: ''
author: mgoedtel
manager: carmonm
editor: ''
ms.assetid: ''
ms.service: azure-monitor
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 06/12/2019
ms.author: magoedte
ms.openlocfilehash: 71c6f1936f8cbc700a24d0ffb497947c8c8d3a50
ms.sourcegitcommit: 41ca82b5f95d2e07b0c7f9025b912daf0ab21909
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/13/2019
ms.locfileid: "67075303"
---
# <a name="how-to-view-logs-and-events-in-real-time-preview"></a>Как просмотреть журналы и события в режиме реального времени (Предварительная версия)
Azure Monitor для контейнеров включает функцию, которая доступна в предварительной версии, обеспечивающая наблюдая в реальном времени журналы контейнера службы Azure Kubernetes (AKS) (stdout и stderr) и события без запуска команд kubectl. При выборе любого из этих вариантов отобразится новая область под таблицей данных производительности на **узлы**, **контроллеров**, и **контейнеры** представления. Он показывает динамической ведение журналов и событий, создаваемых обработчиком контейнера для дальнейшего устранения проблем в режиме реального времени.

>[!NOTE]
>**Участник** доступ к ресурсу кластера необходим для работы этой функции.
>

Динамические журналы поддерживают три различных способа управления доступом к журналам:

1. AKS без включенной авторизации Kubernetes RBAC;
2. AKS со включенной авторизацией Kubernetes RBAC;
3. AKS включена с помощью Azure Active Directory (AD) на основе SAML единого входа

## <a name="kubernetes-cluster-without-rbac-enabled"></a>Кластер Kubernetes без включенного RBAC
 
Если для кластера Kubernetes не настроена авторизация Kubernetes RBAC или он не интегрирован с единым входом Azure AD, вам не нужно выполнять следующие действия. Так как авторизация Kubernetes использует kube-api, требуются разрешения только для чтения.

## <a name="kubernetes-rbac-authorization"></a>Авторизация Kubernetes RBAC
Если вы включили авторизацию Kubernetes RBAC, необходимо будет применить привязку роли кластера. Ниже приведены шаги по настройке привязки роли кластера на основе этого YAML-файла с шаблоном конфигурации. 

1. Скопируйте и вставьте YAML-файл, а затем сохраните его как LogReaderRBAC.yaml.  

    ```
    apiVersion: rbac.authorization.k8s.io/v1 
    kind: ClusterRole 
    metadata: 
       name: containerHealth-log-reader 
    rules: 
       - apiGroups: [""] 
         resources: ["pods/log", "events"] 
         verbs: ["get", "list"]  
    --- 
    apiVersion: rbac.authorization.k8s.io/v1 
    kind: ClusterRoleBinding 
    metadata: 
       name: containerHealth-read-logs-global 
    roleRef: 
        kind: ClusterRole 
        name: containerHealth-log-reader 
        apiGroup: rbac.authorization.k8s.io 
    subjects: 
       - kind: User 
         name: clusterUser 
         apiGroup: rbac.authorization.k8s.io
    ```

2. Если вы впервые настраиваете в первый раз, создании привязки правила кластера, выполнив следующую команду: `kubectl create -f LogReaderRBAC.yaml`. Если включена поддержка предварительной версии оперативных журналов, прежде чем мы представили текущих журналах событий, обновите конфигурацию, выполните следующую команду: `kubectl apply -f LogReaderRBAC.yml`.

## <a name="configure-aks-with-azure-active-directory"></a>Настройка AKS с Azure Active Directory

Службу Azure Kubernetes можно настроить на использование Azure Active Directory (AD) для аутентификации пользователей. Если вы впервые настраиваете впервые, см. в разделе [интегрировать Azure Active Directory со службой Azure Kubernetes](../../aks/azure-ad-integration.md). Во время действия по созданию [клиентское приложение](../../aks/azure-ad-integration.md#create-the-client-application), укажите следующее:

- **(Необязательно) URI перенаправления**: Это **Web** тип приложения и базовое значение URL-адрес должен быть `https://afd.hosting.portal.azure.net/monitoring/Content/iframe/infrainsights.app/web/base-libs/auth/auth.html`.
- После регистрации приложения, из **Обзор** странице выберите **проверки подлинности** в левой области. На **проверки подлинности** раздела **Дополнительные параметры** неявно предоставить **маркеры доступа** и **маркеры Идентификации** и сохраните ваши изменения.

>[!NOTE]
>Настройка проверки подлинности с помощью Azure Active Directory для единого входа могут выполняться только во время первоначального развертывания нового кластера AKS. Настроить единый вход для кластера AKS, который уже развернут, невозможно.

## <a name="view-live-logs-and-events"></a>Просмотр динамической журналов и событий

Вы можете просматривать события журнала в режиме реального времени, при их создании подсистемой контейнера из **узлы**, **контроллеров**, и **контейнеры** представления. В панели «Свойства» выберите **просмотра динамических данных (Предварительная версия)** параметр и область представлена ниже в таблице данных производительности, где можно просмотреть журнал и события в виде непрерывного потока.

![Параметр области представления оперативных журналов для узла свойств](./media/container-insights-live-logs/node-properties-live-logs-01.png)  

Журнал и сообщения о событиях ограничены, зависят от того, какой тип ресурса, выбранного в представлении.

| Просмотр | Тип ресурса | Журнал или событие | Данные, представленные |
|------|---------------|--------------|----------------|
| Nodes | Узел | Событие | При выборе узла события не фильтруются и Показать события на уровне кластера Kubernetes. Заголовок панели имя кластера. |
| Nodes | Pod | Событие | При выборе pod событий фильтруются с пространством имен. Заголовок панели содержится пространство имен модуля. | 
| Controllers; | Pod | Событие | При выборе pod событий фильтруются с пространством имен. Заголовок панели содержится пространство имен модуля. |
| Controllers; | Controller | Событие | При выборе контроллера событий фильтруются с пространством имен. Заголовок панели содержится пространство имен контроллера. |
| Контроллеры/узлы/контейнеры | Контейнер | Журналы | Заголовок панели показывает имя pod контейнере группируется. |

Если для кластера AKS настроен единый вход через AAD, вам будет предложено выполнить аутентификацию при первом использовании в этом сеансе браузера. Выберите свою учетную запись и выполните аутентификацию с помощью Azure.  

Когда аутентификация будет успешно пройдена, в нижнем разделе средней области отобразится область динамических журналов. Если в строке индикатора состояния получения отображается зеленая галочка (справа в области), это означает, что данные могут быть получены.
    
  ![Извлеченные данные из области динамических журналов](./media/container-insights-live-logs/live-logs-pane-01.png)  

В строке поиска можно фильтровать по ключевым словом, чтобы выделить текст в журнал или событий, а также в панели поиска в правом, он показывает, сколько результатов, соответствующих out фильтр.

  ![Пример фильтра области динамических журналов](./media/container-insights-live-logs/live-logs-pane-filter-example-01.png)

При просмотре событий, могут дополнительно ограничить результаты с помощью **фильтра** поглощений, найден в правой части панели поиска. В зависимости от выбранного ресурса поглощений перечислены pod, пространство имен или кластера, чтобы выбрать из.  

Приостановка autoscroll и управления поведением области и позволяют вручную просмотрите новые данные, считанные, щелкните **прокрутки** параметр. Чтобы снова включить автопрокрутки, просто щелкните **прокрутки** снова. Вы можете приостановить получение данных журнала или событий, щелкнув **приостановить** и когда вы будете готовы возобновить работу, просто нажмите кнопку **воспроизведение**.  

![Представление в реальном времени, в котором приостановлено извлечение, в области динамических журналов](./media/container-insights-live-logs/live-logs-pane-pause-01.png)

Вы можете перейти к журналам монитора Azure для просмотра журналов исторических контейнера, выбрав **просмотреть журналы контейнера** из раскрывающегося списка **просмотреть в аналитике**.

## <a name="next-steps"></a>Дальнейшие действия
- Чтобы продолжить изучение способов использования Azure Monitor и отслеживать другие аспекты кластера AKS, ознакомьтесь со статьей [Общие сведения о мониторинге производительности кластера AKS с помощью Azure Monitor для контейнеров (предварительная версия)](container-insights-analyze.md).
- Представление [журнала примеры запросов](container-insights-log-search.md#search-logs-to-analyze-data) предопределенных запросов и примеры для настройки предупреждений, визуализация и анализ кластеров и оценки.
