---
title: Представление журналов контейнеров в реальном времени в Azure Monitor | Документация Майкрософт
description: В этой статье описывается представление журналов контейнеров (stdout/stderr) в реальном времени без использования kubectl в службе "Azure Monitor для контейнеров".
services: azure-monitor
documentationcenter: ''
author: mgoedtel
manager: carmonm
editor: ''
ms.assetid: ''
ms.service: azure-monitor
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 01/09/2019
ms.author: magoedte
ms.openlocfilehash: c8baa4d2355adf99ce188d632ac50901db29a758
ms.sourcegitcommit: 3102f886aa962842303c8753fe8fa5324a52834a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "60497683"
---
# <a name="how-to-view-container-logs-real-time-with-azure-monitor-for-containers-preview"></a>Как представить журналы контейнеров в реальном времени с помощью службы "Azure Monitor для контейнеров" (предварительная версия)
Эта функция, которая в настоящее время находится в предварительной версии, обеспечивает представление журналов контейнеров Службы Azure Kubernetes (stdout/stderr) в реальном времени без необходимости выполнять команды kubectl. Если выбрать этот вариант, в представлении **Контейнеры** под таблицей данных производительности контейнеров появится новая область.  В ней будет показано динамическое ведение журнала, создаваемое модулем контейнера для помощи в устранении проблем в режиме реального времени. **Участник** доступ к ресурсу кластера необходим для работы этой функции.

Динамические журналы поддерживают три метода управления доступом к ним:

1. AKS без включенной авторизации Kubernetes RBAC; 
2. AKS со включенной авторизацией Kubernetes RBAC;
3. AKS со включенным единым входом SAML на основе Azure Active Directory (AD). 

## <a name="kubernetes-cluster-without-rbac-enabled"></a>Кластер Kubernetes без включенного RBAC
 
Если для кластера Kubernetes не настроена авторизация Kubernetes RBAC или он не интегрирован с единым входом Azure AD, вам не нужно выполнять следующие действия. Так как авторизация Kubernetes использует kube-api, требуются разрешения только для чтения.

## <a name="kubernetes-rbac-authorization"></a>Авторизация Kubernetes RBAC
Если вы включили авторизацию Kubernetes RBAC, необходимо будет применить привязку роли кластера. Ниже приведены шаги по настройке привязки роли кластера на основе этого YAML-файла с шаблоном конфигурации.   

1. Скопируйте и вставьте YAML-файл, а затем сохраните его как LogReaderRBAC.yaml.  

   ```
   apiVersion: rbac.authorization.k8s.io/v1 
   kind: ClusterRole 
   metadata: 
      name: containerHealth-log-reader 
   rules: 
      - apiGroups: [""] 
        resources: ["pods/log"] 
        verbs: ["get"] 
   --- 
   apiVersion: rbac.authorization.k8s.io/v1 
   kind: ClusterRoleBinding 
   metadata: 
      name: containerHealth-read-logs-global 
   roleRef: 
       kind: ClusterRole 
       name: containerHealth-log-reader 
       apiGroup: rbac.authorization.k8s.io 
   subjects: 
      - kind: User 
        name: clusterUser 
        apiGroup: rbac.authorization.k8s.io 
   ```

2. Создайте привязку правила кластера, выполнив следующую команду: `kubectl create -f LogReaderRBAC.yaml`. 

## <a name="configure-aks-with-azure-active-directory"></a>Настройка AKS с Azure Active Directory
Службу Azure Kubernetes можно настроить на использование Azure Active Directory (AD) для аутентификации пользователей. Если вы выполняете настройку впервые, ознакомьтесь со статьей [Интеграция Azure Active Directory со Службой Azure Kubernetes](../../aks/azure-ad-integration.md). Во время создания [клиентского приложения](../../aks/azure-ad-integration.md#create-client-application) и указания **универсального кода ресурса (URI) перенаправления** вам требуется добавить другой URI в список `https://ininprodeusuxbase.microsoft.com/*`.  

>[!NOTE]
>Настройку аутентификации с помощью Azure Active Directory для единого входа можно выполнить только при первоначальном развертывании нового кластера AKS. Настроить единый вход для кластера AKS, который уже развернут, невозможно.  
> 

## <a name="view-live-logs"></a>Просмотр динамических журналов
При просмотре **контейнеров** вы можете **просмотреть обычные** или **динамические журналы контейнеров**.  Если выбран вариант **Просмотреть интерактивные журналы контейнера**, под таблицей данных производительности контейнеров появится новая область, создаваемая модулем контейнера для помощи в устранении проблем в режиме реального времени.  
1. Войдите на [портале Azure](https://portal.azure.com). 
2. В меню **Microsoft Azure** выберите **Мониторинг**, а затем — **Контейнеры**.  
3. Выберите контейнер из списка в представлении **Monitored containers** (Отслеживаемые контейнеры).  
4. Выберите представление **Контейнеры**, и вы увидите, что в области свойств выбранного контейнера содержится ссылка **Просмотреть интерактивные журналы контейнера**.  
5. Если для кластера AKS настроен единый вход через AAD, вам будет предложено выполнить аутентификацию при первом использовании в этом сеансе браузера. Выберите свою учетную запись и выполните аутентификацию с помощью Azure.  

Когда аутентификация будет успешно пройдена, в нижнем разделе средней области отобразится область динамических журналов. Если в строке индикатора состояния получения отображается зеленая галочка (справа в области), это означает, что данные могут быть получены.
    
  ![Извлеченные данные из области динамических журналов](./media/container-insights-live-logs/live-logs-pane-01.png)  

В строке поиска можно выполнять фильтрацию по ключевым словам, чтобы выделить текст в журнале.   

  ![Пример фильтра области динамических журналов](./media/container-insights-live-logs/live-logs-pane-filter-01.png)

Чтобы приостановить автоматическую прокрутку и управление поведением области и настроить прокрутку по новым считанным данных журнала вручную, щелкните параметр **Прокрутить**.  Чтобы повторно включить автоматическую прокрутку, просто щелкните **Прокрутить** снова.  Вы также можете приостановить извлечение данных журнала, щелкнув вариант **Пауза**, а когда будете готовы возобновить работу, просто щелкните **Воспроизведение**.  

![Представление в реальном времени, в котором приостановлено извлечение, в области динамических журналов](./media/container-insights-live-logs/live-logs-pane-pause-01.png)

## <a name="next-steps"></a>Дальнейшие действия
- Чтобы продолжить изучение способов использования Azure Monitor и отслеживать другие аспекты кластера AKS, ознакомьтесь со статьей [Общие сведения о мониторинге производительности кластера AKS с помощью Azure Monitor для контейнеров (предварительная версия)](container-insights-analyze.md).
- Представление [журнала примеры запросов](container-insights-log-search.md#search-logs-to-analyze-data) предопределенных запросов и примеры для настройки предупреждений, визуализация и анализ кластеров и оценки.
