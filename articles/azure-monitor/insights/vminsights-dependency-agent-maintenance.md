---
title: Как обновить Azure Monitor для агента зависимостей от вс-м
description: В этой статье описывается, как обновить Azure Monitor для агента зависимостей от вс-, используя командную линию, мастер установки и другие методы.
ms.subservice: ''
ms.topic: conceptual
author: bwren
ms.author: bwren
ms.date: 04/16/2020
ms.openlocfilehash: 01dd8422658aa0c8982733e48782efd27c1bf5be
ms.sourcegitcommit: eefb0f30426a138366a9d405dacdb61330df65e7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/17/2020
ms.locfileid: "81617842"
---
# <a name="how-to-upgrade-the-azure-monitor-for-vms-dependency-agent"></a>Как обновить Azure Monitor для агента зависимостей от вс-м

После первоначального развертывания azure Monitor для агента зависимостей виртуальных св.  Эта статья поможет вам понять доступные методы и как выполнить обновление вручную или с помощью автоматизации.

## <a name="upgrade-options"></a>Параметры обновления 

Агент зависимости для Windows и Linux может быть обновлен до последнего выпуска вручную или автоматически в зависимости от сценария развертывания и среды, в которой работает машина. Для обновления агента можно использовать следующие методы.

|Среда |Метод установки |Метод перехода |
|------------|--------------------|---------------|
|Azure | Расширение VM-агента зависимости для [Windows](../../virtual-machines/extensions/agent-dependency-windows.md) и [Linux](../../virtual-machines/extensions/agent-dependency-linux.md) | Агент автоматически обновляется по умолчанию, если вы не настроили шаблон менеджера ресурсов Azure, чтобы отказаться, установив свойство *autoUpgradeMinorMinorVersion* на **ложный.** Обновление для незначительной версии, где автоматическое обновление отключено, и обновление основной версии следуют тому же методу - удалить и переустановить расширение. |
| Пользовательские изображения Azure VM | Ручная установка агента зависимости для Windows/Linux | Обновление ВМ до новейшей версии агента должно быть выполнено из командной строки, работающей с пакетом установки Windows или пакетом скриптов Linux, извлекающим самоизвечивание и устанавливаемый пакет сценариев оболочки.|
| Не-Azure VMs | Ручная установка агента зависимости для Windows/Linux | Обновление ВМ до новейшей версии агента должно быть выполнено из командной строки, работающей с пакетом установки Windows или пакетом скриптов Linux, извлекающим самоизвечивание и устанавливаемый пакет сценариев оболочки. |

## <a name="upgrade-windows-agent"></a>Обновление агента Windows 

Чтобы обновить агент на Windows VM до последней версии, не установленной с помощью расширения агента зависимости VM, вы либо работаете с командным запросом, скриптом или другим решением автоматизации, либо с помощью SetDyAgent-Windows.exe Setup Wizard.  

Вы можете скачать последнюю версию агента Windows [отсюда](https://aka.ms/dependencyagentwindows).

### <a name="using-the-setup-wizard"></a>Использование мастера настройки

1. Войдите в систему компьютера, используя учетную запись с правами администратора.

2. Выполнить **InstallDependencyAgent-Windows.exe,** чтобы начать мастер настройки.
   
3. Следуйте за мастером **настройки агента зависимостей,** чтобы удалить предыдущую версию агента зависимости, а затем установить последнюю версию.


### <a name="from-the-command-line"></a>Из командной строки

1. Войдите в систему компьютера, используя учетную запись с правами администратора.

2. Выполните следующую команду.

    ```dos
    InstallDependencyAgent-Windows.exe /S /RebootMode=manual
    ```

    Параметр `/RebootMode=manual` предотвращает автоматическое перезагрузить обновление машины, если некоторые процессы используют файлы из предыдущей версии и блокируют их. 

3. Чтобы подтвердить, что обновление `install.log` было успешным, проверьте подробную информацию о настройке. Каталогом журналов является *%Programfiles%\Microsoft Dependency Agent\logs*.

## <a name="upgrade-linux-agent"></a>Обновление агента Linux 

Обновление по предыдущим версиям агента зависимости на Linux поддерживается и выполняется по той же команде, что и новая установка.

Вы можете скачать последнюю версию агента Linux [отсюда](https://aka.ms/dependencyagentlinux).

1. Войдите в систему компьютера, используя учетную запись с правами администратора.

2. Выполнить следующую`sh InstallDependencyAgent-Linux64.bin -s`команду в качестве корня . 

Если Dependency Agent не запускается, просмотрите подробные сведения об ошибке в записях журналов. Что на агентах Linux, каталог журнала */var/opt/microsoft/dependency-agent/log*. 

## <a name="next-steps"></a>Дальнейшие действия

Если вы хотите прекратить мониторинг вхдвисы в течение определенного периода времени или полностью удалить Azure Monitor для ВМ, смотрите в [Azure Monitor для MMs-монитора.](vminsights-optout.md)
