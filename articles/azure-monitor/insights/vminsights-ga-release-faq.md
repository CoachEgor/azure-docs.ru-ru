---
title: Azure Monitor для ВМ (GA) часто задавал вопросы Документы Майкрософт
description: Azure Monitor для виртуальных машин — это решение в Azure, которое отслеживает работоспособность и производительность ОС виртуальных машин Azure, автоматически обнаруживает компоненты приложений и их зависимости от других ресурсов, а также строит схему каналов связи между ними. Эта статья отвечает на распространенные вопросы о выпуске GA.
ms.subservice: ''
ms.topic: conceptual
author: bwren
ms.author: bwren
ms.date: 01/31/2020
ms.openlocfilehash: 3d250ef1aba979be04a44acaf31a3d685f162e37
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "80283894"
---
# <a name="azure-monitor-for-vms-generally-available-ga-frequently-asked-questions"></a>Azure Monitor для VMs, как правило, доступны (GA) Часто задаваемые вопросы
Этот часто задаваемые вопросы общей доступности охватывает изменения, которые были внесены в 4 квартале 2019 и 1 квартале 2020 года, когда мы готовились к GA.

## <a name="updates-for-azure-monitor-for-vms"></a>Обновления для Azure Monitor для vMs
Мы выпустили новую версию Azure Monitor для ВМ в январе 2020 года перед нашим объявлением GA. Клиенты, позволяющие Azure Monitor для вс-голов, теперь будут получать версию GA, но существующие клиенты, использующие версию Azure Monitor для ВМ с 4-го и более раннего уровня, будут предложено обновиться. Этот часто задаваемые вопросы предлагает рекомендации для выполнения обновления в масштабе, если у вас есть большие развертывания в нескольких рабочих областях.


С помощью этого обновления данные о производительности Azure Monitor для ВМ хранятся в той же таблице *InsightsMetrics,* что и [Azure Monitor для контейнеров,](container-insights-overview.md)что упрощает запрос двух наборов данных. Кроме того, вы можете хранить более разнообразные наборы данных, которые мы не могли хранить в таблице, ранее использовававаемой. 

Наши представления производительности теперь используют данные, которые мы храним в таблице *InsightsMetrics.*  Если вы еще не обновились, чтобы использовать последнее решение VMInsights в рабочем пространстве, ваши диаграммы больше не будут отображать информацию.  Вы можете обновить с нашей **страницы Get Started,** как описано ниже.


## <a name="what-is-changing"></a>Что изменяется?
Мы выпустили новое решение под названием VMInsights, которое включает в себя дополнительные возможности для сбора данных наряду с новым местом для хранения этих данных в рабочей области Log Analytics. 

В прошлом мы позволяли решению ServiceMap на вашем рабочем пространстве и настроить счетчики производительности в рабочем пространстве Log Analytics для отправки данных в таблицу *Perf.* Это новое решение отправляет данные в таблицу под названием *InsightsMetrics,* которая также используется Azure Monitor для контейнеров. Эта схема таблицы позволяет нам хранить дополнительные метрики и наборы данных служб, которые не совместимы с форматом таблицы *Perf.*

Мы обновили наши диаграммы производительности, чтобы использовать данные, которые мы храним в таблице *InsightsMetrics.* Вы можете обновить, чтобы использовать таблицу *InsightsMetrics* с нашей страницы **Get Started,** как описано ниже.


## <a name="how-do-i-upgrade"></a>Как обновиться?
Когда рабочее пространство журнала Analytics будет обновлено до последней версии Azure Monitor до VMs, оно обновит агент зависимости на каждом из m-технологий, прикрепленных к этому рабочему пространству. Каждый VM, требующий обновления, будет идентифицирован во вкладке **Get Started** в Azure Monitor для VMs на портале Azure. Когда вы решите обновить VM, он будет модернизировать рабочее пространство для этого VM вместе с любыми другими VMs прилагается к этому рабочему пространству. Вы можете выбрать один VM или несколько VMs, группы ресурсов или подписки. 

Используйте следующую команду для обновления рабочего пространства с помощью PowerShell:

```PowerShell
Set-AzureRmOperationalInsightsIntelligencePack -ResourceGroupName <resource-group-name> -WorkspaceName <workspace-name> -IntelligencePackName "VMInsights" -Enabled $True
```

## <a name="what-should-i-do-about-the-performance-counters-in-my-workspace-if-i-install-the-vminsights-solution"></a>Что делать со счетчиками производительности в рабочем пространстве, если я устанавливаю решение VMInsights?

Предыдущий метод включения Azure Monitor для VMs использовал счетчики производительности в рабочем пространстве. Текущая версия хранит эти данные в таблице с именем `InsightsMetrics`. Вы можете отключить эти счетчики производительности в вашем рабочем пространстве, если вам больше не нужно их использовать. 

>[!NOTE]
>Если у вас есть правила оповещения, `Perf` которые ссылаются на эти счетчики в `InsightsMetrics` таблице, необходимо обновить их для ссылки на новые данные, хранящиеся в таблице. Обратитесь к нашей документации, например, к запросам журналов, которые можно использовать, которые относятся к этой таблице.
>

Если вы решите сохранить счетчики производительности включен, вам будет выставлен счет `Perf` за данные, посягаемые и хранящиеся в таблице на основе цен на «Log Analytics»(https://azure.microsoft.com/pricing/details/monitor/).

## <a name="how-will-this-change-affect-my-alert-rules"></a>Как это изменение повлияет на правила оповещения?

Если вы создали [оповещения журнала,](../platform/alerts-unified-log.md) `Perf` которые задавили запрос счетчиков производительности таблицы, которые были `InsightsMetrics` включены в рабочее пространство, следует обновить эти правила, чтобы вместо этого обратиться к таблице. Это руководство также применяется к `ServiceMapComputer_CL` любым `ServiceMapProcess_CL`правилам поиска журналов, `VMComputer` `VMProcess` использующим и, потому что эти наборы данных перемещаются в таблицы и таблицы.

Мы обновим эти часто задаваемые вопросы и нашу документацию, чтобы включить правила оповещения о поиске на примере для наборов данных, которые мы собираем.

## <a name="how-will-this-affect-my-bill"></a>Как это повлияет на мой счет?

Выставление счетов по-прежнему основано на данных, вламых и сохраненных в рабочей области Log Analytics.

Данные о производительности уровня машины, которые мы собираем, одинаковы, `Perf` имеют аналогичный размер данных, которые мы храним в таблице, и будут стоить примерно столько же.

## <a name="what-if-i-only-want-to-use-service-map"></a>Что делать, если я хочу использовать только карту обслуживания?

Это нормально. Вы увидите запросы на портале Azure при просмотре Azure Monitor для vMs о предстоящем обновлении. После выпуска вы получите запрос на обновление новой версии. Если вы предпочитаете использовать только функцию [«Карты»,](vminsights-maps.md) вы можете отказаться от обновления и продолжать использовать функцию «Карты» в Azure Monitor для vMs и решение карты обслуживания, доступ к которой приходится из рабочей области или плитки панели мониторинга.

Если вы решили вручную включить счетчики производительности в рабочей области, то вы сможете увидеть данные в некоторых из наших диаграмм производительности, просмотренных с Azure Monitor. Как только новое решение будет выпущено, мы обновим `InsightsMetrics` наши диаграммы производительности, чтобы заставить зазапрос данных, хранящихся в таблице. Если вы хотите увидеть данные из этой таблицы в этих диаграммах, вам нужно будет перейти на новую версию Azure Monitor для vMs.

Изменения для перемещения `ServiceMapComputer_CL` данных с и `ServiceMapProcess_CL` повлияет как на карту обслуживания, так и на мониторинг Azure для вс-карт, так что вам все еще нужно планировать это обновление.

Если вы решили не переходить на решение **VMInsights,** мы будем продолжать предоставлять устаревшие `Perf` версии наших рабочих книг о производительности, которые относятся к данным в таблице.  

## <a name="will-the-service-map-data-sets-also-be-stored-in-insightsmetrics"></a>Будут ли также храниться наборы данных карты обслуживания в InsightsMetrics?

Наборы данных не будут дублироваться, если вы используете оба решения. Оба предложения совместно делятся наборами `VMComputer` данных, `VMProcess` которые будут `VMConnection`храниться `VMBoundPort` в (ранее ServiceMapComputer_CL), (ранее ServiceMapProcess_CL), и таблицами для хранения наборов данных карты, которые мы собираем.  

Таблица `InsightsMetrics` будет хранить наборы данных VM, process и service data, которые мы собираем, и будет заселена только в том случае, если вы используете Azure Monitor для vMs и решение VM Insights. Решение «Карта обслуживания» не будет собирать `InsightsMetrics` и не хранить данные в таблице.

## <a name="will-i-be-double-charged-if-i-have-the-service-map-and-vminsights-solutions-in-my-workspace"></a>Будет ли я платить двойную плату, если у меня есть сервисная карта и решения VMInsights в моем рабочем пространстве?

Нет, эти два решения совместно с наборами данных карты, которые мы храним `VMComputer` (ранее ServiceMapComputer_CL), `VMProcess` (ранее ServiceMapProcess_CL), `VMConnection`и `VMBoundPort`. Вы не будете платить двойную плату за эти данные, если у вас есть оба решения в рабочей области.

## <a name="if-i-remove-either-the-service-map-or-vminsights-solution-will-it-remove-my-data"></a>Если я удалю карту обслуживания или решение VMInsights, будет ли он удален мои данные?

Нет, эти два решения совместно с наборами данных карты, которые мы храним `VMComputer` (ранее ServiceMapComputer_CL), `VMProcess` (ранее ServiceMapProcess_CL), `VMConnection`и `VMBoundPort`. Если удалить одно из решений, эти наборы данных заметят, что все еще существует решение, которое использует данные и остается в рабочей области Log Analytics. Для удаления данных из рабочего пространства необходимо удалить оба решения из рабочего пространства.

## <a name="health-feature-is-in-limited-public-preview"></a>Функция работоспособности находится в ограниченном общедоступном предварительном просмотре

Мы получили много отличных отзывов от клиентов о нашем наборе функций VM Health. Существует большой интерес вокруг этой функции и волнение по поводу ее потенциал для поддержки мониторинга рабочих процессов. Мы планируем внести ряд изменений, чтобы добавить функциональность и устранить полученные отзывы. 

Чтобы свести к минимуму влияние этих изменений на новых клиентов, мы перенесли эту функцию в **ограниченный публичный предварительный просмотр.** Это обновление произошло в октябре 2019 года.

Мы планируем перезапустить эту функцию Health в 2020 году, после того, как Azure Monitor для ВМ находится в GA.

## <a name="how-do-existing-customers-access-the-health-feature"></a>Как существующие клиенты получают доступ к функции «Здоровье»?

Существующие клиенты, использующие функцию Health, будут по-прежнему иметь к ней доступ, но она не будет предлагаться новым клиентам.  

Чтобы получить доступ к функции, `feature.vmhealth=true` можно добавить следующий флаг функции в URL [https://portal.azure.com](https://portal.azure.com)портала Azure. Пример `https://portal.azure.com/?feature.vmhealth=true`.

Вы также можете использовать этот короткий URL, [https://aka.ms/vmhealthpreview](https://aka.ms/vmhealthpreview)который устанавливает функцию флагавтоматически: .

Как существующий клиент, вы можете продолжать использовать функцию «Здоровье» на вс-минах, которые подключены к существующей настройке рабочего пространства с функциональностью работоспособности.  

## <a name="i-use-vm-health-now-with-one-environment-and-would-like-to-deploy-it-to-a-new-one"></a>Я использую VM Health теперь с одной средой и хотел бы развернуть его в новую

Если вы являетесь существующим клиентом, который использует функцию Health и хотите использовать vminsights@microsoft.com ее для нового развертывания, пожалуйста, свяжитесь с нами, чтобы запросить инструкции.

## <a name="next-steps"></a>Дальнейшие действия

Сведения о требованиях и методах, помогающих отслеживать виртуальные машины, см. в статье [Подключение Azure Monitor для виртуальных машин (предварительная версия)](vminsights-enable-overview.md).
