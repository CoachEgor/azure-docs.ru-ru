---
title: Часто задаваемые вопросы Azure Monitor для виртуальных машин (общедоступные) | Документация Майкрософт
description: Azure Monitor для виртуальных машин — это решение в Azure, которое отслеживает работоспособность и производительность ОС виртуальных машин Azure, автоматически обнаруживает компоненты приложений и их зависимости от других ресурсов, а также строит схему каналов связи между ними. В этой статье содержатся ответы на часто задаваемые вопросы о общедоступном выпуске.
ms.service: azure-monitor
ms.subservice: ''
ms.topic: conceptual
author: mgoedtel
ms.author: magoedte
ms.date: 10/07/2019
ms.openlocfilehash: 523fb2d3a3b148afc9219e666c2fbe7fa40d58ad
ms.sourcegitcommit: ae461c90cada1231f496bf442ee0c4dcdb6396bc
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/17/2019
ms.locfileid: "72553799"
---
# <a name="azure-monitor-for-vms-generally-available-ga-frequently-asked-questions"></a>Часто задаваемые вопросы о Azure Monitor для виртуальных машин общедоступной версии

Недавно мы объявили о том, что в блоге по [обновлению Azure](https://azure.microsoft.com/blog/) были внесены некоторые запланированные изменения, которые будут происходить в октябре и ноябрь 2019. Дополнительные сведения об этих изменениях см. в статье часто задаваемые вопросы о доступности.

## <a name="updates-for-azure-monitor-for-vms"></a>Обновления для Azure Monitor для виртуальных машин

Мы выпускаем новую версию Azure Monitor для виртуальных машин в ноябре. Клиенты, которые передают мониторы Azure для виртуальных машин после этого выпуска, автоматически получат новую версию, но уже имеющиеся клиенты Azure Monitor для виртуальных машин получат запрос на обновление.  Это часто задаваемые вопросы и документация, в которой содержатся рекомендации по выполнению полного обновления при наличии крупных развертываний в нескольких рабочих областях.

В этом обновлении Azure Monitor для виртуальных машин наборы данных производительности теперь хранятся в той же `InsightsMetrics` таблице, что и [Azure Monitor для контейнеров](container-insights-overview.md), и упрощают выполнение запросов к этим двум наборам. Кроме того, вы можете хранить более разнообразные наборы данных, которые не могли бы храниться в ранее использованной таблице.  Наши представления производительности также будут обновлены для использования этой новой таблицы.

Мы переходим к новым типам данных для наших наборов данных подключения. Данные, которые в настоящее время хранятся в `ServiceMapComputer_CL` и `ServiceMapProcess_CL`, которые используют пользовательские таблицы журналов, будут перемещаться на выделенные типы данных с именами `VMComputer` и `VMProcess`.  Переходя к выделенным типам данных, можно предоставить эти приоритеты для приема данных, и схема таблицы будет стандартизована для всех клиентов.

Мы понимаем, что возможность обновления существующих клиентов приводит к нарушению рабочего процесса, поэтому мы решили сделать это сейчас в общедоступной предварительной версии, а не позднее после приостановки.

## <a name="what-will-change"></a>Что изменится?

Сейчас, когда вы завершите процесс адаптации для Azure Monitor для виртуальных машин, включите решение Сопоставление служб в рабочей области, выбранной для хранения данных мониторинга, а затем настройте счетчики производительности для данных, собранных из виртуальных машин. В ближайшие недели мы выпустим новое решение с именем **вминсигхтс**, которое будет включать дополнительные возможности для сбора данных вместе с новым расположением для хранения этих данных в log Analytics.

Текущий процесс использования счетчиков производительности в рабочей области отправляет данные в таблицу производительности в Log Analytics.  Это новое решение будет отсылать данные в таблицу с именем `InsightsMetrics`, которая также используется Azure Monitor для контейнеров. Эта схема таблицы позволяет нам хранить дополнительные метрики и наборы данных служб, несовместимые с форматом таблицы производительности.

## <a name="what-should-i-do-about-the-performance-counters-on-my-workspace-if-i-install-the-vminsights-solution"></a>Что делать со счетчиками производительности в моей рабочей области, если я устанавливаю решение Вминсигхтс?

Текущий метод включения Azure Monitor для виртуальных машин использует счетчики производительности в рабочей области. Новый метод сохраняет эти данные в новой таблице с именем `InsightsMetrics`.

После обновления пользовательского интерфейса для использования данных в Инсигхтсметрикс мы будем обновлять нашу документацию и сообщать об этом объявлении через несколько каналов, включая отображение баннера в портал Azure. На этом этапе вы можете отключить эти [счетчики производительности](vminsights-enable-overview.md#performance-counters-enabled) в рабочей области, если вы больше не хотите их использовать. 

[!NOTE]
>При наличии правил генерации оповещений, ссылающихся на эти счетчики в таблице производительности, необходимо обновить их, чтобы они ссылались на новые данные в таблице `InsightsMetrics`.  См. документацию по запросам к журналу, которые можно использовать для обращения к этой таблице.

Если вы решили включить счетчики производительности, вам будет выставлен счет за данные, полученные и сохраняемые в таблице производительности на основе [цены на Log Analytics [(https://azure.microsoft.com/pricing/details/monitor/).

## <a name="how-will-this-change-affect-my-alert-rules"></a>Как это изменение повлияет на мои правила генерации оповещений?

Если вы создали [оповещения журнала](../platform/alerts-unified-log.md) , которые запрашивают в `Perf` таблице счетчики производительности, которые были включены в рабочей области, следует обновить эти правила, чтобы они ссылались на `InsightsMetrics` таблицу. Это руководство также применяется к любым правилам поиска журналов, использующим `ServiceMapComputer_CL` и `ServiceMapProcess_CL`, так как эти наборы данных перемещаются в `VMComputer` и `VMProcess` таблицы.

Мы будем обновлять эту часто задаваемые вопросы и документацию, включив в нее примеры правил генерации оповещений поиска по журналам для наборов данных, которые мы соберем.

## <a name="will-there-be-any-changes-to-billing"></a>Будут ли изменения в оплате?

Выставление счетов по-прежнему основано на данных, полученных и хранящихся в Log Analytics рабочей области.

Собранные данные о производительности на уровне компьютера одинаковы, имеют одинаковый размер для данных, хранящихся в таблице производительности, и будут стоить примерно столько же.

## <a name="what-if-i-only-want-to-use-service-map"></a>Что делать, если я хотел бы использовать только Сопоставление служб?

Это нормально.  Вы увидите запросы в портал Azure при просмотре Azure Monitor для виртуальных машин о предстоящем обновлении. После выпуска вы получите запрос на обновление до новой версии. Если вы предпочитаете использовать только функции [карт](vminsights-maps.md) , то можете не обновлять и продолжать использовать функцию карт Azure Monitor для виртуальных машин и сопоставление служб решение, доступ к которому осуществляется из рабочей области или плитки панели мониторинга.

Если вы решили включить счетчики производительности вручную в рабочей области, вы можете увидеть данные на некоторых из наших диаграмм производительности, просмотрев их Azure Monitor. После выпуска нового решения мы будем обновлять наши диаграммы производительности для запроса данных, хранящихся в таблице `InsightsMetrics`. Если вы хотите просмотреть данные из этой таблицы на этих диаграммах, необходимо выполнить обновление до новой версии Azure Monitor для виртуальных машин.

Изменения в перемещении данных из `ServiceMapComputer_CL` и `ServiceMapProcess_CL` будут влиять как на Сопоставление служб, так и на Azure Monitor для виртуальных машин, поэтому вам все равно нужно спланировать это обновление.

Если вы решили не выполнять обновление до решения **вминсигхтс** , мы будем продолжать предоставлять устаревшие версии книг по производительности, которые ссылаются на данные в таблице `Perf`.  

## <a name="will-the-service-map-data-sets-also-be-stored-in-insightsmetrics"></a>Будут ли Сопоставление служб наборы данных также сохранены в Инсигхтсметрикс?

Если используются оба решения, наборы данных не будут дублироваться. Оба предложения совместно используют наборы данных, которые будут храниться в `VMComputer` (ранее ServiceMapComputer_CL), `VMProcess` (ранее ServiceMapProcess_CL), `VMConnection` и `VMBoundPort` таблицах для хранения наборов данных сопоставлений, которые мы соберем.  

Таблица `InsightsMetrics` будет использоваться для хранения наборов данных виртуальных машин, процессов и служб, которые собираются и будут заполнены только при использовании Azure Monitor для виртуальных машин.

## <a name="will-i-be-double-charged-if-i-have-the-service-map-and-vminsights-solutions-on-my-workspace"></a>Будет ли я вдвое заряжена, если у меня есть решения Сопоставление служб и Вминсигхтс в моей рабочей области?

Нет, два решения совместно используют наборы данных карт, которые хранятся в `VMComputer` (ранее ServiceMapComputer_CL), `VMProcess` (ранее ServiceMapProcess_CL), `VMConnection` и `VMBoundPort`.  Если в вашей рабочей области есть оба решения, вы не будете использовать двойную оплату за эти данные.

## <a name="if-i-remove-either-the-service-map-or-vminsights-solution-will-it-remove-my-data-in-log-analytics"></a>Если удалить решение Сопоставление служб или Вминсигхтс будет удалять мои данные в Log Analytics?

Нет, два решения совместно используют наборы данных карт, которые хранятся в `VMComputer` (ранее ServiceMapComputer_CL), `VMProcess` (ранее ServiceMapProcess_CL), `VMConnection` и `VMBoundPort`.  Если удалить одно из решений, эти наборы данных заметят, что по-прежнему существует решение, использующее данные, и оно остается в Log Analytics.  Для удаления данных из рабочей области Log Analytics необходимо удалить оба решения из рабочей области.

## <a name="when-will-this-update-be-released"></a>Когда будет выпущено это обновление?

Мы планируем выпустить обновление для Azure Monitor для виртуальных машин в середине ноября. По мере приближения к дате выпуска обновления будут публиковаться здесь и Показывать уведомления в портал Azure при переходе к Azure Monitor.

## <a name="health-feature-to-enter-limited-public-preview"></a>Функция работоспособности для входа в ограниченную общедоступную предварительную версию

Мы получили огромное мнение от клиентов о наборе функций работоспособности виртуальной машины.  Эта функция очень интересна и повышена благодаря возможности поддерживать рабочие процессы мониторинга. Мы планируем внести ряд изменений, чтобы добавить функции и устранить полученные отзывы. Чтобы снизить влияние этих изменений на новых клиентов, мы перемещая эту функцию в ограниченную общедоступную предварительную версию.

Этот переход начнется в начале октября, и его следует завершить до конца месяца.

Вот некоторые из областей, на которые мы будем сосредоточеновать:

- Более полный контроль над моделью работоспособности и пороговыми значениями
- Разработка в масштабных моделях работоспособности, применимых к области виртуальных машин
- Собственное использование платформы предупреждений для управления правилами генерации оповещений на основе исправности
- Возможность просмотра работоспособности в более широкой области, например одной или нескольких подписок.
- Сокращение задержки при переходах работоспособности и уведомлениях о предупреждениях

## <a name="how-do-existing-customers-access-the-health-feature"></a>Как существующие клиенты получают доступ к функции работоспособности?

Существующие клиенты, использующие функцию работоспособности, будут по прежнему иметь доступ к ней, но не будут предлагаться новым клиентам.  

Чтобы получить доступ к этой функции, можно добавить в URL-адрес портала следующий флаг компонента `feature.vmhealth=true` [https://portal.azure.com](https://portal.azure.com). Пример `https://portal.azure.com/?feature.vmhealth=true`.

Можно также использовать этот короткий URL-адрес, который автоматически устанавливает флаг компонента: [https://aka.ms/vmhealthpreview](https://aka.ms/vmhealthpreview).

В качестве существующего клиента можно продолжать использовать функцию работоспособности на виртуальных машинах, подключенных к существующей настройке рабочей области, с функцией работоспособности.  

## <a name="i-use-vm-health-now-with-one-environment-and-would-like-to-deploy-it-for-a-new-environment"></a>Теперь я использую работоспособность виртуальной машины с одной средой и хочу развернуть ее для новой среды.

Если вы являетесь клиентом, который использует функцию работоспособности и хотите использовать его для нового развертывания, свяжитесь с нами по адресу vminsights@microsoft.com, чтобы запросить инструкции.

## <a name="next-steps"></a>Дальнейшие действия

Сведения о требованиях и методах, помогающих отслеживать виртуальные машины, см. в статье [Подключение Azure Monitor для виртуальных машин (предварительная версия)](vminsights-enable-overview.md).
