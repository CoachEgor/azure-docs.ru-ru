---
title: Просмотр метрик в режиме реального времени с помощью Azure Monitor для контейнеров Документы Майкрософт
description: В этой статье описывается представление метрик в реальном времени без использования kubectl с Azure Monitor для контейнеров.
ms.topic: conceptual
ms.date: 10/15/2019
ms.openlocfilehash: 4604635c985057ec0b7f49a0d1cca7111dfc8eec
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "79216588"
---
# <a name="how-to-view-metrics-in-real-time"></a>Как просматривать метрики в режиме реального времени

Функция Azure Monitor для контейнеров Live Data (предварительный просмотр) позволяет визуализировать метрики состояния узлов и стручков в кластере в режиме реального времени. Он эмулирует прямой `kubectl top nodes`доступ `kubectl get pods –all-namespaces`к `kubectl get nodes` , и команды для вызова, анализа и визуализации данных в диаграммах производительности, которые включены в этот Insight. 

В этой статье содержится подробный обзор и помогает понять, как использовать эту функцию.  

>[!NOTE]
>Кластеры AKS включены как [частные кластеры](https://azure.microsoft.com/updates/aks-private-cluster/) не поддерживаются с помощью этой функции. Эта функция опирается на прямой доступ к API Kubernetes через прокси-сервер из вашего браузера. Включение сетевой безопасности для блокировки API Kubernetes из этого прокси будет блокировать этот трафик. 

>[!NOTE]
>Эта функция доступна во всех регионах Azure, включая Azure China. В настоящее время он недоступен в Azure правительства США.

Для получения помощи в настройке или устранении неполадок функции Live Data (предварительный просмотр) просмотрите наше [руководство по настройке.](container-insights-livedata-setup.md)

## <a name="how-it-works"></a>Принцип работы 

Функция Live Data (предварительный просмотр) непосредственно получает доступ к API Kubernetes, а дополнительную информацию о модели проверки подлинности можно найти [здесь.](https://kubernetes.io/docs/concepts/overview/kubernetes-api/) 

Эта функция выполняет операцию опроса в отношении `/api/v1/nodes` `/apis/metrics.k8s.io/v1beta1/nodes`конечных `/api/v1/pods`точек метрик (включая, и), которая каждые пять секунд по умолчанию. Эти данные кэшируются в вашем браузере и намечаются в четырех диаграммах производительности, включенных в Azure Monitor для контейнеров на вкладке **кластера,** выбрав **Go Live (предварительный просмотр).** Каждый последующий опрос намечается в подвижном пятиминутном окне визуализации. 

![Перейти Live вариант в виде кластера](./media/container-insights-livedata-metrics/cluster-view-go-live-example-01.png)

Интервал голосования настроен из выпадения **интервала набора,** что позволяет устанавливать опрос для новых данных каждые 1, 5, 15 и 30 секунд. 

![Перейти Live падение вниз интервал голосования](./media/container-insights-livedata-metrics/cluster-view-polling-interval-dropdown.png)

>[!IMPORTANT]
>Мы рекомендуем установить интервал опроса до одной секунды при устранении неполадок в течение короткого периода времени. Эти запросы могут повлиять на доступность и регулирование API Kubernetes в вашем кластере. После этого перенакируйся на более длительный интервал голосования. 

>[!IMPORTANT]
>Во время работы этой функции данные постоянно не хранятся. Вся информация, собранная во время сеанса, немедленно удаляется при закрытии браузера или удалении от функции. Данные остаются только для визуализации в пятиминутном окне; любые метрики старше пяти минут также навсегда удаляются.

Эти диаграммы не могут быть закреплены к последней панели мониторинга Azure, просматриваемым в режиме live.

## <a name="metrics-captured"></a>Собранные показатели телеметрии

### <a name="node-cpu-utilization---node-memory-utilization-"></a>Использование процессора узла % / Использование памяти узлов % 

Эти две диаграммы производительности отображают карту, эквивалентную вызыванию `kubectl top nodes` и захвату результатов столбцов **CPU%** и **MEMORY%** к соответствующей диаграмме. 

![Результаты примера примера верхних узлов Kubectl](./media/container-insights-livedata-metrics/kubectl-top-nodes-example.png)

![Диаграмма процент использования процессора узлов](./media/container-insights-livedata-metrics/cluster-view-node-cpu-util.png)

![Диаграмма процент использования удо памяти](./media/container-insights-livedata-metrics/cluster-view-node-memory-util.png)

Расчеты процентиля будут функционировать в больших кластерах, чтобы помочь определить узлы выбросов в кластере. Например, чтобы понять, не используются ли узлы для целей снижения масштаба. Используя агрегацию **Мин,** можно увидеть, какие узлы имеют низкое использование в кластере. Для дальнейшего исследования выберите вкладку **узлов** и сортируйте сетку по процессору или использованию памяти.

Это также поможет вам понять, какие узлы толкаются до предела и если может потребоваться масштабирование. Использование агрегаций **Max** и **P95** может помочь вам увидеть, есть ли узлы в кластере с высоким использованием ресурсов. Для дальнейшего исследования вы снова переключитесь на вкладку **«Узлы».**

### <a name="node-count"></a>Количество узлов

Эта диаграмма производительности отображает эквивалент `kubectl get nodes` вызывания и отображения столбца **STATUS** на диаграмму, сгруппированную по типам статусов.

![Kubectl получить результаты примера узлов](./media/container-insights-livedata-metrics/kubectl-get-nodes-example.png)

![Диаграмма подсчета узлов](./media/container-insights-livedata-metrics/cluster-view-node-count-01.png)

Узлы регистрируются либо в состоянии **ready** or **Not Ready.** Они подсчитываются (и создается общее количество), и намечаются результаты этих двух агрегаций.
Например, чтобы понять, попадают ли ваши узлы в недееспособные состояния. Используя агрегацию **неготовых,** можно быстро увидеть количество узлов в кластере, наданных в настоящее время в состоянии **неготовой** готовности.

### <a name="active-pod-count"></a>Активное количество стручков

Эта диаграмма производительности отображает эквивалент `kubectl get pods –all-namespaces` ссылания и отображает столбец STATUS в таблице **STATUS,** сгруппированный по типам статусов.

![Kubectl получить стручки пример результатов](./media/container-insights-livedata-metrics/kubectl-get-pods-example.png)

![Диаграмма подсчета узлов](./media/container-insights-livedata-metrics/cluster-view-node-pod-count.png)

>[!NOTE]
>Имена статуса, интерпретируемые `kubectl` может точно не совпадать в диаграмме. 

## <a name="next-steps"></a>Дальнейшие действия

Просмотр [примеров запросов журналов](container-insights-log-search.md#search-logs-to-analyze-data) для просмотра предопределенных запросов и примеров для создания оповещений, визуализаций или выполнения дальнейшего анализа кластеров.
