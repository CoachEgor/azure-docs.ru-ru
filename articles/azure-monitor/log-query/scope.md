---
title: Область запросов в журнале Azure Monitor Analytics (ru) Документы Майкрософт
description: Описывает область охвата и временной диапазон для запроса журналов в аналитике журналов Azure Monitor.
ms.subservice: logs
ms.topic: conceptual
author: bwren
ms.author: bwren
ms.date: 06/25/2019
ms.openlocfilehash: 897eff62fcbab5996b6b9493bd825ae412aa4c3e
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "79249598"
---
# <a name="log-query-scope-and-time-range-in-azure-monitor-log-analytics"></a>Область запросов и диапазон времени в аналитике журналов Azure Monitor
При запуске [запроса журнала](log-query-overview.md) в журнале Analytics на [портале Azure](get-started-portal.md)набор данных, оцениваемых запросом, зависит от выбранной области и диапазона времени. В этой статье описаны область охвата и временной диапазон и как вы можете установить каждый в зависимости от ваших требований. Он также описывает поведение различных типов областей.


## <a name="query-scope"></a>Область запроса
Область запроса определяет записи, которые оцениваются запросом. Это обычно включает все записи в одном рабочем пространстве журнала Analytics или приложении Application Insights. Аналитика журналов также позволяет установить область возможностей для конкретного мониторингового ресурса Azure. Это позволяет владельцу ресурса сосредоточиться только на своих данных, даже если этот ресурс записывается в несколько рабочих областей.

Область всегда отображается в левом верхнем верхнем отоке окна log Analytics. Значок указывает, является ли область рабочей областью Log Analytics или приложением Application Insights. Нет значка указывает на другой ресурс Azure.

![Область](media/scope/scope.png)

Область определяется методом запуска log Analytics, а в некоторых случаях можно изменить область действия, нажав на нее. В следующей таблице перечислены различные типы используемой области и различные детали для каждого из них.

| Область запроса | Записи по объему | Как выбрать | Изменение области |
|:---|:---|:---|:---|
| Рабочая область Log Analytics | Все записи в рабочей области Log Analytics. | Выберите **журналы** из меню **Azure Monitor** или меню **рабочих областей анализа журналов.**  | Может изменить область действия на любой другой тип ресурса. |
| Приложение Insights | Все записи в приложении Application Insights. | Выберите **Аналитику** на странице **Обзор** приложений. | Может изменить область действия только в другом приложении Application Insights. |
| Группа ресурсов | Записи, созданные всеми ресурсами в группе ресурсов. Может включать данные из нескольких рабочих областей анализа журналов. | Выберите **журналы** из меню группы ресурсов. | Не может изменить область применения.|
| Подписка | Записи, созданные всеми ресурсами в подписке. Может включать данные из нескольких рабочих областей анализа журналов. | Выберите журналы из меню **подписки.**   | Не может изменить область применения. |
| Другие ресурсы Azure | Записи, созданные ресурсом. Может включать данные из нескольких рабочих областей анализа журналов.  | Выберите **журналы** из меню ресурсов.<br>OR<br>Выберите **журналы** из меню **Azure Monitor,** а затем выберите новую область. | Может изменять область действия только на тот же тип ресурса. |

### <a name="limitations-when-scoped-to-a-resource"></a>Ограничения при охвате ресурса

Когда область запроса является рабочим пространством Log Analytics или приложением Application Insights, все варианты на портале и все команды запросов доступны. При сходе ресурса следующие параметры на портале недоступны, поскольку они связаны с одним рабочим пространством или приложением:

- Сохранять
- Обозреватель запросов
- Новое правило генерации оповещений

Вы не можете использовать следующие команды в запросе, когда область охвата ресурса, так как область запроса уже будет включать любые рабочие области с данными для этого ресурса или набора ресурсов:

- [Приложение](app-expression.md)
- [Рабочей области](workspace-expression.md)
 

## <a name="query-limits"></a>Ограничения на запросы
У ресурса Azure могут возникнуть бизнес-требования для записи данных в несколько рабочих областей анализа журналов. Рабочее пространство не должно находиться в том же регионе, что и ресурс, и одно рабочее пространство может собирать данные из ресурсов в различных регионах.  

Установка области на ресурс или набор ресурсов является особенно мощной особенностью Log Analytics, поскольку она позволяет автоматически консолидировать распределенные данные в одном запросе. Это может существенно повлиять на производительность, если данные необходимо извлечь из рабочих областей в нескольких регионах Azure.

Аналитика журналов помогает защититься от чрезмерных накладных расходов от запросов, которые охватывают рабочие области в нескольких регионах, выдавая предупреждение или ошибку при использовании определенного числа регионов. Ваш запрос получит предупреждение, если область включает рабочие области в 5 или более регионах. он будет по-прежнему работать, но это может занять чрезмерное время для завершения.

![Предупреждение о запросе](media/scope/query-warning.png)

Ваш запрос будет заблокирован, если область включает рабочие области в 20 или более регионах. В этом случае вам будет предложено сократить количество областей рабочего пространства и попытаться запустить запрос снова. Выпадение будет отображать все регионы в области запроса, и следует сократить количество регионов, прежде чем пытаться запустить запрос снова.

![Запрос не удался](media/scope/query-failed.png)


## <a name="time-range"></a>Диапазон времени
Диапазон времени определяет набор записей, которые оцениваются для запроса на основе момента создания записи. Это определяется стандартным свойством на каждой записи в рабочей области или приложении, указанной в следующей таблице.

| Расположение | Свойство |
|:---|:---|
| Рабочая область Log Analytics          | TimeGenerated |
| Приложение Insights | TIMESTAMP     |

Установите временной диапазон, выбрав его из времени сборщика в верхней части окна Log Analytics.  Можно выбрать заранее определенный период или настроить **для** указания определенного диапазона времени.

![Средство выбора времени](media/scope/time-picker.png)

Если вы установите фильтр в запросе, который использует стандартное свойство времени, как показано в таблице выше, сборщик времени изменяется **в Установить в запросе,** и время сборщик отключен. В этом случае наиболее эффективно помещать фильтр в верхнюю часть запроса, чтобы любая последующая обработка работала только с отфильтрованными записями.

![Фильтрованный запрос](media/scope/query-filtered.png)

Если вы используете [рабочую область](workspace-expression.md) или команду [приложения](app-expression.md) для получения данных из другого рабочего пространства или приложения, сборщик времени может вести себя по-другому. Если область является рабочим пространством Log Analytics и вы используете **приложение,** или если область является приложением Application Insights и вы используете **рабочее пространство,** то Log Analytics может не понимать, что свойство, используемое в фильтре, должно определять временной фильтр.

В следующем примере область установлена в рабочей области Log Analytics.  Запрос использует **рабочее пространство** для извлечения данных из другого рабочего пространства Log Analytics. Сборщик времени изменяется **в запросе,** поскольку он видит фильтр, который использует ожидаемое свойство **TimeGenerated.**

![Запрос с рабочим пространством](media/scope/query-workspace.png)

Если запрос использует **приложение** для извлечения данных из приложения Application Insights, журнал Analytics не распознает свойство **метки времени** в фильтре, а сборщик времени остается неизменным. В этом случае оба фильтра применяются. В этом примере в запрос включены только записи, созданные за последние 24 часа, даже если в нем указывается 7 дней в пункте, **где.**

![Запрос с приложением](media/scope/query-app.png)

## <a name="next-steps"></a>Дальнейшие действия

- Пройдите [курс по использованию аналитики журналов на портале Azure.](get-started-portal.md)
- Прогулка через [учебник по написанию запросов](get-started-queries.md).
