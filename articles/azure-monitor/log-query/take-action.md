---
title: Действие Runbook службы автоматизации Azure в Log Analytics, инициированное пользователем | Документы Майкрософт
description: В этой статье описывается запуск модуля runbook службы автоматизации на основе результатов поиска Log Analytics по требованию.
services: log-analytics
documentationcenter: ''
author: mgoedtel
manager: carmonm
editor: tysonn
ms.assetid: ''
ms.service: log-analytics
ms.topic: conceptual
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 02/06/2019
ms.author: magoedte
ms.openlocfilehash: 9194d5fe6553607ac5a0bb4e133da97f53790984
ms.sourcegitcommit: d4dfbc34a1f03488e1b7bc5e711a11b72c717ada
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/13/2019
ms.locfileid: "61424760"
---
# <a name="take-action-with-an-automation-runbook-from-a-log-analytics-log-search-result"></a>Выполнение действия с Runbook службы автоматизации на основе результатов поиска Log Analytics

> [!NOTE]
> Запуск модуля runbook из результатов поиска — это функция классического портала Log Search, которая будет считаться устаревшей с 15 февраля 2019 г. Вы можете настроить группу действий, которая запустит runbook, а также другие действия из [правила генерации оповещений](../platform/alerts-log.md) в Azure Monitor.

В результатах поиска по журналам в Azure Log Analytics теперь можно выбрать пункт **Выполнить действие** для запуска модуля runbook службы автоматизации.  Runbook может использоваться для устранения проблемы или выполнения некоторых других действий, таких как сбор диагностических сведений, отправка сообщения электронной почты или создание запроса на обслуживание. 


## <a name="components-and-features-used"></a>Используемые компоненты и функции
* [Учетная запись службы автоматизации Azure](../../automation/automation-quickstart-create-account.md)
* [Рабочая область Log Analytics](../../azure-monitor/log-query/log-query-overview.md)

## <a name="to-initiate-runbook-from-log-search"></a>Запуск runbook из результатов поиска по журналам

Чтобы отреагировать на событие и запустить runbook из результатов поиска по журналам, выполните поиск по журналам и на основе результатов вызовите runbook по запросу. Это можно сделать через функцию поиска по классическим журналам или на [портале Azure](../../azure-monitor/log-query/log-query-overview.md). В этом примере мы выполняем поиск по журналам на портале Azure, демонстрируя основные возможности этой функции.

1. На портале Azure щелкните **Все службы** и выберите **Log Analytics**.  
2. Выберите рабочую область Log Analytics.
3. В рабочей области выберите **Журналы (классические)** .  
4. Выполните поиск на странице "Поиск по журналу".  
5. В результатах поиска по журналам нажмите кнопку с многоточием слева от полей и в контекстном меню выберите пункт **Выполнить действие с**.<br><br> ![Выбор "Выполнить действие" в результатах поиска](./media/take-action/log-search-takeaction-menuoption.png) 
6. Нажмите **Запустить Runbook** и выберите модуль Runbook для запуска.  Вы можете выбрать любой runbook в учетной записи службы автоматизации, связанной с рабочей областью Log Analytics.  Обратите внимание на следующее.

    * Модули runbook группируются по тегам.
    * Значения входных параметров runbook можно выбрать непосредственно из полей результатов поиска.  Появится раскрывающийся список со всеми доступными для выбора полями в результатах.  
    * Можно выбрать выполнение runbook для [гибридной рабочей роли Runbook](../../automation/automation-hybrid-runbook-worker.md), установленной на компьютере, на котором возникли проблемы, если у вас есть соответствующая группа гибридных рабочих ролей Runbook, содержащая только этот компьютер.  Если имя группы гибридных рабочих ролей совпадает с именем компьютера, которое содержится в результатах поиска по журналам, группа выбирается автоматически.    

6. После нажатия кнопки **Выполнить** открывается страница задания Runbook, в которой можно просмотреть состояние задания.   

При выборе модуля runbook, который был настроен для [вызова из оповещения Log Analytics](../../automation/automation-create-alert-triggered-runbook.md), он имеет входной параметр с именем **WebhookData** типа **Объект**.  Если входной параметр является обязательным, вам потребуется передать результаты поиска в runbook, чтобы преобразовать строку в формате JSON в тип объекта, что позволит вам выполнить фильтрацию по конкретным элементам, на которые вы будете ссылаться в действиях runbook.  Это можно сделать, выбрав **результат поиска (Объект)** в раскрывающемся списке.<br><br> ![Выбор объекта данных Webhook для параметра runbook](media/take-action/select-runbook-and-properties.png)   
    
## <a name="next-steps"></a>Дальнейшие действия

* Полный список полей и аспектов для поиска, доступных в Log Analytics, см. в [справочнике по поиску в журналах Log Analytics](../../azure-monitor/log-query/log-query-overview.md).
* Сведения об автоматическом вызове runbook службы автоматизации см. в статье [Вызов модуля Runbook службы автоматизации Azure из оповещения Log Analytics](../../automation/automation-create-alert-triggered-runbook.md).  
