---
title: Общие сведения о запросах журналов в Azure Monitor | Документация Майкрософт
description: Ответы на часто задаваемые вопросы о запросах к журналу и о том, как приступить к их использованию.
ms.subservice: logs
ms.topic: conceptual
author: bwren
ms.author: bwren
ms.date: 06/19/2019
ms.openlocfilehash: 5a47de51a90d926b47f6b465d6c10111407da9c6
ms.sourcegitcommit: 829d951d5c90442a38012daaf77e86046018e5b9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/09/2020
ms.locfileid: "90033172"
---
# <a name="overview-of-log-queries-in-azure-monitor"></a>Общие сведения о запросах журналов в Azure Monitor
Запросы журналов позволяют полностью использовать значения данных, собираемых в [журналах Azure Monitor](../platform/data-platform-logs.md). Мощный язык запросов позволяет объединять данные из нескольких таблиц, объединять большие наборы данных и выполнять сложные операции с минимальным кодом. Практически любой вопрос можно ответить и выполнить анализ до тех пор, пока собираются вспомогательные данные, и вы понимаете, как создать правильный запрос.

Некоторые функции в Azure Monitor, такие как [Insights](../insights/insights-overview.md) и [Solutions](../monitor-reference.md) , обрабатывают данные журнала без предоставления доступа к базовым запросам. Чтобы полностью использовать другие функции Azure Monitor, необходимо понимать, как создаются запросы и как их можно использовать для интерактивного анализа данных в журналах Azure Monitor.

Используйте эту статью в качестве отправной точки для изучения запросов журнала в Azure Monitor. Он содержит ответы на часто задаваемые вопросы и ссылки на другую документацию, в которой содержатся дополнительные сведения и занятия.

## <a name="how-can-i-learn-how-to-write-queries"></a>Как можно научиться писать запросы?
Если вы хотите перейти непосредственно к тому, вы можете начать со следующих учебников:

- Приступая [к работе с log Analytics в Azure Monitor](get-started-portal.md).
- Приступая [к работе с запросами журналов в Azure Monitor](get-started-queries.md).

Получив основные сведения, ознакомьтесь с несколькими занятиями, используя собственные данные или данные из нашей демонстрационной среды, начиная с: 

- [Работа со строками в запросах журнала Azure Monitor](string-operations.md)
 
## <a name="what-language-do-log-queries-use"></a>Какие языки используют запросы журнала?
Azure Monitor журналы основаны на [Обозреватель данныхах Azure](/azure/data-explorer), а запросы журнала записываются с помощью того же языка запросов KUSTO (ККЛ). Это расширенный язык, предназначенный для простоты чтения и создания, и вы можете начать использовать его с минимальными рекомендациями.

Полную документацию по ККЛ и справочные сведения о различных доступных функциях см. в [документации по обозреватель данных ККЛ Azure](/azure/kusto/query) .<br>
Краткое пошаговое руководство по языку с использованием данных из журналов Azure Monitor см. [в статье Приступая к работе с запросами журналов в Azure Monitor](get-started-queries.md) .
Дополнительные отличия в версии ККЛ, используемой Azure Monitor, см. в [Azure Monitor разделе различия в языке запросов журналов](data-explorer-difference.md) .

## <a name="what-data-is-available-to-log-queries"></a>Какие данные доступны для запросов журнала?
Все данные, собранные в журналах Azure Monitor, доступны для извлечения и анализа в запросах журнала. Различные источники данных записывают свои данные в разные таблицы, но в одном запросе можно включить несколько таблиц, чтобы анализировать данные в нескольких источниках. При создании запроса сначала нужно определить, какие таблицы содержат нужные данные. Описание структурирования данных см. в разделе [Структура журналов Azure Monitor](logs-structure.md) .

## <a name="what-does-a-log-query-look-like"></a>Как выглядит запрос журнала?
Запрос может быть простым, например, одним именем таблицы для получения всех записей из этой таблицы:

```Kusto
Syslog
```

Также можно отфильтровать определенные записи, обобщить их и визуализировать результаты в виде диаграммы:

```
SecurityEvent
| where TimeGenerated > ago(7d)
| where EventID == 4625
| summarize count() by Computer, bin(TimeGenerated, 1h)
| render timechart 
```

Для более сложного анализа можно извлечь данные из нескольких таблиц с помощью объединения, чтобы проанализировать результаты вместе.

```Kusto
app("ContosoRetailWeb").requests
| summarize count() by bin(timestamp,1hr)
| join kind= inner (Perf
    | summarize avg(CounterValue) 
      by bin(TimeGenerated,1hr))
on $left.timestamp == $right.TimeGenerated
```
Даже если вы не знакомы с ККЛ, вы сможете по крайней мере определить базовую логику, используемую этими запросами. Они начинаются с имени таблицы, а затем добавляют несколько команд для фильтрации и обработки этих данных. Запрос может использовать любое количество команд, и вы можете написать более сложные запросы, когда вы узнаете о различных доступных командах ККЛ.

В разделе [Приступая к работе с запросами журналов в Azure Monitor](get-started-queries.md) содержится руководство по запросам журналов, в которых представлен язык и общие функции.<br>


## <a name="what-is-log-analytics"></a>Что такое Log Analytics?
Log Analytics является основным инструментом портала Azure для написания запросов журналов и интерактивного анализа результатов. Даже если запрос журнала используется где-либо еще в Azure Monitor, обычно вы сначала пишете и тестируете запрос с помощью Log Analytics.

Вы можете запустить Log Analytics из нескольких мест в портал Azure. Область данных, доступных для Log Analytics, определяется способом запуска. Дополнительные сведения см. в разделе [область запроса](scope.md) .

- Выберите **журналы** в меню **Azure Monitor** или в меню **log Analytics рабочие области** .
- Выберите **журналы** на странице **Обзор** приложения Application Insights.
- Выберите **журналы** в меню ресурса Azure.

![Log Analytics](media/log-query-overview/log-analytics.png)

Пошаговое руководство по Log Analytics, в котором представлено несколько функций, см. [в статье Приступая к работе с log Analytics в Azure Monitor](get-started-portal.md) .

## <a name="where-else-are-log-queries-used"></a>Где еще используются запросы журнала?
В дополнение к интерактивной работе с запросами журналов и их результатами в Log Analytics области в Azure Monitor, где будут использоваться запросы, включают следующее:

- **Правила генерации оповещений.** [Правила генерации оповещений](../platform/alerts-overview.md) заранее выявляют проблемы с данными в рабочей области.  Каждое правило генерации оповещений основано на поиске по журналам, который автоматически выполняется через определенные интервалы.  Результаты проверяются, чтобы определить, следует ли создавать оповещение.
- **Информационные панели.** Результаты любого запроса можно закрепить на [панели мониторинга Azure](../learn/tutorial-logs-dashboards.md), что даст вам возможность визуализировать данные журналов и метрик вместе и при необходимости использовать совместно с другими пользователями Azure.
- **Представления.**  Вы можете создавать визуализации данных, которые добавлены на панели мониторинга пользователя, с помощью [конструктора представлений](../platform/view-designer.md).  Запросы к журналам предоставляют данные, используемые [плитками](../platform/view-designer-tiles.md) и [элементами визуализации](../platform/view-designer-parts.md) в каждом просмотре.  
- **Программе.**  Когда вы экспортируете данные из Azure Monitor в Excel или [Power BI](../platform/powerbi.md), вы создаете запрос по журналам для определения экспортируемых данных.
- **Оболочк.** Вы можете запустить сценарий PowerShell из командной строки или модуля Runbook службы автоматизации Azure, который использует [Get-азоператионалинсигхтссеарчресултс](/powershell/module/az.operationalinsights/get-azoperationalinsightssearchresult) для получения данных журнала из Azure Monitor.  Для этого командлета требуется запрос, чтобы определить извлекаемые данные.
- **API журналов Azure Monitor.**  [API журналов Azure Monitor](https://dev.loganalytics.io) позволяет любому клиенту REST API извлекать данные журнала из рабочей области.  Запрос API включает запрос, который выполняется в Azure Monitor, чтобы определить извлекаемые данные.


## <a name="next-steps"></a>Дальнейшие шаги
- Пошаговое [руководство по использованию log Analytics в портал Azure](get-started-portal.md).
- Пошаговое [руководство по написанию запросов](get-started-queries.md).
