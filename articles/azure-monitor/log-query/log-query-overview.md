---
title: Обзор запросов журналов в Azure Monitor Документы Майкрософт
description: Ответы на общие вопросы, связанные с журналом запросов и получает вы начали использовать их.
ms.subservice: logs
ms.topic: conceptual
author: bwren
ms.author: bwren
ms.date: 06/19/2019
ms.openlocfilehash: 54a6f875bc33d24d412d2424c634d1019b4af399
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "77670123"
---
# <a name="overview-of-log-queries-in-azure-monitor"></a>Обзор запросов журналов в Azure Monitor
Запросы журнала помогают в полной мере использовать ценность данных, собранных в [журналах Azure Monitor.](../platform/data-platform-logs.md) Мощный язык запросов позволяет объединять данные из нескольких таблиц, агрегировать большие наборы данных и выполнять сложные операции с минимальным кодом. Практически на любой вопрос можно ответить и провести анализ до тех пор, пока собраны вспомогательные данные, и вы понимаете, как построить правильный запрос.

Некоторые функции в Azure Monitor, такие как [идеи](../insights/insights-overview.md) и [решения,](../insights/solutions-inventory.md) обрабатывают данные журналов, не подвергая вас базовым запросам. Чтобы полностью использовать другие функции Azure Monitor, следует понять, как строятся запросы и как их можно использовать для интерактивного анализа данных в журналах Azure Monitor.

Используйте эту статью в качестве отправной точки для изучения запросов журналов в Azure Monitor. Он отвечает на распространенные вопросы и предоставляет ссылки на другую документацию, которая предоставляет более подробную информацию и уроки.

## <a name="how-can-i-learn-how-to-write-queries"></a>Как научиться писать запросы?
Если вы хотите, чтобы перейти прямо в вещи, вы можете начать со следующих учебников:

- [Начатые с аналитики журналов в Azure Monitor](get-started-portal.md).
- [Начатые с запросов журнала в Azure Monitor](get-started-queries.md).

После того, как у вас есть основы вниз, пройти через несколько уроков, используя свои собственные данные или данные из нашей демо-среды, начиная с: 

- [Работа со строками в запросах журнала Azure Monitor](string-operations.md)
 
## <a name="what-language-do-log-queries-use"></a>На каком языке используются запросы журналов?
Журналы Azure Monitor основаны на [Azure Data Explorer,](/azure/data-explorer)а запросы журналов записываются с использованием того же языка запросов Kusto (КЗЛ). Это богатый язык, разработанный, чтобы быть легко читаемым и автором, и вы должны быть в состоянии начать использовать его с минимальным руководством.

Ознакомиться с [документацией Azure Data Explorer КЗЛ](/azure/kusto/query) можно найти полную документацию по КЗЛ и ссылки на различные доступные функции.<br>
Смотрите [начало с запросами журналов в Azure Monitor](get-started-queries.md) для быстрого прохождения языка с использованием данных из журналов Azure Monitor.
См. различия в [языке запросов запросов Azure Monitor](data-explorer-difference.md) для незначительных различий в версии КЗЛ, используемой Azure Monitor.

## <a name="what-data-is-available-to-log-queries"></a>Какие данные доступны для журналов запросов?
Все данные, собранные в журналах Azure Monitor, доступны для получения и анализа в поисковых запросах. Различные источники данных будут записывать свои данные в разные таблицы, но можно включить несколько таблиц в один запрос для анализа данных в нескольких источниках. При создании запроса вы начинаете с определения того, в каких таблицах есть данные, которые вы ищете, поэтому необходимо иметь по крайней мере базовое понимание структуры данных в журналах Azure Monitor.

Ознакомиться с [источниками журналов мониторинга Azure](../platform/data-platform-logs.md#sources-of-azure-monitor-logs)можно в списке различных источников данных, населяемых журналами Azure Monitor.<br>
Для объяснения структуры [журналов Azure Monitor смотрите журналы «Структура монитора»](logs-structure.md) для получения

## <a name="what-does-a-log-query-look-like"></a>Как выглядит запрос журнала?
Запрос может быть простым, как одно название таблицы для извлечения всех записей из этой таблицы:

```Kusto
Syslog
```

Или он может фильтровать для определенных записей, суммировать их и визуализировать результаты на диаграмме:

```
SecurityEvent
| where TimeGenerated > ago(7d)
| where EventID == 4625
| summarize count() by Computer, bin(TimeGenerated, 1h)
| render timechart 
```

Для более сложного анализа можно получить данные из нескольких таблиц, используя соединение для совместного анализа результатов.

```Kusto
app("ContosoRetailWeb").requests
| summarize count() by bin(timestamp,1hr)
| join kind= inner (Perf
    | summarize avg(CounterValue) 
      by bin(TimeGenerated,1hr))
on $left.timestamp == $right.TimeGenerated
```
Даже если вы не знакомы с КЗЛ, вы должны быть в состоянии, по крайней мере, выяснить основную логику, используемую этими запросами. Они начинаются с имени таблицы, а затем добавляют несколько команд для фильтрации и обработки этих данных. Запрос может использовать любое количество команд, и вы можете писать более сложные запросы по мере ознакомления с различными доступными командами КЗЛ.

Смотрите Начало [с журналом запросов в Azure Monitor](get-started-queries.md) для учебника по запросам журнала, который вводит язык и общие функции, .<br>


## <a name="what-is-log-analytics"></a>Что такое Log Analytics?
Log Analytics является основным инструментом на портале Azure для записи журналов и интерактивного анализа их результатов. Даже если запрос журнала используется где-либо еще в Azure Monitor, обычно вы сначала пишете и тестируете запрос с помощью Log Analytics.

Вы можете начать журнал Analytics из нескольких мест на портале Azure. Область данных, доступных для log Analytics, определяется тем, как вы их начинаете. Подробнее о [своп-запросе](scope.md) можно узнать.

- Выберите **журналы** из меню **Azure Monitor** или меню **рабочих областей анализа журналов.**
- Выберите **аналитику** на странице **Обзор** приложения Application Insights.
- Выберите **журналы** из меню ресурса Azure.

![Log Analytics](media/log-query-overview/log-analytics.png)

Смотрите [начало с журналом Analytics в Azure Monitor](get-started-portal.md) для руководства по поиску журнала Analytics, который представляет некоторые из его функций.

## <a name="where-else-are-log-queries-used"></a>Где еще используются запросы журналов?
Помимо интерактивной работы с запросами журналов и их результатами в журнале Analytics, области в Azure Monitor, где вы будете использовать запросы, включают в себя следующие:

- **Правила генерации оповещений.** [Правила генерации оповещений](../platform/alerts-overview.md) заранее выявляют проблемы с данными в рабочей области.  Каждое правило генерации оповещений основано на поиске по журналам, который автоматически выполняется через определенные интервалы.  Результаты проверяются, чтобы определить, следует ли создавать оповещение.
- **Информационные панели.** Результаты любого запроса можно закрепить на [панели мониторинга Azure](../learn/tutorial-logs-dashboards.md), что даст вам возможность визуализировать данные журналов и метрик вместе и при необходимости использовать совместно с другими пользователями Azure.
- **Представления.**  Вы можете создавать визуализации данных, которые добавлены на панели мониторинга пользователя, с помощью [конструктора представлений](../platform/view-designer.md).  Запросы к журналам предоставляют данные, используемые [плитками](../platform/view-designer-tiles.md) и [элементами визуализации](../platform/view-designer-parts.md) в каждом просмотре.  
- **Экспорт.**  Когда вы экспортируете данные из Azure Monitor в Excel или [Power BI](../platform/powerbi.md), вы создаете запрос по журналам для определения экспортируемых данных.
- **Powershell.** Можно запустить скрипт PowerShell из командной строки или в runbook Azure Automation, который использует [Get-AzOperationalInsightsSearchResults](/powershell/module/az.operationalinsights/get-azoperationalinsightssearchresult) для получения данных журнала из Azure Monitor.  Для этого командлета требуется запрос, чтобы определить извлекаемые данные.
- **API журналов Azure Monitor.**  [API журналов Azure Monitor](https://dev.loganalytics.io) позволяет любому клиенту REST API извлекать данные журнала из рабочей области.  Запрос API включает запрос, который выполняется в Azure Monitor, чтобы определить извлекаемые данные.


## <a name="next-steps"></a>Дальнейшие действия
- Пройдите [курс по использованию аналитики журналов на портале Azure.](get-started-portal.md)
- Прогулка через [учебник по написанию запросов](get-started-queries.md).
