---
title: Структура журналов Azure Monitor | Документация Майкрософт
description: Чтобы получить данные журнала из Azure Monitor, требуется запрос по журналам.  В этой статье описывается использование новых запросов по журналам в Azure Monitor и приведены основные сведения, которые необходимо знать перед их созданием.
ms.subservice: logs
ms.topic: conceptual
author: bwren
ms.author: bwren
ms.date: 05/09/2020
ms.openlocfilehash: 58724656dd407f09687b57d0ab034f3a1f808b76
ms.sourcegitcommit: a8ee9717531050115916dfe427f84bd531a92341
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/12/2020
ms.locfileid: "83196288"
---
# <a name="structure-of-azure-monitor-logs"></a>Структура журналов Azure Monitor
Возможность быстрого получения ценных сведений о данных с помощью [запроса журнала](log-query-overview.md) — это мощная функция Azure Monitor. Для создания эффективных и полезных запросов следует понимать некоторые основные понятия, например, где находятся нужные данные и как они структурированы. В этой статье приводятся основные понятия, которые необходимо приступить к работе.

## <a name="overview"></a>Обзор
Данные в журналах Azure Monitor хранятся в Log Analytics рабочей области или в приложении Application Insights. Они работают на платформе [Azure обозреватель данных](/azure/data-explorer/) что означает использование мощного механизма обработки данных и языка запросов.

> [!IMPORTANT]
> Если вы используете [ресурс Application Insights на основе рабочей области](../app/create-workspace-resource.md), данные телеметрии хранятся в log Analytics рабочей области со всеми остальными данными журнала. Таблицы были переименованы и переструктурированы, но имеют те же сведения, что и таблицы в приложении Application Insights.

Данные в рабочих областях и приложениях организованы в таблицы, каждый из которых хранит различные виды данных и имеет собственный уникальный набор свойств. Большинство [источников данных](../platform/data-sources.md) будут записывать данные в собственные таблицы в log Analytics рабочей области, тогда как Application Insights будет записывать данные в предопределенный набор таблиц в Application Insights приложении. Запросы журналов очень гибкие, позволяя легко объединять данные из нескольких таблиц и даже использовать перекрестный запрос для объединения данных из таблиц в нескольких рабочих областях или для написания запросов, объединяющих данные рабочей области и приложения.

На следующем рисунке показаны примеры источников данных, которые записываются в различные таблицы, используемые в примерах запросов.

![Таблицы](media/logs-structure/queries-tables.png)

## <a name="log-analytics-workspace"></a>Рабочая область Log Analytics
Все данные, собираемые журналами Azure Monitor, за исключением Application Insights, хранятся в [log Analytics рабочей области](../platform/manage-access.md). В зависимости от конкретных требований можно создать одну или несколько рабочих областей. [Источники данных](../platform/data-sources.md) , такие как журналы действий и журналы ресурсов из ресурсов Azure, агенты на виртуальных машинах и данные из решений мониторинга, будут записывать данные в одну или несколько рабочих областей, настраиваемых в процессе адаптации. Другие службы, такие как [Центр безопасности Azure](/azure/security-center/) и метка [Azure](/azure/sentinel/) , также используют рабочую область log Analytics для хранения своих данных, чтобы их можно было проанализировать с помощью запросов журналов, а также данных мониторинга из других источников.

Различные типы данных хранятся в разных таблицах в рабочей области, а каждая таблица имеет уникальный набор свойств. Стандартный набор таблиц добавляется в рабочую область при ее создании, а новые таблицы добавляются для различных источников данных, решений и служб по мере их адаптации. Можно также создавать пользовательские таблицы с помощью [API сборщика данных](../platform/data-collector-api.md).

Таблицы в рабочей области и их схеме можно просмотреть на вкладке **схема** в log Analytics рабочей области.

![Схема рабочей области](media/scope/workspace-schema.png)

Используйте следующий запрос, чтобы вывести список таблиц в рабочей области и количество записей, собранных в каждый предыдущий день. 

```Kusto
union withsource = table * 
| where TimeGenerated > ago(1d)
| summarize count() by table
| sort by table asc
```
Дополнительные сведения о создаваемых таблицах см. в документации по каждому источнику данных. Примеры включают статьи для [источников данных агентов](../platform/agent-data-sources.md), [журналов ресурсов](../platform/diagnostic-logs-schema.md)и [решений для мониторинга](../insights/solutions-inventory.md).

### <a name="workspace-permissions"></a>Разрешения рабочей области
Сведения о стратегии управления доступом и рекомендации по обеспечению доступа к данным в рабочей области см. в разделе [Разработка развертывания Azure Monitor журналов](../platform/design-logs-deployment.md) . Помимо предоставления доступа к рабочей области, можно ограничить доступ к отдельным таблицам с помощью RBAC на [уровне таблицы](../platform/manage-access.md#table-level-rbac).

## <a name="application-insights-application"></a>Приложение Application Insights

> [!IMPORTANT]
> Если вы используете Application Insights телеметрии [ресурсов на основе рабочей области](../app/create-workspace-resource.md) , она хранится в log Analytics рабочей области со всеми остальными данными журнала. Таблицы были переименованы и переструктурированы, но имеют те же сведения, что и таблицы в классическом Application Insights ресурсе.

При создании приложения в Application Insights соответствующее приложение автоматически создается в журналах Azure Monitor. Для получения данных конфигурация не требуется, и приложение будет автоматически записывать данные мониторинга, такие как Просмотры страниц, запросы и исключения.

В отличие от Log Analytics рабочей области, Application Insights приложение имеет фиксированный набор таблиц. Другие источники данных нельзя настроить для записи в приложение, поэтому дополнительные таблицы создаваться не могут. 

| Таблица | Описание | 
|:---|:---|
| availabilityResults | Сводные данные из тестов доступности. |
| бровсертимингс      | Данные о производительности клиента, например время, затраченное на обработку входящих данных. |
| customEvents        | Пользовательские события, созданные приложением. |
| customMetrics       | Пользовательские метрики, созданные приложением. |
| зависимости        | Вызовы из приложения в другие компоненты (включая внешние компоненты), записанные через TrackDependency (), например вызовы REST API, базы данных или файловой системы. |
| исключения          | Исключения, вызываемые средой выполнения приложения, захватывают исключения как на стороне сервера, так и на стороне клиента (браузеров).|
| pageViews           | Данные о каждом представлении веб-сайта с информацией браузера. |
| performanceCounters | Измерения производительности от ресурсов вычислений, поддерживающих приложение, например счетчики производительности Windows. |
| requests            | Запросы, полученные приложением. Например, отдельная запись запроса записывается в журнал для каждого HTTP-запроса, получаемого веб – приложением.  |
| traces              | Подробные журналы (трассировки), выдаваемые с помощью платформ кода приложения и ведения журналов, записанных с помощью TrackTrace (). |

Схему для каждой таблицы можно просмотреть на вкладке **схема** в log Analytics для приложения.

![Схема приложения](media/scope/application-schema.png)

## <a name="standard-properties"></a>Стандартные свойства
Хотя каждая таблица в журналах Azure Monitor имеет собственную схему, существуют стандартные свойства, совместно используемые всеми таблицами. Подробные сведения о каждом из них см. [в разделе Стандартные свойства в журналах Azure Monitor](../platform/log-standard-properties.md) .

| Рабочая область Log Analytics | Приложение Application Insights | Описание |
|:---|:---|:---|
| TimeGenerated | TIMESTAMP  | Дата и время создания записи. |
| Type          | itemType   | Имя таблицы, из которой была получена запись. |
| _ResourceId   |            | Уникальный идентификатор ресурса, с которым связана запись. |
| _IsBillable   |            | Указывает, оплачивается ли прием данных. |
| _BilledSize   |            | Указывает размер данных в байтах, за которые будет взиматься плата. |

## <a name="next-steps"></a>Дальнейшие действия
- Сведения об использовании [log Analytics для создания и изменения поисков по журналам](../log-query/portals.md).
- Изучите [руководство по написанию запросов](../log-query/get-started-queries.md) на новом языке.