---
title: Наблюдение за доступностью и скоростью реагирования веб-сайта | Документация Майкрософт
description: Настройка веб-тестов в Application Insights. Получение оповещений, когда веб-сайт становится недоступным или медленно реагирует на запросы.
services: application-insights
author: mrbullwinkle
manager: carmonm
ms.assetid: 46dc13b4-eb2e-4142-a21c-94a156f760ee
ms.service: application-insights
ms.workload: tbd
ms.tgt_pltfrm: ibiza
ms.topic: conceptual
ms.date: 06/19/2019
ms.reviewer: sdash
ms.author: mbullwin
ms.openlocfilehash: abe55007aa8a8719d6b6f1659e00a089a2e28771
ms.sourcegitcommit: 82efacfaffbb051ab6dc73d9fe78c74f96f549c2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/20/2019
ms.locfileid: "67303731"
---
# <a name="monitor-the-availability-of-any-website"></a>Наблюдение за доступностью веб-сайта

После развертывания на web/веб-сайт приложения, можно настроить повторяющиеся тесты для наблюдения за доступностью и скоростью реагирования. [Azure Application Insights](../../azure-monitor/app/app-insights-overview.md) отправляет веб-запросы через одинаковые промежутки времени из разных точек по всему миру. Он может выдать Если приложение не отвечает, или если она отвечает слишком медленно.

Вы можете настроить тесты доступности для любой конечной точки HTTP или HTTPS, доступной из Интернета. Не нужно вносить изменения на веб-сайт, который вы тестируете. На самом деле она даже не должен быть сайт, которыми вы владеете. Можно проверить доступность REST API, который зависит от вашей службы.

### <a name="types-of-availability-tests"></a>Типы тестов доступности:

Существует три вида тестов доступности:

* [Тест проверки связи с URL-адресом](#create-a-url-ping-test)– простой тест, который вы можете создать на портале Azure.
* [Многошаговый веб-тест](availability-multistep.md): Запись последовательности веб-запросов, которые можно воспроизводить только для тестирования более сложных сценариев. Многошаговые веб-тесты создаются в Visual Studio Enterprise и переданный на портал для выполнения.
* [Тесты доступности дорожки](https://docs.microsoft.com/dotnet/api/microsoft.applicationinsights.telemetryclient.trackavailability?view=azure-dotnet): `TrackAvailability()` Метод может использоваться для создания собственных тестов доступности.

**Можно создать до 100 тестов доступности каждого ресурса Application Insights.**

## <a name="create-an-application-insights-resource"></a>Создание ресурса Application Insights

Чтобы создать тест доступности, сначала необходимо создать ресурс Application Insights. Если вы уже создали ресурс, перейдите к следующему разделу, чтобы [Создание теста проверки связи с URL-адрес](#create-a-url-ping-test).

На портале Azure выберите **создать ресурс** > **средств разработчика** > **Application Insights** и [Создание Ресурс Application Insights](create-new-resource.md).

## <a name="create-a-url-ping-test"></a>Создание теста проверки связи с URL-адресом

Имя «URL-адрес проверки связи» — это немного неверно. Следует уточнить, этот тест не делает любое использование протокола ICMP (протокола ICMP) для проверки доступности веб сайта. Вместо этого в нем более широкие возможности запроса HTTP для проверки конечной точки, отвечает. Он также измеряет производительность, связанные с ответом и добавляет возможность задавать критерии пользовательских успеха, в сочетании с более сложные функции, как анализ зависимые запросы и поддержка повторных попыток.

Чтобы создать первый запрос на доступность, откройте область доступности и выберите **Создание теста**.

![Укажите хотя бы URL-адрес своего веб-сайта](./media/monitor-web-app-availability/availability-create-test-001.png)

### <a name="create-a-test"></a>Создание теста

|Параметр| Объяснение
|----|----|----|
|**URL-адрес** |  URL-адрес может быть любой веб-страницы, которую вы хотите протестировать, но он должен быть видимым из общедоступного Интернета. URL-адрес может содержать строку запроса, поэтому вы, например, сможете немного поупражняться в работе с базой данных. Если URL-адрес указывает на перенаправление, мы будем переходить по нему до 10 раз.|
|**Анализировать зависимые запросы**| Тестирование запросов образы, сценарии, файлы стилей и другие файлы, которые являются частью тестируемого веб-страницы. Записанное время ответа включает время, затраченное на получение этих файлов. Тест завершается неудачей, если любой из этих ресурсов не удается загрузить успешно до истечения времени ожидания для всего теста. Если этот флажок не установлен, то тест запросит только файл по указанному URL-адресу. Включение этого параметра приводит в более строгую проверку. Тест может завершиться ошибкой для случаев, которые могут быть заметной, когда вручную поиск по сайту.
|**Разрешить повторные попытки**|Когда тест не пройден, он будет повторяться через короткие интервалы. Сообщение об ошибке отобразится только после трех неудачных попыток подряд. Последующие тесты будут выполняться с обычной частотой. Повторные попытки будут временно приостановлены до следующей успешной попытки. Это правило действует в любом расположении тестирования. **Этот вариант рекомендуется**. В среднем около 80 % неудачных попыток решаются при повторной попытке.|
|**Частота проверки**| Задает частоту выполнения теста для всех тестовых расположений. При стандартной частоте в пять минут и с пятью тестовыми расположениями ваш сайт будет проверяться в среднем каждую минуту.|
|**Расположения тестирования**| Это окна, из которых наши серверы отправляют веб-запросов в URL-адрес. **Наши минимальное количество рекомендуемых тестовыми расположениями равно пяти** чтобы убедиться, что вы можно было различать проблемы веб-сайта сетевые проблемы. Вы можете выбрать до 16 таких расположений.

**Если URL-адрес не является видимым из общедоступного Интернета, вы можете выборочно открывать брандмауэр для разрешения только тест транзакций через**. Дополнительные сведения об исключениях брандмауэра для агентов тестирования нашей доступности, обратитесь к [IP адрес руководство](https://docs.microsoft.com/azure/azure-monitor/app/ip-addresses#availability-tests).

> [!NOTE]
> Мы настоятельно рекомендуем протестировать из нескольких расположений с **как минимум пять местоположений**. Это позволяет предотвратить ложные предупреждения, которые могут возникнуть в результате временных проблем с определенным местоположением. Помимо этого мы пришли к выводу оптимальную конфигурацию желательно использовать **число тестовых местоположений равняться пороговое значение расположения оповещения + 2**.

### <a name="success-criteria"></a>Критерии успеха

|Параметр| Объяснение
|----|----|----|
| **Время ожидания тестов** |Уменьшите значение этого параметра, чтобы получать оповещения о медленных откликах. Тест считается неудачной попыткой, если ответы от сайта не были получены в течение заданного периода. Если выбрать параметр **Анализировать зависимые запросы**, все изображения, файлы стилей, скрипты и другие зависимые ресурсы будут получены в течение этого периода.|
| **HTTP-ответа** | Возвращаемый код состояния, который считается успешным результатом. Код 200 указывает на возврат нормальной веб-страницы.|
| **Совпадения содержимого** | Строка, например «Добро пожаловать!» Проверим наличие точного совпадения (с учетом регистра) в каждом ответе. Это должна быть строка обычного текста без подстановочных знаков. Не забывайте, что если контент страницы изменяется, необходимо обновить эту строку. **Поддерживаются только символы латинского алфавита совпадения содержимого** |

### <a name="alerts"></a>Оповещения

|Параметр| Объяснение
|----|----|----|
|**Почти в реальном времени (Предварительная версия)** | Мы рекомендуем использовать оповещения почти в реальном времени. Настройка оповещений этого типа выполняется после создания теста доступности.  |
|**Классический** | Не рекомендуется использовать с помощью классических оповещений для новые тесты доступности.|
|**Пороговое значение для расположения оповещения**|Мы рекомендуем как минимум 3 из 5 расположений. Оптимальной отношения между пороговым значением предупреждения расположение и число тестовых местоположений **пороговое значение для предупреждения расположения** = **число тестовых местоположений - 2, с минимальным объемом пятью тестовыми расположениями.**|

## <a name="see-your-availability-test-results"></a>Просмотр результатов теста доступности

Результаты теста доступности можно визуализировать с помощью строки и точечных представлений построения.

Через несколько минут, щелкните **обновить** для просмотра результатов теста.

![Представление "строки"](./media/monitor-web-app-availability/availability-refresh-002.png)

Представление точечной диаграмме показаны примеры результатов, которые в них иметь сведений диагностики шаг теста. Обработчик тестов хранит сведения о диагностике тестов, которые завершились сбоем. Диагностические сведения об успешно выполненных тестах хранятся для подмножества выполнений. Наведите указатель на любой из красные или зеленые точки, см. в разделе теста, тестировать, имя и расположение.

![Представление "строки"](./media/monitor-web-app-availability/availability-scatter-plot-003.png)

Выберите конкретный тест, расположение или сократите период времени, чтобы просмотреть дополнительные результаты для нужного периода времени. Используйте обозреватель поиска, чтобы просмотреть результаты всех тестов или воспользуйтесь запросами аналитики, чтобы запустить пользовательские отчеты для этих данных.

## <a name="inspect-and-edit-tests"></a>Изменение и проверка тестов

Чтобы изменить, временно отключить или удалить тест щелкните многоточие рядом с именем теста. Может занять до 20 минут для изменения конфигурации для распространения всех агентов тестирования после изменения.

![Просмотр сведений о тесте. Редактирование и отключение веб-теста](./media/monitor-web-app-availability/edit.png)

При обслуживании службы может потребоваться отключить тесты доступности или правила оповещения, связанные с ними.

## <a name="if-you-see-failures"></a>При возникновении сбоев

Щелкните красную точку.

![Щелкните красную точку.](./media/monitor-web-app-availability/open-instance-3.png)

С помощью результатов тестов доступности вы увидите сведения о транзакциях для всех компонентов. Здесь можно:

* изучить ответ, полученный от сервера;
* диагностировать сбой на основе коррелированной телеметрии на стороне сервера, собранной во время обработки теста доступности, завершившегося сбоем;
* добавить в журнал проблему или рабочий элемент в Git или Azure Boards для отслеживания проблемы; ошибка будет содержать ссылку на это событие;
* открыть результат веб-теста в Visual Studio.

См. дополнительные сведения об [интерфейсе сквозной диагностики транзакций](../../azure-monitor/app/transaction-diagnostics.md).

Щелкните строку исключения, чтобы просмотреть подробности исключения на стороне сервера, вызвавшего сбой искусственного теста доступности. Можно также получить [отладочный моментальный снимок](../../azure-monitor/app/snapshot-debugger.md) для более широкой диагностики на уровне кода.

![Диагностика на стороне сервера](./media/monitor-web-app-availability/open-instance-4.png)

Помимо необработанных результатов можно также просмотреть две ключевые метрики доступности в [обозревателя метрик](https://docs.microsoft.com/azure/azure-monitor/platform/metrics-getting-started):

1. "Доступность": количество успешно выполненных тестов (в процентах).
2. "Продолжительность теста": средняя длительность выполнения тестов.

## <a name="automation"></a>Служба автоматизации

* [Используйте сценарии PowerShell, чтобы настройка теста доступности](../../azure-monitor/app/powershell.md#add-an-availability-test) выполнялась автоматически.
* Настройте вызов [webhook](../../azure-monitor/platform/alerts-webhooks.md), активируемый оповещением.

## <a name="troubleshooting"></a>Устранение неполадок

Выделенные [статьи об устранении неполадок](troubleshoot-availability.md).

## <a name="next-steps"></a>Дальнейшие действия

* [Оповещения доступности](availability-alerts.md)
* [Многошаговые веб-тесты](availability-multistep.md)


