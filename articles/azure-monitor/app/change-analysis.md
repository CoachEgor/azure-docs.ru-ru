---
title: Использование анализа изменение приложения в Azure Monitor для поиска проблем в веб приложение | Документация Майкрософт
description: Анализ изменений приложения в Azure Monitor можно используйте для устранения проблем приложений на действующих сайтах в службе приложений Azure.
services: application-insights
author: cawams
manager: carmonm
ms.assetid: ea2a28ed-4cd9-4006-bd5a-d4c76f4ec20b
ms.service: application-insights
ms.tgt_pltfrm: ibiza
ms.topic: conceptual
ms.date: 05/07/2019
ms.author: cawa
ms.openlocfilehash: 45df8f9e57223ea60a11c6af2187d362184cae2b
ms.sourcegitcommit: f56b267b11f23ac8f6284bb662b38c7a8336e99b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/28/2019
ms.locfileid: "67443347"
---
# <a name="use-application-change-analysis-preview-in-azure-monitor"></a>Использование анализа изменений приложения (Предварительная версия) в Azure Monitor

При возникновении проблемы активного сайта либо сбой, важно быстро определить основную причину. Стандартный решений для мониторинга может предупреждать вас проблемы. Они могут даже означает сбой какой компонент. Однако это предупреждение не всегда следуют сразу объясняются причины сбоя. Вы знаете, что сайт работает пяти минут назад, и теперь оно нарушило. Что изменилось за последние пять минут? Это вопрос, анализ изменений приложения предназначен отвечать в Azure Monitor.

Основываясь на мощь [график ресурсов Azure](https://docs.microsoft.com/azure/governance/resource-graph/overview), анализ изменений предоставляет подробные сведения изменения приложения Azure для повышения наблюдаемость и снижения MTTR (среднее время восстановления).

> [!IMPORTANT]
> Анализ изменений в настоящее время доступна Предварительная версия. Эта предварительная версия предоставляется без соглашения об уровне обслуживания. Эта версия не рекомендуется для производственных рабочих нагрузок. Некоторые функции могут не поддерживаться или могут иметь ограниченные возможности. Дополнительные сведения см. в разделе [дополнительные условия использования предварительных версий Microsoft Azure](https://azure.microsoft.com/support/legal/preview-supplemental-terms/).

## <a name="overview"></a>Обзор

Анализ изменений определяет различные типы изменений, на уровне инфраструктуры, вплоть до развертывания приложения. Он является поставщиком ресурсов Azure на уровне подписки, который проверяет изменения ресурсов в подписке. Анализ изменений предоставляет данные для различных средств диагностики, чтобы помочь пользователям понять, какие изменения, возможно, причиной проблемы.

Следующей схеме показана архитектура анализ изменений:

![Схема архитектуры, как изменить анализа получает измененные данные, и предоставляет его клиентских средств](./media/change-analysis/overview.png)

В настоящее время изменение анализа интегрирована в **Диагностика и решение проблем** опытом в веб-приложения службы приложений. Чтобы включить обнаружение изменений и просмотр изменений в веб-приложение, см. в разделе *изменить анализ для веб-приложений* разделе этой статьи.

### <a name="azure-resource-manager-deployment-changes"></a>Изменения в развертывании Azure Resource Manager

С помощью [график ресурсов Azure](https://docs.microsoft.com/azure/governance/resource-graph/overview), анализ изменений предоставляет исторические данные как ресурсы Azure, на которых размещены приложения изменились со временем. Например, анализ изменений позволяет выявлять, изменения в правила конфигурации IP-адресов, управляемых удостоверений и параметры SSL. Поэтому если тег добавляется в веб-приложении, изменить Analysis отражается изменение. Эта информация доступна, пока `Microsoft.ChangeAnalysis` включен поставщик ресурсов в подписке Azure.

### <a name="changes-in-web-app-deployment-and-configuration"></a>Изменения в развертывание веб-приложений и конфигурации

Анализ изменений фиксирует состояние развертывания и настройки приложения каждые 4 часа. Он может определить, например, изменения в переменных среды приложения. Это средство вычисляет различия и представляется, что изменилось. В отличие от изменений, Resource Manager сведения об изменениях кода развертывания могут оказаться недоступными непосредственно в средстве. Чтобы просмотреть последние изменения в анализе изменений, выберите **проверки изменений теперь**.

![Снимок экрана: кнопка «Проверка изменения»](./media/change-analysis/scan-changes.png)

### <a name="dependency-changes"></a>Изменения зависимостей

Изменения зависимости ресурсов также могут вызвать проблемы в веб-приложения. Например если веб-приложение вызывает кэша Redis, кэш Redis SKU может повлиять на производительность веб-приложения. Чтобы обнаружить изменения в зависимостях, анализа изменений проверяет запись DNS для веб приложения. Таким образом он определяет изменения во всех компонентах приложения, которые могут вызвать проблемы.

## <a name="change-analysis-for-the-web-apps-feature"></a>Анализ изменений для веб-приложений

В Azure Monitor, анализ изменений в настоящее время встроена в самостоятельная **Диагностика и решение проблем** столкнуться. Доступ к этой возможности **Обзор** страницы приложения службы приложений.

![Снимок экрана: Кнопка «Обзор» и «диагностика и решение проблем» кнопки](./media/change-analysis/change-analysis.png)

### <a name="enable-change-analysis-in-the-diagnose-and-solve-problems-tool"></a>Включить анализ изменений в Диагностика и решение проблем средство

1. Выберите **доступности и производительности**.

    ![Снимок экрана «Доступность и производительность» способы устранения неполадок](./media/change-analysis/availability-and-performance.png)

1. Выберите **изменения приложения**. Не то, что эта функция также доступна в **сбой приложения происходит**.

   ![Снимок экрана: кнопка «Сбои приложения»](./media/change-analysis/application-changes.png)

1. Чтобы включить анализ изменений, выберите **включить сейчас**.

   ![Снимок экрана параметров «Сбои приложения»](./media/change-analysis/enable-changeanalysis.png)

1. Включите **анализа изменений** и выберите **Сохранить**.

    ![Снимок экрана пользовательского интерфейса «Включить анализ изменений»](./media/change-analysis/change-analysis-on.png)


1. Чтобы получить доступ к анализа изменений, выберите **Диагностика и решение проблем** > **доступности и производительности** > **сбой приложения происходит**. Вы увидите граф, описывающий тип изменений, со временем, а также сведения об этих изменениях:

     ![Снимок экрана: представление различий для изменений](./media/change-analysis/change-view.png)


### <a name="enable-change-analysis-at-scale"></a>Включить анализ изменений в нужном масштабе

Если ваша подписка включает множество веб-приложений, включение службы на уровне веб-приложения будет неэффективно. В этом случае выполните эти альтернативные инструкции.

### <a name="register-the-change-analysis-resource-provider-for-your-subscription"></a>Зарегистрировать поставщик ресурсов Analysis изменений для вашей подписки

1. Зарегистрируйте флаг компонента анализа изменений (Предварительная версия). Поскольку флаг компонента находится в предварительной версии, необходимо зарегистрировать его, чтобы сделать его видимым для вашей подписки:

   1. Откройте [Azure Cloud Shell](https://azure.microsoft.com/features/cloud-shell/).

      ![Снимок экрана: изменение Cloud Shell](./media/change-analysis/cloud-shell.png)

   1. Измените тип оболочки на **PowerShell**.

      ![Снимок экрана: изменение Cloud Shell](./media/change-analysis/choose-powershell.png)

   1. Выполните следующую команду PowerShell:

        ``` PowerShell
        Set-AzContext -Subscription <your_subscription_id> #set script execution context to the subscription you are trying to enable
        Get-AzureRmProviderFeature -ProviderNamespace "Microsoft.ChangeAnalysis" -ListAvailable #Check for feature flag availability
        Register-AzureRmProviderFeature -FeatureName PreviewAccess -ProviderNamespace Microsoft.ChangeAnalysis #Register feature flag
        ```

1. Зарегистрируйте поставщик ресурсов Analysis изменений для подписки.

   - Перейдите к **подписок**и выберите подписку, которую нужно включить в службе изменений. Выберите поставщиков ресурсов:

        ![Снимок экрана, показывающий, как зарегистрировать поставщик ресурсов Analysis изменений](./media/change-analysis/register-rp.png)

       - Выберите **Microsoft.ChangeAnalysis**. Затем в верхней части страницы, выберите **зарегистрировать**.

       - После включения поставщика ресурсов веб-приложения для обнаружения изменений на уровне развертывания можно задать скрытый тег. Чтобы задать скрытый тег, выполните инструкции из раздела **не удалось получить сведения об анализе изменение**.

   - Кроме того можно использовать сценарий PowerShell для регистрации поставщика ресурсов:

        ```PowerShell
        Get-AzureRmResourceProvider -ListAvailable | Select-Object ProviderNamespace, RegistrationState #Check if RP is ready for registration

        Register-AzureRmResourceProvider -ProviderNamespace "Microsoft.ChangeAnalysis" #Register the Change Analysis RP
        ```

        Чтобы задать скрытый тег на веб-приложения с помощью PowerShell, выполните следующую команду:

        ```powershell
        $webapp=Get-AzWebApp -Name <name_of_your_webapp>
        $tags = $webapp.Tags
        $tags[“hidden-related:diagnostics/changeAnalysisScanEnabled”]=$true
        Set-AzResource -ResourceId <your_webapp_resourceid> -Tag $tag
        ```

     > [!NOTE]
     > После добавления скрытый тег, по-прежнему может потребоваться подождать до 4 часов, прежде чем начать просмотр изменений, внесенных. Результаты являются отложена из-за изменения анализа просматривает веб-приложения только каждые 4 часа. 4-часового расписания ограничивает влияние на производительность сканирования.

## <a name="next-steps"></a>Дальнейшие действия

- Мониторинг службы приложений более эффективно по [Включение функций Application Insights](azure-web-apps.md) в Azure Monitor.
- Дополнительные сведения о [график ресурсов Azure](https://docs.microsoft.com/azure/governance/resource-graph/overview), который помогает power анализа изменений.
