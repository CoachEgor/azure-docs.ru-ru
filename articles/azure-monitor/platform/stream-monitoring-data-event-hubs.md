---
title: Потоковая передача данных мониторинга Azure в концентратор событий
description: Узнайте, как передавать данные мониторинга Azure в концентратор событий, чтобы получить данные в партнерскую sieM или аналитический инструмент.
author: bwren
services: azure-monitor
ms.topic: conceptual
ms.date: 11/15/2019
ms.author: bwren
ms.subservice: ''
ms.openlocfilehash: 32bc90cc069ac82641c3aa7692c900c60db7ba87
ms.sourcegitcommit: ffc6e4f37233a82fcb14deca0c47f67a7d79ce5c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/21/2020
ms.locfileid: "81733103"
---
# <a name="stream-azure-monitoring-data-to-an-event-hub"></a>Потоковая передача данных мониторинга Azure в концентратор событий
Azure Monitor предоставляет полное решение для мониторинга стеков для приложений и служб в Azure, в других облаках и на территории. Помимо использования Azure Monitor для анализа этих данных и использования их для различных сценариев мониторинга, возможно, потребуется отправить их другим инструментам мониторинга в вашей среде. Наиболее эффективным методом потоковой передачи данных мониторинга на внешние инструменты в большинстве случаев является использование [концентраторов Azure Event.](/azure/event-hubs/) В этой статье приводится краткое описание того, как можно передавать данные мониторинга из разных источников в концентратор событий, а также ссылки на подробные рекомендации.


## <a name="create-an-event-hubs-namespace"></a>Создание пространства имен в Центрах событий

Прежде чем настроить потоковую передачу для любого источника данных, необходимо [создать пространство имен событий концентратор и концентратор событий.](../../event-hubs/event-hubs-create.md) Они являются местом назначения всех ваших данных мониторинга. Пространство имен Центров событий — это логическое объединение концентраторов событий, которые совместно используют одну политику доступа. Применяется тот же принцип, что и для отдельных больших двоичных объектов в рамках одной учетной записи хранения. Рассмотрим следующие сведения о пространстве имен ных местах событий и концентратах событий, которые используются для данных потокового мониторинга:

* Добавив единицы пропускной способности, можно увеличить ее масштаб для концентраторов событий. Как правило, требуется только одна пропускная единица. Если вам нужно масштабировать по мере увеличения использования журнала, можно вручную увеличить количество блоки пропускной платы для пространства имен или включить автоинфляцию.
* Добавив разделы, вы можете распараллелить потребление по нескольким клиентам. Один раздел может поддерживать до 20 Мбит/с или приблизительно 20 000 сообщений в секунду. Средство, использующее данные, может поддерживать или не поддерживать потребление из нескольких разделов. Четыре раздела разумно начать, если вы не уверены, если вы не уверены в количестве разделов для установки.
* Удержание сообщений в концентраторе событий составляет не менее 7 дней. Если ваш потребляющий инструмент выходит из-под захода на второй день, это гарантирует, что инструмент может забрать, где он остановился для событий до 7 дней.
* Для концентратора событий следует использовать группу потребителей по умолчанию. Не нужно создавать другие группы объектов-получателей или использовать отдельную группу объектов-получателей, если вы не планируете задействовать два разных средства, которые будут использовать одни и те же данные в одном концентраторе событий.
* Для журнала Azure Activity вы выбираете пространство имен концентров событий, а Azure Monitor создает концентратор событий в этом пространстве имен, называемый _insights-logs-operational-logs._ Для других типов журналов можно выбрать существующий концентратор событий или создать Azure Monitor концентратор событий для журнала.
* Исходящие порты 5671 и 5672, как правило, должны быть открыты на компьютере или VNET, потребляющих данные из концентратора событий.

## <a name="monitoring-data-available"></a>Доступные данные мониторинга
[Источники данных мониторинга для Azure Monitor](data-sources.md) описывают различные уровни данных для приложений Azure и виды данных мониторинга, доступных для каждого из них. В следующей таблице перечислены каждый из этих уровней и описание того, как эти данные могут передаваться в концентратор событий. Следуйте ссылкам, предоставленным для более подробной информации.

| Уровень | Данные | Метод |
|:---|:---|:---|
| [Клиент Azure](data-sources.md#azure-tenant) | Журналы аудита активных каталогов Azure | Настроите диагностическую настройку клиента на арендатора AAD. Для получения подробной информации [см.](../../active-directory/reports-monitoring/tutorial-azure-monitor-stream-logs-to-event-hub.md) |
| [Подписка Azure.](data-sources.md#azure-subscription) | Журнал действий Azure | Создайте профиль журнала для экспорта событий журнала активности в концентраторы событий.  Для получения подробной информации можно ознакомиться с [журналами платформы Stream Azure в концентрах событий Azure.](resource-logs-stream-event-hubs.md) |
| [Ресурсы Azure](data-sources.md#azure-resources) | Метрики платформы<br> Журналы ресурсов |Оба типа данных отправляются в концентратор событий с использованием параметра диагностики ресурсов. Для получения подробной информации можно ознакомиться с [журналами ресурсов Stream Azure в центре событий.](resource-logs-stream-event-hubs.md) |
| [Операционная система (гость)](data-sources.md#operating-system-guest) | Виртуальные машины Azure | Установите [расширение Azure Diagnostics](diagnostics-extension-overview.md) на виртуальные компьютеры Windows и Linux в Azure. Просматривайте [данные потоковой azure Diagnostics по горячим следам, используя концентраторы событий](diagnostics-extension-stream-event-hubs.md) для получения подробной информации о Windows VMs и [используйте диагностическое расширение Linux для мониторинга метрик и журналов](../../virtual-machines/extensions/diagnostics-linux.md#protected-settings) для получения подробной информации о Linux VMs. |
| [Код приложения](data-sources.md#application-code) | Application Insights | Application Insights не предоставляет прямой метод потоковой передачи данных в концентраторы событий. Можно [настроить непрерывный экспорт](../../azure-monitor/app/export-telemetry.md) данных Application Insights на учетную запись хранения, а затем использовать Logic App для отправки данных в концентратор событий, описанный в [ручной потоковой передаче с Logic App.](#manual-streaming-with-logic-app) |

## <a name="manual-streaming-with-logic-app"></a>Ручная потоковая передача с помощью logic App
Для данных, которые вы не можете напрямую передавать в концентратор событий, можно написать в хранилище Azure, а затем использовать time-triggered Logic App, которое [вытягивает данные из хранилища капли](../../connectors/connectors-create-api-azureblobstorage.md#add-action) и [толкает его в качестве сообщения в концентратор событий.](../../connectors/connectors-create-api-azure-event-hubs.md#add-action) 


## <a name="partner-tools-with-azure-monitor-integration"></a>Партнерские инструменты с интеграцией Azure Monitor

Перекачание данных мониторинга в концентратор событий с помощью Azure Monitor позволяет легко интегрироваться с внешними инструментами SIEM и мониторинга. Примеры инструментов с интеграцией Azure Monitor включают в себя следующее:

| Инструмент | Хостинг в Azure | Описание |
|:---|:---| :---|
|  IBM QRadar | нет | Модуль устройства (DSM) Microsoft Azure и протокол концентратора событий Microsoft Azure доступны для загрузки на [веб-сайте поддержки IBM](https://www.ibm.com/support). Вы можете узнать больше об интеграции с Azure в [конфигурации «Радар DSM».](https://www.ibm.com/support/knowledgecenter/SS42VS_DSM/c_dsm_guide_microsoft_azure_overview.html?cp=SS42VS_7.3.0) |
| Splunk | нет | [Надстройка Azure Monitor для Splunk](https://splunkbase.splunk.com/app/3534/) — проект с открытым исходным кодом, доступный в Splunkbase. Документация доступна на [Azure Monitor Addon For Splunk](https://github.com/Microsoft/AzureMonitorAddonForSplunk/wiki/Azure-Monitor-Addon-For-Splunk).<br><br> Если вы не можете установить надстройку в экземпляре Splunk, если, например, вы используете прокси или работаете на Splunk Cloud, вы можете направить эти события в Splunk HTTP Event Collector с помощью [функции Azure для Splunk,](https://github.com/Microsoft/AzureFunctionforSplunkVS)которая вызывается новыми сообщениями в концентраторе событий. |
| sumologic | нет | Инструкции по настройке SumoLogic для использования данных из концентратора событий доступны в [журнале Collect Logs для приложения Azure Audit App от Event Hub.](https://help.sumologic.com/Send-Data/Applications-and-Other-Data-Sources/Azure-Audit/02Collect-Logs-for-Azure-Audit-from-Event-Hub) |
| ArcSight | нет | Смарт-разъем ArcSight Event Hub доступен в рамках [коллекции интеллектуальных разъемов ArcSight.](https://community.softwaregrp.com/t5/Discussions/Announcing-General-Availability-of-ArcSight-Smart-Connectors-7/m-p/1671852) |
| Сервер системного журнала | нет | Если вы хотите передавать данные Azure Monitor непосредственно на сервер Syslog, можно использовать [решение, основанное на функции Azure.](https://github.com/miguelangelopereira/azuremonitor2syslog/)
| ЛогРитм | нет| Инструкции по настройке LogRhythm для сбора журналов из концентратора событий доступны [здесь.](https://logrhythm.com/six-tips-for-securing-your-azure-cloud-environment/) 
|Logz.io | Да | Для получения дополнительной информации см. [Начало мониторинга и регистрации с использованием Logz.io для java-приложений, работающих на Azure](https://docs.microsoft.com/azure/developer/java/fundamentals/java-get-started-with-logzio)


## <a name="next-steps"></a>Next Steps
* [Архив журнала activity в учетную запись хранилища](../../azure-monitor/platform/archive-activity-log.md)
* [Ознакомьтесь с обзором журнала деятельности Azure](../../azure-monitor/platform/platform-logs-overview.md)
* [Настройка оповещения на основе события журнала активности](../../azure-monitor/platform/alerts-log-webhook.md)


