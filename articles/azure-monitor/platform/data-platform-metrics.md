---
title: Метрики в Azure Monitor | Документация Майкрософт
description: Описание метрик в Azure Monitor, которые являются облегченными поддерживает практически сценариев в реальном времени данных мониторинга.
documentationcenter: ''
author: bwren
manager: carmonm
editor: tysonn
ms.service: azure-monitor
ms.topic: conceptual
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 03/26/2019
ms.author: bwren
ms.openlocfilehash: 684491b546a0456d936ae199cdfb93180aa05043
ms.sourcegitcommit: f10ae7078e477531af5b61a7fe64ab0e389830e8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/05/2019
ms.locfileid: "67607024"
---
# <a name="metrics-in-azure-monitor"></a>Метрики в Azure Monitor

> [!NOTE]
> Платформа Azure Monitor данных основана на два основных типа данных. Метрики и журналы. В этой статье описываются метрики. Ссылаться на [журналы в Azure Monitor](data-platform-logs.md) подробное описание журналов, позволяющая [платформы данных Azure Monitor](data-platform.md) сравнение двух.

Метрики в Azure Monitor — упрощенный и поддержку практически сценариев в реальном времени, что делает их особенно удобно для предупреждения, а также быстрое обнаружение проблем. В этой статье описывается, как структурированы метрики, что можно сделать с ними и определяет различных источников данных, которые хранят данные в метриках.

## <a name="what-are-metrics"></a>Что такое метрики
Метрики — это числовые значения, которые описывают конкретный аспект системы в определенный момент времени. Метрики собираются с регулярными интервалами и полезны для создания оповещений, так как они могут быть использованы в выборке часто и оповещение может генерироваться быстро с относительно простой логики.

## <a name="what-can-you-do-with-azure-monitor-metrics"></a>Что можно сделать с помощью метрик в Microsoft Azure?
Ниже перечислены различные способы, что можно использовать данные метрик в Azure Monitor.

|  |  |
|:---|:---|
| Анализ | Используйте [обозревателя метрик](metrics-charts.md) для анализа собранных метрик на диаграмме и сравнения метрики из различных ресурсов. |
| Визуализация | Закрепление диаграммы из обозревателя метрик для [мониторинга Azure](../learn/tutorial-app-dashboards.md).<br>Создание [книги](../app/usage-workbooks.md) для объединения с несколькими наборами данных в виде интерактивного отчета. Экспортировать результаты запроса, чтобы [Grafana](grafana-plugin.md) повысить эффективность его панелей мониторинга и объединить с другими источниками данных. |
| Предупреждение | Настройка [правила оповещения метрики](alerts-metric.md) , отправляет уведомление или принимает [автоматизированное действие](action-groups.md) когда значение метрики достигает порогового значения. |
| Автоматизация |  Используйте [автомасштабирования](autoscale-overview.md) для увеличения или уменьшения ресурсов с учетом значение метрики, пересекает пороговое значение. |
| Экспорт | [Направлять метрики в журналы](diagnostic-logs-stream-log-store.md) для анализа данных в метрики Azure Monitor вместе с данными в журналах Azure Monitor и для хранения значения метрик дольше, чем 93 дня.<br>Stream метрики для [концентратора событий](stream-monitoring-data-event-hubs.md) маршрута к внешним системам. |
| Получение | Доступ из командной строки с помощью значения метрик [командлеты PowerShell](https://docs.microsoft.com/powershell/module/az.applicationinsights)<br>Доступ к значения метрик из пользовательского приложения с помощью [REST API](rest-api-walkthrough.md).<br>Доступ к значения метрик из командной строки с помощью [CLI](/cli/azure/monitor/metrics). |
| Архив | [Архивация](..//learn/tutorial-archive-data.md) журнала производительности и работоспособности ресурса в целях соответствия требованиям, аудита или автономной отчетности. |

## <a name="how-is-data-in-azure-monitor-metrics-structured"></a>Чем служба данных в структурированной метрик в Microsoft Azure?
Данные, собранные метрики Azure Monitor хранятся в базе данных временных рядов, оптимизированная для анализа данных с меткой времени. Каждый набор значений метрик являются временными рядами со следующими свойствами:

* Время было получено значение
* Связанные с ресурсом значение
* Пространство имен, которое выступает в качестве категории для метрики
* Имя метрики
* Само значение
* Некоторые метрики могут иметь несколько измерений, как описано в разделе [многомерных метрик](#multi-dimensional-metrics). Пользовательские метрики могут иметь до 10 измерений.

## <a name="multi-dimensional-metrics"></a>Многомерные метрики
Одной из проблем, чтобы данные метрик является, что часто имеют ограниченную информацию для предоставления контекста для собранные значения. Azure Monitor решает эту проблему с помощью многомерных метрик. Измерения метрики — это пары имя-значение, которые используются для передачи дополнительных данных с описаниями значения метрики. Например, метрика _доступного пространства на диске_ может иметь измерение с названием _диска_ со значениями _C:_ , _D:_ , которые позволяли просмотра либо доступного пространства на диске для всех дисков, либо для каждого диска по отдельности.

В примере ниже показаны два набора данных для гипотетической метрики с названием _Пропускная способность сети_. В первом наборе данных нет измерений. Во втором наборе данных показаны значения с двумя измерениями, _IP-адрес_ и _Направление_:

### <a name="network-throughput"></a>Пропускная способность сети

| Timestamp     | Значение метрики |
| ------------- |:-------------|
| 8/9/2017 8:14 | 1331,8 Кбит/с |
| 8/9/2017 8:15 | 1141,4 Кбит/с |
| 8/9/2017 8:16 | 1110,2 Кбит/с |

Такая метрика без измерений поможет найти ответ только на простые вопросы, например о том, какой была пропускная способность в определенный момент времени.

### <a name="network-throughput--two-dimensions-ip-and-direction"></a>Пропускная способность сети и два измерения ("IP-адрес" и "Направление")

| Timestamp     | Измерение "IP-адрес"   | Измерение "Направление" | Значение метрики|
| ------------- |:-----------------|:------------------- |:-----------|
| 8/9/2017 8:14 | IP-адрес — 192.168.5.2 | Направление — отправка    | 646,5 Кбит/с |
| 8/9/2017 8:14 | IP-адрес — 192.168.5.2 | Направление — получение | 420,1 Кбит/с |
| 8/9/2017 8:14 | IP-адрес — 10.24.2.15  | Направление — отправка    | 150,0 Кбит/с |
| 8/9/2017 8:14 | IP-адрес — 10.24.2.15  | Направление — получение | 115,2 Кбит/с |
| 8/9/2017 8:15 | IP-адрес — 192.168.5.2 | Направление — отправка    | 515,2 Кбит/с |
| 8/9/2017 8:15 | IP-адрес — 192.168.5.2 | Направление — получение | 371,1 Кбит/с |
| 8/9/2017 8:15 | IP-адрес — 10.24.2.15  | Направление — отправка    | 155,0 Кбит/с |
| 8/9/2017 8:15 | IP-адрес — 10.24.2.15  | Направление — получение | 100,1 Кбит/с |

Эта метрика поможет найти ответ на вопросы о том, какая пропускная способность для каждого IP-адреса и сколько данных было отправлено и получено. Многомерные метрики имеют дополнительные значения аналитики и диагностики в отличие от метрик без измерений.

## <a name="interacting-with-azure-monitor-metrics"></a>Взаимодействие с метриками Azure Monitor
Используйте [обозревателя метрик](metrics-charts.md) для интерактивного анализа данных в базе данных метрики и диаграммы со временем значения нескольких метрик. Вы можете закрепить диаграммы на панели мониторинга для их просмотра с помощью других визуализаций. Кроме того, вы можете извлечь метрики с помощью [REST API мониторинга Azure](rest-api-walkthrough.md).

![Обозреватель метрик](media/data-platform/metrics-explorer.png)

## <a name="sources-of-azure-monitor-metrics"></a>Источники метрик Azure Monitor
Существует три основных источника метрик, собираемых службой Azure Monitor. Когда эти метрики собираются в базе данных метрик Azure Monitor, позволяет проверять их друг с другом независимо от их источника.

**Метрики платформы** создаются ресурсами Azure и наглядно отображают работоспособность и производительность этих ресурсов. Каждый тип ресурсов создает [отдельный набор метрик](metrics-supported.md), который не нужно настраивать. Если не указано иное, в определении метрики из ресурсов Azure в один раз в минуту сбор показателей платформы. 

**Метрики гостевой ОС** собираются из операционной системы виртуальной машины. Включить метрики гостевой ОС для виртуальных машин Windows с [расширение диагностики Windows (WAD)](../platform/diagnostics-extension-overview.md) и для виртуальных машин Linux с помощью [InfluxData Telegraf агента](https://www.influxdata.com/time-series-platform/telegraf/).

**Метрики приложений** создаются службой Application Insights для отслеживаемых приложений и помогают обнаруживать проблемы производительности и отслеживать тенденции использования приложений. Сюда входит ряд значений, в том числе значения _Время отклика сервера_ и _Исключения браузера_.

**Настраиваемые метрики** — метрики, которые определяют Помимо стандартных метрик, автоматически становятся доступными. Вы можете [определены пользовательские метрики в приложении](../app/api-custom-events-metrics.md) , осуществляет мониторинг Application Insights или создать пользовательские метрики для службы Azure с помощью [пользовательские метрики API](metrics-store-custom-rest-api.md).

## <a name="retention-of-metrics"></a>Хранения метрик
Для большинства ресурсов в Azure хранятся метрики для 93 дня. Существуют некоторые исключения:
  * **Метрики гостевой ОС для классического**. Метрики классической гостевой ОС хранятся в течение 14 дней. Для длительного хранения, мы рекомендуем использовать новые метрики гостевой ОС, собранных с [расширение диагностики Windows (WAD)](../platform/diagnostics-extension-overview.md) и для виртуальных машин Linux с помощью [InfluxData Telegraf агента](https://www.influxdata.com/time-series-platform/telegraf/).
  * **Метрики на основе журнала Application Insights**. На самом [метрик на основе журнала](../app/pre-aggregated-metrics-log-metrics.md) переводиться запросов к журналу. Срок хранения событий в журналах основной совпадает с их хранения. Для ресурсов Application Insights журналы хранятся в течение 90 дней. 

> [!NOTE]
> Вы можете [отправлять метрики платформы для ресурсов Azure Monitor в рабочую область Log Analytics](diagnostic-logs-stream-log-store.md) для построения долгосрочных тенденций.

## <a name="next-steps"></a>Следующие шаги

- Дополнительные сведения о [платформы данных Azure Monitor](data-platform.md).
- Дополнительные сведения о [записи данных в Azure Monitor](data-platform-logs.md).
- Узнайте о [доступных данных мониторинга](data-sources.md) для различных источников в Azure.
