---
title: Метрика в Azure Monitor Документы Майкрософт
description: Описывает метрики в Azure Monitor, которые представляют собой легкие данные мониторинга, способные поддерживать сценарии в режиме реального времени.
documentationcenter: ''
author: bwren
manager: carmonm
editor: tysonn
ms.topic: conceptual
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 03/26/2019
ms.author: bwren
ms.openlocfilehash: 80bbf83da17d833c4f8bb1abac9610d70e9a23cb
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "79274831"
---
# <a name="metrics-in-azure-monitor"></a>Метрики в Azure Monitor

> [!NOTE]
> Платформа данных Azure Monitor основана на двух основных типах данных: метрики и журналы. В этой статье описана метрика. Для сравнения этих двух [журналов в Azure Monitor](data-platform-logs.md) и [платформы данных Azure Monitor](data-platform.md) в Azure Monitor в Azure Monitor.

Метрики в Azure Monitor являются легкими и способны поддерживать сценарии в режиме реального времени, что делает их особенно полезными для оповещения и быстрого обнаружения проблем. В этой статье описывается, как структурированы метрики, что с ними можно сделать, и определяются различные источники данных, которые хранят данные в метриках.

## <a name="what-are-metrics"></a>Что такое метрики
Метрики — это числовые значения, которые описывают конкретный аспект системы в определенный момент времени. Метрики собираются через регулярные промежутки времени и полезны для оповещения, поскольку их можно часто отбирать, а оповещение можно быстро сделать с относительно простой логикой.

## <a name="what-can-you-do-with-azure-monitor-metrics"></a>Что можно сделать с Azure Monitor Metrics?
В следующей таблице перечислены различные способы использования метрических данных в Azure Monitor.

|  |  |
|:---|:---|
| Анализ | Используйте [исследователя метрик](metrics-charts.md) для анализа собранных метрик на диаграмме и сравнения метрик с разных ресурсов. |
| Визуализация | Прикрепите диаграмму от исследователя метрик к [панели мониторинга Azure.](../learn/tutorial-app-dashboards.md)<br>Создайте [рабочую книгу](../app/usage-workbooks.md) для объединения с несколькими наборами данных в интерактивном отчете. Экспортируйте результаты запроса [в Grafana,](grafana-plugin.md) чтобы использовать его dashboarding и объединить с другими источниками данных. |
| Предупреждение | Настройте [правило предупреждения метрики,](alerts-metric.md) которое отправляет уведомление или принимает [автоматические действия,](action-groups.md) когда значение метрики пересекает порог. |
| Автоматизация |  Используйте [Autoscale](autoscale-overview.md) для увеличения или уменьшения ресурсов на основе метрического значения, пересекающих порог. |
| Экспорт | [Маршрутные метрики для журналов](resource-logs-collect-storage.md) для анализа данных в Azure Monitor Metrics вместе с данными в журналах Azure Monitor и для хранения метрик более 93 дней.<br>Stream Metrics в [концентратор событий,](stream-monitoring-data-event-hubs.md) чтобы направить их к внешним системам. |
| Получение | Значения метрик доступа из командной строки с помощью [смдлетов PowerShell](https://docs.microsoft.com/powershell/module/az.applicationinsights)<br>Доступ к метрическим значениям из пользовательского приложения с помощью [REST API.](rest-api-walkthrough.md)<br>Доступ к метрическим значениям с командной строки с помощью [CLI.](/cli/azure/monitor/metrics) |
| Архив | [Архивация](..//learn/tutorial-archive-data.md) журнала производительности и работоспособности ресурса в целях соответствия требованиям, аудита или автономной отчетности. |

## <a name="how-is-data-in-azure-monitor-metrics-structured"></a>Как структурированы данные в azure Monitor Metrics?
Данные, собранные Azure Monitor Metrics, хранятся в базе данных временных рядов, которая оптимизирована для анализа данных с отметками времени. Каждый набор метрических значений представляет собой временные ряды со следующими свойствами:

* Время сбора значения
* Ресурс, с помощью новейескоторый с ним
* Пространство имен, которое действует как категория для метрики
* Имя метрики
* Само значение
* Некоторые метрики могут иметь несколько измерений, как описано в [многомерных метриках.](#multi-dimensional-metrics) Пользовательские метрики могут иметь до 10 измерений.

## <a name="multi-dimensional-metrics"></a>Многомерные метрики
Одна из проблем, связанных с метрическими данными, заключается в том, что они часто имеют ограниченную информацию для предоставления контекста для собранных значений. Azure Monitor решает эту проблему с помощью многомерных метрик. Измерения метрики — это пары имя-значение, которые используются для передачи дополнительных данных с описаниями значения метрики. Например, _метрика Доступное дисковое пространство_ может иметь измерение под названием _Drive_ со значениями _C:_ _, D:_, которое позволит просматривать либо доступное дисковое пространство на всех дисках, либо для каждого диска по отдельности.

В примере ниже показаны два набора данных для гипотетической метрики с названием _Пропускная способность сети_. В первом наборе данных нет измерений. Второй набор данных показывает значения с двумя измерениями, _IP-адресом_ и _направлением:_

### <a name="network-throughput"></a>Пропускная способность сети

| Отметка времени     | Значение метрики |
| ------------- |:-------------|
| 8/9/2017 8:14 | 1331,8 Кбит/с |
| 8/9/2017 8:15 | 1141,4 Кбит/с |
| 8/9/2017 8:16 | 1110,2 Кбит/с |

Такая метрика без измерений поможет найти ответ только на простые вопросы, например о том, какой была пропускная способность в определенный момент времени.

### <a name="network-throughput--two-dimensions-ip-and-direction"></a>Пропускная способность сети и два измерения ("IP-адрес" и "Направление")

| Отметка времени     | Измерение "IP-адрес"   | Измерение "Направление" | Значение метрики|
| ------------- |:-----------------|:------------------- |:-----------|
| 8/9/2017 8:14 | IP-адрес — 192.168.5.2 | Направление — отправка    | 646,5 Кбит/с |
| 8/9/2017 8:14 | IP-адрес — 192.168.5.2 | Направление — получение | 420,1 Кбит/с |
| 8/9/2017 8:14 | IP-адрес — 10.24.2.15  | Направление — отправка    | 150,0 Кбит/с |
| 8/9/2017 8:14 | IP-адрес — 10.24.2.15  | Направление — получение | 115,2 Кбит/с |
| 8/9/2017 8:15 | IP-адрес — 192.168.5.2 | Направление — отправка    | 515,2 Кбит/с |
| 8/9/2017 8:15 | IP-адрес — 192.168.5.2 | Направление — получение | 371,1 Кбит/с |
| 8/9/2017 8:15 | IP-адрес — 10.24.2.15  | Направление — отправка    | 155,0 Кбит/с |
| 8/9/2017 8:15 | IP-адрес — 10.24.2.15  | Направление — получение | 100,1 Кбит/с |

Эта метрика поможет найти ответ на вопросы о том, какая пропускная способность для каждого IP-адреса и сколько данных было отправлено и получено. Многомерные метрики имеют дополнительные значения аналитики и диагностики в отличие от метрик без измерений.

## <a name="interacting-with-azure-monitor-metrics"></a>Взаимодействие с метриками Azure Monitor
Используйте [Metrics Explorer](metrics-charts.md) для интерактивного анализа данных в базе данных метрик и составления графиков значений нескольких метрик с течением времени. Можно прикрепить диаграммы к панели мониторинга, чтобы просмотреть их с помощью других визуализаций. Кроме того, вы можете извлечь метрики с помощью [REST API мониторинга Azure](rest-api-walkthrough.md).

![Обозреватель метрик](media/data-platform/metrics-explorer.png)

## <a name="sources-of-azure-monitor-metrics"></a>Источники метеоков мониторинга Azure
Существует три основных источника метрик, собираемых службой Azure Monitor. После сбора этих показателей в базе данных метрик Azure Monitor они могут быть оценены вместе независимо от их источника.

**Метрики платформы** создаются ресурсами Azure и наглядно отображают работоспособность и производительность этих ресурсов. Каждый тип ресурсов создает [отдельный набор метрик](metrics-supported.md), который не нужно настраивать. Метрики платформы собираются с ресурсов Azure с частотой в одну минуту, если не указано иное в определении метрики. 

**Метрика гостевой ОС** собирается из гостевой операционной системы виртуальной машины. Включить показатели гостевой ОС для виртуальных машин Windows с [Windows Diagnostic Extension (WAD)](../platform/diagnostics-extension-overview.md) и для виртуальных машин Linux с [агентом Инфундида Телеграф.](https://www.influxdata.com/time-series-platform/telegraf/)

**Метрики приложений** создаются службой Application Insights для отслеживаемых приложений и помогают обнаруживать проблемы производительности и отслеживать тенденции использования приложений. Сюда входит ряд значений, в том числе значения _Время отклика сервера_ и _Исключения браузера_.

**Пользовательские метрики** являются метриками, которые вы определяете в дополнение к стандартным метрикам, которые автоматически доступны. Пользовательские [метрики можно определить в приложении,](../app/api-custom-events-metrics.md) которое контролируется Application Insights, или создать пользовательские метрики для службы Azure, используя [пользовательский API метрик.](metrics-store-custom-rest-api.md)

## <a name="retention-of-metrics"></a>Сохранение метрики
Для большинства ресурсов в Azure метрики хранятся в течение 93 дней. Есть некоторые исключения:

**Метрика Гостевой ОС**
-   **Классические показатели Гостевой ОС**. Это счетчики производительности, собранные [диагностическим расширением Windows (WAD)](../platform/diagnostics-extension-overview.md) или [Linux Diagnostic Extension (LAD)](../../virtual-machines/extensions/diagnostics-linux.md) и направляемые в учетную запись хранения Azure. Сохранение для этих метрик составляет 14 дней.
-   **Метели Гостевой ОС, отправленные в Azure Monitor Metrics.** Это счетчики производительности, собранные [диагностическим расширением Windows (WAD)](diagnostics-extension-overview.md) и отправленные в [раковину данных Azure Monitor](diagnostics-extension-overview.md#data-destinations)или через [агент ИнфлюксДата Телеграф](https://www.influxdata.com/time-series-platform/telegraf/) на машинах Linux. Сохранение для этих метрик составляет 93 дней.
-   **Метрика Гостевой ОС, собранные агентом Log Analytics.** Это счетчики производительности, собранные агентом Log Analytics и отправленные в рабочее пространство Log Analytics. Сохранение для этих метрик составляет 31 день, и может быть продлен до 2 лет.

**Показатели на основе журналов На основе приложений.** 
- За сценой [метрики на основе журналов](../app/pre-aggregated-metrics-log-metrics.md) переводятся в журнальные запросы. Их удержание соответствует удержанию событий в базовых журналах. Для ресурсов Application Insights журналы хранятся в течение 90 дней.


> [!NOTE]
> Вы можете [отправлять метрики платформ для ресурсов Azure Monitor в рабочее пространство log Analytics](resource-logs-collect-storage.md) для долгосрочных трендов.





## <a name="next-steps"></a>Дальнейшие действия

- Узнайте больше о [платформе данных Azure Monitor.](data-platform.md)
- Узнайте о [данных журнала в Azure Monitor](data-platform-logs.md).
- Узнайте о [доступных данных мониторинга](data-sources.md) для различных источников в Azure.
