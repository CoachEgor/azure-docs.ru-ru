---
title: Журналы в Azure Monitor | Документация Майкрософт
description: Сведения о журналах в Azure Monitor, которые используются для расширенного анализа данных мониторинга.
documentationcenter: ''
author: bwren
manager: carmonm
ms.topic: conceptual
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 03/26/2019
ms.author: bwren
ms.openlocfilehash: dae72454cd9c0b3cb7370873619595840b770ed3
ms.sourcegitcommit: cf7caaf1e42f1420e1491e3616cc989d504f0902
ms.contentlocale: ru-RU
ms.lasthandoff: 05/22/2020
ms.locfileid: "83799977"
---
# <a name="logs-in-azure-monitor"></a>Журналы в Azure Monitor

> [!NOTE]
> Все данные, собираемые службой Azure Monitor, соответствуют одному из двух основных типов: метрики или журналы. В этой статье описываются журналы. Подробные описания метрик см. в статье [Метрики в Azure Monitor](data-platform-metrics.md), а сравнение метрик и журналов — в статье [Платформа данных Azure Monitor](data-platform.md).

Журналы в Azure Monitor особенно полезны для комплексного анализа данных из нескольких разных источников. В этой статье описана структура журналов в Azure Monitor, возможные действия с данными в них и некоторые источники данных, которые хранят данные в виде журналов.

> [!NOTE]
> Важно различать журналы Azure Monitor и источники данных журналов в Azure. Например, события уровня подписки в Azure записываются в [журнал действий](platform-logs-overview.md), который можно просмотреть в меню Azure Monitor. Большинство ресурсов записывают информацию о своей работе в [журнал ресурсов](platform-logs-overview.md), который можно пересылать в разные расположения. Журналы Azure Monitor — это платформа данных журналов, которая собирает журналы действий и журналы ресурсов вместе с другими данными мониторинга для обеспечения детального анализа по всему набору ресурсов.

## <a name="what-are-azure-monitor-logs"></a>Что такое журналы Azure Monitor?

Журналы в Azure Monitor содержат данные разных типов, упорядоченные по записям с разными наборами свойств для каждого типа. Журналы могут содержать числовые значения, например метрики Azure Monitor, но чаще это текстовые данные с подробными описаниями. Кроме того, они отличаются от данных метрик по своей структуре и часто не собираются через регулярные промежутки времени. Помимо данных производительности, в журналах Azure Monitor хранятся данные телеметрии, например события и трассировки, что позволяет объединить все эти компоненты при анализе.

Стандартный тип записи журнала — событие, сведения о котором система собирает ситуативно. События создаются приложением или службой и обычно содержат достаточно сведений для получения полного контекста. Например, событие может указывать на то, что определенный ресурс был создан или изменен, новый узел был запущен в ответ на увеличение трафика или в работе приложения была обнаружена ошибка.

 Так как формат данных может различаться, приложения могут создавать пользовательские журналы, используя необходимую структуру. Метрики можно даже сохранить в журналы, чтобы объединить их с другими данными мониторинга для поиска тенденций и других видов анализа данных.


## <a name="what-can-you-do-with-azure-monitor-logs"></a>Что можно делать с журналами Azure Monitor?
В следующей таблице перечислены способы использования журналов в Azure Monitor.


|  |  |
|:---|:---|
| Анализ | Используйте [Log Analytics](../log-query/get-started-portal.md) на портале Azure для создания [запросов по журналам](../log-query/log-query-overview.md) и интерактивного анализа данных журналов с помощью мощной подсистемы анализа в Azure Data Explorer.<br>[Консоль аналитики в Application Insights](../app/analytics.md) на портале Azure позволит вам создавать запросы по журналам и интерактивно изучать данные журналов из Application Insights. |
| Визуализация | Закрепляйте отображаемые результаты в виде таблиц или диаграмм на [панели мониторинга Azure](../../azure-portal/azure-portal-dashboards.md).<br>Создавайте [книги](../platform/workbooks-overview.md) для объединения нескольких наборов данных в интерактивный отчет. <br>Экспортировать результаты запроса в [Power BI](powerbi.md), чтобы можно было использовать разные типы визуализации и делиться этими результатами с пользователями за пределами Azure.<br>Экспортируйте результаты запроса в решение [Grafana](grafana-plugin.md), чтобы использовать его панель мониторинга и объединять результаты с данными из других источников.|
| Предупреждение | Настраивать [правила оповещения журнала](alerts-log.md), которые отправляют уведомления или выполняют [автоматические действия](action-groups.md), когда результаты запроса соответствуют определенному результату.<br>Настраивайте [правила генерации оповещений по метрикам](alerts-metric-logs.md) для определенных данных журналов, извлекаемых в виде метрик. |
| Получение | Получайте результаты запроса по журналам из командной строки с помощью [Azure CLI](/cli/azure/ext/log-analytics/monitor/log-analytics).<br>Получайте результаты запроса по журналам из командной строки с помощью [командлетов PowerShell](https://docs.microsoft.com/powershell/module/az.operationalinsights).<br>Получайте результаты запроса по журналам из пользовательского приложения с помощью [REST API](https://dev.loganalytics.io/). |
| Экспорт | Создавайте рабочие процессы для получения данных журналов и копирования их во внешнее расположение с помощью [Logic Apps](~/articles/logic-apps/index.yml). |


## <a name="how-is-data-in-azure-monitor-logs-structured"></a>Какую структуру имеют данные в журналах Azure Monitor?
Данные, собранные в журналах Azure Monitor, сохраняются в [рабочей области Log Analytics](../platform/design-logs-deployment.md). Каждая рабочая область содержит несколько таблиц, каждая из которых хранит данные из определенного источника. Хотя все таблицы имеют [некоторые общие свойства](log-standard-properties.md), каждая из них включает уникальный набор свойств в зависимости от типа хранимых данных. В новой рабочей области будет содержаться стандартный набор таблиц, а решения для мониторинга и другие службы, подключаемые к рабочей области для записи данных, будут создавать в ней новые таблицы.

Данные журналов из Application Insights используют ту же подсистему Log Analytics, что и рабочие области, но в них данные хранятся раздельно для каждого отслеживаемого приложения. Каждое приложение имеет стандартный набор таблиц для хранения таких данных, как запросы приложений, исключения и просмотры страниц.

Запросы по журналам будут использовать данные из рабочей области Log Analytics или из приложения Application Insights. Для анализа данных приложений вместе с другими данными журналов или для создания запросов сразу по нескольким рабочим областям или приложениям можно использовать [межресурсный запрос](../log-query/cross-workspace-query.md).

![Рабочие области](media/data-platform-logs/workspaces.png)

## <a name="log-queries"></a>Запросы журнала
Данные из журналов Azure Monitor извлекаются с помощью [запросов по журналам](../log-query/log-query-overview.md) на [языке запросов Kusto](../log-query/get-started-queries.md), который позволяет быстро получить, консолидировать и анализировать собранные данные. В [Log Analytics](../log-query/portals.md) на портале Azure можно создавать и тестировать запросы по журналам. Эта служба позволяет работать с результатами в интерактивном режиме или закрепить их на панели мониторинга, чтобы просматривать вместе с другими визуализациями.

![Log Analytics](media/data-platform-logs/log-analytics.png)

Откройте [службу Log Analytics](../app/analytics.md), включенную в Application Insights, чтобы анализировать данные в Application Insights.

![Аналитика Application Insights](media/data-platform-logs/app-insights-analytics.png)

Данные журналов также можно получить с помощью [API Log Analytics](https://dev.loganalytics.io/documentation/overview) и [REST API Application Insights](https://dev.applicationinsights.io/documentation/overview).


## <a name="sources-of-azure-monitor-logs"></a>Источники журналов Azure Monitor
Azure Monitor может собирать данные журнала из различных источников, размещенных как в Azure, так и в локальных ресурсах. В следующих таблицах приведены разные источники данных из разных ресурсов, которые записывают данные в журналы Azure Monitor. К каждому прилагается ссылка на подробные сведения о конфигурации.

### <a name="azure-tenant-and-subscription"></a>Клиент и подписки Azure

| Данные | Описание |
|:---|:---|
| Журналы аудита Azure Active Directory | Настраиваются с помощью параметров диагностики для каждого каталога. См. статью [Интеграция журналов Azure AD с журналами Azure Monitor](../../active-directory/reports-monitoring/howto-integrate-activity-logs-with-log-analytics.md).  |
| Журналы действий | По умолчанию хранятся отдельно и могут использоваться для генерации оповещений практически в реальном времени. Установите решение аналитики для журналов действий, чтобы записывать данные в рабочую область Log Analytics. См. статью о [сборе и анализе журналов действий Azure в Log Analytics](activity-log-collect.md). |

### <a name="azure-resources"></a>Ресурсы Azure

| Данные | Описание |
|:---|:---|
| Диагностика ресурсов | Настройте в параметрах диагностики запись диагностических данных, в том числе метрик, в рабочую область Log Analytics. См. статью о [потоковой передаче журналов ресурсов Azure в Log Analytics](resource-logs-collect-workspace.md). |
| Решения для мониторинга | Решения для мониторинга записывают собранные данные в настроенную для них рабочую область Log Analytics. Список решений см. в статье о [сборе данных для решений управления в Azure](../insights/solutions-inventory.md). Подробную информацию об установке и использовании таких решений см.в статье [Решения мониторинга в Azure Monitor](../insights/solutions.md). |
| Метрики | Отправляйте метрики платформы для ресурсов Azure Monitor в рабочую область Log Analytics, чтобы дольше хранить эти данные и выполнять сложный анализ в сочетании с другими типами данных, используя [язык запросов Kusto](/azure/kusto/query/). См. статью о [потоковой передаче журналов ресурсов Azure в Log Analytics](resource-logs-collect-storage.md). |
| Хранилище таблиц Azure | Собирайте данные из хранилища Azure, куда некоторые ресурсы Azure записывают данные мониторинга. См. статью об [использовании хранилища BLOB-объектов Azure для IIS и хранилища таблиц Azure для событий в Azure Log Analytics](diagnostics-extension-logs.md). |

### <a name="virtual-machines"></a>Виртуальные машины

| Данные | Описание |
|:---|:---|
|  Источники данных в агенте | От агентов [Windows](agent-windows.md) и [Linux](../learn/quick-collect-linux-computer.md) собираются такие источники данных, как события, данные производительности и пользовательские журналы. Список источников данных и сведения об их настройке см. в статье [Источники данных агентов в Azure Monitor](data-sources.md). |
| Решения для мониторинга | Решения для мониторинга записывают собранные от агентов данные в настроенную для них рабочую область Log Analytics. Список решений см. в статье о [сборе данных для решений управления в Azure](../insights/solutions-inventory.md). Подробную информацию об установке и использовании таких решений см.в статье [Решения мониторинга в Azure Monitor](../insights/solutions.md). |
| System Center Operations Manager | Подключите группу управления Operations Manager к Azure Monitor, чтобы собирать события и данные производительности от локальных агентов в журналы Azure Monitor. Дополнительные сведения об этой конфигурации см. в статье [Подключение Operations Manager к Azure Monitor](om-agents.md). |


### <a name="applications"></a>Приложения

| Данные | Описание |
|:---|:---|
| Запросы и исключения | Подробные данные о запросах и исключениях приложений собираются в таблицах _requests_, _pageViews_ и _exceptions_. Вызовы к [внешним компонентам](../app/asp-net-dependencies.md) находятся в таблице _dependencies_. |
| Потребление и производительность | Сведения о производительности приложения можно получить из таблиц _requests_, _browserTimings_ и _performanceCounters_. Данные [пользовательских метрик](../app/api-custom-events-metrics.md#trackevent) доступны в таблице _customMetrics_.|
| Данные трассировки | Результаты [распределенной трассировки](../app/distributed-tracing.md) хранятся в таблице _traces_. |
| Тесты доступности | Сводные данные по [тестам доступности](../app/monitor-web-app-availability.md) хранятся в таблице _availabilityResults_. Подробные данные, полученные от этих тестов, находятся в отдельном хранилище и доступны в Application Insights на портале Azure. |

### <a name="insights"></a>Аналитика

| Данные | Описание |
|:---|:---|
| Azure Monitor для контейнеров | Данные инвентаризации и производительности собираются [Azure Monitor для контейнеров](../insights/container-insights-overview.md). Список таблиц с этими данными см. в разделе [Сбор данных из контейнеров](../insights/container-insights-log-search.md#container-records). |
| Azure Monitor для виртуальных машин | Данные о сопоставлениях и производительности собираются [Azure Monitor для виртуальных машин](../insights/vminsights-overview.md). Подробные сведения о запросах по этим данным см. в статье [Как выполнять запросы к журналам из Azure Monitor для виртуальных машин](../insights/vminsights-log-search.md). |

### <a name="custom"></a>Другой 

| Данные | Описание |
|:---|:---|
| REST API | Записывайте данные в рабочую область Log Analytics из любого клиента с поддержкой REST. Подробнее см. в статье [Отправка данных журналов в Azure Monitor c помощью API сборщика данных HTTP](data-collector-api.md).
| приложение логики; | Записывайте в рабочую область Log Analytics любые данные из рабочего процесса приложения логики с помощью **действия сборщика данных Azure Log Analytics**. |

### <a name="security"></a>Безопасность

| Данные | Описание |
|:---|:---|
| Центр безопасности Azure | [Центр безопасности Azure](/azure/security-center/) хранит данные, собираемые в рабочей области Log Analytics, позволяя анализировать их вместе с другими данными журналов. Подробные сведения о конфигурации рабочей области см. в статье [Сбор данных в Центре безопасности Azure](../../security-center/security-center-enable-data-collection.md). |
| Azure Sentinel | [Azure Sentinel](/azure/sentinel/) сохраняет в рабочей области Log Analytics данные, полученные от источников данных. См. статью [Подключение источников данных](/azure/sentinel/connect-data-sources).  |


## <a name="next-steps"></a>Дальнейшие действия

- Изучите дополнительные сведения в статье о [платформе данных Azure Monitor](data-platform.md).
- Прочитайте статью о [метриках в Azure Monitor](data-platform-metrics.md).
- Узнайте о [доступных данных мониторинга](data-sources.md) для различных источников в Azure.
