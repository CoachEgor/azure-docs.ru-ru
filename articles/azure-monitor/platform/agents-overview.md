---
title: Обзор агентов мониторинга Azure | Документация Майкрософт
description: В этой статье представлен подробный обзор доступных агентов Azure, которые поддерживают мониторинг виртуальных машин, размещенных в Azure или гибридной среде.
services: azure-monitor
ms.subservice: ''
ms.topic: conceptual
author: bwren
ms.author: bwren
ms.date: 02/14/2020
ms.openlocfilehash: a7e6a3a299df8112fe4fbcf457516894c1766b8c
ms.sourcegitcommit: 509b39e73b5cbf670c8d231b4af1e6cfafa82e5a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/05/2020
ms.locfileid: "78362172"
---
# <a name="overview-of-azure-monitor-agents"></a>Общие сведения об агентах Azure Monitor

Виртуальным машинам и другим ресурсам для вычислений требуется, чтобы агент собирал данные мониторинга для измерения производительности и доступности своей операционной системы и рабочих нагрузок на виртуальной машине. В этой статье описываются агенты, используемые Azure Monitor, и помогает определить, что необходимо удовлетворить требованиям конкретной среды.

> [!NOTE]
> В данный момент Azure Monitor несколько агентов из-за последней консолидации Azure Monitor и Log Analytics. Хотя в их функциях может быть перекрываться, каждая из них имеет уникальные возможности. В зависимости от ваших требований может потребоваться один или несколько агентов на виртуальных машинах. 

У вас может быть определенный набор требований, который не может быть полностью удовлетворен одним агентом для конкретной виртуальной машины. Например, можно использовать оповещения метрик, для которых требуется расширение системы диагностики Azure, но также необходимо использовать функции Azure Monitor для виртуальных машин, для которой требуется агент Log Analytics и агент зависимостей. В таких случаях можно использовать несколько агентов, и это распространенный сценарий для клиентов, которым требуются функции каждого из них.

## <a name="summary-of-agents"></a>Сводка по агентам

В следующих таблицах представлено краткое сравнение агентов Azure Monitor для Windows и Linux. Дополнительные сведения о каждом из них приведены в разделе ниже. 

### <a name="windows-agents"></a>Агенты Windows

| | Диагностика<br>расширение (WAD) | Log Analytics<br>агент | Зависимость<br>агент |
|:---|:---|:---|:---|
| Поддерживаемые среды | Azure | Azure<br>Другое облако<br>В локальной среде | Azure<br>Другое облако<br>В локальной среде | 
| Требования к агентам  | Нет | Нет | Требуется агент Log Analytics |
| Собираемые данные | Журналы событий<br>События ETW<br>Производительность<br>Журналы на основе файлов<br>Журналы служб IIS<br>Журналы приложений .NET<br>Аварийные дампы<br>Журналы диагностики агента | Журналы событий<br><IIS logs> производительности<br>Журналы на основе файлов<br>Полезные сведения и решения<br>Другие службы | Сведения о процессе и зависимости<br>Метрики сетевого подключения |
| Отправленные данные | Хранилище Azure<br>Метрики Azure Monitor<br>Концентратор событий | Журналы Azure Monitor | Журналы Azure Monitor |


### <a name="linux-agents"></a>Агенты Linux

| | Диагностика<br>расширение (LAD) | Telegraf<br>агент | Log Analytics<br>агент | Зависимость<br>агент |
|:---|:---|:---|:---|:---|
| Поддерживаемые среды | Azure | Azure<br>Другое облако<br>В локальной среде | Azure<br>Другое облако<br>В локальной среде | Azure<br>Другое облако<br>В локальной среде |
| Требования к агентам  | Нет | Нет | Нет | Требуется агент Log Analytics |
| Собираемые данные | Системный журнал<br>Производительность | Производительность | Системный журнал<br>Производительность| Сведения о процессе и зависимости<br>Метрики сетевого подключения |
| Отправленные данные | Хранилище Azure<br>Концентратор событий | Метрики Azure Monitor | Журналы Azure Monitor | Журналы Azure Monitor |

## <a name="log-analytics-agent"></a>Агент Log Analytics

[Агент log Analytics](log-analytics-agent.md) собирает данные мониторинга из операционной системы на виртуальной машине и рабочих нагрузок виртуальных машин в Azure, в других поставщиках облачных служб и в локальной среде. Он собирает данные в рабочую область Log Analytics. Агент Log Analytics — это тот же агент, который используется System Center Operations Manager. Вы можете использовать компьютеры агента для многодомашнего подключения к группе управления и Azure Monitor одновременно. Этот агент также необходим для определенных аналитических сведений и решений в Azure Monitor.


> [!NOTE]
> Агент Log Analytics для Windows часто называется Microsoft Monitoring Agent (MMA). Агент Log Analytics для Linux часто называется агентом OMS.



Используйте агент Log Analytics, если необходимо:

* Собирайте журналы и данные производительности с виртуальных или физических компьютеров за пределами Azure. 
* Отправляйте данные в рабочую область Log Analytics, чтобы воспользоваться преимуществами функций, поддерживаемых [Azure Monitor журналами](data-platform-logs.md#what-can-you-do-with-azure-monitor-logs) , такими как [запросы журналов](../log-query/log-query-overview.md).
* Используйте [Azure Monitor для виртуальных машин](../insights/vminsights-overview.md) , которая позволяет отслеживать масштаб виртуальных машин и отслеживает их процессы и зависимости от других ресурсов и внешних процессов.  
* Управляйте безопасностью виртуальных машин с помощью [центра безопасности Azure](../../security-center/security-center-intro.md) или [Sentinel Azure](../../sentinel/overview.md).
* Использование [управления обновлениями службы автоматизации](../../automation/automation-update-management.md)Azure, [настройки состояния службы автоматизации](../../automation/automation-dsc-overview.md)Azure или [Отслеживание изменений и инвентаризации Azure Automation](../../automation/change-tracking.md) для предоставления комплексного управления виртуальными машинами Azure
* Используйте различные [решения](../monitor-reference.md#insights-and-core-solutions) для мониторинга определенной службы или приложения.

К ограничениям агента Log Analytics относятся:

- Не удается отправить данные в метрики Azure Monitor, службу хранилища Azure или концентраторы событий Azure.

## <a name="azure-diagnostics-extension"></a>Расширение системы диагностики Azure

[Расширение система диагностики Azure](diagnostics-extension-overview.md) собирает данные мониторинга из операционной системы на виртуальной машине и рабочих нагрузок виртуальных машин Azure и других ресурсов вычислений. В основном он собирает данные в службу хранилища Azure, но также позволяет определять приемники данных для отправки данных в другие назначения, такие как метрики Azure Monitor и концентраторы событий Azure.

Используйте расширение диагностики Azure, если вам нужно:

- Отправка данных в службу хранилища Azure для архивирования или анализа с помощью таких средств, как [Обозреватель службы хранилища Azure](../../vs-azure-tools-storage-manage-with-storage-explorer.md).
- Отправляйте данные в [метрики Azure Monitor](data-platform-metrics.md) , чтобы проанализировать ее с помощью [обозревателя метрик](metrics-getting-started.md) и воспользоваться такими функциями, как оповещения на основе [метрик](../../azure-monitor/platform/alerts-metric-overview.md) практически в реальном времени и [Автомасштабирование](autoscale-overview.md) (только для Windows).
- Отправка данных сторонним средствам с помощью [концентраторов событий Azure](diagnostics-extension-stream-event-hubs.md).
- Собирайте [диагностику загрузки](../../virtual-machines/troubleshooting/boot-diagnostics.md) для изучения проблем загрузки виртуальной машины.

К ограничениям расширения системы диагностики Azure относятся:

- Можно использовать только с ресурсами Azure.
- Ограниченная возможность отправки данных в журналы Azure Monitor.

## <a name="telegraf-agent"></a>Агент Telegraf

[Агент Инфлуксдата Telegraf](collect-custom-metrics-linux-telegraf.md) используется для сбора данных о производительности с компьютеров Linux для Azure Monitor метрик.

Используйте Telegraf Agent, если необходимо:

* Отправляйте данные в [метрики Azure Monitor](data-platform-metrics.md) , чтобы проанализировать ее с помощью [обозревателя метрик](metrics-getting-started.md) и воспользоваться такими функциями, как оповещения на основе [метрик](../../azure-monitor/platform/alerts-metric-overview.md) практически в реальном времени и [Автомасштабирование](autoscale-overview.md) (только для Linux). 



## <a name="dependency-agent"></a>Агент зависимостей

Агент зависимостей собирает обнаруженные данные о процессах, выполняемых на виртуальной машине, и зависимостях внешних процессов. 

Используйте агент зависимостей, если необходимо:

* Используйте функцию Map [Azure Monitor для виртуальных машин](../insights/vminsights-overview.md) или [сопоставление служб](../insights/service-map.md) решение.

При использовании агента зависимостей учитывайте следующее.

- Агенту зависимостей требуется установить агент Log Analytics на той же виртуальной машине.
- На виртуальных машинах Linux необходимо установить агент Log Analytics перед расширением диагностики Azure.

## <a name="extensions-compared-to-agents"></a>Расширения по сравнению с агентами

Расширение Log Analytics для [Windows](../../virtual-machines/extensions/oms-windows.md) и [Linux](../../virtual-machines/extensions/oms-linux.md) установите агент log Analytics на виртуальных машинах Azure. Расширение зависимостей Azure Monitor для [Windows](../../virtual-machines/extensions/agent-dependency-windows.md) и [Linux](../../virtual-machines/extensions/agent-dependency-linux.md) устанавливает агент зависимостей на виртуальных машинах Azure. Это те же агенты, описанные выше, но позволяющие управлять ими с помощью [расширений виртуальной машины](../../virtual-machines/extensions/overview.md). При возможности для установки агентов и управления ими следует использовать расширения.


## <a name="next-steps"></a>Следующие шаги

Дополнительные сведения о каждом из агентов см. в следующих статьях:

- [Общие сведения об агенте Log Analytics](log-analytics-agent.md)
- [Общие сведения о расширении система диагностики Azure](diagnostics-extension-overview.md)
- [Получение пользовательских метрик для виртуальной машины Linux с помощью агента Инфлуксдата Telegraf](collect-custom-metrics-linux-telegraf.md)
