---
title: Обзор агентов мониторинга Azure | Документация Майкрософт
description: В этой статье представлен подробный обзор доступных агентов Azure, которые поддерживают мониторинг виртуальных машин, размещенных в Azure или гибридной среде.
services: azure-monitor
ms.service: azure-monitor
ms.subservice: ''
ms.topic: conceptual
author: bwren
ms.author: bwren
ms.date: 11/15/2019
ms.openlocfilehash: ae799e9a852b8700399ef695c54b3348174b560c
ms.sourcegitcommit: a460fdc19d6d7af6d2b5a4527e1b5c4e0c49942f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/07/2020
ms.locfileid: "77069410"
---
# <a name="overview-of-the-azure-monitor-agents"></a>Общие сведения об агентах Azure Monitor 
Такие ресурсы, как виртуальные машины, создают данные для отслеживания их производительности и доступности так же, как и [другие облачные ресурсы](../insights/monitor-azure-resource.md). Кроме того, для вычислений можно использовать гостевую операционную систему и рабочие нагрузки, которые необходимо отслеживать. Для сбора данных мониторинга из ресурса требуется агент. В этой статье описываются агенты, используемые Azure Monitor, и помогает определить, что необходимо удовлетворить требованиям конкретной среды.

## <a name="summary-of-agents"></a>Сводка по агентам

> [!NOTE]
> В данный момент Azure Monitor несколько агентов из-за последней консолидации Azure Monitor и Log Analytics. Оба агента совместно используют некоторые возможности, в то время как другие функции являются уникальными для конкретного агента. В зависимости от требований может потребоваться один из агентов или оба. 

В Azure Monitor есть три агента, каждый из которых предоставляет определенные функциональные возможности. В зависимости от требований вы можете установить один или несколько агентов на виртуальные машины и другие ресурсы вычислений.

* [Расширение системы диагностики Azure](#azure-diagnostic-extension)
* [Агент Log Analytics](#log-analytics-agent)
* [Агент зависимостей](#dependency-agent)

В следующей таблице приводится краткое сравнение различных агентов. Дополнительные сведения о каждой из них см. в оставшейся части этой статьи.

| | Расширение диагностики Azure | Агент Log Analytics | Агент зависимостей |
|:---|:---|:---|:---|
| Поддерживаемые среды | Azure | Azure<br>Другое облако<br>В локальной среде | Azure<br>Другое облако<br>В локальной среде |
| Операционные системы | Windows<br>Linux | Windows<br>Linux | Windows<br>Linux
| Зависимости агентов  | None | None | Требуется агент Log Analytics |
| Собираемые данные | журналы событий;<br>События ETW<br>Системный журнал<br>Производительность<br>Журналы IIS<br>Приложение .NET для трассировки журналов вывода.<br>Аварийные дампы | журналы событий;<br>Системный журнал<br>Производительность<br>Журналы IIS<br>Пользовательские журналы<br>Данные из решений | Сведения о процессе и зависимости<br>Метрики сетевого подключения |
| Отправленные данные | Хранилище Azure<br>Метрики Azure Monitor<br>Концентратор событий | Журналы Azure Monitor | Журналы Azure Monitor |



## <a name="azure-diagnostic-extension"></a>Расширение системы диагностики Azure
[Расширение система диагностики Azure](../../azure-monitor/platform/diagnostics-extension-overview.md) собирает данные мониторинга из операционной системы на виртуальной машине и рабочих нагрузок ресурсов вычислений Azure. В основном он собирает данные в службу хранилища Azure. Azure Monitor можно настроить для копирования данных из хранилища в Log Analytics рабочую область. Вы также можете получать данные о производительности гостя в метрики Azure Monitor.

Расширение диагностики Azure часто называется расширением системы диагностики Microsoft Azure (WAD) или Linux (LAD).


### <a name="scenarios-supported"></a>Поддерживаемые сценарии

К сценариям, поддерживаемым расширением система диагностики Azure, относятся следующие.

* Собирайте журналы и данные о производительности из ресурсов вычислений Azure.
* Архивация журналов и данных о производительности из гостевой операционной системы в службу хранилища Azure.
* Просмотр данных мониторинга в хранилище с помощью такого средства, как [Обозреватель службы хранилища Azure](../../vs-azure-tools-storage-manage-with-storage-explorer.md).
* Собирайте данные производительности в базе данных метрик, чтобы воспользоваться возможностями, поддерживаемыми [Azure Monitorными метриками](data-platform-metrics.md) , такими как оповещения на основе [метрик](../../azure-monitor/platform/alerts-metric-overview.md) практически в реальном времени и автоматическое [масштабирование](autoscale-overview.md). 
* Собирайте данные мониторинга из [хранилища в log Analytics рабочей области](azure-storage-iis-table.md) , чтобы воспользоваться преимуществами функций, поддерживаемых [Azure Monitor журналами](data-platform-logs.md#what-can-you-do-with-azure-monitor-logs) , такими как [запросы журналов](../log-query/log-query-overview.md).
* Отправка данных мониторинга сторонним средствам с помощью [концентраторов событий Azure](diagnostics-extension-stream-event-hubs.md).
* Исследование неполадок загрузки виртуальной машины с помощью [диагностики загрузки](../../virtual-machines/troubleshooting/boot-diagnostics.md).
* Копирование данных из приложений, выполняющихся на виртуальной машине [, в Application Insights](diagnostics-extension-to-application-insights.md) для интеграции с другим наблюдением за приложениями.

## <a name="log-analytics-agent"></a>Агент Log Analytics
[Агент log Analytics](log-analytics-agent.md) собирает данные мониторинга из операционной системы на виртуальной машине и рабочих нагрузок виртуальных машин в Azure, в других поставщиках облачных служб и в локальной среде. Он собирает данные в рабочую область Log Analytics.

Агент Log Analytics — это тот же агент, который используется System Center Operations Manager и компьютерами с многодомашний агентом для взаимодействия с группой управления и Azure Monitor одновременно. Этот агент также необходим для некоторых решений в Azure Monitor.

Агент Log Analytics для Windows часто называется Microsoft Management Agent (MMA). Агент Log Analytics для Linux часто называется агентом OMS.


### <a name="scenarios-supported"></a>Поддерживаемые сценарии

Ниже перечислены сценарии, поддерживаемые агентом Log Analytics.

* Собирайте журналы и данные о производительности виртуальных машин в Azure, других поставщиках облачных служб и локальных средах. 
* Собирайте данные мониторинга в Log Analytics рабочей области, чтобы воспользоваться преимуществами функций, поддерживаемых [Azure Monitor журналами](data-platform-logs.md#what-can-you-do-with-azure-monitor-logs) , такими как [запросы журналов](../log-query/log-query-overview.md).
* Используйте Azure Monitor решения для мониторинга, например [Azure Monitor для виртуальных машин](../insights/vminsights-overview.md), [Azure Monitor для контейнеров](../insights/container-insights-overview.md)и т. д.  
* Управляйте безопасностью виртуальных машин, используя [метку Azure](../../sentinel/overview.md) , для которой требуется агент log Analytics.
* Управляйте безопасностью виртуальных машин с помощью [центра безопасности Azure](../../security-center/security-center-intro.md) , для которого требуется агент log Analytics.
* Используйте функции [службы автоматизации Azure](../../automation/automation-intro.md) , чтобы обеспечить комплексное управление виртуальными машинами Azure за счет их жизненного цикла.  Ниже приведены примеры этих функций, для которых требуется агент Log Analytics.
  * [Управление обновлениями службы автоматизации Azure](../../automation/automation-update-management.md) для обновлений операционной системы.
  * [Настройка состояния службы автоматизации Azure](../../automation/automation-dsc-overview.md) для поддержания стабильного состояния конфигурации.
  * Отслеживание изменений в конфигурации с помощью [Отслеживания изменений в службе автоматизации и инвентаризации Azure](../../automation/change-tracking.md).

## <a name="dependency-agent"></a>Агент зависимостей
Агент зависимостей собирает обнаруженные данные о процессах, выполняемых на виртуальной машине, и зависимостях внешних процессов. Этот агент необходим для [сопоставление служб](../insights/service-map.md) и функции Map [Azure Monitor для виртуальных машин](../insights/vminsights-overview.md). Агенту зависимостей требуется агент Log Analytics и запись данных в Log Analytics рабочую область в Azure Monitor.


## <a name="using-multiple-agents"></a>Использование нескольких агентов
У вас могут быть особые требования для использования расширения диагностики Azure или агента Log Analytics для конкретной виртуальной машины. Например, вы можете использовать оповещения метрик, для которых требуется расширение диагностики Azure. Но также может потребоваться использовать функцию Map Azure Monitor для виртуальных машин, для которой требуется агент зависимостей и агент Log Analytics. В этом случае можно использовать несколько агентов, и это распространенный сценарий для клиентов, которым требуются функции каждого из них.

### <a name="considerations"></a>Рекомендации

- Агенту зависимостей требуется установить агент Log Analytics на той же виртуальной машине.
- На виртуальных машинах Linux необходимо установить агент Log Analytics перед расширением диагностики Azure.


## <a name="next-steps"></a>Дальнейшие действия

- Сведения о требованиях и поддерживаемых методах для развертывания агента на компьютеры, размещенные в Azure, в вашем центре данных или другой облачной среде, см. в статье [Сбор данных журнала с помощью агента Azure Log Analytics](../../azure-monitor/platform/log-analytics-agent.md).

