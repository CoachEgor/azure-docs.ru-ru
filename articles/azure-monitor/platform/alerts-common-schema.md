---
title: Общие схемы оповещения для предупреждений монитора Azure
description: Понимание общей схемы оповещения, почему вы должны использовать его и как включить его
ms.topic: conceptual
ms.subservice: alerts
ms.date: 03/14/2019
ms.openlocfilehash: 1445e8cf38b2694146fc8749ba5e77f2297de969
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "79249052"
---
# <a name="common-alert-schema"></a>Общая схема оповещений

В этой статье описывается общая схема оповещения, преимущества ее использования и как включить ее.

## <a name="what-is-the-common-alert-schema"></a>Какова общая схема оповещения?

Схема общего оповещения стандартизирует работу по потреблению уведомлений в Azure сегодня. Исторически сложилось так, что три типа оповещений в Azure сегодня (метрика, журнал и журнал активности) имели свои собственные шаблоны электронной почты, схемы веб-крючка и т.д. С помощью общей схемы оповещения теперь можно получать уведомления о потревоге с последовательной схемой.

Любой экземпляр оповещения описывает **ресурс, который был затронут,** и **причину оповещения,** и эти экземпляры описаны в общей схеме в следующих разделах:
* **Основы**: Набор **стандартизированных полей,** распространенных во всех типах оповещения, которые описывают, на **каком ресурсе** находится оповещение, а также дополнительные общие метаданные оповещения (например, серьезность или описание). 
* **Контекст оповещения**: Набор полей, описывающие **причину оповещения,** с полями, которые меняются **в зависимости от типа оповещения.** Например, метрика эвакуирует такие поля, как имя метрики и значение метрики в контексте оповещения, в то время как оповещение журнала активности будет иметь информацию о событии, генерируемом оповещение. 

Типичные сценарии интеграции, которые мы слышим от клиентов, включают в себя разгром экземпляра оповещения в соответствующую команду на основе некоторой стержня (например, группы ресурсов), после чего ответственная группа начинает работать над ним. С помощью общей схемы оповещения можно унифицировать логику реуктора в типах оповещений, используя основные поля, оставляя поля контекста, как и для заинтересованных групп для дальнейшего исследования.

Это означает, что потенциально у вас может быть меньше интеграций, что делает процесс управления и поддержания их _гораздо_ более простой задачей. Кроме того, будущие обогащения полезной нагрузки оповещения (например, настройка, диагностическое обогащение и т.д.) будут всплывать только в общей схеме.

## <a name="what-enhancements-does-the-common-alert-schema-bring"></a>Какие усовершенствования приносит общая схема оповещения?

Общая схема оповещения будет в первую очередь проявляться в уведомлениях о помечке. Улучшения, которые вы увидите, перечислены ниже:

| Действие | Улучшения|
|:---|:---|
| SMS | Последовательный шаблон SMS для всех типов оповещений. |
| Email | Последовательный и подробный шаблон электронной почты, что позволяет легко диагностировать проблемы с первого взгляда. Встроенные глубокие ссылки на экземпляр оповещения на портале и пострадавшем ресурсе гарантируют, что вы сможете быстро перейти в процесс исправления. |
| Webhook/Logic App/Azure Function/Automation Runbook | Согласованная структура JSON для всех типов оповещений, которая позволяет легко создавать интеграции в различных типах оповещений. |

Новая схема также позволит в ближайшем будущем обеспечить более богатый опыт потребления оповещений как на портале Azure, так и в мобильном приложении Azure. 

[Узнайте больше об определениях схем для Webhooks/Logic Apps/Azure Functions/Automation Runbooks.](https://aka.ms/commonAlertSchemaDefinitions)

> [!NOTE]
> Следующие действия не поддерживают общую схему оповещения: ITSM Connector.

## <a name="how-do-i-enable-the-common-alert-schema"></a>Как включить общую схему оповещения?

Вы можете выбрать или отказаться от общей схемы оповещения через группы действий, как на портале, так и через REST API. Переключение для переключения на новую схему существует на уровне действия. Например, вы должны отдельно выбрать для действий по электронной почте и действия webhook.

> [!NOTE]
> 1. Следующие типы оповещений поддерживают общую схему по умолчанию (не выбрать в требуется):
>     * Оповещения интеллектуального обнаружения
> 1. Следующие типы оповещений в настоящее время не поддерживают общую схему:
>     * Оповещения, генерируемые [Azure Monitor для св.м](https://docs.microsoft.com/azure/azure-monitor/insights/vminsights-overview)
>     * Оповещения, генерируемые [Управлением затратами Azure](https://docs.microsoft.com/azure/billing/billing-cost-management-budget-scenario)

### <a name="through-the-azure-portal"></a>Через портал Azure

![Общие схемы оповещения выбрать в](media/alerts-common-schema/portal-opt-in.png)

1. Откройте любое существующее или новое действие в группе действий. 
1. Выберите "Да" для переключения, чтобы включить общую схему оповещения в виде показаний.

### <a name="through-the-action-groups-rest-api"></a>Через группы действий REST API

Можно также использовать [API групп действий,](https://docs.microsoft.com/rest/api/monitor/actiongroups) чтобы выбрать общую схему оповещения. При [создании или обновлении](https://docs.microsoft.com/rest/api/monitor/actiongroups/createorupdate) вызова REST API можно установить флаг "useCommonAlertSchema" на "истинный" (выбрать) или "ложный" (отказаться) для любого из следующих действий - электронной почты /webhook/logic app/Azure Function/automation runbook.

Например, следующий орган запроса, сделанный для [создания или обновления](https://docs.microsoft.com/rest/api/monitor/actiongroups/createorupdate) REST API, будет выполнять следующие:

* Включить общую схему оповещения для действия электронной почты "Почта Джона Доу"
* Отключить общую схему оповещения для действия по электронной почте "Электронная почта Джейн Смит"
* Включить общую схему оповещения для действия веб-крючка "Образец webhook"

```json
{
  "properties": {
    "groupShortName": "sample",
    "enabled": true,
    "emailReceivers": [
      {
        "name": "John Doe's email",
        "emailAddress": "johndoe@email.com",
        "useCommonAlertSchema": true
      },
      {
        "name": "Jane Smith's email",
        "emailAddress": "janesmith@email.com",
        "useCommonAlertSchema": false
      }
    ],
    "smsReceivers": [
      {
        "name": "John Doe's mobile",
        "countryCode": "1",
        "phoneNumber": "1234567890"
      },
      {
        "name": "Jane Smith's mobile",
        "countryCode": "1",
        "phoneNumber": "0987654321"
      }
    ],
    "webhookReceivers": [
      {
        "name": "Sample webhook",
        "serviceUri": "http://www.example.com/webhook",
        "useCommonAlertSchema": true
      }
    ]
  },
  "location": "Global",
  "tags": {}
}
```





## <a name="next-steps"></a>Дальнейшие действия

- [Общие определения схемы оповещения для Webhooks/Logic Apps/Azure Functions/Automation Runbooks.](https://aka.ms/commonAlertSchemaDefinitions)
- [Узнайте, как создать логическое приложение, которое использует общую схему оповещения для обработки всех ваших оповещений.](https://docs.microsoft.com/azure/azure-monitor/platform/alerts-common-schema-integrations) 



