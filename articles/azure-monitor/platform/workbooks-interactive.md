---
title: Azure Monitor книг с пользовательскими параметрами
description: Упростите создание сложных отчетов с помощью готовых настраиваемых параметризованных книг
services: azure-monitor
author: mrbullwinkle
manager: carmonm
ms.service: azure-monitor
ms.workload: tbd
ms.tgt_pltfrm: ibiza
ms.topic: conceptual
ms.date: 10/23/2019
ms.author: mbullwin
ms.openlocfilehash: 19fd8c108e8075d30ca494ca75d52952849c284a
ms.sourcegitcommit: 9405aad7e39efbd8fef6d0a3c8988c6bf8de94eb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/05/2019
ms.locfileid: "74872848"
---
# <a name="interactive-workbooks"></a>Интерактивные Workbooks

Книги позволяют авторам создавать интерактивные отчеты и взаимодействия с пользователями. Интерактивность поддерживается несколькими способами.

## <a name="parameter-changes"></a>Изменения параметров
Когда пользователь книги обновляет параметр, любой элемент управления, использующий этот параметр, автоматически обновляется и перерисовывается в соответствии с новым состоянием. В этом случае большинство отчетов портал Azure поддерживают интерактивность. Книги обеспечивают это очень прямым способом с минимальными усилиями пользователя.

Дополнительные сведения о [параметрах в книгах](workbooks-parameters.md)

## <a name="grid-row-clicks"></a>Щелчки по строкам сетки
Книги позволяют авторам создавать сценарии, в которых щелчок строки в сетке обновляет последующие диаграммы на основе содержимого строки. 

Например, пользователь может иметь сетку, в которой отображается список запросов и определенная статистика, например количество сбоев. Они могут настроить таким образом, что при щелчке строки, соответствующей запросу, на приведенных ниже диаграммах будут обновлены данные для фильтрации только по этому запросу.

### <a name="setting-up-interactivity-on-grid-row-click"></a>Настройка интерактивности при щелчке по строке сетки
1. Переключите книгу в режим редактирования, щелкнув элемент панели инструментов _изменить_ .
2. Используйте ссылку _Добавить запрос_ , чтобы добавить в книгу элемент управления "запрос журнала". 
3. Выберите тип запроса в поле _Журнал_, тип ресурса (например, Application Insights) и ресурсы для целевого объекта.
4. Использование редактора запросов для ввода ККЛ для анализа
    ```kusto
    requests
    | summarize AllRequests = count(), FailedRequests = countif(success == false) by Request = name
    | order by AllRequests desc    
    ```
5. `Run query` просмотреть результаты
6. Щелкните значок _Дополнительные параметры_ в нижнем колонтитуле запроса (значок выглядит как шестеренка). Откроется область Дополнительные параметры. 
7. Проверьте параметр: `When an item is selected, export a parameter`
    1. Поле для экспорта: `Request`
    2. Имя параметра: `SelectedRequest`
    3. Значение по умолчанию — `All requests`.
    
    ![Изображение, отображающее Расширенный редактор с параметрами экспорта полей в качестве параметров](./media/workbooks-interactive/advanced-settings.png)

8. Щелкните `Done Editing`.
9. Добавьте еще один элемент управления запроса, используя шаги 2 и 3.
10. Использование редактора запросов для ввода ККЛ для анализа
    ```kusto
    requests
    | where name == '{SelectedRequest}' or 'All Requests' == '{SelectedRequest}'
    | summarize ['{SelectedRequest}'] = count() by bin(timestamp, 1h)
    ```
11. `Run query`, чтобы просмотреть результаты.
12. Изменение _визуализации_ на `Area chart`
12. Щелкните строку в первой сетке. Обратите внимание, что диаграмма с областями, приведенная ниже, фильтрует выбранный запрос.

Итоговый отчет будет выглядеть в режиме редактирования:

![Изображение, показывающее создание интерактивного интерфейса с помощью щелчков по строкам сетки](./media/workbooks-interactive//grid-click-create.png)

На рисунке ниже показан более сложный интерактивный отчет в режиме чтения, основанный на тех же принципах. В отчете используются щелчки сетки для экспорта параметров, которые, в свою очередь, используются в двух диаграммах и блоке текста.

![Изображение, показывающее создание интерактивного интерфейса с помощью щелчков по строкам сетки](./media/workbooks-interactive/grid-click-read-mode.png)

### <a name="exporting-the-contents-of-an-entire-row"></a>Экспорт содержимого целой строки
Иногда желательно экспортировать все содержимое выбранной строки, а не только конкретный столбец. В таких случаях оставьте значение свойства `Field to export` на шаге 7,1 выше. Книга экспортирует содержимое строки целиком в виде JSON-файла в параметр. 

В ссылающемся элементе управления ККЛ используйте функцию `todynamic`, чтобы проанализировать JSON и получить доступ к отдельным столбцам.

 ## <a name="grid-cell-clicks"></a>Щелчки ячеек сетки
Книги позволяют авторам добавлять интерактивные возможности с помощью специального типа модуля подготовки столбцов сетки, называемого `link renderer`. Модуль подготовки отчетов преобразует ячейку сетки в гиперссылку на основе содержимого ячейки. Книги поддерживают множество типов модулей подготовки отчетов, включая те, которые позволяют открывать колонки обзора ресурсов, средства просмотра контейнеров свойств, поиск в App Insights, использование, трассировку транзакций и т. д.

### <a name="setting-up-interactivity-using-grid-cell-clicks"></a>Настройка взаимодействия с помощью щелчков ячеек сетки
1. Переключите книгу в режим редактирования, щелкнув элемент панели инструментов _изменить_ .
2. Используйте ссылку _Добавить запрос_ , чтобы добавить в книгу элемент управления "запрос журнала". 
3. Выберите тип запроса в поле _Журнал_, тип ресурса (например, Application Insights) и ресурсы для целевого объекта.
4. Использование редактора запросов для ввода ККЛ для анализа
    ```kusto
    requests
    | summarize Count = count(), Sample = any(pack_all()) by Request = name
    | order by Count desc
    ```
5. `Run query` просмотреть результаты
6. Щелкните _Параметры столбца_ , чтобы открыть панель Параметры.
7. В разделе _столбцы_ задайте:
    1. Модуль подготовки к просмотру столбцов: `Link`, представление для открытия: `Cell Details`, метка ссылки: `Sample`
    2. Модуль визуализации столбцов _счетчика_ : `Bar`, цветовая палитра: `Blue`, минимальное значение: `0`
    3. Модуль подготовки столбцов _запросов_ : `Automatic`
    4. Нажмите кнопку _сохранить и закрыть_ , чтобы применить изменения.
8. Щелкните одну из `Sample` ссылок в сетке. Откроется панель свойств с подробными сведениями о примере запроса.

    ![Изображение, показывающее создание интерактивного интерфейса с помощью щелчков ячеек сетки](./media/workbooks-interactive/grid-cell-click-create.png)

### <a name="link-renderer-actions"></a>Действия модуля подготовки ссылок
| Действие ссылки | Действие по щелчку |
|:------------- |:-------------|
| `Generic Details` | Показывает значения строк в колонке контекста в сетке свойств |
| `Cell Details` | Показывает значение ячейки в колонке контекста свойства "Сетка". Полезно, если ячейка содержит динамический тип со сведениями (например, JSON с такими свойствами запроса, как расположение, экземпляр роли и т. д.). |
| `Cell Details` | Показывает значение ячейки в колонке контекста свойства "Сетка". Полезно, если ячейка содержит динамический тип со сведениями (например, JSON с такими свойствами запроса, как расположение, экземпляр роли и т. д.). |
| `Custom Event Details` | Открывает Application Insights сведения о поиске с ИДЕНТИФИКАТОРом пользовательского события (itemId) в ячейке. |
| `* Details` | Аналогично пользовательским сведениям о событии, за исключением зависимостей, исключений, просмотров страниц, запросов и трассировок. |
| `Custom Event User Flows` | Открывает Application Insights Маршруты пользователей возможности, сведенные по имени пользовательского события в ячейке. |
| `* User Flows` | Аналогично Маршруты пользователей пользовательских событий, за исключением исключений, просмотров страниц и запросов |
| `User Timeline` | Открывает временную шкалу пользователя с ИДЕНТИФИКАТОРом пользователя (user_Id) в ячейке |
| `Session Timeline` | Открывает Application Insights поиска для значения в ячейке (например, Поиск текста "ABC", где ABC — это значение в ячейке). |
| `Resource overview` | Откройте Обзор ресурса на портале на основе значения идентификатора ресурса в ячейке. |

## <a name="conditional-visibility"></a>Условная видимость
Книга позволяет пользователям отображать или убирать определенные элементы управления в зависимости от значений параметров. Это позволяет авторам создавать различные отчеты в зависимости от состояния пользовательского ввода или телеметрии. Пример показывает, что пользователи представляют собой сводку, когда все хорошо, но показывают полные сведения, если что-то не так.

### <a name="setting-up-interactivity-using-conditional-visibility"></a>Настройка взаимодействия с помощью условной видимости
1. Выполните действия, описанные в разделе `Setting up interactivity on grid row click`, чтобы настроить два интерактивных элемента управления.
2. Добавьте новый параметр в начало:
    1. Имя: `ShowDetails`.
    2. Тип параметра: `Drop down`
    3. Обязательный: `checked`
    4. Получить данные из: `JSON`
    5. Входные данные JSON: `["Yes", "No"]`
    6. Сохраните для фиксации изменений.
3. Задайте для параметра значение `Yes`
4. В элементе управления запросом с диаграммой с областями щелкните значок _Дополнительные параметры_ (значок шестеренки).
5. Проверьте параметр `Make this item conditionally visible`
    1. Этот элемент отображается, если `ShowDetails` значение параметра `equals` `Yes`
6. Нажмите кнопку _done Edit (Готово_ ), чтобы зафиксировать изменения.
7. Нажмите кнопку _done Edit_ на панели инструментов книги, чтобы перейти в режим чтения.
8. Переключить значение параметра `ShowDetails` на `No`. Обратите внимание, что приведенная ниже диаграмма исчезает.

На рисунке ниже показан видимый случай, когда `ShowDetails` `Yes`

![Изображение, показывающее условную видимость, где отображается диаграмма](./media/workbooks-interactive/conditional-visibility.png)

На рисунке ниже показан скрытый случай, в котором `ShowDetails` `No`

![Изображение, показывающее условную видимость, когда диаграмма скрыта](./media/workbooks-interactive/conditional-invisible.png)

## <a name="next-steps"></a>Дальнейшие действия


* [Узнайте](workbooks-visualizations.md) больше о книгах с множеством разнообразных вариантов визуализации.
* [Управление](workbooks-access-control.md) доступом к ресурсам книги и предоставление общего доступа к ним.
