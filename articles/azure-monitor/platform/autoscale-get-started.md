---
title: Начало работы с автомасштабированием в Azure
description: Узнайте, как масштабировать ресурсы Веб-приложений, Облачных служб, Виртуальных машин и масштабируемых наборов виртуальных машин в Azure.
author: rajram
services: azure-monitor
ms.service: azure-monitor
ms.topic: conceptual
ms.date: 07/07/2017
ms.author: rajram
ms.component: autoscale
ms.openlocfilehash: 0535c84a8ee0776c2c35a46d3c7510a2cd615cf6
ms.sourcegitcommit: 3102f886aa962842303c8753fe8fa5324a52834a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "60788592"
---
# <a name="get-started-with-autoscale-in-azure"></a>Начало работы с автомасштабированием в Azure
В этой статье описывается, как настроить автомасштабирование для ресурса на портале Microsoft Azure.

Автомасштабирование Azure Monitor используется только с [масштабируемыми наборами виртуальных машин](https://azure.microsoft.com/services/virtual-machine-scale-sets/), [облачными службами](https://azure.microsoft.com/services/cloud-services/), [веб-приложениями службы приложений](https://azure.microsoft.com/services/app-service/web/) и [службами управления API](https://docs.microsoft.com/azure/api-management/api-management-key-concepts).

## <a name="discover-the-autoscale-settings-in-your-subscription"></a>Обнаружение параметров автомасштабирования в подписках
Azure Monitor дает возможность обнаружить все ресурсы, для которых можно применить автомасштабирование. Для этой цели вам нужно выполнить следующие действия.

1. Откройте [портал Azure.][1]
1. Щелкните значок Azure на левой панели.
  ![Открытие Azure Monitor][2]
1. Выберите раздел **Автомасштабирование**, чтобы просмотреть все ресурсы, для которых применимо автомасштабирование, и текущее состояние этой настройки для них.
  ![Открытие раздела "Автомасштабирование" в Azure Monitor][3]

Панель фильтрации в верхней части страницы позволяет сузить список до определенной группы ресурсов, отдельных типов ресурсов или одного конкретного ресурса.

Для каждого ресурса вы увидите здесь текущее количество экземпляров и состояние автомасштабирования. Состояние автомасштабирования может принимать одно из перечисленных ниже значений.

- **Не настроено.** Автомасштабирование этого ресурса еще не настроено.
- **Включено.** Автомасштабирование этого ресурса включено.
- **Выключено.** Автомасштабирование этого ресурса выключено.

## <a name="create-your-first-autoscale-setting"></a>Создание параметра автомасштабирования

Теперь выполним простые пошаговые инструкции для создания параметра автомасштабирования.

1. В Azure Monitor откройте колонку **Автомасштабирование** и выберите ресурс, который нужно масштабировать. (В примере ниже используется план службы приложений, связанный с веб-приложением. Вы можете [за пять минут создать первое веб-приложение ASP.NET в Azure][4]).
1. Как видите, текущее количество экземпляров имеет значение 1. Щелкните **Включить автомасштабирование**.
  ![Параметр масштабирования для нового веб-приложения][5]
1. Укажите имя для параметра масштабирования и щелкните **Добавить правило**. Параметры правила масштабирования откроются в виде контекстной области справа. По умолчанию устанавливается следующее правило: количество экземпляров увеличивается на 1, когда загрузка ЦП для ресурса превышает уровень 70 %. Не изменяйте эти значения по умолчанию, а просто нажмите **Добавить**.
  ![Создание параметра масштабирования для веб-приложения][6]
1. Итак, вы создали первое правило масштабирования. В этом же интерфейсе вы увидите некоторые рекомендация по настройке, например: "Рекомендуется настроить не меньше одного правила увеличения масштаба". Для этого выполните следующие действия:

    a. Щелкните **Добавить правило**.

    2. Для параметра **Оператор** установите значение **Меньше, чем**.

    c. Для параметра **Пороговое значение** задайте значение **20**.

    d. Для параметра **Операция** установите значение **Уменьшить счетчик на**.

   Теперь у вас есть параметр масштабирования, который изменяет масштаб в зависимости от показателей загрузки ЦП.
   ![Масштабирование на основе загрузки ЦП][8]
1. Выберите команду **Сохранить**.

Поздравляем! Вы успешно создали первый параметр масштабирования, который будет автомасштабировать веб-приложение, исходя из загрузки ЦП.

> [!NOTE]
> Эти действия можно применить для настройки масштабируемого набора виртуальных машин или ролей облачной службы.

## <a name="other-considerations"></a>Дополнительные рекомендации
### <a name="scale-based-on-a-schedule"></a>Масштабирование на основе расписания
Помимо загрузки ЦП, в параметрах автомасштабирования можно учитывать определенные дни недели.

1. Щелкните **Add a scale condition** (Добавить условие масштабирования).
1. Настройка режима масштабирования и правил выполняется так же, как и для условий по умолчанию.
1. Выберите **Повторять в определенные дни**, чтобы настроить расписание.
1. Выберите дни и время для начала и окончания периода, в который будет применяться условие масштабирования.

![Условие масштабирования на основе расписания][9]
### <a name="scale-differently-on-specific-dates"></a>Масштабирование в определенные даты
Помимо загрузки ЦП, в параметрах автомасштабирования можно учитывать определенные даты.

1. Щелкните **Add a scale condition** (Добавить условие масштабирования).
1. Настройка режима масштабирования и правил выполняется так же, как и для условий по умолчанию.
1. Выберите **Укажите даты начала и окончания**, чтобы настроить расписание.
1. Выберите даты для начала и окончания периода, в который будет применяться условие масштабирования.

![Условие масштабирования на основе дат][10]

### <a name="view-the-scale-history-of-your-resource"></a>Просмотр журнала масштабирования ресурса
Каждый раз, когда масштабируется ресурс, в журнале действий регистрируется событие. Вы можете просмотреть журнал масштабирования ресурса за последние 24 часа, открыв вкладку **Журнал запусков**.

![Выполнения][11]

Если вы хотите просмотреть полный журнал масштабирования (до 90 дней), выберите действие **Щелкните здесь, чтобы просмотреть дополнительные сведения**. Откроется журнал действий автомасштабирования, в котором уже выбраны нужный ресурс и категория.

### <a name="view-the-scale-definition-of-your-resource"></a>Просмотр определения масштабирования для ресурса
Автомасштабирование считается ресурсом Azure Resource Manager. Определение масштабирования можно просмотреть в формате JSON. Для этого откройте вкладку **JSON**.

![Определение масштабирования][12]

При необходимости можно внести изменения в JSON напрямую. Эти изменения будут применены, как только вы их сохраните.

### <a name="disable-autoscale-and-manually-scale-your-instances"></a>Отключение автомасштабирования и масштабирование экземпляров вручную
Иногда необходимо отключить действующий параметр масштабирования и масштабировать ресурс вручную.

Для этого нажмите **Отключить автомасштабирование** в верхней части страницы.
![Отключение автомасштабирования][13]

> [!NOTE]
> Это действие отключает настроенную конфигурацию. Вы всегда можете вернуть прежний режим, включив автомасштабирование.

При отключенном автомасштабировании вы можете вручную задать нужное количество экземпляров.

![Настройка масштабирования вручную][14]

Автомасштабирование можно возобновить в любой момент, щелкнув здесь же **Включить автомасштабирование**, а затем — **Сохранить**.

## <a name="next-steps"></a>Дальнейшие действия
- [Создайте оповещение журнала действий, чтобы отслеживать все операции системы автомасштабирования в подписке](https://github.com/Azure/azure-quickstart-templates/tree/master/monitor-autoscale-alert).
- [Создайте оповещение журнала действий, чтобы отслеживать все сбои автомасштабирования в подписке](https://github.com/Azure/azure-quickstart-templates/tree/master/monitor-autoscale-failed-alert).

<!--Reference-->
[1]:https://portal.azure.com
[2]: ./media/autoscale-get-started/azure-monitor-launch.png
[3]: ./media/autoscale-get-started/discover-autoscale-azure-monitor.png
[4]: https://docs.microsoft.com/azure/app-service/app-service-web-get-started-dotnet
[5]: ./media/autoscale-get-started/scale-setting-new-web-app.png
[6]: ./media/autoscale-get-started/create-scale-setting-web-app.png
[7]: ./media/autoscale-get-started/scale-in-recommendation.png
[8]: ./media/autoscale-get-started/scale-based-on-cpu.png
[9]: ./media/autoscale-get-started/scale-condition-schedule.png
[10]: ./media/autoscale-get-started/scale-condition-dates.png
[11]: ./media/autoscale-get-started/scale-history.png
[12]: ./media/autoscale-get-started/scale-definition-json.png
[13]: ./media/autoscale-get-started/disable-autoscale.png
[14]: ./media/autoscale-get-started/set-manualscale.png
