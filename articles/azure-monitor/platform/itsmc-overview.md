---
title: Соединитель управления ИТ-службами в Azure Log Analytics | Документация Майкрософт
description: В этой статье представлен обзор соединителя управления ИТ-услугами (ITSMC) и сведения о том, как использовать это решение для централизованного мониторинга рабочих элементов ITSM и управления ими в Azure Log Analytics, а также для быстрого устранения каких-либо проблем.
ms.subservice: logs
ms.topic: conceptual
author: nolavime
ms.author: v-jysur
ms.date: 05/24/2018
ms.openlocfilehash: 41aabeeeb151a6e2cf3c52dbfa2075c55f86989f
ms.sourcegitcommit: 6906980890a8321dec78dd174e6a7eb5f5fcc029
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/22/2020
ms.locfileid: "92427307"
---
# <a name="connect-azure-to-itsm-tools-using-it-service-management-connector"></a>Подключение Azure к инструментам ITSM с помощью соединителя управления ИТ-услугами

![Символ соединителя управления ИТ-службами](media/itsmc-overview/itsmc-symbol.png)

Соединитель управления ИТ-услугами (ITSMC) позволяет подключить Azure к поддерживаемым продуктам или службам управления ИТ-услугами.

Службы Azure, такие как Log Analytics и Azure Monitor, предоставляют средства для обнаружения, анализа и устранения неполадок, связанных с ресурсами Azure и сторонними ресурсами. Однако рабочие элементы, с которыми возникают проблемы, обычно находятся в продуктах или службах ITSM. Соединитель ITSM обеспечивает двустороннее подключение между Azure и инструментами ITSM, благодаря чему вы можете устранять проблемы быстрее.

Соединитель управления ИТ-услугами поддерживает подключения к следующим инструментам ITSM:

-   ServiceNow
-   System Center Service Manager;
-   Provance;
-   Cherwell

С помощью ITSMC можно:

-  Создавать рабочие элементы в инструменте ITSM на основе оповещений Azure (например, оповещений о метриках, оповещений журнала действий и Log Analytics).
-  При необходимости синхронизировать данные инцидентов и запросов на изменение из инструмента ITSM с рабочей областью Azure Log Analytics.

Дополнительные сведения о [юридических условиях и политике конфиденциальности](https://go.microsoft.com/fwLink/?LinkID=522330&clcid=0x9).

Вы можете начать использование соединителя ITSM, выполнив следующие шаги:

1.  [Добавьте решение соединителя ITSM](#adding-the-it-service-management-connector-solution).
2.  Создайте подключение ITSM.
3.  [Используйте подключение](#using-the-solution).


##  <a name="adding-the-it-service-management-connector-solution"></a>Добавление решения "Соединитель управления ИТ-службами"

Перед созданием подключения необходимо добавить решение "Соединитель управления ИТ-услугами".

1. На портале Azure щелкните значок **+ Создать**.

   ![Новый ресурс Azure](media/itsmc-overview/azure-add-new-resource.png)

2. Выполните поиск по запросу **Соединитель управления ИТ-службами** в Marketplace и нажмите кнопку **Создать**.

   ![Добавление решения "Соединитель управления ИТ-услугами"](media/itsmc-overview/add-itsmc-solution.png)

3. В разделе **Рабочая область OMS** выберите рабочую область Azure Log Analytics, где нужно установить решение.
   >[!NOTE]
   > * В рамках текущего перехода от Microsoft Operations Management Suite (OMS) к Azure Monitor рабочие области OMS теперь называются рабочими областями Log Analytics.
   > * Соединитель ITSM можно устанавливать в рабочих областях Log Analytics только в следующих регионах: восточная часть США, западная часть США 2, центрально-южная часть США, центрально-западная часть США, Фэрфакс, Центральная Канада, Западная Европа, южная часть Соединенного Королевства, Юго-Восточная Азия, Восточная Япония, Центральная Индия, Юго-Восточная Австралия.

4. В разделе **Параметры рабочей области OMS** выберите группу ресурсов, в которой вы хотите создать решение.

   ![Рабочая область соединителя управления ИТ-услугами](media/itsmc-overview/itsmc-solution-workspace.png)
   >[!NOTE]
   >В рамках текущего перехода от Microsoft Operations Management Suite (OMS) к Azure Monitor рабочие области OMS теперь называются рабочими областями Log Analytics.

5. Нажмите кнопку **Создать**.

Когда ресурс решения будет развернут, вверху окна справа появится уведомление.


## <a name="creating-an-itsm--connection"></a>Создание подключения ITSM

После установки решения можно создать подключение.

Для этого вам необходимо подготовить инструмент ITSM, чтобы разрешить подключение от решения "Соединитель управления ИТ-услугами".  

Выберите продукт ITSM, к которому вы подключаетесь, чтобы выполнить соответствующие шаги:

- [System Center Service Manager](./itsmc-connections.md#connect-system-center-service-manager-to-it-service-management-connector-in-azure);
- [ServiceNow](./itsmc-connections.md#connect-servicenow-to-it-service-management-connector-in-azure)
- [Provance](./itsmc-connections.md#connect-provance-to-it-service-management-connector-in-azure);  
- [Cherwell](./itsmc-connections.md#connect-cherwell-to-it-service-management-connector-in-azure)

Подготовив инструмент ITSM, выполните приведенные ниже шаги, чтобы создать подключение.

1. Перейдите к разделу **Все ресурсы** и найдите элемент **ServiceDesk(имя_вашей_рабочей_области)** .
2. В области слева в разделе **Источники данных рабочей области** щелкните **Подключения ITSM**.
   ![Подключения ITSM](media/itsmc-overview/itsm-connections.png)

   На этой странице отобразится список подключений.
3. Щелкните **Добавить подключение**.

   ![Добавление подключения ITSM](media/itsmc-overview/add-new-itsm-connection.png)

4. Укажите параметры подключения, как описано в статье [Подключение продуктов и служб ITSM с помощью соединителя управления ИТ-услугами (предварительная версия)](./itsmc-connections.md).

   > [!NOTE]
   >
   > По умолчанию ITSMC обновляет данные конфигурации подключения каждые 24 часа. Чтобы обновить данные подключения после любого изменения или обновления шаблона, нажмите кнопку **Синхронизация** на колонке с подключением.

   ![Обновление подключения](media/itsmc-overview/itsmc-connections-refresh.png)


## <a name="using-the-solution"></a>Использование решения
   С помощью решения "Соединитель управления ИТ-услугами" можно создать рабочие элементы на основе оповещений Azure и Log Analytics, а также записей журнала Log Analytics.

## <a name="template-definitions"></a>Определения шаблонов
   Существуют типы **рабочих элементов** , которые могут использовать шаблоны, определяемые средством ITSM.
Использование шаблонов позволяет клиенту определять поля, которые будут автоматически заполнены в соответствии с фиксированными значениями, определенными как часть группы действий. Это определение выполняется в средстве ITSM.
В этих случаях флажок "использовать пользовательский шаблон" позволяет клиенту получать поля полей, которые будут автоматически заполнены в соответствии с фиксированными значениями, определенными как часть группы действий.
   
## <a name="create-itsm-work-items-from-azure-alerts"></a>Создание рабочих элементов ITSM из оповещений Azure

После создания подключения ITSM в инструменте ITSM можно создать рабочие элементы на основе оповещений Azure с помощью **действия ITSM** в **группах действий**.

Группы действий предоставляют модульный и многократно используемый способ активации действий для оповещений Azure. Группы действий можно использовать с оповещениями о метриках, оповещениями журнала действий и Azure Log Analytics на портале Azure.

> [!NOTE]
> После создания подключения ITSM необходимо подождать 30 минут после создания соединителя, который будет создан для процесса синхронизации.
> 

Выполните перечисленные ниже действия.

1. На портале Azure выберите **Монитор**.
2. В левой области щелкните **Группы действий**. Откроется окно **Добавить группу действий**.

    ![Группы действий](media/itsmc-overview/action-groups.png)

3. Предоставьте **Имя** и **ShortName** (Короткое имя) для группы действия. Выберите **группу ресурсов** и **подписку**, в которых необходимо создать группу действий.

    ![Сведения о группах действий](media/itsmc-overview/action-groups-details.png)

4. В списке действий выберите **ITSM** из раскрывающегося меню **Тип действия**. Укажите **имя** действия и щелкните **Изменить сведения**.
5. Выберите **подписку**, в которой расположена рабочая область Log Analytics. Выберите имя **подключения** (имя соединителя ITSM), за которым следует имя рабочей области. Например, MyITSMMConnector(MyWorkspace).

    ![Сведения о действиях ITSM](media/itsmc-overview/itsm-action-details.png)

6. Выберите тип **рабочего элемента** из раскрывающегося меню.

7. Выберите использование существующего шаблона или используйте общий шаблон и заполните поля, необходимые для продукта ITSM.

8. Нажмите кнопку **ОК**.

При создании или изменении правила генерации оповещений Azure используйте группу действий, в которой есть действие ITSM. При активации оповещения в инструменте ITSM будет создан или обновлен рабочий элемент.

> [!NOTE]
>
> Сведения о ценах на действие ITSM см. на [странице цен](https://azure.microsoft.com/pricing/details/monitor/) для групп действий.

> [!NOTE]
>
> Поле краткого описания в определении правила генерации оповещений имеет ограничение в 40 символов при отправке с помощью действия ITSM.


## <a name="visualize-and-analyze-the-incident-and-change-request-data"></a>Визуализация и анализ данных инцидентов и запросов на изменение

В зависимости от конфигурации, выбранной при настройке подключения, соединитель ITSM может синхронизировать данные инцидентов и запросов на изменение за максимум 120 дней. Пример схемы записи журнала для этих данных приведен в [следующем разделе](#additional-information).

Данные инцидентов и запросов на изменение можно визуализировать с помощью информационной панели соединителя ITSM в решении.

![Снимок экрана с Log Analytics](media/itsmc-overview/itsmc-overview-sample-log-analytics.png)

На информационной панели также представлена информация о состоянии соединителя, которую можно использовать в качестве отправной точки анализа любых проблем с подключениями.

Вы также можете визуализировать инциденты, синхронизированные с задействованными компьютерами, в рамках решения "Сопоставление служб".

Служба схемы услуги автоматически обнаруживает компоненты приложений в системах Windows и Linux и сопоставляет взаимодействие между службами. Это решение позволяет рассматривать серверы как взаимосвязанные системы, предоставляющие важные службы. Схема услуги отображает сведения о подключениях между серверами, процессами и портами в любой подключенной по протоколу TCP архитектуре без дополнительной настройки. Пользователям требуется только установить агент. [Подробнее](../insights/service-map.md).

При использовании решения "Сопоставление служб" вы можете просматривать элементы службы поддержки, созданные в решениях ITSM, как показано ниже:

![Снимок экрана с Log Analytics](media/itsmc-overview/itsmc-overview-integrated-solutions.png)

Дополнительные сведения: [Схема услуги](../insights/service-map.md)


## <a name="additional-information"></a>Дополнительные сведения

### <a name="data-synced-from-itsm-product"></a>Данные, синхронизированные из продукта ITSM
Инциденты и запросы на изменение синхронизируются из продукта ITSM с рабочей областью Log Analytics на основе конфигурации подключения.

Ниже приведены примеры данных, собранных соединителем ITSMC.

> [!NOTE]
>
> В зависимости от типа рабочего элемента, импортированного в Log Analytics, **ServiceDesk_CL** содержит указанные ниже поля.

**Рабочий элемент:** **Инциденты**  
ServiceDeskWorkItemType_s="Incident"

**Fields**

- ServiceDeskConnectionName;
- "Идентификатор службы поддержки";
- Состояние
- "Срочность";
- Влияние
- Приоритет
- Escalation (Эскалация);
- Автор
- "Кем разрешено";
- Closed By (Кем закрыто);
- Источник
- Кому назначено
- Категория
- Title
- Описание
- "Дата создания";
- Closed Date (Дата закрытия);
- Resolved Date (Дата разрешения);
- "Дата последнего изменения";
- Компьютер


**Рабочий элемент:** **Запросы на изменение**

ServiceDeskWorkItemType_s="ChangeRequest"

**Fields**
- ServiceDeskConnectionName;
- "Идентификатор службы поддержки";
- Автор
- Closed By (Кем закрыто);
- Источник
- Кому назначено
- Title
- Тип
- Категория
- Состояние
- Escalation (Эскалация);
- Conflict Status (Состояние конфликта);
- "Срочность";
- Приоритет
- Риск
- Влияние
- Кому назначено
- "Дата создания";
- Closed Date (Дата закрытия);
- "Дата последнего изменения";
- Requested Date (Запрошенная дата);
- Planned Start Date (Планируемая дата начала);
- Planned End Date (Планируемая дата окончания);
- Work Start Date (Дата начала работы);
- Work End Date (Дата окончания работы);
- Описание
- Компьютер

## <a name="output-data-for-a-servicenow-incident"></a>Выходные данные инцидента ServiceNow

| Поле Log Analytics | Поле ServiceNow |
|:--- |:--- |
| ServiceDeskId_s| Number |
| IncidentState_s | Состояние |
| Urgency_s |"Срочность"; |
| Impact_s |Влияние|
| Priority_s | Приоритет |
| CreatedBy_s | Opened by (Кем открыто) |
| ResolvedBy_s | "Кем разрешено"|
| ClosedBy_s  | Closed By (Кем закрыто) |
| Source_s| Contact type (Тип контакта) |
| AssignedTo_s | Кому назначено  |
| Category_s | Категория |
| Title_s|  Краткое описание |
| Description_s|  Примечания |
| CreatedDate_t|  Opened (Открыто) |
| ClosedDate_t| closed|
| ResolvedDate_t|"Разрешено"|
| Компьютер  | Элемент конфигурации |

## <a name="output-data-for-a-servicenow-change-request"></a>Выходные данные запроса на изменение ServiceNow

| Log Analytics | Поле ServiceNow |
|:--- |:--- |
| ServiceDeskId_s| Number |
| CreatedBy_s | "Кем запрошено" |
| ClosedBy_s | Closed By (Кем закрыто) |
| AssignedTo_s | Кому назначено  |
| Title_s|  Краткое описание |
| Type_s|  Тип |
| Category_s|  Категория |
| CRState_s|  Состояние|
| Urgency_s|  "Срочность"; |
| Priority_s| Приоритет|
| Risk_s| Риск|
| Impact_s| Влияние|
| RequestedDate_t  | Requested by date |
| ClosedDate_t | Closed Date (Дата закрытия) |
| PlannedStartDate_t  |     Planned Start Date (Планируемая дата начала) |
| PlannedEndDate_t  |   Planned End Date (Планируемая дата окончания) |
| WorkStartDate_t  | Actual start date (Фактическая дата начала) |
| WorkEndDate_t | Actual end date (Фактическая дата окончания)|
| Description_s | Описание |
| Компьютер  | Элемент конфигурации |


## <a name="troubleshoot-itsm-connections"></a>Устранение неполадок с подключениями ITSM
1. Если сбой подключения происходит из пользовательского интерфейса подключенного источника с сообщением **Ошибка при сохранении подключения**, сделайте следующее:
   - При использовании подключений ServiceNow, Cherwell и Provance  
   - проверьте правильность ввода ими пользователя и пароля, а также идентификатора и секрета клиента каждого подключения.  
   - Проверьте наличие необходимых прав в соответствующем продукте ITSM, чтобы установить подключение.  
   - При использовании Service Manager  
   - убедитесь, что веб-приложение успешно развернуто и создано гибридное подключение. Чтобы проверить подключение к локальному компьютеру Service Manager, перейдите по URL-адресу веб-приложения, как описано в документации по установке [гибридного подключения](./itsmc-connections.md#configure-the-hybrid-connection).  

2. Если данные из ServiceNow не синхронизируются с Log Analytics, убедитесь, что экземпляр ServiceNow не находится в спящем режиме. Иногда экземпляры разработки ServiceNow переходят в спящий режим при длительном периоде простоя. В противном случае сообщите о проблеме.
3. Если поступают оповещения Log Analytics, но рабочие элементы не создаются в продукте ITSM либо элементы конфигурации не создаются или не связываются с рабочими элементами или же вам нужны другие сведения общего характера, просмотрите следующие компоненты:
   -  ITSMC: решение показывает сводные данные о подключениях, рабочих элементах, компьютерах и т. д. Щелкните плитку **Состояние соединителя**, чтобы с помощью соответствующего запроса перейти на страницу **Поиск по журналу**. Чтобы получить дополнительные сведения, просмотрите записи журнала, где для параметра ERROR задано значение LogType_S.
   - Страница **Поиск по журналу**: просмотрите сведения об ошибках и другие соответствующие сведения непосредственно с помощью запроса `*`ServiceDeskLog_CL`*`.

## <a name="troubleshoot-service-manager-web-app-deployment"></a>Устранение неполадок развертывания веб-приложения Service Manager
1.  При наличии неполадок с развертыванием веб-приложения проверьте наличие всех необходимых разрешений в подписке, используемой для создания или развертывания ресурсов.
2.  Если во время выполнения [сценария](itsmc-service-manager-script.md) отображается ошибка **Ссылка на объект не указывает на экземпляр объекта**, проверьте значения в разделе **Конфигурация пользователя**.
3.  Если вам не удается создать пространство имен ретранслятора шины обслуживания, убедитесь, в подписке зарегистрирован требуемый поставщик ресурсов. Если он не зарегистрирован, создайте пространство имен ретранслятора служебной шины на портале Azure вручную. Его также можно создать на портале Azure во время создания [гибридного подключения](./itsmc-connections.md#configure-the-hybrid-connection).


## <a name="contact-us"></a>Свяжитесь с нами

Свяжитесь с нами по адресу [omsitsmfeedback@microsoft.com](mailto:omsitsmfeedback@microsoft.com), чтобы оставить отзывы или запросы касательно соединителя управления ИТ-службами.

## <a name="next-steps"></a>Дальнейшие действия
[Подключение продуктов и служб ITSM с помощью соединителя управления ИТ-службами (предварительная версия)](./itsmc-connections.md)

