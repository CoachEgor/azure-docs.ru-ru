---
title: Понять, как работает средство произвольную миграцию для оповещений Azure Monitor
description: Понять, как работает средство миграции оповещения и устранения неполадок.
author: snehithm
ms.service: azure-monitor
ms.topic: conceptual
ms.date: 03/19/2018
ms.author: snmuvva
ms.subservice: alerts
ms.openlocfilehash: 9d872a6d753a206dcfb03761e50e5854db4f146e
ms.sourcegitcommit: 41ca82b5f95d2e07b0c7f9025b912daf0ab21909
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/13/2019
ms.locfileid: "67071591"
---
# <a name="understand-how-the-migration-tool-works"></a>Понять, как работает средство миграции

Как [было объявлено ранее](monitoring-classic-retirement.md), классических оповещений в Azure Monitor будет прекращена в сентябре 2019 (был изначально июля 2019 г). Средства миграции доступен на портале Azure клиентам, кто использовать классические правила генерации оповещений, которые хотят активировать миграции сами.

В этой статье объясняется, как работает средство произвольную миграцию. Здесь также описываются способы устранения некоторых распространенных проблем.

> [!NOTE]
> Даты прекращения использования для переноса классических оповещений было из-за задержки в развертывание средства миграции [расширить до 31 августа 2019](https://azure.microsoft.com/updates/azure-monitor-classic-alerts-retirement-date-extended-to-august-31st-2019/) с изначально было объявлено даты 30 июня 2019 г.

## <a name="which-classic-alert-rules-can-be-migrated"></a>Какие классические правила генерации оповещений можно перенести?

Несмотря на то, что средство можно перенести почти все классические правила генерации оповещений, существуют некоторые исключения. Следующие правила генерации оповещений переноситься не будут, с помощью средства (или во время автоматического переноса в сентября 2019 г.):

- Классические правила генерации оповещений на основе метрик гостевой виртуальной машины (Windows и Linux). См. в разделе [рекомендации для повторного создания такого правила генерации оповещений в новых оповещениях метрик](#guest-metrics-on-virtual-machines) далее в этой статье.
- Классические правила генерации оповещений на основе метрик классического хранилища. См. в разделе [руководство по наблюдению за учетные записи хранения классической](https://azure.microsoft.com/blog/modernize-alerting-using-arm-storage-accounts/).
- Классические правила генерации оповещений на некоторые метрики учетной записи хранения. См. в разделе [сведения](#storage-account-metrics) далее в этой статье.

Если ваша подписка имеет такие классической правила, их необходимо перенести вручную. Так как мы не можем дать автоматической миграции, любые существующие, классические оповещения метрик из этих типов будет продолжать работать до июня 2020 г. Это расширение дает вам время, чтобы переход на новые оповещения. Тем не менее новые классического оповещения могут создаваться после августа 2019.

### <a name="guest-metrics-on-virtual-machines"></a>Метрики гостевой виртуальной машины на виртуальных машинах

Перед созданием нового оповещения на основе метрик для метрик гостевой виртуальной машины, метрики гостевой виртуальной машины должны отправляться в хранилище пользовательских метрик Azure Monitor. Выполните эти инструкции, чтобы включить в параметры диагностики в качестве приемника Azure Monitor.

- [Включение метрик гостевой виртуальной машины для виртуальных машин Windows](collect-custom-metrics-guestos-resource-manager-vm.md)
- [Включение метрик гостевой виртуальной машины для виртуальных машин Linux](collect-custom-metrics-linux-telegraf.md)

После эти шаги будут выполнены, можно создать новые оповещения метрик на метрики гостевой виртуальной машины. И после создания нового оповещения на основе метрик, можно удалить классические оповещения.

### <a name="storage-account-metrics"></a>Метрики учетной записи хранения

За исключением оповещения на основе этих метрик можно перенести все классические оповещения об учетных записях хранения:

- PercentAuthorizationError
- PercentClientOtherError
- PercentNetworkError
- PercentServerOtherError
- PercentSuccess
- PercentThrottlingError
- PercentTimeoutError
- AnonymousThrottlingError
- SASThrottlingError
- ThrottlingError

На основе классического оповещения, правила на основе метрик процента, должны быть перенесены [сопоставление между метрик хранилища старые и новые](https://docs.microsoft.com/azure/storage/common/storage-metrics-migration#metrics-mapping-between-old-metrics-and-new-metrics). Пороговые значения, необходимо соответствующим образом изменить, так как новый доступных метрик является абсолютным.

Классические правила генерации оповещений на AnonymousThrottlingError, SASThrottlingError и ThrottlingError должен быть разделен на две новые оповещения, так как не объединенный показатель, который предоставляет те же функциональные возможности. Пороговые значения, необходимо соответствующим образом адаптировать.

## <a name="rollout-phases"></a>Этапы развертывания

Средство миграции станет доступен на этапах для клиентов, использующих классические правила генерации оповещений. Владельцы подписки будут получать сообщение электронной почты, когда подписка будет готова для переноса с помощью средства.

> [!NOTE]
> Так как средство будет развертываться на этапах, вы можете увидеть, что большая часть ваших подписок еще не готова для переноса на ранних стадиях.

В настоящее время подмножество подписок помечается как готов к миграции. Подмножество включает тех подписок, которые имеют классические правила генерации оповещений только для следующих типов ресурсов. Поддержка дополнительных типов ресурсов будет добавлена в будущих этапов.

- Microsoft.apimanagement/Service
- Microsoft.Batch/batchaccounts
- Microsoft.Cache/redis.
- Microsoft.DataFactory/datafactories
- Microsoft.dbformysql/Servers
- Microsoft.dbforpostgresql/Servers
- Microsoft.eventhub/Namespaces
- Microsoft.Logic/workflows
- Microsoft.Network/applicationgateways
- Microsoft.Network/dnszones
- Microsoft.Network/expressroutecircuits
- Microsoft.Network/loadbalancers
- Microsoft.Network/networkwatchers/connectionmonitors
- Microsoft.Network/publicipaddresses
- Microsoft.Network/trafficmanagerprofiles
- Microsoft.Network/virtualnetworkgateways
- Microsoft.Search/searchservices
- Microsoft.servicebus/Namespaces
- Microsoft.streamanalytics/streamingjobs
- Microsoft.timeseriesinsights/Environments
- Microsoft.Web/hostingenvironments/workerpools
- Microsoft.Web/serverfarms
- Microsoft.web/sites

## <a name="who-can-trigger-the-migration"></a>Кто может активировать миграции?

Любой пользователь, который имеет встроенную роль Monitoring Contributor на уровне подписки можно активировать миграции. Пользователи, имеющие пользовательскую роль со следующими разрешениями можно также активировать миграции:

- */чтение
- Microsoft.Insights/actiongroups/*
- Microsoft.Insights/AlertRules/*
- Microsoft.Insights/metricAlerts/*

## <a name="common-problems-and-remedies"></a>Распространенные проблемы и способы устранения

После того как вы [активировать миграции](alerts-using-migration-tool.md), вы получите по электронной почте на адреса, указанный для уведомления о том, что миграция завершена, или если от вас требуется никаких действий. В этом разделе описываются некоторые общие проблемы и способы их устранения.

### <a name="validation-failed"></a>Сбой проверки

Из-за некоторых последние изменения в классическом правила генерации оповещений в подписке невозможно перенести подписку. Эта проблема является временным. Миграцию можно перезапустить после состояния миграции перемещает **готов к миграции** через несколько дней.

### <a name="policy-or-scope-lock-preventing-us-from-migrating-your-rules"></a>Политики или область блокировки, мы не можем перенос правил

В процессе миграции будут созданы новые оповещения метрик и группы действий, а затем будут удалены классические правила генерации оповещений. Однако есть область действия или политики блокировки препятствует созданию ресурсов. В зависимости от политики или область блокировки некоторые или все правила не могут быть перенесены. Эту проблему можно решить путем временное удаление данной политике или блокировка области и активации миграцию снова.

## <a name="next-steps"></a>Дальнейшие действия

- [Как использовать средство миграции](alerts-using-migration-tool.md)
- [Подготовка к миграции](alerts-prepare-migration.md)
