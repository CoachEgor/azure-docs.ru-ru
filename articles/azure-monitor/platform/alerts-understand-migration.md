---
title: Понять, как добровольное средство миграции оповещений в Azure Monitor работает
description: Понять, как работает средство оповещения миграции и устранить неполадки, если возникнут проблемы.
author: snehithm
ms.service: azure-monitor
ms.topic: conceptual
ms.date: 03/19/2018
ms.author: snmuvva
ms.subservice: alerts
ms.openlocfilehash: a45a0cff606bc854924d5da0841b26e1cb9031bb
ms.sourcegitcommit: 3102f886aa962842303c8753fe8fa5324a52834a
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "60347606"
---
# <a name="understand-how-the-migration-tool-works"></a>Понять, как работает средство миграции

Как [было объявлено ранее](monitoring-classic-retirement.md), классических оповещений в Azure Monitor, прекращается в июля 2019 г. Средство миграции для запуска миграции добровольно доступна на портале Azure и станет доступен для клиентов, использующих классические правила генерации оповещений.

В этой статье пошагово продемонстрирует работе средства произвольную миграцию. Здесь также описываются исправления для некоторых распространенных проблем.

## <a name="which-classic-alert-rules-can-be-migrated"></a>Какие классические правила генерации оповещений можно перенести?

Хотя почти все классические правила генерации оповещений, можно перенести с помощью средства, существуют некоторые исключения. Следующие правила генерации оповещений не будут перенесены с помощью средства (или во время автоматического переноса в июле 2019 г.)

- Классические правила генерации оповещений на основе метрик гостевой виртуальной машины (Windows и Linux). [Инструкции см. в разделе о повторном создании такого правила генерации оповещений в новых оповещениях метрик](#guest-metrics-on-virtual-machines)
- Классические правила генерации оповещений на основе метрик классического хранилища. [См. в руководстве о наблюдении за ваши классические учетные записи хранения](https://azure.microsoft.com/blog/modernize-alerting-using-arm-storage-accounts/)
- Классические правила генерации оповещений на некоторые метрики учетной записи хранения. [Подробное описание ниже](#storage-account-metrics)

Если ваша подписка имеет такие классической правила, остальные правила будут перенесены, но потребуется вручную перенести эти правила. Как мы не можем дать автоматической миграции, все такие существующие классические оповещения метрик будет по-прежнему продолжив работу с июня 2020 времени переход на новые оповещения. Тем не менее новые классического оповещения могут создаваться после июня 2019.

### <a name="guest-metrics-on-virtual-machines"></a>Метрики гостевой виртуальной машины на виртуальных машинах

Чтобы иметь возможность создавать новые оповещения метрик на метрики гостевой виртуальной машины, должны отправляться в хранилище пользовательских метрик Azure Monitor метрики гостевой виртуальной машины. Следуйте инструкциям ниже, чтобы включить в параметры диагностики в качестве приемника Azure Monitor.

- [Включение метрик гостевой виртуальной машины для виртуальных машин Windows](collect-custom-metrics-guestos-resource-manager-vm.md)
- [Включение метрик гостевой виртуальной машины для виртуальных машин Linux](https://docs.microsoft.com/azure/azure-monitor/platform/collect-custom-metrics-linux-telegraf)

По окончании описанные выше действия новые оповещения метрик могут создаваться на метрики гостевой виртуальной машины. После повторного создания новых оповещений метрик классических оповещений могут быть удалены.

### <a name="storage-account-metrics"></a>Метрики учетной записи хранения

Кроме этих оповещений по следующим метрикам можно перенести все классические оповещения об учетных записях хранения:

- PercentAuthorizationError
- PercentClientOtherError
- PercentNetworkError
- PercentServerOtherError
- PercentSuccess
- PercentThrottlingError
- PercentTimeoutError
- AnonymousThrottlingError
- SASThrottlingError

Классические правила генерации оповещений на основе метрик процента будет необходимо перенести на основе [сопоставление между метрик хранилища старые и новые](https://docs.microsoft.com/azure/storage/common/storage-metrics-migration#metrics-mapping-between-old-metrics-and-new-metrics). Пороговые значения, необходимо соответствующим образом изменить, так как новый доступных метрик является абсолютным.

Классические правила генерации оповещений, что AnonymousThrottlingError SASThrottlingError необходимо разделить на две новые оповещения как является не объединенный показатель, который предоставляет те же функциональные возможности. Пороговые значения, необходимо соответствующим образом адаптировать.

## <a name="roll-out-phases"></a>Этапы развертывания

Средство миграции станет доступен на этапах для клиентов, использующих классические правила генерации оповещений. **Владельцы подписки** получит сообщение электронной почты, когда подписка будет готова для переноса с помощью средства.

> [!NOTE]
> Средство разворачивается в этапа, на ранних этапах, можно увидеть, что большая часть ваших подписок еще не готова для переноса.

В настоящее время **подмножества** подписок, которой **только** иметь классические правила генерации оповещений на следующий ресурс, типы, которые помечены как готовые к миграции. Поддержка дополнительных типов ресурсов будет добавлена в будущих этапов.

- Microsoft.apimanagement/Service
- Microsoft.Batch/batchaccounts
- Microsoft.Cache/redis.
- Microsoft.DataFactory/datafactories
- Microsoft.dbformysql/Servers
- Microsoft.dbforpostgresql/Servers
- Microsoft.eventhub/Namespaces
- Microsoft.Logic/workflows
- Microsoft.Network/applicationgateways
- Microsoft.Network/dnszones
- Microsoft.Network/expressroutecircuits
- Microsoft.Network/loadbalancers
- Microsoft.Network/networkwatchers/connectionmonitors
- Microsoft.Network/publicipaddresses
- Microsoft.Network/trafficmanagerprofiles
- Microsoft.Network/virtualnetworkgateways
- Microsoft.Search/searchservices
- Microsoft.servicebus/Namespaces
- Microsoft.streamanalytics/streamingjobs
- Microsoft.timeseriesinsights/Environments
- Microsoft.Web/hostingenvironments/workerpools
- Microsoft.Web/serverfarms
- Microsoft.web/sites

## <a name="who-can-trigger-the-migration"></a>Кто может активировать миграции?

Любой пользователь, который имеет встроенную роль из **Monitoring Contributor** подписке уровня будут иметь возможность запуска миграции. Пользователи с пользовательской роли со следующими разрешениями можно также активировать миграции:

- */чтение
- Microsoft.Insights/actiongroups/*
- Microsoft.Insights/AlertRules/*
- Microsoft.Insights/metricAlerts/*

## <a name="common-issues-and-remediations"></a>Распространенные проблемы и исправления

Когда вы [активировать миграции](alerts-using-migration-tool.md), мы будем использовать адреса электронной почты для уведомлений о завершении миграции, или если есть действие от вас требуется. В следующем разделе описаны некоторые распространенные проблемы и способах их устранения

### <a name="validation-failed"></a>Проверка не пройдена

Из-за некоторых последние изменения в классическом правила генерации оповещений в подписке невозможно перенести подписку. Это временная проблема. Вы можете перезапустить миграции, когда состояние миграции перейдет обратно **готов к миграции** через несколько дней.

### <a name="policyscope-lock-preventing-us-from-migrating-your-rules"></a>Мы не можем перенос правил блокировки политики решения и содержания работ

В процессе миграции будут созданы новые оповещения метрик и группы действий и классические правила генерации оповещений, которые будут удалены (после создания новых правил). Однако есть область действия или политики блокировки препятствует созданию ресурсов. В зависимости от политики или область блокировки некоторые или все правила не могут быть перенесены. Можно устранить эту проблему, временно удаляя политику/блокировки области и запустить миграцию снова.

## <a name="next-steps"></a>Дальнейшие действия

- [Как использовать средство миграции](alerts-using-migration-tool.md)
- [Подготовка к миграции](alerts-prepare-migration.md)
