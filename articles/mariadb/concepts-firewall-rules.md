---
title: Правила брандмауэра - База данных Azure для MariaDB
description: Узнайте об использовании правил брандмауэра для включения подключений к базе данных Azure для сервера MariaDB.
author: ajlam
ms.author: andrela
ms.service: mariadb
ms.topic: conceptual
ms.date: 3/18/2020
ms.openlocfilehash: 743e3f50d747993250399493d97fc2becab19319
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "79532048"
---
# <a name="azure-database-for-mariadb-server-firewall-rules"></a>Правила брандмауэра сервера Базы данных Azure для MariaDB
Брандмауэр запрещает любой доступ к серверу базы данных, пока вы не укажете компьютеры, у которых есть разрешение на доступ. Брандмауэр предоставляет доступ к серверу на основе исходного IP-адреса каждого запроса.

Для настройки брандмауэра можно создать правила брандмауэра, которые указывают диапазон допустимых IP-адресов. Правила брандмауэра можно создавать на уровне сервера.

**Правила брандмауэра** предоставляют клиентам доступ ко всему серверу Базы данных Azure для MariaDB, то есть ко всем базам данных на одном логическом сервере. Правила брандмауэра уровня сервера можно настроить на портале Azure или с помощью команд Azure CLI. Для создания правил брандмауэра уровня сервера необходимо быть владельцем или участником подписки.

## <a name="firewall-overview"></a>Общие сведения о брандмауэре
По умолчанию весь доступ к базам данных на сервере Базы данных Azure для MariaDB блокируется брандмауэром. Чтобы использовать сервер с другого компьютера, сначала необходимо указать одно или несколько правил брандмауэра уровня сервера для обеспечения доступа к этому серверу. Используйте правила брандмауэра, чтобы определить разрешенные диапазоны IP-адресов из Интернета. Правила брандмауэра не повлияют на доступ к самому веб-сайту портала Azure.

Запросы на подключение из Интернета и Azure должны сначала обрабатываться брандмауэром и только потом достигать Базы данных Azure для MariaDB, как показано на следующей схеме:

![Пример рабочего потока брандмауэра](./media/concepts-firewall-rules/1-firewall-concept.png)

## <a name="connecting-from-the-internet"></a>Подключение через Интернет
Правила брандмауэра уровня сервера применяются ко всем базам данных на сервере Базы данных Azure для MariaDB.

Если IP-адрес запроса находится в одном из диапазонов, указанных в правилах брандмауэра уровня сервера, то подключение предоставляется.

Если IP-адрес запроса находится вне диапазонов, указанных в любом из правил брандмауэра уровня базы данных или уровня сервера, то запрос на подключение отклоняется.

## <a name="connecting-from-azure"></a>Подключение из Azure
Рекомендуется найти исходящий IP-адрес любого приложения или службы и разрешить доступ к этим отдельным IP-адресам или диапазонам. Например, вы можете найти исходящий IP-адрес Службы приложений Azure или использовать общедоступный IP, привязанный к виртуальной машине или другому ресурсу (см. ниже информацию о подключении с частным IP виртуальной машины над конечными точками обслуживания). 

Если фиксированный исходящий IP-адрес недоступен для службы Azure, можно рассмотреть возможность подключения всех IP-адресов Центра обработки данных Azure. Эта настройка может быть включена с портала Azure, установив **опцию «Разрешить доступ к службам Azure»** в **ON** из панели **безопасности подключения** и нанеся удар **по сохранению.** Из Azure CLI это эквивалентно установлению правила брандмауэра со стартовым и окончанием адреса, равного 0.0.0.0. Если попытка подключения не разрешена, запрос не поступит на сервер Базы данных Azure для MariaDB.

> [!IMPORTANT]
> Опция **«Разрешить доступ к службам Azure»** настраивает брандмауэр на все соединения из Azure, включая соединения из подписок других клиентов. При выборе этого параметра убедитесь, что используемое имя для входа и разрешения пользователя предоставляют доступ только авторизованным пользователям.
> 

![Настройка разрешения доступа к службам Azure на портале](./media/concepts-firewall-rules/allow-azure-services.png)

### <a name="connecting-from-a-vnet"></a>Подключение из VNet
Чтобы безопасно подключиться к базе данных Azure для сервера MariaDB с VNet, подумайте об использовании [конечных точек службы VNet.](./concepts-data-access-security-vnet.md) 

## <a name="programmatically-managing-firewall-rules"></a>Программное управление правилами брандмауэра
Помимо портала Azure правилами брандмауэра можно управлять программно с помощью Azure CLI. 

Также [см.](./howto-manage-firewall-cli.md)

## <a name="troubleshooting-firewall-issues"></a>Проблемы с устранением брандмауэра
Если доступ к службе сервера Базы данных Microsoft Azure для MariaDB не работает должным образом, необходимо учитывать следующее:

* **Изменения в списке разрешенных адресов еще не вступили в силу.** До того как изменения конфигурации брандмауэра сервера Базы данных Azure для MariaDB вступят в силу, может пройти до пяти минут.

* **Имя для входа не авторизовано, или использован неправильный пароль.** Если имя для входа не имеет разрешений на сервере Базы данных Azure для MariaDB или введен неправильный пароль, подключение к серверу Базы данных Azure для MariaDB отклоняется. Создание параметра брандмауэра только предоставляет клиентам возможность подключения к серверу. Каждый клиент должен предоставить необходимые учетные данные безопасности.

* **Динамический IP-адрес:** при наличии подключения к Интернету с динамическим предоставлением IP-адресов и возникновении проблем с прохождением через брандмауэр попробуйте одно из описанных ниже решений.

   * Попросите поставщика услуг Интернета (ISP) назначить диапазон IP-адресов тем клиентским компьютерам, с которых осуществляется доступ к серверу Базы данных Azure для MariaDB, а затем добавьте диапазон IP-адресов в качестве правила брандмауэра.

   * Получите статические IP-адреса для клиентских компьютеров, а затем добавьте IP-адреса как правила брандмауэра.

* **IP сервера, как представляется, является общедоступным:** Подключение к базе данных Azure для сервера MariaDB направляется через общедоступный шлюз Azure. Однако фактический IP-адрес сервера защищен брандмауэром. Для получения дополнительной информации посетите [статью архитектуры подключения](concepts-connectivity-architecture.md). 

## <a name="next-steps"></a>Дальнейшие действия
- [Создание правил брандмауэра MariaDB в Базе данных Azure для MariaDB и управление ими на портале Azure](./howto-manage-firewall-portal.md)
- [Создание правил брандмауэра Базы данных Azure для MariaDB и управление ими с помощью Azure CLI](./howto-manage-firewall-cli.md)
- [Конечные точки службы VNet в базе данных Azure для MariaDB](./concepts-data-access-security-vnet.md)
