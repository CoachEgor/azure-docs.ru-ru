---
title: Частная ссылка на базу данных Azure для MariaDB (Предварительная версия)
description: Узнайте, как работает частная связь для базы данных Azure для MariaDB.
author: kummanish
ms.author: manishku
ms.service: mariadb
ms.topic: conceptual
ms.date: 01/09/2020
ms.openlocfilehash: 92d7522c8382ded182c5f482df3f3d917b4b3a14
ms.sourcegitcommit: 3dc1a23a7570552f0d1cc2ffdfb915ea871e257c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/15/2020
ms.locfileid: "75982387"
---
# <a name="private-link-for-azure-database-for-mariadb-preview"></a>Частная ссылка на базу данных Azure для MariaDB (Предварительная версия)

Частная ссылка позволяет подключаться к различным службам PaaS в Azure с помощью частной конечной точки. Частная связь Azure, по сути, предоставляет службы Azure в частной виртуальной сети (VNet). Доступ к ресурсам PaaS можно получить, используя частный IP-адрес, как и любой другой ресурс в виртуальной сети.

Чтобы получить список служб PaaS, поддерживающих функции закрытых ссылок, ознакомьтесь с [документацией по](https://docs.microsoft.com/azure/private-link/index)частному каналу. Частная конечная точка — это частный IP-адрес в определенной [виртуальной сети](https://docs.microsoft.com/azure/virtual-network/virtual-networks-overview) и подсети.

> [!NOTE]
> Эта функция доступна во всех регионах Azure, где база данных Azure для MariaDB поддерживает общего назначения и ценовые категории, оптимизированные для памяти.

## <a name="data-exfiltration-prevention"></a>Предотвращение кражи данных

Data ex-фильтрация в базе данных Azure для MariaDB — когда полномочный пользователь, например администратор базы данных, может извлекать данные из одной системы и перемещать их в другое расположение или систему за пределами Организации. Например, пользователь перемещает данные в учетную запись хранения, принадлежащую третьей стороне.

Рассмотрим ситуацию с пользователем, работающим с MariaDB Workbench, в виртуальной машине Azure, которая подключается к экземпляру базы данных Azure для MariaDB. Этот экземпляр MariaDB находится в центре обработки данных в западной части США. В приведенном ниже примере показано, как ограничить доступ с помощью общедоступных конечных точек в базе данных Azure для MariaDB, используя элементы управления доступом к сети.

* Отключите весь трафик службы Azure к базе данных Azure для MariaDB через общедоступную конечную точку, установив флажок Разрешить службам Azure отключать. Убедитесь, что IP-адреса или диапазоны не разрешены для доступа к серверу через [правила брандмауэра](https://docs.microsoft.com/azure/mariadb/concepts-firewall-rules) или [конечные точки службы виртуальной сети](https://docs.microsoft.com/azure/mariadb/concepts-data-access-security-vnet).

* Разрешите трафик только в базу данных Azure для MariaDB, используя частный IP-адрес виртуальной машины. Дополнительные сведения см. в статьях, посвященных [конечной точке службы](concepts-data-access-security-vnet.md) и [правилам брандмауэра виртуальной сети](howto-manage-vnet-portal.md).

* На виртуальной машине Azure Ограничьте область исходящего подключения с помощью групп безопасности сети (группы безопасности сети) и тегов службы следующим образом:

    * Укажите правило NSG, разрешающее трафик для тега службы = SQL. WestUs — разрешает подключение к базе данных Azure для MariaDB в западной части США
    * Укажите правило NSG (с более высоким приоритетом) для запрета трафика для тега службы = SQL — запрет подключений к базе данных MariaDB во всех регионах</br></br>

После завершения установки виртуальная машина Azure может подключаться только к базе данных Azure для MariaDB в регионе "Западная часть США". Однако подключение не ограничено одной базой данных Azure для MariaDB. Виртуальная машина по-прежнему может подключаться к любой базе данных Azure для MariaDB в регионе "Западная часть США", включая базы данных, которые не входят в подписку. Хотя мы сократили масштабы кражи данных в приведенном выше сценарии до определенного региона, мы не полностью устранили ее.</br>

С помощью частного канала теперь можно настроить такие элементы управления доступом к сети, как группы безопасности сети, чтобы ограничить доступ к частной конечной точке. Затем отдельные ресурсы Azure PaaS сопоставляются с конкретными частными конечными точками. Вредоносная программа предварительной оценки может получить доступ только к сопоставленному ресурсу PaaS (например, базе данных Azure для MariaDB) и другим ресурсам.

## <a name="on-premises-connectivity-over-private-peering"></a>Локальные подключения через частный пиринг

При подключении к общедоступной конечной точке из локальных компьютеров необходимо добавить IP-адрес в брандмауэр на основе IP-адресов, используя правило брандмауэра уровня сервера. Хотя эта модель отлично подходит для предоставления доступа к отдельным компьютерам для рабочих нагрузок разработки или тестирования, управлять ею в рабочей среде сложно.

С помощью закрытой ссылки можно включить локальный доступ к частной конечной точке с помощью [Express Route](https://azure.microsoft.com/services/expressroute/) (ER), частного пиринга или [VPN-туннеля](https://docs.microsoft.com/azure/vpn-gateway/). Затем они могут отключить доступ через общедоступную конечную точку и не использовать брандмауэр на основе IP-адресов.

## <a name="configure-private-link-for-azure-database-for-mariadb"></a>Настройка частной ссылки для базы данных Azure для MariaDB

### <a name="creation-process"></a>Процесс создания

Для включения закрытой ссылки требуются частные конечные точки. Это можно сделать с помощью следующих руководств.

* [Портал Azure](https://docs.microsoft.com/azure/mariadb/howto-configure-privatelink-portal)
* [CLI](https://docs.microsoft.com/azure/mariadb/howto-configure-privatelink-cli)

### <a name="approval-process"></a>Процесс утверждения

После того как администратор сети создаст закрытую конечную точку (PE), администратор может управлять подключением к частной конечной точке (PEC) к базе данных Azure для MariaDB.

> [!NOTE]
> Сейчас база данных Azure для MariaDB поддерживает только автоматическое утверждение для частной конечной точки.

* Перейдите к ресурсу сервера базы данных Azure для MariaDB в портал Azure. 
    * Выберите подключения частной конечной точки в левой области.
    * Отображает список всех подключений к частным конечным точкам (ПЕКС)
    * Соответствующая частная конечная точка (PE) создана

![Выбор закрытого портала конечной точки](media/concepts-data-access-and-security-private-link/select-private-link-portal.png)

* Выберите отдельное PEC из списка, щелкнув его.

![Выберите закрытую конечную точку, ожидающие утверждения](media/concepts-data-access-and-security-private-link/select-private-link.png)

* Администратор сервера MariaDB может одобрить или отклонить PEC и при необходимости добавить короткий текст ответа.

![Выберите сообщение частной конечной точки](media/concepts-data-access-and-security-private-link/select-private-link-message.png)

* После утверждения или отклонения список будет отражать соответствующее состояние вместе с текстом ответа.

![выберите конечное состояние частной конечной точки](media/concepts-data-access-and-security-private-link/show-private-link-approved-connection.png)

## <a name="use-cases-of-private-link-for-azure-database-for-mariadb"></a>Варианты использования частной ссылки для базы данных Azure для MariaDB

Клиенты могут подключаться к частной конечной точке из той же виртуальной сети, одноранговой виртуальной сети в том же регионе или через подключение типа "виртуальная сеть — виртуальная сеть" между регионами. Кроме того, клиенты могут подключаться из локальной среды с помощью ExpressRoute, частного пиринга или VPN-туннелирования. Ниже приведена упрощенная схема, на которой показаны распространенные варианты использования.

![Выберите Общие сведения о конечной точке частного назначения](media/concepts-data-access-and-security-private-link/show-private-link-overview.png)

### <a name="connecting-from-an-azure-vm-in-peered-virtual-network-vnet"></a>Подключение из виртуальной машины Azure в одноранговой виртуальной сети (VNet)
Настройте [пиринг виртуальных сетей](https://docs.microsoft.com/azure/virtual-network/tutorial-connect-virtual-networks-powershell) , чтобы установить подключение к базе данных Azure для MariaDB с виртуальной машины Azure в одноранговой виртуальной сети.

### <a name="connecting-from-an-azure-vm-in-vnet-to-vnet-environment"></a>Подключение из виртуальной машины Azure в среде виртуальных сетей
Настройте [подключение VPN-шлюза](https://docs.microsoft.com/azure/vpn-gateway/vpn-gateway-howto-vnet-vnet-resource-manager-portal) между виртуальными сетями, чтобы установить подключение к базе данных Azure для MariaDB с виртуальной машины Azure в другом регионе или в подписке.

### <a name="connecting-from-an-on-premises-environment-over-vpn"></a>Подключение из локальной среды через VPN
Чтобы установить подключение из локальной среды к базе данных Azure для MariaDB, выберите и реализуйте один из следующих вариантов:

* [Подключение "точка — сеть"](https://docs.microsoft.com/azure/vpn-gateway/vpn-gateway-howto-point-to-site-rm-ps)
* [VPN-подключение типа "сеть —сеть"](https://docs.microsoft.com/azure/vpn-gateway/vpn-gateway-create-site-to-site-rm-powershell)
* [Канал ExpressRoute](https://docs.microsoft.com/azure/expressroute/expressroute-howto-linkvnet-portal-resource-manager)

## <a name="private-link-combined-with-firewall-rules"></a>Частная ссылка в сочетании с правилами брандмауэра

При использовании частной ссылки в сочетании с правилами брандмауэра возможны следующие ситуации и результаты.

* Если не настроить какие бы то ни было правила брандмауэра, по умолчанию трафик не будет доступен для базы данных Azure для MariaDB.

* Если вы настраиваете общедоступный трафик или конечную точку службы и создаете частные конечные точки, то соответствующий тип правила брандмауэра разрешается различными типами входящего трафика.

* Если вы не настраиваете общедоступную конечную точку и не создаете частные конечные точки, то база данных Azure для MariaDB доступна только через частные конечные точки. Если не настроить общедоступный трафик или конечную точку службы после того, как все утвержденные частные конечные точки будут отклонены или удалены, трафик не сможет получить доступ к базе данных Azure для MariaDB.

## <a name="next-steps"></a>Дальнейшие действия

Дополнительные сведения о функциях безопасности базы данных Azure для MariaDB см. в следующих статьях:

* Сведения о настройке брандмауэра для базы данных Azure для MariaDB см. в разделе [Поддержка брандмауэра](https://docs.microsoft.com/azure/mariadb/concepts-firewall-rules).

* Чтобы узнать, как настроить конечную точку службы виртуальной сети для базы данных Azure для MariaDB, см. раздел [Настройка доступа из виртуальных сетей](https://docs.microsoft.com/azure/mariadb/concepts-data-access-security-vnet).

* Общие сведения о подключении к базе данных Azure для MariaDB см. в статье [архитектура службы "база данных Azure для MariaDB](https://docs.microsoft.com/azure/MariaDB/concepts-connectivity-architecture) ".
