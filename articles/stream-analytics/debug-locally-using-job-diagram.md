---
title: Отогивание Azure Stream Analytics запрашивает локально с помощью диаграммы заданий в Visual Studio
description: В этой статье описывается, как отладить запросы локально с помощью диаграммы заданий в Azure Stream Analytics Tools for Visual Studio.
author: su-jie
ms.author: sujie
ms.reviewer: mamccrea
ms.service: stream-analytics
ms.topic: conceptual
ms.date: 01/23/2020
ms.openlocfilehash: 106b1f0b765700803d2cd55b5e049fae5be3dfad
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/27/2020
ms.locfileid: "76847203"
---
# <a name="debug-azure-stream-analytics-queries-locally-using-job-diagram-in-visual-studio"></a>Отогивание Azure Stream Analytics запрашивает локально с помощью диаграммы заданий в Visual Studio

Задания, которые не дают результата или неожиданные результаты, являются общими сценариями устранения неполадок для потоковых запросов. Схема задания можно использовать при локальном тестировании запроса в Visual Studio для изучения промежуточного набора результатов и метрик для каждого шага. Диаграммы вакансий могут помочь вам быстро изолировать источник проблемы при устранении неполадок.

## <a name="debug-a-query-using-job-diagram"></a>Отогивание запроса с помощью диаграммы задания

Скрипт Azure Stream Analytics используется для преобразования входных данных в выходные данные. Диаграмма задания показывает, как данные перетекают из входных источников (Event Hub, IoT Hub и т.д.) через несколько этапов запроса и, наконец, в выводят раковины. Каждый шаг запроса отображается в временном `WITH` наборе результатов, определенном в скрипте с помощью оператора. Можно просматривать данные, а также метрики каждого шага запроса в каждом промежуточном наборе результатов, чтобы найти источник проблемы.

> [!NOTE]
> На этой диаграмме задания отображается только данные и метрики для локального тестирования в одном узло. Он не должен использоваться для настройки производительности и устранения неполадок.

### <a name="start-local-testing"></a>Начало локального тестирования

Используйте этот [быстрый запуск,](stream-analytics-quick-create-vs.md) чтобы узнать, как создать работу Stream Analytics с помощью Visual Studio или [экспортировать существующую работу в местный проект.](stream-analytics-vs-tools.md#export-jobs-to-a-project) Если вы хотите протестировать запрос с помощью локальных входных данных, следуйте этим [инструкциям.](stream-analytics-live-data-local-testing.md) Если вы хотите протестировать с живым входом, перейдите к следующему шагу.

> [!NOTE]
> Если вы экспортируете задание в локальный проект и хотите протестировать живой поток ввода, необходимо сначала указать учетные данные для всех входных данных.  

Выберите исходный чат и исходный исход из редактора скриптов и выберите **Выполнить локально.** Диаграмма задания отображается на правой стороне.

### <a name="view-the-intermediate-result-set"></a>Просмотр промежуточного набора результатов  

1. Выберите шаг запроса для навигации по сценарию. Вы автоматически направляетсяе на соответствующий сценарий в редакторе слева.

   ![Диаграмма работы навигации сценарий](./media/debug-locally-using-job-diagram/navigate-script.png)

2. Выберите шаг запроса и выберите **Предварительный просмотр** в диалоге. Набор результатов отображается во вкладке в нижнем окне результата.

   ![Результат предварительного просмотра диаграммы задания](./media/debug-locally-using-job-diagram/preview-result.png)

### <a name="view-step-metrics"></a>Просмотр метрик шагов

В этом разделе вы исследуете метрики, доступные для каждой части диаграммы.

#### <a name="input-sources-live-stream"></a>Входные источники (прямая трансляция)

![Диаграмма работы живые источники ввода](./media/debug-locally-using-job-diagram/live-input.png)

|Метрика|Описание|
|-|-|
|**ТаксиРайд**| Имя входа.|
|**Концентратор событий** | Тип исходного кода ввода.|
|**События**|Количество прочитано событий.|
|**Невыполненные источники событий**|Сколько еще сообщений необходимо прочитать для ввода событийных центров и концентратора IoT.|
|**События в Байтах**|Число переданных байтов.|
| **Деградированные события**|Подсчет событий, которые имели вопрос, кроме десериализации.|
|**Ранние события**| Количество событий, которые имеют отметку времени применения перед высоким водяным знаком.|
|**Поздние события**| Количество событий, которые имеют отметку времени применения после высокого водяного знака.|
|**Источники событий**| Количество считываемых единиц данных. например больших двоичных объектов.|

#### <a name="input-sources-local-input"></a>Входные источники (местные входные ресурсы)

![Диаграмма работы локальных источников ввода](./media/debug-locally-using-job-diagram/local-input.png)

|Метрика|Описание|
|-|-|
|**ТаксиРайд**| Имя входа.|
|**Количество строк**| Количество строк, генерируемых на этапе.|
|**Размер данных**| Размер данных, генерируемых на этом этапе.|
|**Локальный ввод**| Используйте локальные данные в качестве ввода.|

#### <a name="query-steps"></a>Шаги запроса

![Шаг запроса диаграммы задания](./media/debug-locally-using-job-diagram/query-step.png)

|Метрика|Описание|
|-|-|
|**TripData**|Название временного набора результатов.|
|**Количество строк**| Количество строк, генерируемых на этапе.|
|**Размер данных**| Размер данных, генерируемых на этом этапе.|
  
#### <a name="output-sinks-live-output"></a>Поглотители выходов (выход в реальном маштабе времени)

![Диаграмма рабочих местных поглотителей](./media/debug-locally-using-job-diagram/live-output.png)

|Метрика|Описание|
|-|-|
|**regionaggEH**|Имя выхода.|
|**События**|Количество событий, выдающихся в раковины.|

#### <a name="output-sinks-local-output"></a>Поглотители выходов (местный выход)

![Диаграмма рабочих местных поглотителей](./media/debug-locally-using-job-diagram/local-output.png)

|Метрика|Описание|
|-|-|
|**regionaggEH**|Имя выхода.|
|**Местный выход**| Вывод результата в локальный файл.|
|**Количество строк**| Количество строк вывода в локальном файле.|
|**Размер данных**| Размер вывода данных в локальный файл.|

### <a name="close-job-diagram"></a>Близкая диаграмма задания

Если вам больше не нужна диаграмма задания, выберите **Закрыть** в правом верхнем углу. После закрытия окна диаграммы необходимо снова начать локальное тестирование, чтобы увидеть его.

### <a name="view-job-level-metrics-and-stop-running"></a>Просмотр метрик уровня задания и прекращение работы

Другие показатели уровня задания отображаются в всплывающем консоли. Нажмите **на Ctrl'C** в консоли, если вы хотите остановить работу.

![Диаграмма работы остановить работу](./media/debug-locally-using-job-diagram/stop-job.png)

## <a name="limitations"></a>Ограничения

* Мощность BI и Azure Data Lake Storage Gen1 не поддерживается из-за ограничений модели проверки подлинности.

* Для облачных входных данных поддерживаются [политики времени](stream-analytics-out-of-order-and-late-events.md), а для локальных входных данных — нет.

## <a name="next-steps"></a>Дальнейшие действия

* [Краткое руководство. Создание задания Stream Analytics с использованием инструментов Azure Stream Analytics для Visual Studio](stream-analytics-quick-create-vs.md)
* [Просмотр заданий Azure Stream Analytics с помощью Visual Studio](stream-analytics-vs-tools.md)
* [Тестирование реальных данных в локальной среде с помощью инструментов Azure Stream Analytics для Visual Studio (предварительная версия)](stream-analytics-live-data-local-testing.md)
