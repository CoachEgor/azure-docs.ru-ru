---
title: Поиск расположения с помощью служб поиска Azure Maps | Карты Microsoft Azure
description: В этой статье вы узнаете, как искать расположение с помощью Microsoft Azure карт Служба поиска для геокодирования и отмены геокодирования.
author: philmea
ms.author: philmea
ms.date: 01/15/2020
ms.topic: conceptual
ms.service: azure-maps
services: azure-maps
manager: philmea
ms.openlocfilehash: cf0e5267885df1ace51271c53bb2d68ee5002f00
ms.sourcegitcommit: 849bb1729b89d075eed579aa36395bf4d29f3bd9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2020
ms.locfileid: "80335427"
---
# <a name="search-for-a-location-using-azure-maps-search-services"></a>Поиск расположения с помощью служб поиска Azure Maps

Azure Maps [Служба поиска](https://docs.microsoft.com/rest/api/maps/search) — это набор интерфейсов API RESTful, предназначенных для облегчения поиска адресов, мест, Бизнес-вхождений по имени или категории, а также других географических данных. Кроме поддержки традиционной геокодирования, службы также могут обращаться к геокодированным адресам и перекрестным улицы на основе широт и долгот. Значения широты и долготы, возвращаемые функцией поиска, можно использовать в качестве параметров в других Azure Maps службах, таких как [Route](https://docs.microsoft.com/rest/api/maps/route) и [weather](https://docs.microsoft.com/rest/api/maps/weather) Services.

В этой статье вы узнаете, как:

* Запрос координат широты и долготы для адреса (расположение геокода адреса) с помощью [API адреса поиска]( https://docs.microsoft.com/rest/api/maps/search/getsearchaddress)
* Поиск адреса или точки интересов (достопримечательности) с помощью [API нечеткого поиска](https://docs.microsoft.com/rest/api/maps/search/getsearchfuzzy)
* Поиск адреса вместе со свойствами и координатами
* Сделать [обратный поиск адреса](https://docs.microsoft.com/rest/api/maps/search/getsearchaddressreverse) , чтобы перевести координатное расположение на почтовый адрес
* Поиск перекрестной улицы с помощью [интерфейса поиска обратный Крестный адрес API](https://docs.microsoft.com/rest/api/maps/search/getsearchaddressreversecrossstreet)

## <a name="prerequisites"></a>Предварительные условия

Для выполнения действий, описанных в этой статье, необходимо сначала создать учетную запись Azure Maps и сопоставить ключ подписки учетной записи. Следуйте инструкциям в разделе [Создание учетной записи](quick-demo-map-app.md#create-an-account-with-azure-maps) для создания подписки на учетную запись Azure Maps и выполните действия, описанные в разделе [Получение первичного ключа](quick-demo-map-app.md#get-the-primary-key-for-your-account) , чтобы получить первичный ключ для вашей учетной записи. Дополнительные сведения о проверке подлинности в Azure Maps см. в [этой статье](./how-to-manage-authentication.md).

В этой статье для создания вызовов REST используется [приложение Postman](https://www.getpostman.com/apps). Вы можете использовать любую среду разработки API.

## <a name="request-latitude-and-longitude-for-an-address-geocoding"></a>Запрос широты и долготы для адреса (геокодирование)

В этом примере мы используем Azure Maps [получить API адреса поиска](https://docs.microsoft.com/rest/api/maps/search/getsearchaddress) , чтобы преобразовать адрес улицы в координаты широты и долготы. Вы можете передать полный или частичный адрес в API и получить ответ, содержащий подробные свойства адреса, такие как улица, почтовый индекс и страна или регион, а также позиционированные значения в широте и долготе.

Если у вас есть набор адресов для геокодирования, можно использовать [API пакетной службы POST](https://docs.microsoft.com/rest/api/maps/search/postsearchaddressbatch) для отправки пакета запросов в одном вызове API.

1. В окне POST щелкните **создать запрос** | **получить запрос** и назовите **Поиск адреса**.

2. На вкладке Builder (Конструктор) выберите метод HTTP **GET**, введите URL-адрес запроса для конечной точки API и выберите протокол авторизации, если он используется.

![Поиск адреса](./media/how-to-search-for-address/address_search_url.png)

| Параметр | Рекомендуемое значение |
|---------------|------------------------------------------------| 
| Метод HTTP | GET |
| Request URL (URL-адрес запроса) | [https://atlas.microsoft.com/search/address/json?](https://atlas.microsoft.com/search/address/json?) | 
| Авторизация | No Auth (Без авторизации) |

3. Щелкните **Params** (Параметры) и введите следующие пары "ключ — значение", которые будут использоваться в качестве параметров запроса или пути в URL-адресе запроса: 

![Поиск адреса](./media/how-to-search-for-address/address_search_params.png) 

| Клавиши | Значение | 
|------------------|-------------------------| 
| api-version | 1.0 | 
| subscription-key | \<Ваш ключ службы "Карты Azure"\> | 
| query | Броад Стрит 400, Сиэтл, штат Вашингтон, 98109 | 

4. Щелкните **Send** (Отправить), а затем просмотрите текст ответа. 

В этом случае указан запрос с полным адресом и получен один результат в тексте ответа. 

5. В разделе Params (Параметры) замените строку запроса следующим значением. 

    ```plaintext 
        400 Broad, Seattle 
    ``` 

6. Добавьте следующую пару "ключ-значение" в раздел **Параметры** и нажмите кнопку **Отправить**: 

| Клавиши | Значение | 
|-----|------------| 
| typeahead | Да | 

Флажок **typeahead** сообщает API поиска адреса, что нужно обработать запрос как частичные входные данные и вернуть массив прогнозных значений.

## <a name="using-fuzzy-search-api"></a>Использование API нечеткого поиска

Azure Maps[ API нечеткого поиска](https://docs.microsoft.com/rest/api/maps/search/getsearchfuzzy) рекомендуется использовать, если неизвестно, какие данные пользователь вводит для поискового запроса. API сочетает в себе ДОСТОПРИМЕЧАТЕЛЬНОСТИный Поиск и геокодирование в каноническом "однострочном поиске". Например, API-интерфейс может обрабатывать входные данные любой комбинации адреса или токена POI. Ему также можно назначить взвешенное значение с помощью контекстно-зависимой позиции (пары широты или долготы), полностью ограничить с помощью координат и радиуса, а также выполнить без точки привязки геосмещения.

Большинство запросов службы поиска по умолчанию имеют значение `maxFuzzyLevel=1` для улучшения производительности и уменьшения количества необычных результатов. Это значение по умолчанию можно переопределить в зависимости от запроса, используя параметр запроса `maxFuzzyLevel=2` или `3`.

### <a name="search-for-an-address-using-fuzzy-search"></a>Поиск адреса с помощью поиска нечетких соответствий

1. Откройте приложение Postman, в раскрывающемся списке New (Создать) щелкните Create New (Создать) и выберите **запрос GET**. Введите название запроса **поиска нечетких соответствий**, выберите коллекцию или папку, в которую нужно его сохранить, и щелкните **Save** (Сохранить).

2. На вкладке Builder (Конструктор) выберите метод HTTP **GET** и введите URL-адрес запроса для конечной точки API.

    ![Поиск нечетких соответствий](./media/how-to-search-for-address/fuzzy_search_url.png)

    | Параметр | Рекомендуемое значение |
    |---------------|------------------------------------------------|
    | Метод HTTP | GET |
    | Request URL (URL-адрес запроса) | [https://atlas.microsoft.com/search/fuzzy/json?](https://atlas.microsoft.com/search/fuzzy/json?) |
    | Авторизация | No Auth (Без авторизации) |

    Атрибут **json** в URL-адресе пути определяет формат ответа. В этой статье для простоты использования и удобочитаемости используется JSON. Доступные форматы ответа в определении **метода Get поиска нечетких соответствий** можно найти в [справочнике по функциональным API службы Maps](https://docs.microsoft.com/rest/api/maps/search/getsearchfuzzy).

3. Щелкните **Params** (Параметры) и введите следующие пары "ключ — значение", которые будут использоваться в качестве параметров запроса или пути в URL-адресе запроса:

    ![Поиск нечетких соответствий](./media/how-to-search-for-address/fuzzy_search_params.png)

    | Клавиши | Значение |
    |------------------|-------------------------|
    | api-version | 1.0 |
    | subscription-key | \<Ваш ключ службы "Карты Azure"\> |
    | query | пицца |

4. Щелкните **Send** (Отправить), а затем просмотрите текст ответа.

    Неоднозначная строка запроса для "пиццы" вернула 10- [процентный результат](https://docs.microsoft.com/rest/api/maps/search/getsearchpoi#searchpoiresponse) (достопримечательности) в категориях "Пицца" и "Ресторан". Каждый результат возвращает адрес улицы, значения широты и долготы, порт представления и точки входа для расположения.
  
    Результаты для этого запроса различны и не связаны с конкретным эталонным расположением. Можно использовать параметр **Country** , чтобы указать только страны или регионы, для которых ваше приложение нуждается в покрытии. Поведение по умолчанию заключается в поиске по всему миру, потенциально возвращая ненужные результаты.

5. Добавьте следующую пару "ключ-значение" в раздел **Параметры** и нажмите кнопку **Отправить**:

    | Клавиши | Значение |
    |------------------|-------------------------|
    | countrySet | США |
  
    Теперь результаты ограничены кодом страны и запрос возвращает адреса пиццерий в США.
  
    Для получения результатов для указанного места можно запрашивать точку интереса и использовать возвращаемое значение широты и долготы в вызове службы поиска нечетких соответствий. В этом случае служба поиска использовалась для возврата местоположения Space Needle (Сиэтл) и применялись значения широты и долготы, чтобы ориентировать поиск.
  
6. В разделе Params (Параметры) введите следующие пары "ключ — значение" и щелкните **Send** (Отправить).

    ![Поиск нечетких соответствий](./media/how-to-search-for-address/fuzzy_search_latlon.png)
  
    | Клавиши | Значение |
    |-----|------------|
    | lat | 47,620525 |
    | lon | –122,349274 |


## <a name="search-for-a-street-address-using-reverse-address-search"></a>Поиск улицы и номера дома с использованием обратного поиска адреса

Azure Maps [получения поискового интерфейса обратный API]( https://docs.microsoft.com/rest/api/maps/search/getsearchaddressreverse) позволяет переводить координаты (например, 37,786505,-122,3862) в адрес улицы, понятный человеку. Чаще всего это необходимо для отслеживания приложений, в которых вы получаете канал GPS с устройства или ресурса и хотите узнать, в каком адресе находится координата.
Если у вас есть набор координатных расположений для обратного геокодирования, можно использовать [обратный поиск адреса API](https://docs.microsoft.com/rest/api/maps/search/postsearchaddressreversebatch) для отправки пакета запросов в одном вызове API.


1. В окне POST щелкните **создать запрос** | **получить запрос** и назовите его **обратный поиск адреса**.

2. На вкладке Builder (Конструктор) выберите метод HTTP **GET** и введите URL-адрес запроса для конечной точки API.
  
    ![URL-адрес обратного поиска адреса](./media/how-to-search-for-address/reverse_address_search_url.png)
  
    | Параметр | Рекомендуемое значение |
    |---------------|------------------------------------------------|
    | Метод HTTP | GET |
    | Request URL (URL-адрес запроса) | [https://atlas.microsoft.com/search/address/reverse/json?](https://atlas.microsoft.com/search/address/reverse/json?) |
    | Авторизация | No Auth (Без авторизации) |
  
3. Щелкните **Params** (Параметры) и введите следующие пары "ключ — значение", которые будут использоваться в качестве параметров запроса или пути в URL-адресе запроса:
  
    ![Параметры обратного поиска адреса](./media/how-to-search-for-address/reverse_address_search_params.png)
  
    | Клавиши | Значение |
    |------------------|-------------------------|
    | api-version | 1.0 |
    | subscription-key | \<Ваш ключ службы "Карты Azure"\> |
    | query | 47,591180, –122,332700 |
  
4. Щелкните **Send** (Отправить), а затем просмотрите текст ответа.

    Ответ включает основные сведения об адресе Safeco Field.
  
5. Добавьте следующую пару "ключ-значение" в раздел **Параметры** и нажмите кнопку **Отправить**:

    | Клавиши | Значение |
    |-----|------------|
    | number | Да |

    Если параметр [числового](https://docs.microsoft.com/rest/api/maps/search/getsearchaddressreverse) запроса отправляется с запросом, ответ может включать сторону улицы (слева или справа), а также смещение для этого числа.
  
6. Добавьте следующую пару "ключ-значение" в раздел **Параметры** и нажмите кнопку **Отправить**:

    | Клавиши | Значение |
    |-----|------------|
    | returnSpeedLimit | Да |
  
    Если задан параметр запроса [ретурнспидлимит](https://docs.microsoft.com/rest/api/maps/search/getsearchaddressreverse) , ответ возвращает значение предельной скорости.

7. Добавьте следующую пару "ключ-значение" в раздел **Параметры** и нажмите кнопку **Отправить**:

    | Клавиши | Значение |
    |-----|------------|
    | returnRoadUse | Да |

    Если задан параметр запроса [returnRoadUse](https://docs.microsoft.com/rest/api/maps/search/getsearchaddressreverse), в ответе возвращается массив использования пути для обратных геокодов на уровне улицы.

8. Добавьте следующую пару "ключ-значение" в раздел **Параметры** и нажмите кнопку **Отправить**:

    | Клавиши | Значение |
    |-----|------------|
    | roadUse | Да |

    Можно ограничить запрос на обратный геокод определенным типом пути с помощью параметра запроса [роадусе](https://docs.microsoft.com/rest/api/maps/search/getsearchaddressreverse) .
  
## <a name="search-for-cross-street-using-reverse-address-cross-street-search"></a>Поиск перекрестной улицы с помощью обратных адресов Поиск по адресу

1. В окне POST щелкните **создать запрос** | **получить запрос** и присвойте ему имя **обратный адрес для поиска на улице**.

2. На вкладке Builder (Конструктор) выберите метод HTTP **GET** и введите URL-адрес запроса для конечной точки API.
  
    ![Обратный поиск адреса для пересекающей улицы](./media/how-to-search-for-address/reverse_address_search_url.png)
  
    | Параметр | Рекомендуемое значение |
    |---------------|------------------------------------------------|
    | Метод HTTP | GET |
    | Request URL (URL-адрес запроса) | [https://atlas.microsoft.com/search/address/reverse/crossstreet/json?](https://atlas.microsoft.com/search/address/reverse/crossstreet/json?) |
    | Авторизация | No Auth (Без авторизации) |
  
3. Щелкните **Params** (Параметры) и введите следующие пары "ключ — значение", которые будут использоваться в качестве параметров запроса или пути в URL-адресе запроса:
  
    | Клавиши | Значение |
    |------------------|-------------------------|
    | api-version | 1.0 |
    | subscription-key | \<Ваш ключ службы "Карты Azure"\> |
    | query | 47,591180, –122,332700 |
  
4. Щелкните **Send** (Отправить), а затем просмотрите текст ответа.

## <a name="next-steps"></a>Дальнейшие шаги

- Изучите [документацию по Azure Maps Служба поиска REST API](https://docs.microsoft.com/rest/api/maps/search).
- Узнайте о [Azure Maps служба поиска рекомендациях](https://docs.microsoft.com/azure/azure-maps/how-to-use-best-practices-for-search) и о том, как оптимизировать запросы.
