---
title: Руководство. Миграция веб-служб из Google Карт | Microsoft Azure Maps
description: Как перенести веб-службы из Google Карт в Microsoft Azure Maps.
author: rbrundritt
ms.author: richbrun
ms.date: 12/17/2019
ms.topic: tutorial
ms.service: azure-maps
services: azure-maps
manager: cpendle
ms.custom: ''
ms.openlocfilehash: 51c00524c781d9af58f60b36aa3baeb079c6eafa
ms.sourcegitcommit: f9601bbccddfccddb6f577d6febf7b2b12988911
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/12/2020
ms.locfileid: "75910760"
---
# <a name="migrate-web-service-from-google-maps"></a>Миграция веб-службы из Google Карт

Службы Azure и Google Карт предоставляют доступ к пространственным API через веб-службы REST. Интерфейсы API для этих платформ выполняют аналогичные функции, но используют разные соглашения об именовании и объекты ответов.

В приведенной ниже таблице приведены API службы Azure Maps, которые выполняют аналогичные функции для перечисленных API службы Google Карт.

| API-интерфейсы службы Google Карт | API-интерфейсы службы Azure Maps                                                                      |
|-------------------------|---------------------------------------------------------------------------------------------|
| Маршруты              | [Route](https://docs.microsoft.com/rest/api/maps/route)                               |
| Матрица расстояний         | [Матрица маршрута](https://docs.microsoft.com/rest/api/maps/route/postroutematrixpreview) |
| Геокодирование               | [Поиск](https://docs.microsoft.com/rest/api/maps/search)                             |
| Поиск мест           | [Поиск](https://docs.microsoft.com/rest/api/maps/search)                             |
| Автозавершение мест      | [Поиск](https://docs.microsoft.com/rest/api/maps/search)                             |
| Статическая карта              | [Render](https://docs.microsoft.com/rest/api/maps/render/getmapimage)                 |
| Часовой пояс               | [Часовой пояс](https://docs.microsoft.com/rest/api/maps/timezone)                        |

Приведенные ниже API службы в настоящее время недоступны в Azure Maps:

- Elevation
- Географическое положение
- Информация о местах и их фотографии. Номера телефонов и URL-адреса веб-сайтов, доступных в API поиска Azure Maps.
- URL-адреса карт.
- Дороги — данные об ограничении скорости доступны через API-интерфейсы маршрутов и обратного геокодирования в Azure Maps.
- Статическое представление улиц.

Azure Maps имеет несколько дополнительных веб-служб REST, которые могут представлять интерес:

- [Пространственные операции.](https://docs.microsoft.com/rest/api/maps/spatial) Выполнение разгрузки сложных пространственных вычислений и операций, таких как геозонирование, в службу.
- [Дорожное движение.](https://docs.microsoft.com/rest/api/maps/traffic) Предоставление доступа к данным дорожного движения и сведениям о дорожно-транспортных происшествиях в режиме реального времени.

## <a name="geocoding-addresses"></a>Геокодирование адресов

Геокодирование — это преобразование адреса (например, 1 Microsoft Way, Redmond, WA) в координаты (например, долгота: −122,1298, широта: 47,64005). Координаты затем часто используются, чтобы разместить метку на карте или центрировать карту.

Служба Azure Maps предоставляет несколько методов геокодирования адресов:

- [**Геокодирование адресов в свободной форме.** ](https://docs.microsoft.com/rest/api/maps/search/getsearchaddress) Позволяет указать одну строку адреса (например, 1 Microsoft Way, Redmond, WA) и немедленно обработать запрос. Мы рекомендуем использовать этот метод, если нужно быстро выполнить геокодирование отдельных адресов.
- [**Структурированное геокодирование адресов.** ](https://docs.microsoft.com/rest/api/maps/search/getsearchaddressstructured) Позволяет указать части одного адреса, например название улицы, город, страну, почтовый индекс, и немедленно обработать запрос. Мы рекомендуем использовать этот метод, если необходимо быстро выполнить геокодирование отдельных адресов, а данные адреса уже разделены на отдельные части.
- [**Пакетное геокодирование адресов.** ](https://docs.microsoft.com/rest/api/maps/search/postsearchaddressbatchpreview) Позволяет создать запрос, содержащий до 10 000 адресов, и обработать их за определенный период времени. Все адреса будут параллельно геокодированы на сервере. После завершения можно скачать полный результирующий набор. Мы рекомендуем использовать этот метод, чтобы выполнить геокодирование больших наборов данных.
- [**Поиск нечетких соответствий.** ](https://docs.microsoft.com/rest/api/maps/search/getsearchfuzzy) Этот API-интерфейс сочетает выполнение геокодирования адреса с поиском точки интереса. Он принимает строку в свободной форме, которая может быть адресом, местом, ориентиром, точкой интереса или категорией точки интереса, и немедленно обрабатывает запрос. Мы рекомендуем использовать этот API-интерфейс для приложений, в которых пользователь может искать адреса или точки интереса в одном текстовом поле.
- [**Поиск пакетных нечетких соответствий.** ](https://docs.microsoft.com/rest/api/maps/search/postsearchfuzzybatchpreview) Позволяет создать запрос, содержащий до 10 000 адресов, мест, ориентиров или точек интереса, и обработать их за определенный период времени. Все данные будут параллельно обработаны на сервере. После завершения можно скачать полный результирующий набор.

Приведенная ниже таблица содержит параметры API Google Карт и сопоставимые параметры API в Azure Maps.

| Параметр API Google Карт | Сопоставимый параметр API Azure Maps  |
|---------------------------|--------------------------------------|
| `address`                   | `query`                            |
| `bounds`                    | `topLeft` и `btmRight`           |
| `components`                | `streetNumber`<br/>`streetName`<br/>`crossStreet`<br/>`postalCode`<br/>`municipality` — город или другой населенный пункт<br/>`municipalitySubdivision` — округа, городской район или мегаполис<br/>`countrySubdivision` — штат или провинция<br/>`countrySecondarySubdivision` — область<br/>`countryTertiarySubdivision` — район<br/>`countryCode` — двухбуквенный код страны |
| `key`                       | `subscription-key` — ознакомьтесь также с документацией по [аутентификации в Azure Maps](azure-maps-authentication.md). |
| `language`                  | `language` — ознакомьтесь с документацией о [поддерживаемых языках](supported-languages.md).  |
| `region`                    | `countrySet`                       |

Пример использования службы поиска описан [здесь](how-to-search-for-address.md). Обязательно просмотрите [рекомендации по поиску](how-to-use-best-practices-for-search.md).

> [!TIP]
> API геокодирования адресов в свободной форме и поиска нечетких соответствий можно использовать в режиме автозаполнения. Для этого добавьте `&amp;typeahead=true` в URL-адрес запроса. Это сообщит серверу, что входной текст, скорее всего, частичный и запрос перейдет в режим прогнозирования.

## <a name="reverse-geocode-a-coordinate"></a>Обратное геокодирование координат

Обратное геокодирование — это процесс преобразования географических координат (например, долгота: −122,1298, широта: 47,64005) в приблизительный адрес (например, 1 Microsoft Way, Redmond, WA).

Azure Maps предоставляет несколько методов обратного геокодирования:

- [**Обратное геокодирование адресов.** ](https://docs.microsoft.com/rest/api/maps/search/getsearchaddressreverse) Позволяет указать отдельную географическую координату, чтобы получить ее приблизительный адрес, и немедленно обработать запрос.
- [**Обратное геокодирование перекрестков.** ](https://docs.microsoft.com/rest/api/maps/search/getsearchaddressreversecrossstreet) Позволяет указать отдельную географическую координату, чтобы получить информацию о ближайших перекрестках (например, 1-й и основной), и немедленно обработать запрос.
- [**Обратное пакетное геокодирование адресов.** ](https://docs.microsoft.com/rest/api/maps/search/postsearchaddressreversebatchpreview) Позволяет создать запрос, содержащий до 10 000 координат, и обработать его за определенный период времени. Все данные будут параллельно обработаны на сервере. После завершения можно скачать полный результирующий набор.

Приведенная ниже таблица содержит параметры API Google Карт и сопоставимые параметры API в Azure Maps.

| Параметр API Google Карт   | Сопоставимый параметр API Azure Maps   |
|-----------------------------|---------------------------------------|
| `key`                       | `subscription-key` — ознакомьтесь также с документацией по [аутентификации в Azure Maps](azure-maps-authentication.md). |
| `language`                  | `language` — ознакомьтесь с документацией о [поддерживаемых языках](supported-languages.md).  |
| `latlng`                    | `query`  |
| `location_type`             | *Н/Д*     |
| `result_type`               | `entityType`    |

Обязательно просмотрите [рекомендации по поиску](how-to-use-best-practices-for-search.md).

API обратного геокодирования службы Azure Maps имеет некоторые дополнительные функции, недоступные в Google Картах, которые можно использовать для выполнения интеграции при миграции приложения:

- функция для получения сведений об ограничении скорости;
- функция для получения сведений о дороге: является ли она дорогой местного значения, магистральной, с ограниченным движением, на открытых работах и т. д.;
- функция для определения стороны улицы заданных координат.

## <a name="search-for-points-of-interest"></a>Поиск точек интереса

Данные о точке интереса можно искать в Google Картах с помощью API поиска мест. Этот API предоставляет три разных способа поиска точек интереса:

- **Поиск места исходя из текста.** Позволяет выполнить поиск точек интереса на основе имени, адреса или номера телефона.
- **Поиск поблизости.** Позволяет выполнить поиск точек интереса, которые находятся на определенном расстоянии от расположения.
- **Текстовый поиск.** Позволяет выполнить поиск мест с помощью текста в свободной форме, который содержит сведения о точках интересов и расположении. Например, "пицца в Нью-Йорке" или "рестораны рядом с главной улицей".

Azure Maps предоставляет несколько API поиска для точек интереса:

- [**Поиск точек интереса.** ](https://docs.microsoft.com/rest/api/maps/search/getsearchpoi) Позволяет выполнить поиск интересов по названию. Например, Starbucks.
- [**Поиск точек интереса по категориям.** ](https://docs.microsoft.com/rest/api/maps/search/getsearchpoicategory) Позволяет выполнить поиск интересов по категориям. Например, "ресторан".
- [**Поиск поблизости.** ](https://docs.microsoft.com/rest/api/maps/search/getsearchnearby) Позволяет выполнить поиск точек интереса, которые находятся на определенном расстоянии от расположения.
- [**Поиск нечетких соответствий.** ](https://docs.microsoft.com/rest/api/maps/search/getsearchfuzzy) Этот API-интерфейс сочетает выполнение геокодирования адреса с поиском точки интереса. Он принимает строку в свободной форме, которая может быть адресом, местом, ориентиром, точкой интереса или категорией точки интереса, и немедленно обрабатывает запрос. Мы рекомендуем использовать этот API-интерфейс для приложений, в которых пользователь может искать адреса или точки интереса в одном текстовом поле.
- [**Поиск по геометрическим данным.** ](https://docs.microsoft.com/rest/api/maps/search/postsearchinsidegeometry) Позволяет выполнить поиск точек интереса, которые находятся в пределах заданных геометрических данных (многоугольника).
- [**Поиск вдоль маршрута.** ](https://docs.microsoft.com/rest/api/maps/search/postsearchalongroute) Позволяет выполнить поиск точек интересов, которые находятся вдоль заданного маршрута.
- [**Поиск пакетных нечетких соответствий.** ](https://docs.microsoft.com/rest/api/maps/search/postsearchfuzzybatchpreview) Позволяет создать запрос, содержащий до 10 000 адресов, мест, ориентиров или точек интереса, и обработать их за определенный период времени. Все данные будут параллельно обработаны на сервере. После завершения можно скачать полный результирующий набор.

В настоящее время Azure Maps не имеет API, сопоставимого с API текстового поиска Google Карт.

> [!TIP]
> API поиска точек интереса, точек интереса по категориям и нечетких соответствий можно использовать в режиме автозаполнения. Для этого добавьте `&amp;typeahead=true` в URL-адрес запроса. Это сообщит серверу, что входной текст, скорее всего, частичный и запрос перейдет в режим прогнозирования.

Обязательно просмотрите [рекомендации по поиску](how-to-use-best-practices-for-search.md).

### <a name="find-place-from-text"></a>Поиск места исходя из текста

Чтобы найти точки интереса по имени или адресу, можно использовать API [поиска точек интереса](https://docs.microsoft.com/rest/api/maps/search/getsearchpoi) и [поиска нечетких соответствий](https://docs.microsoft.com/rest/api/maps/search/getsearchfuzzy) Azure Maps.

Приведенная ниже таблица содержит параметры API Google Карт и сопоставимые параметры API в Azure Maps.

| Параметр API Google Карт | Сопоставимый параметр API Azure Maps |
|---------------------------|-------------------------------------|
| `fields`                  | *Н/Д*                               |
| `input`                   | `query`                             |
| `inputtype`               | *Н/Д*                               |
| `key`                     | `subscription-key` — ознакомьтесь также с документацией по [аутентификации в Azure Maps](azure-maps-authentication.md). |
| `language`                | `language` — ознакомьтесь с документацией о [поддерживаемых языках](supported-languages.md).  |
| `locationbias`            | `lat`, `lon`и `radius`<br/>`topLeft` и `btmRight`<br/>`countrySet`  |

### <a name="nearby-search"></a>Поиск поблизости

API [поиска поблизости](https://docs.microsoft.com/rest/api/maps/search/getsearchnearby) позволяет получить данные о ближайших точках интереса.

Приведенная ниже таблица содержит параметры API Google Карт и сопоставимые параметры API в Azure Maps.

| Параметр API Google Карт | Сопоставимый параметр API Azure Maps  |
|---------------------------|--------------------------------------|
| `key`                       | `subscription-key` — ознакомьтесь также с документацией по [аутентификации в Azure Maps](azure-maps-authentication.md). |
| `keyword`                   | `categorySet` и `brandSet`        |
| `language`                  | `language` — ознакомьтесь с документацией о [поддерживаемых языках](supported-languages.md).  |
| `location`                  | `lat` и `lon`                     |
| `maxprice`                  | *Н/Д*                               |
| `minprice`                  | *Н/Д*                               |
| `name`                      | `categorySet` и `brandSet`        |
| `opennow`                   | *Н/Д*                               |
| `pagetoken`                 | `ofs` и `limit`                   |
| `radius`                    | `radius`                            |
| `rankby`                    | *Н/Д*                               |
| `type`                      | `categorySet –` ознакомьтесь с документацией о [поддерживаемых категориях поиска](supported-search-categories.md).   |

## <a name="calculate-routes-and-directions"></a>Вычисление маршрутов и направлений

С помощью Azure Maps можно вычислить маршруты и направления. Azure Maps обладает большинством аналогичных функций, что и служба маршрутизации Google Карт, например:

- функция вычисления времени прибытия и отправления;
- функция вычисления маршрутов дорожного движения в реальном времени на основе прогнозирования;
- различные режимы передвижения: на автомобиле, пешком, на велосипеде.

> [!NOTE]
> Azure Maps требует, чтобы все пункты маршрута были в виде координат. Сначала необходимо выполнить геокодирование адресов.

Служба маршрутизации Azure Maps предоставляет следующие API для вычисления маршрутов:

- [**Вычисление маршрута.** ](https://docs.microsoft.com/rest/api/maps/route/getroutedirections) Позволяет вычислить маршрут и немедленно обработать запрос. Этот API поддерживает запросы GET и POST. Мы рекомендуем применять запросы POST при указании большого количества ориентиров или использовании большого количества вариантов маршрута. Это гарантирует, что запрос URL-адреса не будет слишком длинным и не приведет к проблемам.
- [**Пакетные запросы маршрутов.** ](https://docs.microsoft.com/rest/api/maps/route/postroutedirectionsbatchpreview) Позволяет создать запрос, содержащий до 1000 запросов маршрута, и обработать их за определенный период времени. Все данные будут параллельно обработаны на сервере. После завершения можно скачать полный результирующий набор.
- [**Службы мобильности.** ](https://docs.microsoft.com/rest/api/maps/mobility) Позволяют вычислить маршруты и направления, используя информацию об общедоступном транспорте.

Приведенная ниже таблица содержит параметры API Google Карт и сопоставимые параметры API в Azure Maps.

| Параметр API Google Карт    | Сопоставимый параметр API Azure Maps  |
|------------------------------|--------------------------------------|
| `alternatives`                 | `maxAlternatives`                  |
| `arrival_time`                | `arriveAt`                          |
| `avoid`                        | `avoid`                            |
| `departure_time`              | `departAt`                          |
| `destination`                  | `query` — координаты в формате `"lat0,lon0:lat1,lon1…."`.  |
| `key`                          | `subscription-key` — ознакомьтесь также с документацией по [аутентификации в Azure Maps](azure-maps-authentication.md). |
| `language`                     | `language` — ознакомьтесь с документацией о [поддерживаемых языках](supported-languages.md).   |
| `mode`                         | `travelMode`                       |
| `optimize`                     | `computeBestOrder`                 |
| `origin`                       | `query`                            |
| `region`                       | *Н/Д* — это функция, связанная с геокодированием. Используйте параметр *countrySet* вместе с API геокодирования Azure Maps.  |
| `traffic_model`               | *Н/Д* — может только указать, следует ли использовать данные дорожного движения с параметром *traffic*. |
| `transit_mode`                | Ознакомьтесь с документацией о [службах мобильности](https://docs.microsoft.com/rest/api/maps/mobility). |
| `transit_routing_preference` | Ознакомьтесь с документацией о [службах мобильности](https://docs.microsoft.com/rest/api/maps/mobility). |
| `units`                        | *Н/Д* — Azure Maps использует только систему метрик.  |
| `waypoints`                    | `query`                            |

> [!TIP]
> По умолчанию API построения маршрута Azure Maps возвращает только сводку (расстояние и время) и координаты путей маршрута. Параметр `instructionsType` позволяет получить пошаговые инструкции, а параметр `routeRepresentation` — отфильтровать сводку и пути маршрута.

API построения маршрута службы Azure Maps содержит множество дополнительных функций, недоступных в Google Картах, которые можно использовать для выполнения интеграции при миграции приложения:

- Поддержка типа маршрута: самый короткий, самый быстрый, прогулочный и маршрут для экономии топлива.
- Поддержка дополнительных режимов перемещений: на автобусе, мотоцикле, такси, грузовике и фургоне.
- Поддержка 150 ориентиров.
- Вычисление нескольких значений времени поездки в одном запросе: с учетом исторического, текущего дорожного движения и без учета дорожного движения.
- Возможность избежать дополнительных типов дорог: транзитных, грунтовых дорог и дорог, по которым вы уже путешествовали.
- Возможность указать специальные области, которых следует избегать.
- Возможность ограничить максимальную высоту маршрута.
- Построение маршрута на основе характеристик мотора. Вычисляйте маршруты для автомобилей с двигателями внутреннего сгорания или электрических автомобилей на основе данных об их оставшемся топливе и заряде, а также характеристик мотора.
- Поддержка параметров построения маршрута для грузовых автомобилей на основе размера, веса автомобиля, количества осей и типа груза.
- Возможность указать максимальную скорость автомобиля.

Кроме того, служба построения маршрутов в Azure Maps поддерживает [вычисление маршрутизируемых диапазонов](https://docs.microsoft.com/rest/api/maps/route/getrouterange), также известных как изохроны, которые создают многоугольник, охватывающий область, к которой можно добраться любым путем из начальной точки за указанный период времени или на оставшемся топливе или заряде.

## <a name="retrieve-a-map-image"></a>Получение изображения карты

Azure Maps предоставляет API для отрисовки статических изображений карт с наложением данных. API [отрисовки изображений карты](https://docs.microsoft.com/rest/api/maps/render/getmapimagerytile) Azure можно сравнить с API статических карт в Google Картах.

> [!NOTE]
> Для службы Azure Maps необходимо иметь координаты центра, всех меток и расположений путей в виде "долгота,широта", тогда как в службе Google Карт используется формат "широта,долгота". Сначала необходимо выполнить геокодирование адресов.

Приведенная ниже таблица содержит параметры API Google Карт и сопоставимые параметры API в Azure Maps.

| Параметр API Google Карт | Сопоставимый параметр API Azure Maps  |
|---------------------------|--------------------------------------|
| `center`                    | `center`                           |
| `format`                    | `format` — этот параметр указывается как часть URL адреса. Сейчас поддерживается только формат PNG. |
| `key`                       | `subscription-key` — ознакомьтесь также с документацией по [аутентификации в Azure Maps](azure-maps-authentication.md). |
| `language`                  | `language` — ознакомьтесь с документацией о [поддерживаемых языках](supported-languages.md).  |
| `maptype`                   | `layer` и `style`. Ознакомьтесь с документацией о [поддерживаемых стилях карт](supported-map-styles.md). |
| `markers`                   | `pins`                             |
| `path`                      | `path`                             |
| `region`                    | *Н/Д* — это функция, связанная с геокодированием. Используйте параметр `countrySet` вместе с API геокодирования Azure Maps.  |
| `scale`                     | *Н/Д*                              |
| `size`                      | `width` и `height` могут иметь размер до 8192 x 8192. |
| `style`                     | *Н/Д*                              |
| `visible`                   | *Н/Д*                              |
| `zoom`                      | `zoom`                             |

> [!NOTE]
> Azure Maps использует мозаичную систему с фрагментами, которые вдвое больше фрагментов карты в Google Картах. Таким образом, значение уровня масштаба в Azure Maps будет на один уровень больше по сравнению с Google Картами. Уменьшите масштаб в перемещаемых запросах на один уровень, чтобы компенсировать разницу.

Дополнительные сведения см. в статье [Render custom data on a raster map](how-to-render-custom-data.md) (Отображение пользовательских данных на растровой карте).

Кроме возможности создания статического изображения карты, служба отрисовки Azure Maps предоставляет возможность прямого доступа к фрагментам карты в растровом (PNG) и векторном форматах:

- [**Фрагмент карты.** ](https://docs.microsoft.com/rest/api/maps/render/getmaptile) Извлечение растровых (PNG) и векторных фрагментов для базовых карт (дорог, территориальных границ и дальних зон).
- [**Фрагмент снимков карты.** ](https://docs.microsoft.com/rest/api/maps/render/getmapimagerytile) Извлечение фрагментов аэро- и спутниковых снимков.

> [!TIP]
> Многие приложения Google Карт несколько лет назад стали использовать статические изображения карт вместо интерактивных, чтобы сократить затраты. Зачастую в Azure Maps выгоднее использовать интерактивный элемент управления картой в веб-пакете SDK, так как плата взимается в зависимости от загрузки фрагментов карты. В Azure Maps используются большие фрагменты карт. Как правило, чтобы повторно создать то же представление карты, требуются лишь некоторые из них, так как статические карты и их фрагменты автоматически кэшируются в браузере. Таким образом, интерактивный элемент управления картой часто создает лишь часть транзакции при воспроизведении статического представления карты. При панорамировании и масштабировании будут загружаться дополнительные фрагменты, однако в элементе управления картой есть параметры, позволяющие при необходимости отключить это поведение. Интерактивный элемент управления картой также предоставляет гораздо больше параметров визуализации, чем службы статических карт.

### <a name="marker-url-parameter-format-comparison"></a>Сравнение формата параметра URL-адреса метки

**До: Google Карты**

В Google Картах метки можно добавить к статическому изображению карты с помощью параметра `markers` в URL-адресе. Параметр `markers` принимает стиль и список расположений для прорисовки на карте в этом стиле:

```
&markers=markerStyles|markerLocation1|markerLocation2|...
```

Чтобы использовать дополнительные стили, можно добавить в URL-адрес параметр `markers` с другими стилем и набором расположений.

Расположения меток задаются в формате "широта,долгота".

Стили меток в Google Картах добавляются в формате `optionName:value` с разделением разных стилей вертикальной линией (\|), например optionName1:value1\|optionName2:value2. Обратите внимание, что название и значение параметра разделены двоеточием (:). Чтобы задать стили меток в Google Картах, можно использовать следующие параметры стилей:

- `color` — цвет стандартного значка метки. Это может быть 24-разрядный шестнадцатеричный цвет (`0xrrggbb`) или одно из следующих значений: `black`, `brown`, `green`, `purple`, `yellow`, `blue`, `gray`, `orange`, `red`, `white`.
- `label` — одиночный буквенно-цифровой символ верхнего регистра, отображаемый на значке.
- `size` — размер метки. Возможные значения: `tiny`, `mid` или `small`.

Пользовательские значки можно также размещать в Google Картах, используя следующие параметры стиля:

- `anchor` — определяет способ приведения изображения значка в соответствие с координатами. Можно указать пиксельное значение (x, y) или одно из следующих: `top`, `bottom`, `left`, `right`, `center`, `topleft`, `topright`, `bottomleft` или `bottomright`.
- `icon` — URL-адрес, указывающий на изображение значка.

Например, в Google Картах можно добавить на карту красную метку средних размеров в точке с координатами (долгота: −110, широта: 45) с использованием следующего параметра URL-адреса:

```
&markers=color:red|size:mid|45,-110
```

<center>

![Метка Google Карт](media/migrate-google-maps-web-services/google-maps-marker.png)</center>

**После: Azure Maps**

В Azure Maps метки можно также добавить на статическое изображение карты, указав параметр `pins` в URL-адресе. Как и в случае с Google Картами, в этом параметре можно указать стиль и список расположений. Параметр `pins` можно указать несколько раз для поддержки меток с различными стилями.

```
&pins=iconType|pinStyles||pinLocation1|pinLocation2|...
```

Чтобы использовать дополнительные стили, можно добавить в URL-адрес параметр `pins` с другими стилем и набором расположений.

Однако для расположения геометок в Azure Maps необходимо указать координаты в формате "долгота,широта", тогда как в службе Google Карт используется формат "широта,долгота". Обратите также внимание, что в Azure Maps значения долготы и широты разделены запятыми, а не пробелами.

Значение `iconType` указывает тип создаваемой геометки и может иметь следующие значения:

- `default` — стандартный значок метки.
- `none` — значок не отображается, будут отображаться только метки.
- `custom` — указывает используемый пользовательский значок. URL-адрес, указывающий на изображение значка, можно добавить в конец параметра `pins` после сведений о расположении геометки.
- `{udid}` — уникальный идентификатор данных значка, хранящегося на платформе хранилища данных Azure Maps.

Стили геометок в Azure Maps добавляются в формате `optionNameValue` с несколькими стилями, разделенными вертикальной линией (\|), например `iconType|optionName1Value1|optionName2Value2`. Обратите внимание, что название и значение параметра не разделены двоеточием. Чтобы задать стили меток в Azure Maps, можно использовать следующие параметры стилей:

- `al` — задает уровень непрозрачности (альфа-версия) метки. Может иметь значение от 0 до 1.
- `an` — задает привязку геометки. Значения пикселей X и Y указываются в формате "x y".
- `co` — цвет геометки. Должен быть 24-разрядный шестнадцатеричный цвет: от `000000` до `FFFFFF`.
- `la` — указывает привязку метки. Значения пикселей X и Y указываются в формате "x y".
- `lc` — цвет метки. Должен быть 24-разрядный шестнадцатеричный цвет: от `000000` до `FFFFFF`.
- `ls` — размер метки в пикселях. Может иметь значение больше 0.
- `ro` — значение в градусах для поворота значка. Может иметь значение от −360 до 360.
- `sc` — значение масштаба значка геометки. Может иметь значение больше 0.

Вместо одного значения метки, которое применяется ко всем меткам в списке расположений, значения метки указываются для каждого расположения геометки. Значение метки может быть строкой из нескольких символов и быть заключенным в одинарные кавычки. Это гарантирует, что оно не будет ошибочно использоваться в качестве значения стиля или расположения.

Например, в Azure Maps добавить красный (`FF0000`) стандартный значок с меткой "Space Needle", расположенный ниже (15 50) значка, в точке с координатами (долгота: −122,349300, широта: 47,620180) можно с помощью следующего параметра URL-адреса:

```
&pins=default|coFF0000|la15 50||'Space Needle' -122.349300 47.620180
```

<center>

![Метка Azure Maps](media/migrate-google-maps-web-services/azure-maps-marker.png)</center>

В следующем примере добавляются три геометки со значениями меток 1, 2 и 3:

```
&pins=default||'1'-122 45|'2'-119.5 43.2|'3'-121.67 47.12
```

<center>

![Несколько меток в Azure Maps](media/migrate-google-maps-web-services/azure-maps-multiple-markers.png)</center>

### <a name="path-url-parameter-format-comparison"></a>Сравнение формата параметра URL-адреса пути

**До: Google Карты**

В Google Картах линии и многоугольники можно добавить на статическое изображение карты, указав параметр `path` в URL-адресе. Параметр `path` принимает стиль и список расположений для прорисовки на карте в этом стиле:

```
&path=pathStyles|pathLocation1|pathLocation2|...
```

Чтобы использовать дополнительные стили, можно добавить в URL-адрес параметр `path` с другими стилем и набором расположений.

Расположения путей в Google Картах указываются в формате `latitude1,longitude1|latitude2,longitude2|…`. Пути могут быть закодированы или содержать адреса для точек.

Стили путей в Google Картах добавляются в формате `optionName:value` с несколькими стилями, разделенными вертикальной линией (\|), например `optionName1:value1|optionName2:value2`. Обратите внимание, что название и значение параметра разделены двоеточием (:). Чтобы задать стили путей в Google Картах, можно использовать следующие параметры стилей:

- `color` — цвет контура пути или многоугольника. Можно указать 24-разрядный шестнадцатеричный цвет (`0xrrggbb`), 32-разрядный шестнадцатеричный цвет (`0xrrggbbbaa`) или одно из следующих значений: black, brown, green, purple, yellow, blue, gray, orange, red, white.
- `fillColor` — цвет заливки области пути (многоугольника). Можно указать 24-разрядный шестнадцатеричный цвет (`0xrrggbb`), 32-разрядный шестнадцатеричный цвет (`0xrrggbbbaa`) или одно из следующих значений: black, brown, green, purple, yellow, blue, gray, orange, red, white.
- `geodesic` — указывает, является ли путь линией, следующей за кривизной земли.
- `weight` — толщина линии пути в пикселях.

Например, в Google Картах красную линию с 50 % прозрачностью и толщиной в 4 пикселя можно добавить на карту между координатами долготы и широты (−110, 45 и −100, 50) с помощью следующего параметра URL-адреса:

```
&path=color:0xFF000088|weight:4|45,-110|50,-100
```

<center>

![Ломаная линия в Google Картах](media/migrate-google-maps-web-services/google-maps-polyline.png)</center>

**После: Azure Maps**

В Azure Maps линии и прямоугольники можно также добавить на статическое изображение карты, указав параметр `path` в URL-адресе. Как и в случае с Google Картами, в этом параметре можно указать стиль и список расположений. Параметр `path` можно указать несколько раз для отображения нескольких кругов, линий и многоугольников с различными стилями.

```
&path=pathStyles||pathLocation1|pathLocation2|...
```

Однако для расположения путей в Azure Maps необходимо указать координаты в формате "долгота,широта", тогда как в службе Google Карт используется формат "широта,долгота". Обратите также внимание, что в Azure Maps значения долготы и широты разделены запятыми, а не пробелами. Azure Maps не поддерживает закодированные пути или адреса для точек. Большие наборы данных можно загрузить в качестве заливки GeoJSON в API хранилища данных Azure Maps, как описано [здесь](how-to-render-custom-data.md#get-data-from-azure-maps-data-storage).

Стили путей в Azure Maps добавляются в формате `optionNameValue` с несколькими стилями, разделенными вертикальной линией (\|), например `optionName1Value1|optionName2Value2`. Обратите внимание, что название и значение параметра не разделены двоеточием. Чтобы задать стили путей в Azure Maps, можно использовать следующие параметры стилей:

- `fa` — прозрачность цвета заливки (альфа-версия), используемая при отрисовке многоугольников. Может иметь значение от 0 до 1.
- `fc` — цвет заливки, используемый для отрисовки области многоугольника.
- `la` — прозрачность цвета линии (альфа-версия), используемая при отрисовке линий и контуров многоугольников. Может иметь значение от 0 до 1.
- `lc` — цвет линии, используемый при отрисовке линий и контуров многоугольников.
- `lw` — ширина линии в пикселях.
- `ra` — указывает радиус круга в метрах.

Например, в Azure Maps красную линию с 50 % прозрачностью и толщиной в 4 пикселя можно добавить на карту между координатами долготы и широты (−110, 45 и −100, 50) с помощью следующего параметра URL-адреса:

```
&path=lcFF0000|la.5|lw4||-110 45|-100 50
```

<center>

![Ломаная линия в Azure Maps](media/migrate-google-maps-web-services/azure-maps-polyline.png)</center>

## <a name="calculate-a-distance-matrix"></a>Вычисление матрицы расстояний

Azure Maps предоставляет API для вычисления времени и расстояния поездки между несколькими расположениями в виде матрицы расстояний. API матрицы расстояний Azure Maps можно сравнить с API матрицы расстояний в Google Картах.

- [**Матрица маршрута.** ](https://docs.microsoft.com/rest/api/maps/route/postroutematrixpreview) Асинхронно вычисляет время и расстояния поездки для набора исходных мест и мест назначения. Поддерживается до 700 ячеек на запрос (количество исходных мест, умноженное на количество мест назначения). Учитывая это ограничение, примерами возможных матричных измерений могут быть такие: 700 x 1, 50 x 10, 10 x 10, 28 x 25, 10 x 70.

> [!NOTE]
> Запрос к API матрицы расстояний можно выполнить только с использованием запроса POST, содержащего в своем тексте сведения об исходном месте и месте назначения. Кроме того, для Azure Maps необходимо предоставить координаты всех исходных мест и мест назначения. Сначала необходимо выполнить геокодирование адресов.

Приведенная ниже таблица содержит параметры API Google Карт и сопоставимые параметры API в Azure Maps.

| Параметр API Google Карт      | Сопоставимый параметр API Azure Maps  |
|--------------------------------|--------------------------------------|
| `arrivial_time`                | `arriveAt`                           |
| `avoid`                        | `avoid`                              |
| `depature_time`                | `departAt`                           |
| `destinations`                 | `destination` — указывается в тексте запроса POST в формате GeoJSON. |
| `key`                          | `subscription-key` — ознакомьтесь также с документацией по [аутентификации в Azure Maps](azure-maps-authentication.md). |
| `language`                     | `language` — ознакомьтесь с документацией о [поддерживаемых языках](supported-languages.md).  |
| `mode`                         | `travelMode`                         |
| `origins`                      | `origins` — указывается в тексте запроса POST в формате GeoJSON.  |
| `region`                       | *Н/Д* — это функция, связанная с геокодированием. Используйте параметр `countrySet` вместе с API геокодирования Azure Maps. |
| `traffic_model`                | *Н/Д* — может только указать, следует ли использовать данные дорожного движения с параметром `traffic`. |
| `transit_mode`                 | *Н/Д* — матрицы расстояний на основе общественного транспорта в настоящее время не поддерживаются.  |
| `transit_routing_preference`   | *Н/Д* — матрицы расстояний на основе общественного транспорта в настоящее время не поддерживаются.  |
| `units`                        | *Н/Д* — Azure Maps использует только систему метрик. |

> [!TIP]
> Все дополнительные параметры построения маршрутов, доступные в API построения маршрутов Azure Maps (построение маршрутов для грузовика, характеристики мотора, области, которые следует избегать…), поддерживаются в API матрицы расстояний Azure Maps.

## <a name="get-a-time-zone"></a>Получение часового пояса

Azure Maps предоставляет API для получения часового пояса, в котором расположена указанная координата. API часового пояса Azure Maps сравним с API часового пояса в Google Картах:

- [**Часовой пояс по координатам.** ](https://docs.microsoft.com/rest/api/maps/timezone/gettimezonebycoordinates) Укажите координаты и получите сведения о часовом поясе, в котором они находятся.

Приведенная ниже таблица содержит параметры API Google Карт и сопоставимые параметры API в Azure Maps.

| Параметр API Google Карт | Сопоставимый параметр API Azure Maps   |
|---------------------------|---------------------------------------|
| `key`                       | `subscription-key` — ознакомьтесь также с документацией по [аутентификации в Azure Maps](azure-maps-authentication.md).       |
| `language`                  | `language` — ознакомьтесь с документацией о [поддерживаемых языках](supported-languages.md).    |
| `location`                  | `query`             |
| `timestamp`                 | `timeStamp`         |

Кроме того, платформа Azure Maps также предоставляет ряд дополнительных API часовых поясов, позволяющих выполнять преобразования названий и идентификаторов часовых поясов:

- [**Часовой пояс по идентификатору.** ](https://docs.microsoft.com/rest/api/maps/timezone/gettimezonebyid) Возвращает сведения о текущем, прошлом и будущем часовом поясе для указанного идентификатора часового пояса IANA.
- [**Перечисление часовых поясов IANA.** ](https://docs.microsoft.com/rest/api/maps/timezone/gettimezoneenumiana) Возвращает полный список идентификаторов часовых поясов IANA. Обновления службы IANA отражаются в системе в течение одного дня.
- [**Перечисление часовых поясов Windows.** ](https://docs.microsoft.com/rest/api/maps/timezone/gettimezoneenumwindows) Возвращает полный список идентификаторов часовых поясов Windows.
- [**Часовой пояс версии IANA.** ](https://docs.microsoft.com/rest/api/maps/timezone/gettimezoneianaversion) Возвращает текущий номер версии IANA, используемый Azure Maps.
- [**Часовой пояс IANA для Windows.** ](https://docs.microsoft.com/rest/api/maps/timezone/gettimezonewindowstoiana) Возвращает соответствующий идентификатор IANA с учетом допустимого идентификатора часового пояса Windows. Для одного идентификатора Windows может быть возвращено несколько идентификаторов IANA.

## <a name="client-libraries"></a>Клиентские библиотеки

Azure Maps предоставляет клиентские библиотеки для следующих языков:

- JavaScript, TypeScript, Node.js — [документация](how-to-use-services-module.md) \| [пакет NPM](https://www.npmjs.com/package/azure-maps-rest).

Клиентские библиотеки с открытым кодом для других языков:

- .NET Standard 2.0 — [проект GitHub](https://github.com/perfahlen/AzureMapsRestServices) \| [пакет NuGet](https://www.nuget.org/packages/AzureMapsRestToolkit/).

## <a name="additional-resources"></a>Дополнительные ресурсы

Ниже приведены ссылки на ресурсы по службам REST Azure Maps.

- [Рекомендации по использованию службы поиска Azure Maps](how-to-use-best-practices-for-search.md)
- [Поиск адреса с помощью службы поиска Azure Maps](how-to-search-for-address.md)
- [Справочная документация по API службы REST Azure Maps](https://docs.microsoft.com/rest/api/maps/)

## <a name="next-steps"></a>Дальнейшие действия

Дополнительные сведения о службах REST Azure Maps.

> [!div class="nextstepaction"]
> [Рекомендации по использованию службы поиска Azure Maps](how-to-use-best-practices-for-search.md)

> [!div class="nextstepaction"]
> [Сведения об использовании модуля служб Azure Maps](how-to-use-services-module.md)

> [!div class="nextstepaction"]
> [Примеры кода](https://docs.microsoft.com/samples/browse/?products=azure-maps)