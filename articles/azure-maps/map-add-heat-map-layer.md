---
title: Добавление слоя тепловой карты в Azure Maps | Документация Майкрософт
description: Сведения о добавлении слоя тепловой карты на карту Javascript
author: rbrundritt
ms.author: richbrun
ms.date: 12/2/2018
ms.topic: conceptual
ms.service: azure-maps
services: azure-maps
manager: ''
ms.custom: codepen
ms.openlocfilehash: 82a6d6b2af7df91696844b09fb7650c547cb6bd1
ms.sourcegitcommit: 61c8de2e95011c094af18fdf679d5efe5069197b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "62108640"
---
# <a name="add-a-heat-map-layer"></a>Добавление слоя тепловой карты

Тепловая карта, которую также называют картой точек плотности, это тип визуализации данных для представления плотности данных с помощью диапазона цветов. Такие визуализации часто используются для отображения "горячих точек" данных на карте, и они особенно полезны, чтобы преобразовывать для просмотра набор данных больших точек.  Например Подготовка к просмотру десятки тысяч точек в представлении карты как символы, охватывает большую часть области карты и привело бы много символов, перекрывающиеся друга, что затрудняет получить более глубокое понимание данных. Если же те же данные будут отображаться на тепловой карте, вы сможете легко заметить области максимальной или относительно низкой плотности относительно других областей карты. Тепловые карты используются в разных сценариях. Вот лишь несколько примеров.

* В формате тепловой карты очень удобно отображать данные о температурах, так как она предоставляет приблизительные значения данных между двумя точками.
* Отображение сведений от датчиков шума в виде тепловой карты не только позволяет оценить уровень шума в точке установки датчика, но и дает некоторое представление о снижении шума на расстоянии. Уровень шума на одном сайте относительно невелик, но близкое расположение таких областей повышает уровень шума в датчиках перекрытия. Возможно, что область с перекрытием имеет более высокие уровни чувствительности к шуму, и таким образом они появятся на тепловой карте.
* Визуализация GPS трассировку, содержащую скорость виде взвешенного высоту карты, где интенсивность каждой точки данных основана на скорость — это отличный способ см. в разделе, где ускорения автомобиля.

> [!TIP]
> Слои тепловой карты по умолчанию преобразовывают координаты всех геометрических объектов в источнике данных. Чтобы ограничить на уровне, таким образом, он только подготавливает к просмотру точки функции класса geometry, `filter` свойства слоя, чтобы `['==', ['geometry-type'], 'Point']` или `['any', ['==', ['geometry-type'], 'Point'], ['==', ['geometry-type'], 'MultiPoint']]` Если вы хотите включить также MultiPoint функции.

## <a name="add-a-heat-map-layer"></a>Добавление слоя тепловой карты

Чтобы преобразовать источник данных точек в виде тепловой карты, передайте этот источник данных в экземпляр класса `HeatMapLayer` и добавьте его на карту, как показано в следующем примере.

<br/>

<iframe height='500' scrolling='no' title='Простой слой тепловой карты' src='//codepen.io/azuremaps/embed/gQqdQB/?height=500&theme-id=0&default-tab=js,result&embed-version=2&editable=true' frameborder='no' allowtransparency='true' allowfullscreen='true' style='width: 100%;'>Изучите фрагмент кода <a href='https://codepen.io/azuremaps/pen/gQqdQB/'>простого слоя тепловой карты</a>, опубликованный для Azure Maps (<a href='https://codepen.io/azuremaps'>@azuremaps</a>) в репозитории <a href='https://codepen.io'>CodePen</a>.
</iframe>

В этом примере каждая точка тепловой карты имеет радиус 10 пикселей на любом уровне масштабирования. При добавлении слоя карты тепловой карты, в этом примере помещает его под уровнем метки для создания удобства работы пользователя как метки четко видны выше тепловой карты. Находится источник данных в этом образце [USGS землетрясения опасности программы](https://earthquake.usgs.gov/) и представляет значительные землетрясения, произошедших за последние 30 дней.

## <a name="customizing-the-heat-map-layer"></a>Настройка слоя тепловой карты

В предыдущем примере настройка тепловой карты заключалась в установке параметров радиуса и прозрачности. Слой тепловой карты предоставляет несколько параметров для настройки.

* `radius`: определяет радиус в пикселях для отрисовки каждой точки данных. Радиус определяется как фиксированное число или выражение. С помощью выражения, можно масштабировать radius, в зависимости от уровня масштабирования, который отображается для представления согласованные пространственных области на карте (например, 5 миль).
* `color`: определяет параметры цвета для тепловой карты. Градиентная часто используется для тепловых карт и можно добиться с помощью `interpolate` выражение. С помощью `step` выражения для выделения цветом тепловая карта разбивает плотность визуально в диапазоны, поэтому более похожий на карту стиль контура или Лепестковая. Эти цветовые палитры определяют цвета в диапазоне от минимальной до максимальной плотности. Значения цветов для тепловых карт указываются в виде выражения для значения `heatmap-density`. Цвет с индексом 0 в выражении интерполяции или цвет по умолчанию выражение шага, определяет цвет области, где нет данных и может использоваться для определения цвета фона. Многие пользователи предпочитают использовать для этого прозрачный или полупрозрачный черный цвет. Вот несколько примеров выражений для определения цвета.

| Выражение цвета интерполяции | Выражение для ступенчатой палитры | 
|--------------------------------|--------------------------|
| \[<br/>&nbsp;&nbsp;&nbsp;&nbsp;'interpolate',<br/>&nbsp;&nbsp;&nbsp;&nbsp;\['linear'\],<br/>&nbsp;&nbsp;&nbsp;&nbsp;\['heatmap-density'\],<br/>&nbsp;&nbsp;&nbsp;&nbsp;0, 'transparent',<br/>&nbsp;&nbsp;&nbsp;&nbsp;0.01, 'purple',<br/>&nbsp;&nbsp;&nbsp;&nbsp;0.5, '#fb00fb',<br/>&nbsp;&nbsp;&nbsp;&nbsp;1, '#00c3ff'<br/>\] | \[<br/>&nbsp;&nbsp;&nbsp;&nbsp;'step',<br/>&nbsp;&nbsp;&nbsp;&nbsp;\['heatmap-density'\],<br/>&nbsp;&nbsp;&nbsp;&nbsp;'transparent',<br/>&nbsp;&nbsp;&nbsp;&nbsp;0.01, 'navy',<br/>&nbsp;&nbsp;&nbsp;&nbsp;0,25, «зеленый»,<br/>&nbsp;&nbsp;&nbsp;&nbsp;0,50, «желтый»,<br/>&nbsp;&nbsp;&nbsp;&nbsp;значение 0,75, «красный»<br/>\] | 

* `opacity`: указывает степень непрозрачности слоя тепловой карты.
* `intensity`: Применяется множитель вес каждой точки данных, чтобы повысить общую интенсивность тепловой карты и помогающий сделать небольшие различия в вес стало проще визуализировать точек данных.
* `weight`: по умолчанию все точки данных имеют вес 1, то есть равный вес. Параметр weight используется в качестве множителя. Для него можно использовать фиксированное число или выражение. Если в параметре weight используется число, например 2, плотность каждой точки удваивается, как если бы она была нанесена на карту дважды. Фиксированное число в качестве значения параметра weight изменяет тепловую карту точно так же, как изменение параметра intensity. Тем не менее если используется выражение, вес каждой точки данных могут быть основаны на свойствах каждой точки данных. Например, в данных землетрясения каждая точка данных представляет землетрясение. Важная метрика в каждой точке данных землетрясения — это значение величины. Землетрясения происходят постоянно, но большинство из них имеют низкую магнитуду и практически не заметны. С помощью значение величины в выражении назначить вес для каждого данных точки позволит существенно землетрясения лучше представляются в тепловой карты.
* Кроме параметров базового слоя, минимального и максимального масштаба, видимости и фильтра, есть еще параметр `source`, который позволяет обновлять источник данных и параметр `source-layer`, если источник данных является источником векторных фрагментов.

Это средство позволяет проверить разные настройки для слоя тепловой карты.

<br/>

<iframe height='700' scrolling='no' title='Параметры слоя тепловой карты' src='//codepen.io/azuremaps/embed/WYPaXr/?height=700&theme-id=0&default-tab=result' frameborder='no' allowtransparency='true' allowfullscreen='true' style='width: 100%;'>Просмотрите фрагмент кода с <a href='https://codepen.io/azuremaps/pen/WYPaXr/'>параметрами слоя тепловой карты</a> для службы Azure Maps (<a href='https://codepen.io/azuremaps'>@azuremaps</a>), размещенный в репозитории <a href='https://codepen.io'>CodePen</a>.
</iframe>

## <a name="consistent-zoomable-heat-map"></a>Согласованное масштабируемым тепловая карта

По умолчанию радиус точек данных к просмотру в слое тепловой карты имеют фиксированного значения в пикселях radius для всех уровней масштаба. Как карты развернуто выглядит вместе совокупностями данных и слой тепловой карты. Объект `zoom` выражение можно использовать для масштабирования radius для каждого уровня масштаба, таким образом, что каждая точка данных охватывает одной физической области карты. Это сделает слой карты рисков выглядеть более статические и согласованными. Каждый уровень масштаба карты пиксели в два раза по вертикали и горизонтали как к прежнему масштабу. Таким образом, чтобы он удваивается с каждым уровнем масштабирования, масштабирование радиус создаст тепловая карта, которая выглядит согласованно на всех уровнях масштабирования. Это можно сделать с помощью `zoom` по основанию 2 `exponential interpolation` выражения, как показано в приведенном ниже примере. Масштабировать карту, чтобы увидеть, как масштабируется тепловая карта с уровня масштабирования.

<br/>

<iframe height="500" style="width: 100%;" scrolling="no" title="Согласованное масштабируемым тепловая карта" src="//codepen.io/azuremaps/embed/OGyMZr/?height=500&theme-id=light&default-tab=js,result" frameborder="no" allowtransparency="true" allowfullscreen="true">
См. в разделе пера <a href='https://codepen.io/azuremaps/pen/OGyMZr/'>согласованные масштабируемым тепловая карта</a> по "карты Azure" (<a href='https://codepen.io/azuremaps'>@azuremaps</a>) на <a href='https://codepen.io'>CodePen</a>.
</iframe>

> [!TIP]
> При включенной кластеризации для источника данных, расположенные близко друг к другу точки данных группируются в кластеризованые точки. Число точек в каждом кластере можно использовать в выражении веса для тепловой карты. Такой подход позволяет значительно сократить число отображаемых точек. Счетчик точки кластера хранится в `point_count` свойства компонента точки, как показано ниже. 
> ```JavaScript
> var layer = new atlas.layer.HeatMapLayer(datasource, null, {
>    weight: ['get', 'point_count']
> });
> ```
> Если радиус кластеризации составляет несколько пикселей, визуальные различия будут минимальными. Больший радиус означает группирование большего числа точек в каждом кластере, что повысит производительность тепловой карты, но одновременно создаст более заметные визуальные различия.

## <a name="next-steps"></a>Дальнейшие действия

Дополнительные сведения о классах и методах, которые используются в этой статье:

> [!div class="nextstepaction"]
> [HeatMapLayer](https://docs.microsoft.com/javascript/api/azure-maps-control/atlas.htmlmarker?view=azure-iot-typescript-latest)

> [!div class="nextstepaction"]
> [HeatMapLayerOptions](https://docs.microsoft.com/javascript/api/azure-maps-control/atlas.heatmaplayeroptions?view=azure-iot-typescript-latest)

Дополнительные примеры кода для добавления в карты см. в следующих статьях:

> [!div class="nextstepaction"]
> [Добавление слоя символов](./map-add-pin.md)

> [!div class="nextstepaction"]
> [Использование стилистических выражений на основе данных](data-driven-style-expressions-web-sdk.md)