---
title: Добавление или удаление ролевых заданий для внешних пользователей с помощью RBAC и портала Azure
description: Узнайте, как предоставить доступ к ресурсам Azure для пользователей, не внее чем организация, использующее элемент управления доступом на основе ролей Azure (RBAC).
services: active-directory
documentationcenter: ''
author: rolyon
manager: mtillman
editor: ''
ms.assetid: ''
ms.service: role-based-access-control
ms.devlang: ''
ms.topic: conceptual
ms.tgt_pltfrm: ''
ms.workload: identity
ms.date: 11/25/2019
ms.author: rolyon
ms.reviewer: skwan
ms.custom: it-pro
ms.openlocfilehash: 1c440b85f792ac5bb1336f4d20f930aafc38ad7d
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "79245646"
---
# <a name="add-or-remove-role-assignments-for-external-guest-users-using-azure-rbac-and-the-azure-portal"></a>Добавление или удаление ролевых заданий для внешних гостевых пользователей с помощью Azure RBAC и портала Azure

[Контроль доступа на основе ролей Azure (RBAC)](overview.md) позволяет лучше управлять безопасностью для крупных организаций и для малых и средних предприятий, работающих с внешними сотрудниками, поставщиками или фрилансерами, которым необходим доступ к определенным ресурсам в вашей среде, но не обязательно ко всей инфраструктуре или любым областям, связанным с выставлением счетов. Вы можете использовать возможности [в Azure Active Directory B2B](../active-directory/b2b/what-is-b2b.md) для совместной работы с внешними гостевыми пользователями, а также RBAC для предоставления только разрешений, которые нужны гостевым пользователям в вашей среде.

## <a name="prerequisites"></a>Предварительные требования

Чтобы добавить или удалить назначения ролей, необходимо:

- `Microsoft.Authorization/roleAssignments/write` и `Microsoft.Authorization/roleAssignments/delete`, такие как [Администратор доступа пользователей](built-in-roles.md#user-access-administrator) или [Владелец](built-in-roles.md#owner).

## <a name="when-would-you-invite-guest-users"></a>Когда вы пригласите приглашенных пользователей?

Вот несколько примеров сценариев, когда вы можете пригласить приглашенных пользователей в организацию и предоставить разрешения:

- предоставление доступа к ресурсам Azure для определенного проекта внешнему независимому поставщику, у которого есть только учетная запись электронной почты;
- Разрешить внешнему партнеру управлять определенными ресурсами или всей подпиской.
- предоставление доступа к ресурсам Azure инженерам службы поддержки, не входящей в вашу организацию (например, службе поддержки Майкрософт) для устранения неполадок.

## <a name="permission-differences-between-member-users-and-guest-users"></a>Различия в разрешении между пользователями-членами и гостевыми пользователями

Коренные члены каталога (пользователи-члены) имеют различные разрешения, чем пользователи, приглашенные из другого каталога в качестве гостя совместной работы B2B (гость-пользователи). Например, пользователь-пользователь может прочитать почти всю информацию каталога, в то время как гостевые пользователи ограничили разрешения каталога. Для получения дополнительной информации о пользователях-членах и гостевых пользователях [смотрите, что такое пользовательские разрешения по умолчанию в Active Directory Azure?.](../active-directory/fundamentals/users-default-permissions.md)

## <a name="add-a-guest-user-to-your-directory"></a>Добавление гостевого пользователя в каталог

Выполните следующие действия, чтобы добавить гостевого пользователя в каталог с помощью страницы Active Directory Azure.

1. Убедитесь, что внешние настройки совместной работы вашей организации настроены таким образом, чтобы вы могли приглашать гостей. Для получения дополнительной информации [см.](../active-directory/b2b/delegate-invitations.md)

1. На портале Azure щелкните**пользователей** >  **Azure Active Directory** > **Новый гость**.

    ![Новая функция гостевого пользователя на портале Azure](./media/role-assignments-external-users/invite-guest-user.png)

1. Выполните последующие действия, чтобы добавить нового гостевого пользователя. Для получения дополнительной информации на [портале Azure можно добавить пользователей совместной работы Azure Active Directory B2B.](../active-directory/b2b/add-users-administrator.md#add-guest-users-to-the-directory)

После добавления гостевого пользователя в каталог вы можете отправить ему прямую ссылку на общее приложение или он может щелкнуть URL-адрес активации в электронном письме с приглашением.

![Гостевой пользователь приглашает по электронной почте](./media/role-assignments-external-users/invite-email.png)

Для того, чтобы гость мог получить доступ к вашему каталогу, он должен завершить процесс приглашения.

![Гостевой пользователь приглашает на получение разрешений на отзыв](./media/role-assignments-external-users/invite-review-permissions.png)

Для получения дополнительной информации о процессе приглашения смотрите [выкуп приглашений при приглашении Azure Active Directory B2B](../active-directory/b2b/redemption-experience.md)под искуплением.

## <a name="add-a-role-assignment-for-a-guest-user"></a>Добавление ролевой задания для гостевого пользователя

При использовании RBAC, чтобы предоставить доступ, нужно присвоить роль. Чтобы добавить назначение ролей для гостевого пользователя, вы выполняете те [же шаги,](role-assignments-portal.md#add-a-role-assignment) что и пользователь-член, группа, директор службы или управляемая личность. Выполните следующие действия, добавьте назначение ролей для гостевого пользователя в различных областях.

1. На портале Azure щелкните **все сервисы**.

1.  Выберите набор ресурсов, к которым применяется доступ, также известный как область. Например, можно выбрать **Группы управления**, **Подписки**, **Группы ресурсов** или конкретный ресурс.

1. Нажмите на конкретный ресурс.

1. Нажмите **на элемент управления доступом (IAM)**.

    На следующем скриншоте показан пример лезвия управления доступом (IAM) для группы ресурсов. Если вы внесете какие-либо изменения в элемент управления доступом, они будут применяться только к группе ресурсов.

    ![Колонка "Управление доступом (IAM)" для группы ресурсов](./media/role-assignments-external-users/access-control-resource-group.png)

1. Щелкните вкладку **Назначения ролей**, чтобы просмотреть все назначения ролей в этой области.

1. Нажмите **Добавить Добавить** > **ролевые задания,** чтобы открыть панель назначения роли Добавить.

    Если у вас нет прав назначать роли, функция "Добавить назначение роли" будет неактивна.

    ![Меню "Добавить"](./media/role-assignments-external-users/add-menu.png)

1. В раскрывающемся списке **Роли** выберите роль, например **Участник виртуальных машин**.

1. В списке **Select** выберите гостевого пользователя. Если вы не видите пользователя в списке, можно ввести в поле **Select** для поиска имен отображения, адресов электронной почты и идентификаторов объектов.

   ![Область "Добавить назначение ролей"](./media/role-assignments-external-users/add-role-assignment.png)

1. Нажмите **Сохранить,** чтобы назначить роль в выбранной области.

    ![Назначение ролей для вкладчика виртуальной машины](./media/role-assignments-external-users/access-control-role-assignments.png)

## <a name="add-a-role-assignment-for-a-guest-user-not-yet-in-your-directory"></a>Добавьте назначение ролей для гостевого пользователя, еще не всхожее

Чтобы добавить назначение ролей для гостевого пользователя, вы выполняете те [же шаги,](role-assignments-portal.md#add-a-role-assignment) что и пользователь-член, группа, директор службы или управляемая личность.

Если гость еще не в вашем каталоге, вы можете пригласить пользователя непосредственно из панели назначения роли Add.

1. На портале Azure щелкните **все сервисы**.

1.  Выберите набор ресурсов, к которым применяется доступ, также известный как область. Например, можно выбрать **Группы управления**, **Подписки**, **Группы ресурсов** или конкретный ресурс.

1. Нажмите на конкретный ресурс.

1. Нажмите **на элемент управления доступом (IAM)**.

1. Щелкните вкладку **Назначения ролей**, чтобы просмотреть все назначения ролей в этой области.

1. Нажмите **Добавить Добавить** > **ролевые задания,** чтобы открыть панель назначения роли Добавить.

    ![Меню "Добавить"](./media/role-assignments-external-users/add-menu.png)

1. В раскрывающемся списке **Роли** выберите роль, например **Участник виртуальных машин**.

1. В списке **Select** введите адрес электронной почты человека, которого вы хотите пригласить, и выберите его.

   ![Приглашение приглашенного пользователя в панели назначения роли Добавить](./media/role-assignments-external-users/add-role-assignment-new-guest.png)

1. Нажмите **Сохранить,** чтобы добавить гостевого пользователя в каталог, назначить роль и отправить приглашение.

    Через несколько мгновений вы увидите уведомление о назначении роли и информацию о приглашении.

    ![Назначение ролей и уведомление пользователя](./media/role-assignments-external-users/invited-user-notification.png)

1. Чтобы вручную пригласить гостевого пользователя, нажмите правой кнопкой мыши и скопируйте ссылку приглашения в уведомлении. Не нажимайте на ссылку приглашения, поскольку она запускает процесс приглашения.

    Ссылка на приглашение будет иметь следующий формат:

    `https://invitations.microsoft.com/redeem/...`

1. Отправьте ссылку на приглашение гостевому пользователю для завершения процесса приглашения.

    Для получения дополнительной информации о процессе приглашения смотрите [выкуп приглашений при приглашении Azure Active Directory B2B](../active-directory/b2b/redemption-experience.md)под искуплением.

## <a name="remove-a-guest-user-from-your-directory"></a>Удалить гостевого пользователя из каталога

Прежде чем удалить гостевого пользователя из каталога, необходимо сначала удалить любые назначения ролей для этого гостевого пользователя. Выполните следующие действия, чтобы удалить гостевого пользователя из каталога.

1. Открытый **контроль доступа (IAM)** в области, такой как группа управления, подписка, группа ресурсов или ресурс, где гость пользователя имеет назначение роли.

1. Нажмите на вкладку **«Задания ролей»,** чтобы просмотреть все назначения ролей.

1. В списке назначений ролей добавьте галочку рядом с гостем с назначением роли, которое вы хотите удалить.

   ![Удаление назначения ролей](./media/role-assignments-external-users/remove-role-assignment-select.png)

1. Щелкните **Удалить**.

   ![Сообщение об удалении назначения роли](./media/role-assignments-external-users/remove-role-assignment.png)

1. В появившемся сообщении об отзыве назначения роли щелкните **Да**.

1. В левой панели навигации щелкните > **пользователей** **Active Directory Azure.**

1. Нажмите на приглашенного пользователя, который вы хотите удалить.

1. Выберите команду **Удалить**.

   ![Удалить гостевого пользователя](./media/role-assignments-external-users/delete-guest-user.png)

1. В отосвежьи сообщения об удалении нажмите **«Да».**

## <a name="troubleshoot"></a>Устранение неполадок

### <a name="guest-user-cannot-browse-the-directory"></a>Гостевой пользователь не может просматривать каталог

Гостевые пользователи имеют ограниченные разрешения каталога. Например, гостевые пользователи не могут просматривать каталог и не могут искать группы или приложения. Для получения дополнительной информации смотрите [Что такое пользовательские разрешения по умолчанию в active Directory Azure?.](../active-directory/fundamentals/users-default-permissions.md)

![Гостевой пользователь не может просматривать пользователей в каталоге](./media/role-assignments-external-users/directory-no-users.png)

Если гостевому пользователю нужны дополнительные привилегии в каталоге, можно назначить роль каталога гостю. Если вы действительно хотите, чтобы гость мог получить полный доступ к каталогу для чтения, вы можете добавить гостевого пользователя в роль [читателей каталогов](../active-directory/users-groups-roles/directory-assign-admin-roles.md) в Azure AD. Для получения дополнительной информации см. [Разрешения гранта для пользователей из организаций-партнеров в вашем арендаторе Active Directory Azure.](../active-directory/b2b/add-guest-to-role.md)

![Назначить роль читателей каталога](./media/role-assignments-external-users/directory-roles.png)

### <a name="guest-user-cannot-browse-users-groups-or-service-principals-to-assign-roles"></a>Гостевой пользователь не может просматривать пользователей, группы или принципы обслуживания для присвоения ролей

Гостевые пользователи имеют ограниченные разрешения каталога. Даже если гость-пользователь является [Владельцем](built-in-roles.md#owner) в области, если он пытается добавить назначение ролей, чтобы предоставить кому-либо доступ, он не может просматривать список пользователей, групп или директоров служб.

![Гостевой пользователь не может просматривать принципы безопасности для присвоения ролей](./media/role-assignments-external-users/directory-no-browse.png)

Если гостевой пользователь знает чье-то имя в каталоге, он может предоставить доступ. Если вы действительно хотите, чтобы гость мог получить полный доступ к каталогу для чтения, вы можете добавить гостевого пользователя в роль [читателей каталогов](../active-directory/users-groups-roles/directory-assign-admin-roles.md) в Azure AD. Для получения дополнительной информации см. [Разрешения гранта для пользователей из организаций-партнеров в вашем арендаторе Active Directory Azure.](../active-directory/b2b/add-guest-to-role.md)

### <a name="guest-user-cannot-register-applications-or-create-service-principals"></a>Гостевой пользователь не может зарегистрировать приложения или создать принципы обслуживания

Гостевые пользователи имеют ограниченные разрешения каталога. Если гостевой пользователь должен иметь возможность регистрировать приложения или создавать принципы обслуживания, вы можете добавить гостевого пользователя к роли [разработчика приложения](../active-directory/users-groups-roles/directory-assign-admin-roles.md) в Azure AD. Для получения дополнительной информации см. [Разрешения гранта для пользователей из организаций-партнеров в вашем арендаторе Active Directory Azure.](../active-directory/b2b/add-guest-to-role.md)

![Гость не может зарегистрировать приложения](./media/role-assignments-external-users/directory-access-denied.png)

### <a name="guest-user-does-not-see-the-new-directory"></a>Гостевой пользователь не видит новый каталог

Если гостю был предоставлен доступ к каталогу, но он не видит новый каталог, указанный на портале Azure, когда он пытается переключиться в своем каталоге и панели **подписки,** убедитесь, что гостевой пользователь завершил процесс приглашения. Для получения дополнительной информации о процессе приглашения смотрите [выкуп приглашений при приглашении Azure Active Directory B2B](../active-directory/b2b/redemption-experience.md)под искуплением.

### <a name="guest-user-does-not-see-resources"></a>Гостевой пользователь не видит ресурсы

Если гостю был предоставлен доступ к каталогу, но он не видит ресурсов, к которым он получил доступ на портале Azure, убедитесь, что гость выбрал правильный каталог. Гостевой пользователь может иметь доступ к нескольким каталогам. Чтобы переключить каталоги, в левом верхнем углу, нажмите **подписку каталога,** а затем нажмите на соответствующий каталог.

![Каталоги и панель подписки на портале Azure](./media/role-assignments-external-users/directory-subscription.png)

## <a name="next-steps"></a>Дальнейшие действия

- [Добавление пользователей службы совместной работы B2B на портале Azure](../active-directory/b2b/add-users-administrator.md)
- [Свойства пользователя службы совместной работы Azure Active Directory B2B](../active-directory/b2b/user-properties.md)
- [Элементы сообщения с приглашением службы совместной работы B2B Azure Active Directory](../active-directory/b2b/invitation-email-elements.md)
- [Добавление гостевого пользователя в качестве соадминистратора](classic-administrators.md#add-a-guest-user-as-a-co-administrator)