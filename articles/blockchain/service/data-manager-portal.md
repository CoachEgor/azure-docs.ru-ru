---
title: Настройка Диспетчер данных Блокчейн — портал Azure
description: Как создавать Диспетчер данных Блокчейн и управлять ими с помощью портал Azure.
services: azure-blockchain
author: PatAltimore
ms.author: patricka
ms.date: 11/04/2019
ms.topic: article
ms.service: azure-blockchain
ms.reviewer: chroyal
ms.openlocfilehash: 484322fb0486eeb4ab67366d32350c69a18da743
ms.sourcegitcommit: c62a68ed80289d0daada860b837c31625b0fa0f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/05/2019
ms.locfileid: "73605923"
---
# <a name="configure-blockchain-data-manager-using-the-azure-portal"></a>Настройка Диспетчер данных Блокчейн с помощью портал Azure

Настройте Диспетчер данных Блокчейн для службы Блокчейн Azure, чтобы записать данные блокчейн и отправить их в службу "Сетка событий Azure".

Чтобы настроить экземпляр Диспетчер данных Блокчейн, сделайте следующее:

* Создание экземпляра Диспетчер данных Блокчейн для узла транзакции службы Блокчейн Azure
* Добавление приложений блокчейн

## <a name="prerequisites"></a>Предварительные требования

* Полное [руководство. Создание члена блокчейн с помощью портал Azure](create-member.md) или [краткого руководства: создание члена Блокчейн службы блокчейн Azure с помощью Azure CLI](create-member-cli.md)
* Создать [раздел "Сетка событий](../../event-grid/custom-event-quickstart-portal.md#create-a-custom-topic) "
* Дополнительные сведения о [обработчиках событий в службе "Сетка событий Azure](../../event-grid/event-handlers.md) "

## <a name="create-instance"></a>Создать экземпляр

Экземпляр Диспетчер данных Блокчейн подключает и отслеживает узел транзакции службы Блокчейн Azure. Только пользователи с доступом к узлу транзакции могут создать подключение. Экземпляр захватывает все данные необработанных блоков и необработанных транзакций из узла транзакции.

Исходящее подключение отправляет данные блокчейн в службу "Сетка событий Azure". При создании экземпляра вы настраиваете одно исходящее подключение. Блокчейн Диспетчер данных поддерживает несколько разделов "Сетка событий" с исходящими подключениями для любого заданного экземпляра Блокчейн Диспетчер данных. Данные блокчейн можно отправить в одно место назначения или отправить данные блокчейн в несколько назначений. Чтобы добавить другое назначение, просто добавьте дополнительные исходящие подключения к экземпляру.

1. Войдите на [портал Azure](https://portal.azure.com).
1. Перейдите к члену службы Azure Блокчейн, который вы хотите подключить к Блокчейн Диспетчер данных. Выберите **блокчейн Диспетчер данных**.
1. Выберите **Добавить**.

    ![Добавить Диспетчер данных Блокчейн](./media/data-manager-portal/add-instance.png)

    Введите следующие сведения:

    Настройка | Description (Описание)
    --------|------------
    Имя | Введите уникальное имя для подключенной Диспетчер данных Блокчейн. Имя Диспетчер данных Блокчейн может содержать строчные буквы и цифры и имеет длину не более 20 символов.
    Узел транзакции | Выберите узел транзакции. Отображаются только узлы транзакций, у которых есть доступ на чтение.
    Имя подключения | Введите уникальное имя исходящего подключения, в которое отправляются данные транзакции блокчейн.
    Конечная точка сетки событий | Выберите раздел сетки событий в той же подписке, что и экземпляр Диспетчер данных Блокчейн.

1. Нажмите кнопку **ОК**.

    Создание экземпляра Диспетчер данных Блокчейн занимает менее минуты. После развертывания экземпляр автоматически запускается. Выполняющийся экземпляр Диспетчер данных Блокчейн захватывает события блокчейн из узла Transaction и отправляет данные в исходящие подключения.

    Новый экземпляр появится в списке экземпляров Блокчейн Диспетчер данных для члена службы Блокчейн Azure.

    ![Список экземпляров элементов данных Блокчейн](./media/data-manager-portal/instance-list.png)

## <a name="add-blockchain-application"></a>Добавление приложения блокчейн

При добавлении приложения блокчейн Блокчейн Диспетчер данных декодирует события и состояние свойства для приложения. В противном случае отправляются только данные необработанных блоков и необработанных транзакций. Блокчейн Диспетчер данных также обнаруживает контрактные адреса при развертывании контракта. К экземпляру Диспетчер данных Блокчейн можно добавить несколько приложений блокчейн.

> [!IMPORTANT]
> В настоящее время блокчейн приложения, объявляющие [типы массивов](https://solidity.readthedocs.io/en/v0.5.12/types.html#arrays) или [типов сопоставлений](https://solidity.readthedocs.io/en/v0.5.12/types.html#mapping-types) , не полностью поддерживаются. Свойства, объявленные как массив или типы сопоставления, не будут декодированы в сообщениях *контрактпропертиесмсг* или *декодедконтрактевентсмсг* .

Для добавления приложения блокчейн Диспетчер данных требуется интерфейс ABI смарт-контракта и развернутый файл байтового кода.

### <a name="get-contract-abi-and-bytecode"></a>Получение интерфейса ABI и байтового кода контракта

Интерфейс ABI контракта определяет интерфейсы интеллектуального контракта. В нем описывается взаимодействие с интеллектуальным контрактом. Чтобы скопировать интерфейс ABI контракта в буфер обмена, можно использовать [расширение Azure Блокчейн Development Kit для Ethereum](https://marketplace.visualstudio.com/items?itemName=AzBlockchain.azure-blockchain) .

1. В области Обозреватель Visual Studio Code разверните папку **Сборка/контракты** проекта со своей плотностью.
1. Щелкните правой кнопкой мыши JSON-файл метаданных контракта. Имя файла — это имя смарт-контракта, за которым следует расширение **JSON** .
1. Выберите **Копировать контракт ABI**.

    ![Панель Visual Studio Code с выбранным параметром ABI контракта копирования](./media/data-manager-portal/abi-devkit.png)

    Интерфейс ABI контракта копируется в буфер обмена.

1. Сохраните массив **ABI** как JSON-файл. Например, *ABI. JSON*. Вы используете этот файл на более позднем этапе.

Для блокчейн Диспетчер данных требуется развернутый байт-код для интеллектуального контракта. Развернутый байт-код отличается от байтового кода Smart Contract. Развернутый байт можно получить из скомпилированного файла метаданных контракта.

1. Откройте файл метаданных контракта, содержащийся в папке **Build/Contracts** проекта со своей плотностью. Имя файла — это имя смарт-контракта, за которым следует расширение **JSON** .
1. Найдите элемент **деплойедбитекоде** в JSON File.
1. Скопируйте шестнадцатеричное значение без кавычек.

    ![Панель Visual Studio Code с байтом в метаданных](./media/data-manager-portal/bytecode-metadata.png)

1. Сохраните значение **байт-кода** в формате JSON. Например, *байт. JSON*. Вы используете этот файл на более позднем этапе.

В следующем примере показано открытие файлов *ABI. JSON* и *байт. json* в редакторе VS Code. Файлы должны выглядеть аналогичным образом.

![Пример файлов ABI. JSON и байт. JSON](./media/data-manager-portal/contract-files.png)

### <a name="create-contract-abi-and-bytecode-url"></a>Создание интерфейса ABI и URL-адреса байта контракта

При добавлении приложения блокчейн Диспетчер данных требует, чтобы URL-адрес ABI и файлы байта контракта были доступны для использования с одним из них. Для предоставления закрытого URL-адреса можно использовать учетную запись хранения Azure.

#### <a name="create-storage-account"></a>Создать учетную запись хранения

[!INCLUDE [storage-create-account-portal-include](../../../includes/storage-create-account-portal-include.md)]

#### <a name="upload-contract-files"></a>Отправка файлов контрактов

1. Создайте новый контейнер для учетной записи хранения. Выберите **контейнеры > контейнер**.

    ![Создание контейнера учетной записи хранения](./media/data-manager-portal/create-container.png)

    | Поле | Description (Описание) |
    |-------|-------------|
    | Имя  | Присвойте контейнеру имя. Например, *смартконтракт* |
    | Общий уровень доступа | Выберите *частный (без анонимного доступа)* |

1. Нажмите кнопку **ОК**, чтобы создать контейнер.
1. Выберите контейнер, а затем щелкните **Отправить**.
1. Выберите оба файла JSON, созданные в разделе [получение контракта ABI и байт](#get-contract-abi-and-bytecode) .

    ![Отправка большого двоичного объекта](./media/data-manager-portal/upload-blobs.png)

    Щелкните **Отправить**.

#### <a name="generate-url"></a>Создание URL-адреса

Для каждого большого двоичного объекта создайте подпись общего доступа.

1. Выберите большой двоичный объект ABI JSON.
1. Выберите **создать SAS**
1. Задайте требуемый срок действия подписи доступа, а затем выберите **создать маркер SAS BLOB и URL-адрес**.

    ![Создать маркер SAS](./media/data-manager-portal/generate-sas.png)

1. Скопируйте **URL-адрес SAS большого двоичного объекта** и сохраните его для следующего раздела.
1. Повторите шаги [создания URL-адреса](#generate-url) для большого двоичного объекта JSON байта.

### <a name="add-application-to-instance"></a>Добавить приложение в экземпляр

1. Выберите экземпляр Блокчейн Диспетчер данных из списка экземпляров.
1. Выберите **блокчейн приложения**.
1. Выберите **Добавить**.

    ![Добавление приложения блокчейн](./media/data-manager-portal/add-application.png)

    Введите имя приложения блокчейн, а также URL-адреса ABI и байты для Smart Contract.

    Настройка | Description (Описание)
    --------|------------
    Имя | Введите уникальное имя приложения блокчейн для трассировки.
    Интерфейс ABI контракта | URL-путь к файлу ABI контракта. Дополнительные сведения см. в разделе [Создание интерфейса ABI контракта и URL-адрес кода](#create-contract-abi-and-bytecode-url).
    Код байта контракта | URL-путь к файлу байтового кода. Дополнительные сведения см. в разделе [Создание интерфейса ABI контракта и URL-адрес кода](#create-contract-abi-and-bytecode-url).

1. Нажмите кнопку **ОК**.

    После создания приложения оно появится в списке приложений блокчейн.

    ![Список приложений блокчейн](./media/data-manager-portal/artifact-list.png)

Вы можете удалить учетную запись хранения Azure или использовать ее для настройки дополнительных приложений блокчейн. Если вы хотите удалить учетную запись хранения Azure, можно удалить группу ресурсов. При этом удаляется связанная учетная запись хранения и другие ресурсы, связанные с этой группой ресурсов.

## <a name="stop-instance"></a>Останавливает экземпляр

Если необходимо отключить запись событий блокчейн и отправку данных в исходящие подключения, то следует закрыть экземпляр Блокчейн Manager. Когда экземпляр остановлен, плата за Диспетчер данных Блокчейн не взимается. Дополнительные сведения см. на странице [цен](https://azure.microsoft.com/pricing/details/blockchain-service).

1. Перейдите к разделу **Обзор** и выберите пункт **Закрыть**.

    ![Останавливает экземпляр](./media/data-manager-portal/stop-instance.png)

## <a name="next-steps"></a>Дальнейшие действия

Попробуйте создать блокчейн обозреватель сообщений транзакций с помощью Блокчейн Диспетчер данных и Azure Cosmos DB.

> [!div class="nextstepaction"]
> [Учебник. Использование Диспетчер данных Блокчейн для отправки данных в Azure Cosmos DB](data-manager-cosmosdb.md)