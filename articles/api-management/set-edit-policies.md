---
title: Настройка и изменение политик службы управления API Azure | Документация Майкрософт
description: В этой статье показано, как настроить или изменить политики службы управления API Azure.
services: api-management
documentationcenter: ''
author: mikebudzynski
manager: cflower
editor: ''
ms.service: api-management
ms.workload: mobile
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 11/01/2018
ms.author: apimpm
ms.openlocfilehash: 052bf619cd6f41aad139db45a8f3ecd9f4a0a62f
ms.sourcegitcommit: 94ee81a728f1d55d71827ea356ed9847943f7397
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/26/2019
ms.locfileid: "70034921"
---
# <a name="how-to-set-or-edit-azure-api-management-policies"></a>Настройка или изменение политик службы управления API Azure

Определение политики представляет собой XML-документ, в котором описана последовательность входящих и исходящих операторов. Файл XML можно редактировать прямо в окне определения. Вы также можете выбрать стандартную политику в списке, который отображается справа от окна политики. Операторы, применимые к текущей области, разрешены и выделены. Если щелкнуть разрешенный оператор, в месте расположения курсора в представлении определения добавится соответствующий XML-код. 

Дополнительные сведения о политиках см. в статье [Политики в службе управления API Azure](api-management-howto-policies.md).

## <a name="set-or-edit-a-policy"></a>Настройка и изменение политик

Чтобы настроить или изменить политику, сделайте следующее:

1. Войдите на портал Azure по адресу [https://portal.azure.com](https://portal.azure.com).
2. Перейдите к экземпляру службы управления API Azure.
3. Щелкните вкладку **Интерфейсы API**.

    ![Изменить политику](./media/set-edit-policies/code-editor.png)

4. Выберите один из API, которые вы импортировали ранее.
5. Выберите вкладку **Конструктор**.
6. Выберите операцию, к которой требуется применить политику. Если нужно применить политику ко всем операциям, выберите **Все операции**.
7. Выберите значок **</>** (редактор кода) в разделе **обработка входящих запросов** или **Обработка исходящих запросов**.
8. Вставьте код необходимой политики в один из соответствующих блоков.

    ```XML
    <policies>
        <inbound>
            <base />
        </inbound>
        <backend>
            <base />
        </backend>
        <outbound>
            <base />
        </outbound>
        <on-error>
            <base />
        </on-error>
    </policies>
    ```
 
## <a name="configure-scope"></a>Настройка области

Политики можно настраивать глобально либо на уровне продукта, API или операции. Чтобы начать настройку политики, необходимо сначала выбрать область, в которой эта политика должна применяться.

Области политики определяются в следующем порядке:

1. Глобальная область
2. Область продукта
3. Область API
4. Область операций

Операторы внутри политик определяются с учетом размещения элемента `base` при его наличии. Для глобальной политики не существует родительской политики, поэтому использовать в ней элемент `<base>` бесполезно.

Чтобы просмотреть политики в текущей области в редакторе политик, щелкните **Recalculate effective policy for selected scope**(Пересчитать эффективную политику для выбранной области).

### <a name="global-scope"></a>Глобальная область

Глобальная область настраивается для **всех API-интерфейсов** в экземпляре службы управления API.

1. Войдите на [портал Azure](https://portal.azure.com/) и перейдите к своему экземпляру службы управления API.
2. Выберите **Все API**.

    ![Глобальная область](./media/api-management-howto-policies/global-scope.png)

3. Щелкните значок треугольника.
4. Выберите **Редактор кода**.
5. Добавьте или измените политики.
6. Нажмите кнопку **Save**(Сохранить). 

    Изменения сразу распространяются на шлюз службы управления API.

### <a name="product-scope"></a>Область продукта

Область продукта настраивается для выбранного продукта.

1. Щелкните **Продукты**.

    ![Область продукта](./media/api-management-howto-policies/product-scope.png)

2. Выберите продукт, к которому нужно применить политики.
3. Щелкните **Политики**.
4. Добавьте или измените политики.
5. Нажмите кнопку **Save**(Сохранить). 

### <a name="api-scope"></a>Область API

Область API настраивается для **всех операций** выбранного API.

1. Выберите **API**, к которому нужно применить политики.

    ![Область API](./media/api-management-howto-policies/api-scope.png)

2. Выберите **Все операции**.
3. Щелкните значок треугольника.
4. Выберите **Редактор кода**.
5. Добавьте или измените политики.
6. Нажмите кнопку **Save**(Сохранить). 

### <a name="operation-scope"></a>Область операций 

Область операций настраивается для выбранной операции.

1. Выберите **API**.
2. Выберите операцию, к которой нужно применить политики.

    ![Область операций](./media/api-management-howto-policies/operation-scope.png)

3. Щелкните значок треугольника.
4. Выберите **Редактор кода**.
5. Добавьте или измените политики.
6. Нажмите кнопку **Save**(Сохранить). 

## <a name="next-steps"></a>Следующие шаги

Также ознакомьтесь со следующими материалами:

+ [Преобразование API-интерфейсов](transform-api.md).
+ Полный перечень операторов политик и их параметров см. в [справочнике по политикам](api-management-policy-reference.md).
+ [Примеры политик](policy-samples.md).
