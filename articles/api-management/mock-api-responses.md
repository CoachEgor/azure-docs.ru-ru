---
title: Макетирование ответов API с помощью портала Azure | Документация Майкрософт
description: В этом руководстве показано, как использовать службу управления API для установки политик в API, чтобы получать от них макетированный ответ. Этот метод позволяет разработчикам продолжить реализацию и тестирование экземпляра управления API, если серверная часть не может отправлять реальные ответы.
services: api-management
documentationcenter: ''
author: vladvino
manager: cfowler
editor: ''
ms.service: api-management
ms.workload: mobile
ms.tgt_pltfrm: na
ms.devlang: na
ms.custom: mvc
ms.topic: tutorial
ms.date: 06/15/2018
ms.author: apimpm
ms.openlocfilehash: 9b9a691cb2bce2357d184420912ab340aee534e8
ms.sourcegitcommit: b7a44709a0f82974578126f25abee27399f0887f
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/18/2019
ms.locfileid: "67205307"
---
# <a name="mock-api-responses"></a>Макетирование ответов API

Серверные API можно импортировать в API службы управления API или создать их и управлять ими вручную. В этом руководстве показано, как использовать службу управления API для создания пустого API и управления им вручную. В этом руководстве показано как настроить политику API для возвращения макетированных ответов. Этот метод позволяет разработчикам продолжить реализацию и тестирование экземпляра службы управления API, даже если серверная часть не может отправлять реальные ответы. Возможность макетирования ответов может быть полезна в ряде сценариев:

+ Когда сначала создается интерфейсная часть API, а затем — серверная реализация. Или когда серверная часть разрабатывается параллельно.
+ Когда серверная часть временно не работает или ее невозможно масштабировать.

Из этого руководства вы узнаете, как выполнять следующие задачи:

> [!div class="checklist"]
> * создание тестового API; 
> * добавление операции в тестовый API;
> * включение макетирования ответа;
> * тестирование макетирования API.

![Ответ макетированной операции](./media/mock-api-responses/mock-api-responses01.png)

## <a name="prerequisites"></a>Предварительные требования

+ Ознакомьтесь с [терминологией службы управления API в Azure](api-management-terminology.md).
+ Ознакомьтесь с [концепцией использования политик в службе управления API в Azure](api-management-howto-policies.md).
+ Выполните инструкции из краткого руководства [Создание экземпляра службы управления API Azure](get-started-create-service-instance.md).

## <a name="create-a-test-api"></a>создание тестового API; 

В этом разделе показано, как создать пустой API без серверной части. Кроме того, здесь показано, как добавить операции в API. Вызов операции после завершения действий в этом разделе вызовет ошибку. Если завершить все действия из раздела "Включение макетирования ответа" ошибки не возникнут.

![Создание пустого API](./media/mock-api-responses/03-MockAPIResponses-01-CreateTestAPI.png)

1. В службе **управления API** выберите **API**.
2. Выберите **+ Add API** (+ Добавить API) в меню слева.
3. Выберите **Пустой API** в списке.
4. Введите "*Тестовый API*" в качестве **отображаемого имени**.
5. Введите "*Без ограничений*" в поле **Продукты**.
6. Нажмите кнопку **Создать**.

## <a name="add-an-operation-to-the-test-api"></a>добавление операции в тестовый API;

![Добавление операции в API](./media/mock-api-responses/03-MockAPIResponses-02-AddOperation.png)

1. Выберите API, созданный на предыдущем шаге.
2. Щелкните **+ Add Operation** (+ Добавить операцию).

    | Параметр             | Значение                             | ОПИСАНИЕ                                                                                                                                                                                   |
    |---------------------|-----------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
    | **Отображаемое имя**    | *Test call* (Пробный вызов)                       | Имя, отображаемое на **портале разработчика**.                                                                                                                                       |
    | **URL-адрес** (HTTP-команда) | ПОЛУЧЕНИЕ                               | Можно выбрать одну из предопределенных HTTP-команд.                                                                                                                                         |
    | **URL-адрес**             | */test*                           | URL-путь для API.                                                                                                                                                                       |
    | **Описание**     |                                   | Введите описание операции, с помощью которой документация предоставляется разработчикам, которые используют текущее API на **портале разработчика**.                                                    |
    | Вкладка **Запрос**       |                                   | Здесь вы можете добавить параметры запроса. Помимо имени и описания можно указать значения, привязанные к данному параметру. Одно из значений может быть отмечено как значение по умолчанию (необязательно). |
    | Вкладка **Запрос**     |                                   | Вы можете задать типы содержимого, примеры и схемы запросов.                                                                                                                                  |
    | Вкладка **Ответ**    | Ознакомтесь с шагами, приведенными после этой таблицы. | Задайте коды состояния, типы содержимого, примеры и схемы ответов.                                                                                                                           |

3. Выберите вкладку **Ответ**, которая находится под полями "URL-адрес", "Отображаемое имя" и "Описание".
4. Щелкните **+ Add response** (+ Добавить ответ).
5. Из списка выберите **200 OK**.
6. Справа от раздела **Представления** выберите **+ Add representation** (+ Добавить представление).
7. В поле поиска введите "*application/json*" и выберите тип контента **application/json**.
8. В текстовом поле **Образец** введите `{ 'sampleField' : 'test' }`.
9. Нажмите кнопку **Создать**.

## <a name="enable-response-mocking"></a>включение макетирования ответа;

![включение макетирования ответа;](./media/mock-api-responses/03-MockAPIResponses-03-EnableMocking.png)

1. Выберите API, созданный на этапе "Создание тестового API".
2. Выберите добавленную тестовую операцию.
3. Щелкните вкладку **Design** (Проектирование) в окне справа.
4. Щелкните **+ Добавить политику** в окне **Обработка входящих запросов**.
5. Выберите из коллекции плитку **Mock responses** (Макетирование ответов).

    ![Плитка политики макетирования ответов](./media/mock-api-responses/mock-responses-policy-tile.png)

6. В текстовом поле **API Management response** (Ответ службы управления API) введите **200 OK, application/json**. Этот параметр указывает, что API должен возвращать пример ответа, определенный в предыдущем разделе.

    ![включение макетирования ответа;](./media/mock-api-responses/mock-api-responses-set-mocking.png)

7. Выберите команду **Сохранить**.

## <a name="test-the-mocked-api"></a>тестирование макетирования API.

![Тестирование макетирования API](./media/mock-api-responses/03-MockAPIResponses-04-TestMocking.png)

1. Выберите API, созданный на этапе "Создание тестового API".
2. Откройте вкладку **Тест**.
3. Убедитесь, что выбран API **пробного вызова**.

    > [!TIP]
    > Желтая панель с текстом **Макетирование включено** указывает, что ответы, возвращаемые из управления API, отправляют политику макетирования, а не фактические серверные ответы.

4. Чтобы сделать пробный вызов, выберите **Отправка**.
5. В качестве образца в первом разделе руководства отображается **HTTP-ответ** JSON.

    ![включение макетирования ответа;](./media/mock-api-responses/mock-api-responses-test-response.png)

## <a name="video"></a>Видео

> [!VIDEO https://www.youtube.com/embed/i9PjUAvw7DQ]

## <a name="next-steps"></a>Дополнительная информация

Из этого руководства вы узнали, как выполнить следующие задачи:

> [!div class="checklist"]
> * создание тестового API;
> * добавление операции в тестовый API;
> * включение макетирования ответа;
> * тестирование макетирования API.

Перейдите к следующему руководству:

> [!div class="nextstepaction"]
> [Преобразование и защита опубликованного API](transform-api.md)
