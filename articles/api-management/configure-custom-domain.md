---
title: Настройка имени домена для экземпляра службы управления API Azure | Документация Майкрософт
description: В этом разделе описано, как настроить пользовательское имя домена для вашего экземпляра службы управления API Azure.
services: api-management
documentationcenter: ''
author: vladvino
manager: anneta
editor: ''
ms.service: api-management
ms.workload: integration
ms.topic: article
ms.date: 07/01/2019
ms.author: apimpm
ms.openlocfilehash: 59b44dcc9ec3a1f7c274f426a19aa8ed2258db3e
ms.sourcegitcommit: 79496a96e8bd064e951004d474f05e26bada6fa0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/02/2019
ms.locfileid: "67509293"
---
# <a name="configure-a-custom-domain-name"></a>Настройка имени личного домена

При создании экземпляра службы управления API Azure, Azure назначает ему поддомен azure-api.net (например, `apim-service-name.azure-api.net`). Тем не менее, можно предоставить конечным точкам службы управления API, используя собственное имя личного домена, таких как **contoso.com**. Этом руководстве показано, как сопоставление существующего настраиваемого DNS-имени для конечных точек, предоставляемых экземпляра управления API.

> [!WARNING]
> Пользователям, желающим использовать привязку сертификата для повышения безопасности своих приложений, необходимо использовать имя пользовательского домена и сертификат, которым они управляют, а не сертификат по умолчанию. Пользователи, которые привязывают сертификат по умолчанию, получат жесткую зависимость от свойств сертификата, которым они не управляют. Поэтому это делать не рекомендуется.

## <a name="prerequisites"></a>Технические условия

Чтобы выполнить действия, описанные в этой статье, необходимо следующее.

-   Активная подписка Azure.

    [!INCLUDE [quickstarts-free-trial-note](../../includes/quickstarts-free-trial-note.md)]

-   Экземпляр управления API. Дополнительные сведения см. в статье о [создании экземпляра управления API Azure](get-started-create-service-instance.md).
-   Пользовательское доменное имя, которое принадлежит вам. Используемое имя должно быть приобретено отдельно и размещено на DNS-сервере. Этот раздел не содержит инструкции по размещению пользовательского доменного имени.
-   Необходимо иметь действующий сертификат с открытым и закрытым ключами (PFX-файл). Субъекта или альтернативное имя субъекта (SAN) должен совпадать с доменным именем (Это позволяет экземпляру службы управления API безопасно предоставлять URL-адреса по протоколу SSL).

## <a name="use-the-azure-portal-to-set-a-custom-domain-name"></a>Настройка пользовательского доменного имени с помощью портала Azure

1. Перейдите к экземпляру службы управления API в [портала Azure](https://portal.azure.com/).
1. Выберите **Личные домены и SSL**.

    Существует ряд конечных точек, к которым можно назначить пользовательское доменное имя. Сейчас доступны следующие конечные точки:

    - **Proxy** (по умолчанию: `<apim-service-name>.azure-api.net`),
    - **Portal** (по умолчанию: `<apim-service-name>.portal.azure-api.net`),
    - **Management** (по умолчанию: `<apim-service-name>.management.azure-api.net`),
    - **SCM** (по умолчанию: `<apim-service-name>.scm.azure-api.net`).

    > [!NOTE]
    > Можно обновить все конечные точки или некоторые из них. Как правило, клиенты обновляют конечные точки **Proxy** (этот URL-адрес используется для вызова API, предоставляемого через службу управления API) и **Portal** (URL-адрес портала разработчика). **Управление** и **SCM** конечные точки могут использоваться внутренними механизмами только владельцев экземпляров управления API и таким образом, им реже назначается пользовательское доменное имя. В большинстве случаев можно задать только одного пользовательского доменного имени для данной конечной точки. Тем не менее **уровня "премиум"** уровень поддерживает задание нескольких имен узлов для **прокси** конечной точки.

1. Выберите конечную точку, которую необходимо обновить.
1. В окне справа выберите **Настраиваемое**.

    - В поле **Пользовательское доменное имя** укажите имя, которое следует использовать. Например, `api.contoso.com`. Подстановочный знак доменные имена (например, \*. domain.com) также поддерживаются.
    - В **сертификат**, выберите сертификат из хранилища ключей. Вы также можете отправить является допустимым. PFX-ФАЙЛ файла и укажите его **пароль**, если сертификат защищен паролем.

    > [!TIP]
    > Мы рекомендуем использовать Azure Key Vault для управления сертификатами и присвоить им autorotate.
    > Если вы используете Azure Key Vault для управления SSL-сертификата личного домена, убедитесь, что сертификат вставляется в хранилище ключей [как _сертификат_](https://docs.microsoft.com/rest/api/keyvault/CreateCertificate/CreateCertificate), а не _секрет_.
    >
    > Чтобы получить SSL-сертификат, управления API требуются разрешения списка get секреты в хранилище ключей Azure, содержащий сертификат. При использовании портала Azure все необходимые этапы настройки будут выполняться автоматически. При использовании средства командной строки или API управления, эти разрешения должны быть предоставлены вручную. Это делается в два этапа. Во-первых страница управляемого удостоверения на экземпляр управления API, убедитесь, что управляемое удостоверение включено, и запомните или запишите идентификатор участника, показано на этой странице. Во-вторых предоставить список разрешений и разрешения секретов на этот идентификатор участника на хранилище ключей Azure, содержащего сертификат.
    >
    > Если сертификат имеет значение autorotate, API управления получают последнюю версию автоматически без простоев в работе службы (если уровень управления API соглашение об уровне ОБСЛУЖИВАНИЯ - e. i. на всех уровнях, за исключением уровень "Разработка").

1. Нажмите кнопку "Применить".

    > [!NOTE]
    > Назначение сертификата может занять 15 или более минут в зависимости от размера развертывания. Для номера SKU для разработчиков характерен простой, а для номеров SKU "Базовый" и выше такого простоя нет.

[!INCLUDE [api-management-custom-domain](../../includes/api-management-custom-domain.md)]

## <a name="next-steps"></a>Дальнейшие действия

[Повышение категории и масштабирование службы](upgrade-and-scale.md)
