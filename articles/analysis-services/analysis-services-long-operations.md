---
title: Рекомендации для длительных операций в службах анализа Azure Документы Майкрософт
description: В этой статье описаны рекомендации для длительных операций.
author: minewiskan
ms.service: analysis-services
ms.topic: conceptual
ms.date: 04/14/2020
ms.author: owend
ms.openlocfilehash: 3f6b2194cc422a827bbc7a15c012173b3f814b52
ms.sourcegitcommit: b80aafd2c71d7366838811e92bd234ddbab507b6
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/16/2020
ms.locfileid: "81428112"
---
# <a name="best-practices-for-long-running-operations"></a>Лучшие практики для длительных операций

В службах анализа Azure *узел* представляет собой виртуальную машину с использованием серверного ресурса. Некоторые операции, такие как длительные запросы, операции обновления и синхронизация масштабирования запросов, могут выйти из строя, если ресурс сервера перейдет в другой участок. Общие сообщения об ошибках в этом сценарии включают:

- "Ошибка произошла при попытке найти длительный запрос XMLA. Запрос может быть прерван обновлением службы или перезапуском сервера».
- "Job with<guid>ID '<database>для модели ' был отменен из-за ошибки в обслуживании (бездействия) с сообщением 'Отмена запроса на обновление, так как он застрял без каких-либо обновлений. Это внутренняя проблема службы. Пожалуйста, повторно отправьте задание или подайте билет, чтобы получить помощь, если эта проблема возникает неоднократно".

Существует множество причин, по которым длительные операции могут быть нарушены. Например, обновления в Azure, такие как: 
- Патчи операционной системы 
- Обновления для системы безопасности
- Обновления службы анализа Azure
- Обновления сервисной ткани. Service Fabric — это компонент платформы, используемый рядом облачных служб Майкрософт, включая службы анализа Azure.

Помимо обновлений, которые происходят в службе, существует естественное движение услуг по узлам из-за балансировки нагрузки. Движения узлов являются ожидаемой частью облачной службы. Службы анализа Azure пытаются свести к минимуму воздействие движений узлов, но полностью устранить их невозможно. 

В дополнение к движениям узлов, есть и другие сбои, которые могут произойти. Например, система базы данных может быть автономной или потеряно подключение к сети. Если во время обновления раздел имеет 10 миллионов строк и сбой происходит в 9-миллионном ряду, нет никакого способа перезапустить обновление в момент сбоя. Служба должна начаться заново с самого начала. 

## <a name="refresh-rest-api"></a>Обновление АИП REST

Перебои в обслуживании могут быть сложными для длительных операций, таких как обновление данных. Службы анализа Azure включают API REST, который поможет смягчить негативные последствия перебоев в работе служб. Чтобы узнать больше, смотрите [Асинхронное обновление с помощью REST API](analysis-services-async-refresh.md).
 
Помимо REST API, существуют и другие подходы, которые можно использовать для минимизации потенциальных проблем во время длительных операций обновления. Основная цель состоит в том, чтобы избежать необходимости перезагрузки операции обновления с самого начала, а вместо этого выполнять обновления в небольших партиях, которые могут быть зафиксированы поэтапно. 
 
REST API позволяет такой перезапуск, но не обеспечивает полной гибкости создания и удаления разделов. Если сценарий требует сложных операций управления данными, решение должно включать в свою логику некоторую форму пакетирования. Например, с помощью транзакций для обработки данных в нескольких отдельных пакетах допускается отказ не требовать перезагрузки с самого начала, а вместо промежуточной контрольной точки. 
 
## <a name="scale-out-query-replicas"></a>Рекопии запросов масштабирования

Независимо от того, используете ли rest или пользовательскую логику, запросы клиентских приложений могут по-прежнему возвращать несовместимые или промежуточные результаты во время обработки пакетов. Если во время обработки требуется согласованная информация, возвращенная запросами клиентских приложений, а данные модели — в промежуточном состоянии, можно использовать [масштабирование](analysis-services-scale-out.md) с помощью реплик запросов только для чтения.

Используя реплики запроса только для чтения, в то время как обновления выполняются в пакетах, пользователи клиентских приложений могут продолжать зажимировать старый снимок данных на репликах только для чтения. После завершения обновления можно выполнить операцию Synch, чтобы привести реплики только для чтения в актуальном состоянии.


## <a name="next-steps"></a>Дальнейшие действия

[Asynchronous refresh with the REST API](analysis-services-async-refresh.md) (Асинхронное обновление с помощью REST API)  
[Горизонтальное масштабирование служб Azure Analysis Services](analysis-services-scale-out.md)  
[Высокая доступность служб Analysis Services](analysis-services-bcdr.md)  
[Руководство по повторной попытке для служб Azure](https://docs.microsoft.com/azure/architecture/best-practices/retry-service-specific)   

