---
title: Охранники развертывания service Fabric Azure
description: В этой статье приводится обзор распространенных ошибок, допущенных при развертывании кластера Service Fabric через Azure Resource Manager, и способы их предотвращения.
services: service-fabric
documentationcenter: .net
author: peterpogorski
ms.topic: conceptual
ms.date: 02/13/2020
ms.author: pepogors
ms.openlocfilehash: a61b0cf30ca46eb77837eb09d6a9a0b6f30e89a9
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/27/2020
ms.locfileid: "77368576"
---
# <a name="service-fabric-guardrails"></a>Сервис Ткань ограждения 
При развертывании кластера Service Fabric вводятся ограждения, которые сведут на нет развертывание диспетчера ресурсов Azure в случае недействительной конфигурации кластера. Следующие разделы предоставляют обзор общих проблем конфигурации кластеров и шагов, необходимых для смягчения этих проблем. 

## <a name="durability-mismatch"></a>Несоответствие долговечности
### <a name="overview"></a>Обзор
Значение долговечности для типа узла узла service Fabric определяется в двух разных разделах шаблона управления ресурсами Azure. Раздел расширения набора виртуальной шкалы машин ресурса "Настройка виртуальной шкалы машины" и раздел "Тип узлов" кластерного ресурса Service Fabric. Это требование, чтобы значение долговечности в этих разделах совпадает, в противном случае развертывание ресурсов не удастся.

Следующий раздел содержит пример несоответствия прочности между настройками прочности удлинители удлинители удлинители удлинители комплекта комплектации Virtual Machine Scale и параметром долговечности типов типов узлов Service Fabric Type:  

**Настройка прочности виртуальной шкалы машины**
```json 
{
  "extensions": [
    {
      "name": "[concat('ServiceFabricNodeVmExt','_vmNodeType0Name')]",
      "properties": {
        "type": "ServiceFabricNode",
        "publisher": "Microsoft.Azure.ServiceFabric",
        "settings": {
          "durabilityLevel": "Silver",
        }
      }
    }
  ]
}
```

**Настройка прочности узла узла service Fabric** 
```json
{
  "nodeTypes": [
    {
      "name": "[variables('vmNodeType0Name')]",
      "durabilityLevel": "Bronze",
      "isPrimary": true,
      "vmInstanceCount": "[parameters('nt0InstanceCount')]"
    }
  ]
}
```

### <a name="error-messages"></a>Сообщения об ошибках
* Виртуальная шкала машины Установить прочность несоответствие не соответствует текущему сервису Ткань Узел Тип долговечности
* Виртуальная машина шкала Установить долговечность не соответствует целевой сервис Ткани Узел Тип долговечности уровне
* Виртуальная машина шкала Установить долговечность действительно соответствует текущему уровню прочности ткани службы или целевой сервис Ткань Узла Тип долговечности уровне 

### <a name="mitigation"></a>Меры по снижению риска
Чтобы исправить несоответствие прочности, которое указывается любым из вышеуказанных сообщений об ошибке:
1. Обновление уровня долговечности в расширении набора виртуальной шкалы машин или в разделе Service Fabric Node Type шаблона управления ресурсами Azure, чтобы убедиться, что значения совпадают.
2. Передислоцировать шаблон менеджера ресурсов Azure с обновленными значениями.


## <a name="seed-node-deletion"></a>Удаление узла семян 
### <a name="overview"></a>Обзор
Кластер Service Fabric имеет свойство [уровня надежности,](https://docs.microsoft.com/azure/service-fabric/service-fabric-cluster-capacity#the-reliability-characteristics-of-the-cluster) которое используется для определения количества реплик системных служб, которые работают на типе основного узла кластера. Количество требуемых реплик определяет минимальное количество узлов, которые должны быть сохранены в типе основного узла кластера. Если количество узлов в типе первичного узла будет ниже необходимого минимума для уровня надежности, кластер станет нестабильным.  

### <a name="error-messages"></a>Сообщения об ошибках 
Операция удаления узла семян была обнаружена и будет отклонена. 
* Эта операция приведет {0} к тому, что в кластере {1} останутся только потенциальные узлы семян, в то время как они необходимы как минимум.
* Удаление {0} узла семян {1} из приведет к тому, что кластер снизится из-за потери кворума семенного узла. Максимальное количество семенных узлов, которые могут {2}быть удалены за один раз.
 
### <a name="mitigation"></a>Меры по снижению риска 
Убедитесь, что ваш основной тип узла имеет достаточно виртуальных машин для надежности, указанной в кластере. Вы не сможете удалить Виртуальную машину, если она приведет к набору виртуальной шкалы машин ниже минимального количества узлов для данного уровня надежности.
* Если уровень надежности правильно указан, убедитесь, что у вас достаточно узлов в типе первичного узла по мере необходимости для уровня надежности. 
* Если уровень надежности неверен, инициируйте изменение ресурса Service Fabric, чтобы сначала снизить уровень надежности, прежде чем инициировать операции виртуального набора шкалы машин, и подождите, пока он будет завершен.
* Если уровень надежности бронзовый, пожалуйста, выполните эти [шаги,](https://docs.microsoft.com/azure/service-fabric/service-fabric-cluster-scale-up-down#manually-remove-vms-from-a-node-typevirtual-machine-scale-set) чтобы изящно сократить свой кластер.

## <a name="next-steps"></a>Дальнейшие действия
* Создание кластера на основе виртуальных машин или компьютеров под управлением Windows Server: [Создание кластера Azure Service Fabric в локальной или облачной средах](service-fabric-cluster-creation-for-windows-server.md)
* Создание кластера на основе виртуальных машин или компьютеров под управлением Linux: [Создание кластера Linux](service-fabric-cluster-creation-via-portal.md).
* Troubleshoot Сервис Ткань: [Устранение неполадок руководства](https://github.com/Azure/Service-Fabric-Troubleshooting-Guides)
