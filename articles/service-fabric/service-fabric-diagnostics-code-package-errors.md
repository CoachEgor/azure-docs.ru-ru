---
title: Диагностика общих ошибок пакета кода с помощью Service Fabric
description: Узнайте, как устранить общие ошибки пакета кода с помощью Azure Service Fabric
author: grzuber
ms.topic: article
ms.date: 05/09/2019
ms.author: grzuber
ms.openlocfilehash: 344fef70522240da2236a020c96308c472c9c545
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/27/2020
ms.locfileid: "75463109"
---
# <a name="diagnose-common-code-package-errors-by-using-service-fabric"></a>Диагностика общих ошибок пакета кода с помощью Service Fabric

В этой статье описывается, что означает для неожиданного завершения пакета кода. Он дает представление о возможных причинах общих кодов ошибок, а также о шагах устранения неполадок.

## <a name="when-does-a-process-or-container-terminate-unexpectedly"></a>Когда процесс или контейнер завершается неожиданно?

Когда Azure Service Fabric получает запрос на запуск пакета кода, она начинает подготовку среды в локальной системе в соответствии с опциями, установленными в манифестах Приложения и службы. Эти приготовления могут включать в себя резервирование конечных точек или ресурсов сети, настройку правил брандмауэра или настройку ограничений управления ресурсами. 

После правильной настройки среды Service Fabric пытается создать пакет кода. Этот шаг считается успешным, если Время выполнения ОС или контейнера сообщает, что процесс или контейнер активирован успешно. Если активация не удана, вы должны увидеть сообщение о работоспособности в SFX, которое напоминает следующее:

```
There was an error during CodePackage activation. Service host failed to activate. Error: 0xXXXXXXXX
```

После успешной активации пакета кода Service Fabric начинает мониторинг своего срока службы. На этом этапе процесс или контейнер могут быть завершены в любое время по ряду причин. Например, он мог бы не инициализировать DLL, или ОС может исчерпать место рабочей койки. Если пакет кода завершен, вы должны увидеть следующее сообщение о работоспособности в SFX:

```
The process/container terminated with exit code: XXXXXXXX. Please look at your application logs/dump or debug your code package for more details. For information about common termination errors, please visit https://aka.ms/service-fabric-termination-errors
```

Код выхода в этом сообщении о работоспособности является единственным ключом к тому, что процесс или контейнер дает информацию о том, почему он прекратился. Он может быть сгенерирован любым уровнем стека. Например, этот код выхода может быть связан с ошибкой ОС или проблемой .NET, или он может быть поднят вашим кодом. Используйте эту статью в качестве отправной точки для диагностики источника кодов выхода на исход и возможных решений. Но имейте в виду, что это общие решения для общих сценариев и не могут применяться к ошибке, которую вы видите.

## <a name="how-can-i-tell-if-service-fabric-terminated-my-code-package"></a>Как усомниться в том, что Service Fabric прекратила действие пакета кода?

Service Fabric может быть ответственна за прекращение пакета кода по ряду причин. Например, он может принять решение разместить пакет кода на другом узах для целей балансировки нагрузки. Вы можете проверить, что Service Fabric прекратила пакет кодов, если видите какой-либо из кодов выхода в следующей таблице.

>[!NOTE]
> Если ваш процесс или контейнер завершается с кодом выхода, кроме кодов в следующей таблице, Service Fabric не несет ответственности за его прекращение.

Код выхода | Описание
--------- | -----------
7147 | Означает, что Service Fabric изящно выключил процесс или контейнер, отправив ему сигнал Ctrl-C.
7148 | Указывается, что Service Fabric прекратилпроцесс процесса или контейнера. Иногда этот код ошибки указывает на то, что процесс или контейнер не ответили своевременно после отправки сигнала Ctrl-C, и он должен был быть прекращен.


## <a name="other-common-error-codes-and-their-potential-fixes"></a>Другие общие коды ошибок и их потенциальные исправления

Код выхода | Гексадецимальная ценность | Краткое описание | Первопричина | Потенциальное исправление
--------- | --------- | ----------------- | ---------- | -------------
3221225794 | 0xc000142 | STATUS_DLL_INIT_FAILED | Эта ошибка иногда означает, что машина исчерпает пространство рабочего стола. Эта причина особенно вероятна, если у вас есть многочисленные процессы, которые принадлежат вашему приложению, работая на уде. | Если ваша программа не была построена для реагирования на сигналы Ctrl-C, вы можете включить настройку **EnableActivateNoWindow** в манифесте кластера. Включение этой настройки означает, что пакет кода будет работать без окна ГРАФИЧЕСКОго интерфейса и не будет получать сигналы Ctrl-C. Это действие также уменьшает количество рабочего стола кучу пространства каждый процесс потребляет. Если пакет кода должен принимать сигналы Ctrl-C, вы можете увеличить размер рабочей кучи вашего узла.
3762504530 | 0xe0434352 | Недоступно | Это значение представляет собой код ошибки для необработанного исключения из управляемого кода (т.е. .NET). | Этот код выхода указывает на то, что приложение вызвало исключение, которое остается необработанным и которое завершило процесс. В качестве первого шага в определении того, что вызвало эту ошибку, отладить журналы приложения и файлы сброса.

## <a name="next-steps"></a>Дальнейшие действия

* Подробнее о [диагностике других распространенных сценариев.](service-fabric-diagnostics-common-scenarios.md)
* Получите более подробный обзор журналов Azure Monitor и их предложения, прочитав [обзор Azure Monitor.](../operations-management-suite/operations-management-suite-overview.md)
* Узнайте больше о журналах Azure Monitor, предупреждающих об [оказании помощи](../log-analytics/log-analytics-alerts.md) в обнаружении и диагностике.
* Ознакомьтесь с функциями [поиска журналов и запросов,](../log-analytics/log-analytics-log-searches.md) предлагаемых в рамках журналов Azure Monitor.
