---
title: Введение в микрослужбы в Azure | Документация Майкрософт
description: Общие сведения о том, почему создание облачных приложений с использованием микрослужб важно для разработки современных приложений и как платформа Azure Service Fabric позволяет достичь этой цели.
services: service-fabric
documentationcenter: .net
author: athinanthny
manager: chackdan
editor: ''
ms.assetid: fae2be85-0ab4-4cd3-9d1f-e0d95fe1959b
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: conceptual
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 06/18/2019
ms.author: atsenthi
ms.openlocfilehash: 5bcb52165c7cae18b807eff03c80b51eae8e2717
ms.sourcegitcommit: b7a44709a0f82974578126f25abee27399f0887f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/18/2019
ms.locfileid: "67204807"
---
# <a name="why-use-a-microservices-approach-to-building-applications"></a>Зачем использовать для создания приложений с использованием?

Для разработчиков программного обеспечения необходимым разбивать приложения на компоненты нет ничего нового. Как правило многоуровневый подход используется, с серверным хранилищем, бизнес-логики среднего уровня и внешнего интерфейса пользовательский интерфейс (UI). Что *имеет* изменены за последние несколько лет — что разработчики стали создавать распределенные приложения для облака.

Ниже приведены некоторые меняющимся потребностям бизнеса.

* Служба, которая Коллектив разработал и в нужном масштабе для взаимодействия с клиентами в новых географических регионах.
* Ускоренное предоставление функций и возможностей для реагирования на запросы клиентов гибкие возможности.
* Более эффективное использование ресурсов, позволяющее снизить затраты.

Эти бизнес-потребности определяют *способ* сборки приложений.

Дополнительные сведения о Azure подходе к микрослужбам см. в разделе [Микрослужб: микрослужб для приложений на основе облака](https://azure.microsoft.com/blog/microservices-an-application-revolution-powered-by-the-cloud/).

## <a name="monolithic-vs-microservices-design-approach"></a>Монолитные и разработке с использованием микрослужб

По прошествии времени приложения развиваются. Успешные приложения развиваются за счет использования. Неудачные приложения не развиваются и в конечном счете являются устаревшими. Вот вопрос: как много вы знаете о требования к уже сегодня и что они будут в будущем? Например предположим, что вы создаете приложения для создания отчетов для определенного подразделения в организации. Вы уверены в том случае, приложение применяет только в пределах вашей компании, и что отчеты не будут сохраняться long. Ваш подход будет отличаться от того, скажем, создать службу, которая для доставки видеоматериалов десяткам миллионов клиентов.

Иногда внедрение чего-либо на практике подтверждения концепции является решающим фактором. Известно, что приложение можно переработать в более поздней версии. Нет особого смысла перерабатывать то, что никогда не используется. С другой стороны когда компании сборка для облака, ожидается рост и использование. Расширение и масштаб непредсказуемо. Мы хотим прототип быстро при этом также знать, что мы по пути, который может обрабатывать будущему успеху. Подход, который применяют небольшие новые компании, включает сборку, измерение, анализ данных и повторение всего цикла.

В эпоху клиент сервер мы находились сосредоточиться на создании многоуровневых приложений с использованием определенных технологий на каждом уровне. Термин *монолитных* приложения произошел для описания этих подходов. Интерфейсы находились как бы между уровнями, а в рамках самого уровня компоненты были более тесно связаны. При разработке и разделении классы компилировались в библиотеки и в несколько исполняемых файлов и библиотек DLL объединялись.

Существуют преимущества подхода монолитные конструкции. Монолитные приложения зачастую проще проектирования, а вызовы между компонентами выполняются быстрее, поскольку эти вызовы часто превышают межпроцессного взаимодействия (IPC). Кроме того все пользователи могут тестировать один продукт, что обычно более эффективно использовать отдела кадров. Недостатком является, что имеется тесной связи между уровней и невозможность масштабирования отдельных компонентов. Если вам нужно сделать исправлений или обновлений, необходимо дождаться, пока другие завершат тестирование. Довольно сложно быть гибкими.

Микрослужбы устранить эти недостатки и более точного соответствия бизнес-требованиям. Но они также имеют преимущества и обязательств. Преимущества микрослужб состоят в том, что обычно каждая из них включает в себя простые бизнес-функции, а также поддерживает возможность независимого вертикального масштабирования, тестирования, развертывания и управления. Одно из важных преимуществ микрослужб является то, что команд см. по бизнес-сценариев, чем на основе технологии. Небольшие команды разрабатывают микрослужбу на основе сценария клиента и использовать любой технологии, которые они хотят использовать.

Иными словами, организации не нужно стандартизировать технологии для поддержки своих приложений для микрослужб. Отдельные команды, владеющие службами, могут делать то, что они считают целесообразным, исходя из собственных знаний или подходящих действий для решения задачи. На практике набор рекомендуется технологиями, такими как конкретного хранилища NoSQL или платформы веб-приложений, является предпочтительным.

Недостаток микрослужб является наличие управлять более отдельными сущностями и иметь дело с более сложные развертывания и управления версиями. Сетевой трафик между микрослужбами увеличивается, как соответствующие задержки сети. Множество активных служб может привести к катастрофического снижения производительности. Без инструментов, чтобы просмотреть эти зависимости трудно см. в разделе всей системы.

Стандарты сделать микрослужбах следовать, указав способ связи клиента и необходимостью только те задачи, которые вам понадобятся из службы, а не жесткой контракты. Очень важно определить эти контракты заранее в разработке, так как службы обновляются независимо друг от друга. При разработке приложений с использованием микрослужб выделяется еще одна характеристика — мелкомодульная сервисноориентированная архитектура (SOA).

***В простейшем случае подход к разработке микрослужб является применяются несвязанные федерации служб с независимых изменений каждой из них и согласованные стандарты для обмена данными.***

По мере создания дополнительных облачных приложений, пользователи обнаружили, что такая декомпозиция всего приложения на отдельные ориентированные на сценарии службы, — это лучше долгосрочное подход.

## <a name="comparison-between-application-development-approaches"></a>Сравнение подходов к разработке приложений

![Разработка приложений на платформе Service Fabric][Image1]

1) Монолитное приложение содержит функции доменный и обычно делятся на функциональные уровни, такие как web, business и данных.

2) Масштабирование монолитного приложения путем клонирования на нескольких серверах или виртуальных машин и контейнеров.

3) В приложениях, состоящих из микрослужб, функциональные возможности распределены между отдельными службами меньшего размера.

4) Подход с использованием микрослужб дает возможность масштабировать приложения, развертывая каждую службу независимо от других и создавая экземпляры этих служб на разных серверах и виртуальных машинах и в разных контейнерах.

При разработке микрослужб подход не подходит для всех проектов, но он позволяет более точно бизнес-целям, описанные ранее. Начиная с применить Монолитный подход может оказаться целесообразным, если известно, что у вас будет возможность позже переработать код внедрения микрослужб. Но чаще всего разработчики сначала создают монолитное приложение, а затем медленно и поэтапно разделяют его, начиная с функциональных областей, в которых следует увеличить масштабируемость и гибкость.

При использовании микрослужб, создании приложения из множества мелких служб. Эти службы работают в контейнерах, развернутых в кластере виртуальных машин. Небольшие команды разрабатывают службу, ориентированную на сценарии и независимо друг от друга тестирование, управление версиями, развертывание и масштабировать каждой службы. таким образом можно развивать всего приложения.

## <a name="what-is-a-microservice"></a>Что такое микрослужба

Существует много определений микрослужб. Но большинство из этих характеристик микрослужб широко принимаются:

* Инкапсуляция сценария клиента или бизнес-сценария. Какую проблему требуется решить?
* Разработка небольшими командами разработчиков.
* Написанные на любом языке программирования, используя любую платформу.
* Состоят из кода, и при необходимости состояние, каждый из которых является независимо друг от друга с версиями, развертывание и масштабирование.
* Взаимодействие с другими микрослужбами с помощью четко определенных интерфейсов и протоколов.
* Иметь уникальные имена (URL-адреса), которые используются для определения их расположения.
* Обеспечение стабильности работы и доступности в случае сбоя.

Чтобы суммировать:

***Приложения, состоящие из микрослужб, формируются из небольших ориентированных на клиента служб с независимым управлением версиями и масштабированием, которые взаимодействуют по стандартным протоколам с применением четко определенных интерфейсов.***

### <a name="written-in-any-programming-language-using-any-framework"></a>Написанные на любом языке программирования, используя любую платформу

Как разработчиков мы хотим могут выбирать язык или платформу, в зависимости от своих навыков и потребностей службы, мы создаем. Для некоторых служб могут иметь большее значение преимущества производительности C++ выше что-нибудь еще. Для других пользователей, простота управляемой разработки, которую можно получить из C# или Java может быть более важным. В некоторых случаях может потребоваться использовать определенные партнерские библиотеки, технологии хранения данных или метод для предоставления службы клиентам.

После того как вы выберете это технология, необходимо учитывать рабочей или жизненного цикла управления и масштабирования службы.

### <a name="allows-code-and-state-to-be-independently-versioned-deployed-and-scaled"></a>Возможность независимого управления версиями, развертывания и масштабирования кода и состояния

Независимо от того, как написать микрослужб, код и при необходимости состояние следует независимо друг от друга развертывание, обновление и масштабирование. Эту проблему сложно решить, так как все сводится к выбору технологий. Для масштабирования, основные сведения о том, как секционировать (или сегментировать) код и состояние — сложная задача. Если код и состояние используются различных технологий, которые сегодня является распространенным, в скриптах развертывания микрослужбы должна иметь возможность масштабировать их обоих. Такое разделение тоже и динамичность использования, поэтому некоторые из микрослужбы можно обновить без необходимости обновления их все за один раз.

Давайте вернемся к нашей сравнение подходов монолитные и микрослужбы на некоторое время. На этой схеме показаны различия в подходах к хранению состояния.

#### <a name="state-storage-for-the-two-approaches"></a>Сохранение состояния для двух подходов

![Хранилище состояний платформы Service Fabric][Image2]

***Монолитный подход с левой стороны экрана имеет отдельную базу данных и уровнями определенных технологий.***

***Подходы, справа, имеет график взаимосвязанных микрослужб, где состояние обычно ограничивается отдельной микрослужбой и используются различные технологии.***

Монолитное приложение, как правило, использует отдельную базу данных. Чтобы использовать одну базу данных удобен тем, что она находится в одном месте, что упрощает развертывание. У каждого компонента может быть одна таблица для хранения данных о состоянии. Сложность состоит в том, что командам разработчиков необходимо строго разграничивать состояния. Неизбежно кто-то будет соблазн добавить столбец в существующую таблицу customer, соединения между таблицами и создать зависимости на уровне хранилища. Однако в таком случае будет невозможно масштабировать отдельные компоненты.

При подходе с использованием микрослужб каждая служба управляет собственным состоянием и хранит данные о нем. Каждая служба отвечает за масштабирование кода и состояния для обеспечения соответствия собственным требованиям. Недостатком является то, что при необходимости для создания представлений и запросов данных приложения, также необходимость запроса по нескольким хранилищам состояния. Эта проблема обычно решается путем отдельную микрослужбу, которая создает представление коллекции микрослужб. Если вам нужно выполнить несколько нерегламентированных запросов к данным, следует записи каждой микрослужбы данных в службу хранилища данных для автономной аналитике.

Микрослужбы являются с контролем версий. Это разные версии микрослужбы для запуска рядом друг с другом. Более новой версии микрослужбы может завершиться ошибкой во время обновления и необходимо выполнить откат до более ранней версии. Управление версиями также полезен для A / B тестирования, где разные пользователи используют разные версии службы. Например довольно часто для обновления микрослужбы для определенной группы клиентов, которые тестируют новые функциональные возможности, прежде чем внедрять его более широко.

### <a name="interacts-with-other-microservices-over-well-defined-interfaces-and-protocols"></a>Взаимодействие с другими микрослужбами с применением четко определенных интерфейсов и протоколов

За последние 10 лет обширной информации опубликован Описывает шаблоны взаимодействия в архитектурах, ориентированных на службы. Сейчас, как правило, для взаимодействия между службами используется REST, протоколы HTTP и TCP, а также формат сериализации XML или JSON. С точки зрения интерфейса это о работе веб-дизайна. Но ничего не должно остановить вас от применять двоичные протоколы или собственные форматы данных. Просто Учтите, что люди будет сложнее пользоваться вашими микрослужбами, если эти протоколы и форматы не появятся в открытом доступе.

### <a name="has-a-unique-name-url-used-to-resolve-its-location"></a>Уникальное имя (URL-адрес), используемое для распознавания расположения

Микрослужба должна быть адресуемой везде, где он выполняется. Если вы сейчас думаете о машинах и какой из них выполняется определенная микрослужба, можно заведомо неправильный подход.

Микрослужба должна иметь уникальное имя, позволяющее обнаружить ее расположение, подобно тому, как DNS разрешает URL-адрес для конкретного компьютера. Микрослужбам требуются адресуемые имена, которые не зависят от инфраструктуры, в котором они выполняются на. Это значит, что взаимодействие между развертыванием службы и ее обнаружением, так как необходимость в реестре службы. При сбое компьютера служба реестра должна сообщит о том, где служба была перемещена.

### <a name="remains-consistent-and-available-in-the-presence-of-failures"></a>Стабильность работы и доступность в случае сбоя

Устранение неожиданных сбоев — одна из самых труднорешаемых задач, особенно в распределенной системе. Большая часть кода, который пишут разработчики — для обработки исключений. Во время тестирования, мы также можно потратить больше всего времени на обработку исключений. Процесс требует больше усилий, чем написание кода для обработки сбоев. Что происходит при сбое компьютера, на котором работает микрослужба? Необходимо определить сбой, что бывает непросто сам по себе. Но вам также нужно перезапустить микрослужбу.

Доступность микрослужба должна быть устойчива к сбоям и возможность перезапуска на другом компьютере. Помимо этих требований к отказоустойчивости данные не должны быть потеряны, и необходимо поддерживать целостность данных.

Устойчивости трудно достичь при возникновении сбоев во время обновления приложения. Микрослужбе, работающей с системой развертывания, не требуется восстановление. Требуется определить ли он может продолжать переход к более новой версии или откат к предыдущей версии, чтобы поддерживать согласованное состояние. Необходимо учитывать ряд вопросов, касающихся, доступны ли достаточно компьютеров для двигаться вперед, а также как восстанавливать предыдущие версии микрослужбы. Для принятия этих решений требуется микрослужба должна передавать информацию о состоянии.

### <a name="reports-health-and-diagnostics"></a>Передача информации о работоспособности и диагностических данных

Может показаться очевидным и часто забывают, но микрослужба должна сообщить о своей работоспособности и диагностике. В противном случае у вас есть сведения о его работоспособности с точки зрения операций. Сложность заключается не только в выявлении связи между диагностическими событиями для ряда независимых служб, но и в сопоставлении расхождений в показаниях часов компьютера для определения порядка событий. Как и при взаимодействии с микрослужбами с использованием согласованных протоколов и форматов данных, необходимо стандартизировать способ ведения журнала событий работоспособности и диагностических событий, которые в конечном счете оказываются в хранилище событий, к которому можно обращаться для просмотра данных и создания запросов. С использованием микрослужб разные команды должны согласовать единый формат ведения журнала. В приложении должен использоваться согласованный подход к просмотру диагностических событий.

Данные о работоспособности и диагностические данные — это не одно и то же. Отчет о работоспособности микрослужбы — это данные о ее текущем состоянии, необходимые для принятия соответствующих мер. Хорошим примером является работа с механизмами обновления и развертывания для обеспечения доступности. Хотя служба может быть в неработоспособном состоянии из-за сбоя процессов или перезагрузки компьютера, служба может по-прежнему работать. Последнее, что нужно — это чтобы сделать плохой ситуации с начала обновления. Лучше проанализировать в первую очередь или дождаться восстановления микрослужбы. События работоспособности микрослужбы помогают принимать обоснованные решения и фактически помогают создавать службы с возможностью самовосстановления.

## <a name="guidance-for-designing-microservices-on-azure"></a>Руководство по разработке микрослужб в Azure 
Посетите Центр архитектуры Azure рекомендации на [проектирование и создание микрослужб в Azure](https://docs.microsoft.com/azure/architecture/microservices/).

## <a name="service-fabric-as-a-microservices-platform"></a>Платформа микрослужб Service Fabric

Azure Service Fabric появилось при переходе Майкрософт от предоставления упакованный продуктов, зачастую монолитных, для предоставления служб. Service Fabric ее создании учитывался опыт разработки и эксплуатации масштабных служб, таких как базы данных SQL Azure и Azure Cosmos DB. Платформа развиваться по мере внедрения во больше служб. Service Fabric работает не только в среде Azure, но и в автономных развертываниях Windows Server.

***Целью Service Fabric — решать сложные проблемы при построении и запуске службы и эффективно использовать ресурсы инфраструктуры, поэтому командам решать бизнес-задач с помощью микрослужб.***

Service Fabric позволяет создавать приложения в рамках подхода с использованием микрослужб, предоставляя следующее:

* Платформа, которая предоставляет системные службы для развертывания, обновления, обнаружения и перезапуска служб, в которых произошел сбой, а также обнаружения служб, маршрутизации сообщений, управления состоянием и мониторинга работоспособности.
* Возможность развертывания приложений, выполняемых в контейнерах или в виде процессов. Service Fabric — это контейнер и оркестратор процессов.
* Эффективные программные интерфейсы, которые помогут вам создавать приложения как микрослужбы: [Общие сведения о модели программирования Service Fabric](service-fabric-choose-framework.md). К примеру, вы можете получать информацию о работоспособности и данные диагностики, а также пользоваться преимуществами встроенных средств, обеспечивающих высокую доступность.

***Service Fabric — это не влияет на работу как создать службу, и вы можете использовать любую технологию. Но эта платформа предоставляет встроенные API программирования, которые облегчают создание микрослужб.***

### <a name="migrating-existing-applications-to-service-fabric"></a>Перенос существующих приложений в Service Fabric

Service Fabric позволяет повторно использовать существующий код и модернизировать его с помощью новых микрослужб. Существует пять этапов модернизации приложения, и можно начать и остановить на любом этапе. Ниже приведены этапы.

1) начать с традиционного монолитного приложения.  
2) Перенос. Использование контейнеров или гостевых исполняемых файлов для размещения существующего кода в Service Fabric.  
3) Модернизация. Добавление новых микрослужб существующему контейнерному коду.  
4) Непрерывные Разбейте монолитное приложение на микрослужбы на основе потребностей.  
5) Преобразование приложения на микрослужбы. Преобразование существующих монолитных приложений или создавать новые приложения с нуля.

![Переход на микрослужбы][Image3]

Помните, что вы можете *начать и остановить любой из этих этапов*. У вас нет для хода выполнения на следующий этап. 

Давайте рассмотрим примеры для каждого из этих этапов.

**Миграция**  
По двум причинам многие компании переходят имеющиеся монолитные приложения в контейнеры:

* Снижение стоимости, из-за консолидации и удаления существующего оборудования или из-за запуска приложений с более высокой плотностью.
* Контракт о согласованном развертывании между разработкой и операциями.

Сокращение расходов просты. В корпорации Microsoft многих существующих приложений выполняется в контейнерах, что приводит к миллионы долларов экономии. Обеспечить согласованное развертывание труднее оценить, но важна. Это означает, что разработчики могут выбрать технологии, в соответствии с их, но операции будет принимать только один метод для развертывания и управления приложениями. Она устраняет операций приходится иметь дело с сложности поддержки различных технологий не принуждает разработчиков, чтобы выбрать только некоторых из них. По сути каждое приложение упаковывается в автономный развертываемый образ.

На этом многие организации останавливаются. У них уже есть преимущества контейнеров и Service Fabric предоставляет все возможности управления, включая развертывание, обновление, управление версиями, отката и наблюдение за работоспособностью.

**Модернизируйте**  
Модернизация заключается в добавлении новых служб к существующему контейнерному коду. Если вы собираетесь написать новый код, лучше воспользоваться понемногу путь микрослужб. Это означает добавление новой конечной точки REST API или новые бизнес-логики. Таким образом запустить процесс создания новых микрослужбами и освоите их разработку и развертывание.

**Инновации**  
Подход с использованием микрослужб позволит учесть изменяющиеся требования бизнеса. На этом этапе необходимо решить, нужно ли начинать применение разделение монолитного приложения в службы или внедрение инноваций. Классический пример — когда базы данных, которая используется в качестве очереди рабочего процесса становится узким местом обработки. По мере увеличения количества запросов рабочих процессов работа должна распределяться соответственно масштабу. Взять эту конкретного приложения, не масштабируется или который необходимо будет обновляться чаще и разделить его как микрослужбы и внедряйте инновации.

**Преобразование приложения на микрослужбы**  
На этом этапе приложение полностью состоит из (или разбивать на) микрослужб. Для достижения этой точки, вы внесли путешествие микрослужб. Вы можете начать с этого, но сделать это без микрослужб платформы требует значительных вложений.

### <a name="are-microservices-right-for-my-application"></a>Подходят ли микрослужбы моему приложению?

Возможно. В корпорации Microsoft как другие команды начинают разрабатывать облачные приложения для бизнес-многие из них реализовать преимущества микрослужб по принципу подход. Bing, например, использующий микрослужбы лет. Для других команд этот подход был новым. Они столкнулись со сложными проблемами, которые им не удалось решить. Именно поэтому Service Fabric быстро заслужила популярность как технология для создания служб.

Цель Service Fabric — для уменьшения сложности создания приложений для микрослужб, таким образом, чтобы не нужно проходить через столько дорогостоящих переделки проекта. Принцип использования платформы: создание небольшого приложения, масштабирование по мере необходимости, удаление устаревших служб, добавление новых служб и развитие приложения по мере использования клиентами. Мы знаем: чтобы сделать микрослужбы более доступными для большинства разработчиков, следует решить еще множество проблем. Контейнеры и модель программирования субъектов — примеры маленьких шагов в этом направлении. Мы уверены, что упрощает микрослужб создаст еще множество инноваций.


## <a name="next-steps"></a>Дальнейшие действия

* [Microservices: An application revolution powered by the cloud](https://azure.microsoft.com/blog/microservices-an-application-revolution-powered-by-the-cloud/) (Микрослужбы. Революция приложений в облаке)
* [Центр архитектуры Azure: Проектирование микрослужб в Azure](https://docs.microsoft.com/azure/architecture/microservices/)
* [Рекомендации по Azure Service Fabric приложения и кластера](service-fabric-best-practices-overview.md)
* [Общие сведения о терминологии Service Fabric](service-fabric-technical-overview.md)

[Image1]: media/service-fabric-overview-microservices/monolithic-vs-micro.png
[Image2]: media/service-fabric-overview-microservices/statemonolithic-vs-micro.png
[Image3]: media/service-fabric-overview-microservices/microservices-migration.png
