---
title: Веб-вход с помощью OpenID Connect Connect-Azure Active Directory B2C
description: Создание веб-приложений с помощью протокола проверки подлинности OpenID Connect Connect в Azure Active Directory B2C.
services: active-directory-b2c
author: msmimart
manager: celestedg
ms.service: active-directory
ms.workload: identity
ms.topic: conceptual
ms.date: 08/22/2019
ms.author: mimart
ms.subservice: B2C
ms.custom: fasttrack-edit
ms.openlocfilehash: 6640ab1660e6499a97a8c990a0001d5fbae4e997
ms.sourcegitcommit: 7b25c9981b52c385af77feb022825c1be6ff55bf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/13/2020
ms.locfileid: "79264392"
---
# <a name="web-sign-in-with-openid-connect-in-azure-active-directory-b2c"></a>Вход в веб-приложения с помощью OpenID Connect в Azure Active Directory B2C

OpenID Connect — это протокол проверки подлинности на основе OAuth 2.0, который может использоваться для безопасного входа пользователей в веб-приложения. Используя реализацию OpenID Connect в Azure Active Directory B2C (Azure AD B2C), можно передать Azure Active Directory (Azure AD) регистрацию, вход в систему и другие действия по управлению пользователями в веб-приложениях. В этом руководстве показано, как это сделать (независимо от языка программирования). и описывает, как отправлять и получать сообщения HTTP, не используя ни одну из наших библиотек с открытым исходным кодом.

[OpenID Connect](https://openid.net/specs/openid-connect-core-1_0.html) расширяет возможности протокола *авторизации* OAuth 2.0 и позволяет использовать его в качестве протокола *проверки подлинности*, Этот протокол проверки подлинности позволяет выполнять единый вход. В нем представлено понятие *маркера идентификации*, которое позволяет клиенту проверить подлинность пользователя и получить основные сведения о профиле пользователя.

Так как он расширяет OAuth 2,0, он также позволяет приложениям безопасно получать *маркеры доступа*. обеспечивая возможность доступа к ресурсам, защищенным [сервером авторизации](protocols-overview.md). OpenID Connect Connect рекомендуется использовать, если вы создаете веб-приложение, размещенное на сервере и доступ к которому осуществляется через браузер. Дополнительные сведения об маркерах см. в разделе [Общие сведения о токенах в Azure Active Directory B2C](tokens-overview.md)

В Azure AD B2C стандартный протокол OpenID Connect выходит за рамки простой проверки подлинности и авторизации. В нем представлен [параметр потока пользователя](user-flow-overview.md), который позволяет использовать OpenID Connect Connect для добавления в приложение пользовательских интерфейсов, таких как регистрация, вход и управление профилями.

## <a name="send-authentication-requests"></a>Отправка запросов проверки подлинности

Если веб-приложению требуется проверить подлинность пользователя и запустить поток пользователя, он может направить пользователя на конечную точку `/authorize`. Пользователь принимает действие в зависимости от потока пользователя.

В этом запросе клиент указывает разрешения, которые необходимо получить от пользователя в параметре `scope`, и указывает поток пользователя для выполнения. Чтобы понять, как работает запрос, Попробуйте поместить запрос в браузер и запустить его. Замените `{tenant}` именем вашего клиента. Замените `90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6` ИДЕНТИФИКАТОРом приложения, которое вы ранее зарегистрировали в клиенте. Также измените имя политики (`{policy}`) на имя политики в клиенте, например `b2c_1_sign_in`.

```HTTP
GET https://{tenant}.b2clogin.com/{tenant}.onmicrosoft.com/{policy}/oauth2/v2.0/authorize?
client_id=90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6
&response_type=code+id_token
&redirect_uri=https%3A%2F%2Faadb2cplayground.azurewebsites.net%2F
&response_mode=form_post
&scope=openid%20offline_access
&state=arbitrary_data_you_can_receive_in_the_response
&nonce=12345
```

| Параметр | Обязательно | Description |
| --------- | -------- | ----------- |
| клиентом | Да | Имя клиента Azure AD B2C |
| политик | Да | Выполняемый пользователем поток. Укажите имя потока пользователей, созданного в Azure AD B2C клиенте. Например: `b2c_1_sign_in`, `b2c_1_sign_up`или `b2c_1_edit_profile`. |
| client_id | Да | Идентификатор приложения, назначенный приложению [портал Azure](https://portal.azure.com/) . |
| nonce | Да | Значение, включенное в запрос (созданное приложением), включенное в результирующий маркер идентификации в качестве утверждения. Затем приложение может проверить это значение, чтобы устранить атаки, направленные на воспроизведение маркеров. Это значение обычно представляет собой случайную уникальную строку, которую можно использовать для определения источника запроса. |
| response_type | Да | Необходимо включить маркер идентификации для OpenID Connect Connect. Если веб-приложению также требуются маркеры для вызова веб-API, можно использовать `code+id_token`. |
| Область | Да | Список областей с разделителями-пробелами. Область `openid` определяет разрешение на вход пользователя и получение данных о пользователе в форме маркеров идентификации. Область `offline_access` не является обязательной для веб-приложений. Это означает, что для расширенного доступа к ресурсам приложению потребуется *маркер обновления* . |
| prompt | нет | Требуемый тип взаимодействия с пользователем. Сейчас единственное допустимое значение — `login`, при котором пользователю приходится вводить учетные данные по запросу. |
| redirect_uri | нет | Параметр `redirect_uri` приложения, в котором приложения могут отправлять и получать ответы на проверку подлинности. Он должен точно соответствовать одному из `redirect_uri` параметров, зарегистрированных в портал Azure, за исключением того, что он должен быть закодирован URL-адресом. |
| response_mode | нет | Метод, который используется для отправки полученного кода авторизации обратно в приложение. Это может быть `query`, `form_post` или `fragment`.  Для максимальной безопасности рекомендуется использовать режим ответа `form_post`. |
| state | нет | Значение, включаемое в запрос, которое также возвращается в ответе маркера. Это может быть строка любого контента. Как правило, с целью предотвращения подделки межсайтовых запросов используется генерируемое случайным образом уникальное значение. Состояние также используется для кодирования сведений о состоянии пользователя в приложении до того, как был выполнен запрос проверки подлинности, например на странице, на которой они находились. |

На этом этапе пользователю предлагается завершить рабочий процесс. Пользователю может потребоваться ввести имя пользователя и пароль, войти с помощью социальных удостоверений или зарегистрироваться в каталоге. В зависимости от того, как определен поток пользователя, может существовать любое другое количество шагов.

После того как пользователь завершит поток пользователя, в приложение будет возвращен ответ, указанный в параметре `redirect_uri`, с помощью метода, указанного в параметре `response_mode`. Ответ одинаков для каждого из предыдущих случаев, независимо от потока пользователя.

Успешный ответ с использованием метода `response_mode=fragment` выглядит следующим образом:

```HTTP
GET https://aadb2cplayground.azurewebsites.net/#
id_token=eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ik5HVEZ2ZEstZnl0aEV1Q...
&code=AwABAAAAvPM1KaPlrEqdFSBzjqfTGBCmLdgfSTLEMPGYuNHSUYBrq...
&state=arbitrary_data_you_can_receive_in_the_response
```

| Параметр | Description |
| --------- | ----------- |
| id_token | Маркер идентификации, запрошенный приложением. Вы можете использовать маркер идентификации для проверки личности пользователя и запуска сеанса пользователя. |
| код | Код авторизации, запрошенный приложением, если вы использовали `response_type=code+id_token`. Приложение может использовать код авторизации для запроса маркера доступа к целевому ресурсу. Срок действия кодов авторизации обычно истекает через 10 минут. |
| state | Если запрос содержит параметр `state`, то в ответе должно отображаться то же значение. Приложение должно проверить, совпадают ли значения `state` в запросе и ответе. |

Сообщения об ошибках также можно отправить в параметр `redirect_uri`, чтобы приложение могла соответствующим образом обрабатывать их:

```HTTP
GET https://aadb2cplayground.azurewebsites.net/#
error=access_denied
&error_description=the+user+canceled+the+authentication
&state=arbitrary_data_you_can_receive_in_the_response
```

| Параметр | Description |
| --------- | ----------- |
| ошибка | Код, который можно использовать для классификации типов произошедших ошибок. |
| error_description | Конкретное сообщение об ошибке, которое может помочь определить основную причину ошибки проверки подлинности. |
| state | Если запрос содержит параметр `state`, то в ответе должно отображаться то же значение. Приложение должно проверить, совпадают ли значения `state` в запросе и ответе. |

## <a name="validate-the-id-token"></a>Проверка маркера идентификации

Получение маркера идентификации не является достаточным для прохождения пользователем проверки подлинности. Проверьте подпись маркера идентификации и проверьте утверждения в маркере на соответствие требованиям приложения. В Azure AD B2C для подписи маркеров и проверки их правильности используются [веб-маркеры JSON Web Token (JWT)](https://self-issued.info/docs/draft-ietf-oauth-json-web-token.html) и шифрование с открытым ключом. Для проверки JWT доступны многие библиотеки с открытым исходным кодом в зависимости от выбранного языка программирования. Мы рекомендуем изучить различные библиотеки, а не реализовывать логику проверки самостоятельно.

Azure AD B2C имеет конечную точку метаданных OpenID Connect Connect, которая позволяет приложению получать сведения о Azure AD B2C во время выполнения. Эти сведения включают конечные точки, содержимое маркеров и ключи подписи маркеров. Для каждого потока пользователя в клиенте B2C есть собственный документ метаданных JSON. Например, документ метаданных для потока пользователя `b2c_1_sign_in` в `fabrikamb2c.onmicrosoft.com` находится в каталоге:

```HTTP
https://fabrikamb2c.b2clogin.com/fabrikamb2c.onmicrosoft.com/b2c_1_sign_in/v2.0/.well-known/openid-configuration
```

Одно из свойств этого документа конфигурации — `jwks_uri`, значение которого для точно такого же потока пользователя будет следующим:

```HTTP
https://fabrikamb2c.b2clogin.com/fabrikamb2c.onmicrosoft.com/b2c_1_sign_in/discovery/v2.0/keys
```

Чтобы определить, какой поток пользователя использовался при подписывании маркера идентификации (и откуда можно получить метаданные), у вас есть два варианта. Во-первых, имя потока пользователя включено в утверждение `acr` маркера идентификации. Другой вариант — закодировать поток пользователя в значении параметра `state` при отправке запроса, а затем декодировать его, чтобы определить используемый поток. Каждый из этих методов является допустимым.

После получения документа метаданных из конечной точки метаданных подключения OpenID Connect можно использовать открытые ключи RSA 256 для проверки подписи маркера идентификации. В этой конечной точке может быть несколько ключей, каждая из которых идентифицируется утверждением `kid`. Заголовок маркера идентификации также содержит утверждение `kid`, указывающее на ключ, который был использован для подписывания маркера идентификации.

Чтобы проверить маркеры от Azure AD B2C, необходимо создать открытый ключ с помощью экспоненты (e) и модуля (n). Необходимо определить, как это сделать на соответствующем языке программирования. Официальную документацию по созданию открытого ключа с помощью протокола RSA можно найти здесь: https://tools.ietf.org/html/rfc3447#section-3.1

После проверки подписи маркера идентификации вам потребуется проверить несколько утверждений. Например:

- Проверьте утверждение `nonce` во избежание атак с использованием воспроизведения маркеров. Его значение должно совпадать с указанным вами в запросе на вход.
- Проверьте утверждение `aud`, чтобы убедиться, что маркер идентификатора был выдан для вашего приложения. Его значение должно быть ИДЕНТИФИКАТОРом приложения.
- Проверьте `iat` и `exp` утверждения, чтобы убедиться, что срок действия маркера идентификатора не истек.

Также существуют некоторые дополнительные проверки, которые необходимо выполнить. Эти проверки подробно описаны в [спецификации OpenID Connect Connect Core](https://openid.net/specs/openid-connect-core-1_0.html). Может также потребоваться проверить дополнительные утверждения в зависимости от вашего сценария. Ниже приведены некоторые из стандартных проверок:

- Проверка того, что пользователь или организация зарегистрированы в приложении.
- Предоставление пользователю необходимого уровня авторизации и привилегий.
- Обеспечение определенного уровня проверки подлинности, например с помощью службы Многофакторной идентификации Azure.

После проверки маркера идентификации можно начать сеанс с пользователем. Утверждения в маркере идентификации можно использовать для получения сведений о пользователе в приложении. Эти сведения используются для отображения, получения записей и проверки подлинности.

## <a name="get-a-token"></a>Получение маркера

Если требуется, чтобы веб-приложение выполняло только потоки пользователей, можно пропустить несколько следующих разделов. Эти разделы применимы только к веб-приложениям, которые должны выполнять проверку подлинности вызовов к веб-API и также защищены с помощью Azure AD B2C.

Чтобы воспользоваться кодом авторизации маркера для необходимого ресурса (полученным с помощью `response_type=code+id_token`), отправьте запрос `POST` на конечную точку `/token`. В Azure AD B2C можно [запросить маркеры доступа для других API](access-tokens.md#request-a-token) обычным образом, указав их области в запросе.

Вы также можете запросить маркер доступа для собственного серверного веб-API в соответствии с соглашением об использовании идентификатора клиента приложения в качестве запрошенной области (что приведет к маркеру доступа с таким ИДЕНТИФИКАТОРом клиента, как "аудитория"):

```HTTP
POST {tenant}.onmicrosoft.com/{policy}/oauth2/v2.0/token HTTP/1.1
Host: {tenant}.b2clogin.com
Content-Type: application/x-www-form-urlencoded

grant_type=authorization_code&client_id=90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6&scope=90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6 offline_access&code=AwABAAAAvPM1KaPlrEqdFSBzjqfTGBCmLdgfSTLEMPGYuNHSUYBrq...&redirect_uri=urn:ietf:wg:oauth:2.0:oob
```

| Параметр | Обязательно | Description |
| --------- | -------- | ----------- |
| клиентом | Да | Имя клиента Azure AD B2C |
| политик | Да | Поток пользователя, который использовался для получения кода авторизации. В этом запросе нельзя использовать другой поток пользователя. Добавьте этот параметр в строку запроса, а не в тело сообщения POST. |
| client_id | Да | Идентификатор приложения, назначенный приложению [портал Azure](https://portal.azure.com/) . |
| client_secret | Да, в веб-приложениях | Секрет приложения, созданный в [портал Azure](https://portal.azure.com/). Секреты клиента используются в этом потоке для сценариев веб-приложений, где клиент может безопасно хранить секрет клиента. Для сценариев собственного приложения (общедоступного клиента) секретность клиента не может быть безопасно сохранена, срефоре не используется в этом потоке. При использовании секрета клиента следует периодически менять его. |
| код | Да | Код авторизации, полученный в начале потока пользователя. |
| grant_type | Да | Тип предоставления. Для потока кода авторизации это должен быть тип `authorization_code`. |
| redirect_uri | Да | Параметр `redirect_uri` приложения, в котором вы получили код авторизации. |
| Область | нет | Список областей с разделителями-пробелами. Область `openid` определяет разрешение на вход пользователя и получение данных о пользователе в форме маркеров идентификации. Его можно использовать для получения маркеров для собственного серверного веб-интерфейса API, который представляется тем же ИДЕНТИФИКАТОРом приложения, что и клиент. Область `offline_access` указывает, что приложению требуется маркер обновления для расширенного доступа к ресурсам. |

Успешный ответ маркера выглядит следующим образом:

```JSON
{
    "not_before": "1442340812",
    "token_type": "Bearer",
    "access_token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ik5HVEZ2ZEstZnl0aEV1Q...",
    "scope": "90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6 offline_access",
    "expires_in": "3600",
    "refresh_token": "AAQfQmvuDy8WtUv-sd0TBwWVQs1rC-Lfxa_NDkLqpg50Cxp5Dxj0VPF1mx2Z...",
}
```

| Параметр | Description |
| --------- | ----------- |
| not_before | Момент времени, в который маркер начинает считаться действительным (с начала эпохи). |
| token_type | Значение типа маркера. единственным поддерживаемым типом является `Bearer`. |
| access_token | Подписанный маркер JWT, который вы запрашивали. |
| Область | Области, для которых действителен маркер. |
| expires_in | Срок действия маркера доступа (в секундах). |
| refresh_token | Маркер обновления OAuth 2.0. Приложение может использовать этот токен для получения дополнительных маркеров после истечения срока действия текущего маркера. Маркеры обновления можно использовать для получения доступа к ресурсам в течение продолжительного периода времени. Для получения маркера обновления область `offline_access` должна быть использована как в запросе авторизации, так и в запросах токенов. |

Сообщения об ошибках выглядят следующим образом:

```JSON
{
    "error": "access_denied",
    "error_description": "The user revoked access to the app.",
}
```

| Параметр | Description |
| --------- | ----------- |
| ошибка | Код, который можно использовать для классификации типов произошедших ошибок. |
| error_description | Сообщение, которое может помочь определить основную причину ошибки проверки подлинности. |

## <a name="use-the-token"></a>Использование маркера

После успешного получения маркера доступа маркер можно использовать в запросах к веб-API серверной части приложения путем включения маркера в заголовок `Authorization`:

```HTTP
GET /tasks
Host: mytaskwebapi.com
Authorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ik5HVEZ2ZEstZnl0aEV1Q...
```

## <a name="refresh-the-token"></a>Обновление маркера

Срок действия маркеров идентификатора истекает через короткий период времени. Обновите токены после истечения срока их действия, чтобы продолжить доступ к ресурсам. Токен можно обновить, отправив другой запрос `POST` в конечную точку `/token`. На этот раз укажите параметр `refresh_token` вместо параметра `code`:

```HTTP
POST {tenant}.onmicrosoft.com/{policy}/oauth2/v2.0/token HTTP/1.1
Host: {tenant}.b2clogin.com
Content-Type: application/x-www-form-urlencoded

grant_type=refresh_token&client_id=90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6&scope=openid offline_access&refresh_token=AwABAAAAvPM1KaPlrEqdFSBzjqfTGBCmLdgfSTLEMPGYuNHSUYBrq...&redirect_uri=urn:ietf:wg:oauth:2.0:oob
```

| Параметр | Обязательно | Description |
| --------- | -------- | ----------- |
| клиентом | Да | Имя клиента Azure AD B2C |
| политик | Да | Поток пользователя, который использовался для получения исходного маркера обновления. В этом запросе нельзя использовать другой поток пользователя. Добавьте этот параметр в строку запроса, а не в тело сообщения POST. |
| client_id | Да | Идентификатор приложения, назначенный приложению [портал Azure](https://portal.azure.com/) . |
| client_secret | Да, в веб-приложениях | Секрет приложения, созданный в [портал Azure](https://portal.azure.com/). Секреты клиента используются в этом потоке для сценариев веб-приложений, где клиент может безопасно хранить секрет клиента. Для сценариев собственного приложения (общедоступного клиента) секретность клиента не может быть безопасно сохранена, срефоре не используется в этом вызове. При использовании секрета клиента следует периодически менять его. |
| grant_type | Да | Тип предоставления, который должен быть маркером обновления для этой части потока кода авторизации. |
| refresh_token | Да | Исходный маркер обновления, полученный во второй части последовательности. Для получения маркера обновления необходимо использовать область `offline_access` в запросах авторизации и маркеров. |
| redirect_uri | нет | Параметр `redirect_uri` приложения, в котором вы получили код авторизации. |
| Область | нет | Список областей с разделителями-пробелами. Область `openid` определяет разрешение на вход пользователя и получение данных о пользователе в форме маркеров идентификации. Его можно использовать для отправки маркеров в собственный серверный веб-API приложения, который представляется тем же ИДЕНТИФИКАТОРом приложения, что и клиент. Область `offline_access` указывает, что приложению требуется маркер обновления для расширенного доступа к ресурсам. |

Успешный ответ маркера выглядит следующим образом:

```JSON
{
    "not_before": "1442340812",
    "token_type": "Bearer",
    "access_token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ik5HVEZ2ZEstZnl0aEV1Q...",
    "scope": "90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6 offline_access",
    "expires_in": "3600",
    "refresh_token": "AAQfQmvuDy8WtUv-sd0TBwWVQs1rC-Lfxa_NDkLqpg50Cxp5Dxj0VPF1mx2Z...",
}
```

| Параметр | Description |
| --------- | ----------- |
| not_before | Момент времени, в который маркер начинает считаться действительным (с начала эпохи). |
| token_type | Значение типа маркера. единственным поддерживаемым типом является `Bearer`. |
| access_token | Подписанный токен JWT, который был запрошен. |
| Область | Область, для которой токен является допустимым. |
| expires_in | Срок действия маркера доступа (в секундах). |
| refresh_token | Маркер обновления OAuth 2.0. Приложение может использовать этот токен для получения дополнительных маркеров после истечения срока действия текущего маркера. Маркеры обновления можно использовать для получения доступа к ресурсам в течение продолжительного периода времени. |

Сообщения об ошибках выглядят следующим образом:

```JSON
{
    "error": "access_denied",
    "error_description": "The user revoked access to the app.",
}
```

| Параметр | Description |
| --------- | ----------- |
| ошибка | Код, который можно использовать для классификации типов произошедших ошибок. |
| error_description | Сообщение, которое может помочь определить основную причину ошибки проверки подлинности. |

## <a name="send-a-sign-out-request"></a>Отправка запроса на выход

Если вы хотите подписать пользователя из приложения, достаточно очистить файлы cookie приложения или иным способом завершить сеанс с пользователем. Перенаправление пользователя в Azure AD B2C для выхода. Если этого не сделать, пользователь может выполнить повторную проверку подлинности в приложении без повторного ввода учетных данных.

Чтобы выйти из учетной записи пользователя, перенаправьте пользователя на конечную точку `end_session`, которая указана в документе OpenID Connect Connect metadata, описанном ранее.

```HTTP
GET https://{tenant}.b2clogin.com/{tenant}.onmicrosoft.com/{policy}/oauth2/v2.0/logout?post_logout_redirect_uri=https%3A%2F%2Fjwt.ms%2F
```

| Параметр | Обязательно | Description |
| --------- | -------- | ----------- |
| клиентом | Да | Имя клиента Azure AD B2C |
| политик | Да | Поток пользователя, который вы хотите использовать для выхода пользователя из приложения. |
| id_token_hint| нет | Ранее выданный маркер идентификатора для передачи в конечную точку выхода в качестве подсказки о текущем сеансе, прошедшем проверку подлинности конечного пользователя, с клиентом. `id_token_hint` гарантирует, что `post_logout_redirect_uri` является зарегистрированным URL-адресом ответа в параметрах приложения Azure AD B2C. |
| client_id | Нет* | Идентификатор приложения, назначенный приложению [портал Azure](https://portal.azure.com/) .<br><br>\**это необходимо при использовании конфигурации единого входа `Application` изоляции и необходимости _маркера идентификатора_ в запросе на выход, установленной в значение `No`.* |
| post_logout_redirect_uri | нет | URL-адрес, по которому необходимо перенаправить пользователя после успешного выхода. Если он не указан, Azure AD B2C показывает пользователю универсальное сообщение. Если вы не предоставляете `id_token_hint`, не зарегистрируйте этот URL-адрес в качестве URL-адреса ответа в параметрах приложения Azure AD B2C. |
| state | нет | Если запрос содержит параметр `state`, то в ответе должно отображаться то же значение. Приложение должно проверить, совпадают ли значения `state` в запросе и ответе. |

### <a name="secure-your-logout-redirect"></a>Защита перенаправления выхода

После выхода пользователя перенаправляется на URI, указанный в параметре `post_logout_redirect_uri`, независимо от URL-адресов ответа, указанных для приложения. Однако если передается допустимый `id_token_hint`, Azure AD B2C проверяет, соответствует ли значение `post_logout_redirect_uri` одному из настроенных URI перенаправления приложения перед выполнением перенаправления. Если соответствующий URL-адрес ответа не был настроен для приложения, выводится сообщение об ошибке, и пользователь не перенаправляется.

### <a name="external-identity-provider-sign-out"></a>Выход из внешнего поставщика удостоверений

При перенаправлении пользователя в конечную точку `end_session` часть состояния единого входа пользователя очищается Azure AD B2C, но не выполняется выход пользователя из сеанса поставщика удостоверений социальных сетей (IDP). Если пользователь выбирает один и тот же IDP во время последующего входа, они проходят повторную проверку подлинности без ввода учетных данных. Если пользователь хочет выйти из приложения, это не обязательно означает, что нужно выйти из своей учетной записи Facebook. Однако если используются локальные учетные записи, то сеанс пользователя завершается правильно.
