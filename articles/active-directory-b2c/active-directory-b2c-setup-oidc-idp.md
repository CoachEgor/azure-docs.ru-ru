---
title: Настройка регистрации и входа с помощью OpenID Connect — Azure Active Directory B2C | Документация Майкрософт
description: Настройка регистрации и входа с помощью OpenID Connect через Azure Active Directory B2C.
services: active-directory-b2c
author: mmacy
manager: celestedg
ms.service: active-directory
ms.workload: identity
ms.topic: conceptual
ms.date: 08/08/2019
ms.author: marsma
ms.subservice: B2C
ms.openlocfilehash: fe49a57e74822c0b4349b2919ea8aa89cbfb458d
ms.sourcegitcommit: 55e0c33b84f2579b7aad48a420a21141854bc9e3
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/19/2019
ms.locfileid: "69622295"
---
# <a name="set-up-sign-up-and-sign-in-with-openid-connect-using-azure-active-directory-b2c"></a>Настройка регистрации и входа с помощью OpenID Connect через Azure Active Directory B2C

[OpenID Connect Connect](active-directory-b2c-reference-oidc.md) — это протокол проверки подлинности, созданный на основе OAuth 2,0, который можно использовать для безопасного входа пользователя в систему. Большинство поставщиков удостоверений, использующих этот протокол, поддерживаются в Azure AD B2C. В этой статье объясняется, как можно добавить пользовательских поставщиков удостоверений OpenID Connect в потоки пользователя.

## <a name="add-the-identity-provider"></a>Добавление поставщика удостоверений

1. Войдите на [портал Azure](https://portal.azure.com/) с правами глобального администратора клиента Azure AD B2C.
1. Убедитесь, что вы используете каталог, содержащий клиент Azure AD B2C, щелкнув фильтр **каталогов и подписок** в верхнем меню и выбрав Каталог, содержащий ваш клиент.
1. Выберите **Все службы** в левом верхнем углу окна портала Azure, найдите службу **Azure AD B2C** и выберите ее.
1. Выберите **поставщики удостоверений**, а затем выберите **Новый поставщик OpenID Connect Connect**.

## <a name="configure-the-identity-provider"></a>Настройка поставщика удостоверений

Каждый поставщик удостоверений OpenID Connect Connect описывает документ метаданных, который содержит большую часть сведений, необходимых для выполнения входа. Сюда входят такие сведения, как используемые URL-адреса и расположение открытых ключей подписывания службы. Документ метаданных OpenID Connect всегда находится в конечной точке, которая заканчивается на `.well-known\openid-configuration`. Для поставщика удостоверений OpenID Connect, которого требуется добавить, введите его URL-адрес метаданных.

## <a name="client-id-and-secret"></a>Идентификатор клиента и секрет

Чтобы разрешить пользователям выполнять вход, разработчики должны зарегистрировать приложение в своей службе, так как это требуется для поставщика удостоверений. Это приложение получит **идентификатор клиента** и **секрет клиента**. Скопируйте эти значения от поставщика удостоверений и введите их в соответствующие поля.

> [!NOTE]
> Секрет клиента не обязателен. Однако необходимо ввести секрет клиента, если вы хотите использовать [поток кода авторизации](https://openid.net/specs/openid-connect-core-1_0.html#CodeFlowAuth), который использует секрет для обмена кодом маркера.

## <a name="scope"></a>`Scope`

Области определяют сведения и разрешения, которые требуется собрать от пользовательского поставщика удостоверений. Запросы OpenID Connect должны содержать значение области `openid`, чтобы получить маркер идентификатора от поставщика удостоверений. Без маркера идентификатора пользователи не смогут войти в Azure AD B2C с помощью пользовательского поставщика удостоверений. Можно присоединить другие области (разделяемые пробелом). Сведения о том, какие другие области могут быть доступны, см. в документации пользовательского поставщика удостоверений.

## <a name="response-type"></a>Тип ответа

Тип ответа описывает, какие сведения будут отправляться обратно в исходный вызов `authorization_endpoint` пользовательского поставщика удостоверений. Можно использовать следующие типы ответов:

* `code`. в соответствии с [потоком с использованием кода авторизации](https://openid.net/specs/openid-connect-core-1_0.html#CodeFlowAuth), код будет возвращаться обратно в Azure AD B2C. Azure AD B2C затем перейдет к вызову `token_endpoint` для обмена кода для маркера.
* `token`. маркер доступа возвращается обратно в Azure AD B2C от пользовательского поставщика удостоверений.
* `id_token`. маркер идентификатора возвращается обратно в Azure AD B2C от пользовательского поставщика удостоверений.

## <a name="response-mode"></a>Режим ответа

Режим ответа позволяет определить метод, который следует использовать для отправки данных обратно от пользовательского поставщика удостоверений в Azure AD B2C. Можно использовать следующие режимы ответов:

* `form_post`. этот режим ответа рекомендуется использовать для максимальной безопасности. Ответ передается через HTTP-метод `POST` с кодом или маркером, закодированным в тексте с использованием формата `application/x-www-form-urlencoded`.
* `query`. код или маркер возвращается в виде параметра запроса.

## <a name="domain-hint"></a>Указание домена

Используя указание домена, можно перейти непосредственно на страницу входа указанного поставщика удостоверений. Таким образом, пользователю не придется выбирать поставщика удостоверений из списка доступных. Чтобы разрешить такое поведение, введите значение для указания домена. Чтобы перейти к пользовательскому поставщику удостоверений, добавьте параметр `domain_hint=<domain hint value>` в конец запроса при вызове Azure AD B2C для входа.

## <a name="claims-mapping"></a>Сопоставление утверждений

После того как пользовательский поставщик удостоверений отправит маркер идентификатора обратно в службу Azure AD B2C, эта служба должна иметь возможность сопоставить утверждения из полученного маркера с утверждениями, которые Azure AD B2C распознает и использует. Ознакомьтесь со сведениями о каждом приведенном ниже сопоставлении в документации пользовательского поставщика удостоверений, чтобы понимать утверждения, которые возвращаются обратно в маркерах поставщика удостоверений.

* **Идентификатор пользователя.** Введите утверждение, которое предоставляет *уникальный идентификатор* для пользователя, выполнившего вход.
* **Отображаемое имя**: Введите утверждение, которое предоставляет пользователю *Отображаемое имя* или *полное имя* .
* **Заданное имя**: Введите утверждение, которое предоставляет *первое имя* пользователя.
* **Фамилия**: Введите утверждение, которое предоставляет *фамилию* пользователя.
* **Электронная почта:** Введите утверждение, которое предоставляет *адрес электронной почты* пользователя.
