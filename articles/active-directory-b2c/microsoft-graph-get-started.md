---
title: Управление ресурсами с помощью Microsoft Graph
titleSuffix: Azure AD B2C
description: Подготовьтесь к управлению ресурсами Azure AD B2C с помощью Microsoft Graph, зарегистрировав приложение, получивщее необходимые разрешения Наиболее API.
services: B2C
author: msmimart
manager: celestedg
ms.service: active-directory
ms.workload: identity
ms.topic: conceptual
ms.date: 02/14/2020
ms.author: mimart
ms.subservice: B2C
ms.openlocfilehash: 32117d4bfcf0c0af94eced095b94ab0c1b6f88af
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "78184365"
---
# <a name="manage-azure-ad-b2c-with-microsoft-graph"></a>Управление Azure AD B2C с помощью графика Microsoft

[Microsoft Graph][ms-graph] позволяет управлять многими ресурсами в вашем клиенте Azure AD B2C, включая учетные записи пользователей и пользовательские политики. Написав скрипты или приложения, которые называются [Microsoft Graph API,][ms-graph-api]можно автоматизировать задачи управления арендаторами, такие как:

* Иперенести существующий магазин пользователей в ряды a2C-клиента Azure AD
* Развертывание пользовательских политик с помощью конвейера Azure в Azure DevOps и управление пользовательскими ключами политики
* Хостовпользовательская регистрация на собственной странице и создание учетных записей пользователей в каталоге Azure AD B2C за кулисами
* Автоматизация регистрации заявок
* Получение журналов аудита

Следующие разделы помогут вам подготовиться к использованию API Microsoft Graph для автоматизации управления ресурсами в каталоге Azure AD B2C.

## <a name="microsoft-graph-api-interaction-modes"></a>Режимы взаимодействия Microsoft Graph API

Существует два способа связи, которые можно использовать при работе с API Microsoft Graph для управления ресурсами в вашем наемщике Azure AD B2C:

* **Интерактивный** - Подходящий для выполнения задач, вы используете учетную запись администратора в b2C арендатора для выполнения задач управления. Этот режим требует, чтобы администратор вписывался в использование своих учетных данных перед вызовом API Microsoft Graph.

* **Автоматизированная** - Для запланированных или непрерывно выполняемых задач этот метод использует учетную запись службы, которую вы настраиваете с разрешениями, необходимыми для выполнения задач управления. Вы создаете "учетную запись обслуживания" в Azure AD B2C, регистрируя приложение, которое ваши приложения и скрипты используют для проверки подлинности с помощью идентификатора *приложения (клиента)* и гранта учетных данных клиентов OAuth 2.0. В этом случае приложение действует как само по себе, чтобы вызвать Microsoft Graph API, а не пользователя администратора, как в ранее описанном интерактивном методе.

Сценарий **автоматического** взаимодействия позволяет создать регистрацию приложения, показанную в следующих разделах.

## <a name="register-management-application"></a>Заявка на управление регистром

Прежде чем ваши скрипты и приложения смогут взаимодействовать с [API Microsoft Graph][ms-graph-api] для управления ресурсами Azure AD B2C, необходимо создать регистрацию приложений в вашем наемщике Azure AD B2C, который предоставляет необходимые разрешения API.

[!INCLUDE [active-directory-b2c-appreg-mgmt](../../includes/active-directory-b2c-appreg-mgmt.md)]

### <a name="grant-api-access"></a>Предоставление доступа через API

Затем предоставите зарегистрированным приложениям разрешения на манипулирование ресурсами клиента с помощью вызовов на API Microsoft Graph.

[!INCLUDE [active-directory-b2c-permissions-directory](../../includes/active-directory-b2c-permissions-directory.md)]

### <a name="create-client-secret"></a>Создание секрета клиента

[!INCLUDE [active-directory-b2c-client-secret](../../includes/active-directory-b2c-client-secret.md)]

Теперь у вас есть приложение, которое имеет разрешение на *создание,* *чтение,* *обновление*и *удаление* пользователей в вашем арендаторе Azure AD B2C. Продолжить следующий раздел, чтобы добавить разрешения *на обновление пароля.*

## <a name="enable-user-delete-and-password-update"></a>Включить удаление пользователя и обновление пароля

Разрешение *данных каталога «Читать и писать»* **НЕ** включает возможность удалять пользователей или обновлять пароли учетных записей пользователей.

Если вашему приложению или скрипту необходимо удалить пользователей или обновить их пароли, отназначьте роль *администратора пользователя* приложению:

1. Вопийте на [портале Azure](https://portal.azure.com) и используйте фильтр **подписки каталога и подписки,** чтобы переключиться на арендатора Azure AD B2C.
1. Поиск и выберите **Azure AD B2C.**
1. Под **управлением**выберите **роли и администраторов.**
1. Выберите роль **администратора пользователя.**
1. Выберите **назначения добавления.**
1. В **текстовом** окне Select введите название зарегистрированного ранее приложения, например, *managementapp1.* Выберите приложение, когда оно появится в результатах поиска.
1. Нажмите кнопку **Добавить**. Полностью распространение разрешений может занять несколько минут.

## <a name="next-steps"></a>Дальнейшие действия

Теперь, когда вы зарегистрировали приложение управления и предоставили ему необходимые разрешения, приложения и службы (например, Azure Pipelines) могут использовать свои учетные данные и разрешения для взаимодействия с API Microsoft Graph.

* [Операции B2C при поддержке Microsoft Graph](microsoft-graph-operations.md)
* [Управление учетными записями пользователей Azure AD B2C с помощью Microsoft Graph](manage-user-accounts-graph-api.md)
* [Получить журналы аудита с API aPI API](view-audit-logs.md#get-audit-logs-with-the-azure-ad-reporting-api)

<!-- LINKS -->
[ms-graph]: https://docs.microsoft.com/graph/
[ms-graph-api]: https://docs.microsoft.com/graph/api/overview
