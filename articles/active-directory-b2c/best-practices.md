---
title: Лучшие практики для Azure AD B2C
titleSuffix: Azure AD B2C
description: Рекомендации и рекомендации, которые следует учитывать при работе с Azure Active Directory B2C (Azure AD B2C).
services: active-directory-b2c
author: vigunase
manager: celestedg
ms.service: active-directory
ms.workload: identity
ms.topic: conceptual
ms.date: 03/03/2020
ms.author: vigunase
ms.subservice: B2C
ms.openlocfilehash: a76852a6e3cc5ffcdfcac62ce29fe47c97af3df1
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "79136165"
---
# <a name="recommendations-and-best-practices-for-azure-active-directory-b2c"></a>Рекомендации и рекомендации для Aure Active Directory B2C

Следующие рекомендации и рекомендации охватывают некоторые основные аспекты интеграции B2C Active Directory (Azure AD) в существующие или новые среды приложений.

## <a name="fundamentals"></a>Основы

|  |  |
|--|--|
| Выберите потоки пользователей для большинства сценариев | Основа опыта идентификации Azure AD B2C является основной силой службы. Политики полностью описывают процесс идентификации: регистрацию, вход и редактирование профиля. Чтобы вам было проще настроить наиболее распространенные задачи идентификации, на портале Azure AD B2C реализованы предопределенные настраиваемые политики, которые называются потоками пользователей. С потоками пользователей, вы можете создать большой пользовательский опыт в считанные минуты, всего за несколько кликов. [Узнайте, когда следует использовать потоки пользователей по сравнению с пользовательскими политиками.](custom-policy-overview.md#comparing-user-flows-and-custom-policies)|
| Регистрация приложений | Каждое приложение (веб, родной) и API, которые защищены, должны быть зарегистрированы в Azure AD B2C. Если приложение имеет как веб-, так и родную версию iOS и Android, вы можете зарегистрировать их в качестве одного приложения в Azure AD B2C с тем же идентификатором клиента. Узнайте, как [зарегистрировать приложения OIDC, SAML, веб и нативные приложения.](https://docs.microsoft.com/azure/active-directory-b2c/tutorial-register-applications?tabs=applications) Узнайте больше о [типах приложений, которые можно использовать в Azure AD B2C.](https://docs.microsoft.com/azure/active-directory-b2c/application-types) |
| Переход к ежемесячной активной биллинг пользователей | Azure AD B2C перешла от ежемесячной активной аутентификации к ежемесячному выставлению счетов активным пользователям (MAU). Большинство клиентов найдут эту модель рентабельной. [Узнайте больше о ежемесячных активных пользователей биллинга](https://azure.microsoft.com/updates/mau-billing/). |

## <a name="planning-and-design"></a>Планирование и разработка

Определите архитектуру приложений и служб, системы инвентаризации и планируйте миграцию в Azure AD B2C.

|  |  |
|--|--|
| Архитектура сквозного решения | Включите все зависимости приложений при планировании интеграции Azure AD B2C. Рассмотрим все службы и продукты, которые в настоящее время находятся в вашей среде или которые могут потребоваться к добавлению в решение, например, функции Azure, системы управления отношениями с клиентами (CRM), шлюз управления API Azure и службы хранения данных. Примите во внимание безопасность и масштабируемость для всех служб. |
| Документируйте опыт пользователей | Подробно все пользовательские путешествия ваши клиенты могут испытать в вашем приложении. Включите каждый экран и любые потоки ветвления, с которыми они могут столкнуться при взаимодействии с аспектами идентификации и профиля приложения. Включите удобство использования, доступность и локализацию в планирование. |
| Выберите правильный протокол проверки подлинности |  Для разбивки различных сценариев приложений и рекомендуемых потоков аутентификации [см. Сценарии и поддерживаемые потоки проверки подлинности.](../active-directory/develop/authentication-flows-app-scenarios.md#scenarios-and-supported-authentication-flows) |
| Пилотный опыт сквозного пользователя (POC) | Начните с наших [образцов кода Майкрософт](code-samples.md) и [образцов сообщества.](https://github.com/azure-ad-b2c/samples) |
| Создание плана миграции |Планирование заблаговременно может сделать миграцию более гладкой. Подробнее о [миграции пользователей.](user-migration.md)|
| Удобство и безопасность | Ваше решение должно найти правильный баланс между удобством использования приложений и приемлемым уровнем риска вашей организации. |
| Перемещение зависимых от помещений в облако | Чтобы обеспечить устойчивое решение, рассмотрите возможность переноса существующих зависимостей приложений в облако. |
| Перенести существующие приложения в b2clogin.com | Амортизацию login.microsoftonline.com вступила в силу для всех арендаторов Azure AD B2C 04 декабря 2020 года. Ознакомьтесь с [дополнительными сведениями](b2clogin.md). |

## <a name="implementation"></a>Реализация

На этапе осуществления рассмотрите следующие рекомендации.

|  |  |
|--|--|
| Оторите пользовательские политики с расширением Azure AD B2C для Visual Studio Code | Скачать Visual Studio Code и это сообщество [построено расширение от Visual Studio Code Marketplace](https://marketplace.visualstudio.com/items?itemName=AzureADB2CTools.aadb2c). Хотя это и не является официальным продуктом Microsoft, расширение Azure AD B2C для Visual Studio Code включает в себя несколько функций, которые помогают упростить работу с пользовательскими политиками. |
| Узнайте, как устранить неполадки Azure AD B2C | Узнайте, как [устранить пользовательские политики](https://docs.microsoft.com/azure/active-directory-b2c/troubleshoot-custom-policies?tabs=applications) во время разработки. Узнайте, как выглядит обычный поток аутентификации, и используйте инструменты для обнаружения аномалий и ошибок. Например, используйте [Application Insights](troubleshoot-with-application-insights.md) для просмотра выводных журналов поездок пользователей. |
| Используйте нашу библиотеку проверенных шаблонов пользовательской политики | Найдите [образцы](https://github.com/azure-ad-b2c/samples) для нескольких расширенных поездок пользователей Azure AD B2C и управления доступом (CIAM). |


## <a name="testing"></a>Тестирование

Проверьте и автоматируйте реализацию Azure AD B2C.

|  |  |
|--|--|
| Учетная запись для глобального трафика | Используйте источники трафика из разных глобальных адресов для проверки требований к производительности и локализации. Убедитесь, что все HTMLs, CSS и зависимости могут удовлетворить ваши потребности в производительности. |
| Функциональное тестирование и тестирование системы и сов. | Проверьте потоки пользователей сквозной. Добавляйте синтетические тесты каждые несколько минут, используя Selenium, VS Web Test и т.д. |
| Тестирование на ручку | Прежде чем приехать в жизнь с вашим решением, выполните упражнения по тестированию на проникновение, чтобы проверить безопасность всех компонентов, включая любые зависимые от сторонних сторонних из них. Убедитесь, что вы закрепили свои AI с помощью токенов доступа и использовали правильный протокол проверки подлинности для сценария приложения. Узнайте больше о [тестировании penetration](https://docs.microsoft.com/azure/security/fundamentals/pen-testing) и [правилах единого тестирования на проникновение Microsoft Cloud.](https://www.microsoft.com/msrc/pentest-rules-of-engagement?rtc=1) |
| A/B Тестирование | Полет ваши новые функции с небольшой, случайный набор пользователей, прежде чем развертывание для всего населения. С включенным JavaScript в Azure AD B2C можно интегрироваться с инструментами тестирования A/B, такими как Optimizely, Clarity и другими. |
| Нагрузочное тестирование | Azure AD B2C может масштабироваться, но приложение может масштабироваться только в том случае, если все его зависимости могут масштабироваться. Загрузить тест aAИ и CDN. |
| Регулирование |  Azure AD B2C дросселит трафик, если слишком много запросов отправляется из одного и того же источника в течение короткого периода времени. Используйте несколько источников трафика `AADB2C90229` во время тестирования нагрузки и изящно обрабатывают код ошибки в приложениях. |
| Служба автоматизации | Используйте конвейеры непрерывной интеграции и доставки (CI/CD) для автоматизации тестирования и развертывания, например, [Azure DevOps.](deploy-custom-policies-devops.md) |

## <a name="operations"></a>Операции

Управление средой Azure AD B2C.

|  |  |
|--|--|
| Создание нескольких сред | Для упрощения развертывания операций и развертывания создайте отдельные среды для разработки, тестирования, предварительного производства и производства. Создавайте для каждого из них арендаторов Azure AD B2C. |
| Используйте управление версиями для пользовательских политик | Рассмотрите возможность использования GitHub, Azure Repos или другой облачной системы управления версиями для пользовательских политик Azure AD B2C. |
| Используйте API Microsoft Graph для автоматизации управления вашими арендаторами B2C | Microsoft Graph AIS:<br/>Управление [инфраструктурой опыта идентификации](https://docs.microsoft.com/graph/api/resources/trustframeworkpolicy?view=graph-rest-beta) (пользовательские политики)<br/>[Ключи](https://docs.microsoft.com/graph/api/resources/trustframeworkkeyset?view=graph-rest-beta)<br/>[Маршруты пользователей](https://docs.microsoft.com/graph/api/resources/identityuserflow?view=graph-rest-beta) |
| Интеграция с Azure DevOps | [Конвейер CI/CD](deploy-custom-policies-devops.md) упрощает перемещение кода между различными средами и обеспечивает готовность производства в любое время.   |
| Интеграция с Azure Monitor | [События журнала аудита](view-audit-logs.md) сохраняются только в течение семи дней. [Интегрируйтесь с Azure Monitor,](azure-monitor.md) чтобы сохранить журналы для долгосрочного использования, или интегрируйтесь с помощью сторонних средств безопасности и управления событиями (SIEM) для получения информации о вашей среде. |
| Настройка активного оповещения и мониторинга | [Отслеживайте поведение пользователей](active-directory-b2c-custom-guide-eventlogger-appins.md) в Azure AD B2C с помощью Application Insights. |


## <a name="support-and-status-updates"></a>Обновления поддержки и статуса

Будьте в курсе состояния службы и найдите варианты поддержки.

|  |  |
|--|--|
| [Обновления сервиса](https://azure.microsoft.com/updates/?product=active-directory-b2c) |  Будьте в курсе обновлений и объявлений о продуктах Azure AD B2C. |
| [Служба технической поддержки Майкрософт](support-options.md) | Подать запрос на поддержку технических проблем Azure AD B2C. Поддержка по выставлению счетов и управлению подпиской предоставляется бесплатно. |
| [Состояние Azure](https://status.azure.com/status) | Просмотр текущего состояния работоспособности всех служб Azure. |