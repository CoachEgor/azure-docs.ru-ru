---
title: Руководство. Включение в одностраничном приложении аутентификации c помощью Azure Active Directory B2C | Документация Майкрософт
description: Руководство по предоставлению пользователю данных для входа в одностраничное приложение JavaScript с помощью Azure Active Directory B2C.
services: active-directory-b2c
author: davidmu1
manager: celestedg
ms.author: davidmu
ms.date: 02/04/2019
ms.custom: mvc
ms.topic: tutorial
ms.service: active-directory
ms.subservice: B2C
ms.openlocfilehash: 9541d635ff69444459470cf1e486568a58af0a1e
ms.sourcegitcommit: 44a85a2ed288f484cc3cdf71d9b51bc0be64cc33
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "64730159"
---
# <a name="tutorial-enable-authentication-in-a-single-page-application-using-azure-active-directory-b2c"></a>Руководство по Включение в одностраничном приложении аутентификации с помощью Azure Active Directory B2C

В этом руководстве описано использование Azure Active Directory (Azure Active Directory) B2C для входа и регистрации пользователей в одностраничном приложении (SPA). Azure AD B2C позволяет приложениям выполнять проверку подлинности учетных записей социальных сетей, корпоративных учетных записей и учетных записей Azure Active Directory с помощью стандартных протоколов.

Из этого руководства вы узнаете, как выполнять следующие задачи:

> [!div class="checklist"]
> * Обновление приложения в Azure AD B2C.
> * Настройка примера для использования приложения.
> * регистрация с помощью потока пользователя.

[!INCLUDE [quickstarts-free-trial-note](../../includes/quickstarts-free-trial-note.md)]

## <a name="prerequisites"></a>Предварительные требования

* [Создайте потоки пользователя](tutorial-create-user-flows.md), чтобы обеспечить взаимодействие с пользователями в приложении. 
* Установите [Visual Studio 2017](https://www.visualstudio.com/downloads/) с рабочей нагрузкой **ASP.NET и веб-разработка**.
* Установите [пакет SDK для .NET Core 2.0.0](https://www.microsoft.com/net/core) или более поздней версии.
* Установите [Node.js](https://nodejs.org/en/download/)

## <a name="update-the-application"></a>Обновление приложения

Во время прохождения руководства, которое является частью предварительных требований, вы добавили веб-приложение в Azure AD B2C. Для обеспечения взаимодействия с примером в этом руководстве необходимо добавить URI перенаправления для приложения в Azure AD B2C.

1. Войдите на [портале Azure](https://portal.azure.com).
2. Убедитесь, что используете каталог, содержащий клиент Azure AD B2C, щелкнув **Фильтр каталога и подписки** в верхнем меню и выбрав каталог, содержащий ваш клиент.
3. Выберите **Все службы** в левом верхнем углу окна портала Azure, а затем найдите и выберите **Azure AD B2C**.
4. Щелкните пункт **Приложения**, а затем выберите приложение *webapp1*.
5. В разделе **URL-адрес ответа** добавьте `http://localhost:6420`.
6. Щелкните **Сохранить**.
7. На странице свойств запишите идентификатор приложения, который будет использоваться при настройке веб-приложения.
8. Выберите **Ключи**, а затем щелкните **Создать ключ** и нажмите кнопку **Сохранить**. Запишите ключ, который будет использоваться при настройке веб-приложения.

## <a name="configure-the-sample"></a>Настройка примера

С помощью этого руководства вы настроите пример, который можно скачать из репозитория GitHub. В этом примере показано, как использовать Azure AD B2C в одностраничном приложении для регистрации и входа пользователя, а также вызова защищенного веб-API.

[Скачайте ZIP-файл](https://github.com/Azure-Samples/active-directory-b2c-javascript-msal-singlepageapp/archive/master.zip) или клонируйте пример с GitHub.

```
git clone https://github.com/Azure-Samples/active-directory-b2c-javascript-msal-singlepageapp.git
```

Чтобы изменить параметры:

1. Откройте файл `index.html` в примере.
2. Укажите для примера идентификатор приложения и ключ, которые вы записали ранее. Измените следующие строки кода, заменив значения именами используемого каталога и API:

    ```javascript
    // The current application coordinates were pre-registered in a B2C directory.
    var applicationConfig = {
        clientID: '<Application ID>',
        authority: "https://contoso.b2clogin.com/tfp/contoso.onmicrosoft.com/B2C_1_signupsignin1",
        b2cScopes: ["https://contoso.onmicrosoft.com/demoapi/demo.read"],
        webApi: 'https://contosohello.azurewebsites.net/hello',
    };
    ```

    Имя потока пользователя, используемое в этом руководстве, — **B2C_1_signupsignin1**. Если вы используете другое имя потока пользователя, укажите его в значении `authority`.

## <a name="run-the-sample"></a>Запуск примера

1. Откройте командную строку Node.js.
2. Перейдите в каталог, содержащий пример приложения Node.js. Например `cd c:\active-directory-b2c-javascript-msal-singlepageapp`
3. Выполните следующие команды:

    ```
    npm install && npm update
    node server.js
    ```

    В окне консоли отобразится номер порта, связанный с размещаемым приложением.
    
    ```
    Listening on port 6420...
    ```

4. С помощью браузера перейдите по адресу `http://localhost:6420`, чтобы просмотреть приложение.

Пример поддерживает регистрацию пользователей, вход в систему, редактирование профилей и сброс паролей. В этом руководстве показан процесс регистрации пользователя с помощью адреса электронной почты.

### <a name="sign-up-using-an-email-address"></a>Регистрация с помощью адреса электронной почты

1. Щелкните **Войти**, чтобы зарегистрироваться как пользователь приложения. В этом случае используется поток пользователя **B2C_1_signupsignin1**, определенный на предыдущем шаге.
2. Появляется страница входа в Azure AD B2C со ссылкой для регистрации. Щелкните ссылку **Зарегистрироваться сейчас**, так как у вас нет учетной записи. 
3. В рамках рабочего процесса регистрации появляется страница для сбора данных и проверки личности пользователя с использованием адреса электронной почты. Рабочий процесс регистрации также собирает пароль пользователя и запрашиваемые атрибуты, определенные в потоке пользователя.

    Используйте действительный адрес электронной почты и подтвердите его с помощью кода проверки. Задайте пароль. Введите значения запрашиваемых атрибутов. 

    ![Рабочий процесс регистрации](media/active-directory-b2c-tutorials-desktop-app/sign-up-workflow.png)

4. Щелкните **Создать**, чтобы создать локальную учетную запись в каталоге Azure AD B2C.

Теперь пользователь может использовать адрес электронной почты для входа в одностраничное приложение и работы с ним.

> [!NOTE]
> После входа в систему приложение выдаст ошибку, информирующую о недостаточных разрешениях. Эта ошибка возникает, потому что вы пытаетесь получить доступ к ресурсу из демонстрационного каталога. Так как маркер доступа действителен только для вашего каталога Azure AD, вызов API считается неавторизованным. Перейдите к следующему руководству, чтобы создать защищенный веб-API для своего каталога.

## <a name="next-steps"></a>Дополнительная информация

Из этой статьи вы узнали, как выполнять следующие задачи:

> [!div class="checklist"]
> * Обновление приложения в Azure AD B2C.
> * Настройка примера для использования приложения.
> * регистрация с помощью потока пользователя.

> [!div class="nextstepaction"]
> [Руководство Предоставление доступа к веб-API ASP.NET Core из одностраничного приложения с помощью Azure Active Directory B2C](active-directory-b2c-tutorials-spa-webapi.md)
