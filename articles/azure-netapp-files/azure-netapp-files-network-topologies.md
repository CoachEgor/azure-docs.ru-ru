---
title: Руководящие принципы для планирования сети файлов Сети Azure NetApp (ru) Документы Майкрософт
description: Описывает рекомендации, которые помогут вам разработать эффективную сетевую архитектуру с помощью файлов Azure NetApp.
services: azure-netapp-files
documentationcenter: ''
author: ram-kakani
manager: ''
editor: ''
ms.assetid: ''
ms.service: azure-netapp-files
ms.workload: storage
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: conceptual
ms.date: 05/08/2019
ms.author: b-juche
ms.openlocfilehash: 8e6a1c3472c6b20b27cf181edbeeb96ab71eb58d
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/27/2020
ms.locfileid: "73242477"
---
# <a name="guidelines-for-azure-netapp-files-network-planning"></a>Рекомендации по планированию сети Azure NetApp Files

Планирование сетевой архитектуры является ключевым элементом проектирования любой инфраструктуры приложений. Эта статья поможет вам разработать эффективную сетевую архитектуру для ваших рабочих нагрузок, чтобы воспользоваться богатыми возможностями файлов NetApp Azure.

Объемы файлов Azure NetApp предназначены для содержащихся в подсети специального назначения, называемой [делегированной подсетью](https://docs.microsoft.com/azure/virtual-network/virtual-network-manage-subnet) в виртуальной сети Azure. Таким образом, вы можете получить доступ к объемам непосредственно из вашего VNet, из заглянув VNets в том же регионе, или из-за помещения через виртуальный шлюз сети (ExpressRoute или VPN Gateway) по мере необходимости. Подсеть предназначена для файлов NetApp Azure, и нет подключения к другим службам Azure или Интернету.

## <a name="considerations"></a>Рекомендации  

Вы должны понимать несколько соображений, когда вы планируете для сети Azure NetApp Файлов.

### <a name="constraints"></a>Ограничения

Приведенные ниже функции не поддерживаются для файлов NetApp Azure: 

* Группы сетевой безопасности (НСГ) подали заявки на делегированную подсеть
* Маршруты, определяемые пользователем (UDRs) с адресной префиксом подсети файлов Azure NetApp
* Политики Azure (например, пользовательские политики именования) в интерфейсе Azure NetApp Files
* Балансиваторы загрузки для трафика файлов Сети Azure

Следующие сетевые ограничения распространяются на файлы NetApp Azure:

* Количество ис-чатов, использоваемых в VNet с файлами NetApp Azure (включая заглянувvvvvvvские VNets), не может превышать 1000. Мы работаем над увеличением этого лимита для удовлетворения потребностей клиентов в масштабах. В то же время, если вам требуется больше I-провайдеров, обратитесь к нашей группе поддержки с вашим случаем использования и требуемым лимитом.
* В каждой виртуальной сети Azure можно делегировать только одну подсеть для Azure NetApp Files.


### <a name="supported-network-topologies"></a>Поддерживаемые топологии сети

В следующей таблице описаны сетевые топологии, поддерживаемые файлами NetApp Azure.  Он также описывает обходные пути для неподдерживаемых топологий. 

|    Топологии    |    Поддерживается    |     Обходной путь    |
|-------------------------------------------------------------------------------------------------------------------------------|--------------------|-----------------------------------------------------------------------------|
|    Подключение к объему в локальном VNet    |    Да    |         |
|    Подключение к объему в загляну vNet (тот же регион)    |    Да    |         |
|    Связь с объемом в загляну vNet (Перекрестный регион или глобальное пиринг)    |    нет    |    None    |
|    Подключение к объему через шлюз ExpressRoute    |    Да    |         |
|    Связь от на-предпосылки к объему в spoke VNet над шлюзом ExpressRoute и VNet peering с шлюзом транзита    |    Да    |        |
|    Связь от наемных помещений до громкости в спицком VNet через VPN шлюз    |    Да    |         |
|    Связь от на-предпосылки к объему в spoke VNet над шлюзом VPN и VNet peering с шлюзом транзита    |    Да    |         |


## <a name="virtual-network-for-azure-netapp-files-volumes"></a>Виртуальная сеть для объемов файлов NetApp Azure

В этом разделе разъясняется концепция, которые помогут вам в виртуальном планировании сети.

### <a name="azure-virtual-networks"></a>Виртуальные сети Azure

Прежде чем предоставить объем файлов Сети Приложений Azure, необходимо создать виртуальную сеть Azure (VNet) или использовать ту, которая уже существует в вашей подписке. VNet определяет границу объема сети.  Для получения дополнительной информации о [Azure Virtual Network documentation](https://docs.microsoft.com/azure/virtual-network/virtual-networks-overview)создании виртуальных сетей см.

### <a name="subnets"></a>Подсети

Подсети сегментируют виртуальную сеть на отдельные адресные пространства, которые можно учесть ресурсами Azure в них.  Объемы файлов Azure NetApp содержатся в подсетевом специальном профиле подсети, называемом [делегированной подсетью.](https://docs.microsoft.com/azure/virtual-network/virtual-network-manage-subnet) 

Делегация Subnet дает явные разрешения службе Azure NetApp Files на создание ресурсов, специфиченных для службы, в подсети.  При развертывании службы используется уникальный идентификатор. В этом случае создается сетевой интерфейс для включения в приложения Для подключения к файлам NetApp Azure.

Если вы используете новую VNet, вы можете создать подсеть и делегировать подсеть в Файлы NetApp Azure, следуя инструкциям в [Делегировании подсети в Azure NetApp Files.](azure-netapp-files-delegate-subnet.md) Можно также делегировать существующую пустую подсеть, которая еще не делегирована другим службам.

Если VNet заглянул в другой VNet, вы не можете расширить пространство адреса VNet. По этой причине в адресном пространстве VNet необходимо создать новую делегированную подсеть. Если вам необходимо расширить пространство адреса, необходимо удалить вонючий VNet перед расширением адресного пространства.

### <a name="udrs-and-nsgs"></a>UDИ и НСК

Маршруты, определяемые пользователями (UDR) и группы безопасности сети (НСГ), не поддерживаются в делегированных поднетах для файлов NetApp Azure.

В качестве обходного пути можно применить НСГ к другим подсетям, которые либо разрешают, либо отказывают в трафике и из делегированных поднетов Azure NetApp Files.  

## <a name="azure-native-environments"></a>Родные среды Azure

Следующая диаграмма иллюстрирует среду, родную Лазуру:

![Сетевая среда, нативная к лазурным понародным,](../media/azure-netapp-files/azure-netapp-files-network-azure-native-environment.png)

### <a name="local-vnet"></a>Местный VNet

Основным сценарием является создание или подключение к объему файлов Azure NetApp с виртуальной машины (VM) в той же VNet. Для VNet 2 на приведенной выше диаграмме том 1 создается в делегированной подсети и может быть установлен на VM 1 в подсети по умолчанию.

### <a name="vnet-peering"></a>Пиринговая связь между виртуальными сетями

Если в одном регионе есть дополнительные V-руты, которым необходим доступ к ресурсам друг друга, VNets могут быть подключены с помощью [взорвателя VNet](https://docs.microsoft.com/azure/virtual-network/virtual-network-peering-overview) для обеспечения безопасного подключения через инфраструктуру Azure. 

Рассмотрим VNet 2 и VNet 3 на диаграмме выше. Если VM 1 необходимо подключиться к VM 2 или Том 2, или если VM 2 необходимо подключиться к VM 1 или Том 1, то вам нужно включить VNet пиринг между VNet 2 и VNet 3. 

Кроме того, рассмотрим сценарий, в котором VNet 1 заглядывается с VNet 2, а VNet 2 — с VNet 3 в том же регионе. Ресурсы VNet 1 могут подключаться к ресурсам в VNet 2, но они не могут подключаться к ресурсам в VNet 3, если только VNet 1 и VNet 3 не будут заглянуны. 

На приведенной выше диаграмме, хотя VM 3 может подключиться к объему 1, VM 4 не может подключиться к объему 2.  Причиной этого является то, что говорил VNets не заглядываются, и _транзитная маршрутизирующая не поддерживается через ВНет пиринг_.

## <a name="hybrid-environments"></a>Гибридные среды

Следующая диаграмма иллюстрирует гибридную среду: 

![Гибридная сетевая среда](../media/azure-netapp-files/azure-netapp-files-network-hybrid-environment.png)

В гибридном сценарии приложениям из центров обработки данных для помещений необходим доступ к ресурсам Azure.  Это происходит независимо от того, хотите ли вы расширить свой центр обработки данных до Azure, или вы хотите использовать нацслужбы Azure или для восстановления аварийного сообщения. Ознакомьтесь с [вариантами планирования VPN Gateway,](https://docs.microsoft.com/azure/vpn-gateway/vpn-gateway-about-vpngateways?toc=%2fazure%2fvirtual-network%2ftoc.json#planningtable) чтобы узнать о том, как подключать несколько ресурсов к ресурсам в Azure через VPN от сайта к сайту или ExpressRoute.

В гибридной топологии концентратора VNet в Azure выступает в качестве центральной точки подключения к вашей предварительной сети. Спицы VNets заглянул с концентратором, и они могут быть использованы для изоляции рабочих нагрузок.

В зависимости от конфигурации можно подключить ресурсы к ресурсам в концентраторе и спицах.

В топологии, иллюстрированной выше, локальная сеть подключена к концентратору VNet в Azure, и есть 2 спица VNets в том же регионе, вглядываемый с концентратором VNet.  В этом сценарии параметры подключения, поддерживаемые для объемов файлов Azure NetApp, следующие:

* На местах ресурсы VM 1 и VM 2 могут подключаться к объему 1 в концентраторе по схеме VPN или ExpressRoute. 
* На местах ресурсы VM 1 и VM 2 могут подключаться к тому 2 или тому 3 по VPN-сайту и региональному Vnet.
* VM 3 в концентраторе VNet может подключиться к тому 2 в говорил VNet 1 и Том 3 в говорил VNet 2.
* VM 4 от говорил VNet 1 и VM 5 от говорил VNet 2 может подключиться к объему 1 в концентраторе VNet.

VM 4 в говорил VNet 1 не может подключиться к объему 3 в говорил VNet 2. Кроме того, VM 5 в спицкой VNet2 не может подключиться к тому 2 в говорил VNet 1. Это так, потому что говорил VNets не заглянул и _транзита маршрутизации не поддерживается через VNet пиринга_.

## <a name="next-steps"></a>Дальнейшие действия

[Делегирование подсети службе Azure NetApp Files](azure-netapp-files-delegate-subnet.md)
