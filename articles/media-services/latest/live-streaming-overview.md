---
title: Обзор потоковой передачи в реальном времени с помощью служб мультимедиа Azure v3 | Документация Майкрософт
description: В этой статье содержатся общие сведения о потоковой трансляции в реальном времени с использованием Служб мультимедиа Azure версии 3.
services: media-services
documentationcenter: ''
author: Juliako
manager: femila
editor: ''
ms.service: media-services
ms.workload: media
ms.tgt_pltfrm: na
ms.devlang: ne
ms.topic: article
ms.date: 11/12/2019
ms.author: juliako
ms.openlocfilehash: 93005b181075ac671af6c8d73a3f2a06ed9eb0d8
ms.sourcegitcommit: 5ab4f7a81d04a58f235071240718dfae3f1b370b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/10/2019
ms.locfileid: "74977749"
---
# <a name="live-streaming-with-azure-media-services-v3"></a>Потоковая трансляция в Службах мультимедиа Azure версии 3

Службы мультимедиа Azure дают возможность предоставлять клиентам события прямой трансляции в облаке Azure. Для потоковой передачи событий прямой трансляции с помощью Служб мультимедиа вам потребуются:  

- камера для записи события;<br/>Чтобы установить оборудование, ознакомьтесь с записью блога [Simple and portable event video gear setup]( https://link.medium.com/KNTtiN6IeT) (Настройка простого портативного оборудования для сьемки).

    Если у вас нет доступа к камере, можно использовать такие средства, как [Wirecast аудиопотока](https://www.telestream.net/wirecast/overview.htm) , для создания динамического канала из видеофайла.
- Динамический видеокодировщик, преобразующий сигналы с камеры (или другого устройства, например ноутбука) в исходный поток, который передается в Службы мультимедиа. этот поток может содержать сигналы, связанные с рекламой, например метки SCTE-35;<br/>Список рекомендуемых кодировщиков потоковой трансляции см. в [этой статье](recommended-on-premises-live-encoders.md). Кроме того, ознакомьтесь с этим блогом: [потоковая передача в реальном времени с помощью OBS](https://link.medium.com/ttuwHpaJeT).
- компоненты Служб мультимедиа, которые дают возможность принимать, просматривать, упаковывать, записывать, шифровать и транслировать события в реальном времени непосредственно клиентам или в сеть доставки содержимого (CDN) для дальнейшего распространения.

В этой статье приводятся общие сведения и рекомендации по потоковой передаче с помощью служб мультимедиа и ссылки на другие важные статьи.
 
> [!NOTE]
> В настоящее время вы не можете использовать портал Azure для управления ресурсами версии 3. Используйте [REST API](https://aka.ms/ams-v3-rest-ref), [CLI](https://aka.ms/ams-v3-cli-ref) или один из поддерживаемых [пакетов SDK](media-services-apis-overview.md#sdks).

## <a name="dynamic-packaging"></a>Динамическое упаковывание

С помощью служб мультимедиа можно использовать [динамическую упаковку](dynamic-packaging-overview.md), позволяющую просматривать и рассылать Интерактивные потоки в [форматах MPEG, HLS и Smooth Streaming](https://en.wikipedia.org/wiki/Adaptive_bitrate_streaming) из веб-канала публикации, который отправляется в службу. Ваши зрители могут воспроизводить трансляцию с помощью любых проигрывателей, поддерживающих HLS, DASH и Smooth Streaming. Для доставки потока в любом из этих протоколов можно использовать [Проигрыватель мультимедиа Azure](https://amp.azure.net/libs/amp/latest/docs/index.html) в мобильном или веб-приложении.

## <a name="dynamic-encryption"></a>динамическое шифрование.

Динамическое Шифрование позволяет динамически шифровать содержимое в реальном времени или по запросу с помощью AES-128 или любой из трех основных систем управления цифровыми правами (DRM): Microsoft PlayReady, Google Widevine и Apple FairPlay. Они также обеспечивают службу доставки ключей AES и лицензий DRM (PlayReady, Widevine и FairPlay) авторизованным клиентам. Дополнительные сведения см. в разделе [динамическое шифрование](content-protection-overview.md).

> [!NOTE]
> Widevine — это служба, предоставляемая Google Inc. и подпадает под условия обслуживания и политики конфиденциальности Google, Inc.

## <a name="dynamic-manifest"></a>Динамический манифест

Динамическая фильтрация используется для управления числом дорожек, форматов, скорости и окон времени представления, отправляемых игрокам. Дополнительные сведения см. в разделе [фильтры и динамические манифесты](filters-dynamic-manifest-overview.md).

## <a name="live-event-types"></a>Типы событий потоковой трансляции

[События потоковой трансляции](https://docs.microsoft.com/rest/api/media/liveevents) отвечают за прием и обработку видеопотоков. Событие в реальном времени может быть одним из двух типов: сквозная и динамическая кодировка. Дополнительные сведения о потоковой передаче в службах мультимедиа v3 см. в статье [динамические события и выходные данные](live-events-outputs-concept.md)в реальном времени.

### <a name="pass-through"></a>Сквозной режим

![Сквозной режим](./media/live-streaming/pass-through.svg)

При использовании сквозного мероприятия в **реальном**времени вы используете локальный динамический кодировщик для создания видеопотока с несколькими скоростями и отправляете его в интерактивное событие (используя RTMP или фрагментированный протокол ввода MP4). Затем событие в реальном времени передается через входящие потоки видео в динамический упаковщик (конечную точку потоковой передачи) без дальнейшей перекодировки. Такое событие сквозной передачи оптимизировано для долго выполняющихся интерактивных событий или 24x365 линейной потоковой передачи. 

### <a name="live-encoding"></a>Кодирование в реальном времени  

![Кодирование в реальном времени](./media/live-streaming/live-encoding.svg)

При использовании кодирования в облаке с помощью служб мультимедиа вы настроите локальный динамический кодировщик для отправки односкоростного видео в качестве веб-канала вклада (32Mbps Aggregate) в Live Event (с использованием RTMP или фрагментированного входного протокола MP4). Событие Live переводит входящий поток с одной скоростью в [несколько видеопотоков](https://en.wikipedia.org/wiki/Adaptive_bitrate_streaming) с различной скоростью, чтобы улучшить доставку и сделать ее доступной для доставки на устройства воспроизведения через стандартные протоколы, такие как MPEG-тире, Apple HTTP Live Streaming (HLS) и Microsoft Smooth Streaming. 

### <a name="live-transcription-preview"></a>Динамическая транскрипция (Предварительная версия)

Транскрипция в реальном времени — это функция, которую можно использовать с динамическими событиями, поддерживающими сквозную или динамическую кодировку. Дополнительные сведения см. в разделе [Динамическая транскрипция](live-transcription.md). Если эта функция включена, служба использует функцию преобразования [речи в текст](../../cognitive-services/speech-service/speech-to-text.md) Cognitive Services, чтобы транскрипция слова во входящем звуке в текст. Этот текст затем становится доступным для доставки, а также видео и аудио в протоколах MPEG-ТИРЕ и HLS.

> [!NOTE]
> Сейчас функция интерактивной записи доступна в виде предварительной версии в западной части США 2.

## <a name="live-streaming-workflow"></a>Рабочий процесс для потоковой трансляции в реальном времени

Чтобы понять рабочий процесс потоковой передачи в службах мультимедиа v3, сначала необходимо ознакомиться со следующими понятиями. 

- [Конечные точки потоковой передачи](streaming-endpoint-concept.md)
- [События и выходные данные потоковой трансляции](live-events-outputs-concept.md)
- [Указатели потоковой передачи](streaming-locators-concept.md)

### <a name="general-steps"></a>основные шаги

1. Убедитесь, что в учетной записи служб мультимедиа выполняется **Конечная точка потоковой передачи** (источник). 
2. Создание [события прямой трансляции](live-events-outputs-concept.md). <br/>Для создаваемого события можно настроить автоматический запуск. Кроме того, событие можно запустить, когда вы будете готовы начать потоковую передачу.<br/> Если для автозапуска задано значение true, событие прямой трансляции будет запущено сразу после создания. Плата начисляется сразу же после запуска трансляции. Чтобы остановить начисление оплаты, нужно явно вызвать функцию Stop (Остановить) для ресурса события потоковой трансляции. Дополнительные сведения см. в статье [Состояния компонента LiveEvent и выставление счетов за его использование](live-event-states-billing.md).
3. Получите URL-адреса приема и настройте локальный кодировщик для использования URL-адреса для отправки веб-канала публикаций.<br/>[Рекомендуемые кодировщики потоковой трансляции](recommended-on-premises-live-encoders.md).
4. Получите URL-адрес для предварительного просмотра, чтобы проверить получение входных данных от кодировщика.
5. Создание объекта **ресурса**. 

    Каждый динамический выход связан с ресурсом, который используется для записи видео в связанный контейнер хранилища BLOB-объектов Azure. 
6. Создайте **динамический выход** и используйте созданное имя ресурса, чтобы поток можно было заархивировать в ресурсе.

    Выходные данные прямой трансляции запускаются при создании и останавливаются при удалении. При удалении выходных данных вы не удаляете базовый ресурс и содержимое в ресурсе.
7. Создайте **указатель потоковой передачи** со [встроенными типами политики потоковой передачи](streaming-policy-concept.md).

    Чтобы опубликовать выходные данные в реальном времени, необходимо создать указатель потоковой передачи для связанного ресурса. 
8. Создайте список путей на основе **потокового указателя**, чтобы получать URL-адреса для использования (детерминированные).
9. Получите имя узла для **конечной точки потоковой передачи** (источника), из которой требуется выполнить потоковую передачу.
10. Объедините URL-адрес (полученный на шаге 8) с именем узла (полученным на шаге 9), чтобы получить полный URL-адрес.
11. Чтобы прекратить транслировать **событие потоковой трансляции**, необходимо остановить потоковую передачу событий, удалив **указатель потоковой передачи**.
12. После завершения потоковой передачи мероприятия вы можете удалить выделенные ранее ресурсы с помощью описанной ниже процедуры.

    * Остановите трансляцию потока из кодировщика.
    * Остановите событие потоковой трансляции. Плата за остановленное событие потоковой трансляции не взимается. Если вам понадобится снова запустить его, вы можете воспользоваться тем же URL-адресом приема (перенастраивать кодировщик не потребуется).
    * Вы можете остановить конечную точку потоковой передачи, если больше не собираетесь предоставлять доступ к архиву мероприятия в качестве потоковой передачи по требованию. Плата за остановленное событие потоковой трансляции не взимается.

Ресурс, в который осуществляется архивация в реальном времени, автоматически становится активом по запросу при удалении активного выхода. Прежде чем можно будет остановить интерактивное событие, необходимо удалить все активные выходные данные. Можно использовать необязательный флаг [ремовеаутпутсонстоп](https://docs.microsoft.com/rest/api/media/liveevents/stop#request-body) для автоматического удаления динамических выходных данных при прерывании. 

> [!TIP]
> См. раздел [руководство по потоковой передаче в реальном времени](stream-live-tutorial-with-api.md). в статье рассматривается код, реализующий описанные выше действия.

## <a name="other-important-articles"></a>Другие важные статьи

- [Recommended live streaming encoders](recommended-on-premises-live-encoders.md) (Рекомендуемые кодировщики потоковой трансляции)
- [Использование средства цифровой видеозаписи в облаке](live-event-cloud-dvr.md)
- [Сравнение типов LiveEvent](live-event-types-comparison.md)
- [Состояния и выставление счетов](live-event-states-billing.md)
- [Задержка](live-event-latency.md)

## <a name="ask-questions-give-feedback-get-updates"></a>Получение справки, отправка отзывов, получение обновлений

Прочитайте статью [сообщества Служб мультимедиа Azure](media-services-community.md), чтобы узнать, как задавать вопросы, оставлять отзывы и получать новости о Службах мультимедиа.

## <a name="next-steps"></a>Дальнейшие действия

* [Руководство по потоковой трансляции](stream-live-tutorial-with-api.md)
* [Руководство по миграции из версии 2 в версию 3 Служб мультимедиа](migrate-from-v2-to-v3.md)
