---
title: Закодировать пользовательские преобразования с помощью медиа-сервисов v3 .NET - Azure Документы Майкрософт
description: В этой теме показано, как использовать Azure Media Services v3 для кодирования пользовательского преобразования с помощью .NET.
services: media-services
documentationcenter: ''
author: Juliako
manager: femila
editor: ''
ms.service: media-services
ms.workload: ''
ms.topic: article
ms.date: 05/03/2019
ms.author: juliako
ms.custom: seodec18
ms.openlocfilehash: ebe701032e6416b3e007a28db62f5a8235bb1bb1
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "80068032"
---
# <a name="how-to-encode-with-a-custom-transform---net"></a>Как закодировать с помощью пользовательского преобразования - .NET

При кодировании с помощью Медиа-сервисов Azure можно быстро начать работу с одной из рекомендуемых встроенных пресетов на основе передовых отраслевых практик, продемонстрированных в учебнике [по стриминговым](stream-files-tutorial-with-api.md) файлам. Можно также создать пользовательский предустановленный набор для таргетинга на конкретный сценарий или требования к устройству.

## <a name="considerations"></a>Рекомендации

При создании пользовательских пресетов применяются следующие соображения:

* Все значения для высоты и ширины содержимого AVC должны быть кратными 4.
* В Azure Media Services v3 все бираты кодирования кодируются по биту в секунду. Это отличается от пресетов с нашими v2 AIS, которые использовали килобиты в секунду в качестве устройства. Например, если битрат в v2 был указан как 128 (килобит в секунду), то в v3 он будет установлен до 128000 (бит в секунду).

## <a name="prerequisites"></a>Предварительные требования 

[Создание учетной записи медиа-услуг](create-account-cli-how-to.md)

## <a name="download-the-sample"></a>Скачивание примера приложения

Клонируйте репозиторий GitHub, содержащий пример .NET Core, на компьютер с помощью следующей команды:  

 ```bash
 git clone https://github.com/Azure-Samples/media-services-v3-dotnet-core-tutorials.git
 ```
 
Пример настраиваемой предустановки находится в папке [EncodeCustomTransform](https://github.com/Azure-Samples/media-services-v3-dotnet-core-tutorials/blob/master/NETCore/EncodeCustomTransform/).

## <a name="create-a-transform-with-a-custom-preset"></a>Создание преобразования с помощью настраиваемой предустановки 

При создании [преобразования](https://docs.microsoft.com/rest/api/media/transforms) необходимо указать, что требуется создать в качестве выходных данных. Обязательный параметр — это объект [TransformOutput](https://docs.microsoft.com/rest/api/media/transforms/createorupdate#transformoutput), как показано в приведенном ниже примере кода. Каждый объект **TransformOutput** содержит **предустановку** (Preset). **Preset** описывает пошаговые инструкции по работе с видео и/или аудиообработкой, которые должны использоваться для создания желаемого **TransformOutput.** Следующая предустановка **TransformOutput** создает настраиваемый кодек и параметры слоя вывода.

При создании [преобразования](https://docs.microsoft.com/rest/api/media/transforms) сначала проверьте, существует ли оно, с помощью метода **Get**, как показано в следующем коде. В Media Services v3 **получите** методы на сущностях, **возвращающиеся нулевые,** если сущность не существует (проверка имени без чувствительного случая).

### <a name="example"></a>Пример

Следующий пример определяет набор выводов, которые мы хотим сгенерировать при использовании этого преобразования. Сначала мы добавляем слой AacAudio для кодирования звука и два слоя H264Video для кодирования видео. В слоях видео мы назначаем метки так, чтобы они могли использоваться в именах выходных файлов. Далее, мы хотим, чтобы выход также включал эскизы. В приведенном ниже примере мы указывать изображения в формате PNG, генерируемые при 50% разрешения входном видео, а в три временных метки - 25%, 50%, 75" длины вхоженного видео. Наконец, мы указываем формат для выходных файлов - один для видео-аудио, а другой для эскизов. Так как у нас есть несколько H264Layers, мы должны использовать макросы, которые производят уникальные имена на слой. Мы можем использовать `{Label}` `{Bitrate}` или макрос, пример показывает первый.

[!code-csharp[Main](../../../media-services-v3-dotnet-core-tutorials/NETCore/EncodeCustomTransform/MediaV3ConsoleApp/Program.cs#EnsureTransformExists)]

## <a name="next-steps"></a>Дальнейшие действия

[Файлы потоковой передачи](stream-files-tutorial-with-api.md) 
