---
title: Кодирование пользовательского преобразования, с помощью служб мультимедиа версии 3 .NET — Azure | Документация Майкрософт
description: В этом разделе показано, как использовать службы мультимедиа Azure v3 для кодирования пользовательское преобразование, с помощью .NET.
services: media-services
documentationcenter: ''
author: Juliako
manager: femila
editor: ''
ms.service: media-services
ms.workload: ''
ms.topic: article
ms.custom: seodec18
ms.date: 05/03/2019
ms.author: juliako
ms.openlocfilehash: 2167a74dc81bdbb2562211cf5c0195a755941d9d
ms.sourcegitcommit: d4dfbc34a1f03488e1b7bc5e711a11b72c717ada
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/13/2019
ms.locfileid: "65148337"
---
# <a name="how-to-encode-with-a-custom-transform---net"></a>Как кодировать с помощью пользовательского преобразования — .NET

При кодировании с помощью служб мультимедиа Azure, вы можете быстро начать работу с одним из рекомендуемых встроенные конфигурации на основе на передовых методах отрасли, как показано в [потоковая передача файлов](stream-files-tutorial-with-api.md) руководства. Можно также создать пользовательскую предустановку для конкретных требований сценария или устройства.

## <a name="considerations"></a>Рекомендации

Создавая пользовательские предустановки, следующие соображения.

* Все значения высоты и ширины в содержимом AVC, должны быть кратна 4.
* В Azure Media Services v3 все кодировки скоростей, в битах в секунду. Это отличается от предустановки с наши API версии 2, который используется в качестве единицы килобит в секунду. Например если скорости в версии 2 было указано как 128 (килобит в секунду), в версии 3 он устанавливается для 128000 (бит/с).

## <a name="prerequisites"></a>Технические условия 

[Создание учетной записи Служб мультимедиа](create-account-cli-how-to.md)

## <a name="download-the-sample"></a>Скачивание примера приложения

Клонируйте репозиторий GitHub, содержащий пример .NET Core, на компьютер с помощью следующей команды:  

 ```bash
 git clone https://github.com/Azure-Samples/media-services-v3-dotnet-core-tutorials.git
 ```
 
Пример настраиваемой предустановки находится в папке [EncodeCustomTransform](https://github.com/Azure-Samples/media-services-v3-dotnet-core-tutorials/blob/master/NETCore/EncodeCustomTransform/).

## <a name="create-a-transform-with-a-custom-preset"></a>Создание преобразования с помощью настраиваемой предустановки 

При создании [преобразования](https://docs.microsoft.com/rest/api/media/transforms) необходимо указать, что требуется создать в качестве выходных данных. Обязательный параметр — это объект [TransformOutput](https://docs.microsoft.com/rest/api/media/transforms/createorupdate#transformoutput), как показано в приведенном ниже примере кода. Каждый объект **TransformOutput** содержит **предустановку** (Preset). **Предустановку** описаны пошаговые инструкции, видео- и аудиоданных обработки операций, которые должны использоваться для создания нужного **TransformOutput**. Следующая предустановка **TransformOutput** создает настраиваемый кодек и параметры слоя вывода.

При создании [преобразования](https://docs.microsoft.com/rest/api/media/transforms) сначала проверьте, существует ли оно, с помощью метода **Get**, как показано в следующем коде. В Службах мультимедиа версии 3 методы **Get**, отправленные к сущностям, возвращают значение **NULL**, если сущность не существует (проверка по имени без учета регистра).

### <a name="example"></a>Пример

В следующем примере определяется набор выходных данных, которые должны создаваться, если это преобразование используется. Во-первых, мы добавим слой AacAudio для кодирования, аудио и два уровня H264Video, для кодирования видео. В слои видео мы присваивать метки, они могут использоваться в именах файлов выходных данных. Далее нам нужно, выходные данные для включения эскизов. В приведенном ниже примере мы указываем изображения в формате PNG, созданный на 50% от разрешения входного видео, а три метки времени — {25%, 50%, 75} Длина входного видео. Наконец, мы указываем формат для выходных файлов - один для видео и аудио, а другой для изображений эскизов. Так как у нас есть несколько H264Layers, нужно использовать макросы, которые создают уникальные имена на один уровень. Мы можем использовать `{Label}` или `{Bitrate}` макрос, в примере первый вариант.

[!code-csharp[Main](../../../media-services-v3-dotnet-core-tutorials/NETCore/EncodeCustomTransform/MediaV3ConsoleApp/Program.cs#EnsureTransformExists)]

## <a name="next-steps"></a>Дальнейшие действия

[Файлы потоковой передачи](stream-files-tutorial-with-api.md) 
