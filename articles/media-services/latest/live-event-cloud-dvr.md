---
title: Используйте время работы и выходы в реальном времени для воспроизведения видео по требованию
titleSuffix: Azure Media Services
description: В этой статье описывается, как использовать время изменения и Live выходы для записи Потоков в реальном времени и создания воспроизведения по требованию.
services: media-services
documentationcenter: ''
author: Juliako
manager: femila
editor: ''
ms.service: media-services
ms.workload: media
ms.tgt_pltfrm: na
ms.devlang: ne
ms.topic: article
ms.date: 08/27/2019
ms.author: juliako
ms.openlocfilehash: 4c7618b60e5fd86a9b8b3f22fb3333c00cfdfa61
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/27/2020
ms.locfileid: "74899801"
---
# <a name="use-time-shifting-and-live-outputs-to-create-on-demand-video-playback"></a>Используйте время работы и выходы в реальном времени для воспроизведения видео по требованию

В Службах мультимедиа Azure объект [Live Output](https://docs.microsoft.com/rest/api/media/liveoutputs) подосмена цифровому видеорегистратору, который будет ловить и записывать ваш живой поток в актив в вашей учетной записи Медиа-услуг. Записанное содержимое сохраняется в контейнере, определяемом ресурсом [актива](https://docs.microsoft.com/rest/api/media/assets) (контейнер находится в учетной записи Azure Storage, прикрепленной к вашей учетной записи). Live Output также позволяет контролировать некоторые свойства исходящего живого потока, например, сколько потока хранится в архивной записи (например, емкость облачного видеорегистратора) или когда зрители могут начать смотреть прямую трансляцию. Архив на диске представляет собой круговое архивное "окно", в котором содержится только количество содержимого, указанного в **свойстве archiveWindowLength** Live Output. Содержимое, выпавщее за пределы этого окна, автоматически выбрасывается из контейнера для хранения и не восстанавливается. Значение архиваWindowLength представляет продолжительность времени ISO-8601 (например, PTHH:MM:SS), которая определяет емкость видеорегистратора. Значение может быть установлено от минимум трех минут до максимум 25 часов.

Взаимосвязь между Live Event и его Live Outputs похожа на традиционную телевизионную трансляцию, в том, что канал (Live Event) представляет собой постоянный поток видео и запись (Live Output) приобщен к определенному временному сегменту (например, вечерние новости из с 18:30 до 19:00). После того, как поток влился в Live Event, вы можете начать потоковое событие, создав актив, Live Output и потоковое локатор. Выходные данные потоковой трансляции запустят архивирование потока и предложат его зрителям через [конечную точку потоковой передачи](https://docs.microsoft.com/rest/api/media/streamingendpoints). В событии потоковой трансляции можно создать несколько объектов выходных данных потоковой трансляции (до трех) с разными длиной и параметрами архивации. Для получения информации о рабочем процессе потоковой передачи в реальном времени смотрите [раздел "Общие шаги".](live-streaming-overview.md#general-steps)

## <a name="using-a-dvr-during-an-event"></a>Использование видеорегистратора во время мероприятия

В этом разделе рассматривается, как использовать видеорегистратор во время мероприятия, чтобы контролировать, какие части потока доступны для 'перемотки'.

Значение `archiveWindowLength` определяет, как далеко назад во времени зритель может уйти от текущего положения живого. Значение `archiveWindowLength` также определяет, как долго клиент проявляется может расти.

Предположим, что вы потокового футбольный `ArchiveWindowLength` матч, и он имеет только 30 минут. Зритель, который начинает смотреть событие спустя 45 минут после начала игры, может отмотать назад не далее, чем к отметке в 15 минут. Ваши живые выходы для игры будут продолжаться до тех пор, пока Live Event не будет остановлен. Содержимое, выпавщее за пределы архиваWindowLength, постоянно выбрасывается из хранилища и не восстановимое. В этом примере видео между началом мероприятия и 15-минутной отметкой было бы удалено из вашего видеорегистратора и из контейнера в хранилище каброй для актива. Архив не восстанавливается и удаляется из контейнера в хранилище Azure blob.

Live Event поддерживает до трех одновременно работающих Live Outputs (вы можете создавать не более 3 записей/архивов из одного живого потока одновременно). Эта поддержка позволяет публиковать и архивировать различные части события по мере необходимости. Предположим, что вам необходимо круглосуточно транслировать содержимое по линейному веб-каналу в реальном времени и создавать "записи" разных программ, чтобы клиенты могли по запросу просмотреть пропущенное содержимое. Для этого сценария сначала создается основной выход Live с коротким окном архива в 1 час или меньше – это основной живой эфир, в который настраивались бы ваши зрители. Вы создадите потоковое locator для этого Live Output и опубликуете его в своем приложении или на веб-сайте в качестве канала "Live". Запустив событие потоковой трансляции, вы можете программными средствами создавать дополнительный, параллельный компонент выходных данных потоковой трансляции в начале программы (или на 5 минут раньше, чтобы оставить запас на небольшие сдвиги, который вы удалите позднее). Этот дополнительный компонент выходных данных потоковой трансляции можно удалить через 5 минут после окончания программы. С помощью этого второго актива можно создать новый streaming Locator для публикации этой программы в качестве актива по требованию в каталоге вашего приложения. Этот процесс можно повторять любое количество раз для других программ или особо важных моментов, которые вы хотите предоставить в качестве видео по запросу. При этом веб-канал "потоковой трансляции" из первого компонента выходных данных продолжает транслировать содержимое по линейному веб-каналу.

## <a name="creating-an-archive-for-on-demand-playback"></a>Создание архива для воспроизведения по требованию

Актив, который архивирует Live Output, автоматически становится активом по требованию при удалении Live Output. Вы должны удалить все живые выходы, прежде чем Live Event может быть остановлен. Вы можете использовать дополнительный флаг [removeOutputsOnStop,](https://docs.microsoft.com/rest/api/media/liveevents/stop#request-body) чтобы автоматически удалить живые выходы на остановке.

Даже после того, как вы остановите и удалите событие, пользователи могут передавать ваш архивный контент в виде видео по требованию, если вы не удалите ресурс. Актив не должен быть удален, если он используется событием; событие должно быть удалено в первую очередь.

Если вы опубликовали актив вашего Live Output с помощью потокового локатора, Live Event (до длины окна DVR) будет по-прежнему просматриваться до истечения или удаления потокового локатора, в зависимости от того, что наступит раньше.

Дополнительные сведения см. в разделе:

- [Общие сведения о потоковой трансляции](live-streaming-overview.md)
- [Руководство по потоковой трансляции](stream-live-tutorial-with-api.md)

> [!NOTE]
> При удалении Live Output вы не удаляете базовый актив и содержимое актива.

## <a name="next-steps"></a>Дальнейшие действия

* [Подстегивайте видео](subclip-video-rest-howto.md).
* [Определите фильтры для ваших активов.](filters-dynamic-manifest-rest-howto.md)
