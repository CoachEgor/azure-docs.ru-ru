---
title: Используйте сдвиги времени и динамические выходные данные, чтобы создать воспроизведение видео по запросу
titleSuffix: Azure Media Services
description: В этой статье описывается, как использовать сдвиги времени и динамические выходные данные для записи динамических потоков и создания воспроизведения по запросу.
services: media-services
documentationcenter: ''
author: Juliako
manager: femila
editor: ''
ms.service: media-services
ms.workload: media
ms.tgt_pltfrm: na
ms.devlang: ne
ms.topic: article
ms.date: 08/27/2019
ms.author: juliako
ms.openlocfilehash: 4c7618b60e5fd86a9b8b3f22fb3333c00cfdfa61
ms.sourcegitcommit: 375b70d5f12fffbe7b6422512de445bad380fe1e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/06/2019
ms.locfileid: "74899801"
---
# <a name="use-time-shifting-and-live-outputs-to-create-on-demand-video-playback"></a>Используйте сдвиги времени и динамические выходные данные, чтобы создать воспроизведение видео по запросу

В службах мультимедиа Azure [динамический выходной](https://docs.microsoft.com/rest/api/media/liveoutputs) объект подобен цифровому видеозаписывающему, который будет перехватывать и записывать динамический поток в ресурс в учетной записи служб мультимедиа. Записанное содержимое сохраняется в контейнере [, определенном ресурсом](https://docs.microsoft.com/rest/api/media/assets) ресурса (контейнер находится в учетной записи хранения Azure, присоединенной к вашей учетной записи). Выходные данные в реальном времени также позволяют управлять некоторыми свойствами исходящего активного потока, например объемом потока, который хранится в записи архива (например, емкостью DVR для облака) или когда читатели могут начать просмотр потока в реальном времени. Архив на диске — это циклический Архив "Window", который содержит только объем содержимого, указанного в свойстве **оно** выходного выхода. Содержимое, которое находится за пределами этого окна, автоматически удаляется из контейнера хранилища и не может быть восстановлено. Значение оно представляет собой длительность ISO-8601 TimeSpan (например, ПСХ: MM: SS), которая указывает емкость DVR. Значение может быть не менее трех минут, а не больше 25 часов.

Связь между событием Live и его обычными выходными данными аналогична традиционной телетрансляции, в том, что канал (прямая трансляция) представляет собой постоянный поток видео и запись (выходные данные в реальном времени), ограниченный конкретным временным сегментом (например, вечером новостей из 6:30 до 7:12:00). Когда поток переводится в интерактивное событие, вы можете начать потоковую передачу события, создав ресурс, динамический выход и указатель потоковой передачи. Выходные данные потоковой трансляции запустят архивирование потока и предложат его зрителям через [конечную точку потоковой передачи](https://docs.microsoft.com/rest/api/media/streamingendpoints). Вы можете создать несколько динамических выходных данных (до трех максимумов) на динамическом событии с разными длинами и параметрами архива. Сведения о рабочем процессе потоковой передачи в реальном времени см. в разделе [Общие действия](live-streaming-overview.md#general-steps) .

## <a name="using-a-dvr-during-an-event"></a>Использование DVR во время события

В этом разделе описывается использование DVR во время события для управления тем, какие части потока доступны для операции "Перемотка назад".

Значение `archiveWindowLength` определяет, насколько далеко назад средство просмотра может перейти из текущей активной должности. Значение `archiveWindowLength` также определяет, как долго могут расти манифесты клиента.

Предположим, что вы выполняете потоковую передачу на футболку и занимаетесь `ArchiveWindowLength` всего за 30 минут. Зритель, который начинает смотреть событие спустя 45 минут после начала игры, может отмотать назад не далее, чем к отметке в 15 минут. Ваши Интерактивные выходные данные для игры будут продолжены до тех пор, пока не будет остановлено активное событие. Содержимое, которое находится за пределами оно, постоянно удаляется из хранилища и не может быть восстановлено. В этом примере видео между началом события и 15-минутной меткой было удалено из DVR и из контейнера в хранилище BLOB-объектов для ресурса. Архив недоступен для восстановления и удаляется из контейнера в хранилище BLOB-объектов Azure.

Динамическое событие поддерживает до трех параллельно выполняющихся динамических выходов (вы можете одновременно создать не более трех записей и архивов из одного активного потока). Эта поддержка позволяет публиковать и архивировать различные части события по мере необходимости. Предположим, что вам необходимо круглосуточно транслировать содержимое по линейному веб-каналу в реальном времени и создавать "записи" разных программ, чтобы клиенты могли по запросу просмотреть пропущенное содержимое. В этом сценарии вы сначала создаете основной динамический выход с коротким окном архива в 1 час или меньше — это основной динамический поток, в который ваши читатели будут выполнять настройку. Вы создадите указатель потоковой передачи для этого выходного потока и опубликуете его в приложении или на веб-сайте в качестве интерактивного веб-канала. Пока выполняется интерактивное событие, можно программно создать второй параллельный выходной поток в начале программы (или 5 минут раньше, чтобы предоставить несколько дескрипторов для обрезки). Второй динамический выход может быть удален через 5 минут после завершения программы. С помощью этого второго ресурса можно создать новый указатель потоковой передачи, чтобы опубликовать эту программу как ресурс-контейнер по запросу в каталоге приложения. Этот процесс можно повторить несколько раз для других границ программы или подсветов, которые вы хотите использовать в качестве видеороликов по запросу, в то время как интерактивный канал из первого интерактивного выхода продолжит транслировать линейный канал.

## <a name="creating-an-archive-for-on-demand-playback"></a>Создание архива для воспроизведения по требованию

Ресурс, в котором происходит архивация в режиме реального времени, автоматически становится активом по запросу при удалении активного выхода. Прежде чем можно будет остановить интерактивное событие, необходимо удалить все активные выходные данные. Можно использовать необязательный флаг [ремовеаутпутсонстоп](https://docs.microsoft.com/rest/api/media/liveevents/stop#request-body) для автоматического удаления динамических выходных данных при прерывании.

Даже после завершения и удаления события пользователи могут выполнять потоковую передачу архивного содержимого в виде видео по запросу, пока вы не удалите ресурс. Ресурс не должен удаляться, если он используется событием; Сначала необходимо удалить событие.

Если вы опубликовали ресурс в режиме реального времени с помощью указателя потоковой передачи, событие в реальном времени (до длины окна DVR) будет по-прежнему отображаться до истечения срока действия указателя потоковой передачи или удаления, в зависимости от того, что происходит раньше.

Дополнительные сведения см. здесь:

- [Потоковая трансляция в Службах мультимедиа Azure версии 3](live-streaming-overview.md)
- [Руководство по потоковой трансляции](stream-live-tutorial-with-api.md)

> [!NOTE]
> Когда вы удаляете динамический выход, вы не удаляете базовый ресурс и содержимое в ресурсе.

## <a name="next-steps"></a>Дальнейшие действия

* [Подрежьте видео](subclip-video-rest-howto.md).
* [Определите фильтры для своих ресурсов](filters-dynamic-manifest-rest-howto.md).
