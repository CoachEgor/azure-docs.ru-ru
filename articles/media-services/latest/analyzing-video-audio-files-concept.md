---
title: Анализ видео- и аудиофайлов
titleSuffix: Azure Media Services
description: Узнайте, как анализировать аудио- и видеоконтент с помощью AudioAnalyzerPreset и VideoAnalyzerPreset в медиасервисах Azure.
services: media-services
documentationcenter: ''
author: Juliako
manager: femila
editor: ''
ms.service: media-services
ms.workload: ''
ms.topic: article
ms.date: 01/30/2020
ms.author: juliako
ms.openlocfilehash: 1d28fc37b98493322b9e201ac899b7911dd1d705
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "79269891"
---
# <a name="analyze-video-and-audio-files-with-azure-media-services"></a>Анализ видео- и аудиофайлов с помощью медиаслужб Azure

Azure Media Services v3 позволяет извлекать сведения из видео- и аудиофайлов с помощью Video Indexer. В этой статье описывается медиа-услуг v3 анализатор пресетов, используемых для извлечения этих идей. Если вам нужны более подробные аналитические сведения, используйте непосредственно Индексатор видео. Чтобы понять, когда использовать видео индексер против медиа-услуг анализатор пресетов, проверить [сравнение документа](../video-indexer/compare-video-indexer-with-media-services-presets.md).

Чтобы проанализировать свой контент с помощью пресетов Media Services v3, вы создаете **преобразование** и отправляете **задание,** использующего одну из этих пресетов: [VideoAnalyzerPreset](https://docs.microsoft.com/rest/api/media/transforms/createorupdate#videoanalyzerpreset) или **AudioAnalyzerPreset.** Для руководства, демонстрирующего, как использовать **VideoAnalyzerPreset,** смотрите [анализ видео с Azure Media Services](analyze-videos-tutorial-with-api.md).

> [!NOTE]
> Используя наборы настроек анализаторов, установите 10 зарезервированных единиц мультимедиа S3 для своей учетной записи на портале Azure. Дополнительные сведения см. в [этой статье](media-reserved-units-cli-how-to.md).

## <a name="compliance-privacy-and-security"></a>Соответствие требованиям, конфиденциальность и безопасность

Хотим напомнить, что при использовании Индексатора видео вы должны соблюдать все применимые законы, и не имеете права использовать Индексатор видео или любые другие службы Azure каким либо способом, который нарушает права других лиц или может нанести им вред. Перед отправкой любого видеосодержимого, включая любые биометрические данные, в службу "Индексатор видео" для обработки и хранения данных необходимо иметь все необходимые права, включая все возможные разрешения, от отдельных пользователей, содержащихся в видеосодержимом. Чтобы узнать о соответствии требованиям, конфиденциальности и безопасности в Индексаторе видео, см. [Условия Microsoft Cognitive Services](https://azure.microsoft.com/support/legal/cognitive-services-compliance-and-privacy/). Обязательства Майкрософт по обеспечению конфиденциальности и обработке ваших данных см. в [Заявлении о конфиденциальности](https://privacy.microsoft.com/PrivacyStatement), [Условиях использования веб-служб](https://www.microsoft.com/licensing/product-licensing/products) ("OST") и [Приложение к обработке данных](https://www.microsoftvolumelicensing.com/DocumentSearch.aspx?Mode=3&DocumentTypeId=67) ("DPA"). Дополнительные сведения о конфиденциальности, включая хранение данных, их удаление или уничтожение, доступны в OST и [здесь](../video-indexer/faq.md). Используя Индексатор видео, обязуетесь соблюдать Условия Cognitive Services, OST, DPA и Заявление о конфиденциальности.

## <a name="built-in-presets"></a>Встроенные предустановки

Сейчас Службы мультимедиа поддерживают следующие встроенные предустановки анализатора:  

|**Имя предустановки**|**Сценарий**|**Подробно**|
|---|---|---|
|[AudioAnalyzerPreset](https://docs.microsoft.com/rest/api/media/transforms/createorupdate#audioanalyzerpreset)|Анализ аудио|Эта предустановка применяет предопределенный набор операций анализа на основе ИИ, включая транскрибирование речи. В настоящее время она поддерживает обработку содержимого с одной звуковой дорожкой, содержащей речь на одном языке. Можно указать язык для полезных данных аудио во входных данных. Для этого используется формат BCP-47 "тег языка — регион". Поддерживаемые языки: английский ('en-US' и 'en-GB'), испанский ('es-ES' и 'es-MX'), французский ('fr-FR'), итальянский ('it-IT'), японский ('ja-JP'), португальский ('pt-BR'), китайский ('zh-CN'), немецкий ('de-DE'), арабский ('ar-EG') Хинди ('hi-IN'), и корейский ('ko-KR').<br/><br/> Если язык не указан или установлен на нуле, автоматическое обнаружение языка выбирает обнаруженный первый язык и продолжает сярретсив с выбранным языком в течение всего срока действия файла. Функция автоматического определения языка сейчас поддерживается для таких языков: английский, китайский, французский, немецкий, итальянский, японский, испанский, русский и португальский. Он не поддерживает динамическое переключение между языками после обнаружения первого языка. Автоматическое распознавание языка лучше всего работает с аудиозаписями с четко различимой речью. Если автоматическое обнаружение языка не может найти язык, транскрипция возвращается на английский язык.|
|[VideoAnalyzerPreset](https://docs.microsoft.com/rest/api/media/transforms/createorupdate#videoanalyzerpreset)|Анализ аудио и видео|Извлекает из аудио и видео аналитические данные (подробные метаданные) и выдает файл в формате JSON. Можно указать, если нужно извлекать аналитические данные только для аудио при обработке видеофайла. Дополнительные сведения см. в статье [Руководство. Анализ видео с помощью Служб мультимедиа Azure](analyze-videos-tutorial-with-api.md).|
|[FaceDetectorPreset](https://docs.microsoft.com/rest/api/media/transforms/createorupdate#facedetectorpreset)|Обнаружение лиц, присутствующих на видео|Описывает настройки, которые будут использоваться при анализе видео для обнаружения всех присутствующих лиц.|

### <a name="audioanalyzerpreset"></a>AudioAnalyzerPreset

Эта предустановка позволяет извлечь из аудио- и видеофайлов множество аналитических сведений об аудио. Выходные данные включают в себя JSON-файл (со всеми сведениями) и VTT-файл расшифровки аудиозаписи. Эта предустановка принимает свойство, которое указывает язык входного файла в виде строки [BCP47](https://tools.ietf.org/html/bcp47). Аналитические сведения об аудиофайле включают в себя:

* **Аудио транскрипция**: Стенограмма произнесенных слов с метками времени. Поддерживается несколько языков.
* **Индексирование динамика**: Отображение динамиков и соответствующих произнесенных слов.
* **Анализ настроений речи**: Выход анализа настроений, выполненных на аудио транскрипции.
* **Ключевые слова**: Ключевые слова, которые извлекаются из аудио транскрипции.

### <a name="videoanalyzerpreset"></a>VideoAnalyzerPreset

Эта предустановка позволяет извлечь из видеофайлов множество аналитических сведений об аудио и видео. Выходные данные включают в себя JSON-файл (со всеми сведениями), VTT-файл расшифровки аудиозаписи и коллекцию эскизов видео. Эта предустановка также принимает строку [​​BCP47](https://tools.ietf.org/html/bcp47) (представляющую язык видео) как свойство. Сведения о видеосодержимом включают в себя все сведения об аудиосодержимом, упомянутые выше, и следующие дополнительные элементы:

* **Отслеживание лица**: Время, в течение которого лица присутствуют в видео. Каждое лицо имеет идентификатор лица и соответствующую коллекцию эскизов.
* **Визуальный текст**: Текст, который обнаруживается с помощью оптического распознавания символов. Текст штамп времени, а также используется для извлечения ключевых слов (в дополнение к аудио стенограммы).
* **Ключевые кадры**: Коллекция ключевых кадров, извлеченных из видео.
* **Умеренность визуального контента**: Часть видео помечена как взрослая или колоритная по своей природе.
* **Аннотация**: Результат аннотации видео на основе заранее определенной модели объекта

## <a name="insightsjson-elements"></a>Элементы insights.json

Выход включает в себя файл JSON (insights.json) со всеми идеями, найденными в видео или аудио. JSON может содержать следующие элементы:

### <a name="transcript"></a>transcript

|name|Описание|
|---|---|
|идентификатор|Идентификатор строки.|
|text|Сама расшифровка аудиозаписи.|
|Язык|Язык расшифровки аудиозаписи. Предназначен для поддержки расшифровки, где каждая строка может быть написана на другом языке.|
|instances|Список диапазонов времени, в которых появилась эта строка. Если экземпляр является расшифровкой, будет отображаться только один экземпляр.|

Пример

```json
"transcript": [
{
    "id": 0,
    "text": "Hi I'm Doug from office.",
    "language": "en-US",
    "instances": [
    {
        "start": "00:00:00.5100000",
        "end": "00:00:02.7200000"
    }
    ]
},
{
    "id": 1,
    "text": "I have a guest. It's Michelle.",
    "language": "en-US",
    "instances": [
    {
        "start": "00:00:02.7200000",
        "end": "00:00:03.9600000"
    }
    ]
}
] 
```

### <a name="ocr"></a>ocr

|name|Описание|
|---|---|
|идентификатор|Идентификатор строки OCR.|
|text|Текст OCR.|
|confidence|Достоверность распознавания.|
|Язык|Язык OCR.|
|instances|Список диапазонов времени, где появилось это OCR (одно и то же OCR может появляться несколько раз).|

```json
"ocr": [
    {
      "id": 0,
      "text": "LIVE FROM NEW YORK",
      "confidence": 0.91,
      "language": "en-US",
      "instances": [
        {
          "start": "00:00:26",
          "end": "00:00:52"
        }
      ]
    },
    {
      "id": 1,
      "text": "NOTICIAS EN VIVO",
      "confidence": 0.9,
      "language": "es-ES",
      "instances": [
        {
          "start": "00:00:26",
          "end": "00:00:28"
        },
        {
          "start": "00:00:32",
          "end": "00:00:38"
        }
      ]
    }
  ],
```

### <a name="faces"></a>faces

|name|Описание|
|---|---|
|идентификатор|Идентификатор лица.|
|name|Обозначение лица. Это может быть "Неизвестный #0", идентифицированная знаменитость, или обученный клиент человек.|
|confidence|Достоверности идентификации лица.|
|description|Текстовое описание знаменитости. |
|thumbnailId|Идентификатор эскиза лица.|
|knownPersonId|Внутренний идентификатор (если это известный человек).|
|referenceId|Bing ID (если это знаменитость Bing).|
|referenceType|В настоящее время только Bing.|
|title|Название (если это знаменитость, например, "Генеральный директор Microsoft").|
|imageurl|URL-адрес изображения, если это знаменитость.|
|instances|Случаи, когда лицо появилось в заданном диапазоне времени. У каждого экземпляра также есть thumbnailsId. |

```json
"faces": [{
    "id": 2002,
    "name": "Xam 007",
    "confidence": 0.93844,
    "description": null,
    "thumbnailId": "00000000-aee4-4be2-a4d5-d01817c07955",
    "knownPersonId": "8340004b-5cf5-4611-9cc4-3b13cca10634",
    "referenceId": null,
    "title": null,
    "imageUrl": null,
    "instances": [{
        "thumbnailsIds": ["00000000-9f68-4bb2-ab27-3b4d9f2d998e",
        "cef03f24-b0c7-4145-94d4-a84f81bb588c"],
        "adjustedStart": "00:00:07.2400000",
        "adjustedEnd": "00:00:45.6780000",
        "start": "00:00:07.2400000",
        "end": "00:00:45.6780000"
    },
    {
        "thumbnailsIds": ["00000000-51e5-4260-91a5-890fa05c68b0"],
        "adjustedStart": "00:10:23.9570000",
        "adjustedEnd": "00:10:39.2390000",
        "start": "00:10:23.9570000",
        "end": "00:10:39.2390000"
    }]
}]
```

### <a name="shots"></a>shots

|name|Описание|
|---|---|
|идентификатор|Идентификатор снимка.|
|keyframes|Список ключевых кадров в снимке (каждый из них имеет идентификатор и список временных интервалов экземпляров). Экземпляры ключевых кадров имеют поле thumbnailId с идентификатором эскиза keyFrame.|
|instances|Список временных интервалов этого снимка (снимки имеют только один экземпляр).|

```json
"Shots": [
    {
      "id": 0,
      "keyFrames": [
        {
          "id": 0,
          "instances": [
            {
                "thumbnailId": "00000000-0000-0000-0000-000000000000",
              "start": "00: 00: 00.1670000",
              "end": "00: 00: 00.2000000"
            }
          ]
        }
      ],
      "instances": [
        {
            "thumbnailId": "00000000-0000-0000-0000-000000000000",  
          "start": "00: 00: 00.2000000",
          "end": "00: 00: 05.0330000"
        }
      ]
    },
    {
      "id": 1,
      "keyFrames": [
        {
          "id": 1,
          "instances": [
            {
                "thumbnailId": "00000000-0000-0000-0000-000000000000",      
              "start": "00: 00: 05.2670000",
              "end": "00: 00: 05.3000000"
            }
          ]
        }
      ],
      "instances": [
        {
      "thumbnailId": "00000000-0000-0000-0000-000000000000",
          "start": "00: 00: 05.2670000",
          "end": "00: 00: 10.3000000"
        }
      ]
    }
  ]
```

### <a name="statistics"></a>статистика

|name|Описание|
|---|---|
|CorrespondenceCount|Количество соответствий в видео.|
|WordCount|Число слов каждого говорящего.|
|SpeakerNumberOfFragments|Число фрагментов в видео на определенного говорящего.|
|SpeakerLongestMonolog|Самый длинный монолог говорящего. Если динамик имеет тишины внутри монолога он включен. Паузы в начале и конце монолога удаляются.|
|SpeakerTalkToListenRatio|Результат вычисления основан на длительности монолога говорящего (без учета пауз между монологами), деленной на общее время видео. Значение времени округляется до трех знаков после запятой.|


### <a name="sentiments"></a>sentiments

Тональность агрегируется по полю sensimentType (позитивная/нейтральная/негативная). Например, 0–0,1 0,2–0,1.

|name|Описание|
|---|---|
|идентификатор|Идентификатор тональности.|
|averageScore |Среднее значение всех оценок всех экземпляров этого типа тональности — позитивная/нейтральная/негативная.|
|instances|Список диапазонов времени, в которых появилась эта тональность.|
|sentimentType |Может иметь значение Positive, Neutral или Negative.|

```json
"sentiments": [
{
    "id": 0,
    "averageScore": 0.87,
    "sentimentType": "Positive",
    "instances": [
    {
        "start": "00:00:23",
        "end": "00:00:41"
    }
    ]
}, {
    "id": 1,
    "averageScore": 0.11,
    "sentimentType": "Positive",
    "instances": [
    {
        "start": "00:00:13",
        "end": "00:00:21"
    }
    ]
}
]
```

### <a name="labels"></a>метки;

|name|Описание|
|---|---|
|идентификатор|Идентификатор метки.|
|name|Название метки (например, "Компьютер", "Телевизор").|
|Язык|Язык метки (при наличии перевода). BCP-47|
|instances|Список диапазонов времени, где появилась эта метка (метка может появляться несколько раз). У каждого экземпляра есть поле достоверности. |

```json
"labels": [
    {
      "id": 0,
      "name": "person",
      "language": "en-US",
      "instances": [
        {
          "confidence": 1.0,
          "start": "00: 00: 00.0000000",
          "end": "00: 00: 25.6000000"
        },
        {
          "confidence": 1.0,
          "start": "00: 01: 33.8670000",
          "end": "00: 01: 39.2000000"
        }
      ]
    },
    {
      "name": "indoor",
      "language": "en-US",
      "id": 1,
      "instances": [
        {
          "confidence": 1.0,
          "start": "00: 00: 06.4000000",
          "end": "00: 00: 07.4670000"
        },
        {
          "confidence": 1.0,
          "start": "00: 00: 09.6000000",
          "end": "00: 00: 10.6670000"
        },
        {
          "confidence": 1.0,
          "start": "00: 00: 11.7330000",
          "end": "00: 00: 20.2670000"
        },
        {
          "confidence": 1.0,
          "start": "00: 00: 21.3330000",
          "end": "00: 00: 25.6000000"
        }
      ]
    }
  ] 
```

### <a name="keywords"></a>keywords

|name|Описание|
|---|---|
|идентификатор|Идентификатор ключевого слова.|
|text|Идентификатор текста.|
|confidence|Достоверность распознавания ключевого слова.|
|Язык|Язык ключевого слова (при наличии перевода).|
|instances|Список диапазонов времени, где появилось это ключевое слово (ключевое слово может появляться несколько раз).|

```json
"keywords": [
{
    "id": 0,
    "text": "office",
    "confidence": 1.6666666666666667,
    "language": "en-US",
    "instances": [
    {
        "start": "00:00:00.5100000",
        "end": "00:00:02.7200000"
    },
    {
        "start": "00:00:03.9600000",
        "end": "00:00:12.2700000"
    }
    ]
},
{
    "id": 1,
    "text": "icons",
    "confidence": 1.4,
    "language": "en-US",
    "instances": [
    {
        "start": "00:00:03.9600000",
        "end": "00:00:12.2700000"
    },
    {
        "start": "00:00:13.9900000",
        "end": "00:00:15.6100000"
    }
    ]
}
] 
```

#### <a name="visualcontentmoderation"></a>visualContentModeration

Блок visualContentModeration содержит диапазоны времени, в которых Индексатор видео, вероятно, обнаружил содержимое для взрослых. Если visualContentModeration пуст, нет никакого контента для взрослых, который был идентифицирован.

Видео, в которых обнаружено содержимое для взрослых или содержимое непристойного характера, могут быть доступны только для закрытого просмотра. Пользователи могут отправить запрос на человеческий обзор содержимого, и в этом случае `IsAdult` атрибут будет содержать результат человеческого обзора.

|name|Описание|
|---|---|
|идентификатор|Идентификатор модерации визуального контента.|
|adultScore|Результат оценки содержимого для взрослых (от Content Moderator).|
|racyScore|Результат оценки содержимого непристойного характера (от Content Moderator).|
|instances|Список диапазонов времени, где применяется модерация контента.|

```json
"VisualContentModeration": [
{
    "id": 0,
    "adultScore": 0.00069,
    "racyScore": 0.91129,
    "instances": [
    {
        "start": "00:00:25.4840000",
        "end": "00:00:25.5260000"
    }
    ]
},
{
    "id": 1,
    "adultScore": 0.99231,
    "racyScore": 0.99912,
    "instances": [
    {
        "start": "00:00:35.5360000",
        "end": "00:00:35.5780000"
    }
    ]
}
] 
```
## <a name="next-steps"></a>Дальнейшие действия

[Руководство. Анализ видео с помощью Служб мультимедиа Azure](analyze-videos-tutorial-with-api.md)
