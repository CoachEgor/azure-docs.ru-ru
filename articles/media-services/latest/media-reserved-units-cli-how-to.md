---
title: Использование CLI для масштабирования зарезервированных единиц кодирования — Azure | Документация Майкрософт
description: В этом разделе показано, как использовать CLI для масштабирования обработки мультимедиа с использованием служб мультимедиа Azure.
services: media-services
documentationcenter: ''
author: juliako
manager: femila
editor: ''
ms.service: media-services
ms.workload: media
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 03/09/2020
ms.author: juliako
ms.custom: seodec18
ms.openlocfilehash: 79f2df0f94b212ea45c01c825b23f1dbb4cc40db
ms.sourcegitcommit: 849bb1729b89d075eed579aa36395bf4d29f3bd9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2020
ms.locfileid: "80582287"
---
# <a name="scaling-media-processing"></a>Масштабирование при обработке мультимедиа

Службы мультимедиа Azure позволяют масштабировать обработку мультимедиа в учетной записи, управляя зарезервированными единицами мультимедиа (MRU). Мрус определяет скорость обработки задач обработки мультимедиа. Вы можете выбрать один из следующих типов зарезервированных единиц: **S1**, **S2** или **S3**. Например, если использовать тип зарезервированной единицы **S2**, задание по кодированию выполняется быстрее по сравнению заданием, для которого выбран тип **S1**. 

Помимо указания типа зарезервированных единиц, можно также указать параметр, позволяющий использовать зарезервированные единицы при подготовке учетной записи. Количеством подготовленных зарезервированных единиц определяется количество задач мультимедиа, которые могут одновременно обрабатываться в данной учетной записи. Например, если в учетной записи имеется пять зарезервированных единиц, то будет запущено пять одновременно выполняемых задач мультимедиа, если имеются задачи, которые требуется обработать. Остальные задачи будут ожидать в очереди, они будут последовательно отбираться для обработки после завершения выполнения текущей задачи. Если учетная запись не имеет подготовленных зарезервированных единиц, задачи будут отбираться последовательно. В этом случае время ожидания между завершением одной задачи и началом выполнения следующей будет зависеть от доступности ресурсов в системе.

## <a name="choosing-between-different-reserved-unit-types"></a>Выбор между разными типами зарезервированных единиц

Следующая таблица помогает принять решение при выборе между разными скоростями кодирования. Кроме того, в [видео, которое можно загрузить](https://nimbuspmteam.blob.core.windows.net/asset-46f1f723-5d76-477e-a153-3fd0f9f90f73/SeattlePikePlaceMarket_7min.ts?sv=2015-07-08&sr=c&si=013ab6a6-5ebf-431e-8243-9983a6b5b01c&sig=YCgEB8DxYKK%2B8W9LnBykzm1ZRUTwQAAH9QFUGw%2BIWuc%3D&se=2118-09-21T19%3A28%3A57Z), представлено несколько вариантов тестов производительности, чтобы вы могли выполнить собственное тестирование.

|Тип зарезервированных единиц|Сценарий|Пример результатов для [видео длительностью 7 мин. с разрешением 1080p](https://nimbuspmteam.blob.core.windows.net/asset-46f1f723-5d76-477e-a153-3fd0f9f90f73/SeattlePikePlaceMarket_7min.ts?sv=2015-07-08&sr=c&si=013ab6a6-5ebf-431e-8243-9983a6b5b01c&sig=YCgEB8DxYKK%2B8W9LnBykzm1ZRUTwQAAH9QFUGw%2BIWuc%3D&se=2118-09-21T19%3A28%3A57Z)|
|---|---|---|
| **S1**|Односкоростное кодирование. <br/> Файлы с разрешением SD или ниже, без учета времени, низкие затраты.|Кодирование в файл MP4 с односкоростным SD-файлом с помощью "H264 Single bitrate с односкоростным SD-16x9" занимает около 7 минут.|
| **S2**|Односкоростное и многоскоростное кодирование.<br/> Обычное использование для кодирования SD и HD.|Кодирование с предустановленной установкой H264 Single bitrate с односкоростной скоростью 720p занимает около 6 минут.<br/><br/>Кодирование с предустановленной установкой "H264 Single bitrate несколько скорость 720p" занимает около 12 минут.|
| **S3**|Односкоростное и многоскоростное кодирование.<br/> Видеоролики с разрешением Full HD и 4К. С учетом времени, более быстрое полное кодирование.|Кодирование с предустановкой "H264 Single bitrate односкоростной" требует приблизительно 3 минут.<br/><br/>Кодирование с предустановкой H264 Multiple Bitrate 1080p длится 8 минут.|

## <a name="considerations"></a>Рекомендации

* Для заданий анализа аудио и видео, которые активируют Службы мультимедиа версии 3 или Индексатор видео, настоятельно рекомендуется использовать единицу типа S3.
* При использовании общего пула, т. е. без зарезервированных единиц, задачи кодирования будут иметь такую же производительность, что и с зарезервированными единицами S1. Однако время, которое задачи могут находиться в очереди, не ограничено, и в каждый момент времени будет выполняться не более чем одна задача.

В оставшейся части статьи показано, как использовать [службы мультимедиа v3 CLI](https://aka.ms/ams-v3-cli-ref) для масштабирования мрус.

> [!NOTE]
> Для заданий анализа аудио и видео, которые активируют Службы мультимедиа версии 3 или Индексатор видео, настоятельно рекомендуется подготовить к работе вашу учетную запись с помощью 10 единиц MRU S3. Если вам требуется более 10 единиц MRU S3, отправьте запрос в службу поддержки с помощью [портала Azure](https://portal.azure.com/).

## <a name="prerequisites"></a>Предварительные требования 

[Создание учетной записи Служб мультимедиа](create-account-cli-how-to.md).

[!INCLUDE [media-services-cli-instructions](../../../includes/media-services-cli-instructions.md)]

## <a name="scale-media-reserved-units-with-cli"></a>Масштабирование зарезервированных единиц кодирования с помощью интерфейса командной строки

Выполните команду `mru`.

Следующая команда [az ams account mru](https://docs.microsoft.com/cli/azure/ams/account/mru?view=azure-cli-latest) настраивает зарезервированные единицы мультимедиа в учетной записи amsaccount с использованием параметров **count** и **type**.

```azurecli
az ams account mru set -n amsaccount -g amsResourceGroup --count 10 --type S3
```

## <a name="billing"></a>Выставление счетов

Вы платите за количество минут, в течение которых зарезервированные единицы мультимедиа подготавливаются в вашей учетной записи. Это происходит независимо от того, выполняются ли в вашей учетной записи какие-либо задания. Подробное описание см. в разделе часто задаваемых вопросов на странице [цен на службы мультимедиа](https://azure.microsoft.com/pricing/details/media-services/).   

## <a name="next-step"></a>Дальнейшие действия

[Анализ видео](analyze-videos-tutorial-with-api.md) 

## <a name="see-also"></a>См. также

* [Квоты и ограничения](limits-quotas-constraints.md)
* [Azure CLI](https://docs.microsoft.com/cli/azure/ams?view=azure-cli-latest)
