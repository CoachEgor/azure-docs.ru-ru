---
title: Потоковые конечные точки (Origin)
titleSuffix: Azure Media Services
description: Узнайте о потоковой работе (Origin), динамическом упаковочном и потоковом сервисе, который доставляет контент непосредственно в приложение игрока-клиента или в сеть доставки контента (CDN).
services: media-services
documentationcenter: ''
author: Juliako
manager: femila
editor: ''
ms.service: media-services
ms.workload: ''
ms.topic: article
ms.date: 02/13/2020
ms.author: juliako
ms.openlocfilehash: 1a2a370ac92ea3edf925d97af6f5e721c79d0d2d
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "79529702"
---
# <a name="streaming-endpoints-origin-in-azure-media-services"></a>Потоковые конечные точки (Origin) в медиаслужбах Azure

В Microsoft Azure Media Services [потоковая конечная точка](https://docs.microsoft.com/rest/api/media/streamingendpoints) представляет собой динамическую (точно в срок) упаковочную и отправную службу, которая может доставлять содержимое в реальном времени и по требованию непосредственно в приложение игрока-клиента с помощью одного из распространенных протоколов потокового мультимедиа (HLS или DASH). Кроме того, **Потоковая конечная точка** обеспечивает динамическое (точно в срок) шифрование для ведущих в отрасли DRM. 

Когда вы создаете учетную запись Служб мультимедиа, конечная точка потоковой передачи **по умолчанию** создается в остановленном состоянии. Вы не можете удалить конечную точку потоковой **передачи по умолчанию.** Дополнительные конечные точки потоковой передачи могут быть созданы в соответствии с учетной записью (см. [Квоты и ограничения).](limits-quotas-constraints.md)

> [!NOTE]
> Чтобы начать потоковую передачу видео, вам потребуется запустить **конечную точку потоковой передачи**, из которой предполагается транслировать видео.
>
> Выставляете счет только тогда, когда конечная точка потоковой передачи находится в запущенном состоянии.

Убедитесь в том, чтобы также рассмотреть тему [динамической упаковки.](dynamic-packaging-overview.md) 

## <a name="naming-convention"></a>Соглашение об именовании

Формат имени хоста потокового `{servicename}-{accountname}-{regionname}.streaming.media.azure.net`URL: `servicename` , где - имя конечной точки потоковой передачи или имя события в реальном времени.

При использовании точки потоковой передачи по умолчанию, `servicename` опущен так URL: `{accountname}-{regionname}.streaming.azure.net`.

### <a name="limitations"></a>Ограничения

* Имя конечной точки потоковой передачи имеет максимальное значение 24 символа.
* Имя должно следовать этому [шаблону regex:](https://docs.microsoft.com/dotnet/standard/base-types/regular-expression-language-quick-reference) `^[a-zA-Z0-9]+(-*[a-zA-Z0-9])*$`.

## <a name="types"></a>Типы

Существует два типа **конечных точек потоковой передачи:** **Стандартный** (предварительный просмотр) и **Премиум.** Тип определяется по количеству единиц масштабирования (`scaleUnits`), выделенных для конечной точки потоковой передачи.

В таблице ниже описаны типы.

|Тип|Единицы масштабирования|Описание|
|--------|--------|--------|  
|**Стандартный**|0|Конечная точка потоковой передачи по умолчанию является **стандартным** `scaleUnits`типом — она может быть изменена на тип Premium путем регулировки.|
|**Премиум**|> 0|**Премиум** Потоковые конечные точки подходят для продвинутых рабочих нагрузок и обеспечения выделенной и масштабируемой пропускной способности. Вы переходите в тип `scaleUnits` **Premium,** регулируя (потоковые единицы). `scaleUnits` предоставляют определенную выходную пропускную способность, которую можно приобрести с шагом приращения 200 Мбит/с. При использовании типа **Premium** каждая включенная единица обеспечивает дополнительную пропускную способность приложения. |

> [!NOTE]
> Для клиентов, желающих доставить контент для большой интернет-аудитории, мы рекомендуем включить CDN в конечную точку потоковой передачи.

Для получения информации о SLA [см.](https://azure.microsoft.com/pricing/details/media-services/)

## <a name="comparing-streaming-types"></a>Сравнение типов потоковой передачи

Компонент|Standard|Premium
---|---|---
Пропускная способность |До 600 Мбит/с и может обеспечить гораздо более высокую эффективную пропускную силу при использовании CDN.|200 Мбит/с на единицу потоковой передачи. Может обеспечить гораздо более высокую эффективную пропускную силу при использовании CDN.
CDN|Azure CDN, сторонний CDN или нет CDN.|Azure CDN, сторонний CDN или нет CDN.
Пропорциональное выставление счетов| Ежедневно|Ежедневно
Динамическое шифрование|Да|Да
Динамическая упаковка|Да|Да
Масштабирование|Автоматически масштабируется до целевой пропускной способности.|Дополнительные SUs
Фильтрация IP/G20/Custom host <sup>1</sup>|Да|Да
Прогрессивное скачивание|Да|Да
Рекомендуемый способ использования |Рекомендуется для большинства сценариев потоковой передачи.|Специализированное использование.

<sup>1</sup> используется непосредственно на конечной точке потоковой передачи, если CDN не включен в конечной точке.<br/>

## <a name="streaming-endpoint-properties"></a>Свойства конечных точек потоковой передачи

В этом разделе приводится подробная информация о некоторых свойствах конечной точки потоковой передачи. Примеры создания новой конечной точки потоковой передачи и описания всех свойств см. в [этой статье](https://docs.microsoft.com/rest/api/media/streamingendpoints/create).

- `accessControl`: Используется для настройки следующих параметров безопасности для этой потоковой точки: ключи аутентификации заголовков подписей Akamai и IP-адреса, которые могут быть подключены к этой конечной точке. Это свойство может `cdnEnabled` быть установлено только тогда, когда установлено на ложное.

- `cdnEnabled`: Указывается, включена ли интеграция Azure CDN для этой точки потоковой передачи (отключена по умолчанию). Если задать для `cdnEnabled` значение true, следующие конфигурации интеграции отключаются: `customHostNames` и `accessControl`.

    Не все центры обработки данных поддерживают интеграцию Azure CDN. Чтобы проверить, доступна ли в центре обработки данных интеграция Azure CDN, сделайте следующие действия:

  - Попробуйте задать для параметра `cdnEnabled` значение true.
  - Проверьте возвращенный `HTTP Error Code 412` результат на (PreconditionFailed) с сообщением "Streaming свойство Endpoint CdnEnabled не может быть установлен о правде, поскольку возможность CDN недоступна в текущем регионе".

    Если вы получаете эту ошибку, центр обработки данных не поддерживает ее. Попробуйте другой центр обработки данных.

- `cdnProfile`: `cdnEnabled` Когда установлен на истину, `cdnProfile` вы также можете передать значения. `cdnProfile` — имя профиля CDN, в котором будет создана конечная точка CDN. Вы можете предоставить имеющийся cdnProfile или создать его. Если значение равно NULL, а `cdnEnabled` — true, используется значение по умолчанию (AzureMediaStreamingPlatformCdnProfile). Если параметр `cdnProfile` уже предоставлен, с его использованием создается конечная точка. Если профиля не существует, автоматически создается новый профиль.
- `cdnProvider`: Когда CDN включен, вы `cdnProvider` также можете передать значения. `cdnProvider` определяет, какой поставщик будет использоваться. Сейчас поддерживаются три значения: StandardVerizon, PremiumVerizon и StandardAkamai. Если значение не `cdnEnabled` предусмотрено и верно, используется "StandardVerizon" (это значение по умолчанию).
- `crossSiteAccessPolicies`: Используется для указания политик доступа к сайтам для различных клиентов. Дополнительные сведения см. в статьях [Спецификация файла междоменной политики](https://www.adobe.com/devnet/articles/crossdomain_policy_file_spec.html) и [Настройка доступности службы на границах домена](https://msdn.microsoft.com/library/cc197955\(v=vs.95\).aspx). Настройки применяются только к плавной потоковой передаче.
- `customHostNames`: Используется для настройки точки потоковой передачи для приема трафика, направленного на пользовательское имя хоста. Это свойство действительно для стандартных и премиум `cdnEnabled`потоковых конечных точек и может быть установлено, когда: ложно.

    Право собственности на доменное имя должно быть подтверждено Службой сми. Службы мультимедиа проверяют право собственности на доменное имя, `CName` требуя, чтобы запись, содержащая идентификатор учетной записи Media Services, в качестве компонента, которая была добавлена в использоваваемый домен. Например, чтобы использовать sports.contoso.com в качестве пользовательского имени узла для конечной точки потоковой передачи, запись для `<accountId>.contoso.com` необходимо настроить для указания одного из имен узлов проверки Служб мультимедиа. Имя узла проверки состоит из verifydns.\<зона_DNS_Служб_мультимедиа>.

    Ниже приведены ожидаемые зоны DNS, которые будут использоваться в записи проверки для различных регионов Azure.
  
  - Северная Америка, Европа, Сингапур, Гонконг SAR, Япония:

    - `media.azure.net`
    - `verifydns.media.azure.net`

  - Китай:

    - `mediaservices.chinacloudapi.cn`
    - `verifydns.mediaservices.chinacloudapi.cn`

    Например, `CName` запись, которая карты "945a4c4e-28ea-45cd-8ccb-a519f6b700ad.contoso.com" на "verifydns.media.azure.net" доказывает, что Media Services ID 945a4c4e-28ea-45cd-8ccb-a519f6b700ad имеет право собственности на contoso.com домена, что позволяет любое имя под contoso.com, которые будут использоваться в качестве пользовательского хоста для потоковой конечной точки в соответствии с этим счетом. Чтобы найти значение идентификатора службы мультимедиа, перейдите на [портал Azure](https://portal.azure.com/) и выберите свою учетную запись службы мультимедиа. **Идентификатор учетной записи** отображается в правом верхнем правом виде страницы.

    Если есть попытка установить пользовательское имя хоста без `CName` надлежащей проверки записи, ответ DNS не удастся, а затем будет кэшировать в течение некоторого времени. После получения соответствующей записи повторная проверка кэшированного ответа может занять некоторое время. В зависимости от поставщика DNS для пользовательского домена, это занимает от нескольких минут до часа, чтобы пересмотреть запись.

    В дополнение `CName` к `<accountId>.<parent domain>` картам, которые `verifydns.<mediaservices-dns-zone>` `CName` карты, вы должны создать еще `sports.contoso.com`один, который карты пользовательских имя хоста `amstest-usea.streaming.media.azure.net`(например, ) на медиа-услуг потокового конечных точек имя (например, ).

    > [!NOTE]
    > Потоковые конечные точки, расположенные в одном центре обработки данных, не могут быть одинаковыми именами хоста.

    Сейчас службы мультимедиа не поддерживают SSL для личных доменов.

- `maxCacheAge`- Переопределения заголовка управления кэшем MAX-age по умолчанию, установленного конечная точка потоковой передачи на фрагментах мультимедиа и манифестах по требованию. Это значение задается в секундах.
- `resourceState` -

    - Остановлено: начальное состояние конечной точки потоковой передачи после создания
    - Запуск: переход в запущенное состояние
    - Запуск: способен передавать контент клиентам
    - Масштабирование: единицы масштаба увеличиваются или уменьшаются
    - Остановка: переход в остановленное состояние
    - Удаление: удаляется

- `scaleUnits`: Предоставьте вам специальную емкость, которую можно приобрести с шагом в 200 Мбит/с. Если вам нужно выполнить переход к типу **Премиум**, настройте параметр `scaleUnits`.

## <a name="why-use-multiple-streaming-endpoints"></a>Зачем использовать несколько конечных точек потоковой передачи?

Единая конечная точка потоковой передачи может передавать как видео в прямом эфире, так и по требованию, и большинство клиентов используют только одну конечную точку потоковой передачи. В этом разделе приведены некоторые примеры того, почему может потребоваться использование нескольких конечных точек потоковой передачи.

* Каждый зарезервированный блок позволяет на 200 Мбит/с пропускной способности. Если вам нужно более 2000 Мбит/с (2 Гбит/с) пропускной способности, вы можете использовать вторую конечную точку потоковой передачи и баланс нагрузки, чтобы дать вам дополнительную пропускную способность.

    Тем не менее, CDN является лучшим способом для достижения масштабирования для потокового контента, но если вы доставляете столько контента, что CDN тянет более 2 Гбит/с, то вы можете добавить дополнительные потоковые конечные точки (истоки). В этом случае вам нужно будет раздавать URL-адреса содержимого, которые сбалансированы между двумя конечными точками потоковой передачи. Этот подход дает лучшее кэширование, чем попытка отправки запросов каждому происхождению случайным образом (например, через менеджера трафика). 
    
    > [!TIP]
    > Обычно, если CDN тянет более 2 Гбит/с, то что-то может быть неправильно настроено (например, нет происхождения экранирования).
    
* Загрузка балансировки различных поставщиков CDN. Например, можно настроить конечную точку потоковой передачи по умолчанию для использования Verizon CDN и создать вторую для использования Akamai. Затем добавьте баланс нагрузки между ними для достижения баланса между multi-CDN. 

    Тем не менее, клиент часто балансирует нагрузку между несколькими поставщиками CDN, используя одно происхождение.
* Потоковое смешанное содержание: Live и видео по требованию. 

    Шаблоны доступа к контенту в реальном времени и по требованию очень разные. Содержание в реальном маштабе времени клонит получить много требование для такого же содержания все сразу. Содержимое видео по требованию (например, содержимое архива длинного хвоста) имеет низкое использование одного и того же контента. Таким образом кэширование работает очень наилучшим образом на содержании в реальном маштабе времени но не также на длинном содержании кабеля.

    Рассмотрим сценарий, в котором ваши клиенты в основном смотрят живой контент, но лишь изредка смотрят контент по требованию, и он подается из той же точки потоковой передачи. Низкое использование содержимого по требованию будет занимать пространство кэша, которое было бы лучше сохранено для живого контента. В этом сценарии мы рекомендуем обслуживать живой контент из одной точки потоковой передачи и содержимое длинного хвоста из другой точки потоковой передачи. Это повысит производительность живого содержимого события.
    
## <a name="scaling-streaming-with-cdn"></a>Масштабирование потоковой передачи с помощью CDN

См. следующие статьи:

- [Обзор CDN](../../cdn/cdn-overview.md)
- [Масштабирование потоковой передачи с помощью CDN](scale-streaming-cdn.md)

## <a name="ask-questions-and--get-updates"></a>Задавайте вопросы и получайте обновления

Прочитайте статью [сообщества Служб мультимедиа Azure](media-services-community.md), чтобы узнать, как задавать вопросы, оставлять отзывы и получать новости о Службах мультимедиа.

## <a name="see-also"></a>См. также

[Динамическая упаковка](dynamic-packaging-overview.md)

## <a name="next-steps"></a>Дальнейшие действия

[Управление конечными точками потоковой передачи](manage-streaming-endpoints-howto.md)
