---
title: Активы
titleSuffix: Azure Media Services
description: Сведения о том, какие ресурсы и как они используются службами мультимедиа Azure.
services: media-services
documentationcenter: ''
author: Juliako
manager: femila
editor: ''
ms.service: media-services
ms.workload: ''
ms.topic: article
ms.date: 08/29/2019
ms.author: juliako
ms.custom: seodec18
ms.openlocfilehash: 3860823787b860f2504d6fb13b9479d1feec9d28
ms.sourcegitcommit: 934776a860e4944f1a0e5e24763bfe3855bc6b60
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/20/2020
ms.locfileid: "77505812"
---
# <a name="assets-in-azure-media-services"></a>Ресурсы в службах мультимедиа Azure

В службах мультимедиа Azure [ресурс-контейнер](https://docs.microsoft.com/rest/api/media/assets) содержит сведения о цифровых файлах, хранящихся в службе хранилища Azure (включая видео, аудио, изображения, коллекции эскизов, текстовые дорожки и файлы скрытых субтитров).

Ресурс сопоставляется с контейнером больших двоичных объектов в [учетной записи хранения Azure](storage-account-concept.md). Файлы ресурса хранятся в этом контейнере как блочные BLOB-объекты. Если в учетной записи используется хранилище общего назначения версии 2 (GPv2), Службы мультимедиа поддерживают уровни больших двоичных объектов. Это хранилище позволяет перемещать файлы в [холодный или архивный уровень хранилища](https://docs.microsoft.com/azure/storage/blobs/storage-blob-storage-tiers). **Архивное** хранилище подходит для архивирования исходных файлов, если они больше не нужны (например, после кодирования).

**Архивный уровень хранилища** рекомендуется только для очень больших исходных файлов, которые уже были закодированы, а выходные данные задания кодирования были помещены в выходной контейнер больших двоичных объектов. Большие двоичные объекты в контейнере вывода, которые необходимо связать с ресурсом и использовать для потоковой передачи или анализа содержимого, должны существовать на **активном** или **холодном** уровне хранилища.

### <a name="naming"></a>Именование 

#### <a name="assets"></a>Активы

Имена ресурсов должны быть уникальными. Имена ресурсов служб мультимедиа v3 (например, ресурсы, задания, преобразования) подчиняются Azure Resource Manager ограничениям именования. Дополнительные сведения см. в разделе [соглашения об именовании](media-services-apis-overview.md#naming-conventions).

#### <a name="blobs"></a>BLOB-объекты

Имена файлов и больших двоичных объектов в ресурсе должны соответствовать требованиям к [имени большого двоичного объекта](https://docs.microsoft.com/rest/api/storageservices/Naming-and-Referencing-Containers--Blobs--and-Metadata) и [требованиям к имени NTFS](https://docs.microsoft.com/windows/win32/fileio/naming-a-file). Причина этих требований заключается в том, что файлы могут быть скопированы из хранилища BLOB-объектов на локальный диск NTFS для обработки.

## <a name="upload-digital-files-into-assets"></a>Отправка цифровых файлов в ресурсы

После передачи цифровых файлов в хранилище и их связывания с ресурсом их можно использовать в рабочих процессах кодирования, потоковой передачи и анализа содержимого служб мультимедиа. Один из стандартных рабочих процессов Служб мультимедиа — отправка, кодирование и потоковая передача файла. В этом разделе описываются общие инструкции.

> [!TIP]
> Перед началом разработки изучите [разработку с помощью API-интерфейсов служб мультимедиа v3](media-services-apis-overview.md) (содержит сведения о доступе к API, соглашения об именовании и т. д.).

1. Используйте API Служб мультимедиа версии 3, чтобы создать новый входной ресурс. Эта операция создает контейнер в учетной записи хранения, связанной с вашей учетной записью Служб мультимедиа. API возвращает имя контейнера (например, `"container": "asset-b8d8b68a-2d7f-4d8c-81bb-8c7bbbe67ee4"`).

    Если у вас уже есть контейнер больших двоичных объектов, который необходимо связать с ресурсом, можно указать имя контейнера при создании ресурса. Службы мультимедиа в настоящее время поддерживают только большие двоичные объекты в корневом контейнере, а не с путями в имени файла. Таким образом, контейнер с именем файла input.mp4 подойдет. Однако контейнер с именем файла "videos/Inputs/input. MP4" не будет работать.

    Azure CLI можно использовать для передачи непосредственно в любую учетную запись хранения и контейнер, на которые у вас есть права в вашей подписке.

    Имя контейнера должно быть уникальным и соответствовать правилам именования хранилища. Имя не обязательно должно соответствовать формату имени контейнера ресурса Служб мультимедиа (Asset-GUID).

    ```azurecli
    az storage blob upload -f /path/to/file -c MyContainer -n MyBlob
    ```
2. Получите URL-адрес SAS с разрешениями на чтение и запись, которые будут использоваться для передачи цифровых файлов в контейнер ресурса. Можно использовать API Служб мультимедиа для вывода [списка URL-адресов контейнеров ресурса](https://docs.microsoft.com/rest/api/media/assets/listcontainersas).
3. Используйте API-интерфейсы или пакеты SDK службы хранилища Azure (например, [REST API](../../storage/common/storage-rest-api-auth.md) или [пакет SDK для .NET](../../storage/blobs/storage-quickstart-blobs-dotnet.md)) для отправки файлов в контейнер ресурсов.
4. Используйте API Служб мультимедиа версии 3, чтобы создать преобразование и задание для обработки входного ресурса. Дополнительные сведения см. в статье [Преобразования и задания](transform-concept.md).
5. Потоковая передача содержимого из выходного ресурса.

Полный пример .NET, демонстрирующий создание ресурса, получение URL-адреса SAS для записи в контейнер ресурса в хранилище, а также передача файла в контейнер в хранилище с помощью URL-адреса SAS см. в разделе [Создание входных данных задания из локального файла](job-input-from-local-file-how-to.md).

### <a name="create-a-new-asset"></a>Создание ресурса

> [!NOTE]
> Свойства ресурса типа DateTime всегда имеют формат UTC.

#### <a name="rest"></a>REST

```
PUT https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Media/mediaServices/{amsAccountName}/assets/{assetName}?api-version=2018-07-01
```

Пример REST см. в разделе [Создание ресурса с помощью REST](https://docs.microsoft.com/rest/api/media/assets/createorupdate#examples).

В примере показано, как создать **текст запроса** , в котором можно указать описание, имя контейнера, учетную запись хранения и другие полезные сведения.

#### <a name="curl"></a>cURL

```cURL
curl -X PUT \
  'https://management.azure.com/subscriptions/00000000-0000-0000-000000000000/resourceGroups/resourceGroupName/providers/Microsoft.Media/mediaServices/amsAccountName/assets/myOutputAsset?api-version=2018-07-01' \
  -H 'Accept: application/json' \
  -H 'Content-Type: application/json' \
  -d '{
  "properties": {
    "description": "",
  }
}'
```

#### <a name="net"></a>.NET

```csharp
 Asset asset = await client.Assets.CreateOrUpdateAsync(resourceGroupName, accountName, assetName, new Asset());
```

Полный пример см. в разделе [Создание входных данных задания из локального файла](job-input-from-local-file-how-to.md). В Службах мультимедиа версии 3 входные данные задания также могут создаваться из URL-адреса HTTPS (см. раздел [Создание входных данных задания из URL-адреса HTTPS](job-input-from-http-how-to.md)).

## <a name="map-v3-asset-properties-to-v2"></a>Свойства ресурса V3 на карте версии 2

В следующей таблице показано, как свойства [ресурса](https://docs.microsoft.com/rest/api/media/assets/createorupdate#asset)в v3 сопоставляются со свойствами ресурса в версии 2.

|v3, свойства|свойства v2|
|---|---|
|`id`-(Unique) полный путь Azure Resource Manager см. в разделе примеры в [активе](https://docs.microsoft.com/rest/api/media/assets/createorupdate) .||
|`name`-(Unique) см. [соглашения об именовании](media-services-apis-overview.md#naming-conventions) ||
|`alternateId`|`AlternateId`|
|`assetId`|`Id`-(уникальное) значение начинается с префикса `nb:cid:UUID:`.|
|`created`|`Created`|
|`description`|`Name`|
|`lastModified`|`LastModified`|
|`storageAccountName`|`StorageAccountName`|
|`storageEncryptionFormat`| `Options` (параметры создания)|
|`type`||

## <a name="storage-side-encryption"></a>Шифрование на стороне хранилища

Чтобы защитить неактивные ресурсы, их нужно зашифровать на стороне хранилища. В следующей таблице показано, как происходит шифрование на стороне хранилища в Службах мультимедиа.

|Вариант шифрования|Description|Службы мультимедиа версии 2|Службы мультимедиа версии 3|
|---|---|---|---|
|Шифрование хранилища Служб мультимедиа|Шифрование AES-256, ключ, управляемый службами мультимедиа.|Поддерживается<sup>(1)</sup>|Не поддерживается<sup>(2)</sup>|
|[Шифрование службы хранилища для неактивных данных](https://docs.microsoft.com/azure/storage/common/storage-service-encryption)|Шифрование на стороне сервера, предоставляемое службой хранилища Azure, ключом, управляемым Azure или клиентом.|Поддерживается|Поддерживается|
|[Шифрование хранилища на стороне клиента](https://docs.microsoft.com/azure/storage/common/storage-client-side-encryption)|Шифрование на стороне клиента, предлагаемое службой хранилища Azure, ключ, управляемый клиентом, в Key Vault.|Не поддерживается|Не поддерживается|

<sup>1</sup> хотя службы мультимедиа поддерживают обработку содержимого в Clear/без какой-либо формы шифрования, делать это не рекомендуется.

<sup>2</sup>В Службах мультимедиа версии 3 для обратной совместимости поддерживается шифрование хранилища (шифрование AES-256), только если ресурсы созданы с помощью Служб мультимедиа версии 2. Это означает, что v3 работает с существующими зашифрованными ресурсами хранилища, но не позволяет создавать новые.

## <a name="filtering-ordering-paging"></a>Фильтрации, упорядочивание, разбиение по страницам

Ознакомьтесь с разделом [Фильтрация, упорядочивание и разбиение по страницам сущностей Служб мультимедиа](entities-overview.md).

## <a name="next-steps"></a>Дальнейшие действия

* [Краткое руководство по потоковой передаче видеофайлов — .NET](stream-files-dotnet-quickstart.md)
* [Использование средства цифровой видеозаписи в облаке](live-event-cloud-dvr.md)
* [Различия между Службами мультимедиа версий 2 и 3](migrate-from-v2-to-v3.md)
