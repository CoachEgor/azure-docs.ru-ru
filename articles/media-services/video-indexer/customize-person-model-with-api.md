---
title: Настройка модели пользователя с помощью API Индексатора видео в Azure
titlesuffix: Azure Media Services
description: В этой статье описана настройка модели пользователя с помощью API Индексатора видео.
services: media-services
author: anikaz
manager: johndeu
ms.service: media-services
ms.subservice: video-indexer
ms.topic: article
ms.date: 05/15/2019
ms.author: anzaman
ms.openlocfilehash: 6c4980536eddd0226fac422ae17ddb717e34630d
ms.sourcegitcommit: d4dfbc34a1f03488e1b7bc5e711a11b72c717ada
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/13/2019
ms.locfileid: "65799466"
---
# <a name="customize-a-person-model-with-the-video-indexer-api"></a>Настройка модели пользователя с помощью API Индексатора видео

Индексатор видео поддерживает функцию определения лиц и распознавания знаменитостей для видеосодержимого. Функция распознавания знаменитостей охватывает около миллиона лиц на основе часто запрашиваемых источников данных, таких как IMDB, Википедия и влиятельные лица LinkedIn. Лица, которые не распознаются с помощью функции распознавания знаменитостей, также определяются, но их имя не указывается. После передачи видео в Индексатор видео и получения результатов вы можете вернуться и ввести имена для лиц, которые не удалось распознать. После того как вы введете имя для определенного лица, это лицо и назначенное имя будут добавлены в модель пользователя вашей учетной записи. Индексатор видео затем сможет распознать это лицо в будущих и предыдущих видео.

Вы можете использовать API Индексатора видео для изменения обнаруженных в видео лиц, как описано в этом разделе. Вы также можете использовать API, как описано в статье [Customize Person model using the Video Indexer website](customize-person-model-with-api.md) (Настройка модели пользователя с помощью API Индексатора видео).

## <a name="managing-multiple-person-models"></a>Управление несколькими моделями пользователя 

Индексатор видео поддерживает использование нескольких моделей пользователя на одну учетную запись. Эта функция сейчас доступна только с помощью API Индексатора видео.

Если ваша учетная запись поддерживает разные сценарии ввода-вывода, вам может потребоваться создать несколько моделей пользователя на одну учетную запись. Например, если ваше содержимое связано со спортом, вы можете создать отдельную модель пользователя для каждого вида спорта (американского футбола, баскетбола, футбола и т. д.). 

После создания модели вы можете использовать ее указав идентификатор конкретной модели пользователя при отправке, индексации или переиндексации видео. Обучение нового лица для видео обновляет определенную настраиваемую модель, с которой это видео было связано.

Для каждой учетной записи стоит ограничение в 50 моделей пользователя. Если вам не требуется поддержка нескольких моделей пользователя, не присваивайте вашему видео идентификатор модели пользователя во время отправки, индексации или переиндексации. В этом случае Индексатор видео использует пользовательскую модель пользователя по умолчанию с вашей учетной записи.

## <a name="create-a-new-person-model"></a>Создание новой модели пользователя

Создайте новую модель пользователя в указанной учетной записи. 

### <a name="request-url"></a>Request URL (URL-адрес запроса)

Это запрос POST.

```
https://api.videoindexer.ai/{location}/Accounts/{accountId}/Customization/PersonModels?name={name}&accessToken={accessToken}
```

Ниже приведен запрос в Curl.

```curl
curl -v -X POST "https://api.videoindexer.ai/{location}/Accounts/{accountId}/Customization/PersonModels?name={name}&accessToken={accessToken}"
```

[Просмотрите необходимые параметры и выполните тестирование с помощью портала разработчика Индексатора видео](https://api-portal.videoindexer.ai/docs/services/operations/operations/Create-Person-Model?).

### <a name="request-parameters"></a>Параметры запроса 

|**Имя**|**Тип**|**Обязательный**|**Описание**|
|---|---|---|---|
|location|string|Да|Регион Azure, в который должен быть направлен вызов. Дополнительные сведения см. в статье [Azure regions in which Video Indexer exists](regions.md) (Регионы Azure, в которых существует Индексатор видео).|
|accountId|string|Да|Глобальный уникальный идентификатор для учетной записи|
|name|string|Да|Имя для модели пользователя|
|accessToken|string|Да|Маркер доступа (должен быть в области [маркера доступа к учетной записи](https://api-portal.videoindexer.ai/docs/services/authorization/operations/Get-Account-Access-Token?)) для проверки подлинности вызова. Срок действия маркеров доступа истекает в течение 1 часа.|

### <a name="request-body"></a>Текст запроса

Для этого вызова больше не требуется текст запроса.

### <a name="response"></a>Ответ

Ответ предоставляет имя и идентификатор модели пользователя, которую вы создали используя формат из примера приведенного ниже.

```json
{
    "id": "227654b4-912c-4b92-ba4f-641d488e3720",
    "name": "Example Person Model"
}
```

Затем вы должны использовать значение **id** для параметра **personModelId** во время [отправки видео в индекс](https://api-portal.videoindexer.ai/docs/services/operations/operations/Upload-video?) или [переиндексации видео](https://api-portal.videoindexer.ai/docs/services/operations/operations/Re-index-video?).

## <a name="delete-a-person-model"></a>Удаление модели пользователя

Удалите настраиваемую модель пользователя с указанной учетной записи. 

После успешного удаления модели пользователя, индекс ваших видео, который использовал удаленную модель, измениться только после переиндексации. После переиндексации лица, имена которых находились в удаленной модели, не будут распознаваться Индексатором видео в ваших видео индексированных с помощью этой модели. Тем не менее эти лица все же будут обнаруживаться. Ваши видео, индексирование с помощью удаленной модели, будут использовать модель пользователя вашей учетной записи по умолчанию. Если имена лиц с удаленной модели также подсоединены к вашей модели учетной записи по умолчанию, то они все же будут распознаваться в видео.

### <a name="request-url"></a>Request URL (URL-адрес запроса)

```
https://api.videoindexer.ai/{location}/Accounts/{accountId}/Customization/PersonModels/{id}?accessToken={accessToken}
```

Ниже приведен запрос в Curl.
```curl
curl -v -X DELETE "https://api.videoindexer.ai/{location}/Accounts/{accountId}/Customization/PersonModels/{id}?accessToken={accessToken}"
```

[Просмотрите необходимые параметры и выполните тестирование с помощью портала разработчика Индексатора видео](https://api-portal.videoindexer.ai/docs/services/operations/operations/Delete-Person-Model?).

### <a name="request-parameters"></a>Параметры запроса

|**Имя**|**Тип**|**Обязательный**|**Описание**|
|---|---|---|---|
|location|string|Да|Регион Azure, в который должен быть направлен вызов. Дополнительные сведения см. в статье [Azure regions in which Video Indexer exists](regions.md) (Регионы Azure, в которых существует Индексатор видео).|
|accountId|string|Да|Глобальный уникальный идентификатор для учетной записи|
|id|string|Да|Идентификатор модели пользователя (создан вместе с моделью пользователя)|
|accessToken|string|Да|Маркер доступа (должен быть в области [маркера доступа к учетной записи](https://api-portal.videoindexer.ai/docs/services/authorization/operations/Get-Account-Access-Token?)) для проверки подлинности вызова. Срок действия маркеров доступа истекает в течение 1 часа.|

### <a name="request-body"></a>Текст запроса

Для этого вызова больше не требуется текст запроса.

### <a name="response"></a>Ответ

При успешном удалении языковой модели содержимое не возвращается.

## <a name="get-all-person-models"></a>Получение всех моделей пользователя

Получите все модели пользователя в указанной учетной записи. 

### <a name="request-call"></a>Вызов запроса

Это запрос GET.

```
https://api.videoindexer.ai/{location}/Accounts/{accountId}/Customization/PersonModels?accessToken={accessToken}
```

Ниже приведен запрос в Curl.

```curl
curl -v -X GET "https://api.videoindexer.ai/{location}/Accounts/{accountId}/Customization/PersonModels?accessToken={accessToken}"
```

[Просмотрите необходимые параметры и выполните тестирование с помощью портала разработчика Индексатора видео](https://api-portal.videoindexer.ai/docs/services/operations/operations/Get-Person-Models?).

### <a name="request-parameters"></a>Параметры запроса

|**Имя**|**Тип**|**Обязательный**|**Описание**|
|---|---|---|---|
|location|string|Да|Регион Azure, в который должен быть направлен вызов. Дополнительные сведения см. в статье [Azure regions in which Video Indexer exists](regions.md) (Регионы Azure, в которых существует Индексатор видео).|
|accountId|string|Да|Глобальный уникальный идентификатор для учетной записи|
|accessToken|string|Да|Маркер доступа (должен быть в области [маркера доступа к учетной записи](https://api-portal.videoindexer.ai/docs/services/authorization/operations/Get-Account-Access-Token?)) для проверки подлинности вызова. Срок действия маркеров доступа истекает в течение 1 часа.|

### <a name="request-body"></a>Текст запроса

Для этого вызова больше не требуется текст запроса.

### <a name="response"></a>Ответ

В ответе содержится список всех моделей пользователя в вашей учетной записи (включая модель пользователя по умолчанию в указанной учетной записи), а также их имена и идентификаторы используя формат из примера приведенного ниже.

```json
[
    {
        "id": "59f9c326-b141-4515-abe7-7d822518571f",
        "name": "Default"
    }, 
    {
        "id": "9ef2632d-310a-4510-92e1-cc70ae0230d4",
        "name": "Test"
    }
]
```

Вы можете выбрать, которую модель вы желаете использовать для видео, с помощью значения **id** модели пользователя для параметра **personModelId** во время [отправки видео в индекс](https://api-portal.videoindexer.ai/docs/services/operations/operations/Upload-video?) или [переиндексации видео](https://api-portal.videoindexer.ai/docs/services/operations/operations/Re-index-video?).

## <a name="update-a-face"></a>Обновление информации о лицах

Эта команда позволяет обновлять информацию о лицах в вашем видео добавлением имени с помощью идентификатора видео и идентификатора лица. Это затем обновляет модель пользователя с которой было связано видео при отправке, индексации или переиндексации. Если не было указано модель пользователя, тогда обновляется модель учетной записи по умолчанию. 

Затем она распознает случаи появления этого лица в других ваших видео, которые используют ту же модель пользователя. Распознавание лиц в других имеющихся видео может занять некоторое время, так как этот процесс представляет собой пакетную обработку.

Вы можете присвоить лицу, которое Индексатор видео распознал как знаменитость, новое имя. Новое имя, которое вы присвоите, будет иметь приоритет над именами, встроенными в функцию распознавания знаменитостей.

### <a name="request-call"></a>Вызов запроса

Это запрос POST.

```
https://api.videoindexer.ai/{location}/Accounts/{accountId}/Videos/{videoId}/Index/Faces/{faceId}?accessToken={accessToken}&newName={newName}
```

Ниже приведен запрос в Curl.

```curl
curl -v -X PUT "https://api.videoindexer.ai/{location}/Accounts/{accountId}/Videos/{videoId}/Index/Faces/{faceId}?accessToken={accessToken}&newName={newName}"
```

[Просмотрите необходимые параметры и выполните тестирование с помощью портала разработчика Индексатора видео](https://api-portal.videoindexer.ai/docs/services/operations/operations/Update-Video-Face?).

### <a name="request-parameters"></a>Параметры запроса

|**Имя**|**Тип**|**Обязательный**|**Описание**|
|---|---|---|---|
|location|string|Да|Регион Azure, в который должен быть направлен вызов. Дополнительные сведения см. в статье [Azure regions in which Video Indexer exists](regions.md) (Регионы Azure, в которых существует Индексатор видео).|
|accountId|string|Да|Глобальный уникальный идентификатор для учетной записи|
|videoId|string|Да|Идентификатор для видео, в которых присутствует лицо, информацию о котором вы желаете обновить. Оно создается во время отправки и индексации.|
|faceId|целое число|Да|Идентификатор для лица, информацию о котором вы будете обновлять. Вы можете получить faceId в индексе видео|
|accessToken|string|Да|Маркер доступа (должен быть в области [маркера доступа к учетной записи](https://api-portal.videoindexer.ai/docs/services/authorization/operations/Get-Account-Access-Token?)) для проверки подлинности вызова. Срок действия маркеров доступа истекает в течение 1 часа.|
|name|string|Да|Новое имя обновляемого лица.|

Имена являются уникальными в моделях Person, поэтому если вы присваиваете одно **имя** двум разным лицам, Индексатор видео распознает эти лица как лица одного человека и объединит их при повторной индексации видео. 

### <a name="request-body"></a>Текст запроса

Для этого вызова больше не требуется текст запроса.

### <a name="response"></a>Ответ

При успешном обновлении языковой модели содержимое не возвращается.

## <a name="next-steps"></a>Дальнейшие действия

[Customize Person model using the Video Indexer website](customize-person-model-with-website.md) (Настройка модели пользователя с помощью веб-сайта Индексатора видео)
