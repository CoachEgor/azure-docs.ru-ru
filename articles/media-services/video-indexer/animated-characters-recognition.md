---
title: Распознавание анимированных символов с помощью индексатора видео
titleSuffix: Azure Media Services
description: В этом разделе показано, как использовать распознавание анимированных символов с помощью индексатора видео.
services: media-services
author: Juliako
manager: femila
ms.service: media-services
ms.subservice: video-indexer
ms.topic: article
ms.date: 11/19/2019
ms.author: juliako
ms.openlocfilehash: af608dcfbb5d98cf3116de4e14dc12bf6facb97b
ms.sourcegitcommit: 849bb1729b89d075eed579aa36395bf4d29f3bd9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2020
ms.locfileid: "76989915"
---
# <a name="animated-character-detection-preview"></a>Обнаружение анимированных символов (Предварительная версия)

Индексатор видео служб мультимедиа Azure поддерживает обнаружение, группирование и распознавание символов в анимированном содержимом с помощью интеграции с [Cognitive Services пользовательской концепцией](https://azure.microsoft.com/services/cognitive-services/custom-vision-service/). Эта функция доступна как на портале, так и через API.

После отправки анимированного видео с определенной моделью анимации индексатор видео извлекает ключевые кадры, обнаруживает анимированные символы в этих кадрах, группирует схожий символ и выбирает лучший пример. Затем он отправляет сгруппированные символы в Пользовательское визуальное распознавание, определяющие символы на основе моделей, на которых она была обучена. 

Прежде чем начать обучение модели, символы будут обнаружены намелессли. При добавлении имен и обучении модели индексатор видео будет распознавать символы и наименовать их соответствующим образом.

## <a name="flow-diagram"></a>Схема процесса

На следующей схеме показан поток процесса обнаружения анимированных символов.

![Схема процесса](./media/animated-characters-recognition/flow.png)

## <a name="accounts"></a>Учетные записи

В зависимости от типа учетной записи индексатора видео доступны различные наборы функций. Сведения о том, как подключить учетную запись к Azure, см. в статье [Создание учетной записи индексатора видео, подключенной к Azure](connect-to-azure.md).

* Пробная учетная запись: индексатор видео использует учетную запись внутренней Пользовательское визуальное распознавание для создания модели и ее подключения к учетной записи индексатора видео. 
* Платная учетная запись. Вы подключаете учетную запись Пользовательское визуальное распознавание к учетной записи индексатора видео (если у вас ее еще нет, сначала необходимо создать учетную запись).

### <a name="trial-vs-paid"></a>Сравнение пробных версий и платных

|Функциональность|Пробная версия|Платно|
|---|---|---|
|Учетная запись Пользовательское визуальное распознавание|Управляется в фоновом режиме с помощью индексатора видео. |Ваша учетная запись Пользовательское визуальное распознавание подключена к индексатору видео.|
|Число моделей анимации|Один|До 100 моделей на учетную запись (ограничение Пользовательское визуальное распознавание).|
|Обучение модели|Индексатор видео обучает модели на наличие новых символов дополнительные примеры существующих символов.|Владелец учетной записи обучает модель, когда они готовы к внесению изменений.|
|Дополнительные параметры в Пользовательское визуальное распознавание|Нет доступа к Пользовательское визуальное распознавание порталу.|Вы можете вручную настроить модели на портале Пользовательское визуальное распознавание.|

## <a name="use-the-animated-character-detection-with-portal"></a>Использование распознавания анимированных символов с помощью портала 

В этом разделе описаны действия, которые необходимо предпринять, чтобы начать использовать модель обнаружения анимированных символов. 

Поскольку в пробных учетных записях Управление интеграцией Пользовательское визуальное распознавание осуществляется с помощью индексатора видео, можно приступить к созданию и использованию модели анимированных символов и пропустить следующий раздел ("подключение учетной записи Пользовательское визуальное распознавание").

### <a name="connect-your-custom-vision-account-paid-accounts-only"></a>Подключение учетной записи Пользовательское визуальное распознавание (только платные учетные записи)

Если вы владеете платной учетной записью индексатора видео, сначала необходимо подключить учетную запись Пользовательское визуальное распознавание. Если у вас еще нет учетной записи Пользовательское визуальное распознавание, создайте ее. Дополнительные сведения см. в разделе [пользовательское визуальное распознавание](../../cognitive-services/custom-vision-service/home.md).

> [!NOTE]
> Обе учетные записи должны находиться в одном регионе. Интеграция с Пользовательское визуальное распознавание в настоящее время не поддерживается в японском регионе.

#### <a name="connect-a-custom-vision-account-with-api"></a>Подключение учетной записи Пользовательское визуальное распознавание с помощью API 

Выполните следующие действия, чтобы подключить учетную запись Пользовательское визуальное распознавание к индексатору видео или изменить учетную запись Пользовательское визуальное распознавание, которая в настоящее время подключена к индексатору видео:

1. Перейдите по [www.customvision.AI](https://www.customvision.ai) и войдите в систему.
1. Скопируйте следующие ключи: 

    * Ключ обучения (для учебного ресурса)
    * Ключ прогнозирования (для ресурса прогноза)
    * Конечная точка 
    * Идентификатор ресурса прогноза
    
    > [!NOTE]
    > Чтобы предоставить все ключи, необходимо иметь два отдельных ресурса в Пользовательское визуальное распознавание, один для обучения и один для прогнозирования.
1. Перейдите к [индексатору видео](https://vi.microsoft.com/)и войдите в него.
1. Щелкните вопросительный знак в правом верхнем углу страницы и выберите **Справочник по API**.
1. Убедитесь, что вы подписаны на службу управления API, щелкнув вкладку **продукты** . Если у вас есть подключенный API, можно перейти к следующему шагу, в противном случае — Subscribe. 
1. На портале разработчика щелкните **полный справочник по API** и перейдите к **операциям**.  
1. Выберите **подключить пользовательское визуальное распознавание учетную запись (Предварительная версия)** и нажмите кнопку **попробовать**.
1. Заполните обязательные поля, а также маркер доступа и нажмите кнопку **Отправить**. 

    Дополнительные сведения о том, как получить маркер доступа к индексатору видео, см. на [портале разработчика](https://api-portal.videoindexer.ai/docs/services/operations/operations/Get-Account-Access-Token?)и в [соответствующей документации](video-indexer-use-apis.md#obtain-access-token-using-the-authorization-api).  
1. Когда вызов вернет 200 OK, ваша учетная запись будет подключена.
1. Чтобы проверить подключение, перейдите на портал " [индексатор видео](https://vi.microsoft.com/)"):
1. Нажмите кнопку **Настройка модели содержимого** в правом верхнем углу.
1. Перейдите на вкладку **анимированные символы** .
1. Когда вы наберете "Управление моделями" в Пользовательское визуальное распознавание "* *", вы перейдете на только что подключенную учетную запись Пользовательское визуальное распознавание.

> [!NOTE]
> В настоящее время поддерживаются только модели, созданные с помощью индексатора видео. Модели, созданные с помощью Пользовательское визуальное распознавание, будут недоступны. Кроме того, рекомендуется изменять модели, созданные с помощью индексатора видео, только с помощью платформы индексатора видео, так как изменения, внесенные с помощью Пользовательское визуальное распознавание, могут привести к непредвиденным результатам.

### <a name="create-an-animated-characters-model"></a>Создание модели анимированных символов

1. Откройте веб-сайт [Индексатора видео](https://vi.microsoft.com/) и выполните вход.
1. Нажмите кнопку Настройка модели содержимого в правом верхнем углу страницы.

    ![Настройка модели содержимого](./media/animated-characters-recognition/content-model-customization.png)
1. Перейдите на вкладку " **анимированные символы** " в разделе "Настройка модели".
1. Щелкните **Добавить модель**.
1. Назовите модель и нажмите клавишу ВВОД, чтобы сохранить имя.

> [!NOTE]
> Рекомендуется иметь одну пользовательскую модель представления для каждого анимированного ряда. 

### <a name="index-a-video-with-an-animated-model"></a>Индексирование видео с помощью анимированной модели

1. Нажмите кнопку **Отправить** в верхнем меню.
1. Выберите видео для отправки (из файла или с помощью URL-адреса).
1. Щелкните **Дополнительные параметры**.
1. В разделе **люди/анимированные символы** выберите **модели анимации**.
1. Если у вас одна модель, она будет выбрана автоматически, и при наличии нескольких моделей можно выбрать в раскрывающемся меню один из них.
1. Щелкните Отправить.
1. После индексирования видео обнаруженные символы отображаются в разделе " **анимированные символы** " в области " **аналитика** ".

> [!NOTE] 
> Перед созданием тегов и обучении модели все анимированные символы будут называться "Unknown #X". После обучения модели они также будут распознаны.

### <a name="customize-the-animated-characters-models"></a>Настройка моделей с анимированными символами

1. Пометьте и обучить модель.

    1. Пометка обнаруженного символа путем изменения его имени. После того как символ будет обучен в модели, он будет распознан следующим видео, проиндексированным в этой модели. 
    1. Чтобы пометить анимированный символ в видео, перейдите на вкладку **аналитика** и нажмите кнопку **изменить** в правом верхнем углу окна.
    1. В области **аналитика** щелкните любой из обнаруженных анимированных символов и измените их имена с "Unknown #X" (или имя, которое ранее было назначено этому символу).
    1. После ввода нового имени щелкните значок галочки рядом с новым именем. Это сохранит новое имя в модели в индексаторе видео.
    1. После завершения редактирования всех нужных имен необходимо обучить модель.

        Откройте страницу Настройка и щелкните вкладку **анимированные символы** , а затем нажмите кнопку **обучение** , чтобы обучить модель.
         
        Если у вас есть платная учетная запись, можно щелкнуть ссылку **Управление моделями в клиентской концепции** (как показано ниже). Затем вы будете перенаправлены на страницу модели в **пользовательское визуальное распознавание**.
 
        ![Настройка модели содержимого](./media/animated-characters-recognition/content-model-customization-tab.png)

     1. После обучения любое видео, которое будет индексироваться или переиндексировано с помощью этой модели, будет распознавать обученные символы. 
    Оплаченные учетные записи, имеющие доступ к своей учетной записи Пользовательское визуальное распознавание, могут видеть модели и изображения с тегами. Дополнительные сведения об [улучшении классификатора в пользовательское визуальное распознавание](https://docs.microsoft.com/azure/cognitive-services/custom-vision-service/getting-started-improving-your-classifier).

1. Удаление анимированного символа.

    1. Чтобы удалить анимированный символ в Video Insights, перейдите на вкладку **аналитика** и нажмите кнопку **изменить** в правом верхнем углу окна.
    1. Выберите анимированный символ и нажмите кнопку **Удалить** под его именем.

    > [!NOTE]
    > Это позволит удалить аналитику из этого видео, но не повлияет на модель.

1. Удаление модели.

    1. Нажмите кнопку **Настройка модели содержимого** в верхнем меню и перейдите на вкладку **анимированные символы** .
    1. Щелкните значок с многоточием справа от модели, которую необходимо удалить, а затем нажмите кнопку Удалить.
    
    * Платная учетная запись. модель будет отключена от индексатора видео, и ее невозможно будет подключить повторно.
    * Пробная учетная запись. модель также будет удалена из таможенного видения. 
    
        > [!NOTE]
        > В пробной учетной записи имеется только одна модель, которую можно использовать. После удаления вы не сможете обучить другие модели.

## <a name="use-the-animated-character-detection-with-api"></a>Использование распознавания анимированных символов с помощью API 

1. Подключите учетную запись Пользовательское визуальное распознавание.

    Если вы владеете платной учетной записью индексатора видео, сначала необходимо подключить учетную запись Пользовательское визуальное распознавание. <br/>
    Если у вас еще нет учетной записи Пользовательское визуальное распознавание, создайте ее. Дополнительные сведения см. в разделе [пользовательское визуальное распознавание](https://docs.microsoft.com/azure/cognitive-services/custom-vision-service/home).

    [Подключите учетную запись пользовательское визуальное распознавание с помощью API](https://api-portal.videoindexer.ai/docs/services/Operations/operations/Connect-Custom-Vision-Account?tags=&pattern=&groupBy=tag).
1. Создание модели анимированных символов.

    Используйте API [создания модели анимации](https://api-portal.videoindexer.ai/docs/services/Operations/operations/Create-Animation-Model?&groupBy=tag) .
1. Индексирование и повторное индексирование видео.

    Используйте API [повторной индексации](https://api-portal.videoindexer.ai/docs/services/operations/operations/Re-Index-Video?) . 
1. Настройка моделей с анимированными символами.

    Использование API-интерфейса для [обучения модели анимации](https://api-portal.videoindexer.ai/docs/services/Operations/operations/Train-Animation-Model?&groupBy=tag) .

### <a name="view-the-output"></a>Просмотр результатов

Просмотр анимированных символов в созданном JSON файле.

```json
"animatedCharacters": [
    {
    "videoId": "e867214582",
    "confidence": 0,
    "thumbnailId": "00000000-0000-0000-0000-000000000000",
    "seenDuration": 201.5,
    "seenDurationRatio": 0.3175,
    "isKnownCharacter": true,
    "id": 4,
    "name": "Bunny",
    "appearances": [
        {
            "startTime": "0:00:52.333",
            "endTime": "0:02:02.6",
            "startSeconds": 52.3,
            "endSeconds": 122.6
        },
        {
            "startTime": "0:02:40.633",
            "endTime": "0:03:16.6",
            "startSeconds": 160.6,
            "endSeconds": 196.6
        },
    ]
    },
]
```

## <a name="limitations"></a>Ограничения

* В настоящее время возможность "идентификации анимации" не поддерживается в регионе Восточной Азии.
* Символы, которые выглядят маленькими или далеко не в видео, могут быть неправильно идентифицированы, если качество видео низкое.
* Рекомендуется использовать модель для набора анимированных символов (например, для каждого анимированного ряда).

## <a name="next-steps"></a>Дальнейшие шаги

[Общие сведения об Индексаторе видео](video-indexer-overview.md)
