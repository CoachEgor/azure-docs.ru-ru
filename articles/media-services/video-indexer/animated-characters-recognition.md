---
title: Анимированное обнаружение символов с помощью видеоиндекса
titleSuffix: Azure Media Services
description: Эта тема демонстрирует, как использовать анимированные обнаружения символов с видео индексатора.
services: media-services
author: Juliako
manager: femila
ms.service: media-services
ms.subservice: video-indexer
ms.topic: article
ms.date: 11/19/2019
ms.author: juliako
ms.openlocfilehash: af608dcfbb5d98cf3116de4e14dc12bf6facb97b
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/27/2020
ms.locfileid: "76989915"
---
# <a name="animated-character-detection-preview"></a>Обнаружение анимированных символов (предварительный просмотр)

Video Indexer Azure Media Services поддерживает обнаружение, группировку и распознавание персонажей в анимационном контенте посредством интеграции с [пользовательским видением Cognitive Services.](https://azure.microsoft.com/services/cognitive-services/custom-vision-service/) Эта функциональность доступна как через портал, так и через API.

После загрузки анимированного видео с определенной моделью анимации, Video Indexer извлекает ключевые кадры, обнаруживает анимированных персонажей в этих кадрах, группирует похожий персонаж и выбирает лучший образец. Затем он отправляет сгруппированные символы в Custom Vision, которая определяет символы на основе моделей, на которые он обучался. 

Перед тем, как начать обучение модели, символы обнаруживаются безымянно. При добавлении имен и обучении модели Видеоиндексер распознает символы и назовет их соответствующим образом.

## <a name="flow-diagram"></a>Схема процесса

Следующая диаграмма демонстрирует поток процесса обнаружения анимированных символов.

![Схема процесса](./media/animated-characters-recognition/flow.png)

## <a name="accounts"></a>Учетные записи

В зависимости от типа учетной записи Video Indexer доступны различные наборы функций. Для получения информации о том, как подключить учетную запись к Azure, можно узнать об [создаваемую учетную запись Video Indexer, подключенную к Azure.](connect-to-azure.md)

* Пробная учетная запись: Video Indexer использует внутреннюю учетную запись Custom Vision для создания модели и подключения ее к учетной записи Video Indexer. 
* Платная учетная запись: вы подключаете учетную запись Custom Vision к учетной записи Video Indexer (если у вас ее еще нет, сначала необходимо создать учетную запись).

### <a name="trial-vs-paid"></a>Судебное разбирательство по сравнению с оплаченным

|Функциональность|Пробная версия|Платно|
|---|---|---|
|Учетная запись Custom Vision|Управляется за кулисами Видео Indexer. |Ваша учетная запись Custom Vision подключена к Video Indexer.|
|Количество моделей анимации|Один|До 100 моделей на учетную запись (ограничение пользовательского зрения).|
|Обучение модели|Video Indexer готовит модель для новых персонажей дополнительных примеров существующих символов.|Владелец учетной записи обучает модель, когда они готовы внести изменения.|
|Расширенные опции в пользовательском видении|Нет доступа к порталу Custom Vision.|Вы можете настроить модели самостоятельно на портале Custom Vision.|

## <a name="use-the-animated-character-detection-with-portal"></a>Используйте анимированное обнаружение символов с помощью портала 

В этом разделе описаны шаги, которые необходимо предпринять, чтобы начать использовать анимированную модель обнаружения символов. 

Так как в пробных учетных записях интеграция Custom Vision управляется Video Indexer, вы можете начать создавать и использовать модель анимированных персонажей и пропустить следующий раздел ("Подключите учетную запись Custom Vision").

### <a name="connect-your-custom-vision-account-paid-accounts-only"></a>Подключите учетную запись Custom Vision (только платные счета)

Если у вас есть платная учетная запись Video Indexer, сначала необходимо подключить учетную запись Custom Vision. Если у вас уже нет учетной записи Custom Vision, пожалуйста, создайте ее. Для получения дополнительной информации [см.](../../cognitive-services/custom-vision-service/home.md)

> [!NOTE]
> Обе учетные записи должны находиться в одном регионе. Интеграция Custom Vision в настоящее время не поддерживается в регионе Японии.

#### <a name="connect-a-custom-vision-account-with-api"></a>Подключение учетной записи Custom Vision с помощью API 

Выполните следующие действия, чтобы подключить учетную запись Custom Vision к Video Indexer или изменить учетную запись Custom Vision, которая в настоящее время подключена к Video Indexer:

1. Просмотрите [www.customvision.ai](https://www.customvision.ai) и войти.
1. Копируйте следующие клавиши: 

    * Учебный ключ (для учебного ресурса)
    * Ключ прогнозирования (для ресурса прогнозирования)
    * Конечная точка 
    * Идентификатор ресурса прогнозирования
    
    > [!NOTE]
    > Чтобы предоставить все ключи, необходимо иметь два отдельных ресурса в Custom Vision, один для обучения и один для прогнозирования.
1. Просмотрите и вопийте в [Video Indexer.](https://vi.microsoft.com/)
1. Нажмите на вопросительный знак в правом верхнем углу страницы и выберите **ссылку API.**
1. Убедитесь, что вы подписались на API Management, нажав на вкладку **«Продукты».** Если у вас есть Подключенный API, вы можете продолжить следующий шаг, в противном случае, подписаться. 
1. На портале разработчиков щелкните **Полную ссылку API** и просмотрите **операции.**  
1. Выберите **учетную запись пользовательского зрения (PREVIEW)** и нажмите **Попробуйте его.**
1. Заполните необходимые поля, а также токен доступа и нажмите **Отправить**. 

    Для получения дополнительной информации о том, как получить токен доступа Video Indexer, перейдите на [портал разработчиков](https://api-portal.videoindexer.ai/docs/services/operations/operations/Get-Account-Access-Token?)и ознакомьтесь с [соответствующей документацией.](video-indexer-use-apis.md#obtain-access-token-using-the-authorization-api)  
1. После того, как вызов возвращает 200 OK ответ, ваша учетная запись подключена.
1. Чтобы проверить подключение, просматривая портал [Video Indexer:](https://vi.microsoft.com/)
1. Нажмите на кнопку **настройки модели Content** в правом верхнем углу.
1. Перейдите на вкладку **Анимированные персонажи.**
1. Как только вы нажмете на модели Управления в Custom Vision, вы будете переведены на только что подключенный аккаунт Custom Vision.

> [!NOTE]
> В настоящее время поддерживаются только модели, созданные с помощью Video Indexer. Модели, созданные с помощью Custom Vision, будут недоступны. Кроме того, наилучшей практикой является редикации моделей, которые были созданы с помощью Video Indexer только через платформу Video Indexer, так как изменения, внесенные через Custom Vision, могут привести к непреднамеренным результатам.

### <a name="create-an-animated-characters-model"></a>Создание модели анимированных персонажей

1. Откройте веб-сайт [Индексатора видео](https://vi.microsoft.com/) и выполните вход.
1. Нажмите на кнопку настройки модели содержимого в правом верхнем углу страницы.

    ![Настройка модели содержимого](./media/animated-characters-recognition/content-model-customization.png)
1. Перейдите на вкладку **Анимированные символы** в разделе настройки модели.
1. Нажмите на **модель Добавить**.
1. Назовите модель и нажмите кнопку "Введите", чтобы сохранить имя.

> [!NOTE]
> Наилучшая практика заключается в том, чтобы иметь одну пользовательскую модель видения для каждого мультсериала. 

### <a name="index-a-video-with-an-animated-model"></a>Индекс видео с анимированной моделью

1. Нажмите на кнопку **Загрузка** из верхнего меню.
1. Выберите видео для загрузки (из файла или URL).
1. Нажмите на **Расширенные опции**.
1. Под **Люди / Анимированные персонажи** выбирают **модели анимации**.
1. Если у вас есть одна модель, она будет выбрана автоматически, и если у вас есть несколько моделей, вы можете выбрать соответствующую модель из меню выпадения.
1. Нажмите на загрузку.
1. После индексирования видео вы увидите обнаруженные символы в разделе **Анимированные символы** в панели **Insights.**

> [!NOTE] 
> Перед пометкой и обучением модели все анимационные персонажи будут называться «Неизвестные #X». После тренировки модели они также будут признаны.

### <a name="customize-the-animated-characters-models"></a>Настройка моделей анимированных персонажей

1. Тег и обучить модель.

    1. Отметьте обнаруженный символ, отредактировав его имя. Как только персонаж обучается в модели, он будет признан следующим видео индексируется с этой моделью. 
    1. Чтобы отметить анимированного персонажа в видео, перейдите на вкладку **Insights** и нажмите на кнопку **Редактирование** в правом верхнем углу окна.
    1. В панели **Insights** нажмите на любой из обнаруженных анимированных персонажей и измените их имена с «Unknown #X» (или имя, которое ранее было присвоено персонажу).
    1. После ввода нового имени щелкните значок галочки рядом с новым именем. Это сохраняет новое имя в модели в Video Indexer.
    1. После того, как вы закончили редактировать все имена, которые вы хотите, вам нужно обучить модель.

        Откройте страницу настройки и нажмите на вкладку **Анимированные символы,** а затем нажмите на кнопку **"Поезд",** чтобы обучить свою модель.
         
        Если у вас есть платная учетная запись, вы можете нажать **на модели Управления в** ссылке Customer Vision (как показано ниже). Затем вы будете перенаправлены на страницу модели в **Custom Vision**.
 
        ![Настройка модели содержимого](./media/animated-characters-recognition/content-model-customization-tab.png)

     1. После обучения любое видео, которое будет проиндексировано или переиндексировано с этой моделью, распознает обученные символы. 
    Платные учетные записи, которые имеют доступ к своей учетной записи Custom Vision, могут видеть модели и помеченные изображения. Подробнее об [улучшении классификатора читайте в пользовательском](https://docs.microsoft.com/azure/cognitive-services/custom-vision-service/getting-started-improving-your-classifier)видении.

1. Удалить анимированный персонаж.

    1. Чтобы удалить анимированный персонаж в видео-идеи, перейдите на вкладку **Insights** и нажмите на кнопку **Редактирование** в правом верхнем углу окна.
    1. Выберите анимированный персонаж, а затем нажмите на кнопку **Удалить** под его именем.

    > [!NOTE]
    > Это удалит информацию из этого видео, но не повлияет на модель.

1. Удалить модель.

    1. Нажмите на кнопку **настройки модели содержимого** в верхнем меню и перейдите на вкладку **Анимированные персонажи.**
    1. Нажмите на значок эллипсиса справа от модели, который вы хотите удалить, а затем на кнопку удаления.
    
    * Платная учетная запись: модель будет отключена от Video Indexer, и вы не сможете подключить его.
    * Пробная учетная запись: модель также будет удалена из таможенного видения. 
    
        > [!NOTE]
        > В пробной учетной записи у вас есть только одна модель, которая вы можете использовать. После удаления вы не можете обучить другие модели.

## <a name="use-the-animated-character-detection-with-api"></a>Используйте анимированное обнаружение символов с помощью API 

1. Подключите учетную запись Custom Vision.

    Если у вас есть платная учетная запись Video Indexer, сначала необходимо подключить учетную запись Custom Vision. <br/>
    Если у вас уже нет учетной записи Custom Vision, пожалуйста, создайте ее. Для получения дополнительной информации [см.](https://docs.microsoft.com/azure/cognitive-services/custom-vision-service/home)

    [Подключите учетную запись Custom Vision с помощью API.](https://api-portal.videoindexer.ai/docs/services/Operations/operations/Connect-Custom-Vision-Account?tags=&pattern=&groupBy=tag)
1. Создайте модель анимированных персонажей.

    Используйте API [модели анимации.](https://api-portal.videoindexer.ai/docs/services/Operations/operations/Create-Animation-Model?&groupBy=tag)
1. Индекс или переиндексация видео.

    Используйте [API повторной индексации.](https://api-portal.videoindexer.ai/docs/services/operations/operations/Re-Index-Video?) 
1. Настройте модели анимированных персонажей.

    Используйте [модель анимации поезда](https://api-portal.videoindexer.ai/docs/services/Operations/operations/Train-Animation-Model?&groupBy=tag) API.

### <a name="view-the-output"></a>Просмотр результатов

Смотрите анимированные персонажи в сгенерированном файле JSON.

```json
"animatedCharacters": [
    {
    "videoId": "e867214582",
    "confidence": 0,
    "thumbnailId": "00000000-0000-0000-0000-000000000000",
    "seenDuration": 201.5,
    "seenDurationRatio": 0.3175,
    "isKnownCharacter": true,
    "id": 4,
    "name": "Bunny",
    "appearances": [
        {
            "startTime": "0:00:52.333",
            "endTime": "0:02:02.6",
            "startSeconds": 52.3,
            "endSeconds": 122.6
        },
        {
            "startTime": "0:02:40.633",
            "endTime": "0:03:16.6",
            "startSeconds": 160.6,
            "endSeconds": 196.6
        },
    ]
    },
]
```

## <a name="limitations"></a>Ограничения

* В настоящее время в регионе Восточной и Азии не поддерживается возможность «идентификации анимации».
* Персонажи, которые кажутся маленькими или далекими в видео, не могут быть идентифицированы должным образом, если качество видео плохое.
* Рекомендация заключается в использовании модели на набор анимированных персонажей (например, в мультсериале).

## <a name="next-steps"></a>Дальнейшие действия

[Общие сведения об Индексаторе видео](video-indexer-overview.md)
