---
title: Миграция из планировщика Azure в Azure Logic Apps
description: Узнайте, как можно заменить задания в планировщике Azure, поддержка которого будет прекращена, на задания Azure Logic Apps.
services: scheduler
ms.service: scheduler
ms.suite: infrastructure-services
author: derek1ee
ms.author: deli
ms.reviewer: klam, LADocs
ms.topic: article
ms.date: 09/20/2018
ms.openlocfilehash: 0225a9f34e016a4b1de51c06ba982d384e41007c
ms.sourcegitcommit: af58483a9c574a10edc546f2737939a93af87b73
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/17/2019
ms.locfileid: "68302074"
---
# <a name="migrate-azure-scheduler-jobs-to-azure-logic-apps"></a>Перемещение заданий из планировщика Azure в Azure Logic Apps

> [!IMPORTANT]
> Служба Azure Logic Apps заменяет планировщик Azure, который выводится из эксплуатации. Чтобы запланировать задания, следуйте приведенным в этой статье инструкциям по переходу на Azure Logic Apps.

В этой статье показано, как можно планировать одноразовые и повторяющиеся задания, создавая автоматические рабочие процессы в Azure Logic Apps вместо планировщика Azure. Когда вы создаете запланированные задания в Logic Apps, вы получаете следующие преимущества:

* Вам не нужно беспокоиться о концепции *коллекции заданий*, потому что каждое приложение логики представляет собой отдельный ресурс Azure.

* Вы можете запускать несколько одноразовых заданий с помощью единого приложения логики.

* Служба Azure Logic Apps поддерживает часовой пояс и летнее время (DST).

Дополнительные сведения см. в статье [Что такое Azure Logic Apps](../logic-apps/logic-apps-overview.md) или попробуйте создать первое приложение логики в этом кратком руководстве: [Создайте свое первое приложение логики](../logic-apps/quickstart-create-first-logic-app-workflow.md).

## <a name="prerequisites"></a>Предварительные требования

* Подписка Azure. Если у вас еще нет подписки Azure, <a href="https://azure.microsoft.com/free/" target="_blank">зарегистрируйтесь для получения бесплатной учетной записи Azure</a>.

* Чтобы активировать приложение логики с помощью HTTP-запросов, используйте средство, такое как [классическое приложение Postman](https://www.getpostman.com/apps).

## <a name="schedule-one-time-jobs"></a>Планирование одноразовых заданий

Вы можете запускать несколько одноразовых заданий с помощью единого приложения логики. 

### <a name="create-your-logic-app"></a>Создание приложения логики

1. На [портале Azure](https://portal.azure.com) создайте пустое приложение логики в конструкторе приложений логики. 

   Основные шаги [приведены в кратком руководстве: Создание первого автоматизированного рабочего процесса с помощью Azure Logic Apps на портале Azure](../logic-apps/quickstart-create-first-logic-app-workflow.md).

1. В поле поиска введите фильтр "когда HTTP-запрос". В списке триггеров выберите триггер: **При получении HTTP-запроса** 

   ![Добавление триггера запросов](./media/migrate-from-scheduler-to-logic-apps/request-trigger.png)

1. Для триггера запросов можно дополнительно предоставить схему JSON, которая помогает конструктору приложений логики понять структуру входных данных входящего запроса и облегчит вам выбор выходных данных в рабочем процессе.

   Чтобы указать схему, введите ее в поле **Схема JSON текста запроса**, например: 

   ![Схема запроса](./media/migrate-from-scheduler-to-logic-apps/request-schema.png)

   Если у вас нет схемы, но у вас есть пример полезных данных в формате JSON, можно создать схему на основе полезных данных.

   1. В триггере запросов выберите **Использовать пример полезной нагрузки, чтобы создать схему**.

   1. В разделе **Введение или вставка примера полезных данных JSON** предоставьте пример полезных данных, а затем выберите **Готово**, например:

      ![Пример полезных данных](./media/migrate-from-scheduler-to-logic-apps/sample-payload.png)

1. В разделе триггера выберите **Следующий шаг**. 

1. В поле поиска введите "задержка до" в качестве условия фильтра. В списке действий выберите действие **Задержка до**

   Это действие приостанавливает рабочий процесс вашего приложения логики до указанной даты и времени.

   ![Добавление действия "Задержка до"](./media/migrate-from-scheduler-to-logic-apps/delay-until.png)

1. Введите отметку времени, когда требуется запустить рабочий процесс приложения логики. 

   Когда вы щелкаете внутри поля **Метка времени**, появляется список динамического содержимого, и вы можете выбрать выходные данные из триггера.

   ![Указание сведений "Задержка до"](./media/migrate-from-scheduler-to-logic-apps/delay-until-details.png)

1. Добавьте любые другие действия, которые необходимо выполнить, выбрав один из [сотен готовых соединителей](../connectors/apis-list.md). 

   Например, вы можете включить действие HTTP, которое отправляет запрос на URL-адрес, или действия, которые работают с очередями хранения, очередями или темами служебной шины: 

   ![Действие HTTP](./media/migrate-from-scheduler-to-logic-apps/request-http-action.png)

1. Сохраните приложение логики, когда закончите.

   ![Сохранение приложения логики](./media/migrate-from-scheduler-to-logic-apps/save-logic-app.png)

   Когда вы впервые сохраняете свое приложение логики, URL-адрес конечной точки для триггера запросов вашего приложения появляется в поле **URL-адрес HTTP POST**. 
   Если вы хотите вызвать приложение логики и отправить в него входные данные для обработки, используйте в качестве назначения вызова этот URL-адрес.

   ![Сохранение URL-адреса конечной точки триггера запроса](./media/migrate-from-scheduler-to-logic-apps/request-endpoint-url.png)

1. Скопируйте и сохраните этот URL-адрес конечной точки, чтобы впоследствии вы могли вручную отправить запрос, который запускает ваше приложение логики. 

## <a name="start-a-one-time-job"></a>Запуск одноразового задания

Чтобы вручную запустить или активировать одноразовое задание, отправьте вызов на адрес конечной точки для триггера запроса приложения логики. В этом вызове укажите входные или полезные данные для отправки, которые вы могли описать ранее, указав схему. 

Например, используя приложение Postman, вы можете создать запрос POST с параметрами, как в этом примере, а затем выбрать **Отправить**, чтобы выполнить запрос.

| Метод запроса | URL | Текст | Заголовки |
|----------------|-----|------|---------| 
| **POST** | <*endpoint-URL*> | **raw** (Без форматирования) <p>**JSON (application/json)** <p>В поле **raw** (Без форматирования) введите полезные данные, которые нужно отправить в запросе. <p>**Примечание**. Этот параметр автоматически настраивает значения  заголовков. | **Ключ**: Content-Type <br>**Значение**: application/json
 |||| 

![Отправка запроса на запуск приложения логики вручную](./media/migrate-from-scheduler-to-logic-apps/postman-send-post-request.png)

После отправки вызова ответ из приложения логики появится в поле **raw** (Без форматирования) на вкладке **Body** (Текст). 

<a name="workflow-run-id"></a>

> [!IMPORTANT]
>
> Если вы хотите отменить задание позже, выберите вкладку **Headers** (Заголовки). Найдите и скопируйте значение заголовка **x-ms-workflow-run-id** в ответе. 
>
> ![Ответ](./media/migrate-from-scheduler-to-logic-apps/postman-response.png)

## <a name="cancel-a-one-time-job"></a>Отмена одноразового задания

В Logic Apps каждое одноразовое задание выполняется как отдельный экземпляр запуска приложения логики. Чтобы отменить одноразовое задание, можно использовать команды [отмены выполнений рабочего процесса](https://docs.microsoft.com/rest/api/logic/workflowruns/cancel) в REST API Logic Apps. Когда вы отправляете вызов триггеру, укажите [идентификатор выполнения рабочего процесса](#workflow-run-id).

## <a name="schedule-recurring-jobs"></a>Планирование повторяющихся заданий

### <a name="create-your-logic-app"></a>Создание приложения логики

1. На [портале Azure](https://portal.azure.com) создайте пустое приложение логики в конструкторе приложений логики. 

   Основные шаги [приведены в кратком руководстве: Создание первого автоматизированного рабочего процесса с помощью Azure Logic Apps на портале Azure](../logic-apps/quickstart-create-first-logic-app-workflow.md).

1. В поле поиска введите слово "повторение" в качестве фильтра. В списке триггеров выберите триггер: **Периодичность** 

   ![Добавление триггера повторения](./media/migrate-from-scheduler-to-logic-apps/recurrence-trigger.png)

1. При желании можно настроить более расширенное расписание.

   ![Расширенное расписание](./media/migrate-from-scheduler-to-logic-apps/recurrence-advanced-schedule.png)

   Дополнительные сведения о расширенных параметрах планирования см. в разделе [Создание и выполнение повторяющихся задач и рабочих процессов с помощью Azure Logic Apps](../connectors/connectors-native-recurrence.md).

1. Добавьте другие необходимые действия, выбрав их из [сотен готовых к использованию](../connectors/apis-list.md). В разделе триггера выберите **Следующий шаг**. Найдите и выберите нужные действия.

   Например, вы можете включить действие HTTP, которое отправляет запрос на URL-адрес, или действия, которые работают с очередями хранения, очередями или темами служебной шины: 

   ![Действие HTTP](./media/migrate-from-scheduler-to-logic-apps/recurrence-http-action.png)

1. Сохраните приложение логики, когда закончите.

   ![Сохранение приложения логики](./media/migrate-from-scheduler-to-logic-apps/save-logic-app.png)

## <a name="advanced-setup"></a>Расширенная настройка

Здесь вы можете настроить свои задания.

### <a name="retry-policy"></a>Политика повтора

Чтобы контролировать способ повторного запуска действия в вашем приложении логики, когда происходят прерывистые сбои, вы можете установить [политику повтора](../logic-apps/logic-apps-exception-handling.md#retry-policies) в параметрах каждого действия, например:

1. Откройте меню действия ( **...** ) и выберите пункт **Параметры**.

   ![Открытие параметров действия](./media/migrate-from-scheduler-to-logic-apps/action-settings.png)

1. Выберите нужную политику повтора. Дополнительные сведения см. в разделе [Политики повтора](../logic-apps/logic-apps-exception-handling.md#retry-policies).

   ![Выбор политики повтора](./media/migrate-from-scheduler-to-logic-apps/retry-policy.png)

## <a name="handle-exceptions-and-errors"></a>Обработка ошибок и исключений

В планировщике Azure, если действие по умолчанию не выполняется, вы можете запустить альтернативное действие, которое учитывает условие ошибки. В Azure Logic Apps вы можете выполнить ту же задачу.

1. В конструкторе приложений логики над действием, которое вы хотите обработать, переместите указатель на стрелку между шагами и выберите **Добавить параллельную ветвь**. 

   ![Добавление параллельной ветви](./media/migrate-from-scheduler-to-logic-apps/add-parallel-branch.png)

1. Найдите и выберите действие, которое нужно использовать в качестве альтернативного действия.

   ![Добавление параллельного действия](./media/migrate-from-scheduler-to-logic-apps/add-parallel-action.png)

1. В альтернативном действии откройте ( **...** ) и выберите пункт **Настроить последующий запуск**.

   ![Настройка последующего запуска](./media/migrate-from-scheduler-to-logic-apps/configure-run-after.png)

1. Снимите флажок свойства **выполнено**. Выберите эти свойства: **завершился сбоем**, **пропущен** и **прекращено по таймауту**.

   ![Настройка свойств последующего запуска](./media/migrate-from-scheduler-to-logic-apps/select-run-after-properties.png)

1. По завершении нажмите кнопку **Готово**.

Дополнительные сведения об обработке исключений см. в разделе [Перехват и обработка ошибок с помощью свойства RunAfter](../logic-apps/logic-apps-exception-handling.md#catch-and-handle-failures-with-the-runafter-property).

## <a name="faq"></a>Часто задаваемые вопросы

<a name="retire-date"></a> 

**Вопрос**. Когда будет снят с учета планировщика Azure? <br>
**Ответ**. Запланировано прекращение использования планировщика Azure 30 сентября 2019 г.

**Вопрос**. Что происходит с моими коллекциями заданий и заданиями планировщика после завершения службы? <br>
**Ответ**. Все коллекции заданий и задания планировщика будут удалены из системы.

**Вопрос**. Нужно ли выполнять резервное копирование или выполнение других задач перед переносом заданий планировщика в Logic Apps? <br>
**Ответ**. Рекомендуется всегда создавать резервные копии своей работы. Убедитесь, что созданные вами приложения логики работают, как ожидалось, прежде чем удалять или отключать задания планировщика. 

**Вопрос**. Есть ли средство, которое может помочь перенести мои задания из планировщика в Logic Apps? <br>
**Ответ**. Каждое задание планировщика является уникальным, поэтому не существует средства с одним размером. Тем не менее будут доступны различные сценарии, которые можно будет изменить для ваших нужд. Доступность сценариев можно будет проверить позже.

**Вопрос**. Где можно получить поддержку миграции заданий планировщика? <br>
**Ответ**. Ниже приведены некоторые способы получения поддержки. 

**портал Azure**

Если ваша подписка Azure имеет платный план поддержки, вы можете создать запрос в службу технической поддержки на портале Azure. В противном случае вы можете выбрать другой вариант поддержки.

1. В главном меню на [портале Azure](https://portal.azure.com) выберите **Справка + поддержка**.

1. Затем в разделе **Поддержка** выберите **Новый запрос в службу поддержки**. Предоставьте такие сведения о запросе:

   | Параметр | Значение |
   |---------|-------|
   | **Тип проблемы** | **Технические требования** | 
   | **Подписка** | <*ваша_подписка_Azure*> | 
   | **Служба** | В разделе **Мониторинг и управление** выберите **Планировщик**. | 
   ||| 

1. Выберите нужный вариант поддержки. Если у вас есть оплаченный план поддержки, нажмите кнопку **Далее**.

**Сообщество**

* [Форум Azure Logic Apps](https://social.msdn.microsoft.com/Forums/en-US/home?forum=azurelogicapps)
* [Stack Overflow](https://stackoverflow.com/questions/tagged/azure-scheduler)

## <a name="next-steps"></a>Следующие шаги

* [Создание регулярно выполняющихся рабочих процессов и задач с помощью Azure Logic Apps](../connectors/connectors-native-recurrence.md)
* [Учебник. Проверка трафика с помощью приложения логики на основе расписания](../logic-apps/tutorial-build-schedule-recurring-logic-app-workflow.md)
