---
title: Миграция из планировщика Azure в Azure Logic Apps
description: Узнайте, как можно заменить задания в планировщике Azure, поддержка которого будет прекращена, на задания Azure Logic Apps.
services: scheduler
ms.service: scheduler
ms.suite: infrastructure-services
author: derek1ee
ms.author: deli
ms.reviewer: klam, estfan
ms.topic: article
ms.date: 02/29/2020
ms.openlocfilehash: 90c3cc2e096b9b58465987bc53f718c5d06c6203
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "78899096"
---
# <a name="migrate-azure-scheduler-jobs-to-azure-logic-apps"></a>Перемещение заданий из планировщика Azure в Azure Logic Apps

> [!IMPORTANT]
> [Azure Logic Apps](../logic-apps/logic-apps-overview.md) заменяет Azure Scheduler, который [в настоящее время удался.](#retire-date) Чтобы продолжить работу с заданиями, настроенными в Scheduler, пожалуйста, перейти на Azure Logic Apps как можно скорее, следуя этой статье. 
>
> Планировщик больше не доступен на портале Azure, но на данный момент доступны смдлеты [REST API](/rest/api/scheduler) и [Azure Scheduler PowerShell,](scheduler-powershell-reference.md) чтобы вы могли управлять своими рабочими местами и коллекциями заданий.

В этой статье показано, как можно планировать одноразовые и повторяющиеся задания, создавая автоматические рабочие процессы в Azure Logic Apps вместо планировщика Azure. Когда вы создаете запланированные задания в Logic Apps, вы получаете следующие преимущества:

* Создайте свою работу с помощью визуального конструктора и [готовых к использованию разъемов](../connectors/apis-list.md) из сотен служб, таких как Хранилище Azure Blob Storage, Azure Service Bus, Office 365 Outlook и SAP.

* Управление каждым запланированным рабочим процессом в качестве первоклассного ресурса Azure. Вам не нужно беспокоиться о концепции *сбора задания,* потому что каждое приложение логики является отдельным ресурсом Azure.

* Выполнить несколько одноразовых заданий с помощью одного приложения логики.

* Установите расписания, которые поддерживают часовые пояса и автоматически приспосабливаются к дневному времени (DST).

Чтобы узнать больше, посмотрите [Что такое Azure Logic Apps?](../logic-apps/logic-apps-overview.md) или попробуйте создать свое первое логическое приложение в этом quickstart: [Создайте свое первое приложение логики](../logic-apps/quickstart-create-first-logic-app-workflow.md).

## <a name="prerequisites"></a>Предварительные требования

* Подписка Azure. Если у вас еще нет подписки Azure, [зарегистрируйтесь для получения бесплатной учетной записи Azure](https://azure.microsoft.com/free/).

* Чтобы активировать приложение логики с помощью HTTP-запросов, используйте средство, такое как [классическое приложение Postman](https://www.getpostman.com/apps).

## <a name="migrate-by-using-a-script"></a>Мигрировать с помощью сценария

Каждое задание Планировщика уникально, поэтому не существует универсального инструмента для переноса заданий Планировщика в приложения Azure Logic Apps. Тем не менее, вы можете [отойти от этого сценария,](https://github.com/Azure/logicapps/tree/master/scripts/scheduler-migration) чтобы удовлетворить ваши потребности.

## <a name="schedule-one-time-jobs"></a>Планирование одноразовых заданий

Вы можете запускать несколько одноразовых заданий с помощью единого приложения логики.

1. На [портале Azure](https://portal.azure.com) создайте пустое приложение логики в конструкторе приложений логики.

   Основные шаги описаны в статье [Краткое руководство. Создание первого автоматизированного рабочего процесса с помощью Azure Logic Apps на портале Azure](../logic-apps/quickstart-create-first-logic-app-workflow.md).

1. В поле поиска `when a http request` введите, чтобы найти триггер Запроса. В списке триггеров выберите триггер **При получении HTTP-запроса**.

   ![Добавление триггера запросов](./media/migrate-from-scheduler-to-logic-apps/request-trigger.png)

1. Для триггера Запроса можно дополнительно предоставить схему JSON, которая помогает конструктору logic App понять структуру входных данных, включенных в входящий вызов триггера Запроса, и упрощает выбор выходов позже в рабочем процессе.

   В поле **Запрос тела JSON Schema** введите схему, например:

   ![Схема запроса](./media/migrate-from-scheduler-to-logic-apps/request-schema.png)

   Если у вас нет схемы, но у вас есть пример полезных данных в формате JSON, можно создать схему на основе полезных данных.

   1. В триггере запросов выберите **Использовать пример полезной нагрузки, чтобы создать схему**.

   1. Под **Введите или вставьте образец полезной нагрузки JSON,** предоставьте вашу полезную нагрузку образца, и выберите **Done,** например:

      ![Пример полезных данных](./media/migrate-from-scheduler-to-logic-apps/sample-payload.png)

      ```json
      {
         "runat": "2012-08-04T00:00Z",
         "endpoint": "https://www.bing.com"
      }
      ```

1. Под спусковым крючком выберите **Следующий шаг.**

1. В поле поиска введите `delay until` в качестве фильтра. В списке действий выберите действие **Задержка до**.

   Это действие приостанавливает рабочий процесс вашего приложения логики до указанной даты и времени.

   ![Добавление действия "Задержка до"](./media/migrate-from-scheduler-to-logic-apps/delay-until.png)

1. Введите отметку времени, когда требуется запустить рабочий процесс приложения логики.

   При нажатии в поле **Timestamp** отображается динамический список содержимого, чтобы можно было по желанию выбрать выход из триггера.

   ![Указание сведений "Задержка до"](./media/migrate-from-scheduler-to-logic-apps/delay-until-details.png)

1. Добавьте любые другие действия, которые вы хотите выполнить, выбрав из [сотен готовых к использованию разъемов.](../connectors/apis-list.md)

   Например, вы можете включить действие HTTP, которое отправляет запрос на URL-адрес, или действия, которые работают с очередями хранения, очередями или темами служебной шины:

   ![Действие HTTP](./media/migrate-from-scheduler-to-logic-apps/request-http-action.png)

1. Сохраните приложение логики, когда закончите.

   ![Сохранение приложения логики](./media/migrate-from-scheduler-to-logic-apps/save-logic-app.png)

   Когда вы впервые сохраняете свое приложение логики, URL-адрес конечной точки для триггера запросов вашего приложения появляется в поле **URL-адрес HTTP POST**. Если вы хотите вызвать приложение логики и отправить в него входные данные для обработки, используйте в качестве назначения вызова этот URL-адрес.

   ![Сохранение URL-адреса конечной точки триггера запроса](./media/migrate-from-scheduler-to-logic-apps/request-endpoint-url.png)

1. Скопируйте и сохраните этот URL-адрес конечной точки, чтобы впоследствии вы могли вручную отправить запрос, который запускает ваше приложение логики.

## <a name="start-a-one-time-job"></a>Запуск одноразового задания

Чтобы вручную запустить или активировать одноразовое задание, отправьте вызов на адрес конечной точки для триггера запроса приложения логики. В этом вызове укажите входные или полезные данные для отправки, которые вы могли описать ранее, указав схему.

Например, используя приложение Post, можно создать запрос POST с настройками, аналогичными этому примеру, а затем выбрать **Отправить,** чтобы сделать запрос.

| Метод запроса | URL-адрес | Текст | Заголовки |
|----------------|-----|------|---------|
| **Поместить** | <*конечная точка-URL*> | **raw** <p>**JSON (application/json)** <p>В **необработанной** коробке введите полезную нагрузку, которую вы хотите отправить в запросе. <p>**Примечание**. Этот параметр автоматически настраивает значения **Headers** (Заголовки). | **Ключ**: Тип контента <br>**Значение**: приложение/json |
|||||

![Отправка запроса на запуск приложения логики вручную](./media/migrate-from-scheduler-to-logic-apps/postman-send-post-request.png)

После отправки вызова ответ из приложения логики появится в поле **raw** (Без форматирования) на вкладке **Body** (Текст). 

<a name="workflow-run-id"></a>

> [!IMPORTANT]
>
> Если вы хотите отменить задание позже, выберите вкладку **Заголовки.** Найти и скопировать значение **заголовка x-ms-workflow-run-id** в ответе. 
>
> ![Ответ](./media/migrate-from-scheduler-to-logic-apps/postman-response.png)

## <a name="cancel-a-one-time-job"></a>Отмена одноразового задания

В Logic Apps каждое одноразовое задание выполняется как отдельный экземпляр запуска приложения логики. Чтобы отменить одноразовое задание, можно использовать команды [отмены выполнений рабочего процесса](https://docs.microsoft.com/rest/api/logic/workflowruns/cancel) в REST API Logic Apps. Когда вы отправляете вызов триггеру, укажите [идентификатор выполнения рабочего процесса](#workflow-run-id).

## <a name="schedule-recurring-jobs"></a>Планирование повторяющихся заданий

1. На [портале Azure](https://portal.azure.com) создайте пустое приложение логики в конструкторе приложений логики.

   Основные шаги описаны в статье [Краткое руководство. Создание первого автоматизированного рабочего процесса с помощью Azure Logic Apps на портале Azure](../logic-apps/quickstart-create-first-logic-app-workflow.md).

1. В поле поиска введите слово "повторение" в качестве фильтра. В списке триггеров выберите триггер **Периодичность**.

   ![Добавление триггера повторения](./media/migrate-from-scheduler-to-logic-apps/recurrence-trigger.png)

1. При желании можно настроить более расширенное расписание.

   ![Расширенное расписание](./media/migrate-from-scheduler-to-logic-apps/recurrence-advanced-schedule.png)

   Для получения дополнительной информации о расширенных вариантах планирования см. [Создание и выполнение повторяющихся задач и рабочих процессов с приложениями Azure Logic Apps.](../connectors/connectors-native-recurrence.md)

1. Добавьте другие действия, которые вы хотите, выбрав из [сотен готовых к использованию.](../connectors/apis-list.md) Под спусковым крючком выберите **Следующий шаг.** Найдите и выберите нужные действия.

   Например, вы можете включить действие HTTP, которое отправляет запрос на URL-адрес, или действия, которые работают с очередями хранения, очередями или темами служебной шины:

   ![Действие HTTP](./media/migrate-from-scheduler-to-logic-apps/recurrence-http-action.png)

1. Сохраните приложение логики, когда закончите.

   ![Сохранение приложения логики](./media/migrate-from-scheduler-to-logic-apps/save-logic-app.png)

## <a name="advanced-setup"></a>Расширенная настройка

Здесь вы можете настроить свои задания.

### <a name="retry-policy"></a>Политика повтора

Чтобы контролировать способ повторного запуска действия в вашем приложении логики, когда происходят прерывистые сбои, вы можете установить [политику повтора](../logic-apps/logic-apps-exception-handling.md#retry-policies) в параметрах каждого действия, например:

1. Откройте эллипсы действия **(...**) меню и выберите **Настройки.**

   ![Открытие параметров действия](./media/migrate-from-scheduler-to-logic-apps/action-settings.png)

1. Выберите захотевную политику повтора. Дополнительные сведения см. в разделе [Политики повтора](../logic-apps/logic-apps-exception-handling.md#retry-policies).

   ![Выбор политики повтора](./media/migrate-from-scheduler-to-logic-apps/retry-policy.png)

## <a name="handle-exceptions-and-errors"></a>Обработка ошибок и исключений

В планировщике Azure, если действие по умолчанию не выполняется, вы можете запустить альтернативное действие, которое учитывает условие ошибки. В Azure Logic Apps вы можете выполнить ту же задачу.

1. В Logic App Designer, над действием, которое вы хотите обрабатывать, переместите указатель на стрелку между шагами и выберите **Добавить параллельную ветку.**

   ![Добавление параллельной ветви](./media/migrate-from-scheduler-to-logic-apps/add-parallel-branch.png)

1. Найдите и выберите действие, которое нужно использовать в качестве альтернативного действия.

   ![Добавление параллельного действия](./media/migrate-from-scheduler-to-logic-apps/add-parallel-action.png)

1. На альтернативном действии, откройте эллипсы **(...**) меню, и выберите **Настройка запустить после**.

   ![Настройка последующего запуска](./media/migrate-from-scheduler-to-logic-apps/configure-run-after.png)

1. Снимите флажок свойства **выполнено**. Выберите эти свойства: **завершился сбоем**, **пропущен** и **прекращено по таймауту**.

   ![Настройка свойств последующего запуска](./media/migrate-from-scheduler-to-logic-apps/select-run-after-properties.png)

1. По завершении нажмите кнопку **Готово**.

Дополнительные сведения об обработке исключений см. в разделе [Перехват и обработка ошибок с помощью свойства RunAfter](../logic-apps/logic-apps-exception-handling.md#control-run-after-behavior).

## <a name="faq"></a>часто задаваемые вопросы

<a name="retire-date"></a>

**В**. Когда прекращается поддержка планировщика Azure? <br>
**A:** Azure Scheduler полностью выйдет на пенсию 31 декабря 2019 года. Для важных шагов, которые необходимо предпринять до этой даты и подробные сроки, [см.](https://azure.microsoft.com/updates/extending-retirement-date-of-scheduler/) Для общих обновлений смотрите [обновления Azure - Расписание](https://azure.microsoft.com/updates/?product=scheduler).

**В:** Что происходит с моими коллекциями и рабочими местами после выхода службы на пенсию? <br>
**A:** Все коллекции заданий и заданий Scheduler прекращаются и удаляются из системы.

**В**. Нужно ли выполнять резервное копирование или какие-либо другие задачи перед переносом заданий планировщика в Logic Apps? <br>
**О**. Рекомендуется всегда создавать резервную копию своей работы. Убедитесь, что созданные вами приложения логики работают, как ожидалось, прежде чем удалять или отключать задания планировщика.

**В**. Есть ли инструмент, который помогает перенести задания из планировщика в Logic Apps? <br>
**О**. Каждое задание планировщика уникально, поэтому не существует универсального средства. Однако, основываясь на ваших потребностях, можно [отсеять этот скрипт, чтобы перенести задания Azure Scheduler в приложения логики Azure.](https://github.com/Azure/logicapps/tree/master/scripts/scheduler-migration)

**В**. Где я могу получить поддержку, чтобы перенести свои задания планировщика? <br>
**О**. Ниже приведены некоторые способы получения поддержки.

**Портал Azure**

Если ваша подписка Azure имеет платный план поддержки, вы можете создать запрос в службу технической поддержки на портале Azure. В противном случае вы можете выбрать другой вариант поддержки.

1. В главном меню на [портале Azure](https://portal.azure.com) выберите **Справка + поддержка**.

1. Из меню **поддержки** выберите **новый запрос поддержки.** Предоставьте эту информацию для вашего запроса:

   | Свойство | Значение |
   |---------|-------|
   | **Тип проблемы** | **Технические требования** |
   | **Подписка** | <*подписка на Ваш Лазурный газ*> |
   | **Служба** | В разделе **Мониторинг и управление** выберите **Планировщик**. Если вы не можете найти **Планировщик,** выберите **все службы** в первую очередь. |
   ||| 

1. Выберите нужный вариант поддержки. Если у вас есть платный план поддержки, выберите **Next**.

**Сообщество**

* [Форум Azure Logic Apps](https://social.msdn.microsoft.com/Forums/en-US/home?forum=azurelogicapps)
* [Stack Overflow](https://stackoverflow.com/questions/tagged/azure-scheduler)

## <a name="next-steps"></a>Дальнейшие действия

* [Создание регулярно выполняющихся рабочих процессов и задач с помощью Azure Logic Apps](../connectors/connectors-native-recurrence.md)