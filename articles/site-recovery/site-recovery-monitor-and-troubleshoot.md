---
title: Мониторинг службы Azure Site Recovery | Документация Майкрософт
description: Мониторинг и устранение неполадок с репликацией и операциями Azure Site Recovery с помощью портала.
author: raynew
manager: carmonm
ms.service: site-recovery
ms.topic: conceptual
ms.date: 07/30/2019
ms.author: raynew
ms.openlocfilehash: aa9d776df50306ab1705426c923413b5a5d545a5
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/27/2020
ms.locfileid: "68717348"
---
# <a name="monitor-site-recovery"></a>Мониторинг Site Recovery

В этой статье узнайте, как контролировать [восстановление сайта](site-recovery-overview.md)Azure, используя встроенный мониторинг восстановления сайта.  Вы можете контролировать:

- Здоровье и состояние машин, реплицированных на восстановление сайта
- Статус тестового отказа машин.
- Проблемы и ошибки, влияющие на конфигурацию и репликацию.
- Компоненты инфраструктуры, такие как серверы.


## <a name="before-you-start"></a>Перед началом работы

Возможно, перед началом проверки необходимо просмотреть [общие вопросы мониторинга.](monitoring-common-questions.md)

## <a name="monitor-in-the-dashboard"></a>Монитор на приборной панели

1. В хранилище нажмите **Обзор**. Панель мониторинга служб восстановления объединяет всю информацию мониторинга хранилища в одном месте. Есть страницы как для восстановления сайта, так и для службы резервного копирования Azure, и вы можете переключаться между ними.

    ![Панель мониторинга Site Recovery](./media/site-recovery-monitor-and-troubleshoot/dashboard.png)

2. С приборной панели, сверлить вниз в различных областях. 

    ![Панель мониторинга Site Recovery](./media/site-recovery-monitor-and-troubleshoot/site-recovery-overview-page.png).

3. В **реплицированных элементах**нажмите **«Просмотреть все,** чтобы просмотреть все серверы в хранилище.
4. Нажмите на сведения о состоянии в каждом разделе, чтобы сверлить вниз.
5. В **представлении инфраструктуры**сортируйте информацию мониторинга по типу машин, которые вы реплицируйте.

## <a name="monitor-replicated-items"></a>Мониторинг реплицированных элементов

В **реплицированных элементах**следите за работоспособностью всех машин в хранилище, которые включены в репликацию.

**Состояние** | **Подробно**
--- | ---
Healthy | Репликация выполняется в обычном режиме. Ошибки или предупреждения не обнаружены.
Предупреждение | Обнаружено один или несколько признаков предупреждений, которые могут повлиять на репликацию.
Critical | Обнаружено один или несколько признаков критических ошибок репликации.<br/><br/> Как правило, эти признаки ошибок указывают на то, что репликация остановлена или не выполняется с такой же скоростью, с какой изменяются данные.
Неприменимо | Серверы, которые в настоящее время не будут реплицироваться. Сюда относятся компьютеры, для которых выполнена отработка отказа.

## <a name="monitor-test-failovers"></a>Мониторинг тестовых отработок отказа

В **успехе теста Failover**следите за состоянием отказа для машин в хранилище.

- Тестовую отработку отказа на реплицированных компьютерах рекомендуется выполнять хотя бы раз в шесть месяцев. Это способ проверить, что сбой работает, как ожидалось, не нарушая вашу производственную среду. 
- Тестовая отработка отказа считается успешной только после успешной отработки отказа и успешного восстановления после сбоя.

**Состояние** | **Подробно**
--- | ---
Рекомендуется тестовая отработка отказа | Компьютеры, которые не выполняли тестовую отработку отказа с момента перехода в защищенное состояние.
Выполнено | Компьютеры, для которых тестовая отработка отказа была успешно выполнена один или несколько раз.
Неприменимо | Компьютеры, которые в настоящее время не подлежат тестовой отработке отказа. Например: компьютеры, для которых выполнена отработка отказа; компьютеры, для которых сейчас выполняется начальная репликация, тестовая или реальная отработка отказа.

## <a name="monitor-configuration-issues"></a>Мониторинг проблем с конфигурацией

В **вопросах конфигурации**следите за любыми проблемами, которые могут повлиять на вашу способность успешно перейти к сбою.

- Проблемы с конфигурацией (кроме доступности обновления программного обеспечения) определяются с помощью проверяющего элемента управления, который выполняет проверку каждые 12 часов по умолчанию. Можно принудительно выполнить операцию проверяющего элемента управления немедленно, щелкнув значок рядом с заголовком раздела **Проблемы с конфигурацией**.
- Щелкните ссылки для получения дополнительных сведений. Для проблем, влияющих на определенные машины, нажмите **требует внимания** в столбце **конфигураций Target.** Подробная информация включает рекомендации по восстановлению.

**Состояние** | **Подробно**
--- | ---
Отсутствующие конфигурации | Отсутствует необходимый параметр, например сеть восстановления или группа ресурсов.
Отсутствующие ресурсы | Указанный ресурс не найден или недоступен в подписке. Например, ресурс был удален или перенесен. К отслеживаемым ресурсам относятся: целевая группа ресурсов, целевая виртуальная сеть или подсеть, учетная запись хранения журнала или целевого объекта, целевая группа доступности, целевой IP-адрес.
Квота подписки |  Доступный баланс квоты ресурсов подписки приравнивается к балансу, который необходим для выполнения отработки отказа всех компьютеров в хранилище.<br/><br/> Если ресурсов недостаточно, сообщается о недостаточном балансе квот.<br/><br/> Квоты отслеживают число ядер виртуальных машин, число ядер семейства виртуальных машин, количество сетевых адаптеров (NIC).
Обновления программного обеспечения | Доступность новых обновлений программного обеспечения, а также данные о сроке действия версий программного обеспечения.


## <a name="monitor-errors"></a>Мониторинг ошибок

В **резюме ошибки,** мониторинг в настоящее время активные симптомы ошибки, которые могут повлиять на репликацию серверов в хранилище, и контролировать количество пострадавших машин.

- Ошибки, влияющие на компоненты инфраструктуры, отображаются в начале раздела. Например, неполучение сердцебиения от поставщика восстановления сайта Azure на сервере конфигурации на территории или хоста Hyper-V.
- Далее перечислены ошибки репликации, влияющие на реплицированные серверы.
- Записи таблицы сортируются по убыванию серьезности ошибок, а затем — по убыванию количества затронутых компьютеров.
- Количество затронутых серверов — это полезный способ понять, может ли одна основная проблема повлиять на несколько машин. Например, сбой в сети потенциально может повлиять на все машины, которые реплицируются в Azure. 
- На одном сервере может возникнуть несколько ошибок репликации. В этом случае каждая ошибка засчитывает этот сервер в список затронутых ею серверов. После устранения проблемы параметры репликации исправляются и ошибка удаляется с компьютера.

## <a name="monitor-the-infrastructure"></a>Мониторинг инфраструктуры.

В **представлении инфраструктуры**отслеживайте компоненты инфраструктуры, участвующие в репликации, и работоспособность подключения между серверами и службами Azure.

- Зеленая линия указывает на работоспособность подключения.
- Красная линия с накладной иконкой ошибки указывает на наличие одного или нескольких симптомов ошибки, влияющих на подключение.
-  Если навести указатель мыши на значок ошибки, отобразится описание ошибки и количество затронутых ею объектов. Щелкните значок, чтобы увидеть отфильтрованный список затронутых объектов.

    ![Представление инфраструктуры Site Recovery (хранилище)](./media/site-recovery-monitor-and-troubleshoot/site-recovery-vault-infra-view.png)

### <a name="tips-for-monitoring-the-infrastructure"></a>Советы по мониторингу инфраструктуры

- Убедитесь, что локальные компоненты инфраструктуры (сервер конфигурации, серверы обработки, серверы VMM, узлы Hyper-V, виртуальные машины VMware) используют последнюю версию поставщика или агентов Site Recovery.
- Чтобы использовать все функции в представлении инфраструктуры, следует запустить для этих компонентов [накопительный пакет обновления 22](https://support.microsoft.com/help/4072852).
- Чтобы использовать представление инфраструктуры, выберите соответствующий сценарий репликации в своей среде. Можно выполнить детализацию в представлении для получения дополнительных сведений. В следующей таблице показаны, какие сценарии представлены.

    **Сценарий** | **Состояние**  | **Доступно ли представление?**
    --- |--- | ---
    **Репликация между локальными сайтами** | Все состояния | нет 
    **Репликация виртуальных машин Azure между регионами Azure**  | Выполняется включенная и начальная репликация | Да
    **Репликация виртуальных машин Azure между регионами Azure** | Отработка отказа и восстановление размещения | нет   
    **Репликация VMware в Azure** | Выполняется включенная и начальная репликация | Да     
    **Репликация VMware в Azure** | Отработка отказа и восстановление размещения | нет      
    **Репликация Hyper-V в Azure** | Отработка отказа и восстановление размещения | нет

- Чтобы просмотреть представление инфраструктуры для одного реплицируемого компьютера, в меню хранилища щелкните **Реплицированные элементы** и выберите сервер.  




## <a name="monitor-recovery-plans"></a>Мониторинг планов восстановления

В **планах восстановления**следите за количеством планов, создавайте новые планы и изменяйте существующие.  

## <a name="monitor-jobs"></a>Мониторинг заданий

В **вакансиях**следите за состоянием операций восстановления сайта.

- Большинство операций в Azure Site Recovery выполняется асинхронно, при этом создается и используется задание отслеживания для мониторинга хода выполнения операции. 
- Объект задания содержит все необходимые сведения для отслеживания состояния и хода выполнения операции. 

Выполняйте мониторинг заданий следующим образом.

1. В разделе "Панель мониторинга" > **Задания** можно просмотреть сводку заданий, которые были завершены, находятся в ходе выполнения или ожидают ввода данных, за последние 24 часа. Можно щелкнуть любое состояние, чтобы получить дополнительные сведения о соответствующих заданиях.
2. Нажмите кнопку **Просмотреть все**, чтобы просмотреть все задания за последние 24 часа.

    > [!NOTE]
    > Сведения о задании можно также получить из "Меню хранилища" > **Задания Site Recovery**. 

2. В списке **Задания Site Recovery** отображается список заданий. В верхнем меню можно получить сведения об ошибке для конкретных заданий, отфильтровать список заданий на основе заданных критериев и экспортировать выбранные сведения о задании в Excel.
3. Задание можно детализировать, щелкнув его. 

## <a name="monitor-virtual-machines"></a>Мониторинг виртуальных машин

В **Реплицированных элементах**получите список реплицированных машин. 
    ![Представление списка реплицированных элементов Azure Site Recovery](./media/site-recovery-monitor-and-troubleshoot/site-recovery-virtual-machine-list-view.png)

2. Вы можете просматривать и фильтровать информацию. Вверху меню действий можно выполнить действия для определенного компьютера, включая запуск тестовой отработки отказа или просмотр конкретных ошибок.
3. Нажмите кнопку **Столбцы** для отображения дополнительных столбцов, например столбцов RPO, проблем с конфигурацией целевого объекта и ошибок репликации.
4. Щелкните **Фильтр** для просмотра сведений на основе указанных параметров, например работоспособность репликации или политика конкретной репликации.
5. Щелкните правой кнопкой мыши, чтобы запустить операции, такие как тестовая отработка отказа для компьютера или просмотр сведений о конкретной ошибке.
6. Выберите компьютер, чтобы получить дополнительные сведения о нем. Вы сможете ознакомиться со следующими сведениями.
   - **Сведения о репликации.** Текущее состояние и работоспособность компьютера.
   - **RPO** (целевая точка восстановления). Текущая целевая точка восстановления виртуальной машины и время последнего вычисления целевой точки восстановления.
   - **Точки восстановления.** Последние доступные точки восстановления компьютера.
   - **Готовность к отработке отказа.** Показывает, выполнялась ли тестовая отработка отказа для компьютера, версию агента, работающего на компьютере (для компьютеров под управлением Службы мобильности), а также проблемы с конфигурацией.
   - **Ошибки**. Список ошибок репликации, наблюдаемых на компьютере в настоящее время, а также возможные причины или действия их появления.
   - **События.** Хронологический список последних событий, влияющих на работу компьютера. Сведения об ошибке отображают текущие наблюдаемые ошибки, а события представляют собой хронологическую запись о проблемах, которые повлияли на компьютер.
   - **Представление инфраструктуры**. Показывает состояние инфраструктуры для сценария, когда происходит репликация компьютера в Azure.

     ![Сведение о реплицированном элементе Azure Site Recovery](./media/site-recovery-monitor-and-troubleshoot/site-recovery-virtual-machine-details.png)

## <a name="subscribe-to-email-notifications"></a>Подписка на уведомления по электронной почте

Вы можете подписаться на уведомления по электронной почте для следующих критических событий.
 
- Критическое состояние реплицируемого компьютера.
- Отсутствие связи между локальными компонентами инфраструктуры и службой Site Recovery. Связь между Site Recovery и локальными серверами, зарегистрированными в хранилище, определяется с помощью механизма пульса.
- Сбои отработки отказа.

Подпишитесь следующим образом.

В разделе **Monitoring** > сводков нажмите **«События восстановления сайта».**
1. Щелкните **Уведомления по электронной почте**.
1. В разделе **Уведомления по электронной почте** включите уведомления и укажите, кому отправлять сообщение. Вы можете отправлять уведомления всем администраторам подписки, а также на конкретные адреса электронной почты.

    ![Уведомления по электронной почте](./media/site-recovery-monitor-and-troubleshoot/email.png)

## <a name="next-steps"></a>Дальнейшие действия

[Узнайте о](monitor-log-analytics.md) восстановлении сайта мониторинга с помощью Azure Monitor.
