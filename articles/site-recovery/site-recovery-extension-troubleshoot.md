---
title: Устранение проблем расширения Azure VM для аварийного восстановления с восстановлением сайта Azure
description: Проблемы с устранением проблем с расширением Azure VM для аварийного восстановления с восстановлением сайта Azure.
author: sideeksh
manager: rochakm
ms.topic: troubleshooting
ms.date: 11/27/2018
ms.openlocfilehash: a780a42179a0bacf0e4a12ba1e75ae84943539b4
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/27/2020
ms.locfileid: "77190723"
---
# <a name="troubleshoot-azure-vm-extension-issues"></a>Проблемы устранения проблем Azure VM проблемы расширения

В этой статье приведены меры по устранению неполадок, которые помогут вам устранить ошибки восстановления сайта Azure, связанные с агентом VM и расширением.


## <a name="azure-site-recovery-extension-time-out"></a>Тайм-аут расширения расширения сайта Azure  

Сообщение об ошибке: "Task execution has timed out while tracking for extension operation to be started" (Истекло время ожидания выполнения задачи при отслеживании запуска операции расширения)<br>
Код ошибки: "151076"

 Azure Site Recovery установил расширение на виртуальной машине как часть задания по защите включить. Любое из следующих условий может предотвратить срабатывание защиты и привести к сбою задания. Выполните следующие шаги по устранению неполадок, а затем повторите операцию:

- [Агент установлен на виртуальной машине, но не отвечает (для виртуальных машин Windows)](#the-agent-installed-in-the-vm-but-unresponsive-for-windows-vms)
- [Устарел агент, установленный на виртуальной машине (для виртуальных машин Linux)](#the-agent-installed-in-the-vm-is-out-of-date-for-linux-vms)
- [Не удалось обновить или загрузить расширение Site Recovery](#the-site-recovery-extension-fails-to-update-or-load).

Сообщение об ошибке: "Предыдущая операция расширения восстановления сайта занимает больше времени, чем ожидалось".<br>
Код ошибки: "150066"

- [Агент установлен на виртуальной машине, но не отвечает (для виртуальных машин Windows)](#the-agent-installed-in-the-vm-but-unresponsive-for-windows-vms)
- [Устарел агент, установленный на виртуальной машине (для виртуальных машин Linux)](#the-agent-installed-in-the-vm-is-out-of-date-for-linux-vms)
- [Неправильное состояние расширения Site Recovery](#the-site-recovery-extension-fails-to-update-or-load).

## <a name="protection-fails-because-the-vm-agent-is-unresponsive"></a>Защита завершается ошибкой, так как агент виртуальной машины не отвечает

Сообщение об ошибке: "Task execution has timed out while tracking for extension operation to be started" (Истекло время ожидания выполнения задачи при отслеживании запуска операции расширения)<br>
Код ошибки: "151099"

Эта ошибка может произойти, если гостевой агент Azure в виртуальной машине не в готовом состоянии.

Проверить статус гостевого агента Azure можно на [портале Azure.](https://portal.azure.com/) Перейдите к виртуальной машине, которую вы пытаетесь защитить, и проверьте статус в**статусе** **агента VM** > **Settings** > **Properties.** >  Большую часть времени статус агента готов после перезагрузки виртуальной машины. Однако, если вы не можете перезагрузить или вы все еще сталкиваетесь с проблемой, а затем завершить следующие шаги устранения неполадок:

- [Агент установлен на виртуальной машине, но не отвечает (для виртуальных машин Windows)](#the-agent-installed-in-the-vm-but-unresponsive-for-windows-vms)
- [Устарел агент, установленный на виртуальной машине (для виртуальных машин Linux)](#the-agent-installed-in-the-vm-is-out-of-date-for-linux-vms)


Сообщение об ошибке: "Task execution has timed out while tracking for extension operation to be started" (Истекло время ожидания выполнения задачи при отслеживании запуска операции расширения)<br>
Код ошибки: "151095"

Эта ошибка возникает, когда агентская версия на машине Linux устарела. Выполнить следующий шаг по устранению неполадок:

- [Устарел агент, установленный на виртуальной машине (для виртуальных машин Linux)](#the-agent-installed-in-the-vm-is-out-of-date-for-linux-vms)  

## <a name="causes-and-solutions"></a>Причины и решения

### <a name="the-agent-is-installed-in-the-vm-but-its-unresponsive-for-windows-vms"></a><a name="the-agent-installed-in-the-vm-but-unresponsive-for-windows-vms"></a>Агент установлен на виртуальной машине, но не отвечает (для виртуальных машин Windows)

#### <a name="solution"></a>Решение
Возможно, агент виртуальной машины может быть поврежден или служба остановлена. Повторная установка агента виртуальной машины поможет получить последнюю версию и возобновить обмен данными со службой.

1. Определите, запущена ли служба гостевого агента Microsoft Azure в службах виртуальной машины (services.msc). Перезапустите службу гостевого агента Windows Azure.    
1. Если служба гостевого агента Windows Azure не отображается в службах, откройте панель управления. Перейдите к **программам и функциям,** чтобы узнать, установлена ли служба гостевого агента Windows.
1. Если гостевой агент Microsoft Azure отображается в разделе **Программы и компоненты**, удалите его.
1. Скачайте и установите [последнюю версию файла MSI агента](https://go.microsoft.com/fwlink/?LinkID=394789&clcid=0x409). Для завершения установки необходимы права администратора.
1. Убедитесь, что служба гостевого агента Windows Azure отображается в службах.
1. Перезапустите задание защиты.

Кроме того, убедитесь, что [Microsoft .NET 4.5 установлен](https://docs.microsoft.com/dotnet/framework/migration-guide/how-to-determine-which-versions-are-installed) на виртуальной машине. Для связи агента VM с сервисом необходимо .NET 4.5.

### <a name="the-agent-installed-in-the-vm-is-out-of-date-for-linux-vms"></a>Устарел агент, установленный на виртуальной машине (для виртуальных машин Linux)

#### <a name="solution"></a>Решение
Большая часть неполадок, связанных с агентом или расширением на виртуальных машинах Linux, вызваны проблемами с устаревшим агентом виртуальной машины. Чтобы устранить эту проблему, следуйте приведенным ниже общим рекомендациям.

1. Выполните указания по [обновлению агента виртуальной машины Linux ](../virtual-machines/linux/update-agent.md).

   > [!NOTE]
   > Мы *настоятельно рекомендуем* обновлять агент только посредством репозитория дистрибутивов. Мы не рекомендуем загружать код агента непосредственно с GitHub и обновлять его. Если последний агент для вашего дистрибутива недоступен, обратитесь в службу поддержки распространения для получения инструкций по его установке. Чтобы проверить наличие последней версии агента, перейдите на страницу [агента Linux для Microsoft Azure](https://github.com/Azure/WALinuxAgent/releases) в репозитории GitHub.

1. Убедитесь, что на виртуальной машине запущен агент Azure, выполнив команду `ps -e`.

   Если нужный процесс не запущен, выполните следующие команды для его перезапуска:

   - Для Ubuntu: `service walinuxagent start`.
   - Для других дистрибутивов: `service waagent start`.

1. [Налажить автоматический агент перезагрузки.](https://github.com/Azure/WALinuxAgent/wiki/Known-Issues#mitigate_agent_crash)
1. Включите защиту для виртуальной машины.

### <a name="the-site-recovery-extension-fails-to-update-or-load"></a>Не удалось обновить или загрузить расширение Site Recovery

Статус расширения отображается как "Пустой", "Неготовый" или "Переход".

#### <a name="solution"></a>Решение

Удалите расширение и перезапустите операцию.

Чтобы удалить расширение, сделайте следующее:

1. На [портале Azure](https://portal.azure.com/)перейдите на VM, который испытывает сбой резервного копирования.
1. Выберите **Параметры**.
1. Выберите **расширения.**
1. Выберите **Расширение Site Recovery**.
1. Выберите **Удалить**.

Для Linux VM, если расширение VMSnapshot не отображаются на портале Azure, [обновите Azure Linux Agent.](../virtual-machines/linux/update-agent.md) Затем запустите защиту.

Когда вы завершаете эти действия, это приводит к тому, что расширение будет переустановлено во время защиты.
