---
title: Настройка агентов безопасности
description: Узнайте, как настроить Центр безопасности Azure для агентов безопасности IoT для использования в Службе безопасности IoT.
services: asc-for-iot
ms.service: asc-for-iot
documentationcenter: na
author: mlottner
manager: rkarlin
editor: ''
ms.assetid: f95c445a-4f0d-4198-9c6c-d01446473bd0
ms.subservice: asc-for-iot
ms.devlang: na
ms.topic: conceptual
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 02/18/2020
ms.author: mlottner
ms.openlocfilehash: e41b7222ca89976674973e1eb700d62765b306f0
ms.sourcegitcommit: 7e04a51363de29322de08d2c5024d97506937a60
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81311329"
---
# <a name="tutorial-configure-security-agents"></a>Учебник: Настройка агентов безопасности

В этой статье описано, как изменять и настраивать центр безопасности Azure для агентов безопасности IoT, а также подробно описано, как их изменять и настраивать.

> [!div class="checklist"]
> * Настройка агентов безопасности
> * Изменение поведения агента путем редактирования свойств близнецов
> * Откройте для себя конфигурацию по умолчанию

## <a name="agents"></a>Агенты

Центр безопасности Azure для агентов безопасности IoT собирает данные с устройств IoT и выполняет меры безопасности для уменьшения обнаруженных уязвимостей. Конфигурация агента безопасности управляема с помощью набора двух свойств модуля, которые можно настроить. Как правило, вторичные обновления этих свойств происходят нечасто.

Центр безопасности Azure для двойного объекта конфигурации агента безопасности IoT является объектом формата JSON. Объект конфигурации представляет собой набор управляемых свойств, которые можно определить для управления поведением агента.

Эти конфигурации помогут настроить агента для каждого требуемого сценария. Например, автоматическое исключение некоторых событий или сохранение энергопотребления до минимального уровня возможно путем настройки этих свойств.

Для внесения изменений используйте Центр безопасности Azure для [схемы](https://aka.ms/iot-security-github-module-schema) конфигурации агента безопасности IoT.

## <a name="configuration-objects"></a>Объекты конфигурации

Свойства, связанные с каждым Центром безопасности Azure для агента безопасности IoT, расположены в объекте конфигурации агента, в пределах желаемого раздела свойств, модуля **azureiotsecurity.**

Чтобы изменить конфигурацию, создайте и измените этот объект внутри двойного удостоверения модуля **azureiotsecurity.**

Если объект конфигурации агента не существует в двойном модуле **azureiotsecurity,** все значения свойств агента безопасности настроены по умолчанию.

```json
"desired": {
  "ms_iotn:urn_azureiot_Security_SecurityAgentConfiguration": {
  }
}
```

## <a name="configuration-schema-and-validation"></a>Схема конфигурации и проверка

Убедитесь в том, чтобы проверить конфигурацию агента на фоне этой [схемы.](https://aka.ms/iot-security-github-module-schema) Агент не запускается, если объект конфигурации не соответствует схеме.

Если во время работы агента объект конфигурации изменяется на недействительную конфигурацию (конфигурация не соответствует схеме), агент проигнорирует недействительную конфигурацию и продолжит использовать текущую конфигурацию.

### <a name="configuration-validation"></a>Проверка конфигурации

Центр безопасности Azure для агента безопасности IoT сообщает о текущей конфигурации внутри сообщаемого раздела свойств двойного удостоверения модуля **azureiotsecurity.**
Агент сообщает обо всех доступных свойствах, если свойство не было установлено пользователем, агент сообщает конфигурацию по умолчанию.

Чтобы проверить конфигурацию, сравните значения, установленные на нужном разделе, с значениями, представленными в сообщенном разделе.

Если есть несоответствие между желаемым и зарегистрированным свойствами, то агент не смог разобрать конфигурацию.

Проверьте желаемые свойства [на](https://aka.ms/iot-security-github-module-schema)схеме, исправить ошибки и установить желаемые свойства снова!

> [!NOTE]
> Предупреждение об ошибке конфигурации будет уволено из агента в случае, если агент не смог разобрать нужную конфигурацию.
> Сравните отчетный и желаемый раздел, чтобы понять, применяется ли оповещение

## <a name="editing-a-property"></a>Редактирование свойства

Все пользовательские свойства должны быть установлены внутри объекта конфигурации агента в двойном модуле **azureiotsecurity.**
Чтобы использовать значение свойства по умолчанию, удалите свойство из объекта конфигурации.

### <a name="setting-a-property"></a>Установка свойства

1. В концентраторе IoT найдите и выберите устройство, которое вы хотите изменить.

1. Нажмите на устройство, а затем на модуль **azureiotsecurity.**

1. Нажмите на **Модуль Identity Twin**.

1. Отспособите свойства, которые вы хотите изменить в модуле безопасности.

   Например, для настройки событий соединения в качестве приоритетных и сбора событий с высоким приоритетом каждые 7 минут используйте следующую конфигурацию.

    ```json
    "desired": {
        "ms_iotn:urn_azureiot_Security_SecurityAgentConfiguration": {
            "highPriorityMessageFrequency": {
                "value": "PT7M"
            },
            "eventPriorityConnectionCreate": {
                "value": "High"
            }
        }
    }
    ```

1. Выберите команду **Сохранить**.

### <a name="using-a-default-value"></a>Использование значения по умолчанию

Чтобы использовать значение свойства по умолчанию, удалите свойство из объекта конфигурации.

## <a name="default-properties"></a>Свойства по умолчанию

В следующей таблице содержатся управляемые свойства Центра безопасности Azure для агентов безопасности IoT.

Значения по умолчанию доступны в надлежащей схеме в [GitHub](https\://aka.ms/iot-security-module-default).

| Имя| Состояние | Допустимые значения| Значения по умолчанию| Описание |
|----------|------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------|---------------|
|highPriorityMessageЧастота|Требуется: ложный |Действительные значения: Продолжительность в формате ISO 8601 |Значение по умолчанию: PT7M |Максимальный интервал времени перед отправкой сообщений с высоким приоритетом.|
|lowPriorityMessageЧастота |Требуется: ложный|Действительные значения: Продолжительность в формате ISO 8601 |Значение по умолчанию: PT5H |Максимальное время до отправки сообщений с низким приоритетом.|
|снимокЧастотаЧастота |Требуется: ложно|Действительные значения: Продолжительность в формате ISO 8601 |Значение по умолчанию PT13H |Интервал времени для создания моментальных снимков состояния устройства.|
|maxLocalCacheSizeInBytes |Требуется: ложный |Допустимые значения: |Значение по умолчанию: 2560000, больше, чем 8192 | Максимальное хранение (в байтах) допускается для кэша сообщений агента. Максимальное количество места позволяет хранить сообщения на устройстве до отправки сообщений.|
|maxMessageSizeInBytes |Требуется: ложный |Действительные значения: положительное число, больше 8192, меньше, чем 262144 |Значение по умолчанию: 204800 |Максимально допустимый размер агента для облачного сообщения. Эта настройка контролирует максимальное количество данных, отправленных в каждом сообщении. |
|eventPriority.»EventName |Требуется: ложный |Допустимые значения: высокие, низкие, выключенные |Значения по умолчанию: |Приоритет каждого события, генерируемого агентом |

### <a name="supported-security-events"></a>Поддерживаемые события безопасности

|Имя события| PropertyName | Значение по умолчанию| Событие моментального снимка| Статус детали  |
|----------|------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------|---------------|
|Диагностическое мероприятие|eventPriorityДиагностика| Выкл.| False| Связанные с агентом диагностические события. Используйте это событие для многословной регистрации.|
|Ошибка конфигурации |eventPriorityConfigurationError |Низкий |False |Агент не смог разобрать конфигурацию. Проверьте конфигурацию по схеме.|
|Статистика выпавших событий |eventPriorityDroppedEventsСтатистика |Низкий |True|Статистика связанных с агентом событий. |
|Подключенное оборудование|eventPriorityConnectedHardware |Низкий |True |Снимок всего оборудования, подключенного к устройству.|
|Ожидание передачи данных через порты|eventPriorityListeningPorts |Высокий |True |Снимок всех открытых портов прослушивания на устройстве.|
|Создание процесса |eventPriorityProcessСоздать |Низкий |False |Аудит процесса создания на устройстве.|
|Процесс завершается|eventPriorityProcessTerminate |Низкий |False |Аудит процесса прекращения на устройстве.|
|Сведения о системе |eventPrioritySystemInformation |Низкий |True |Снимок системной информации (например: ОС или процессор).|
|Местные пользователи| eventPriorityLocalUsers |Высокий |True|Снимок зарегистрированных местных пользователей в системе. |
|Имя входа|  eventPriorityLogin |Высокий|False|Аудит событий входа на устройство (местные и удаленные логины).|
|Создание соединения |eventPriorityConnectionСоздать|Низкий|False|Аудит tCP соединений, созданных на устройстве и из устройства. |
|Конфигурация брандмауэра| eventPriorityFirewallConfiguration|Низкий|True|Снимок конфигурации брандмауэра устройства (правила брандмауэра). |
|Базовый униза ОС| eventPriorityOSBaseline| Низкий|True|Снимок базовой проверки оС устройства.|
|

## <a name="next-steps"></a>Следующие шаги

- [Понимание рекомендаций Центра безопасности Azure для рекомендаций IoT](concept-recommendations.md)
- [Исследуйте Центр безопасности Azure для оповещений IoT](concept-security-alerts.md)
- [Доступ к необработанным данным безопасности](how-to-security-data-access.md)
