---
title: Агрегация событий
description: Узнайте об агрегировании событий Azure Security Center для агрегирования событий IoT.
services: asc-for-iot
ms.service: asc-for-iot
documentationcenter: na
author: mlottner
manager: rkarlin
editor: ''
ms.assetid: d40dac0b-abd0-4ff5-82eb-0f511ee13725
ms.subservice: asc-for-iot
ms.devlang: na
ms.topic: conceptual
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 09/26/2019
ms.author: mlottner
ms.openlocfilehash: f72ef8cc5161bd6f885249e7d39344a57fa2368e
ms.sourcegitcommit: 7e04a51363de29322de08d2c5024d97506937a60
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81311414"
---
# <a name="azure-security-center-for-iot-event-aggregation"></a>Центр безопасности Azure для агрегации событий IoT

Центр безопасности Azure для агентов безопасности IoT собирает данные и системные события с локального устройства и отправляет эти данные в облако Azure для обработки и аналитики. Агент безопасности собирает множество типов событий устройства, включая новый процесс и новые события соединения. Как новый процесс, так и новые события соединения могут часто возникать на устройстве в течение секунды, и, хотя это важно для надежной и всеобъемлющей безопасности, количество сообщений, которые агенты безопасности вынуждены отправлять, может быстро достичь или превысить квоту IoT Hub и лимиты затрат. Тем не менее, эти события содержат очень ценную информацию о безопасности, которая имеет решающее значение для защиты вашего устройства.

Чтобы уменьшить дополнительные квоты и затраты при сохранении защиты устройств, Центр безопасности Azure для IoT-агентов агрегирует эти типы событий.

Агрегация событий **включена** по умолчанию, и, хотя это и не рекомендуется, может быть **выключается** вручную в любое время.

Агрегация в настоящее время доступна для следующих типов событий:

* ProcessСоздать
* ПодключениеСоздать
* ProcessTerminate (только Windows)

## <a name="how-does-event-aggregation-work"></a>Как работает агрегация событий?

При оставлении агрегации событий **центр**безопасности Azure для агентов IoT агрегирует события для интервального периода или временного окна.
После завершения периода интервала агент отправляет агрегированные события в облако Azure для дальнейшего анализа.
Агрегированные события сохраняются в памяти до отправки в облако Azure.

Чтобы уменьшить след памяти агента, всякий раз, когда агент собирает идентичное событие, которое уже хранится в памяти, агент увеличивает количество попадания этого конкретного события. Когда окно времени агрегации проходит, агент отправляет количество попадания каждого конкретного типа события, которое произошло. Агрегация событий — это просто агрегация количества попаданий каждого собранного типа события.

События считаются идентичными только при соблюдении следующих условий:

* События ProcessCreate - когда **командная линия,** **исполняемая,** **пользовательское имя**и **userid** идентичны
* События ConnectionCreate - когда **командная линия,** **userId,** **направление,** **локальный адрес,** **удаленный адрес,** протокол и **порт назначения** идентичны
* События ProcessTerminate - когда **исполняемый** и **статус выхода** идентичны

### <a name="working-with-aggregated-events"></a>Работа с агрегированными событиями

Во время агрегирования свойства событий, которые не агрегируются, отбрасываются и отображаются в аналитике журналов со значением 0.

* ProcessCreate события - **processId,** и **parentProcessId** настроены на 0
* События ConnectionCreate - **processId**и **исходный порт** настроены на 0

## <a name="event-aggregation-based-alerts"></a>Оповещения об агрегации событий

После анализа Центр безопасности Azure для IoT создает оповещения о безопасности подозрительных агрегированных событий. Оповещения, созданные из агрегированных событий, появляются только один раз для каждого агрегированного события.

Время начала агрегации, время окончания и количество хитов для каждого события регистрируются в поле **ExtraDetails** в журнале Analytics для использования во время исследований.

Каждое агрегированное событие представляет собой 24-часовой период собранных оповещений. Используя меню параметров событий в левом верхнем углу каждого события, вы можете **отклонить** каждое отдельное агрегированное событие.

## <a name="event-aggregation-twin-configuration"></a>Двойная конфигурация агрегации событий

Вносить изменения в конфигурацию Центра безопасности Azure для агрегирования событий IoT внутри [объекта конфигурации агента](how-to-agent-configuration.md) двойного удостоверения модуля **azureiotsecurity.**

| Имя конфигурации | Возможные значения | Сведения | Remarks |
|:-----------|:---------------|:--------|:--------|
| агрегацияEnabledProcessСоздать | Логическое | Включить / отключить агрегацию событий для создания процесса |
| агрегацияIntervalProcessСоздать | Строка ISO8601 Timespan | Интервал агрегации для создания процесса событий |
| агрегацияEnabledConnectionСоздать | Логическое| Включить / отключить агрегацию событий для создания соединения событий |
| агрегатацияIntervalConnectionСоздать | Строка ISO8601 Timespan | Интервал агрегации для создания соединения событий |
| агрегацияEnabledProcessTerminate | Логическое | Включить / отключить агрегацию событий для событий завершения процесса | Только Windows|
| агрегатированиеIntervalProcessTerminate | Строка ISO8601 Timespan | Интервал агрегации для событий завершения процесса | Только Windows|
|

## <a name="default-configurations-settings"></a>Настройки конфигураций по умолчанию

| Имя конфигурации | Значения по умолчанию |
|:-----------|:---------------|
| агрегацияEnabledProcessСоздать | true |
| агрегацияIntervalProcessСоздать | "PT1H"|
| агрегацияEnabledConnectionСоздать | true |
| агрегатацияIntervalConnectionСоздать | "PT1H"|
| агрегацияEnabledProcessTerminate | true |
| агрегатированиеIntervalProcessTerminate | "PT1H"|
|

## <a name="next-steps"></a>Следующие шаги

В этой статье вы узнали об агрегации агентов безопасности Azure Security Center для агрегации агентов безопасности IoT и доступных вариантах конфигурации событий.

Чтобы продолжить работу с Центром безопасности Azure для развертывания IoT, используйте следующие статьи:

- Понимание [методов проверки подлинности агента безопасности](concept-security-agent-authentication-methods.md)
- Выберите и развернуть [агента безопасности](how-to-deploy-agent.md)
- Просмотрите [предпосылки службы](service-prerequisites.md) безопасности Azure для службы IoT
- Узнайте, как [включить Центр безопасности Azure для обслуживания IoT в вашем концентраторе IoT](quickstart-onboard-iot-hub.md)
- Узнайте больше об службе в [Центре безопасности Azure для часто задаваемых вопросов IoT](resources-frequently-asked-questions.md)
