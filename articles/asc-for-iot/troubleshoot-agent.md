---
title: Центр безопасности Azure для IoT Linux службы безопасности агента по устранению неполадок руководства Документы Майкрософт
description: Устранение проблем с Центром безопасности Azure для агентов безопасности IoT для Linux.
services: asc-for-iot
ms.service: asc-for-iot
documentationcenter: na
author: mlottner
manager: rkarlin
editor: ''
ms.assetid: 55c8d3b6-3126-4246-8d07-ef88fe5ea84f
ms.subservice: asc-for-iot
ms.devlang: na
ms.topic: conceptual
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 07/25/2019
ms.author: mlottner
ms.openlocfilehash: 7f3bd4be3ef927f73643146a457bc551ef86a450
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/27/2020
ms.locfileid: "68600570"
---
# <a name="security-agent-troubleshoot-guide-linux"></a>Инструкции по устранению неполадок с агентом безопасности (Linux)

В этой статье объясняется, как решить потенциальные проблемы в процессе запуска агента безопасности.

Центр безопасности Azure для самозачета агента IoT сразу после установки. Процесс запуска агента включает чтение локальной конфигурации, подключение к концентратору Azure IoT и получение удаленной двойной конфигурации. Сбой в любом из этих шагов может привести к сбою агента безопасности.

В этом руководстве по устранению неполадок вы узнаете, как:
> [!div class="checklist"]
> * Проверка, если агент безопасности работает
> * Получайте ошибки агента безопасности
> * Понимание и устранение ошибок агента безопасности 

## <a name="validate-if-the-security-agent-is-running"></a>Проверка, если агент безопасности работает

1. Для проверки выполняется работа агента безопасности, подождите несколько минут после установки агента и запустите следующую команду. 
     <br>

    **C агент**
    ```bash
    grep "ASC for IoT Agent initialized" /var/log/syslog
    ```
    **Агент СИ**
    ```bash
    grep "Agent is initialized!" /var/log/syslog
    ```
2. Если команда возвращает пустую строку, агент безопасности не смог успешно начать.    

## <a name="force-stop-the-security-agent"></a>Сила остановить агента безопасности 
В тех случаях, когда агент безопасности не может начать, остановите агента со следующей командой, затем перейдите к таблице ошибок ниже:

```bash
systemctl stop ASCIoTAgent.service
```
## <a name="get-security-agent-errors"></a>Получайте ошибки агента безопасности
1. Retrieve security agent error (s) путем выполнения следующей команды:
    ```bash
    grep ASCIoTAgent /var/log/syslog
    ```
2. Команда ошибки агента безопасности извлекает все журналы, созданные Центром безопасности Azure для агента IoT. Используйте следующую таблицу, чтобы понять ошибки и принять правильные шаги для исправления. 

> [!Note]
> Ошибки журналы отображаются в хронологическом порядке. Убедитесь в том, чтобы отметить отметку времени каждой ошибки, чтобы помочь вашей исправления. 

## <a name="restart-the-agent"></a>Перезапуск агента

1. После обнаружения и исправления ошибки агента безопасности, попробуйте перезапустить агента, запустив следующую команду. 
    ```bash
    systemctl restart ASCIoTAgent.service
    ```
1. Повторите предыдущий процесс, чтобы восстановить стоп и получить ошибки, если агент продолжает провалить процесс запуска. 

## <a name="understand-security-agent-errors"></a>Понимание ошибок агента безопасности

Большинство ошибок агента безопасности отображаются в следующем формате: 
```
Azure Security Center for IoT agent encountered an error! Error in: {Error Code}, reason: {Error sub code}, extra details: {error specific details}
```
| Код ошибки | Код подошибки | Сведения об ошибке | Восстановители C | Восстановители C # |
|:-----------|:---------------|:--------|:------------|:------------|
| Локальная конфигурация | Отсутствует конфигурация | Конфигурация отсутствует в файле локальной конфигурации. Сообщение об ошибке должно указать, какой ключ отсутствует. | Добавьте недостающий ключ в файл /var/LocalConfiguration.json, [см.](azure-iot-security-local-configuration-c.md)| Добавьте недостающий ключ в файл [c#-localconfig-reference](azure-iot-security-local-configuration-csharp.md) General.config, см. |
| Локальная конфигурация | Конфигурация Кант Парс | Значение конфигурации не может быть разогнано. Сообщение об ошибке должно указать, какой ключ нельзя разобрать. Значение конфигурации не может быть разобрано либо потому, что значение не находится в ожидаемом типе, либо значение находится вне диапазона. | Исправьте значение ключа в файле /var/LocalConfiguration.json, чтобы он соответствовал [c#-localconfig-reference](azure-iot-security-local-configuration-csharp.md) схеме LocalConfiguration, см. |  Исправьте значение ключа в файле General.config так, чтобы он соответствовал схеме, см. [cs-localconfig-ссылку](azure-iot-security-local-configuration-c.md) для деталей.|
| Локальная конфигурация | Формат файла | Не удалось разобрать файл конфигурации. | Файл конфигурации поврежден, загрузите агента и переустановите. | |
| Удаленная конфигурация | Время ожидания | Агент не смог получить двойной модуль azureiotsecurity в течение периода тайм-аута. | Убедитесь, что конфигурация аутентификации верна, и повторите попытку. | Агент не смог получить двойной модуль azureiotsecurity в течение периода тайм-аута. | Убедитесь, что конфигурация аутентификации верна, и повторите попытку. |
| Проверка подлинности | Файл не существует | Файл в данном пути не существует. | Убедитесь, что файл существует в данном пути или перейдите в файл **LocalConfiguration.json** и измените конфигурацию **FilePath.** | Убедитесь, что файл существует в данном пути или перейдите в файл **Authentication.config** и измените конфигурацию **filePath.**|
| Проверка подлинности | Разрешение на файл | Агент не имеет достаточного разрешения на открытие файла. | Дайте пользователю **asciotagent** читать разрешения на файл в данном пути. | Убедитесь, что файл доступен. |
| Проверка подлинности | Формат файла | Данный файл не находится в правильном формате. | Убедитесь, что файл находится в правильном формате. Поддерживаемые типы файлов : .pfx и .pem. | Убедитесь, что файл является действительным файлом сертификата. |
| Проверка подлинности | Не авторизовано | Агент не смог проверить подлинность против IoT Hub с данными учетными данными. | Проверка конфигурации проверки подлинности в файле LocalConfiguration, пройти через конфигурацию проверки подлинности и убедиться, что все детали верны, проверить, что секрет в файле соответствует подлинной идентификации. | Проверка конфигурации проверки подлинности в Authentication.config, пройдите конфигурацию аутентификации и убедитесь, что все детали верны, а затем проверить, что секрет в файле соответствует подлинной идентификации.
| Проверка подлинности | Не найдено | Устройство / модуль был найден. | Проверка конфигурации проверки подлинности - убедитесь, что имя хоста правильно, устройство существует в Концентраторе IoT и имеет двойной модуль azureiotsecurity. |  Проверка конфигурации проверки подлинности - убедитесь, что имя хоста правильно, устройство существует в Концентраторе IoT и имеет двойной модуль azureiotsecurity. |
| Проверка подлинности | Отсутствует конфигурация | Конфигурация отсутствует в файле *Authentication.config.* Сообщение об ошибке должно указать, какой ключ отсутствует. | Добавьте недостающий ключ в файл *LocalConfiguration.json.*| Добавьте недостающий ключ в файл *Authentication.config,* см. [c#-localconfig-reference](azure-iot-security-local-configuration-csharp.md) |
| Проверка подлинности | Конфигурация Кант Парс | Значение конфигурации не может быть разогнано. Сообщение об ошибке должно указать, какой ключ нельзя разобрать. Значение конфигурации нельзя разогнать, поскольку либо значение не является ожидаемым типом, либо значение находится вне диапазона. |Исправьте значение ключа в файле **LocalConfiguration.json.** |Исправьте значение ключа в файле **Authentication.config** в соответствии с схемой, [см.](azure-iot-security-local-configuration-c.md)|
|

## <a name="restart-the-agent"></a>Перезапуск агента
1. После обнаружения и исправления ошибки агента безопасности перезапустите агента, запустив следующую команду:

    ```bash
    systemctl restart ASCIoTAgent.service
    ```
2. При необходимости повторите предыдущие процессы, чтобы заставить остановить агента и извлечь ошибки, если агент продолжает провалить процесс запуска. 

## <a name="next-steps"></a>Дальнейшие действия
- Прочтите [обзор](overview.md) службы безопасности Azure для обслуживания IoT
- Узнайте больше о Центре безопасности Azure для [IoT-архитектуры](architecture.md)
- Включить Центр безопасности Azure для [службы](quickstart-onboard-iot-hub.md) IoT
- Прочтите Центр безопасности Azure для [часто задаваемых вопросов](resources-frequently-asked-questions.md) ioT
- Узнайте, как получить доступ к [необработанным данным безопасности](how-to-security-data-access.md).
- Общие сведения о [рекомендациях](concept-recommendations.md).
- Понимание [предупреждений безопасности](concept-security-alerts.md)
