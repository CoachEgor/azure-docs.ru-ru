---
title: Метрики в Azure Monitor — Центры событий Azure | Документация Майкрософт
description: В этой статье описывается, как использовать приложение Azure Monitor для мониторинга Центров событий Azure.
services: event-hubs
documentationcenter: .NET
author: ShubhaVijayasarathy
manager: timlt
editor: ''
ms.assetid: ''
ms.service: event-hubs
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.custom: seodec18
ms.date: 09/18/2019
ms.author: shvija
ms.openlocfilehash: 96c346f4359740fda5638dfdbe5735c5bdfce8c9
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/27/2020
ms.locfileid: "77162656"
---
# <a name="azure-event-hubs-metrics-in-azure-monitor"></a>Метрики Центров событий Azure в Azure Monitor

Метрики концентраторов событий дают вам состояние ресурсов концентраторов событий в подписке Azure. Используя обширный набор данных метрик, можно оценить общую работоспособность концентраторов событий не только на уровне пространства имен, но также и на уровне сущности. Эти статистические данные могут быть важны, так как они позволяют отслеживать состояние концентраторов событий. Кроме того, метрики могут помочь в устранении первопричин проблем без необходимости обращения в службу поддержки Azure.

Azure Monitor предоставляет унифицированный пользовательский интерфейс для мониторинга различных служб Azure. Дополнительные сведения см. в разделе [Обзор мониторинга в Microsoft Azure](../monitoring-and-diagnostics/monitoring-overview.md). Ознакомьтесь также с примером [получения данных метрик Azure Monitor с помощью .NET](https://github.com/Azure-Samples/monitor-dotnet-metrics-api) на сайте GitHub.

## <a name="access-metrics"></a>Доступ к метрикам

Azure Monitor предоставляет несколько способов доступа к метрикам. Вы можете использовать [портал Azure](https://portal.azure.com), интерфейсы API Azure Monitor (REST и .NET), а также решения для анализа, например Log Analytics и Центры событий. Дополнительные сведения см. в разделе [Мониторинг данных, собранных Azure Monitor](../azure-monitor/platform/data-platform.md).

Метрики включены по умолчанию, и вы можете получить доступ к данным за последние 30 дней. Если необходимо хранить данные метрик в течение длительного периода времени, вы можете архивировать их в учетную запись хранения Azure. Для настройки используйте [параметры диагностики](../azure-monitor/platform/diagnostic-settings.md) в Azure Monitor.


## <a name="access-metrics-in-the-portal"></a>Доступ к метрикам на портале

На [портале Azure](https://portal.azure.com) можно отслеживать метрики в течение продолжительного периода времени. В приведенном ниже примере показано, как просмотреть успешные запросы и входящие запросы на уровне учетной записи.

![Просмотр метрик успешного выполнения][1]

Можно также открыть метрики непосредственно с помощью пространства имен. Для этого выберите пространство имен, а затем нажмите **Metrics.** Чтобы отобразить метрики, отфильтрованные по концентратору событий, выберите концентратор событий и щелкните **Метрики**.

Для метрик с поддержкой измерений необходимо выполнить фильтрацию по нужному значению измерения, как показано в примере ниже.

![Фильтрация по значению измерения][2]

## <a name="billing"></a>Выставление счетов

Использование метрик в Azure Monitor пока бесплатно. Тем не менее, если вы используете дополнительные решения для приема данных метрик, за использование этих решений может взиматься плата. Например, при архивации данных метрик в учетную запись хранения Azure плата будет взиматься службой хранилища Azure, Вам также выставляется счет Azure, если вы транслируете данные метрик в журналы Azure Monitor для расширенного анализа.

Приведенные ниже метрики позволяют получить общие сведения о работоспособности службы. 

> [!NOTE]
> Несколько метрик стали неподдерживаемыми, так как теперь они доступны под другим именем. Это может потребовать обновления ссылок. Метрики, помеченные ключевым словом "нерекомендуемая", больше не будут поддерживаться.

Все значения метрик ежеминутно отправляются в Azure Monitor. Степень детализации определяет интервал времени, за который представлены значения метрик. Поддерживаемый интервал времени для всех метрик Центров событий составляет 1 минуту.

## <a name="request-metrics"></a>Метрики запросов

Подсчитывают объем данных и количество запросов операций управления.

| Имя метрики | Описание |
| ------------------- | ----------------- |
| Входящих запросов  | Число запросов к службе Центров событий Azure за указанный период. <br/><br/> Единица измерения: число <br/> Тип агрегирования: итог <br/> Измерение: EntityName. |
| Выполненные запросы    | Число успешных запросов к службе Центров событий Azure за указанный период. <br/><br/> Единица измерения: число <br/> Тип агрегирования: итог <br/> Измерение: EntityName. |
| Server Errors  | Число запросов, которые не были обработаны из-за ошибки в службе Центров событий Azure, за указанный период. <br/><br/>Единица измерения: число <br/> Тип агрегирования: итог <br/> Измерение: EntityName. |
|Ошибки пользователей |Количество запросов, не обработанных из-за ошибки пользователя, за указанный период.<br/><br/> Единица измерения: число <br/> Тип агрегирования: итог <br/> Измерение: EntityName.|
|Квота превысила ошибки |Количество запросов, превысивших доступную квоту. Дополнительные сведения о квотах Центров событий см. в [этой статье](event-hubs-quotas.md).<br/><br/> Единица измерения: число <br/> Тип агрегирования: итог <br/> Измерение: EntityName.|

## <a name="throughput-metrics"></a>Метрики пропускной способности

| Имя метрики | Описание |
| ------------------- | ----------------- |
|Застывные запросы |Число запросов, которые были отрегулированы из-за превышения квоты единиц пропускной способности.<br/><br/> Единица измерения: число <br/> Тип агрегирования: итог <br/> Измерение: EntityName.|

## <a name="message-metrics"></a>Метрики использования

| Имя метрики | Описание |
| ------------------- | ----------------- |
|Входящие сообщения |Количество событий или сообщений, отправленных в Центры событий, за указанный период.<br/><br/> Единица измерения: число <br/> Тип агрегирования: итог <br/> Измерение: EntityName.|
|Исходящие сообщения |Количество событий или сообщений, полученных из Центров событий, за указанный период.<br/><br/> Единица измерения: число <br/> Тип агрегирования: итог <br/> Измерение: EntityName.|
|Входящие байты |Число байтов, переданных в службу Центров событий Azure, за указанный период.<br/><br/> Единица измерения: байт <br/> Тип агрегирования: итог <br/> Измерение: EntityName.|
|Исходящие байты |Число байтов, полученных от службы Центров событий Azure, за указанный период.<br/><br/> Единица измерения: байт <br/> Тип агрегирования: итог <br/> Измерение: EntityName.|

## <a name="connection-metrics"></a>Метрики подключения

| Имя метрики | Описание |
| ------------------- | ----------------- |
|ActiveConnections |Число активных подключений для пространства имен, а также для сущности.<br/><br/> Единица измерения: число <br/> Тип агрегирования: итог <br/> Измерение: EntityName.|
|Открытые соединения |Число открытых подключений.<br/><br/> Единица измерения: число <br/> Тип агрегирования: итог <br/> Измерение: EntityName.|
|Соединения закрыты |Число закрытых подключений.<br/><br/> Единица измерения: число <br/> Тип агрегирования: итог <br/> Измерение: EntityName.|

## <a name="event-hubs-capture-metrics"></a>Метрики функции "Сбор" в Центрах событий

Можно отслеживать метрики функции "Сбор" в Центрах событий, если для ваших концентраторов событий включена эта функция. Приведенные ниже метрики описывают возможности отслеживания с помощью функции записи.

| Имя метрики | Описание |
| ------------------- | ----------------- |
|Захват невыполненной работы |Число байтов, которые будут записаны в выбранное назначение.<br/><br/> Единица измерения: байт <br/> Тип агрегирования: итог <br/> Измерение: EntityName.|
|Захваченные сообщения |Число сообщений или событий, записанных в выбранное назначение, за указанный период.<br/><br/> Единица измерения: число <br/> Тип агрегирования: итог <br/> Измерение: EntityName.|
|Захваченные байты |Число байтов, записанных в выбранное назначение, за указанный период.<br/><br/> Единица измерения: байт <br/> Тип агрегирования: итог <br/> Измерение: EntityName.|

## <a name="metrics-dimensions"></a>Измерения метрик

Центры событий Azure поддерживают следующие измерения метрик в Azure Monitor. Добавление измерений для метрик является необязательным. Если не добавить измерения, то метрики указываются на уровне пространства имен. 

| Имя метрики | Описание |
| ------------------- | ----------------- |
|EntityName| Центры событий поддерживают сущности концентраторов событий в пространстве имен.|

## <a name="azure-monitor-integration-with-siem-tools"></a>Интеграция Azure Monitor с помощью инструментов SIEM
Перекачание данных мониторинга (журналы активности, журналы диагностики и т.д.) в концентратор событий с помощью Azure Monitor позволяет легко интегрироваться с инструментами управления безопасностью и событиями (SIEM). Для получения дополнительной информации, см следующие статьи / блог сообщения:

- [Потоковая передача данных мониторинга Azure в концентратор событий для потребления внешним инструментом](../azure-monitor/platform/stream-monitoring-data-event-hubs.md)
- [Общие сведения о службе "Интеграция журналов данных Azure"](../security/fundamentals/azure-log-integration-overview.md)
- [Интеграция с инструментами SIEM с использованием Azure Monitor](https://azure.microsoft.com/blog/use-azure-monitor-to-integrate-with-siem-tools/)

В сценарии, когда инструмент SIEM потребляет данные журнала из концентратора событий, если вы не видите входящих сообщений или не видите входящих сообщений, но нет исходящих сообщений в графике метрик, выполните следующие действия:

- Если **нет входящих сообщений,** это означает, что служба Azure Monitor не перемещает журналы аудита/диагностики в концентратор событий. В этом сценарии откройте билет поддержки с командой Azure Monitor. 
- если есть входящие сообщения, но **нет исходящих сообщений,** это означает, что приложение SIEM не читает сообщения. Обратитесь к поставщику SIEM, чтобы определить, является ли конфигурация концентратора событий эти приложения правильной.


## <a name="next-steps"></a>Дальнейшие действия

* Ознакомьтесь с разделом [Обзор мониторинга в Microsoft Azure](../monitoring-and-diagnostics/monitoring-overview.md).
* Изучите пример [получения данных метрик Azure Monitor с помощью .NET](https://github.com/Azure-Samples/monitor-dotnet-metrics-api) на сайте GitHub. 

Дополнительные сведения о Центрах событий см. по следующим ссылкам:

- Начните работу с руководства по Центрам событий
    - [.NET Core](get-started-dotnet-standard-send-v2.md)
    - [Java](get-started-java-send-v2.md)
    - [Python](get-started-python-send-v2.md)
    - [Javascript](get-started-java-send-v2.md)
* [Центры событий: часто задаваемые вопросы](event-hubs-faq.md)
* [Примеры приложений, использующих Центры событий](https://github.com/Azure/azure-event-hubs/tree/master/samples)

[1]: ./media/event-hubs-metrics-azure-monitor/event-hubs-monitor1.png
[2]: ./media/event-hubs-metrics-azure-monitor/event-hubs-monitor2.png



