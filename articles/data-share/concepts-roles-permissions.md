---
title: Роли и требования для общей папки данных Azure
description: Сведения о ролях контроля доступа и требованиях к поставщикам данных и потребителям данных для предоставления общего доступа к данным в общем ресурсе данных Azure.
author: joannapea
ms.author: joanpo
ms.service: data-share
ms.topic: conceptual
ms.date: 07/10/2019
ms.openlocfilehash: 34c73a6bd400da076c68f308a2100a0f4569bd04
ms.sourcegitcommit: c22327552d62f88aeaa321189f9b9a631525027c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/04/2019
ms.locfileid: "73490575"
---
# <a name="roles-and-requirements-for-azure-data-share"></a>Роли и требования для общей папки данных Azure 

В этой статье описываются роли, необходимые для обмена данными с помощью общего ресурса Azure, а также прием и получение данных с помощью общего ресурса данных Azure. 

## <a name="roles-and-requirements"></a>Роли и требования

Azure Data Share использует управляемые удостоверения для служб Azure (ранее известные как MSI) для проверки подлинности в базовых учетных записях хранения, чтобы иметь возможность считывать данные, совместно используемые поставщиком данных, а также получать данные, совместно используемые в качестве потребителя данных. В результате нет необходимости в обмене учетными данными между поставщиком данных и потребителем данных. 

Управляемое удостоверение службы должен быть предоставлен доступ к базовой учетной записи хранения или базе данных SQL. Для чтения и записи данных служба общего доступа к данным Azure использует Управляемое удостоверение службы ресурсов общего ресурса Azure. Пользователю общей папки данных Azure требуется возможность создания назначения ролей для Управляемое удостоверение службы учетной записи хранения или базе данных SQL, от которой они совместно используют данные. 

В случае хранилища разрешение на создание назначений ролей существует в роли **владельца** , в роли администратора доступа пользователей или в пользовательской роли с помощью Microsoft. Authorization, назначение ролей или разрешение на запись. 

Если вы не являетесь владельцем учетной записи хранения и вам не удается создать назначение роли для управляемого удостоверения ресурса Azure Data Share, вы можете запросить администратора Azure создать назначение роли от вашего имени. 

Ниже приведена сводка ролей, назначенных для совместного использования управляемыми ресурсами удостоверения.

| |  |  |
|---|---|---|
|**Тип хранилища**|**Хранилище поставщика данных**|**Целевое хранилище потребителя данных**|
|Хранилище больших двоичных объектов Azure| Модуль чтения данных BLOB-объекта хранилища | Участник данных BLOB-объекта хранилища
|Azure Data Lake Gen1 | Владелец | Не поддерживается
|Azure Data Lake Gen2 | Модуль чтения данных BLOB-объекта хранилища | Участник данных BLOB-объекта хранилища
|Azure SQL | dbo | dbo 
|

### <a name="data-providers"></a>Поставщики данных 
Чтобы добавить набор данных к общему ресурсу данных Azure, необходимо добавить в роль модуля чтения BLOB-объектов хранилища данные поставщиков данных, которые используют управляемый ресурс. Это выполняется автоматически службой общих ресурсов Azure, если пользователь добавляет наборы данных через Azure и является владельцем учетной записи хранения или является членом пользовательской роли, которой назначены разрешения Microsoft. Authorization/Role/Write. 

Кроме того, у пользователя может быть администратор Azure, добавляющий удостоверение, управляемое ресурсом, в роль читателя данных BLOB-объекта хранилища вручную. Создание этого назначения роли вручную может быть недействительным владельцем учетной записи хранения или назначением настраиваемой роли. Это относится к данным, которые совместно используются в службе хранилища Azure или Azure Data Lake Gen2. 

При совместном использовании данных из Azure Data Lake Gen1 необходимо назначить роль владельца. 

Чтобы создать назначение роли для управляемого удостоверения общего ресурса данных, выполните следующие действия.

1. Перейдите к учетной записи хранения.
1. Выберите **Управление доступом (IAM)** .
1. Выберите **Добавление назначения роли**.
1. В разделе *роль*выберите *модуль чтения данных большого двоичного объекта хранилища*.
1. В поле *выбрать*введите имя учетной записи общего ресурса данных Azure.
1. Щелкните *Сохранить*.

Для источников на основе SQL пользователь должен быть создан из внешнего поставщика в базе данных SQL, к данным которых предоставлен общий доступ, с тем же именем, что и у учетной записи общего ресурса Azure. Пример скрипта, а также другие необходимые компоненты для совместного использования на основе SQL можно найти в руководстве по [совместному использованию данных](share-your-data.md) . 

### <a name="data-consumers"></a>Потребители данных
Для получения данных данные потребителей, которые используют управляемый ресурс, должны быть добавлены в роль участника данных BLOB-объекта хранилища и (или) роль dbo базы данных SQL при получении данных в базу данных SQL. 

В случае хранилища это автоматически выполняется службой общего ресурса данных Azure, если пользователь добавляет наборы данных через Azure и является владельцем учетной записи хранения или является членом пользовательской роли, имеющей разрешение Microsoft. Authorization/Role (назначение ролей/запись). данному. 

Кроме того, пользователь может добавить в роль участника данных BLOB-объекта хранилища учетные данные для совместного использования управляемого ресурса с помощью администратора Azure. Создание этого назначения роли вручную может быть недействительным владельцем учетной записи хранения или назначением настраиваемой роли. Обратите внимание, что это относится к данным, которые совместно используются в службе хранилища Azure или Azure Data Lake Gen2. Получение данных в Azure Data Lake Gen1 не поддерживается. 

Чтобы создать назначение роли для управляемого удостоверения ресурса ресурса данных вручную, выполните следующие действия.

1. Перейдите к учетной записи хранения.
1. Выберите **Управление доступом (IAM)** .
1. Выберите **Добавление назначения роли**.
1. В разделе *роль*выберите пункт *участник данных BLOB-объекта хранилища*. 
1. В поле *выбрать*введите имя учетной записи общего ресурса данных Azure.
1. Щелкните *Сохранить*.

Если вы предоставляете общий доступ к данным с помощью наших интерфейсов API, вам потребуется создать эти назначения ролей вручную, добавив учетную запись общего доступа к данным в соответствующие роли. 

Если данные поступают в источник на основе SQL, убедитесь, что новый пользователь создается из внешнего поставщика с тем же именем, что и у учетной записи общего ресурса Azure. Ознакомьтесь с предварительными требованиями в руководстве по [принятию и получению данных](subscribe-to-data-share.md) . 

Дополнительные сведения о добавлении назначения ролей см. в [этой документации,](https://docs.microsoft.com/azure/role-based-access-control/role-assignments-portal#add-a-role-assignment) в которой описано, как добавить назначение роли в ресурс Azure. 

## <a name="resource-provider-registration"></a>Регистрация поставщика ресурсов 

При принятии приглашения на общий ресурс Azure необходимо вручную зарегистрировать поставщик ресурсов Microsoft. Data Share в подписке. Выполните следующие действия, чтобы зарегистрировать поставщик ресурсов Microsoft. данных в подписке Azure. 

1. В портал Azure перейдите к разделу **подписки**.
1. Выберите подписку, которую вы используете для общего ресурса данных Azure.
1. Щелкните **поставщики ресурсов**.
1. Найдите файл Microsoft.
1. Щелкните **Зарегистрировать**.

## <a name="next-steps"></a>Дальнейшие действия

- Дополнительные сведения о ролях в Azure см. в статье [Определения ролей](../role-based-access-control/role-definitions.md).

