---
title: Устранение неполадок в Azure Data Share
description: Узнайте, как устранять неполадки с приглашениями и ошибками при создании или получении общих ресурсов данных с помощью общего ресурса данных Azure.
services: data-share
author: joannapea
ms.author: joanpo
ms.service: data-share
ms.topic: troubleshooting
ms.date: 07/10/2019
ms.openlocfilehash: 901f2b56bc045dc9a9837dd18b2e6ce7169aa3b9
ms.sourcegitcommit: 849bb1729b89d075eed579aa36395bf4d29f3bd9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2020
ms.locfileid: "76964232"
---
# <a name="troubleshoot-common-issues-in-azure-data-share"></a>Устранение распространенных неполадок в общей папке данных Azure 

В этой статье показано, как устранять распространенные проблемы, связанные с общей папкой данных Azure. 

## <a name="azure-data-share-invitations"></a>Приглашения Azure Data Share 

В некоторых случаях, когда новый пользователь выбирает **Принять приглашение** из отправленного по электронной почте приглашения, ему может быть представлен пустой список приглашений. 

![Нет приглашений](media/no-invites.png)

Это может быть вызвано следующими причинами.

* **Служба общего доступа к данным Azure не зарегистрирована в качестве поставщика ресурсов для любой подписки Azure в клиенте Azure.** Эта проблема возникает, если в клиенте Azure нет общего ресурса данных. Когда вы создаете ресурс общего ресурса Azure, он автоматически регистрирует поставщик ресурсов в подписке Azure. Вы также можете вручную зарегистрировать службу общих ресурсов данных, выполнив следующие действия. Для выполнения этих действий необходимо иметь роль участника Azure.

    1. На портале Azure перейдите к **подпискам**
    1. Выберите подписку, которую вы хотите использовать для создания общего ресурса данных Azure.
    1. Щелкните **Поставщики ресурсов**
    1. Найдите **файл Microsoft.**
    1. Щелкните **Зарегистрировать**. 

    Вам потребуется [роль Azure Contributor RBAC](https://docs.microsoft.com/azure/role-based-access-control/built-in-roles#contributor), чтобы выполнить эти действия. 

* **Приглашение отправляется в псевдоним электронной почты вместо адреса электронной почты для входа в Azure.** Если вы зарегистрировали службу общего доступа к данным Azure или уже создали ресурс общего ресурса в клиенте Azure, но не видите это приглашение, это может быть вызвано тем, что поставщик указал псевдоним электронной почты в качестве получателя вместо адреса электронной почты для входа в Azure. Обратитесь к поставщику данных и убедитесь, что он отправил приглашение на адрес электронной почты для входа в Azure, а не ваш псевдоним электронной почты.

* **Приглашение уже принято.** Ссылка в сообщении электронной почты переводит вас на страницу приглашения для общего доступа к данным в портал Azure, в которой отображаются только ожидающие приглашения. Если вы уже приняли приглашение, оно больше не будет отображаться на странице приглашения на общий доступ к данным. Перейдите к ресурсу общего доступа к данным, который использовался для принятия приглашения на просмотр полученных общих ресурсов и настройки целевого параметра кластера Azure обозреватель данных.

## <a name="error-when-creating-or-receiving-a-new-share"></a>Ошибка при создании или получении нового общего ресурса

"Не удалось добавить наборы данных"

«Не удалось отобразить наборы данных»

"Не удается предоставить доступ к общему ресурсу данных x к y"

"У вас нет необходимых разрешений для x"

"Не удалось добавить разрешения на запись для общей учетной записи Azure Data Share в один или несколько выбранных ресурсов"

Если при создании новых наборов данных общего доступа или сопоставления выдается любое из указанных выше сообщений об ошибках, это может быть вызвано недостаточными разрешениями для хранилища Azure. Необходимые разрешения см. в разделе [роли и требования](concepts-roles-permissions.md) . 

Необходимо разрешение на запись для совместного использования или получения данных из хранилища данных Azure, которое обычно существует в роли участника. 

Если вы впервые используете или получаете данные из хранилища данных Azure, вам также потребуются разрешения *Майкрософт. Авторизация, назначение ролей и запись* , которые обычно существуют в роли владельца. Даже если вы создали ресурс хранилища данных Azure, он не будет автоматически создавать владельца ресурса. С соответствующим разрешением служба общих ресурсов Azure автоматически предоставит доступ к хранилищу данных для управляемого удостоверения общего ресурса данных. Выполнение этого процесса может занять несколько минут. Если у вас возникли проблемы из-за этой задержки, повторите попытку через несколько минут.

Для совместного использования на основе SQL требуются дополнительные разрешения. Дополнительные сведения см. в разделе Устранение неполадок совместного использования на основе SQL.

## <a name="troubleshooting-sql-based-sharing"></a>Устранение неполадок с совместным использованием на основе SQL

"Пользователь x не существует в базе данных SQL"

Если эта ошибка возникает при добавлении набора данных из источника на основе SQL, это может быть вызвано тем, что вы не создали пользователя для управляемого удостоверения общего ресурса данных Azure на SQL Server.  Чтобы устранить эту проблему, выполните следующий скрипт:

```sql
    create user "<share_acct_name>" from external provider; 
    exec sp_addrolemember db_datareader, "<share_acct_name>";
```      
Если эта ошибка возникает при сопоставлении набора данных с целевым объектом на основе SQL, это может быть вызвано тем, что вы не создали пользователя для управляемого удостоверения общего ресурса данных Azure на SQL Server.  Чтобы устранить эту проблему, выполните следующий скрипт:

```sql
    create user "<share_acc_name>" from external provider; 
    exec sp_addrolemember db_datareader, "<share_acc_name>"; 
    exec sp_addrolemember db_datawriter, "<share_acc_name>"; 
    exec sp_addrolemember db_ddladmin, "<share_acc_name>";
```
Обратите внимание на то, что *<share_acc_name>* — это имя вашего ресурса Data Share.      

Убедитесь, что выполнены все предварительные требования, указанные в руководстве [общий доступ к данным](share-your-data.md) и [прием и получение данных](subscribe-to-data-share.md) .

## <a name="snapshot-failed"></a>Сбой моментального снимка
Сбой моментального снимка может быть вызван различными причинами. Подробное сообщение об ошибке можно найти, щелкнув время начала моментального снимка, а затем состояние каждого набора данных. 

Если сообщение об ошибке связано с разрешениями, убедитесь, что служба общего доступа к данным имеет необходимые разрешения. Дополнительные сведения см. в разделе [роли и требования](concepts-roles-permissions.md) . Если вы впервые занимаетесь созданием моментального снимка, вам может потребоваться несколько минут для предоставления общему ресурсу данных доступа к хранилищу данных Azure. Подождите несколько минут и повторите попытку.

## <a name="next-steps"></a>Дальнейшие шаги

Чтобы узнать, как приступить к обмену данными, перейдите к [этому](share-your-data.md) руководству. 

Чтобы узнать, как получать данные, перейдите к руководству по [принятию и получению данных](subscribe-to-data-share.md) .

