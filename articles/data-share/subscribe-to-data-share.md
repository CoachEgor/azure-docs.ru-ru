---
title: Руководство по принятию и получению данных в Azure Data Share
description: Руководство по принятию и получению данных с помощью службы Azure Data Share.
author: joannapea
ms.author: joanpo
ms.service: data-share
ms.topic: tutorial
ms.date: 07/10/2019
ms.openlocfilehash: 9c24f54fe846459187488b0a65b2582914e25e2a
ms.sourcegitcommit: c22327552d62f88aeaa321189f9b9a631525027c
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/04/2019
ms.locfileid: "73499350"
---
# <a name="tutorial-accept-and-receive-data-using-azure-data-share"></a>Руководство по Прием и получение данных с помощью Azure Data Share  

В этом руководстве вы узнаете, как принять приглашение в общий ресурс данных с помощью службы Azure Data Share, а также как получить данные, к которым вам предоставили доступ и включить интервал регулярного обновления, чтобы всегда иметь последний моментальный снимок этих данных. 

> [!div class="checklist"]
> * Как принять приглашение Azure Data Share
> * Создание учетной записи Azure Data Share
> * Указание места назначения данных.
> * Создание подписки на общий ресурс с данными для получения запланированного обновления.

## <a name="prerequisites"></a>Предварительные требования
Чтобы принять приглашение в общий ресурс данных, вам необходимо подготовить к работе ряд ресурсов Azure, которые перечислены ниже. 

Прежде чем принять приглашение в общий ресурс данных, выполните все предварительные требования. 

* Подписка Azure. Если у вас еще нет подписки Azure, [создайте бесплатную учетную запись Azure](https://azure.microsoft.com/free/), прежде чем начинать работу.
* Приглашение Data Share. Приглашение от Microsoft Azure с темой "Приглашение Azure Data Share от **<yourdataprovider@domain.com>** ".

### <a name="receive-data-into-a-storage-account"></a>Получение данных в учетную запись хранения 

* Учетная запись хранения Azure. Если у вас еще нет учетной записи хранения Azure, вы можете [создать ее](https://docs.microsoft.com/azure/storage/common/storage-quickstart-create-account). 
* Разрешение на добавление назначения ролей в учетную запись хранения с разрешением *Microsoft.Authorization/role assignments/write*. Это разрешение назначено роли владельца. 
* Регистрация поставщика ресурсов для Microsoft.DataShare. См. подробнее о [поставщиках ресурсов Azure](https://docs.microsoft.com/azure/azure-resource-manager/resource-manager-supported-services). 

> [!IMPORTANT]
> Чтобы получить данные Azure Data Share, сначала необходимо зарегистрировать поставщик ресурсов Microsoft.DataShare и стать владельцем учетной записи хранения, где вы будете получать данные. Следуйте инструкциям, изложенным в статье [Устранение распространенных неполадок в общей папке данных Azure](data-share-troubleshoot.md), чтобы зарегистрировать поставщик ресурсов для общего ресурса данных, а также добавить себя в качестве владельца учетной записи хранения. 

### <a name="receive-data-into-a-sql-based-source"></a>Получение данных в источник на основе SQL

* Разрешение MSI на доступ к базе данных SQL Azure или хранилищу данных SQL Azure для общего ресурса данных. Это можно обеспечить следующим образом. 
    1. Укажите себя в качестве администратора Azure Active Directory для сервера.
    1. Подключитесь к хранилищу данных SQL Azure или базе данных SQL Azure с использованием Azure Active Directory.
    1. Используйте редактор запросов (предварительная версия) для выполнения следующего сценария, чтобы добавить MSI Data Share в качестве роли db_owner. Необходимо подключиться с помощью Active Directory, а не аутентификации SQL Server. 

```sql
    create user <share_acct_name> from external provider;     
    exec sp_addrolemember db_owner, <share_acct_name>; 
```      
Обратите внимание на то, что *<share_acc_name>*  — это имя вашей учетной записи Data Share. Если вы еще не создали учетную запись Data Share, вы можете вернуться к этому требованию позже.         

* Доступ к брандмауэру для IP-адреса клиента SQL Server Это можно обеспечить следующим образом. 1. Перейдите к разделу *Брандмауэры и виртуальные сети* 1. Чтобы разрешить доступ к службам Azure, щелкните переключатель **Вкл.** 

После выполнения этих предварительных требований вы сможете получить данные в SQL Server.

## <a name="sign-in-to-the-azure-portal"></a>Вход на портал Azure

Войдите на [портале Azure](https://portal.azure.com/).

## <a name="open-invitation"></a>Открытие приглашения

Проверьте папку "Входящие" на наличие приглашения от вашего поставщика данных. Это должно быть приглашение от Microsoft Azure с названием **Приглашение Azure Data Share от <yourdataprovider@domain.com>** . Запишите имя общего ресурса, чтобы принять правильную общую папку при наличии нескольких приглашений. 

Выберите **View invitation** (Просмотреть приглашение), чтобы увидеть ваше приглашение в Azure. После этого откроется представление полученных общих ресурсов.

![Приглашения](./media/invitations.png "Список приглашений") 

Выберите общий ресурс для просмотра. 

## <a name="accept-invitation"></a>Принятие приглашения
Просмотрите все поля, в том числе **Условия использования**. Если вы согласны с условиями использования, установите флажок для подтверждения своего согласия. 

![Условия использования](./media/terms-of-use.png "Условия использования") 

В разделе *Target Data Share Account* (Целевая учетная запись Data Share) выберите подписку и группу ресурсов, куда будете развертывать общий ресурс данных. 

В поле **учетной записи Data Share** выберите **Создать**, если у вас нет существующей учетной записи Data Share. В противном случае выберите учетную запись Data Share, где бы вы хотели принимать данные. 

В поле *Received Share Name* (Имя полученного общего ресурса) можно оставить значение по умолчанию, заданное поставщиком данных, или указать новое имя для полученного общего ресурса. 

![Целевая учетная запись Data Share](./media/target-data-share.png "Целевая учетная запись Data Share") 

Согласившись с условиями использования и указав расположение для общего ресурса, выберите *Accept and Configure* (Принять и настроить). Если вы выбрали эту команду, будет создана подписка на общий ресурс и на следующем экране вам нужно будет выбрать целевую учетную запись хранения, куда будут копироваться данные. 

![Принятие параметров](./media/accept-options.png "Принятие параметров") 

Если вы хотите принять приглашение сейчас, но настроить хранилище позднее, выберите *Accept and Configure later* (Принять и настроить позже). Этот вариант позволяет настроить вашу целевую учетную запись хранения позже. Сведения о возобновлении настройки общего ресурса данных и конфигурации хранилища см. [на этой странице](how-to-configure-mapping.md). 

Если вы не хотите принимать приглашение, выберите *Отклонить*. 

## <a name="configure-storage"></a>Настройка хранилища
В разделе *Target Storage Settings* (Параметры целевого хранилища) выберите подписку, группу ресурсов и учетную запись хранения, где вы хотите получать свои данные. 

![Параметры целевого хранилища](./media/target-storage-settings.png "Целевое хранилище") 

Чтобы получать регулярные обновления данных, включите настройки создания моментальных снимков. Обратите внимание, что вы сможете увидеть параметры расписания создания моментальных снимком только в том случае, если ваш поставщик данных включил расписание в общий ресурс. 

![Параметры моментального снимка](./media/snapshot-settings.png "Параметры моментального снимка") 

Щелкните *Сохранить*. 

> [!IMPORTANT]
> Если вы получаете данные SQL и хотите передавать их в источник на основе SQL, ознакомьтесь с нашим практическим руководством по [настройке сопоставления набора данных](how-to-configure-mapping.md), чтобы узнать, как настроить SQL Server в качестве назначения для набора данных. 

## <a name="trigger-a-snapshot"></a>Активация создания моментальных снимков

Вы можете активировать создание моментальных снимков, выбрав в разделе Received Shares (Полученные общие ресурсы) вкладку "Подробности", а затем — **Trigger snapshot** (Активировать создание моментальных снимков). Здесь вы сможете активировать полные или добавочные моментальные снимки ваших данных. Если вы осуществляете прием данных от поставщика в первый раз, выберите полное копирование. 

![Активация создания моментального снимка](./media/trigger-snapshot.png "Активация создания моментального снимка") 

Если состояние последнего запуска является *успешным*, откройте учетную запись хранения для просмотра полученных данных. 

Чтобы проверить, какая учетная запись хранения использовалась, выберите **Наборы данных**. 

![Наборы данных объекта-получателя](./media/consumer-datasets.png "Сопоставление набора данных объекта-получателя") 

## <a name="view-history"></a>Просмотр истории
Чтобы просмотреть журнал моментальных снимков, перейдите в раздел Received Shares (Полученные общие ресурсы) -> "Журнал". Здесь вы найдете журнал всех моментальных снимков за последние 60 дней. 

## <a name="next-steps"></a>Дополнительная информация
В этом учебнике вы узнали, как принять приглашение и получить данные Azure Data Share. Дополнительные сведения о понятиях Azure Data Share см. в[ этой статье](terminology.md).