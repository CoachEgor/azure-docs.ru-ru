---
title: Руководство по Общий доступ за пределами организации в Azure Data Share
description: Руководство по совместному использованию данных клиентами и партнерами с помощью Azure Data Share
author: jifems
ms.author: jife
ms.service: data-share
ms.topic: tutorial
ms.date: 08/28/2020
ms.openlocfilehash: 4f3c9d739f959670700182baf80c4a08e53d8587
ms.sourcegitcommit: bcda98171d6e81795e723e525f81e6235f044e52
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/01/2020
ms.locfileid: "89259070"
---
# <a name="tutorial-share-data-using-azure-data-share"></a>Руководство по Совместное использование данных с помощью Azure Data Share  

Из этого руководства вы узнаете, как настроить новый Azure Data Share и начать предоставлять свои данные клиентам и партнерам за пределами вашей организации Azure. 

Из этого руководства вы узнаете, как выполнять следующие задачи:

> [!div class="checklist"]
> * создать общий доступ к данным;
> * добавить наборы данных в общий доступ к данным;
> * включить расписание моментальных снимков для Data Share; 
> * добавить получателей для общего доступа к данным. 

## <a name="prerequisites"></a>Предварительные требования

* Подписка Azure. Если у вас еще нет подписки Azure, [создайте бесплатную учетную запись](https://azure.microsoft.com/free/), прежде чем начинать работу.
* Адрес электронной почты для входа получателей в Azure (псевдонимы электронной почты не поддерживаются).
* Если исходное хранилище данных Azure находится в подписке Azure, отличной от той, которая будет использоваться для создания ресурса Data Share, зарегистрируйте [поставщик ресурсов Microsoft.DataShare](concepts-roles-permissions.md#resource-provider-registration) в подписке, в которой находится хранилище данных Azure. 

### <a name="share-from-a-storage-account"></a>Совместное использование из учетной записи хранения

* Учетная запись хранения Azure. Если у вас ее еще нет, вы можете создать [Учетную запись службі хранилища Azure](https://docs.microsoft.com/azure/storage/common/storage-quickstart-create-account)
* Разрешение на запись в учетную запись хранения, которая имеется в *Microsoft.Storage/storageAccounts/write*. Это разрешение назначено роли участника.
* Разрешение на добавление назначения ролей в учетную запись хранения, имеющуюся в *Microsoft.Authorization/role assignments/write*. Это разрешение назначено роли владельца. 


### <a name="share-from-a-sql-based-source"></a>Совместное использование из источника на основе SQL

* База данных SQL Azure или Azure Synapse Analytics (ранее хранилище данных SQL Azure) с таблицами и представлениями, к которым вы хотите предоставить общий доступ.
* Разрешение на запись в базы данных на сервере SQL, которое присутствует в *Microsoft.Sql/servers/databases/write*. Это разрешение назначено роли участника.
* Разрешение на доступ к хранилищу данных для общего ресурса данных. Это можно обеспечить следующим образом. 
    1. Укажите себя в качестве администратора Azure Active Directory для сервера SQL.
    1. Подключитесь к хранилищу данных SQL Azure или базе данных SQL Azure с использованием Azure Active Directory.
    1. Используйте редактор запросов (предварительная версия) для выполнения следующего сценария, чтобы добавить управляемое удостоверение для ресурса Data Share в качестве db_datareader. Необходимо подключиться с помощью Active Directory, а не аутентификации SQL Server. 
    
        ```sql
        create user "<share_acct_name>" from external provider;     
        exec sp_addrolemember db_datareader, "<share_acct_name>"; 
        ```                   
       Обратите внимание на то, что *<share_acc_name>* — это имя вашего ресурса Data Share. Если вы еще не создали ресурс Data Share, вы можете вернуться к этому требованию позже.  

* Пользователь Базы данных SQL Azure с доступом "db_datareader" для навигации и выбора таблиц и представлений, к которым необходимо предоставить общий доступ. 

* Доступ к брандмауэру для IP-адреса клиента SQL Server. Это можно обеспечить следующим образом. 
    1. В SQL Server на портале Azure перейдите к разделу *Брандмауэры и виртуальные сети*
    1. Чтобы разрешить доступ к службам Azure, щелкните переключатель **Вкл.**
    1. Щелкните **+Добавить IP-адрес клиента**, а затем **Сохранить**. IP-адрес клиента можно изменить. При следующем совместном использовании данных SQL из портала Azure может потребоваться повторение этого процесса. Вы можете также добавить диапазон IP-адресов. 

### <a name="share-from-azure-data-explorer"></a>Предоставление общего доступа к данным из Azure Data Explorer
* Кластер Azure Data Explorer с базами данных, к которым вы хотите предоставить общий доступ.
* Разрешение на запись в кластер Azure Data Explorer, имеющийся в *Microsoft.Kusto/clusters/write*. Это разрешение назначено роли участника.
* Разрешение на добавление назначения ролей в кластер Azure Data Explorer *Microsoft.Authorization/role assignments/write*. Это разрешение назначено роли владельца.

## <a name="sign-in-to-the-azure-portal"></a>Вход на портал Azure

Войдите на [портал Azure](https://portal.azure.com/).

## <a name="create-a-data-share-account"></a>Создание учетной записи для общего доступа к данным

Создайте ресурс Azure Data Share в группе ресурсов Azure.

1. Нажмите кнопку меню в левом верхнем углу окна портала и выберите элемент **Создать ресурс** (+).

1. Найдите *Data Share*.

1. Выберите Data Share и команду **Создать**.

1. Укажите основные сведения о ресурсе Azure Data Share, указав следующую информацию. 

     **Параметр** | **Рекомендуемое значение** | **Описание поля**
    |---|---|---|
    | Подписка | Ваша подписка | Выберите подписку Azure, которую нужно использовать для своей учетной записи Data Share.|
    | Группа ресурсов | *test-resource-group* | Воспользуйтесь существующей группой ресурсов или создайте новую. |
    | Расположение | *Восточная часть США 2* | Выберите регион для учетной записи Data Share.
    | Имя | *datashareaccount* | Укажите имя вашей учетной записи Data Share. |
    | | |

1. Выберите **Проверить и создать**, а затем **Создать**, чтобы подготовить учетную запись для общего ресурса данных. Подготовка новой учетной записи для общего доступа к данным обычно занимает около 2 минут или меньше. 

1. Когда развертывание будет завершено, выберите **Перейти ресурсу**.

## <a name="create-a-share"></a>Создание общей папки

1. Перейдите на страницу "Обзор Data Share".

    ![Общий доступ к данным](./media/share-receive-data.png "Общий доступ к данным") 

1. Выберите команду **Начать совместное использование данных**.

1. Нажмите кнопку **создания**.   

1. Введите сведения о совместном использовании. Укажите имя, тип совместного использования, описание содержимого и условия использования (необязательно). 

    ![EnterShareDetails](./media/enter-share-details.png "Введите сведения об общем ресурсе") 

1. Выберите **Continue** (Продолжить).

1. Чтобы добавить наборы данных в общий ресурс, выберите **Добавить наборы данных**. 

    ![Добавление наборов данных в общий ресурс](./media/datasets.png "Наборы данных")

1. Выберите тип набора данных, который хотите добавить. Вы увидите другой список типов наборов данных в зависимости от типа ресурса (моментальный снимок или на странице), который вы выбрали на предыдущем этапе. При предоставлении общего доступа из Базы данных SQL Azure или Хранилища данных SQL Azure вам будет предложено ввести учетные данные SQL. Выполните проверку подлинности с помощью пользователя, созданного в рамках предварительных требований.

    ![AddDatasets](./media/add-datasets.png "Добавление наборов данных")    

1. Перейдите к объекту, доступ к которому нужно предоставить, и выберите "Добавить наборы данных". 

    ![SelectDatasets](./media/select-datasets.png "Выбор наборов данных")    

1. На вкладке "Получатели" введите адреса электронной почты получателей данных, выбрав команду "+Добавить получателя". 

    ![AddRecipients](./media/add-recipient.png "Добавление получателей") 

1. Выберите **Continue** (Продолжить).

1. Если выбран тип общего доступа к моментальным снимкам, вы можете настроить расписание моментальных снимков для предоставления обновлений данных потребителям. 

    ![EnableSnapshots](./media/enable-snapshots.png "Включение моментальных снимков") 

1. Выберите время начала и интервал повторения. 

1. Выберите **Continue** (Продолжить).

1. На вкладке "Просмотр и создание" просмотрите содержимое пакета, параметры, получателей и параметры синхронизации. Нажмите кнопку **Создать**.

Azure Data Share создан, и получатель Data Share готов принять ваше приглашение. 

## <a name="next-steps"></a>Дальнейшие действия

Из этого руководства вы узнали, как создать Azure Data Share и пригласить получателей. Чтобы узнать больше о том, как потребитель данных может получить и принять Data Share, см. пособие о том, как [принять и получить данные](subscribe-to-data-share.md). 
