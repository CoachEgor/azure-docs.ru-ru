---
title: Общие сведения об использовании BGP с VPN-шлюзами Azure | Документация Майкрософт
description: В статье описывается использование BGP с VPN-шлюзами Azure.
services: vpn-gateway
author: yushwang
manager: rossort
ms.service: vpn-gateway
ms.topic: article
ms.date: 01/12/2017
ms.author: yushwang
ms.openlocfilehash: 91e9fe1eb6b3df0b64d05f2b1e300403a9e01db9
ms.sourcegitcommit: d4dfbc34a1f03488e1b7bc5e711a11b72c717ada
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/13/2019
ms.locfileid: "60762287"
---
# <a name="about-bgp-with-azure-vpn-gateway"></a>Использования BGP с VPN-шлюзами Azure
В этой статье содержаться общие сведения о поддержке протокола BGP VPN-шлюзами Azure.

Стандартный протокол маршрутизации BGP обычно используется в Интернете для обмена данными о маршрутизации и доступности между двумя или несколькими сетями. В контексте виртуальных сетей Azure протокол BGP используется VPN-шлюзами Azure и локальными VPN-устройствами (так называемые узлы BGP) для обмена данными о маршрутах. Это позволяет информировать участников обмена о доступности и возможности передавать префиксы через шлюзы или маршрутизаторы. Также BGP позволяет передавать трафик транзитом через несколько сетей. Для этого шлюз BGP распространяет на все известные ему узлы BGP информацию о маршрутах, полученную от остальных узлов BGP. 

## <a name="why"></a>Почему именно BGP?
BGP не является обязательным протоколом для VPN-шлюзов Azure с использованием маршрутов. Также до включения протокола BGP следует убедиться, что ваши локальные VPN-устройства поддерживают его. Вы можете продолжать использовать VPN-шлюзы Azure и локальные VPN-устройства без протокола BGP. Для обмена данными между сетями и Azure можно использовать статические маршруты (без BGP) *или* динамическую маршрутизацию по протоколу BGP.

Преимущества и возможности протокола BGP:

### <a name="prefix"></a>Поддержка автоматического и гибкого обновления префиксов
Если используется протокол BGP, достаточно объявить минимальный префикс для определенного узла BGP через VPN-туннель IPsec S2S. Это может быть даже небольшой префикс узла (/32) для IP-адреса узла BGP на локальном VPN-устройстве. Вы можете выбирать, какие из локальных префиксов будут объявлены в Azure, чтобы виртуальная сеть Azure получила к ним доступ.

Также можно объявлять более крупные префиксы, в том числе некоторые префиксы адресов виртуальной сети, например большое пространство частных IP-адресов (10.0.0.0/8 и т. д.). Обратите внимание, что эти префиксы не должны совпадать с префиксами виртуальной сети. Маршруты, идентичные префиксам виртуальной сети, будут отклонены.

### <a name="multitunnel"></a>Поддержка нескольких туннелей между виртуальной сетью и локальным сайтом с автоматическим переходом на другой ресурс на основе BGP
Вы можете создавать несколько подключений между виртуальной сетью Azure и локальными VPN-устройствами в одном расположении. Это позволяет использовать между двумя сетями несколько туннелей (путей) в режиме "активный — активный". Если один из туннелей отключится, BGP отзовет соответствующие маршруты и трафик автоматически переместится в действующие туннели.

Следующая схема содержит простой пример настройки с высокой доступностью.

![Несколько активных путей](./media/vpn-gateway-bgp-overview/multiple-active-tunnels.png)

### <a name="transitrouting"></a>Поддержка транзитной маршрутизации между локальными сетями и несколькими виртуальными сетями Azure
BGP позволяет нескольким шлюзам получать и распространять префиксы из разных сетей, подключенных к ним напрямую или опосредованно. Благодаря этому возможна транзитная маршрутизация через VPN-шлюзы Azure между локальными сайтами или несколькими виртуальными сетями Azure.

Следующая схема содержит пример многоскачковой топологии с несколькими путями, по которым трафик может проходить между двумя локальными сетями через VPN-шлюзы Azure в сети Microsoft.

![Многоскачковый транзит](./media/vpn-gateway-bgp-overview/full-mesh-transit.png)

## <a name="faq"></a>Часто задаваемые вопросы о BGP
[!INCLUDE [vpn-gateway-faq-bgp-include](../../includes/vpn-gateway-faq-bgp-include.md)]

## <a name="next-steps"></a>Дальнейшие действия
Действия по настройке BGP для межсистемных подключений и подключений между виртуальными сетями описаны в разделе [Настройка BGP на VPN-шлюзах Azure с помощью Azure Resource Manager и PowerShell](vpn-gateway-bgp-resource-manager-ps.md) .

