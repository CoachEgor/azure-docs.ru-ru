---
title: Завершение запросов SSL с сертификатами Azure Key Vault
description: Узнайте, как интегрировать шлюз приложений Azure с хранилищем ключей для сертификатов сервера, вложенные в прослушиватели, поддерживающей протокол HTTPS.
services: application-gateway
author: vhorne
ms.service: application-gateway
ms.topic: article
ms.date: 4/25/2019
ms.author: victorh
ms.openlocfilehash: 18af315c58c838a7237acfbcc32f622a0edbd3b3
ms.sourcegitcommit: be9fcaace62709cea55beb49a5bebf4f9701f7c6
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/17/2019
ms.locfileid: "65827627"
---
# <a name="ssl-termination-with-key-vault-certificates"></a>Завершение запросов SSL с сертификатами в Key Vault

[Azure Key Vault](../key-vault/key-vault-whatis.md) , это сохранить секрет управляемую платформу, можно использовать для защиты секретов, ключи и сертификаты SSL. Шлюз приложений Azure поддерживает интеграцию с хранилищем ключей (в общедоступной предварительной версии) для сертификатов сервера, вложенные в прослушиватели, поддерживающей протокол HTTPS. Эта поддержка ограничена v2 SKU шлюза приложений.

> [!IMPORTANT]
> Интеграция шлюза приложений с хранилищем ключей в настоящее время находится в общедоступной предварительной версии. Эта предварительная версия предоставляется без соглашения об уровне обслуживания (SLA) и не рекомендуется для производственных рабочих нагрузок. Некоторые функции могут не поддерживаться или их возможности могут быть ограничены. Дополнительные сведения см. в статье [Дополнительные условия использования предварительных выпусков Microsoft Azure](https://azure.microsoft.com/support/legal/preview-supplemental-terms/).

Эта общедоступная Предварительная версия предлагает две модели для завершения SSL-запросов:

- Можно явно указать SSL-сертификаты, подключенные к прослушивателю. Эта модель является традиционный способ передачи SSL-сертификаты для шлюза приложений для завершения SSL-запросов.
- При необходимости можно указать ссылку на существующий сертификат в хранилище ключей или секрет, при создании прослушивателя с поддержкой HTTPS.

Интеграция шлюза приложений с помощью Key Vault предоставляет множество преимуществ, включая:

- Более высокий уровень безопасности, так как SSL-сертификаты не обрабатываются напрямую с группой разработки приложения. Интеграция позволяет команде отдельные системы безопасности:
  * Настройте шлюзы приложений.
  * Жизненные циклы управления приложения шлюза.
  * Предоставьте разрешения для выбранного приложения шлюзы для доступа к сертификатам, которые хранятся в хранилище ключей.
- Поддержка для импорта существующих сертификатов в хранилище ключей. Или использовать API-интерфейсы хранилища ключей для создания и управления ими новые сертификаты с любым из доверенных партнеров Key Vault.
- Поддержка автоматического возобновления действия сертификатов, которые хранятся в хранилище ключей.

В настоящее время шлюз приложений поддерживает только сертификаты, прошли проверку программного обеспечения. Аппаратный модуль безопасности (HSM)-проверенных сертификатов не поддерживаются. После настройки шлюза приложений для использования сертификатов хранилища ключей его экземпляров получить сертификат из хранилища ключей и установить их для завершения SSL-запросов. Экземпляры также проводят опрос Key Vault в сутки для извлечения обновленных версии сертификата, если он существует. При обнаружении обновленный сертификат SSL-сертификат, в данный момент связанный с HTTPS-прослушиватель поворачивается автоматически.

## <a name="how-integration-works"></a>Как работает интеграции

Интеграция шлюза приложений с помощью хранилища ключей требуется процесс конфигурации трех этапов:

1. **Создание назначаемого пользователем управляемого удостоверения**

   Создать или повторно использовать существующее назначаемое пользователем управляемое удостоверение, который шлюз приложений использует для получения сертификатов из хранилища ключей от вашего имени. Дополнительные сведения см. в статье [Что такое управляемые удостоверения для ресурсов Azure](../active-directory/managed-identities-azure-resources/overview.md). Этот шаг создает новое удостоверение в клиенте Azure Active Directory. Удостоверение является доверенным для подписки, который используется для создания удостоверения.

1. **Настройка хранилища ключей**

   Вы затем импортируйте существующий сертификат или создайте его в хранилище ключей. Сертификат будет использоваться приложениями, выполняемыми через шлюз приложений. На этом шаге можно также использовать секрет хранилища ключей, который хранится в виде без пароля, базовый закодированным в Base64 PFX-файла. Мы рекомендуем использовать тип сертификата из-за возможность автоматическое обновление, которая доступна с объектами типа сертификата в хранилище ключей. После создания сертификата или секрет, вы можете настраивать политики доступа, в хранилище ключей, чтобы разрешить удостоверение будет предоставлен *получить* доступа к секрету.

1. **Настройка шлюза приложений**

   После выполнения двух действий, можно настроить или изменить имеющийся шлюз приложений для использования назначаемого пользователем управляемого удостоверения. Вы также можете настроить прослушиватель HTTP SSL-сертификат, чтобы они указывали полный URI Key Vault сертификата или секретный код.

   ![Сертификаты в хранилище ключей](media/key-vault-certs/ag-kv.png)

## <a name="next-steps"></a>Дальнейшие действия

[Настройка моста SSL сертификаты Key Vault с помощью Azure PowerShell](configure-keyvault-ps.md)
