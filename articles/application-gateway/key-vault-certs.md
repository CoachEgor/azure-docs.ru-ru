---
title: Завершение запросов SSL с сертификатами в Key Vault
description: Узнайте, как интегрировать шлюз приложений Azure с хранилищем ключей для сертификатов сервера, подключенных к прослушиватели протокол HTTPS.
services: application-gateway
author: vhorne
ms.service: application-gateway
ms.topic: article
ms.date: 4/25/2019
ms.author: victorh
ms.openlocfilehash: 9ab1a42578081d4e6537f221e3f3a8f4c7babde0
ms.sourcegitcommit: 37343b814fe3c95f8c10defac7b876759d6752c3
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/24/2019
ms.locfileid: "63759621"
---
# <a name="ssl-termination-with-key-vault-certificates"></a>Завершение запросов SSL с сертификатами в Key Vault

[Azure Key Vault](../key-vault/key-vault-whatis.md) — это управляемая платформа секретное хранилище позволяет защитить секретные данные, ключи и сертификаты SSL. Шлюз приложений поддерживает интеграцию с хранилищем ключей (в общедоступной предварительной версии) для сертификатов сервера, подключенных к прослушиватели протокол HTTPS. Эта поддержка ограничена v2 SKU шлюза приложений.

> [!IMPORTANT]
> Интеграция хранилища ключей шлюза приложения находится в общедоступной предварительной версии. Предварительная версия предоставляется без соглашения об уровне обслуживания. Не рекомендуем использовать ее в рабочей среде. Некоторые функции могут не поддерживаться или их возможности могут быть ограничены. См. [дополнительные условия использования для предварительных версий Microsoft Azure](https://azure.microsoft.com/support/legal/preview-supplemental-terms/).

Существует две модели для завершения SSL-запросов с помощью этой общедоступной предварительной версии.

- Можно явно указать SSL-сертификаты, подключенные к прослушивателю. Это традиционной модели передачи SSL-сертификаты для шлюза приложений для завершения SSL-запросов.
- При необходимости можно указать ссылку на существующий сертификат Key Vault или секрет во время HTTPS включено создание прослушивателя.

Существует широкий набор преимуществ при интеграции хранилища ключей, включая:

- Более высокий уровень безопасности, так как SSL-сертификаты не обрабатываются напрямую с группой разработки приложения. Интеграция с хранилищем ключей позволяет команде отдельные системы безопасности для подготовки, управления жизненным циклом и предоставить соответствующие разрешения для выбора шлюзов приложений для доступа к сертификаты, хранящиеся в хранилище ключей.
- Поддерживает для импорта существующих сертификатов в хранилище ключей или использовать API-интерфейсы хранилища ключей для создания и управления ими новые сертификаты с любым из доверенных партнеров Key Vault.
- Поддержка сертификатов, сохраненных в хранилище ключей для автоматического обновления.

В настоящее время шлюз приложений поддерживает только сертификаты проверки программного обеспечения. Сертификаты module (HSM) проверки оборудования безопасности не поддерживаются. После настройки шлюза приложений для использования сертификатов хранилища ключей его экземпляров получить сертификат из хранилища ключей и установить их для завершения SSL-запросов. Экземпляры также периодически опрашивать хранилище ключей в 24-часового интервала для извлечения обновленных версии сертификата, если он существует. При обнаружении обновленный сертификат SSL-сертификат, в данный момент связанный с HTTPS-прослушиватель поворачивается автоматически.

## <a name="how-it-works"></a>Принцип работы

Интеграция с хранилищем ключей требуется процесс конфигурации трех этапов:

1. **Создание пользовательского управляемого удостоверения**

   Необходимо создать или повторно использовать существующего управляемого удостоверения, который шлюз приложений использует для получения сертификатов из хранилища ключей от вашего имени пользователя. Дополнительные сведения см. в разделе [что такое управляемые удостоверения для ресурсов Azure?](../active-directory/managed-identities-azure-resources/overview.md) Этот шаг создает удостоверение в клиенте Azure AD, который является доверенным для подписки, используемый для создания удостоверения.
1. **Настройка хранилища ключей**

   Затем необходимо либо импортировать или создать новый сертификат в хранилище ключей, используемых приложений, работающих через шлюз приложения. Секрет хранилища ключей, хранятся как на этом этапе также можно без пароля Base64 кодировке PFX-файл. С помощью типа сертификата предпочтительнее из-за автоматическое обновление возможности, доступные с объектами типа сертификата в хранилище ключей. После создания сертификата или секрет политики доступа должен быть определен в хранилище ключей, чтобы разрешить удостоверение будет предоставлен *получить* доступ для получения секрета.

1. **Настройка шлюза приложений**

   После завершения предыдущие два шага, можно подготовить или изменить имеющийся шлюз приложений для использования управляемого удостоверения пользователя. Можно также настроить прослушиватель HTTP SSL-сертификат для указания сертификата полный URI из Key Vault или секретный код.

![Сертификаты Key Vault](media/key-vault-certs/ag-kv.png)

## <a name="next-steps"></a>Дальнейшие действия

[Настройка моста SSL с помощью сертификаты Key Vault с помощью Azure PowerShell](configure-keyvault-ps.md).