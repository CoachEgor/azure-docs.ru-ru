---
title: Краткое руководство. Настройка шифрования SSL end-to-end со шлюзом приложений Azure — портал Azure | Документация Майкрософт
description: Узнайте, как создать шлюз приложений Azure с начала до конца SSL-шифрования с помощью портала Azure.
services: application-gateway
author: vhorne
ms.service: application-gateway
ms.topic: article
ms.date: 4/30/2019
ms.author: absha
ms.custom: mvc
ms.openlocfilehash: bd165f81b45e3ae0c121fb8876ed88e68d493195
ms.sourcegitcommit: ed66a704d8e2990df8aa160921b9b69d65c1d887
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/30/2019
ms.locfileid: "64946799"
---
# <a name="configure-end-to-end-ssl-by-using-application-gateway-with-the-portal"></a>Настройка-сквозного режима связи SSL с помощью шлюза приложений с помощью портала

В этой статье показано, как использовать портал Azure для настройки шифрования SSL end-to-end со шлюзом приложений v1 SKU.  

> [!NOTE]
> Номер SKU v2 шлюза приложений требуется доверенных корневых сертификатов для включения конфигурации end-to-end. Поддержка портала для добавления доверенных корневых сертификатов еще не доступны. Таким образом, в случае v2 SKU см. в разделе [-сквозного режима связи SSL с помощью PowerShell настроить](https://docs.microsoft.com/azure/application-gateway/application-gateway-end-to-end-ssl-powershell).

Если у вас еще нет подписки Azure, [создайте бесплатную учетную запись Azure](https://azure.microsoft.com/free/?WT.mc_id=A261C142F), прежде чем начинать работу.

## <a name="before-you-begin"></a>Перед началом работы

Чтобы настроить сквозной режим связи SSL для шлюза приложений, требуются сертификат для шлюза и сертификаты для внутренних серверов. Сертификат шлюза используется для получения симметричного ключа согласно спецификации протокола SSL. Затем симметричный ключ используется для шифрования и расшифровки трафика, передаваемого в шлюз. Чтобы использовать сквозное шифрование SSL, серверная часть должна быть внесена в список разрешений с помощью шлюза приложений. Чтобы сделать это, передайте открытый сертификат серверных частей, также известный как сертификаты проверки подлинности, шлюз приложений. Это гарантирует, что шлюз приложений взаимодействует только с известными экземплярами серверной части, тем самым защищая сквозной обмен данными.

Дополнительные сведения см. в разделе [SSL завершения и end-to-end SSL](https://docs.microsoft.com/azure/application-gateway/ssl-overview).

## <a name="create-a-new-application-gateway-with-end-to-end-ssl"></a>Создать шлюз приложений с помощью протокола SSL end-to-end

Чтобы создать шлюз приложений с начала до конца SSL-шифрования, необходимо сначала включить завершение SSL-запросов при создании нового шлюза приложений. Это позволит SSL-шифрования для обмена данными между клиентом и приложением шлюза. Затем необходимо добавить в список разрешений сертификаты для внутренних серверов, в параметрах HTTP Включение шифрования SSL для связи между шлюзом и серверной части серверов приложений, выполнения end-to-end SSL-шифрования.

### <a name="enable-ssl-termination-while-creating-a-new-application-gateway"></a>Включение завершения SSL-запросов при создании нового шлюза приложений

Обратитесь к данной статье, чтобы понять, как [Включение завершения SSL-запросов при создании нового шлюза приложения](https://docs.microsoft.com/azure/application-gateway/create-ssl-portal).

### <a name="whitelist-certificates-for-backend-servers"></a>Список разрешений сертификаты для внутренних серверов

1. Выберите **Все ресурсы**, а затем — **myAppGateway**.

2. Выберите **параметры HTTP** в меню слева. Azure автоматически создала HTTP по умолчанию, **appGatewayBackendHttpSettings**, при создании шлюза приложений. 

3. Выберите **appGatewayBackendHttpSettings**.

4. В разделе **протокола**выберите **HTTPS**. Панель для **сертификаты встроенной проверки подлинности** будет отображаться. 

5. В разделе **сертификаты встроенной проверки подлинности**, выберите **создать**.

6. Введите подходящее **имя**.

7. Отправьте сертификат с помощью **отправить CER-сертификат** поле.![ addcert](./media/end-to-end-ssl-portal/addcert.png)

   > [!NOTE]
   > Сертификат, предоставленный на этом шаге, должен быть открытым ключом сертификата в формате PFX, хранящимся в серверной части. Экспортируйте сертификат (не корневой) в формате CER, установленный на внутреннем сервере, и используйте его на этом шаге. Это действие добавляет серверную часть в список разрешений шлюза приложений.

8. Щелкните **Сохранить**.

## <a name="enable-end-to-end-ssl-for-existing-application-gateway"></a>Включить-сквозного режима связи SSL для шлюза приложений

Чтобы настроить шлюз приложений с начала до конца SSL-шифрование, необходимо завершения первого enable SSL-запросов в прослушивателе. Это позволит SSL-шифрования для обмена данными между клиентом и приложением шлюза. Затем необходимо добавить в список разрешений сертификаты для внутренних серверов, в параметрах HTTP Включение шифрования SSL для связи между шлюзом и серверной части серверов приложений, выполнения end-to-end SSL-шифрования.

Необходимо использовать прослушиватель с помощью протокола HTTPS и сертификат для включение завершения SSL-запросов. Протокол существующего прослушивателя, нельзя изменить. Таким образом либо можно выбрать для использования существующего прослушивателя с помощью протокола HTTPS и сертификат или создать новый прослушиватель. В случае, если выбрать первый вариант, можно игнорировать указанные ниже действия, чтобы **завершения включить SSL в имеющемся шлюзе приложений** и перейти непосредственно к **белого списка сертификаты для внутренних серверов** раздел. Если вы выберете второй вариант, выполните следующие действия.

### <a name="enable-ssl-termination-in-existing-application-gateway"></a>Включение завершения SSL-запросов в имеющийся шлюз приложений

1. Выберите **Все ресурсы**, а затем — **myAppGateway**.

2. Выберите **прослушиватели** в меню слева.

3. Выбор между **основные** и **многосайтовой** прослушиватель согласно вашим требованиям.

4. В разделе **протокола**выберите **HTTPS**. Панель для **сертификат** будет отображаться.

5. Отправьте сертификат PFX, который будет использоваться для оконечной точки SSL между клиентом и приложением шлюза.

   > [!NOTE]
   > В целях тестирования можно использовать самозаверяющий сертификат. Не следует использовать самозаверяющий сертификат для рабочих нагрузок. Узнайте, как [создать самозаверяющий сертификат](https://docs.microsoft.com/azure/application-gateway/create-ssl-portal#create-a-self-signed-certificate).

6. Добавьте другие необходимые параметры для **прослушивателя** согласно вашим требованиям.

7. Нажмите кнопку **ОК**, чтобы сохранить введенные данные.

### <a name="whitelist-certificates-for-backend-servers"></a>Список разрешений сертификаты для внутренних серверов

1. Выберите **Все ресурсы**, а затем — **myAppGateway**.

2. Выберите **параметры HTTP** в меню слева. Вы можете либо добавить в список разрешений сертификаты в существующей серверной части HTTP параметр или создать новый параметр HTTP. В ниже шаг, мы выполним белого списка сертификат для HTTP по умолчанию, **appGatewayBackendHttpSettings**.

3. Выберите **appGatewayBackendHttpSettings**.

4. В разделе **протокола**выберите **HTTPS**. Панель для **сертификаты встроенной проверки подлинности** будет отображаться. 

5. В разделе **сертификаты встроенной проверки подлинности**, выберите **создать**.

6. Введите подходящее **имя**.

7. Отправьте сертификат с помощью **отправить CER-сертификат** поле.![ addcert](./media/end-to-end-ssl-portal/addcert.png)

   > [!NOTE]
   > Сертификат, предоставленный на этом шаге, должен быть открытым ключом сертификата в формате PFX, хранящимся в серверной части. Экспортируйте сертификат (не корневой) в формате CER, установленный на внутреннем сервере, и используйте его на этом шаге. Это действие добавляет серверную часть в список разрешений шлюза приложений.

8. Щелкните **Сохранить**.

## <a name="next-steps"></a>Дальнейшие действия

> [!div class="nextstepaction"]
> [Руководство по управлению веб-трафиком с помощью шлюза приложений и Azure CLI](./tutorial-manage-web-traffic-cli.md)
