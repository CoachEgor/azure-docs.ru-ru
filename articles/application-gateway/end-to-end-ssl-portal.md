---
title: Краткое руководство. Настройка сквозного шифрования SSL с помощью шлюза приложений Azure — портал Azure | Документация Майкрософт
description: Узнайте, как использовать портал Azure для создания шлюза приложений Azure с сквозным шифрованием SSL.
services: application-gateway
author: vhorne
ms.service: application-gateway
ms.topic: article
ms.date: 4/30/2019
ms.author: absha
ms.custom: mvc
ms.openlocfilehash: a37b313bd808ee0441d84ac92050b087eba7ac9d
ms.sourcegitcommit: cd70273f0845cd39b435bd5978ca0df4ac4d7b2c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/18/2019
ms.locfileid: "71097203"
---
# <a name="configure-end-to-end-ssl-by-using-application-gateway-with-the-portal"></a>Настройка сквозного протокола SSL с помощью шлюза приложений на портале

В этой статье показано, как использовать портал Azure для настройки сквозного шифрования SSL с номером SKU шлюза приложений версии 1.  

> [!NOTE]
> SKU шлюза приложений версии 2 требует доверенных корневых сертификатов для включения сквозной конфигурации.

Если у вас еще нет подписки Azure, [создайте бесплатную учетную запись Azure](https://azure.microsoft.com/free/?WT.mc_id=A261C142F), прежде чем начинать работу.

## <a name="before-you-begin"></a>Перед началом работы

Чтобы настроить сквозной протокол SSL с помощью шлюза приложений, требуется сертификат для шлюза, а для внутренних серверов требуются сертификаты. Сертификат шлюза используется для получения симметричного ключа согласно спецификации протокола SSL. Затем симметричный ключ используется для шифрования и расшифровки трафика, передаваемого шлюзу. Для сквозного шифрования SSL в шлюзе приложений должны быть разрешены правая серверные серверы. Для этого передайте в шлюз приложений общедоступный сертификат внутренних серверов, известный также как сертификаты проверки подлинности (v1) или доверенные корневые сертификаты (v2). Добавление сертификата гарантирует, что шлюз приложений обменивается данными только с известными экземплярами серверной части. тем самым защищая сквозной обмен данными.

Дополнительные сведения см. в разделе [Завершение SSL и сквозной протокол SSL](https://docs.microsoft.com/azure/application-gateway/ssl-overview).

## <a name="create-a-new-application-gateway-with-end-to-end-ssl"></a>Создание нового шлюза приложений с сквозным SSL

Чтобы создать новый шлюз приложений с сквозным шифрованием SSL, необходимо сначала включить завершение SSL при создании нового шлюза приложений. Это позволит включить шифрование SSL для обмена данными между клиентом и шлюзом приложений. Затем необходимо список разрешений сертификаты для внутренних серверов в параметрах HTTP, чтобы включить шифрование SSL для обмена данными между шлюзом приложений и внутренними серверами, достигая сквозное шифрование SSL.

### <a name="enable-ssl-termination-while-creating-a-new-application-gateway"></a>Включить завершение SSL при создании нового шлюза приложений

Сведения о [включении прерывания SSL во время создания нового шлюза приложений](https://docs.microsoft.com/azure/application-gateway/create-ssl-portal)см. в этой статье.

### <a name="add-authenticationroot-certificate-of-back-end-servers"></a>Добавление проверки подлинности или корневого сертификата внутренних серверов

1. Выберите **Все ресурсы**, а затем — **myAppGateway**.

2. В меню слева выберите **Параметры HTTP** . Azure автоматически создал параметр HTTP по умолчанию **appGatewayBackendHttpSettings**при создании шлюза приложений. 

3. Выберите **appGatewayBackendHttpSettings**.

4. В разделе **протокол**выберите **HTTPS**. Появится панель для **внутренних сертификатов проверки подлинности или доверенных корневых сертификатов** . 

5. Выберите **создать**.

6. Введите подходящее **имя**.

7. Выберите файл сертификата с помощью поля **Отправить CER Certificate** .

   Для шлюзов приложений Standard и WAF (v1) необходимо передать открытый ключ сертификата внутреннего сервера в формате CER.

   ![аддцерт](./media/end-to-end-ssl-portal/addcert.png)

   Для шлюзов приложений Standard_v2 и WAF_v2 необходимо передать **корневой сертификат** сертификата внутреннего сервера в формате CER. Если серверный сертификат выдается известным центром сертификации, можно установить флажок "использовать хорошо известный сертификат ЦС" и не загружать сертификат.

   ![аддтрустедрутцерт](./media/end-to-end-ssl-portal/trustedrootcert-portal.png)

   ![рутцерт](./media/end-to-end-ssl-portal/trustedrootcert.png)

8. Щелкните **Сохранить**.

## <a name="enable-end-to-end-ssl-for-existing-application-gateway"></a>Включение сквозного протокола SSL для существующего шлюза приложений

Чтобы настроить существующий шлюз приложений с сквозным шифрованием SSL, необходимо сначала включить завершение SSL в прослушивателе. Это позволит включить шифрование SSL для обмена данными между клиентом и шлюзом приложений. Затем необходимо список разрешений сертификаты для внутренних серверов в параметрах HTTP, чтобы включить шифрование SSL для обмена данными между шлюзом приложений и внутренними серверами, достигая сквозное шифрование SSL.

Для включения завершения SSL необходимо использовать прослушиватель с протоколом HTTPS и сертификатом. Таким образом, можно выбрать использование существующего прослушивателя с протоколом HTTPS и сертификатом или создать новый прослушиватель. Если вы выберете первый вариант, вы можете пропустить описанные ниже шаги, чтобы **включить завершение SSL в существующем шлюзе приложений** и напрямую переместиться в раздел **Добавление проверки подлинности или доверенных корневых сертификатов для внутренних серверов** . При выборе второго варианта выполните следующие действия.

### <a name="enable-ssl-termination-in-existing-application-gateway"></a>Включить завершение SSL в существующем шлюзе приложений

1. Выберите **Все ресурсы**, а затем — **myAppGateway**.

2. В меню слева выберите прослушиватели.

3. Выберите **базовый** и многосайтовый прослушиватель в соответствии с вашими требованиями.

4. В разделе **протокол**выберите **HTTPS**. Появится панель для **сертификата** .

5. Отправьте PFX-сертификат, который вы планируете использовать для завершения SSL-запросов между клиентом и шлюзом приложений.

   > [!NOTE]
   > В целях тестирования можно использовать самозаверяющий сертификат. но не рекомендуется для рабочих нагрузок, так как они сложнее в управлении и не полностью защищены. Узнайте, как [создать самозаверяющий сертификат](https://docs.microsoft.com/azure/application-gateway/create-ssl-portal#create-a-self-signed-certificate).

6. Добавьте другие обязательные параметры для **прослушивателя** в соответствии с вашими требованиями.

7. Нажмите кнопку **ОК**, чтобы сохранить введенные данные.

### <a name="add-authenticationtrusted-root-certificates-of-back-end-servers"></a>Добавление проверки подлинности и доверенных корневых сертификатов внутренних серверов

1. Выберите **Все ресурсы**, а затем — **myAppGateway**.

2. В меню слева выберите **Параметры HTTP** . Можно либо список разрешений сертификаты в существующий серверный параметр HTTP, либо создать новый параметр HTTP. На следующем шаге мы будем список разрешений сертификат для параметра HTTP по умолчанию **appGatewayBackendHttpSettings**.

3. Выберите **appGatewayBackendHttpSettings**.

4. В разделе **протокол**выберите **HTTPS**. Появится панель для **внутренних сертификатов проверки подлинности или доверенных корневых сертификатов** . 

5. Выберите **создать**.

6. Введите подходящее **имя**.

7. Выберите файл сертификата с помощью поля **Отправить CER Certificate** .

   Для шлюзов приложений Standard и WAF (v1) необходимо передать открытый ключ сертификата внутреннего сервера в формате CER.

   ![аддцерт](./media/end-to-end-ssl-portal/addcert.png)

   Для шлюзов приложений Standard_v2 и WAF_v2 необходимо передать **корневой сертификат** сертификата внутреннего сервера в формате CER. Если серверный сертификат выдается известным центром сертификации, можно установить флажок "использовать хорошо известный сертификат ЦС" и не загружать сертификат.

   ![аддтрустедрутцерт](./media/end-to-end-ssl-portal/trustedrootcert-portal.png)

8. Щелкните **Сохранить**.

## <a name="next-steps"></a>Следующие шаги

> [!div class="nextstepaction"]
> [Руководство по управлению веб-трафиком с помощью шлюза приложений и Azure CLI](./tutorial-manage-web-traffic-cli.md)
