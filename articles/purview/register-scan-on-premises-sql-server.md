---
title: Регистрация и сканирование локального сервера SQL Server
description: В этом учебнике описывается проверка локального сервера SQL Server с помощью локальной среды IR.
author: viseshag
ms.author: viseshag
ms.service: purview
ms.subservice: purview-data-catalog
ms.topic: how-to
ms.date: 09/18/2020
ms.openlocfilehash: a807c76a08bf075973cd0f358c67b61b10b40ba0
ms.sourcegitcommit: 65db02799b1f685e7eaa7e0ecf38f03866c33ad1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/03/2020
ms.locfileid: "96554523"
---
# <a name="register-and-scan-an-on-premises-sql-server"></a>Регистрация и сканирование локального сервера SQL Server

В этой статье описано, как зарегистрировать источник данных SQL Server в зрения и настроить на нем проверку.

## <a name="supported-capabilities"></a>Поддерживаемые возможности

Локальный источник данных SQL Server поддерживает следующие функциональные возможности.

- **Полное и добавочное сканирование** для записи метаданных и классификации в локальной сети или на сервере SQL Server, установленном на виртуальной машине Azure.

- **Журнал преобразований** между ресурсами данных для операций копирования и потока ADF

Локальный источник данных SQL Server поддерживает:

- для каждой версии SQL Server 2019 назад к SQL Server 2000

- Метод проверки подлинности: проверка подлинности SQL

## <a name="prerequisites"></a>Предварительные требования

- Перед регистрацией источников данных создайте учетную запись Azure зрения. Дополнительные сведения о создании учетной записи зрения см. в разделе [Краткое руководство. Создание учетной записи Azure зрения](create-catalog-portal.md).

- Настройте локальную [среду выполнения интеграции](manage-integration-runtimes.md) для сканирования источника данных.

## <a name="setting-up-authentication-for-a-scan"></a>Настройка проверки подлинности при проверке

Существует только один способ настройки проверки подлинности для локальной среды SQL Server:

- Проверка подлинности SQL

### <a name="sql-authentication"></a>Проверка подлинности SQL

Удостоверение SQL должно иметь доступ к базе данных источника. Это расположение `sys.databases` хранится. Сканер зрения должен выполнить перечисление, `sys.databases` чтобы найти все экземпляры SQL DB на сервере.

#### <a name="using-an-existing-server-administrator"></a>Использование существующего администратора сервера

Если вы планируете использовать существующего пользователя администратора сервера (SA) для сканирования локального сервера SQL Server, убедитесь в следующем:

1. `sa` не является типом проверки подлинности Windows.

2. Пользователь уровня сервера, который вы планируете использовать, должен иметь роли сервера public и sysadmin. Чтобы проверить это, перейдите в SQL Server Management Studio (SSMS), подключитесь к серверу, перейдите к разделу Безопасность, выберите имя входа, которое вы планируете использовать, щелкните правой кнопкой мыши пункт **Свойства** и выберите пункт **роли сервера**.

   :::image type="content" source="media/register-scan-on-premises-sql-server/server-level-login.png" alt-text="Имя входа на уровне сервера.":::

3. Базы данных сопоставляются с пользователем, имеющим по крайней мере db_datareader доступ на уровне каждой базы данных.

   :::image type="content" source="media/register-scan-on-premises-sql-server/user-mapping-sa.png" alt-text="Сопоставление пользователей для SA.":::

#### <a name="creating-a-new-login-and-user"></a>Создание нового имени входа и пользователя

Если вы хотите создать новое имя входа и пользователя для проверки SQL Server, выполните следующие действия:

1. Перейдите к SQL Server Management Studio (SSMS), подключитесь к серверу, перейдите к разделу Безопасность, щелкните правой кнопкой мыши имя входа и создайте новое имя входа. Убедитесь, что выбрана проверка подлинности SQL.

   :::image type="content" source="media/register-scan-on-premises-sql-server/create-new-login-user.png" alt-text="Создайте новое имя входа и пользователя.":::

2. Выберите роли сервера в левой области навигации и выберите общедоступные и sysadmin.

3. Выберите сопоставление пользователей в левой области навигации и выберите все базы данных на карте.

   :::image type="content" source="media/register-scan-on-premises-sql-server/user-mapping.png" alt-text="Сопоставление пользователей.":::

4. Нажмите кнопку OK, чтобы сохранить изменения.

5. Снова перейдите к созданному пользователю, щелкнув правой кнопкой мыши и выбрав пункт **Свойства**. Введите новый пароль и подтвердите его. Выберите параметр "укажите старый пароль" и введите старый пароль. **Пароль необходимо изменить сразу после создания нового имени входа.**

   :::image type="content" source="media/register-scan-on-premises-sql-server/change-password.png" alt-text="изменение пароля.":::

#### <a name="storing-your-sql-login-password-in-a-key-vault-and-creating-a-credential-in-purview"></a>Хранение пароля имени входа SQL в хранилище ключей и создание учетных данных в зрения

1. Перейдите к хранилищу ключей в портал Azure
1. Выберите **параметры > секреты**
1. Выберите **+ создать/импортировать** и введите **имя** и **значение** в качестве *пароля* для имени входа SQL Server.
1. Выберите **создать** для завершения
1. Если хранилище ключей еще не подключено к зрения, вам потребуется [создать новое подключение к хранилищу ключей](manage-credentials.md#create-azure-key-vaults-connections-in-your-azure-purview-account) .
1. Наконец, [Создайте новые учетные данные](manage-credentials.md#create-a-new-credential) , используя **имя пользователя** и **пароль** , чтобы настроить проверку.

## <a name="register-a-sql-server-data-source"></a>Регистрация источника данных SQL Server

1. Перейдите к своей учетной записи зрения

1. В разделе источники и сканирование в левой области навигации выберите **среды выполнения интеграции**. Убедитесь, что настроена локальная среда выполнения интеграции. Если она не настроена, выполните описанные [здесь](manage-integration-runtimes.md) действия, чтобы создать локальную среду выполнения интеграции для проверки на локальной или виртуальной машине Azure, которая имеет доступ к локальной сети.

1. Выбор **источников** в левой области навигации

1. Нажмите кнопку **Зарегистрировать**.

1. Выберите **SQL Server** , а затем **Продолжайте**

   :::image type="content" source="media/register-scan-on-premises-sql-server/set-up-sql-data-source.png" alt-text="Настройте источник данных SQL.":::

5. Укажите понятное имя и конечную точку сервера, а затем нажмите кнопку **Готово** , чтобы зарегистрировать источник данных. Например, если полное доменное имя SQL Server — **foobar.Database.Windows.NET**, введите *foobar* в качестве конечной точки сервера.

[!INCLUDE [create and manage scans](includes/manage-scans.md)]

## <a name="next-steps"></a>Дальнейшие шаги

- [Обзор каталога данных Azure зрения](how-to-browse-catalog.md)
- [Поиск в каталоге данных Azure зрения](how-to-search-catalog.md)
