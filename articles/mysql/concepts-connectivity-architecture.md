---
title: Архитектура подключения к базе данных Azure для MySQL
description: Описывает архитектуру подключения для сервера базы данных Azure для MySQL.
author: kummanish
ms.author: manishku
ms.service: mysql
ms.topic: conceptual
ms.date: 03/16/2020
ms.openlocfilehash: 440007767835de4641fb828b41d572f35997acd2
ms.sourcegitcommit: d8b8768d62672e9c287a04f2578383d0eb857950
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2020
ms.locfileid: "88064474"
---
# <a name="connectivity-architecture-in-azure-database-for-mysql"></a>Архитектура подключения в базе данных Azure для MySQL
В этой статье описывается архитектура подключения к базе данных Azure для MySQL, а также сведения о том, как трафик направляется в базу данных Azure для экземпляра MySQL с клиентов как внутри, так и за пределами Azure.

## <a name="connectivity-architecture"></a>Архитектура подключения
Подключение к базе данных Azure для MySQL устанавливается через шлюз, который отвечает за маршрутизацию входящих подключений к физическому расположению сервера в наших кластерах. На следующей схеме показан поток трафика.

![Обзор архитектуры подключения](./media/concepts-connectivity-architecture/connectivity-architecture-overview-proxy.png)

Когда клиент подключается к базе данных, он получает строку подключения, которая подключается к шлюзу. Этот шлюз имеет общедоступный IP-адрес, который прослушивает порт 3306. В кластере базы данных трафик перенаправляется в соответствующую базу данных Azure для MySQL. Поэтому для подключения к серверу, например из корпоративных сетей, необходимо открыть брандмауэр на стороне клиента, чтобы разрешить исходящий трафик для доступа к нашим шлюзам. Ниже приведен полный список IP-адресов, используемых нашими шлюзами в каждом регионе.

## <a name="azure-database-for-mysql-gateway-ip-addresses"></a>IP-адреса шлюза базы данных Azure для MySQL
В следующей таблице перечислены основной и дополнительный IP-адреса шлюза базы данных Azure для MySQL для всех областей данных. Основным IP-адресом является текущий IP-адрес шлюза, а второй IP-адрес — это IP-адрес отработки отказа в случае сбоя первичной реплики. Как уже упоминалось, клиенты должны разрешать исходящие подключения к обоим IP-адресам. Второй IP-адрес не прослушивает службы, пока он не будет активирован службой "база данных Azure для MySQL" для приема подключений.

| **Имя региона** | **IP-адреса шлюза** |
|:----------------|:-------------|
| Центральная Австралия| 20.36.105.0     |
| Central2 Австралия     | 20.36.113.0   |
| Восточная Австралия | 13.75.149.87, 40.79.161.1     |
| Юго-Восточная Австралия |191.239.192.109, 13.73.109.251   |
| Brazil South | 104.41.11.5, 191.233.201.8, 191.233.200.16  |
| Центральная Канада |40.85.224.249  |
| Восточная Канада | 40.86.226.166    |
| Центральная часть США | 23.99.160.139, 13.67.215.62, 52.182.136.37, 52.182.136.38     |
| Восточный Китай | 139.219.130.35    |
| Восточный Китай 2 | 40.73.82.1  |
| Северный Китай | 139.219.15.17    |
| Северный Китай 2 | 40.73.50.0     |
| Восточная Азия | 191.234.2.139, 52.175.33.150, 13.75.33.20, 13.75.33.21     |
| Восточная часть США | 40.121.158.30, 191.238.6.43, 40.71.8.203, 40.71.83.113 |
| восточная часть США 2 |40.79.84.180, 191.239.224.107, 52.177.185.181, 40.70.144.38, 52.167.105.38  |
| Центральная Франция | 40.79.137.0, 40.79.129.1  |
| Южная Франция | 40.79.177.0     |
| Центральная Германия | 51.4.144.100     |
| Северо-восточная Германия | 51.5.144.179  |
| Центральная Индия | 104.211.96.159     |
| Южная Индия | 104.211.224.146  |
| Западная Индия | 104.211.160.80    |
| Japan East | 13.78.61.196, 191.237.240.43  |
| Западная Япония | 104.214.148.156, 191.238.68.11, 40.74.96.6, 40.74.96.7    |
| Республика Корея, центральный регион | 52.231.32.42   |
| Республика Корея, южный регион | 52.231.200.86    |
| Центрально-северная часть США | 23.96.178.199, 23.98.55.75, 52.162.104.35, 52.162.104.36    |
| Северная Европа | 40.113.93.91, 191.235.193.75, 52.138.224.6, 52.138.224.7    |
| Северная часть ЮАР;  | 102.133.152.0    |
| Западная часть ЮАР | 102.133.24.0   |
| Центрально-южная часть США |13.66.62.124, 23.98.162.75, 104.214.16.39, 20.45.120.0   |
| Юго-Восточная Азия | 104.43.15.0, 23.100.117.95, 40.78.233.2, 23.98.80.12     |
| Центральная часть ОАЭ. | 20.37.72.64  |
| Северная часть ОАЭ; | 65.52.248.0    |
| южная часть Соединенного Королевства | 51.140.184.11   |
| западная часть Соединенного Королевства | 51.141.8.11  |
| центрально-западная часть США | 13.78.145.25     |
| Западная Европа | 40.68.37.158, 191.237.232.75, 13.69.105.208, 104.40.169.187 |
| западная часть США | 104.42.238.205, 23.99.34.75, 13.86.216.212, 13.86.217.212 |
| западная часть США 2 | 13.66.226.202  |
||||

## <a name="connection-redirection"></a>Перенаправление соединения

База данных Azure для MySQL поддерживает дополнительную политику подключения, **Перенаправление**, которая помогает снизить задержку в сети между клиентскими приложениями и серверами MySQL. С помощью этой функции после установки начального сеанса TCP для сервера базы данных Azure для MySQL сервер возвращает внутренний адрес узла, на котором размещен сервер MySQL, клиенту. После этого все последующие пакеты поступают непосредственно на сервер, минуя шлюз. Так как пакеты поступают непосредственно на сервер, задержка и пропускная способность повышают производительность.

Эта функция поддерживается в базе данных Azure для серверов MySQL с версиями 5,6, 5,7 и 8,0.

Поддержка перенаправления доступна в расширении [MYSQLND_AZURE](https://github.com/microsoft/mysqlnd_azure) PHP, разработанном корпорацией Майкрософт и доступно в [PECL](https://pecl.php.net/package/mysqlnd_azure). Дополнительные сведения о том, как использовать перенаправление в приложениях, см. в статье [Настройка перенаправления](./howto-redirection.md) .

> [!IMPORTANT]
> Поддержка перенаправления в расширении PHP [mysqlnd_azure](https://github.com/microsoft/mysqlnd_azure) в настоящее время доступна в предварительной версии.

## <a name="next-steps"></a>Дальнейшие действия

* [Создание правил брандмауэра базы данных Azure для MySQL и управление ими с помощью портал Azure](./howto-manage-firewall-using-portal.md)
* [Создание правил брандмауэра базы данных Azure для MySQL и управление ими с помощью Azure CLI](./howto-manage-firewall-using-cli.md)
* [Настройка перенаправления с помощью базы данных Azure для MySQL](./howto-redirection.md)
