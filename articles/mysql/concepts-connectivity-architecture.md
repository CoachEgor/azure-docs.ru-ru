---
title: Архитектура подключения в базе данных Azure для MySQL
description: Описывает архитектуру подключения для сервера базы данных Azure для MySQL.
author: kummanish
ms.author: manishku
ms.service: mysql
ms.topic: conceptual
ms.date: 11/15/2019
ms.openlocfilehash: c4fecfadefedf10f7e11534b4efbd197c4d7fdae
ms.sourcegitcommit: d6b68b907e5158b451239e4c09bb55eccb5fef89
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/20/2019
ms.locfileid: "74213149"
---
# <a name="connectivity-architecture-in-azure-database-for-mysql"></a>Архитектура подключения в базе данных Azure для MySQL
В этой статье описывается архитектура подключения к базе данных Azure для MySQL, а также сведения о том, как трафик направляется в базу данных Azure для экземпляра MySQL с клиентов как внутри, так и за пределами Azure.

## <a name="connectivity-architecture"></a>Архитектура подключения
Подключение к базе данных Azure для MySQL устанавливается через шлюз, который отвечает за маршрутизацию входящих подключений к физическому расположению сервера в наших кластерах. На следующей схеме показан поток трафика.

![Обзор архитектуры подключения](./media/concepts-connectivity-architecture/connectivity-architecture-overview-proxy.png)

Когда клиент подключается к базе данных, он получает строку подключения, которая подключается к шлюзу. Этот шлюз имеет общедоступный IP-адрес, который прослушивает порт 3306. В кластере базы данных трафик перенаправляется в соответствующую базу данных Azure для MySQL. Поэтому для подключения к серверу, например из корпоративных сетей, необходимо открыть брандмауэр на стороне клиента, чтобы разрешить исходящий трафик для доступа к нашим шлюзам. Ниже приведен полный список IP-адресов, используемых нашими шлюзами в каждом регионе.

## <a name="azure-database-for-mysql-gateway-ip-addresses"></a>IP-адреса шлюза базы данных Azure для MySQL
В следующей таблице перечислены основной и дополнительный IP-адреса шлюза базы данных Azure для MySQL для всех областей данных. Основным IP-адресом является текущий IP-адрес шлюза, а второй IP-адрес — это IP-адрес отработки отказа в случае сбоя первичной реплики. Как уже упоминалось, клиенты должны разрешать исходящие подключения к обоим IP-адресам. Второй IP-адрес не прослушивает службы, пока он не будет активирован службой "база данных Azure для MySQL" для приема подключений.

| **Имя региона** | **Основной IP-адрес** | **Дополнительный IP-адрес** |
|:----------------|:-------------|:------------------------|
| Восточная часть Австралии | 13.75.149.87 | 40.79.161.1 |
| Юго-Восточная Австралия | 191.239.192.109 | 13.73.109.251 |
| Южная Бразилия | 104.41.11.5 | |
| Центральная Канада | 40.85.224.249 | |
| Восточная Канада | 40.86.226.166 | |
| Central US | 23.99.160.139 | 13.67.215.62 |
| Восточный Китай 1 | 139.219.130.35 | |
| Восточный Китай 2 | 40.73.82.1 | |
| Северный Китай 1 | 139.219.15.17 | |
| Северный Китай 2 | 40.73.50.0 | |
| Восточная Азия | 191.234.2.139 | 52.175.33.150 |
| Восточная часть США 1 | 191.238.6.43 | 40.121.158.30 |
| Восток США 2 | 191.239.224.107 | 40.79.84.180 * |
| Центральная Франция | 40.79.137.0 | 40.79.129.1 |
| Центральная Германия | 51.4.144.100 | |
| Центральная Индия | 104.211.96.159 | |
| Южная Индия | 104.211.224.146 | |
| Западная Индия | 104.211.160.80 | |
| Восточная часть Японии | 191.237.240.43 | 13.78.61.196 |
| Западная часть Японии | 191.238.68.11 | 104.214.148.156 |
| Центральная Корея | 52.231.32.42 | |
| Южная Корея | 52.231.200.86 |  |
| Центрально-северная часть США | 23.98.55.75 | 23.96.178.199 |
| Северная Европа | 191.235.193.75 | 40.113.93.91 |
| Центрально-южная часть США | 23.98.162.75 | 13.66.62.124 |
| Юго-Восточная Азия | 23.100.117.95 | 104.43.15.0 |
| Северная часть ЮАР; | 102.133.152.0 | |
| Западная часть ЮАР | 102.133.24.0 | |
| Северная часть ОАЭ; | 65.52.248.0 | |
| Южная часть Великобритании | 51.140.184.11 | |
| Западная часть Великобритании | 51.141.8.11| |
| Западная Европа | 191.237.232.75 | 40.68.37.158 |
| Западная часть США 1 | 23.99.34.75 | 104.42.238.205 |
| Западный регион США 2 | 13.66.226.202 | |
||||

> [!NOTE]
> В регионе *Восточная часть США 2* также доступен третичный IP-адрес `52.167.104.0`.

## <a name="connection-redirection"></a>Перенаправление соединения

База данных Azure для MySQL поддерживает дополнительную политику подключения, **Перенаправление**, которая помогает снизить задержку в сети между клиентскими приложениями и серверами MySQL. С помощью этой функции после установки начального сеанса TCP для сервера базы данных Azure для MySQL сервер возвращает внутренний адрес узла, на котором размещен сервер MySQL, клиенту. После этого все последующие пакеты поступают непосредственно на сервер, минуя шлюз. Так как пакеты поступают непосредственно на сервер, задержка и пропускная способность повышают производительность.

Эта функция поддерживается в базе данных Azure для серверов MySQL с версиями 5,6, 5,7 и 8,0.

Поддержка предварительной версии для перенаправления доступна в расширении [Mysqlnd_azure PHP](https://github.com/microsoft/mysqlnd_azure) , разработанном корпорацией Майкрософт и доступно в [PECL](https://pecl.php.net/package/mysqlnd_azure). Дополнительные сведения о том, как использовать перенаправление в приложениях, см. в статье [Настройка перенаправления](./howto-redirection.md) . 

## <a name="next-steps"></a>Дополнительная информация

* [Создание правил брандмауэра базы данных Azure для MySQL и управление ими с помощью портала Azure](./howto-manage-firewall-using-portal.md)
* [Создание правил брандмауэра базы данных Azure для MySQL и управление ими с помощью Azure CLI](./howto-manage-firewall-using-cli.md)