---
title: Создание фабрики изображений в Лабораториях Azure DevTest (ru) Документы Майкрософт
description: В этой статье показано, как настроить фабрику пользовательских изображений с помощью образца скриптов, доступных в репозитории Git (Azure DevTest Labs).
services: devtest-lab, lab-services
documentationcenter: na
author: spelluru
manager: femila
ms.service: lab-services
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 01/24/2020
ms.author: spelluru
ms.openlocfilehash: 2c5a44a9505d4a312be521cdc3219c5e4ce95a42
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/27/2020
ms.locfileid: "76759454"
---
# <a name="create-a-custom-image-factory-in-azure-devtest-labs"></a>Создание фабрики пользовательских изображений в Лабораториях Azure DevTest
В этой статье показано, как настроить фабрику пользовательских изображений с помощью образца скриптов, доступных в [репозитории Git.](https://github.com/Azure/azure-devtestlab/tree/master/samples/DevTestLabs/Scripts/ImageFactory)

## <a name="whats-an-image-factory"></a>Что такое фабрика изображений?
Фабрика изображений — это решение конфигурации как кода, которое автоматически создает и распределяет изображения на регулярной основе со всеми желаемыми конфигурациями. Изображения на фабрике изображений всегда актуальны, а текущее техническое обслуживание почти равно нулю после автоматизации всего процесса. И, поскольку все необходимые конфигурации уже находятся в изображении, это экономит время от ручной настройки системы после создания VM с базовой ОС.

Значительный ускоритель для получения рабочего стола разработчика в готовое состояние в DevTest Labs использует пользовательские изображения. Недостатком пользовательских изображений является то, что есть что-то дополнительно для поддержания в лаборатории. Например, пробные версии продуктов истекают с течением времени (или) недавно выпущенные обновления безопасности не применяются, что заставляет нас периодически обновлять пользовательское изображение. С фабрикой изображений у вас есть определение изображения, проверенного на управление исходным кодом, и автоматизированный процесс создания пользовательских изображений на основе определения.

Решение позволяет ускорить создание виртуальных машин из пользовательских изображений, устраняя при этом дополнительные текущие расходы на техническое обслуживание. С помощью этого решения вы можете автоматически создавать пользовательские изображения, распространять их в других лабораториях DevTest и удалить старые изображения. В следующем видео вы узнаете о фабрике изображений и о том, как она реализуется с DevTest Labs.  Все скрипты Azure Powershell находятся в [https://aka.ms/dtlimagefactory](https://aka.ms/dtlimagefactory)свободном доступе и расположены здесь: .

<br/>

> [!VIDEO https://channel9.msdn.com/Blogs/Azure/Custom-Image-Factory-with-Azure-DevTest-Labs/player]


## <a name="high-level-view-of-the-solution"></a>Представление решения на высоком уровне
Решение позволяет ускорить создание виртуальных машин из пользовательских изображений, устраняя при этом дополнительные текущие расходы на техническое обслуживание. С помощью этого решения вы можете автоматически создавать пользовательские изображения и распространять их в других Лабораториях DevTest Labs. Вы используете Azure DevOps (ранее Visual Studio Team Services) в качестве движка оркестровки для автоматизации всех операций в DevTest Labs.

![Представление решения на высоком уровне](./media/create-image-factory/high-level-view-of-solution.png)

Для [DevTest Labs есть расширение VSTS,](https://marketplace.visualstudio.com/items?itemName=ms-azuredevtestlabs.tasks) которое позволяет выполнять следующие отдельные действия:

- Создание пользовательского образа
- Создание виртуальной машины
- Удаление виртуальной машины
- Создание среды
- Удалить среду
- Заполнить окружающую среду

Использование расширения DevTest Labs — это простой способ начать работу с автоматического создания пользовательских изображений в DevTest Labs.

Существует альтернативная реализация с использованием сценария PowerShell для более сложного сценария. С помощью PowerShell вы можете полностью автоматизировать фабрику изображений на основе DevTest Labs, которая может быть использована в вашей непрерывной интеграции и непрерывной доставке (CI/CD) инструментария. Принципы, которые следуют в этом альтернативном решении:

- Общие обновления не должны требовать внесения изменений в фабрику изображений. (например, добавление нового типа пользовательского изображения, автоматические выходящие на пенсию старые изображения, добавление новой «конечной точки» DevTest Labs для получения пользовательских изображений и так далее.)
- Общие изменения поддерживаются контролем исходного кода (инфраструктура как код)
- DevTest Labs, получающие пользовательские изображения, могут находиться не в той же подписке Azure (лаборатории охватывают подписки)
- PowerShell скрипты должны быть многоразовые, чтобы мы могли спина дополнительных заводов по мере необходимости

## <a name="next-steps"></a>Дальнейшие действия
Перейдите к следующей статье в этом разделе: [Выполнить изображение завода из Azure DevOps](image-factory-set-up-devops-lab.md)
