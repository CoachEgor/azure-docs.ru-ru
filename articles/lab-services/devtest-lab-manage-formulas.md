---
title: Управление формулами в Azure DevTest Labs для создания виртуальных машин | Документация Майкрософт
description: В этой статье показано, как создать формулу из базового образа (пользовательского образа, образа Marketplace или другой формулы) или существующей виртуальной машины.
services: devtest-lab,virtual-machines,lab-services
documentationcenter: na
author: spelluru
manager: femila
editor: ''
ms.assetid: 841dd95a-657f-4d80-ba26-59a9b5104fe4
ms.service: lab-services
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 01/24/2020
ms.author: spelluru
ms.openlocfilehash: a668c1f7cf401c109c1041232d7f28dd2accd750
ms.sourcegitcommit: b5d646969d7b665539beb18ed0dc6df87b7ba83d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/26/2020
ms.locfileid: "76760408"
---
# <a name="manage-azure-devtest-labs-formulas"></a>Управление формулами Azure DevTest Labs

[!INCLUDE [devtest-lab-formula-definition](../../includes/devtest-lab-formula-definition.md)]

В этой статье показано, как создать формулу из базового образа (пользовательского образа, образа Marketplace или другой формулы) или существующей виртуальной машины. В этой статье также объясняется, как управлять существующими формулами.

## <a name="create-a-formula"></a>Создание формулы
Любой пользователь, имеющий разрешения роли *Пользователь* DevTest Labs, может создавать виртуальные машины на основе формул. Формулы можно создавать двумя способами. 

* Из базового образа — используйте этот способ, если хотите задать все характеристики формулы.
* На основе существующей виртуальной машины — используйте этот способ, если хотите создать формулу на основе параметров существующей виртуальной машины.

Дополнительные сведения о добавлении пользователей и разрешений см. в статье [Добавление владельцев и пользователей в Azure DevTest Labs](./devtest-lab-add-devtest-user.md).

### <a name="create-a-formula-from-a-base"></a>Создание формулы из базового образа
Ниже приведены пошаговые инструкции по созданию формулы на основе пользовательского образа, образа Marketplace или другой формулы.

1. Войдите на [портал Azure](https://go.microsoft.com/fwlink/p/?LinkID=525040).

2. Щелкните **Все службы** и выберите в списке **DevTest Labs**.

3. Из списка лабораторий выберите нужную лабораторию.  

4. На странице лаборатории выберите **Formulas (reusable bases)** (Формулы (базовые образы, используемые повторно)).
   
    ![Меню формулы](./media/devtest-lab-create-formulas/lab-settings-formulas.png)

5. На странице **Формулы** выберите **+ Добавить**.
   
    ![Добавление формулы](./media/devtest-lab-create-formulas/add-formula.png)

6. На странице **Choose a base** (Выбор базового образа) выберите базовый образ (пользовательский образ, образ Marketplace или формулу), на основе которого нужно создать формулу.
   
    ![Список базовых образов](./media/devtest-lab-create-formulas/base-list.png)

7. Во вкладке **Основные параметры** на странице **создания формулы** укажите следующие значения.
   
    * **Имя формулы** — введите имя формулы. Это значение отображается в списке базовых образов при создании виртуальной машины. Имя проверяется по мере ввода. Если оно недопустимо, появляется сообщение с указанием требований к именам.
    * **Имя пользователя** — введите имя пользователя, которому будут предоставлены права администратора.
    * **Пароль** — введите или выберите из раскрывающегося списка значение, связанное с секретом (паролем), которое будет применяться для указанного пользователя. См. дополнительные сведения о [хранении секретов в Azure Key Vault и их использовании их при создании ресурсов лаборатории](devtest-lab-store-secrets-in-key-vault.md).
    * **Размер виртуальной машины** — выберите **Изменить размер**, чтобы изменить размер виртуальной машины. 
    * **Артефакты** — выберите страницу **Добавление/удаление артефактов**, где можно выбрать и настроить артефакты, которые нужно добавить в базовый образ. Дополнительные сведения об артефактах см. в статье о [создании настраиваемых артефактов для виртуальной машины Azure DevTest Labs](devtest-lab-artifact-author.md).
8. Переключитесь на вкладку **Дополнительные параметры** и укажите следующие значения.
    - **Виртуальная сеть** — чтобы изменить виртуальную сеть, щелкните **Изменить виртуальную сеть**. 
    - **Подсеть** — чтобы изменить подсеть, выберите **Изменить подсеть**. 
    - **Настройка IP-адреса** — укажите, какие IP-адреса необходимо использовать (общедоступные, частные или общие). Дополнительные сведения см. в статье [Общие IP-адреса в Azure DevTest Labs](./devtest-lab-shared-ip.md).
    - **Expiration date and time** (Дата и время окончания срока действия) — укажите дату и время окончания срока действия виртуальной машины, чтобы она автоматически удалилась. 
    - **Make this machine claimable** (Разрешить запрашивать эту виртуальную машину) — этот параметр означает, что при создании виртуальной машины права владения не будут назначаться. Вместо этого пользователи лаборатории смогут становиться владельцами этой виртуальной машины ("запрашивать" ее) на странице лаборатории.     
    - **Количество** запрашиваемых экземпляров — укажите количество запрашиваемых экземпляров, которые требуется создать. 
8. Для создания формулы выберите **Отправить**.

9. Когда формула создана, она отображается на странице **Формулы**.

### <a name="create-a-formula-from-a-vm"></a>Создание формулы на основе виртуальной машины
Ниже приводятся пошаговые инструкции по созданию формулы на основе существующей виртуальной машины. 

> [!NOTE]
> Для создания формулы на основе виртуальной машины необходимо, чтобы эта виртуальная машина была создана после 30 марта 2016 г. 
> 
> 

1. Войдите на [портал Azure](https://go.microsoft.com/fwlink/p/?LinkID=525040).
2. Щелкните **Все службы** и выберите в списке **DevTest Labs**.
3. Из списка лабораторий выберите нужную лабораторию.  
4. На странице **Обзор** выберите виртуальную машину, на основе которой будет создана формула.
   
    ![Лабораторные виртуальные машины](./media/devtest-lab-create-formulas/my-vms.png)
5. На странице виртуальной машины выберите **Create formula (reusable base)** (Создать формулу (базовый образ, используемый повторно)).
   
    ![Создание формулы](./media/devtest-lab-create-formulas/create-formula-menu.png)
6. На странице **Create formula** (Создание формулы) введите **имя** и **описание** новой формулы в соответствующих полях.
   
    ![Страница создания формулы](./media/devtest-lab-create-formulas/create-formula-blade.png)
7. Нажмите кнопку **ОК** , чтобы создать формулу.

## <a name="modify-a-formula"></a>Изменение формулы
Чтобы изменить формулу, выполните указанные ниже действия.

1. Войдите на [портал Azure](https://go.microsoft.com/fwlink/p/?LinkID=525040).
2. Щелкните **Все службы** и выберите в списке **DevTest Labs**.
3. Из списка лабораторий выберите нужную лабораторию.  
4. На странице лаборатории выберите **Formulas (reusable bases)** (Формулы (базовые образы, используемые повторно)).
   
    ![Меню формулы](./media/devtest-lab-manage-formulas/lab-settings-formulas.png)
5. На странице **Lab formulas** (Формулы лаборатории) выберите формулу, которую нужно изменить.
6. На странице **Изменить формулу** внесите необходимые изменения и щелкните **Обновить**.

## <a name="delete-a-formula"></a>Удаление формулы
Чтобы удалить формулу, выполните указанные ниже действия.

1. Войдите на [портал Azure](https://go.microsoft.com/fwlink/p/?LinkID=525040).
2. Щелкните **Все службы** и выберите в списке **DevTest Labs**.
3. Из списка лабораторий выберите нужную лабораторию.  
4. На странице **параметров** лаборатории выберите **Формулы**.
   
    ![Меню формулы](./media/devtest-lab-manage-formulas/lab-settings-formulas.png)
5. На странице **Lab formulas** (Формулы лаборатории) щелкните многоточие справа от формулы, которую нужно удалить.
   
    ![Меню формулы](./media/devtest-lab-manage-formulas/lab-formulas-blade.png)
6. В контекстном меню формулы выберите **Удалить**.
   
    ![Контекстное меню формулы](./media/devtest-lab-manage-formulas/formula-delete-context-menu.png)
7. В диалоговом окне подтверждения удаления нажмите кнопку **Да** .

[!INCLUDE [devtest-lab-try-it-out](../../includes/devtest-lab-try-it-out.md)]

## <a name="related-blog-posts"></a>Связанные записи в блогах
* [Custom images or formulas? (Пользовательские изображения или формулы?)](https://blogs.msdn.microsoft.com/devtestlab/2016/04/06/custom-images-or-formulas/)

## <a name="next-steps"></a>Дальнейшие действия
После создания формулы, которая служит для создания виртуальных машин, можно [добавить виртуальную машину в лабораторию](devtest-lab-add-vm.md).

