---
title: Создание лаборатории с общим ресурсом | Службы лаборатории Azure
description: Узнайте, как создать лабораторию, для которой требуется общий ресурс учащихся.
author: emaher
ms.topic: article
ms.date: 06/26/2020
ms.author: enewman
ms.openlocfilehash: 9cb5698f95aa220208fb02a35a52ff5363a173ac
ms.sourcegitcommit: 877491bd46921c11dd478bd25fc718ceee2dcc08
ms.contentlocale: ru-RU
ms.lasthandoff: 07/02/2020
ms.locfileid: "85443372"
---
# <a name="how-to-create-a-lab-with-a-shared-resource-in-azure-lab-services"></a>Создание лаборатории с общим ресурсом в службах лаборатории Azure

Иногда при создании лаборатории для занятий могут существовать некоторые ресурсы, которые должны быть общими для всех учащихся в лаборатории.  Например, имеется сервер лицензирования или SQL Server для класса базы данных.  В этой статье рассматриваются действия по включению общего ресурса для лаборатории.  Мы также поговорим о том, как ограничить доступ к этому общему ресурсу.

## <a name="architecture"></a>Architecture

Как показано на схеме ниже, у нас будет учетная запись лаборатории с лабораторией.  У учетной записи лаборатории будут параметры пиринга виртуальной сети, поэтому виртуальная сеть для лаборатории будет подключена к сети общего ресурса.  На приведенной ниже схеме есть две виртуальные сети с перекрывающимся диапазонами IP-адресов.  Эти диапазоны IP-адресов представляют собой примеры диапазонов.  Также обратите внимание, что виртуальная сеть общих ресурсов находится в той же подписке, что и учетная запись лаборатории.

![Службы лаборатории с архитектурой общих ресурсов](./media/how-to-create-a-lab-with-shared-resource/shared-resource-architecture.png)

## <a name="setup-shared-resource"></a>Настройка общего ресурса

Перед созданием лаборатории необходимо создать виртуальную сеть для общего ресурса.  Дополнительные сведения о создании виртуальной сети см. в статье [Создание виртуальной сети](../virtual-network/quick-create-portal.md).  Планирование диапазонов виртуальных сетей так, чтобы они не перекрывались с IP-адресом компьютеров лаборатории.  Дополнительные сведения о планировании сети см. в статье Планирование [виртуальных сетей](../virtual-network/virtual-network-vnet-plan-design-arm.md) . В нашем примере общий ресурс находится в виртуальной сети с диапазоном 10.2.0.0/16.  Если это еще не сделано, [Создайте подсеть](../virtual-network/virtual-network-manage-subnet.md#add-a-subnet) для хранения общего ресурса.  В этом примере используется диапазон 10.2.0.0/24, но диапазон может отличаться в зависимости от потребностей сети.

Общий ресурс может быть программным обеспечением, работающим на виртуальной машине или в предоставляемой Azure службе. Общий ресурс должен быть доступен через частный IP-адрес.  Делая общий доступ доступным только через частный IP-адрес, вы ограничиваете доступ к этому общему ресурсу.

На схеме также показана группа безопасности сети (NSG), которую можно использовать для ограничения трафика, поступающего от виртуальной машины учащихся.  Например, можно написать правило безопасности, которое указывает, что трафик с IP-адресов виртуальной машины учащихся может получить доступ только к одному общему ресурсу и ничего другого.  Дополнительные сведения о настройке правил безопасности см. в разделе [Управление группой безопасности сети](../virtual-network/manage-network-security-group.md#work-with-security-rules). Если вы хотите ограничить доступ к общему ресурсу для определенной лаборатории, получите IP-адрес лаборатории из [параметров лаборатории из учетной записи лаборатории](manage-labs.md#view-labs-in-a-lab-account) и задайте правило входящего трафика, разрешающее доступ только с этого IP-адреса.  Не забудьте разрешить порты 49152 — 65535 для этого IP-адреса.  При необходимости можно найти частный IP-адрес виртуальных машин учащихся, используя [страницу пула виртуальных машин](how-to-set-virtual-machine-passwords.md).

Если общий ресурс является виртуальной машиной Azure, на которой выполняется необходимое программное обеспечение, может потребоваться изменить правила брандмауэра по умолчанию для виртуальной машины.

## <a name="lab-account"></a>Учетная запись лаборатории

Чтобы использовать общий ресурс, учетная запись лаборатории должна быть настроена для использования [одноранговой виртуальной сети](how-to-connect-peer-virtual-network.md).  В этом случае мы будем пиринга с виртуальной сетью, содержащей общий ресурс.

>[!WARNING]
>Лаборатория для класса должна быть создана после того, **как** учетная запись лаборатории будет соединена с виртуальной сетью общих ресурсов.  
Компьютер шаблона

После того как учетная запись лаборатории будет соединена с виртуальной сетью, компьютер-шаблон теперь должен иметь доступ к общему ресурсу.  Может потребоваться обновить правила брандмауэра в зависимости от общего ресурса, к которому осуществляется доступ.
