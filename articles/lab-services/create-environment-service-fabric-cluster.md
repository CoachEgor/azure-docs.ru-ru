---
title: Создание кластерной среды service Fabric в Лабораториях Azure DevTest
description: Узнайте, как создать среду с автономным кластером Service Fabric, а также запустить и остановить кластер с помощью графиков.
services: devtest-lab,virtual-machines,lab-services
documentationcenter: na
author: EMaher
manager: femila
editor: spelluru
ms.assetid: ''
ms.service: lab-services
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 01/16/2020
ms.author: enewman
ms.openlocfilehash: 71793b81d8735c80881fc25a9b7ec31bc4fc6762
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/27/2020
ms.locfileid: "76170342"
---
# <a name="create-an-environment-with-self-contained-service-fabric-cluster-in-azure-devtest-labs"></a>Создание среды с автономным кластером Service Fabric в Лабораториях Azure DevTest
В этой статье приводится информация о том, как создать среду с автономным кластером Service Fabric в Лабораториях Azure DevTest Labs. 

## <a name="overview"></a>Обзор
DevTest Labs могут создавать автономные тестовые среды, определенные шаблонами управления ресурсами Azure. Эти среды содержат как ресурсы IaaS, такие как виртуальные машины, так и ресурсы PaaS, такие как Service Fabric. DevTest Labs позволяет управлять виртуальными машинами в среде, предоставляя команды для управления виртуальными машинами. Эти команды дают вам возможность запустить или остановить виртуальную машину по расписанию. Аналогичным образом, DevTest Labs также может помочь вам управлять кластерами Service Fabric в среде. Вы можете запустить или остановить кластер Service Fabric в среде либо вручную, либо по расписанию.

## <a name="create-a-service-fabric-cluster"></a>Создание кластера Service Fabric
Кластеры service Fabric создаются с использованием сред в DevTest Labs. Каждая среда определяется шаблоном менеджера ресурсов Azure в репозитории Git. [Общедоступное репозиторий Git](https://github.com/Azure/azure-devtestlab/tree/master/Environments/) для DevTest Labs содержит шаблон менеджера ресурсов для создания кластера Service Fabric в папке [ServiceFabric-Cluster.](https://github.com/Azure/azure-devtestlab/tree/master/Environments/ServiceFabric-LabCluster) 

1. Во-первых, создайте лабораторию в Лабораториях Azure DevTest, используя инструкции в следующей статье: [Создайте лабораторию](devtest-lab-create-lab.md). Обратите внимание, что опция **«Общедоступная среда»** **работает** по умолчанию. 
2. Подтвердите, что поставщик Услуги Fabric зарегистрирован для вашей подписки, выдыхая следующие действия:
    1. Выберите **подписку** в левом навигационном меню и выберите **подписку**
    2. На странице **подписки** выберите **поставщиков ресурсов** в разделе **«Настройки»** в левом меню. 
    3. Если **Microsoft.ServiecFabric** не зарегистрирован, выберите **Регистр**. 
3. На странице **DevTest Lab** созданной лаборатории выберите **+ Добавить** на панели инструментов. 
    
    ![Добавить кнопку на панели инструментов](./media/create-environment-service-fabric-cluster/add-button.png)
3. На **странице «Выбрать базовую** страницу» выберите **кластер Service Fabric Lab** в списке. 

    ![Выберите сервисНый кластер Fabric Lab в списке](./media/create-environment-service-fabric-cluster/select-service-fabric-cluster.png)
4. На странице **настройки настройки** сделайте следующие действия: 
    1. Укажите **имя** для **среды**кластера. Это название группы ресурсов в Azure, в которой будет создан кластер Service Fabric. 
    2. Выберите **операционную систему (ОС)** для кластерных виртуальных машин. Значение по умолчанию: **Windows**.
    3. Укажите имя **администратора** кластера. 
    4. Укажите **пароль** для администратора. 
    5. Для **сертификата**введите информацию о сертификате в виде закодированной строки Base64. Чтобы создать сертификат, сделайте следующие действия:
        1. Загрузите файл **Create-ClusterCertificate.ps1** из [репозитория Git.](https://github.com/Azure/azure-devtestlab/tree/master/Environments/ServiceFabric-LabCluster) Кроме того, клонируйте репозиторий на вашей машине. 
        2. Запустите **PowerShell**. 
        3. Выполнить файл **ps1** `.\Create-ClusterCertificate.ps1`с помощью команды. Вы видите текстовый файл, открытый в блокноте с информацией, необходимой для заполнения полей, связанных с сертификатом, на этой странице. . 
    6. Введите **пароль для сертификата**.
    7. Укажите **отпечаток пальца** для сертификата.
    8. Выберите **Добавить** на странице **Настройка Настройки.** 

        ![Настройка параметров кластера](./media/create-environment-service-fabric-cluster/configure-settings.png)
5. После создания кластера можно увидеть группу ресурсов с именем среды, предоставленной на предыдущем этапе. При расширении вы видите кластер Service Fabric. Если состояние группы ресурсов застряло при **создании,** выберите **Обновление** на панели инструментов. Кластерная среда **Service Fabric** создает кластер с 5-узловой 1-узловой на Linux или Windows.

    В следующем примере **mysfabricclusterrg** — это название группы ресурсов, созданной специально для кластера Service Fabric. Важно отметить, что лабораторные среды являются автономными в группе ресурсов, в которой они создаются. Это означает, что шаблон, определяющий среду, который может получить доступ только к ресурсам в недавно созданной группе ресурсов или [виртуальным сетям, настроенным для использования в лаборатории.](devtest-lab-configure-vnet.md) Вышеприведенный выборец создает все необходимые ресурсы в одной и той же группе ресурсов.

    ![Созданный кластер](./media/create-environment-service-fabric-cluster/cluster-created.png)

## <a name="start-or-stop-the-cluster"></a>Запуск или остановка кластера
Вы можете начать или остановить кластер либо со страницы DevTest Lab, либо со страницы кластера Service Fabric Cluster, предоставленной DevTest Labs. 

### <a name="from-the-devtest-lab-page"></a>Со страницы Лаборатории DevTest
Вы можете запустить или остановить кластер на странице DevTest Lab для вашей лаборатории. 

1. Выберите **три точки (...)** для кластера Service Fabric, показанного на следующем изображении: 

    ![Команды запуска и остановки кластера](./media/create-environment-service-fabric-cluster/start-stop-on-devtest-lab-page.png)

2. В меню контекста можно увидеть две команды для **запуска** и **остановки** кластера. Команда запуска всех узлов запускается в кластере. Команда остановки останавливает все узлы в кластере. После остановки кластера сам кластер Service Fabric остается в готовом состоянии, но узлы не доступны до переизданной в кластере в лаборатории.

    При использовании кластера Service Fabric в тестовой среде следует отметить несколько соображений. После перезапуска узлов кластеру Service Fabric может потребоваться некоторое время. Чтобы сохранить данные от выключения до запуска, данные должны быть сохранены на управляемом диске, подключенном к виртуальной машине. При использовании присоединенного управляемого диска существуют последствия для производительности, поэтому рекомендуется использовать только для тестовых сред. Если диск, используемый для хранения данных, не поддерживается, данные теряются при выдаче команды стоп-команды в кластере.

### <a name="from-the-service-fabric-cluster-page"></a>Со страницы кластера сервисной ткани 
Существует еще один способ, чтобы начать или остановить кластер. 

1. Выберите кластер Service Fabric в представлении дерева на странице DevTest Lab. 

    ![Выберите кластер](./media/create-environment-service-fabric-cluster/select-cluster.png)

2. На странице **кластера Service Fabric Cluster—** на панели инструментов можно увидеть команды для запуска или остановки кластера. 

    ![Запуск или остановка команд на странице кластера service Fabric](./media/create-environment-service-fabric-cluster/start-stop-on-cluster-page.png)

## <a name="configure-auto-startup-and-auto-shutdown-schedule"></a>Настройка автоматического запуска и графика автоматического выключения
Кластеры Service Fabric также могут быть запущены или остановлены по расписанию. Этот опыт похож на опыт для виртуальных машин в лаборатории. Чтобы сэкономить деньги, по умолчанию каждый кластер, созданный в лаборатории, автоматически выключается в момент, определяемый [политикой закрытия](devtest-lab-set-lab-policy.md?#set-auto-shutdown-policy)лаборатории. Можно переопределить, указав, следует ли закрыть кластер, или указав время выключения кластера. 

![Существующие графики автоматического запуска и автоматического отключения](./media/create-environment-service-fabric-cluster/existing-schedules.png)

### <a name="opt-in-to-the-auto-start-schedule"></a>Выберите в график автоматического начала
Чтобы выбрать в график евки, сделайте следующие шаги:

1. Выберите **автозапуск** в левом меню
2. Выберите **On** для **Разрешить этот кластер ткани службы, который будет запланирован для автоматического запуска.** Эта страница включена только в том случае, если владелец лаборатории разрешил пользователям автоматически запускать свои виртуальные машины или кластеры Service Fabric.
3. На панели инструментов щелкните **Сохранить**. 

    ![Страница звезды авто](./media/create-environment-service-fabric-cluster/set-auto-start-settings.png)

### <a name="configure-auto-shutdown-settings"></a>Настройка параметров автоматического выключения 
Чтобы изменить настройки для выключения, сделайте следующие действия:

1. Выберите **автоматическое выключение** в левом меню. 
2. На этой странице можно отказаться от автоматического выключения, выбрав **Off** для **Enabled.** 
3. Если вы выбрали **On** для **Enabled,** выполните следующие действия:
    1. Укажите **время** завершения работы.
    2. Укажите **часовой пояс** на время. 
    3. Укажите, хотите ли вы, чтобы DevTest Labs отправляли **уведомления** до автоматического отключения. 
    4. Если вы выбрали **«Да»** для опции уведомления, укажите **URL-адрес Webhook** и/или **адрес электронной почты** для отправки уведомлений. 
    5. На панели инструментов щелкните **Сохранить**.

        ![Авто выключить страницу](./media/create-environment-service-fabric-cluster/auto-shutdown-settings.png)

## <a name="to-view-nodes-in-the-service-fabric-cluster"></a>Просмотр узлов в кластере Service Fabric
Страница кластера Service Fabric, которая была замечена ранее на шагах, специфична для страницы DevTest Labs. Он не показывает узлы в кластере. Чтобы узнать больше о кластере, выполните следующие действия:

1. На странице **DevTest Lab** для вашей лаборатории выберите **группу ресурсов** в представлении дерева в разделе **Мои виртуальные машины.**

    ![Выбор группы ресурсов](./media/create-environment-service-fabric-cluster/select-resource-group.png)
2. На странице **группы ресурсов** в списке можно увидеть все ресурсы группы ресурсов. Выберите **кластер Service Fabric** из списка. 

    ![Выберите кластер в списке](./media/create-environment-service-fabric-cluster/select-cluster-resource-group-page.png)
3. Для кластера можно увидеть страницу **кластера Service Fabric Cluster.** Это страница, которую предоставляет Ткань службы. Вы видите всю информацию о кластерах, таких как узлы, типы узлов и т.д.

    ![Обслуживание Ткань Кластер главная страница](./media/create-environment-service-fabric-cluster/service-fabric-cluster-page.png)

## <a name="next-steps"></a>Дальнейшие действия
Подробности о средах смотрите следующие статьи: 

- [Создание сред со множеством виртуальных машин и ресурсов PaaS с помощью шаблонов Azure Resource Manager](devtest-lab-create-environment-from-arm.md)
- [Настройка и использование общедоступных сред в Azure DevTest Labs](devtest-lab-configure-use-public-environments.md)
