---
title: Создание среды с кластером Service Fabric в Azure DevTest Labs | Документация Майкрософт
description: Узнайте, как создать среду с автономного кластера Service Fabric и запускать и останавливать кластеру с помощью расписания.
services: devtest-lab,virtual-machines,lab-services
documentationcenter: na
author: EMaher
manager: femila
editor: spelluru
ms.assetid: ''
ms.service: lab-services
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 03/01/2019
ms.author: enewman
ms.openlocfilehash: 9848f197800c391285c4065685b910685f0ac64b
ms.sourcegitcommit: 41ca82b5f95d2e07b0c7f9025b912daf0ab21909
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/13/2019
ms.locfileid: "60312185"
---
# <a name="create-an-environment-with-self-contained-service-fabric-cluster-in-azure-devtest-labs"></a>Создание среды с помощью автономного кластера Service Fabric в Azure DevTest Labs
В этой статье сведения о том, как создать среду с автономного кластера Service Fabric в Azure DevTest Labs. 

## <a name="overview"></a>Обзор
DevTest Labs можно создать автономное тестовых сред, согласно определению шаблонов Azure Resource Manager. Эти среды содержат обоих ресурсов IaaS, например виртуальных машин и ресурсов PaaS, таких как Service Fabric. DevTest Labs позволяет управлять виртуальными машинами в среде, предоставляя команды для управления виртуальными машинами. Эти команды предоставляют следующие возможности для запуска или остановки виртуальных машин по расписанию. Аналогичным образом DevTest Labs также помогает управлять кластерами Service Fabric в среде. Вы можете запустить или остановить кластер Service Fabric в среде, вручную или по расписанию.

## <a name="create-a-service-fabric-cluster"></a>Создание кластера Service Fabric
Кластеры Service Fabric создаются с помощью сред в лаборатории. Каждая среда определяется шаблон диспетчера ресурсов Azure в репозитории Git. [Общедоступный репозиторий Git](https://github.com/Azure/azure-devtestlab/tree/master/Environments/) для DevTest Labs содержит шаблон Resource Manager создать кластер Service Fabric в [кластер Service Fabric](https://github.com/Azure/azure-devtestlab/tree/master/Environments/ServiceFabric-LabCluster) папки. 

1. Во-первых создание лаборатории в Azure DevTest Labs с помощью инструкций в следующей статье: [Создание лаборатории](devtest-lab-create-lab.md). Обратите внимание, что **общих средах** вариант — **на** по умолчанию. 
2. Убедитесь, что поставщик Service Fabric зарегистрирован для вашей подписки, выполнив следующие действия:
    1. Выберите **подписок** в левом меню навигации и выберите ваш **подписки**
    2. На **подписки** выберите **поставщиков ресурсов** в **параметры** раздел, в меню слева. 
    3. Если **Microsoft.ServiecFabric** не зарегистрирован, выберите **зарегистрировать**. 
3. На странице **DevTest Lab** созданной лаборатории выберите **+ Добавить** на панели инструментов. 
    
    ![Добавьте кнопку на панели инструментов](./media/create-environment-service-fabric-cluster/add-button.png)
3. На **Выбор основы** выберите **лаборатории кластера Service Fabric** в списке. 

    ![В списке выберите кластер Service Fabric лаборатории](./media/create-environment-service-fabric-cluster/select-service-fabric-cluster.png)
4. На **настройки** выполните следующие действия: 
    1. Укажите **имя** для кластера **среды**. Это имя группы ресурсов в Azure, в котором будет создан кластер Service Fabric. 
    2. Выберите **операционной системы (ОС)** для виртуальных машин кластера. По умолчанию используется значение **Windows**.
    3. Укажите имя для **администратора** для кластера. 
    4. Укажите **пароль** для администратора. 
    5. Для **сертификат**, введите данные сертификата в виде строки в кодировке Base64. Чтобы создать сертификат, выполните следующие действия:
        1. Скачайте **создать ClusterCertificate.ps1** файла из [репозиторий Git](https://github.com/Azure/azure-devtestlab/tree/master/Environments/ServiceFabric-LabCluster). Кроме того клонируйте репозиторий на вашем компьютере. 
        2. Запустите **PowerShell**. 
        3. Запустите **ps1** файл с помощью команды `.\Create-ClusterCertificate.ps1`. Отобразится текстового файла, открытого в блокноте со сведениями, необходимо заполнить поля, относящиеся к сертификатам, на этой странице. . 
    6. Введите **пароль для сертификата**.
    7. Укажите **отпечаток** для сертификата.
    8. Выберите **добавить** на **Настройка параметров** страницы. 

        ![Настройка параметров кластера](./media/create-environment-service-fabric-cluster/configure-settings.png)
5. После создания кластера, вы увидите группу ресурсов с именем среды, в которой вы указали на предыдущем шаге. При развертывании, см. в кластере Service Fabric, в нем. Если состояние группы ресурсов зависла на **создание**выберите **обновить** на панели инструментов. **Кластера Service Fabric** среда создает кластер 5 узлами 1-nodetype на Windows или Linux.

    В следующем примере **mysfabricclusterrg** — это имя группы ресурсов, которая создается специально для кластера Service Fabric. Важно отметить, что лабораторных сред являются самодостаточными в группе ресурсов, в котором они были созданы. Это означает, что шаблон, который определяет среду, которая имеет доступ только к ресурсам в созданной группе ресурсов или [виртуальные сети, настроенные для использования в лаборатории](devtest-lab-configure-vnet.md). В этом примере выше создает все необходимые ресурсы в той же группе ресурсов.

    ![Кластер был создан](./media/create-environment-service-fabric-cluster/cluster-created.png)

## <a name="start-or-stop-the-cluster"></a>Запуск или остановка кластера
Вы можете запустить или остановить кластера с либо DevTest Lab самой страницы или со страницы кластера Service Fabric, предоставляемые DevTest Labs. 

### <a name="from-the-devtest-lab-page"></a>На странице DevTest Lab
Вы можете запустить или остановить кластера на странице DevTest Lab для лаборатории. 

1. Выберите **многоточие (...)**  для кластера Service Fabric, как показано на следующем рисунке: 

    ![Запуск и остановка команд для кластера](./media/create-environment-service-fabric-cluster/start-stop-on-devtest-lab-page.png)

2. Вы увидите две команды в контекстном меню, чтобы **запустить** и **остановить** кластера. Команда start запускает все узлы в кластере. Команда stop останавливает все узлы в кластере. После остановки кластера самого кластера Service Fabric остается в состоянии готовности, но ни один из узлов доступны, пока не будет повторно выдан команду запуска в кластере в лаборатории.

    Существуют некоторые рекомендации для Обратите внимание, при использовании кластера Service Fabric в тестовой среде. Он может занять некоторое время для кластера Service Fabric, чтобы полностью повторно заполнить после перезапуска узлов. Чтобы сохранить данные после завершения работы с запуском, на управляемом диске, подключенном к виртуальной машине должны быть сохранены данные. Это влияет на производительность при использовании присоединенного управляемого диска, поэтому рекомендуется только для тестовых сред. Если диск, используемый для хранения данных не поддерживается, то данные теряются при выдаче команды остановки в кластере.

### <a name="from-the-service-fabric-cluster-page"></a>На странице кластера Service Fabric 
Есть еще один способ, чтобы запустить или остановить кластера. 

1. Выберите свой кластер Service Fabric в представлении в виде дерева на странице DevTest Lab. 

    ![Выберите свой кластер](./media/create-environment-service-fabric-cluster/select-cluster.png)

2. На **кластера Service Fabric** страницы для кластера, просмотреть команды на панели инструментов, чтобы запустить или остановить кластера. 

    ![Запуск или остановка команды на странице кластера Service Fabric](./media/create-environment-service-fabric-cluster/start-stop-on-cluster-page.png)

## <a name="configure-auto-startup-and-auto-shutdown-schedule"></a>Настройка автоматического запуска и расписание автоматического завершения работы
Кластеры Service Fabric можно запустить или остановить по расписанию. Этот процесс выполняется аналогично в среде виртуальных машин в лаборатории. Чтобы сократить затраты, по умолчанию, в каждом кластере, созданные в лаборатории, автоматически завершает работу по времени, определенному лабораторией [политика завершения работы](devtest-lab-get-started-with-lab-policies.md#set-auto-shutdown). Можно переопределить, указав, следует ли завершить работу кластера, или указав время, кластер завершает работу. 

![Существующие расписания для автоматического запуска и автоматическое завершение работы](./media/create-environment-service-fabric-cluster/existing-schedules.png)

### <a name="opt-in-to-the-auto-start-schedule"></a>Согласиться на расписание автоматического запуска
Согласиться на расписание запуска, выполните следующие действия:

1. Выберите **автозапуска** в меню слева
2. Выберите **на** для **разрешить этот кластер service fabric для планирования автоматического запуска**. Эта страница становится доступен только в том случае, если владелец лаборатории пользователи, которым разрешен автоматический запуск их виртуальных машин или кластеры Service Fabric.
3. На панели инструментов щелкните **Сохранить**. 

    ![Страница "автоматические" типа "звезда"](./media/create-environment-service-fabric-cluster/set-auto-start-settings.png)

### <a name="configure-auto-shutdown-settings"></a>Настроить параметры автоматического завершения работы 
Чтобы изменить параметры завершения работы, выполните следующие действия:

1. Выберите **автоматического завершения работы** в меню слева. 
2. На этой странице можно отказаться от автоматического завершения работы, выбрав **Off** для **включено**. 
3. При выборе **на** для **включено**, выполните следующие действия:
    1. Укажите **время** для завершения работы.
    2. Укажите **часовой пояс** раз. 
    3. Укажите, должен ли DevTest Labs для отправки **уведомления** до автоматического завершения работы. 
    4. Если вы выбрали **Да** параметр уведомлений, укажите **URL-адрес веб-перехватчика** и/или **адрес электронной почты** для отправки уведомлений. 
    5. На панели инструментов щелкните **Сохранить**.

        ![Автоматическое завершение работы страницы](./media/create-environment-service-fabric-cluster/auto-shutdown-settings.png)

## <a name="to-view-nodes-in-the-service-fabric-cluster"></a>Чтобы просмотреть узлы в кластере Service Fabric
На странице кластера Service Fabric, который вы видели в шагах выше относится только к странице DevTest Labs. Оно не показывает узлы в кластере. Чтобы просмотреть дополнительные сведения о кластере, выполните следующие действия.

1. На **DevTest Lab** страницы для лаборатории, выберите **группы ресурсов** в представлении в виде дерева в **Мои виртуальные машины** раздел.

    ![Выбор группы ресурсов](./media/create-environment-service-fabric-cluster/select-resource-group.png)
2. На **группы ресурсов** страницы, вы увидите все ресурсы в группе ресурсов, в списке. Выберите ваш **кластера Service Fabric** из списка. 

    ![Выберите свой кластер в списке](./media/create-environment-service-fabric-cluster/select-cluster-resource-group-page.png)
3. Вы увидите **кластера Service Fabric** страницы для кластера. Это страница, которая предоставляет Service Fabric. Будут выведены все сведения о кластерах, таких как узлы, типы узлов, и т.д.

    ![Домашняя страница кластера Service Fabric](./media/create-environment-service-fabric-cluster/service-fabric-cluster-page.png)

## <a name="next-steps"></a>Дальнейшие действия
Ознакомьтесь со следующими статьями, Дополнительные сведения о средах: 

- [Создание сред со множеством виртуальных машин и ресурсов PaaS с помощью шаблонов Azure Resource Manager](devtest-lab-create-environment-from-arm.md)
- [Настройка и использование общих средах в Azure DevTest Labs](devtest-lab-configure-use-public-environments.md)
