---
title: Эталонная архитектура для Azure DevTest Labs для предприятия
description: В этой статье предоставляет справочное руководство по архитектуре для Azure DevTest Labs на предприятии.
services: devtest-lab,virtual-machines,lab-services
documentationcenter: na
author: spelluru
manager: femila
ms.service: lab-services
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 04/12/2019
ms.author: spelluru
ms.reviewer: christianreddington,anthdela,juselph
ms.openlocfilehash: bcb154f7cffb92ef23fc2606e1f604bb12f8d1a3
ms.sourcegitcommit: 3102f886aa962842303c8753fe8fa5324a52834a
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "60561527"
---
# <a name="azure-devtest-labs---reference-architecture-for-an-enterprise"></a>Azure DevTest Labs — эталонной архитектуры для предприятия
В этой статье предоставляет эталонную архитектуру для развертывания решений на базе Azure DevTest Labs на предприятии. Он включает в себя локальные подключения через Express Route, шлюза удаленных рабочих столов для удаленного входа в виртуальные машины, подключение к репозиторию артефактов для частные артефакты и других служб PaaS, используемых в лаборатории.

![Эталонная архитектура](./media/devtest-lab-reference-architecture/reference-architecture.png)

## <a name="architecture"></a>Архитектура
Ниже приведены ключевые элементы в эталонной архитектуре.

- **Azure Active Directory (AAD)**: Azure DevTest Labs использует [службы Azure Active Directory для управления удостоверениями](../active-directory/fundamentals/active-directory-whatis.md). Существует два важных момента, которые следует учитывать в предоставлении доступа к среде, в зависимости от DevTest Labs для пользователей.
    - **Управление ресурсами**:  Он предоставляет доступ к порталу Azure для управления ресурсами (Создание виртуальных машин, Создание сред, start/stop/перезапуска/delete/applyartifacts и т. д.). Это делается в Azure с помощью управления доступом на основе Roble (RBAC) и применяя назначения ролей для пользователя, параметр ресурсов и уровня доступа.
    - **Виртуальные машины (на уровне сети)**:  В конфигурации по умолчанию виртуальные машины используют учетную запись локального администратора.  Если имеется домен ([AAD доменных служб](../active-directory-domain-services/active-directory-ds-overview.md), локального домена или домена на основе облака), компьютеры можно быть присоединены к домену. После присоединения пользователи будет использовать их удостоверения на основе домена для подключения к виртуальным машинам.
- **Локальное подключение**: В приведенной выше схеме архитектуры [Express Route](../expressroute/expressroute-introduction.md) используется i, но можно также использовать [сеть-сеть VPN](../vpn-gateway/vpn-gateway-about-vpn-gateway-settings.md). Несмотря на то, что это не обязательно для DevTest Labs, часто происходит на предприятиях. Это обязательное поле только если нет причин для подключения к корпоративным ресурсам. Ниже приведены распространенные причины. 
    - Локальные данные, пока невозможно переместить в облако
    - Предпочтения для присоединения к локальному домену Виртуальные лаборатории
    - Принудительная весь сетевой трафик и из него в облачную среду через брандмауэр на локальном по причинам безопасности и соответствия
- **Группы безопасности сети**. Распространенный способ ограничить трафик к облачной среде (или в облачной среде) на основе источника и назначения IP-адресов заключается в использовании [группы безопасности сети](../virtual-network/security-overview.md). Например позволяя только сетевой трафик, исходящий из корпоративной сети в сетях лаборатории.
- **Шлюз удаленных рабочих столов**:  Как правило, предприятий блокируются исходящие подключения удаленного рабочего стола в корпоративном брандмауэре. Чтобы включить подключения к облачной среде в DevTest Labs, существует несколько вариантов, как при использовании [шлюза удаленных рабочих столов](/windows-server/remote/remote-desktop-services/desktop-hosting-logical-architecture) (статический IP-адрес для подсистемы балансировки нагрузки шлюза в список разрешений) или [направлять все входящие Трафик RDP](../vpn-gateway/vpn-gateway-forced-tunneling-rm.md) через подключение Express Route/сеть-сеть VPN. Это распространенные следует учитывать при планировании развертывания DevTest Labs на предприятии.
- **Сети Azure (виртуальные сети, подсети)**:  [Сети Azure](../networking/networking-overview.md) топология является другим ключевым элементом в общую архитектуру DevTest Labs. Он позволяет ресурсам лабораторных занятий для взаимодействия (или нет), доступ к локальным (или его отсутствия) и доступ к Интернету (или его отсутствия). Схема архитектуры включает чаще всего клиенты используют DevTest Labs (все занятия, подключенных через [Пиринг](../virtual-network/virtual-network-peering-overview.md) с помощью [звездообразной модели](/azure/architecture/reference-architectures/hybrid-networking/hub-spoke) для подключения Express Route/сеть-сеть VPN — локальная среда), но так как DevTest Labs использует сеть Azure напрямую, не существует каких-либо ограничений, о том, как настроить сетевую инфраструктуру.
- **DevTest Labs**:  Лаборатория для разработки является ключевой частью общей архитектуры. Дополнительные сведения о службе, см. в разделе [о DevTest Labs](devtest-lab-overview.md).
- **Виртуальные машины и другие ресурсы (SaaS, PaaS и IaaS)**:  Одно из основных рабочих нагрузок, поддерживаемых DevTest Labs, виртуальные машины и другие ресурсы Azure.  DevTest Labs позволяет легко и быстро предприятия для предоставления доступа к ресурсам Azure (включая виртуальные машины и другие ресурсы Azure).  Дополнительные сведения о доступе к Azure для [разработчики](devtest-lab-developer-lab.md) и [инженеров-испытателей](devtest-lab-test-env.md).

## <a name="scalability-considerations"></a>Вопросы масштабируемости
Несмотря на то, что DevTest Labs, нет ли встроенные квоты или ограничения, другие ресурсы Azure используются в стандартной операции лаборатории имеют [квоты подписки уровня](../azure-subscription-service-limits.md). В результате в типичной корпоративной среде необходимо иметь несколько подписок Azure, чтобы охватить крупномасштабного развертывания DevTest Labs. Приведены квоты, достигнут чаще всего предприятия.

- **Группы ресурсов.**  В конфигурации по умолчанию DevTest Labs создает группу ресурсов для каждой новой виртуальной машины или среды, созданный пользователем с помощью службы. Подписки могут содержать [максимальное 980 групп ресурсов](../azure-subscription-service-limits.md#subscription-limits---azure-resource-manager), поэтому данное ограничение составляет допустимое число виртуальных машин и сред в подписке. Существует две конфигурации, которые следует учитывать:
    - **[Все виртуальные машины перейдите к той же группе ресурсов](resource-group-control.md)**:  Несмотря на то, что она помогает выполнить ограничение для группы ресурсов, это влияет на тип ресурса предел группы ресурсов.
    - **Использование общих общедоступные IP-адреса**:  Все виртуальные машины такого же размера и том же регионе перейду к той же группе ресурсов. Это «промежуточный вариант» между квоты группы ресурсов и тип ресурса для каждой квоты группы ресурсов, если разрешено иметь общедоступные IP-адреса виртуальных машин. 
- **Группы ресурсов для одного ресурса каждого ресурса типа**: Ограничение по умолчанию [ресурсам для каждой группы ресурсов для одного ресурса типа — 800](../azure-subscription-service-limits.md#resource-group-limits).  Если на всех виртуальных машин, перейдите к одной и той же конфигурации группы ресурсов, будут обращаться пользователи этого лимита подписки намного быстрее, особенно в том случае, если виртуальные машины имеют много дополнительных дисков.
- **Учетные записи хранения**. В лабораторию в DevTest Labs поставляется с учетной записи хранения и Azure квоты для [количество учетных записей хранения на регион на подписку — 250](../azure-subscription-service-limits.md#storage-limits). Это означает, что верхний предел для числа DevTest Labs, в том же регионе также — 250.
- **Назначения ролей**: Назначение роли — как предоставить пользователю или субъекту-доступ к ресурсу (владелец, ресурсов, уровень разрешений). В Azure, существует [ограничение в 2000 ролей в рамках одной подписки](../azure-subscription-service-limits.md#role-based-access-control-limits). Служба DevTest Labs (в конфигурации по умолчанию) создает группу ресурсов для каждой виртуальной Машины, а также получают владелец **владельца** разрешения для виртуальной Машины DevTest Labs и **чтения** разрешение на Группа ресурсов.  Таким образом каждая новая созданная виртуальная машина использует две дополнительные назначения ролей для назначения роли, созданных при предоставление пользователям разрешения на лаборатории.
- **API операций чтения и записи**: Существует несколько способов (API-интерфейсы REST, PowerShell, CLI, пакет SDK для Azure и т. д.) для автоматизации Azure и DevTest Labs и за счет автоматизации существует возможность попадания другой ограничение на запросы API. Каждая подписка допускает до [12000 чтение запросов и 1200 записи запросов в час](../azure-resource-manager/resource-manager-request-limits.md).  Это ограничение, которые следует учитывать при автоматизации DevTest Labs.

## <a name="manageability-considerations"></a>Вопросы управляемости
DevTest Labs имеет интерфейс отличный пользователя с правами администратора при работе с отдельной лабораторией. На предприятии, скорее всего есть несколько подписок Azure и многие практические занятия. Он требует наличия внесение изменений в все занятия согласованно сценариев автоматизации.  Ниже приведены некоторые примеры и лучшие способы управления развертыванием DevTest Labs.

- **Изменения в параметры лаборатории**: Распространенным сценарием является изменение определенных лабораторных условиях нескольких все лаборатории в рамках развертывания. Например новый размер экземпляра виртуальной Машины доступен, и все занятия необходимо обновить, чтобы разрешить его.  Лучше автоматизировать эти изменения с помощью скриптов Azure PowerShell, Azure CLI или REST API.  
- **Артефакт репозитория личный маркер доступа**:  Как правило личные маркеры доступа для репозитория Git, срок действия (90 дней, 1 год 2 года). Чтобы обеспечить непрерывность, важно либо расширить личный маркер доступа, или создайте новую и применить новый личный маркер доступа к все лаборатории с помощью службы автоматизации.
- **Внесение изменений в лабораторных условиях**:  Часто бывает при наличии определенного параметра (например, позволяя образов Marketplace для использования), который должен быть ограничен. Это можно сделать с помощью "Политика Azure" (для предотвращения изменений к этому типу ресурсов) или путем создания пользовательской роли и предоставление этой роли, а не «владелец» в лаборатории. Это можно сделать для большинства параметров в лаборатории (внутренняя служба поддержки, объявление лаборатории, размеры виртуальных Машин разрешен и т. д.)
- **Требуя виртуальных машин соответствуют соглашению об именовании**: Это популярный запрос легко идентифицировать виртуальные машины, которые являются частью облачной среды разработки и тестирования. Это можно сделать [с политикой Azure](https://github.com/Azure/azure-policy/tree/master/samples/TextPatterns/allow-multiple-name-patterns).

Важно отметить, что DevTest Labs использует базовых ресурсов в Azure (сеть, диски, вычисления, т. д.), управление которыми осуществляется так же, в Azure.  Например "Политика Azure" применяется для виртуальных машин, созданных в лаборатории. Центр безопасности Azure может сообщать о совместимости виртуальной Машины. Службу архивации Azure можно указать регулярное резервное копирование для виртуальных машин в лаборатории и так далее. 

## <a name="security-considerations"></a>Вопросы безопасности
Azure DevTest Labs использует существующие ресурсы в Azure (вычисления, сети и т. д.) и таким образом автоматически выигрывает от все встроенные функции безопасностью платформы. Например чтобы защитить все входящие подключения удаленного рабочего стола, до исходящих только из корпоративной сети, является простым добавлением группу безопасности сети в виртуальную сеть на шлюз удаленных рабочих столов. Только дополнительные вопросы по безопасности за использование Azure DevTest Labs — это уровень разрешения, предоставленные участникам команды, которые будут использовать лабораторные работы по принципу изо дня в день.  Общие разрешения, предоставленные являются [«Владелец» и «Пользователь DevTest Labs»](devtest-lab-add-devtest-user.md). Дополнительные сведения об этих ролях см. в разделе [Добавление владельцев и пользователей в Azure DevTest Labs](devtest-lab-add-devtest-user.md).

## <a name="next-steps"></a>Следующие шаги
См. следующую статью в этом цикле: [Увеличить свою инфраструктуру Azure DevTest Labs](devtest-lab-guidance-scale.md)
