---
title: Типовая архитектура организации. за использование Azure DevTest Labs
description: Эта статья содержит руководство по архитектуре ссылку для Azure DevTest Labs на предприятии.
services: devtest-lab,virtual-machines,lab-services
documentationcenter: na
author: spelluru
manager: femila
ms.service: lab-services
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 04/12/2019
ms.author: spelluru
ms.reviewer: christianreddington,anthdela,juselph
ms.openlocfilehash: 73a3d426e9040525b0c631db273e59c49a6a9eb0
ms.sourcegitcommit: 44a85a2ed288f484cc3cdf71d9b51bc0be64cc33
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "64705881"
---
# <a name="azure-devtest-labs-reference-architecture-for-enterprises"></a>Эталонная архитектура Azure DevTest Labs для предприятий
Эта статья содержит эталонной архитектуры, облегчающие развертывание решений на базе Azure DevTest Labs на предприятии. Он включает в себя следующее:
- Подключения к локальным ресурсам через Azure ExpressRoute
- Шлюз удаленных рабочих столов для удаленного входа в виртуальные машины
- Подключение к репозиторию артефактов для частные артефакты
- Другие службы PaaS, используемые в лабораториях

![Схема эталонной архитектуры](./media/devtest-lab-reference-architecture/reference-architecture.png)

## <a name="architecture"></a>Архитектура
Ниже приведены ключевые элементы эталонной архитектуры.

- **Azure Active Directory (Azure AD)**. DevTest Labs использует [служба Azure AD для управления удостоверениями](../active-directory/fundamentals/active-directory-whatis.md). Рассмотрим эти два ключевых аспекта, при предоставлении пользователям доступа к среде, в зависимости от DevTest Labs:
    - **Управление ресурсами**: Он предоставляет доступ к порталу Azure для управления ресурсами (Создание виртуальных машин; Создание сред; запустить, остановить, перезапустить, удалить и применение артефактов; и так далее). Управление ресурсами выполняется в Azure с помощью управления доступом на основе ролей (RBAC). Назначение ролей пользователям и набор ресурсов и разрешений уровня доступа.
    - **Виртуальные машины (на уровне сети)**: В конфигурации по умолчанию виртуальные машины используют учетную запись локального администратора. Если имеется домен ([доменных служб Azure AD](../active-directory-domain-services/active-directory-ds-overview.md), локального домена или домена на основе облака), компьютеры можно быть присоединены к домену. Пользователи могут использовать их удостоверения на основе домена для подключения к виртуальным машинам.
- **Подключение к локальной среде**. В нашей схеме архитектуры [ExpressRoute](../expressroute/expressroute-introduction.md) используется. Но можно также использовать [сеть сеть VPN](../vpn-gateway/vpn-gateway-about-vpn-gateway-settings.md). Несмотря на то, что ExpressRoute, не является обязательным для DevTest Labs, она часто используется в организациях. ExpressRoute является обязательным только в том случае, если вам нужен доступ к корпоративным ресурсам. Ниже приведены распространенные сценарии.
    - У вас есть локальные данные, не могут быть перемещены в облако.
    - Вы хотите присоединить лаборатории виртуальных машин к локальному домену.
    - Вы хотите, чтобы весь сетевой трафик и из него в облачную среду через брандмауэр подключения к локальной для безопасности и соответствия.
- **Группы безопасности сети**. Распространенный способ ограничить трафик к облачной среде (или в облачной среде) на основе источника и назначения IP-адресов заключается в использовании [группы безопасности сети](../virtual-network/security-overview.md). Например вы хотите разрешить только трафик из корпоративной сети в сетях лаборатории.
- **Шлюз удаленных рабочих столов**: Как правило, предприятий блокируются исходящие подключения удаленного рабочего стола в корпоративном брандмауэре. Существует несколько вариантов, чтобы обеспечить подключение к облачной среде в DevTest Labs, в том числе:
  - Используйте [шлюза удаленных рабочих столов](/windows-server/remote/remote-desktop-services/desktop-hosting-logical-architecture)и список разрешений статический IP-адрес шлюза подсистемы балансировки нагрузки.
  - [Направлять весь входящий трафик протокола удаленного рабочего СТОЛА](../vpn-gateway/vpn-gateway-forced-tunneling-rm.md) через подключение ExpressRoute или сеть сеть VPN. Эта функция рассматривается распространенных при предприятий Планирование развертывания DevTest Labs.
- **Сетевые службы (виртуальные сети, подсети)**: [Сети Azure](../networking/networking-overview.md) топология является другим ключевым элементом в архитектуре DevTest Labs. Он управляет ли ресурсы из лаборатории может взаимодействовать и иметь доступ к локальным и Интернетом. Наша диаграмма архитектуры включает в себя наиболее распространенными способами, что клиенты используют DevTest Labs: Все занятия подключение по протоколу [пиринга виртуальных сетей](../virtual-network/virtual-network-peering-overview.md) с помощью [звездообразной модели](/azure/architecture/reference-architectures/hybrid-networking/hub-spoke) ExpressRoute/сеть сеть VPN-подключение к локальной. Но DevTest Labs использует виртуальную сеть Azure напрямую, поэтому нет ограничений на том, как настроить сетевую инфраструктуру.
- **DevTest Labs**:  Лаборатория для разработки является ключевой частью общей архитектуры. Дополнительные сведения о службе, см. в разделе [о DevTest Labs](devtest-lab-overview.md).
- **Виртуальные машины и другие ресурсы (SaaS, PaaS и IaaS)**:  Виртуальные машины, ключевые рабочие нагрузки, которые DevTest Labs поддерживает и другие ресурсы Azure. DevTest Labs позволяет легко и быстро предприятия для предоставления доступа к ресурсам Azure (включая виртуальные машины и другие ресурсы Azure). Дополнительные сведения о доступе к Azure для [разработчики](devtest-lab-developer-lab.md) и [инженеров-испытателей](devtest-lab-test-env.md).

## <a name="scalability-considerations"></a>Вопросы масштабируемости
Несмотря на то, что DevTest Labs не имеет встроенных квоты или лимиты, у других ресурсов Azure, которые используются в нормальной работе лаборатории [квоты подписки уровня](../azure-subscription-service-limits.md). Поэтому в типичной корпоративной среде необходимо несколько подписок Azure, чтобы охватить крупномасштабного развертывания DevTest Labs. Приведены квоты, наиболее часто доступные для предприятий.

- **Группы ресурсов.** В конфигурации по умолчанию DevTest Labs создает группу ресурсов для каждой новой виртуальной машины, или пользователь создает среду с помощью службы. Подписки могут содержать [до 980 групп ресурсов](../azure-subscription-service-limits.md#subscription-limits---azure-resource-manager). Так, что это ограничение виртуальных машин и сред в подписке. Существует две конфигурации, которые следует учитывать:
    - **[Все виртуальные машины перейдите к той же группе ресурсов](resource-group-control.md)**: Несмотря на то, что эта конфигурация помогает обеспечить ограничение для группы ресурсов, она влияет на ограничение типа ресурсов на их resource-group.
    - **Использование общих общедоступные IP-адреса**: Все виртуальные машины такого же размера и области перейдите в той же группе ресурсов. Эта конфигурация является «промежуточный вариант» между квоты группы ресурсов и ресурсов типа для ресурсов групп квот, если разрешено иметь общедоступные IP-адреса виртуальных машин.
- **Группы ресурсов для одного ресурса каждого типа ресурсов**: Ограничение по умолчанию [ресурсы на группу ресурсов каждого типа ресурсов равно 800](../azure-subscription-service-limits.md#resource-group-limits).  При использовании *перейти ко всем виртуальным машинам в той же группе ресурсов* конфигурации, попадание пользователей этой подписки ограничить гораздо быстрее, особенно в том случае, если виртуальные машины имеют много дополнительных дисков.
- **Учетные записи хранения**. В лабораторию в DevTest Labs поставляется с учетной записью хранения. Квота Azure для [количество учетных записей хранения на регион на подписку — 250](../azure-subscription-service-limits.md#storage-limits). Максимальное число DevTest Labs, в том же регионе также — 250.
- **Назначения ролей**: Назначение роли — как предоставляют пользователю или субъекту-доступ к ресурсу (владелец, ресурсов, уровень разрешений). В Azure есть [ограничение в 2000 назначения ролей на подписку](../azure-subscription-service-limits.md#role-based-access-control-limits). По умолчанию служба DevTest Labs создает группу ресурсов для каждой виртуальной Машины. Владельцу предоставляется *владельца* разрешения для виртуальной Машины DevTest Labs и *чтения* разрешений для группы ресурсов. Таким образом в каждой новой виртуальной Машины, создаваемой использует два назначения роли, помимо назначения, которые используются, когда вы разрешаете пользователям лаборатории.
- **API операций чтения и записи**: Существуют различные способы автоматизации Azure и DevTest Labs, включая интерфейсы API REST, PowerShell, интерфейса командной строки Azure и пакета SDK для Azure. За счет автоматизации вы можете достигнуть другой ограничение на запросы API: Каждая подписка допускает до [чтение 12 000 запросов в час для записи в запросы и 1200](../azure-resource-manager/resource-manager-request-limits.md). Имейте в виду эти ограничения при автоматизации DevTest Labs.

## <a name="manageability-considerations"></a>Вопросы управляемости
DevTest Labs имеет интерфейс отличный пользователя с правами администратора для работы с отдельной лабораторией. Но на предприятии, скорее всего имеется несколько подписок Azure и многие практические занятия. Вносить изменения согласованно в своей лаборатории требуется сценариев автоматизации. Ниже приведены некоторые примеры и рекомендации по обеспечению управления для развертывания DevTest Labs.

- **Изменения в параметры лаборатории**: Распространенным сценарием является изменение определенных лабораторных условиях нескольких все занятия в развертывании. Например новый размер экземпляра виртуальной Машины доступен, и все занятия необходимо обновить, чтобы приложение. Лучше автоматизировать эти изменения с помощью сценариев PowerShell, интерфейса командной строки или интерфейсов REST API.  
- **Артефакт репозитория личный маркер доступа**:  Как правило личные маркеры доступа для репозитория Git истекает через 90 дней, один год или два года. Чтобы обеспечить непрерывность, очень важно для расширения личный маркер доступа, или создайте новую. Затем с помощью службы автоматизации применить новый личный маркер доступа к лабораторным работам.
- **Ограничить внесение изменений в лабораторных условиях**: Часто конкретного значения параметра должен быть ограничен (например, позволяя использовать образы marketplace). "Политика Azure" можно использовать для предотвращения изменений к типу ресурса. Или можно создать настраиваемую роль и предоставить пользователям этой роли, а не *владельца* роли для лаборатории. Это можно сделать для большинства параметров в лаборатории (внутренняя служба поддержки, объявление лаборатории, допустимые размеры виртуальных Машин и т. д.).
- **Виртуальные машины для соглашений об именовании**: Руководители обычно нужно легко идентифицировать виртуальные машины, которые являются частью облачной среды разработки и тестирования. Это можно сделать с помощью ["Политика Azure"](https://github.com/Azure/azure-policy/tree/master/samples/TextPatterns/allow-multiple-name-patterns).

Обратите внимание, что DevTest Labs использует базовых ресурсов Azure, управление которыми осуществляется так же важно: сеть, диски, вычислений и т. д. Например "Политика Azure" применяется к виртуальным машинам, которые созданы в лаборатории. Центр безопасности Azure может сообщать о совместимости виртуальной Машины. И службы архивации Azure может предоставить регулярное резервное копирование для виртуальных машин в лаборатории.

## <a name="security-considerations"></a>Вопросы безопасности
Azure DevTest Labs использует существующие ресурсы в Azure (вычисления, сети и т. д.). Поэтому он автоматически использует средства безопасности, встроенные в платформу. Например чтобы требовать входящие подключения удаленного рабочего стола должна осуществляться только из корпоративной сети, просто добавьте группу безопасности сети в виртуальную сеть на шлюз удаленных рабочих столов. Только дополнительные вопросы по безопасности — уровень разрешений, которые предоставить участникам команды, которые используют лабораторные работы на повседневной основе. Наиболее распространенные разрешения, [ *владельца* и *пользователя*](devtest-lab-add-devtest-user.md). Дополнительные сведения об этих ролях см. в разделе [Добавление владельцев и пользователей в Azure DevTest Labs](devtest-lab-add-devtest-user.md).

## <a name="next-steps"></a>Дальнейшие действия
См. следующую статью в этом цикле: [Увеличить свою инфраструктуру Azure DevTest Labs](devtest-lab-guidance-scale.md).
