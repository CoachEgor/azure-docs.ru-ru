---
title: Создание пользователей - База данных Azure для PostgreS-L - Единый сервер
description: В этой статье описывается, как можно создавать новые учетные записи пользователей для взаимодействия с базой данных Azure для PostgreS-L - Single Server.
author: rachel-msft
ms.author: raagyema
ms.service: postgresql
ms.topic: conceptual
ms.date: 09/22/2019
ms.openlocfilehash: 127d484d6cfc35368803069f9c3d602e787baa56
ms.sourcegitcommit: e040ab443f10e975954d41def759b1e9d96cdade
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/29/2020
ms.locfileid: "80384353"
---
# <a name="create-users-in-azure-database-for-postgresql---single-server"></a>Создание пользователей в базе данных Azure для PostgreS-L - Единый сервер

В этой статье описывается, как можно создавать пользователей в базе данных Azure для сервера PostgreS'L.

Если вы хотите узнать о том, как создавать и управлять пользователями подписки Azure и их привилегиями, вы можете посетить [статью управления доступом на основе роли Azure (RBAC)](../role-based-access-control/built-in-roles.md) или просмотреть, [как настроить роли.](../role-based-access-control/custom-roles.md)

## <a name="the-server-admin-account"></a>Учетная запись администратора сервера

При создании первой службы "База данных Azure для PostgreSQL" вы указали имя пользователя и пароль администратора сервера. Дополнительные сведения и пошаговые инструкции см. в [этом кратком руководстве](quickstart-create-server-database-portal.md). Так как имя пользователя администратора сервера настраивает пользователь, можно найти выбранное имя на портале Azure.

Сервер службы "База данных Azure для PostgreSQL" создается с тремя определенными по умолчанию ролями. Эти роли можно просмотреть, выполнив команду: `SELECT rolname FROM pg_roles;`

- azure_pg_admin
- azure_superuser
- пользователь-администратор сервера

Пользователь-администратор сервера является членом роли azure_pg_admin. Но учетная запись администратора сервера не входит в роль azure_superuser. Так как эта служба является управляемой службой PaaS, только Майкрософт входит в роль суперпользователя.

Подсистема PostgreSQL использует права для управления доступом к объектам базы данных, как описано в [документации по продукту PostgreSQL](https://www.postgresql.org/docs/current/static/sql-createrole.html). В службе "База данных Azure для PostgreSQL" пользователю-администратору сервера предоставляются следующие права: LOGIN, NOSUPERUSER, INHERIT, CREATEDB, CREATEROLE, NOREPLICATION

Учетную запись пользователя администратора сервера можно использовать для создания дополнительных пользователей и включения этих пользователей в роль azure_pg_admin. Кроме того, учетная запись администратора сервера может использоваться для создания менее привилегированных пользователей и ролей, имеющих доступ к отдельным базам данных и схемам.

## <a name="how-to-create-additional-admin-users-in-azure-database-for-postgresql"></a>Как создать дополнительных администраторов в службе "База данных Azure для PostgreSQL"

1. Получите сведения о подключении и имя пользователя администратора.
   Чтобы подключиться к серверу базы данных, вам потребуются учетные данные администратора для входа и полное имя сервера. Вы можете легко найти данные для входа на странице **Обзор** сервера или на странице **Свойства** на портале Azure.

2. Используйте учетную запись и пароль администратора для подключения к серверу базы данных. Используйте предпочитаемое клиентское средство, например pgAdmin или psql.
   Если вы не знаете, как подключиться, см. раздел [Быстрое начало](./quickstart-create-server-database-portal.md)

3. Измените и выполните следующий код SQL. Замените новым именем пользователя значение заполнителя <new_user>, а заполнитель пароля замените надежным паролем. 

   ```sql
   CREATE ROLE <new_user> WITH LOGIN NOSUPERUSER INHERIT CREATEDB CREATEROLE NOREPLICATION PASSWORD '<StrongPassword!>';

   GRANT azure_pg_admin TO <new_user>;
   ```

## <a name="how-to-create-database-users-in-azure-database-for-postgresql"></a>Как создать пользователей базы данных в службе "База данных Azure для PostgreSQL"

1. Получите сведения о подключении и имя пользователя администратора.
   Чтобы подключиться к серверу базы данных, вам потребуются учетные данные администратора для входа и полное имя сервера. Вы можете легко найти данные для входа на странице **Обзор** сервера или на странице **Свойства** на портале Azure.

2. Используйте учетную запись и пароль администратора для подключения к серверу базы данных. Используйте предпочитаемое клиентское средство, например pgAdmin или psql.

3. Измените и выполните следующий код SQL. Замените значение заполнителя `<db_user>` новым именем пользователя, а значение заполнителя `<newdb>` — именем базы данных. Замените заполнитель пароля надежным паролем.

   Этот код SQL создает базу данных testdb для примера. Затем он создает пользователя в службе PostgreSQL и предоставляет ему привилегии для подключения к новой базе данных для этого пользователя.

   ```sql
   CREATE DATABASE <newdb>;
   
   CREATE ROLE <db_user> WITH LOGIN NOSUPERUSER INHERIT CREATEDB NOCREATEROLE NOREPLICATION PASSWORD '<StrongPassword!>';
   
   GRANT CONNECT ON DATABASE <newdb> TO <db_user>;
   ```

4. При использовании учетной записи администратора вам может потребоваться предоставить дополнительные права для безопасности объектов в базе данных. См. [документацию PostgreSQL](https://www.postgresql.org/docs/current/static/ddl-priv.html) для получения дальнейших сведений о ролях базы данных и правах доступа. Пример:

   ```sql
   GRANT ALL PRIVILEGES ON DATABASE <newdb> TO <db_user>;
   ```

5. Чтобы войти на сервер, укажите эту базу данных и введите новое имя пользователя и пароль. В этом примере показана командная строка psql. После ввода этой команды вам будет предложено ввести пароль для имени пользователя. Укажите собственные имя сервера, имя базы данных и имя пользователя.

   ```shell
   psql --host=mydemoserver.postgres.database.azure.com --port=5432 --username=db_user@mydemoserver --dbname=newdb
   ```

## <a name="next-steps"></a>Дальнейшие действия

Откройте брандмауэр для IP-адресов компьютеров новых пользователей, чтобы обеспечить их подключение. Для этого ознакомьтесь с разделом [Создание правил брандмауэра базы данных Azure для PostgreSQL и управление ими с помощью портала Azure](howto-manage-firewall-using-portal.md) или [Azure CLI](howto-manage-firewall-using-cli.md).

Чтобы получить дополнительные сведения об управлении учетными записями пользователей, ознакомьтесь с [ролями базы данных и привилегиями](https://www.postgresql.org/docs/current/static/user-manag.html), [синтаксисом GRANT](https://www.postgresql.org/docs/current/static/sql-grant.html) и [привилегиями](https://www.postgresql.org/docs/current/static/ddl-priv.html) в документации по продукту PostgreSQL.
