---
title: Создание пользователей — масштабирование (Цитус) — база данных Azure для PostgreSQL
description: В этой статье описывается создание новых учетных записей пользователей для взаимодействия с базой данных Azure для PostgreSQL-Scale (Цитус).
author: jonels-msft
ms.author: jonels
ms.service: postgresql
ms.subservice: hyperscale-citus
ms.topic: conceptual
ms.date: 1/8/2019
ms.openlocfilehash: 684116f92544e61a892b3653f8539f9f8f03e0c9
ms.sourcegitcommit: b9d4b8ace55818fcb8e3aa58d193c03c7f6aa4f1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/29/2020
ms.locfileid: "82584082"
---
# <a name="create-users-in-azure-database-for-postgresql---hyperscale-citus"></a>Создание пользователей в базе данных Azure для PostgreSQL — масштабирование (Цитус)

> [!NOTE]
> Термин "Пользователи" относится к пользователям в группе серверов с горизонтальным масштабированием (Цитус). Чтобы узнать больше о пользователях подписки Azure и их привилегиях, ознакомьтесь со [статьей управление доступом на основе ролей (RBAC) в Azure](../role-based-access-control/built-in-roles.md) или Узнайте, [как настроить роли](../role-based-access-control/custom-roles.md).

## <a name="the-server-admin-account"></a>Учетная запись администратора сервера

Подсистема PostgreSQL использует [роли](https://www.postgresql.org/docs/current/sql-createrole.html) для управления доступом к объектам базы данных, а вновь созданная группа серверов с горизонтальным масштабированием (Цитус) поставляется с несколькими предварительно определенными ролями:

* [Роли PostgreSQL по умолчанию](https://www.postgresql.org/docs/current/default-roles.html)
* `azure_pg_admin`
* `postgres`
* `citus`

Поскольку масштабирование является управляемой службой PaaS, только корпорация Майкрософт может войти с помощью `postgres` роли суперпользователя. Для ограниченного административного доступа эта роль предоставляется `citus` в масштабе.

Разрешения для `citus` роли:

* Чтение всех переменных конфигурации, даже переменных, обычно видимых только для пользователей.
* Чтение всех представлений\_PG\_ \* stat и использование различных расширений, связанных с статистикой — даже представления или расширения, обычно видимые только для пользователей.
* Выполнение функций мониторинга, которые могут получать доступ к блокировкам таблиц, потенциально в течение длительного времени.
* [Создайте расширения PostgreSQL](concepts-hyperscale-extensions.md) (поскольку роль является членом `azure_pg_admin`).

Особенно, у `citus` роли есть некоторые ограничения:

* Не удается создать роли
* Не удается создать базы данных

## <a name="how-to-create-additional-user-roles"></a>Создание дополнительных ролей пользователей

Как уже упоминалось `citus` , учетная запись администратора не имеет разрешения на создание дополнительных пользователей. Чтобы добавить пользователя, используйте интерфейс портал Azure.

1. Перейдите на страницу **роли** для группы масштабируемых серверов и нажмите кнопку **+ Добавить**:

   ![Страница «роли»](media/howto-hyperscale-create-users/1-role-page.png)

2. Введите имя и пароль роли. Нажмите кнопку **Сохранить**.

   ![Добавление роли](media/howto-hyperscale-create-users/2-add-user-fields.png)

Пользователь будет создан на узле координатора группы серверов и распространен на все рабочие узлы. Роли, созданные с помощью портал Azure, `LOGIN` имеют атрибут, что означает, что они являются настоящими пользователями, которые могут входить в базу данных.

## <a name="how-to-modify-privileges-for-user-role"></a>Изменение привилегий для роли пользователя

Новые роли пользователей обычно используются для предоставления доступа к базе данных с ограниченными правами. Чтобы изменить привилегии пользователя, используйте стандартные команды PostgreSQL, используя такие средства, как PgAdmin или psql. (См. раздел " [подключение с помощью psql](quickstart-create-hyperscale-portal.md#connect-to-the-database-using-psql) " в кратком руководстве по масштабированию (Цитус).)

Например, чтобы разрешить `db_user` чтение `mytable`, предоставьте разрешение:

```sql
GRANT SELECT ON mytable TO db_user;
```

Масштабирование (Цитус) распространяет инструкции GRANT с одной таблицы на весь кластер, применяя их ко всем рабочим узлам. Однако предоставление разрешений, которые являются всей системой (например, для всех таблиц в схеме), необходимо выполнять на каждом узле даты.  Используйте `run_command_on_workers()` вспомогательную функцию:

```sql
-- applies to the coordinator node
GRANT SELECT ON ALL TABLES IN SCHEMA public TO db_user;

-- make it apply to workers as well
SELECT run_command_on_workers(
  'GRANT SELECT ON ALL TABLES IN SCHEMA public TO db_user;'
);
```

## <a name="how-to-delete-a-user-role-or-change-their-password"></a>Удаление роли пользователя или изменение ее пароля

Чтобы обновить пользователя, перейдите на страницу **роли** для группы масштабируемых серверов и нажмите кнопку с многоточием **...** рядом с пользователем. С многоточием откроется меню для удаления пользователя или сброса пароля.

   ![Изменение роли](media/howto-hyperscale-create-users/edit-role.png)

`citus` Роль является привилегированной и не может быть удалена.

## <a name="next-steps"></a>Дальнейшие действия

Откройте брандмауэр для IP-адресов компьютеров новых пользователей, чтобы разрешить им подключение: [Создание правил брандмауэра Цитус и управление ими с помощью портал Azure](howto-hyperscale-manage-firewall-using-portal.md).

Дополнительные сведения об управлении учетными записями пользователей баз данных см. в разделе Документация по продукту PostgreSQL:

* [Роли и привилегии базы данных](https://www.postgresql.org/docs/current/static/user-manag.html)
* [Синтаксис предоставления](https://www.postgresql.org/docs/current/static/sql-grant.html)
* [Права](https://www.postgresql.org/docs/current/static/ddl-priv.html)
