---
title: Частная ссылка - База данных Azure для PostgreS'L - Единый сервер
description: Узнайте, как работает приватная ссылка для базы данных Azure для PostgreS-L - Одинсервер.
author: kummanish
ms.author: manishku
ms.service: postgresql
ms.topic: conceptual
ms.date: 03/10/2020
ms.openlocfilehash: 4216abdf8cc8aae00e3ba0c57961c4b8b7403672
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "79371687"
---
# <a name="private-link-for-azure-database-for-postgresql-single-server"></a>Частная ссылка на базу данных Azure для почтово-единого сервера

Private Link позволяет создавать частные конечные точки для базы данных Azure для PostgreS-L - Единый сервер и таким образом приносит услуги Azure внутри вашей частной виртуальной сети (VNet). Частная конечная точка предоставляет частный IP, который можно использовать для подключения к серверу базы данных, как и любой другой ресурс в VNet.

Для получения списка служб PaaS, поддерживающих функции Private Link, просмотрите [документацию](https://docs.microsoft.com/azure/private-link/index)Private Link. Частная конечная точка — это частный IP-адрес в определенной [виртуальной сети](https://docs.microsoft.com/azure/virtual-network/virtual-networks-overview) и подсети.

> [!NOTE]
> Эта функция доступна во всех регионах Azure, где база данных Azure для одного сервера PostgreS'L поддерживает уровни ценообразования общего назначения и памяти.

## <a name="data-exfiltration-prevention"></a>Предотвращение кражи данных

Экс-фильтрация данных в базе данных Azure для одного сервера PostgreS'L — это когда авторизованный пользователь, например администратор базы данных, может извлечь данные из одной системы и переместить их в другое место или систему за пределами организации. Например, пользователь перемещает данные в учетную запись хранения, принадлежащую третьей стороне.

Рассмотрим сценарий с пользователем, работающим с PGAdmin внутри виртуальной машины Azure (VM), которая подключается к базе данных Azure для единого сервера PostgreS'L, подготовленного в Западной ЧАСТИ США. В приведенном ниже примере показано, как ограничить доступ с общедоступными конечными точками в базе данных Azure для одного сервера PostgreS'L с помощью элементов управления доступом к сети.

* Отключите весь трафик службы Azure в базу данных Azure для единого сервера PostgreS'L через общедоступную точку, установив для OFF *службы «Разрешить Лазурный* газ». Убедитесь, что IP-адреса или диапазоны не имеют доступа к серверу либо с помощью [правил брандмауэра,](https://docs.microsoft.com/azure/postgresql/concepts-firewall-rules) либо с помощью [виртуальных конечных точек сетевого обслуживания.](https://docs.microsoft.com/azure/postgresql/concepts-data-access-and-security-vnet)

* Разрешить трафик на базу данных Azure для одного сервера PostgreS'L с помощью частного IP-адреса VM. Для получения дополнительной информации смотрите статьи о [правилах брандмауэра](howto-manage-vnet-using-portal.md) [Service Endpoint](concepts-data-access-and-security-vnet.md) и VNet.

* На виртуальной машине Azure ограничьте область исходящего подключения, используя группы безопасности сети (NSG) и теги службы, как показано ниже:

    * Укажите правило NSG, разрешав трафик для *тега обслуживания и S'L. WestUS* - разрешить подключение к базе данных Azure только для одного сервера PostgreS'L на западе США
    * Указать правило NSG (с более высоким приоритетом) отказать в трафике для *тега службы и S'L* - отказ в подключении к базе данных PostgreS'L во всех регионах</br></br>

В конце этой установки Azure VM может подключаться только к базе данных Azure для единого сервера PostgreS'L в западном регионе США. Однако подключение не ограничено одной базой данных Azure для одного сервера PostgreS'L. VM по-прежнему может подключиться к любой базе данных Azure для одного сервера PostgreS'L в западном регионе США, включая базы данных, не входят в подписку. Хотя мы сократили масштабы кражи данных в приведенном выше сценарии до определенного региона, мы не полностью устранили ее.</br>

С помощью Private Link теперь можно настроить элементы управления доступом к сети, такие как НСГ, чтобы ограничить доступ к частной конечной точке. Затем отдельные ресурсы Azure PaaS сопоставляются с конкретными частными конечными точками. Злоумышленник может получить доступ только к отображенным ресурсу PaaS (например, база данных Azure для одного сервера PostgreS'L) и никакому другому ресурсу.

## <a name="on-premises-connectivity-over-private-peering"></a>Локальные подключения через частный пиринг

При подключении к общедоступной точке с помощью наземных машин ваш IP-адрес должен быть добавлен в брандмауэр на основе IP с помощью правила брандмауэра уровня Сервера. Хотя эта модель отлично подходит для предоставления доступа к отдельным компьютерам для рабочих нагрузок разработки или тестирования, управлять ею в рабочей среде сложно.

С помощью Private Link вы можете включить кросс-предпосылок к частной конечной точке с помощью [Express Route](https://azure.microsoft.com/services/expressroute/) (ER), частного пиринга или [VPN туннеля.](https://docs.microsoft.com/azure/vpn-gateway/) Впоследствии они могут отключить весь доступ через публичную конечную точку и не использовать брандмауэр на основе IP.

## <a name="configure-private-link-for-azure-database-for-postgresql-single-server"></a>Наймите частную ссылку для базы данных Azure для одного сервера PostgreS'L

### <a name="creation-process"></a>Процесс создания

Для включения Private Link требуются частные конечные точки. Это можно сделать с помощью следующих руководств.

* [Портал Azure](https://docs.microsoft.com/azure/postgresql/howto-configure-privatelink-portal)
* [Cli](https://docs.microsoft.com/azure/postgresql/howto-configure-privatelink-cli)

### <a name="approval-process"></a>Процесс утверждения
Как только сетевой админ создает частную конечную точку (PE), админ PostgreS'L может управлять частным конечным соединением (PEC) к базе данных Azure для PostgreS'L. Такое разделение обязанностей между админ-сервером сети и dBA полезно для управления базой данных Azure для подключения PostgreS'L. 

* Перейдите на базу данных Azure для серверного ресурса PostgreS'L на портале Azure. 
    * Выберите приватные соединения конечных точек в левом стеле
    * Отображает список всех частных конечных соединений (УИК)
    * Создана соответствующая частная конечная точка (PE)

![выберите частный портал конечных точек](media/concepts-data-access-and-security-private-link/select-private-link-portal.png)

* Выберите отдельное PEC из списка, щелкнув его.

![выбрать частную конечную точку в ожидании утверждения](media/concepts-data-access-and-security-private-link/select-private-link.png)

* Администратор сервера PostgreS'L может утвердить или отклонить УИК и дополнительно добавить короткий текстовый ответ.

![выбрать закрытое сообщение конечных точек](media/concepts-data-access-and-security-private-link/select-private-link-message.png)

* После утверждения или отклонения список будет отражать соответствующее состояние вместе с текстом ответа

![выбрать конечное состояние конечной точки](media/concepts-data-access-and-security-private-link/show-private-link-approved-connection.png)

## <a name="use-cases-of-private-link-for-azure-database-for-postgresql"></a>Используйте случаи частной ссылки для базы данных Azure для PostgreS'L

Клиенты могут подключиться к частной точке от одной из тох же VNet, заглянув vNet в том же регионе или через соединение VNet-vNet в разных регионах. Кроме того, клиенты могут подключаться из локальной среды с помощью ExpressRoute, частного пиринга или VPN-туннелирования. Ниже приведена упрощенная схема, на которой показаны распространенные варианты использования.

![выберите частный обзор конечных точек](media/concepts-data-access-and-security-private-link/show-private-link-overview.png)

### <a name="connecting-from-an-azure-vm-in-peered-virtual-network-vnet"></a>Подключение из виртуальной машины Azure в одноранговой виртуальной сети (VNet)
[Нанастройка ВНет для](https://docs.microsoft.com/azure/virtual-network/tutorial-connect-virtual-networks-powershell) создания подключения к базе данных Azure для PostgreS-L - Одинсервер с Azure VM в загляну в VNet.

### <a name="connecting-from-an-azure-vm-in-vnet-to-vnet-environment"></a>Подключение из виртуальной машины Azure в среде виртуальных сетей
Наладить [подключение к шлюзу VNet-to-VNet VPN](https://docs.microsoft.com/azure/vpn-gateway/vpn-gateway-howto-vnet-vnet-resource-manager-portal) для установления подключения к базе данных Azure для PostgreS-L - Единого сервера с Azure VM в другом регионе или подписке.

### <a name="connecting-from-an-on-premises-environment-over-vpn"></a>Подключение из локальной среды через VPN
Чтобы установить подключение из предварительной среды к базе данных Azure для PostgreS-L - Единый сервер, выберите и реализуйте один из вариантов:

* [Подключение "точка — сеть"](https://docs.microsoft.com/azure/vpn-gateway/vpn-gateway-howto-point-to-site-rm-ps)
* [VPN-подключение типа "сеть —сеть".](https://docs.microsoft.com/azure/vpn-gateway/vpn-gateway-create-site-to-site-rm-powershell)
* [Канал ExpressRoute](https://docs.microsoft.com/azure/expressroute/expressroute-howto-linkvnet-portal-resource-manager)

## <a name="private-link-combined-with-firewall-rules"></a>Частная ссылка в сочетании с правилами брандмауэра

Следующие ситуации и результаты возможны при использовании Private Link в сочетании с правилами брандмауэра:

* Если вы не наверстируете никаких правил брандмауэра, то по умолчанию ни один трафик не сможет получить доступ к базе данных Azure для одного сервера PostgreS'L.

* Если вы настраиваете общественный трафик или конечную точку службы и создаете частные конечные точки, то различные типы входящего трафика авторизуются соответствующим типом правила брандмауэра.

* Если вы не настраиваете какой-либо общественный трафик или конечную точку обслуживания и создаете частные конечные точки, то база данных Azure для одного сервера PostgreS'L доступна только через частные конечные точки. Если вы не наверстируете общественный трафик или конечную точку службы, после того, как все утвержденные частные конечные точки будут отклонены или удалены, ни один трафик не сможет получить доступ к базе данных Azure для Единого сервера PostgreS'L.

## <a name="deny-public-access-for-azure-database-for-postgresql-single-server"></a>Запретить открытый доступ для базы данных Azure для одного сервера PostgreS'L

Если вы хотите полагаться только на частные конечные точки для доступа к своей базе данных Azure для одного сервера PostgreS'L, можно отключить установку всех общедоступных конечных точек[(правил брандмауэра](concepts-firewall-rules.md) и [конечных точек службы VNet),](concepts-data-access-and-security-vnet.md)установив конфигурацию **доступа к сети Deny Public Network Access** на сервере базы данных. 

При установке этой настройки *на ДА* только соединения через частные конечные точки допускаются к вашей базе данных Azure для PostgreS'L. Когда эта настройка установлена *для NO,* клиенты могут подключиться к базе данных Azure для PostgreS'L на основе настройки брандмауэра или vNet службы. Кроме того, после того, как значение доступа к частной сети устанавливается для клиентов, не может добавить и/или обновить существующие правила «Firewall» и «правило конечной точки службы VNet»

> [!Note]
> Эта функция доступна во всех регионах Azure, где база данных Azure для PostgreS-L - Единый сервер поддерживает уровни ценообразования общего назначения и памяти.
>
> Эта настройка не оказывает никакого влияния на конфигурации SSL и TLS для базы данных Azure для одного сервера PostgreS'L.

Чтобы узнать, как настроить **"Запретить публичный доступ к сети"** для базы данных Azure для единого сервера PostgreS'L с портала Azure, обратитесь к [Как настроить "Deny Public Network Access".](howto-deny-public-network-access.md)

## <a name="next-steps"></a>Дальнейшие действия

Чтобы узнать больше о базе данных Azure для функций безопасности одного сервера PostgreS'L, смотрите следующие статьи:

* Для настройки брандмауэра для базы данных Azure [Firewall support](https://docs.microsoft.com/azure/postgresql/concepts-firewall-rules)для единого сервера PostgreS'L см.

* Чтобы узнать, как настроить конечную точку виртуального сетевого сервиса для базы данных Azure для единого сервера PostgreS'L, [см.](https://docs.microsoft.com/azure/postgresql/concepts-data-access-and-security-vnet)

* Для получения обзора базы данных Azure для подключения [Azure Database for PostgreSQL Connectivity Architecture](https://docs.microsoft.com/azure/postgresql/concepts-connectivity-architecture) одного сервера PostgreS'L см.