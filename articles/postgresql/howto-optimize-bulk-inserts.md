---
title: Оптимизация операций массовой вставки на сервере службы "База данных Azure для PostgreSQL"
description: В этой статье описывается оптимизация операций массовой вставки на сервере службы "База данных Azure для PostgreSQL".
author: WenJason
ms.author: v-jay
ms.service: postgresql
ms.topic: conceptual
origin.date: 10/22/2018
ms.date: 03/04/2019
ms.openlocfilehash: a82984ce4c2a2e44306abaa63265e0c25cc6ace4
ms.sourcegitcommit: 3102f886aa962842303c8753fe8fa5324a52834a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "60422123"
---
# <a name="optimize-bulk-inserts-and-use-transient-data-on-an-azure-database-for-postgresql-server"></a>Оптимизация операций массовой вставки и использование временных данных на сервере службы "База данных Azure для PostgreSQL" 
В этой статье описывается оптимизация операций массовой вставки и использование временных данных на сервере службы "База данных Azure для PostgreSQL".

## <a name="use-unlogged-tables"></a>Использование нерегистрируемых таблиц
Если ваши операции рабочей нагрузки включают временные данные или вставляют большие наборы данных в пакетном режиме, рассмотрите возможность использования нерегистрируемых таблиц.

Нерегистрируемые таблицы — это функция PostgreSQL, которая может эффективно оптимизировать операции массовой вставки. PostgreSQL использует упреждающее протоколирование (WAL). Она по умолчанию обеспечивает атомарность и устойчивость. Атомарность, согласованность, изолированность и устойчивость составляют свойства ACID. 

Вставка в нерегистрируемую таблицу означает, что PostgreSQL выполняет вставку без записи в журнал транзакций, что само по себе является операцией ввода-вывода. Таким образом, эти таблицы значительно быстрее, чем обычные.

Создайте нерегистрируемую таблицу, используя следующие параметры:
- создайте нерегистрируемую таблицу с помощью синтаксиса `CREATE UNLOGGED TABLE <tableName>`;
- преобразуйте существующую регистрируемую таблицу в нерегистрируемую с помощью синтаксиса `ALTER TABLE <tableName> SET UNLOGGED`.  

Чтобы отменить процесс, используйте синтаксис `ALTER TABLE <tableName> SET LOGGED`.

## <a name="unlogged-table-tradeoff"></a>Недостатки нерегистрируемой таблицы
Нерегистрируемые таблицы неустойчивы к сбоям. Нерегистрируемая таблица автоматически усекается после сбоя, и ее данные могут быть потеряны в случае некорректного завершения работы. Содержимое нерегистрируемой таблицы не реплицируется на резервные серверы. Любые индексы в нерегистрируемой таблице также не регистрируются автоматически. После завершения операции вставки преобразуйте таблицу в регистрируемую, чтобы операция вставки была устойчивой.

При некоторых клиентских рабочих нагрузках наблюдается повышение производительности примерно от 15 до 20 % в случае использования нерегистрируемых таблиц.

## <a name="next-steps"></a>Дальнейшие действия
Проверьте свою рабочую нагрузку на использование временных данных и массовой вставки. Ознакомьтесь со следующей документацией PostgreSQL:
 
- [Сведения о командах SQL для создания таблиц](https://www.postgresql.org/docs/current/static/sql-createtable.html)