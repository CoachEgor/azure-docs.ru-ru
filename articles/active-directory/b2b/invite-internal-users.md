---
title: Пригласите внутренних пользователей к совместной работе B2B - Azure AD
description: Если у вас есть внутренние учетные записи пользователей для партнеров, дистрибьюторов, поставщиков, поставщиков и других гостей, вы можете перейти в совместное сотрудничество Azure AD B2B, предложив им войти в систему со своими внешними учетными данными или войти в систему. Используйте aPI приглашения PowerShell или Microsoft Graph.
services: active-directory
ms.service: active-directory
ms.subservice: B2B
ms.topic: conceptual
ms.date: 04/12/2020
ms.author: mimart
author: msmimart
manager: celestedg
ms.reviewer: mal
ms.collection: M365-identity-device-management
ms.openlocfilehash: 097de14a3451e8d352dceb17436ae8423aa06533
ms.sourcegitcommit: 8dc84e8b04390f39a3c11e9b0eaf3264861fcafc
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/13/2020
ms.locfileid: "81265945"
---
# <a name="invite-internal-users-to-b2b-collaboration"></a>Пригласите внутренних пользователей к совместной работе B2B

|     |
| --- |
| Приглашение внутренних пользователей использовать совместное использование B2B — это общедоступное функцию предварительного просмотра active Directory Azure. Для получения дополнительной информации о предварительных просмотрах [см.](https://azure.microsoft.com/support/legal/preview-supplemental-terms/) |
|     |

До получения совместной работы Azure AD B2B организации могли сотрудничать с дистрибьюторами, поставщиками, поставщиками и другими гостевыми пользователями, настроив для них внутренние учетные данные. Если у вас есть внутренние гостевые пользователи, как это, вы можете предложить им использовать B2B совместной работы, чтобы вы могли воспользоваться преимуществами Azure AD B2B. Ваши пользователи B2B-гость смогут использовать свои собственные идентификаторы и учетные данные для вхустройства, и вам не нужно будет поддерживать пароли или управлять жизненным циклом учетной записи.

Отправка приглашения на существующую внутреннюю учетную запись позволяет сохранить идентификатор объекта пользователя, UPN, членство в группе и назначения приложений. Вам не нужно вручную удалять и повторно приглашать пользователя или переназначать ресурсы. Чтобы пригласить пользователя, вы будете использовать API приглашения, чтобы передать как внутренний объект пользователя, так и адрес электронной почты гостевого пользователя вместе с приглашением. Когда пользователь принимает приглашение, служба B2B изменяет существующий внутренний объект пользователя на пользователя B2B. В будущем пользователь должен войти в службы облачных ресурсов, используя свои учетные данные B2B. Они все еще могут использовать свои внутренние учетные данные для доступа на ресурсы помещений, но вы можете предотвратить это, сбросив или заменив пароль на внутренней учетной записи.

> [!NOTE]
> Приглашение одностороннее. Вы можете предложить внутренним пользователям использовать совместное использование B2B-совместной работы, но вы не можете удалить учетные данные B2B после их добавления. Чтобы вернуть пользователя на внутреннего пользователя, необходимо удалить объект пользователя и создать новый.

В то время как в публичном предварительном просмотре, метод, описанный в этой статье для приглашения внутренних пользователей к совместной работе B2B, не может быть использован в этих случаях:

- Внутреннему пользователю уже назначена лицензия Exchange.
- Пользователь из домена, настроенного для прямой федерации в вашем каталоге.
- Внутренний пользователь — это учетная запись только для облака, а его основная учетная запись не находится в Azure AD.

В этих случаях, если внутренний пользователь должен быть изменен на пользователя B2B, вы должны удалить внутреннюю учетную запись и отправить пользователю приглашение для совместной работы B2B.

**На месте синхронизированных пользователей**: Для учетных записей пользователей, которые синхронизируются между наместерастками и облаком, каталог на месте остается источником полномочий после того, как им предлагается использовать совместное использование B2B. Любые изменения, внесенные в локту, будут синхронизированы с облачной учетной записью, включая отключение или удаляние учетной записи. Таким образом, вы не можете запретить пользователю войти в свою учетную запись, сохраняя при этом свою облачную учетную запись, просто удаляя локти. Вместо этого можно установить пароль учетной записи в случайном GUID или другом неизвестном значении.

## <a name="how-to-invite-internal-users-to-b2b-collaboration"></a>Как пригласить внутренних пользователей к совместной работе B2B

Вы можете использовать PowerShell или API приглашения для отправки приглашения B2B внутреннему пользователю. Убедитесь, что адрес электронной почты, который вы хотите использовать для приглашения, установлен в качестве внешнего адреса электронной почты на внутреннем объекте пользователя.

- Для пользователя, использующему только облако, используйте адрес электронной почты в свойстве User.OtherMails для приглашения.
- Для предварительного синхронизированного пользователя необходимо использовать значение в свойстве User.Mail для приглашения.
- Домен в свойстве Почты пользователя должен соответствовать учетной записи, в которой он используется для вхлых в систему. В противном случае некоторые службы, такие как Teams, не смогут проверить подлинность пользователя.

По умолчанию приглашение отправит пользователю электронное письмо, в которое он будет знать, что он был приглашен, но вы можете подавить это письмо и отправить свой собственный вместо этого.

> [!NOTE]
> Чтобы отправить свою электронную почту или другое сообщение, вы можете использовать New-AzureADMSInvitation с -SendInvitationMessage:$false приглашать пользователей молча, а затем отправить свое собственное сообщение электронной почты для преобразованного пользователя. Смотрите [API и настройку совместной настройки Azure AD B2B.](customize-invitation-api.md)

## <a name="use-powershell-to-send-a-b2b-invitation"></a>Используйте PowerShell для отправки приглашения B2B

Используйте следующую команду, чтобы пригласить пользователя к совместной работе B2B:

```powershell
Uninstall-Module AzureADPreview
Install-Module AzureADPreview
$ADGraphUser = Get-AzureADUser -searchstring "<<external email>>"
$msGraphUser = New-Object Microsoft.Open.MSGraph.Model.User -ArgumentList $ADGraphUser.ObjectId
New-AzureADMSInvitation -InvitedUserEmailAddress <<external email>> -SendInvitationMessage $True -InviteRedirectUrl "http://myapps.microsoft.com" -InvitedUser $msGraphUser
```

## <a name="use-the-invitation-api-to-send-a-b2b-invitation"></a>Используйте API приглашения для отправки приглашения B2B

Приведенный ниже пример иллюстрирует, как вызвать API приглашения, чтобы пригласить внутреннего пользователя в качестве пользователя B2B.

```json
POST https://graph.microsoft.com/v1.0/invitations
Authorization: Bearer eyJ0eX...
ContentType: application/json
{
    "invitedUserEmailAddress": "<<external email>>"",
    "sendInvitationMessage": true,
    "invitedUserMessageInfo": {
        "messageLanguage": "en-US",
        "ccRecipients": [
            {
                "emailAddress": {
                    "name": null,
                    "address": "<<optional additional notification email>>""
                }
            }
        ],
        "customizedMessageBody": "<<custom message>>"
    },
    "inviteRedirectUrl": "https://myapps.microsoft.com?tenantId=",
    "invitedUser": {"id": "<<ID for the user you want to convert>>"}
}
```

Ответ на API - это тот же ответ, который вы получаете, когда приглашаете нового гостевого пользователя в каталог.

## <a name="next-steps"></a>Дальнейшие действия

- [Активация приглашения службы совместной работы B2B](redemption-experience.md)