---
title: Известные проблемы соответствия требованиям протокола SCIM 2.0 службы подготовки пользователей Azure AD и способы их устранения | Документация Майкрософт
description: Способы устранения распространенных проблем совместимости c протоколом, возникающих при добавлении приложения не из коллекции, которое поддерживает SCIM 2.0, в Azure AD
services: active-directory
documentationcenter: ''
author: msmimart
manager: CelesteDG
ms.assetid: ''
ms.service: active-directory
ms.subservice: app-mgmt
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: conceptual
ms.date: 12/03/2018
ms.author: mimart
ms.reviewer: asmalser
ms.collection: M365-identity-device-management
ms.openlocfilehash: 952853b32b5fadb980e9e96a7c56c05ac63d9931
ms.sourcegitcommit: 36c50860e75d86f0d0e2be9e3213ffa9a06f4150
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/16/2019
ms.locfileid: "65784594"
---
# <a name="known-issues-and-resolutions-with-scim-20-protocol-compliance-of-the-azure-ad-user-provisioning-service"></a>Известные проблемы соответствия требованиям протокола SCIM 2.0 службы подготовки пользователей Azure AD и способы их устранения

Azure Active Directory (Azure AD) может выполнять автоматическую подготовку пользователей и групп для любого приложения или системы, представляющих собой веб-службу с интерфейсом, определенным в [спецификации протокола SCIM 2.0](https://tools.ietf.org/html/draft-ietf-scim-api-19). 

Поддержка протокола SCIM 2.0 в Azure AD описана в статье [Использование системы для управления удостоверениями между доменами (SCIM) для автоматической подготовки пользователей и групп из Azure Active Directory в приложениях](use-scim-to-provision-users-and-groups.md), где указаны определенные части протокола, которые он реализует для автоматической подготовки пользователей и групп из Azure AD для приложений, которые поддерживают SCIM 2.0.

В этой статье описываются текущие и прошлые проблемы, связанные с соответствием службы подготовки пользователей Azure AD протоколу SCIM 2.0, и приводятся сведения об их устранении.

> [!IMPORTANT]
> Последнее обновление клиента SCIM службы подготовки пользователей Azure AD было выполнено 18 декабря 2018 г. Это обновление позволило устранить известные проблемы совместимости, приведенные в таблице ниже. Дополнительные сведения об этом обновлении см. в разделе часто задаваемых вопросов ниже.

## <a name="scim-20-compliance-issues-and-status"></a>Проблемы соответствия SCIM 2.0 и их состояние

| **Проблема соответствия SCIM 2.0** |  **Исправлена?** | **Дата исправления**  |  
|---|---|---|
| В Azure AD требуется, чтобы "/scim" находился в корне URL-адреса конечной точки SCIM приложения.  | Да  |  18 декабря 2018 г. | 
| Перед именами атрибутов атрибуты расширения используют нотацию "." (точка) вместо ":" (двоеточие). |  Да  | 18 декабря 2018 г.  | 
|  Запросы patch для многозначных атрибутов содержат недопустимый синтаксис фильтра пути. | Да  |  18 декабря 2018 г.  | 
|  Запросы на создание группы содержат недопустимый URI схемы. | Да  |  18 декабря 2018 г.  |  

## <a name="were-the-services-fixes-described-automatically-applied-to-my-pre-existing-scim-app"></a>Были ли описанные исправления служб автоматически применены к существующему приложению SCIM?

№ Поскольку это стало бы критическим изменением для приложений SCIM, которые были созданы для работы с более старым поведением, изменения не были автоматически применены к существующим приложениям.

Изменения применяются ко всем новым [приложениям SCIM не из коллекции](configure-single-sign-on-non-gallery-applications.md), настроенным на портале Azure, после даты выхода исправления.

Сведения о том, как перенести существующее задание подготовки пользователя для включения последних исправлений, см. в следующем разделе.

## <a name="can-i-migrate-an-existing-scim-based-user-provisioning-job-to-include-the-latest-service-fixes"></a>Можно ли перенести существующее задание подготовки пользователя на основе SCIM для включения последних исправлений службы?

Да. Если вы уже используете этот экземпляр приложения для единого входа и вам требуется перенести существующее задание подготовки для включения последних исправлений, выполните процедуру ниже. Здесь описывается использование Microsoft Graph API и обозревателя Microsoft Graph API для удаления старого задания подготовки из существующего приложения SCIM и создание нового задания с новым поведением.

> [!NOTE]
> Если приложение все еще находится на этапе разработки и пока не было развернуто для единого входа или подготовки пользователей, самым простым решением является удаление записи приложения в разделе **Azure Active Directory > Корпоративные приложения** на портале Azure и добавление новой записи для приложения с помощью параметра **Создать приложение > Не из коллекции**. Этот способ является альтернативой описанной ниже процедуре.
 
1. Войдите на портал Azure по адресу https://portal.azure.com.
2. На портале Azure перейдите в раздел **Azure Active Directory > Корпоративные приложения** и выберите имеющееся приложение SCIM.
3. В разделе **Свойства** приложения SCIM скопируйте **идентификатор объекта**.
4. В новом окне веб-браузера перейдите по адресу https://developer.microsoft.com/graph/graph-explorer и войдите с правами администратора клиента Azure AD, в который будет добавлено приложение.
5. В песочнице Graph выполните следующую команду, чтобы найти идентификатор задания подготовки. Замените [object-id] на идентификатор субъекта-службы (идентификатор объекта), скопированный на третьем шаге.
 
   `GET https://graph.microsoft.com/beta/servicePrincipals/[object-id]/synchronization/jobs` 

   ![Получение заданий](./media/application-provisioning-config-problem-scim-compatibility/get-jobs.PNG "Получение заданий") 


6. В результатах скопируйте полную строку ID, которая начинается с customappsso или scim.
7. Выполните следующую команду, чтобы получить конфигурацию сопоставления атрибутов для создания резервной копии. Используйте прежний [object-id] и замените [job-id] на идентификатор задания подготовки, скопированный из последнего шага.
 
   `GET https://graph.microsoft.com/beta/servicePrincipals/[object-id]/synchronization/jobs/[job-id]/schema`
 
   ![Получение схемы](./media/application-provisioning-config-problem-scim-compatibility/get-schema.PNG "Получение схемы") 

8. Скопируйте выходные данные JSON из последнего шага и сохраните их в текстовом файле. Он содержит все пользовательские сопоставления атрибутов, добавленные в старое приложение, и должен иметь примерно несколько тысяч строк JSON.
9. Выполните следующую команду, чтобы удалить задание подготовки.
 
   `DELETE https://graph.microsoft.com/beta/servicePrincipals/[object-id]/synchronization/jobs/[job-id]`

10. Выполните следующую команду, чтобы создать задание подготовки, которое содержит последние исправления службы.

 `POST https://graph.microsoft.com/beta/servicePrincipals/[object-id]/synchronization/jobs`
 `{   templateId: "scim"   }`
   
11. В результатах последнего шага скопируйте полную строку ID, которая начинается с scim. При необходимости повторно примените прежние сопоставления атрибутов, выполнив приведенную ниже команду: замените [new-job-id] на новый скопированный идентификатор задания и введите выходные данные JSON из шага 7 в качестве текста запроса.

 `POST https://graph.microsoft.com/beta/servicePrincipals/[object-id]/synchronization/jobs/[new-job-id]/schema`
 `{   <your-schema-json-here>   }`

12. Вернитесь в первое окно веб-браузера и откройте вкладку **Подготовка** для приложения.
13. Проверьте конфигурацию, а затем запустите задание подготовки. 

## <a name="can-i-add-a-new-non-gallery-app-that-has-the-old-user-provisioning-behavior"></a>Можно ли добавить новое приложение не из коллекции со старым поведением для подготовки пользователей?

Да. Если вы создали приложение со старым поведением, которое существовало до выхода исправлений, и хотите развернуть его новый экземпляр, выполните процедуру ниже. Здесь описывается использование Microsoft Graph API и обозревателя Microsoft Graph API для создания задания подготовки SCIM со старым поведением.
 
1. Войдите на портал Azure по адресу https://portal.azure.com.
2. В разделе **Azure Active Directory > Корпоративные приложения > Создание приложения** создайте приложение **не из коллекции**.
3. В разделе **Свойства** нового пользовательского приложения скопируйте **идентификатор объекта**.
4. В новом окне веб-браузера перейдите по адресу https://developer.microsoft.com/graph/graph-explorer и войдите с правами администратора клиента Azure AD, в который будет добавлено приложение.
5. В песочнице Graph выполните приведенную ниже команду для инициализации конфигурации подготовки для приложения.
   Замените [object-id] на идентификатор субъекта-службы (идентификатор объекта), скопированный на третьем шаге.

   `POST https://graph.microsoft.com/beta/servicePrincipals/[object-id]/synchronization/jobs`
   `{   templateId: "customappsso"   }`
 
6. Вернитесь в первое окно веб-браузера и откройте вкладку **Подготовка** для приложения.
7. Завершите конфигурации подготовки пользователей, как обычно.


## <a name="next-steps"></a>Дальнейшие действия
[Автоматическая подготовка пользователей и ее отзыв для приложений SaaS в Azure Active Directory](user-provisioning.md)

