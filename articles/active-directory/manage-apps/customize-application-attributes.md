---
title: Настройка сопоставлений атрибутов в Azure AD | Документация Майкрософт
description: Узнайте, что такое сопоставление атрибутов для приложений SaaS в Azure Active Directory и как настроить его в соответствии с потребностями вашего бизнеса.
services: active-directory
documentationcenter: ''
author: msmimart
manager: CelesteDG
ms.service: active-directory
ms.subservice: app-mgmt
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: conceptual
ms.date: 04/03/2019
ms.author: mimart
ms.collection: M365-identity-device-management
ms.openlocfilehash: ef3d6a47986056925f9964638c9c7192341ca5f9
ms.sourcegitcommit: 824e3d971490b0272e06f2b8b3fe98bbf7bfcb7f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/10/2019
ms.locfileid: "72240993"
---
# <a name="customizing-user-provisioning-attribute-mappings-for-saas-applications-in-azure-active-directory"></a>Настройка сопоставлений атрибутов для подготовки пользователей для приложений SaaS в Azure Active Directory

Microsoft Azure AD обеспечивает поддержку подготовки пользователей для сторонних приложений SaaS, таких как Salesforce, G Suite и др. При включении подготовки пользователей для стороннего приложения SaaS портал Azure определяет значения атрибутов с помощью сопоставлений атрибутов.

Существует предварительно настроенный набор атрибутов и сопоставлений атрибутов между объектами пользователей Azure AD и объектами пользователей приложения SaaS. Некоторые приложения управляют другими типами объектов вместе с пользователями, например группами.

Сопоставление атрибутов по умолчанию можно настроить в соответствии с потребностями вашего бизнеса. Таким образом, можно изменить или удалить существующие сопоставления атрибутов или создать новые сопоставления атрибутов.

## <a name="editing-user-attribute-mappings"></a>Изменение сопоставлений атрибутов пользователя

Чтобы получить доступ к функции **сопоставления** для подготовки пользователей, выполните следующие действия.

1. Войдите на [портал Azure Active Directory](https://aad.portal.azure.com).
1. В области слева выберите **корпоративные приложения** . Отображается список всех настроенных приложений, включая приложения, добавленные из коллекции.
1. Выберите любое приложение для загрузки его области управления приложениями, где можно просматривать отчеты и управлять параметрами приложения.
1. Выберите **подготовку** для управления параметрами подготовки учетных записей пользователей для выбранного приложения.
1. Разверните узел **сопоставления** , чтобы просмотреть и изменить атрибуты пользователей, переходящих между Azure AD и целевым приложением. Если целевое приложение поддерживает его, в этом разделе можно дополнительно настроить подготовку групп и учетных записей пользователей.

   ![Использование сопоставлений для просмотра и изменения атрибутов пользователя](./media/customize-application-attributes/21.png)

1. Выберите конфигурацию **сопоставления** , чтобы открыть экран связанного **атрибута сопоставление** . Для правильной работы приложения SaaS требуются некоторые сопоставления атрибутов. Для требуемых атрибутов функция **Удалить** недоступна.

   ![Использование сопоставления атрибутов для настройки сопоставлений атрибутов приложений](./media/customize-application-attributes/22.png)

   На этом снимке экрана видно, что атрибут **username** управляемого объекта в Salesforce заполняется значением **userPrincipalName** связанного объекта Azure Active Directory.

1. Выберите существующее **сопоставление атрибутов** , чтобы открыть экран **Изменение атрибута** . Здесь можно изменить атрибуты пользователя, которые передаются между Azure AD и целевым приложением.

   ![Изменение атрибутов пользователя с помощью атрибута "изменить атрибут"](./media/customize-application-attributes/23.png)

### <a name="understanding-attribute-mapping-types"></a>Основные сведения о типах сопоставления атрибутов

С помощью сопоставлений атрибутов можно управлять заполнением атрибутов в сторонних приложениях SaaS.
Поддерживаются четыре типа сопоставлений:

- **Прямое** — целевой атрибут заполняется значением атрибута связанного объекта в Azure AD.
- **Константа** — целевой атрибут заполняется указанной строкой.
- **Выражение** — целевой атрибут заполняется на основе результата выражения, похожего на сценарий.
  Дополнительные сведения см. в статье [Запись выражений для сопоставления атрибутов в Azure Active Directory](functions-for-customizing-application-data.md).
- **Нет** — целевой атрибут остается без изменений. Однако если целевой атрибут пуст, он заполняется заданным по умолчанию значением.

Вместе с четырьмя базовыми типами сопоставления настраиваемых атрибутов поддерживают понятие необязательного назначения значения **по умолчанию** . Назначение значения по умолчанию гарантирует, что целевой атрибут заполняется значением, если в Azure AD или целевом объекте нет значения. В наиболее распространенной конфигурации это поле остается пустым.

### <a name="understanding-attribute-mapping-properties"></a>Основные сведения о свойствах сопоставления атрибутов

В предыдущем разделе вы уже появились в свойстве типа сопоставления атрибутов.
Вместе с этим свойством сопоставления атрибутов также поддерживают следующие атрибуты:

- **Атрибут источника** — атрибут пользователя из исходной системы (например Azure Active Directory).
- **Целевой атрибут** — атрибут пользователя в целевой системе (например ServiceNow).
- **Сопоставлять объекты с помощью этого атрибута** — следует ли использовать это сопоставление для уникальной идентификации пользователей между исходной и целевой системами. Обычно он задается для атрибута userPrincipalName или mail в Azure AD, который обычно сопоставляется с полем имени пользователя в целевом приложении.
- **Приоритет сопоставления** — возможность указания нескольких атрибутов сопоставления. Если существует несколько, они оцениваются в порядке, определенном в этом поле. Как только соответствие найдено, дальнейшие атрибуты сопоставления не вычисляются.
- **Применить это сопоставление**
  - **Всегда** — применять это сопоставление как для действий создания, так и для обновления пользователей.
  - **Только во время создания** — применение этого сопоставления только для действий по созданию пользователя.

## <a name="editing-group-attribute-mappings"></a>Изменение сопоставлений атрибутов группы

Выбранное число приложений, например ServiceNow, Box и G Suite, поддерживает возможность подготавливать объекты группы и объекты-пользователи. Объекты группы могут содержать свойства группы, такие как отображаемые имена и псевдонимы электронной почты вместе с членами группы.

![Пример показывает ServiceNow с подготовленными объектами группы и пользователей](./media/customize-application-attributes/24.png)

Можно дополнительно включить или отключить подготовку групп, выбрав сопоставление групп в разделе **сопоставления**и установив для параметра **включено** на экране **сопоставление атрибутов** .

Атрибуты, подготовленные как часть объектов группы, можно настроить так же, как объекты пользователя, описанные ранее. 

> [!TIP]
> Подготовка объектов группы (свойства и участники) отличается от [присвоения групп](assign-user-or-group-access-portal.md) приложению. Вы можете назначить группу приложению, однако подготовить можно только те объекты пользователя, которые содержатся в группе. Для использования групп в назначениях подготовка объектов для всей группы не требуется.

## <a name="editing-the-list-of-supported-attributes"></a>Изменение списка поддерживаемых атрибутов

Атрибуты пользователя, поддерживаемые для заданного приложения, настроены предварительно. Большинство API-интерфейсов управления пользователями приложения не поддерживают обнаружение схемы. Таким образом, служба подготовки Azure AD не может динамически создавать список поддерживаемых атрибутов, выполнив вызовы к приложению.

Однако некоторые приложения поддерживают настраиваемые атрибуты, и служба подготовки Azure AD может считывать пользовательские атрибуты и записывать их в них. Чтобы ввести их определения в портал Azure, установите флажок **Показывать дополнительные параметры** в нижней части экрана **сопоставления атрибутов** , а затем выберите **изменить список атрибутов для** своего приложения.

Ниже приведены приложения и системы, поддерживающие настройку списка атрибутов.

- Salesforce
- ServiceNow
- Workday
- Azure Active Directory (поддерживаются [атрибуты по умолчанию API Graph Azure AD](https://msdn.microsoft.com/Library/Azure/Ad/Graph/api/entity-and-complex-type-reference#user-entity) и расширения пользовательского каталога)
- Приложения, поддерживающие [SCIM 2.0](https://tools.ietf.org/html/rfc7643), где необходимо добавить атрибуты, определенные в [основной схеме](https://tools.ietf.org/html/rfc7643)

> [!NOTE]
> Изменение списка поддерживаемых атрибутов рекомендуется только для администраторов, которые настроили схему своих приложений и систем и имеют непосредственные знания об определении их атрибутов. Иногда для этого требуются навыки работы с API-интерфейсами и средствами разработчика, предоставляемыми приложением или системой.

При изменении списка поддерживаемых атрибутов предоставляются следующие свойства:

- **Имя** — системное имя атрибута, определенное в схеме целевого объекта.
- **Type** — тип данных, которые хранятся в атрибуте, как определено в схеме целевого объекта, может быть одним из следующих типов:
  - *Binary* — атрибут содержит двоичные данные.
  - *Boolean* — атрибут содержит значение True или False.
  - *DateTime* — атрибут содержит строку даты.
  - *Integer* — атрибут содержит целое число.
  - *Reference* — атрибут содержит идентификатор, который ссылается на значение, хранящееся в другой таблице в целевом приложении.
  - *String* — атрибут содержит текстовую строку.
- **Первичный ключ?** — Указывает, определен ли атрибут как поле первичного ключа в схеме целевого объекта.
- **Обязательный?** — Указывает, должен ли атрибут быть заполнен в целевом приложении или системе.
- **С несколькими значениями?** — Указывает, поддерживает ли атрибут несколько значений.
- **С учетом регистра?** — Определяет, учитывается ли регистр значений атрибутов.
- **Выражение API** — не используйте, если это не указано в документации по конкретному соединителю подготовки (например, Workday).
- **Упоминаемый атрибут объекта** . Если это Атрибут ссылочного типа, это меню позволяет выбрать таблицу и атрибут в целевом приложении, который содержит значение, связанное с атрибутом. Например, если у вас есть атрибут с именем Department, сохраненное значение которого указывает на объект в отдельной таблице Departments, необходимо выбрать Departments.Name. Ссылочные таблицы и поля первичного идентификатора, поддерживаемые для данного приложения, предварительно настроены и в настоящее время не могут быть изменены с помощью портал Azure, но могут быть изменены с помощью [API Graph](https://developer.microsoft.com/graph/docs/api-reference/beta/resources/synchronization-configure-with-custom-target-attributes).

Чтобы добавить новый атрибут, перейдите в конец списка поддерживаемых атрибутов, заполните поля выше, использовав предоставленные входные данные, и выберите **Добавить атрибут**. После завершения добавления атрибутов нажмите кнопку **Сохранить**. Затем необходимо перезагрузить вкладку **Подготовка** для новых атрибутов, чтобы они стали доступны в редакторе сопоставления атрибутов.

## <a name="restoring-the-default-attributes-and-attribute-mappings"></a>Восстановление атрибутов по умолчанию и сопоставления атрибутов

Если необходимо начать заново и сбросить существующие сопоставления обратно в состояние по умолчанию, можно установить флажок **Восстановить сопоставления по умолчанию** и сохранить конфигурацию. При этом все сопоставления задаются так, как если бы приложение было только что Добавлено в клиент Azure AD из коллекции приложений.

Выбор этого параметра приведет к принудительной повторной синхронизации всех пользователей во время выполнения службы подготовки.

> [!IMPORTANT]
> Настоятельно рекомендуется установить **состояние подготовки** в значение **Off** перед вызовом этого параметра.

## <a name="what-you-should-know"></a>Необходимая информация

- Процесс синхронизации в Microsoft Azure AD реализован очень эффективно. Во время цикла синхронизации в инициализированной среде обрабатываются только объекты, требующие обновления.
- Обновление сопоставлений атрибутов влияет на производительность цикла синхронизации. Чтобы обновить конфигурацию сопоставления атрибутов, необходимо повторно оценить все управляемые объекты.
- Рекомендуется, чтобы количество последовательных изменений в сопоставлении атрибутов было минимальным.
- Добавление атрибута Photo для подготовки к работе в приложении не поддерживается, так как нельзя указать формат для синхронизации фотографии. Вы можете запросить эту функцию на [голоса пользователя](https://feedback.azure.com/forums/169401-azure-active-directory)
- Атрибут Иссофтделетед часто является частью сопоставлений по умолчанию для приложения. Иссофтделетед может быть true в одном из четырех сценариев (пользователь выходит из области действия, поскольку он не назначен из приложения, пользователь выходит из области действия, так как не соответствует фильтру области, пользователь был обратимо удален в Azure AD, или свойство AccountEnabled имеет значение false.  для пользователя). 
- Служба подготовки Azure AD не поддерживает инициализацию значений NULL

## <a name="next-steps"></a>Следующие шаги

- [Автоматическая подготовка пользователей и ее отзыв для приложений SaaS](user-provisioning.md)
- [Запись выражений для сопоставления атрибутов](functions-for-customizing-application-data.md)
- [Фильтры области для подготовки пользователей](define-conditional-rules-for-provisioning-user-accounts.md)
- [Автоматическая подготовка пользователей и групп из Azure Active Directory в приложениях с использованием SCIM](use-scim-to-provision-users-and-groups.md)
- [Список учебников по интеграции приложений SaaS](../saas-apps/tutorial-list.md)
