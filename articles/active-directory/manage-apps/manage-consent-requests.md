---
title: Управление согласием на приложения и оценка запросов на согласие - Azure AD
description: Узнайте, как управлять запросами на согласие, когда согласие пользователя отключено или ограничено, и как оценить запрос на согласие админа с приложением.
services: active-directory
author: psignoret
manager: CelesteDG
ms.service: active-directory
ms.subservice: app-mgmt
ms.workload: identity
ms.topic: conceptual
ms.date: 12/27/2019
ms.author: mimart
ms.reviewer: phsignor
ms.collection: M365-identity-device-management
ms.openlocfilehash: 0451fe18629a572c9b49f14924bfa50293f42a2b
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/27/2020
ms.locfileid: "77367851"
---
# <a name="managing-consent-to-applications-and-evaluating-consent-requests"></a>Управление согласием на приложения и оценка запросов на согласие

Корпорация Майкрософт [рекомендует](https://docs.microsoft.com/azure/security/fundamentals/steps-secure-identity#restrict-user-consent-operations) отключить согласие конечных пользователей на приложения. Это позволит централизовать процесс принятия решений с командой администраторов безопасности и идентификационных данных организации.

После того, как согласие конечных пользователей отключено или ограничено, существует несколько важных соображений, обеспечивающих безопасность вашей организации при одновременном разрешении использования критически важных приложений для бизнеса. Эти шаги имеют решающее значение для минимизации воздействия на группу поддержки организации и ИТ-администраторов, предотвращая при этом использование неуправляемых учетных записей в сторонних приложениях.

## <a name="process-changes-and-education"></a>Изменения процесса и образование

 1. Рассмотрите возможность предоставления [рабочему процессу согласия администратора (предварительный просмотр),](configure-admin-consent-workflow.md) чтобы пользователи запросили одобрение администратора непосредственно с экрана согласия.

 2. Убедитесь, что все администраторы понимают [рамки разрешений и согласия,](../develop/consent-framework.md)как работает [запрос согласия](../develop/application-consent-experience.md) и как оценить запрос на согласие администратора администратора [в масштабах всего клиента.](#evaluating-a-request-for-tenant-wide-admin-consent)
 3. Просмотрите существующие процессы организации, чтобы пользователи запросили одобрение администратора для приложения, и при необходимости внося обновления. Если процессы изменены:
    * Обновление соответствующей документации, мониторинг, автоматизация и так далее.
    * Общайтесь с изменениями процесса для всех затронутых пользователей, разработчиков, групп поддержки и ИТ-администраторов.

## <a name="auditing-and-monitoring"></a>Аудит и мониторинг

1. [Аудит приложений и предоставленных разрешений](https://docs.microsoft.com/azure/security/fundamentals/steps-secure-identity#audit-apps-and-consented-permissions) в вашей организации, чтобы гарантировать, что ранее не было предоставлено необоснованного или подозрительного доступа к данным.

2. Обзор [обнаружения и устранения незаконного согласия гранты в офисе 365](https://docs.microsoft.com/microsoft-365/security/office-365-security/detect-and-remediate-illicit-consent-grants) для дополнительных передовой практики и гарантий в отношении подозрительных приложений с просьбой ОУт согласия.

3. Если ваша организация имеет соответствующую лицензию:

    * Используйте [дополнительные функции аудита приложений OAuth в Microsoft Cloud App Security.](https://docs.microsoft.com/cloud-app-security/investigate-risky-oauth)
    * Используйте [рабочие книги Azure Monitor для мониторинга разрешений и согласований, связанных](../reports-monitoring/howto-use-azure-monitor-workbooks.md) с деятельностью. В трудовой книжке *Consent Insights* представлено представление приложений по количеству неудавшихся запросов на согласие. Это может быть полезно для определения приоритетов приложений для администраторов для рассмотрения и принятия решения о предоставлении им согласия администратора.

### <a name="additional-considerations-for-reducing-friction"></a>Дополнительные соображения для снижения трения

Чтобы свести к минимуму влияние на надежные, критически важные для бизнеса приложения, которые уже используются, рассмотрите возможность упреждающего предоставления согласия администратора приложениям, которые имеют большое количество грантов на согласие пользователей:

1. Пройдите инвентаризацию приложений, уже добавленных в организацию с высоким уровнем использования, на основе входа в журналы или действия по предоставлению согласия. Скрипт [script](https://gist.github.com/psignoret/41793f8c6211d2df5051d77ca3728c09) PowerShell может быть использован для быстрого и легкого обнаружения приложений с большим количеством грантов на согласие пользователей.

2. Оцените топ-приложения, которые еще не получили согласия админ.

   > [!IMPORTANT]
   > Тщательно оцените приложение, прежде чем предоставить согласие админа ширины клиента, даже если многие пользователи в организации уже дали свое согласие.

3. Для каждой утвержденной заявки предоставите согласие админара с использованием одного из методов, описанных ниже.

4. Для каждой утвержденной заявки рассмотрите [вопрос об ограничении доступа пользователей.](configure-user-consent.md)

## <a name="evaluating-a-request-for-tenant-wide-admin-consent"></a>Оценка запроса на согласие админа широкого клиента

Предоставление согласия админа по всему арендатору является чувствительной операцией.  Разрешения будут выдаваться от имени всей организации и могут включать в себя разрешения на попытку высокопривилегированных операций. Например, управление роями, полный доступ ко всем почтовым ящикам или всем сайтам, а также полное олицетворение пользователя.

Прежде чем предоставить согласие админа с участием всего клиента, вы должны убедиться, что вы доверяете приложению и издателю приложения, для уровня доступа, который вы предоставляете. Если вы не уверены, что понимаете, кто контролирует приложение и почему приложение запрашивает разрешения, *не даете согласия.*

В следующем перечне содержатся некоторые рекомендации, которые следует учитывать при оценке запроса на предоставление согласия админ.

* **Понимание [платформы разрешений и согласия](../develop/consent-framework.md) в платформе идентификации Майкрософт.**

* **Поймите разницу между [делегированными разрешениями и разрешениями приложений.](../develop/v2-permissions-and-consent.md#permission-types)**

   Разрешения приложений позволяют приложению получить доступ к данным для всей организации без какого-либо взаимодействия с пользователем. Делегированные разрешения позволяют приложению действовать от имени пользователя, который в какой-то момент был подписан в приложение.

* **Понимание запрашиваемых разрешений.**

   Разрешения, запрошенные приложением, перечислены в [запросе согласия.](../develop/application-consent-experience.md) Расширение заголовка разрешения будет отображать описание разрешения. Описание разрешений на применение обычно заканчивается "без пользователя, вписавого в приложение". Описание делегированных разрешений обычно заканчивается "от имени пользователя, вписавого в пользователя". Разрешения для API-графика Microsoft Graph описаны в «Ссылке на разрешения Microsoft Graph» — относятся к документации для других API для понимания разных разрешений, которые они предоставляют.

   Если вы не понимаете запрашиваемого разрешения, *не даете согласия.*

* **Понять, какое приложение запрашивает разрешения и кто опубликовал приложение.**

   Осторожен с вредоносными приложениями, которые пытаются выглядеть как другие приложения.

   Если вы сомневаетесь в законности приложения или его издателя, *не даете согласия.* Вместо этого ищите дополнительное подтверждение (например, непосредственно у издателя приложения).

* **Убедитесь, что запрашиваемые разрешения приведены в соответствие с функциями, которые вы ожидаете от приложения.**

   Например, приложение, предлагающее управление сайтом SharePoint, может потребовать делегированного доступа к чтению всех коллекций сайтов, но не обязательно будет нуждаться в полном доступе ко всем почтовым ящикам или полной привилегии олицетворения в каталоге.

   Если вы подозреваете, что приложение запрашивает больше разрешений, чем ему нужно, *не даете согласия.* Свяжитесь с издателем приложения, чтобы получить более подробную информацию.

## <a name="granting-consent-as-an-administrator"></a>Предоставление согласия в качестве администратора

### <a name="granting-tenant-wide-admin-consent"></a>Предоставление согласия админа широкого клиента

См. [согласие админового админора Grant](grant-admin-consent.md) на приложение для пошаговых инструкций для предоставления запросу на запрос от azure, с помощью Azure AD PowerShell, или из запроса согласия.

### <a name="granting-consent-on-behalf-of-a-specific-user"></a>Предоставление согласия от имени конкретного пользователя

Вместо того, чтобы дать согласие на всю организацию, администратор может также использовать [API Microsft Graph](https://docs.microsoft.com/graph/use-the-api) для предоставления согласия на делегированные разрешения от имени одного пользователя. Для получения дополнительной [информации,](https://docs.microsoft.com/graph/auth-v2-user)смотрите Получить доступ от имени пользователя .

## <a name="limiting-user-access-to-applications"></a>Ограничение доступа пользователей к приложениям

Доступ пользователей к приложениям по-прежнему может быть ограничен даже в том случае, если было получено согласие админа для всего клиента. Для получения дополнительной информации о том, [methods for assigning users and groups](methods-for-assigning-users-and-groups.md)как требовать назначения пользователя в приложение, см.

Более широкий обзор, включая способы обработки дополнительных сложных сценариев, [см.](what-is-access-management.md)

## <a name="next-steps"></a>Дальнейшие действия

[Пять шагов по защите инфраструктуры удостоверений](https://docs.microsoft.com/azure/security/fundamentals/steps-secure-identity#before-you-begin-protect-privileged-accounts-with-mfa)

[Настройка рабочего процесса согласия админа](configure-admin-consent-workflow.md)

[Настройка того, как конечные пользователи соглашаются на приложения](configure-user-consent.md)

[Разрешения и согласие в платформе идентификации Майкрософт](../develop/active-directory-v2-scopes.md)

[Azure AD на StackOverflow](https://stackoverflow.com/questions/tagged/azure-active-directory)