---
title: Появится сообщение об ошибке на странице приложения после входа | Документация Майкрософт
description: Как устранить проблемы со входом Azure AD, когда приложение возвращает сообщение об ошибке.
services: active-directory
documentationcenter: ''
author: msmimart
manager: CelesteDG
ms.assetid: ''
ms.service: active-directory
ms.subservice: app-mgmt
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: conceptual
ms.date: 07/11/2017
ms.author: mimart
ms.reviewer: asteen
ms.collection: M365-identity-device-management
ms.openlocfilehash: 23e6a3d0b533dccc3c3111382b014907d5c026ab
ms.sourcegitcommit: 6a42dd4b746f3e6de69f7ad0107cc7ad654e39ae
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/07/2019
ms.locfileid: "67612670"
---
# <a name="an-app-page-shows-an-error-message-after-the-user-signs-in"></a>На странице приложения отобразится сообщение об ошибке после входа пользователя

В этом случае Azure Active Directory (Azure AD) выполняет вход пользователя. Но приложения появляется сообщение об ошибке и завершить процесс входа пользователя. Проблема в том, что приложение не приняло ответ, выданный Azure AD.

Существует несколько возможных причин, почему приложение не приняло ответ от Azure AD. Если сообщение об ошибке не указаны, чего не хватает из ответа, сделайте следующее:

-   Если приложение находится в коллекции Azure AD, убедитесь, что вы выполнили действия, описанные в [отладка на основе SAML единого входа для приложений в Azure AD](https://azure.microsoft.com/documentation/articles/active-directory-saml-debugging).

-   Используйте инструменты, например [Fiddler](https://www.telerik.com/fiddler) для записи запроса, ответа и токена SAML.

-   Отправить ответ SAML поставщику приложения и попросите о том, чего не хватает.

## <a name="attributes-are-missing-from-the-saml-response"></a>В ответе SAML отсутствуют атрибуты

Чтобы добавить атрибут в конфигурацию Azure AD, отправляется в ответе Azure AD, выполните следующие действия.

1. Откройте [ **портала Azure** ](https://portal.azure.com/) и войдите в систему качестве глобального администратора или соадминистратора.

2. В верхней части области навигации слева, выберите **все службы** открыть расширения Azure AD.

3. Тип **Azure Active Directory** в поле фильтра поиска, а затем выберите **Azure Active Directory**.

4. Выберите **корпоративные приложения** в области навигации Azure AD.

5. Выберите **все приложения** для просмотра списка приложений.

   > [!NOTE]
   > Если вы не видите приложение, для которого необходимо, используйте **фильтра** элемента управления в верхней части **список всех приложений**. Задайте **Показать** возможность «Все приложения».

6. Выберите приложение, которое вы хотите настроить единый вход.

7. После загрузки приложения выберите **единого входа** в области навигации.

8. В **атрибуты пользователя** выберите **представление и изменить все другие атрибуты пользователей**. Здесь можно изменить атрибуты для отправки приложению в токене SAML, при входе пользователей.

   Чтобы добавить атрибут, выполните указанные ниже действия.

   1. Нажмите кнопку **Добавить атрибут**. Введите **имя**и выберите **значение** из раскрывающегося списка.

   1.  Щелкните **Сохранить**. Вы увидите новый атрибут в таблице.

9. Сохраните конфигурацию.

   В следующий раз пользователь выполняет вход в приложение Azure AD будет отправлять новый атрибут в ответе SAML.

## <a name="the-app-doesnt-identify-the-user"></a>Приложение не определяет пользователя

Вход приложение завершается сбоем, так как ответ SAML отсутствует атрибут, например, роль. Или происходит сбой, поскольку приложение ожидает другой формат или значение для **NameID** атрибут (идентификатора пользователя).

Если вы используете [Автоматическая подготовка пользователей Azure AD](https://docs.microsoft.com/azure/active-directory/manage-apps/user-provisioning) для создания, обслуживания и удалять пользователей в приложении, убедитесь, что пользователь подготовлен к приложению SaaS. Дополнительные сведения см. в разделе [пользователи не подготавливаются к работе для приложения из коллекции Azure AD](https://docs.microsoft.com/azure/active-directory/manage-apps/application-provisioning-config-problem-no-users-provisioned).

## <a name="add-an-attribute-to-the-azure-ad-app-configuration"></a>Добавить атрибут в конфигурацию приложения Azure AD

Чтобы изменить значение идентификатора пользователя, сделайте следующее:

1. Откройте [ **портала Azure** ](https://portal.azure.com/) и войдите в систему качестве глобального администратора или соадминистратора.

2. Выберите **все службы** в верхней части области навигации с левой стороны, чтобы открыть расширения Azure AD.

3. Тип **Azure Active Directory** в поле фильтра поиска, а затем выберите **Azure Active Directory**.

4. Выберите **корпоративные приложения** в области навигации Azure AD.

5. Выберите **все приложения** для просмотра списка приложений.

   > [!NOTE]
   > Если вы не видите приложение, для которого необходимо, используйте **фильтра** элемента управления в верхней части **список всех приложений**. Задайте **Показать** возможность «Все приложения».

6. Выберите приложение, которое вы хотите настроить единый вход.

7. После загрузки приложения выберите **единого входа** в области навигации.

8. В разделе **атрибуты пользователя**, выберите уникальный идентификатор для пользователя из **идентификатор пользователя** стрелку раскрывающегося списка.

## <a name="change-the-nameid-format"></a>Изменение формата идентификатора имени

Если приложение ожидает другой формат для **NameID** атрибут (идентификатора пользователя), см. в разделе [nameID редактирование](https://docs.microsoft.com/azure/active-directory/develop/active-directory-saml-claims-customization#editing-nameid) для изменения формата NameID.

Azure AD выбирает формат **NameID** атрибута (идентификатор пользователя) на основе значения, который выбран или формат, который запрашивается в приложении, в который SAML. Дополнительные сведения см. в разделе «NameIDPolicy» [единый вход SAML протокола](https://docs.microsoft.com/azure/active-directory/develop/single-sign-on-saml-protocol#nameidpolicy).

## <a name="the-app-expects-a-different-signature-method-for-the-saml-response"></a>Приложение ожидает другой метод подписи для ответа SAML

Чтобы изменить какие-либо части токена SAML, имеющие цифровую подпись Azure AD, выполните следующие действия.

1. Откройте [портала Azure](https://portal.azure.com/) и войдите в систему качестве глобального администратора или соадминистратора.

2. Выберите **все службы** в верхней части области навигации с левой стороны, чтобы открыть расширения Azure AD.

3. Тип **Azure Active Directory** в поле фильтра поиска, а затем выберите **Azure Active Directory**.

4. Выберите **корпоративные приложения** в области навигации Azure AD.

5. Выберите **все приложения** для просмотра списка приложений.

   > [!NOTE]
   > Если вы не видите нужное приложение, используйте **фильтра** элемента управления в верхней части **список всех приложений**. Задайте **Показать** возможность «Все приложения».

6. Выберите приложение, которое вы хотите настроить единый вход.

7. После загрузки приложения выберите **единого входа** в области навигации.

8. В разделе **сертификат подписи SAML**выберите **Показать дополнительные параметры подписывания сертификатов**.

9. Выберите **вариант подписывания** , приложение ожидает, что один из этих параметров:

   * **Ответ знака SAML**
   * **Ответ знака SAML и утверждение**
   * **Утверждение знака SAML**

   В следующий раз пользователь выполняет вход в приложение Azure AD подпишет ответ SAML, который вы выбрали в части.

## <a name="the-app-expects-the-sha-1-signing-algorithm"></a>Приложение ожидает алгоритм подписи SHA-1

По умолчанию Azure AD подписывает токен SAML с помощью алгоритма наиболее безопасной. Мы рекомендуем не изменять алгоритм подписи *SHA-1* Если приложение не требует SHA-1.

Чтобы изменить алгоритм подписи, сделайте следующее:

1. Откройте [портала Azure](https://portal.azure.com/) и войдите в систему качестве глобального администратора или соадминистратора.

2. Выберите **все службы** в верхней части области навигации с левой стороны, чтобы открыть расширения Azure AD.

3. Тип **Azure Active Directory** в поле фильтра поиска, а затем выберите **Azure Active Directory**.

4. Выберите **корпоративные приложения** в области навигации Azure AD.

5. Выберите **все приложения** для просмотра списка приложений.

   > [!NOTE]
   > Если вы не видите нужное приложение, используйте **фильтра** элемента управления в верхней части **список всех приложений**. Задайте **Показать** возможность «Все приложения».

6. Выберите приложение, которое вы хотите настроить единый вход.

7. После загрузки приложения выберите **единого входа** в области навигации в левой части приложения.

8. В разделе **сертификат подписи SAML**выберите **Показать дополнительные параметры подписывания сертификатов**.

9. Выберите **SHA-1** как **алгоритм подписи**.

   В следующий раз пользователь выполняет вход в приложение Azure AD подпишет маркер SAML с помощью алгоритма SHA-1.

## <a name="next-steps"></a>Следующие шаги
[Отладка на основе SAML единого входа для приложений в Azure AD](https://azure.microsoft.com/documentation/articles/active-directory-saml-debugging).
