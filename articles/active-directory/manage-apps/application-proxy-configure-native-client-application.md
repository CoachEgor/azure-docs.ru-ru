---
title: Публикация собственных клиентских приложений — Azure AD | Документация Майкрософт
description: В этой статье описано, как включить собственные клиентские приложения для взаимодействия с соединителем прокси приложений Azure AD, чтобы обеспечить безопасный удаленный доступ к локальным приложениям.
services: active-directory
documentationcenter: ''
author: msmimart
manager: CelesteDG
ms.service: active-directory
ms.subservice: app-mgmt
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: conceptual
ms.date: 04/15/2019
ms.author: mimart
ms.reviewer: japere
ms.custom: it-pro
ms.collection: M365-identity-device-management
ms.openlocfilehash: cb36d6a03da07681db468184a489a79f7f0deab7
ms.sourcegitcommit: d4dfbc34a1f03488e1b7bc5e711a11b72c717ada
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/13/2019
ms.locfileid: "65825490"
---
# <a name="how-to-enable-native-client-applications-to-interact-with-proxy-applications"></a>Как включить собственные клиентские приложения для взаимодействия с приложениями прокси

Прокси приложения Azure Active Directory (Azure AD) можно использовать для публикации веб-приложений, но его также можно использовать для публикации собственных клиентских приложений, настроенных с помощью Azure AD проверки подлинности Library (ADAL). Собственные клиентские приложения отличаются от веб-приложений, так как они устанавливаются на устройство, а веб-приложения предоставляются через браузер.

Чтобы поддерживать собственные клиентские приложения, прокси приложения принимает AD выданных токенов Azure, которые отправляются в заголовке. Служба прокси приложения выполняет проверку подлинности для пользователей. Это решение не использует маркеры приложения для проверки подлинности.

![Связь между конечными пользователями, Azure Active Directory и опубликованными приложениями](./media/application-proxy-configure-native-client-application/richclientflow.png)

Для публикации собственных приложений, используйте библиотеку проверки подлинности Azure AD, которая отвечает за проверку подлинности и поддерживает многие клиентские среды. Прокси приложения вписывается в [сценарий вызова веб-API собственным приложением](../develop/native-app.md).

В этой статье рассматриваются четыре действия, которые нужно выполнить, чтобы опубликовать собственное приложение с помощью прокси приложения и библиотеки аутентификации Azure AD.

## <a name="step-1-publish-your-proxy-application"></a>Шаг 1. Опубликуйте приложение прокси

Опубликуйте приложение прокси, как любое другое приложение, и назначьте пользователей, имеющих доступ к вашему приложению. Дополнительные сведения см. в статье [Публикация приложений с помощью прокси приложения Azure AD](application-proxy-add-on-premises-application.md).

## <a name="step-2-register-your-native-application"></a>Шаг 2. Регистрация собственного приложения

Теперь необходимо зарегистрировать приложение в Azure AD следующим образом:

1. Войдите в [портал Azure Active Directory](https://aad.portal.azure.com/). **Панели мониторинга** для **Центр администрирования Azure Active Directory** отображается.
2. На боковой панели, выберите **Azure Active Directory**. **Azure Active Directory** отображается на странице "Обзор".
3. На боковой панели Обзор Azure AD, выберите **регистрация приложений**. Отобразится список всех зарегистрированных приложений.
4. Выберите **Новая регистрация**. **Зарегистрировать приложение** появится страница.

   ![Создание регистрации приложения](./media/application-proxy-configure-native-client-application/create.png)
5. В **имя** заголовок, укажите имя отображения пользовательского интерфейса для приложения.
6. В разделе **поддерживаемые типы учетных записей** выберите уровень доступа, с помощью следующих правил:
   - Чтобы ориентироваться только учетные записи, которые являются внутренними для вашей организации, выберите **учетных записей в организации каталога только**.
   - Чтобы ориентироваться только бизнеса или образования клиентов, выберите **учетных записей в любой организации directory**.
   - Предназначены для широкого набора идентификаторов Майкрософт, выберите **учетные записи в любой каталог организации и личных учетных записей Майкрософт**.
7. В **URI перенаправления** щелкните **общедоступным клиентом (мобильных и настольных систем)** , а затем введите URI перенаправления для приложения.
8. Выберите и прочитайте **политики платформы Microsoft**, а затем выберите **зарегистрировать**. На странице "Обзор" для регистрация нового приложения создаются и отображаются.

Более подробные сведения о создании новой регистрации приложения, см. в разделе [интеграция приложений с Azure Active Directory](../develop/quickstart-v1-integrate-apps-with-azure-ad.md).

## <a name="step-3-grant-access-to-your-proxy-application"></a>Шаг 3. Предоставление доступа к прокси приложения

Теперь, когда вы зарегистрировали собственное приложение, ему можно присвоить доступ для других приложений в каталоге, в этом случае для доступа к прокси приложения. Чтобы включить собственное приложение, которое будет передан приложение прокси-сервера:

1. На боковой панели страницы регистрации новых приложений, выберите **разрешения API**. **Разрешения API** Регистрация нового приложения отобразится страница.
2. Выберите **Добавить разрешение**. **Разрешения запроса API** появится страница.
3. В разделе **Выбор API** выберите **API, организации**. Откроется список приложений в каталоге, которые предоставляют API-интерфейсы.
4. Введите в поле поиска или прокрутки, чтобы найти прокси приложения, которое вы опубликовали в [шаг 1: Опубликуйте приложение прокси](#step-1-publish-your-proxy-application), а затем выберите приложение прокси-сервера.
5. В **какой тип разрешения требует приложения?** щелкните тип разрешения. Если собственное приложение требуется доступ к прокси-сервера приложения API от имени выполнившего вход пользователя, выберите **делегированные разрешения**. Если собственное приложение выполняется как фоновая служба или управляющая программа без вошедшего пользователя, выберите **разрешения приложения**.
6. В **Выбор разрешений** , выберите нужные разрешения и выберите **добавить разрешения**. **Разрешения API** страницы, теперь в собственном приложении показано прокси приложения и разрешение API, который вы добавили.

## <a name="step-4-edit-the-active-directory-authentication-library"></a>Шаг 4. Изменение библиотеки проверки подлинности Active Directory

Измените код собственного приложения с учетом проверки подлинности с помощью библиотеки Active Directory Authentication Library (ADAL). Для этого включите в код следующий текст:

```
// Acquire Access Token from AAD for Proxy Application
AuthenticationContext authContext = new AuthenticationContext("https://login.microsoftonline.com/<Tenant ID>");
AuthenticationResult result = await authContext.AcquireTokenAsync("< External Url of Proxy App >",
        "<App ID of the Native app>",
        new Uri("<Redirect Uri of the Native App>"),
        PromptBehavior.Never);

//Use the Access Token to access the Proxy Application
HttpClient httpClient = new HttpClient();
httpClient.DefaultRequestHeaders.Authorization = new AuthenticationHeaderValue("Bearer", result.AccessToken);
HttpResponseMessage response = await httpClient.GetAsync("< Proxy App API Url >");
```

Сведения, необходимые в образце кода можно найти на портале Azure AD следующим образом:

| Необходимые сведения | Как найти его на портале Azure AD |
| --- | --- |
| \<Идентификатор клиента > | **Azure Active Directory** > **свойства** > **идентификатор каталога** |
| \<Внешний URL-адрес прокси-сервера приложения > | **Корпоративные приложения** > *приложение прокси* > **прокси приложения** > **внешний URL-адрес** |
| \<Идентификатор приложения собственного приложения > | **Корпоративные приложения** > *собственное приложение* > **свойства** > **идентификатор приложения** |
| \<URI собственного приложения перенаправления > | **Azure Active Directory** > **регистрация приложений** > *собственное приложение* > **URI перенаправления** |
| \<URL-адрес прокси-сервера приложения API > | **Azure Active Directory** > **регистрация приложений** > *собственное приложение* > **разрешения API**  >  **API / имя РАЗРЕШЕНИЯ** |

После изменения ADAL со следующими параметрами пользователей для проверки подлинности в собственных клиентских приложений даже в том случае, если они находятся за пределами корпоративной сети.

## <a name="next-steps"></a>Дальнейшие действия

Дополнительные сведения о потоке собственного приложения, см. в разделе [собственные приложения в Azure Active Directory](../develop/native-app.md).

Узнайте больше о настройке [единого входа в приложения в Azure Active Directory](what-is-single-sign-on.md#choosing-a-single-sign-on-method).
