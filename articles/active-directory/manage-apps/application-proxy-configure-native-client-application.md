---
title: Публикация собственных клиентских приложений — Azure AD | Документация Майкрософт
description: В этой статье описано, как включить собственные клиентские приложения для взаимодействия с соединителем прокси приложений Azure AD, чтобы обеспечить безопасный удаленный доступ к локальным приложениям.
services: active-directory
documentationcenter: ''
author: msmimart
manager: CelesteDG
ms.service: active-directory
ms.subservice: app-mgmt
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: conceptual
ms.date: 04/15/2019
ms.author: mimart
ms.reviewer: japere
ms.custom: it-pro
ms.collection: M365-identity-device-management
ms.openlocfilehash: 3d2a2bb9dd543da7455a276075a829ef06032edb
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/27/2020
ms.locfileid: "77159290"
---
# <a name="how-to-enable-native-client-applications-to-interact-with-proxy-applications"></a>Как включить приложения для натиных клиентов для взаимодействия с прокси-приложениями

Для публикации веб-приложений можно использовать приложение Azure Active Directory (Azure AD), но его также можно использовать для публикации приложений для натиных клиентов, настроенных в Библиотеку аутентификации Azure AD (ADAL). Собственные клиентские приложения отличаются от веб-приложений, так как они устанавливаются на устройство, а веб-приложения предоставляются через браузер.

Для поддержки приложений для нативших клиентов приложение Proxy принимает токены, выданные Azure AD, которые отправляются в заголовке. Служба Application Proxy делает аутентификацию для пользователей. Это решение не использует маркеры приложений для проверки подлинности.

![Взаимоотношения между конечными пользователями, Azure AD и опубликованными приложениями](./media/application-proxy-configure-native-client-application/richclientflow.png)

Для публикации нативных приложений воспользуйтесь Библиотекой аутентификации Azure AD, которая занимается аутентификацией и поддерживает многие клиентские среды. Прокси приложения вписывается в [сценарий вызова веб-API собственным приложением](../azuread-dev/native-app.md).

В этой статье рассматриваются четыре действия, которые нужно выполнить, чтобы опубликовать собственное приложение с помощью прокси приложения и библиотеки аутентификации Azure AD.

## <a name="step-1-publish-your-proxy-application"></a>Шаг 1: Опубликуйте свое прокси-приложение

Опубликуйте приложение прокси, как любое другое приложение, и назначьте пользователей, имеющих доступ к вашему приложению. Для получения дополнительной информации [см.](application-proxy-add-on-premises-application.md)

## <a name="step-2-register-your-native-application"></a>Шаг 2: Зарегистрируйте свое родное заявление

Теперь необходимо зарегистрировать приложение в Azure AD следующим образом:

1. Вопием на [портале Active Directory Azure](https://aad.portal.azure.com/). Отображается **панель мониторинга** для **центра адажа Active Directory Azure.**
1. В боковой панели выберите **Активный каталог Azure.** Отображается страница обзора **active Directory Azure.**
1. В обзоре боковой панели Azure AD выберите **регистрацию приложений.** Отображается список всех регистраций приложений.
1. Выберите **Новая регистрация**. Отображается страница **заявки Register.**

   ![Создание новой регистрации приложений на портале Azure](./media/application-proxy-configure-native-client-application/create.png)

1. В заголовке **«Имя»** укажите имя дисплея приложения, обращенное к пользователю.
1. В **заголовке «Поддерживаемые типы учетных записей»** выберите уровень доступа, используя следующие рекомендации:

   - Чтобы настроить таргетинг только на учетные записи, которые являются внутренними для вашей организации, выберите **учетные записи только в этом каталоге организации.**
   - Чтобы ориентироваться только на бизнес-клиентов или образовательных клиентов, выберите **учетные записи в любом каталоге организационных**организаций.
   - Чтобы настроить таргетинг на самый широкий набор идентификационных данных Майкрософт, выберите **учетные записи в любом каталоге организаций и личных учетных записях Майкрософт.**

1. В заголовке **Redirect URI** выберите **«Общественный клиент» (мобильный & рабочий стол),** а затем введите перенаправление URI для приложения.
1. Выберите и прочитайте **политики платформы Майкрософт,** а затем выберите **Регистрацию.** Создается и отображается страница обзора для регистрации нового приложения.

Более подробную информацию о создании новой регистрации приложений можно узнать в [интегрирующем приложении с помощью Active Directory Azure.](../develop/quickstart-register-app.md)

## <a name="step-3-grant-access-to-your-proxy-application"></a>Шаг 3: Предоставить доступ к вашему прокси-приложению

Теперь, когда вы зарегистрировали свое родное приложение, вы можете предоставить ему доступ к другим приложениям в вашем каталоге, в этом случае для доступа к прокси-приложению. Для того, чтобы нативное приложение было подвержено прокси-приложению:

1. На боковой панели новой страницы регистрации приложения выберите **разрешения API.** Отображается страница **разрешений API** для регистрации нового приложения.
1. Выберите **Добавить разрешение**. Отображается страница **разрешений API запроса.**
1. В настройках **Select an API** выберите **API, которые использует моя организация.** Появляется список, содержащий приложения в каталоге, которые разоблачают AIS.
1. Введите окно поиска или прокрутите, чтобы найти прокси-приложение, которое вы опубликовали в [шаге 1: Опубликуйте ваше прокси-приложение,](#step-1-publish-your-proxy-application)а затем выберите приложение прокси.
1. В **типе разрешений требуется ваше приложение?** Если вашему родному приложению необходим доступ к API прокси-приложения в качестве пользователя, вписав в нее, выберите **делегированные разрешения.**
1. В заголовке **«Выберите разрешения»** выберите желаемое разрешение и выберите **разрешения «Добавить».** Страница **разрешений API** для вашего родного приложения теперь показывает приложение прокси и API разрешения, которые вы добавили.

## <a name="step-4-edit-the-active-directory-authentication-library"></a>Шаг 4. Изменение библиотеки проверки подлинности Active Directory

Измените код собственного приложения с учетом проверки подлинности с помощью библиотеки Active Directory Authentication Library (ADAL). Для этого включите в код следующий текст:

```
// Acquire Access Token from AAD for Proxy Application
AuthenticationContext authContext = new AuthenticationContext("https://login.microsoftonline.com/<Tenant ID>");
AuthenticationResult result = await authContext.AcquireTokenAsync("< External Url of Proxy App >",
        "<App ID of the Native app>",
        new Uri("<Redirect Uri of the Native App>"),
        PromptBehavior.Never);

//Use the Access Token to access the Proxy Application
HttpClient httpClient = new HttpClient();
httpClient.DefaultRequestHeaders.Authorization = new AuthenticationHeaderValue("Bearer", result.AccessToken);
HttpResponseMessage response = await httpClient.GetAsync("< Proxy App API Url >");
```

Требуемую информацию в примере кода можно найти на портале Azure AD:

| Требуется информация | Как найти его на портале Azure AD |
| --- | --- |
| \<Идентификатор> | **Azure Active Directory** > **Properties** > **Идентификатор каталога** активных свойств каталога Azure |
| \<Внешний Url прокси-приложения> | **Корпоративные приложения** > *вашего прокси-приложения* > **Приложение Прокси** > **Внешний Url** |
| \<Идентификатор приложения Для коренных> | **Предприятие прикладывает** > **идентификатор** *приложения* > **Свойства** >  |
| \<Перенаправить URI из> приложения коренных народов | **Приложение Azure Active Directory** > **App зарегистрирует** > *ваше родное приложение* > **Redirect URIs** |
| \<Прокси-приложение API Url> | **Приложение Azure Active Directory** > **App зарегистрирует** > разрешение > *API aPI нативное приложение* > **API permissions****/ PERMISSIONS NAME** |

После того, как вы отображаете ADAL с помощью этих параметров, пользователи могут проверить подлинность для приложений нативной клиентской продукции, даже если они находятся за пределами корпоративной сети.

## <a name="next-steps"></a>Дальнейшие действия

Для получения дополнительной информации о потоке нативных приложений смотрите [приложения Native в Active Directory Azure.](../azuread-dev/native-app.md)

Узнайте о настройке [единого ввоза приложений в Active Directory Azure.](what-is-single-sign-on.md#choosing-a-single-sign-on-method)
