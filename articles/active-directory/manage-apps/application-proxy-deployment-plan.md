---
title: Планирование развертывания прокси приложения Azure Active Directory
description: End-to-end руководство по планированию развертывания прокси приложения в вашей организации
services: active-directory
documentationcenter: azure
author: barbaraselden
manager: CelesteDG
ms.assetid: ''
ms.service: active-directory
ms.component: app-mgmt
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: conceptual
ms.date: 04/04/2019
ms.author: baselden
ms.reviewer: ''
ms.openlocfilehash: 24429c5596494082b526b9648a1405bc397b9d2f
ms.sourcegitcommit: d4dfbc34a1f03488e1b7bc5e711a11b72c717ada
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/13/2019
ms.locfileid: "67108485"
---
# <a name="plan-an-azure-ad-application-proxy-deployment"></a>Планирование развертывания прокси приложения Azure AD

Прокси приложения Azure Active Directory (Azure AD) — это решение безопасным и экономным удаленного доступа для локальных приложений. Он предоставляет другой путь сервера немедленно перейдет для «Первый Cloud» организации для управления доступом к устаревшие локальные приложения, которые еще не может использовать современные протоколы. Дополнительные общие сведения см. в разделе [что такое прокси приложения](https://docs.microsoft.com/azure/active-directory/manage-apps/application-proxy).

Прокси приложения рекомендуется для предоставления удаленным пользователям доступа к внутренним ресурсам. Прокси приложения заменяет потребность в виртуальной частной сети или обратного прокси-сервера для этих вариантов использования удаленного доступа. Он не предназначен для пользователей, которые находятся в корпоративной сети. Эти сотрудники, использующие прокси приложения для доступа к интрасети могут возникать проблемы производительности нежелательным.

Эта статья содержит ресурсы, необходимые для планирования, эксплуатации и управления прокси приложения Azure AD. 

## <a name="plan-your-implementation"></a>Планирование реализации

В следующем разделе приведены широкое представление ключ, планированию элементы, которые будут задавать для использования интерфейс эффективное развертывание. 

### <a name="prerequisites"></a>Технические условия

Необходимо выполнить следующие условия перед началом реализации. Можно просмотреть дополнительные сведения о настройке среды, включая этих требований, в этом [руководстве](application-proxy-add-on-premises-application.md).

* **Соединители**: Соединители — это упрощенные агенты, которые можно развернуть на:
   * Физическое оборудование на предприятии
   * Виртуальных Машин, размещенных в любое решение низкоуровневой оболочки
   * Виртуальных Машин, размещенных в Azure, чтобы разрешить исходящее подключение к службе прокси приложения.

* См. в разделе [соединители понять прокси приложения Azure AD](application-proxy-connectors.md) более подробный обзор.

     * Соединитель компьютеры должны [включить TLS 1.2](application-proxy-add-on-premises-application.md) перед установкой соединители.

     * Если это возможно, развернуть соединители в [одной сети](application-proxy-network-topology.md) и сегмент в качестве серверов внутренних веб-приложений. Лучше всего развернуть соединители, после завершения обнаружения приложений.
     * Мы рекомендуем, что каждая группа соединителей имеет по крайней мере два соединителя для обеспечения высокого уровня доступности и масштабирования. Наличие три соединителя является оптимальным, если службы компьютера в любой момент может потребоваться. Просмотрите [таблице емкости соединитель](https://docs.microsoft.com/azure/active-directory/manage-apps/application-proxy-connectors#capacity-planning) помогут решить, какой тип компьютера для установки соединителей на. Чем больше размер виртуальной машины дополнительные буфера и высокопроизводительных будет Соединитель.

* **Параметры сетевого доступа**: Соединители Azure AD Application Proxy [подключиться к Azure через HTTPS (порт 443 TCP) и HTTP (TCP-порта 80)](application-proxy-add-on-premises-application.md). 

   * Завершающий соединитель трафика TLS не поддерживается и не позволит соединители установкой безопасного канала с их соответствующие конечные точки прокси приложения Azure.

   * Избегайте все формы проверки встроенного на исходящий сетевой TLS между соединителями и Azure. Внутренней проверки между соединителем и серверной части приложений возможна, но может привести к снижению взаимодействие с пользователем и таким образом, не рекомендуется.

   * Балансировка нагрузки соединителей, сами не также поддерживается, и даже необходимые.

### <a name="important-considerations-before-configuring-azure-ad-application-proxy"></a>Важные вопросы, прежде чем настраивать прокси приложения Azure AD

Чтобы настроить и реализовать прокси приложения Azure AD должны быть выполнены следующие требования core.

*  **Адаптация Azure**: Прежде чем развертывать прокси приложения, удостоверения пользователей необходимо синхронизировать из локального каталога или непосредственно в клиентах Azure AD. Синхронизация удостоверений позволяет Azure AD выполнить предварительную проверку подлинности пользователей до предоставления им доступа к опубликованным приложениям Application Proxy и получить сведения об идентификаторах пользователей для выполнения единого входа (SSO).

* **Требования для условного доступа к**: Не рекомендуется использовать прокси приложения для доступа к интрасети, так как это приводит к увеличению задержки, влияющих на пользователей. Мы рекомендуем использовать прокси приложения с помощью предварительной проверки подлинности и политики условного доступа для удаленного доступа из Интернета.  Подход для предоставления условного доступа для использования в интрасети — модернизация приложений, поэтому они могут diretly пройти проверку подлинности AAD. Ссылаться на [ресурсы по переносу приложений в AAD](https://docs.microsoft.com/azure/active-directory/manage-apps/migration-resources) Дополнительные сведения. 

* **Ограничения**: Чтобы обеспечить защиту от чрезмерное использование ресурсов, используемых отдельными пользователями существует являются ограничения регулирования в приложения и клиента. Чтобы просмотреть эти ограничения см. [лимиты и ограничения службы Azure AD](https://docs.microsoft.com/azure/active-directory/users-groups-roles/directory-service-limits-restrictions). Эти ограничения регулирования основаны на тестировании гораздо выше типичное использование тома и предоставляет буфер достаточно для большинства развертываний.

* **Открытый сертификат**: Если вы используете пользовательские доменные имена, необходимо приобрести открытый сертификат, выданный сторонних доверенным центром сертификации. В зависимости от требований организации получение сертификата может занять некоторое время, и мы рекомендуем начала процесса как можно раньше. Прокси приложения Azure поддерживает стандарт [подстановочный знак](application-proxy-wildcard.md), или сертификаты на основе SAN.

* **Требования к домену**: Единый вход в опубликованные приложения через ограниченное делегирование Kerberos (KCD) требует ведущих присоединены к домену AD, в котором выполняется публикация приложения. Подробные сведения по этой теме см. в разделе [ограниченного делегирования Kerberos для единого входа](application-proxy-configure-single-sign-on-with-kcd.md) с помощью прокси приложения. Служба соединителя выполняется в контексте учетной записи local System и не должны быть настроены для использования пользовательских удостоверений.

* **Записи DNS для URL-адресов**

   * Перед использованием пользовательскими доменами в прокси приложения необходимо создать запись CNAME в общедоступном DNS-Сервере, позволяя клиентам распознавать пользовательские определенный внешний URL-адрес для предварительно определенных адресов прокси приложения. Не удалось создать запись CNAME для приложения, использующего пользовательского домена позволит удаленным пользователям подключается к приложению. Шаги, необходимые для добавления записей CNAME может варьироваться от DNS поставщика, поэтому Узнайте, как [Управление записями и наборами записей DNS с помощью портала Azure](https://docs.microsoft.com/azure/dns/dns-operations-recordsets-portal).

   * Аналогичным образом узлов соединителя должен быть способен разрешить внутренний URL-адрес публикуемых приложений.

* **Права администратора и ролей**

   * **Установка соединителя** требуются права локального администратора, в котором он установлен на сервере Windows. Он также требуется как минимум *администратор приложения* роль для проверки подлинности и зарегистрируйте экземпляр соединителя в клиент Azure AD. 

   * **Публикация приложений и администрирования** требуют *администратор приложения* роли. Приложение администраторы могут управлять всем приложениям в каталоге, включая регистраций, параметры единого входа, пользователей и назначения групп и лицензирования, параметры прокси приложения и согласия. Она не предоставляет прав на управление условным доступом. *Администратор облачных приложений* роль имеет все возможности из администратор приложения, за исключением того, что он не позволяет управлять параметрами прокси приложения.

* **Лицензирование.** Прокси приложения доступно через подписку Azure AD Basic. Ссылаться на [страницы Azure Active Directory: цены](https://azure.microsoft.com/pricing/details/active-directory/) полный список возможностей службы лицензирования.  

### <a name="application-discovery"></a>Обнаружение приложений

Скомпилируйте актуальный список всех приложений в области, опубликованные через прокси приложения, так как следующие сведения:

| Тип сведений| Собираемые сведения |
|---|---|
| Тип службы| Пример: SharePoint, SAP, CRM, пользовательские веб-приложения, API |
| Платформа приложений | Пример: Windows IIS, Apache в Linux, Tomcat, NGINX |
| Членство в домене| Веб-сервер полное доменное имя (FQDN) |
| Расположение приложения | Расположение веб-сервера или фермы в инфраструктуре |
| Внутренний доступ | Точный URL-адрес, используемый при доступе к приложению внутренне. <br> Если в ферме, какой тип балансировки нагрузки — используется? <br> Ли приложение рисует содержимое из источников, кроме самого себя.<br> Определите, если приложение работает через WebSockets. |
| Внешний доступ | Решения поставщика, который приложение уже предоставляется извне. <br> URL-адрес, который вы хотите использовать для доступа к внешним ресурсам. Если SharePoint, убедитесь, что сопоставления для альтернативного доступа настроены на [в этом руководстве](https://docs.microsoft.com/SharePoint/administration/configure-alternate-access-mappings). В противном случае будет необходимо определить внешние URL-адреса. |
| Открытый сертификат | Если используется пользовательский домен, приобретите сертификат с соответствующим именем субъекта. Если сертификат уже существует Обратите внимание, серийный номер и расположение, из которой его можно получить. |
| Authentication type (Тип проверки подлинности)| Тип проверки подлинности поддерживается службой поддержки приложений, таких как Basic, Windows интеграции проверки подлинности на основе форм, на основе заголовка и утверждения. <br>Если приложение настроено для запуска под учетной записью домена, обратите внимание, полное доменное имя (FQDN) учетной записи службы.<br> Если на основе SAML, URL-адресов идентификатор и ответа. <br> Если на основе заголовка, введите поставщика решений и определенные требования к для обработки проверки подлинности. |
| Имя группы для соединителя | Логическое имя для группы соединителей, которые будут назначены для предоставления канала передачи и единый вход для этого приложения внутреннего сервера. |
| Доступ пользователей или групп | Пользователи или группы пользователей, которым предоставляется внешний доступ к приложению. |
| Дополнительные требования | Обратите внимание на то, любой удаленный доступ к дополнительным возможностям или требования к безопасности, которые должна быть учтена в публикации приложения. |

Это средство можно загрузить [листа инвентаризации приложения](https://aka.ms/appdiscovery) для инвентаризации приложений.

### <a name="define-organizational-requirements"></a>Определение организационных требований

Ниже перечислены области, для которых необходимо определить бизнес-требований вашей организации. Каждая область содержит примеры требований

 **Access**

* Удаленные пользователи с присоединенных к домену или устройства, присоединенные к Azure AD пользователи могут, чтобы доступ к опубликованным приложениям безопасно с простой единый вход (SSO).

* Удаленных пользователей с помощью утвержденных личных устройств можно безопасно доступ к опубликованным приложениям, если они зарегистрированы в многофакторной проверки Подлинности и зарегистрировали приложение Microsoft Authenticator на свой мобильный телефон для проверки подлинности.

**Система управления** 

* Администраторам определять и отслеживать жизненный цикл назначения пользователей к приложениям, опубликованным через прокси приложения.

**Безопасность**

* Только пользователи назначаются приложениям через членство в группе или по отдельности могут обращаться к этим приложениям.

**Производительность**

* Нет без снижения производительности приложения, по сравнению с доступа к приложению из внутренней сети.

**Взаимодействие с пользователем**

* Пользователи, помнить о том, как получать доступ к приложениям с помощью знакомых компании URL-адреса на любую платформу устройства.

**Аудит**
* Администраторы имеют возможность выполнять аудит действий доступа пользователей.


### <a name="best-practices-for-a-pilot"></a>Советы и рекомендации для пилотного развертывания

Определите объем время и усилия, необходимые для полностью комиссии одного приложения для удаленного доступа с единым входом (SSO). Сделать это, является реализация пилотной программы, который рассматривает его начального обнаружения, публикации и общему тестированию. С помощью простой IIS веб-приложения, который уже предварительно настроен для встроенной проверки подлинности Windows (IWA) может помочь определить базовые показатели, как эта конфигурация требует успешного пилотного развертывания удаленного доступа и единого входа с минимальными усилиями.

Следующие элементы проектирования следует увеличить успех вашей пилотных непосредственно в рабочем клиенте.  

**Соединитель управления**:  

* Соединители играют ключевую роль в обеспечении локальным каналом в приложения. С помощью **по умолчанию** группа соединителей вполне подходит для первоначального пилотного тестирования опубликованных приложений перед их введения в эксплуатацию в рабочую среду. Затем можно перемещать успешно проверено приложения на рабочей группы соединителей.

**Управление приложениями**:

* Своих сотрудников, скорее всего, помните, что внешний URL-адрес, знакомы и соответствующие. Избегайте публикации приложения с помощью наших предварительно определенных суффиксов msappproxy.net или onmicrosoft.com. Вместо этого предоставляют знакомый верхнего уровня проверенного домена, такие как префикс с именем логического узла *интрасети. < customers_domain > .com*.

* Ограничьте видимость значка пилотного развертывания приложения в пилотной группе, скрывая его форме значок запуска на портале Azure MyApps. Когда все будет готово для рабочей среды вы можете задать область приложения для его соответствующей целевой аудитории, в том же клиенте подготовительной, либо также публикация приложения в своем клиенте.

**Параметры единого входа единого**: Конкретные зависимости, которые может занять время настройки, поэтому следует избегать управления изменениями, которые задержки, гарантируя зависимости будут удовлетворены заранее у некоторых параметров единого входа. Сюда входят домена Присоединение узлов соединителя для выполнения единого входа с помощью ограниченное делегирование Kerberos (KCD) и выполняет другие действия много времени. Например установка экземпляра доступом PING Access, если требуется единый вход на основе заголовка.

**SSL между узел соединителя и целевое приложение**: Безопасность имеет первостепенное значение, поэтому следует всегда использовать TLS между приложениями сервер узла и целевой соединителя. Особенно в том случае, если веб-приложение настроено для проверки подлинности на основе форм (FBA), от имени пользователя учетные данные затем эффективно передаются в виде открытого текста.

**Реализовать постепенно и проверить каждый шаг**. Тестирование основных функциональных после публикации приложения убедитесь, что выполнены все требования к пользователям и business, следуя приведенным ниже инструкциям:

1. Тестирование и проверка общего доступа к веб-приложения с помощью предварительной проверки подлинности отключены.
2. При успешном выполнении включите предварительную проверку подлинности и назначьте пользователей и групп. Тестирование и проверка доступа.
3. Затем добавьте метод единого входа для приложения и повторите тестирование для проверки прав доступа.
4. Применение условного доступа и многофакторной проверки Подлинности политик при необходимости. Тестирование и проверка доступа.

**Средства устранения неполадок**: При устранении неполадок, всегда начинается по проверке доступа к опубликованному приложению из браузера на узле соединителя и убедитесь, что приложение работает ожидаемым образом. Чем проще в настройках, проще определить основную причину, поэтому следует проверить, попытка воспроизведения проблемы с минимальной конфигурацией, например, использование только один соединитель и нет единого входа. В некоторых случаях может оказаться незаменимым для устранения неполадок доступа или содержимое в приложениях, через прокси-сервер веб-отладки, средства, такие как от компании Telerik Fiddler. Fiddler может выступать в качестве прокси-сервера для трассировки и отладки трафика для мобильных платформ, таких как iOS и Android, и практически все, что, можно настроить для маршрутизации через прокси-сервер. См. в разделе [руководство по устранению неполадок](application-proxy-troubleshoot.md) Дополнительные сведения.

## <a name="implement-your-solution"></a>Реализации решения

### <a name="deploy-application-proxy"></a>Развертывание прокси приложения

В этом описаны шаги по развертыванию прокси-сервер приложения [учебника для добавления приложения в локальной для удаленного доступа](application-proxy-add-on-premises-application.md). Если оно завершилось сбоем, выберите **Устранение неполадок с прокси приложения** на портале или использовать руководство по устранению неполадок [проблем при установке соединителя агента прокси приложения](application-proxy-connector-installation-problem.md).

### <a name="publish-applications-via-application-proxy"></a>Публикация приложений через прокси приложения

Публикация приложений предполагается, что выполнены все предварительные требования и у вас несколько соединителей, отображается как зарегистрированное и активны на странице прокси приложения.

Публиковать приложения можно также с помощью [PowerShell](https://docs.microsoft.com/powershell/module/azuread/?view=azureadps-2.0-preview).

Ниже приведены некоторые рекомендации при публикации приложения.

* **Использовать группы соединителей**: Назначьте группу соединителей, предназначенных для публикации каждого соответствующего приложения. Мы рекомендуем, что каждая группа соединителей имеет по крайней мере два соединителя для обеспечения высокого уровня доступности и масштабирования. Наличие три соединителя является оптимальным, если службы компьютера в любой момент может потребоваться. Кроме того, см. в разделе [публикация приложений в отдельных сетях и расположениях с помощью групп соединителей](application-proxy-connector-groups.md) чтобы увидеть, как можно использовать группы соединителей для сегментирования соединители по сети или расположение.

* **Задать время ожидания серверного приложения**: Этот параметр полезен в сценариях, где приложение может потребовать более чем на 75 секунд для обработки транзакций client. Например когда клиент отправляет запрос веб-приложению, выступает в роли внешнего интерфейса до базы данных. Внешний интерфейс отправляет этот запрос к серверу базы данных серверной части и ожидает ответа, но на момент времени, он получает ответ, клиентская часть диалога времени ожидания. Задание времени ожидания для долго предоставляет больше транзакций до 180 секунд.

* **Используйте соответствующий Cookie типы**

   * **Только протокол HTTP Cookie**: Обеспечивает дополнительную безопасность за счет прокси приложения включать флаг HTTPOnly в заголовки HTTP-ответа set-cookie. Этот параметр позволяет блокировать эксплойты, например межузловых сценариев (XSS). Оставьте значение "Нет" для агентов клиентов и пользователей, которым требуется доступ к этому файлу cookie сеанса. Например RDP/MTSC клиент, подключающийся к шлюз удаленных рабочих столов опубликованы через прокси приложения.

   * **Защита файла Cookie**: Если файл cookie имеет значение атрибута Secure, агент пользователя (приложения на стороне клиента) будет только включать куки-файл в HTTP-запросов, если запрос передается через защищенный канал TLS. Это помогает снизить риск компрометации по каналам открытым текстом, поэтому должен быть включен файл cookie.

   * **Постоянный файл Cookie**: Позволяет сохранять между замыкания браузера, останутся действительными до истечения срока действия или удаляется файл cookie сеанса прокси приложения. Используется для сценариев, где функционально насыщенного приложения, такие как office обращающийся к документу в опубликованной веб-приложения без повторного запроса для проверки подлинности пользователя. Enable с осторожностью тем не менее, виде постоянных файлов cookie можно в конечном счете оставить услуга на риск несанкционированного доступа, если не используется в сочетании с другими компенсирующие элементами управления. Этот параметр должен использоваться только для более старых приложений, которые не могут совместно использовать файлы cookie между процессами. Рекомендуется обновить приложения для обработки общего доступа файлы cookie между процессами вместо того чтобы использовать этот параметр.

* **Преобразовывать URL-адреса в заголовках**: Можно включить для сценариев, где внутренней службы DNS не может быть настроен в соответствии общедоступное пространство имен организации (называемые также разделение DNS). Если приложению не требуется исходный заголовок узла в запросе клиента, оставьте это поле, значение «Да». Вариант, чтобы использовать полное доменное имя в внутренний URL-адрес для маршрутизации для фактического трафика и полное доменное имя в внешний URL-адрес, как заголовок узла соединитель. В большинстве случаев этот вариант следует разрешить приложению работать в обычном режиме, когда удаленный доступ, но пользователи теряют преимущества соответствующий внутри и вне URL-адрес.

* **Translate URLs in Application Body** (Преобразовывать URL-адреса в коде приложения): Включите преобразование ссылок тело приложения для приложения, когда требуется ссылки из этого приложения, которые будут преобразованы в ответах обратно клиенту. Если параметр включен, эта функция предоставляет наиболее безопасным местом на перевод всех внутренних ссылок, прокси приложения выполняет поиск в HTML и CSS ответы, возвращаемые клиентам. Это полезно при публикации приложения, содержащие жестко абсолютное или NetBIOS shortname ссылки в содержимом, или приложения с содержимым, которое содержит ссылки на другие локальные приложения.

Для сценариев, где опубликованного приложения ссылок на другие опубликованные приложения включите преобразование ссылок для каждого приложения, таким образом, вы можете контролировать взаимодействие с пользователем на уровне отдельных приложений.

Например, предположим, у вас есть три приложения, опубликованные с помощью прокси приложения. Они содержат ссылки друг на друга: Преимущества, расходы и пути, а также четвертое приложение, отзыв, которое не опубликовано через прокси приложения.

![Рисунок 1](media/App-proxy-deployment-plan/link-translation.png)

При включении преобразования ссылок для приложения преимущества, ссылки на расходы "и" путешествия перенаправляются на внешние URL-адреса для этих приложений, пользователей, обращающихся к приложениям из вне корпоративной сети можно получить доступ к их. Ссылки из расходы "и" путешествия обратно к преимуществам не работают, так как преобразование ссылок еще не включена для этих двух приложений. Ссылка на отзывы не перенаправляется, так как нет нет внешнего URL-адреса, поэтому пользователи, с помощью преимущества приложения не смогут получить доступ к приложению обратной связи за пределами корпоративной сети. Просмотреть подробные сведения о [связать перевода и другие параметры перенаправления](application-proxy-configure-hard-coded-link-translation.md).

### <a name="access-your-application"></a>Доступ к приложению

Существует несколько вариантов для управления доступом к прокси приложения опубликованных ресурсов, поэтому выберите наиболее подходящий для вашего данного сценария и требований к масштабируемости. Типичные подходы включают: с помощью локальных групп, синхронизированных с помощью Azure AD Connect, создание динамических групп в Azure AD на основе атрибутов пользователя, с помощью групп самообслуживания, которые управляются владельцем ресурса, или сочетание всех вместе. См. в разделе связанные ресурсы для преимущества каждого из них.

Наиболее эффективный способ назначения пользователям доступ к приложению переводится в режим **пользователей и групп** параметров в левой области опубликованного приложения и прямого назначения групп или отдельных пользователей.

![Рисунок 24](media/App-proxy-deployment-plan/add-user.png)

Также можно разрешить пользователям самостоятельный доступ к приложению с назначение, они в настоящее время не являетесь членом группы, а также настройка параметров самообслуживание.

![Рисунок 25](media/App-proxy-deployment-plan/allow-access.png)

Если параметр включен, пользователи смогут затем выполнять вход в MyApps портала и запросите доступ, и быть автоматически утверждены и добавлен в уже разрешенную группами самообслуживания, либо требуется утверждение от назначенного утверждающего лица.

Гостевые пользователи также могут быть [приглашения для доступа к внутренним приложениям, опубликованным через прокси приложения через Azure AD B2B](https://docs.microsoft.com/azure/active-directory/b2b/add-users-information-worker).

Для локальным приложениям, обычно доступным анонимно, требуя без проверки подлинности, вы можете предпочесть отключите этот параметр, расположенный в приложения **свойства**.

![Рисунок 26](media/App-proxy-deployment-plan/assignment-required.png)


Если этот параметр, задайте значение "Нет" позволяет пользователям получить доступ к локальному приложению через прокси приложения Azure AD без разрешения, поэтому следует использовать с осторожностью.

После публикации приложения, он должен быть доступен, введя его внешний URL-адрес в браузере или значок на [ https://myapps.microsoft.com ](https://myapps.microsoft.com/).

### <a name="enable-pre-authentication"></a>Включите предварительную проверку подлинности

Убедитесь, что приложение доступно через прокси приложения, доступ к нему через внешний URL-адрес. 

1. Перейдите в **Azure Active Directory** > **Корпоративные приложения** > **Все приложения** и выберите приложение, которым необходимо управлять.

2. Выберите **Прокси приложения**.

3. В **предварительной проверки подлинности** поле, воспользуйтесь раскрывающимся списком для выбора **Azure Active Directory**и выберите **Сохранить**.

С включенной предварительной проверкой подлинности Azure AD сначала бросьте пользователей для проверки подлинности, и если единый вход — configued затем серверное приложение также будет проверять пользователя перед предоставлением доступа к приложению. Также переход в режим предварительной проверки подлинности с Passthrough Azure AD настраивает внешний URL-адрес с HTTPS, поэтому теперь любое приложение, изначально настроен для HTTP будут защищены с помощью протокола HTTPS.

### <a name="enable-single-sign-on"></a>Доступ с единым входом

SSO обеспечивает наилучшее взаимодействие с пользователем и безопасность, так как пользователям нужно только войти один раз при доступе к Azure AD. Как только пользователь прошел предварительную проверку подлинности, единый вход выполняется аутентификации соединителя прокси приложения в локальное приложение, от имени пользователя. В серверное приложение обрабатывает имя входа, как будто пользователь самостоятельно. 

Выбор **Passthrough** параметр позволяет пользователям получать доступ к опубликованному приложению без необходимости проходить проверку подлинности Azure AD.

Выполнение единого входа можно только если Azure AD могла идентифицировать пользователя, запрашивающего доступ к ресурсу, поэтому ваше приложение должно быть настроено выполнять предварительную проверку подлинности пользователей с помощью Azure AD при доступе для единого входа в функцию, в противном случае параметры единого входа будет отключена.

Чтение [единого входа в приложения в Azure AD](what-is-single-sign-on.md) поможет вам выбрать наиболее подходящий метод единого входа, при настройке приложений.

###  <a name="working-with-other-types-of-applications"></a>Работа с другими типами приложений

Прокси приложения Azure AD также поддерживает приложения, которые были разработаны для использования нашей библиотеки аутентификации Azure AD ([ADAL](https://docs.microsoft.com/azure/active-directory/develop/active-directory-authentication-libraries)) или библиотеки проверки подлинности Microsoft ([MSAL](https://azure.microsoft.com/blog/start-writing-applications-today-with-the-new-microsoft-authentication-sdks/)). Она поддерживает собственных клиентских приложений, использование Azure AD, выданных маркеров, полученных в заголовке запроса клиента для выполнения предварительной проверки подлинности от имени пользователей.

Чтение [публикации собственного и мобильных клиентских приложений](https://docs.microsoft.com/azure/active-directory/active-directory-application-proxy-native-client) и [приложений на основе утверждений](https://docs.microsoft.com/azure/active-directory/active-directory-application-proxy-claims-aware-apps) Дополнительные сведения о конфигурации прокси-сервера приложения.

### <a name="use-conditional-access-to-strengthen-security"></a>Использование условного доступа для системы безопасности.

Безопасность приложений требуется расширенный набор возможностей обеспечения безопасности, которые можно защитить от и отвечать на сложные угрозы в локальной, так и в облаке. Злоумышленники часто получить доступ к корпоративной сети через weak, по умолчанию или украденных учетные данные.  Безопасности на основе удостоверений Microsoft уменьшает использования украденных учетных данных, управление и защита привилегированные и непривилегированные удостоверения.

Для поддержки прокси приложения Azure AD можно использовать следующие возможности:

* Пользователь и условного доступа на основе расположения: Хранить конфиденциальные данные, защищенные, ограничивая доступ пользователей на основе географического расположения или IP-адрес с [политики условного доступа на основе расположения](https://docs.microsoft.com/azure/active-directory/active-directory-conditional-access-locations).

* Условный доступ, на основе устройств: Обеспечить только зарегистрированным, утвержденных и соответствующим устройствам доступ к корпоративным данным с [условного доступа на основе устройств](https://docs.microsoft.com/azure/active-directory/active-directory-conditional-access-policy-connected-applications).

* Условного доступа на основе приложения: Остановитесь, когда пользователь не находится в корпоративной сети не работы. [Безопасный доступ к корпоративным приложениям облачных и локальных](https://docs.microsoft.com/azure/active-directory/active-directory-conditional-access-mam) и контролировать с помощью условного доступа.

* На основе рисков условного доступа: Защитите свои данные от действий злоумышленников с [политики условного доступа на основе рисков](https://www.microsoft.com/cloud-platform/conditional-access) , которые могут быть применены для всех приложений и пользователей, ли в локальной или в облаке.

* Панель доступа Azure AD: Прокси приложения службы, развернутой и приложений, опубликованных безопасно предоставить пользователям простой концентратора для обнаружения и доступ к приложениям. Увеличение производительности за счет возможности самообслуживания, такие как возможность запросить доступ для новых приложений и группы, или управлять доступом к этим ресурсам от лица других пользователей, с помощью [панели доступа](https://aka.ms/AccessPanelDPDownload).

## <a name="manage-your-implementation"></a>Управлять своей реализацией

### <a name="required-roles"></a>Необходимые роли

Microsoft осуществляет принципа предоставления минимальным возможным уровнем полномочий и выполнить необходимые задания с помощью Azure AD. [Просмотрите различные роли Azure, доступные](https://docs.microsoft.com/azure/active-directory/active-directory-assign-admin-roles-azure-portal) и выбрать нужную для удовлетворения потребностей каждого пользователя. Некоторые роли может потребоваться временно применяться и удаляются после завершения развертывания.

| Бизнес-роли| Бизнес-задач| Роли Azure AD |
|---|---|---|
| Помочь администратору службы поддержки | Обычно ограничивается уточнение конечного пользователя отображается проблемы, а также выполнять только ограниченные задачи, такие как изменение паролей пользователей, стал недопустимым токены обновления и мониторинг работоспособности службы. | Администратор службы технической поддержки |
| Удостоверение администратора| Проблемы, связанные с чтения AD вход в Azure отчеты и журналы аудита для отладки приложения прокси-сервера.| Читатель сведений о безопасности |
| Владелец приложения| Создание и управление всеми аспектами корпоративных приложений, регистрации приложения и параметры прокси приложения.| Администратор приложений |
| Администратор инфраструктуры | Смена владельца сертификата | Администратор приложений |

Сокращение числа пользователей, имеющих доступ к защищенным сведениям или ресурсам поможет снизить вероятность получения несанкционированного доступа, или авторизованный пользователь непреднамеренно повлияет на критический ресурс вредоносного субъекта. 
 
Тем не менее, пользователям по-прежнему требуется выполнять привилегированные операции изо дня в день, поэтому применение just-in-time (JIT) на основе [Privileged Identity Management](https://docs.microsoft.com/azure/active-directory/active-directory-privileged-identity-management-configure) политики для предоставления по требованию привилегированный доступ к ресурсам Azure и Azure AD — это наш Рекомендуемый подход для эффективного управления административным доступом и аудита.

### <a name="reporting-and-monitoring"></a>Создание отчетов и мониторинг

Azure AD предоставляет дополнительные функции анализа в вашей организации подготовки пользователей об использовании и работоспособности через журналов и отчетов аудита. 

#### <a name="application-audit-logs"></a>Журналы аудита приложений

Эти журналы содержат подробные сведения об именах входа для приложения, настроенные с помощью прокси приложения и устройства и пользователя, доступ к приложению. Журналы аудита расположены на портале Azure и в API аудита для экспорта.

#### <a name="windows-event-logs-and-performance-counters"></a>Журналы событий Windows и счетчики производительности

Соединители содержат администратора и сеансов журналы. В журналах администратора регистрируются основные события и соответствующие ошибки. В журналах сеансов содержатся все транзакции и подробные сведения об их обработке. Журналы и счетчики, находятся в журналы событий Windows и следуют [руководству, чтобы настроить источники данных журнала событий в Azure Monitor](https://docs.microsoft.com/azure/azure-monitor/platform/data-sources-windows-events).

### <a name="troubleshooting-guide-and-steps"></a>Руководство по устранению неполадок и действия

Дополнительные сведения о распространенных проблем и способы их устранения с нашим руководством по [Устранение неполадок](application-proxy-troubleshoot.md) сообщения об ошибках. 

Следующие статьи описаны распространенные сценарии, которые также могут использоваться для создания руководства по устранению неполадок для поддержки организации. 

* [Проблемы при отображении страницы приложения](application-proxy-page-appearance-broken-problem.md)
* [Слишком долгая загрузка приложения](application-proxy-page-load-speed-problem.md)
* [Ссылки на странице приложения не работают](application-proxy-page-links-broken-problem.md)
* [Порты, которые необходимо открыть для приложения](application-proxy-connectivity-ports-how-to.md)
* [Не удается найти рабочий соединитель в группе соединителей для приложения](application-proxy-connectivity-no-working-connector.md)
* [Настройка на портале администрирования](application-proxy-config-how-to.md)
* [Настройка единого входа в приложение](application-proxy-config-sso-how-to.md)
* [Проблема при создании приложения на портале администрирования](application-proxy-config-problem.md)
* [Настройка ограниченного делегирования Kerberos](application-proxy-back-end-kerberos-constrained-delegation-how-to.md)
* [Настройка для использования PingAccess](application-proxy-back-end-ping-access-how-to.md)
* [Не удается получить доступ к корпоративному приложению](application-proxy-sign-in-bad-gateway-timeout-error.md)
* [Проблема при установке соединителя агента Application Proxy](application-proxy-connector-installation-problem.md)
* [Проблема входа](application-sign-in-problem-on-premises-application-proxy.md)
