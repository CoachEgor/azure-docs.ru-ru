---
title: Отчеты по автоматической подготовке учетных записей пользователей Azure Active Directory для приложений SaaS | Документация Майкрософт
description: Узнайте, как проверить состояние заданий автоматической подготовки учетных записей пользователей и устранить неполадки при подготовке отдельных пользователей.
services: active-directory
documentationcenter: ''
author: CelesteDG
manager: mtillman
ms.service: active-directory
ms.subservice: app-mgmt
ms.workload: identity
ms.tgt_pltfrm: app-mgmt
ms.devlang: na
ms.topic: conceptual
ms.date: 09/09/2018
ms.author: celested
ms.reviewer: asmalser
ms.collection: M365-identity-device-management
ms.openlocfilehash: e293eb555269a1f8beeeccd74000358abe1ef5c8
ms.sourcegitcommit: 44a85a2ed288f484cc3cdf71d9b51bc0be64cc33
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "64721069"
---
# <a name="tutorial-reporting-on-automatic-user-account-provisioning"></a>Руководство по Отчеты об автоматической подготовке учетных записей пользователей


Azure Active Directory включает в себя [службу подготовки учетных записей пользователей](user-provisioning.md), которая помогает автоматизировать подготовку и отзыв учетных записей пользователей в приложениях SaaS и других системах для комплексного управления жизненным циклом удостоверений. Azure AD поддерживает предварительно интегрированные соединители для подготовки пользователей для всех приложений и систем в разделе "Избранные" [коллекции приложений Azure AD](https://azuremarketplace.microsoft.com/marketplace/apps/category/azure-active-directory-apps?page=1&subcategories=featured).

В этой статье описывается, как проверить состояние заданий подготовки после их настройки и устранить неполадки при подготовке отдельных пользователей и групп.

## <a name="overview"></a>Обзор

Соединители подготовки устанавливаются и настраиваются с помощью [портала Azure](https://portal.azure.com). Для этого можно воспользоваться [документацией](../saas-apps/tutorial-list.md), предоставленной для поддерживаемого приложения. После настройки и запуска заданий подготовки можно создать отчеты по ним, воспользовавшись одним из двух способов.

* **Портал управления Azure**. В первую очередь в этой статье описывается получение данных отчетов с [портала Azure](https://portal.azure.com), предоставляющего как сводный отчет о подготовке, так и подробные журналы аудита подготовки для заданного приложения.

* **API аудита**. Azure Active Directory также предоставляет API аудита, который обеспечивает программное получение подробных журналов аудита. Документация по работе с этим API приведена в [справочнике по API аудита Azure Active Directory](https://developer.microsoft.com/graph/docs/api-reference/beta/resources/directoryaudit). Хотя в данной статье не рассматривается использование этого API, в ней описываются типы событий подготовки, записываемых в журнал аудита.

### <a name="definitions"></a>Определения

В этой статье используются термины, приведенные ниже.

* **Исходная система**. Исходный репозиторий пользователей для синхронизации службы подготовки Azure AD. Azure Active Directory является исходной системой большинства предварительно интегрированных соединителей для подготовки, однако имеются некоторые исключения (пример: входящая синхронизация Workday).

* **Целевая система**. Целевой репозиторий пользователей для синхронизации службы подготовки Azure AD. Обычно это приложение SaaS (пример: SalesForce, ServiceNow, G Suite, Dropbox for Business), но в некоторых случаях может быть в локальной системе, например Active Directory (пример: входящая синхронизация Workday в Active Directory).


## <a name="getting-provisioning-reports-from-the-azure-management-portal"></a>Получение отчетов о подготовке с портала управления Azure

Чтобы получить данные отчета о подготовке для конкретного приложения, сначала запустите [портал управления Azure](https://portal.azure.com) и перейдите к корпоративному приложению, для которого настроена подготовка. Например, если подготавливаются пользователи в LinkedIn Elevate, то путь к сведениям о приложении следующий:

**Azure Active Directory > Корпоративные приложения > Все приложения > LinkedIn Elevate**

Здесь доступны сводный отчет о подготовке и журналы аудита подготовки, как описано ниже.


## <a name="provisioning-summary-report"></a>Сводный отчет о подготовке

Сводный отчет о подготовке отображается на вкладке **Подготовка** для заданного приложения. Он расположен в разделе **Сведения о синхронизации** под заголовком **Параметры** и содержит следующую информацию.

* Общее количество пользователей и групп, которые синхронизированы и в настоящее время находятся в области действия подготовки между исходной системой и целевой системой.

* Время последнего запуска синхронизации. Обычно синхронизация выполняется каждые 20–40 минут после завершения [начальной синхронизации](user-provisioning.md#what-happens-during-provisioning).

* Сведения о том, завершена ли [начальная синхронизация](user-provisioning.md#what-happens-during-provisioning).

* Сведения о том, помещен ли процесс подготовки в карантин, а также о причине состояния карантина (например, не удалось связаться с целевой системой из-за неправильных учетных данных администратора).

Администратору следует в первую очередь просмотреть сводный отчет о подготовке при проверке работоспособности задания подготовки.

 ![Сводный отчет](./media/check-status-user-account-provisioning/summary_report.PNG)

## <a name="provisioning-audit-logs"></a>Журналы аудита подготовки
Все действия, выполняемые службой подготовки, записываются в журналы аудита Azure AD, которые можно просмотреть в разделе **Журналы аудита** в категории **Подготовка учетных записей**. В журналы записываются следующие типы событий действия.

* **События импорта**. Событие "импорта" записывается каждый, когда служба подготовки Azure AD извлекает сведения об отдельном пользователе или группе из исходной или целевой системы. Во время синхронизации сначала извлекаются данные пользователей из исходной системы, и результаты записываются как события импорта. Затем соответствующие идентификаторы полученных пользователей запрашиваются из целевой системы, чтобы проверить, существуют ли они. Результаты также записывается как события импорта. В этих событиях записываются все сопоставленные атрибуты и значения пользователей, которые были обнаружены службой подготовки Azure AD на момент возникновения события. 

* **События правил синхронизации**. Эти события сообщают о результатах правил сопоставления атрибутов и любых настроенных фильтров области после импорта и оценки данных пользователей из исходной и целевой систем. Например, если пользователь в исходной системе попал в область для подготовки и отсутствует в целевой системе, то в этом событии записывается, что пользователь будет подготовлена в целевой системе. 

* **События экспорта**. События "экспорта" записывается каждый раз, когда служба подготовки Azure AD записывает объект группы или учетной записи пользователя в целевую систему. В этих событиях записываются все атрибуты пользователей и их значения, которые были записаны службой подготовки Azure AD на момент возникновения события. Если при записи объекта группы или учетной записи пользователя в целевую систему произойдет ошибка, она будет отображена в этом событии.

* **События дополнительной обработки**. Дополнительная обработка происходит, когда возникает сбой службы подготовки при попытке выполнить операцию и она начинает повторять эту операцию с интервалом отката с возвратом. Событие дополнительной обработки записывается каждый раз, когда служба повторяет попытку выполнить операцию подготовки.

Если просмотреть события подготовки отдельного пользователя, то они обычно следуют в приведенном ниже порядке.

1. Событие импорта: данные пользователя извлекаются из исходной системы.

2. Событие импорта: выполняется запрос к целевой системе для проверки существования извлеченного пользователя.

3. Событие правила синхронизации: пользовательские данные из исходной и целевой систем оцениваются относительно настроенных правил сопоставления атрибутов и фильтров области, позволяя определить действие, которое должно выполняться при необходимости.

4. Событие экспорта: если событие правила синхронизации указывает, что необходимо выполнить действие (например, добавление, обновление или удаление), то результаты этого действия записываются в событие экспорта.

![Создание тестового пользователя Azure AD](./media/check-status-user-account-provisioning/audit_logs.PNG)


### <a name="looking-up-provisioning-events-for-a-specific-user"></a>Поиск событий подготовки для конкретного пользователя

Как правило, журналы аудита подготовки используются для проверки состояния подготовки отдельной учетной записи. Вот как можно найти события подготовки для конкретного пользователя.

1. Перейдите в раздел **Журналы аудита**.

2. В меню **Категория** выберите **Подготовка учетных записей**.

3. В меню **Диапазон дат** выберите диапазон дат для поиска.

4. В поле **Поиск** введите идентификатор пользователя, данные которого нужно найти. Формат значения идентификатора должен соответствовать элементу, выбранному в качестве основного идентификатора сопоставления в конфигурации сопоставления атрибутов (например, userPrincipalName или идентификационный номер сотрудника). Требуемое значение идентификатора будет отображено в столбце "Цели".

5. Нажмите клавишу ВВОД для поиска. Самые последние события подготовки будут показаны первыми.

6. Если события отобразились, обратите внимание на типы действий и результат их выполнения (успешное или неудачное). Если результаты не отобразились, это значит, что пользователь не существует или еще не был обнаружен процессом подготовки, если полная синхронизация не завершена.

7. Щелкните отдельные события, чтобы просмотреть подробные сведения, включая все свойства пользователя, которые были получены, оценены или записаны в ходе события.

Чтобы узнать о том, как использовать журналы аудита, см. видео ниже. Сведения о журналах аудита представлены начиная с отметки 5:30:

> [!VIDEO https://www.youtube.com/embed/pKzyts6kfrw]

### <a name="tips-for-viewing-the-provisioning-audit-logs"></a>Советы по просмотру журналов аудита подготовки

Для удобства чтения на портале Azure нажмите кнопку **Столбцы** и выберите следующие столбцы:

* **Дата** — содержит дату возникновения события.
* **Цели** — содержит имя приложения и идентификатор пользователя для события.
* **Действие** — отображает тип действия, как описано выше.
* **Состояние** — показывает, успешно ли выполнено событие.
* **Причина состояния** — содержит сводку действий, выполненных при событии подготовки.


## <a name="troubleshooting"></a>Устранение неполадок

Сводный отчет о подготовке и журналы аудита очень важны для администраторов, так как играют ключевую роль в устранении различных проблем при подготовке учетных записей пользователей.

Руководство по устранению неполадок при автоматической подготовке пользователей со сценариями доступно в разделе [Проблемы при настройке и подготовке пользователей для приложения](application-provisioning-config-problem.md).


## <a name="additional-resources"></a>Дополнительные ресурсы

* [Управление подготовкой учетных записей пользователей для корпоративных приложений](configure-automatic-user-provisioning-portal.md)
* [Что такое доступ к приложениям и единый вход с помощью Azure Active Directory?](what-is-single-sign-on.md)
