---
title: Проблемы, вопиявввв в федеративном приложении с одним вданным в галерею (ru) Документы Майкрософт
description: Рекомендации по конкретным ошибкам при входе в приложение, для которого настроен федеративный единый вход на базе SAML с помощью Azure AD
services: active-directory
documentationcenter: ''
author: msmimart
manager: CelesteDG
ms.assetid: ''
ms.service: active-directory
ms.subservice: app-mgmt
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: conceptual
ms.date: 02/18/2019
ms.author: mimart
ms.reviewer: luleon, asteen
ms.collection: M365-identity-device-management
ms.openlocfilehash: 874d273e26a728afc0a1dc1a16852016797067ca
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/27/2020
ms.locfileid: "77367901"
---
# <a name="problems-signing-in-to-a-gallery-application-configured-for-federated-single-sign-on"></a>Проблемы с входом в приложение из коллекции, для которого настроен федеративный единый вход

Для устранения неполадок в вопросы, приведенные ниже, мы рекомендуем вам следовать этим предложениям, чтобы получить лучшую диагностику и автоматизировать шаги резолюции:

- Установите [расширение my Apps Secure Browser,](access-panel-extension-problem-installing.md) чтобы помочь Active Directory Azure (Azure AD) обеспечить лучшую диагностику и разрешение при использовании опыта тестирования на портале Azure.
- Воспроизвести ошибку, используя опыт тестирования на странице конфигурации приложения на портале Azure. Узнайте больше о приложениях для [одного знака на основе Debug SAML](../azuread-dev/howto-v1-debug-saml-sso-issues.md)


## <a name="application-not-found-in-directory"></a>Приложение не найдено в каталоге

*Ошибка AADSTS70001: Приложение с идентификатором "https:\//contoso.com" не было найдено в каталоге*.

**Возможная причина**

Атрибут, `Issuer` отправленный из приложения в Azure AD в запросе SAML, не соответствует значению идентификатора, настроенного для приложения в Azure AD.

**Решение**

Убедитесь, `Issuer` что атрибут в запросе SAML соответствует значению идентификатора, настроенной в Azure AD. Если вы используете [опыт тестирования](../azuread-dev/howto-v1-debug-saml-sso-issues.md) на портале Azure с расширением my Apps Secure Browser, вам не нужно вручную следовать этим шагам.

1.  Откройте [**портал Azure**](https://portal.azure.com/) и вопием в качестве **глобального администратора** или **соадминистратора.**

1.  Откройте **расширение Active Directory Azure,** выбрав **все службы** в верхней части основного меню левой навигации.

1.  Введите **"Активный каталог Azure"** в поле поиска фильтров и выберите элемент **Azure Active Directory.**

1.  Выберите **корпоративные приложения** из меню слева от навигации Azure Active.

1.  Выберите **все приложения** для просмотра списка всех приложений.

    Если вы не видите приложение, которое вы хотите отображить здесь, используйте элемент управления **фильтром** в верхней части **списка всех приложений** и установите опцию **Show** для **всех приложений.**

1.  Выберите приложение, для которого нужно настроить единый вход.

1.  После загрузки приложения щелкните **Базовая конфигурация SAML**. Убедитесь, что значение в текстовом ящике идентификатора соответствует значению значения идентификатора, отображаемого в ошибке.



## <a name="the-reply-address-does-not-match-the-reply-addresses-configured-for-the-application"></a>Адрес ответа не соответствует адресам ответа, настроенным для приложения

*Ошибка AADSTS50011: Адрес ответа 'https:\//contoso.com' не соответствует адресам ответа, настроенным для приложения*

**Возможная причина**

Значение `AssertionConsumerServiceURL` в запросе SAML не соответствует значению URL-адреса ответа или шаблону, настроенного в Azure AD. Значение `AssertionConsumerServiceURL` в запросе SAML — это URL-адрес, который вы видите в ошибке.

**Решение**

Убедитесь, `AssertionConsumerServiceURL` что значение в запросе SAML соответствует значению URL-адреса ответа, настроенному в Azure AD. Если вы используете [опыт тестирования](../azuread-dev/howto-v1-debug-saml-sso-issues.md) на портале Azure с расширением my Apps Secure Browser, вам не нужно вручную следовать этим шагам.

1.  Откройте [**портал Azure**](https://portal.azure.com/) и вопием в качестве **глобального администратора** или **соадминистратора.**

1.  Откройте **расширение Active Directory Azure,** выбрав **все службы** в верхней части основного меню левой навигации.

1.  Введите **"Активный каталог Azure"** в поле поиска фильтров и выберите элемент **Azure Active Directory.**

1.  Выберите **корпоративные приложения** из меню слева от навигации Azure Active.

1.  Выберите **все приложения** для просмотра списка всех приложений.

    Если вы не видите приложение, которое вы хотите отображить здесь, используйте элемент управления **фильтром** в верхней части **списка всех приложений** и установите опцию **Show** для **всех приложений.**

1.  Выберите приложение, для которого нужно настроить единый вход.

1.  После загрузки приложения щелкните **Базовая конфигурация SAML**. Проверьте или обновите значение в `AssertionConsumerServiceURL` текстовом ящике URL-адреса Reply в соответствии с значением в запросе SAML.    
    
После обновления значения URL-адреса ответа в Azure AD и соответствия значения, отправленного приложением в запросе SAML, вы сможете войти в приложение.

## <a name="user-not-assigned-a-role"></a>Не назначена роль пользователя

*Ошибка AADSTS50105: Подписанная в\@пользовательском "брайан contoso.com" не назначена роль юноша для приложения.*

**Возможная причина**

Пользователю не предоставлен доступ к приложению в Azure AD.

**Решение**

Чтобы назначить одного или нескольких пользователей в приложение напрямую, выполните ниже приведенные ниже действия. Если вы используете [опыт тестирования](../azuread-dev/howto-v1-debug-saml-sso-issues.md) на портале Azure с расширением my Apps Secure Browser, вам не нужно вручную следовать этим шагам.

1.  Откройте [**портал Azure**](https://portal.azure.com/) и войдите в систему как **глобальный администратор**.

1.  Откройте **расширение Active Directory Azure,** выбрав **все службы** в верхней части основного меню левой навигации.

1.  Введите **"Активный каталог Azure"** в поле поиска фильтров и выберите элемент **Azure Active Directory.**

1.  Выберите **корпоративные приложения** из меню слева от навигации Azure Active.

1.  Выберите **все приложения** для просмотра списка всех приложений.

    Если вы не видите приложение, которое вы хотите отображить здесь, используйте элемент управления **фильтром** в верхней части **списка всех приложений** и установите опцию **Show** для **всех приложений.**

1.  Из списка приложений выберите тот, который вы хотите назначить пользователю.

1.  После загрузки приложения выберите **пользователей и группы** из меню левой навигации приложения.

1.  В верхней части списка **Пользователи и группы** нажмите кнопку **Добавить**, чтобы открыть область **Добавление назначения**.

1.  Выберите селектор **пользователей и групп** из панели **добавления назначения.**

1. В поле поиска **Поиск по имени или адресу электронной почты** введите полное имя или адрес электронной почты пользователя, которого требуется назначить.

1. Нависте над **пользователем** в списке, чтобы показать **флажок.** Нажмите на флажок рядом с фотографией или логотипом профиля пользователя, чтобы добавить пользователя в **выбранный** список.

1. **Необязательно:** Если вы хотите **добавить несколько пользователей,** введите другое полное имя или адрес электронной почты в поле поиска **по имени или адресу электронной почты** и нажмите на флажок, чтобы добавить пользователя в **выбранный** список.

1. Когда вы закончите выбор пользователей, нажмите кнопку **«Выберите»,** чтобы добавить их в список пользователей и групп, которые будут назначены в приложение.

1. **Необязательно:** Нажмите на селектор **роли выбора** в панели **добавления назначения,** чтобы выбрать роль, которую вы выбрали для выбранных пользователей.

1. Нажмите кнопку **«Назначить»,** чтобы назначить приложение выбранным пользователям.

После короткого периода времени выбранные вами пользователи смогут запускать эти приложения с помощью методов, описанных в разделе описания решения.

## <a name="not-a-valid-saml-request"></a>Не является действительным запросом SAML

*Ошибка AADSTS75005: запрос не является допустимым сообщением протокола Saml2*.

**Возможная причина**

Azure AD не поддерживает запрос SAML, отправленный приложением для единого входа. К наиболее распространенным проблемам относятся:

-   Отсутствие обязательных полей в запросе SAML
-   Метод кодировки запроса SAML

**Решение**

1. Захват запроса SAML. Следуйте учебнику [Как отладить SAML-одиночный знак для приложений в Azure AD,](../azuread-dev/howto-v1-debug-saml-sso-issues.md) чтобы узнать, как захватить запрос SAML.

1. Свяжитесь с поставщиком приложения и передайте ему следующие сведения:

   -   Запрос SAML

   -   [Требования к протоколу SAML единого входа в Azure](../develop/single-sign-on-saml-protocol.md)

Поставщик приложений должен подтвердить, что он поддерживает реализацию Azure AD SAML для одного входного.

## <a name="misconfigured-application"></a>Неправильно настроенное приложение

*Ошибка AADSTS650056: Неправильно настроенное приложение. Это может быть связано с одним из следующих: Клиент не указал никаких разрешений в запрошенных разрешений в регистрации заявки клиента. Или, Админ не дал согласия в арендатора. Или проверьте идентификатор приложения в запросе, чтобы убедиться, что он соответствует настроенному идентификатору клиентского приложения. Пожалуйста, свяжитесь с вашим представителем, чтобы исправить конфигурацию или согласие от имени арендатора.*.

**Возможная причина**

Атрибут, `Issuer` отправленный из приложения в Azure AD в запросе SAML, не соответствует значению идентификатора, настроенного для приложения в Azure AD.

**Решение**

Убедитесь, `Issuer` что атрибут в запросе SAML соответствует значению идентификатора, настроенной в Azure AD. Если вы используете [опыт тестирования](../azuread-dev/howto-v1-debug-saml-sso-issues.md) на портале Azure с расширением my Apps Secure Browser, вам не нужно вручную следовать этим шагам:

1.  Откройте [**портал Azure**](https://portal.azure.com/) и вопием в качестве **глобального администратора** или **соадминистратора.**

1.  Откройте **расширение Active Directory Azure,** выбрав **все службы** в верхней части основного меню левой навигации.

1.  Введите **"Активный каталог Azure"** в поле поиска фильтров и выберите элемент **Azure Active Directory.**

1.  Выберите **корпоративные приложения** из меню слева от навигации Azure Active.

1.  Выберите **все приложения** для просмотра списка всех приложений.

    Если вы не видите приложение, которое вы хотите отображить здесь, используйте элемент управления **фильтром** в верхней части **списка всех приложений** и установите опцию **Show** для **всех приложений.**

1.  Выберите приложение, для которого нужно настроить единый вход.

1.  После загрузки приложения щелкните **Базовая конфигурация SAML**. Убедитесь, что значение в текстовом ящике идентификатора соответствует значению значения идентификатора, отображаемого в ошибке.


## <a name="certificate-or-key-not-configured"></a>Не настроен сертификат или ключ

*Ошибка AADSTS50003: не настроен ключ подписывания*.

**Возможная причина**

Поврежден объект приложения, и Azure AD не распознает сертификат, настроенный для приложения.

**Решение**

Чтобы удалить и создать сертификат, выполните следующие действия:

1. Откройте [**портал Azure**](https://portal.azure.com/) и вопием в качестве **глобального администратора** или **соадминистратора.**

1. Откройте **расширение Azure Active Directory**, щелкнув **Все службы** в верхней части главного меню навигации слева.

1. Введите **"Активный каталог Azure"** в поле поиска фильтров и выберите элемент **Azure Active Directory.**

1. Выберите **корпоративные приложения** из меню слева от навигации Azure Active.

1. Выберите **все приложения** для просмотра списка всех приложений.

    Если вы не видите приложение, которое вы хотите отображить здесь, используйте элемент управления **фильтром** в верхней части **списка всех приложений** и установите опцию **Show** для **всех приложений.**

1. Выберите приложение, для которого нужно настроить единый вход.

1. После загрузки приложения выберите пункт **Единый вход** в меню навигации этого приложения слева.

1. Выберите **Создать новый сертификат** в разделе **SAML подписания сертификата.**

1. Выберите дату истечения срока действия, а затем нажмите **Сохранить**.

1. Проверьте **Сделать новый сертификат активным,** чтобы переопределить активный сертификат. Нажмите кнопку **Сохранить** в верхней части области и активируйте сертификат возобновления.

1. В разделе **Сертификат подписи SAML** нажмите **кнопку «Удалить** **неиспользованный** сертификат».

## <a name="saml-request-not-present-in-the-request"></a>Отсутствие запроса SAML в запросе

*Ошибка AADSTS750054: SAMLRequest или SAMLResponse должны присутствовать в качестве параметров строки запроса в запросе HTTP для перенаправления SAML.*

**Возможная причина**

Azure AD не удалось определить запрос SAML в параметрах URL-адреса в HTTP-запросе. Это может произойти, если приложение не использует связывание HTTP при отправке запроса SAML в Azure AD.

**Решение**

Приложение должно отправить запрос SAML, закодированный в заголовок местоположения с помощью перенаправления http. Дополнительные сведения о реализации см. в разделе о HTTP перенаправлении привязки в документе спецификации протокола SAML [здесь](https://docs.oasis-open.org/security/saml/v2.0/saml-bindings-2.0-os.pdf).

## <a name="azure-ad-is-sending-the-token-to-an-incorrect-endpoint"></a>Azure AD отправляет маркер в неправильную конечную точку

**Возможная причина**

Во время одного ввоза, если запрос на вставку не содержит явного URL-адреса ответа (URL-адрес Службы защиты прав потребителей), то Azure AD выберет любой из настроенных URL-адресов опоры для этого приложения. Даже если приложение имеет явный URL-адрес ответа, https://127.0.0.1:444пользователь может быть перенаправлен. 

Когда приложение добавлялось как не входящее в коллекцию, служба Azure Active Directory создавала этот URL-адрес ответа как значение по умолчанию. Эта схема изменена, и теперь Azure Active Directory больше не добавляет по умолчанию этот URL-адрес. 

**Решение**

Удалите неиспользованные URL-адреса ответа, настроенные для приложения.

1.  Откройте [**портал Azure**](https://portal.azure.com/) и вопием в качестве **глобального администратора** или **соадминистратора.**

2.  Откройте **расширение Active Directory Azure,** выбрав **все службы** в верхней части основного меню левой навигации.

3.  Введите **"Активный каталог Azure"** в поле поиска фильтров и выберите элемент **Azure Active Directory.**

4.  Выберите **корпоративные приложения** из меню слева от навигации Azure Active.

5.  Выберите **все приложения** для просмотра списка всех приложений.

    Если вы не видите приложение, которое вы хотите отображить здесь, используйте элемент управления **фильтром** в верхней части **списка всех приложений** и установите опцию **Show** для **всех приложений.**

6.  Выберите приложение, для которого нужно настроить единый вход.

7.  После загрузки приложения щелкните **Базовая конфигурация SAML**. В **URL-адресе ответа (Url-адрес Службы защиты прав потребителей)** удалите неиспользованные URL-адреса ответа по умолчанию, созданные системой. Например, `https://127.0.0.1:444/applications/default.aspx`.

## <a name="problem-when-customizing-the-saml-claims-sent-to-an-application"></a>Проблема при настройке утверждений SAML, отправляемых в приложение

Чтобы узнать, как настроить требования атрибута SAML, отправленные в приложение, смотрите [отображение утверждений в Active Directory Azure.](../develop/active-directory-claims-mapping.md)

## <a name="next-steps"></a>Дальнейшие действия

[Отладка единого входа на основе SAML в приложения в Azure Active Directory](../azuread-dev/howto-v1-debug-saml-sso-issues.md)
