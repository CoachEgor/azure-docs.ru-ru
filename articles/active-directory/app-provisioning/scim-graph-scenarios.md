---
title: Использование SCIM, Microsoft Graph и Azure AD для инициализации пользователей и обогащения приложений с помощью данных
description: Использование SCIM и Microsoft Graph вместе для подготовки пользователей и расширения возможностей приложения с использованием необходимых данных.
services: active-directory
author: msmimart
manager: CelesteDG
ms.service: active-directory
ms.subservice: app-provisioning
ms.workload: identity
ms.topic: conceptual
ms.date: 04/26/2020
ms.author: mimart
ms.reviewer: arvinh
ms.openlocfilehash: ceba22e9289e0a10211ee26a7758238a8b1f06c7
ms.sourcegitcommit: 67bddb15f90fb7e845ca739d16ad568cbc368c06
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2020
ms.locfileid: "82201692"
---
# <a name="using-scim-and-microsoft-graph-together-to-provision-users-and-enrich-your-application-with-the-data-it-needs"></a>Использование SCIM и Microsoft Graph вместе для подготовки пользователей и расширения возможностей приложения с помощью необходимых данных

**Целевая аудитория:** Эта статья предназначена для разработчиков, создающих приложения, интегрированные с Azure Active Directory (Azure AD). Если вы хотите использовать приложения, которые уже интегрированы с Azure AD, такие как Zoom, ServiceNow и DropBox, вы можете пропустить эту статью и ознакомиться с [учебниками](https://docs.microsoft.com/azure/active-directory/saas-apps/tutorial-list) по конкретным приложениям или изучить [работу службы подготовки](https://docs.microsoft.com/azure/active-directory/app-provisioning/how-provisioning-works).

**Распространенные сценарии**

Azure AD предоставляет готовую службу для подготовки и расширяемой платформы для создания приложений. Дерево принятия решений описывает, как разработчик будет использовать [scim](https://aka.ms/scimoverview) и [Microsoft Graph](https://docs.microsoft.com/graph/overview) для автоматизации подготовки. 

> [!div class="checklist"]
> * Автоматически создавать пользователей в моем приложении
> * Автоматически удалять пользователей из приложения, если у них больше нет доступа
> * Интеграция приложения с несколькими поставщиками удостоверений для подготовки
> * Обогащение моего приложения с помощью данных служб Майкрософт, таких как команды, Outlook и Office.
> * Автоматическое создание, обновление и удаление пользователей и групп в Azure AD и Active Directory

![Дерево принятия решений графа SCIM](./media/user-provisioning/scim-graph.png)

## <a name="scenario-1-automatically-create-users-in-my-app"></a>Сценарий 1. Автоматическое создание пользователей в приложении
Сегодня ИТ-администраторы подготавливают пользователей, вручную создавая учетные записи пользователей или периодически отправляют CSV-файлы в приложение. Этот процесс занимает много времени для клиентов и замедляет внедрение моего приложения. Все, что мне нужно, — это основные сведения о пользователе, такие как имя, электронная почта и userPrincipalName, для создания пользователя. 

**Совет**. 
* Если клиенты используют различные поставщиков удостоверений и вы не хотите поддерживать модуль синхронизации для интеграции с каждым из них, поддержка конечной точки [/Users](https://aka.ms/scimreferencecode) , совместимой с scim. Клиенты смогут легко использовать эту конечную точку для интеграции со службой подготовки Azure AD и автоматически создавать учетные записи пользователей при необходимости доступа. Вы можете создать конечную точку один раз, и она будет совместима со всеми поставщиков удостоверений. Просмотрите пример запроса ниже, чтобы создать пользователя с помощью SCIM.
* Если требуется, чтобы данные пользователя находящихся в объекте пользователя в Azure AD и других данных из корпорации Майкрософт, рассмотрите возможность создания конечной точки SCIM для подготовки пользователей и вызова Microsoft Graph для получения остальных данных. 

```json
POST /Users
{
    "schemas": [
        "urn:ietf:params:scim:schemas:core:2.0:User",
        "urn:ietf:params:scim:schemas:extension:enterprise:2.0:User"],
    "externalId": "0a21f0f2-8d2a-4f8e-bf98-7363c4aed4ef",
    "userName": "BillG",
    "active": true,
    "meta": {
        "resourceType": "User"
    },
    "name": {
        "formatted": "Bill Gates",
        "familyName": "Gates",
        "givenName": "Bill"
    },
    "roles": []
}
```
    
## <a name="scenario-2-automatically-remove-users-from-my-app"></a>Сценарий 2. Автоматическое удаление пользователей из моего приложения
Клиенты, использующие мое приложение, — это безопасность и требования к управлению для удаления учетных записей, когда сотрудникам они больше не нужны. Как автоматизировать отмену инициализации приложения?

**Рекомендации:** Поддержка конечной точки/Users, совместимой с SCIM. Служба подготовки Azure AD отправит запросы на отключение и удаление, когда у пользователя больше не будет доступа. Рекомендуется поддерживать как отключение, так и удаление пользователей. Ниже приведены примеры того, как будет выглядеть запрос на отключение и удаление. 

Отключение пользователя
```json
PATCH /Users/5171a35d82074e068ce2 HTTP/1.1
{
    "Operations": [
        {
            "op": "Replace",
            "path": "active",
            "value": false
        }
    ],
    "schemas": [
        "urn:ietf:params:scim:api:messages:2.0:PatchOp"
    ]
}
```
Delete user (Удаление пользователя)
```json
DELETE /Users/5171a35d82074e068ce2 HTTP/1.1
```

## <a name="scenario-3-automate-managing-group-memberships-in-my-app"></a>Сценарий 3. Автоматизация управления членством в группах в моем приложении
Мое приложение использует группы для доступа к различным ресурсам, и клиенты хотят повторно использовать группы, которые они используют в Azure AD. Как можно импортировать группы из Azure AD и обновлять их по мере изменения членства?  

**Рекомендации:** Поддержка [конечной точки](https://aka.ms/scimreferencecode)/граупс, совместимой с scim. Служба подготовки Azure AD будет создавать группы и управлять обновлениями членства в приложении. 

## <a name="scenario-4-enrich-my-app-with-data-from-microsoft-services-such-as-teams-outlook-and-onedrive"></a>Сценарий 4. расширение возможностей моего приложения с помощью данных служб Майкрософт, таких как команды, Outlook и OneDrive
Мое приложение встроено в Microsoft Teams и полагается на данные сообщений. Кроме того, мы сохраняем файлы для пользователей в OneDrive. Как можно расширить свое приложение с помощью данных из этих служб и в корпорации Майкрософт?

**Рекомендации:** [Microsoft Graph](https://docs.microsoft.com/graph/) — это точка входа для доступа к данным Майкрософт. Каждая рабочая нагрузка предоставляет API-интерфейсы с необходимыми данными. Microsoft Graph можно использовать вместе с [scim подготовки](https://docs.microsoft.com/azure/active-directory/app-provisioning/use-scim-to-provision-users-and-groups) для приведенных выше сценариев. SCIM можно использовать для подготовки базовых атрибутов пользователей в приложении при вызове Graph, чтобы получить любые другие необходимые данные. 

## <a name="scenario-5-track-changes-in-microsoft-services-such-as-teams-outlook-and-azure-ad"></a>Сценарий 5. регистрация изменений в службах Майкрософт, таких как команды, Outlook и Azure AD
Мне нужна возможность отслеживанию изменений в командах и сообщениях Outlook и реагирование на них в режиме реального времени. Как можно вернуть эти изменения в приложение?

**Рекомендации:** Microsoft Graph предоставляет [уведомления об изменениях](https://docs.microsoft.com/graph/webhooks) и [Отслеживание изменений](https://docs.microsoft.com/graph/delta-query-overview) для различных ресурсов. Обратите внимание на следующие ограничения уведомлений об изменениях.
- Если получатель событий подтверждает событие, но не может по какой бы то ни было действовать по какой либо причине, возможно, это событие будет потеряно.
- Если получатель событий подтверждает событие, но не может по какой бы то ни было действовать по какой либо причине, возможно, это событие будет потеряно.
- Уведомления об изменениях не всегда содержат [данные ресурсов](https://docs.microsoft.com/graph/webhooks-with-resource-data) по указанным выше причинам. разработчики часто используют уведомления об изменениях вместе с отслеживанием изменений для сценариев синхронизации. 

## <a name="scenario-6-provision-users-and-groups-in-azure-ad"></a>Сценарий 6. предоставление пользователей и групп в Azure AD
Мое приложение создает сведения о пользователе, который требуется клиентам в Azure AD. Это может быть приложение отдела кадров, чем управление наймом, коммуникационное приложение, которое создает номера телефонов для пользователей, или другое приложение, которое создает данные, которые будут полезны в Azure AD. Разделы справки заполнить запись пользователя в Azure AD этими данными? 

**Рекомендация** Microsoft Graph предоставляет конечные точки/Users и/Граупс, которые можно интегрировать с сегодняшней, чтобы подготавливать пользователей в Azure AD. Обратите внимание, что Azure Active Directory не поддерживает запись этих пользователей обратно в Active Directory. 

> [!NOTE]
> У Майкрософт есть служба подготовки, которая извлекает данные из приложений отдела кадров, таких как Workday и SuccessFactors. Эти интеграции создаются и управляются корпорацией Майкрософт. Для адаптации нового приложения HR к нашей службе можно запросить его на [UserVoice](https://feedback.azure.com/forums/374982-azure-active-directory-application-requests). 

## <a name="related-articles"></a>Похожие статьи

- [Обзор документации по Microsoft Graph синхронизации](https://docs.microsoft.com/graph/api/resources/synchronization-overview?view=graph-rest-beta)
- [Интеграция пользовательского приложения SCIM с Azure AD](use-scim-to-provision-users-and-groups.md)
