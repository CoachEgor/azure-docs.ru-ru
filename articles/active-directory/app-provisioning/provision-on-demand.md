---
title: Подготавливает пользователя по запросу с помощью Azure Active Directory
description: Принудительная синхронизация
services: active-directory
author: msmimart
manager: CelesteDG
ms.service: active-directory
ms.subservice: app-provisioning
ms.workload: identity
ms.topic: how-to
ms.date: 06/23/2020
ms.author: mimart
ms.reviewer: arvinh
ms.openlocfilehash: 78a56b6a848139c47d7934a47decb126afe00b7a
ms.sourcegitcommit: 877491bd46921c11dd478bd25fc718ceee2dcc08
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/02/2020
ms.locfileid: "85297534"
---
# <a name="on-demand-provisioning"></a>Подготовка по требованию
Подготовка по требованию позволяет подготовить пользователя в приложении за считаные секунды. Эту возможность можно использовать для быстрого устранения неполадок конфигурации, проверки выражений, которые были определены, фильтры области тестирования и многое другое. 

## <a name="how-to-use-on-demand-provisioning"></a>Использование подготовки по требованию 

1. Войдите на **портал Azure**.
2. Перейдите к разделу **Корпоративные приложения**.
3. Выберите приложение и перейдите на страницу конфигурации подготовки.
4. Настройте подготовку, указав учетные данные администратора.
5. Щелкните **подготавливать по запросу**.
6. Поиск пользователя по имени, фамилии, отображаемому имени, имени участника-пользователя или электронной почте.
7. В нижней части страницы щелкните готовить.

## <a name="understanding-the-provisioning-steps"></a>Основные сведения о действиях по подготовке
Функция подготовки по требованию пытается отобразить действия, которые выполняет служба подготовки при подготовке пользователя. Для подготовки пользователя обычно пять шагов, и один или несколько описанных ниже шагов будут показаны в процессе подготовки по требованию.

### <a name="step-1-test-connection"></a>Шаг 1. Проверка подключения
Служба подготовки пытается авторизовать доступ к целевому приложению, выполнив запрос "тестового пользователя". Служба подготовки предоставила ответ, указывающий, что ему разрешается продолжить подготовку. Этот шаг отображается только в случае сбоя на шаге. При успешном выполнении действия он не отображается в процессе подготовки по требованию. 

**Советы по устранению неполадок**
* Убедитесь, что в целевое приложение предоставлены допустимые учетные данные, такие как маркер секрета и URL-адрес клиента. Необходимые учетные данные зависят от приложения. Подробные руководства по настройке можно найти [здесь](https://docs.microsoft.com/azure/active-directory/saas-apps/tutorial-list). 
* Убедитесь, что целевое приложение поддерживает фильтрацию по соответствующим атрибутам, определенным в колонке сопоставления атрибутов. Чтобы понять, какие фильтры поддерживаются, может потребоваться ознакомиться с документацией по API, предоставленной разработчиком приложения.  
* Для приложений SCIM можно использовать такой инструмент, как POST, чтобы убедиться, что приложение отвечает на запросы авторизации, так как ожидает служба подготовки Azure AD. Пример запроса можно найти [здесь](https://docs.microsoft.com/azure/active-directory/app-provisioning/use-scim-to-provision-users-and-groups#request-3).

### <a name="step-2-import-user"></a>Шаг 2. Импорт пользователя
Затем служба подготовки получает пользователя из исходной системы. Атрибуты пользователя, извлекаемые службой, используются позже для определения того, находится ли пользователь в области для подготовки, проверки целевой системы для существующего пользователя и для выбора атрибутов пользователя, которые необходимо экспортировать в целевую систему. 

**Подробнее**

В разделе Просмотр сведений отображаются свойства пользователя, которые были импортированы из исходной системы (например, Azure AD).

**Советы по устранению неполадок**
* Импорт пользователя может завершиться ошибкой, если соответствующий атрибут отсутствует в объекте пользователя в исходной системе. Эту ошибку можно устранить, обновив объект пользователя, указав значение для атрибута сопоставления или изменив атрибут сопоставления в конфигурации подготовки.  
* Если в импортированном списке отсутствует ожидаемый атрибут, убедитесь, что атрибут имеет значение в объекте пользователя в исходной системе. Сейчас служба подготовки не поддерживает подготовку атрибутов null. 
* Убедитесь, что страница сопоставления атрибутов конфигурации подготовки содержит ожидаемый атрибут. 

### <a name="step-3-determine-if-user-is-in-scope"></a>Шаг 3. определение, входит ли пользователь в область
Затем служба подготовки определяет, находится ли пользователь в [области](https://docs.microsoft.com/azure/active-directory/app-provisioning/how-provisioning-works#scoping) для подготовки. Служба будет рассматривать такие аспекты, как принадлежность пользователя к приложению, задано ли для параметра scope значение синхронизация назначено или синхронизировать все, а также фильтры области, определенные в конфигурации подготовки.  

**Подробнее**

В разделе Просмотр сведений отображаются условия, которые были оценены. Может появиться одно из следующих свойств:
* **Активна в исходной системе** указывает, что для пользователя в Azure AD свойству задано значение true.
* **Назначено приложению** указывает, что пользователь назначен приложению в Azure AD
* **Область синхронизация все** указывает, что параметр Scope разрешает всем пользователям и группам в клиенте.
* **Пользователь имеет обязательную роль** указывает, что пользователь имеет необходимые роли для подготовки в приложении. 
* **Фильтры области** будут отображаться также, если для приложения определены фильтры области. Фильтр будет отображаться в следующем формате: {заголовок фильтра области} {атрибут фильтра области} {оператор фильтра области} {значение фильтра области}. 

**Советы по устранению неполадок**
* Убедитесь, что определена допустимая роль области. Например, старайтесь не использовать оператор ["больше чем"](https://docs.microsoft.com/azure/active-directory/app-provisioning/define-conditional-rules-for-provisioning-user-accounts#create-a-scoping-filter) с нецелочисленным значением. 
* Если у пользователя нет необходимой роли, ознакомьтесь с советами, описанными [здесь](https://docs.microsoft.com/azure/active-directory/app-provisioning/application-provisioning-config-problem-no-users-provisioned#provisioning-users-assigned-to-the-default-access-role). 

### <a name="step-4-match-user-between-source-and-target"></a>Шаг 4. Сопоставление пользователя между исходным и целевым элементами
На этом шаге. служба пытается сопоставить пользователя, полученного на шаге импорта, с пользователем в целевой системе. 

**Подробнее**

На страницах Просмотр сведений отображаются свойства пользователей, которые были сопоставлены в целевой системе. Свойства, отображаемые в области контекста, будут отличаться следующим образом.
* Если в целевой системе нет пользователей, для которых не найдено ни одного пользователя, вы не увидите никаких свойств.
* Если в целевой системе имеется один пользователь, вы увидите свойства соответствующего пользователя из целевой системы.
* Если найдено несколько пользователей, вы увидите свойства обоих соответствующих пользователей.
* Если несколько соответствующих атрибутов являются частью сопоставлений атрибутов, каждый соответствующий атрибут будет оцениваться последовательно и отображены соответствующие пользователи. 

**Сведения об устранении неполадок**
* Служба подготовки не может однозначно сопоставить пользователя в источнике с пользователем в целевом объекте. Это можно разрешить, убедившись, что соответствующий атрибут уникален. 
* Убедитесь, что целевое приложение поддерживает фильтрацию по атрибуту, определенному как атрибут сопоставления.  

### <a name="step-5-perform-action"></a>Шаг 5. выполнение действия
Наконец, служба подготовки выполняет такие действия, как создание, обновление, удаление или пропуск пользователя. 

**Подробнее**

В разделе Просмотр сведений отображаются атрибуты, которые были изменены в целевом приложении. Это представляет окончательный результат действия службы подготовки и экспортированных атрибутов. Если этот шаг завершается неудачей, отображаемые атрибуты представляют атрибуты, которые служба подготовки попыталась изменить.  

**Советы по устранению неполадок**
* Сбои при экспорте изменений могут сильно различаться. Ознакомьтесь с [документацией](https://docs.microsoft.com/azure/active-directory/reports-monitoring/concept-provisioning-logs#error-codes) по журналам подготовки для распространенных сбоев.


## <a name="frequently-asked-questions"></a>Часто задаваемые вопросы
**Нужно ли отключить подготовку для использования подготовки по требованию?** Для приложений, использующих длительный токен носителя или имя пользователя и пароль для авторизации, никаких дополнительных действий не требуется. Приложения, использующие OAuth для авторизации, в настоящее время требуют, чтобы задание подготовки было остановлено перед использованием подготовки по требованию. В эту категорию входят такие приложения, как G Suite, Box, Рабочая область на Facebook и временной резерв. Работа выполняется, чтобы разрешить выполнение подготовки по требованию для всех приложений без необходимости прекращать подготовку. 

**Сколько времени занимает подготовка по требованию?** Обычно это занимает менее 30 секунд. 

## <a name="known-limitations"></a>Известные ограничения
В настоящее время существует несколько известных ограничений. Запишитесь на [UserVoice](https://aka.ms/appprovisioningfeaturerequest) , чтобы мы могли лучше определить приоритеты, чтобы сделать следующее. Обратите внимание, что эти ограничения относятся к возможности подготовки по требованию. сведения о том, поддерживает ли приложение группы подготовки, удаления и т. д., см. в руководстве по приложению. 

* Приложения Workday, AWS и SuccessFactors не поддерживают подготовку по требованию.
* Подготовка групп и ролей по запросу не поддерживается.
* Отключение или удаление пользователей и групп не поддерживается.

## <a name="next-steps"></a>Следующие шаги

* [Устранение неполадок при подготовке](https://docs.microsoft.com/azure/active-directory/app-provisioning/application-provisioning-config-problem)
