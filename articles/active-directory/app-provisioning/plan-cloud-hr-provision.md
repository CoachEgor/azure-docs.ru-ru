---
title: Планирование облачного HR-приложения для подготовки пользователей Azure Active Directory
description: В этой статье описывается процесс развертывания облачных HR-систем, таких как Workday и SuccessFactors, с Azure Active Directory. Интеграция Azure AD с облачной системой управления персоналом приводит к полной системе управления жизненным циклом идентификации.
services: active-directory
author: martincoetzer
manager: CelesteDG
tags: azuread
ms.service: active-directory
ms.subservice: app-provisioning
ms.topic: conceptual
ms.workload: identity
ms.date: 11/22/2019
ms.author: martinco
ms.reviewer: arvindha
ms.openlocfilehash: 28abe2dfa5a1a13ba09e20202180cb5e47d94072
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/27/2020
ms.locfileid: "77522438"
---
# <a name="plan-cloud-hr-application-to-azure-active-directory-user-provisioning"></a>Планирование облачного HR-приложения для подготовки пользователей Azure Active Directory

Исторически Сложилось так, что ИТ-персонал использовал ручные методы для создания, обновления и удаления сотрудников. Они использовали такие методы, как загрузка файлов CSV или пользовательских скриптов для синхронизации данных сотрудников. Эти процессы подготовки подвержены ошибкам, небезопасным и трудно управляемым.

Для управления жизненными циклами сотрудников, поставщиков или условных работников [служба предоставления услуг по предоставлению пользовательских ресурсов Azure Active Directory (Azure AD)](../app-provisioning/user-provisioning.md) предлагает интеграцию с приложениями для управления персоналом на основе облачных ресурсов (HR). Примеры приложений включают Workday или SuccessFactors.

Azure AD использует эту интеграцию для обеспечения следующих рабочих процессов облачного HR-приложения (app):

- **Предоставление пользователям Active Directory:** Предоставление выбранных наборов пользователей из облачного приложения HR в один или несколько доменов Active Directory.
- **Предоставление только для пользователей облачных технологий Azure AD:** В сценариях, в которых Active Directory не используется, предоставление пользователям непосредственно из облачного HR-приложения к Azure AD.
- **Напишите обратно в облачное HR-приложение:** Напишите адреса электронной почты и атрибуты имени пользователя из Azure AD обратно в облачное HR-приложение.

> [!NOTE]
> В этом плане развертывания отображается способ развертывания рабочих процессов облачных HR-приложений с помощью подготовки пользователей Azure AD. Для получения информации о том, как развернуть автоматическую подготовку пользователей к программному обеспечению в качестве приложения службы (SaaS), [см.](https://aka.ms/deploymentplans/provisioning)

## <a name="enabled-hr-scenarios"></a>Сценарии HR с включенным персоналом

Служба предоставления услуг по предоставлению пользователей Azure AD позволяет автоматизировать следующие сценарии управления жизненным циклом идентификации на основе HR:

- **Новый наем сотрудников:** При добавлении нового сотрудника в облачное HR-приложение пользовательская учетная запись автоматически создается в Active Directory и Azure AD с возможностью записи обратно адреса электронной почты и атрибутов имени пользователя в облачное hr-приложение.
- **Атрибут сотрудника и обновления профиля:** Когда запись сотрудника, например имя, название или менеджер, обновляется в облачном HR-приложении, их учетная запись пользователя автоматически обновляется в Active Directory и Azure AD.
- **Увольнения сотрудников:** При завершении работы сотрудника в облачном HR-приложении его учетная запись пользователя автоматически отключается в Active Directory и Azure AD.
- **Сотрудник нанимает:** При повторном найме сотрудника в облачном HR-приложении его старая учетная запись может быть автоматически активирована или перезаранее перенаправима в Active Directory и Azure AD.

## <a name="who-is-this-integration-best-suited-for"></a>Для кого эта интеграция лучше всего подходит?

Интеграция облачных HR-приложений с подготовкой пользователей Azure AD идеально подходит для организаций, которые:

- Хотите заранее построенное облачное решение для подготовки облачных hr-пользователей.
- Требуется прямая подготовка пользователей от облачного HR-приложения к Active Directory или Azure AD.
- Требовать, чтобы пользователи были подготовлены с помощью данных, полученных из облачного приложения HR.
- Требуйте присоединения, перемещения и синхронизации пользователей с одним или большим числом лесов, доменов и оу,5, основанных только на информации об изменении, обнаруженной в облачном hr-приложении.
- Используйте Office 365 для электронной почты.

## <a name="learn"></a>Обучение

Подготовка пользователей создает основу для постоянного управления идентификацией. Это повышает качество бизнес-процессов, которые опираются на авторитетные данные идентичности.

### <a name="terms"></a>Термины

В этой статье используются следующие термины:

- **Исходная система**: Репозиторий пользователей, от которого предусмотрено Azure AD. Примером может служить облачное HR-приложение, такое как Workday или SuccessFactors.
- **Целевая система**: Репозиторий пользователей, к которым привижает Azure AD. Примерами являются Active Directory, Azure AD, Office 365 или другие приложения SaaS.
- **Процесс Joiners-Movers-Leavers:** термин, используемый для новых сотрудников, переводов и прекращения с помощью облачного приложения HR в качестве системы записей. Процесс завершается, когда служба успешно обеспечивает необходимые атрибуты целевой системы.

### <a name="key-benefits"></a>Основные преимущества

Эта возможность подготовки к ИТ, ориентированная на ПЕРСОНАЛ, предлагает следующие значительные преимущества для бизнеса:

- **Повышение производительности:** Теперь можно автоматизировать назначение учетных записей пользователей и лицензий Office 365 и предоставить доступ к ключевым группам. Автоматизация заданий дает новым сотрудникам немедленный доступ к их инструментам работы и повышает производительность.
- **Управление рисками:** Повысить безопасность можно, автоматизируя изменения на основе статуса сотрудника или членства в группе с данными, поступлениями из облачного приложения HR. Автоматизация изменений гарантирует, что идентификаторы пользователей и доступ к ключевым приложениям обновляются автоматически при переходе пользователей или выходе из организации.
- **Решение проблемы соблюдения и управления:** Azure AD поддерживает журналы аутинговых аудитов для запросов на подготовку пользователей, выполняемых приложениями как исходных, так и целевых систем. С помощью аудита можно отслеживать, кто имеет доступ к приложениям с одного экрана.
- **Управление затратами:** Автоматическое подготовка снижает затраты, избегая неэффективности и человеческих ошибок, связанных с ручной подготовкой. Это уменьшает потребность в пользовательских решениях для подготовки пользователей, созданных с течением времени с помощью устаревших и устаревших платформ.

### <a name="licensing"></a>Лицензирование

Для настройки облачного HR-приложения для интеграции пользователей Azure AD требуется действительная [лицензия Azure AD Premium](https://azure.microsoft.com/pricing/details/active-directory/) и лицензия для облачного HR-приложения, например Workday или SuccessFactors.

Вам также нужна действительная azure AD Premium P1 или более высокая лицензия подписки для каждого пользователя, которая будет получена из облачного HR-приложения и подготовлена либо active Directory, либо Azure AD. Любое неправильное количество лицензий, принадлежащих в облачном HR-приложении, может привести к ошибкам при подготовке пользователей.

### <a name="prerequisites"></a>Предварительные требования

- Глобальный доступ администратора Azure AD для настройки агента подготовки Azure AD Connect.
- Пример тестирования и производства облачного HR-приложения.
- Разрешение администратора в облачном HR-приложении для создания пользователя системной интеграции и внесения изменений в тест данных сотрудников для целей тестирования.
- Для подготовки пользователей к Active Directory сервер под управлением Windows Server 2012 или больше с помощью времени выполнения .NET 4.7.1 требуется для размещения агента по [подготовке Azure AD Connect.](https://go.microsoft.com/fwlink/?linkid=847801)
- [Azure AD Connect](../hybrid/whatis-azure-ad-connect.md) для синхронизации пользователей между Active Directory и Azure AD.

### <a name="training-resources"></a>Учебные ресурсы

| **Ресурсы** | **Ссылка и описание** |
|:-|:-|
| Видео | [Что такое подготовка пользователей в каталоге Active Azure?](https://youtu.be/_ZjARPpI6NI) |
| | [Как развернуть подготовку пользователей в каталоге Active Azure](https://youtu.be/pKzyts6kfrw) |
| Учебники | [Список учебников по интеграции приложений SaaS с Azure AD](../saas-apps/tutorial-list.md) |
| | [Руководство по настройке Workday для автоматической подготовки пользователей](../saas-apps/workday-inbound-tutorial.md#frequently-asked-questions-faq) |
| часто задаваемые вопросы | [Автоматическая подготовка пользователей](../app-provisioning/user-provisioning.md#what-applications-and-systems-can-i-use-with-azure-ad-automatic-user-provisioning) |
| | [Подготовка от рабочего дня к Azure AD](../saas-apps/workday-inbound-tutorial.md#frequently-asked-questions-faq) |

### <a name="solution-architecture"></a>Архитектура решения

Ниже приводится пример сквозной архитектуры решений для совместного подготовки пользователей для общих гибридных сред и включает в себя:

- **Авторитетный поток HR-данных из облачного HR-приложения в Active Directory.** В этом потоке в облаке HR-клиентах инициируется hr-событие (процесс Joiners-Movers-Leavers). Служба предоставления AD Azure AD и агент по предоставлению подключения Azure AD connect присваивают данные пользователей от арендатора облачного HR-приложения в Active Directory. В зависимости от события это может привести к созданию, обновлению, включить и отключить операции в Active Directory.
- **Синхронизируйте с Azure AD и записывайте обратно электронную почту и имя пользователя из предварительного Active Directory в облачное HR-приложение.** После обновления учетных записей в Active Directory они синхронизируются с Azure AD через Azure AD Connect. Адреса электронной почты и атрибуты имени пользователя могут быть записаны обратно в наниматель облачного приложения HR.

![Схема рабочих процессов](media/plan-cloud-hr-provision/plan-cloudhr-provisioning-img1.png)

#### <a name="description-of-workflow"></a>Описание рабочего процесса

Следующие ключевые шаги указаны на диаграмме:  

1. **HR-группа** выполняет транзакции в облаке HR-клиента.
2. **Служба предоставления AD Azure** запускает запланированные циклы от нанимателя приложения для HR и определяет изменения, которые необходимо обрабатывать для синхронизации с Active Directory.
3. **Служба предоставления AD Azure** вызывает агента по подготовке Azure AD Connect с полезной нагрузкой запроса, которая содержит создание, обновление, обновление и отключение операций учетной записи Active Directory.
4. **Агент по подготовке Azure AD Connect** использует учетную запись службы для управления данными учетной записи Active Directory.
5. **Azure AD Connect** запускает [синхронизацию](../hybrid/how-to-connect-sync-whatis.md) дельты, чтобы вытащить обновления в Active Directory.
6. **Обновления Active Directory** синхронизируются с Azure AD.
7. **Служба предоставления AD Azure** записывает атрибут электронной почты и имя пользователя из Azure AD в сторону арендатора облачных HR-приложений.

## <a name="plan-the-deployment-project"></a>Планирование проекта развертывания

Учитывайте ваши организационные потребности, пока вы определяете стратегию развертывания в среде.

### <a name="engage-the-right-stakeholders"></a>Привлечение правильных заинтересованных сторон

Когда технологические проекты терпят неудачу, они обычно делают это из-за несовпадающих ожиданий в отношении воздействия, результатов и обязанностей. Чтобы избежать этих ловушек, [убедитесь, что вы привлекаете нужных заинтересованных сторон.](https://aka.ms/deploymentplans) Также убедитесь, что роли заинтересованных сторон в проекте хорошо понятны. Документируйте заинтересованные стороны и их вклад в проект и учетные записи.

Включите представителя от организации по персоналу, который может предоставить данные по существующим бизнес-процессам и идентификации сотрудников, а также требования к обработке рабочих данных.

### <a name="plan-communications"></a>Планирование информирования

Коммуникация имеет решающее значение для успеха любой новой службы. Проактивно общайтесь с пользователями о том, когда и как изменится их опыт. Пусть они знают, как получить поддержку, если они испытывают проблемы.

### <a name="plan-a-pilot"></a>Планирование пилотного проекта

Интеграция бизнес-процессов и рабочих процессов идентификации из облачного HR-приложения в целевые системы требует значительного объема проверки данных, преобразования данных, очистки данных и сквозного тестирования, прежде чем вы сможете развернуть решение в рабочей силе.

Запустите начальную конфигурацию в [пилотной среде,](../fundamentals/active-directory-deployment-plans.md#best-practices-for-a-pilot) прежде чем масштабировать ее для всех пользователей в производственной среде.

## <a name="select-cloud-hr-provisioning-connector-apps"></a>Выберите приложения для подготовки облачных кадров

Для облегчения рабочих процессов Azure AD между облачным HR-приложением и Active Directory можно добавить несколько приложений для подготовки разъемов из галереи приложений Azure AD:

- **Облачное HR-приложение для подготовки пользователей Active Directory:** Это приложение для подготовки разъема облегчает подготовку учетной записи пользователя от облачного приложения HR к единому домену Active Directory. Если имеется несколько доменов, можно добавить один экземпляр этого приложения из коллекции приложений Azure AD для каждого домена Active Directory, в котором требуется подготовка.
- **Облачное HR-приложение для подготовки пользователей Azure AD:** В то время как Azure AD Connect — это инструмент, который должен использоваться для синхронизации пользователей Active Directory с Azure AD, это приложение для разъема для подготовки пользователей облачных технологий от облачного ПРИЛОЖЕНИЯ HR до одного нанимателя Azure AD.
- Запись облачного **HR-приложения:** Это приложение для подготовки разъемов облегчает списания адресов электронной почты пользователя из Azure AD в облачное приложение HR.

Например, на следующем изображении перечислены приложения для разъема рабочего дня, доступные в галерее приложений Azure AD.

![Галерея приложений портала Azure Active Directory](media/plan-cloud-hr-provision/plan-cloudhr-provisioning-img2.png)

### <a name="decision-flow-chart"></a>Диаграмма потока решений

Используйте следующую диаграмму потока решений, чтобы определить, какие приложения для подготовки облачных кадров имеют отношение к вашему сценарию.

![Диаграмма потока решений](media/plan-cloud-hr-provision/plan-cloudhr-provisioning-img3.png)

## <a name="design-the-azure-ad-connect-provisioning-agent-deployment-topology"></a>Разработка топологии развертывания агента подключения Azure AD

Интеграция подготовки между облачным HR-приложением и Active Directory требует четырех компонентов:

- Арендатор приложения Cloud HR
- Приложение для подготовки разъема
- Агент по подготовке Azure AD Connect
- Домен Active Directory

Топология развертывания развертывания агента Azure AD Connect зависит от количества арендаторов облачных HR-приложений и доменов Active Directory, которые планируется интегрировать. Если у вас есть несколько доменов Active Directory, это зависит от того, являются ли домены Active Directory смежными или [разрозненными.](https://docs.microsoft.com/windows-server/identity/ad-ds/plan/disjoint-namespace)

На основе решения выберите один из сценариев развертывания:

- Арендатор приложения для одного облака HR -> целевых одиночных или нескольких доменов ребенка Active Directory в надежном лесу
- Однооблако HR-приложение арендатора -> целевой несколько доменов ребенка в разрозненных Active Directory лес

### <a name="single-cloud-hr-app-tenant---target-single-or-multiple-active-directory-child-domains-in-a-trusted-forest"></a>Арендатор приложения для одного облака HR -> целевых одиночных или нескольких доменов ребенка Active Directory в надежном лесу

Мы рекомендуем следующую конфигурацию производства:

|Требование|Рекомендация|
|:-|:-|
|Количество агентов по развертыванию AD-соединения Azure AD Для развертывания|Два (для высокой доступности и неудачи)
|Количество приложений для настройки разъема для настройки|Одно приложение на детский домен|
|Хост сервера для агента по подготовке Azure AD Connect|Windows 2012 R2 с прямой видимости для геолокации контроллеров домена Active Directory</br>Может ли сосуществовать с сервисом Azure AD Connect|

![Поток к агентам на месте](media/plan-cloud-hr-provision/plan-cloudhr-provisioning-img4.png)

### <a name="single-cloud-hr-app-tenant---target-multiple-child-domains-in-a-disjoint-active-directory-forest"></a>Однооблако HR-приложение арендатора -> целевой несколько доменов ребенка в разрозненных Active Directory лес

Этот сценарий предполагает подготовку пользователей из облачного приложения HR к доменам в разрозненных лесах Active Directory.

Мы рекомендуем следующую конфигурацию производства:

|Требование|Рекомендация|
|:-|:-|
|Количество агентов по развертыванию ad-агентов Azure AD Connect для развертывания на месте|Два на разрозненные Active Directory forest|
|Количество приложений для настройки разъема для настройки|Одно приложение на детский домен|
|Хост сервера для агента по подготовке Azure AD Connect|Windows 2012 R2 с прямой видимости для геолокации контроллеров домена Active Directory</br>Может ли сосуществовать с сервисом Azure AD Connect|

![Однооблако HR-приложение арендатора разъединяется Активный каталог леса](media/plan-cloud-hr-provision/plan-cloudhr-provisioning-img5.png)

### <a name="azure-ad-connect-provisioning-agent-requirements"></a>Требования к агенту По предоставлению aD Azure AD

Облачное HR-приложение для решения для подготовки пользователей Active Directory требует развертывания одного или нескольких агентов по развертыванию Azure AD Connect на серверах, запускающих Windows 2012 R2 или больше. Серверы должны иметь не менее 4 ГБ оперативной памяти и время выполнения .NET 4.7.1. Убедитесь, что сервер-хозяин имеет сетевой доступ к целевому домену Active Directory.

Для подготовки среды, Azure AD Connect конфигурация агента конфигурации регистрирует агента с вашим арендатором Azure AD, [открывает порты,](../manage-apps/application-proxy-add-on-premises-application.md#open-ports) [позволяет получить доступ к URL-адресам,](../manage-apps/application-proxy-add-on-premises-application.md#allow-access-to-urls)и поддерживает [исходящие конфигурации прокси HTTPS.](../saas-apps/workday-inbound-tutorial.md#how-do-i-configure-the-provisioning-agent-to-use-a-proxy-server-for-outbound-http-communication)

Поставщик использует учетную запись службы для связи с доменами Active Directory. Перед установкой агента создайте учетную запись службы в Active Directory Users and Computers, которая отвечает следующим требованиям:

- Пароль, срок действия которого не истекает
- Делегированные разрешения управления для чтения, создания, удаления и управления учетными записями пользователей

Можно выбрать контроллеры доменов, которые должны обрабатывать запросы на подготовку. Если у вас есть несколько географически распределенных контроллеров домена, установите агент подготовки на том же сайте, что и предпочтительные контроллеры домена. Такое позиционирование повышает надежность и производительность сквозного решения.

Для высокой доступности можно развернуть несколько агентов по подключению Azure AD Connect. Зарегистрируйте агента для обработки одного и того же набора доменов Active Directory.

## <a name="plan-scoping-filters-and-attribute-mapping"></a>Планирование отслеживания фильтров и отображение атрибутов

При вменении приложения для управления персоналом из облачного приложения в Active Directory или Azure AD портал Azure управляет значениями атрибутов с помощью отображения атрибутов.

### <a name="define-scoping-filters"></a>Определение фильтров для скопирования

Используйте [фильтры для определения](../app-provisioning/define-conditional-rules-for-provisioning-user-accounts.md) правил, основанных на атрибутах, которые определяют, какие пользователи должны быть подготовлены от облачного HR-приложения к Active Directory или Azure AD.

Когда вы инициируете процесс Joiners, соберите следующие требования:

- Используется ли облачное HR-приложение для привлечения на борт как сотрудников, так и сотрудников контингента?
- Планируете ли вы использовать облачное HR-приложение для подготовки пользователей Azure AD для управления как сотрудниками, так и сотрудниками контингентов?
- Планируете ли вы внедрить облачное HR-приложение для пользователя Azure AD, подготовленного только для подмноженого приложения для облачных HR-приложений? Примером могут быть только сотрудники.

В зависимости от ваших требований при настройке отображения атрибутов можно настроить поле **области области исходного объекта,** чтобы выбрать, какие наборы пользователей в облачном HR-приложении должны быть в рамках подготовки к Active Directory. Для получения дополнительной информации ознакомьтесь с учебником по облачным приложениям HR для широко используемых фильтров для скопирования.

### <a name="determine-matching-attributes"></a>Определение соответствующих атрибутов

С подготовкой вы получаете возможность сопоставлять существующие учетные записи между источником и целевой системой. При интеграции облачного HR-приложения с службой обеспечения AD Azure AD можно [настроить отображение атрибутов,](../app-provisioning/configure-automatic-user-provisioning-portal.md#mappings) чтобы определить, какие пользовательские данные должны передаваться из облачного HR-приложения в Active Directory или Azure AD.

Когда вы инициируете процесс Joiners, соберите следующие требования:

- Каков уникальный идентификатор в этом облачном HR-приложении, которое используется для идентификации каждого пользователя?
- С точки зрения жизненного цикла идентификации, как вы обрабатываете ренайсы? Ли rehires сохранить свои старые идотов сотрудника?
- Вы обрабатываете будущие наймы и создаете для них учетные записи Active Directory заранее?
- С точки зрения жизненного цикла идентификации, как вы обрабатываете сотрудника к преобразованию контингента работника, или иным образом?
- У преобразованных пользователей сохранить свои старые учетные записи Active Directory или они получают новые?

В зависимости от ваших требований Azure AD поддерживает прямое отображение атрибутов, предоставляя постоянные значения или [записывая выражения для отображений атрибутов.](../app-provisioning/functions-for-customizing-application-data.md) Эта гибкость позволяет вам в конечном итоге контролировать то, что заселены в целевом атрибуте приложения. Можно использовать [Microsoft Graph API](../app-provisioning/export-import-provisioning-configuration.md) и Graph Explorer для экспорта отображения атрибутов и схемы атрибутов пользователя в файл JSON и импорта его обратно в Azure AD.

По умолчанию атрибут в облачном HR-приложении, представляющем уникальный идентификатор сотрудника, используется в качестве соответствующего атрибута, *отображаемого с уникальным атрибутом в Active Directory.* Например, в сценарии приложения «Рабочий день» атрибут **Workday** **WorkerID** отображается в атрибуте «Активный **каталог» для сотрудников.**

Можно установить несколько соответствующих атрибутов и назначить приоритет соответствия. Они оцениваются по соответствующей приоритетности. Как только соответствие найдено, дальнейшие атрибуты сопоставления не вычисляются.

Можно также [настроить отображение атрибутов по умолчанию,](../app-provisioning/customize-application-attributes.md#understanding-attribute-mapping-types)например изменение или удаляние существующих отображений атрибутов. Вы также можете создавать новые отображения атрибутов в соответствии с потребностями вашего бизнеса. Для получения дополнительной информации смотрите учебник по облачным приложениям HR (например, [Workday)](../saas-apps/workday-inbound-tutorial.md#planning-workday-to-active-directory-user-attribute-mapping-and-transformations)для списка пользовательских атрибутов на карте.

### <a name="determine-user-account-status"></a>Определение состояния учетной записи пользователя

По умолчанию приложение для разъема подготовки отображает статус профиля HR-пользователя со статусом учетной записи пользователя в Active Directory или Azure AD, чтобы определить, следует ли включить или отключить учетную запись пользователя.

Когда вы инициируете процесс Joiners-Leavers, соберите следующие требования.

| Процесс | Требования |
| - | - |
| **Столяров** | С точки зрения жизненного цикла идентификации, как вы обрабатываете ренайсы? Ли rehires сохранить свои старые идотов сотрудника? |
| | Вы обрабатываете будущие наймы и создаете для них учетные записи Active Directory заранее? Создаются ли эти учетные записи в состоянии с включенным или отключенным? |
| | С точки зрения жизненного цикла идентификации, как вы обрабатываете сотрудника к преобразованию контингента работника, или иным образом? |
| | Сохраняют ли конвертированные пользователи свои старые учетные записи Active Directory или получают новые? |
| **Выпускников** | Рассматриваются ли увольнения по-разному для сотрудников и работников контингента в Active Directory? |
| | Какие эффективные даты считаются для обработки пользователей прекращения? |
| | Как конверсии сотрудников и контингентов влияют на существующие учетные записи Active Directory? |
| | Как обработать операцию Rescind в Active Directory? Операции по отмене должны быть обработаны, если будущие датированные наймы создаются в Active Directory как часть процесса Joiner. |

В зависимости от ваших требований можно настроить логику отображения с помощью [экспрессий Azure AD,](../app-provisioning/functions-for-customizing-application-data.md) чтобы учетная запись Active Directory была включена или отключена на основе комбинации точек данных.

### <a name="map-cloud-hr-app-to-active-directory-user-attributes"></a>Карта облачного HR-приложения с атрибутами пользователя Active Directory

Каждое облачное HR-приложение поставляется с облачным hr-приложением по умолчанию в отображение Active Directory.

Когда вы инициируете процесс Joiners-Movers-Leavers, соберите следующие требования.

| Процесс | Требования |
| - | - |
| **Столяров** | Является ли процесс создания учетной записи Active Directory ручным, автоматизированным или частично автоматизированным? |
| | Планируете ли вы распространять пользовательские атрибуты из облачного приложения HR в Active Directory? |
| **Переезд** | Какие атрибуты вы хотели бы обработать всякий раз, когда операция Movers происходит в облачном HR-приложении? |
| | Выполняете ли вы какие-либо конкретные проверки атрибутов во время обновления пользователей? Если да, предоставьте подробную информацию. |
| **Выпускников** | Рассматриваются ли увольнения по-разному для сотрудников и работников контингента в Active Directory? |
| | Какие эффективные даты считаются для обработки пользователей прекращения? |
| | Как конверсии сотрудников и контингента влияют на существующие учетные записи Active Directory? |

В зависимости от ваших требований, вы можете изменить отображение для достижения ваших целей интеграции. Для получения дополнительной информации ознакомьтесь с конкретным учебником по облачным приложениям HR (например, [Workday)](../saas-apps/workday-inbound-tutorial.md#planning-workday-to-active-directory-user-attribute-mapping-and-transformations)для составления списка пользовательских атрибутов на карте.

### <a name="generate-a-unique-attribute-value"></a>Создание уникального значения атрибута

При инициировании процесса Joiners может потребоваться создание уникальных значений атрибутов при установке атрибутов, таких как CN, samAccountName и UPN, которые могут быть уникальными ограничениями.

Функция Azure AD [SelectUniqueValues](../app-provisioning/functions-for-customizing-application-data.md#selectuniquevalue) оценивает каждое правило, а затем проверяет значение, генерируемое на уникальность в целевой системе. Например, [см. Создайте уникальное значение для атрибута userPrincipalName (UPN).](../app-provisioning/functions-for-customizing-application-data.md#generate-unique-value-for-userprincipalname-upn-attribute)

> [!NOTE]
> Эта функция в настоящее время поддерживается только для Workday для подготовки пользователей Active Directory. Он не может быть использован с другими приложениями подготовки.

### <a name="configure-active-directory-ou-container-assignment"></a>Настройка назначения контейнера Active Directory OU

Обычное требование является размещать учетные записи пользователей Active Directory в контейнерах на основе бизнес-единиц, местоположений и отделов. При инициировании процесса Movers и изменении наблюдательной организации может потребоваться перемещение пользователя из одного OU в другой в Active Directory.

Используйте функцию [Switch()](../app-provisioning/functions-for-customizing-application-data.md#switch) для настройки бизнес-логики для назначения OU и сопоставления ее с атрибутом Active Directory **parentDistinguishedName.**

Например, если вы хотите создать пользователей в OU на основе **hr атрибута муниципалитета,** вы можете использовать следующее выражение:

`
Switch([Municipality], "OU=Default,OU=Users,DC=contoso,DC=com", "Dallas", "OU=Dallas,OU=Users,DC=contoso,DC=com", "Austin", "OU=Austin,OU=Users,DC=contoso,DC=com", "Seattle", "OU=Seattle,OU=Users,DC=contoso,DC=com", "London", "OU=London,OU=Users,DC=contoso,DC=com")
`

С этим выражением, если значение муниципалитета Даллас, Остин, Сиэтл или Лондон, учетная запись пользователя будет создана в соответствующем OU. Если нет совпадений, то учетная запись создается в OU по умолчанию.

## <a name="plan-for-password-delivery-of-new-user-accounts"></a>Планирование доставки паролей новых учетных записей пользователей

Когда вы инициируете процесс Joiners, необходимо установить и предоставить временный пароль новых учетных записей пользователей. С помощью облачного HR-подготовки к пользователю Azure AD можно внедрить возможность [сброса паролей самообслуживания](../authentication/quickstart-sspr.md) Azure AD (SSPR) для пользователя в первый день.

SSPR — это простое средство для ИТ-администраторов, позволяющее пользователям сбросить свои пароли или разблокировать свои учетные записи. Атрибут **мобильного номера** можно предоставить из облачного HR-приложения в Active Directory и синхронизировать с Azure AD. После того, как атрибут **мобильного номера** находится в Azure AD, можно включить SSPR для учетной записи пользователя. Затем в первый день новый пользователь может использовать зарегистрированный и проверенный номер мобильного телефона для проверки подлинности.

## <a name="plan-for-initial-cycle"></a>План начального цикла

Когда служба обеспечения AD Azure AD работает впервые, она выполняет [начальный цикл](../app-provisioning/how-provisioning-works.md#initial-cycle) против облачного HR-приложения для создания снимка всех пользовательских объектов в облачном HR-приложении. Время, заоражаемые для начальных циклов, напрямую зависит от количества пользователей, присутствующих в исходной системе. Первоначальный цикл для некоторых арендаторов облачных HR-приложений с более чем 100 000 пользователей может занять много времени.

**Для крупных арендаторов облачных HR-приложений (>30 000 пользователей)** запуск начального цикла на прогрессивных этапах. Запуск дополнительных обновлений только после проверки того, что правильные атрибуты установлены в Active Directory для различных сценариев подготовки пользователей. Следуйте заказу здесь.

1. Запустите начальный цикл только для ограниченного набора пользователей, установив [фильтр для скопирования.](#plan-scoping-filters-and-attribute-mapping)
2. Проверка подготовки учетной записи Active Directory и значений атрибутов, установленных для пользователей, выбранных для первого запуска. Если результат соответствует вашим ожиданиям, расширьте фильтр для проверки, чтобы постепенно включать больше пользователей и проверить результаты для второго запуска.

После того как вы удовлетворены результатами первоначального цикла для тестовых пользователей, запустите [дополнительные обновления.](../app-provisioning/how-provisioning-works.md#incremental-cycles)

## <a name="plan-testing-and-security"></a>Планирование тестирования и безопасности

На каждом этапе развертывания от первоначального пилотного проекта до включения в систему подготовки пользователей убедитесь, что вы тестируете результаты, как и ожидалось, и аудита циклов подготовки.

### <a name="plan-testing"></a>Планирование тестирования

После настройки облачного HR-приложения для подготовки пользователей Azure AD запустите тестовые случаи, чтобы проверить, соответствует ли это решение требованиям организации.

|Сценарии|Ожидаемые результаты|
|:-|:-|
|Новый сотрудник нанимается в облачном HR-приложении.| - Учетная запись пользователя представлена в Active Directory.</br>- Пользователь может войти в приложения Active Directory-domain и выполнять желаемые действия.</br>- Если синхронизация Azure AD Connect настроена, учетная запись пользователя также создается в Azure AD.
|Пользователь завершаетработу в облачном HR-приложении.|- Учетная запись пользователя отключена в Active Directory.</br>- Пользователь не может войти в приложения предприятия, защищенные Active Directory.
|Организация по надзору за пользователями обновляется в облачном HR-приложении.|На основе отображения атрибутов учетная запись пользователя перемещается из одного OU в другой в Active Directory.|
|HR обновляет менеджер пользователя в облачном HR-приложении.|Поле менеджера в Active Directory обновляется с учетом имени нового менеджера.|
|HR вновь нанимает сотрудника на новую роль.|Поведение зависит от того, как настроено облачное HR-приложение для генерации идонов сотрудников:</br>- Если старый идентификатор сотрудника используется повторно для повторного использования, разъем позволяет пользователю использовать существующую учетную запись Active Directory.</br>- Если рехирий получает новый идентификатор сотрудника, разъем создает новую учетную запись Active Directory для пользователя.|
|HR преобразует сотрудника в контрактного работника или наоборот.|Для новой персоны создается новая учетная запись Active Directory, и старая учетная запись отключена в дату вступления в силу.|

Используйте предыдущие результаты, чтобы определить, как перейти к автоматической реализации пользовательского обеспечения в производство на основе установленных сроков.

> [!TIP]
> Используйте такие методы, как сокращение данных и очистка данных при обновлении тестовой среды производственными данными для удаления или маскировки конфиденциальных персональных данных в соответствии со стандартами конфиденциальности и безопасности. 

### <a name="plan-security"></a>Планирование безопасности

Обычно при развертывании новой службы требуется проверка безопасности. Если требуется или не проводилась проверка безопасности, см. [white papers](https://www.microsoft.com/download/details.aspx?id=36391)

### <a name="plan-rollback"></a>Откат плана

Реализация облачного hr-пользователя может не работать по желанию в рабочей среде. Если это так, следующие шаги отката могут помочь вам вернуться к предыдущему известному хорошему состоянию.

1. Просмотрите [сводный отчет](../app-provisioning/check-status-user-account-provisioning.md#getting-provisioning-reports-from-the-azure-portal) и [журналы подготовки,](../app-provisioning/check-status-user-account-provisioning.md#provisioning-logs-preview) чтобы определить, какие неправильные операции были выполнены на пострадавших пользователей или групп. Для получения дополнительной информации о подготовке сводном отчета и журналов, [см.](#manage-your-configuration)
2. Последнее известное хорошее состояние пользователей или групп, затронутых, может быть определено с помощью журналов аудита подготовки или путем анализа целевых систем (Azure AD или Active Directory).
3. Работайте с владельцем приложения, чтобы обновить пользователей или группы, затронутые непосредственно в приложении, используя последние известные значения хорошего состояния.

## <a name="deploy-the-cloud-hr-app"></a>Развертывание облачного HR-приложения

Выберите облачное HR-приложение, которое соответствует требованиям к решениям.

**Рабочий день**: Импортировать профили работников из рабочего дня в Active Directory и Azure AD [см.](../saas-apps/workday-inbound-tutorial.md#planning-your-deployment) Дополнительно вы можете записать адрес электронной почты и имя пользователя в Workday.

## <a name="manage-your-configuration"></a>Управление конфигурацией

Azure AD может предоставить дополнительные сведения об использовании пользователей вашей организации и оперативном состоянии с помощью журналов аудита и отчетов.

### <a name="gain-insights-from-reports-and-logs"></a>Получение информации из отчетов и журналов

После успешного [начального цикла](../app-provisioning/how-provisioning-works.md#initial-cycle)служба предоставления Azure AD продолжает работать в нерабочее время, с интервалами, определенными в учебниках, характерных для каждого приложения, до тех пор, пока не произойдет одно из следующих событий:

- Служба останавливается вручную. Новый начальный цикл запускается с помощью [портала Azure](https://portal.azure.com/) или соответствующей команды [Microsoft GraphAPI.](https://developer.microsoft.com/graph/docs/api-reference/beta/resources/synchronization-overview)
- Новый начальный цикл срабатывает из-за изменения отображения атрибутов или фильтров для скопирования.
- Процесс подготовки переходит в карантин из-за высокой частоты ошибок. Он остается в карантине более четырех недель, после чего автоматически отключается.

Для анализа этих событий и всех других мероприятий, выполняемых службой обеспечения, [узнайте, как просматривать журналы и получать отчеты о подготовке деятельности.](../app-provisioning/check-status-user-account-provisioning.md)

#### <a name="azure-monitor-logs"></a>Журналы Azure Monitor

Все действия, выполняемые службой обеспечения, записываются в журналы аудита Azure AD. Для дальнейшего анализа можно направить журналы аудита Azure AD в журналы Azure Monitor. С помощью журналов Azure Monitor (также известных как рабочее пространство Log Analytics) можно заставить данные засыхнуть для поиска событий, анализа тенденций и выполнения корреляции между различными источниками данных. Посмотрите это [видео,](https://youtu.be/MP5IaCTwkQg) чтобы узнать о преимуществах использования журналов Azure Monitor для журналов Azure AD в практических сценариях пользователей.

Установите [представления аналитики журналов для журналов деятельности Azure AD,](../reports-monitoring/howto-install-use-log-analytics-views.md) чтобы получить доступ к [заранее построенным отчетам](https://github.com/AzureAD/Deployment-Plans/tree/master/Log%20Analytics%20Views) о событиях подготовки в вашей среде.

Для получения дополнительной информации узнайте, как [анализировать журналы активности Azure AD с помощью журналов Azure Monitor.](../reports-monitoring/howto-analyze-activity-logs-log-analytics.md)

### <a name="manage-personal-data"></a>Управление персональными данными

Средство подготовки Azure AD Connect, установленное на сервере Windows, создает журналы в журнале событий Windows, которые могут содержать личные данные в зависимости от облачного приложения HR для отображения атрибутов Active Directory. Чтобы выполнить обязательства по конфиденциальности пользователей, установите запланированную для Windows задачу по очистке журнала событий и обеспечению того, чтобы данные не хранились более 48 часов.

Служба предоставления AD Azure не генерирует отчеты, не выполняет аналитические данные и не предоставляет аналитических данных в течение 30 дней, поскольку служба не хранит, не обрабатывает и не хранит никаких данных в течение 30 дней.

### <a name="troubleshoot"></a>Устранение неполадок

Для устранения любых проблем, которые могут возникнуть во время подготовки, см.

- [Проблема при настройке подготовки пользователей для приложения из коллекции Azure AD](application-provisioning-config-problem.md)
- [Синхронизация атрибута из вашего предприимчивого Active Directory в Azure AD для подготовки к приложению](user-provisioning-sync-attributes-for-mapping.md)
- [Подготовка пользователей для приложения в коллекции Azure AD выполняется час и более](application-provisioning-when-will-provisioning-finish.md)
- [Проблема сохранения учетных данных администратора при настройке подготовки пользователей для приложения из коллекции Azure Active Directory](application-provisioning-config-problem-storage-limit.md)
- [Пользователи для приложения в коллекции Azure AD не подготавливаются](application-provisioning-config-problem-no-users-provisioned.md)
- [Подготовка неправильного набора пользователей для приложения в коллекции Azure AD](application-provisioning-config-problem-wrong-users-provisioned.md)
- [Настройка средства просмотра событий Windows для устранения неполадок агента](../saas-apps/workday-inbound-tutorial.md#setting-up-windows-event-viewer-for-agent-troubleshooting)
- [Настройка журналов аудита на портале Azure для устранения неполадок службы](../saas-apps/workday-inbound-tutorial.md#setting-up-azure-portal-audit-logs-for-service-troubleshooting)
- [Общие сведения о журналах операций создания учетных записей пользователей AD](../saas-apps/workday-inbound-tutorial.md#understanding-logs-for-ad-user-account-create-operations)
- [Понимание журналов для операций обновления менеджера](../saas-apps/workday-inbound-tutorial.md#understanding-logs-for-manager-update-operations)
- [Устранение распространенных ошибок](../saas-apps/workday-inbound-tutorial.md#resolving-commonly-encountered-errors)

### <a name="next-steps"></a>Дальнейшие действия

- [Написание выражений для отображения атрибутов](functions-for-customizing-application-data.md)
- [Общие сведения об API синхронизации Azure AD](https://developer.microsoft.com/graph/docs/api-reference/beta/resources/synchronization-overview)
- [Пропустить удаление учетных записей пользователей, которые выходят за рамки](skip-out-of-scope-deletions.md)
- [Агент по подключению Azure AD Connect: история выпуска версии](provisioning-agent-release-version-history.md)
