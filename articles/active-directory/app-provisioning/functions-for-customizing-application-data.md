---
title: Написание выражений для сопоставлений атрибутов в Azure Active Directory
description: Узнайте, как использовать сопоставление выражений для преобразования значений атрибутов в допустимый формат при автоматической подготовке объектов приложения SaaS в Azure Active Directory.
services: active-directory
author: kenwith
manager: celestedg
ms.service: active-directory
ms.subservice: app-provisioning
ms.workload: identity
ms.topic: how-to
ms.date: 02/05/2020
ms.author: kenwith
ms.openlocfilehash: 47f0502226e4227c6b94920da6f040004beb41f1
ms.sourcegitcommit: 877491bd46921c11dd478bd25fc718ceee2dcc08
ms.contentlocale: ru-RU
ms.lasthandoff: 07/02/2020
ms.locfileid: "84781673"
---
# <a name="how-to-write-expressions-for-attribute-mappings-in-azure-ad"></a>Пошаговое руководство. Написание выражений для сопоставлений атрибутов в Azure AD

При настройке подготовки для приложения SaaS одним из типов сопоставления атрибутов, которые можно указать, является сопоставление выражений. Для этого необходимо написать выражение, похожее на скрипт. Оно позволит вам преобразовать данные пользователей в форматы, более подходящие для приложений SaaS.

## <a name="syntax-overview"></a>Общие сведения о синтаксисе

Синтаксис выражений для сопоставления атрибутов напоминает функции Visual Basic для приложений (VBA).

* Все выражение должно определяться функциями, состоящими из имени и следующих за ним в скобках аргументов:  <br>
  *FunctionName ( `<<argument 1>>` , `<<argument N>>` )*
* Функции можно вкладывать одну в другую. Пример: <br> *Функтиононе (Функтионтво ( `<<argument1>>` ))*
* В функцию можно передавать следующие три типа аргументов.
  
  1. Атрибуты, которые должны быть заключены в квадратные скобки. Например: [имя_атрибута].
  2. Строковые константы, которые должны быть заключены в двойные кавычки. Например: "США".
  3. Другие функции. Например: Функтиононе ( `<<argument1>>` , функтионтво ( `<<argument2>>` ))
* Если в строковых константах необходимо использовать обратную косую черту (\) или кавычки (""), такие символы следует экранировать обратной косой чертой (\). Например: "название компании: \\ " Contoso \\ ""

## <a name="list-of-functions"></a>Список функций

[Append](#append) &nbsp; &nbsp; Добавить &nbsp; &nbsp; [BitAnd](#bitand) &nbsp; &nbsp; BitAnd &nbsp; &nbsp; [CBool](#cbool) &nbsp; &nbsp; CBool &nbsp; &nbsp; [Coalesce](#coalesce) &nbsp; &nbsp; Объединение &nbsp; &nbsp; [ConvertToBase64](#converttobase64) &nbsp; &nbsp; ConvertToBase64 &nbsp; &nbsp; [ConvertToUTF8Hex](#converttoutf8hex) &nbsp; &nbsp; ConvertToUTF8Hex &nbsp; &nbsp; [Count](#count) &nbsp; &nbsp; Количество &nbsp; &nbsp; [CStr](#cstr) &nbsp; &nbsp; CStr &nbsp; &nbsp; [Датефромнум](#datefromnum) &nbsp; [FormatDateTime](#formatdatetime) &nbsp; &nbsp; FormatDateTime &nbsp; &nbsp; [Идентификатор](#guid) &nbsp; &nbsp; GUID &nbsp; &nbsp; [IIF](#iif) &nbsp; &nbsp; IIf &nbsp; &nbsp; [InStr](#instr) &nbsp; &nbsp; InStr &nbsp; &nbsp; [IsNull](#isnull) &nbsp; &nbsp; IsNull &nbsp; &nbsp; [IsNullOrEmpty](#isnullorempty) &nbsp; &nbsp; IsNullOrEmpty &nbsp; &nbsp; [IsPresent](#ispresent) &nbsp; &nbsp; Present &nbsp; &nbsp; [IsString](#isstring) &nbsp; &nbsp; Substring &nbsp; &nbsp; [Item](#item) &nbsp; &nbsp; Элемент &nbsp; &nbsp; [Join](#join) &nbsp; &nbsp; Соединение &nbsp; &nbsp; По [левому краю](#left) &nbsp; &nbsp; &nbsp; &nbsp; [MID](#mid) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [нормализедиакритикс](#normalizediacritics) [Not](#not) &nbsp; &nbsp; &nbsp; &nbsp; [RemoveDuplicates](#removeduplicates) &nbsp; &nbsp; &nbsp; &nbsp; [заменить](#replace) &nbsp; &nbsp; &nbsp; &nbsp; [селектуникуевалуе](#selectuniquevalue) &nbsp; &nbsp; &nbsp; &nbsp; [синглеаппролеассигнмент](#singleapproleassignment) &nbsp; &nbsp; &nbsp; &nbsp; [разделить](#split) &nbsp; &nbsp; &nbsp; &nbsp; [стрипспацес](#stripspaces) &nbsp; &nbsp; &nbsp; &nbsp; [switch](#switch) &nbsp; &nbsp; &nbsp; &nbsp; [ToLower](#tolower) &nbsp; &nbsp; &nbsp; &nbsp; [ToUpper](#toupper) &nbsp; &nbsp; &nbsp; &nbsp; [Word](#word)

---
### <a name="append"></a>Добавить

**Функций**<br>  Append(source, suffix)

**Описание:**<br>  Получает исходное строковое значение и присоединяет к его концу суффикс.

**Вход**<br> 

| name | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **source** |Обязательное значение |Строка |Как правило, имя атрибута из исходного объекта. |
| **суффикс** |Обязательное значение |Строка |Строка, которую необходимо присоединить к концу исходного значения. |

---
### <a name="bitand"></a>BitAnd
**Функций**<br> BitAnd (значение1, значение2)

**Описание:**<br>  Эта функция преобразует оба параметра в двоичное представление и устанавливает для бита следующие значения:

0 — если один или оба соответствующих бита в value1 и value2 равны 0;                                                  
1 — если оба соответствующих бита равны 1.                                    

Другими словами, функция возвращает значение 0 всегда, за исключением случаев, когда соответствующие биты обоих параметров равны 1.

**Вход**<br> 

| name | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **value1** |Обязательное значение |num |Числовое значение, которое должно быть двух с value2|
| **value2** |Обязательное значение |num |Числовое значение, которое должно быть двух с значение1|

**Пример.**<br>
BitAnd(&HF, &HF7)                                                                                
11110111 и 00000111 = 00000111, BitAnd возвращает 7, двоичное значение 00000111

---
### <a name="cbool"></a>CBool
**Функций**<br> CBool (выражение)

**Описание:**<br> CBool возвращает логическое значение на основе вычисленного выражения. Если результатом вычисления выражения является ненулевое значение, CBool возвращает значение true, в противном случае возвращается значение false.

**Вход**<br> 

| name | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **expression** |Обязательное значение | expression | Любое допустимое выражение |

**Пример.**<br>
CBool ([Атрибут1] = [атрибут2])                                                                    
Возвращает значение True, если оба атрибута имеют одинаковое значение.

---
### <a name="coalesce"></a>Coalesce
**Функций**<br> Объединение (Source1, source2,..., defaultValue)

**Описание:**<br> Возвращает первое исходное значение, не равное NULL. Если все аргументы имеют значение NULL и имеется defaultValue, будет возвращено значение defaultValue. Если все аргументы равны NULL и значение defaultValue отсутствует, функция объединения возвращает значение NULL.

**Вход**<br> 

| name | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **source1  … sourceN** | Обязательное значение | Строка |Обязательно, переменное число раз. Как правило, имя атрибута из исходного объекта. |
| **defaultValue** | Необязательный | Строка | Значение по умолчанию, используемое, если все исходные значения имеют значение NULL. Может быть пустой строкой ("").

---
### <a name="converttobase64"></a>ConvertToBase64
**Функций**<br> ConvertToBase64 (источник)

**Описание:**<br> Функция ConvertToBase64 преобразует строку в строку Юникода в кодировке base64.

**Вход**<br> 

| name | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **source** |Обязательное значение |Строка |Строка, которая должна быть преобразована в Base 64|

**Пример.**<br>
ConvertToBase64("Hello world!")                                                                                                        
 Возвращает SABlAGwAbABvACAAdwBvAHIAbABkACEA.

---
### <a name="converttoutf8hex"></a>ConvertToUTF8Hex
**Функций**<br> ConvertToUTF8Hex (источник)

**Описание:**<br> Функция ConvertToUTF8Hex преобразует строку в значение в шестнадцатеричной кодировке UTF8.

**Вход**<br> 

| name | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **source** |Обязательное значение |Строка |Строка для преобразования в шестнадцатеричное значение UTF8|

**Пример.**<br>
ConvertToUTF8Hex("Hello world!")                                                                                                         
 Возвращает 48656C6C6F20776F726C6421.

---
### <a name="count"></a>Count
**Функций**<br> Count (атрибут)

**Описание:**<br>  Функция Count возвращает количество элементов в атрибуте с несколькими значениями.

**Вход**<br> 

| name | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **версию** |Обязательное значение |Атрибут |Многозначный атрибут, для которого будут учитываться элементы|

---
### <a name="cstr"></a>CStr
**Функций**<br> CStr (Value)

**Описание:**<br> Функция CStr преобразует значение в строковый тип данных.

**Вход**<br> 

| name | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **value** |Обязательное значение | Числовой, ссылочный или логический | может быть числовым значением, ссылочным атрибутом или логическим значением. |

**Пример.**<br>
CStr([dn])                                                            
Возвращает "CN = Joe, DC = contoso, DC = com"

---
### <a name="datefromnum"></a>DateFromNum
**Функций**<br> Датефромнум (значение)

**Описание:**<br>  Функция DateFromNum преобразует значение даты в формате AD в тип DateTime.

**Вход**<br> 

| name | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **value** |Обязательное значение | Дата | Дата объявления для преобразования в тип DateTime |

**Пример.**<br>
DateFromNum([lastLogonTimestamp])                                                                                                   
DateFromNum(129699324000000000)                                                            
 Возвращает значение DateTime, равное 2012-01-01 23:00:00.

---
### <a name="formatdatetime"></a>FormatDateTime
**Функций**<br>  FormatDateTime(source, inputFormat, outputFormat)

**Описание:**<br> Преобразовывает строку даты из одного формата в другой.

**Вход**<br> 

| name | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **source** |Обязательное значение |Строка |Как правило, имя атрибута из исходного объекта. |
| **inputFormat** |Обязательное значение |Строка |Предполагаемый формат исходного значения. Поддерживаемые форматы см. в разделе [https://msdn.microsoft.com/library/8kb3ddd4%28v=vs.110%29.aspx](https://msdn.microsoft.com/library/8kb3ddd4%28v=vs.110%29.aspx) . |
| **outputFormat** |Обязательное значение |Строка |Формат вывода даты. |

---
### <a name="guid"></a>Guid
**Функций**<br> Guid()

**Описание:**<br> Функция Guid создает случайный идентификатор GUID.

---
### <a name="iif"></a>IIF
**Функций**<br> IIF (Condition, true, значение для false)

**Описание:**<br> Функция IIF возвращает одно из набора возможных значений на основе заданного условия.

**Вход**<br> 

| name | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **выполняет** |Обязательное значение |Переменная или выражение |Любое значение или выражение, результатом которого может быть значение True или False. |
| **valueIfTrue** |Обязательное значение |Переменная или строка | возвращаемое значение, если условие принимает значение true. |
| **valueIfFalse** |Обязательное значение |Переменная или строка |возвращаемое значение, если условие принимает значение false.|

**Пример.**<br>
IIF ([страна] = "USA", [страна], [Отдел])

---
### <a name="instr"></a>InStr
**Функций**<br> InStr (значение1, значение2, начало, Компаретипе)

**Описание:**<br>  Функция InStr находит первое вхождение подстроки в строке.

**Вход**<br> 

| name | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **value1** |Обязательное значение |Строка |Строка для поиска |
| **value2** |Обязательное значение |Строка |Строка для поиска |
| **start** |Необязательный |Целое число |Начальная Расположение для поиска подстроки|
| **компаретипе** |Необязательно |Перечисление |Может быть Вбтексткомпаре или Вббинарикомпаре |

**Пример.**<br>
InStr("The quick brown fox","quick")                                                                             
 Принимает значение 5.

InStr("repEated","e",3,vbBinaryCompare)                                                                                  
 Принимает значение 7.

---
### <a name="isnull"></a>IsNull
**Функций**<br> IsNull (выражение)

**Описание:**<br>  Функция IsNull возвращает значение True, если выражение принимает значение NULL.  Значение NULL для атрибута выражается в отсутствии атрибута.

**Вход**<br> 

| name | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **expression** |Обязательное значение |expression |Вычисляемое выражение |

**Пример.**<br>
IsNull([displayName])                                                                                                
Возвращает значение true, если атрибут отсутствует

---
### <a name="isnullorempty"></a>IsNullorEmpty
**Функций**<br> IsNullOrEmpty (выражение)

**Описание:**<br>  Функция IsNullOrEmpty возвращает значение True, если выражение имеет значение NULL или является пустой строкой. Для атрибута это будет значение True, если атрибут отсутствует или же присутствует, но является пустой строкой.
Обратной функцией этой функции является IsPresent.

**Вход**<br> 

| name | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **expression** |Обязательное значение |expression |Вычисляемое выражение |

**Пример.**<br>
IsNullOrEmpty ([displayName])                                               
Возвращает значение true, если атрибут отсутствует или является пустой строкой

---
### <a name="ispresent"></a>IsPresent
**Функций**<br> Present (выражение)

**Описание:**<br> Функция IsPresent возвращает значение True, если результат выражения — строка, которая не имеет значение NULL и не является пустой.  Обратной функцией этой функции является IsNullOrEmpty.

**Вход**<br> 

| name | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **expression** |Обязательное значение |expression |Вычисляемое выражение |

**Пример.**<br>
Switch(IsPresent([directManager]),[directManager], IsPresent([skiplevelManager]),[skiplevelManager], IsPresent([director]),[director])

---
### <a name="isstring"></a>IsString
**Функций**<br> Substring (выражение)

**Описание:**<br>  Функция IsString возвращает значение True, если выражение может принимать значение строкового типа.

**Вход**<br> 

| name | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **expression** |Обязательное значение |expression |Вычисляемое выражение |

---
### <a name="item"></a>Item
**Функций**<br> Элемент (атрибут, индекс)

**Описание:**<br>  Функция Item возвращает один элемент из строки или атрибута с несколькими значениями.

**Вход**<br> 

| name | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **версию** |Обязательное значение |Атрибут |Атрибут с несколькими значениями для поиска |
| **номер** |Обязательный |Целое число | Индексирование элемента в строке с несколькими значениями|

**Пример.**<br>
Item ([proxyAddresses], 1)

---
### <a name="join"></a>Join
**Функций**<br>  Join(separator, source1, source2, …)

**Описание:**<br> Функция Join() действует аналогично функции Append(), но может объединять несколько **исходных** строковых значений в одну строку, а между значениями будет строка **разделителя**.

Если одно из исходных значений является атрибутом с несколькими значениями, все значения в этом атрибуте будут объединены, а между ними будет значение разделителя.

**Вход**<br> 

| name | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **separator**язательно, количество |Обязательное значение |Строка |Строка, используемая для разделения исходных значений, когда они объединяются в одну строку. Если разделитель не требуется, может не иметь значения (""). |
| **source1  … sourceN** |Обязательно, количество повторов может меняться. |Строка |Строковые значения для объединения. |

---
### <a name="left"></a>Левый
**Функций**<br> Left (строка, NumChars)

**Описание:**<br>  Функция Left возвращает указанное количество символов из левой части строки. если numChars = 0, возвращается пустая строка;
если numChars < 0, возвращается введенная строка;
если строка имеет значение Null, возвращается пустая строка.
Если строка содержит меньше символов, чем указано в numChars, возвращается строка без изменений (т. е. содержащая все символы в параметре 1).

**Вход**<br> 

| name | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **String** |Обязательное значение |Атрибут | Строка, из которой возвращаются символы |
| **NumChars** |Обязательный |Целое число | Число, определяющее количество символов, возвращаемых с начала (слева) строки|

**Пример.**<br>
Left ("Джон Петров", 3)                                                            
Возвращает "Жох"

---
### <a name="mid"></a>Mid
**Функций**<br>  Mid(source, start, length)

**Описание:**<br>  Возвращает подстроку исходного значения. Подстрокой является строка, содержащая только некоторые символы из исходной строки.

**Вход**<br> 

| name | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **source** |Обязательное значение |Строка |Как правило, имя атрибута. |
| **start** |Обязательное значение |Целое число |Индекс положения начала подстроки в **исходной** строке. Первый символ в строке будет иметь индекс 1, второй символ — индекс 2 и т. д. |
| **length** |Обязательное значение |Целое число |Длина подстроки. Длина подстроки. Если она превышает размер строки **source**, функция возвращает подстроку от индекса **start** до конца строки **source**. |

---
### <a name="normalizediacritics"></a>NormalizeDiacritics
**Функций**<br> NormalizeDiacritics(source)

**Описание:**<br> Требуется один строковый аргумент. Возвращает строку, в которой все символы с диакритическими знаками заменены эквивалентами без диакритических знаков. Обычно используется для преобразования имен и фамилий с диакритическими знаками в допустимые значения, которые могут использоваться в различных идентификаторах пользователя, таких как имена участников-пользователей, имена учетных записей SAM и адреса электронной почты.

**Вход**<br> 

| name | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **source** |Обязательное значение |Строка | Обычно атрибут имени или фамилии. |

---
### <a name="not"></a>Not
**Функций**<br> Not(source)

**Описание:**<br> Изменяет логическое значение **исходной строки** на обратное. Если значение **исходной строки** — "*True*", возвращает "*False*". В противном случае возвращает "*True*".

**Вход**<br> 

| name | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **source** |Обязательное значение |Логическая строка |Предполагаемые **исходные** значения — "True" или "False". |

---
### <a name="numfromdate"></a>NumFromDate
**Функций**<br> Нумфромдате (значение)

**Описание:**<br> Функция Нумфромдате преобразует значение DateTime в формат Active Directory, необходимый для задания таких атрибутов, как [accountExpires](https://docs.microsoft.com/windows/win32/adschema/a-accountexpires). Эта функция используется для преобразования значений DateTime, полученных из облачных приложений отдела кадров, таких как Workday и SuccessFactors, в эквивалентное представление AD. 

**Вход**<br> 

| name | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **value** |Обязательное значение | Строка | Строка даты и времени в поддерживаемом формате. Поддерживаемые форматы см. по адресу https://msdn.microsoft.com/library/8kb3ddd4%28v=vs.110%29.aspx. |

**Пример.**<br>
* Пример рабочего дня <br>
  Предположим, что вы хотите сопоставить атрибут *контрактенддате* из Workday, который находится в поле Format *2020-12-31-08:00* to *accountExpires* в AD, вот как можно использовать эту функцию и изменить смещение часового пояса в соответствии с языковым стандартом. 
  `NumFromDate(Join("", FormatDateTime([ContractEndDate], "yyyy-MM-ddzzz", "yyyy-MM-dd"), "T23:59:59-08:00"))`

* Пример SuccessFactors <br>
  Предполагая, что вы хотите сопоставить атрибут *EndDate* из SuccessFactors, который находится в поле Format *M/d/гггг чч: мм: СС TT* – *accountExpires* в AD, вот как можно использовать эту функцию и изменить смещение часового пояса в соответствии с региональными стандартами.
  `NumFromDate(Join("",FormatDateTime([endDate],"M/d/yyyy hh:mm:ss tt","yyyy-MM-dd"),"T23:59:59-08:00"))`


---
### <a name="removeduplicates"></a>RemoveDuplicates
**Функций**<br> RemoveDuplicates (атрибут)

**Описание:**<br>  Функция RemoveDuplicates принимает строку с несколькими значениями и проверяет, чтобы каждое значение было уникальным.

**Вход**<br> 

| name | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **версию** |Обязательное значение |Атрибут с несколькими значениями |Многозначный атрибут, в котором будут удалены дубликаты|

**Пример.**<br>
RemoveDuplicates([proxyAddresses])                                                                                                       
Возвращает исключенный атрибут proxyAddress, в котором были удалены все дублирующиеся значения

---
### <a name="replace"></a>Замените
**Функций**<br> Replace(source, oldValue, regexPattern, regexGroupName, replacementValue, replacementAttributeName, template)

**Описание:**<br>
 Заменяет значения в пределах строки. Ее работа зависит от указанных параметров.

* Если указаны параметры **старое_значение** и **заменяющее_значение**:
  
  * заменяет все вхождения параметра **oldValue** в **source** параметром **replacementValue**.
* Если указаны параметры **старое_значение** и **шаблон**:
  
  * Заменяет все вхождения **старого значения** в **шаблоне** на **исходное** значение
* Если указаны параметры **regexPattern** и **replacementValue**:

  * функция применяет параметр **regexPattern** к строке **source** и вы можете использовать имена групп регулярных выражений для создания строки для параметра **replacementValue**.
* Если указаны параметры **regexPattern**, **regexGroupName**, **replacementValue**:
  
  * функция применяет параметр **regexPattern** к строке **source** и заменяет все значения, соответствующие параметру **regexGroupName**, на **replacementValue**.
* Если указаны параметры **regexPattern**, **regexGroupName**, **replacementAttributeName**:
  
  * Если для **source** не указано значение, возвращается **source**.
  * Если для **source** указано значение, функция применяет параметр **regexPattern** к строке **source** и заменяет все значения, соответствующие параметру **regexGroupName**, значением, связанным с **replacementAttributeName**.

**Вход**<br> 

| name | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **source** |Обязательное значение |Строка |Обычно это имя атрибута из **исходного** объекта. |
| **oldValue** |Необязательный |Строка |Значение для замены в **source** или **template**. |
| **regexPattern** |Необязательный |Строка |Шаблон регулярного выражения для значения, которое должно быть заменено в **источнике**. Или, при использовании **replacementPropertyName**, шаблон для извлечения значения из **replacementPropertyName**. |
| **regexGroupName** |Необязательный |Строка |Имя группы в **regexPattern**. Значение этой группы будет извлечено из **replacementPropertyName** как **replacementValue**, только если используется **replacementPropertyName**. |
| **replacementValue** |Необязательный |Строка |Новое значение для замены старого. |
| **replacementAttributeName** |Необязательный |Строка |Имя атрибута, используемого для значения замены. |
| **шаблон** |Необязательный |Строка |Если указано значение **template**, будет выполнен поиск **oldValue** в шаблоне с последующей заменой значением **source**. |

---
### <a name="selectuniquevalue"></a>SelectUniqueValue
**Функций**<br> SelectUniqueValue(uniqueValueRule1, uniqueValueRule2, uniqueValueRule3, …)

**Описание:**<br> Требуется как минимум два аргумента, которые являются правилами формирования уникальных значений, определенными с помощью выражений. Функция вычисляет каждое правило, а затем проверяет сформированное значение на уникальность в целевом приложении/каталоге. Будет возвращено первое найденное уникальное значение. Если все значения уже существуют в целевом объекте, запись будет дополнительно обработана, а причина записана в журналы аудита. Предельной границы числа аргументов, которые можно указать, не существует.


 - Это функция верхнего уровня, которую нельзя вложить.
 - Функцию нельзя применить к атрибутам, имеющим приоритет сопоставления.   
 - Эта функция предназначена только для создания записей. При использовании ее с атрибутом задайте для свойства **Apply Mapping** (Применить сопоставление) значение **Только в ходе создания объектов**.
 - В настоящее время эта функция поддерживается только для приложения Workday to Active Directory User Provisioning. Ее нельзя использовать с другими приложениями подготовки. 


**Вход**<br> 

| name | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **uniqueValueRule1... uniqueValueRuleN** |Требуется не менее 2, нет верхней границы |Строка | Список правил формирования уникальных значений для оценки. |


---
### <a name="singleapproleassignment"></a>SingleAppRoleAssignment
**Функций**<br> SingleAppRoleAssignment([appRoleAssignments])

**Описание:**<br> Возвращает один объект appRoleAssignment из списка всех объектов appRoleAssignment, назначенных пользователю для заданного приложения. Эта функция необходима для преобразования объекта appRoleAssignment в отдельную строку имени роли. Обратите внимание на то, что рекомендуется назначать только один объект appRoleAssignment одному пользователю одновременно. При назначении нескольких ролей невозможно предсказать возвращаемую строку роли. 

**Вход**<br> 

| name | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **[appRoleAssignments]** |Обязательное значение |Строка |Объект **[appRoleAssignments]**. |

---
### <a name="split"></a>Split
**Функций**<br> Split(source, delimiter)

**Описание:**<br> Разделяет строку на многозначный массив с помощью определенного символа разделителя.

**Вход**<br> 

| name | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **source** |Обязательное значение |Строка |**источник** — обновляемое значение. |
| **разделитель** |Обязательное значение |Строка |Задает символ, который будет использоваться для разделения строки (к примеру, ",") |

---
### <a name="stripspaces"></a>StripSpaces
**Функций**<br>  StripSpaces(source)

**Описание:**<br>  Удаляет все пробелы (« ») из исходной строки.

**Вход**<br> 

| name | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **source** |Обязательное значение |Строка |**источник** — обновляемое значение. |

---
### <a name="switch"></a>Параметр
**Функций**<br>  Switch(source, defaultValue, key1, value1, key2, value2, …)

**Описание:**<br> Когда значение **источника** совпадает с **ключом**, возвращает**значение** для этого **ключа**. Если значение**источника** не совпадает ни с одним ключом, возвращает **значение по умолчанию**.  Параметры **key** и **value** должны всегда быть парными. Для функции необходимо всегда использовать четное количество параметров. Функция не должна использоваться для ссылочных атрибутов, таких как диспетчер. 

**Вход**<br> 

| name | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **source** |Обязательное значение |Строка |Значение **source**, которое необходимо обновить |
| **defaultValue** |Необязательный |Строка |Значение по умолчанию, которое необходимо использовать, если значение source не соответствует ни одному ключу. Может быть пустой строкой (""). |
| **key** |Обязательное значение |Строка |Параметр **key**, с которым сравнивается значение **source** |
| **value** |Обязательное значение |Строка |Значение, которым заменяется значение **source** , соответствующее ключу. |

---
### <a name="tolower"></a>ToLower
**Функций**<br> ToLower(source, culture)

**Описание:**<br> Принимает строковое значение *source* и преобразует его в нижний регистр, используя указанные правила языка и региональных параметров. Если не указаны сведения о *языке и региональных параметрах*, будут использоваться инвариантные язык и региональные параметры.

**Вход**<br> 

| name | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **source** |Обязательное значение |Строка |Как правило, имя атрибута из исходного объекта. |
| **culture** |Необязательный |Строка |Форматом названия языка и региональных параметров в соответствии с RFC 4646 является *languagecode2-country/regioncode2*, где *languagecode2* — это двухбуквенный код языка, а *country/regioncode2* — двухбуквенный код субкультуры. Примеры включают в себя ja-JP для японского языка (Япония) и en-US для английского (США). В случаях, когда двухбуквенный код языка недоступен, используется трехбуквенный код на основе ISO 639-2.|

---
### <a name="toupper"></a>ToUpper
**Функций**<br> ToUpper(source, culture)

**Описание:**<br> Принимает строковое значение *source* и преобразует его в верхний регистр, используя указанные правила языка и региональных параметров. Если не указаны сведения о *языке и региональных параметрах*, будут использоваться инвариантные язык и региональные параметры.

**Вход**<br> 

| name | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **source** |Обязательное значение |Строка |Как правило, имя атрибута из исходного объекта. |
| **culture** |Необязательный |Строка |Форматом названия языка и региональных параметров в соответствии с RFC 4646 является *languagecode2-country/regioncode2*, где *languagecode2* — это двухбуквенный код языка, а *country/regioncode2* — двухбуквенный код субкультуры. Примеры включают в себя ja-JP для японского языка (Япония) и en-US для английского (США). В случаях, когда двухбуквенный код языка недоступен, используется трехбуквенный код на основе ISO 639-2.|

---
### <a name="word"></a>Слово
**Функций**<br> Word (String, Ворднумбер, разделители)

**Описание:**<br>  Функция Word возвращает слово, содержащееся внутри строки, в зависимости от параметров, описывающих разделители и количество слов для возврата.  Каждая строка символов в строке, разделенной одним из символов-разделителей, определяется как слово:

если number < 1, возвращается пустая строка;
если string имеет значение Null, возвращается пустая строка.
Если строка содержит меньше слов, чем number, или строка не содержит слов, идентифицируемых с помощью разделителей, возвращается пустая строка.

**Вход**<br> 

| name | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **String** |Обязательное значение |Атрибут с несколькими значениями |Строка, из которой возвращается слово.|
| **ворднумбер** |Обязательный | Целое число | Номер, указывающий, какой номер слова должен возвращаться|
| **разделители** |Обязательное значение |Строка| Строка, представляющая разделители, которые должны использоваться для поиска слов|

**Пример.**<br>
Word ("Экспресс-коричневый Fox", 3, "")                                                                                       
 Возвращает значение "brown".

Word ("это, String! имеет&много разделителей", 3, ",! & #")                                                                       
Возвращает "имеет"

---

## <a name="examples"></a>Примеры
### <a name="strip-known-domain-name"></a>Извлечение известного доменного имени
Необходимо извлечь известное доменное имя из адреса электронной почты пользователя, чтобы получить имя пользователя. <br>
 Например, если домен — contoso.com, можно использовать следующее выражение:

**Выражение** <br>
`Replace([mail], "@contoso.com", , ,"", ,)`

**Пример ввода и вывода:** <br>

* **Входные данные** (mail): "john.doe@contoso.com"
* **Выходные данные**: john.doe

### <a name="append-constant-suffix-to-user-name"></a>Добавление суффикса константы к имени пользователя
При использовании Salesforce Sandbox может потребоваться добавить дополнительный суффикс ко всем именам пользователей перед их синхронизацией.

**Выражение** <br>
`Append([userPrincipalName], ".test")`

**Пример ввода и вывода:** <br>

* **Входные данные**: (userPrincipalName): "John.Doe@contoso.com"
* **Выходные данные**: " John.Doe@contoso.com.test "

### <a name="generate-user-alias-by-concatenating-parts-of-first-and-last-name"></a>Создание псевдонима пользователя путем сцепления частей имени и фамилии
Необходимо создать псевдоним пользователя, используя первые три буквы имени и первые пять букв фамилии пользователя.

**Выражение** <br>
`Append(Mid([givenName], 1, 3), Mid([surname], 1, 5))`

**Пример ввода и вывода:** <br>

* **ВВОД** : (givenName): "John"
* **ВВОД** : (surname): "Doe"
* **Выходные данные**: "JohDoe"

### <a name="remove-diacritics-from-a-string"></a>Удаление диакритических знаков из строки
Вам нужно заменить символы с диакритическими знаками эквивалентами без диакритических знаков.

**Выражение** <br>
NormalizeDiacritics([givenName])

**Пример ввода и вывода:** <br>

* **ВВОД** (givenName): "Zoë"
* **Выходные данные**: "Zoe".

### <a name="split-a-string-into-a-multi-valued-array"></a>Разделение строки на многозначный массив
Выберите список строк с разделителями-запятыми и разделите их на массив, который можно подключить к такому многозначному атрибуту, как, например, атрибут PermissionSets компании Salesforce. В этом примере список наборов разрешений заполнен в extensionAttribute5 в Azure AD.

**Выражение** <br>
Split([extensionAttribute5], ",")

**Пример ввода и вывода:** <br>

* **Входные данные** (extensionAttribute5): "Пермиссионсетоне, пермисионсеттво"
* **Выходные данные**:  ["PermissionSetOne", "PermissionSetTwo"]

### <a name="output-date-as-a-string-in-a-certain-format"></a>Вывод даты в виде строки в определенном формате
Необходимо отправить в приложение SaaS даты в определенном формате. <br>
 Например, требуется отформатировать даты для ServiceNow.

**Выражение** <br>

`FormatDateTime([extensionAttribute1], "yyyyMMddHHmmss.fZ", "yyyy-MM-dd")`

**Пример ввода и вывода:**

* **ВВОД** : (extensionAttribute1): "20150123105347.1Z"
* **Выходные данные**: "2015-01-23"

### <a name="replace-a-value-based-on-predefined-set-of-options"></a>Замена значения на основе предопределенного набора параметров

Необходимо определить часовой пояс пользователя на основе кода государства, сохраненного в Azure AD. <br>
 Если код государства не совпадает с предопределенными параметрами, используйте значение по умолчанию «Australia/Sydney».

**Выражение** <br>
`Switch([state], "Australia/Sydney", "NSW", "Australia/Sydney","QLD", "Australia/Brisbane", "SA", "Australia/Adelaide")`

**Пример ввода и вывода:**

* **ВВОД** : (state): "QLD"
* **ВЫВОД**: "Australia/Brisbane"

### <a name="replace-characters-using-a-regular-expression"></a>Замените символы с помощью регулярного выражения
Необходимо определить символы, соответствующие значению регулярного выражения, и удалить их.

**Выражение** <br>

Replace([mailNickname], , "[a-zA-Z_]*", , "", , )

**Пример ввода и вывода:**

* **Входные данные** (mailNickname: "john_doe72"
* **Выходные данные**: "72"

### <a name="convert-generated-userprincipalname-upn-value-to-lower-case"></a>Преобразование созданного значения userPrincipalName (UPN) в нижний регистр
В приведенном ниже примере значение UPN создается путем объединения полей источника данных PreferredFirstName и PreferredLastName, а функция ToLower использует строку для преобразования всех знаков в нижний регистр. 

`ToLower(Join("@", NormalizeDiacritics(StripSpaces(Join(".",  [PreferredFirstName], [PreferredLastName]))), "contoso.com"))`

**Пример ввода и вывода:**

* **Входные данные** (предпочитаемое имя): "John".
* **Входные данные** (предпочитаемая фамилия): "Smith".
* **Выходные данные**: " john.smith@contoso.com "

### <a name="generate-unique-value-for-userprincipalname-upn-attribute"></a>Создание уникального значения для атрибута userPrincipalName (имя участника-пользователя)
На основе имени, отчества и фамилии пользователя необходимо создать значение для атрибута имени участника-пользователя и проверить его на уникальность в целевом каталоге AD перед присвоением этого значения атрибуту имени участника-пользователя.

**Выражение** <br>

    SelectUniqueValue( 
        Join("@", NormalizeDiacritics(StripSpaces(Join(".",  [PreferredFirstName], [PreferredLastName]))), "contoso.com"), 
        Join("@", NormalizeDiacritics(StripSpaces(Join(".",  Mid([PreferredFirstName], 1, 1), [PreferredLastName]))), "contoso.com"),
        Join("@", NormalizeDiacritics(StripSpaces(Join(".",  Mid([PreferredFirstName], 1, 2), [PreferredLastName]))), "contoso.com")
    )

**Пример ввода и вывода:**

* **Входные данные** (предпочитаемое имя): "John".
* **Входные данные** (предпочитаемая фамилия): "Smith".
* **Выходные данные**: " John.Smith@contoso.com ", если значение UPN John.Smith@contoso.com еще не существует в каталоге
* **Выходные данные**: J.Smith@contoso.com Если значение UPN John.Smith@contoso.com уже существует в каталоге
* **Выходные данные**: Jo.Smith@contoso.com Если в каталоге уже существуют два значения имени участника-пользователя,

### <a name="flow-mail-value-if-not-null-otherwise-flow-userprincipalname"></a>Значение потока сообщений, если не равно NULL, в противном случае поток userPrincipalName
Вы хотите передать атрибут mail, если он существует. Если это не так, вместо этого нужно передать значение userPrincipalName.

**Выражение** <br>
`Coalesce([mail],[userPrincipalName])`

**Пример ввода и вывода:** <br>

* **Входные данные** (почта): NULL
* **Входные данные** (userPrincipalName): " John.Doe@contoso.com "
* **Выходные данные**: " John.Doe@contoso.com "

## <a name="related-articles"></a>Похожие статьи
* [Автоматическая подготовка пользователей и ее отзыв для приложений SaaS](../app-provisioning/user-provisioning.md)
* [Настройка сопоставлений атрибутов для подготовки пользователей](../app-provisioning/customize-application-attributes.md)
* [Фильтры области для подготовки пользователей](define-conditional-rules-for-provisioning-user-accounts.md)
* [Автоматическая подготовка пользователей и групп из Azure Active Directory в приложениях с использованием SCIM](../app-provisioning/use-scim-to-provision-users-and-groups.md)
* [Уведомления о подготовке учетных записей](../app-provisioning/user-provisioning.md)
* [Список учебников по интеграции приложений SaaS](../saas-apps/tutorial-list.md)
