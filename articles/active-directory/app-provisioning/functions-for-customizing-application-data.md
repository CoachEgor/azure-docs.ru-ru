---
title: Написание выражений для сопоставления атрибутов в Azure AD
description: Узнайте, как использовать сопоставление выражений для преобразования значений атрибутов в допустимый формат при автоматической подготовке объектов приложения SaaS в Azure Active Directory.
services: active-directory
documentationcenter: ''
author: msmimart
manager: CelesteDG
ms.service: active-directory
ms.subservice: app-provisioning
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: conceptual
ms.date: 02/05/2020
ms.author: mimart
ms.collection: M365-identity-device-management
ms.openlocfilehash: cc41a18063202bfefb9ddf7238de17fc691984af
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "77612136"
---
# <a name="writing-expressions-for-attribute-mappings-in-azure-active-directory"></a>Запись выражений для сопоставления атрибутов в Azure Active Directory
При настройке подготовки для приложения SaaS одним из типов сопоставления атрибутов, которые можно указать, является сопоставление выражений. Для этого необходимо написать выражение, похожее на скрипт. Оно позволит вам преобразовать данные пользователей в форматы, более подходящие для приложений SaaS.

## <a name="syntax-overview"></a>Общие сведения о синтаксисе
Синтаксис выражений для сопоставления атрибутов напоминает функции Visual Basic для приложений (VBA).

* Все выражение должно определяться функциями, состоящими из имени и следующих за ним в скобках аргументов:  <br>
  *`<<argument 1>>`ФункцияИмя(),`<<argument N>>`*
* Функции можно вкладывать одну в другую. Пример: <br> *FunctionOne (FunctionTwo`<<argument1>>`())*
* В функцию можно передавать следующие три типа аргументов.
  
  1. Атрибуты, которые должны быть заключены в квадратные скобки. Например: [имя_атрибута].
  2. Строковые константы, которые должны быть заключены в двойные кавычки. Например: "США".
  3. Другие функции. Например: FunctionOne(`<<argument1>>`,`<<argument2>>`FunctionTwo ())
* Если в строковых константах необходимо использовать обратную косую черту (\) или кавычки (""), такие символы следует экранировать обратной косой чертой (\). Например: "Название \\компании: "Контосо\\""

## <a name="list-of-functions"></a>Список функций
[Приложение](#append) &nbsp; &nbsp; [Count](#count) [BitAnd](#bitand) &nbsp; &nbsp; [CStr](#cstr) [CBool](#cbool) &nbsp; &nbsp; [Coalesce](#coalesce) &nbsp; &nbsp; &nbsp; [ConvertToBase64](#converttobase64) &nbsp; [ConvertToUTF8Hex](#converttoutf8hex) &nbsp; BitAnd &nbsp; &nbsp; CBool &nbsp; &nbsp; Coalesce &nbsp; ConvertToBase64 &nbsp; ConvertToUTF8Hex Граф &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [IIF](#iif) &nbsp; [DateFromNum](#datefromnum) &nbsp; &nbsp; [IsNull](#isnull) [FormatDateTime](#formatdatetime) &nbsp; &nbsp; [Guid](#guid) &nbsp; &nbsp; [InStr](#instr) &nbsp; [IsNullOrEmpty](#isnullorempty) DateFromNum &nbsp; &nbsp; FormatDateTime &nbsp; &nbsp; Guid &nbsp; &nbsp; IIF &nbsp;InStr &nbsp; IsNull &nbsp; IsNullOrEmpty &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [IsPresent](#ispresent) &nbsp; &nbsp; &nbsp; [IsString](#isstring) &nbsp; [Item](#item) &nbsp; [Left](#left) [Not](#not) [Join](#join) &nbsp; [Mid](#mid) [NormalizeDiacritics](#normalizediacritics) IsString &nbsp; &nbsp; Пункт &nbsp; &nbsp; Присоединиться к &nbsp; левой &nbsp; середине &nbsp; нормализацииДиакритики не &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [Replace](#replace) &nbsp; &nbsp; [RemoveDuplicates](#removeduplicates) &nbsp; &nbsp; [SelectUniqueValue](#selectuniquevalue) &nbsp; [Split](#split) [SingleAppRoleAssignment](#singleapproleassignment) &nbsp; RemoveDuplicates &nbsp; &nbsp; &nbsp; Заменить &nbsp; &nbsp; SelectUniqueValue&nbsp; SingleAppRoleНазначение&nbsp; Сплит &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [ Stripspaces](#stripspaces) &nbsp; &nbsp; &nbsp; [Word](#word) [Switch](#switch) &nbsp; [ToUpper](#toupper) [ToLower](#tolower) &nbsp; переключить&nbsp; &nbsp; tolower&nbsp; toupper&nbsp; &nbsp; слово&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;

---
### <a name="append"></a>Append
**Функции:**<br>  Append(source, suffix)

**Описание:**<br>  Получает исходное строковое значение и присоединяет к его концу суффикс.

**Параметры:**<br> 

| name | Обязательно/повторяется | Тип | Примечания |
| --- | --- | --- | --- |
| **Источник** |Обязательно |Строка |Как правило, имя атрибута из исходного объекта. |
| **suffix** |Обязательно |Строка |Строка, которую необходимо присоединить к концу исходного значения. |

---
### <a name="bitand"></a>BitAnd
**Функции:**<br> BitAnd (значение1, значение2)

**Описание:**<br>  Эта функция преобразует оба параметра в двоичное представление и устанавливает для бита следующие значения:

0 — если один или оба соответствующих бита в value1 и value2 равны 0;                                                  
1 — если оба соответствующих бита равны 1.                                    

Другими словами, функция возвращает значение 0 всегда, за исключением случаев, когда соответствующие биты обоих параметров равны 1.

**Параметры:**<br> 

| name | Обязательно/повторяется | Тип | Примечания |
| --- | --- | --- | --- |
| **значение1** |Обязательно |num |Числовое значение, которое должно быть AND'ed с value2|
| **значение2** |Обязательно |num |Числовое значение, которое должно быть AND'ed с value1|

**Примере:**<br>
BitAnd(&HF, &HF7)                                                                                
11110111 И 00000111 1 00000111 так BitAnd возвращает 7, бинарное значение 00000111

---
### <a name="cbool"></a>CBool
**Функции:**<br> CBool (Выражение)

**Описание:**<br> CBool возвращает булеан на основе оцененного выражения. Если выражение оценивается к ненулевому значению, то CBool возвращает True, иначе оно возвращает False.

**Параметры:**<br> 

| name | Обязательно/повторяется | Тип | Примечания |
| --- | --- | --- | --- |
| **выражение** |Обязательно | expression | Любое допустимое выражение |

**Примере:**<br>
CBool («атрибут1» и «атрибут2»)                                                                    
Возвращает значение True, если оба атрибута имеют одинаковое значение.

---
### <a name="coalesce"></a>Coalesce
**Функции:**<br> Coalesce (источник1, source2, ..., defaultValue)

**Описание:**<br> Возвращает значение первого источника, которое не является NULL. Если все аргументы являются NULL и defaultValue присутствует, значение по умолчанию будет возвращено. Если все аргументы являются NULL и defaultValue не присутствует, Coalesce возвращает NULL.

**Параметры:**<br> 

| name | Обязательно/повторяется | Тип | Примечания |
| --- | --- | --- | --- |
| **source1  … sourceN** | Обязательно | Строка |Требуемое, переменное количество раз. Как правило, имя атрибута из исходного объекта. |
| **defaultValue** | Необязательный | Строка | Значение по умолчанию, используемое при всех значениях источника NULL. Может быть пустой строкой ("").

---
### <a name="converttobase64"></a>ConvertToBase64
**Функции:**<br> ConvertToBase64 (источник)

**Описание:**<br> Функция ConvertToBase64 преобразует строку в строку Юникода в кодировке base64.

**Параметры:**<br> 

| name | Обязательно/повторяется | Тип | Примечания |
| --- | --- | --- | --- |
| **Источник** |Обязательно |Строка |Строка, которая будет преобразована в базу 64|

**Примере:**<br>
ConvertToBase64("Hello world!")                                                                                                        
 Возвращает SABlAGwAbABvACAAdwBvAHIAbABkACEA.

---
### <a name="converttoutf8hex"></a>ConvertToUTF8Hex
**Функции:**<br> ConvertToUTF8Hex (источник)

**Описание:**<br> Функция ConvertToUTF8Hex преобразует строку в значение в шестнадцатеричной кодировке UTF8.

**Параметры:**<br> 

| name | Обязательно/повторяется | Тип | Примечания |
| --- | --- | --- | --- |
| **Источник** |Обязательно |Строка |Строка, которая будет преобразована в UTF8 Hex|

**Примере:**<br>
ConvertToUTF8Hex("Hello world!")                                                                                                         
 Возвращает 48656C6C6F20776F726C6421.

---
### <a name="count"></a>Count
**Функции:**<br> Граф (атрибут)

**Описание:**<br>  Функция Count возвращает количество элементов в атрибуте с несколькими значениями.

**Параметры:**<br> 

| name | Обязательно/повторяется | Тип | Примечания |
| --- | --- | --- | --- |
| **Атрибут** |Обязательно |атрибут |Многоценный атрибут, который будет иметь элементы, подсчитанные|

---
### <a name="cstr"></a>CStr
**Функции:**<br> CStr (значение)

**Описание:**<br> Функция CStr преобразует значение в тип данных строки.

**Параметры:**<br> 

| name | Обязательно/повторяется | Тип | Примечания |
| --- | --- | --- | --- |
| **value** |Обязательно | числовые, справочные или булеан | может быть числовым значением, ссылочным атрибутом или логическим значением. |

**Примере:**<br>
CStr([dn])                                                            
Возвращает "cn'Joe,dc'contoso,dc'com"

---
### <a name="datefromnum"></a>DateFromNum
**Функции:**<br> DateFromNum (значение)

**Описание:**<br>  Функция DateFromNum преобразует значение даты в формате AD в тип DateTime.

**Параметры:**<br> 

| name | Обязательно/повторяется | Тип | Примечания |
| --- | --- | --- | --- |
| **value** |Обязательно | Дата | Дата aD, которая будет преобразована в тип DateTime |

**Примере:**<br>
DateFromNum([lastLogonTimestamp])                                                                                                   
DateFromNum(129699324000000000)                                                            
 Возвращает значение DateTime, равное 2012-01-01 23:00:00.

---
### <a name="formatdatetime"></a>FormatDateTime
**Функции:**<br>  FormatDateTime(source, inputFormat, outputFormat)

**Описание:**<br> Преобразовывает строку даты из одного формата в другой.

**Параметры:**<br> 

| name | Обязательно/повторяется | Тип | Примечания |
| --- | --- | --- | --- |
| **Источник** |Обязательно |Строка |Как правило, имя атрибута из исходного объекта. |
| **inputFormat** |Обязательно |Строка |Предполагаемый формат исходного значения. Для поддерживаемых форматов см. [https://msdn.microsoft.com/library/8kb3ddd4%28v=vs.110%29.aspx](https://msdn.microsoft.com/library/8kb3ddd4%28v=vs.110%29.aspx) |
| **outputFormat** |Обязательно |Строка |Формат вывода даты. |

---
### <a name="guid"></a>Guid
**Функции:**<br> Guid()

**Описание:**<br> Функция Guid создает случайный идентификатор GUID.

---
### <a name="iif"></a>IIF
**Функции:**<br> IIF (условие,valueIfTrue,valueIfFalse)

**Описание:**<br> Функция IIF возвращает одно из набора возможных значений на основе заданного условия.

**Параметры:**<br> 

| name | Обязательно/повторяется | Тип | Примечания |
| --- | --- | --- | --- |
| **Состояние** |Обязательно |Переменный или выражение |Любое значение или выражение, результатом которого может быть значение True или False. |
| **valueIfTrue** |Обязательно |Переменный или струнный | возвращаемое значение, если условие принимает значение true. |
| **valueIfFalse** |Обязательно |Переменный или струнный |возвращаемое значение, если условие принимает значение false.|

**Примере:**<br>
IIF («страна» США», «страна», «департамент»)

---
### <a name="instr"></a>InStr
**Функции:**<br> InStr (стоимость1,value2,start,compareType)

**Описание:**<br>  Функция InStr находит первое вхождение подстроки в строке.

**Параметры:**<br> 

| name | Обязательно/повторяется | Тип | Примечания |
| --- | --- | --- | --- |
| **значение1** |Обязательно |Строка |Строка для поиска |
| **значение2** |Обязательно |Строка |Строка, которая будет найдена |
| **start** |Необязательный |Целое число |Исходное положение для поиска подстроки|
| **сравнитеТип** |Необязательный |Перечисление. |Может быть vbTextCompare или vbBinaryCompare |

**Примере:**<br>
InStr("The quick brown fox","quick")                                                                             
 Принимает значение 5.

InStr("repEated","e",3,vbBinaryCompare)                                                                                  
 Принимает значение 7.

---
### <a name="isnull"></a>IsNull
**Функции:**<br> IsNull (Выражение)

**Описание:**<br>  Функция IsNull возвращает значение True, если выражение принимает значение NULL.  Значение NULL для атрибута выражается в отсутствии атрибута.

**Параметры:**<br> 

| name | Обязательно/повторяется | Тип | Примечания |
| --- | --- | --- | --- |
| **выражение** |Обязательно |expression |Выражение для оценки |

**Примере:**<br>
IsNull([displayName])                                                                                                
Возвращает Правда, если атрибут не присутствует

---
### <a name="isnullorempty"></a>IsNullorОпт
**Функции:**<br> Isnullorempty (Выражение)

**Описание:**<br>  Функция IsNullOrEmpty возвращает значение True, если выражение имеет значение NULL или является пустой строкой. Для атрибута это будет значение True, если атрибут отсутствует или же присутствует, но является пустой строкой.
Обратной функцией этой функции является IsPresent.

**Параметры:**<br> 

| name | Обязательно/повторяется | Тип | Примечания |
| --- | --- | --- | --- |
| **выражение** |Обязательно |expression |Выражение для оценки |

**Примере:**<br>
IsNullorempty ("Имя дисплея")                                               
Возвращает Правда, если атрибут не присутствует или является пустой строкой

---
### <a name="ispresent"></a>IsPresent
**Функции:**<br> Присутствует (Выражение)

**Описание:**<br> Функция IsPresent возвращает значение True, если результат выражения — строка, которая не имеет значение NULL и не является пустой.  Обратной функцией этой функции является IsNullOrEmpty.

**Параметры:**<br> 

| name | Обязательно/повторяется | Тип | Примечания |
| --- | --- | --- | --- |
| **выражение** |Обязательно |expression |Выражение для оценки |

**Примере:**<br>
Switch(IsPresent([directManager]),[directManager], IsPresent([skiplevelManager]),[skiplevelManager], IsPresent([director]),[director])

---
### <a name="isstring"></a>IsString
**Функции:**<br> IsString (Выражение)

**Описание:**<br>  Функция IsString возвращает значение True, если выражение может принимать значение строкового типа.

**Параметры:**<br> 

| name | Обязательно/повторяется | Тип | Примечания |
| --- | --- | --- | --- |
| **выражение** |Обязательно |expression |Выражение для оценки |

---
### <a name="item"></a>Item
**Функции:**<br> Элемент (атрибут, индекс)

**Описание:**<br>  Функция Item возвращает один элемент из строки или атрибута с несколькими значениями.

**Параметры:**<br> 

| name | Обязательно/повторяется | Тип | Примечания |
| --- | --- | --- | --- |
| **Атрибут** |Обязательно |Атрибут |Многоценный атрибут для поиска |
| **index** |Обязательно |Целое число | Индекс к элементу в мультиценированной строке|

**Примере:**<br>
Пункт (((ПроксиУмоны, 1)

---
### <a name="join"></a>Join
**Функции:**<br>  Join(separator, source1, source2, …)

**Описание:**<br> Функция Join() действует аналогично функции Append(), но может объединять несколько **исходных** строковых значений в одну строку, а между значениями будет строка **разделителя**.

Если одно из исходных значений является атрибутом с несколькими значениями, все значения в этом атрибуте будут объединены, а между ними будет значение разделителя.

**Параметры:**<br> 

| name | Обязательно/повторяется | Тип | Примечания |
| --- | --- | --- | --- |
| **Разделитель** |Обязательно |Строка |Строка, используемая для разделения исходных значений, когда они объединяются в одну строку. Если разделитель не требуется, может не иметь значения (""). |
| **source1  … sourceN** |Обязательно, количество повторов может меняться. |Строка |Строковые значения для объединения. |

---
### <a name="left"></a>Слева
**Функции:**<br> Слева (Струны, NumChars)

**Описание:**<br>  Функция Left возвращает указанное количество символов из левой части строки. если numChars = 0, возвращается пустая строка;
если numChars < 0, возвращается введенная строка;
если строка имеет значение Null, возвращается пустая строка.
Если строка содержит меньше символов, чем указано в numChars, возвращается строка без изменений (т. е. содержащая все символы в параметре 1).

**Параметры:**<br> 

| name | Обязательно/повторяется | Тип | Примечания |
| --- | --- | --- | --- |
| **Строка** |Обязательно |Атрибут | Строка для возврата символов из |
| **NumChars** |Обязательно |Целое число | Номер, определяющий количество символов, которые нужно вернуть с начала (слева) строки|

**Примере:**<br>
Слева ("Джон Доу", 3)                                                            
Возвращает "Joh"

---
### <a name="mid"></a>Mid
**Функции:**<br>  Mid(source, start, length)

**Описание:**<br>  Возвращает подстроку исходного значения. Подстрокой является строка, содержащая только некоторые символы из исходной строки.

**Параметры:**<br> 

| name | Обязательно/повторяется | Тип | Примечания |
| --- | --- | --- | --- |
| **Источник** |Обязательно |Строка |Как правило, имя атрибута. |
| **start** |Обязательно |Целое число |Индекс положения начала подстроки в **исходной** строке. Первый символ в строке будет иметь индекс 1, второй символ — индекс 2 и т. д. |
| **длина** |Обязательно |Целое число |Длина подстроки. Длина подстроки. Если она превышает размер строки **source**, функция возвращает подстроку от индекса **start** до конца строки **source**. |

---
### <a name="normalizediacritics"></a>NormalizeDiacritics
**Функции:**<br> NormalizeDiacritics(source)

**Описание:**<br> Требуется один строковый аргумент. Возвращает строку, в которой все символы с диакритическими знаками заменены эквивалентами без диакритических знаков. Обычно используется для преобразования имен и фамилий с диакритическими знаками в допустимые значения, которые могут использоваться в различных идентификаторах пользователя, таких как имена участников-пользователей, имена учетных записей SAM и адреса электронной почты.

**Параметры:**<br> 

| name | Обязательно/повторяется | Тип | Примечания |
| --- | --- | --- | --- |
| **Источник** |Обязательно |Строка | Обычно атрибут имени или фамилии. |

---
### <a name="not"></a>Not
**Функции:**<br> Not(source)

**Описание:**<br> Изменяет логическое значение **исходной строки** на обратное. Если значение **исходной строки** — "*True*", возвращает "*False*". В противном случае возвращает "*True*".

**Параметры:**<br> 

| name | Обязательно/повторяется | Тип | Примечания |
| --- | --- | --- | --- |
| **Источник** |Обязательно |Логическая строка |Предполагаемые **исходные** значения — "True" или "False". |

---
### <a name="numfromdate"></a>NumFromDate
**Функции:**<br> NumFromDate (значение)

**Описание:**<br> Функция NumFromDate преобразует значение DateTime в формат Active Directory, который требуется для установки атрибутов, таких как [accountExpires.](https://docs.microsoft.com/windows/win32/adschema/a-accountexpires) Используйте эту функцию для преобразования значений DateTime, полученных из облачных HR-приложений, таких как Workday и SuccessFactors, в эквивалентное представление AD. 

**Параметры:**<br> 

| name | Обязательно/повторяется | Тип | Примечания |
| --- | --- | --- | --- |
| **value** |Обязательно | Строка | Строка времени даты в поддерживаемом формате. Поддерживаемые форматы см. по адресу https://msdn.microsoft.com/library/8kb3ddd4%28v=vs.110%29.aspx. |

**Примере:**<br>
* Пример рабочего дня <br>
  Предполагая, что вы хотите, чтобы карта атрибут *contractEndDate* от рабочего дня, который находится в формате *2020-12-31-08:00* *на поле accountExpires* в AD, вот как вы можете использовать эту функцию и изменить часовой пояс смещения в соответствии с вашим языком. 
  `NumFromDate(Join("", FormatDateTime([ContractEndDate], "yyyy-MM-ddzzz", "yyyy-MM-dd"), "T23:59:59-08:00"))`

* Пример SuccessFactors <br>
  Предполагая, что вы хотите, чтобы карта *атрибута endDate* от SuccessFactors, который находится в формате *M/d/yyyy hh:mm:ss tt* для *accountExpires* поле в AD, вот как вы можете использовать эту функцию и изменить часовой пояс смещения в соответствии с вашим языком.
  `NumFromDate(Join("",FormatDateTime([endDate],"M/d/yyyy hh:mm:ss tt","yyyy-MM-dd"),"T23:59:59-08:00"))`


---
### <a name="removeduplicates"></a>RemoveDuplicates
**Функции:**<br> УдалитьДублы (атрибут)

**Описание:**<br>  Функция RemoveDuplicates принимает строку с несколькими значениями и проверяет, чтобы каждое значение было уникальным.

**Параметры:**<br> 

| name | Обязательно/повторяется | Тип | Примечания |
| --- | --- | --- | --- |
| **Атрибут** |Обязательно |Многоценный атрибут |Мультиценный атрибут, который будет иметь дубликаты удалены|

**Примере:**<br>
RemoveDuplicates([proxyAddresses])                                                                                                       
Возвращает дезинфицированный атрибут proxyAddress, где все дублирующие значения были удалены

---
### <a name="replace"></a>Replace
**Функции:**<br> Replace(source, oldValue, regexPattern, regexGroupName, replacementValue, replacementAttributeName, template)

**Описание:**<br>
 Заменяет значения в пределах строки. Ее работа зависит от указанных параметров.

* Если указаны параметры **старое_значение** и **заменяющее_значение**:
  
  * заменяет все вхождения параметра **oldValue** в **source** параметром **replacementValue**.
* Если указаны параметры **старое_значение** и **шаблон**:
  
  * Заменяет все вхождения **старого значения** в **шаблоне** на **исходное** значение
* Если указаны параметры **regexPattern** и **replacementValue**:

  * функция применяет параметр **regexPattern** к строке **source** и вы можете использовать имена групп регулярных выражений для создания строки для параметра **replacementValue**.
* Если указаны параметры **regexPattern**, **regexGroupName**, **replacementValue**:
  
  * функция применяет параметр **regexPattern** к строке **source** и заменяет все значения, соответствующие параметру **regexGroupName**, на **replacementValue**.
* Если указаны параметры **regexPattern**, **regexGroupName**, **replacementAttributeName**:
  
  * Если для **source** не указано значение, возвращается **source**.
  * Если для **source** указано значение, функция применяет параметр **regexPattern** к строке **source** и заменяет все значения, соответствующие параметру **regexGroupName**, значением, связанным с **replacementAttributeName**.

**Параметры:**<br> 

| name | Обязательно/повторяется | Тип | Примечания |
| --- | --- | --- | --- |
| **Источник** |Обязательно |Строка |Обычно имя атрибута от **исходного** объекта. |
| **oldValue** |Необязательный |Строка |Значение для замены в **source** или **template**. |
| **regexPattern** |Необязательный |Строка |Шаблон регулярного выражения для значения, которое должно быть заменено в **источнике**. Или, при использовании **replacementPropertyName**, шаблон для извлечения значения из **replacementPropertyName**. |
| **regexGroupName** |Необязательный |Строка |Имя группы в **regexPattern**. Значение этой группы будет извлечено из **replacementPropertyName** как **replacementValue**, только если используется **replacementPropertyName**. |
| **replacementValue** |Необязательный |Строка |Новое значение для замены старого. |
| **replacementAttributeName** |Необязательный |Строка |Имя атрибута, используемого для значения замены. |
| **template** |Необязательный |Строка |Если указано значение **template**, будет выполнен поиск **oldValue** в шаблоне с последующей заменой значением **source**. |

---
### <a name="selectuniquevalue"></a>SelectUniqueValue
**Функции:**<br> SelectUniqueValue(uniqueValueRule1, uniqueValueRule2, uniqueValueRule3, …)

**Описание:**<br> Требуется как минимум два аргумента, которые являются правилами формирования уникальных значений, определенными с помощью выражений. Функция вычисляет каждое правило, а затем проверяет сформированное значение на уникальность в целевом приложении/каталоге. Будет возвращено первое найденное уникальное значение. Если все значения уже существуют в целевом объекте, запись будет дополнительно обработана, а причина записана в журналы аудита. Предельной границы числа аргументов, которые можно указать, не существует.

> [!NOTE]
> - Это функция верхнего уровня, которую нельзя вложить.
> - Функцию нельзя применить к атрибутам, имеющим приоритет сопоставления.  
> - Эта функция предназначена только для создания записей. При использовании ее с атрибутом задайте для свойства **Apply Mapping** (Применить сопоставление) значение **Только в ходе создания объектов**.
> - В настоящее время эта функция поддерживается только для приложения Workday to Active Directory User Provisioning. Ее нельзя использовать с другими приложениями подготовки. 


**Параметры:**<br> 

| name | Обязательно/повторяется | Тип | Примечания |
| --- | --- | --- | --- |
| **uniqueValueRule1... uniqueValueRuleN** |Требуется не менее 2, нет верхней границы |Строка | Список правил формирования уникальных значений для оценки. |


---
### <a name="singleapproleassignment"></a>SingleAppRoleAssignment
**Функции:**<br> SingleAppRoleAssignment([appRoleAssignments])

**Описание:**<br> Возвращает один объект appRoleAssignment из списка всех объектов appRoleAssignment, назначенных пользователю для заданного приложения. Эта функция необходима для преобразования объекта appRoleAssignment в отдельную строку имени роли. Обратите внимание на то, что рекомендуется назначать только один объект appRoleAssignment одному пользователю одновременно. При назначении нескольких ролей невозможно предсказать возвращаемую строку роли. 

**Параметры:**<br> 

| name | Обязательно/повторяется | Тип | Примечания |
| --- | --- | --- | --- |
| **[appRoleAssignments]** |Обязательно |Строка |Объект **[appRoleAssignments]**. |

---
### <a name="split"></a>Split
**Функции:**<br> Split(source, delimiter)

**Описание:**<br> Разделяет строку на многозначный массив с помощью определенного символа разделителя.

**Параметры:**<br> 

| name | Обязательно/повторяется | Тип | Примечания |
| --- | --- | --- | --- |
| **Источник** |Обязательно |Строка |**источник** — обновляемое значение. |
| **Разделитель** |Обязательно |Строка |Задает символ, который будет использоваться для разделения строки (к примеру, ",") |

---
### <a name="stripspaces"></a>StripSpaces
**Функции:**<br>  StripSpaces(source)

**Описание:**<br>  Удаляет все пробелы (« ») из исходной строки.

**Параметры:**<br> 

| name | Обязательно/повторяется | Тип | Примечания |
| --- | --- | --- | --- |
| **Источник** |Обязательно |Строка |**источник** — обновляемое значение. |

---
### <a name="switch"></a>Параметр
**Функции:**<br>  Switch(source, defaultValue, key1, value1, key2, value2, …)

**Описание:**<br> Когда значение **источника** совпадает с **ключом**, возвращает**значение** для этого **ключа**. Если значение**источника** не совпадает ни с одним ключом, возвращает **значение по умолчанию**.  Параметры **key** и **value** должны всегда быть парными. Для функции необходимо всегда использовать четное количество параметров. Функция не должна использоваться для референтных атрибутов, таких как менеджер. 

**Параметры:**<br> 

| name | Обязательно/повторяется | Тип | Примечания |
| --- | --- | --- | --- |
| **Источник** |Обязательно |Строка |Значение **source**, которое необходимо обновить |
| **defaultValue** |Необязательный |Строка |Значение по умолчанию, которое необходимо использовать, если значение source не соответствует ни одному ключу. Может быть пустой строкой (""). |
| **Ключ** |Обязательно |Строка |Параметр **key**, с которым сравнивается значение **source** |
| **value** |Обязательно |Строка |Значение, которым заменяется значение **source** , соответствующее ключу. |

---
### <a name="tolower"></a>ToLower
**Функции:**<br> ToLower(source, culture)

**Описание:**<br> Принимает строковое значение *source* и преобразует его в нижний регистр, используя указанные правила языка и региональных параметров. Если не указаны сведения о *языке и региональных параметрах*, будут использоваться инвариантные язык и региональные параметры.

**Параметры:**<br> 

| name | Обязательно/повторяется | Тип | Примечания |
| --- | --- | --- | --- |
| **Источник** |Обязательно |Строка |Как правило, имя атрибута из исходного объекта. |
| **culture** |Необязательный |Строка |Форматом названия языка и региональных параметров в соответствии с RFC 4646 является *languagecode2-country/regioncode2*, где *languagecode2* — это двухбуквенный код языка, а *country/regioncode2* — двухбуквенный код субкультуры. Примеры включают в себя ja-JP для японского языка (Япония) и en-US для английского (США). В случаях, когда двухбуквенный код языка недоступен, используется трехбуквенный код на основе ISO 639-2.|

---
### <a name="toupper"></a>ToUpper
**Функции:**<br> ToUpper(source, culture)

**Описание:**<br> Принимает строковое значение *source* и преобразует его в верхний регистр, используя указанные правила языка и региональных параметров. Если не указаны сведения о *языке и региональных параметрах*, будут использоваться инвариантные язык и региональные параметры.

**Параметры:**<br> 

| name | Обязательно/повторяется | Тип | Примечания |
| --- | --- | --- | --- |
| **Источник** |Обязательно |Строка |Как правило, имя атрибута из исходного объекта. |
| **culture** |Необязательный |Строка |Форматом названия языка и региональных параметров в соответствии с RFC 4646 является *languagecode2-country/regioncode2*, где *languagecode2* — это двухбуквенный код языка, а *country/regioncode2* — двухбуквенный код субкультуры. Примеры включают в себя ja-JP для японского языка (Япония) и en-US для английского (США). В случаях, когда двухбуквенный код языка недоступен, используется трехбуквенный код на основе ISO 639-2.|

---
### <a name="word"></a>Word
**Функции:**<br> Слово (String,WordNumber,Delimiters)

**Описание:**<br>  Функция Word возвращает слово, содержащееся внутри строки, в зависимости от параметров, описывающих разделители и количество слов для возврата.  Каждая строка символов в строке, разделенной одним из символов-разделителей, определяется как слово:

если number < 1, возвращается пустая строка;
если string имеет значение Null, возвращается пустая строка.
Если строка содержит меньше слов, чем number, или строка не содержит слов, идентифицируемых с помощью разделителей, возвращается пустая строка.

**Параметры:**<br> 

| name | Обязательно/повторяется | Тип | Примечания |
| --- | --- | --- | --- |
| **Строка** |Обязательно |Многоценный атрибут |Строка, чтобы вернуть слово из.|
| **WordNumber** |Обязательно | Целое число | Номер, определяющий, какой номер слова должен вернуться|
| **Разделители** |Обязательно |Строка| Строка, представляющая делимитетер(ы), который должен использоваться для идентификации слов|

**Примере:**<br>
Слово ("Быстрая коричневая лиса",3", ")                                                                                       
 Возвращает значение "brown".

Слово ("Это, строка!&много сепараторов",3,",& ")                                                                       
Возвращает "имеет"

---

## <a name="examples"></a>Примеры
### <a name="strip-known-domain-name"></a>Извлечение известного доменного имени
Необходимо извлечь известное доменное имя из адреса электронной почты пользователя, чтобы получить имя пользователя. <br>
 Например, если домен — contoso.com, можно использовать следующее выражение:

**Выражение:** <br>
`Replace([mail], "@contoso.com", , ,"", ,)`

**Пример ввода и вывода:** <br>

* **Входные данные** (mail): "john.doe@contoso.com"
* **Выходные данные**: john.doe

### <a name="append-constant-suffix-to-user-name"></a>Добавление суффикса константы к имени пользователя
При использовании Salesforce Sandbox может потребоваться добавить дополнительный суффикс ко всем именам пользователей перед их синхронизацией.

**Выражение:** <br>
`Append([userPrincipalName], ".test")`

**Пример ввода и вывода:** <br>

* **Входные данные**: (userPrincipalName): "John.Doe@contoso.com"
* **ВЫХОД**:John.Doe@contoso.com.test"

### <a name="generate-user-alias-by-concatenating-parts-of-first-and-last-name"></a>Создание псевдонима пользователя путем сцепления частей имени и фамилии
Необходимо создать псевдоним пользователя, используя первые три буквы имени и первые пять букв фамилии пользователя.

**Выражение:** <br>
`Append(Mid([givenName], 1, 3), Mid([surname], 1, 5))`

**Пример ввода и вывода:** <br>

* **ВВОД** : (givenName): "John"
* **ВВОД** : (surname): "Doe"
* **OUTPUT**: "JohDoe"

### <a name="remove-diacritics-from-a-string"></a>Удаление диакритических знаков из строки
Вам нужно заменить символы с диакритическими знаками эквивалентами без диакритических знаков.

**Выражение:** <br>
NormalizeDiacritics([givenName])

**Пример ввода и вывода:** <br>

* **ВВОД** (givenName): "Zoë"
* **Выходные данные**: "Zoe".

### <a name="split-a-string-into-a-multi-valued-array"></a>Разделение строки на многозначный массив
Выберите список строк с разделителями-запятыми и разделите их на массив, который можно подключить к такому многозначному атрибуту, как, например, атрибут PermissionSets компании Salesforce. В этом примере список наборов разрешений заполнен в extensionAttribute5 в Azure AD.

**Выражение:** <br>
Split([extensionAttribute5], ",")

**Пример ввода и вывода:** <br>

* **INPUT** (расширениеАтрибут5): "PermissionSetOne, PermisionSetTwo"
* **Выходные данные**:  ["PermissionSetOne", "PermissionSetTwo"]

### <a name="output-date-as-a-string-in-a-certain-format"></a>Вывод даты в виде строки в определенном формате
Необходимо отправить в приложение SaaS даты в определенном формате. <br>
 Например, требуется отформатировать даты для ServiceNow.

**Выражение:** <br>

`FormatDateTime([extensionAttribute1], "yyyyMMddHHmmss.fZ", "yyyy-MM-dd")`

**Пример ввода и вывода:**

* **ВВОД** : (extensionAttribute1): "20150123105347.1Z"
* **ВЫХОД**: "2015-01-23"

### <a name="replace-a-value-based-on-predefined-set-of-options"></a>Замена значения на основе предопределенного набора параметров

Необходимо определить часовой пояс пользователя на основе кода государства, сохраненного в Azure AD. <br>
 Если код государства не совпадает с предопределенными параметрами, используйте значение по умолчанию «Australia/Sydney».

**Выражение:** <br>
`Switch([state], "Australia/Sydney", "NSW", "Australia/Sydney","QLD", "Australia/Brisbane", "SA", "Australia/Adelaide")`

**Пример ввода и вывода:**

* **ВВОД** : (state): "QLD"
* **ВЫВОД**: "Australia/Brisbane"

### <a name="replace-characters-using-a-regular-expression"></a>Замените символы с помощью регулярного выражения
Необходимо определить символы, соответствующие значению регулярного выражения, и удалить их.

**Выражение:** <br>

Replace([mailNickname], , "[a-zA-Z_]*", , "", , )

**Пример ввода и вывода:**

* **Входные данные** (mailNickname: "john_doe72"
* **ВЫХОД**: "72"

### <a name="convert-generated-userprincipalname-upn-value-to-lower-case"></a>Преобразование созданного значения userPrincipalName (UPN) в нижний регистр
В приведенном ниже примере значение UPN создается путем объединения полей источника данных PreferredFirstName и PreferredLastName, а функция ToLower использует строку для преобразования всех знаков в нижний регистр. 

`ToLower(Join("@", NormalizeDiacritics(StripSpaces(Join(".",  [PreferredFirstName], [PreferredLastName]))), "contoso.com"))`

**Пример ввода и вывода:**

* **Входные данные** (предпочитаемое имя): "John".
* **Входные данные** (предпочитаемая фамилия): "Smith".
* **ВЫХОД**:john.smith@contoso.com"

### <a name="generate-unique-value-for-userprincipalname-upn-attribute"></a>Создание уникального значения для атрибута userPrincipalName (имя участника-пользователя)
На основе имени, отчества и фамилии пользователя необходимо создать значение для атрибута имени участника-пользователя и проверить его на уникальность в целевом каталоге AD перед присвоением этого значения атрибуту имени участника-пользователя.

**Выражение:** <br>

    SelectUniqueValue( 
        Join("@", NormalizeDiacritics(StripSpaces(Join(".",  [PreferredFirstName], [PreferredLastName]))), "contoso.com"), 
        Join("@", NormalizeDiacritics(StripSpaces(Join(".",  Mid([PreferredFirstName], 1, 1), [PreferredLastName]))), "contoso.com"),
        Join("@", NormalizeDiacritics(StripSpaces(Join(".",  Mid([PreferredFirstName], 1, 2), [PreferredLastName]))), "contoso.com")
    )

**Пример ввода и вывода:**

* **Входные данные** (предпочитаемое имя): "John".
* **Входные данные** (предпочитаемая фамилия): "Smith".
* **OUTPUT**:John.Smith@contoso.com" если значение John.Smith@contoso.com UPN еще не существует в каталоге
* **OUTPUT**:J.Smith@contoso.com" если значение John.Smith@contoso.com UPN уже существует в каталоге
* **OUTPUT**:Jo.Smith@contoso.com" если вышедвадшиеся значения UPN уже существуют в каталоге

### <a name="flow-mail-value-if-not-null-otherwise-flow-userprincipalname"></a>Значение почты потока, если не NULL, в противном случае поток userPrincipalName
Вы хотите передавать атрибут почты, если он присутствует. Если это не так, вы хотите, чтобы поток значение userPrincipalName вместо.

**Выражение:** <br>
`Coalesce([mail],[userPrincipalName])`

**Пример ввода и вывода:** <br>

* **INPUT** (почта): NULL
* **INPUT** (пользовательPrincipalName):John.Doe@contoso.com"
* **ВЫХОД**:John.Doe@contoso.com"

## <a name="related-articles"></a>Связанные статьи
* [Автоматическая подготовка пользователей и ее отзыв для приложений SaaS](../app-provisioning/user-provisioning.md)
* [Настройка сопоставления атрибутов для подготовки пользователей](../app-provisioning/customize-application-attributes.md)
* [Фильтры области для подготовки пользователей](define-conditional-rules-for-provisioning-user-accounts.md)
* [Автоматическая подготовка пользователей и групп из Azure Active Directory в приложениях с использованием SCIM](../app-provisioning/use-scim-to-provision-users-and-groups.md)
* [Уведомления о предоставлении учетной записи](../app-provisioning/user-provisioning.md)
* [Список учебников по интеграции приложений SaaS](../saas-apps/tutorial-list.md)
