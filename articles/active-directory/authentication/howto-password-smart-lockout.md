---
title: Предотвращение атак с помощью интеллектуальной блокировки Azure Active Directory
description: Смарт-блокировка Azure Active Directory помогает защитить вашу организацию от атак методом подбора
services: active-directory
ms.service: active-directory
ms.subservice: authentication
ms.topic: conceptual
ms.date: 11/21/2019
ms.author: iainfou
author: iainfoulds
manager: daveba
ms.reviewer: rogoya
ms.collection: M365-identity-device-management
ms.openlocfilehash: 30006d0dcccdd1b160289c72769340d141198d3c
ms.sourcegitcommit: c38a1f55bed721aea4355a6d9289897a4ac769d2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/05/2019
ms.locfileid: "74847598"
---
# <a name="azure-active-directory-smart-lockout"></a>Смарт-блокировка Azure Active Directory

Смарт-блокировка помогает блокировать злоумышленников, которые пытаются угадать пароли пользователей или использовать методы подбора пароля для входа. Эта функция позволяет распознавать входные сигналы от действительных пользователей и относиться к ним иначе, нежели к злоумышленникам и другим неизвестным источникам. Механизм смарт-блокировки блокирует доступ для злоумышленников, пытающихся войти в систему. При этом обычные пользователи могут спокойно получать доступ к учетным записям и продолжать работу.

По умолчанию после 10 неудачных попыток смарт-блокировка блокирует учетную запись от попыток входа в систему на одну минуту. Учетная запись повторно блокируется после каждой последующей неудачной попытки входа (сначала доступ отсутствует одну минуту, а при последующих попытках — дольше).

Смарт-блокировка отслеживает хэши последних трех попыток неправильного ввода пароля во избежание повторного увеличения счетчика блокировки для того же пароля. Если кто-то введет тот же неверный пароль несколько раз, это не вызовет блокировку учетной записи.

 > [!NOTE]
 > Функция отслеживания хэшей недоступна для клиентов, использующих сквозную аутентификацию, так как аутентификация выполняется локально, а не в облаке.

Федеративные развертывания, использующие AD FS 2016 и AF FS 2019, могут обеспечить аналогичные преимущества с помощью [AD FS блокировки экстрасети и Smart-блокировки экстрасети](https://docs.microsoft.com/windows-server/identity/ad-fs/operations/configure-ad-fs-extranet-smart-lockout-protection).

Для всех клиентов Azure AD, у которых установлены эти настройки по умолчанию, обеспечивающие оптимальное сочетание безопасности и удобства в использовании, смарт-блокировка всегда включена. Настройка параметров смарт-блокировки со значениями, характерными для вашей организации, требует платных лицензий Azure AD для пользователей.

Использование интеллектуальной блокировки не гарантирует, что подлинное пользователь никогда не будет заблокирован. Если при интеллектуальной блокировке учетная запись пользователя блокируется, мы пытаемся не блокировать подлинного пользователя. Служба блокировки пытается ограничить доступ злоумышленников к учетной записи настоящего пользователя.  

* Каждый центр обработки данных Azure Active Directory отслеживает блокировку независимо друг от друга. У пользователя есть определенное число попыток (threshold_limit * datacenter_count) для каждого центра обработки данных.
* Смарт-блокировка различает злоумышленников и подлинных пользователей по расположению (неизвестное и известное). Для каждого типа расположения будут предусмотрены отдельные счетчики блокировки.

Смарт-блокировку можно интегрировать в гибридные среды, используя синхронизацию хэшей паролей или сквозную проверку подлинности для защиты локальных учетных записей Active Directory от блокировки злоумышленниками. Если правильно установить политики смарт-блокировки в Azure AD, то прежде, чем атаки смогут достичь локальной среды Active Directory, они будут отфильтрованы.

При использовании [сквозной аутентификации](../hybrid/how-to-connect-pta.md) необходимо убедиться, что:

* Пороговое значение блокировки Azure AD должно быть **меньше**, чем пороговое значение блокировки учетных записей Active Directory. Необходимо, чтобы пороговое значение блокировки учетных записей Active Directory как минимум в два-три раза превышало пороговое значение блокировки Azure AD. 
* Длительность блокировки Azure AD должна быть задана дольше, чем счетчик блокировки Active Directory сброса учетной записи после длительности. Имейте в виду, что длительность Azure AD задается в секундах, а длительность рекламы задается в минутах. 

Например, если вы хотите, чтобы значение счетчика Azure AD было выше, чем AD, то Azure AD будет 120 секунд (2 минуты), а локальная служба AD — 1 минута (60 секунд).

> [!IMPORTANT]
> В настоящее время администратор не может разблокировать облачные учетные записи пользователей, если они были заблокированы с помощью функции смарт-блокировки. Администраторы должны подождать, пока не завершится срок действия блокировки. Тем не менее пользователь может разблокировать с помощью самостоятельного сброса пароля (SSPR) из доверенного устройства или расположения.

## <a name="verify-on-premises-account-lockout-policy"></a>Проверка локальных политик блокировки учетных записей

Чтобы проверить локальную политику блокировки учетных записей Active Directory, сделайте следующее:

1. Откройте средства управления групповыми политиками.
2. Измените групповую политику, которая включает в себя политики блокировки учетных записей организации, например **политику домена по умолчанию**.
3. Последовательно выберите **Конфигурация компьютера** > **Политики** > **Параметры Windows** > **Параметры безопасности** > **Политики учетных записей** > **Политика блокировки учетной записи**.
4. Проверьте **пороговое значение блокировки учетных записей** и **время до сброса счетчика блокировки учетных записей**.

![Изменение политики блокировки локальной учетной записи Active Directory](./media/howto-password-smart-lockout/active-directory-on-premises-account-lockout-policy.png)

## <a name="manage-azure-ad-smart-lockout-values"></a>Управление значениями смарт-блокировки Azure AD

Исходя из требований организации, возможно потребуется настроить значение смарт-блокировки. Настройка параметров смарт-блокировки со значениями, характерными для вашей организации, требует платных лицензий Azure AD для пользователей.

Чтобы проверить или изменить значения смарт-блокировки для организации, выполните следующие действия.

1. Войдите на [портале Azure](https://portal.azure.com).
1. Найдите и выберите *Azure Active Directory*. Выберите **методы проверки Подлинности** > **защиту паролем**.
1. В зависимости от того, сколько попыток неудачного входа разрешено до первой блокировки учетной записи, установите **пороговое значение блокировки**. По умолчанию задано значение 10.
1. Чтобы указать время для каждой блокировки (в секундах), установите параметр **Длительность блокировки в секундах**. Значение по умолчанию — 60 секунд (одна минута).

> [!NOTE]
> Если первый вход после блокировки завершится ошибкой, учетная запись будет снова заблокирована. Если учетная запись будет заблокирована несколько раз, продолжительность блокировки увеличится.

![Настройка политики смарт-блокировки Azure AD на портале Azure](./media/howto-password-smart-lockout/azure-active-directory-custom-smart-lockout-policy.png)

## <a name="how-to-determine-if-the-smart-lockout-feature-is-working-or-not"></a>Как определить, работает ли функция смарт-блокировки

При активации порога Smart-блокировки при блокировке учетной записи будет получено следующее сообщение:

**Ваша учетная запись временно заблокирована, чтобы предотвратить несанкционированное использование. Повторите попытку позже. Если у вас по-прежнему возникают проблемы, обратитесь к администратору.**

## <a name="next-steps"></a>Дальнейшие действия

* [Настройка пользовательского списка заблокированных паролей](howto-password-ban-bad.md)
* [Быстрое развертывание самостоятельного сброса пароля в Azure AD](quickstart-sspr.md)
