---
title: Самостоятельный сброс пароля для Windows — Azure Active Directory
description: Как включить самостоятельный сброс пароля с помощью функции "Забытый пароль" на экране входа в Windows
services: active-directory
ms.service: active-directory
ms.subservice: authentication
ms.topic: conceptual
ms.date: 11/21/2019
ms.author: joflore
author: MicrosoftGuyJFlo
manager: daveba
ms.reviewer: sahenry
ms.collection: M365-identity-device-management
ms.openlocfilehash: 44e25efcb068fe51f05dbbde50e8a96da492a735
ms.sourcegitcommit: f523c8a8557ade6c4db6be12d7a01e535ff32f32
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/22/2019
ms.locfileid: "74381228"
---
# <a name="how-to-enable-password-reset-from-the-windows-login-screen"></a>Как включить сброс пароля с экрана входа в Windows

Для компьютеров под Windows 7, 8, 8,1 и 10 можно разрешить пользователям сбрасывать свой пароль на экране входа в Windows. Пользователям больше не нужно искать устройство с веб-браузером для доступа к [порталу SSPR](https://aka.ms/sspr).

![Примеры экранов входа Windows 7 и 10 с показанной ссылкой SSPR](./media/howto-sspr-windows/windows-reset-password.png)

## <a name="general-limitations"></a>Общие ограничения

- В настоящее время сброс пароля не поддерживается из удаленный рабочий стол или из расширенных сеансов Hyper-V.
- Эта функция не поддерживается для сетей с развернутым решением аутентификации 802.1X и заданным параметром "Выполнять непосредственно перед входом пользователя". Чтобы включить эту функцию для сетей с развернутыми решением аутентификации 802.1X, используйте аутентификацию компьютера.
- Гибридные компьютеры, присоединенные к Azure AD, должны иметь линию сетевого подключения к контроллеру домена, чтобы использовать новый пароль и обновлять кэшированные учетные данные.
- При использовании образа перед запуском программы Sysprep убедитесь, что веб-кэш для встроенного администратора отключен, прежде чем выполнять шаг Копипрофиле. Дополнительные сведения об этом шаге можно найти в статье о поддержке [низкая производительность при использовании пользовательского профиля пользователя по умолчанию](https://support.microsoft.com/help/4056823/performance-issue-with-custom-default-user-profile).
- Известны следующие параметры, которые влияют на возможность использования и сброса паролей на устройствах Windows 10.
    - Если согласно политике версий Windows 10 до 1809 нужно нажать CTRL+ALT+DEL, **Сброс пароля** не будет работать.
    - Если уведомления на экране блокировки отключены, **Сброс пароля** не будет работать.
    - HideFastUserSwitching со значением Enabled (Вкл.) или 1;
    - DontDisplayLastUserName со значением Enabled (Вкл.) или 1;
    - NoLockScreen со значением Enabled (Вкл.) или 1;
    - EnableLostMode, установленный на устройстве;
    - файл Explorer.exe, замененный на файл пользовательской оболочки.
- Сочетание следующих трех параметров может привести к неработоспособности этой функции.
    - Интерактивный вход: не требовать CTRL + ALT + DEL = Disabled
    - Дисаблелоккскринаппнотификатионс = 1 или включено
    - Исконтентделивериполициенфорцед = 1 или true

## <a name="windows-10-password-reset"></a>Сброс пароля Windows 10

### <a name="windows-10-prerequisites"></a>Предварительные требования для Windows 10

- Администратор должен включить самостоятельный сброс пароля Azure AD из портал Azure.
- **Пользователи должны зарегистрироваться для SSPR перед использованием этой функции**
- Требования к сетевому прокси
   - Устройства с Windows 10 
       - Порт 443 для `passwordreset.microsoftonline.com` и `ajax.aspnetcdn.com`
       - Устройства Windows 10 поддерживают только конфигурацию прокси-сервера на уровне компьютера
- Запустите Windows 10 с обновлением 2018 (v1803), а устройства должны быть либо:
    - присоединение к Azure AD;
    - присоединение к Azure AD (гибридные устройства).

### <a name="enable-for-windows-10-using-intune"></a>Включить для Windows 10 с помощью Intune

Самый гибкий метод — это развертывание изменений конфигурации для включения сброса пароля в окне входа в систему с помощью Intune. Intune позволяет развертывать изменения конфигурации для определенной группы компьютеров. Этот метод требует регистрации устройства в Intune.

#### <a name="create-a-device-configuration-policy-in-intune"></a>Создание политики конфигурации устройства в Intune

1. Войдите на [портал Azure](https://portal.azure.com) и щелкните **Intune**.
1. Создайте профиль конфигурации устройства, последовательно выбрав **Конфигурация устройства** > **Профили** > **Создать профиль**.
   - Введите понятное имя для профиля.
   - При необходимости введите содержательное описание профиля.
   - Выберите платформу **Windows 10 и более поздних версий**.
   - Для типа профиля укажите **Пользовательский**.
1. Настройте **параметры**.
   - В разделе "Параметры OMA-URI" **добавьте** следующий параметр, чтобы включить отображение ссылки сброса пароля.
      - Введите понятное имя, которое указывает на действия параметра.
      - При необходимости введите содержательное описание параметра.
      - Для параметра **OMA-URI** укажите значение `./Vendor/MSFT/Policy/Config/Authentication/AllowAadPasswordReset`.
      - Для параметра **Тип данных** задайте значение **Целое число**.
      - Для параметра **Значение** установите значение **1**.
      - Нажмите кнопку **ОК**
   - Нажмите кнопку **ОК**
1. Нажмите кнопку **Создать**
1. Эту политику можно назначить конкретным пользователям, устройствам или группам. Дополнительные сведения можно найти в статье [Назначение профилей пользователей и устройств в Microsoft Intune](https://docs.microsoft.com/intune/device-profile-assign).

### <a name="enable-for-windows-10-using-the-registry"></a>Включение для Windows 10 с помощью реестра

1. Войдите в Windows PC, используя административные учетные данные.
1. Запустите **regedit** от имени администратора.
1. Настройте следующий раздел реестра:
   - `HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\AzureADAccount`
      - `"AllowPasswordReset"=dword:00000001`

#### <a name="troubleshooting-windows-10-password-reset"></a>Устранение неполадок при сбросе пароля Windows 10

Журнал аудита Azure AD включают в себя сведения об IP-адресе и типе клиента (ClientType), на котором произошел сброс пароля.

![Пример сброса пароля Windows 7 в журнале аудита Azure AD](media/howto-sspr-windows/windows-7-sspr-azure-ad-audit-log.png)

Когда пользователи сбрасывают пароль на экране входа устройства Windows 10, создается временная учетная запись с низким уровнем прав, называемая `defaultuser1`. Эта учетная запись используется для обеспечения безопасности процесса сброса пароля. Учетная запись имеет случайно сгенерированный пароль, который не отображается при входе в устройство и будет автоматически удален после сброса пользователем пароля. Несколько профилей `defaultuser` могут существовать, но их можно спокойно игнорировать.

## <a name="windows-7-8-and-81-password-reset"></a>Сброс паролей Windows 7, 8 и 8,1

### <a name="windows-7-8-and-81-prerequisites"></a>Предварительные требования для Windows 7, 8 и 8,1

- Администратор должен включить самостоятельный сброс пароля Azure AD из портал Azure.
- **Пользователи должны зарегистрироваться для SSPR перед использованием этой функции**
- Требования к сетевому прокси
   - Устройства с Windows 7, 8 и 8,1
       - Порт 443 для `passwordreset.microsoftonline.com`
- В операционной системе Windows 7 или Windows 8.1 должны быть установлены исправления.
- Должен быть включен протокол TLS 1.2 (см. руководство по [настройке параметров реестра для протокола TLS](https://docs.microsoft.com/windows-server/security/tls/tls-registry-settings#tls-12)).
- Если на компьютере включен более одного стороннего поставщика учетных данных, на экране входа в систему будут отображаться несколько профилей пользователей.

> [!WARNING]
> Необходимо включить TLS 1,2, а не только установить автоматическое согласование

### <a name="install"></a>Установить

1. Скачайте соответствующий установщик для версии Windows, в которой следует включить этот протокол.
   - Программное обеспечение доступно в Центре загрузки Майкрософт по адресу [https://aka.ms/sspraddin](https://aka.ms/sspraddin).
1. Войдите на компьютер, где следует выполнить установку, и запустите программу установки.
1. После установки настоятельно рекомендуется выполнить перезагрузку.
1. После перезагрузки на экране входа выберите пользователя и нажмите кнопку "Забыли пароль?". чтобы инициировать процесс сброса пароля.
1. Завершите процесс, следуя указаниям на экране для сброса пароля.

![Пример для Windows 7 со ссылкой "Забыли пароль?", Поток SSPR](media/howto-sspr-windows/windows-7-sspr.png)

#### <a name="silent-installation"></a>Автоматическая установка

- Для автоматической установки воспользуйтесь командой msiexec /i SsprWindowsLogon.PROD.msi /qn.
- Для автоматического удаления воспользуйтесь командой msiexec /x SsprWindowsLogon.PROD.msi /qn.

#### <a name="troubleshooting-windows-7-8-and-81-password-reset"></a>Устранение неполадок Windows 7, 8 и 8,1 для сброса пароля

События регистрируются в журнале как на компьютере, так и в Azure AD. События Azure AD включают в себя сведения об IP-адресе и типе клиента (ClientType), на котором произошел сброс пароля.

![Пример сброса пароля Windows 7 в журнале аудита Azure AD](media/howto-sspr-windows/windows-7-sspr-azure-ad-audit-log.png)

При необходимости для включения подробного ведения журнала можно изменить соответствующий раздел реестра на компьютере. Подробное ведение журнала следует включать только для устранения неполадок.

`HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Authentication\Credential Providers\{86D2F0AC-2171-46CF-9998-4E33B3D7FD4F}`

- Чтобы включить подробное ведение журнала, создайте `REG_DWORD: “EnableLogging”`и задайте для него значение 1.
- Чтобы отключить подробное ведение журнала, измените `REG_DWORD: “EnableLogging”` на 0.

## <a name="what-do-users-see"></a>Что видят пользователи?

Теперь, когда вы настроили сброс пароля для устройств Windows, какие изменения для пользователя? Как они узнают, что можно сбросить пароль на экране входа в систему?

![Примеры экранов входа Windows 7 и 10 с показанной ссылкой SSPR](./media/howto-sspr-windows/windows-reset-password.png)

Когда пользователи пытаются войти в систему, они увидят ссылку **сбросить** пароль или **забыли пароль** , который открывает средство самостоятельного сброса пароля на экране входа. С помощью этой функции пользователи могут сбросить пароль, не используя другое устройство для получения доступа к браузеру.

Инструкции по использованию этой функции пользователи могут найти в статье [Я не помню свой пароль Azure AD](../user-help/active-directory-passwords-update-your-own-password.md).

## <a name="next-steps"></a>Дополнительная информация

[Планирование способов проверки подлинности](concept-authentication-methods.md)

[Настройка Windows 10](https://docs.microsoft.com/windows/configuration/)
