---
title: Отчеты о доступе и использовании для многофакторной Идентификации Azure — Azure Active Directory
description: Эта статья содержит информацию о том, как использовать функцию отчетов службы Многофакторной идентификации Azure.
services: multi-factor-authentication
ms.service: active-directory
ms.subservice: authentication
ms.topic: conceptual
ms.date: 07/30/2018
ms.author: joflore
author: MicrosoftGuyJFlo
manager: daveba
ms.reviewer: michmcla
ms.collection: M365-identity-device-management
ms.openlocfilehash: 988e8982b6f06fb1210330c5cafdb696892794fe
ms.sourcegitcommit: 509e1583c3a3dde34c8090d2149d255cb92fe991
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/27/2019
ms.locfileid: "66235517"
---
# <a name="reports-in-azure-multi-factor-authentication"></a>Отчеты в службе Многофакторной идентификации Azure

Служба "Многофакторная идентификация Azure" предоставляет несколько типов отчетов, которые могут быть полезны для вас и вашей организации. Просмотреть их можно на портале Azure. В следующей таблице перечислены доступные отчеты:

| Отчет | Расположение | Описание |
|:--- |:--- |:--- |
| Журнал заблокированных пользователей | "Azure AD > Сервер MFA > Блокировать или разблокировать пользователей" | История запросов на блокировку или разблокирование пользователей. |
| Предупреждения об использовании и о мошенничестве | "Azure AD > События входа" | Сведения об общем использовании, сводка пользователей, сведения о пользователях, а также история предупреждений о мошенничестве, отправленных в течение указанного диапазона дат. |
| Использование локальных компонентов | "Azure AD > Сервер MFA > Отчет о действиях" | Сведения об общем использовании MFA через расширение NPS, ADFS и сервер MFA. |
| Журнал обойденных пользователей | "Azure AD > Сервер MFA > Одноразовый обход проверки" | История запросов на обход многофакторной проверки подлинности для пользователя. |
| Состояние сервера | "Azure AD > Сервер MFA > Состояние сервера" | Сведения о состоянии серверов Многофакторной идентификации, с которыми связана ваша учетная запись. |

## <a name="view-mfa-reports"></a>Просмотр отчетов MFA

1. Войдите на [портале Azure](https://portal.azure.com).
2. В левой части экрана выберите **Azure Active Directory** > **Сервер MFA**.
3. Выберите отчет, который нужно просмотреть.

   ![Отчет о состоянии сервера многофакторной проверки Подлинности сервера на портале Azure](./media/howto-mfa-reporting/report.png)

## <a name="azure-ad-sign-ins-report"></a>Отчет по действиям входа Azure AD

**Отчеты по действиям входа** на [портале Azure](https://portal.azure.com) позволяют получать всю необходимую информацию, чтобы определить, как работает среда.

Благодаря этим отчетам вы получаете информацию об использовании управляемых приложений и действиях входа пользователей, которые включают сведения об использовании многофакторной проверки подлинности (MFA). Эти данные позволяют понять, как работает многофакторная проверка подлинности в вашей организации. Они позволяют ответить на такие вопросы:

- Выполнена ли многофакторная проверка подлинности при входе?
- Как пользователь выполнил ее?
- Почему пользователю не удалось это сделать?
- Сколько пользователей проходят многофакторную проверку подлинности?
- Скольким пользователям не удалось ее пройти?
- С какими общими проблемами сталкиваются пользователи, проходя многофакторную проверку подлинности?

Доступ к этим данным можно получить через [портал Azure](https://portal.azure.com) и [API отчетов](../reports-monitoring/concept-reporting-api.md).

![Входы в систему отчета Azure AD на портале Azure](./media/howto-mfa-reporting/sign-in-report.png)

### <a name="sign-ins-report-structure"></a>Структура отчета по действиям входа

Отчеты по действиям входа для многофакторной проверки подлинности позволяют получить доступ к следующим данным:

**Необходимость многофакторной проверки подлинности.** Требуется ли многофакторная проверка подлинности при входе в систему. MFA может потребоваться из-за соответствующих параметров для каждого пользователя, условного доступа или по другим причинам. Возможные значения: **Да** или **нет**.

**Результат многофакторной проверки подлинности.** Дополнительные сведения о выполнении или сбое многофакторной проверки подлинности:

- Если многофакторная проверка подлинности выполнена, в этом столбце можно просмотреть дополнительные сведения о ее выполнении.
   - Многофакторная идентификация Azure
      - Завершено в облаке.
      - Истек срок действия из-за политик, настроенных для клиента.
      - Запрос регистрации.
      - Выполнено путем утверждения в токене.
      - Выполнено путем утверждения, предоставленного внешним поставщиком.
      - Выполнено за счет строгой проверки подлинности.
      - Пропущено, так как был выполнен поток входа в брокер Windows.
      - Пропущено из-за пароля приложения.
      - Пропущено из-за расположения.
      - Пропущено из-за зарегистрированного устройства.
      - Пропущено из-за устройства.
      - Успешно завершено.
   - Перенаправлено к внешнему поставщику многофакторной проверки подлинности.

- Если произошел сбой многофакторной проверки подлинности, в этом столбце будет указана причина сбоя.
   - Отказ службы Azure Multi-Factor Authentication
      - Выполняется проверка подлинности.
      - Попытка повторного выполнения проверки подлинности.
      - Неверный код указан слишком много раз.
      - Недействительная проверка подлинности.
      - Недействительный код проверки в мобильном приложении.
      - Неправильные настройки.
      - Звонок был направлен на голосовую почту.
      - Недопустимый формат номера телефона.
      - Ошибка службы.
      - Не удается подключиться к телефону пользователя.
      - Не удается отправить уведомление от мобильного приложения на устройстве.
      - Не удается отправить уведомление от мобильного приложения.
      - Пользователь отклонил проверку подлинности.
      - Пользователь не отвечает на уведомление от мобильного приложения.
      - Пользователь не зарегистрировал методы проверки.
      - Пользователь ввел неправильный код.
      - Пользователь ввел неправильный ПИН-код.
      - Пользователь отклонил телефонный звонок без успешного выполнения проверки подлинности.
      - Пользователь заблокирован.
      - Пользователь не ввел код проверки.
      - Не удалось найти пользователя.
      - Код проверки уже использован один раз.

**Метод многофакторной проверки подлинности.** Метод многофакторной проверки подлинности, примененный пользователем. Ниже перечислены возможные значения.

- Текстовое сообщение
- Уведомление от мобильного приложения
- Телефонный звонок (телефон для проверки подлинности).
- Код проверки в мобильном приложении
- Телефонный звонок (рабочий телефон).
- Телефонный звонок (альтернативный для проверки подлинности).

**Сведения о многофакторной проверке подлинности.** Очищенная версия номера телефона, например +X XXXXXXXX64.

**Условный доступ** Узнайте о политиках условного доступа, которые затрагиваются попытками входа, в том числе:

- Имя политики
- Элементы управления предоставлением прав
- Элементы управления сеансов
- Результат

## <a name="powershell-reporting-on-users-registered-for-mfa"></a>PowerShell, отчеты о пользователей, зарегистрированных для многофакторной проверки Подлинности

Во-первых, убедитесь, что у вас есть [модуля MSOnline PowerShell версии 1](https://docs.microsoft.com/powershell/azure/active-directory/overview?view=azureadps-1.0) установлен.

Определите пользователей, зарегистрированных для многофакторной проверки подлинности с помощью Powershell:

```Get-MsolUser -All | where {$_.StrongAuthenticationMethods -ne $null} | Select-Object -Property UserPrincipalName```

Определите пользователей, не зарегистрированных для многофакторной проверки подлинности с помощью Powershell:

```Get-MsolUser -All | where {$_.StrongAuthenticationMethods.Count -eq 0} | Select-Object -Property UserPrincipalName```

## <a name="possible-results-in-activity-reports"></a>Возможные результаты в отчеты о действиях

Следующая таблица может использоваться для устранения неполадок многофакторной проверки подлинности с помощью загруженной версии отчета о действиях многофакторной проверки подлинности. Они не будут отображаться непосредственно на портале Azure.

| Результат вызова | Описание | Общее описание |
| --- | --- | --- |
| SUCCESS_WITH_PIN | ПИН-код введен | Пользователь ввел ПИН-код.  Если проверка подлинности успешно пройдена, значит он ввел правильный ПИН-код.  При проверке подлинности отказано, значит введен неправильный ПИН-код или пользователя установлено до стандартного режима. |
| SUCCESS_NO_PIN | Только # ввода | Если пользователь будет переведена в режим ПИН-кода и в проверке подлинности отказано, это означает, что пользователь не ввел свой ПИН-код и только ввести #.  Если пользователь находится в стандартном режиме и проверка подлинности завершается успешно, это означает, что пользователь ввел только #, который является правильным, выполните в стандартном режиме. |
| SUCCESS_WITH_PIN_BUT_TIMEOUT | # Не нажата в течение операции | Пользователь был не отправил цифры DTMF, поскольку не введен #.  Другие введенные цифры не отправляются, если # вводится, указывающий на завершение операции. |
|SUCCESS_NO_PIN_BUT_TIMEOUT | Нет ввода в телефоне — превышено время ожидания | Звонок был принят, но не был получен ответ.  Обычно это означает, что вызов была принята голосовой почты. |
| SUCCESS_PIN_EXPIRED | Истек срок действия ПИН-код и он не изменен | Истек срок действия ПИН-кода пользователя и пользователь получил запрос на его изменить, но изменить ПИН-код не был успешно завершен. |
| SUCCESS_USED_CACHE | Используемый кэш | Проверка подлинности успешно пройдена без вызова многофакторной проверки подлинности, с момента предыдущей успешной проверки подлинности для того же имени пользователя в пределах настроенного периода действия кэша. |
| SUCCESS_BYPASSED_AUTH | Проверка подлинности обойдена | Проверка подлинности успешно пройдена с помощью одноразовый обход проверки, инициированного для пользователя.  См. в разделе пользователя отчет по журналу обойденных Дополнительные сведения об обходе проверки. |
| SUCCESS_USED_IP_BASED_CACHE | Используемый кэш на основе IP-адресов | Проверка подлинности успешно пройдена без вызова многофакторной проверки подлинности с момента предыдущей успешной проверки подлинности для того же имени пользователя, тип проверки подлинности, имя приложения, и произошла IP-адрес в пределах настроенного периода действия кэша. |
| SUCCESS_USED_APP_BASED_CACHE | Используемый кэш на основе приложений | Проверка подлинности успешно пройдена без вызова многофакторной проверки подлинности с момента предыдущей успешной проверки подлинности для того же имени пользователя, тип проверки подлинности и имя приложения в пределах настроенного периода действия кэша. |
| SUCCESS_INVALID_INPUT | Недопустимый ввод в телефоне | Недопустимый ответ, отправляемый с телефона.  Это может быть ответ факсимильного аппарата или модема, либо пользователь мог быть введен * как часть свой ПИН-код. |
| SUCCESS_USER_BLOCKED | Пользователь заблокирован | Номер телефона пользователя заблокирован.  Заблокированный номер может быть запущена пользователем во время вызова для проверки подлинности с помощью портала Azure. <br> Примечание.  Заблокированный номер также является побочным эффектом предупреждения о мошенничестве. |
| SUCCESS_SMS_AUTHENTICATED | SMS прошло проверку подлинности | Двустороннее SMS, пользователь правильно ответил на используя одноразовый пароль (OTP) или OTP + ПИН-код. |
| SUCCESS_SMS_SENT | SMS отправлено | Для текстовых сообщений успешно отправлено текстовое сообщение, содержащее одноразовый пароль (OTP).  Пользователь будет вводить OTP или OTP + ПИН-код в приложении, чтобы завершить проверку подлинности. |
| SUCCESS_PHONE_APP_AUTHENTICATED | Мобильное приложение прошло проверку подлинности | Пользователь успешно прошел проверку подлинности через мобильное приложение. |
| SUCCESS_OATH_CODE_PENDING | Ожидание oath-кода | Пользователь был запрошен свой oath-код, но не получили ответ. |
| SUCCESS_OATH_CODE_VERIFIED | Oath-код проверен | Пользователь ввел допустимый oath-код при появлении запроса. |
| SUCCESS_FALLBACK_OATH_CODE_VERIFIED | Резервный oath-код проверен | Пользователю было отказано в проверке подлинности с помощью его основного метода многофакторной проверки подлинности затем он предоставляется действительного кода OATH для резервной проверки подлинности. |
| SUCCESS_FALLBACK_SECURITY_QUESTIONS_ANSWERED | Ответы на вопросы резервной системы безопасности | Пользователю было отказано в проверке подлинности с помощью его основного метода многофакторной проверки подлинности и затем ответы на свои контрольные вопросы для резервной. |
| FAILED_PHONE_BUSY | Проверка подлинности уже выполняется | Многофакторная Идентификация уже осуществляет проверку подлинности для этого пользователя.  Часто это связано с RADIUS-клиенты, которые отправляют несколько запросов проверки подлинности во время такой же вход. |
| CONFIG_ISSUE | Телефон недоступен | Была предпринята попытка вызова, но либо не удалось поместить или не был получен ответ.  Сюда входят сигналов, сигналов (отключен), тремя необслуживаемого (число больше не в службе), истекло время ожидания при звонка и т. д. |
| FAILED_INVALID_PHONENUMBER | Недопустимый формат номера телефона | Номер телефона имеет недопустимый формат.  Номера телефонов должны быть числовыми и должен содержать 10 цифр для кода страны + 1 (США и Канада). |
| FAILED_USER_HUNGUP_ON_US | Пользователь повесил трубку | Пользователь взял, но затем положил ее без нажатия клавиши все кнопки. |
| FAILED_INVALID_EXTENSION | Недопустимый добавочный номер | Добавочный номер содержит недопустимые символы.  Только цифры, запятые, *, а # запрещены.  Также можно использовать префикс @. |
| FAILED_FRAUD_CODE_ENTERED | Введен мошеннический код | Пользователь решил сообщить о мошенничестве во время вызова приведет отказом в проверке подлинности и блокировке телефонного номера.| 
| FAILED_SERVER_ERROR | Не удалось сделать вызов | Служба многофакторной проверки подлинности не удалось выполнить вызов. |
| FAILED_SMS_NOT_SENT | Не удалось отправить текстовое сообщение | Не удалось отправить текстовое сообщение.  В проверке подлинности отказано. |
| FAILED_SMS_OTP_INCORRECT | SMS: неверный OTP | Пользователь ввел неправильный одноразовый пароль (OTP) из текста сообщения, полученного.  В проверке подлинности отказано. |
| FAILED_SMS_OTP_PIN_INCORRECT | Текст сообщения OTP + ПИН-код неверные | Пользователь ввел неправильный одноразовый пароль (OTP) и (или) неправильный ПИН-код пользователя.  В проверке подлинности отказано. |
| FAILED_SMS_MAX_OTP_RETRY_REACHED | Превышено допустимое число попыток ввода одноразового ПАРОЛЯ сообщения | Пользователь превысил максимальное количество попыток одноразовый пароль (OTP). |
| FAILED_PHONE_APP_DENIED | Мобильное приложение запрещено | Пользователь отклонил проверку подлинности в мобильном приложении, нажав клавишу «запретить». |
| FAILED_PHONE_APP_INVALID_PIN | Мобильное приложение: недопустимый ПИН-код | Пользователь ввел недопустимый ПИН-код при проверке подлинности в мобильном приложении. |
| FAILED_PHONE_APP_PIN_NOT_CHANGED | Мобильное приложение ПИН-код не изменен | Пользователь не завершилась успешно необходимое изменение ПИН-кода в мобильном приложении. |
| FAILED_FRAUD_REPORTED | Сообщение о мошенничестве | Пользователь сообщил о мошенничества в мобильном приложении. |
| FAILED_PHONE_APP_NO_RESPONSE | Мобильное приложение нет ответа | Пользователь не ответил на запрос проверки подлинности мобильного приложения. |
| FAILED_PHONE_APP_ALL_DEVICES_BLOCKED | Мобильное приложение: все устройства заблокированы | Устройства с мобильным приложением для этого пользователя больше не отвечают на уведомления и были заблокированы. |
| FAILED_PHONE_APP_NOTIFICATION_FAILED | Не удалось отправить уведомление мобильного приложения | Произошла ошибка при попытке отправить уведомление в мобильное приложение на устройстве пользователя. |
| FAILED_PHONE_APP_INVALID_RESULT | Мобильное приложение: недопустимый результат | Мобильное приложение вернуло недопустимый результат. |
| FAILED_OATH_CODE_INCORRECT | Неправильный oath-код | Пользователь ввел неправильный oath-код.  В проверке подлинности отказано. |
| FAILED_OATH_CODE_PIN_INCORRECT | Oath-код + ПИН-код неверны | Пользователь ввел неправильный oath-код и (или) неправильный ПИН-код пользователя.  В проверке подлинности отказано. |
| FAILED_OATH_CODE_DUPLICATE | Дублирование oath-кода | Пользователь ввел oath-код, который использовался ранее.  В проверке подлинности отказано. |
| FAILED_OATH_CODE_OLD | Устаревший oath-код | Пользователь ввел oath-код, который предшествует oath-код, который использовался ранее.  В проверке подлинности отказано. |
| FAILED_OATH_TOKEN_TIMEOUT | Превышено время ожидания результата OATH кода | Пользователь заняло слишком много времени, чтобы ввести oath-код и попытки многофакторной проверки подлинности уже превышено время ожидания. |
| FAILED_SECURITY_QUESTIONS_TIMEOUT | Время ожидания результатов вопросы безопасности | Пользователь заняло слишком много времени, чтобы ввести ответов на вопросы безопасности и попытки многофакторной проверки подлинности уже превышено время ожидания. |
| FAILED_AUTH_RESULT_TIMEOUT | Время ожидания результатов проверки подлинности | Пользователь слишком долго для завершения попытки многофакторной проверки подлинности. |
| FAILED_AUTHENTICATION_THROTTLED | Регулирование проверки подлинности | Попытка многофакторной проверки подлинности был регулируется службой. |

## <a name="next-steps"></a>Дальнейшие действия

* [Для пользователей](../user-help/multi-factor-authentication-end-user.md)
* [Выберите для себя решение "Многофакторная идентификация Microsoft Azure"](concept-mfa-whichversion.md)
