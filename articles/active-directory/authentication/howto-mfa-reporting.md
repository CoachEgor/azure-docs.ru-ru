---
title: Отчеты о доступе и использовании для Azure MFA — Azure Active Directory
description: Эта статья содержит информацию о том, как использовать функцию отчетов службы Многофакторной идентификации Azure.
services: multi-factor-authentication
ms.service: active-directory
ms.subservice: authentication
ms.topic: conceptual
ms.date: 07/30/2018
ms.author: joflore
author: MicrosoftGuyJFlo
manager: daveba
ms.reviewer: michmcla
ms.collection: M365-identity-device-management
ms.openlocfilehash: 25cd36b6b3e8a6974618189985152e55c2676999
ms.sourcegitcommit: b3bad696c2b776d018d9f06b6e27bffaa3c0d9c3
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/21/2019
ms.locfileid: "69874302"
---
# <a name="reports-in-azure-multi-factor-authentication"></a>Отчеты в службе Многофакторной идентификации Azure

Служба "Многофакторная идентификация Azure" предоставляет несколько типов отчетов, которые могут быть полезны для вас и вашей организации. Просмотреть их можно на портале Azure. В следующей таблице перечислены доступные отчеты:

| Сообщить | Местоположение | Описание |
|:--- |:--- |:--- |
| Журнал блокировки пользователей | "Azure AD > Сервер MFA > Блокировать или разблокировать пользователей" | История запросов на блокировку или разблокирование пользователей. |
| Предупреждения об использовании и о мошенничестве | "Azure AD > События входа" | Сведения об общем использовании, сводка пользователей, сведения о пользователях, а также история предупреждений о мошенничестве, отправленных в течение указанного диапазона дат. |
| Использование локальных компонентов | "Azure AD > Сервер MFA > Отчет о действиях" | Сведения об общем использовании MFA через расширение NPS, ADFS и сервер MFA. |
| Журнал обойденных пользователей | "Azure AD > Сервер MFA > Одноразовый обход проверки" | История запросов на обход многофакторной проверки подлинности для пользователя. |
| Состояние сервера | "Azure AD > Сервер MFA > Состояние сервера" | Сведения о состоянии серверов Многофакторной идентификации, с которыми связана ваша учетная запись. |

## <a name="view-mfa-reports"></a>Просмотр отчетов MFA

1. Войдите на [портале Azure](https://portal.azure.com).
2. В левой части экрана выберите **Azure Active Directory** > **Сервер MFA**.
3. Выберите отчет, который нужно просмотреть.

   ![Отчет о состоянии сервера MFA в портал Azure](./media/howto-mfa-reporting/report.png)

## <a name="azure-ad-sign-ins-report"></a>Отчет по действиям входа Azure AD

**Отчеты по действиям входа** на [портале Azure](https://portal.azure.com) позволяют получать всю необходимую информацию, чтобы определить, как работает среда.

Благодаря этим отчетам вы получаете информацию об использовании управляемых приложений и действиях входа пользователей, которые включают сведения об использовании многофакторной проверки подлинности (MFA). Эти данные позволяют понять, как работает многофакторная проверка подлинности в вашей организации. Они позволяют ответить на такие вопросы:

- Выполнена ли многофакторная проверка подлинности при входе?
- Как пользователь выполнил ее?
- Почему пользователю не удалось это сделать?
- Сколько пользователей проходят многофакторную проверку подлинности?
- Скольким пользователям не удалось ее пройти?
- С какими общими проблемами сталкиваются пользователи, проходя многофакторную проверку подлинности?

Доступ к этим данным можно получить через [портал Azure](https://portal.azure.com) и [API отчетов](../reports-monitoring/concept-reporting-api.md).

![Отчет о входе в Azure AD в портал Azure](./media/howto-mfa-reporting/sign-in-report.png)

### <a name="sign-ins-report-structure"></a>Структура отчета по действиям входа

Отчеты по действиям входа для многофакторной проверки подлинности позволяют получить доступ к следующим данным:

**Необходимость многофакторной проверки подлинности.** Требуется ли многофакторная проверка подлинности при входе в систему. MFA может потребоваться из-за многопользовательского MFA, условного доступа или по другим причинам. Возможные значения: **Да** или **нет**.

**Результат многофакторной проверки подлинности.** Дополнительные сведения о выполнении или сбое многофакторной проверки подлинности:

- Если многофакторная проверка подлинности выполнена, в этом столбце можно просмотреть дополнительные сведения о ее выполнении.
   - Многофакторная проверка подлинности Azure
      - Завершено в облаке.
      - Истек срок действия из-за политик, настроенных для клиента.
      - Запрос регистрации.
      - Выполнено путем утверждения в токене.
      - Выполнено путем утверждения, предоставленного внешним поставщиком.
      - Выполнено за счет строгой проверки подлинности.
      - Пропущено, так как был выполнен поток входа в брокер Windows.
      - Пропущено из-за пароля приложения.
      - Пропущено из-за расположения.
      - Пропущено из-за зарегистрированного устройства.
      - Пропущено из-за устройства.
      - Успешно завершено.
   - Перенаправлено к внешнему поставщику многофакторной проверки подлинности.

- Если произошел сбой многофакторной проверки подлинности, в этом столбце будет указана причина сбоя.
   - Отказ службы Azure Multi-Factor Authentication
      - Выполняется проверка подлинности.
      - Попытка повторного выполнения проверки подлинности.
      - Неверный код указан слишком много раз.
      - Недействительная проверка подлинности.
      - Недействительный код проверки в мобильном приложении.
      - Неправильные настройки.
      - Звонок был направлен на голосовую почту.
      - Недопустимый формат номера телефона.
      - Ошибка службы.
      - Не удается подключиться к телефону пользователя.
      - Не удается отправить уведомление от мобильного приложения на устройстве.
      - Не удается отправить уведомление от мобильного приложения.
      - Пользователь отклонил проверку подлинности.
      - Пользователь не отвечает на уведомление от мобильного приложения.
      - Пользователь не зарегистрировал методы проверки.
      - Пользователь ввел неправильный код.
      - Пользователь ввел неправильный ПИН-код.
      - Пользователь отклонил телефонный звонок без успешного выполнения проверки подлинности.
      - Пользователь заблокирован.
      - Пользователь не ввел код проверки.
      - Не удалось найти пользователя.
      - Код проверки уже использован один раз.

**Метод многофакторной проверки подлинности.** Метод многофакторной проверки подлинности, примененный пользователем. Ниже перечислены возможные значения.

- SMS
- Уведомление мобильного приложения
- Телефонный звонок (телефон для проверки подлинности).
- Код проверки в мобильном приложении
- Телефонный звонок (рабочий телефон).
- Телефонный звонок (альтернативный для проверки подлинности).

**Сведения о многофакторной проверке подлинности.** Очищенная версия номера телефона, например +X XXXXXXXX64.

**Условный доступ** Сведения о политиках условного доступа, которые затронули попытки входа в систему, включая:

- Имя политики
- Предоставить управление
- Элементы управления сеансов
- Результат

## <a name="powershell-reporting-on-users-registered-for-mfa"></a>Отчеты PowerShell для пользователей, зарегистрированных для MFA

Сначала убедитесь, что установлен [модуль PowerShell MSOnline v1](https://docs.microsoft.com/powershell/azure/active-directory/overview?view=azureadps-1.0) .

Определите пользователей, зарегистрированных для многофакторной проверки подлинности с помощью Powershell:

```Get-MsolUser -All | Where-Object {$_.StrongAuthenticationMethods -ne $null} | Select-Object -Property UserPrincipalName```

Определите пользователей, не зарегистрированных для многофакторной проверки подлинности с помощью Powershell:

```Get-MsolUser -All | Where-Object {$_.StrongAuthenticationMethods.Count -eq 0} | Select-Object -Property UserPrincipalName```

## <a name="possible-results-in-activity-reports"></a>Возможные результаты в отчетах об активности

Следующая таблица может использоваться для устранения неполадок многофакторной проверки подлинности с помощью скачанной версии отчета о действиях многофакторной проверки подлинности. Они не будут отображаться непосредственно в портал Azure.

| Результат вызова | Описание | Общее описание |
| --- | --- | --- |
| SUCCESS_WITH_PIN | ПИН-код введен | Пользователь указал ПИН-код.  Если проверка подлинности прошла удачно, они указали правильный ПИН-код.  Если проверка подлинности запрещена, то введен неверный ПИН-код или пользователь настроен на стандартный режим. |
| SUCCESS_NO_PIN | Только указанный # | Если пользователь настроен на режим закрепления и для проверки подлинности отказано, это означает, что пользователь не введет ПИН-код и только введет #.  Если пользователь настроен на стандартный режим и проверка подлинности выполнена, это означает, что пользователь вводит только #, что нужно сделать в стандартном режиме. |
| SUCCESS_WITH_PIN_BUT_TIMEOUT | # Не нажат после записи | Пользователь не отправил никакие цифры DTMF, так как не была указана директива #.  Другие введенные цифры не отправляются, если не введено значение #, указывающее на завершение записи. |
|SUCCESS_NO_PIN_BUT_TIMEOUT | Нет ввода с телефона — истекло время ожидания | Получен ответ на вызов, но ответ отсутствует.  Как правило, это означает, что вызов был выбран голосовой почтой. |
| SUCCESS_PIN_EXPIRED | Истек срок действия ПИН-кода, и он не изменен | Срок действия ПИН-кода пользователя истек, и ему было предложено изменить его, но изменение ПИН-кода не было выполнено. |
| SUCCESS_USED_CACHE | Используемый кэш | Проверка подлинности успешно выполнена без вызова многофакторной проверки подлинности, так как предыдущая успешная проверка подлинности для одного имени пользователя произошла в течение заданного интервала |
| SUCCESS_BYPASSED_AUTH | Пропущенная проверка подлинности | Проверка подлинности прошла с использованием одноразового обхода, инициированного пользователем.  Дополнительные сведения о пропуске см. в отчете о пропуске журнала пользователей. |
| SUCCESS_USED_IP_BASED_CACHE | Используемый кэш на основе IP-адреса | Проверка подлинности прошла успешно без вызова многофакторной проверки подлинности с момента предыдущей успешной проверки подлинности для того же имени пользователя, типа проверки подлинности, имени приложения и IP-адреса в течение заданного интервала. |
| SUCCESS_USED_APP_BASED_CACHE | Используемый кэш на основе приложений | Проверка подлинности прошла успешно без вызова многофакторной проверки подлинности с момента предыдущей успешной проверки подлинности для того же имени пользователя, типа проверки подлинности и имени приложения в пределах настроенного интервала. |
| SUCCESS_INVALID_INPUT | Недопустимый ввод в телефоне | Недопустимый ответ, отправленный с телефона.  Это может быть компьютер факса или модем, или пользователь указал * как часть своего ПИН-кода. |
| SUCCESS_USER_BLOCKED | Пользователь заблокирован | Номер телефона пользователя заблокирован.  Заблокированное число может инициироваться пользователем во время вызова проверки подлинности или администратором с помощью портал Azure. <br> Примечание.  Заблокированное число — это также побочным эффектом предупреждения о мошенничестве. |
| SUCCESS_SMS_AUTHENTICATED | SMS прошло проверку подлинности | Для двустороннего тестового сообщения пользователь правильно ответил с помощью одноразового секретного кода (OTP) или OTP + PIN. |
| SUCCESS_SMS_SENT | SMS отправлено | Для текстовых сообщений текстовое сообщение, содержащее одноразовый секретный код (OTP), успешно отправлено.  Пользователь введет в приложении ПИН-код OTP или OTP + для завершения проверки подлинности. |
| SUCCESS_PHONE_APP_AUTHENTICATED | Мобильное приложение прошло проверку подлинности | Пользователь успешно прошел проверку подлинности через мобильное приложение. |
| SUCCESS_OATH_CODE_PENDING | Ожидание OATH-кода | Пользователь получил запрос на OATH-код, но не ответил. |
| SUCCESS_OATH_CODE_VERIFIED | OATH-код проверен | При появлении запроса пользователь вводит допустимый OATH-код. |
| SUCCESS_FALLBACK_OATH_CODE_VERIFIED | OATH-код резервной системы безопасности проверен | Пользователю отказано в проверке подлинности с помощью основного метода многофакторной проверки подлинности, а затем предоставлен допустимый OATH-код для отката. |
| SUCCESS_FALLBACK_SECURITY_QUESTIONS_ANSWERED | Получены ответы на вопросы резервной системы безопасности | Пользователю было отказано в проверке подлинности с помощью основного метода многофакторной проверки подлинности, а затем правильно получены ответы на контрольные вопросы. |
| FAILED_PHONE_BUSY | Выполняется проверка подлинности | Многофакторная проверка подлинности уже обрабатывает проверку подлинности для этого пользователя.  Часто это вызвано тем, что клиенты RADIUS, отправляющие несколько запросов проверки подлинности во время одного входа. |
| CONFIG_ISSUE | Телефон недоступен | Предпринята попытка вызова, но либо не удалось поместить, либо не ответил.  Это включает сигнал занятости, сигнал высокой занятости (отключен), три тона (число больше не обслуживается), время ожидания при звонках и т. д. |
| FAILED_INVALID_PHONENUMBER | Недопустимый формат номера телефона | Недопустимый формат номера телефона.  Номера телефонов должны быть числовыми и состоять из 10 цифр в коде страны + 1 (США & Канада). |
| FAILED_USER_HUNGUP_ON_US | Пользователь повесил трубку | Пользователь ответил на телефон, но затем зависла без нажатия каких либо кнопок. |
| FAILED_INVALID_EXTENSION | Недопустимый добавочный номер | Расширение содержит недопустимые символы.  Допускаются только цифры, запятые, * и #.  Можно также использовать префикс @. |
| FAILED_FRAUD_CODE_ENTERED | Введен мошеннический код | Пользователь решил сообщить о мошенничестве во время вызова, что привело к запрещенной проверке подлинности и заблокированному номеру телефона.| 
| FAILED_SERVER_ERROR | Не удается сделать вызов | Службе многофакторной идентификации не удалось разместить вызов. |
| FAILED_SMS_NOT_SENT | Не удалось отправить текстовое сообщение | Не удалось отправить текстовое сообщение.  Проверка подлинности запрещена. |
| FAILED_SMS_OTP_INCORRECT | SMS: неверный OTP | Пользователь указал неправильный одноразовый пароль (OTP) на основе полученного текстового сообщения.  Проверка подлинности запрещена. |
| FAILED_SMS_OTP_PIN_INCORRECT | SMS — неверный OTP + ПИН-код | Пользователь указал неверный одноразовый пароль (OTP) и (или) неверный ПИН-код пользователя.  Проверка подлинности запрещена. |
| FAILED_SMS_MAX_OTP_RETRY_REACHED | Превышено максимальное число попыток OTP для SMS | Пользователь превысил максимальное число попыток одноразового секретного кода (OTP). |
| FAILED_PHONE_APP_DENIED | Мобильное приложение запрещено | Пользователь отклонил проверку подлинности в мобильном приложении, нажав кнопку "запретить". |
| FAILED_PHONE_APP_INVALID_PIN | Мобильное приложение: недопустимый ПИН-код | При проверке подлинности в мобильном приложении пользователь указал недопустимый ПИН-код. |
| FAILED_PHONE_APP_PIN_NOT_CHANGED | Мобильное приложение: ПИН-код не изменен | Пользователь не успешно выполнил требуемое изменение ПИН-кода в мобильном приложении. |
| FAILED_FRAUD_REPORTED | Получено сообщение о мошенничестве | Пользователь сообщил о мошенничестве в мобильном приложении. |
| FAILED_PHONE_APP_NO_RESPONSE | Мобильное приложение: нет ответа | Пользователь не ответил на запрос проверки подлинности мобильного приложения. |
| FAILED_PHONE_APP_ALL_DEVICES_BLOCKED | Мобильное приложение: все устройства заблокированы | Мобильные устройства мобильных приложений для этого пользователя больше не отвечают на уведомления и были заблокированы. |
| FAILED_PHONE_APP_NOTIFICATION_FAILED | Мобильное приложение: сбой уведомления | При попытке отправить уведомление в мобильное приложение на устройстве пользователя произошла ошибка. |
| FAILED_PHONE_APP_INVALID_RESULT | Мобильное приложение: недопустимый результат | Мобильное приложение вернуло недопустимый результат. |
| FAILED_OATH_CODE_INCORRECT | Неверный OATH-код | Пользователь указал неверный OATH-код.  Проверка подлинности запрещена. |
| FAILED_OATH_CODE_PIN_INCORRECT | OATH-код + неверное закрепление | Пользователь указал неверный OATH-код и (или) неверное значение пользователя.  Проверка подлинности запрещена. |
| FAILED_OATH_CODE_DUPLICATE | Дублирование OATH-кода | Пользователь вводит OATH-код, который использовался ранее.  Проверка подлинности запрещена. |
| FAILED_OATH_CODE_OLD | OATH-код устарел | Пользователь указал OATH-код, который предшествует ранее использованному OATH-коду.  Проверка подлинности запрещена. |
| FAILED_OATH_TOKEN_TIMEOUT | Превышено время ожидания результата OATH-кода | Пользователь занял слишком много времени для ввода OATH-кода и попытки многофакторной проверки подлинности уже истекли. |
| FAILED_SECURITY_QUESTIONS_TIMEOUT | Превышено время ожидания результатов ответов на контрольные вопросы | Ввод ответа на контрольные вопросы и попытка многофакторной проверки подлинности уже истек, так как пользователь занял слишком много времени. |
| FAILED_AUTH_RESULT_TIMEOUT | Время ожидания результатов проверки подлинности | Выполнение многофакторной проверки подлинности пользователем заняло слишком много времени. |
| FAILED_AUTHENTICATION_THROTTLED | Регулирование проверки подлинности | Попытка многофакторной проверки подлинности была отрегулирована службой. |

## <a name="next-steps"></a>Следующие шаги

* [Отчеты об использовании и аналитике SSPR и MFA](howto-authentication-methods-usage-insights.md)
* [Для пользователей](../user-help/multi-factor-authentication-end-user.md)
* [Выберите для себя решение "Многофакторная идентификация Microsoft Azure"](concept-mfa-whichversion.md)
