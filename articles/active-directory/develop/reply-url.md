---
title: Перенаправление URL-адрес URI/ответа ограничения и ограничения - платформой Microsoft identity
description: Ограничения URL-адресов и перенаправления URL-адреса ответа и ограничения
author: SureshJa
ms.author: sureshja
manager: CelesteDG
ms.date: 06/29/2019
ms.topic: article
ms.subservice: develop
ms.service: active-directory
ms.reviewer: lenalepa, manrath
ms.collection: M365-identity-device-management
ms.openlocfilehash: 07be7d0c70193fec88782fea681e33d6b4cf4b40
ms.sourcegitcommit: 9b80d1e560b02f74d2237489fa1c6eb7eca5ee10
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/01/2019
ms.locfileid: "67486237"
---
# <a name="redirect-urireply-url-restrictions-and-limitations"></a>Ограничения для универсального кода ресурса (URI) перенаправления и URL-адреса ответа

Перенаправление URI или URL-адрес ответа, — расположение, что сервер авторизации будет направлять пользователя только раз приложения был успешно авторизован и предоставить код авторизации, либо доступ токена. Токен или код содержится в поле адрес URI или ответ маркер, поэтому очень важно зарегистрировать правильное расположение в рамках процесса регистрации приложения.

## <a name="maximum-number-of-redirect-uris"></a>Максимальное количество URI перенаправления

Следующая таблица показывает максимальное количество URI перенаправления, можно добавить при регистрации приложения. 

| Учетные записи, вход | Максимальное количество URI перенаправления | Описание |
|--------------------------|---------------------------------|-------------|
| Рабочей или учебной учетными записями в клиенте Azure Active Directory (Azure AD) для любой организации Майкрософт | 256 | `signInAudience` поля в манифесте приложения может принимать значение *AzureADMyOrg* или *AzureADMultipleOrgs* |
| Microsoft персональных учетных записей и работать и учебных учетных записей | 100 | `signInAudience` поля в манифесте приложения задается *AzureADandPersonalMicrosoftAccount* |

## <a name="maximum-uri-length"></a>Максимальная длина URI

Для каждого URI перенаправления, который можно добавить регистрацию приложения можно использовать не более 256 символов.

## <a name="restrictions-using-a-wildcard-in-uris"></a>Ограничения, с помощью подстановочного знака в URI

Шаблон URI, таких как `https://*.contoso.com`, удобны, но следует избегать. Использование подстановочных знаков в перенаправления URI имеет последствия для безопасности. В соответствии со спецификацией OAuth 2.0 ([раздел 3.1.2 из RFC 6749](https://tools.ietf.org/html/rfc6749#section-3.1.2)), URI конечной точки перенаправления должен быть абсолютным URI. 

Модели приложения Azure AD не поддерживает подстановочные идентификаторы URI для приложений, которые настроены для входа личных учетных записей Майкрософт и рабочих или учебных учетных записей. Тем не менее для приложений, которые настроены для входа в рабочих или учебных учетных записей в клиенте Azure AD организации сегодня разрешены подстановочные идентификаторы URI. 
 
> [!NOTE]
> Новый [регистрация приложений](https://go.microsoft.com/fwlink/?linkid=2083908) интерфейс не позволяет разработчикам добавлять подстановочный знак коды URI в пользовательском Интерфейсе. Добавление URI подстановочный знак для приложений, войдите в рабочих или учебных учетных записей поддерживается только через редактор манифеста приложения. Забегая вперед, новые приложения нельзя использовать подстановочные знаки в URI перенаправления. Тем не менее более старые приложения, которые содержат подстановочные знаки в перенаправления идентификаторы URI будет продолжать работать.

Если сценарий требует, что несколько URI перенаправления чем максимальный предел, разрешенный, вместо добавления подстановочный знак URI перенаправления, рассмотрите один из следующих подходов.

### <a name="use-a-state-parameter"></a>Использовать параметр состояния

У вас есть несколько дочерних доменов, если сценарий требует для перенаправления пользователей после успешной проверки подлинности на ту же страницу, где они запущены, используйте параметр, состояние может быть полезно. 

При использовании этого подхода:

1. Создание «общий» URI перенаправления каждого приложения для обработки маркеров безопасности, полученный от конечной точки авторизации.
1. Приложение может отправлять параметры конкретного приложения (например, в которых была создана пользователем, или что-нибудь, например сведения о компании поддомен URL-адрес) в параметре state. При использовании параметра состояния защиты от CSRF защиты, как указано в [разделе 10.12 описания RFC 6749](https://tools.ietf.org/html/rfc6749#section-10.12)). 
1. Параметры конкретного приложения будут включать все сведения, необходимые для приложения для отображения правильного взаимодействия с пользователем, то есть, создайте состояние соответствующего приложения. Полосковых линий конечной точки авторизации Azure AD, HTML из параметра состояния таким образом убедиться, что вы не передаете HTML содержимого в этом параметре.
1. Когда Azure AD отправляет ответ на «общий» URI перенаправления, она отправляет параметра состояния в приложение.
1. Приложение может использовать значение в параметре state для определения точного URL-адреса для дальнейшей отправки пользователю. Убедитесь, что проверка для защиты CSRF.

> [!NOTE]
> Такой подход позволяет клиенту скомпрометированных изменить дополнительные параметры, передаваемые в параметре state, тем самым перенаправления пользователя на другой URL-адрес, который является [откройте угроз перенаправителя](https://tools.ietf.org/html/rfc6819#section-4.2.4) описано в RFC 6819. Таким образом клиент должен защитить эти параметры путем шифрования состояния или проверка его с другими способами, например проверки доменного имени в URI-перенаправления с маркера.

### <a name="add-redirect-uris-to-service-principals"></a>Добавление URI перенаправления для субъекта-службы

Другой подход заключается в добавлении URI для перенаправления [субъекты-службы](app-objects-and-service-principals.md#application-and-service-principal-relationship) , представляющие регистрации приложения любого клиента Azure AD. Этот подход можно использовать, когда нельзя использовать параметр состояния или вашего сценария необходимо добавить новый URI перенаправления для регистрации приложения для каждого нового клиента, которые вы поддерживаете. 

## <a name="next-steps"></a>Дальнейшие действия

- Дополнительные сведения о [манифест приложения](reference-app-manifest.md)
