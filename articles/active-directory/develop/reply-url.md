---
title: Перенаправить URI & ограничения URL-адреса - платформа идентификации Майкрософт (ru) Azure
description: Ответ URL-адреса / перенаправить ограничения URls & ограничения
author: SureshJa
ms.author: sureshja
manager: CelesteDG
ms.date: 06/29/2019
ms.topic: conceptual
ms.subservice: develop
ms.custom: aaddev
ms.service: active-directory
ms.reviewer: lenalepa, manrath
ms.openlocfilehash: 8fdc64632be8b5fcb3dca8de2ee833fef25719fe
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "77656744"
---
# <a name="redirect-urireply-url-restrictions-and-limitations"></a>Ограничения для универсального кода ресурса (URI) перенаправления и URL-адреса ответа

Перенаправление URI, или URL-адреса ответа, — это место, куда сервер авторизации отправит пользователя после успешного авторизации приложения и предоставит код авторизации или токен доступа. Код или токен содержится в перенаправлении URI или токене ответа, поэтому важно зарегистрировать правильное местоположение в процессе регистрации приложения.

 Следующие ограничения применяются для ответа URL-адресов:

    * URL-адрес ответа должен `https`начинаться со схемы.
    * URL-адрес ответа является чувствительным к случаям. Его случай должен соответствовать случаю пути URL-адреса вашего запущенного приложения. Например, если приложение включает в `.../abc/response-oidc`себя как `.../ABC/response-oidc` часть своего пути, не укажите в URL-адресе ответа. Поскольку веб-браузер рассматривает пути как чувствительные к `.../abc/response-oidc` случаям, файлы cookie, связанные с ними, могут быть исключены, если они перенаправлены на несовпадаемый `.../ABC/response-oidc` URL-адрес.
    
## <a name="maximum-number-of-redirect-uris"></a>Максимальное количество перенаправить URIs

В следующей таблице отображается максимальное количество URL-изуми, которое можно добавить при регистрации приложения.

| Счета, вписаемые в | Максимальное количество перенаправить URIs | Описание |
|--------------------------|---------------------------------|-------------|
| Учетные записи работы или школ корпорации Майкрософт в резолютивном каталоге Azure (Azure AD) любой организации | 256 | `signInAudience`поле в манифесте приложения установлено либо на *AzureADMyOrg,* либо *на AzureADMultipleOrgs* |
| Личные учетные записи Майкрософт и рабочие и школьные учетные записи | 100 | `signInAudience`поле в манифесте приложения установлено на *AzureADandPersonalMicrosoftAccount* |

## <a name="maximum-uri-length"></a>Максимальная длина URI

Вы можете использовать максимум 256 символов для каждого перенаправления URI, которые вы добавляете к регистрации приложения.

## <a name="supported-schemes"></a>Поддерживаемые схемы
Модель приложения Azure AD сегодня поддерживает как схемы HTTP, так и HTTPS для приложений, которые регистрались в учетных записях работы майкрософт или в школе в любом арендаторе Active Directory (Azure AD) любой организации. То `signInAudience` есть поле в манифесте приложения устанавливается либо на *AzureADMyOrg,* либо *на AzureADMultipleOrgs.* Для приложений, которые подписывают в личных учетных `signInAudience` записей Microsoft и работы и школьных учетных записей (который установлен на *AzureADandPersonalMicrosoftAccount*) только httpS схема допускается.

> [!NOTE]
> Новый опыт [регистрации приложений](https://go.microsoft.com/fwlink/?linkid=2083908) не позволяет разработчикам добавлять URI со схемой HTTP на uI. Добавление HTTP URI для приложений, вкоторыехавших учетные записи в рабочие или школьные, поддерживается только через редактор манифеста приложения. В будущем новые приложения не смогут использовать схемы HTTP в перенаправлении URI. Тем не менее, старые приложения, содержащие схемы HTTP в перенаправить URIs будет продолжать работать. Разработчики должны использовать схемы HTTPS в перенаправлении URI.

## <a name="restrictions-using-a-wildcard-in-uris"></a>Ограничения с использованием подстановочного знака в URIs

Уайлдкард URIs, такие как, `https://*.contoso.com`удобны, но следует избегать. Использование подстановочных знаков в перенаправлении URI имеет последствия для безопасности. В соответствии с спецификацией OAuth 2.0[(раздел 3.1.2 RFC 6749),](https://tools.ietf.org/html/rfc6749#section-3.1.2)конечная точка перенаправления URI должна быть абсолютной URI. 

Модель приложения Azure AD не поддерживает URIs подстановочных знаков для приложений, которые настроены для регистрации в личных учетных записях Майкрософт и рабочих или школьных учетных записей. Тем не менее, URIs подстановочных знаков разрешены для приложений, настроенных для ввода в рабочие или школьные учетные записи в ат-арендаторе Azure AD организации сегодня. 
 
> [!NOTE]
> Новый опыт [регистрации приложений](https://go.microsoft.com/fwlink/?linkid=2083908) не позволяет разработчикам добавлять URI подстановочных знаков на uI. Добавление wilcard URI для приложений, которые вписываются в рабочие или школьные учетные записи, поддерживается только через редактор манифеста приложения. Заглядывая вперед, новые приложения не смогут использовать подстановочные знаки в перенаправлении URI. Тем не менее, старые приложения, содержащие подстановочные знаки в перенаправление URI, будут продолжать работать.

Если сценарий требует больше перенаправления URIs, чем максимальный допустимый предел, вместо добавления подстановочного знака перенаправить URI, рассмотрим следующий подход.

### <a name="use-a-state-parameter"></a>Использование параметра состояния

Если у вас есть несколько поддоменов, и если ваш сценарий требует перенаправить пользователей после успешной проверки подлинности на ту же страницу, где они начали, использование параметра состояния может быть полезным. 

При таком подходе:

1. Создайте «общий» перенаправление URI в приложение для обработки токенов безопасности, которые вы получаете из точки авторизации.
1. Приложение может отправлять параметры, к онниму щие по конкретным приложениям (например, URL-адрес, где возник пользователь, или что-либо вроде информации о брендинге) в параметре состояния. При использовании параметра состояния остерегаться защиты CSRF, указанной в [разделе 10.12 RFC 6749](https://tools.ietf.org/html/rfc6749#section-10.12)). 
1. Параметры приложения будут включать всю информацию, необходимую для того, чтобы приложение сделало правильный опыт для пользователя, то есть построить соответствующее состояние приложения. Конечная точка авторизации Azure AD удаляет HTML из параметра состояния, поэтому убедитесь, что вы не передаете HTML-контент в этом параметре.
1. Когда Azure AD отправляет ответ на «общий» перенаправление URI, он отправит параметр состояния обратно в приложение.
1. Затем приложение может использовать значение в параметре состояния, чтобы определить, к какому URL -12- для дальнейшей отправки пользователя. Убедитесь, что вы проверяете для защиты CSRF.

> [!NOTE]
> Такой подход позволяет скомпрометированному клиенту изменять дополнительные параметры, отправленные в параметр состояния, тем самым перенаправляя пользователя на другой URL, который является [открытой угрозой редиректора,](https://tools.ietf.org/html/rfc6819#section-4.2.4) описанной в RFC 6819. Таким образом, клиент должен защитить эти параметры, шифруя состояние или проверяя его какими-либо другими средствами, такими как проверка доменного имени в перенаправлении URI против токена.

## <a name="next-steps"></a>Дальнейшие действия

- Узнайте о [манифесте Приложения](reference-app-manifest.md)
