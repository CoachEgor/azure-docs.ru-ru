---
title: Azure Active Directory. Справочные материалы о критических изменениях | Документация Майкрософт
description: Дополнительные сведения об изменениях, внесенных в протоколы Azure AD, которые могут повлиять на приложение.
services: active-directory
documentationcenter: ''
author: CelesteDG
manager: mtillman
editor: ''
ms.assetid: 68517c83-1279-4cc7-a7c1-c7ccc3dbe146
ms.service: active-directory
ms.subservice: develop
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 10/02/2018
ms.author: celested
ms.reviewer: hirsin
ms.custom: aaddev
ms.collection: M365-identity-device-management
ms.openlocfilehash: 2fcc400f952cc89f5fb4bf6e8d6f0f331483868e
ms.sourcegitcommit: 3102f886aa962842303c8753fe8fa5324a52834a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "60298280"
---
# <a name="whats-new-for-authentication"></a>Новые возможности для проверки подлинности. 

>Получайте уведомления об обновлениях этой страницы. Добавьте [этот URL-адрес](https://docs.microsoft.com/api/search/rss?search=%22whats%20new%20for%20authentication%22&locale=en-us) своему читателю RSS-канала.

Система проверки подлинности изменяет и добавляет функции на постоянной основе для безопасности и соответствия стандартам. Чтобы вы оставались в курсе последних разработок, в этой статье предоставлены такие сведения:

- Новые возможности
- Известные проблемы
- Изменения протокола
- Нерекомендуемые функции.

> [!TIP] 
> Эта страница обновляется регулярно, поэтому нужно часто пересматривать ее. Если иное не указано, эти изменения вводятся только для приложений, зарегистрированных после вступления в силу соответствующих изменений.  

## <a name="upcoming-changes"></a>Предстоящие изменения

Пока не запланировано. 

## <a name="march-2019"></a>Марта 2019 г.

### <a name="looping-clients-will-be-interrupted"></a>Циклы клиентов будет прервано

**Дата вступления в силу**: 25 марта 2019 г.

**Затронутые конечные точки**: версии 1.0 и 2.0.

**Затронутый протокол**: Все потоки

Клиентские приложения могут иногда проблемное, выдачи сотни же запрос на вход за короткий период времени.  Эти запросы могут или не может быть выполнен успешно, но все они включаются плохое впечатление на пользователей и повышенную рабочих нагрузок для поставщика Удостоверений, увеличение задержки для всех пользователей и снижая доступности поставщика удостоверений.  Эти приложения работают за пределами границ обычного использования и необходимо обновить, чтобы работало правильно.  

Клиенты, которые создают несколько раз повторяющиеся запросы будут отправляться `invalid_grant` ошибка: `AADSTS50196: The server terminated an operation because it encountered a loop while processing a request`. 

Большинство клиентов не требуется изменить поведение, чтобы избежать этой ошибки.  Эта ошибка может оказать влияние только неправильно настроенные клиенты (без кэширования маркеров или действия уже обнаружены подсказки циклов).  Клиенты, отслеживаются для каждого экземпляра локально (через файл cookie) на следующие факторы:

* Указание пользователя, если таковые имеются

* Области или запрашиваемого ресурса

* Идентификатор клиента

* URI перенаправления

* Тип ответа и режим

Выполнения нескольких запросов (15 +) за короткий период времени (5 минут) приложения будут получать `invalid_grant` об ошибке, поясняющее, что они цикла.  Маркеры, запрашиваемого содержать достаточно продолжительного времени существования (минимум 10 минут, по умолчанию — 60 минут), повторяющиеся таким образом запросы за этот период времени, не нужны.  

Все приложения должны обрабатывать `invalid_grant` , показывающий интерактивное приглашение, вместо автоматически запросе маркера.  Чтобы избежать этой ошибки, клиенты должны убедитесь, что они правильно кэшируется токены, полученные.


## <a name="october-2018"></a>Октябрь 2018 г.

### <a name="authorization-codes-can-no-longer-be-reused"></a>Коды авторизации больше нельзя использовать повторно

**Дата вступления в силу**: 15 ноября 2018 г.

**Затронутые конечные точки**: версии 1.0 и 2.0.

**Затронутый протокол**: [поток кода](v2-oauth2-auth-code-flow.md).

С 15 ноября 2018 г. в Azure AD прекращается поддержка использованных кодов аутентификации для приложений. Это изменение системы безопасности помогает Azure AD соответствовать спецификации OAuth и будет применяться для конечных точек версии 1 и 2.

Если ваше приложение повторно использует коды проверки подлинности для получения маркеров для нескольких ресурсов, мы рекомендуем использовать код для получения маркера обновления, а затем использовать этот маркер для получения дополнительных маркеров для других ресурсов. Коды проверки подлинности можно использовать только один раз, однако маркеры обновления можно использовать несколько раз для нескольких ресурсов. Любое новое приложение, которое пытается повторно использовать код проверки подлинности во время потока кода OAuth, получит ошибку invalid_grant.

Дополнительные сведения о маркерах обновления см. в статье [Обновление маркеров доступа](v1-protocols-oauth-code.md#refreshing-the-access-tokens).  При использовании ADAL или MSAL обработку выполняет библиотека — замените второй экземпляр AcquireTokenByAuthorizationCodeAsync на AcquireTokenSilentAsync. 

## <a name="may-2018"></a>Май 2018 г.

### <a name="id-tokens-cannot-be-used-for-the-obo-flow"></a>Для потока OBO нельзя использовать маркеры идентификации

**Дата**. 1 мая 2018 г.

**Затронутые конечные точки**: версии 1.0 и 2.0.

**Затронутые протоколы**: неявный поток и [поток OBO](v1-oauth2-on-behalf-of-flow.md)/

Начиная с 1 мая 2018 г. новые приложения не могут использовать маркеры id_token в качестве утверждения в потоке OBO. Вместо этого следует использовать маркеры доступа для защиты API, даже между клиентом и средним уровнем того же приложения. Приложения, зарегистрированные до 1 мая 2018 г., будут дальше работать с возможностью замены маркеров id_token на маркеры доступа, но это нерекомендуемый подход.

Чтобы обойти это изменение, можно сделать следующее.

1. Создайте веб-API для своего приложения с одной или несколькими областями. Такая явная точка входа позволит обеспечить более точный контроль и защиту.
1. В манифесте вашего приложения, на [портале Azure](https://portal.azure.com) или [портале регистрации приложений](https://apps.dev.microsoft.com), убедитесь, что приложению разрешено выдавать маркеры доступа через неявный поток. Это определяется с помощью ключа `oauth2AllowImplicitFlow`.
1. Когда ваше клиентское приложение запрашивает id_token через `response_type=id_token`, оно также запрашивает маркер доступа (`response_type=token`) для веб-API, созданного выше. Таким образом при использовании конечной точки версии 2.0 параметр `scope` должен выглядеть примерно так: `api://GUID/SCOPE`. В конечной точке версии 1.0 параметр `resource` должен быть универсальным кодом ресурса (URI) приложения веб-API.
1. Передайте этот маркер доступа на средний уровень вместо id_token.  
