---
title: Конфигурация приложения клиента (библиотека проверки подлинности Майкрософт) | Azure
description: Узнайте о параметрах конфигурации для общедоступного клиента и конфиденциального клиента приложения в библиотеки аутентификации Майкрософт (MSAL).
services: active-directory
documentationcenter: dev-center-name
author: rwike77
manager: celested
editor: ''
ms.service: active-directory
ms.subservice: develop
ms.devlang: na
ms.topic: conceptual
ms.tgt_pltfrm: na
ms.workload: identity
ms.date: 04/12/2019
ms.author: ryanwi
ms.reviewer: saeeda
ms.custom: aaddev
ms.collection: M365-identity-device-management
ms.openlocfilehash: 3a48eea9fedd2d82f44693d58b31ee0d5c8c288d
ms.sourcegitcommit: f6ba5c5a4b1ec4e35c41a4e799fb669ad5099522
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/06/2019
ms.locfileid: "65138538"
---
# <a name="application-configuration-options"></a>Параметры настройки приложения

В коде инициализации новых общедоступных или конфиденциальных клиентов (или агент пользователя для MSAL.js) приложение для проверки подлинности и получения маркеров.  Существует несколько вариантов конфигурации, которые могут устанавливаться при инициализации клиентского приложения в MSAL. Эти параметры можно разделить на две группы:

- Параметры регистрации, включая:
    - [Центр](#authority) (состоящий из поставщика удостоверений [экземпляр](#cloud-instance) и входа в систему [аудитории](#application-audience) для приложения и, возможно, идентификатор клиента).
    - [Идентификатор клиента](#client-id)
    - [URI перенаправления](#redirect-uri)
    - [секрет клиента](#client-secret) (для приложений конфиденциальный клиент).
- [Параметры ведения журнала](#logging), включая уровень ведения журнала, управления персональных данных и имя компонента, с помощью библиотеки.

## <a name="authority"></a>Authority
Администратор не, указывающее каталог, MSAL может запрашивать маркеры из URL-адрес. Обычные центры являются:

- https://login.microsoftonline.com/&lt; клиента&gt;/, где &lt;клиента&gt; — это идентификатор клиента в клиенте Azure AD или домен, связанный с этим клиентом Azure AD.  Используется только для входа пользователей из определенной организации.
- https://login.microsoftonline.com/common/. Используется для входа в систему с помощью рабочих и учебных учетных записей или личной учетной записи Майкрософт.
- https://login.microsoftonline.com/organizations/. Используется для входа в систему с помощью рабочих и учебных учетных записей.
- https://login.microsoftonline.com/consumers/. Используется для входа в систему с помощью только личную учетную запись Майкрософт (live).

Параметр центра должны быть согласованы с что объявлен на портале регистрации приложений.

URL-адрес центра состоит из экземпляра и аудитории.

Это может быть:
- Центр облачных Azure Active directory
- Центр Azure AD B2C. См. в разделе [особенности B2C](https://github.com/AzureAD/microsoft-authentication-library-for-dotnet/wiki/AAD-B2C-specifics).
- центр служб федерации Active Directory. См. в разделе [служб федерации Active Directory поддерживают](https://aka.ms/msal-net-adfs-support).

Azure AD облачных центров состоят из двух частей:
- Поставщик удостоверений **экземпляра**
- вход **аудитории** для приложения

Экземпляр и аудитории можно объединяются и предоставить как URL-адрес центра. В версии MSAL.NET до MSAL 3.x, приходилось compose полномочия самостоятельно в зависимости от облака, чтобы целевой объект и аудитории входа в систему.  На следующей схеме показано, как URL-адрес центра состоит.

![Authority](media/msal-client-application-configuration/authority.png)

## <a name="cloud-instance"></a>Экземпляр облака
**Экземпляр** используется для указания того, если приложение входит пользователей из общедоступного облака Microsoft Azure или национальным облакам. В коде с помощью MSAL, экземпляр облака Azure можно задать с помощью перечисления или путем передачи URL-адрес [национального облачного экземпляра](authentication-national-cloud.md#azure-ad-authentication-endpoints) как `Instance` элемента (если известно).

MSAL.NET вызовет явное исключение, если оба `Instance` и `AzureCloudInstance` указаны. 

Если не указать экземпляр, общедоступное облако Azure экземпляр будет работать ваше приложение (URL-адрес экземпляра `https://login.onmicrosoftonline.com`).

## <a name="application-audience"></a>Аудитории приложения

Аудитория входа зависит от бизнес-потребностей для вашего приложения:
- При наличии строки бизнес-разработчиков, скорее всего будет создавать однотенантного приложения, который будет использоваться только в вашей организации. В этом случае необходимо указать, что такой подход аналогичен, либо по Идентификатору клиента (идентификатор Azure Active Directory) или имя домена, связанное с этом Azure Active Directory.
- Если вы являетесь независимым поставщиком по, вы можете выполнять вход пользователей с помощью рабочих и учебных учетных записей в любой организации, или некоторые организации (мультитенантное приложение), но также может потребоваться наличие пользователям вход с личной учетной записи Майкрософт.

### <a name="how-to-specify-the-audience-in-your-codeconfiguration"></a>Как задать целевой аудитории в коде или конфигурации
С помощью MSAL в коде, можно указать целевой аудитории с помощью:
- либо Azure AD authority аудитории перечисление. 
- или идентификатор клиента, который может быть:
  - GUID (идентификатор Azure Active Directory) для приложений с одним клиентом
  - имя домена, связанное с Azure Active Directory (также для приложений с одним клиентом)
- или один из этих заполнителей в виде идентификатора клиента вместо перечисления аудитории центра Azure AD:
    - `organizations` для приложения с несколькими клиента
    - `consumers` для входа в систему только с помощью своих личных учетных записях
    - `common` для входа в систему с помощью свою рабочую и учебную учетную запись или личной учетной записи Майкрософт

MSAL вызовет значимое исключение, если указать аудитории центра Azure AD и идентификатор клиента. 

Если вы не укажете аудитория будет работать ваше приложение Azure AD и личные учетные записи Майкрософт, как аудитории (то есть `common`).

### <a name="effective-audience"></a>Действующие аудитории
Действующие аудитории для приложения будет минимальным (если есть пересечение) аудитории, заданные в приложении и аудитории, указанные при регистрации приложения. Действительно, процесс регистрации приложения ([регистрации приложения](https://aka.ms/appregistrations)) позволяет указать целевой аудитории (типов поддерживаемых учетных записей) для приложения. См. [Краткое руководство. Регистрация приложения в платформе Microsoft identity](quickstart-register-app.md) Дополнительные сведения.

В настоящее время единственный способ получить приложение для входа в систему с помощью только личные учетные записи Майкрософт является установка:
- Задайте аудитории регистрации приложения в «Рабочих и учебных учетных записей и личные учетные записи» и
- и установите аудитории в коде или конфигурации для `AadAuthorityAudience.PersonalMicrosoftAccount` (или `TenantID `= «пользователи»)

## <a name="client-id"></a>Идентификатор клиента
Идентификатор уникальное приложение (клиент), назначенный вашему приложению с помощью Azure AD при регистрации приложения.

## <a name="redirect-uri"></a>URI перенаправления
URI перенаправления — это URI, которому поставщик удостоверений будет отправлять обратно на маркеры безопасности. 

### <a name="redirect-uri-for-public-client-applications"></a>URI перенаправления для общедоступных клиентских приложений
Для разработчиков приложений общедоступного клиента с помощью MSAL:
- Не нужно передавать ``RedirectUri`` как оно автоматически вычисляется с помощью MSAL. Это перенаправление URI настроена на следующих значений в зависимости от платформы.

- ``urn:ietf:wg:oauth:2.0:oob`` для всех платформ Windows
- ``msal{ClientId}://auth`` для iOS и Xamarin Android

Однако перенаправления URI должен быть настроен в [регистрации приложения](https://aka.ms/appregistrations).

![URI перенаправления на портале](media/msal-client-application-configuration/redirect-uri.png)

Можно переопределить в URI перенаправления с помощью `RedirectUri` свойство, например при использовании брокеров. Ниже приведены некоторые примеры URI перенаправления, в этом случае.

- `RedirectUriOnAndroid` = "msauth-5a434691-ccb2-4fd1-b97b-b64bcfbc03fc://com.microsoft.identity.client.sample";
- `RedirectUriOnIos` = $«msauth. {Bundle.ID}://auth»;

Дополнительные сведения см. особенности Android и [особенности iOS](https://github.com/AzureAD/microsoft-authentication-library-for-dotnet/wiki/Leveraging-the-broker-on-iOS)

### <a name="redirect-uri-for-confidential-client-applications"></a>URI перенаправления для конфиденциального клиента приложения
Для веб-приложений redirect URI (или URI ответа), — это URI, по которому Azure AD будет связаться с обратно приложение с маркером. Это может быть URL-адрес веб-приложения или веб-API, если конфиденциальные имеет одно из следующих.  Этот URI перенаправления должен быть зарегистрирован в регистрации приложения. Это особенно важно при развертывании приложения, изначально проверенного локально. Затем необходимо добавить URL-адрес ответа развернутого приложения на портале регистрации приложений.

Для приложений управляющей программы не нужно указать URI перенаправления.

## <a name="client-secret"></a>Секрет клиента
Секрет клиента для конфиденциального клиентского приложения. Этот секрет (пароль приложения), предоставляемые на портал регистрации приложений, или будет Azure AD во время регистрации приложения с PowerShell AzureAD, PowerShell AzureRM или интерфейса командной строки Azure.

## <a name="logging"></a>Ведение журналов
Другие параметры включить ведение журнала и устранение неполадок. Дополнительные сведения см. в разделе [ведение журнала](msal-logging.md) получить дополнительные сведения о том, как их использовать.

## <a name="next-steps"></a>Дальнейшие действия
Дополнительные сведения о [создания клиентских приложений с помощью MSAL.NET](msal-net-initializing-client-applications.md).

Дополнительные сведения о [создания клиентских приложений, использующих MSAL.js](msal-js-initializing-client-applications.md).
