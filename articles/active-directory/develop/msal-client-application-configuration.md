---
title: Конфигурация приложения клиента (библиотека проверки подлинности Майкрософт) | Azure
description: Узнайте о параметрах конфигурации для общедоступного клиента и конфиденциального клиента приложения в библиотеки аутентификации Майкрософт (MSAL).
services: active-directory
documentationcenter: dev-center-name
author: rwike77
manager: CelesteDG
editor: ''
ms.service: active-directory
ms.subservice: develop
ms.devlang: na
ms.topic: conceptual
ms.tgt_pltfrm: na
ms.workload: identity
ms.date: 04/12/2019
ms.author: ryanwi
ms.reviewer: saeeda
ms.custom: aaddev
ms.collection: M365-identity-device-management
ms.openlocfilehash: b5e175a8cdd1622add90bd80df63303fe914ab9c
ms.sourcegitcommit: 087ee51483b7180f9e897431e83f37b08ec890ae
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/31/2019
ms.locfileid: "66430807"
---
# <a name="application-configuration-options"></a>Параметры настройки приложения

В коде инициализации новых общедоступных или конфиденциальных клиентов (или агент пользователя для MSAL.js) приложение для проверки подлинности и получения маркеров. Можно задать несколько вариантов конфигурации, при инициализации клиентского приложения в библиотеки аутентификации Майкрософт (MSAL). Эти параметры делятся на две группы:

- Параметры регистрации, включая:
    - [Центр](#authority) (состоящий из поставщика удостоверений [экземпляр](#cloud-instance) и входа в систему [аудитории](#application-audience) для приложения и, возможно, идентификатор клиента).
    - [Идентификатор клиента](#client-id).
    - [URI перенаправления](#redirect-uri).
    - [секрет клиента](#client-secret) (для приложений конфиденциальный клиент).
- [Параметры ведения журнала](#logging), включая уровень ведения журнала, управления персональных данных и имя компонента, с помощью библиотеки.

## <a name="authority"></a>Authority
Администратор не указывает каталог, MSAL может запрашивать маркеры из URL-адрес. Распространенные центры являются:

- https://login.microsoftonline.com/&lt; клиента&gt;/, где &lt;клиента&gt; — это идентификатор клиента Azure Active Directory (Azure AD) клиент или домен, связанный с этим клиентом Azure AD. Используется только для входа пользователей из определенной организации.
- https://login.microsoftonline.com/common/. Используется для входа в систему с помощью рабочих и учебных учетных записей или личных учетных записей Майкрософт.
- https://login.microsoftonline.com/organizations/. Используется для входа в систему с помощью рабочих и учебных учетных записей.
- https://login.microsoftonline.com/consumers/. Используется для входа в систему с помощью только личных учетных записей Майкрософт (ранее известные как учетные записи Windows Live ID).

Параметр центра должна быть согласована с что объявлен на портале регистрации приложений.

URL-адрес центра состоит из экземпляра и аудитории.

Это может быть:
- Облако центр сертификации Azure AD.
- Центр Azure AD B2C. См. в разделе [особенности B2C](https://github.com/AzureAD/microsoft-authentication-library-for-dotnet/wiki/AAD-B2C-specifics).
- Центр служб федерации Active Directory (ADFS). См. в разделе [служб федерации Active Directory поддерживают](https://aka.ms/msal-net-adfs-support).

Azure AD облачных центров состоят из двух частей:
- Поставщик удостоверений *экземпляра*
- Вход *аудитории* для приложения

Экземпляр и аудитории можно объединяются и предоставить как URL-адрес центра. В версии MSAL.NET, более ранних, чем MSAL 3. *x*, приходилось самостоятельно compose полномочия, зависимости в облаке, вы хотите получать целевых и аудитории входа в систему.  На этой схеме показано, как URL-адрес центра состоит:

![Как состоит URL-адрес центра](media/msal-client-application-configuration/authority.png)

## <a name="cloud-instance"></a>Экземпляр облака
*Экземпляр* используется для указания того, если приложение входит пользователей из общедоступного облака Azure или национальным облакам. С помощью MSAL в коде, можно задать экземпляр облака Azure с помощью перечисления или путем передачи URL-адрес [национального облачного экземпляра](authentication-national-cloud.md#azure-ad-authentication-endpoints) как `Instance` элемента (если известно).

MSAL.NET вызовет явное исключение, если оба `Instance` и `AzureCloudInstance` указаны.

Если не указать экземпляр, общедоступное облако Azure экземпляр будет работать ваше приложение (URL-адрес экземпляра `https://login.onmicrosoftonline.com`).

## <a name="application-audience"></a>Аудитории приложения

Аудитория входа зависит от бизнес-потребностей для вашего приложения:
- Если вы строку бизнес-разработчиков, будет, скорее всего, создавать приложения одним клиентом, который будет использоваться только в вашей организации. В этом случае необходимо указать в организации, либо по Идентификатору клиента (идентификатор экземпляра Azure AD), либо с помощью доменного имени, связанного с экземпляром Azure AD.
- Если вы являетесь независимым поставщиком по, может потребоваться войти в систему с помощью их рабочих и учебных учетных записей в любой организации или в некоторых организациях (мультитенантное приложение). Но вы также захотите пользователям вход с помощью своих личных учетных записей Майкрософт.

### <a name="how-to-specify-the-audience-in-your-codeconfiguration"></a>Как задать целевой аудитории в коде или конфигурации
С помощью MSAL в коде, можно указать целевой аудитории с помощью одного из следующих значений:
- Перечисление аудитории центра Azure AD
- Идентификатор клиента, который может быть:
  - Идентификатор GUID (идентификатор экземпляра Azure AD), для приложений с одним клиентом
  - Имя домена, связанное с имеющимся экземпляром Azure AD (а также для приложений с одним клиентом)
- Один из этих заполнителей в виде идентификатора клиента вместо перечисления аудитории центра Azure AD:
    - `organizations` для мультитенантного приложения
    - `consumers` для входа в систему только с помощью своих личных учетных записях
    - `common` для входа в систему с помощью их рабочих и учебных учетных записей или их личных учетных записей Майкрософт

MSAL вызовет значимое исключение, если указать аудитории центра Azure AD и идентификатор клиента.

Если вы не укажете аудитории, будет работать ваше приложение Azure AD и личные учетные записи Майкрософт в качестве аудитории. (То есть он должен вести себя так, как будто `common` были указаны.)

### <a name="effective-audience"></a>Действующие аудитории
Действующие аудитории для приложения будет минимальным (если есть пересечение) целевой аудитории так, установите в приложении и аудитории, который указан в регистрации приложения. На самом деле [регистрация приложений](https://aka.ms/appregistrations) позволяет указать аудитории (типы поддерживаемых учетной записи) для приложения. Дополнительные сведения см. в разделе [ Регистрация приложения в платформе Microsoft identity](quickstart-register-app.md).

В настоящее время единственный способ получить приложение для входа в систему с помощью только личных учетных записей Майкрософт является настройка оба параметра:
- Значение аудитории регистрации приложения `Work and school accounts and personal accounts`.
- Задать в коде или конфигурации для аудитории `AadAuthorityAudience.PersonalMicrosoftAccount` (или `TenantID` = «пользователи»).

## <a name="client-id"></a>Идентификатор клиента
Идентификатор клиента — идентификатор уникальное приложение (клиент), назначенный вашему приложению с помощью Azure AD при регистрации приложения.

## <a name="redirect-uri"></a>URI перенаправления
Этот URI — URI, поставщик удостоверений будет отправлять обратно на маркеры безопасности.

### <a name="redirect-uri-for-public-client-apps"></a>URI перенаправления для общедоступных клиентских приложений
Если вы разработчик приложения общедоступный клиент, использующий MSAL:
- Не нужно передавать `RedirectUri` так, как оно автоматически вычисляется с помощью MSAL. Это перенаправление URI задано одно из следующих значений, в зависимости от платформы:
   - `urn:ietf:wg:oauth:2.0:oob` для всех платформ Windows
   - `msal{ClientId}://auth` для iOS и Xamarin Android

- Вам нужно настроить перенаправления URI в [регистрация приложений](https://aka.ms/appregistrations):

   ![URI перенаправления в регистрация приложений](media/msal-client-application-configuration/redirect-uri.png)

URI перенаправления можно переопределить с помощью `RedirectUri` свойства (например, если вы используете брокеров). Ниже приведены некоторые примеры URI перенаправления для этого сценария.

- `RedirectUriOnAndroid` = "msauth-5a434691-ccb2-4fd1-b97b-b64bcfbc03fc://com.microsoft.identity.client.sample";
- `RedirectUriOnIos` = $«msauth. {Bundle.ID}://auth»;

Дополнительные сведения см. в разделе [документации для iOS и Android](https://github.com/AzureAD/microsoft-authentication-library-for-dotnet/wiki/Leveraging-the-broker-on-iOS).

### <a name="redirect-uri-for-confidential-client-apps"></a>URI перенаправления для приложения конфиденциального клиента
Для веб-приложения URI перенаправления (или URI ответа) является URI, который будет использоваться для отправки маркера в приложение Azure AD. Это может быть URL-адрес web app/веб-API, если конфиденциальные приложений имеет одно из следующих. Должен быть зарегистрирован в регистрации приложения URI перенаправления. Эта регистрация особенно важна при развертывании приложения, изначально Протестированное локально. Затем необходимо добавить URL-адрес ответа приложения на портале регистрации приложений.

Для приложений управляющей программы не нужно указать URI перенаправления.

## <a name="client-secret"></a>Секрет клиента
Этот параметр указывает секрет клиента для конфиденциального клиентского приложения. Этот секрет (пароль приложения) или будет доступно, предоставляемые на портале регистрации приложения в Azure AD во время регистрации приложения с PowerShell AzureAD, PowerShell AzureRM или интерфейса командной строки Azure.

## <a name="logging"></a>Ведение журналов
Другие параметры конфигурации, включите ведение журнала и устранения неполадок. См. в разделе [ведение журнала](msal-logging.md) статьи приведены сведения о том, как их использовать.

## <a name="next-steps"></a>Дальнейшие действия
Дополнительные сведения о [создания клиентских приложений с помощью MSAL.NET](msal-net-initializing-client-applications.md).

Дополнительные сведения о [создания клиентских приложений с помощью MSAL.js](msal-js-initializing-client-applications.md).
