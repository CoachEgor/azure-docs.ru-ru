---
title: Платформа предоставления согласия Azure Active Directory
description: Сведения о платформе предоставления согласия Azure Active Directory и о том, как с ее помощью легко разрабатывать мультитенантные веб-приложения и собственные клиентские приложения.
services: active-directory
documentationcenter: ''
author: rwike77
manager: CelesteDG
editor: ''
ms.service: active-directory
ms.subservice: develop
ms.devlang: na
ms.topic: conceptual
ms.tgt_pltfrm: na
ms.workload: identity
ms.date: 11/30/2018
ms.author: ryanwi
ms.reviewer: zachowd, lenalepa, jesakowi
ms.custom: aaddev
ms.collection: M365-identity-device-management
ms.openlocfilehash: 2edbf5548f5e230986f0a1786d67fb4580e574e2
ms.sourcegitcommit: 509e1583c3a3dde34c8090d2149d255cb92fe991
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/27/2019
ms.locfileid: "66235444"
---
# <a name="azure-active-directory-consent-framework"></a>Платформа предоставления согласия Azure Active Directory

Платформа предоставления согласия Azure Active Directory (Azure AD) упрощает разработку мультитенантных веб-приложений и собственных клиентских приложений. Эти приложения позволяют входить в учетные записи пользователей с клиентов Azure AD, отличных от тех, где было зарегистрировано приложение. Им также может потребоваться доступ к веб-API, таким как API Microsoft Graph (для доступа к Azure AD, Intune и службам Office 365), и другим API-интерфейсам служб Майкрософт.

Эта платформа использует согласие пользователя или администратора на регистрацию приложения в своем каталоге, что может включать в себя доступ к данным каталога. Например, если приложению веб-клиента необходимо прочитать сведения календаря о пользователе Office 365, сначала этот пользователь должен дать согласие на использование клиентского приложения. После предоставления такого разрешения клиентское приложение сможет вызывать API Microsoft Graph от имени этого пользователя и пользоваться сведениями календаря по мере необходимости. [API Microsoft Graph](https://developer.microsoft.com/graph) предоставляет доступ к данным в Office 365 (календарям и сообщениям Exchange, сайтам и спискам SharePoint, документам в OneDrive, записным книжкам в OneNote, задачам Планировщика и книгам Excel), а также пользователям и группам Azure AD и другим объектам данных других облачных служб Майкрософт.

Платформа согласия основана на OAuth 2.0 и различных его процедурах, таких как предоставление кода авторизации и учетных данных пользователя, с помощью общедоступных или конфиденциальных клиентов. Благодаря OAuth 2.0 среда Azure AD позволяет создавать различные клиентские приложения, например на телефоне, планшете, сервере или в Интернете, и получать доступ к необходимым ресурсам.

Дополнительные сведения об использовании платформы предоставления согласия с разрешениями на авторизацию OAuth 2.0 см. в статьях [Авторизация доступа к веб-приложениям Azure Active Directory с помощью последовательности предоставления кода OAuth 2.0](v1-protocols-oauth-code.md) и [Сценарии проверки подлинности в Azure AD](authentication-scenarios.md). Дополнительные сведения о получении авторизованного доступа к Office 365 через Microsoft Graph см. в руководстве по [получению маркеров доступа для вызова Microsoft Graph](https://developer.microsoft.com/graph/docs/authorization/auth_overview).

## <a name="consent-experience---an-example"></a>Пример процедуры предоставления согласия

Ниже описывается, как работает процедура предоставления согласия для разработчика приложений и пользователя.

1. Предположим, у вас есть приложение веб-клиента, которому необходимо запросить конкретные разрешения для получения доступа к ресурсу или API. В следующем разделе показано, как выполнить эту настройку, однако фактически портал Azure используется для объявления запросов разрешений во время настройки. Как и другие параметры конфигурации, они становятся частью регистрации Azure AD приложения:

    ![Разрешения для других приложений](./media/consent-framework/permissions.png)

1. Представим себе, что разрешения вашего приложения были обновлены, само приложение запущено, а пользователь собирается воспользоваться им в первый раз. Сначала приложение должно получить код авторизации из конечной точки `/authorize` Azure AD. Код авторизации можно использовать для получения новых маркеров доступа или обновления.

1. Если пользователь еще не выполнил проверку подлинности, конечная точка `/authorize` Azure AD запросит данные пользователя для входа.

    ![Вход пользователя или администратора в Azure AD](./media/quickstart-v1-integrate-apps-with-azure-ad/usersignin.png)

1. После входа Azure AD определяет, требуется ли отобразить этому пользователю страницу согласия. Принятие этого решения основано на том, дал ли этот пользователь (или администратор его организации) свое согласие для приложения. Если согласие еще не было дано, Azure AD запрашивает у пользователя согласие и отображает необходимые для этого разрешения. В диалоговом окне согласия отображается тот же набор разрешений, который совпадает с набором **Делегированные разрешения** на портале Azure.

    ![Процедура использования согласия пользователей](./media/quickstart-v1-integrate-apps-with-azure-ad/consent.png)

1. После того как пользователь дает свое согласие, в ваше приложение возвращается код авторизации, который используется для получения токена доступа и токена обновления. Дополнительные сведения об этом потоке см. в статье о [типе приложения веб-API](web-api.md).

1. Обладая правами администратора, вы можете также согласиться использовать делегированные разрешения приложения от имени всех пользователей в клиенте. Административное согласие предотвращает появление диалогового окна согласия для каждого пользователя в клиенте и может предоставляться на [портале Azure](https://portal.azure.com) пользователями, которым назначена роль администратора. Сведения о том, администраторы каких ролей могут предоставлять делегированные разрешения, см. в статье [Разрешения роли администратора в Azure Active Directory](../users-groups-roles/directory-assign-admin-roles.md).

    **Предоставление согласия на делегированные разрешения приложения**

   1. Перейдите к **разрешения API** странице вашего приложения
   1. Щелкните **предоставления согласия администратора** кнопки.

      ![Предоставление разрешений, на которые требуется явное согласие администратора](./media/consent-framework/grant-consent.png)

   > [!IMPORTANT]
   > Для одностраничных приложений (SPA), использующих ADAL.js, сейчас требуется предоставление явного разрешения с помощью кнопки **Предоставить разрешения**. В противном случае происходит сбой приложения при запросе маркера доступа.

## <a name="next-steps"></a>Дальнейшие действия

* Дополнительные сведения см. в руководстве по [преобразованию приложения в мультитенантное](howto-convert-app-to-be-multi-tenant.md).
* Узнайте подробнее о том, [как согласие поддерживается на уровне протокола OAuth 2.0 во время предоставления кода авторизации.](https://docs.microsoft.com/azure/active-directory/develop/active-directory-protocols-oauth-code#request-an-authorization-code)
