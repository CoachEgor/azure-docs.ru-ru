---
title: Проблемы на Internet Explorer & Microsoft Edge (MSAL.js) Azure
titleSuffix: Microsoft identity platform
description: Узнайте о проблемах, связанных с использованием библиотеки аутентификации Майкрософт для JavaScript (MSAL.js) с помощью браузеров Internet Explorer и Microsoft Edge.
services: active-directory
author: navyasric
manager: CelesteDG
ms.service: active-directory
ms.subservice: develop
ms.topic: troubleshooting
ms.workload: identity
ms.date: 05/16/2019
ms.author: nacanuma
ms.reviewer: saeeda
ms.custom: aaddev
ms.openlocfilehash: 5ae2dee68ec0da8e8a00d4f01583461462bc196c
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/27/2020
ms.locfileid: "76696101"
---
# <a name="known-issues-on-internet-explorer-and-microsoft-edge-browsers-msaljs"></a>Известные проблемы в браузерах Internet Explorer и Microsoft Edge (MSAL.js)

## <a name="issues-due-to-security-zones"></a>Проблемы из-за зон безопасности
У нас было несколько сообщений о проблемах с аутентификацией в IE и Microsoft Edge (с момента обновления *версии браузера Microsoft Edge до 40.15063.0.0*). Мы отслеживаем их и проинформировали команду Microsoft Edge. В то время как Microsoft Edge работает над разрешением, вот описание часто встречающихся проблем и возможных обходных пути, которые могут быть реализованы.

### <a name="cause"></a>Причина
Причина большинства из этих проблем заключается в следующем. Хранилище сеансов и локальное хранилище разделены зонами безопасности в браузере Microsoft Edge. В этой конкретной версии Microsoft Edge при перенаправлении приложения в различные зоны очищается хранилище сеансов и локальное хранилище. В частности, хранилище сеансов очищается в обычной навигации браузера, и как сеанс, так и локальное хранилище очищается в режиме InPrivate браузера. MSAL.js сохраняет определенное состояние в хранилище сеанса и полагается на проверку этого состояния во время потоков проверки подлинности. Когда хранилище сеанса очищается, это состояние теряется и, следовательно, приводит к сломанной опыту.

### <a name="issues"></a>Проблемы

- **Бесконечные циклы перенаправления и перезагрузки страниц во время проверки подлинности.** Когда пользователи входят в приложение на Microsoft Edge, они перенаправляются назад со страницы входа AAD и застревают в бесконечном цикле перенаправления, что приводит к повторной перезагрузке страницы. Обычно это сопровождается `invalid_state` ошибкой в хранилище сеанса.

- **Бесконечные приобретают циклы токенов и ошибку AADSTS50058.** Когда приложение, работая на Microsoft Edge, пытается приобрести токен для ресурса, приложение может застрять в бесконечном цикле вызова токенов приобретения вместе со следующей ошибкой от AAD в сетевом следе:

    `Error :login_required; Error description:AADSTS50058: A silent sign-in request was sent but no user is signed in. The cookies used to represent the user's session were not sent in the request to Azure AD. This can happen if the user is using Internet Explorer or Edge, and the web app sending the silent sign-in request is in different IE security zone than the Azure AD endpoint (login.microsoftonline.com)`

- **Всплывающее окно не закрывается или застревает при использовании входа через Popup для проверки подлинности.** При аутентификации через всплывающее окно в Microsoft Edge или IE (InPrivate), после ввода учетных данных и входа, если несколько доменов в зонах безопасности участвуют в навигации, всплывающее окно не закрывается, потому что MSAL.js теряет ручку всплывающее окно.  

### <a name="update-fix-available-in-msaljs-023"></a>Обновление: Исправление доступно в MSAL.js 0.2.3
Исправления для проблем с перенаправлением цикла проверки подлинности были выпущены в [MSAL.js 0.2.3](https://github.com/AzureAD/microsoft-authentication-library-for-js/releases). Включите `storeAuthStateInCookie` флаг в конфигурации MSAL.js, чтобы воспользоваться этим исправлением. По умолчанию этот флаг установлен на ложный.

Когда `storeAuthStateInCookie` флаг включен, MSAL.js будет использовать файлы cookie браузера для хранения состояния запроса, необходимого для проверки потоков auth.

> [!NOTE]
> Это исправление еще не доступно для оберток msal-angular и msal-angularjs. Это исправление не решает проблему с окнами Popup.

Используйте обходные пути ниже.

#### <a name="other-workarounds"></a>Другие обходные пути
Убедитесь в том, чтобы проверить, что ваша проблема происходит только на конкретной версии браузера Microsoft Edge и работает на других браузерах, прежде чем принимать эти обходные пути.  
1. В качестве первого шага, чтобы обойти эти проблемы, убедитесь, что домен приложения, и любые другие сайты, участвующие в перенаправлениях потока проверки подлинности добавляются в качестве надежных сайтов в настройках безопасности браузера, так что они принадлежат к той же зоне безопасности.
Для этого выполните следующие действия.
    - Открыть **Internet Explorer** и нажмите на **настройки** (значок передачи) в правом верхнем углу
    - Выберите **варианты Интернета**
    - Выберите вкладку **безопасности**
    - В соответствии с опцией **Trusted Sites** нажмите на кнопку **«Сайты»** и добавьте URL-адреса в открывающийся диалоговое окно.

2. Как упоминалось ранее, так как только хранилище сеанса очищается во время обычной навигации, вы можете настроить MSAL.js, чтобы использовать локальное хранилище вместо этого. Это может быть `cacheLocation` установлено в качестве параметра конфигурации при инициализации MSAL.

Обратите внимание, что это не решит проблему для просмотра InPrivate, так как расчищены как сеанс, так и локальное хранилище.

## <a name="issues-due-to-popup-blockers"></a>Проблемы из-за всплывающих блокировщиков

Бывают случаи, когда всплывающие окно блокируется в IE или Microsoft Edge, например, когда во время многофакторной аутентификации происходит второе всплывающее окно. Вы получите оповещение в браузере, чтобы всплывающее окно раз или всегда. Если вы решите, браузер автоматически открывает всплывающее `null` окно и возвращает ручку для него. В результате библиотека не имеет ручки для окна и нет возможности закрыть всплывающее окно. Та же проблема не возникает в Chrome, когда она подсказывает вам разрешить всплывающие окна, поскольку он не открывает автоматически всплывающее окно.

Как **обходной путь,** разработчики должны будут разрешить всплывающие данные в IE и Microsoft Edge, прежде чем они начнут использовать свое приложение, чтобы избежать этой проблемы.

## <a name="next-steps"></a>Дальнейшие действия
Подробнее об [использовании MSAL.js в Internet Explorer](msal-js-use-ie-browser.md).
