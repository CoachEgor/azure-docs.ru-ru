---
title: Веб-браузеров в библиотеку проверки подлинности Майкрософт для .NET | Azure
description: Дополнительные сведения о специальные рекомендации при использовании Xamarin Android с помощью библиотеки проверки подлинности Майкрософт для .NET (MSAL.NET).
services: active-directory
documentationcenter: dev-center-name
author: rwike77
manager: celested
editor: ''
ms.service: active-directory
ms.subservice: develop
ms.devlang: na
ms.topic: conceptual
ms.tgt_pltfrm: na
ms.workload: identity
ms.date: 05/06/2019
ms.author: jmprieur
ms.reviewer: saeeda
ms.custom: aaddev
ms.collection: M365-identity-device-management
ms.openlocfilehash: d4b4c4cd4dbab10a9d4796a8393cc7f479b90cc4
ms.sourcegitcommit: 6f043a4da4454d5cb673377bb6c4ddd0ed30672d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/08/2019
ms.locfileid: "65406765"
---
# <a name="using-web-browsers-in-msalnet"></a>Использование веб-браузеров в MSAL.NET
Веб-обозреватели являются обязательными для интерактивной проверки подлинности. По умолчанию поддерживает MSAL.NET [системы веб-браузере](#system-web-browser-on-xamarinios-and-xamarinandroid) на Xamarin.iOS и [Xamarin.Android](https://github.com/AzureAD/microsoft-authentication-library-for-dotnet/wiki/system-browser). Но [можно также включить Embedded веб-браузере](#enable-embedded-webviews) в зависимости от требований (UX, потребность в единый вход (SSO), безопасность) в [Xamarin.iOS](#choosing-between-embedded-web-browser-or-system-browser-on-xamarinios) и [Xamarin.Android](#choosing-between-embedded-web-browser-or-system-browser-on-xamarinandroid) приложения. И вы даже можете [выберите динамически](#detecting-the-presence-of-custom-tabs-on-xamarinandroid) использовать веб-браузере на основе наличия Chrome или браузер, поддерживающий пользовательские вкладки Chrome в Android.

## <a name="web-browsers-in-msalnet"></a>Веб-браузеров в MSAL.NET

Важно понимать, что при получении маркера в интерактивном режиме, содержимое диалогового окна не предоставляется библиотекой, но службой маркеров безопасности (Security Token Service). Конечную точку проверки подлинности отправляет коды HTML и JavaScript, который контролирует взаимодействие, которое отображается в веб-браузера или веб-элемента управления. Позволяя STS для обработки взаимодействия HTML имеет множество преимуществ:

- Пароль (Если указано одно) никогда не хранит приложения, а также библиотеки проверки подлинности.
- Включает перенаправление в других поставщиков удостоверений (например имя входа в с рабочей учетной записи учебного заведения или личной учетной записи с помощью MSAL, или с учетной записью социальной сети с Azure AD B2C).
- Позволяет управлять условного доступа, например, при наличии пользователя выполните несколько многофакторной идентификации (MFA) на этапе проверки подлинности (Windows Hello ПИН-кода, или при вызове на свой телефон или приложения для проверки подлинности на свой звонок) службы маркеров безопасности. В случаях, где требуется многофакторной проверки подлинности еще не задан его вверх пользователя можно настроить ее на момент времени, в то же диалоговое окно.  Пользователь вводит номер мобильного телефона и интерактивной установки приложения проверки подлинности и сканировать QR тег, чтобы добавить свою учетную запись. Этот сервер на основе взаимодействия является удобной!
- Пользователь может изменить пароль в этом же диалоговом окне при истечении срока действия пароля (предоставляя дополнительные поля для старый пароль и новый пароль).
- Позволяет фирменной символики клиента или приложения (образов) управляет администратор клиента Azure AD или владелец приложения.
- Чтобы пользователи моли приложение получать доступ к ресурсам / областей в названии сразу после проверки подлинности.

## <a name="system-web-browser-on-xamarinios-and-xamarinandroid"></a>Система веб-браузер на Xamarin.iOS и Xamarin.Android

По умолчанию MSAL.NET поддерживает системы веб-браузер на Xamarin.iOS и Xamarin.Android. Для всех платформ, которые предоставляют пользовательский Интерфейс (то есть не .NET Core) предоставляется диалоговое окно библиотеки, встраивание элемента управления браузера. MSAL.NET также использует внедренный веб-представление для настольных систем .NET и WAB для платформы UWP. Тем не менее, при этом используется по умолчанию **системы веб-браузере** Xamarin iOS и Xamarin Android приложений. В iOS, он даже выбирает веб-представление, в зависимости от версии операционной системы (iOS12, iOS11 и более ранних версий).

Использование обозревателя системы имеет значительное преимущество, совместное использование состояния единого входа с другими приложениями и веб-приложений без необходимости брокера (корпоративного портала и проверки подлинности). Система браузер использовался, по умолчанию в MSAL.NET для платформы Xamarin Android Xamarin iOS и так как на этих платформах веб-браузера системы занимает весь экран и взаимодействие с пользователем, тем лучше. Веб-представление системы не отличить от диалоговое окно. На iOS Однако пользователь может потребоваться предоставить согласие для браузера для обратного вызова приложения, который может раздражать.

### <a name="uwp-does-not-use-the-system-webview"></a>UWP не использует System Webview

Для настольных приложений Однако запуск System Webview приводит к недостаточно высокие впечатления, поскольку пользователь видит браузер, где они могут уже иметь другие вкладки открывается. А когда была выполнена проверка подлинности, пользователи получает страницу, задавая им, чтобы закрыть это окно. Если пользователь не обращайте внимания, их можно закрыть весь процесс (включая другие вкладки, которые не связаны с проверки подлинности). Использование обозревателя системы на рабочем столе также потребуется Открытие локальные порты и прослушивание на них, который могут потребоваться дополнительные разрешения для приложения. Вы, как разработчик, пользователь или администратор, может неохотно об этом требовании.

## <a name="enable-embedded-webviews"></a>Включить встроенные веб-представления 
Вы также можете включить встроенные веб-представления в приложениях Xamarin.iOS и Xamarin.Android. Начиная с помощью MSAL.NET 2.0.0-preview MSAL.NET также поддерживает использование **embedded** параметр веб-представления. Для ADAL.NET внедренные webview является единственным параметром поддерживается.

Как разработчик, с помощью MSAL.NET, предназначенные для Xamarin вы можете использовать встроенные веб-представления или браузеры системы. Это ваш выбор, в зависимости от пользователя проблем безопасности и возможности, которыми вы будете работать.

В настоящее время MSAL.NET пока не поддерживает брокеров Android и iOS. Поэтому если необходимо предоставить единый вход (SSO), системный браузер может быть лучшим вариантом. Поддержка брокеров в embedded веб-браузере, — в невыполненной работе MSAL.NET.

### <a name="differences-between-embedded-webview-and-system-browser"></a>Различия между embedded webview и браузера системы 
Существуют некоторые визуальные отличия между embedded webview и системный браузер в MSAL.NET.

**Интерактивного входа в систему с помощью MSAL.NET, с помощью внедренных веб-представления:**

![Embedded](media/msal-net-web-browsers/embedded-webview.png)

**Интерактивного входа в систему с помощью MSAL.NET, с помощью браузера системы:**

![Системный браузер](media/msal-net-web-browsers/system-browser.png)

### <a name="developer-options"></a>Параметры разработчика

Как разработчик, с помощью MSAL.NET у вас есть несколько способов отображения интерактивного диалогового окна из службы маркеров безопасности:

- **Системный браузер.** Системный браузер имеет значение по умолчанию в библиотеке. Если с помощью Android, прочтите [браузеры системы](msal-net-system-browser-android-considerations.md) подробные сведения о том, какие браузеры поддерживаются для проверки подлинности. При использовании браузера системы в Android, мы рекомендуем устройство имеет браузер, поддерживающий пользовательские вкладки Chrome.  В противном случае возможен сбой проверки подлинности.
- **Внедренные webview.** Для использования только внедренные webview в MSAL.NET, `AcquireTokenInteractively` содержит построитель параметров `WithUseEmbeddedWebView()` метод.

    iOS

    ```csharp
    AuthenticationResult authResult;
    authResult = app.AcquireTokenInteractively(scopes)
                    .WithUseEmbeddedWebView(useEmbeddedWebview)
                    .ExecuteAsync();
    ```

    Android:

    ```csharp
    authResult = app.AcquireTokenInteractively(scopes)
                .WithParentActivityOrWindow(activity)
                .WithUseEmbeddedWebView(useEmbeddedWebview)
                .ExecuteAsync();
    ```

#### <a name="choosing-between-embedded-web-browser-or-system-browser-on-xamarinios"></a>Выбор между embedded веб-браузер или системный браузер на Xamarin.iOS

В приложении iOS в `AppDelegate.cs` можно инициализировать `ParentWindow` для `null`. Он не используется в iOS

```csharp
App.ParentWindow = null; // no UI parent on iOS
```

#### <a name="choosing-between-embedded-web-browser-or-system-browser-on-xamarinandroid"></a>Выбор между embedded веб-браузер или системный браузер на Xamarin.Android

В приложении Android в `MainActivity.cs` родительское действие, можно задать таким образом, чтобы результаты проверки подлинности возвращается к нему:

```csharp
 App.ParentWindow = this;
```

Затем в `MainPage.xaml.cs`:

```csharp
authResult = await App.PCA.AcquireTokenInteractive(App.Scopes)
                      .WithParentActivityOrWindow(App.ParentWindow)
                      .WithUseEmbeddedWebView(true)
                      .ExecuteAsync();
```

#### <a name="detecting-the-presence-of-custom-tabs-on-xamarinandroid"></a>Обнаружение присутствия пользовательских вкладок на Xamarin.Android

Если вы хотите использовать веб-браузера системы для включить ЕДИНЫЙ вход для приложений, выполняющихся в браузере, но беспокоитесь об взаимодействие с пользователем для устройств Android, не имеющий браузер с поддержкой настраиваемой вкладки, вы можете решить, вызвав `IsSystemWebViewAvailable()` метод в < c 2 настроек `IPublicClientApplication` . Этот метод возвращает `true` Если PackageManager обнаруживает пользовательские вкладки и `false` если они не обнаружены на устройстве.

На основании значение, возвращаемое данным методом и вашим требованиям, можно принять решение:

- Может возвращать настраиваемое сообщение об ошибке для пользователя. Например: «Пожалуйста, установите Chrome, чтобы продолжить работу с проверкой подлинности» - OR-
- Можно переключиться на параметр embedded webview и запустить пользовательский Интерфейс как внедренные веб-представление.

В приведенном ниже коде показан параметр внедренного веб-представления:

```csharp
bool useSystemBrowser = app.IsSystemWebviewAvailable();

authResult = await App.PCA.AcquireTokenInteractive(App.Scopes)
                      .WithParentActivityOrWindow(App.ParentWindow)
                      .WithUseEmbeddedWebView(!useSystemBrowser)
                      .ExecuteAsync();
```

## <a name="net-core-does-not-support-interactive-authentication-out-of-the-box"></a>.NET core не поддерживает интерактивную проверку подлинности без дополнительной настройки

Для .NET Core получением токенов интерактивно, недоступна. Действительно .NET Core не предоставляет пользовательский Интерфейс еще. Если вы хотите обеспечить интерактивный вход для приложений .NET Core, можно позволить приложения пользователь получает код и URL-адрес для входа в интерактивном режиме (см. в разделе [поток кода устройства](msal-authentication-flows.md#device-code)).

Кроме того, вы можете реализовать [IWithCustomUI](scenario-desktop-acquire-token.md#withcustomwebui) интерфейс, а также предоставляют свои собственные