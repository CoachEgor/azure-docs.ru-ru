---
title: Общий режим устройства для устройств Android Azure
description: Узнайте о режиме совместного устройства, который позволяет работникам первой линии совместно использовать устройство Android
services: active-directory
documentationcenter: dev-center-name
author: mmacy
manager: CelesteDG
ms.service: active-directory
ms.subservice: develop
ms.devlang: na
ms.topic: conceptual
ms.tgt_pltfrm: na
ms.workload: identity
ms.date: 1/15/2020
ms.author: marsma
ms.reviwer: hahamil
ms.custom: aaddev, identityplatformtop40
ms.openlocfilehash: 9928b64d286cc5072f28f7cc17e4af3e95662cd0
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/27/2020
ms.locfileid: "77085616"
---
# <a name="shared-device-mode-for-android-devices"></a>Режим совместной работы с устройством Android

> [!NOTE]
> Эта функция предоставляется в общедоступной предварительной версии.
> Эта предварительная версия предоставляется без соглашения об уровне обслуживания и не рекомендована для использования рабочей среде. Некоторые функции могут не поддерживаться или их возможности могут быть ограничены.
> Дополнительные сведения см. в статье [Дополнительные условия использования предварительных выпусков Microsoft Azure](https://azure.microsoft.com/support/legal/preview-supplemental-terms/).

Работники первой линии, такие как розничные партнеры, члены экипажа и работники полевых служб, часто используют совместное мобильное устройство для работы. Это становится проблематичным, когда они начинают обмениваться паролями или пин-кодами для доступа к данным клиентов и бизнеса на совместном устройстве.

Режим общего устройства позволяет настроить устройство Android таким образом, чтобы его можно было легко совместно использовать несколькимсотрудникам. Сотрудники могут быстро войти в систему и получить доступ к информации о клиентах. Когда они закончат со своей сменой или задачей, они могут выйти из устройства, и он будет немедленно готов к следующему сотруднику для использования.

Режим совместного устройства также обеспечивает управление устройством, обеспечивающим идентификацию майкрософт.

Для создания приложения общего режима устройства разработчики и поставщики облачных устройств работают вместе:

- Разработчики пишут приложение с одним счетом (приложения с несколькими `"shared_device_mode_supported": true` учетными записями не поддерживаются в режиме общего устройства), добавляют в конфигурацию приложения и пишут код для обработки таких вещей, как общий выход устройства.
- Админы устройства готовят устройство для совместного использования, установив приложение аутентификатора и установив устройство в общий режим с помощью приложения аутентификатора. Только пользователи, которые находятся в роли [администратора облачных устройств,](https://docs.microsoft.com/azure/active-directory/users-groups-roles/directory-assign-admin-roles#cloud-device-administrator) могут поместить устройство в общий режим с помощью [приложения Authenticator.](https://docs.microsoft.com/azure/active-directory/user-help/user-help-auth-app-overview) Вы можете настроить членство в организационном составе на портале Azure с помощью: **Функции активных каталогов** > Azure и**администраторы облачных устройств****администраторов администраторов администраторов.** > 

 В этой статье основное внимание уделяется тому, о чем разработчики должны думать.

## <a name="single-vs-multiple-account-applications"></a>Одноместные и многоучетные приложения

Приложения, написанные с помощью SDK Библиотеки подлинности Майкрософт (MSAL), могут управлять одной учетной записью или несколькими учетными записями. Для получения подробной информации смотрите [режим с одним счетом или режим с несколькими учетными данными.](https://docs.microsoft.com/azure/active-directory/develop/single-multi-account) Функции платформы идентификации Майкрософт, доступные вашему приложению, варьируются в зависимости от того, работает ли приложение в режиме с одной учетной записью или в режиме с несколькими учетными записями.

**Приложения с общим ими работают только в режиме с одним счетом.**

> [!IMPORTANT]
> Приложения, поддерживающие только режим с несколькими учетными записи, не могут работать на общем устройстве. Если сотрудник загружает приложение, которое не поддерживает режим с одной учетной записью, оно не будет работать на общем устройстве.
>
> Приложения, написанные до выпуска MSAL SDK, работают в режиме с несколькими учетными данными и должны обновляться для поддержки режима с одной учетной записью, прежде чем они смогут работать на устройстве общего режима.

**Поддержка как одно-учетной записи, так и нескольких учетных записей**

Ваше приложение может быть построено для поддержки работы как на персональных устройствах, так и на общих устройствах. Если ваше приложение в настоящее время поддерживает несколько учетных записей и вы хотите поддерживать общий режим устройства, добавьте поддержку для единого режима учетной записи.

Вы также хотите, чтобы ваше приложение изменило свое поведение в зависимости от типа устройства, на которое оно работает. Используйте `ISingleAccountPublicClientApplication.isSharedDevice()` для определения того, когда работать в режиме с одним счетом.

Существует два различных интерфейса, которые представляют тип устройства, на которых находится ваше приложение. При запросе экземпляра приложения на фабрике приложений MSAL правильный объект приложения предоставляется автоматически.

Следующая модель объекта иллюстрирует тип объекта, который вы можете получить, и что он означает в контексте общего устройства:

![модель наследования приложений публичного клиента](media/v2-shared-device-mode/ipublic-client-app-inheritance.png)

При походе `PublicClientApplication` необходимо проверить тип и отлить их к соответствующему интерфейсу. Следующий код проверяет для нескольких режимов учетной записи или одного режима учетной записи, и отбрасывает объект приложения соответствующим образом:

```java
private IPublicClientApplication mApplication;

        // Running in personal-device mode?
        if (mApplication instanceOf IMultipleAccountPublicClientApplication) {
          IMultipleAccountPublicClientApplication multipleAccountApplication = (IMultipleAccountPublicClientApplication) mApplication;
          ...
        // Running in shared-device mode?
        } else if (mApplication instanceOf ISingleAccountPublicClientApplication) {
           ISingleAccountPublicClientApplication singleAccountApplication = (ISingleAccountPublicClientApplication) mApplication;
            ...
        }
```

Следующие различия в зависимости от того, работает ли ваше приложение на совместном или личном устройстве:

|  | Устройство общего режима  | Личное устройство |
|---------|---------|---------|
| **Учетные записи**     | Единая учетная запись | Несколько учетных записей |
| **Вход** | Global | Global |
| **Регистрация** | Global | Каждое приложение может контролировать, является ли выход локальным для приложения или для семейства приложений. |
| **Поддерживаемые типы учетных записей** | Только рабочие счета | Личные и рабочие учетные записи поддерживаются  |

## <a name="why-you-may-want-to-only-support-single-account-mode"></a>Почему вы можете поддерживать только режим с одним счетом

Если вы пишете приложение, которое будет использоваться только для сотрудников первой строки с помощью общего устройства, мы рекомендуем вам написать приложение только для поддержки режима с одной учетной записью. Это относится к большинству приложений, ориентированных на задачи, например к приложениям для учета медицинских записей и выставления счетов, а также к большинству бизнес-приложений. Только поддержка режима с одним счетом упрощает разработку, потому что вам не нужно будет реализовывать дополнительные функции, которые являются частью приложений с несколькими учетными записями.

## <a name="what-happens-when-the-device-mode-changes"></a>Что происходит при изменении режима устройства

Если приложение работает в режиме нескольких учетных записей, и администратор помещает устройство в общий режим устройства, все учетные записи на устройстве очищаются от приложения, а приложение переходит в режим с одной учетной записью.

## <a name="shared-device-sign-out-and-the-overall-app-lifecycle"></a>Общий выход устройства и общий жизненный цикл приложения

Когда пользователь выходит, вам нужно будет принять меры для защиты конфиденциальности и данных пользователя. Например, если вы строите приложение медицинских записей, вы хотите убедиться, что, когда пользователь выписывает ранее отображаемые записи пациента, будут очищены. Ваша заявка должна быть подготовлена к этому и проверять каждый раз, когда она выходит на передний план.

Когда приложение использует MSAL для регистрации пользователя в приложении, работая на устройстве, находясь в общем режиме, учетная запись и кэшированные токены удаляются как из приложения, так и из устройства.

На следующей диаграмме показан общий жизненный цикл приложения и общие события, которые могут произойти во время работы приложения. Диаграмма охватывает время запуска действия, входе в учетную запись и регистрацию, а также от того, как такие события, как приостановка, возобновление и прекращение действия.

![Общий жизненный цикл приложения общего устройства](media/v2-shared-device-mode/lifecycle.png)

## <a name="next-steps"></a>Дальнейшие действия

Попробуйте [режим «Использование общего устройства» в](tutorial-v2-shared-device-mode.md) своем учебнике по приложению для Android, в которое показано, как запускать приложение для первых сотрудников в общем режиме Android.
