---
title: Подключаемый модуль единого входа Microsoft Enterprise для устройств Apple
titleSuffix: Microsoft identity platform | Azure
description: Сведения о подключаемом модуле единого входа Microsoft Azure Active Directory для устройств iOS и macOS.
services: active-directory
author: brandwe
manager: CelesteDG
ms.service: active-directory
ms.subservice: develop
ms.topic: conceptual
ms.workload: identity
ms.date: 09/15/2020
ms.author: brandwe
ms.reviewer: brandwe
ms.custom: aaddev
ms.openlocfilehash: ec0ab4601e15129ecd8917e0e750a3e1661dc558
ms.sourcegitcommit: 829d951d5c90442a38012daaf77e86046018e5b9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/09/2020
ms.locfileid: "91530703"
---
# <a name="microsoft-enterprise-sso-plug-in-for-apple-devices-preview"></a>Подключаемый модуль единого входа Microsoft Enterprise для устройств Apple (Предварительная версия)

> [!NOTE]
> Эта функция предоставляется в общедоступной предварительной версии.
> Эта предварительная версия предоставляется без соглашения об уровне обслуживания и не рекомендована для использования рабочей среде. Некоторые функции могут не поддерживаться или их возможности могут быть ограничены.
> Дополнительные сведения см. в статье [Дополнительные условия использования предварительных выпусков Microsoft Azure](https://azure.microsoft.com/support/legal/preview-supplemental-terms/).

*Подключаемый модуль единого входа Microsoft Enterprise для устройств Apple* обеспечивает единый вход (SSO) для учетных записей Azure Active Directory (Azure AD) во всех приложениях, поддерживающих функцию [единого входа Apple Enterprise](https://developer.apple.com/documentation/authenticationservices) . Корпорация Майкрософт тесно работала с компанией Apple для разработки этого подключаемого модуля, чтобы повысить удобство использования приложения и обеспечить лучшую защиту, которую могут предоставить компании Apple и Майкрософт.

В этой общедоступной предварительной версии подключаемый модуль единого входа предприятия доступен только для устройств iOS и распространяется в некоторых приложениях Майкрософт.

## <a name="features"></a>Компоненты

Подключаемый модуль единого входа Microsoft Enterprise для устройств Apple предоставляет следующие преимущества.

- Предоставляет единый вход для учетных записей Azure AD во всех приложениях, поддерживающих единую Sign-Onную функцию Apple Enterprise.
- Автоматически доставляется в Microsoft Authenticator и может быть включено любым решением управления мобильными устройствами (MDM).

## <a name="requirements"></a>Требования

Чтобы использовать подключаемый модуль единого входа Microsoft Enterprise для устройств Apple, выполните следующие действия.

- на устройстве должен быть установлен iOS 13,0 или более поздней версии.
- На устройстве должно быть установлено приложение Майкрософт, которое предоставляет подключаемый модуль единого входа Microsoft Enterprise для устройств Apple. Для общедоступной предварительной версии эти приложения включают [Microsoft Authenticator приложение](../user-help/user-help-auth-app-overview.md).
- Устройство должно быть зарегистрировано в MDM (например, с Microsoft Intune).
- Чтобы включить подключаемый модуль единого входа Microsoft Enterprise для устройств Apple на устройстве, необходимо принудительно отправить конфигурацию на устройство. Это ограничение безопасности является обязательным для Apple.

## <a name="enable-the-sso-plug-in-with-mobile-device-management-mdm"></a>Включение подключаемого модуля единого входа с помощью управления мобильными устройствами (MDM)

Чтобы включить подключаемый модуль единого входа Microsoft Enterprise для устройств Apple, устройства должны отправлять сигнал через службу MDM. Так как корпорация Майкрософт включает подключаемый модуль единого входа предприятия в [Microsoft Authenticator приложении](..//user-help/user-help-auth-app-overview.md), используйте MDM, чтобы настроить приложение для включения подключаемого модуля единого входа Microsoft Enterprise.

Используйте следующие параметры для настройки подключаемого модуля единого входа Microsoft Enterprise для устройств Apple.

- **Тип**: перенаправление
- **Идентификатор расширения**: `com.microsoft.azureauthenticator.ssoextension`
- **Идентификатор команды**: (это поле не требуется для iOS)
- **URL-адреса**:
  - `https://login.microsoftonline.com`
  - `https://login.microsoft.com`
  - `https://sts.windows.net`
  - `https://login.partner.microsoftonline.cn`
  - `https://login.chinacloudapi.cn`
  - `https://login.microsoftonline.de`
  - `https://login.microsoftonline.us`
  - `https://login.usgovcloudapi.net`
  - `https://login-us.microsoftonline.com`
  
### <a name="additional-configuration-options"></a>Дополнительные параметры конфигурации.
Дополнительные параметры конфигурации можно добавить для расширения функциональности единого входа для дополнительных приложений.

#### <a name="enable-sso-for-apps-that-dont-use-msal"></a>Включение единого входа для приложений, которые не используют MSAL

Подключаемый модуль единого входа позволяет любому приложению участвовать в едином входе, даже если оно не было разработано с помощью пакета Microsoft SDK, такого как библиотека проверки подлинности Майкрософт (MSAL).

Подключаемый модуль единого входа устанавливается автоматически устройствами, которые загрузили приложение Microsoft Authenticator и зарегистрировали свое устройство в Организации. Организация, скорее всего, использует приложение Authenticator сегодня для таких сценариев, как многофакторная идентификация, проверка подлинности без пароля и условный доступ. Его можно включить для приложений с помощью любого поставщика MDM, хотя корпорация Майкрософт упростила настройку в Microsoft Endpoint Manager для Intune. Список разрешений используется для настройки этих приложений на использование подключаемого модуля SSO, установленного приложением Authenticator.

Поддерживаются только приложения, использующие собственные сетевые технологии Apple или веб – представления. Если приложение поставляется с собственной реализацией сетевого уровня, подключаемый модуль единого входа Microsoft Enterprise не поддерживается.  

Используйте следующие параметры для настройки подключаемого модуля единого входа Microsoft Enterprise для приложений, которые не используют MSAL:

- **Ключ:** `AppAllowList`
- **Тип**: `String`
- **Значение**: разделенный запятыми список идентификаторов наборов приложений для приложений, которые могут УЧАСТВОВАТЬ в SSO.
- **Например**: `com.contoso.workapp, com.contoso.travelapp`.

[Приложения](./application-consent-experience.md) с ограниченным участием, разрешенные администратором MDM для участия в SSO, могут получать маркер для конечного пользователя автоматически. Поэтому важно добавлять в список разрешений только доверенные приложения. 

В этот список не нужно добавлять приложения, использующие MSAL или Асвебаусентикатионсессион. Эти приложения включены по умолчанию. 

#### <a name="allow-creating-sso-session-from-any-application"></a>Разрешить создание сеанса единого входа из любого приложения

По умолчанию подключаемый модуль единого входа Майкрософт предоставляет единый вход для полномочных приложений, только если у подключаемого модуля единого входа уже есть общие учетные данные. Подключаемый модуль SSO Microsoft Enterprise может получить общие учетные данные при вызове другого приложения ADAL или MSAL во время получения маркера. Большинство приложений Майкрософт используют Microsoft Authenticator или подключаемый модуль единого входа. Это означает, что по умолчанию единый вход за пределы собственных потоков приложений является наилучшим вариантом.  

`browser_sso_interaction_enabled`Флаг включения позволяет MSAL приложениям и браузеру Safari выполнять начальную начальную загрузку и получать общие учетные данные. Если у подключаемого модуля единого входа Microsoft Enterprise нет общих учетных данных, он попытается получить его каждый раз, когда запрос на вход будет запрошен из URL-адреса Azure AD в браузере Safari, Асвебаусентикатионсессион, Сафаривиевконтроллер или другого разрешенного собственного приложения.  

- **Ключ:** `browser_sso_interaction_enabled`
- **Тип**: `Integer`
- **Значение**: 1 или 0

Рекомендуется включить этот флаг, чтобы обеспечить более согласованную работу во всех приложениях. Он отключен по умолчанию. 

#### <a name="disable-oauth2-application-prompts"></a>Отключить запросы приложения OAuth2

Подключаемый модуль SSO Microsoft Enterprise обеспечивает единый вход, добавляя общие учетные данные к сетевым запросам, поступающим из разрешенных приложений. Некоторые OAuth2 приложения могут принудительно использовать запрос конечного пользователя на уровне протокола. Общие учетные данные для этих приложений будут игнорироваться.  

Флаг включения позволяет `disable_explicit_app_prompt` использовать как собственные, так и веб-приложения для принудительного выполнения запроса конечным пользователем на уровне протокола и обходить единый вход.

- **Ключ:** `disable_explicit_app_prompt`
- **Тип**: `Integer`
- **Значение**: 1 или 0

Рекомендуется включить этот флаг, чтобы обеспечить более согласованную работу во всех приложениях. Он отключен по умолчанию. 

#### <a name="use-intune-for-simplified-configuration"></a>Использование Intune для упрощения настройки

Microsoft Intune в качестве службы MDM можно использовать для упрощения настройки подключаемого модуля единого входа Microsoft Enterprise. Дополнительные сведения см. в [документации по конфигурации Intune](/intune/configuration/ios-device-features-settings).

## <a name="using-the-sso-plug-in-in-your-application"></a>Использование подключаемого модуля единого входа в приложении

[Библиотека проверки подлинности Microsoft (MSAL) для устройств Apple](https://github.com/AzureAD/microsoft-authentication-library-for-objc) версии 1.1.0 и выше поддерживает подключаемый модуль единого входа Microsoft Enterprise для устройств Apple.

Если вы создаете приложение для рабочих сценариев оказался, см. раздел [режим общего устройства для устройств iOS](msal-ios-shared-devices.md) для дополнительной настройки компонента.

## <a name="how-the-sso-plug-in-works"></a>Принцип работы подключаемого модуля единого входа

Подключаемый модуль единого входа Майкрософт использует [корпоративную платформу Apple enterprise Sign-On Framework](https://developer.apple.com/documentation/authenticationservices/asauthorizationsinglesignonprovider?language=objc). Поставщики удостоверений, подключенные к платформе, могут перехватывать сетевой трафик для своих доменов, а также улучшать или изменять способ обработки этих запросов. Например, подключаемый модуль единого входа может отображать дополнительный пользовательский интерфейс для безопасного получения учетных данных пользователя, требовать MFA или автоматически предоставлять токены для приложения.

Собственные приложения также могут реализовывать пользовательские операции и обращаться непосредственно к подключаемому модулю единого входа.
Вы можете узнать об инфраструктуре единого входа в этом [2019 ввдк видео из Apple](https://developer.apple.com/videos/play/tech-talks/301/) .

### <a name="applications-that-use-msal"></a>Приложения, использующие MSAL

[Библиотека проверки подлинности Microsoft (MSAL) для устройств Apple](https://github.com/AzureAD/microsoft-authentication-library-for-objc) версии 1.1.0 и выше поддерживает подключаемый модуль единого входа Microsoft Enterprise для устройств Apple в собственном режиме для рабочих и учебных учетных записей. 

При соблюдении [всех рекомендуемых действий](./quickstart-v2-ios.md) и использовании [формата URI перенаправления](./redirect-uris-ios.md)по умолчанию не требуется специальной настройки. При запуске на устройстве, где имеется подключаемый модуль единого входа, MSAL автоматически вызывает его для всех интерактивных и автоматических запросов маркеров, а также для операций перечисления учетных записей и удаления учетных записей. Так как MSAL реализует собственный протокол единого входа, который использует пользовательские операции, эта программа установки обеспечивает самый гладкий собственный интерфейс для конечного пользователя. 

Если подключаемый модуль SSO не включен в MDM, но на устройстве имеется Microsoft Authenticator приложение, MSAL будет использовать Microsoft Authenticatorное приложение для любых интерактивных запросов маркеров. Подключаемый модуль единого входа использует единый вход с приложением Microsoft Authenticator.

### <a name="applications-that-dont-use-msal"></a>Приложения, которые не используют MSAL

Приложения, которые не используют MSAL, могут по-прежнему получать единый вход, если администратор добавил их в список разрешений явным образом. 

В этих приложениях не требуется вносить изменения в код, если выполняются следующие условия.

- Приложение использует платформы Apple для выполнения сетевых запросов (например, [вквебвиев](https://developer.apple.com/documentation/webkit/wkwebview), [NSURLSession](https://developer.apple.com/documentation/foundation/nsurlsession)). 
- Приложение использует стандартные протоколы для взаимодействия с Azure AD (например, OAuth2, SAML, WS-Federation).
- Приложение не соберет имя пользователя и пароль открытого текста в собственном пользовательском интерфейсе

В этом случае единый вход предоставляется, когда приложение создает сетевой запрос и открывает веб-браузер для входа пользователя. Когда пользователь перенаправляется на URL-адрес входа в Azure AD, подключаемый модуль единого входа проверяет URL-адрес и проверяет наличие учетных данных единого входа для этого URL-адреса. Если это так, подключаемый модуль единого входа передает учетные данные единого входа в Azure AD, что разрешает приложению завершить сетевой запрос, не запрашивая от пользователя ввода учетных данных. Кроме того, если устройство известно для Azure AD, подключаемый модуль единого входа также передаст сертификат устройства для удовлетворения проверки условного доступа на основе устройств. 

Для поддержки единого входа для MSAL приложений подключаемый модуль единого входа реализует протокол, аналогичный подключаемому модулю браузера Windows, описанному в разделе [что такое основной маркер обновления?](../devices/concept-primary-refresh-token.md#browser-sso-using-prt). 

По сравнению с приложениями на основе MSAL подключаемый модуль единого входа работает более прозрачно для приложений, не являющихся MSAL, путем интеграции с существующим интерфейсом входа в браузер, предоставляемым приложениями. Конечный пользователь увидит свои привычные возможности, и вам не нужно выполнять дополнительные операции входа в каждое приложение. Например, вместо того чтобы отображать средство выбора собственной учетной записи, подключаемый модуль единого входа добавляет сеансы единого входа к веб-интерфейсу выбора учетных записей. 

## <a name="next-steps"></a>Дальнейшие шаги

Дополнительные сведения о режиме общего устройства в iOS см. в статье [режим общего устройства для устройств iOS](msal-ios-shared-devices.md).
