---
title: Проверка подлинности на платформе Microsoft Identity (версия 1.0) | Службы
description: Ознакомьтесь с основами проверки подлинности на платформе идентификации Майкрософт — модель приложения, API, подготовка и наиболее распространенные сценарии проверки подлинности, поддерживаемые платформой Microsoft Identity.
services: active-directory
documentationcenter: dev-center-name
author: rwike77
manager: CelesteDG
editor: ''
ms.assetid: 0c84e7d0-16aa-4897-82f2-f53c6c990fd9
ms.service: active-directory
ms.subservice: develop
ms.devlang: na
ms.topic: conceptual
ms.tgt_pltfrm: na
ms.workload: identity
ms.date: 10/14/2019
ms.author: ryanwi
ms.reviewer: saeeda, sureshja, hirsin
ms.custom: aaddev, identityplatformtop40
ms.collection: M365-identity-device-management
ms.openlocfilehash: 7c7bf80c0471853008573bbcbb918fb33c6c43cd
ms.sourcegitcommit: 0b1a4101d575e28af0f0d161852b57d82c9b2a7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/30/2019
ms.locfileid: "73149175"
---
# <a name="what-is-authentication"></a>Что такое проверка подлинности?

*Аутентификация* — это акт запроса допустимых учетных данных у стороны, выполняющей вход. Это основа для создания субъекта безопасности, используемого для управления доступом и удостоверениями. Проще говоря, это процесс, подтверждающий, что вы являетесь тем, за кого себя выдаете. Аутентификация иногда сокращенно обозначается AuthN (Authentication).

*Авторизация* — это акт предоставления разрешения на выполнение какого-либо действия субъекту безопасности, прошедшему аутентификацию. Она указывает, к каким данным разрешено получить доступ и что с ними можно делать. Авторизация иногда сокращенно обозначается AuthZ (Authorization).

Платформа удостоверений Майкрософт упрощает процесс проверки подлинности для разработчиков приложений, предоставляя удостоверение как услугу, благодаря поддержке стандартных протоколов, например OAuth 2.0 и OpenID Connect, а также библиотекам с открытым кодом для различных платформ, которые позволяют оперативно приступать к программированию.

Модель программирования платформы удостоверений Майкрософт предусматривает два основных варианта:

* При предоставлении авторизации OAuth 2.0 — когда владелец ресурса предоставляет авторизацию для клиентского приложения, разрешая клиенту получать доступ к своим ресурсам.
* При доступе клиента к ресурсам — сервер ресурсов выполняет авторизацию, используя содержащиеся в маркере доступа значения утверждений, на основе которых можно принимать решения по контролю доступа.

## <a name="authentication-basics-in-microsoft-identity-platform"></a>Основные сведения о проверке подлинности на платформе удостоверений Майкрософт

Рассмотрим наиболее простой сценарий, где требуется удостоверение: в веб-браузере пользователю нужно выполнить аутентификацию веб-приложения. Этот сценарий показан на следующей схеме:

![Обзор входа в веб-приложение](./media/v1-authentication-scenarios/auth-basics-microsoft-identity-platform.svg)

Вот что необходимо знать о различных компонентах, показанных на схеме:

* Платформа удостоверений Майкрософт — это поставщик удостоверений. Поставщик удостоверений отвечает за аутентификацию удостоверений пользователей и приложений, данные которых есть в каталоге организации, и выдает маркеры безопасности после успешной аутентификации этих пользователей и приложений.
* Любое приложение, из которого нужно передать функцию проверки подлинности платформе удостоверений Майкрософт, необходимо зарегистрировать в Azure Active Directory. Azure AD регистрирует и уникальным образом идентифицирует приложение в каталоге.
* Использование разработчиками библиотек проверки подлинности платформы удостоверений Майкрософт с открытым кодом позволяет упростить выполнение проверки подлинности благодаря обработке библиотеками данных протокола. Дополнительные сведения см. в статьях о библиотеках проверки подлинности платформы удостоверений Майкрософт версий [2.0](reference-v2-libraries.md) и [1.0](active-directory-authentication-libraries.md).
* Как только пользователь прошел проверку подлинности, приложение должно проверить маркер безопасности пользователя, чтобы убедиться, что проверка подлинности прошла успешно. Можно найти краткие руководства, учебники и примеры кода на различных языках и платформах, в которых показано, что должно делать приложение.
  * Чтобы быстро создать приложение и добавить в него такие функциональные возможности, как получение и обновление маркеров, выполнение входа пользователя, отображение некоторых сведений о пользователе и многое другое, см. раздел документации с **краткими руководствами**.
  * Чтобы получить подробные инструкции на основе сценариев для основных задач по разработке аутентификации, таких как получение маркеров доступа и их использование в вызовах Microsoft Graph API и других API-интерфейсов, реализация входа в учетную запись Майкрософт в традиционном приложении на основе веб-браузера с помощью подключения OpenID, см. раздел документации с **руководствами**.
  * Чтобы скачать примеры кода, перейдите на сайт [GitHub](https://github.com/Azure-Samples?q=active-directory).
* Поток запросов и ответов при аутентификации определяется применяемым протоколом аутентификации, например OAuth 2.0, OpenID Connect, WS-Federation или SAML 2.0. Дополнительные сведения о протоколах см. в разделе **Основные понятия > протокола проверки подлинности** в документации.

В приведенном выше примере сценария можно классифицировать приложения в зависимости от следующих двух ролей:

* приложения, которым требуется защищенный доступ к ресурсам;
* приложения, которые выполняют роль самого ресурса.

### <a name="how-each-flow-emits-tokens-and-codes"></a>Как каждый поток порождает маркеры и коды

В зависимости от того, как строится клиент, он может использовать один (или несколько) потоков проверки подлинности, поддерживаемых платформой Microsoft Identity.  Эти потоки могут создавать различные маркеры (id_tokens, маркеры обновления, маркеры доступа), а также коды авторизации, и для их работы требуются разные токены. На этой диаграмме представлен обзор:

|Поток | Необходима | id_token | Twitter, | маркер обновления | Код авторизации | 
|-----|----------|----------|--------------|---------------|--------------------|
|[Поток кода авторизации](v1-protocols-oauth-code.md) | | x | x | x | x|  
|[Неявный поток](v1-oauth2-implicit-grant-flow.md) | | x        | x    |      |                    |
|[Гибридный поток OIDC](v1-protocols-openid-connect-code.md#get-access-tokens)| | x  | |          |            x   |
|[Активация токена обновления](v1-protocols-oauth-code.md#refreshing-the-access-tokens) | маркер обновления | x | x | x| |
|[Поток On-Behalf-Of](v1-oauth2-on-behalf-of-flow.md) | Twitter,| x| x| x| |
|[Учетные данные клиента](v1-oauth2-client-creds-grant-flow.md) | | | x (только для приложений)| | |

Токены, выданные через неявный режим, имеют ограничение длины, так как они передаются обратно в браузер через URL-адрес (где `response_mode` — `query` или `fragment`).  Некоторые браузеры имеют ограничение на размер URL-адреса, который может быть размещен в строке браузера, и завершается ошибкой, если она слишком длинная.  Поэтому у этих маркеров нет утверждений `groups` или `wids`. 

Теперь, когда вы получили общие сведения, ознакомьтесь с API и моделью приложений с удостоверениями. Узнайте, как на платформе удостоверений Майкрософт выполняется процесс подготовки, и просмотрите ссылки на подробные сведения о распространенных сценариях, которые поддерживаются на платформе удостоверений Майкрософт.

## <a name="application-model"></a>Модель приложения

Платформа удостоверений Майкрософт представляет приложения, следующие определенной модели, предназначенной для выполнения двух основных функций:

* **Идентификация приложения в соответствии с протоколами аутентификации, которые оно поддерживает.** При этом задействуется перечисление всех идентификаторов, URL-адресов, секретов и других связанных сведений, которые требуются во время аутентификации. Платформа удостоверений Майкрософт:

    * содержит все данные, необходимые для поддержки аутентификации во время выполнения;
    * содержит все данные для определения ресурсов, к которым приложению может потребоваться доступ, а также того, следует ли выполнить поданный запрос и при каких обстоятельствах;
    * предоставляет инфраструктуру для подготовки приложения в пределах клиента его разработчика, а также для любого другого клиента Azure AD.

* **Обработка согласия пользователя во время запроса маркера и упрощение динамической подготовки приложений между клиентами**. Платформа удостоверений Майкрософт:

    * позволяет пользователям и администраторам динамически предоставлять или отзывать согласие для приложения на доступ к ресурсам от их имени;
    * позволяет администраторам единолично решить, какие действия разрешены приложениям, какие пользователи могут использовать определенные приложения и каким способом осуществляется доступ к ресурсам каталога.

На платформе удостоверений Майкрософт **объект приложения** описывает приложение как абстрактную сущность. Разработчики работают с приложениями. Во время развертывания платформа удостоверений Майкрософт использует заданный объект приложения как схему для создания **субъекта-службы**, который представляет конкретный экземпляр приложения в пределах каталога или клиента. Именно субъект-служба определяет, что фактически приложение может делать в определенном целевом каталоге, кто может его использовать, к каким ресурсам у него есть доступ и т. д. Платформа удостоверений Майкрософт создает субъект-службу из объекта приложения путем предоставления **согласия**.

На следующей схеме показан упрощенный процесс подготовки платформы удостоверений Майкрософт на основе согласия.  На ней показаны два клиента (A и B). Клиент A является владельцем приложения, а клиент B создает экземпляр приложения с помощью субъекта-службы.  

![Упрощенный процесс подготовки на основе согласия](./media/v1-authentication-scenarios/simplified-provisioning-flow-consent-driven.svg)

В этом процессе подготовки:

1. Пользователь клиента B пытается выполнить вход в приложение. Конечная точка авторизации запрашивает маркер безопасности для приложения.
1. Учетные данные пользователя принимаются и проверяются для аутентификации.
1. Пользователю предлагается предоставить согласие для приложения на получение доступа к клиенту B.
1. Платформа удостоверений Майкрософт использует объект приложения в клиенте A как схему для создания субъекта-службы в клиенте B.
1. Пользователь получает запрошенный маркер безопасности.

Этот процесс можно повторить сколько угодно раз для других клиентов (C, D и т. д.). Клиент A сохраняет схему для приложения (объект приложения). Пользователи и администраторы всех остальных клиентов, где приложение получает согласие, сохраняют контроль над тем, что приложению разрешено делать, с помощью соответствующего объекта субъекта-службы в каждом клиенте. Дополнительные сведения см. в [этой статье](app-objects-and-service-principals.md).

## <a name="claims-in-microsoft-identity-platform-security-tokens"></a>Утверждения в маркерах безопасности платформы удостоверений Майкрософт

Маркеры безопасности (маркеры доступа и маркеры идентификации), которые выдает система платформы удостоверений Майкрософт, содержат утверждения со сведениями о субъекте, для которого была выполнена проверка подлинности. Приложения могут использовать утверждения для различных задач, включая следующие:

* проверка маркера безопасности;
* идентификация клиента каталога субъекта;
* Отображение сведений о пользователе
* определение авторизации субъекта.

Утверждения, имеющиеся в любом заданном маркере безопасности, зависят от типа маркера, типа учетных данных, используемых для проверки подлинности пользователя, и конфигурации приложения.

В следующей таблице приведено краткое описание каждого типа утверждений, которые создает платформа удостоверений Майкрософт. Дополнительные сведения см. в описании [маркеров доступа](access-tokens.md) и [маркеров идентификаторов](id-tokens.md), выдаваемых платформой удостоверений Майкрософт.

| Утверждение | Описание |
| --- | --- |
| Идентификатор приложения | Идентифицирует приложение, которое использует маркер. |
| Аудитория | Идентифицирует ресурс получателя, для которого предназначен маркер. |
| Ссылка на класс контекста проверки подлинности приложения | Показывает, как клиент прошел проверку подлинности (открытый клиент или конфиденциальный клиент). |
| Время выполнения проверки подлинности | Фиксирует дату и время выполнения сеанса проверки подлинности. |
| Метод проверки подлинности | Указывает способ проверки подлинности субъекта маркера (с помощью пароля, сертификата и т. д.). |
| Имя | Предоставляет имя пользователя, как задано в Azure AD. |
| Группы | Содержит идентификаторы объектов для групп Azure AD, членом которых является пользователь. |
| Поставщик удостоверений | Фиксирует поставщика удостоверений, который проверил подлинность субъекта маркера. |
| Выдано в | Фиксирует время, когда был выдан маркер, часто используется для определения "степени свежести" маркера. |
| Издатель | Идентифицирует STS, который выдал маркер, а также клиента Azure AD. |
| Фамилия | Предоставляет фамилию пользователя, как задано в Azure AD. |
| Name | Предоставляет удобное для восприятия значение, которое идентифицирует субъект маркера. |
| Object ID | Содержит неизменяемый, уникальный идентификатор субъекта в Azure AD. |
| Роли | Содержит простые имена ролей приложения в Azure AD, которые предоставлены пользователю. |
| Область действия | Указывает разрешения, предоставленные клиентскому приложению. |
| Тема | Указывает участника, сведения о котором утверждает маркер. |
| Tenant ID | Содержит неизменяемый, уникальный идентификатор клиента каталога, который выдал маркер. |
| Token Lifetime | Определяет интервал времени, в течение которого маркер является действительным. |
| User Principal Name | Содержит имя участника-пользователя субъекта. |
| Версия | Содержит номер версии маркера. |

## <a name="next-steps"></a>Дальнейшие действия

* Ознакомьтесь с дополнительными сведениями о [типах приложений и сценариях, поддерживаемых на платформе удостоверений Майкрософт](app-types.md).
