---
title: Рекомендации для платформы идентификации Майкрософт Azure
description: Узнайте о рекомендациях, рекомендациях и общих нарушениях при интеграции с платформой идентификации Майкрософт.
services: active-directory
author: rwike77
manager: CelesteDG
ms.service: active-directory
ms.subservice: develop
ms.topic: conceptual
ms.workload: identity
ms.date: 09/11/2019
ms.author: ryanwi
ms.reviewer: lenalepa, sureshja, jesakowi
ms.custom: aaddev, identityplatformtop40, scenarios:getting-started
ms.openlocfilehash: 56975cebbfe4f6dd6452c850c338d431faea27bb
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "80050501"
---
# <a name="microsoft-identity-platform-best-practices-and-recommendations"></a>Лучшие практики и рекомендации платформы идентификации Майкрософт

В этой статье освещаются лучшие практики, рекомендации и общие оплошность при интеграции с платформой идентификации Майкрософт.  Этот контрольный список поможет вам обеспечить высококачественную и безопасную интеграцию. Регулярно просматривайте этот список, чтобы убедиться, что вы поддерживаете качество и безопасность интеграции приложения с платформой идентификации. Контрольный список не предназначен для рассмотрения всего приложения. Содержимое контрольного перечня может быть изменено по мере улучшения платформы.

Если вы только начинаете работу, ознакомьтесь с [документацией платформы идентификации Майкрософт,](index.yml) чтобы узнать об основах аутентификации, сценариях приложений в платформе идентификации Майкрософт и многом.

Используйте следующий контрольный список, чтобы гарантировать, что ваше приложение эффективно интегрировано с [платформой идентификации Майкрософт.](https://docs.microsoft.com/azure/active-directory/develop/)

## <a name="basics"></a>Основы

|   |   |
|---|---|
| ![флажок](./media/active-directory-integration-checklist/checkbox-two.svg) | Прочитайте и поймите [политики платформы Майкрософт](https://go.microsoft.com/fwlink/?linkid=2090497&clcid=0x409). Убедитесь, что ваше приложение соответствует условиям, изложенным в их предназначении для защиты пользователей и платформы. |

## <a name="ownership"></a>владельца;

|   |   |
|---|---|
| ![флажок](./media/active-directory-integration-checklist/checkbox-two.svg) | Убедитесь, что информация, связанная с учетной записью, используемой для регистрации и управления приложениями, актуальна. |

## <a name="branding"></a>Фирменная символика

|   |   |
|---|---|
| ![флажок](./media/active-directory-integration-checklist/checkbox-two.svg) | Придерживайтесь [руководящих принципов брендинга для приложений.](howto-add-branding-in-azure-ad-apps.md) |
| ![флажок](./media/active-directory-integration-checklist/checkbox-two.svg) | Предоставьте значимое имя и логотип для вашего приложения. Эта информация появляется в [запросе согласия вашего приложения.](application-consent-experience.md) Убедитесь, что ваше имя и логотип являются репрезентативными для вашей компании/продукта, чтобы пользователи могли принимать обоснованные решения. Убедитесь, что вы не нарушаете никаких товарных знаков. |

## <a name="privacy"></a>Конфиденциальность

|   |   |
|---|---|
| ![флажок](./media/active-directory-integration-checklist/checkbox-two.svg) | Укажите ссылки на условия обслуживания и заявления о конфиденциальности вашего приложения. |

## <a name="security"></a>Безопасность

|   |   |
|---|---|
| ![флажок](./media/active-directory-integration-checklist/checkbox-two.svg) | Управление перенаправлением URIs: <ul><li>Поддерживайте владение всеми вашими перенаправить URIs и держать записи DNS для них в актуальном состоянии.</li><li>Не используйте подстановочные знаки в ваших URIs.</li><li>Для веб-приложений убедитесь, что все УРИ являются безопасными и зашифрованными (например, с помощью схем https).</li><li>Для публичных клиентов используйте определенные платформы, перенаправляя URI, если это применимо (в основном для iOS и Android). В противном случае используйте URL-е типы с большим количеством случайности, чтобы предотвратить столкновения при вызове обратно в приложение.</li><li>Если ваше приложение используется из изолированного веб-агента, вы можете использовать. `https://login.microsoftonline.com/common/oauth2/nativeclient`</li><li>Обзор и обрезка всех неиспользованных или ненужных перенаправить URIs на регулярной основе.</li></ul> |
| ![флажок](./media/active-directory-integration-checklist/checkbox-two.svg) | Если ваше приложение зарегистрировано в каталоге, минимируйте и вручную отслеживайте список владельцев регистрации приложений. |
| ![флажок](./media/active-directory-integration-checklist/checkbox-two.svg) | Не включайте поддержку [неявного потока грантов OAuth2,](v2-oauth2-implicit-grant-flow.md) если это явно не требуется. Узнайте о допустимом сценарии [здесь](v2-oauth2-implicit-grant-flow.md#suitable-scenarios-for-the-oauth2-implicit-grant). |
| ![флажок](./media/active-directory-integration-checklist/checkbox-two.svg) | Перемещение за пределы имени пользователя/пароля. Не используйте [поток учетных данных владельца ресурсов (ROPC),](v2-oauth-ropc.md)который непосредственно обрабатывает пароли пользователей. Этот поток требует высокой степени доверия и пользовательского воздействия и должен использоваться только тогда, когда другие, более безопасные, потоки не могут быть использованы. Этот поток по-прежнему необходим в некоторых сценариях (например, DevOps), но следует помнить, что его использование накладывает ограничения на приложение.  Для более современных подходов прочитайте [потоки аутентификации и сценарии применения.](authentication-flows-app-scenarios.md)|
| ![флажок](./media/active-directory-integration-checklist/checkbox-two.svg) | Защита и управление конфиденциальными учетных данными приложений для веб-приложений, веб-aI и приложений daemon. Используйте [учетные данные сертификатов,](active-directory-certificate-credentials.md)а не учетные данные паролей (секреты клиента). Если вы должны использовать учетные данные паролей, не устанавливайте его вручную. Не храните учетные данные в коде или конфигурации и никогда не позволяйте им обрабатываться людьми. Если это возможно, используйте [управляемые идентификаторы для ресурсов Azure](https://docs.microsoft.com/azure/active-directory/managed-identities-azure-resources/overview) или [Azure Key Vault](https://docs.microsoft.com/azure/key-vault/key-vault-whatis) для хранения и регулярного поворота учетных данных. |
| ![флажок](./media/active-directory-integration-checklist/checkbox-two.svg) | Убедитесь, что приложение запрашивает наименьшие разрешения на привилегии. Только запросить разрешения, что ваше приложение абсолютно необходимо, и только тогда, когда вы в них нуждается. Понимание [различных типов разрешений.](v2-permissions-and-consent.md#permission-types) При необходимости используйте разрешения на применение только в случае необходимости; использовать делегированные разрешения, где это возможно. Полный список разрешений Microsoft Graph смотрите в этой [ссылке на разрешения.](https://docs.microsoft.com/graph/permissions-reference) |
| ![флажок](./media/active-directory-integration-checklist/checkbox-two.svg) | Если вы обеспечиваете безопасность API с помощью платформы идентификации Майкрософт, тщательно продумайте разрешения, которые он должен предоставить. Подумайте, какая гранулярность подходит для решения и какое разрешение (s) требует согласия админа. Проверьте ожидаемые разрешения в входящих токенах, прежде чем принимать какие-либо решения о авторизации. |

## <a name="implementation"></a>Реализация

|   |   |
|---|---|
| ![флажок](./media/active-directory-integration-checklist/checkbox-two.svg) | Используйте современные решения аутентификации (OAuth 2.0, [OpenID Connect),](v2-protocols-oidc.md)чтобы безопасно войти в систему пользователей. |
| ![флажок](./media/active-directory-integration-checklist/checkbox-two.svg) |  Не запрограммируйте непосредственно против протоколов, таких как OAuth 2.0 и Open ID. Вместо этого используйте [библиотеку подлинности Майкрософт (MSAL).](msal-overview.md) Библиотеки MSAL надежно обращают протоколы безопасности в простую в использовании библиотеку, и вы получаете встроенную поддержку сценариев [условного доступа,](/azure/active-directory/conditional-access/overview) [систему единого входного входного знака (SSO)](/azure/active-directory/manage-apps/what-is-single-sign-on)и встроенную поддержку кэширования токенов. Для получения дополнительной информации смотрите список поддерживаемых корпорацией Майкрософт [библиотек клиентов](reference-v2-libraries.md#microsoft-supported-client-libraries) и [библиотек и библиотек и промежуточное программное обеспечение,](reference-v2-libraries.md#microsoft-supported-server-middleware-libraries) а также список [совместимых сторонних библиотек клиентов.](reference-v2-libraries.md#compatible-client-libraries)<br/><br/>Если необходимо передать код для протоколов проверки подлинности, следует следовать методологии, такой как [Microsoft SDL.](https://www.microsoft.com/sdl/default.aspx) Обратите пристальное внимание на соображения безопасности в спецификациях стандартов для каждого протокола.|
| ![флажок](./media/active-directory-integration-checklist/checkbox-two.svg) |  Переносите существующие приложения из [Библиотеки подлинности активных каталогов Azure (ADAL) в](../azuread-dev/active-directory-authentication-libraries.md) [библиотеку подлинности Майкрософт.](msal-overview.md) MSAL является последним решением платформы идентификации Корпорации Майкрософт и является предпочтительным для ADAL. Он доступен на .NET, JavaScript, Android, iOS, macOS, а также в открытом доступе для Python и Java. Узнайте больше о миграционных [ADAL.NET,](msal-net-migration.md) [ADAL.js](msal-compare-msal-js-and-adal-js.md)и приложениях [для брокеров ADAL.NET и iOS.](msal-net-migration-ios-broker.md)|
| ![флажок](./media/active-directory-integration-checklist/checkbox-two.svg) |  Для мобильных приложений назначайте каждую платформу, используя опыт регистрации приложения. Для того, чтобы ваше приложение воспользовалось услугами Microsoft Authenticator или портала компании Майкрософт для одного входного ввод, вашему приложению необходим настроенный «брокер перенаправление URI». Это позволяет корпорации Майкрософт вернуть элемент управления в ваше приложение после проверки подлинности. При настройке каждой платформы опыт регистрации приложения поможет вам пройти через этот процесс. Используйте quickstart, чтобы загрузить рабочий пример. На iOS, используйте брокеров и системный веб-вью, когда это возможно.|
| ![флажок](./media/active-directory-integration-checklist/checkbox-two.svg) |  В веб-приложениях или веб-aI сохраните один кэш маркеров на учетную запись.  Для веб-приложений кэш маркеров должен быть включин идентификатором учетной записи.  Для web-aPI учетная запись должна быть включь хэш маркера, используемого для вызова API. MSAL.NET предоставляет сериализацию пользовательских кэша токенов в подплатформах .NET И .NET Core. По соображениям безопасности и производительности наша рекомендация состоит в том, чтобы сериализовать один кэш на пользователя. Для получения дополнительной информации прочитайте о [сериализации кэша токенов.](msal-net-token-cache-serialization.md#token-cache-for-a-web-app-confidential-client-application)|
| ![флажок](./media/active-directory-integration-checklist/checkbox-two.svg) | Если данные, необходимые приложению, доступны через [Microsoft Graph,](https://developer.microsoft.com/graph)запрашивайте разрешения на эти данные с помощью конечных точек Microsoft Graph, а не отдельного API. |
| ![флажок](./media/active-directory-integration-checklist/checkbox-two.svg) |Не смотрите на значение маркера доступа и не пытайтесь разобрать его как клиент.  Они могут изменять значения, форматы или даже шифроваться без предупреждения - всегда используйте id_token если вашему клиенту нужно узнать что-то о пользователе, или позвонить в Microsoft Graph.  Только веб-aIS должны разбирать токены доступа (поскольку именно они определяют формат и устанавливают ключи шифрования). |

## <a name="end-user-experience"></a>Возможности для пользователей

|   |   |
|---|---|
| ![флажок](./media/active-directory-integration-checklist/checkbox-two.svg) | [Поймите опыт согласия](application-consent-experience.md) и наберите части запроса согласия приложения, чтобы конечные пользователи и админы имели достаточно информации, чтобы определить, доверяют ли они вашему приложению. |
| ![флажок](./media/active-directory-integration-checklist/checkbox-two.svg) | Свести к минимуму количество раз, когда пользователь должен ввести учетные данные входа при использовании приложения, пытаясь тихую аутентификацию (тихое приобретение маркеров) перед интерактивными потоками. |
| ![флажок](./media/active-directory-integration-checklist/checkbox-two.svg) | Не используйте "быстрое согласие" для каждого входиного. Используйте запрос только в том случае, если вы определили, что вам нужно запросить согласие на получение дополнительных разрешений (например, если вы изменили требуемые разрешения вашего приложения). |
| ![флажок](./media/active-directory-integration-checklist/checkbox-two.svg) | Там, где это применимо, обогащайте приложение данными пользователей. Использование [API Microsoft Graph](https://developer.microsoft.com/graph) — это простой способ сделать это. Инструмент [Graph Explorer,](https://developer.microsoft.com/graph/graph-explorer) который поможет вам начать работу. |
| ![флажок](./media/active-directory-integration-checklist/checkbox-two.svg) | Зарегистрируйте полный набор разрешений, необходимых вашему приложению, чтобы админы могли легко дать согласие своему арендатору. Используйте [постепенное согласие](../azuread-dev/azure-ad-endpoint-comparison.md#incremental-and-dynamic-consent) во время выполнения, чтобы помочь пользователям понять, почему ваше приложение запрашивает разрешения, которые могут касаться или запутать пользователей при запросе при первом запуске. |
| ![флажок](./media/active-directory-integration-checklist/checkbox-two.svg) | Реализация [чистого одного выхода опыт](https://github.com/Azure-Samples/active-directory-aspnetcore-webapp-openidconnect-v2/tree/master/1-WebApp-OIDC/1-6-SignOut). Это конфиденциальность и требования безопасности, и делает для хорошего пользовательского опыта. |

## <a name="testing"></a>Тестирование

|   |   |
|---|---|
| ![флажок](./media/active-directory-integration-checklist/checkbox-two.svg) | Тест для [политик условного доступа,](https://github.com/Azure-Samples/active-directory-aspnetcore-webapp-openidconnect-v2/tree/master/1-WebApp-OIDC/1-6-SignOut) которые могут повлиять на способность пользователей использовать ваше приложение. |
| ![флажок](./media/active-directory-integration-checklist/checkbox-two.svg) | Проверьте приложение со всеми возможными учетными записями, которые вы планируете поддерживать (например, рабочие или школьные учетные записи, личные учетные записи Майкрософт, учетные записи детей и суверенные учетные записи). |

## <a name="additional-resources"></a>Дополнительные ресурсы

Ниже приведены ресурсы с подробными сведениями о версии 2.0:

* [Платформа идентификации Майкрософт (обзор v2.0)](v2-overview.md)
* [Ссылка на протоколы платформы идентификации Майкрософт](active-directory-v2-protocols.md)
* [Справочник по маркерам доступа](access-tokens.md)
* [Справочник по токенам идентификаторов](id-tokens.md)
* [Ссылка на библиотеки аутентификации](reference-v2-libraries.md)
* [Разрешения и согласие в платформе идентификации Майкрософт](v2-permissions-and-consent.md)
* [API Microsoft Graph](https://developer.microsoft.com/graph)
