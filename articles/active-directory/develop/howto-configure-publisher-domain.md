---
title: Наверстывай домен издателя приложения Azure
titleSuffix: Microsoft identity platform
description: Узнайте, как настроить домен издателя приложения, чтобы пользователи знали, куда отправляется их информация.
services: active-directory
author: rwike77
manager: CelesteDG
ms.service: active-directory
ms.subservice: develop
ms.topic: conceptual
ms.workload: identity
ms.date: 04/05/2019
ms.author: ryanwi
ms.reviewer: lenalepa, sureshja, zachowd
ms.custom: aaddev
ms.openlocfilehash: 68040c8ee22454c300296493b6c840eabbca98aa
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/27/2020
ms.locfileid: "76697138"
---
# <a name="how-to-configure-an-applications-publisher-domain"></a>Как: Настройка домена издателя приложения

Домен издателя приложения отображается пользователям по [запросу согласия приложения,](application-consent-experience.md) чтобы сообщить пользователям, куда отправляется их информация. Мультитенантные приложения, зарегистрированные после 21 мая 2019 года, не имеюющие домен издателя, отображаются как **непроверенные.** Мультитенантные приложения — это приложения, поддерживающие учетные записи вне единого каталога организации; например, поддерживать все учетные записи Azure AD или поддерживать все учетные записи Azure AD и личные учетные записи Майкрософт.

## <a name="new-applications"></a>Новые приложения

При регистрации нового приложения домен издателя вашего приложения может быть установлен на значение по умолчанию. Значение зависит от того, где зарегистрировано приложение, в частности, зарегистрировано ли приложение в арендаторе и есть ли у арендатора проверенные домены.

При наличии проверенных арендаторами доменов домен издателя по умолчанию будет по умолчанию в основной проверенный домен арендатора. Если нет проверенных доменов (что происходит в случае, когда приложение не зарегистрировано в арендаторе), домен издателя приложения будет сведен на нет.

В следующей таблице кратко излагается поведение домена издателя по умолчанию.  

| Проверенные арендатором домены | Значение по умолчанию домена издателя |
|-------------------------|----------------------------|
| null | null |
| В.onmicrosoft.com | В.onmicrosoft.com |
| - Onmicrosoft.com<br/>- domain1.com<br/>- domain2.com (первичный) | domain2.com |

Если домен издателя мультитенантного приложения не установлен, или если он установлен на домене, который заканчивается в .onmicrosoft.com, запрос согласия приложения будет отображаться **непроверенным** вместо домена издателя.

## <a name="grandfathered-applications"></a>Дедушки приложений

Если ваше приложение было зарегистрировано до 21 мая 2019 года, запрос согласия приложения не будет отображаться **непроверенным,** если вы не установили домен издателя. Мы рекомендуем установить значение домена издателя, чтобы пользователи могли видеть эту информацию в запросе согласия вашего приложения.

## <a name="configure-publisher-domain-using-the-azure-portal"></a>Настройка домена издателя с помощью портала Azure

Чтобы настроить домен издателя приложения, выполните следующие действия.

1. Войдите на [портал Azure](https://portal.azure.com) с помощью личной учетной записи Майкрософт либо рабочей или учебной учетной записи.

1. Если ваша учетная запись присутствует в нескольких клиентах Azure AD:
   1. Выберите свой профиль в меню в правом верхнем углу страницы, а затем **Переключение каталога**.
   1. Измените сеанс на арендатор Azure AD, в котором нужно создать приложение.

1. Перейдите в [Azure Active Directory > регистрации приложений,](https://go.microsoft.com/fwlink/?linkid=2083908) чтобы найти и выбрать приложение, которое вы хотите настроить.

   После того как вы выбрали приложение, вы увидите страницу **обзора** приложения.

1. На странице **обзора** приложения выберите раздел **Брендинг.**

1. Найдите **поле домена Publisher** и выберите один из следующих вариантов:

   - Выберите **настройку домена,** если вы еще не настроили домен.
   - Выберите **домен обновления,** если домен уже настроен.

Если ваше приложение зарегистрировано в арендаторе, вы увидите две вкладки, чтобы выбрать из: **Выберите проверенный домен** и **Проверить новый домен.**

Если ваше приложение не зарегистрировано в арендаторе, вы увидите возможность проверить новый домен для приложения.

### <a name="to-verify-a-new-domain-for-your-app"></a>Проверка нового домена для вашего приложения

1. Создайте файл `microsoft-identity-association.json` с именем и вставьте следующий фрагмент кода JSON.

   ```json
   {
      "associatedApplications": [
        {
           "applicationId": "{YOUR-APP-ID-HERE}"
        }
      ]
    }
   ```

1. Замените заполнитель *«YOUR-APP-ID-HERE»* идентификатором приложения (клиента), который соответствует вашему приложению.

1. Размещать файл `https://{YOUR-DOMAIN-HERE}.com/.well-known/microsoft-identity-association.json`по адресу: . Замените заполнитель *«YOUR-DOMAIN-HERE»* в соответствии с проверенным доменом.

1. Нажмите кнопку **«Проверка» и сохраните кнопку «Проверка».**

### <a name="to-select-a-verified-domain"></a>Выбрать проверенный домен

- Если ваш арендатор проверил домены, выберите один из доменов из **Выберите проверенный упадок домена.**

>[!Note]
> Ожидаемый заголовок 'Content-Type', который `application/json`должен быть возвращен, находится в. Вы можете получить ошибку, как упоминалось ниже, если вы используете что-нибудь еще, как`application/json; charset=utf-8` 
> 
>``` "Verification of publisher domain failed. Error getting JSON file from https:///.well-known/microsoft-identity-association. The server returned an unexpected content type header value. " ```
>

## <a name="implications-on-the-app-consent-prompt"></a>Последствия запроса о согласии приложения

Настройка домена издателя влияет на то, что пользователи видят в запросе согласия приложения. Чтобы полностью понять компоненты запроса согласия, [см.](application-consent-experience.md)

В следующей таблице описывается поведение приложений, созданных до 21 мая 2019 года.

![Запрос согласия для приложений, созданных до 21 мая 2019 года](./media/howto-configure-publisher-domain/old-app-behavior-table.png)

Поведение новых приложений, созданных после 21 мая 2019 года, будет зависеть от домена издателя и типа приложения. В следующей таблице описаны изменения, которые следует ожидать увидеть с различными комбинациями конфигураций.

![Запрос согласия для приложений, созданных после 21 мая 2019 г.](./media/howto-configure-publisher-domain/new-app-behavior-table.png)

## <a name="implications-on-redirect-uris"></a>Последствия перенаправления УРИ

Приложения, которые подписывают в пользователях с любой работой или школьной учетной записи, или личные учетные записи Microsoft[(мультиарендатор](single-and-multi-tenant-apps.md)) подлежат несколько ограничений при указании перенаправления URIs.

### <a name="single-root-domain-restriction"></a>Однокорневое ограничение домена

Когда значение домена издателя для мультитенантных приложений сведено к нулю, приложения ограничены для совместного использования одного корневого домена для перенаправления URI. Например, следующая комбинация значений не допускается, поскольку корневой домен, contoso.com, не соответствует fabrikam.com.

```
"https://contoso.com",
"https://fabrikam.com",
```

### <a name="subdomain-restrictions"></a>Ограничения поддоменов

Субдомены разрешены, но вы должны явно зарегистрировать корневой домен. Например, в то время как следующие УРИ имеют общий унитёр, комбинация не допускается.

```
"https://app1.contoso.com",
"https://app2.contoso.com",
```

Однако, если разработчик явно добавляет корневой домен, комбинация разрешена.

```
"https://contoso.com",
"https://app1.contoso.com",
"https://app2.contoso.com",
```

### <a name="exceptions"></a>Исключения

Следующие случаи не подпадают под одно ограничение корневого домена:

- Единые приложения-арендаторы или приложения, ориентированные на учетные записи в одном каталоге
- Использование localhost в качестве перенаправления URIs
- Перенаправить УРИ с пользовательскими схемами (не HTTP или HTTPS)

## <a name="configure-publisher-domain-programmatically"></a>Настройка домена издателя программно

В настоящее время нет поддержки REST API или PowerShell для настройки домена издателя программно.
