---
title: Руководство. Настройка обратной записи SAP SuccessFactors в Azure Active Directory | Документация Майкрософт
description: Узнайте, как настроить обратную запись атрибута в SAP SuccessFactors из Azure AD.
services: active-directory
author: cmmdesai
documentationcenter: na
manager: jodadzie
ms.assetid: ad255bd4-9e50-43a1-a92b-359215868b6b
ms.service: active-directory
ms.subservice: saas-app-tutorial
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: identity
ms.date: 07/23/2020
ms.author: chmutali
ms.openlocfilehash: 5181cc0f6457c5eb98cca828ecb91c52f47f3fbe
ms.sourcegitcommit: dccb85aed33d9251048024faf7ef23c94d695145
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/28/2020
ms.locfileid: "87273546"
---
# <a name="tutorial-configure-attribute-write-back-from-azure-ad-to-sap-successfactors-preview"></a>Руководство. Настройка атрибута обратной записи из Azure AD в SAP SuccessFactors (Предварительная версия)
Цель этого учебника — продемонстрировать действия, которые необходимо выполнить с помощью атрибутов обратной записи из Azure AD в службу SAP SuccessFactors Employee Central. 

## <a name="overview"></a>Обзор

Вы можете настроить приложение обратной записи SAP SuccessFactors для записи конкретных атрибутов из Azure Active Directory в SAP SuccessFactors Employee Central. Приложение подготовки обратной записи SuccessFactors поддерживает назначение значений следующим центральным атрибутам сотрудника:

* Рабочий адрес электронной почты
* Имя пользователя
* Номер рабочего телефона (включая код страны, код города, номер и расширение)
* Основной флаг номера рабочего телефона
* Номер сотового телефона (включая код страны, код города, номер)
* Первичный флаг мобильного телефона 
* Пользовательские custom01-custom15 атрибуты
* атрибут Логинмесод

> [!NOTE]
> Это приложение не зависит от приложений интеграции SuccessFactors для входящих пользователей. Вы можете настроить его независимо от [SuccessFactors для локального приложения AD](sap-successfactors-inbound-provisioning-tutorial.md) или [SuccessFactors в приложение подготовки Azure AD](sap-successfactors-inbound-provisioning-cloud-only-tutorial.md) .

### <a name="who-is-this-user-provisioning-solution-best-suited-for"></a>Кому это решение подготовки пользователей подходит лучше всего?

Решение для подготовки пользователей обратной записи SuccessFactors идеально подходит для:

* Организации, использующие Office 365, которым требуется обратная запись полномочных атрибутов, управляемых им (например, адрес электронной почты, Телефон, имя пользователя), обратно в SuccessFactors Employee Central.

## <a name="configuring-successfactors-for-the-integration"></a>Настройка SuccessFactors для интеграции

Все соединители подготовки SuccessFactors нуждаются в учетных данных учетной записи SuccessFactors с нужными разрешениями для вызова API-интерфейсов OData Central. В этом разделе описаны шаги по созданию учетной записи службы в SuccessFactors и предоставлению соответствующих разрешений. 

* [Создание или указание учетной записи пользователя API в SuccessFactors](#createidentify-api-user-account-in-successfactors)
* [Создание роли разрешений API](#create-an-api-permissions-role)
* [Создание группы разрешений для пользователя API](#create-a-permission-group-for-the-api-user)
* [Предоставление роли разрешений группе разрешений](#grant-permission-role-to-the-permission-group)

### <a name="createidentify-api-user-account-in-successfactors"></a>Создание или указание учетной записи пользователя API в SuccessFactors
Обратитесь к группе администраторов SuccessFactors или партнеру по реализации, чтобы создать или указать учетную запись пользователя в SuccessFactors, которая будет использоваться для вызова интерфейсов API OData. При настройке приложений подготовки в Azure AD будут необходимы учетные данные пользователя и пароль этой учетной записи. 

### <a name="create-an-api-permissions-role"></a>Создание роли разрешений API

1. Войдите в SAP SuccessFactors с учетной записью пользователя, имеющего доступ к центру администрирования.
1. Выполните поиск по запросу *Управление ролями разрешений*, а затем выберите **Управление ролями разрешений** в результатах поиска.

   ![Управление ролями разрешений](./media/sap-successfactors-inbound-provisioning/manage-permission-roles.png)

1. В списке роль разрешений щелкните **создать**.

   > [!div class="mx-imgBorder"]
   > ![Создать новую роль разрешений](./media/sap-successfactors-inbound-provisioning/create-new-permission-role-1.png)

1. Добавьте имя и **Описание** **роли** для новой роли разрешений. Имя и описание должны указывать, что роль предназначена для разрешений на использование API.

   > [!div class="mx-imgBorder"]
   > ![Сведения о роли разрешений](./media/sap-successfactors-inbound-provisioning/permission-role-detail.png)

1. В разделе Параметры разрешений щелкните **разрешение...**, затем прокрутите вниз список разрешений и выберите пункт **Управление инструментами интеграции**. Установите флажок **разрешить администратору доступ к API OData через обычную проверку подлинности**.

   > [!div class="mx-imgBorder"]
   > ![Управление инструментами интеграции](./media/sap-successfactors-inbound-provisioning/manage-integration-tools.png)

1. Прокрутите вниз в том же окне и выберите **Центральный API сотрудника**. Добавьте разрешения, как показано ниже, для чтения с помощью API ODATA и редактирования с помощью API ODATA. Выберите параметр изменить, если вы планируете использовать одну и ту же учетную запись для сценария обратной записи в SuccessFactors. 

   > [!div class="mx-imgBorder"]
   > ![Чтение разрешений на запись](./media/sap-successfactors-inbound-provisioning/odata-read-write-perm.png)

1. Нажмите кнопку **Готово**. Щелкните **Сохранить изменения**.

### <a name="create-a-permission-group-for-the-api-user"></a>Создание группы разрешений для пользователя API

1. В центре администрирования SuccessFactors выполните поиск по запросу *Управление группами разрешений*, а затем выберите **Управление группами разрешений** в результатах поиска.

   > [!div class="mx-imgBorder"]
   > ![Управление группами разрешений](./media/sap-successfactors-inbound-provisioning/manage-permission-groups.png)

1. В окне Управление группами разрешений щелкните **создать**.

   > [!div class="mx-imgBorder"]
   > ![Добавление новой группы](./media/sap-successfactors-inbound-provisioning/create-new-group.png)

1. Добавьте имя группы для новой группы. Имя группы должно указывать, что группа предназначена для пользователей API.

   > [!div class="mx-imgBorder"]
   > ![Имя группы разрешений](./media/sap-successfactors-inbound-provisioning/permission-group-name.png)

1. Добавление участников в группу. Например, можно выбрать **имя пользователя** в раскрывающемся меню пул людей, а затем ввести имя пользователя учетной записи API, которая будет использоваться для интеграции. 

   > [!div class="mx-imgBorder"]
   > ![Добавление членов группы](./media/sap-successfactors-inbound-provisioning/add-group-members.png)

1. Нажмите кнопку **Готово** , чтобы завершить создание группы разрешений.

### <a name="grant-permission-role-to-the-permission-group"></a>Предоставление роли разрешений группе разрешений

1. В центре администрирования SuccessFactors выполните поиск по запросу *Управление ролями разрешений*, а затем выберите **Управление ролями разрешений** в результатах поиска.
1. В **списке роль разрешений**выберите роль, созданную для разрешений на использование API.
1. В разделе **предоставить эту роль для...** нажмите кнопку **Добавить..** ..
1. Выберите **группу разрешений...** в раскрывающемся меню выберите команду **выбрать...** , чтобы открыть окно группы для поиска и выбора группы, созданной выше. 

   > [!div class="mx-imgBorder"]
   > ![Добавить группу разрешений](./media/sap-successfactors-inbound-provisioning/add-permission-group.png)

1. Проверьте роль разрешений, предоставляемую группе разрешений. 
   > [!div class="mx-imgBorder"]
   > ![Сведения о роли и группе разрешений](./media/sap-successfactors-inbound-provisioning/permission-role-group.png)

1. Щелкните **Сохранить изменения**.

## <a name="preparing-for-successfactors-writeback"></a>Подготовка к обратной записи SuccessFactors

Приложение подготовки обратной записи SuccessFactors использует определенные значения *кода* для настройки электронной почты и номеров телефонов в центре сотрудников. Эти значения *кода* задаются как постоянные значения в таблице сопоставления атрибутов и отличаются для каждого экземпляра SuccessFactors. В этом разделе используется [процедура POST](https://www.postman.com/downloads/) для выборки значений кода. Для отправки HTTP-запросов [можно использовать](https://curl.haxx.se/) [Fiddler](https://www.telerik.com/fiddler) или любое другое аналогичное средство. 

### <a name="download-and-configure-postman-with-your-successfactors-tenant"></a>Скачайте и настройте POST с помощью клиента SuccessFactors.

1. Загрузка [публикации](https://www.postman.com/downloads/)
1. Создайте новую коллекцию в приложении POST. Вызовите его «SuccessFactors». 

   > [!div class="mx-imgBorder"]
   > ![Новая коллекция POST](./media/sap-successfactors-inbound-provisioning/new-postman-collection.png)

1. На вкладке "Авторизация" введите учетные данные пользователя API, настроенного в предыдущем разделе. Настройте тип "Обычная проверка подлинности". 

   > [!div class="mx-imgBorder"]
   > ![Авторизация после авторизации](./media/sap-successfactors-inbound-provisioning/postman-authorization.png)

1. Сохраните конфигурацию. 

### <a name="retrieve-constant-value-for-emailtype"></a>Получение постоянного значения для Емаилтипе

1. В окне POST щелкните многоточие (...), связанный с коллекцией SuccessFactors, и добавьте "новый запрос", именуемый "получение типов электронной почты", как показано ниже. 

   > [!div class="mx-imgBorder"]
   > ![Отправить запрос по электронной почте](./media/sap-successfactors-inbound-provisioning/postman-email-request.png)

1. Откройте панель запроса "получение типа электронной почты". 
1. В поле получить URL-адрес добавьте следующий URL-адрес, заменив `successFactorsAPITenantName` его клиентом API для экземпляра SuccessFactors. 
   `https://<successfactorsAPITenantName>/odata/v2/Picklist('ecEmailType')?$expand=picklistOptions&$select=picklistOptions/id,picklistOptions/externalCode&$format=json`

   > [!div class="mx-imgBorder"]
   > ![Тип электронной почты после получения сообщения](./media/sap-successfactors-inbound-provisioning/postman-get-email-type.png)

1. Вкладка "Авторизация" будет наследовать проверку подлинности, настроенную для коллекции. 
1. Нажмите кнопку "Отправить", чтобы вызвать API. 
1. В тексте ответа просмотрите результирующий набор JSON и найдите идентификатор, соответствующий `externalCode = B` . 

   > [!div class="mx-imgBorder"]
   > ![Ответ типа электронной почты](./media/sap-successfactors-inbound-provisioning/postman-email-type-response.png)

1. Запишите это значение в качестве константы для использования с *емаилтипе* в таблице сопоставления атрибутов.

### <a name="retrieve-constant-value-for-phonetype"></a>Получение постоянного значения для Фонетипе

1. В окне POST щелкните многоточие (...), связанный с коллекцией SuccessFactors, и добавьте "новый запрос", именуемый "получение типов телефонов", как показано ниже. 

   > [!div class="mx-imgBorder"]
   > ![Отправить запрос по телефону](./media/sap-successfactors-inbound-provisioning/postman-phone-request.png)

1. Откройте панель запроса "получение типа телефона". 
1. В поле получить URL-адрес добавьте следующий URL-адрес, заменив `successFactorsAPITenantName` его клиентом API для экземпляра SuccessFactors. 
   `https://<successfactorsAPITenantName>/odata/v2/Picklist('ecPhoneType')?$expand=picklistOptions&$select=picklistOptions/id,picklistOptions/externalCode&$format=json`

   > [!div class="mx-imgBorder"]
   > ![Тип телефона получения сообщения](./media/sap-successfactors-inbound-provisioning/postman-get-phone-type.png)

1. Вкладка "Авторизация" будет наследовать проверку подлинности, настроенную для коллекции. 
1. Нажмите кнопку "Отправить", чтобы вызвать API. 
1. В тексте ответа просмотрите результирующий набор JSON и найдите *идентификатор* , соответствующий `externalCode = B` и `externalCode = C` . 

   > [!div class="mx-imgBorder"]
   > ![POST-Phone](./media/sap-successfactors-inbound-provisioning/postman-phone-type-response.png)

1. Запишите эти значения как константы для использования с *бусинессфонетипе* и *целлфонетипе* в таблице сопоставления атрибутов.

## <a name="configuring-successfactors-writeback-app"></a>Настройка приложения обратной записи SuccessFactors

В этом разделе приводятся шаги для 

* [Добавление приложения соединителя подготовки и Настройка подключения к SuccessFactors](#part-1-add-the-provisioning-connector-app-and-configure-connectivity-to-successfactors)
* [Настройка сопоставлений атрибутов](#part-2-configure-attribute-mappings)
* [Включение и запуск подготовки пользователей](#enable-and-launch-user-provisioning)

### <a name="part-1-add-the-provisioning-connector-app-and-configure-connectivity-to-successfactors"></a>Часть 1. Добавление приложения соединителя подготовки и Настройка подключения к SuccessFactors

**Чтобы настроить обратную запись SuccessFactors, сделайте следующее:**

1. Перейдите на сайт <https://portal.azure.com>.

2. В области навигации слева выберите **Azure Active Directory**.

3. Щелкните **Корпоративные приложения**, а затем — **Все приложения**.

4. Выберите **Добавить приложение** и выберите категорию **Все**.

5. Выполните поиск **обратной записи SuccessFactors**и добавьте это приложение из коллекции.

6. После добавления приложения и отображения экрана сведений о приложении выберите **Подготовка**

7. Изменение режима **подготовки** **Mode** на **Автоматический**

8. В разделе **Учетные данные администратора** заполните поля следующим образом.

   * **Имя пользователя администратора** — введите имя пользователя учетной записи API SuccessFactors с ДОБАВЛЕНным идентификатором компании. Он имеет формат: **username \@ companyID** .

   * **Пароль администратора —** Введите пароль учетной записи пользователя API SuccessFactors. 

   * **URL-адрес клиента —** Введите имя конечной точки служб API OData SuccessFactors. Введите только имя узла сервера без HTTP или HTTPS. Это значение должно выглядеть следующим образом: `api4.successfactors.com` .

   * **Адрес электронной почты для уведомлений —** введите адрес электронной почты и установите флажок "send email if failure occurs" (Отправлять по электронной почте в случае сбоя).
    > [!NOTE]
    > Служба подготовки Azure AD отправляет уведомление по электронной почте, если задание подготовки переходит в состояние [Карантин](/azure/active-directory/manage-apps/application-provisioning-quarantine-status).

   * Нажмите кнопку **Проверить подключение**. Если проверка подключения выполнена успешно, нажмите кнопку **Сохранить** в верхней части. В случае сбоя Проверьте правильность учетных данных и URL-адреса SuccessFactors.
    >[!div class="mx-imgBorder"]
    >![Портал Azure](./media/sap-successfactors-inbound-provisioning/sfwb-provisioning-creds.png)

   * После успешного сохранения учетных данных в разделе **сопоставления** будет отображаться сопоставление по умолчанию. Обновите страницу, если сопоставления атрибутов не видны.  

### <a name="part-2-configure-attribute-mappings"></a>Часть 2. Настройка сопоставлений атрибутов

В этом разделе вы настроите, каким способом данные пользователей из SuccessFactors будут Active Directory.

1. На вкладке Подготовка в разделе **сопоставления**щелкните **подготовить Azure Active Directory пользователей**.

1. В поле **область исходного объекта** можно выбрать, какие наборы пользователей в Azure AD следует рассмотреть для обратной записи, определив набор фильтров на основе атрибутов. Область по умолчанию — "все пользователи в Azure AD". 
   > [!TIP]
   > При первой настройке приложения подготовки необходимо проверить сопоставления атрибутов и выражения, чтобы получить желаемый результат. Корпорация Майкрософт рекомендует использовать фильтры области в **области объектов источника** , чтобы проверить сопоставления с помощью нескольких тестовых пользователей из Azure AD. После проверки работоспособности сопоставлений можно либо удалить фильтр, либо постепенно расширять его, добавляя больше пользователей.

1. Поле " **действия целевого объекта** " поддерживает только операцию **обновления** .

1. В таблице сопоставление в разделе **сопоставления атрибутов** можно сопоставить следующие Azure Active Directory атрибуты с SuccessFactors. В следующей таблице приведены инструкции по сопоставлению атрибутов обратной записи. 

   | \# | Атрибут Azure AD | Атрибут SuccessFactors | Remarks |
   |--|--|--|--|
   | 1 | employeeId | персонидекстернал | По умолчанию этот атрибут является соответствующим идентификатором. Вместо employeeId можно использовать любой другой атрибут Azure AD, который может хранить значение, равное Персонидекстернал в SuccessFactors.    |
   | 2 | mail | email | Источник атрибута адреса электронной почты. В целях тестирования можно сопоставлять userPrincipalName с электронной почтой. |
   | 3 | 8448 | емаилтипе | Это постоянное значение является значением идентификатора SuccessFactors, связанным с бизнес-электронной почтой. Обновите это значение в соответствии со средой SuccessFactors. Инструкции по заданию этого значения см. в разделе [Получение постоянного значения для емаилтипе](#retrieve-constant-value-for-emailtype) . |
   | 4 | true | емаилиспримари | Используйте этот атрибут, чтобы задать бизнес-адрес электронной почты как основной в SuccessFactors. Если бизнес-почта не является основной, установите для этого флага значение false. |
   | 5 | userPrincipalName | [custom01 – custom15] | С помощью команды **Добавить новое сопоставление**можно дополнительно записать userPrincipalName или любой атрибут Azure AD в настраиваемый атрибут, доступный в объекте пользователя SuccessFactors.  |
   | 6 | локальный — samAccountName | username | С помощью команды **Добавить новое сопоставление**можно при необходимости сопоставить локальные SamAccountName с атрибутом username SuccessFactors. |
   | 7 | Единый вход | логинмесод | Если клиент SuccessFactors настроен для [частичного единого входа](https://apps.support.sap.com/sap/support/knowledge/en/2320766), то при помощи команды "добавить новое сопоставление" при необходимости можно задать для логинмесод постоянное значение "SSO" или "pwd". |
   | 8 | TelephoneNumber | бусинессфоненумбер | Используйте это сопоставление для передачи *telephoneNumber* из Azure AD в SuccessFactors рабочий или рабочий номер телефона. |
   | 9 | 10605 | бусинессфонетипе | Это постоянное значение является значением идентификатора SuccessFactors, связанным с рабочим телефоном. Обновите это значение в соответствии со средой SuccessFactors. Инструкции по заданию этого значения см. в разделе [Получение постоянного значения для фонетипе](#retrieve-constant-value-for-phonetype) . |
   | 10 | true | бусинессфонеиспримари | Используйте этот атрибут, чтобы задать основной флаг для номера рабочего телефона. Допустимые значения: true или false. |
   | 11 | mobile | целлфоненумбер | Используйте это сопоставление для передачи *telephoneNumber* из Azure AD в SuccessFactors рабочий или рабочий номер телефона. |
   | 12 | 10606 | целлфонетипе | Это постоянное значение является значением идентификатора SuccessFactors, связанным с сотовым телефоном. Обновите это значение в соответствии со средой SuccessFactors. Инструкции по заданию этого значения см. в разделе [Получение постоянного значения для фонетипе](#retrieve-constant-value-for-phonetype) . |
   | 13 | false | целлфонеиспримари | Используйте этот атрибут, чтобы задать основной флаг для номера сотового телефона. Допустимые значения: true или false. |
 
1. Проверьте и проверьте сопоставления атрибутов. 
 
    >[!div class="mx-imgBorder"]
    >![Сопоставление атрибутов обратной записи](./media/sap-successfactors-inbound-provisioning/writeback-attribute-mapping.png)

1. Нажмите кнопку **сохранить** , чтобы сохранить сопоставления. Далее мы будем обновлять выражения API пути JSON, чтобы использовать коды Фонетипе в экземпляре SuccessFactors. 
1. Выберите **Показать расширенные параметры**. 

    >[!div class="mx-imgBorder"]
    >![Отображение дополнительных параметров](./media/sap-successfactors-inbound-provisioning/show-advanced-options.png)

1. Щелкните **изменить список атрибутов для SuccessFactors**. 

   > [!NOTE] 
   > Если параметр **изменить список атрибутов для SuccessFactors** не отображается в портал Azure, используйте URL-адрес *https://portal.azure.com/?Microsoft_AAD_IAM_forceSchemaEditorEnabled=true* для доступа к странице. 

1. Столбец **выражение API** в этом представлении отображает выражения пути JSON, используемые соединителем. 
1. Обновите выражения пути JSON для рабочего телефона и сотового телефона, чтобы использовать значение идентификатора (*бусинессфонетипе* и *целлфонетипе*), соответствующее вашей среде. 

    >[!div class="mx-imgBorder"]
    >![Изменение пути JSON для телефона](./media/sap-successfactors-inbound-provisioning/phone-json-path-change.png)

1. Нажмите кнопку **сохранить** , чтобы сохранить сопоставления.

## <a name="enable-and-launch-user-provisioning"></a>Включение и запуск подготовки пользователей

После завершения настройки SuccessFactors подготовки приложений вы можете включить службу подготовки в портал Azureе.

> [!TIP]
> По умолчанию при включении службы подготовки она инициализирует операции подготовки для всех пользователей в области. При возникновении ошибок сопоставления или данных задание подготовки может завершиться сбоем и переходить в состояние карантина. Чтобы избежать этого, рекомендуется настроить фильтр **Область исходного объекта** и протестировать сопоставления атрибутов с несколькими тестовыми пользователями перед запуском полной синхронизации всех пользователей. После проверки работоспособности сопоставлений и получения желаемых результатов можно либо удалить фильтр, либо постепенно расширять его, добавляя больше пользователей.

1. На вкладке **Подготовка** установите для параметра **Состояние подготовки** значение **Вкл**.

2. Выберите команду **Сохранить**.

3. Эта операция начнет начальную синхронизацию, что может занять переменное количество часов в зависимости от количества пользователей в клиенте SuccessFactors. Можно проверить индикатор выполнения, чтобы отслеживать ход выполнения цикла синхронизации. 

4. В любой момент можно проверить вкладку **Журналы аудита** на портале Azure, чтобы узнать, какие действия выполнила служба подготовки. В журналах аудита перечислены все индивидуальные события синхронизации, выполняемые службой подготовки, например, какие пользователи считываются из центрального сотрудника, а затем добавляются или обновляются для Active Directory. 

5. После завершения первичной синхронизации на вкладке **Подготовка** будет создан сводный отчет аудита, как показано ниже.

   > [!div class="mx-imgBorder"]
   > ![Индикатор выполнения подготовки](./media/sap-successfactors-inbound-provisioning/prov-progress-bar-stats.png)

## <a name="supported-scenarios-known-issues-and-limitations"></a>Поддерживаемые сценарии, известные проблемы и ограничения

См. [раздел сценарии обратной записи](../app-provisioning/sap-successfactors-integration-reference.md#writeback-scenarios) в справочном руководстве по интеграции SAP SuccessFactors. 

## <a name="next-steps"></a>Дальнейшие действия

* [Подробный справочник по интеграции Azure AD и SAP SuccessFactors](../app-provisioning/sap-successfactors-integration-reference.md)
* [Сведения о просмотре журналов и получении отчетов о действиях по подготовке](../app-provisioning/check-status-user-account-provisioning.md)
* [Узнайте, как настроить единый вход между SuccessFactors и Azure Active Directory](successfactors-tutorial.md)
* [Узнайте, как интегрировать другие приложения SaaS с Azure Active Directory](tutorial-list.md).
* [Узнайте, как экспортировать и импортировать конфигурации подготовки.](../app-provisioning/export-import-provisioning-configuration.md)

