---
title: Непрерывная оценка доступа в Azure AD
description: Реагирование на изменения состояния пользователя быстрее с непрерывной оценкой доступа в Azure AD
services: active-directory
ms.service: active-directory
ms.subservice: conditional-access
ms.topic: conceptual
ms.date: 04/21/2020
ms.author: joflore
author: MicrosoftGuyJFlo
manager: daveba
ms.reviewer: jlu
ms.collection: M365-identity-device-management
ms.openlocfilehash: e5b70c11cd6bc24f945b437decf22586cfb97557
ms.sourcegitcommit: af1cbaaa4f0faa53f91fbde4d6009ffb7662f7eb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/22/2020
ms.locfileid: "81873307"
---
# <a name="continuous-access-evaluation"></a>Непрерывная оценка доступа

Службы Майкрософт, такие как Azure Active Directory (Azure AD) и Office 365, используют открытые стандарты и протоколы для максимальной совместимости. Одним из наиболее важных из них является Open ID Connect (OIDC). Когда клиентское приложение, такое как Outlook, подключается к такой службе, как Exchange Online, запросы API авторизуются с помощью токенов доступа OAuth 2.0. По умолчанию эти токены доступа действительны в течение одного часа. По истечении срока действия этого клиента перенаправляется обратно в Azure AD для его обновления. Это также дает возможность пересмотреть политики для доступа пользователей - мы можем отказаться от обновления маркера из-за политики условного доступа или из-за того, что пользователь был отключен в каталоге. 

Мы слышали подавляющее обратной связи от наших клиентов: часовой перерыв из-за срока службы маркера доступа для повторного применения политики условного доступа и изменения в состоянии пользователя (например: отключен из-за furlough) не достаточно хорошо.

Корпорация Майкрософт была одним из первых участников инициативы по непрерывной оценке доступа (CAEP) в рамках рабочей группы [по общим сигналам и событиям](https://openid.net/wg/sse/) в Фонде OpenID. Поставщики идентификационных данных и заинтересованные стороны смогут использовать события безопасности и сигналы, определенные рабочей группой, для повторного авторизации или прекращения доступа. Это захватывающая работа и повысит безопасность на многих платформах и приложениях.

Поскольку преимущества безопасности настолько велики, мы внедряем первоначальную реализацию, разработанную корпорацией Майкрософт параллельно с нашей постоянной работой в органах по стандартизации. Работая над развертыванием этих возможностей непрерывной оценки доступа (CAE) в службах Майкрософт, мы многому научились и делимся этой информацией с сообществом стандартов. Мы надеемся, что наш опыт развертывания может помочь проинформировать еще более высокий отраслевой стандарт и привержены внедрению этого стандарта после ратификации, что позволит всем участвующим службам воспользоваться преимуществами.

## <a name="how-does-cae-work-in-microsoft-services"></a>Как CAE работает в службах Майкрософт?

Мы сосредоточиваем наше первоначальное внедрение непрерывной оценки доступа для Exchange и Teams. Мы надеемся расширить поддержку других служб Майкрософт в будущем. Мы начнем проводить постоянную оценку доступа только для арендаторов, не имеющих политик условного доступа. Мы будем использовать наши знания, полученные на этом этапе CAE, для информирования о нашем постоянном развертывании CAE.

## <a name="service-side-requirements"></a>Требования к стороне обслуживания

Непрерывная оценка доступа осуществляется, позволяя службам (поставщикам ресурсов) подписаться на критические события в Azure AD, чтобы эти события могли быть оценены и приведены в исполнение практически в режиме реального времени. Следующие события будут приведены в исполнение в этом первоначальном развертывании CAE:

- Учетная запись пользователя удалена или отключена
- Пароль для пользователя изменен или спрозан
- Админ явно аннулирует все маркеры обновления для пользователя
- Повышенный риск пользователя, обнаруженный Azure AD Identity Protection

В будущем мы надеемся добавить больше событий, включая такие события, как изменения местоположения и состояния устройства. **Хотя наша цель заключается в обеспечении соблюдения будет мгновенным, в некоторых случаях задержка до 15 минут может наблюдаться из-за времени распространения событий.** 

## <a name="client-side-claim-challenge"></a>Вызов требования на стороне клиента

Перед непрерывной оценкой доступа клиенты всегда будут пытаться воспроизвести токен доступа из кэша, пока он не истек. С помощью CAE мы вводим новый случай, согласно которым поставщик ресурсов может отклонить токен, даже если срок его действия не истек. Для того, чтобы информировать клиентов об обходе кэша, даже если кэшированные токены не истекли, мы вводим механизм, называемый **вызовом претензии.** CAE требует обновления клиента, чтобы понять вызов претензии. Последняя версия следующих приложений ниже вызова претензии поддержки:

- Перспективы для Windows 
- Outlook iOS 
- Outlook Android 
- Outlook Mac 
- Команды для Windows
- Команды iOS 
- Команды Android 
- Команды Mac 

## <a name="token-lifetime"></a>Token Lifetime

Поскольку риск и политика оцениваются в режиме реального времени, клиенты, которые ведут переговоры о непрерывной оценке доступа, будут полагаться на caE вместо существующих политик и продолжительности жизни токенов, а это означает, что настраиваемая политика жизни маркеров больше не будет соблюдаться для клиентов, способных caE вести переговоры о сеансах, связанных с CAE.

Мы увеличим срок службы маркеров до 24 часов на сеансах CAE. Отзыв обусловлен критическими событиями и оценкой политики, а не произвольным периодом времени. Это изменение повышает стабильность приложений, не влияя на вашу безопасность. 

## <a name="example-flows"></a>Пример потоков

### <a name="user-revocation-event-flow"></a>Поток событий отзыва пользователей:

![Поток событий отзыва пользователей](./media/concept-fundamentals-continuous-access-evaluation/user-revocation-event-flow.png)

1. Клиент, способный caE, представляет учетные данные или маркер обновления AAD с просьбой предоставить токен доступа для некоторых ресурсов.
1. Токен доступа возвращается клиенту вместе с другими артефактами.
1. Администратор явно [аннулирует все маркеры обновления для пользователя.](https://docs.microsoft.com/powershell/module/azuread/revoke-azureaduserallrefreshtoken?view=azureadps-2.0) Событие отзыва будет отправлено поставщику ресурсов из Azure AD.
1. Токен доступа представлен поставщику ресурсов. Поставщик ресурсов оценивает достоверность токена и проверяет, есть ли событие отзыва у пользователя. Поставщик ресурсов использует эту информацию, чтобы принять решение предоставить доступ к ресурсу или нет.
1. В этом случае поставщик ресурсов отказывает в доступе и отправляет клиенту претензию 401 "обратно"
1. Клиент, способный CAE, понимает, что претензия 401 ". Он обходит кэши и возвращается к шагу 1, отправляя свой маркер обновления вместе с требованием претензии обратно в Azure AD. Azure AD затем пересмотрит все условия и подскажет пользователю повторной аутентификации в этом случае.
 
## <a name="faqs"></a>Часто задаваемые вопросы

### <a name="what-is-the-lifetime-of-my-access-token"></a>Какова продолжительность жизни моего токена доступа?

Если вы не используете клиентов, способных caE, срок службы токенов по умолчанию по-прежнему составит 1 час, если вы не настроили срок службы маркера доступа с функцией предварительного просмотра [Configurable Token Lifetime (CTL).](../develop/active-directory-configurable-token-lifetimes.md)

Если вы используете клиентов, способных к проведению CAE, которые ведут переговоры о сеансах, связанных с ОСАГО, ваши настройки CTL для срока службы Access Token будут перезаписаны, а срок службы Access Token составит 24 часа.

### <a name="how-quick-is-enforcement"></a>Насколько быстро правоприменение?

Хотя наша цель состоит в том, чтобы обеспечить соблюдение, чтобы быть мгновенным, в некоторых случаях задержка до 15 минут может наблюдаться из-за времени распространения событий.

### <a name="how-will-cae-work-with-sign-in-frequency"></a>Как CAE будет работать с частотой ввоза?

Частота ввоза будет соблюдаться с или без CAE.

## <a name="next-steps"></a>Дальнейшие действия

[Объявление непрерывной оценки доступа](https://techcommunity.microsoft.com/t5/azure-active-directory-identity/moving-towards-real-time-policy-and-security-enforcement/ba-p/1276933)
