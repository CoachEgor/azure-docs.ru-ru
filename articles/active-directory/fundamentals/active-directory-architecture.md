---
title: Общие сведения об архитектуре Azure Active Directory | Документация Майкрософт
description: Сведения о том, что такое клиент Azure Active Directory и как управлять Azure с помощью Azure Active Directory.
services: active-directory
author: eross-msft
manager: daveba
ms.service: active-directory
ms.subservice: fundamentals
ms.workload: identity
ms.topic: conceptual
ms.date: 05/23/2019
ms.author: lizross
ms.reviewer: jeffsta
ms.custom: it-pro, seodec18
ms.collection: M365-identity-device-management
ms.openlocfilehash: aed332f32fa9fdc154c72e45914e642a9dad4993
ms.sourcegitcommit: 41ca82b5f95d2e07b0c7f9025b912daf0ab21909
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/13/2019
ms.locfileid: "67055710"
---
# <a name="what-is-the-azure-active-directory-architecture"></a>Что такое архитектура Azure Active Directory?
Azure Active Directory (Azure AD) позволяет безопасно управлять доступом к службам и ресурсам Azure пользователей, а также содержит полный набор возможностей управления удостоверениями. Дополнительные сведения о возможностях Azure AD см. в статье [Что такое Microsoft Azure Active Directory](active-directory-whatis.md).

Благодаря Azure AD вы можете создавать пользователей и группы и управлять ими, разрешая и запрещая доступ к корпоративным ресурсам на основе разрешений. Дополнительные сведения об управлении удостоверениями см. в [этой статье](active-directory-whatis.md).

## <a name="azure-ad-architecture"></a>Архитектура Azure AD
Географически распределенная архитектура Azure AD сочетает в себе расширенные возможности мониторинга, автоматического перенаправления, отработки отказа и восстановления, которые предоставляют клиентам доступность и производительность корпоративного класса.

В этой статье рассматриваются следующие элементы архитектуры:
 *  схема архитектуры службы;
 *  Масштабируемость
 *  Постоянная доступность
 *  Центры обработки данных

### <a name="service-architecture-design"></a>Схема архитектуры службы
Наиболее распространенный способ создания доступной и удобной в использовании системы с большим количеством данных заключается в использовании независимых стандартных блоков или единиц масштабирования на уровне данных Azure AD. Эти единицы масштабирования называются *разделами*. 

На уровне данных содержится несколько интерфейсных служб, обеспечивающих возможность чтения и записи. На следующей схеме показано, как компоненты раздела каталога доставляются на протяжении всего географически распределенных центров обработки данных. 

  ![Схема раздела каталога](./media/active-directory-architecture/active-directory-architecture.png)

К компонентам архитектуры Azure AD относятся первичная реплика и вторичные реплики.

**Первичная реплика**

*Первичная реплика* принимает все операции *записи* раздела, к которому она относится. Перед возвращением успешного ответа вызывающей стороне все операции записи сразу же реплицируются на вторичную реплику в другом центре обработки данных, что обеспечивает геоизбыточную устойчивость этих операций.

**Вторичные реплики**

Все directory *считывает* обслуживаются из *вторичных реплик*, расположенных в центрах обработки данных, которые физически находятся в разных географических регионах. Данные реплицируются асинхронно, поэтому вы можете иметь большое количество вторичных реплик. Операции чтения в каталоге, такие как запросы проверки подлинности, обслуживаются из центров обработки данных, которые ближе клиентам. Вторичные реплики отвечают за масштабируемость операций чтения.

### <a name="scalability"></a>Масштабируемость

Масштабируемость — это возможность расширения службы в соответствии с растущими требованиями к производительности. Изменение количества операций записи обеспечивается за счет секционирования, а операций чтения — за счет репликации данных из одного раздела на несколько вторичных реплик, распределенных по всему миру.

Запросы от приложений каталога направляются в ближайший центр обработки данных. Операции записи явным образом перенаправляются на первичную реплику, что позволяет обеспечить согласованность операций чтения и записи. Вторичные реплики значительно расширяют масштаб разделов, так как большую часть времени каталоги обрабатывают операции чтения.

Приложения каталога подключаются к ближайшим центрам обработки данных. Это повышает производительность и, следовательно, предоставляет возможности масштабирования. Так как разделы каталога могут иметь большое количество вторичных реплик, эти реплики можно размещать ближе к клиентам каталога. Только внутренние компоненты службы каталогов с большим количеством операций записи непосредственно используют активную первичную реплику.

### <a name="continuous-availability"></a>Постоянная доступность

Доступность (или время непрерывной работы) определяет возможность системы работать без перебоя. Ключом к высокой доступности Azure AD является то, что служб быстро распределять трафик между несколькими географически распределенных центров обработки данных. Каждый центр обработки данных является независимым, позволяющее режимы сбоя не коррелируют. Через эту схему высокого уровня доступности Azure AD не простаивают для действий по обслуживанию.

Архитектура разделов Azure AD не такая сложная по сравнению с архитектурой AD предприятия. Архитектура с одной первичной репликой включает тщательно организованный и детерминированный процесс отработки отказа первичной реплики.

**Отказоустойчивость**

Чтобы обеспечить более высокую доступность системы, необходимо реализовать ее устойчивость к сбоям оборудования, сети и программного обеспечения. Для каждого раздела в каталоге назначена основная реплика с высоким уровнем доступности — это первичная реплика. Эта реплика обрабатывает только операции записи на определенный раздел. Она постоянно находится под тщательным контролем, а в случае обнаружения сбоя операции записи немедленно перенаправляются на другую реплику (которая становится новой первичной репликой). Во время отработки отказа доступность для записи может быть потеряна на 1–2 минуты. Эта операция не влияет на доступность для чтения.

Операции чтения (которые численно превышают количество операций записи) направляются только на вторичные реплики. Так как вторичные реплики идемпотентные, потеря одной из них в определенном разделе легко возмещается за счет перенаправления операций чтения на другую реплику, расположенную обычно в том же центре обработки данных.

**Устойчивость данных**

Операция записи надежно фиксируется по по крайней мере двумя центрами обработки данных перед подтверждением. Это происходит по первой фиксируется на первичной, а затем немедленно реплицируется хотя бы один другой центр обработки данных. Это действие записи гарантирует, что на возможную необратимой потерей размещения основного центра обработки данных приводит к потере данных.

Azure AD поддерживает нулевое значение [цели времени восстановления (RTO)](https://en.wikipedia.org/wiki/Recovery_time_objective), что позволяет не терять данные во время отработок отказа. А именно:
-  выдача токенов и чтение каталога;
-  RTO для операций записи в каталог на уровне 5 минут.

### <a name="datacenters"></a>Центры обработки данных

Реплики Azure AD хранятся в центрах обработки данных, расположенных по всему миру. Дополнительные сведения см. в разделе [глобальная инфраструктура Azure](https://azure.microsoft.com/global-infrastructure/).

Azure AD работает в центрах обработки данных со следующими характеристиками:

 * Службы проверки подлинности, Graph и другие службы AD находятся за службой шлюза. Шлюз управляет балансировкой нагрузки этих служб. При обнаружении неработоспособных серверов с использованием транзакционных проб работоспособности он автоматически выполняет отработку отказа. В зависимости от этих проб шлюз динамически направляет трафик в работоспособные центры обработки данных.
 * Для *считывает*, каталог имеет вторичные реплики и соответствующие интерфейсные службы в конфигурации активный активный в нескольких центрах обработки данных. В случае сбоя всего центра обработки данных, весь трафик автоматически направляется в другой центр обработки данных.
 *  Для *записывает*, каталог будет выполнена отработка отказа первичной (основной) в центрах обработки данных с помощью запланированных (новая первичная синхронизируется со старой) или экстренного процесса отработки отказа. Устойчивость данных достигается за счет репликации всех фиксаций по по крайней мере двумя центрами обработки данных.

**Согласованность данных**

Модель каталога обеспечивает окончательную согласованность данных. Типичная проблема, связанная с распределенными асинхронно реплицированными системами, заключается в том, что данные, возвращенные из определенной реплики, могут не всегда отражать последние изменения. 

Azure AD обеспечивает согласованность операций чтения и записи для приложений, использующих вторичную реплику, направляя их операции записи на первичную реплику и синхронно возвращая эти операции на вторичную реплику.

Операции записи приложения, выполняемые с помощью API Graph службы Azure AD, абстрагируются от сохранения сходства с репликой каталога для согласованности операций чтения и записи. Служба Azure AD Graph поддерживает логический сеанс, который имеет сходство с вторичной репликой, используемой для операций чтения; сходство сохраняется в маркера реплики «», что, кэшируемом службой graph с помощью распределенного кэша в центре обработки данных вторичной реплики. Затем этот токен используется в последующих операциях в том же логическом сеансе. Чтобы продолжить, используется логический сеанс, последующие запросы должны направляться в одном центре обработки данных Azure AD. Невозможно продолжить логический сеанс, если клиент directory запрашивает маршрутизируются в нескольких центрах обработки данных Azure AD; в этом случае клиент имеет несколько логических сеансов, имеющих независимых согласованностью чтения и записи.

 >[!NOTE]
 >Операции записи немедленно реплицируются на вторичную реплику, для которой были выданы операции чтения логического сеанса.
 >

**Резервное копирование**

Чтобы упростить процесс восстановления случайно удаленных пользователей и клиентов, в каталоге используется обратимое удаление вместо необратимого. Если администратор клиента случайно удалил пользователей, он может легко отменить удаление и восстановить их. 

Azure AD выполняет ежедневное резервное копирование всех данных и поэтому может принудительно восстановить данные в случае их логического удаления или повреждения. На уровне данных применяются коды исправления ошибок. Это позволяет проверять наличие ошибок и автоматически исправлять определенные типы ошибок диска.

**Метрики и мониторы**

Для выполнения службы с высоким уровнем доступности требуются метрики и возможности мониторинга мирового уровня. Azure AD постоянно анализирует метрики работоспособности основных служб и предоставляет сведения о них, а также о критериях успешной работы каждой из этих служб. Кроме того, постоянно разрабатываются и настраиваются метрики, возможности мониторинга и создания оповещений для каждого сценария в каждой службе Azure AD и во всех остальных службах.

Если какая-либо служба Azure AD не работает должным образом, немедленно предпринимается действие по восстановлению ее работоспособности. Самая важная метрика, отслеживаемая Azure AD, — это скорость обнаружения и устранения проблем на рабочем сайте клиента. Мы вложили много ресурсов в возможности мониторинга и создания оповещений, чтобы минимизировать время на обнаружение (менее 5 минут) и устранение (менее 30 минут) проблемы.

**Защита операций**

Мы используем операционные элементы управления, такие как многофакторная проверка подлинности (MFA), для всех операций, а также ведем аудит всех операций. Кроме того, мы используем JIT-систему повышения прав, чтобы предоставлять необходимый временный доступ к любой рабочей задаче по запросу на постоянной основе. Дополнительные сведения см. на странице [Надежное облако](https://azure.microsoft.com/support/trust-center).

## <a name="next-steps"></a>Дальнейшие действия
[Руководство разработчика по Azure Active Directory](https://docs.microsoft.com/azure/active-directory/develop/active-directory-developers-guide)

