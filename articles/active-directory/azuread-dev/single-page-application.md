---
title: Одностраничные приложения в Azure Active Directory
description: В этой статье описываются одностраничные приложения (SPA) и основные понятия, касающиеся потока протокола, регистрации и срока действия маркеров для приложений такого типа.
services: active-directory
author: rwike77
manager: CelesteDG
ms.service: active-directory
ms.subservice: azuread-dev
ms.workload: identity
ms.topic: conceptual
ms.date: 09/24/2018
ms.author: ryanwi
ms.reviewer: saeeda, jmprieur
ms.custom: aaddev
ROBOTS: NOINDEX
ms.openlocfilehash: adf3c5b5cd40a9ea3f07ba9c92cfc4544ca60f1e
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "80154752"
---
# <a name="single-page-applications"></a>Одностраничные приложения

[!INCLUDE [active-directory-azuread-dev](../../../includes/active-directory-azuread-dev.md)]

Одностраничные приложения (SPA), как правило, структурированы как слой представления JavaScript (передний конец), который работает в браузере, и задняя часть Web API, которая работает на сервере и реализует бизнес-логику приложения. Чтобы узнать больше о неявном разрешении и помочь вам решить, подходит ли он сценарию приложения, см. [Понимание неявного потока грантов OAuth2 в active Directory Azure Active.](v1-oauth2-implicit-grant-flow.md)

В этом сценарии при входе пользователя в систему интерфейсная часть JavaScript использует [библиотеку проверки подлинности Active Directory для JavaScript (ADAL.JS)](https://github.com/AzureAD/azure-activedirectory-library-for-js) и неявное предоставление авторизации для получения маркера идентификатора (id_token) из Azure AD. Маркер кэшируется, а клиент присоединяет его к запросу как маркер носителя при отправке вызовов в свою серверную часть веб-API, для защиты которого применяется ПО промежуточного слоя OWIN.

## <a name="diagram"></a>Схема

![Схема одностраничного приложения](./media/authentication-scenarios/single-page-app.png)

## <a name="protocol-flow"></a>Поток использования протокола

1. Пользователь переходит в веб-приложение.
1. Приложение возвращает браузеру интерфейс (уровень представления данных) JavaScript.
1. Пользователь выполняет вход, например щелкает ссылку входа. Браузер отправляет инструкцию GET в конечную точку авторизации Azure AD для запроса идентификатора маркера. Этот запрос содержит идентификатор приложения и URL-адрес ответа.
1. Azure AD проверяет URL-адрес ответа путем его сравнения с зарегистрированным URL-адресом ответа, который указан на портале Azure.
1. Пользователь выполняет вход на странице входа.
1. Если аутентификация успешна, Azure AD создает маркер идентификатора и возвращает его в виде фрагмента URL-адреса (кв) в URL-адрес ответа приложения. В рабочем приложении для этого URL-адреса ответа должен использоваться протокол HTTPS. Возвращаемый маркер содержит утверждения о пользователе и системе Azure AD, которые требуются приложению для проверки маркера.
1. Клиентский код JavaScript, работающий в браузере, извлекает маркер из ответа, используемого при обеспечении безопасности вызовов на задней энд естер Web API приложения.
1. Браузер вызывает заднюю часть web API приложения с маркером ID в заголовке авторизации. Служба проверки подлинности Azure AD выдает маркер идентификатора, который можно использовать в качестве маркера носителя, если ресурс совпадает с идентификатором клиента (в таком случае это возможно, так как веб-API является серверной частью приложения).

## <a name="code-samples"></a>Примеры кода

Ознакомьтесь с [примерами кода для сценариев одностраничного приложения](sample-v1-code.md#single-page-applications). Периодически проверяйте этот раздел, так как он регулярно пополняется новыми примерами.

## <a name="app-registration"></a>Регистрация приложения

* Единый арендатор - Если вы строите приложение только для вашей организации, оно должно быть зарегистрировано в каталоге вашей компании с помощью портала Azure.
* Multi-tenant - Если вы строите приложение, которое может быть использовано пользователями за пределами организации, оно должно быть зарегистрировано в каталоге вашей компании, но также должно быть зарегистрировано в каталоге каждой организации, который будет использовать приложение. Чтобы ваше приложение сделать доступным в чужом каталоге, можно реализовать процесс входа для клиентов, с помощью которого они смогут предоставлять вашему приложению требуемые разрешения. При входе клиентов в приложение для них будет отображаться диалоговое окно с разрешениями, которые требуются приложению. В этом окне также можно будет предоставить требуемые разрешения. В зависимости от необходимых разрешений может потребоваться, чтобы их предоставил администратор из другой организации. Если пользователь или администратор предоставляет требуемые разрешения, приложение регистрируется в их каталоге.

После регистрации приложения его необходимо настроить для использования протокола неявного предоставления разрешения OAuth 2.0. По умолчанию для приложений этот протокол отключен. Чтобы включить протокол предоставления неявного гранта OAuth2 для вашего приложения, отредкройте его манифест приложения с портала Azure и установите значение "oauth2AllowImplicitFlow" в реальность. Дополнительные сведения см. в статье [Манифест приложения Azure Active Directory](../develop/reference-app-manifest.md?toc=/azure/active-directory/azuread-dev/toc.json&bc=/azure/active-directory/azuread-dev/breadcrumb/toc.json).

## <a name="token-expiration"></a>Срок действия маркера

Использование ADAL.js поможет вам:

* обновить просроченный маркер;
* запросить маркер доступа для вызова ресурса веб-API.

После успешной проверки подлинности Azure AD записывает файл cookie в браузере пользователя, чтобы установить сеанс. Обратите внимание, что сеанс устанавливается между пользователем и Azure AD, а не между пользователем и веб-приложением. По истечении срока действия маркера файл ADAL.js использует этот сеанс для автоматического получения другого маркера. ADAL.js использует скрытый элемент iFrame, чтобы отправлять и получать запросы по протоколу неявного предоставления разрешения OAuth. ADAL.js также может использовать этот же механизм для бесшумного получения токенов доступа для других веб-ресурсов API, которые вызывает приложение, если эти ресурсы поддерживают совместное использование ресурсов между собой (CORS), зарегистрированы в каталоге пользователя, и любое требуемое согласие было данный пользователем при входе в систему.

## <a name="next-steps"></a>Дальнейшие действия

* Дополнительные сведения см. в статье [о других типах приложений и сценариях](app-types.md)
* Узнайте об [основах аутентификации](v1-authentication-scenarios.md) Azure AD
