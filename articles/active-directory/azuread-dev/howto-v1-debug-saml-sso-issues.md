---
title: Отладка единого входа на основе SAML в Azure Active Directory | Документы Майкрософт
description: Отладка единого входа на основе SAML в приложениях в Azure Active Directory.
services: active-directory
author: rwike77
manager: CelesteDG
ms.service: active-directory
ms.subservice: azuread-dev
ms.topic: conceptual
ms.workload: identity
ms.date: 02/18/2019
ms.author: ryanwi
ms.custom: aaddev
ms.reviewer: luleon, hirsin, paulgarn
ROBOTS: NOINDEX
ms.openlocfilehash: 5d92b43b47a20a75d2c8b6becb69cfee5829e80f
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "80154854"
---
# <a name="debug-saml-based-single-sign-on-to-applications-in-azure-active-directory"></a>Отладка единого входа на основе SAML в приложениях в Azure Active Directory

[!INCLUDE [active-directory-azuread-dev](../../../includes/active-directory-azuread-dev.md)]

Узнайте, как найти и устранить проблемы с [единым входом](../manage-apps/what-is-single-sign-on.md) для приложений в Azure Active Directory (Azure AD) с поддержкой [языка разметки заявлений системы безопасности (SAML) 2.0](https://en.wikipedia.org/wiki/Security_Assertion_Markup_Language). 

## <a name="before-you-begin"></a>Перед началом

Мы рекомендуем установить [расширение защищенного входа в мои приложения](../user-help/my-apps-portal-end-user-troubleshoot.md#im-having-trouble-installing-the-my-apps-secure-sign-in-extension). Это расширение браузера позволяет легко собирать запрос SAML и информацию о ответе SAML, что вам нужно для решения проблем с одним всданным. Если вы не можете установить расширение, ознакомьтесь с этой статьей, которая описывает решение проблем при наличии или отсутствии этого расширения.

Перейдите по одной из следующих ссылок, чтобы загрузить и установить расширение защищенного входа в мои приложения.

- [Chrome](https://go.microsoft.com/fwlink/?linkid=866367)
- [Microsoft Edge](https://go.microsoft.com/fwlink/?linkid=845176)
- [Firefox](https://go.microsoft.com/fwlink/?linkid=866366)

## <a name="test-saml-based-single-sign-on"></a>Тестирование единого входа на основе SAML

Чтобы протестировать одиночный знак на основе SAML между Azure AD и целевым приложением:

1. Войдите на [портал Azure](https://portal.azure.com) как глобальный администратор или другой администратор с правами на управление приложениями.
1. В левом лезвии выберите **Активный каталог Azure,** а затем выберите **приложения Enterprise.** 
1. Из списка корпоративных приложений выберите приложение, для которого вы хотите протестировать один очный знак, а затем из опций слева выберите **Единый поднос.**
1. Чтобы открыть SAML на основе одного знака тестирования опыт, перейдите к **тесту одного знака** (шаг 5). Если кнопка **Test** поседенна, необходимо сначала заполнить и сохранить необходимые атрибуты в разделе **Basic SAML Configuration.**
1. В колонке **Тестирование единого входа** введите корпоративные учетные данные, чтобы войти в целевое приложение. Вы можете выполнить вход как текущий пользователь или как другой пользователь. Если вы войдете от имени другого пользователя, откроется окно проверки подлинности.

    ![Скриншот, показывающий тестовую страницу SAML SSO](./media/howto-v1-debug-saml-sso-issues/test-single-sign-on.png)

Если вы успешно выполнили вход, тест пройден. В этом случае Azure AD выдает маркер ответа SAML приложению. Приложение использует маркер SAML, чтобы обработать ваш вход.

Если на странице входа компании или на странице приложения отображается ошибка, воспользуйтесь инструкциями из следующих разделов, чтобы решить ее.

## <a name="resolve-a-sign-in-error-on-your-company-sign-in-page"></a>Решение ошибки входа на странице входа компании

При попытке войти в систему может возникнуть ошибка на странице регистрации компании, аналогичная следующему примеру.

![Пример ошибки на странице регистрации компании](./media/howto-v1-debug-saml-sso-issues/error.png)

Чтобы устранить эту ошибку, вам понадобится сообщение об ошибке и запрос SAML. Расширение защищенного входа в мои приложения автоматически собирает эту информацию и отображает инструкции по решению проблемы в Azure AD.

### <a name="to-resolve-the-sign-in-error-with-the-my-apps-secure-sign-in-extension-installed"></a>Для устранения ошибки в входе с установленным расширением моего безопасного ввоза

1. При возникновении ошибки расширение перенаправляет вас обратно в **одиночный клинок** Azure AD Test.
1. На **тесте одного знака на** лезвие, выберите **Скачать запрос SAML**.
1. Отобразятся инструкции по устранению в зависимости от ошибки и значений в запросе SAML.
1. Вы увидите кнопку **Исправление его** для автоматического обновления конфигурации в Azure AD для устранения проблемы. Если вы не видите эту кнопку, то проблема в ввходе не из-за неправильной настройки на Azure AD.

Если не предусмотрено разрешение ошибки в входе, мы предлагаем вам использовать текстовый ящик обратной связи, чтобы сообщить нам.

### <a name="to-resolve-the-error-without-installing-the-my-apps-secure-sign-in-extension"></a>Устранение ошибки без установки безопасного расширения ввигирования моих приложений

1. Скопируйте сообщение об ошибке в нижнем правом углу страницы. В сообщении об ошибке указывается:
    - CorrelationID и Timestamp. Эти значения важно указать при обращении в службу поддержки корпорации Майкрософт. Это поможет нашим инженерам быстрее определить проблему и найти ей решение.
    - Инструкция, определяющая первопричину проблемы.
1. Вернитесь в Azure AD и найдите колонку **Тестирование единого входа**.
1. В текстовое поле над пунктом **Получить рекомендации по устранению** вставьте сообщение об ошибке.
1. Нажмите **Получить рекомендации по устранению**, чтобы просмотреть инструкции по устранению ошибки. Для рекомендаций может потребоваться информация из запроса SAML или ответа SAML. Если вы не используете расширение безопасности вхольного ввоза My Apps, вам может понадобиться такой инструмент, как [Fiddler](https://www.telerik.com/fiddler) для получения запроса samL и ответа.
1. Убедитесь, что пункт назначения в запросе SAML соответствует URL-адресу службы единого знака SAML, полученному из Azure AD.
1. Проверка эмитента в запросе SAML — это тот же идентификатор, который вы настроили для приложения в Azure AD. В Azure AD значение издателя используется для поиска приложения в каталоге.
1. Verify AssertionConsumerServiceURL — это место, где приложение ожидает получить токен SAML от Azure AD. Вы можете настроить это значение в Azure AD, но оно не является обязательным, если оно является частью запроса SAML.


## <a name="resolve-a-sign-in-error-on-the-application-page"></a>Устранение ошибки входа на странице приложения

Ошибка на странице приложения может отображаться даже после успешного входа. Это происходит в случае, когда Azure AD выдает приложению маркер, но приложение не принимает ответ.

Чтобы устранить ошибку, выполните следующие действия.

1. Если приложение находится в галерее Azure AD, убедитесь, что вы выполнили все действия по интеграции приложения с Azure AD. Инструкции по интеграции для приложения вы найдете в [руководствах по интеграции приложений SaaS](../saas-apps/tutorial-list.md).
1. Получите ответ SAML.
    - Если расширение защищенного входа в мои приложения установлено, в колонке **Тестирование единого входа** нажмите **Загрузить ответ SAML**.
    - Если расширение не установлено, получите ответ SAML с помощью дополнительного средства, например [Fiddler](https://www.telerik.com/fiddler).
1. Обратите внимание на следующие элементы в маркере ответа SAML:
   - Уникальный идентификатор пользователя значения и формата NameID
   - Утверждения, выданные в маркере
   - Сертификат, использованный для подписи маркера.

     Дополнительные сведения об ответе SAM см. в статье [Протокол единого входа SAML](../develop/single-sign-on-saml-protocol.md?toc=/azure/active-directory/azuread-dev/toc.json&bc=/azure/active-directory/azuread-dev/breadcrumb/toc.json).

1. Теперь, когда вы рассмотрели ответ SAML, [см. Ошибку на странице приложения после входной](../manage-apps/application-sign-in-problem-application-error.md) регистрации для получения рекомендаций о том, как решить проблему. 
1. Если вы все еще не можете войти в систему успешно, вы можете спросить поставщика приложений, чего не хватает в ответе SAML.

## <a name="next-steps"></a>Дальнейшие действия

Теперь, когда один вход работает на ваше приложение, вы можете [автоматизировать подготовку пользователя и де-подготовки к приложениям SaaS](../manage-apps/user-provisioning.md) или [начать работу с условным доступом.](../conditional-access/app-based-conditional-access.md)
