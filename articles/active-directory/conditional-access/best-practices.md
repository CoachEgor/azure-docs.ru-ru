---
title: Рекомендации по работе с условным доступом в Azure Active Directory | Документация Майкрософт
description: Необходимые сведения о том, что нужно и не нужно делать при настройке политики условного доступа.
services: active-directory
keywords: условный доступ к приложениям, условный доступ посредством Azure Active Directory, безопасный доступ к ресурсам организации, политики условного доступа
documentationcenter: ''
author: MicrosoftGuyJFlo
manager: daveba
editor: ''
ms.assetid: 8c1d978f-e80b-420e-853a-8bbddc4bcdad
ms.service: active-directory
ms.subservice: conditional-access
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: identity
ms.date: 01/25/2019
ms.author: joflore
ms.reviewer: calebb
ms.collection: M365-identity-device-management
ms.openlocfilehash: 54cb8c3017b2b0a4c476095ba639985fb9418441
ms.sourcegitcommit: 2028fc790f1d265dc96cf12d1ee9f1437955ad87
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/30/2019
ms.locfileid: "64917316"
---
# <a name="best-practices-for-conditional-access-in-azure-active-directory"></a>Рекомендации по работе с условным доступом в Azure Active Directory

С помощью [условного доступа Azure Active Directory (Azure AD)](../active-directory-conditional-access-azure-portal.md) можно контролировать доступ авторизованных пользователей к облачным приложениям. В этой статье вы ознакомитесь:

- с важными сведениями; 
- а также тем, чего не нужно делать при настройке политики условного доступа. 

Перед прочтением этой статьи следует ознакомиться с основными понятиями и терминами, связанными с [условным доступом в Azure Active Directory](../active-directory-conditional-access-azure-portal.md).



## <a name="whats-required-to-make-a-policy-work"></a>Что необходимо для работы политики?

При создании политики отсутствуют выбранные пользователи, группы, приложения или элементы управления доступом.

![Облачные приложения](./media/best-practices/02.png)


Чтобы привести политику в работоспособное состояние, необходимо настроить следующее.


| Что           | Как                                  | Назначение |
| :--            | :--                                  | :-- |
| **Облачные приложения** |Выберите одно или несколько приложений.  | Политика условного доступа предназначена для управления способом доступа авторизованных пользователей к облачным приложениям.|
| **Пользователи и группы** | Выберите по меньшей мере одного пользователя или группу, которая имеет права для доступа к выбранным облачным приложениям. | Политика условного доступа, которой не назначены пользователи и группы, не активируется. |
| **Элементы управления доступом** | Выберите по меньшей мере один элемент управления доступом. | Процессор политики должен знать, что делать в случае выполнения условий. |




## <a name="what-you-should-know"></a>Необходимая информация



### <a name="how-are-conditional-access-policies-applied"></a>Как применяются политики условного доступа?

При доступе к облачному приложению может применяться несколько политик условного доступа. В этом случае условия всех применяемых политик должны быть выполнены. Например, если для одной политики требуется MFA, а для другой требуется соответствующее устройство, необходимо пройти MFA и использовать соответствующее устройство. 

Все политики применяются в два этапа.

- На **первом** этапе оцениваются все политики и собираются все элементы управления доступом, требованиях которых не выполнены. 

- На **втором** этапе вам будет предложено удовлетворить невыполненные требования. Если хотя бы одна из политик блокирует доступ, вас заблокируют без приглашения выполнить требования других элементов управления политики. Если этого не случится, вы получите приглашение выполнить требования других элементов управления политики в следующем порядке.

    ![Порядок](./media/best-practices/06.png)
    
    Далее следуют внешние поставщики MFA и условия использования.



### <a name="how-are-assignments-evaluated"></a>Проверка назначений

Все назначения выполняются с помощью логического оператора **AND**. Если вы настроили несколько назначений, для активации политики все назначения должны быть выполнены.  

Если необходимо настроить условие расположения, которое применяется ко всем подключениям за пределами сети вашей организации, сделайте следующее:

- включите **все расположения**;
- исключите **все надежные IP-адреса**.


### <a name="what-to-do-if-you-are-locked-out-of-the-azure-ad-admin-portal"></a>Что делать, если доступ к порталу администрирования Azure AD для вас заблокирован?

Если доступ к порталу администрирования Azure AD для вас заблокирован из-за неправильной настройки политики условного доступа, сделайте следующее:

- Проверьте, есть ли в вашей организации администраторы, доступ которым не заблокирован. Администратор с доступом к порталу Azure может отключить политику, влияющую на вход в систему. 

- Если ни один из администраторов в организации не может обновить политику, необходимо отправить запрос в службу поддержки. В службе технической поддержки Майкрософт просмотрят и обновят политики условного доступа, которые препятствуют доступу.


### <a name="what-happens-if-you-have-policies-in-the-azure-classic-portal-and-azure-portal-configured"></a>Что произойдет, если настроить политики на классическом портале Azure и на портале Azure?  

Azure Active Directory применяет обе политики, и пользователь получает доступ только в том случае, если все требования соблюдены.

### <a name="what-happens-if-you-have-policies-in-the-intune-silverlight-portal-and-the-azure-portal"></a>Что произойдет, если настроить политики на портале Intune Silverlight и портале Azure?

Azure Active Directory применяет обе политики, и пользователь получает доступ только в том случае, если все требования соблюдены.

### <a name="what-happens-if-i-have-multiple-policies-for-the-same-user-configured"></a>Что произойдет, если настроить несколько политик для одного пользователя?  

Во время каждого входа в систему Azure Active Directory оценивает все политики и проверяет соблюдение всех требований, прежде чем предоставить пользователю доступ. Блокирование доступа перекрывает все остальные параметры конфигурации. 


### <a name="does-conditional-access-work-with-exchange-activesync"></a>Работает ли условный доступ с Exchange Active Sync?

Да, вы можете использовать Exchange ActiveSync в политике условного доступа с некоторыми [ограничения](https://docs.microsoft.com/azure/active-directory/conditional-access/conditional-access-for-exo-and-spo#exchange-activesync). 

### <a name="how-should-you-configure-conditional-access-with-office-365-apps"></a>Как следует настроить условный доступ с помощью приложений Office 365?

Так как приложения Office 365 связаны между собой, мы рекомендуем назначение часто используемые приложения друг с другом при создании политик.

Распространенные взаимосвязанных приложений включают Microsoft Flow, планировщик (Майкрософт), Microsoft Teams, Office 365 Exchange Online, Office 365 SharePoint Online и Office 365 Yammer.

Очень важно для политик, требующих взаимодействия с пользователем, например многофакторной проверки подлинности, когда управление доступом осуществляется в начале сеанса или задачи. Если этого не сделать, пользователи не смогут выполнить некоторые задачи в приложении. Например если требуется многофакторная проверка подлинности на неуправляемых устройствах для доступа к SharePoint, но не к электронной почте, работа в электронной почте пользователи не смогут для вложения файлов SharePoint в сообщение. Дополнительные сведения можно найти в статье [Каковы зависимости служб в условном доступе Azure Active Directory?](service-dependencies.md).





## <a name="what-you-should-avoid-doing"></a>Чего следует избегать

Платформа условного доступа обеспечивает исключительную гибкость конфигурации. Тем не менее исключительная гибкость также означает, что во избежание нежелательных результатов необходимо внимательно просмотреть каждую политику конфигурации, прежде чем выпускать ее. В этом контексте следует уделить особое внимание назначениям, которые влияют на полные наборы, такие как **все пользователи / группы / облачные приложения**.

В своей среде следует избегать следующих конфигураций:


**Для всех пользователей, всех облачных приложений:**

- **Блокировка доступа** — эта конфигурация блокирует всю организацию, что явно не является хорошей идеей.

- **Требовать соответствующее требованиям устройство** — для пользователей, которые еще не зарегистрировали свои устройства, эта политика полностью блокирует доступ, включая доступ к порталу Intune. Если вы являетесь администратором без зарегистрированного устройства, то эта политика блокирует ваш доступ к порталу Azure для изменения политики.

- **Require domain join** (Требовать присоединения к домену) — эта политика блокировки доступа также имеет возможность блокировать доступ для всех пользователей организации, у которых еще нет присоединенных к домену устройств.

- **Требуется политика защиты приложений** — эта политика блокировки доступа также имеет возможность блокировать доступ для всех пользователей в вашей организации, если у вас нет политики Intune. Если вы являетесь администратором без клиентское приложение, которое имеет политику защиты приложений Intune, эта политика блокирует ваш доступ обратно в порталах, таких как Intune и Azure.

**Для всех пользователей, всех облачных приложений, всех платформ устройств:**

- **Блокировка доступа** — эта конфигурация блокирует всю организацию, что явно не является хорошей идеей.


## <a name="how-should-you-deploy-a-new-policy"></a>Как развертывать новую политику?

Сначала необходимо оценить политику с помощью [инструмента what if для условного доступа](what-if-tool.md).

Когда новые политики будут готовы для вашей среды, разверните их поэтапно.

1. Примените политику к небольшому набору пользователей и убедитесь, что она правильно работает. 

2.  При расширении политики для вмещения большего количества пользователей продолжайте исключать всех администраторов из политики, чтобы гарантировать, что они все еще имеют доступ и могут обновлять политику, если требуется изменение.

3. Применяйте политику ко всем пользователям, только если это действительно необходимо. 

Мы рекомендуем создать учетную запись пользователя, которая:

- предназначена для администрирования политики, 
- исключена из всех политик.


## <a name="policy-migration"></a>Перенос политики

Мы рекомендуем перенести политики, созданные не на портале Azure, по следующим причинам:

- Теперь вы можете работать со сценариями, которые невозможно было обрабатывать ранее.

- Можно уменьшить количество политик, которыми необходимо управлять, объединяя их.   

- Всеми политиками условного доступа можно управлять централизованно.

- Классический портал Azure больше не используется.   


Дополнительные сведения см. в статье [Перенос классических политик на портале Azure](policy-migration.md).


## <a name="next-steps"></a>Дальнейшие действия

Чтобы узнать:

- как настроить политику условного доступа, обратитесь к статье [Краткое руководство. Требование Многофакторной идентификации для конкретных приложений с помощью условного доступа Azure Active Directory](app-based-mfa.md);
- как планировать политики условного доступа, обратитесь к статье [Практическое руководство. Планирование развертывания с условным доступом в Azure Active Directory](plan-conditional-access.md).
