---
title: Условный доступ Что делать, если инструмент - Активный каталог Azure
description: Узнайте, как можно понять влияние политик условного доступа на среду.
services: active-directory
ms.service: active-directory
ms.subservice: conditional-access
ms.topic: article
ms.date: 02/25/2020
ms.author: joflore
author: MicrosoftGuyJFlo
manager: daveba
ms.reviewer: nigu
ms.collection: M365-identity-device-management
ms.openlocfilehash: dc87b434664ba12cefeb233972e749f631d8a2b4
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "77620683"
---
# <a name="troubleshoot-using-the-what-if-tool-in-conditional-access"></a>Устранение неполадок с помощью инструмента «Что если» в условном доступе

[Условная доступность](../active-directory-conditional-access-azure-portal.md) — это возможность active Directory Azure (Azure AD), которая позволяет контролировать доступ авторизованных пользователей к облачным приложениям. Как узнать, чего ожидать от политик «Условный доступ» в вашей среде? Чтобы ответить на этот вопрос, вы можете использовать **инструмент «Условный доступ, если».**

В этой статье объясняется, как можно использовать этот инструмент для тестирования политик условного доступа.

## <a name="what-it-is"></a>Что это

Инструмент **политики «Условный доступ, если»** позволяет понять влияние политик «Условный доступ» на среду. Вместо того, чтобы тестировать политики, выполняя несколько входов вручную, можно воспользоваться данным инструментом, чтобы имитировать вход пользователя. При имитации оценивается влияние входа на политики и создается отчет об имитации. В отчете перечисляются не только применяемые политики условного доступа, но и [классические политики,](policy-migration.md#classic-policies) если они существуют.    

Инструмент **What If** предоставляет способ быстрого определения политик, применимых к конкретному пользователю. Эти сведения можно использовать, например, если необходимо устранить проблему.    

## <a name="how-it-works"></a>Принцип работы

В **инструменте «Условный доступ, если если»** сначала необходимо настроить настройки сценария вхлажий, который вы хотите смоделировать. К числу этих параметров относятся следующие:

- пользователь, которого необходимо проверить; 
- облачные приложения, к которым пользователь попытается получить доступ;
- условия, при которых осуществляется доступ к настроенным облачным приложениям.
     
В качестве следующего шага можно запустить имитацию, чтобы проверить выбранные параметры. В оценке участвуют только включенные политики.

По завершении оценки инструмент создает отчет о задействованных политиках.

## <a name="running-the-tool"></a>Запуск инструмента

Вы можете найти инструмент **What If** на странице **[«Условный доступ - политики»](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ConditionalAccessBlade/Policies)** на портале Azure.

Чтобы запустить инструмент, в панели инструментов в верхней части списка политик, нажмите **Что если**.

![What If](./media/what-if-tool/01.png)

Прежде чем можно будет выполнить оценку, необходимо настроить параметры.

## <a name="settings"></a>Параметры

В этом разделе приводятся сведения о параметрах имитации.

![What If](./media/what-if-tool/02.png)

### <a name="user"></a>Пользователь

Можно выбрать только одного пользователя. Это единственное обязательное для заполнения поле.

### <a name="cloud-apps"></a>Облачные приложения

Значение по умолчанию для этого параметра — **Все облачные приложения**. При значении по умолчанию выполняется оценка всех доступных политик в вашей среде. Можно сузить область оценки до политик, влияющих на конкретные облачные приложения.

### <a name="ip-address"></a>IP-адрес

IP-адрес — это отдельный IPv4-адрес, необходимый для имитации [условия расположения](location-condition.md). Адрес представляет веб-адрес устройства, используемого пользователем для входа. Можно проверить IP-адрес устройства, например, перейдя по ссылке [What is my IP address](https://whatismyipaddress.com) (Определить мой IP-адрес).    

### <a name="device-platforms"></a>Платформы устройств

Этот параметр имитирует [условие платформы устройства](concept-conditional-access-conditions.md#device-platforms) и представляет эквивалент параметра **Все платформы (в том числе и неподдерживаемые)**. 

### <a name="client-apps"></a>Клиентские приложения

Этот параметр имитирует [условие клиентских приложений](concept-conditional-access-conditions.md#client-apps-preview).
По умолчанию этот параметр вызывает оценку всех политик, для которых выбран параметр **Браузер** или **Мобильные приложения и настольные клиенты** (или оба эти параметра). Он также позволяет обнаружить политики, которые принудительно используют **Exchange ActiveSync (EAS)**. Область этого параметра можно сузить, выбрав:

- **Браузер** для оценки всех политик, для которых выбран по крайней мере параметр **Браузер**; 
- **Мобильные приложения и настольные клиенты** для оценки всех политик, для которых выбран по крайней мере параметр **Мобильные приложения и настольные клиенты**. 

### <a name="sign-in-risk"></a>Риск при входе

Этот параметр имитирует [условие риска при входе](concept-conditional-access-conditions.md#sign-in-risk).   

## <a name="evaluation"></a>Ознакомительная версия 

Вы начинаете оценку, нажав **Что если**. После оценки предоставляется отчет, содержащий: 

![What If](./media/what-if-tool/03.png)

- индикатор существования классических политик в вашей среде;
- политики, которые применяются к вашему пользователю;
- политики, которые не применяются к вашему пользователю.

Если для выбранных облачных приложений существуют [классические политики](policy-migration.md#classic-policies), то отчет содержит соответствующий индикатор. Щелкнув этот индикатор, можно перейти на страницу классических политик. На странице классических политик можно перенести классическую политику или просто отключить ее. Закрыв эту страницу, можно вернуться к результату оценки.

В списке политик, применимых к выбранного вами пользователю, вы также можете найти список [элементов управления грантом,](concept-conditional-access-grant.md) а [элементы управления сеансом,](concept-conditional-access-session.md) которые должен удовлетворить пользователь.

В списке политик, которые не применяются к пользователю, можно также найти причины, по которым эти политики не применяются. Для каждой из перечисленных политик причина представляет первое условие, которое не было выполнено. Возможной причиной для политики, которая не применяется, является отключение политики ввиду того, что она в дальнейшем не оценивается.   

## <a name="next-steps"></a>Дальнейшие действия

- Если вы хотите узнать, как настроить политику условного доступа, [см.](app-based-mfa.md)
- Если вы готовы настроить политики условного доступа для [best practices for Conditional Access in Azure Active Directory](best-practices.md)среды, см. 
- Если вы хотите перенести классические политики, прочитайте раздел [Перенос классических политик на портале Azure](policy-migration.md).  
