---
title: Планирование политик условного доступа в Active Каталогaz (ru) Документы Майкрософт
description: В этой статье вы узнаете, как планировать политики условного доступа для активного каталога Azure.
services: active-directory
ms.service: active-directory
ms.subservice: conditional-access
ms.topic: conceptual
ms.date: 01/25/2019
ms.author: joflore
author: MicrosoftGuyJFlo
manager: daveba
ms.reviewer: martincoetzer
ms.collection: M365-identity-device-management
ms.openlocfilehash: e1c75d5022432a9a57b30aabec4dd2c4f76f2f29
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "78671829"
---
# <a name="how-to-plan-your-conditional-access-deployment-in-azure-active-directory"></a>Как: Планирование развертывания условного доступа в active-каталоге Azure

Планирование развертывания условия доступа имеет решающее значение для достижения требуемой стратегии доступа к приложениям и ресурсам в организации. Проводите большую часть времени на этапе планирования развертывания для разработки различных политик, необходимых для предоставления или блокирования доступа к пользователям в определенных условиях. В этом документе разъясняется, какие шаги следует предпринять для реализации политик «Безопасный и качественный доступ». Прежде чем начать, убедитесь, что вы [понимаете,](overview.md) как работает условный доступ и когда вы должны его использовать.

## <a name="what-you-should-know"></a>Необходимая информация

Думайте об условном доступе как о системе, которая позволяет контролировать доступ к приложениям и ресурсам организации, а не к автономной функции. Следовательно, некоторые параметры условного доступа требуют настройки дополнительных функций. Например, можно настроить политику так, чтобы она реагировала на определенный [уровень риска входа в систему](../identity-protection/howto-identity-protection-configure-risk-policies.md). Но для того, чтобы политика учитывала такой уровень риска, должна быть включена [Защита идентификации Azure Active Directory](../identity-protection/overview-identity-protection.md).

Если применяются дополнительные функции, могут потребоваться лицензии для них. Например, в то время как Условный доступ является функцией Azure AD Premium P1, для защиты идентификационных данных требуется лицензия Azure AD Premium P2.

Существует два типа политик условного доступа: базовый и стандартный. [Базовая политика](baseline-protection.md) — это предопределенная политика условного доступа. Такие политики обеспечивают минимальный (базовый) уровень безопасности. Базовые политики доступны во всех выпусках AAD, но у них ограниченные возможности настройки. Если ваш сценарий требует гибкости, отключите базовую политику и реализуйте свои требования в виде настраиваемой стандартной политики.

В стандартной политике условного доступа можно настроить все настройки для настройки политики в соответствии с бизнес-требованиями. Для использования стандартных политик требуется лицензия Azure AD Premium P1.

>[!NOTE]
> Мы рекомендуем использовать политику условного доступа Azure AD на основе Azure AD, чтобы получить наилучшее правоприменение после первоначальной проверки подлинности устройства. Это включает в себя закрытие сессий, если устройство выпадает из соответствия и потока кода устройства.

## <a name="draft-policies"></a>Черновые политики

Условная доступность Azure Active Directory позволяет вывести защиту облачных приложений на новый уровень. Вы можете определять возможность доступа к облачному приложению на основе динамической оценки, а не жесткой конфигурации. С помощью политики «Условный доступ» вы определяете ответ **(сделай это)** к состоянию доступа **(когда это произойдет).**

![Причина и ответ](./media/plan-conditional-access/10.png)

Определите каждую политику условного доступа, которая необходимо реализовать с помощью этой модели планирования. Планирование позволяет выполнить следующие задачи:

- Правильно структурировать ответы и условия для каждой политики.
- Результаты в хорошо задокументированном каталоге политики условного доступа для организации. 

Этот каталог позволяет оценить, соответствует ли реализация политики реальным бизнес-требованиям вашей организации. 

Используйте следующий пример шаблона для создания политик условного доступа для организации:

|В *этом* случае:|Сделать *это*:|
|-|-|
|Выполняется попытка доступа:<br>- В облачное приложение*<br>- пользователями и группами*<br>Вместе с этим:<br>— Условие 1 (например, за пределами корпоративной сети)<br>— Условие 2 (например, платформы устройств)|Блокировать доступ к приложению|
|Выполняется попытка доступа:<br>- В облачное приложение*<br>- пользователями и группами*<br>Вместе с этим:<br>— Условие 1 (например, за пределами корпоративной сети)<br>— Условие 2 (например, платформы устройств)|Предоставить доступ с ограничениями (условное "И"):<br>— Требование 1 (например, многофакторная проверка подлинности)<br>— Требование 2 (например, соответствие устройств)|
|Выполняется попытка доступа:<br>- В облачное приложение*<br>- пользователями и группами*<br>Вместе с этим:<br>— Условие 1 (например, за пределами корпоративной сети)<br>— Условие 2 (например, платформы устройств)|Предоставить доступ с ограничениями (условное "ИЛИ"):<br>— Требование 1 (например, многофакторная проверка подлинности)<br>— Требование 2 (например, соответствие устройств)|

Раздел **в этом случае** определяет субъект (**кто**), который пытается получить доступ к облачному приложению (**что**). При необходимости здесь можно добавить дополнительные характеристики попытки доступа (**как**). В Условиях доступа элементы, определяющие, кто, что и как известны как условия. Для получения дополнительной информации см. [Каковы условия в условном доступе к обыкновению активного каталога Azure?](concept-conditional-access-conditions.md) 

В разделе **сделать это** вы определяете ответ политики на состояние доступа. В этом ответе можно блокировать или предоставить доступ, в том числе с дополнительными требованиями, например с многофакторной проверкой подлинности (MFA). Полный обзор читайте [в элементе управления доступом в условьном доступе Azure Active Directory?](controls.md)  

Сочетание условий с элементами управления доступом представляет собой политику условного доступа.

![Причина и ответ](./media/plan-conditional-access/51.png)

См. дополнительные сведения о [применении политик](best-practices.md#whats-required-to-make-a-policy-work).

Итак, сейчас самое время выбрать стандарт именования для ваших политик. Стандарт именования позволит быстро находить нужные политики и понимать их назначение, не открывая настройки политики на портале администрирования Azure. Назовите свою политику, чтобы показать:

- порядковый номер;
- облачное приложение, к которому она применяется;
- Ответ
- к кому она применяется;
- когда применяется (если применима).
 
![Стандарт именования](./media/plan-conditional-access/11.png)

В то время как описательное имя помогает сохранить обзор реализации условного доступа, номер последовательности полезен, если вам нужно ссылаться на политику в разговоре. Например, если вы говорите коллегу администратора по телефону, вы можете попросить его открыть политику EM063 для решения проблемы.

Например, следующее имя указывает на то, что эта политика требует применить многофакторную проверку подлинности для пользователей из группы маркетинга, использующих приложение Dynamics CRP в любой внешней сети:

`CA01 - Dynamics CRP: Require MFA For marketing When on external networks`

Кроме активных политик, целесообразно определить некоторые отключенные политики, которые будут служить дополнительным [средством контроля доступа при сбоях или в аварийном режиме](../authentication/concept-resilient-controls.md). Ваш стандарт именования для политик на случай непредвиденных обстоятельств должен включать еще несколько пунктов: 

- `ENABLE IN EMERGENCY` в начале, чтобы выделить имя среди других политик;
- имя нарушения, к которому должна применяться политика;
- порядковый номер, помогающий администратору узнать, какой по счету должна быть включена эта политика. 

Например, следующее имя указывает, что эта политика является первой политикой из четырех, которые вы должны включить, если есть нарушение МИД:

`EM01 - ENABLE IN EMERGENCY, MFA Disruption[1/4] - Exchange SharePoint: Require hybrid Azure AD join For VIP users`

## <a name="plan-policies"></a>Планирование политик

При планировании решения политики условного доступа оцените, нужно ли создавать политики для достижения следующих результатов. 

### <a name="block-access"></a>Заблокировать доступ

Действие блокировки доступа — это очень мощный инструмент, который:

- имеет более высокий приоритет, чем любые другие назначения для пользователя;
- позволяет блокировать вход в клиент для всей организации сразу.
 
Если вы намерены заблокировать доступ для всех пользователей, обязательно определите хотя бы одно исключение (обычно это учетные записи для аварийного доступа). См. дополнительные сведения о [выборе пользователей и облачных приложений](block-legacy-authentication.md#select-users-and-cloud-apps).  

### <a name="require-mfa"></a>Требовать многофакторную идентификацию

Чтобы упростить процесс входа пользователей, им можно разрешить выполнять вход в облачные приложения с помощью имени пользователя и пароля. Но чаще всего есть смысл потребовать боле строгую проверку учетной записи хотя бы для некоторых сценариев доступа. С помощью политики условного доступа можно ограничить требование МИД определенными сценариями. 

Вот несколько вариантов, в которых обычно требуется MFA:

- [вход с правами администратора](howto-baseline-protect-administrators.md);
- [доступ к конкретным приложениям](app-based-mfa.md); 
- [вход из сетевых расположений, которым вы не доверяете](untrusted-networks.md).

### <a name="respond-to-potentially-compromised-accounts"></a>Реагирование на потенциально скомпрометированные учетные записи

С помощью политик «Условный доступ» можно реализовать автоматизированные ответы на входы из потенциально скомпрометированных идентификаторов. Вероятность компрометации учетной записи выражается в виде уровней риска. Служба защиты идентификации вычисляет два уровня риска: риск входа и риск пользователя. Чтобы реализовать ответ на риск входа, вы можете использовать два механизма:

- [Условие риска ввески](concept-conditional-access-conditions.md#sign-in-risk) в политике условного доступа
- [политика риска входа](../identity-protection/howto-sign-in-risk-policy.md) в службе защиты идентификации. 

Мы рекомендуем обрабатывать риск входа как условия, так как это предоставляет больше параметров для настройки.

Уровень риска пользователя доступен только как [политика риска пользователя](../identity-protection/howto-user-risk-policy.md) в Защите идентификации. 

См. дополнительные сведения о [Защите идентификации Azure Active Directory](../identity-protection/overview.md). 

### <a name="require-managed-devices"></a>Требование доступа с управляемых устройств

Широкое разнообразие поддерживаемых устройств для доступа к облачным ресурсам помогает повысить эффективность работы пользователей. С другой стороны, вы наверняка захотите оградить некоторые ресурсы в корпоративной среде от доступа устройств с неизвестным уровнем защиты. Для всех таких ресурсов нужно настроить ограничение, разрешающее доступ только с управляемых устройств. Для получения дополнительной информации [см. Как требовать управляемых устройств для доступа к облачным приложениям с помощью условия условного доступа.](require-managed-devices.md) 

### <a name="require-approved-client-apps"></a>Требование доступа из утвержденных клиентских приложений

В сценариях использования собственных устройств (BYOD) вам нужно как можно раньше решить, нужно ли управлять всем устройством или только данными на нем. Ваши сотрудники используют мобильные устройства как в личных целях, так и для выполнения рабочих задач. Помимо обеспечения эффективности работы сотрудников требуется предотвратить возможную потерю данных. С помощью условного доступа Azure Active Directory (Azure AD) можно ограничить доступ к облачным приложениям утвержденным клиентским приложениям, которые могут защитить ваши корпоративные данные. Для получения дополнительной информации [см. Как требовать утвержденных клиентских приложений для доступа к облачным приложениям с помощью условия условного доступа.](app-based-conditional-access.md)

### <a name="block-legacy-authentication"></a>Блокировка устаревших методов проверки подлинности

AAD поддерживает несколько широко распространенные протоколы проверки подлинности и авторизации, часть из которых уже устарела. Как же запретить доступ к ресурсам клиента всем приложениям, которые используют устаревшую проверку подлинности? Рекомендация состоит в том, чтобы просто заблокировать их с помощью политики условного доступа. Если потребуется, вы сможете разрешить отдельным пользователям использовать конкретные приложения с устаревшей проверкой подлинности из конкретных сетевых расположений. Для получения дополнительной информации [см. Как заблокировать устаревшую аутентификацию в Azure AD с помощью условного доступа.](block-legacy-authentication.md)

## <a name="test-your-policy"></a>Тестирование политики

Прежде, чем развернуть политику в рабочей среде, следует проверить ее и убедиться, что все работает правильно.

1. Создание тестовых пользователей
1. Создание плана тестирования
1. Настройка политики
1. Оценка смоделированного входа
1. Тестирование политики
1. Очистка

### <a name="create-test-users"></a>Создание тестовых пользователей

Чтобы проверить политику, создайте группу пользователей с характеристиками реальных пользователей в рабочей среде. Создав тестовых пользователей, вы убедитесь, что все политики работают правильно, прежде чем применять их к реальным пользователям и создавать риск нарушения доступа к приложениям и ресурсам. 

Некоторые организации используют для таких целей тестовые клиенты. Но воссоздание всех условий и приложений из реальной среды в тестовом клиенте, чтобы полностью протестировать результат применения политики, может оказаться сложной задачей. 

### <a name="create-a-test-plan"></a>Создание плана тестирования

План тестирования нужен для того, чтобы сравнить ожидаемые и фактически полученные результаты. Прежде, чем тестировать любые компоненты, вы должны знать, что вы ожидаете получить. В следующей таблице приведены примеры тестовых случаев. Скорректируйте эти сценарии и ожидаемые результаты с учетом параметров ваших политик условного доступа.

|Политика |Сценарий |Ожидаемый результат | Результат |
|---|---|---|---|
|[Требовать MFA для доступа не с рабочего места](/azure/active-directory/conditional-access/untrusted-networks)|Авторизованный пользователь входит в *приложение*, находясь в надежном расположении (на рабочем месте)|Пользователю не нужно выполнять MFA| |
|[Требовать MFA для доступа не с рабочего места](/azure/active-directory/conditional-access/untrusted-networks)|Авторизованный пользователь входит в *приложение*, находясь в ненадежном расположении (не на рабочем месте)|Пользователю предлагается выполнить MFA и он может успешно войти| |
|[Требовать MFA для администраторов](/azure/active-directory/conditional-access/howto-baseline-protect-administrators)|Глобальный администратор входит в *приложение*|Администратору предлагается выполнить MFA| |
|[Рискованные вхливы](/azure/active-directory/identity-protection/howto-sign-in-risk-policy)|Пользователь входит в *приложение* с помощью [браузера Tor](/azure/active-directory/active-directory-identityprotection-playbook)|Администратору предлагается выполнить MFA| |
|[Управление устройствами](/azure/active-directory/conditional-access/require-managed-devices)|Авторизованный пользователь пытается войти с авторизованного устройства|Предоставляется доступ| |
|[Управление устройствами](/azure/active-directory/conditional-access/require-managed-devices)|Авторизованный пользователь пытается войти с неавторизованного устройства|Доступ блокируется| |
|[Изменение пароля для пользователей с высоким уровнем риска](/azure/active-directory/identity-protection/howto-user-risk-policy)|Авторизованный пользователь пытается войти с использованием скомпрометированных учетных данных (высокий риск входа)|В соответствии с политикой пользователю предлагается изменить пароль, иначе доступ блокируется| |

### <a name="configure-the-policy"></a>Настройка политики

Управление политиками условного доступа — ручная задача. На портале Azure вы можете управлять политиками условного доступа в одном центральном месте - странице условного доступа. Одной из отправных точек на странице условного доступа является раздел **безопасности** в навигационном стеле **Active Directory.** 

![Условный доступ](media/plan-conditional-access/03.png)

Если вы хотите узнать больше о том, [Require MFA for specific apps with Azure Active Directory Conditional Access](app-based-mfa.md)как создать политики условного доступа, см. Это краткое руководство поможет вам:

- ознакомиться с пользовательским интерфейсом;
- Получите первое впечатление о том, как работает условный доступ. 

### <a name="evaluate-a-simulated-sign-in"></a>Оценка смоделированного входа

Теперь, когда вы настроили политику условного доступа, вероятно, вы захотите узнать, работает ли она так, как ожидалось. В качестве первого шага используйте инструмент «Условный [доступ», если инструмент политики](what-if-tool.md) будет имитировать вход в систему пользователя теста. При имитации оценивается влияние входа на политики и создается отчет об имитации.

>[!NOTE]
> Хотя смоделированный запуск создает впечатление о воздействии политики условного доступа, он не заменяет фактический тестовый запуск.

### <a name="test-your-policy"></a>Тестирование политики

Выполните тестовые случаи, включенные в план тестирования. На этом шаге вы выполните полное тестирование для каждой политики с тестовыми пользователями, чтобы убедиться в правильности работы всех политик. Используйте созданные выше сценарии для выполнения каждого теста.

Здесь важно убедиться, что вы правильно проверяете определенные в политике критерии исключения. Предположим, что вы исключили пользователя или группу из политики, которая требует использовать MFA. Проверьте, если исключены пользователи вызваны для МИД, потому что сочетание других политик может потребовать МИД для этих пользователей.

### <a name="cleanup"></a>Очистка

Процедура очистки состоит из следующих шагов:

1. Отключение политики.
1. Удаление всех назначенных пользователей и групп.
1. Удаление тестовых пользователей.  

## <a name="move-to-production"></a>Перенос в рабочую среду

Когда новые политики будут готовы для вашей среды, разверните их поэтапно.

- Проинформируйте пользователей об изменениях.
- Для начала примените политику к небольшой группе пользователей и убедитесь, что она правильно работает.
- Развертывая политику для остальных пользователей, временно исключите из нее всех администраторов. Исключение администраторов из политики позволит сохранить доступ на случай, если потребуются изменения этой политики.
- Применяйте политику ко всем пользователям, только если это действительно необходимо.

Мы рекомендуем создать хотя бы одну учетную запись пользователя, которая:

- предназначена для администрирования политики,
- исключена из всех политик.

## <a name="rollback-steps"></a>Процедура отката

Если потребуется выполнить откат для только что примененной политики, попробуйте одно или несколько из следующих действий:

1. **Отключите политику**. Отключение политики гарантирует, что она не применяется при попытке пользователя выполнить вход. Вы всегда можете вернуться и включить политику, когда потребуется ее использовать.

   ![Отключение политики](media/plan-conditional-access/07.png)

1. **Исключите пользователя или группу из политики**. Если пользователь не может получить доступ к приложению, попробуйте исключить его из политики.

   ![Исключение пользователей](media/plan-conditional-access/08.png)

   > [!NOTE]
   > Этот вариант следует применять ограниченно и только к тем пользователям, которым вы доверяете. Пользователь или группа должны быть добавлены обратно в политику, как только это станет возможным.

1. **Удалите политику**. Если политика больше не требуется, удалите ее.

## <a name="next-steps"></a>Дальнейшие действия

См. дополнительные сведения об с [условном доступе AAD](index.yml).
