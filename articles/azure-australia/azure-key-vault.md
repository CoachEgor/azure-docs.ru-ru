---
title: Azure Key Vault в Австралии Azure
description: Руководство по настройке и использованию Azure Key Vault для управления ключами в австралийских регионах в соответствии с определенными требованиями политики Австралии правительства, нормативных актов и законодательства.
author: galey801
ms.service: azure-australia
ms.topic: conceptual
ms.date: 07/22/2019
ms.author: grgale
ms.openlocfilehash: 263765c777f994134befc52f0c63c7f18e590b39
ms.sourcegitcommit: 15f7b641a67f3d6cf4fb4b4c11eaee18cf335923
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/29/2019
ms.locfileid: "68602114"
---
# <a name="azure-key-vault-in-azure-australia"></a>Azure Key Vault в Австралии Azure

Безопасное хранение криптографических ключей и управление жизненным циклом криптографического ключа являются критически важными элементами в криптографических системах.  Служба, которая предоставляет эту возможность в Azure, — это Azure Key Vault. Key Vault IRAP безопасность и ACSC сертифицирована для защиты.  В этой статье рассматриваются ключевые моменты, которые следует учитывать при использовании Key Vault для обеспечения соответствия стандартным элементам управления "ручное оповещение" (ASD) [Information Security](https://acsc.gov.au/infosec/ism/) принимало (ISM).

Azure Key Vault — это облачная служба, которая защищает ключи и секреты шифрования. Поскольку эти данные являются конфиденциальными и являются критически важными для бизнеса, Key Vault обеспечивает безопасный доступ к хранилищам ключей, разрешая только полномочные пользователи и приложения. Существует три основных артефакта, управляемых и контролируемых Key Vault:

- ключи
- секреты
- сертификаты

В этой статье основное внимание уделяется управлению ключами с помощью Key Vault.

![Хранилище Azure Key Vault](media/azure-key-vault-overview.png)

*Схема 1 — Azure Key Vault*

## <a name="key-design-considerations"></a>Основные рекомендации по проектированию

### <a name="deployment-options"></a>Параметры развертывания

Существует два варианта создания хранилища ключей Azure. Оба варианта используют семейство аппаратных модулей безопасности (HSM) Thales nShield, являются федеральными стандартами обработки информации (FIPS) и утверждаются для хранения ключей в ЗАЩИЩЕНных средах. Доступны следующие параметры.

- **Защищенные программные хранилища:** Проверен уровень 1 FIPS 140-2. Ключи, хранящиеся в HSM. Операции шифрования и расшифровки выполняются в ресурсах вычислений в Azure.
- **Защищенные от HSM хранилища:** Проверен уровень 2 FIPS 140-2. Ключи, хранящиеся в HSM. Операции шифрования и расшифровки выполняются в HSM.

Key Vault поддерживает ключи шифрования Ривест-Шамир-Адельман (RSA) и эллиптических кривых (ECC). По умолчанию используется RSA 2048-разрядный ключ, но имеется дополнительный параметр для ключей RSA 3072-bit, RSA 4096 и ECC.  Все ключи соответствуют элементам управления ISM, но предпочтительнее использовать ключи эллиптической кривой.

### <a name="resource-operations"></a>Операции с ресурсами

В Azure Key Vault участвует несколько персонажей:

- **Администратор Key Vault:** Управляет жизненным циклом хранилища
- **Администратор ключа:** Управляет жизненным циклом ключей в хранилище
- **Разработчик или оператор:** Интеграция ключей из хранилища в приложения и службы
- **Аудитор** Мониторинг использования ключа и доступа
- **Приложения** Использование ключей для защиты информации

Azure Key Vault защищен с помощью двух отдельных интерфейсов:

- **Плоскость управления:** Эта плоскость имеет дело с управлением хранилищем и защищенным RBAC.
- **Плоскость данных:** Эта плоскость имеет дело с управлением артефактами в хранилище и доступом к ним.  Защита с помощью политики доступа Key Vault.

Согласно требованиям ISM, Правильная проверка подлинности и авторизации необходимы перед вызывающим объектом (пользователем или приложением), прежде чем они смогут получить доступ к хранилищу ключей на любой плоскости.

В Azure RBAC имеется одна встроенная роль для Key Vault, [Key Vault участник](https://docs.microsoft.com/azure/role-based-access-control/built-in-roles#key-vault-contributor), для управления управлением хранилищами ключей. Рекомендуется создать пользовательские роли, выравниваемая к более детализированным ролям для управления хранилищами ключей.

>[!WARNING]
>Если доступ к ключам разрешен через политику доступа Key Vault, то пользователь или приложение имеют доступ ко всем ключам в хранилище ключей (например, если пользователь имеет доступ "Удалить", он может удалить все ключи).  Поэтому для согласования с доменами безопасности и границами следует развернуть несколько хранилищ ключей.

### <a name="networking"></a>Сети

Вы можете настроить Key Vault брандмауэры и виртуальные сети для управления доступом к плоскости данных.  Вы можете разрешить доступ к пользователям или приложениям в определенных сетях, запретив доступ к пользователям или приложениям во всех других сетях. [Доверенные службы](https://docs.microsoft.com/azure/key-vault/key-vault-overview-vnet-service-endpoints#trusted-services) являются исключением из этого элемента управления, если включен флажок "Разрешить доверенные службы".  Управление виртуальной сетью не применяется к плоскости управления.

Доступ к хранилищам ключей должен быть явно ограничен минимальным набором сетей, в которых есть пользователи или приложения, которым требуется доступ к ключам.

### <a name="bring-your-own-key-byok"></a>Создание собственных ключей (BYOK)

Key Vault поддерживает BYOK.  BYOK позволяет пользователям импортировать ключи из существующей инфраструктуры ключей.  Thales предоставляет [набор инструментов Австралии](https://www.microsoft.com/download/details.aspx?id=45345) для поддержки безопасного перемещения и импорта ключей из внешнего HSM (например, ключи, созданные на автономной рабочей станции) в Key Vault.

### <a name="key-vault-auditing-and-logging"></a>Key Vault аудит и ведение журнала

ACSC требует, чтобы сущности Содружество использовали соответствующие службы Azure для отслеживания рабочих нагрузок Azure в режиме реального времени и создания отчетов.

Ведение журнала включено путем включения параметра диагностики **_"AuditEvent"_** в значениях ключей.  События аудита будут регистрироваться в указанной учетной записи хранения.  Период **_"RetentionInDays"_** должен быть установлен в соответствии с политикой хранения данных.  Аудит и запись в журнал выполняются для [операций](https://docs.microsoft.com/azure/key-vault/key-vault-logging#interpret) на плоскости управления и плоскости данных. [Azure Key Vault решение в Azure Monitor](https://docs.microsoft.com/azure/azure-monitor/insights/azure-key-vault) можно использовать для просмотра журналов Key Vault AuditEvent.  Для обработки и распространения Key Vault Аудитевентс можно использовать ряд других служб Azure.

### <a name="key-rotation"></a>Смена ключей

Хранение ключей в Key Vault предоставляет единую точку для хранения ключей за пределами приложений, которые позволяют обновлять ключи, не влияя на поведение приложений. Хранение ключей в Azure Key Vault включает различные стратегии для поддержки смены ключей.

- Вручную
- Программное с помощью интерфейсов API
- Скрипты автоматизации (например, с помощью PowerShell и службы автоматизации Azure)

Эти параметры позволяют периодически поворачивать ключи в соответствии с требованиями соответствия требованиям или на нерегламентированной основе, если существуют проблемы, которые могут быть скомпрометированы ключами.

#### <a name="key-rotation-strategies"></a>Стратегии смены ключей

Важно разработать подходящую стратегию смены ключей для ключей, которые хранятся в KeyVault.  Использование неправильного ключа приведет к неправильной расшифровке информации, а Потеря ключей может привести к потере доступа к информации.  Ниже приведены примеры стратегий смены ключей для различных сценариев.

- **Данные порядковых:** временные данные передаются между двумя сторонами.  При повороте ключа обе стороны должны иметь механизм для синхронного получения обновленных ключей из хранилища ключей.
- **Данные как остальные:** Субъект хранит зашифрованные данные и расшифровывает их в будущем для использования.  Когда клавиша будет повернута, данные должны быть расшифрованы с помощью старого ключа, а затем зашифрованы новым, повернутым ключом.  Существуют подходы к минимальному влиянию процесса расшифровки и шифрования с помощью ключей шифрования ключа (см. пример).  Корпорация Майкрософт управляет большинством процессов, связанных с сменой ключей для службы хранилища Azure (см...).
- **Ключи доступа.** некоторые службы Azure имеют ключи доступа, которые могут храниться в Key Vault (например, CosmosDB).  Службы Azure имеют первичные и вторичные ключи доступа.  Важно, чтобы оба ключа одновременно не поворачиваются.  Таким образом, один ключ следует поворачивать после того, как была проверена точка и операция с ключом, затем можно поворачивать второй ключ.

### <a name="high-availability"></a>Высокая надежность

ISM имеет несколько элементов управления, связанных с непрерывностью бизнес-процессов.
Azure Key Vault имеет несколько уровней избыточности с содержимым, реплицированным в пределах региона и во вторичный, [парный регион](https://docs.microsoft.com/azure/best-practices-availability-paired-regions).

Когда хранилище ключей находится в состоянии отработки отказа, оно находится в режиме только для чтения и вернется в режим чтения и записи, после чего восстанавливается основная служба.

У ISM есть несколько элементов управления, связанных с резервным копированием.  Важно разработать и выполнить соответствующие планы резервного копирования и восстановления для хранилищ и их ключей.

## <a name="key-lifecycle"></a>Жизненный цикл ключа

### <a name="key-operations"></a>Операции с ключами

Key Vault поддерживает следующие операции с ключом:

- **создания** Позволяет клиентам создавать ключи в Key Vault. Значение ключа создается в Key Vault и хранится в нем. Оно не выдается клиенту. В Key Vault можно создать асимметричные ключи.
- **импортиру** Позволяет клиентам импортировать имеющиеся ключи в Key Vault. В Key Vault можно импортировать асимметричные ключи с помощью нескольких различных способов упаковки внутри конструкции JWK.
- **обновляют** Позволяет клиентам с достаточными разрешениями изменять метаданные (атрибуты ключей), связанные с ключами, сохраненными ранее в Key Vault.
- **удален** Позволяет клиентам с достаточными разрешениями удалять ключи из Key Vault.
- **числ** Позволяет клиентам выводить полный список ключей в определенном хранилище ключей.
- **список версий:** Позволяет клиентам выводить список всех версий указанного ключа в определенном хранилище ключей.
- **Получить:** Позволяет клиентам извлекать открытые части указанного ключа из Key Vault.
- **копия** Экспорт ключей в защищенной форме.
- **восстановлен** Импорт ранее заархивированного ключа.

Существует соответствующий набор разрешений, которые могут быть предоставлены пользователям, субъектам-службам или приложениям с помощью Key Vault записей контроля доступа, чтобы они могли выполнять операции с ключами.

В Key Vault имеется функция обратимого удаления, позволяющая восстанавливать удаленные хранилища и ключи. По умолчанию **_"обратимое удаление"_** не включено, но после включения объекты удерживаются в течение 90 дней (срок хранения), а затем удаляются.  Дополнительное разрешение **_"очистить"_** позволяет удалить ключи, если параметр **_"очистить защиту"_** отключен.

При создании или импорте существующего ключа создается новая версия ключа.

### <a name="cryptographic-operations"></a>Криптографические операции

Key Vault также поддерживает криптографические операции с помощью ключей:

- **подписать и проверить:** эта операция является "хэш-хэшем" или "Проверка хэша". Key Vault не поддерживает хэширование содержимого в процессе создания подписи.
- **Шифрование и перенос ключей:** эта операция используется для защиты другого ключа.
- **Шифрование и расшифровка:** хранимый ключ используется для шифрования или расшифровки одного блока данных.

Существует соответствующий набор разрешений, которые могут быть предоставлены пользователям, субъектам-службам или приложениям с помощью Key Vault записей контроля доступа, чтобы они могли выполнять криптографические операции.

Существует три ключевых атрибута, которые можно использовать для управления включением ключа и возможностью использования криптографических операций.

- **доступной**
- **NBF:** не до того, как он был включен до указанной даты
- **EXP:** Дата истечения срока действия

## <a name="storage-and-keys"></a>Хранилище и ключи

Управляемые клиентом ключи являются большей гибкостью и позволяют контролировать контролируемые ключи и управлять ими. Они также позволяют проводить аудит ключей шифрования, используемых для защиты данных.
Существует три аспекта хранения и ключей, хранящихся в Key Vault:

- Ключи управляемой учетной записи хранения Key Vault
- Шифрование службы хранилища Azure (SSE) для неактивных данных
- Управляемые диски и шифрование дисков Azure

Управление ключами учетной записи хранения Azure Key Vault — это расширение для службы ключей Key Vault, которое поддерживает синхронизацию и повторное создание (вращение) ключей учетной записи хранения.  [Интеграция службы хранилища Azure с Azure Active Directory](https://docs.microsoft.com/azure/storage/common/storage-auth-aad) (Предварительная версия) рекомендуется в случае выпуска, так как она обеспечивает более высокую безопасность и удобство использования.
SSE использует два ключа для управления шифрованием неактивных данных:

- Ключи шифрования ключей (KEK)
- Ключи шифрования данных (DEK)

Хотя корпорация Майкрософт управляет DEK, SSE имеет возможность использовать управляемые клиентом ключи обмена ключами, которые могут храниться в Key Vault. Это позволяет переключаться между ключами в Azure Key Vault в соответствии с соответствующими политиками соответствия. Когда ключи поворачиваются, служба хранилища Azure повторно шифрует ключ шифрования учетной записи для этой учетной записи хранения. Это не приводит к повторному шифрованию всех данных, и никаких других действий не требуется.

SSE используется для управляемых дисков, но ключи, управляемые клиентом, не поддерживаются.  Шифрование управляемых дисков можно выполнить с помощью шифрования дисков Azure с KEK ключами, управляемыми клиентами, в Key Vault.

## <a name="next-steps"></a>Следующие шаги

Ознакомьтесь с статьей о [федерации удостоверений](identity-federation.md)

Ознакомьтесь с дополнительными Azure Key Vault документацией и учебниками в [справочной библиотеке](reference-library.md) .
