---
title: Внедрение IoT Plug и воспроизведения Предварительный просмотр модели открытия (ru) Документы Майкрософт
description: Как разработчик решений, узнайте, как можно реализовать обнаружение модели IoT Plug и Play в своем решении.
author: ChrisGMsft
ms.author: chrisgre
ms.date: 12/26/2019
ms.topic: conceptual
ms.custom: mvc
ms.service: iot-pnp
services: iot-pnp
manager: philmea
ms.openlocfilehash: 66da0321930ac38217a336380c9889963a433e67
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/27/2020
ms.locfileid: "75531366"
---
# <a name="implement-iot-plug-and-play-preview-model-discovery-in-an-iot-solution"></a>Внедрение обнаружения модели IoT Plug и Play Preview в решении IoT

В этой статье описывается, как разработчик решений можно реализовать обнаружение модели IoT Plug и Play Preview в решении IoT.  Обнаружение модели IoT Plug and Play — это то, как устройства IoT Plug и Play определяют поддерживаемые ими модели и интерфейсы, а также то, как решение IoT получает эти модели и интерфейсы.

Существует две широкие категории решений IoT: специально созданные решения, которые работают с известным набором устройств IoT Plug and Play, и решения, управляемые моделью, которые работают с любым устройством IoT Plug and Play.

В этой концептуальной статье описывается, как реализовать обнаружение модели в обоих типах решений.

## <a name="model-discovery"></a>Обнаружение модели

Когда устройство IoT Plug and Play впервые подключается к концентратору IoT, оно отправляет сообщение информационной телеметрии модели. Это сообщение включает в себя идоты интерфейсов, которые реализует устройство. Для работы с устройством необходимо решить эти идентионные данные и получить определения для каждого интерфейса.

Вот шаги, которые принимает устройство IoT Plug and Play, когда оно использует службу обеспечения устройств (DPS) для подключения к концентратору:

1. Когда устройство включено, оно подключается к глобальной конечной точке для DPS и проверяет подлинность с помощью одного из допустимых методов.
1. Затем DPS проверяет подлинность устройства и ищет правило, которое сообщает ему, какой концентратор IoT присвоит устройству. DPS затем регистрирует устройство с этим концентратором.
1. DPS возвращает строку соединения IoT Концентратора с устройством.
1. Затем устройство отправляет сообщение телеметрии обнаружения в ваш концентратор IoT. Телеметрическое сообщение обнаружения содержит иди интерфейсов, реализованных устройством.
1. Устройство IoT Plug and Play готово к работе с решением, которое использует ваш концентратор IoT.

Если устройство подключается непосредственно к концентратору IoT, оно подключается с помощью строки соединения, встроенной в код устройства. Затем устройство отправляет сообщение телеметрии обнаружения в ваш концентратор IoT.

Смотрите интерфейс [ModelInformation,](concepts-common-interfaces.md) чтобы узнать больше о модели информационного телеметрии сообщение.

### <a name="purpose-built-iot-solutions"></a>Решения IoT, созданные специально

Специальное решение IoT работает с известным набором моделей и интерфейсов устройств IoT Plug and Play.

Вы будете иметь модель возможностей и интерфейсы для устройств, которые будут подключаться к вашему решению заранее. Используйте следующие шаги для подготовки решения:

1. Храните интерфейс jSON файлов в Azure в месте, где ваше решение может прочитать их.
1. Напишите логику в своем решении IoT на основе ожидаемых моделей и интерфейса возможностей IoT Plug и Play.
1. Подпишитесь на уведомления от концентратора IoT, который использует ваше решение.

При получении уведомления о подключении к новому устройству выполните следующие действия:

1. Ознакомьтесь с сообщением телеметрии обнаружения, чтобы получить идентионы модели возможностей и интерфейсов, реализованных устройством.
1. Сравните идентификатор модели возможностей с идентификаторами моделей возможностей, которые вы хранили заранее.
1. Теперь вы знаете, какой тип устройства подключен. Используйте логику, о чем вы писали ранее, чтобы пользователи могли взаимодействовать с устройством надлежащим образом.

### <a name="model-driven-solutions"></a>Решения, управляемые моделью

Модельное ioT-решение может работать с любым устройством IoT Plug and Play. Создание модельного решения IoT является более сложным, но преимущество заключается в том, что ваше решение работает с любыми устройствами, добавленными в будущем.

Чтобы создать решение IoT, управляемое моделью, необходимо создать логику на основе примитивных интерфейсов IoT Plug и Play: телеметрии, свойств и команд. Логика решения IoT представляет собой устройство, комбинируя несколько возможностей телеметрии, свойств и команд.

Решение также должно подписаться на уведомления от использоватого концентратора IoT.

Когда решение получает уведомление о подключении нового устройства, выполните следующие действия:

1. Ознакомьтесь с сообщением телеметрии обнаружения, чтобы получить идентионы модели возможностей и интерфейсов, реализованных устройством.
1. Для каждого идентификатора прочитайте полный файл JSON, чтобы найти возможности устройства.
1. Проверьте, присутствует ли каждый интерфейс в кэшах, которые вы создали для хранения файлов JSON, извлеченных ранее вашим решением.
1. Затем проверьте, присутствует ли интерфейс с этим идентификатором в общедоступном репозитории модели. Для получения дополнительной информации смотрите [репозиторий общедоступной модели](howto-manage-models.md).
1. Если интерфейс не присутствует в общедоступном репозитории моделей, попробуйте найти его в репозиториях моделей компании, известных вашему решению. Для доступа к репозиторию модели компании нужна строка подключения. Для получения дополнительной [информации](howto-manage-models.md)см.
1. Если вы не можете найти все интерфейсы в публичном репозитории моделей или в репозитории модели компании, вы можете проверить, может ли устройство предоставить определение интерфейса. Устройство может реализовать стандартный интерфейс [ModelDefinition](concepts-common-interfaces.md) для публикации информации о том, как получить файлы интерфейса с командой.
1. Если вы нашли файлы JSON для каждого интерфейса, реализованного устройством, можно перечислить возможности устройства. Используйте логику, о чем вы писали ранее, чтобы пользователи могли взаимодействовать с устройством.
1. В любое время можно вызвать aPI цифровых близнецов, чтобы получить идентификатор модели возможностей и идентификаторы интерфейса для устройства.

## <a name="next-steps"></a>Дальнейшие действия

Теперь, когда вы узнали об открытии модели IoT-решения, узнайте больше о [платформе Azure IoT,](overview-iot-plug-and-play.md) чтобы использовать другие возможности для вашего решения.
