---
title: Подключение примера устройства IoT Plug and Play (предварительная версия) к Центру Интернета вещей | Документация Майкрософт
description: Создайте и запустите пример кода устройства IoT Plug and Play (предварительная версия), который подключается к Центру Интернета вещей. С помощью обозревателя Интернета вещей Azure просматривайте сведения, отправленные устройством в центр.
author: ChrisGMsft
ms.author: chrisgre
ms.date: 08/02/2019
ms.topic: quickstart
ms.service: iot-pnp
services: iot-pnp
ms.custom: mvc
ms.openlocfilehash: b233fcecfe80d1ce4464d2d02fdddb188f9265a7
ms.sourcegitcommit: b3bad696c2b776d018d9f06b6e27bffaa3c0d9c3
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/21/2019
ms.locfileid: "69881583"
---
# <a name="quickstart-connect-a-sample-iot-plug-and-play-preview-device-application-to-iot-hub"></a>Краткое руководство. Подключение примера приложения IoT Plug and Play (предварительная версия) к Центру Интернета вещей

В этом кратком руководстве показано, как создать пример приложения устройства IoT Plug and Play, подключить его к Центру Интернета вещей и с помощью обозревателя IoT Azure просмотреть сведения, отправляемые в Центр. Пример приложения написан на языке C и включен в пакет SDK для устройств Azure IoT для C. Разработчик решения может использовать обозреватель IoT Azure, чтобы ознакомиться с возможностями устройства IoT Plug and Play, не просматривая код устройства.

## <a name="prerequisites"></a>Предварительные требования

Для выполнения инструкций, указанных в этом кратком руководстве, вам необходимо установить на локальный компьютер следующее программное обеспечение:

* [Visual Studio (Community, Professional или Enterprise)](https://visualstudio.microsoft.com/downloads/). При установке Visual Studio обязательно добавьте компонент **Диспетчер пакетов NuGet** и рабочую нагрузку **Разработка классических приложений на C++** .
* [Git](https://git-scm.com/download/).
* [CMake](https://cmake.org/download/).

### <a name="install-the-azure-iot-explorer"></a>Установка обозревателя Azure IoT

Скачайте обозреватель Azure IoT со [страницы последнего выпуска](https://github.com/Azure/azure-iot-explorer/releases) и установите его на компьютере.

[!INCLUDE [cloud-shell-try-it.md](../../includes/cloud-shell-try-it.md)]

## <a name="prepare-an-iot-hub"></a>Подготовка Центра Интернета вещей

Для выполнения инструкций, приведенных в этом кратком руководстве, также необходим Центр Интернета вещей Azure в подписке Azure. Если у вас еще нет подписки Azure, [создайте бесплатную учетную запись Azure](https://azure.microsoft.com/free/?WT.mc_id=A261C142F), прежде чем начинать работу.

Добавьте расширение Интернета вещей Microsoft Azure в интерфейсе командной строки Azure:

```azurecli-interactive
az extension add --name azure-cli-iot-ext
```

Выполните приведенную ниже команду, чтобы создать удостоверение устройства в Центре Интернета вещей. Замените заполнители **YourIoTHubName** и **YourDevice** фактическими именами. Если у вас нет Центра Интернета вещей, создайте его, выполнив инструкции, указанные в [этой статье](../iot-hub/iot-hub-create-using-cli.md).

```azurecli-interactive
az iot hub device-identity create --hub-name [YourIoTHubName] --device-id [YourDevice]
```

Выполните приведенные ниже команды, чтобы получить _строку подключения к только что зарегистрированному устройству_:

```azurecli-interactive
az iot hub device-identity show-connection-string --hub-name [YourIoTHubName] --device-id [YourDevice] --output table
```

Выполните приведенные ниже команды, чтобы получить _строку подключения к вашему Центру Интернета вещей_:

```azurecli-interactive
az iot hub show-connection-string --hub-name [YourIoTHubName] --output table
```

## <a name="prepare-the-development-environment"></a>Подготовка среды разработки

### <a name="get-azure-iot-device-sdk-for-c"></a>Получение пакета SDK для устройств Azure IoT для C

С помощью этого краткого руководства вы подготовите среду разработки, которую можно использовать для клонирования и сборки пакета SDK для устройств Azure IoT для C.

Откройте окно командной строки. Выполните следующую команду для клонирования репозитория GitHub [пакета SDK для устройства C Интернета вещей Azure](https://github.com/Azure/azure-iot-sdk-c):

```cmd/sh
git clone https://github.com/Azure/azure-iot-sdk-c --recursive -b public-preview
```

Выполнение этой операции может занять несколько минут.

## <a name="build-the-code"></a>Сборка кода

Создаваемое приложение имитирует устройство, которое подключается к Центру Интернета вещей. Оно отправляет данные телеметрии и свойства, а также получает команды.

1. Создайте подкаталог `cmake` в корневой папке пакета SDK для устройства и перейдите к этой папке:

    ```cmd\sh
    cd <root folder>\azure-iot-sdk-c
    mkdir cmake
    cd cmake
    ```

1. Выполните приведенные ниже команды, чтобы собрать пакет SDK для устройства и сгенерированную заглушку кода:

    ```cmd\sh
    cmake ..
    cmake --build . -- /m /p:Configuration=Release
    ```

    > [!NOTE]
    > Если cmake не может найти ваш компилятор C++, при запуске предыдущей команды отобразятся ошибки сборки. В этом случае попробуйте выполнить эту команду в [командной строке Visual Studio](https://docs.microsoft.com/dotnet/framework/tools/developer-command-prompt-for-vs).

## <a name="run-the-device-sample"></a>Запуск примера устройства

Запустите приложение, передав в качестве параметра строку подключения к устройству Центра Интернета вещей.

```cmd\sh
cd digitaltwin_client\samples\digitaltwin_sample_device\Release
copy ..\EnvironmentalSensor.interface.json .
digitaltwin_sample_device.exe "[IoT Hub device connection string]"
```

Приложение устройства начнет отправку данных в Центр Интернета вещей.

## <a name="use-the-azure-iot-explorer-to-validate-the-code"></a>Проверка кода с помощью обозревателя Azure IoT

1. Откройте обозреватель Центра Интернета вещей Azure. Отобразится страница **конфигураций приложения**.

1. Введите строку подключения к Центру Интернета вещей и щелкните **Подключить**.

1. После подключения откроется страница обзора устройства.

1. Чтобы добавить репозиторий своей компании, выберите **Параметры** и **+ Создать**, а затем — **On the connected device** (На подключенном устройстве).

1. На странице обзора устройства найдите и выберите созданное ранее удостоверение устройства, чтобы просмотреть более подробную информацию.

1. Разверните интерфейс, указав идентификатор **urn:НАЗВАНИЕ_ВАШЕЙ_КОМПАНИИ:EnvironmentSensor:1**, чтобы увидеть примитивы IoT Plug and Play: свойства, команды и данные телеметрии.

1. Выберите страницу **Телеметрия**, чтобы просмотреть данные телеметрии, которые отправляет устройство.

1. Выберите страницу **Properties(non-writable)​​** (Свойства (недоступные для записи)), чтобы просмотреть недоступные для записи свойства, сообщаемые устройством.

1. Выберите страницу **Properties(writable)** (Свойства (доступные для записи)), чтобы просмотреть доступные для записи свойства, которые можно обновить.

1. Разверните свойство **name**, укажите в качестве его значения новое имя и выберите **Update writeable property** (Обновить свойство, доступное для записи). 

1. Чтобы увидеть новое имя в столбце **Передаваемое свойство**, нажмите кнопку **Обновить** в верхней части страницы.

1. Выберите страницу **команд**, чтобы просмотреть все команды, поддерживаемые устройством.

1. Разверните команду **​​blink** и установите новый интервал времени мигания. Выберите **Отправить команду**, чтобы вызвать команду на устройстве.

1. Перейдите к имитированному устройству, чтобы проверить, выполнена ли команда должным образом.

## <a name="next-steps"></a>Дополнительная информация

Из этого краткого руководства вы узнали, как подключить устройство IoT Plug and Play к Центру Интернета вещей. Дополнительные сведения о создании решения, взаимодействующего с устройствами IoT Plug and Play, см. в следующей статье:

> [!div class="nextstepaction"]
> [Практическое руководство. Подключение к устройству IoT Plug and Play (предварительная версия) и взаимодействие с ним](howto-develop-solution.md)
