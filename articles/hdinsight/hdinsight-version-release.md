---
title: Обзор HDInsight 4.0 в Azure
description: Сравнение функций и ограничений HDInsight 3.6 и HDInsight 4.0, а также рекомендации по обновлению.
author: hrasheed-msft
ms.author: hrasheed
ms.reviewer: hrasheed
ms.service: hdinsight
ms.topic: conceptual
ms.date: 04/14/2020
ms.openlocfilehash: d0fd9999abc4a67ded0f66977e1a3ba5310c87be
ms.sourcegitcommit: ea006cd8e62888271b2601d5ed4ec78fb40e8427
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81383027"
---
# <a name="azure-hdinsight-40-overview"></a>Обзор Azure HDInsight 4.0

Azure HDInsight является одним из самых популярных сервисов среди корпоративных клиентов Apache Hadoop и Apache Spark. HDInsight 4.0 — это облачное распределение компонентов Apache Hadoop. Эта статья содержит сведения о последнем выпуске Azure HDInsight и инструкции по обновлению.

## <a name="whats-new-in-hdinsight-40"></a>Что нового в HDInsight 4.0?

### <a name="apache-hive-30-and-low-latency-analytical-processing"></a>Apache Hive 3.0 и аналитическая обработка с низкой задержкой

Аналитическая обработка Apache Hive с низкой задержкой (LLAP) использует постоянные серверы запросов и кэширование в памяти. Этот процесс обеспечивает быстрые результаты запроса на данные в удаленном облачном хранилище. Hive LLAP использует набор стойких daemons, которые выполняют фрагменты запросов Hive. Выполнение запросов в LLAP аналогично выполнению запросов в Hive без LLAP: рабочие задачи выполняются в управляющих программах LLAP, а не в контейнерах.

Преимущества Hive LLAP:

* Возможность делать глубокую аналитику S'L без ущерба для производительности и адаптивности. Такие, как сложные соединения, подзапросы, функции окон, сортировка, функции, определяемые пользователем, и сложные агрегации.

* Интерактивные запросы к данным в том же хранилище, в котором выполняется их подготовка, что исключает необходимость перемещать данные из хранилища в другую подсистему для аналитической обработки.

* Результаты запроса кэширования позволяют повторно использовать ранее вычисленные результаты запроса. Этот кэш экономит время и ресурсы, затрачиваемые на выполнение задач кластера, необходимых для запроса.

### <a name="hive-dynamic-materialized-views"></a>Динамические материализованные представления Hive

Hive теперь поддерживает динамические материализованные представления, или предварительные вычисления соответствующих резюме. Представления ускоряют обработку запросов в хранилищах данных. Материализованные представления могут храниться в собственном коде в Hive и прозрачно использовать ускорение обработки LLAP.

### <a name="hive-transactional-tables"></a>Транзакционные таблицы Hive

HDI 4.0 включает в себя Apache Hive 3. Hive 3 требует соблюдения атомарности, согласованности, изоляции и долговечности транзакционных таблиц, которые живут на складе Hive. Доступ к совместимым с ACID таблицам и табличным данным и управление ими осуществляет Hive. Данные в таблицах создания, извлечения, обновления и удаления (CRUD) должны находиться в формате оптимизированной колонки строки (ORC). Таблицы только для вставки поддерживают все форматы файлов.

* В ACID версии 2 повышена производительность формата хранения и подсистемы выполнения.

* Компонент ACID включен по умолчанию для обеспечения полной поддержки обновления данных.

* Улучшенные возможности ACID дают возможность обновлять и удалять данные на уровне строки.

* Снижение производительности при этом отсутствует.

* Группирование не требуется.

* Служба Spark может считывать и записывать данные в совместимых с ACID таблицах Hive с помощью соединителя хранилища данных Hive.

Узнайте больше об [Apache Hive 3](https://docs.hortonworks.com/HDPDocuments/HDP3/HDP-3.0.0/hive-overview/content/hive_whats_new_in_this_release_hive.html).

### <a name="apache-spark"></a>Apache Spark

Apache Spark получает обновляемые таблицы и транзакции ACID с помощью соединителя хранилища данных Hive. Соединитель хранилища данных Hive позволяет зарегистрировать транзакционные таблицы Hive в качестве внешних таблиц в Spark для получения доступа ко всем функциям транзакций. Предыдущие версии поддерживали только оперирование секциями таблиц. Хив Склад разъем также поддерживает потоковое DataFrames.  Этот процесс потоков читает и записывает в транзакционных и потоковой таблицы Hive из Spark.

Исполнители Spark могут подключаться непосредственно к управляющим программам Hive LLAP, чтобы извлекать и обновлять данные посредством транзакций, что позволяет Hive сохранить контроль над данными.

Apache Spark в HDInsight 4.0 поддерживает следующие сценарии:

* Обучение моделей машинного обучения с помощью транзакционной таблицы, используемой для создания отчетов.
* Безопасное добавление столбцов из Spark ML в таблицу Hive с помощью транзакций ACID.
* Запуск задания потоковой передачи Spark в канале изменений из таблицы потоковой передачи Hive.
* Создание ORC-файлов непосредственно в задании структурированной потоковой передачи Spark.

Вам больше не придется беспокоиться о случайной попытке получить доступ к транзакционным таблицам Hive непосредственно из Spark. В результате несовместимые результаты, дублирование данных или порча данных. В HDInsight 4.0 таблицы Spark и таблицы Hive хранятся в отдельных хранилищах метаданных. Используйте соединитель хранилища данных Hive, чтобы явно регистрировать транзакционные таблицы Hive как внешние таблицы Spark.

Узнайте больше об [Apache Spark](https://docs.hortonworks.com/HDPDocuments/HDP3/HDP-3.0.0/spark-overview/content/analyzing_data_with_apache_spark.html).

### <a name="apache-oozie"></a>Apache Oozie

Apache Oozie 4.3.1 входит в состав HDI 4.0 со следующими изменениями:

* Oozie больше не выполняет действия Hive. Интерфейс командной строки Hive удален и заменен BeeLine.

* Вы можете исключить нежелательные зависимости из общей библиотеки, добавив шаблон исключения в файл **job.properties**.

Узнайте больше об [Apache Oozie](https://docs.hortonworks.com/HDPDocuments/HDP3/HDP-3.0.0/release-notes/content/patch_oozie.html).

## <a name="how-to-upgrade-to-hdinsight-40"></a>Как выполнить обновление до HDInsight 4.0

Тщательно проверьте компоненты перед реализацией последней версии в производственной среде. HDInsight 4.0 доступен для вас, чтобы начать процесс обновления. HDInsight 3.6 является опцией по умолчанию для предотвращения случайных неудач.

Нет поддерживаемого пути обновления от предыдущих версий HDInsight до HDInsight 4.0. Поскольку форматы данных Metastore и blob изменились, 4.0 не совместим с предыдущими версиями. Важно, чтобы ваша новая среда HDInsight 4.0 была отделена от текущей производственной среды. При развертывании HDInsight 4.0 в текущей среде ваш Metastore будет постоянно обновляться.  

## <a name="limitations"></a>Ограничения

* HDInsight 4.0 не поддерживает MapReduce для Apache Hive. Вместо этого используйте Apache Tez. Узнайте больше об [Apache Tez](https://tez.apache.org/).
* HDInsight 4.0 не поддерживает Apache Storm.
* В HDInsight 4.0 больше не используется представление Hive.
* Переводчик Shell в Apache Цеппелин не поддерживается в кластерах Spark и Interactive Query.
* Вы не можете *запретить* использование LLAP в кластере Spark LLAP. Вы можете отключить только LLAP.
* Azure Data Lake Storage Gen2 не может сохранить ноутбуки Jupyter в кластере Spark.

## <a name="next-steps"></a>Следующие шаги

* [Документация Azure HDInsight](index.yml)
* [Заметки о выпуске](hdinsight-release-notes.md)
