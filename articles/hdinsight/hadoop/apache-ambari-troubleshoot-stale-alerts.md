---
title: Устаревшие оповещения Apache Ambari в Azure HDInsight
description: Обсуждение и анализ возможных причин и решений для устаревших оповещений Apache Ambari в HDInsight.
author: hrasheed-msft
ms.author: hrasheed
ms.reviewer: jasonh
ms.service: hdinsight
ms.topic: troubleshooting
ms.date: 01/22/2020
ms.openlocfilehash: f19d499b5e50fbb5030a0f396296eed46fc6eee3
ms.sourcegitcommit: f52ce6052c795035763dbba6de0b50ec17d7cd1d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/24/2020
ms.locfileid: "76722815"
---
# <a name="scenario-apache-ambari-stale-alerts-in-azure-hdinsight"></a>Сценарий: устаревшие оповещения Apache Ambari в Azure HDInsight

В этой статье описываются действия по устранению неполадок и возможные способы решения проблем при взаимодействии с кластерами Azure HDInsight.

## <a name="issue"></a>Проблема

В пользовательском интерфейсе Apache Ambari может появиться предупреждение, похожее на следующее изображение:

![Пример устаревшего предупреждения Apache Ambari](./media/apache-ambari-troubleshoot-stale-alerts/ambari-stale-alerts-example.png)

## <a name="cause"></a>Причина

Агенты Ambari постоянно выполняют проверки работоспособности для отслеживания работоспособности многих ресурсов. Каждое оповещение настроено на выполнение через определенные интервалы времени. После выполнения каждого предупреждения агенты Ambari сообщают о состоянии на сервер Ambari. На этом этапе, если сервер Ambari обнаруживает, что какие-либо из предупреждений не выполнялись своевременно, он запускает "предупреждения сервера Ambari". Существует несколько причин, по которым проверка работоспособности может не выполняться с заданным интервалом:

* Когда узлы сильно загружены (высокая загрузка ЦП), существует вероятность того, что агент Ambari не смог получить достаточно системных ресурсов для своевременного выполнения оповещений.

* Кластер занят исполнением множества заданий и служб во время большой нагрузки.

* Несколько узлов в кластере могут содержать множество компонентов, поэтому для выполнения многих предупреждений потребуется. Если количество компонентов велико, возможно, задания предупреждений не пропускают запланированные интервалы.

## <a name="resolution"></a>Решение

### <a name="increase-alert-interval-time"></a>Увеличить время интервала оповещения

Можно увеличить значение отдельного интервала оповещений на основе времени отклика кластера и его нагрузки.

1. В пользовательском интерфейсе Apache Ambari выберите вкладку **оповещения** .
1. Выберите нужное имя определения предупреждения.
1. В определении выберите **изменить**.
1. При необходимости измените значение **интервала проверки** , а затем нажмите кнопку **сохранить**.

### <a name="increase-alert-interval-time-for-ambari-server-alerts"></a>Увеличение времени интервала оповещений для предупреждений сервера Ambari

1. В пользовательском интерфейсе Apache Ambari выберите вкладку **оповещения** .
1. В раскрывающемся списке **группы** выберите **AMBARI по умолчанию**.
1. Выберите оповещения **Ambari Server**Alerts.
1. В определении выберите **изменить**.
1. При необходимости измените значение **интервала проверки** .
1. При необходимости измените значение **множителя интервала** и нажмите кнопку **сохранить**.

### <a name="disable-and-enable-the-alert"></a>Отключение и включение оповещения

Вы можете отключить и снова включить оповещение, чтобы удалить все устаревшие оповещения.

1. В пользовательском интерфейсе Apache Ambari выберите вкладку **оповещения** .
1. Выберите нужное имя определения предупреждения.
1. Из определения выберите **включено** в правом углу.
1. На всплывающем окне **подтверждения** выберите пункт **подтвердить отключение**.
1. Подождите несколько секунд, пока не будут удалены все экземпляры предупреждений, показанные на странице.
1. Из определения выберите **отключено** в правом углу.
1. На всплывающем окне **подтверждения** нажмите кнопку **подтвердить включение**.

### <a name="increase-alert-grace-time"></a>Увеличение времени льготы оповещения

Прежде чем агент Ambari сообщит о том, что в настроенном предупреждении пропущено расписание, применяется льготное время. Даже если предупреждение пропустило запланированное время, но оно было активировано в течение льготного периода оповещения, то устаревшее предупреждение не срабатывает.

Значение `alert_grace_period` по умолчанию — 5 секунд. Этот параметр `alert_grace_period` можно настроить в `/etc/ambari-agent/conf/ambari-agent.ini`. Для тех узлов, из которых устаревшие оповещения запускаются через регулярные интервалы, попробуйте увеличить значение до 10. Затем перезапустите агент Ambari

## <a name="next-steps"></a>Дальнейшие действия

Если вы не видите своего варианта проблемы или вам не удается ее устранить, дополнительные сведения можно получить, посетив один из следующих каналов.

* Получите ответы от экспертов Azure через [службу поддержки сообщества Azure](https://azure.microsoft.com/support/community/).

* Подключайтесь с [@AzureSupport](https://twitter.com/azuresupport) — официальная учетная запись Microsoft Azure для улучшения качества взаимодействия с клиентами. Подключение сообщества Azure к нужным ресурсам: ответы, поддержка и эксперты.

* Если вам нужна дополнительная помощь, можно отправить запрос в службу поддержки из [портал Azure](https://portal.azure.com/?#blade/Microsoft_Azure_Support/HelpAndSupportBlade/). Выберите пункт **Поддержка** в строке меню или откройте центр **справки и поддержки** . Для получения более подробных сведений см. статью [о создании запроса на поддержку Azure](https://docs.microsoft.com/azure/azure-supportability/how-to-create-azure-support-request). Доступ к управлению подписками и поддержкой выставления счетов включен в вашу подписку Microsoft Azure, а техническая поддержка предоставляется через один из [планов поддержки Azure](https://azure.microsoft.com/support/plans/).
