---
title: Виртуальная сетевая архитектура Azure HDInsight
description: Узнайте ресурсы, доступные при создании кластера HDInsight в виртуальной сети Azure.
author: hrasheed-msft
ms.author: hrasheed
ms.reviewer: jasonh
ms.service: hdinsight
ms.topic: conceptual
ms.date: 10/31/2019
ms.openlocfilehash: b3f622b360f565ef5b16d5376cb1aa2498655017
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "79272153"
---
# <a name="azure-hdinsight-virtual-network-architecture"></a>Виртуальная сетевая архитектура Azure HDInsight

В этой статье разъясняются ресурсы, которые присутствуют при развертывании кластера HDInsight в пользовательскую виртуальную сеть Azure. Эта информация поможет вам подключить ресурсы к кластеру HDInsight в Azure. Для получения дополнительной информации о виртуальных сетях Azure смотрите [Что такое виртуальная сеть Azure?.](../virtual-network/virtual-networks-overview.md)

## <a name="resource-types-in-azure-hdinsight-clusters"></a>Типы ресурсов в кластерах Azure HDInsight

Кластеры Azure HDInsight имеют различные типы виртуальных машин или узлов. Каждый тип узла играет определенную роль в работе системы. В следующей таблице приведены эти типы узлов и их роли в кластере.

| Тип | Описание |
| --- | --- |
| Головной узел |  Для всех типов кластеров, кроме Apache Storm, головные узлы размещаются в процессах, управляющих выполнением распределенного приложения. Головной узла также является узлами, которые можно ввести sSH и выполнить приложения, которые затем координируются для запуска ресурсов кластера. Количество головных узлов фиксируется на уровне двух для всех типов кластеров. |
| Узлы Зоохранителя | Зоозащитник координирует задачи между узлами, выполняющие обработку данных. Он также делает лидер омвыборов головного узла, и отслеживает, какой головной узла работает конкретный мастер службы. Количество узлов ЗооKeeper фиксируется на уровне трех. |
| Рабочий узел | Представляет узлы, поддерживающие функциональность обработки данных. Рабочие узлы могут быть добавлены или удалены из кластера для масштабирования вычислительных возможностей и управления затратами. |
| Узла края сервера R | Узла края R Server представляет собой узла SSH и выполнение приложений, которые затем координируются для запуска ресурсов кластера. Узлы края не участвуют в анализе данных в кластере. Этот узлы также размещают R Studio Server, что позволяет запускать R-приложение с помощью браузера. |
| Региональный узла | Для типа кластера HBase узла региона (также называемого узлами данных) выполняется сервер региона. Серверы регионов обслуживают и управляют частью данных, управляемых HBase. Узлы регионов могут быть добавлены или удалены из кластера для масштабирования вычислительных возможностей и управления затратами.|
| Нимбусный узла | Для кластера Storm узла Nimbus узла обеспечивает функциональность, аналогичную головному узлам. Узло Nimbus присваивает задачи другим узлам в кластере через зоозащитника, который координирует работу топологий Storm. |
| Узла супервайзера | Для типа кластера Storm узла супервайзера выполняет инструкции, предоставленные узлами Nimbus для выполнения заданной обработки. |

## <a name="resource-naming-conventions"></a>Конвенции о наименовании ресурсов

Пожалуйста, используйте полностью квалифицированные доменные имена (F-DNs) при обращении к узлам в кластере. Вы можете получить F-DN для различных типов узлов в вашем кластере с помощью [API Ambari.](hdinsight-hadoop-manage-ambari-rest-api.md) 

Эти ФЗНбудут будут в `<node-type-prefix><instance-number>-<abbreviated-clustername>.<unique-identifier>.cx.internal.cloudapp.net`форме.

Будет `<node-type-prefix>` *hn* для headnodes, *wn* для узлов работника и *zn* для узлов зоозащитника.

Если вам нужно только имя хоста, используйте только первую часть ФЗДН:`<node-type-prefix><instance-number>-<abbreviated-clustername>`

## <a name="basic-virtual-network-resources"></a>Основные виртуальные сетевые ресурсы

На следующей диаграмме показано размещение узлов HDInsight и сетевых ресурсов в Azure.

![Диаграмма объектов HDInsight, созданных в пользовательском VNET на заказ Azure](./media/hdinsight-virtual-network-architecture/hdinsight-vnet-diagram.png)

Ресурсы по умолчанию, присутствующие при развертывании HDInsight в виртуальной сети Azure, включают типы кластерных узлов, упомянутые в предыдущей таблице, а также сетевые устройства, поддерживающие связь между виртуальной сетью и внешними сетями.

В следующей таблице кратко излагаются девять кластерных узлов, которые создаются при развертывании HDInsight в пользовательскую виртуальную сеть Azure.

| Тип ресурса | Номер настоящего | Сведения |
| --- | --- | --- |
|Головной узел | two |    |
|Узел ZooKeeper | three | |
|Рабочий узел | two | Это число может варьироваться в зависимости от конфигурации кластера и масштабирования. Для Apache Kafka требуется как минимум три рабочих узла.  |
|Узел шлюза | two | Узлы шлюза — это виртуальные машины Azure, которые создаются в Azure, но не видны в подписке. Обратитесь в службу поддержки, если вам нужно перезагрузить эти узлы. |

Следующие сетевые ресурсы автоматически создаются внутри виртуальной сети, используемой с HDInsight:

| Сетевой ресурс | Номер настоящего | Сведения |
| --- | --- | --- |
|Подсистема балансировки нагрузки | three | |
|Сетевые интерфейсы | Девять | Это значение основано на обычном кластере, где каждый узла имеет свой собственный сетевой интерфейс. Девять интерфейсов для двух головных узлов, трех узлов зоозащитника, двух рабочих узлов и двух узлов шлюза, упомянутых в предыдущей таблице. |
|Общедоступные IP-адреса | two |    |

## <a name="endpoints-for-connecting-to-hdinsight"></a>Конечные точки для подключения к HDInsight

Вы можете получить доступ к кластеру HDInsight тремя способами:

- Конечная точка HTTPS за пределами виртуальной сети на `CLUSTERNAME.azurehdinsight.net`.
- Конечная точка SSH для прямого подключения к `CLUSTERNAME-ssh.azurehdinsight.net`головному ноду на .
- Конечная точка HTTPS в `CLUSTERNAME-int.azurehdinsight.net`виртуальной сети. Обратите внимание на "-int" в этом URL. Эта конечная точка будет решать для частного IP в этой виртуальной сети и не доступен из публичного Интернета.

Этим трем конечным точкам присваивается баланселизатор нагрузки.

Публичные IP-адреса также предоставляются двум конечным точкам, которые позволяют подключение из-за пределов виртуальной сети.

1. Один публичный IP присваивается балансеру нагрузки для полностью квалифицированного доменного имени `CLUSTERNAME.azurehdinsight.net`(ФЗДН) для использования при подключении к кластеру из Интернета.
1. Второй публичный IP-адрес используется только для `CLUSTERNAME-ssh.azurehdinsight.net`доменного имени SSH.

## <a name="next-steps"></a>Дальнейшие действия

- [Безопасный входящий трафик кластеров HDInsight в виртуальной сети с частной конечной точкой](https://azure.microsoft.com/blog/secure-incoming-traffic-to-hdinsight-clusters-in-a-vnet-with-private-endpoint/)
