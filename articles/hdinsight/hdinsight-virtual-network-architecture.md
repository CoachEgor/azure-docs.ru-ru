---
title: Архитектура виртуальной сети Azure HDInsight
description: Сведения о ресурсах, доступных при создании кластера HDInsight в виртуальной сети Azure.
author: hrasheed-msft
ms.author: hrasheed
ms.reviewer: jasonh
ms.service: hdinsight
ms.topic: conceptual
ms.date: 10/31/2019
ms.openlocfilehash: 0a1139f7bf1711a5f6d980e67a8a9027bfd3af52
ms.sourcegitcommit: 609d4bdb0467fd0af40e14a86eb40b9d03669ea1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/06/2019
ms.locfileid: "73665320"
---
# <a name="azure-hdinsight-virtual-network-architecture"></a>Архитектура виртуальной сети Azure HDInsight

В этой статье объясняются ресурсы, которые имеются при развертывании кластера HDInsight в настраиваемой виртуальной сети Azure. Эта информация поможет вам подключить локальные ресурсы к кластеру HDInsight в Azure. Дополнительные сведения о виртуальных сетях Azure см. в статье [что такое виртуальная сеть Azure?](../virtual-network/virtual-networks-overview.md).

## <a name="resource-types-in-azure-hdinsight-clusters"></a>Типы ресурсов в кластерах Azure HDInsight

Кластеры Azure HDInsight имеют различные типы виртуальных машин или узлов. Каждый тип узла играет роль в работе системы. В следующей таблице перечислены типы узлов и их роли в кластере.

| Тип | Description (Описание) |
| --- | --- |
| Головной узел |  Для всех типов кластеров, кроме Apache Storm, головные узлы размещают процессы, управляющие выполнением распределенного приложения. Головной узел — это также узел, который можно использовать для подключения по протоколу SSH и выполнения приложений, которые затем согласовываются в ресурсах кластера. Количество головных узлов фиксировано по два для всех типов кластера. |
| Узел ZooKeeper | Zookeeper координирует задачи между узлами, выполняющими обработку данных. Он также выдает ведущие выборы головного узла и отслеживает, какой головной узел выполняет определенную главную службу. Число узлов ZooKeeper фиксировано 3. |
| Рабочий узел | Представляет узлы, поддерживающие функции обработки данных. Рабочие узлы можно добавлять в кластер или удалять из кластера, чтобы масштабировать вычислительные возможности и управлять затратами. |
| Граничные узлы R Server | Пограничным узлом R Server является узел, который можно использовать для подключения по протоколу SSH и выполнения приложений, которые затем согласовываются для выполнения в ресурсах кластера. Граничные узлы не участвуют в анализе данных в кластере. Этот узел также содержит R Studio Server, что позволяет запускать приложение R с помощью браузера. |
| Узел региона | Для типа кластера HBase узел региона (также называемый узлом данных) запускает сервер регионов. Региональные серверы обслуживают и управляют частью данных, управляемых HBase. Узлы регионов можно добавлять в кластер или удалять из него, чтобы масштабировать вычислительные возможности и управлять затратами.|
| Узел Nimbus | Для типа кластера Nimbus узел предоставляет функциональные возможности, аналогичные головному узлу. Узел Nimbus назначает задачи другим узлам в кластере через Zookeeper, который координирует выполнение топологий. |
| Узел супервизора | Для типа кластера с различными типами узел супервизора выполняет инструкции, предоставленные узлом Nimbus для выполнения требуемой обработки. |

## <a name="basic-virtual-network-resources"></a>Основные ресурсы виртуальной сети

На следующей схеме показано размещение узлов HDInsight и сетевых ресурсов в Azure.

![Схема сущностей HDInsight, созданных в настраиваемой виртуальной сети Azure](./media/hdinsight-virtual-network-architecture/hdinsight-vnet-diagram.png)

Ресурсы по умолчанию, используемые при развертывании HDInsight в виртуальной сети Azure, включают в себя типы узлов кластера, упомянутые в предыдущей таблице, а также сетевые устройства, поддерживающие взаимодействие между виртуальной сетью и внешними сетями.

В следующей таблице перечислены девять узлов кластера, которые создаются при развертывании HDInsight в настраиваемой виртуальной сети Azure.

| Тип ресурса | Номер представлен | Сведения |
| --- | --- | --- |
|Головной узел | two |    |
|Узел ZooKeeper | three | |
|Рабочий узел | two | Это число может изменяться в зависимости от конфигурации кластера и масштабирования. Для Apache Kafka требуется не менее трех рабочих узлов.  |
|Узел шлюза | two | Узлы шлюза — это виртуальные машины Azure, созданные в Azure, но не отображаемые в вашей подписке. Если необходимо перезагрузить эти узлы, обратитесь в службу поддержки. |

В виртуальной сети, используемой в HDInsight, автоматически создаются следующие сетевые ресурсы:

| Сетевой ресурс | Номер представлен | Сведения |
| --- | --- | --- |
|Подсистема балансировки нагрузки | three | |
|Сетевые интерфейсы | девять | Это значение основано на стандартном кластере, где каждый узел имеет собственный сетевой интерфейс. Девять интерфейсов предназначены для двух головных узлов, трех узлов Zookeeper, двух рабочих узлов и двух узлов шлюза, упомянутых в предыдущей таблице. |
|Общедоступные IP-адреса | two |    |

## <a name="endpoints-for-connecting-to-hdinsight"></a>Конечные точки для подключения к HDInsight

Доступ к кластеру HDInsight можно получить тремя способами:

- Конечная точка HTTPS за пределами виртуальной сети в `CLUSTERNAME.azurehdinsight.net`.
- Конечная точка SSH для прямого подключения к головного узла на `CLUSTERNAME-ssh.azurehdinsight.net`.
- Конечная точка HTTPS в виртуальной сети `CLUSTERNAME-int.azurehdinsight.net`. Обратите внимание на "-int" в этом URL-адресе. Эта конечная точка будет разрешаться в частный IP-адрес в этой виртуальной сети и недоступна из общедоступного Интернета.

Каждому из этих трех конечных точек назначается балансировщик нагрузки.

Общедоступные IP-адреса также предоставляются для двух конечных точек, которые разрешают подключение извне виртуальной сети.

1. Один общедоступный IP-адрес назначается подсистеме балансировки нагрузки для полного доменного имени (FQDN), используемого при подключении к кластеру из `CLUSTERNAME.azurehdinsight.net`Интернета.
1. Второй общедоступный IP-адрес используется только для имени домена, используемого только SSH `CLUSTERNAME-ssh.azurehdinsight.net`.

## <a name="next-steps"></a>Дальнейшие действия

- [Защита входящего трафика в кластерах HDInsight в виртуальной сети с помощью частной конечной точки](https://azure.microsoft.com/blog/secure-incoming-traffic-to-hdinsight-clusters-in-a-vnet-with-private-endpoint/)
