---
title: Настройка расписания обновления путем частичной замены ОС для кластеров HDInsight в Azure
description: Узнайте, как настроить расписание обновления путем частичной замены ОС для кластеров HDInsight.
author: omidm1
ms.author: omidm
ms.service: hdinsight
ms.custom: hdinsightactive
ms.topic: conceptual
ms.date: 01/24/2019
ms.openlocfilehash: a887d6c69b9fa80f3144434e72a097e80d123a1b
ms.sourcegitcommit: 44a85a2ed288f484cc3cdf71d9b51bc0be64cc33
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "64722299"
---
# <a name="os-patching-for-hdinsight"></a>Обновление путем частичной замены ОС для кластеров HDInsight 

> [!IMPORTANT]
> Образы Ubuntu станут доступны для создания кластера HDInsight в течение 3 месяцев после публикации. По состоянию на январь 2019 года работающие кластеры **не** были автоматически исправлены. Клиенты должны использовать действия сценария или другие механизмы для исправления работающего кластера. Созданные кластеры будут всегда содержать последние обновления, включая самые последние обновления безопасности.

## <a name="how-to-configure-the-os-patching-schedule-for-linux-based-hdinsight-clusters"></a>Как настроить расписание обновления путем частичной замены ОС для кластеров HDInsight под управлением Linux
Виртуальные машины в кластере HDInsight нужно время от времени перезагружать для установки важных исправлений системы безопасности. 

С помощью действия сценария, описанного в этой статье, можно изменить расписание обновления путем частичной замены ОС следующим образом.
1. Можно включить или отключить автоматическую перезагрузку.
2. Можно задать частоту перезагрузки (в днях между перезагрузками).
3. Можно задать день недели, когда происходит перезагрузка.

> [!NOTE]  
> Это действие сценария будет работать только с кластерами HDInsight под управлением Linux, созданными после 1 августа 2016 года. Исправления начнут действовать только после перезагрузки виртуальных машин. 

## <a name="how-to-use-the-script"></a>Как использовать сценарий 

Для использования этого сценария требуется следующая информация.
1. Расположение скрипта: https://hdiconfigactions.blob.core.windows.net/linuxospatchingrebootconfigv01/os-patching-reboot-config.sh.  HDInsight использует этот универсальный код ресурса (URI), чтобы найти и запустить сценарий на всех виртуальных машинах в кластере.
  
2. Типы узлов кластера, к которым применяется сценарий: головной узел, рабочий узел, узел zookeeper. Этот сценарий должен применяться к узлам всех типов в кластере. Если не применить его к какому-либо типу узла, то виртуальные машины этого типа узла продолжат использовать прежнее расписание обновления путем частичной замены ОС.


3.  Параметры. Этот сценарий принимает три числовых параметра.

    | Параметр | Определение |
    | --- | --- |
    | Включение или отключение автоматических перезагрузок. |0 или 1. Значение 0 отключает автоматические перезагрузки, а значение 1 — включает. |
    | Frequency |7–90 (включительно). Число дней до перезагрузки виртуальных машин для установки исправлений, которые требуют перезагрузки. |
    | День недели |1–7 (включительно). Значение 1 указывает, что перезагрузка должна выполняться в понедельник, а 7 — в воскресенью. Например, использование параметров 1 60 2 приведет к автоматической перезагрузке каждые 60 дней (максимум) во вторник. |
    | Сохраняемость |В случае применения действия сценария к существующему кластеру можно пометить сценарий как сохраняемый. Сохраняемые сценарии применяются при добавлении новых рабочих узлов в кластер при операциях масштабирования. |

> [!NOTE]  
> Этот сценарий необходимо пометить как сохраняемый, если он применяется к существующему кластеру. В противном случае все новые узлы, созданные операциями масштабирования, будут использовать расписание обновления путем частичной замены ОС по умолчанию.  Если применить сценарий при создании кластера, он сохраняется автоматически.

## <a name="next-steps"></a>Дальнейшие действия

Инструкции по использованию действия сценария см. в следующих разделах статьи [Настройка кластеров HDInsight под управлением Linux с помощью действия сценария](hdinsight-hadoop-customize-cluster-linux.md):

* [Использование действия скрипта при создании кластера](hdinsight-hadoop-customize-cluster-linux.md#use-a-script-action-during-cluster-creation)
* [Применение действия скрипта в работающем кластере](hdinsight-hadoop-customize-cluster-linux.md#apply-a-script-action-to-a-running-cluster)
