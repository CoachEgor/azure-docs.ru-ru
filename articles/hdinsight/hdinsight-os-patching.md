---
title: Настройка графика исправления ОС для кластеров Azure HDInsight
description: Узнайте, как настроить расписание обновления путем частичной замены ОС для кластеров HDInsight.
author: hrasheed-msft
ms.author: hrasheed
ms.reviewer: jasonh
ms.service: hdinsight
ms.topic: conceptual
ms.custom: hdinsightactive
ms.date: 01/21/2020
ms.openlocfilehash: f8e694f658d6e9de04c92001214ecd5c32ff7753
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "78206866"
---
# <a name="configure-the-os-patching-schedule-for-linux-based-hdinsight-clusters"></a>Настройка графика исправления ОС для кластеров HDInsight на основе Linux

> [!IMPORTANT]
> Изображения Ubuntu становятся доступными для создания нового кластера Azure HDInsight в течение трех месяцев после публикации. По состоянию на январь 2019 года, запущенные кластеры не являются автоматическими. Клиенты должны использовать действия сценария или другие механизмы для исправления работающего кластера. Созданные кластеры будут всегда содержать последние обновления, включая самые последние обновления безопасности.

HDInsight предоставляет поддержку для выполнения общих задач в кластере, таких как установка патчей ОС, обновления безопасности и перезагрузка узлов. Эти задачи выполняются с использованием следующих двух скриптов, которые могут быть запущены в виде [действий скрипта](hdinsight-hadoop-customize-cluster-linux.md)и настроены с параметрами:

- `schedule-reboots.sh`- Немедленно перезапустите или запланируйте перезапуск на кластерных узлах.
- `install-updates-schedule-reboots.sh`- Установите все обновления, только ядра и обновления безопасности, или только обновления ядра.

> [!NOTE]  
> Действия скрипта не будут автоматически применять обновления для всех будущих циклов обновления. Выполнить скрипты каждый раз, когда новые обновления должны быть применены для установки обновлений, а затем перезапустить VM.

## <a name="preparation"></a>Подготовка

Патч на репрезентативной непроизводственной среде до развертывания в производство. Разработайте план, чтобы адекватно протестировать систему до фактического исправления.

Время от времени, из сеанса ssh с кластером, вы можете получать сообщение о доступном обновлении. Сообщение может выглядеть примерно так:

```
New release '18.04.3 LTS' available.
Run 'do-release-upgrade' to upgrade it
```

Патчинг является необязательным и на ваше усмотрение.

## <a name="restart-nodes"></a>Перезапуск узлов
  
График [скриптов-перезагрузки,](https://hdiconfigactions.blob.core.windows.net/linuxospatchingrebootconfigv02/schedule-reboots.sh)устанавливает тип перезагрузки, которая будет выполняться на машинах в кластере. При отправке действия скрипта установите его на все три типа узлов: головной узлы, рабочий узлы и зоозащитник. Если скрипт не применяется к типу узла, чаты и не перезапущены чаты для этого типа узлов.

Принимает `schedule-reboots script` один числовый параметр:

| Параметр | Допустимые значения | Определение |
| --- | --- | --- |
| Тип перезагрузки для выполнения | 1 или 2 | Значение 1 позволяет перезапустить расписание (запланировано в 12-24 часа). Значение 2 позволяет немедленно перезапустить (через 5 минут). Если параметр не дан, по умолчанию 1. |  

## <a name="install-updates-and-restart-nodes"></a>Установка обновлений и перезапуск узлов

Скрипт [install-updates-schedule-reboots.sh](https://hdiconfigactions.blob.core.windows.net/linuxospatchingrebootconfigv02/install-updates-schedule-reboots.sh) предоставляет варианты установки различных типов обновлений и перезагрузки VM.

Сценарий `install-updates-schedule-reboots` принимает два численных параметра, как описано в следующей таблице:

| Параметр | Допустимые значения | Определение |
| --- | --- | --- |
| Тип обновлений для установки | 0, 1 или 2 | Значение 0 устанавливает только обновления ядра. Значение 1 устанавливает все обновления, и 2 устанавливает только ядро и обновления безопасности. Если параметр не предусмотрен, по умолчанию 0. |
| Тип перезагрузки для выполнения | 0, 1 или 2 | Перезапуск значения 0 отсутсвий. Значение 1 позволяет перезапустить расписание, а 2 позволяет немедленно перезапустить. Если параметр не предусмотрен, по умолчанию 0. Пользователь должен изменить параметр ввода 1 на вхотливный параметр 2. |

> [!NOTE]
> Необходимо отметить сценарий как упорный после его применения к существующему кластеру. В противном случае все новые узлы, созданные операциями масштабирования, будут использовать расписание обновления путем частичной замены ОС по умолчанию. Если применить скрипт как часть процесса создания кластера, он сохраняется автоматически.

## <a name="next-steps"></a>Дальнейшие действия

Для конкретных шагов по использованию действий скрипта см. следующие разделы в [кластерах На основе Linux HDInsight с использованием действия скрипта:](hdinsight-hadoop-customize-cluster-linux.md)

- [Используйте действие скрипта во время создания кластера](hdinsight-hadoop-customize-cluster-linux.md#script-action-during-cluster-creation)
- [Применение действия скрипта в работающем кластере](hdinsight-hadoop-customize-cluster-linux.md#script-action-to-a-running-cluster)
