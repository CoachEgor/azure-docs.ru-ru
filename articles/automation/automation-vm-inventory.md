---
title: Управление виртуальной машиной Azure с помощью сбора данных инвентаризации | Документация Майкрософт
description: Управление виртуальной машиной с помощью сбора данных инвентаризации.
services: automation
ms.subservice: change-inventory-management
keywords: данные инвентаризации, автоматизация, отслеживание
ms.date: 01/28/2020
ms.topic: conceptual
ms.openlocfilehash: 0627d2daa70c276535dc43b722e22e1d73b0c8d2
ms.sourcegitcommit: 849bb1729b89d075eed579aa36395bf4d29f3bd9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2020
ms.locfileid: "81617373"
---
# <a name="manage-an-azure-virtual-machine-with-inventory-collection"></a>Управление виртуальной машиной Azure с помощью сбора данных инвентаризации

Отслеживание данных для виртуальной машины Azure можно включить со страницы ресурсов виртуальной машины. Вы можете получать и просматривать следующие данные инвентаризации на компьютерах:

- Программное обеспечение Windows (приложения Windows и обновления Windows), службы, файлы и ключи реестра
- Управляющие программы для Linux (пакеты) и файлы

В этом способе предоставляется пользовательский интерфейс на основе браузера для настройки сбора данных инвентаризации.

## <a name="before-you-begin"></a>Подготовка к работе

Если у вас еще нет подписки Azure, [создайте бесплатную учетную запись](https://azure.microsoft.com/free/).

В этой статье предполагается, сто у вас есть виртуальная машина для настройки решения. [Создайте виртуальную машину](../virtual-machines/windows/quick-create-portal.md), если вы еще не сделали этого.

## <a name="sign-in-to-the-azure-portal"></a>Вход на портал Azure

Войдите на [портал Azure](https://portal.azure.com/).

## <a name="enable-inventory-collection-from-the-virtual-machine-resource-page"></a>Включение сбора данных инвентаризации на странице ресурсов виртуальной машины

1. В левой области на портале Azure выберите **Виртуальные машины**.
2. В списке виртуальных машин выберите виртуальную машину.
3. В меню **Ресурс** в разделе **Операции** выберите **Инвентаризация**.
4. Выберите рабочую область Log Analytics для хранения журналов данных.
    Если рабочая область для этого региона недоступна, вам будет предложено создать рабочую область по умолчанию и учетную запись службы автоматизации.
5. Чтобы запустить подключение компьютера, выберите **Включить**.

   ![Просмотр параметров подключения](./media/automation-vm-inventory/inventory-onboarding-options.png)

    Строка состояния уведомляет о включении решения. Этот процесс может занять до 15 минут. В это время можно закрыть окно или оставить его открытыми с уведомлением о включении решения. Состояние развертывания можно отслеживать на панели уведомлений.

   ![Просмотр решения инвентаризации сразу после подключения](./media/automation-vm-inventory/inventory-onboarded.png)

После завершения развертывания строка состояния исчезнет. Система по-прежнему собирает данные инвентаризации, которые еще могут не отображаться. На сбор всех данных может потребоваться 24 часа.

## <a name="configure-your-inventory-settings"></a>Настройка параметров инвентаризации

По умолчанию для сбора настраиваются программное обеспечение, службы Windows и управляющие программы Linux. Для сбора данных реестра Windows и инвентаризации файлов настройте параметры сбора данных инвентаризации.

1. На странице "Инвентаризация" щелкните **изменить параметры** в верхней части страницы.
2. Чтобы добавить новый параметр коллекции, перейдите к категории параметров, которую необходимо добавить, выбрав вкладку **реестр Windows**, **файлы Windows**или **файлы Linux** .
3. Выберите соответствующую категорию и нажмите кнопку **Добавить** в верхней части страницы.

Далее приведены сведения о каждом свойстве, которое можно настроить для разных категорий.

### <a name="windows-registry"></a>реестр Windows;

|Свойство  |Описание  |
|---------|---------|
|Активировано     | Определяет, применяется ли параметр        |
|Имя элемента     | Понятное имя файла для отслеживания        |
|Группа     | Имя группы для логического группирования файлов        |
|Раздел реестра Windows   | Путь для проверки наличия файла. Например: HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders\Common Startup      |

### <a name="windows-files"></a>файлы Windows.

|Свойство  |Описание  |
|---------|---------|
|Активировано     | Значение true, если параметр применен, и false в противном случае.        |
|Имя элемента     | Понятное имя файла для отслеживания.        |
|Группа     | Имя группы для логического группирования файлов.       |
|Укажите путь     | Путь для проверки файла, например **к:\темп\мифиле.ткст**.

### <a name="linux-files"></a>Файлы Linux

|Свойство  |Описание  |
|---------|---------|
|Активировано     | Значение true, если параметр применен, и false в противном случае.        |
|Имя элемента     | Понятное имя файла для отслеживания.        |
|Группа     | Имя группы для логического группирования файлов.        |
|Укажите путь     | Путь для проверки файла, например **/etc/*. conf**.       |
|Тип пути     | Тип элемента для трассировки. Значения — File и Directory.        |
|Рекурсия     | Значение true, если рекурсия используется при поиске элемента для отслеживания, и false в противном случае.        |
|Использовать sudo     | Значение true, если sudo используется при проверке элемента, и false в противном случае.         |
|Ссылки     | Значение, указывающее, как обрабатываются символьные ссылки при просмотре каталогов. Возможны следующие значения: <br> Ignore (Игнорировать) — игнорирование символических ссылок без включения ссылочных файлов и каталогов.<br>Follow (Переходить) — переход по символическим ссылкам во время рекурсий и включение ссылочных файлов и каталогов.<br>Manage (Управлять) — переход по символическим ссылкам и изменение способа обработки полученного содержимого.      |

## <a name="manage-machine-groups"></a>Управление группами компьютеров

Инвентаризация позволяет создавать и просматривать группы компьютеров в журналах Azure Monitor. Группы компьютеров — это коллекции компьютеров, определяемые запросом в журналах Azure Monitor.

[!INCLUDE [azure-monitor-log-analytics-rebrand](../../includes/azure-monitor-log-analytics-rebrand.md)]

Чтобы просмотреть группы компьютеров, на странице "Инвентаризация" щелкните вкладку **Группы компьютеров**.

![Просмотр групп компьютеров на странице инвентаризации](./media/automation-vm-inventory/inventory-machine-groups.png)

Чтобы открыть страницу "Группы компьютеров", выберите группу из списка. На этой странице отображаются сведения о конкретной группе, в том числе запрос Log Analytics для определения этой группы. В нижней части приведен список всех компьютеров, которые включены в эту группу.

![Просмотр страницы группы компьютеров](./media/automation-vm-inventory/machine-group-page.png)

Щелкните **+ clone (+ клонировать** ), чтобы клонировать группу компьютеров. Необходимо присвоить группе новое имя и псевдоним для группы. Также на этом этапе можно изменить определение. После изменения запроса нажмите кнопку **проверить запрос** , чтобы просмотреть выбранные компьютеры. Когда вы довольны группой, нажмите кнопку **создать** , чтобы создать группу компьютеров.

Если вы хотите создать новую группу компьютеров, щелкните **+ создать группу компьютеров**. Эта кнопка открывает страницу **Создание группы компьютеров** , на которой можно определить новую группу. Щелкните **Создать**, чтобы создать группу.

![Создание новой группы компьютеров](./media/automation-vm-inventory/create-new-group.png)

## <a name="disconnect-your-virtual-machine-from-management"></a>Отключение виртуальной машины от управления

Чтобы удалить виртуальную машину из управления инвентаризации, сделайте следующее:

1. В левой области на портале Azure выберите **Log Analytics**, а затем выберите рабочую область, используемую при подключении виртуальной машины.
2. На странице Log Analytics откройте меню **ресурсов** .
3. Выберите **виртуальные машины** в разделе **Источники данных рабочей области**.
4. Из списка выберите виртуальную машину, которую необходимо отключить. Рядом с ней будет зеленый флажок с текстом **This workspace** (Эта рабочая область) в столбце **OMS Connection** (Подключение OMS).

   >[!NOTE]
   >Operations Management Suite (OMS) теперь называется журналами Azure Monitor.
   
5. В верхней части следующей страницы щелкните **Отключить**.
6. В окне подтверждения нажмите кнопку **Да** , чтобы отключить компьютер от управления.

## <a name="next-steps"></a>Дальнейшие шаги

* Дополнительные сведения об управлении изменениями файлов и параметров реестра на виртуальных машинах см. в статье [Отслеживание изменений программного обеспечения в среде с помощью решения для отслеживания изменений](../log-analytics/log-analytics-change-tracking.md).
* Дополнительные сведения об управлении Windows и пакетами обновлений на виртуальных машинах см. в статье [Решение для управления обновлениями в Azure](../operations-management-suite/oms-solution-update-management.md).