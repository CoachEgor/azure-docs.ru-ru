---
title: Управление виртуальной машиной Azure с помощью сбора данных инвентаризации | Документация Майкрософт
description: Управление виртуальной машиной с помощью сбора данных инвентаризации.
services: automation
ms.service: automation
ms.subservice: change-inventory-management
keywords: данные инвентаризации, автоматизация, отслеживание
author: jennyhunter-msft
ms.author: jehunte
ms.date: 02/06/2019
ms.topic: conceptual
manager: carmonm
ms.openlocfilehash: 59f36595e0b6cc8b9d9ea0669c9ecb5be1e74b42
ms.sourcegitcommit: d4dfbc34a1f03488e1b7bc5e711a11b72c717ada
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/13/2019
ms.locfileid: "61304152"
---
# <a name="manage-an-azure-virtual-machine-with-inventory-collection"></a>Управление виртуальной машиной Azure с помощью сбора данных инвентаризации

Отслеживание данных для виртуальной машины Azure можно включить со страницы ресурсов виртуальной машины. Вы можете собирать и просматривать сведения об установленных на компьютерах программном обеспечении, файлах, управляющих программах, службах и разделах реестра Windows. В этом способе предоставляется пользовательский интерфейс на основе браузера для настройки сбора данных инвентаризации.

## <a name="before-you-begin"></a>Перед началом работы

Если у вас еще нет подписки Azure, [создайте бесплатную учетную запись](https://azure.microsoft.com/free/).

В этой статье предполагается, сто у вас есть виртуальная машина для настройки решения. [Создайте виртуальную машину](../virtual-machines/windows/quick-create-portal.md), если вы еще не сделали этого.

## <a name="sign-in-to-the-azure-portal"></a>Вход на портал Azure

Войдите на [портале Azure](https://portal.azure.com/).

## <a name="enable-inventory-collection-from-the-virtual-machine-resource-page"></a>Включение сбора данных инвентаризации на странице ресурсов виртуальной машины

1. В левой области на портале Azure выберите **Виртуальные машины**.
2. В списке виртуальных машин выберите виртуальную машину.
3. В меню **Ресурс** в разделе **Операции** выберите **Инвентаризация**.
4. Выберите рабочую область Log Analytics для хранения данных журналов.
    Если рабочая область для этого региона недоступна, вам будет предложено создать рабочую область по умолчанию и учетную запись службы автоматизации.
5. Чтобы запустить подключение компьютера, выберите **Включить**.

   ![Просмотр параметров подключения](./media/automation-vm-inventory/inventory-onboarding-options.png)

    Строка состояния уведомляет о включении решения. Этот процесс может занять до 15 минут. В это время можно закрыть окно или оставить его открытыми с уведомлением о включении решения. Состояние развертывания можно отслеживать на панели уведомлений.

   ![Просмотр решения инвентаризации сразу после подключения](./media/automation-vm-inventory/inventory-onboarded.png)

После завершения развертывания строка состояния исчезнет. Система по-прежнему собирает данные инвентаризации, которые еще могут не отображаться. На сбор всех данных может потребоваться 24 часа.

## <a name="configure-your-inventory-settings"></a>Настройка параметров инвентаризации

По умолчанию для сбора настраиваются программное обеспечение, службы Windows и управляющие программы Linux. Для сбора данных реестра Windows и инвентаризации файлов настройте параметры сбора данных инвентаризации.

1. В представлении **Инвентаризация** в верхней части окна нажмите кнопку **Изменить параметры**.
2. Чтобы добавить новый параметр сбора, перейдите к категории параметра, который необходимо добавить, используя вкладки **реестра Windows**, **файлов Windows** и **файлов Linux**.
3. Выберите подходящую категорию и щелкните **Добавить** в верхней части окна.

Далее приведены сведения о каждом свойстве, которое можно настроить для разных категорий.

### <a name="windows-registry"></a>реестр Windows;

|Свойство  |ОПИСАНИЕ  |
|---------|---------|
|Enabled     | Определяет, применяется ли параметр        |
|Имя элемента     | Понятное имя файла для отслеживания        |
|Группа     | Имя группы для логического группирования файлов        |
|Раздел реестра Windows   | Путь для проверки наличия файла. Например: HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders\Common Startup      |

### <a name="windows-files"></a>файлы Windows.

|Свойство  |ОПИСАНИЕ  |
|---------|---------|
|Enabled     | Определяет, применяется ли параметр        |
|Имя элемента     | Понятное имя файла для отслеживания        |
|Группа     | Имя группы для логического группирования файлов        |
|Укажите путь     | Путь для проверки наличия файла. Например, c:\temp\myfile.txt.

### <a name="linux-files"></a>Файлы Linux

|Свойство  |ОПИСАНИЕ  |
|---------|---------|
|Enabled     | Определяет, применяется ли параметр        |
|Имя элемента     | Понятное имя файла для отслеживания        |
|Группа     | Имя группы для логического группирования файлов        |
|Укажите путь     | Путь для проверки наличия файла. Например, /etc/*.conf.       |
|Тип пути     | Тип элемента для отслеживания (возможными значениями могут быть "Файл" и "Каталог")        |
|Рекурсия     | Определяет, используется ли рекурсия при поиске отслеживаемого элемента.        |
|Использовать sudo     | Этот параметр определяет, используется ли sudo для проверки наличия элемента.         |
|Ссылки     | Этот параметр определяет работу символических ссылок при обзоре каталогов.<br> **Ignore** (Игнорировать) — игнорирование символических ссылок без включения ссылочных файлов и каталогов.<br>**Follow** (Переходить) — переход по символическим ссылкам во время рекурсий и включение ссылочных файлов и каталогов.<br>**Manage** (Управлять) — переход по символическим ссылкам и изменение способа обработки полученного содержимого.      |

## <a name="manage-machine-groups"></a>Управление группами компьютеров

Инвентаризации позволяет создавать и просматривать группы компьютеров в Azure Monitor журналы. Группы компьютеров являются коллекциями машины, определенные в запросе в журналах Azure Monitor.

[!INCLUDE [azure-monitor-log-analytics-rebrand](../../includes/azure-monitor-log-analytics-rebrand.md)]

Чтобы просмотреть группы компьютеров, на странице "Инвентаризация" щелкните вкладку **Группы компьютеров**.

![Просмотр групп компьютеров на странице инвентаризации](./media/automation-vm-inventory/inventory-machine-groups.png)

Чтобы открыть страницу "Группы компьютеров", выберите группу из списка. На этой странице отображаются сведения о конкретной группе, в том числе запрос Log Analytics для определения этой группы. В нижней части приведен список всех компьютеров, которые включены в эту группу.

![Просмотр страницы группы компьютеров](./media/automation-vm-inventory/machine-group-page.png)

Чтобы клонировать группу компьютеров, нажмите кнопку **+ Клонировать**. Здесь нужно задать новое имя и псевдоним для группы. Также на этом этапе можно изменить определение. После этого нажмите кнопку **Проверить запрос**, чтобы просмотреть выбранные компьютеры. Если вас все устраивает, нажмите кнопку **Создать**, чтобы создать группу компьютеров.

Если вы хотите создать новую группу компьютеров, выберите **+ создать группу компьютеров**. Откроется **страница создания группы компьютеров**, на которой вы сможете определить новую группу. Щелкните **Создать**, чтобы создать группу.

![Создание новой группы компьютеров](./media/automation-vm-inventory/create-new-group.png)

## <a name="disconnect-your-virtual-machine-from-management"></a>Отключение виртуальной машины от управления

Чтобы удалить виртуальную машину из управления инвентаризации, сделайте следующее:

1. В левой области на портале Azure выберите **Log Analytics**, а затем выберите рабочую область, используемую при подключении виртуальной машины.
2. В окне **Log Analytics** в меню **Ресурс** в категории **Workspace Data Sources** (Источники данных рабочей области) выберите **Виртуальные машины**.
3. Из списка выберите виртуальную машину, которую необходимо отключить. Рядом с ней будет зеленый флажок с текстом **This workspace** (Эта рабочая область) в столбце **OMS Connection** (Подключение OMS).

   >[!NOTE]
   >OMS, теперь называется журналы Azure Monitor.
   
4. В верхней части следующей страницы выберите **Отключить**.
5. В диалоговом окне подтверждения выберите **Да**.
    Это действие отключает компьютер от управления.

## <a name="next-steps"></a>Дальнейшие действия

* Дополнительные сведения об управлении изменениями файлов и параметров реестра на виртуальных машинах см. в статье [Отслеживание изменений программного обеспечения в среде с помощью решения для отслеживания изменений](../log-analytics/log-analytics-change-tracking.md).
* Дополнительные сведения об управлении Windows и пакетами обновлений на виртуальных машинах см. в статье [Решение для управления обновлениями в Azure](../operations-management-suite/oms-solution-update-management.md).

