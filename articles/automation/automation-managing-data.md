---
title: Управление данными службы автоматизации Azure
description: Эта статья содержит несколько разделов об управлении средой службы автоматизации Azure.  Сейчас включает в себя хранение данных и резервное копирование для аварийного восстановления службы автоматизации Azure.
services: automation
ms.subservice: shared-capabilities
ms.date: 03/23/2020
ms.topic: conceptual
ms.openlocfilehash: f917e9c64a932d75fd0f6b14c9e0f35808467355
ms.sourcegitcommit: 7d8158fcdcc25107dfda98a355bf4ee6343c0f5c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/09/2020
ms.locfileid: "80984663"
---
# <a name="managing-azure-automation-data"></a>Управление данными службы автоматизации Azure

Эта статья содержит несколько тем для управления данными в среде автоматизации Azure.

>[!NOTE]
>Эта статья была изменена и теперь содержит сведения о новом модуле Az для Azure PowerShell. Вы по-прежнему можете использовать модуль AzureRM, исправления ошибок для которого будут продолжать выпускаться как минимум до декабря 2020 г. Дополнительные сведения о совместимости модуля Az с AzureRM см. в статье [Introducing the new Azure PowerShell Az module](https://docs.microsoft.com/powershell/azure/new-azureps-module-az?view=azps-3.5.0) (Знакомство с новым модулем Az для Azure PowerShell). Для инструкций по установке модуля Az на гибридном Runbook Worker [см.](https://docs.microsoft.com/powershell/azure/install-az-ps?view=azps-3.5.0) Для учетной записи Автоматизация вы можете обновить свои модули до последней версии, используя [как обновить модули Azure PowerShell в Azure Automation.](automation-update-azure-modules.md)

## <a name="data-retention"></a>Хранение данных

При удалении ресурса в Azure Automation он сохраняется в течение нескольких дней для целей аудита до постоянного удаления. Вы не можете видеть или использовать ресурс в течение этого времени. Эта политика также применяется к ресурсам, которые принадлежат к удаленной учетной записи Automation.

В следующей таблице кратко описана политика хранения для различных ресурсов.

| Данные | Политика |
|:--- |:--- |
| Учетные записи |Учетная запись удаляется навсегда через 30 дней после того, как пользователь удаляет ее. |
| Активы |Актив удаляется на постоянной основе через 30 дней после удаления пользователем или через 30 дней после того, как пользователь удаляет учетную запись, владеющую активом. |
| Узлы DSC |Узел DSC постоянно удаляется через 30 дней после того, как не зарегистрирован ный учет с помощью портала Azure или смдлета [Unregister-AzAutomationDscNode](https://docs.microsoft.com/powershell/module/az.automation/unregister-azautomationdscnode?view=azps-3.7.0) в Windows PowerShell. Узла также навсегда удаляется через 30 дней после удаления пользователя учетной записи, вмещаемых узла. |
| Задания |Задание удаляется и постоянно удаляется через 30 дней после изменения, например, после завершения задания, останавливается или приостанавливается. |
| Модули |Модуль удаляется на постоянной основе через 30 дней после удаления пользователем или через 30 дней после того, как пользователь удаляет учетную запись, которая удерживает модуль. |
| Конфигурации узлов и MOF-файлы |Старая конфигурация узла постоянно удаляется через 30 дней после того, как создается новая конфигурация узла. |
| Отчеты узла |Отчет о узлове удаляется навсегда через 90 дней после того, как новый отчет генерируется для этого узла. |
| Модули runbook |Запуск книги постоянно удаляется через 30 дней после удаления пользователем ресурса или через 30 дней после того, как пользователь удаляет учетную запись, которая содержит ресурс. |

Политика удержания применяется ко всем пользователям и в настоящее время не может быть настроена. Однако, если необходимо хранить данные в течение более длительного периода времени, можно [перенаправить данные о работе Azure Automation в журналы Azure Monitor.](automation-manage-send-joblogs-log-analytics.md)

## <a name="data-backup"></a>Резервное копирование данных

При удалении учетной записи Автоматизации в Azure все объекты в учетной записи удаляются. Объекты включают в себя рунбуки, модули, конфигурации, настройки, задания и ресурсы. Они не могут быть восстановлены после удаления учетной записи. Вы можете использовать следующую информацию для резервного копирования содержимого учетной записи Автоматизации, прежде чем удалить ее.

### <a name="runbooks"></a>Модули runbook

Модули Runbook можно экспортировать в файлы сценариев с помощью портала Azure или командлета [Get-AzureAutomationRunbookDefinition](https://docs.microsoft.com/powershell/module/servicemanagement/azure/get-azureautomationrunbookdefinition) в Windows PowerShell. Вы можете импортировать эти файлы скриптов в другую учетную запись Автоматизации, как это обсуждается в [runbooks в Azure Automation.](manage-runbooks.md)

### <a name="integration-modules"></a>Модули интеграции

Вы не можете экспортировать интеграционные модули из Azure Automation. Вы должны сделать их доступными за пределами учетной записи Автоматизация.

### <a name="assets"></a>Активы

Активы Azure Automation не могут экспортировать: сертификаты, соединения, учетные данные, расписания и переменные. Вместо этого можно использовать портал Azure и cmdlets Azure, чтобы узнать детали этих ресурсов. Затем используйте эти сведения для создания любых активов, которые используются в runbooks, которые вы импортируете в другую учетную запись Автоматизация.

Вы не можете получить значения для зашифрованных переменных или полей паролей учетных данных с помощью cmdlets. Если вы не знаете этих значений, вы можете получить их в runbook. Для получения переменных значений [см.](shared-resources/variables.md) Узнать больше о получении учетных данных можно в [Azure Automation.](shared-resources/credentials.md)

 ### <a name="dsc-configurations"></a>Конфигурации DSC

Вы можете экспортировать свои конфигурации DSC в файлы сценариев с помощью портала Azure или смдлета [Экспорт-AzAutomationDscConfiguration](https://docs.microsoft.com/powershell/module/az.automation/export-azautomationdscconfiguration?view=azps-3.7.0
) в Windows PowerShell. Вы можете импортировать и использовать эти конфигурации в другой учетной записи Автоматизации.

## <a name="geo-replication-in-azure-automation"></a>Георепликация в службе автоматизации Azure

Георепликация является стандартной в учетных записях Azure Automation. При настройке учетной записи вы выбираете основной регион. Служба георепликации внутренней автоматизации автоматически присваивает учетную запись второстепенный регион. Затем служба непрерывно резервирует данные учетной записи из первичного региона во вторичный регион. Полный список первичных и вторичных регионов можно найти в [непрерывности бизнеса и аварийном восстановлении (BCDR): Зоны спайки Azure.](https://docs.microsoft.com/azure/best-practices-availability-paired-regions) 

Резервное копирование, созданное службой георепликации Automation, представляет собой полную копию активов, конфигураций автоматизации и т.п. Это резервное копирование может быть использовано, если основная область выходит из системы и теряет данные. В маловероятном случае потери данных для основного региона корпорация Майкрософт пытается восстановить их. Если компания не может восстановить первичные данные, она использует автоматическое сбой и информирует вас о ситуации через подписку Azure. 

Служба георепликации автоматизации недоступна напрямую внешним клиентам при региональном сбое. Если вы хотите поддерживать конфигурацию автоматизации и runbooks во время региональных сбоев:

1. Выберите вторичный регион для сопряжения с географическим регионом основной учетной записи автоматизации.

2. Создание учетной записи автоматизации во вторичном регионе.

3. В основной учетной записи экспортируйте свои рунбуки в виде скриптов.

4. Импортируйте руны на свой аккаунт Автоматизации во вторичном регионе.

## <a name="next-steps"></a>Дальнейшие действия

* Чтобы узнать больше о безопасных ресурсах в Azure Automation, [см.](automation-secure-asset-encryption.md)

* Чтобы узнать больше о георепликации, [см. Создание и использование активной георепликации.](https://docs.microsoft.com/azure/sql-database/sql-database-active-geo-replication)