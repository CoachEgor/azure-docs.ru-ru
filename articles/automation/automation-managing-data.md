---
title: Управление данными службы автоматизации Azure
description: В этой статье описываются основные понятия управления данными в службе автоматизации Azure, включая хранение и резервное копирование данных.
services: automation
ms.subservice: shared-capabilities
ms.date: 03/23/2020
ms.topic: conceptual
ms.openlocfilehash: de60ef31a39a698f9a797a5836546f9b75b67594
ms.sourcegitcommit: 0b80a5802343ea769a91f91a8cdbdf1b67a932d3
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/25/2020
ms.locfileid: "83835212"
---
# <a name="management-of-azure-automation-data"></a>Управление данными службы автоматизации Azure

Эта статья содержит несколько разделов об управлении данными в среде службы автоматизации Azure.

## <a name="data-retention"></a>Хранение данных

После удаления ресурса в службе автоматизации Azure он сохраняется еще несколько дней в целях аудита, прежде чем будет удален окончательно. В течение этого времени его нельзя увидеть или использовать. Эта политика применяется также к ресурсам удаляемой учетной записи службы автоматизации.

В следующей таблице кратко описана политика хранения для различных ресурсов.

| Данные | Политика |
|:--- |:--- |
| Учетные записи |Учетная запись окончательно удаляется через 30 дней после удаления пользователем. |
| Активы |Актив окончательно удаляется через 30 дней после удаления пользователем или через 30 дней после удаления пользователем учетной записи, которая содержала этот актив. |
| Узлы DSC |Узел DSC окончательно удаляется через 30 дней после отмены регистрации в учетной записи службы автоматизации на портале Azure или с помощью командлета [Unregister-AzAutomationDscNode](https://docs.microsoft.com/powershell/module/az.automation/unregister-azautomationdscnode?view=azps-3.7.0) в Windows PowerShell. Также узел окончательно удаляется через 30 дней после удаления пользователем учетной записи, которая содержала этот узел. |
| Задания |Задание удаляется окончательно через 30 дней после изменения его состояния, например после его завершения, остановки или приостановки. |
| Модули |Модуль окончательно удаляется через 30 дней после удаления пользователем или через 30 дней после удаления пользователем учетной записи, которая содержала этот модуль. |
| Конфигурации узлов и MOF-файлы |Старая конфигурация узла окончательно удаляется через 30 дней после создания новой конфигурации узла. |
| Отчеты узла |Отчет узла окончательно удаляется через 90 дней после создания нового отчета для того же узла. |
| Модули runbook |Ресурс runbook окончательно удаляется через 30 дней после удаления пользователем или через 30 дней после удаления пользователем учетной записи, которая содержала этот ресурс. |

Политика хранения применяется ко всем пользователям и в настоящее время не может быть изменена. Но если вам нужно сохранять данные на более длительный период времени, воспользуйтесь [пересылкой данных задания службы автоматизации Azure в журналы Azure Monitor](automation-manage-send-joblogs-log-analytics.md).

## <a name="data-backup"></a>Резервное копирование данных

При удалении учетной записи службы автоматизации в Azure удаляются и все содержащиеся в ней объекты. Это могут быть runbook, модули, конфигурации, параметры, задания и активы. Объекты невозможно восстановить после удаления учетной записи. Приведенная ниже информация позволит вам создать резервную копию содержимого учетной записи службы автоматизации перед ее удалением.

### <a name="runbooks"></a>Модули runbook

Модули Runbook можно экспортировать в файлы сценариев с помощью портала Azure или командлета [Get-AzureAutomationRunbookDefinition](https://docs.microsoft.com/powershell/module/servicemanagement/azure/get-azureautomationrunbookdefinition) в Windows PowerShell. Чтобы импортировать файлы скрипта в другую учетную запись службы автоматизации, воспользуйтесь руководством [Управление модулями runbook в службе автоматизации Azure](manage-runbooks.md).

### <a name="integration-modules"></a>Модули интеграции

Модули интеграции невозможно экспортировать из службы автоматизации Azure. Для них нужно настроить доступность из-за пределов учетной записи службы автоматизации.

### <a name="assets"></a>Активы

Невозможно экспортировать следующие активы службы автоматизации Azure: сертификаты, подключения, учетные данные, расписания и переменные. Но вы можете сохранить сведения об этих активах, используя портал Azure и командлеты Azure. На основе этих сведений можно воссоздать все ресурсы, используемые в runbook, которые вы импортируете в другую службу автоматизации.

С помощью командлетов невозможно получить значения зашифрованных переменных или полей с паролями для учетных данных. Если эти значения вам неизвестны, их можно получить из runbook. Извлечение значений переменных описано в статье [Управление переменными в службе автоматизации Azure](shared-resources/variables.md). Сведения о получении значений учетных данных см. в статье [Управление учетными данными в службе автоматизации Azure](shared-resources/credentials.md).

 ### <a name="dsc-configurations"></a>Конфигурации DSC

Конфигурации DSC можно экспортировать в файлы скриптов с помощью портала Azure или командлета [Export-AzAutomationDscConfiguration](https://docs.microsoft.com/powershell/module/az.automation/export-azautomationdscconfiguration?view=azps-3.7.0
) в Windows PowerShell. Вы можете импортировать эти конфигурации и применить их в другой учетной записи службы автоматизации.

## <a name="geo-replication-in-azure-automation"></a>Георепликация в службе автоматизации Azure

Георепликация является стандартной возможностью в учетных записях службы автоматизации Azure. При настройке учетной записи вы выбираете основной регион. Внутренняя служба георепликации в службе автоматизации сама назначает учетной записи дополнительный регион. После этого она постоянно сохраняет резервные копии данных учетной записи из основного региона в дополнительном регионе. Полный список основных и дополнительных регионов см. в статье [Непрерывность бизнес-процессов и аварийное восстановление (BCDR) в парах регионов Azure](https://docs.microsoft.com/azure/best-practices-availability-paired-regions). 

Резервная копия, созданная службой георепликации службы автоматизации, является полной копией всех активов, конфигураций и т. п. из службы автоматизации. Эта резервная копия пригодится в том случае, если основной регион выйдет из строя и/или потеряет ваши данные. В этом маловероятном случае корпорация Майкрософт попытается восстановить утраченные данные основного региона. Если восстановление окажется невозможным, будет выполнена автоматическая отработка отказа, после чего вы получите оповещение о сложившейся ситуации через стандартные механизмы подписки Azure. 

У внешних клиентов нет возможности напрямую использовать службу георепликации службы автоматизации в случае регионального сбоя. Если вы хотите сохранить возможность обновлять конфигурацию и runbook в службе автоматизации во время региональных сбоев, сделайте следующее.

1. Выберите дополнительный регион, являющийся парным для региона вашей основной учетной записи службы автоматизации.

2. Создайте учетную запись службы автоматизации в этом дополнительном регионе.

3. Экспортируйте runbook в виде файлов скриптов из основной учетной записи.

4. Импортируйте эти runbook в учетную запись службы автоматизации в дополнительном регионе.

## <a name="next-steps"></a>Дальнейшие действия

* Сведения о защите активов в службе автоматизации см. в статье [Шифрование защищенных ресурсов в службе автоматизации Azure](automation-secure-asset-encryption.md).
* Подробные сведения о георепликации см. в статье [Создание и использование активной георепликации](https://docs.microsoft.com/azure/sql-database/sql-database-active-geo-replication).