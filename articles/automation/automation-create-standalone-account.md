---
title: Создание автономной учетной записи службы автоматизации Azure
description: В этой статье приводятся пошаговые инструкции по созданию и тестированию, а также пример проверки подлинности с помощью субъекта безопасности в службе автоматизации Azure.
services: automation
ms.subservice: process-automation
ms.date: 01/15/2019
ms.topic: conceptual
ms.openlocfilehash: 72a40363edf0e83eea26ee697ce992226da0db4f
ms.sourcegitcommit: 849bb1729b89d075eed579aa36395bf4d29f3bd9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2020
ms.locfileid: "81392294"
---
# <a name="create-a-standalone-azure-automation-account"></a>Создание автономной учетной записи службы автоматизации Azure

В этой статье объясняется, как создать учетную запись службы автоматизации на портале Azure. Учетную запись автоматизации портала можно использовать для ознакомления и изучения автоматизации без использования дополнительных решений по управлению или интеграции с журналами Azure Monitor. Вы можете добавить эти решения для управления или интегрировать их с журналами Azure Monitor для расширенного мониторинга заданий Runbook в любой момент в будущем.

С использованием учетной записи службы автоматизации можно проверять подлинность ресурсов управления модулями Runbook в модели Azure Resource Manager или в классической модели развертывания. Одна учетная запись автоматизации может управлять ресурсами во всех регионах и подписках для конкретного клиента.

При создании учетной записи службы автоматизации в портал Azure учетная запись **запуска от имени** создается автоматически. Она выполняет следующие задачи:

* создает субъект-службу в Azure Active Directory (Azure AD);
* создает сертификат;
* назначает управление доступом на основе ролей участника (RBAC), используемое для управления ресурсами Azure Resource Manager с помощью модулей Runbook.

После создания этой учетной записи вы сможете быстро приступить к созданию и развертыванию модулей Runbook для поддержки нужд автоматизации.

## <a name="permissions-required-to-create-an-automation-account"></a>Разрешения, необходимые для создания учетной записи службы автоматизации

Чтобы создать или обновить учетную запись службы автоматизации и выполнить задачи, приведенные в этой статье, вам потребуются указанные ниже привилегии и разрешения.

* Чтобы создать учетную запись службы автоматизации, необходимо добавить учетную запись пользователя Azure AD к роли с разрешениями, эквивалентными `Microsoft.Automation` роли владельца для ресурсов. Дополнительные сведения см. в статье [Управление доступом на основе ролей в службе автоматизации Azure](automation-role-based-access-control.md).
* В портал Azure в разделе **Azure Active Directory** > **Управление** > **параметрами пользователя**, если для **параметра Регистрация приложений** задано значение **Да**, пользователи без прав администратора в клиенте Azure AD могут [регистрировать приложения Active Directory](../active-directory/develop/howto-create-service-principal-portal.md#check-azure-subscription-permissions). Если для параметра **Регистрация приложений** задано значение **Нет**, пользователю потребуются права глобального администратора в Azure AD, чтобы выполнить это действие.

Если вы не являетесь членом Active Directory экземпляра подписки, прежде чем добавить роль глобального администратора или соадминистратора подписки, вы добавите в Active Directory в качестве гостя. В этом сценарии вы видите это сообщение на панели Добавление учетной записи службы автоматизации:`You do not have permissions to create.`

Если пользователь добавляется в роль глобального администратора или соадминистратора, можно удалить пользователя из экземпляра Active Directory подписки. Вы можете прочитать пользователя в роли пользователя в Active Directory.

Чтобы проверить роли пользователей, сделайте следующее:

1. На портале Azure перейдите на панель Azure Active Directory.
1. Выберите **Пользователи и группы**.
1. Выберите **все пользователи**.
1. После выбора конкретного пользователя выберите **Профиль**. Значение атрибута **Тип пользователя** в профиле пользователя не должно соответствовать значению **Гость**.

## <a name="create-a-new-automation-account-in-the-azure-portal"></a>Создание учетной записи службы автоматизации на портале Azure

Чтобы создать учетную запись службы автоматизации Azure на портале Azure, выполните следующие действия:

1. Войдите на портал Azure с помощью учетной записи, добавленной в качестве участника роли "Администраторы" подписки и соадминистратора подписки.
1. Выберите действие **+ Создать ресурс**.
1. Введите в строку поиска **Служба автоматизации**. В результатах поиска выберите **Автоматизация**.

   ![Поиск и выбор предложения "Автоматизация и управление" в Azure Marketplace](media/automation-create-standalone-account/automation-marketplace-select-create-automationacct.png)

1. На следующем экране выберите **создать**.

   ![Добавление учетной записи службы автоматизации](media/automation-create-standalone-account/automation-create-automationacct-properties.png)

   > [!NOTE]
   > Если учетная запись не является участником роли "Администраторы подписки" и соадминистратором подписки, в колонке Добавление учетной записи службы автоматизации отобразится следующее сообщение.
   >
   > ![Предупреждение в области "Добавление учетной записи службы автоматизации"](media/automation-create-standalone-account/create-account-without-perms.png)

1. В области Добавление учетной записи службы автоматизации введите имя новой учетной записи службы автоматизации в поле **имя** . Это имя нельзя изменить после его выбора. 

    > [!NOTE]
    > Имена учетных записей службы автоматизации уникальны для каждого региона и группы ресурсов. Имена удаленных учетных записей службы автоматизации могут быть недоступными сразу.

1. При наличии нескольких подписок используйте поле **Подписка** , чтобы указать подписку, которая будет использоваться для новой учетной записи.
1. В поле **Группа ресурсов** укажите или выберите новую или имеющуюся группу ресурсов.
1. В поле **Расположение** выберите расположение центра обработки данных Azure.
1. Для параметра **создать учетную запись запуска от имени Azure** установите флажок **Да** , а затем нажмите кнопку **создать**.

   > [!NOTE]
   > Если вы решили не создавать учетную запись запуска от имени и выбрали значение **Нет** для параметра **Создать учетную запись запуска от имени**, в области Добавление учетной записи службы автоматизации появится сообщение. Хотя учетная запись и создается на портале Azure, она не содержит соответствующее удостоверение проверки подлинности в службе каталогов подписки классической модели развертывания или подписки Azure Resource Manager. Поэтому у учетной записи службы автоматизации не будет доступа к ресурсам в вашей подписке. Из-за этого модули Runbook, ссылающиеся на эту учетную запись, не смогут проходить проверку подлинности и выполнять задачи, используя ресурсы в соответствующих моделях развертывания.
   >
   > ![Предупреждение в области "Добавление учетной записи службы автоматизации"](media/automation-create-standalone-account/create-account-decline-create-runas-msg.png)
   >
   > Если субъект-служба не создан, роль участника не назначается.
   >

1. Чтобы отслеживать ход создания учетной записи службы автоматизации, выберите в меню пункт **уведомления** .

### <a name="resources-included"></a>Создаваемые ресурсы

После создания учетной записи службы автоматизации автоматически создаются несколько ресурсов. После создания эти модули Runbook можно безопасно удалить, если вы не хотите их хранить. Чтобы выполнить аутентификацию для вашей учетной записи в модуле runbook, можно использовать учетные записи запуска от имени. Вы можете не удалять их, если не собираетесь создавать новую учетную запись или если они еще могут потребоваться. В следующей таблице перечислены ресурсы для учетной записи запуска от имени.

| Ресурс | Описание |
| --- | --- |
| Модуль Runbook AzureAutomationTutorial |Пример графического модуля Runbook, который демонстрирует, как выполнить проверку подлинности с помощью учетной записи запуска от имени. Он получает доступ ко всем ресурсам Resource Manager. |
| Модуль Runbook AzureAutomationTutorialScript |Пример модуля Runbook PowerShell, который демонстрирует, как выполнить проверку подлинности с помощью учетной записи запуска от имени. Он получает доступ ко всем ресурсам Resource Manager. |
| AzureAutomationTutorialPython2 Runbook |Пример модуля Runbook Python, в котором показано, как выполнить аутентификацию с помощью учетной записи запуска от имени. Модуль Runbook отображает список групп ресурсов для указанной подписки. |
| AzureRunAsCertificate |Ресурс сертификатов, создаваемый автоматически во время создания учетной записи службы автоматизации или с помощью приведенного ниже сценария PowerShell для имеющейся учетной записи. Этот сертификат позволяет пройти проверку подлинности в Azure, что дает возможность управлять ресурсами Azure Resource Manager с помощью модулей Runbook. Срок действия этого сертификата — один год. |
| AzureRunAsConnection |Ресурс подключений, создаваемый автоматически во время создания учетной записи службы автоматизации или с помощью сценария PowerShell для имеющейся учетной записи. |

## <a name="create-a-classic-run-as-account"></a>Создание классической учетной записи запуска от имени

Классические учетные записи запуска от имени больше не создаются по умолчанию при создании учетной записи службы автоматизации Azure. Если вам по-прежнему требуется Классическая учетная запись запуска от имени:

1. В учетной записи службы автоматизации выберите **учетные записи запуска от имени** в разделе **Параметры учетной записи**.
2. Выберите **классическую учетную запись запуска от имени Azure**.
3. Нажмите кнопку **создать** , чтобы продолжить создание классической учетной записи запуска от имени.

## <a name="next-steps"></a>Дальнейшие действия

* Дополнительные сведения о графической разработке см. [в этой статье](automation-graphical-authoring-intro.md).
* Чтобы приступить к работе с модулями Runbook PowerShell, см. [Мой первый модуль Runbook PowerShell](automation-first-runbook-textual-powershell.md).
* Чтобы приступить к работе с модулями Runbook рабочих процессов PowerShell, см. [Мой первый Runbook рабочего процесса PowerShell](automation-first-runbook-textual.md).
* Чтобы приступить к работе с модулями Runbook Python 2, ознакомьтесь с [моим первым модулем Runbook python2](automation-first-runbook-textual-python2.md).
* Справочник по командлетам PowerShell см. в документации по [Az.Automation](https://docs.microsoft.com/powershell/module/az.automation/?view=azps-3.7.0#automation
).
