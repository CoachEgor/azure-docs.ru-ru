---
title: Перемещение учетной записи службы автоматизации Azure в другую подписку
description: В этой статье описывается Перемещение учетной записи службы автоматизации в другую подписку
services: automation
ms.service: automation
ms.subservice: process-automation
author: bobbytreed
ms.author: robreed
ms.date: 03/11/2019
ms.topic: conceptual
manager: carmonm
ms.openlocfilehash: a82358a2194f10a2112ed89109f0f2933dfd5fe2
ms.sourcegitcommit: f811238c0d732deb1f0892fe7a20a26c993bc4fc
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/29/2019
ms.locfileid: "67478610"
---
# <a name="move-your-azure-automation-account-to-another-subscription"></a>Перемещение учетной записи службы автоматизации Azure в другую подписку

Azure предоставляет возможность перемещения некоторых ресурсов в новую группу ресурсов или подписку. Можно переместить ресурсы с помощью портала Azure, PowerShell, Azure CLI или REST API. Дополнительные сведения о процессе, см. в разделе [перемещение ресурсов в новую группу ресурсов или подписки](../../azure-resource-manager/resource-group-move-resources.md). 

Учетные записи службы автоматизации Azure — один из ресурсов, которые могут быть перемещены. В этой статье вы узнаете, как действия для перемещения учетных записей службы автоматизации в другую ресурсов или подписку.

Перечислены основные действия по переносу учетной записи службы автоматизации.

1. Удалите свои решения.
2. Удалить связь с рабочей области.
3. Перемещение учетной записи службы автоматизации.
4. Удаление и повторное создание учетных записей запуска от имени.
5. Повторно включите свои решения.

## <a name="remove-solutions"></a>Удаление решения

Чтобы отменить привязку рабочую область из учетной записи службы автоматизации, эти решения необходимо удалить из рабочей области:
- **Отслеживание изменений и инвентаризация**
- **Управление обновлениями** 
- **Запуск и остановка виртуальных машин в нерабочее время** 

В группе ресурсов, найдите каждое решение и выберите **удалить**. На **удалить ресурсы** убедитесь, ресурсы, которые необходимо удалить и выберите **удалить**.

![Удаление решения с помощью портала Azure](../media/move-account/delete-solutions.png)

Можно выполнить ту же задачу с [Remove-AzureRmResource](/powershell/module/azurerm.resources/remove-azurermresource) командлета, как показано в следующем примере:

```azurepowershell-interactive
$workspaceName = <myWorkspaceName>
$resourceGroupName = <myResourceGroup>
Remove-AzureRmResource -ResourceType 'Microsoft.OperationsManagement/solutions' -ResourceName "ChangeTracking($workspaceName)" -ResourceGroupName $resourceGroupName
Remove-AzureRmResource -ResourceType 'Microsoft.OperationsManagement/solutions' -ResourceName "Updates($workspaceName)" -ResourceGroupName $resourceGroupName
Remove-AzureRmResource -ResourceType 'Microsoft.OperationsManagement/solutions' -ResourceName "Start-Stop-VM($workspaceName)" -ResourceGroupName $resourceGroupName
```

### <a name="additional-steps-for-startstop-vms"></a>Дополнительные действия для запуска и остановки виртуальных машин

Для **запуск и остановка виртуальных машин** решение, необходимо также удалить правила генерации оповещений, созданных решением.

На портале Azure, перейдите в группу ресурсов и выберите **мониторинг** > **оповещения** > **Управление правилами генерации оповещений**.

![Страница выбора отображение правил генерации оповещений управление оповещения](../media/move-account/alert-rules.png)

На **правила** страницы, вы увидите список оповещений, настроенных в этой группе ресурсов. **Запуск и остановка виртуальных машин** решение создает три правила генерации оповещений:

* AutoStop_VM_Child
* ScheduledStartStop_Parent
* SequencedStartStop_Parent

Выберите эти три правила генерации оповещений, а затем выберите **удалить**. Это действие удалит эти правила генерации оповещений.

![Страница правил, запрос на подтверждение удаления для выбранного правила](../media/move-account/delete-rules.png)

> [!NOTE]
> Если вы не видите никаких правил оповещений на **правила** странице **состояние** Показать **отключена** создает предупреждение, так как вы возможно, отключены их.

При удалении правила генерации оповещений, удалите группу действий, который был создан для **запуск и остановка виртуальных машин** решение уведомления.

На портале Azure выберите **монитор** > **оповещения** > **управлять группами действий**.

Выберите **StartStop_VM_Notification** из списка. На странице группы "действие", выберите **удалить**.

![Удалить действие странице группы выберите](../media/move-account/delete-action-group.png)

Аналогичным образом, можно удалить группу действий, с помощью Azure PowerShell [Remove-azurermactiongroup:](/powershell/module/azurerm.insights/remove-azurermactiongroup) командлет, как показано в следующем примере:

```azurepowershell-interactive
Remove-AzureRmActionGroup -ResourceGroupName <myResourceGroup> -Name StartStop_VM_Notification
```

## <a name="unlink-your-workspace"></a>Удалить связь с рабочей области

На портале Azure выберите **учетной записи службы автоматизации** > **связанные ресурсы** > **рабочей области связанные**. Выберите **связь с рабочей областью** связь с рабочей областью, из учетной записи службы автоматизации.

![Связь с рабочей областью из учетной записи службы автоматизации](../media/move-account/unlink-workspace.png)

## <a name="move-your-automation-account"></a>Перемещение учетной записи службы автоматизации

После удаления предыдущих элементов, вы можете удалить учетную запись службы автоматизации и свои модули Runbook. На портале Azure перейдите к группе ресурсов из учетной записи службы автоматизации. Выберите **переместить** > **переместить в другую подписку**.

![Странице группы ресурсов, перемещение в другую подписку](../media/move-account/move-resources.png)

Выберите ресурсы в группе ресурсов, которую требуется переместить. Убедитесь, включены в **учетной записи службы автоматизации**, **Runbook**, и **рабочей области Log Analytics** ресурсы.

После завершения перемещения некоторые дополнительные действия, требуется для того, все работает.

## <a name="re-create-run-as-accounts"></a>Повторно создать учетные записи запуска от имени

[Учетные записи запуска от имени](../manage-runas-account.md) создать субъект-службу в Azure Active Directory для проверки подлинности с ресурсами Azure. При изменении подписок учетной записи службы автоматизации не использует существующую учетную запись запуска от имени.

Перейдите к учетной записи службы автоматизации в новую подписку и выберите **выполняются с учетными записями** под **параметры учетной записи**. Вы увидите, что учетные записи запуска от имени показывают как незавершенная теперь.

![Учетные записи запуска от имени, содержат неполные сведения](../media/move-account/run-as-accounts.png)

Выберите каждой учетной записи запуска от имени. На **свойства** выберите **удалить** удалить учетную запись запуска от имени.

> [!NOTE]
> Если у вас нет разрешений на создание или просмотреть учетные записи запуска от имени, вы увидите следующее сообщение: `You do not have permissions to create an Azure Run As account (service principal) and grant the Contributor role to the service principal.` Дополнительные сведения о разрешениях, необходимых для настройки учетной записи запуска от имени, см. в разделе [разрешения, необходимые для настройки учетных записей запуска от имени](../manage-runas-account.md#permissions).

После удаления учетных записей запуска от имени, выберите **создать** под **учетной записи запуска от имени Azure**. На **добавить Azure запись запуска от имени** выберите **создать** для создания субъекта-службы и учетной записи запуска от имени. Повторите предыдущие шаги с **Azure классической учетной записи запуска от**.

## <a name="enable-solutions"></a>включение решений;

После повторного создания учетных записей запуска от имени, будет включена снова решений, которые удалены до перемещения. Чтобы включить **отслеживания изменений и инвентаризации** и **управления обновлениями**, выберите соответствующие возможности в учетной записи службы автоматизации. Выберите рабочую область Log Analytics, перемещении по и **включить**.

![Повторное включение решения в перемещенной учетной записи службы автоматизации](../media/move-account/reenable-solutions.png)

Компьютеры, которые будут подключены с решениями, будут отображаться при подключении существующую рабочую область Log Analytics.

Чтобы включить **запуск и остановка виртуальных машин** решение нерабочее время, вам потребуется повторно развернуть решение. В разделе **связанные ресурсы**выберите **запуск и остановка виртуальных машин** > **Получите подробные сведения и включите решение** > **создать** чтобы начать развертывание.

На **добавить решение** выберите вашей рабочей области Log Analytics и учетная запись автоматизации.  

![Решение меню "Добавить"](../media/move-account/add-solution-vm.png)

Подробные инструкции по настройке решения, см. в разделе [запуск и остановка виртуальных машин в нерабочее время решения в службе автоматизации Azure](../automation-solution-vm-management.md).

## <a name="post-move-verification"></a>После перемещения проверки

После завершения перемещения, проверьте перечисленные ниже задачи, которые необходимо проверить.

|Функция|Тесты|Устранение неполадок связи|
|---|---|---|
|Модули Runbook|Модуль runbook можно успешно запустить и подключиться к ресурсам Azure.|[Устранение неполадок с модулями Runbook](../troubleshoot/runbooks.md)
| Система управления версиями|Необходимо выполнить синхронизацию вручную на вашего репозитория системы управления версиями.|[Интеграция системы управления версиями](../source-control-integration.md)|
|Отслеживание изменений и инвентаризации|Убедитесь, что вы видите текущие данные инвентаризации с машин.|[Устранение неполадок с отслеживанием изменений](../troubleshoot/change-tracking.md)|
|Управление обновлениями|Убедитесь, вы увидите свои компьютеры, и они работоспособное.</br>Выполните тестовое развертывание обновления программного обеспечения.|[Устранение неполадок управления обновлениями](../troubleshoot/update-management.md)|

## <a name="next-steps"></a>Дальнейшие действия

Дополнительные сведения о перемещении ресурсов в Azure, см. в разделе [перемещение ресурсов в Azure](../../azure-resource-manager/move-support-resources.md).
