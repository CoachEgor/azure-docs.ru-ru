---
title: Мониторинг и настройка производительности
description: Обзор возможностей мониторинга и настройки производительности и методологии в базе данных SQL Azure.
services: sql-database
ms.service: sql-database
ms.subservice: performance
ms.custom: ''
ms.devlang: ''
ms.topic: conceptual
author: jovanpop-msft
ms.author: jovanpop
ms.reviewer: jrasnick, carlrab
ms.date: 03/10/2020
ms.openlocfilehash: 837d88665c1fdffe902c9c478e5d6dc65a2e402a
ms.sourcegitcommit: 849bb1729b89d075eed579aa36395bf4d29f3bd9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2020
ms.locfileid: "79268734"
---
# <a name="monitoring-and-performance-tuning-in-azure-sql-database"></a>Мониторинг и настройка производительности в базе данных SQL Azure

Чтобы отслеживать производительность базы данных в базе данных SQL Azure, начните с наблюдения за ресурсами ЦП и ввода-вывода, используемыми рабочей нагрузкой, относительно уровня производительности базы данных, выбранного при выборе конкретного уровня служб и уровня производительности. Для этого база данных SQL Azure выдает метрики ресурсов, которые можно просмотреть в портал Azure или с помощью одного из следующих средств управления SQL: [Azure Data Studio](https://docs.microsoft.com/sql/azure-data-studio/what-is) или [SQL Server Management Studio](https://docs.microsoft.com/sql/ssms/sql-server-management-studio-ssms) (SSMS).

Для баз данных в одной службе и в составе пула база данных SQL Azure предоставляет ряд помощников по базам данных, позволяющих обеспечить Интеллектуальные рекомендации по настройке производительности и параметры автоматической настройки для повышения производительности. Кроме того, анализ производительности запросов отображает подробные сведения о запросах, ответственных за наибольшее использование ЦП и операций ввода-вывода для баз данных в одной и в составе пула.

База данных SQL Azure предоставляет дополнительные возможности мониторинга и настройки, поддерживаемые искусственным интеллектом, чтобы помочь в устранении неполадок и максимальном увеличении производительности баз данных и решений. Вы можете настроить [потоковый экспорт](sql-database-metrics-diag-logging.md) этих [Intelligent Insights](sql-database-intelligent-insights.md) и других журналов ресурсов базы данных SQL и метрик в одно из нескольких назначений для использования и анализа, особенно с помощью [аналитики SQL](../azure-monitor/insights/azure-sql.md). Аналитика SQL Azure — это расширенное решение мониторинга облака для мониторинга производительности всех баз данных SQL Azure в масштабе и нескольких подписок в одном представлении. Список журналов и метрик, которые можно экспортировать, см. в статье [диагностические данные диагностики для экспорта](sql-database-metrics-diag-logging.md#diagnostic-telemetry-for-export-for-azure-sql-database) .

Наконец, SQL имеет собственные возможности мониторинга и диагностики с [SQL Server хранилищем запросов](https://docs.microsoft.com/sql/relational-databases/performance/monitoring-performance-by-using-the-query-store) и [динамическими административными представлениями (DMV)](https://docs.microsoft.com/sql/relational-databases/system-dynamic-management-views/system-dynamic-management-views). В разделе [мониторинг с помощью динамических административных](sql-database-monitoring-with-dmvs.md) сценариев для отслеживания различных проблем с производительностью.

## <a name="monitoring-and-tuning-capabilities-in-the-azure-portal"></a>Возможности мониторинга и настройки в портал Azure

В портал Azure база данных SQL Azure обеспечивает мониторинг метрик ресурсов для всех типов развертывания. Дополнительные, для баз данных в одной и в составе пула, Advisor и анализ производительности запросов обеспечивают рекомендации по настройке запросов и анализ производительности запросов. Наконец, в портал Azure можно включить автоматическое включение логических серверов и их отдельных баз данных и в составе пула.

### <a name="sql-database-resource-monitoring"></a>Мониторинг ресурсов базы данных SQL

Вы можете быстро отслеживать следующие метрики ресурсов в портал Azure в представлении **метрики** :

- **Использование DTU**

  Проверьте, приближается ли база данных или эластичный пул к 100 процента использования DTU в течение продолжительного периода времени. Высокая степень использования DTU указывает, что для рабочей нагрузки может потребоваться больше ресурсов ЦП или операций ввода-вывода. Он также может указывать на запросы, которые необходимо оптимизировать.
- **Использование ЦП**

  Проверьте, приближается ли база данных, эластичный пул или управляемый экземпляр к 100 проценту использования ЦП в течение продолжительного периода времени. Высокая загрузка ЦП означает, что вашей рабочей нагрузке может потребоваться больше ресурсов ЦП или операций ввода-вывода. Он также может указывать на запросы, которые необходимо оптимизировать.
- **Использование операций ввода-вывода**

  Проверьте, приближается ли база данных, эластичный пул или экземпляр управления к ограничениям ввода-вывода в базовом хранилище. Высокая интенсивность использования операций ввода-вывода указывает, что для рабочей нагрузки может потребоваться больше ресурсов ЦП или операций ввода-вывода. Он также может указывать на запросы, которые необходимо оптимизировать.

  ![Метрики ресурсов](./media/sql-database-monitor-tune-overview/resource-metrics.png)

### <a name="database-advisors"></a>Помощники по базам данных
' База данных SQL Azure включает в себя рекомендации [по](sql-database-advisor.md) настройке производительности для баз данных в одной и в составе пула. Эти рекомендации доступны в портал Azure, а также с помощью [PowerShell](https://docs.microsoft.com/powershell/module/az.sql/get-azsqldatabaseadvisor). Можно также включить [автоматическую настройку](sql-database-automatic-tuning.md) , чтобы база данных SQL могла автоматически реализовывать эти рекомендации по настройке.

### <a name="query-performance-insight"></a>Анализ производительности запросов

[Анализ производительности запросов](sql-database-query-performance.md) показывает производительность в портал Azure самых ресурсоемких и наиболее длительных запросов для баз данных в одной и в составе пула.

## <a name="generate-intelligent-assessments-of-performance-issues"></a>Создание интеллектуальной оценки проблем производительности

[Intelligent Insights](sql-database-intelligent-insights.md) базы данных SQL Azure использует встроенную аналитику для постоянного отслеживания использования базы данных с помощью искусственного интеллекта и обнаружения событий, вызывающих снижение производительности. Intelligent Insights автоматически обнаруживает проблемы с производительностью баз данных в базе данных SQL Azure на основе времени ожидания выполнения запроса, ошибок или истечения времени ожидания. После обнаружения будет выполнен подробный анализ, создающий журнал ресурсов (именуемый SQLInsights) с [интеллектуальной оценкой проблем](sql-database-intelligent-insights-troubleshoot-performance.md). Эта оценка состоит из анализа первопричин проблемы с производительностью базы данных и возможных рекомендаций по повышению производительности.

Intelligent Insights — уникальная функция встроенного аналитического механизма Azure, который предлагает следующие возможности:

- Упреждающий мониторинг
- специализированная аналитика производительности;
- заблаговременное выявление снижения производительности базы данных;
- анализ первопричин обнаруженных проблем;
- рекомендации по повышению производительности;
- возможность развертывания сотен тысяч баз данных;
- положительное влияние на ресурсы DevOps и совокупную стоимость владения.

## <a name="enable-the-streaming-export-of-metrics-and-resource-logs"></a>Включение потокового экспорта метрик и журналов ресурсов

Вы можете включить и настроить [потоковую передачу телеметрии диагностики](sql-database-metrics-diag-logging.md) в одно из нескольких назначений, включая журнал ресурсов Intelligent Insights. Используйте [SQL Analytics](../azure-monitor/insights/azure-sql.md) и другие возможности для использования этой дополнительной диагностической телеметрии для выявления и устранения проблем с производительностью.

Вы настраиваете параметры диагностики для потоковой передачи категорий метрик и журналов ресурсов для отдельных баз данных, баз данных в пуле, эластичных пулов, управляемых экземпляров и баз данных экземпляров в один из следующих ресурсов Azure.

### <a name="log-analytics-workspace-in-azure-monitor"></a>Рабочая область Log Analytics в Azure Monitor

Вы можете передавать метрики и журналы ресурсов в [рабочую область log Analytics в Azure Monitor](../azure-monitor/platform/resource-logs-collect-workspace.md). Поток данных, переданный здесь, можно использовать в [SQL Analytics](../azure-monitor/insights/azure-sql.md), который представляет собой облачное решение мониторинга, которое обеспечивает интеллектуальный Мониторинг баз данных, включая отчеты о производительности, предупреждения и рекомендации по устранению рисков. Потоки данных, переданные в рабочую область Log Analytics, можно анализировать с помощью собранных данных мониторинга, а также использовать другие функции Azure Monitor, такие как оповещения и визуализации.

### <a name="azure-event-hubs"></a>Центры событий Azure

Вы можете передавать метрики и журналы ресурсов в [концентраторы событий Azure](../azure-monitor/platform/resource-logs-stream-event-hubs.md). Потоковая передача данных диагностики в концентраторы событий для обеспечения следующих функциональных возможностей:

- **Потоковая передача журналов в сторонние системы ведения журналов и телеметрии**

  Выполните потоковую передачу всех метрик и журналов ресурсов в один концентратор событий, чтобы передать данные журнала в стороннее средство SIEM или log Analytics.
- **Создание пользовательской платформы телеметрии и ведения журналов**

  Высокая масштабируемость публикации и подписки концентраторов событий позволяет гибко принимать метрики и журналы ресурсов в настраиваемую платформу телеметрии. Дополнительные сведения см. в статье [Разработка и изменение размера платформы телеметрии глобальной шкалы в концентраторах событий Azure](https://azure.microsoft.com/documentation/videos/build-2015-designing-and-sizing-a-global-scale-telemetry-platform-on-azure-event-Hubs/) .
- **Просмотр работоспособности службы путем потоковой передачи данных в Power BI**

  Используйте концентраторы событий, Stream Analytics и Power BI для преобразования диагностических данных в практический анализ в режиме реального времени в службах Azure. Дополнительные сведения об этом решении см. в разделе [Stream Analytics и Power BI. панель мониторинга для потоковой передачи данных в режиме реального времени](https://docs.microsoft.com/azure/stream-analytics/stream-analytics-power-bi-dashboard) .

### <a name="azure-storage"></a>Хранилище Azure

Потоковые метрики и журналы ресурсов в [службе хранилища Azure](../azure-monitor/platform/resource-logs-collect-storage.md). Используйте службу хранилища Azure для архивации огромных объемов диагностических данных диагностики за долю стоимости предыдущих двух вариантов потоковой передачи.

## <a name="use-extended-events-in-the-sql-database-engine"></a>Использование расширенных событий в ядре СУБД SQL

Кроме того, можно использовать [Расширенные события](https://docs.microsoft.com/sql/relational-databases/extended-events/extended-events) в SQL для дополнительного мониторинга и устранения неполадок. Архитектура расширенных событий позволяет пользователям выполнять накопление как минимум данных, необходимых для устранения проблем с производительностью. Дополнительные сведения об использовании расширенных событий в базе данных SQL см. [в разделе Расширенные события в базе данных SQL](sql-database-xevent-db-diff-from-svr.md).

## <a name="next-steps"></a>Дальнейшие шаги

- Дополнительные сведения о интеллектуальных рекомендациях по производительности для одной и для баз данных в составе пула см. в статье [рекомендации по повышению производительности базы данных](sql-database-advisor.md).
- Дополнительные сведения о мониторинге производительности базы данных с помощью автоматической диагностики и анализа первопричин проблем с производительностью см. в статье [Intelligent Insights](sql-database-intelligent-insights.md).
'''''''''