---
title: Мониторинг и настройка производительности
description: Обзор возможностей и методологии настройки мониторинга и производительности в базе данных Azure S'L.
services: sql-database
ms.service: sql-database
ms.subservice: performance
ms.custom: ''
ms.devlang: ''
ms.topic: conceptual
author: jovanpop-msft
ms.author: jovanpop
ms.reviewer: jrasnick, carlrab
ms.date: 03/10/2020
ms.openlocfilehash: 837d88665c1fdffe902c9c478e5d6dc65a2e402a
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "79268734"
---
# <a name="monitoring-and-performance-tuning-in-azure-sql-database"></a>Мониторинг и настройка производительности в базе данных Azure S'L

Чтобы контролировать производительность базы данных в базе данных Azure S'L, начните с мониторинга ресурсов процессора и исправления, используемых рабочей нагрузкой, относительно уровня производительности базы данных, выбранной при выборе определенного уровня обслуживания и уровня производительности. Для достижения этой цели база данных Azure S'L исчисляет метрики ресурсов, которые можно просматривать на портале Azure или с помощью одного из этих инструментов управления S'L: [Azure Data Studio](https://docs.microsoft.com/sql/azure-data-studio/what-is) или [S'L Server Management Studio](https://docs.microsoft.com/sql/ssms/sql-server-management-studio-ssms) (SSMS).

Для отдельных и объединенных баз данных база данных Azure S'L Database предоставляет ряд советников по базам данных для предоставления интеллектуальных рекомендаций по настройке производительности и вариантов автоматической настройки для повышения производительности. Кроме того, в запросах Performance Insight показаны сведения о запросах, ответственных за использование наиболее компакт-процессоров и ит-ч для отдельных и объединенных баз данных.

База данных Azure S'L предоставляет дополнительные возможности мониторинга и настройки, поддерживаемые искусственным интеллектом, чтобы помочь вам в устранении неполадок и максимизации производительности баз данных и решений. Вы можете настроить [потоковое экспорт](sql-database-metrics-diag-logging.md) этих [интеллектуальных анализов](sql-database-intelligent-insights.md) и других журналов и метрик базы данных S'L в один из нескольких направлений для потребления и анализа, в частности с помощью [S'L Analytics](../azure-monitor/insights/azure-sql.md)). Azure S'L Analytics — это передовое решение для мониторинга производительности всех баз данных Azure S'L в масштабе и по нескольким подпискам в одном представлении. Список журналов и метрик, которые можно экспортировать, [см.](sql-database-metrics-diag-logging.md#diagnostic-telemetry-for-export-for-azure-sql-database)

Наконец, с помощью [серверного хранилища](https://docs.microsoft.com/sql/relational-databases/performance/monitoring-performance-by-using-the-query-store) и [динамических представлений управления (DMV)](https://docs.microsoft.com/sql/relational-databases/system-dynamic-management-views/system-dynamic-management-views)компания S'L имеет свои собственные возможности мониторинга и диагностики. Смотрите [мониторинг с помощью DMV](sql-database-monitoring-with-dmvs.md) для скриптов для мониторинга различных проблем производительности.

## <a name="monitoring-and-tuning-capabilities-in-the-azure-portal"></a>Возможности мониторинга и настройки на портале Azure

На портале Azure база данных Azure S'L обеспечивает мониторинг метрик ресурсов для всех типов развертывания. Дополнительные рекомендации по настройке запросов и объединенным базам данных, консультанты по базам данных и запросы обеспечивают настройку запросов и анализ производительности запросов. Наконец, на портале Azure можно включить автоматическое включение логических серверов и их единых и объединенных баз данных.

### <a name="sql-database-resource-monitoring"></a>Мониторинг ресурсов базы данных СЗЛ

Вы можете быстро отслеживать следующие метрики ресурсов на портале Azure в **представлении Метрики:**

- **Использование DTU**

  Проверьте, достигает ли база данных или эластичного пула 100 процентов использования DTU в течение длительного периода времени. Высокое использование DTU указывает на то, что рабочая нагрузка может потребовать сяпотго в ресурсах процессора или иосега. Это также может указывать на запросы, которые необходимо оптимизировать.
- **Использование процессора**

  Проверьте, достигает ли база данных, эластичного пула или управляемого экземпляра 100 процентов использования процессора в течение длительного периода времени. Высокий процессор указывает на то, что рабочей нагрузке может потребоваться больше ресурсов процессора или иоспу. Это также может указывать на запросы, которые необходимо оптимизировать.
- **Использование io**

  Проверьте, достигает ли база данных, эластичного пула или экземпляра управления пределы базового хранилища. Высокое использование итогового она означает, что рабочей нагрузке может потребоваться больше ресурсов процессора или иоспу. Это также может указывать на запросы, которые необходимо оптимизировать.

  ![Метрики ресурсов](./media/sql-database-monitor-tune-overview/resource-metrics.png)

### <a name="database-advisors"></a>Консультанты по базам данных
База данных Azure S'L содержит [советников по базам данных,](sql-database-advisor.md) которые предоставляют рекомендации по настройке производительности для отдельных и объединенных баз данных. Эти рекомендации доступны на портале Azure, а также с помощью [PowerShell](https://docs.microsoft.com/powershell/module/az.sql/get-azsqldatabaseadvisor). Вы также можете включить [автоматическую настройку,](sql-database-automatic-tuning.md) чтобы база данных S'L могла автоматически выполнять эти рекомендации по настройке.

### <a name="query-performance-insight"></a>Анализ производительности запросов

[Анализ производительности запросов](sql-database-query-performance.md) показывает производительность на портале Azure самых эффективных и длинных запросов для отдельных и объединенных баз данных.

## <a name="generate-intelligent-assessments-of-performance-issues"></a>Создание интеллектуальных оценок проблем производительности

База данных [«Интеллектуальные исследования»](sql-database-intelligent-insights.md) в Azure S'L использует встроенный интеллект для непрерывного мониторинга использования баз данных с помощью искусственного интеллекта и обнаружения разрушительных событий, которые приводят к низкой производительности. Интеллектуальные исследования автоматически выявляют проблемы с производительностью с базами данных в базе данных Azure S'L database на основе времени ожидания выполнения запроса, ошибок или тайм-аутов. После обнаружения проводится подробный анализ, который генерирует журнал ресурсов (так называемый S'LInsights) с [интеллектуальной оценкой проблем.](sql-database-intelligent-insights-troubleshoot-performance.md) Эта оценка состоит из анализа первопричин проблемы с производительностью базы данных и возможных рекомендаций по повышению производительности.

Intelligent Insights — уникальная функция встроенного аналитического механизма Azure, который предлагает следующие возможности:

- Упреждающий мониторинг
- специализированная аналитика производительности;
- заблаговременное выявление снижения производительности базы данных;
- анализ первопричин обнаруженных проблем;
- рекомендации по повышению производительности;
- возможность развертывания сотен тысяч баз данных;
- положительное влияние на ресурсы DevOps и совокупную стоимость владения.

## <a name="enable-the-streaming-export-of-metrics-and-resource-logs"></a>Включить потоковое экспорт метрик и журналов ресурсов

Вы можете включить и настроить [потоковое экспорт диагностической телеметрии](sql-database-metrics-diag-logging.md) в один из нескольких направлений, включая журнал ресурсов Intelligent Insights. Используйте [аналитику s'L](../azure-monitor/insights/azure-sql.md) и другие возможности для использования этой дополнительной диагностической телеметрии для выявления и устранения проблем с производительностью.

Вы настраиваете диагностические настройки на потоки категорий метрик и журналов ресурсов для отдельных баз данных, объединенных баз данных, эластичных пулов, управляемых экземпляров и баз данных экземпляров в один из следующих ресурсов Azure.

### <a name="log-analytics-workspace-in-azure-monitor"></a>Рабочее пространство журналов Analytics в мониторе Azure

Вы можете передавать метрики и журналы ресурсов [в рабочее пространство анализа журналов в Azure Monitor.](../azure-monitor/platform/resource-logs-collect-workspace.md) Данные, перевозимые здесь, могут быть использованы с помощью [s'L Analytics,](../azure-monitor/insights/azure-sql.md)которая является только облачным решением для мониторинга, которое обеспечивает интеллектуальный мониторинг баз данных, включающий отчеты о производительности, оповещения и рекомендации по смягчению последствий. Данные, перетекаемые в рабочее пространство Log Analytics, можно анализировать с помощью других собранных данных мониторинга, а также позволяют использовать другие функции Azure Monitor, такие как оповещения и визуализации.

### <a name="azure-event-hubs"></a>Центры событий Azure

Вы можете передавать метрики и журналы ресурсов в [концентраторы событий Azure.](../azure-monitor/platform/resource-logs-stream-event-hubs.md) Потоковая диагностическая телеметрия в концентраторы событий для обеспечения следующей функциональности:

- **Поток журналов к третьей стороны лесозаготовки и телеметрии систем**

  Стричь все метрики и журналы ресурсов в единый концентратор событий, чтобы войти в систему труб на сторонний инструмент SIEM или журнал аналитики.
- **Создание пользовательской телеметрии и платформы для ведения журнала**

  Высоко масштабируемый характер событийных концентраторов позволяет гибко глотать метрики и журналы ресурсов в пользовательскую телеметрическую платформу. Подробнее о [проектировании и подчете платформы телеметрии глобального масштаба можно узнать на концентрах Azure Event.](https://azure.microsoft.com/documentation/videos/build-2015-designing-and-sizing-a-global-scale-telemetry-platform-on-azure-event-Hubs/)
- **Просмотр работоспособности службы, перенаправив данные в Power BI**

  Используйте концентраторы событий, stream Analytics и Power BI для преобразования диагностических данных в практически в режиме реального времени, чтобы получить информацию о службах Azure. [См. Stream Analytics и Power BI: Панель мониторинга аналитики в режиме реального времени для потоковой передачи данных](https://docs.microsoft.com/azure/stream-analytics/stream-analytics-power-bi-dashboard) для получения подробной информации об этом решении.

### <a name="azure-storage"></a>Хранилище Azure

Поток метрик и журналов ресурсов в [Хранилище Azure.](../azure-monitor/platform/resource-logs-collect-storage.md) Используйте хранилище Azure для архивирования огромного количества диагностической телеметрии за долю от стоимости двух предыдущих вариантов потоковой передачи.

## <a name="use-extended-events-in-the-sql-database-engine"></a>Используйте расширенные события в движке базы данных S'L

Кроме того, можно использовать [расширенные события](https://docs.microsoft.com/sql/relational-databases/extended-events/extended-events) в S'L для дополнительного расширенного мониторинга и устранения неполадок. Расширенная архитектура событий позволяет пользователям собирать столько или меньше данных, необходимых для устранения неполадок или выявления проблемы с производительностью. Для получения информации об использовании расширенных событий в базе данных S'L можно ознакомиться на [расширенных событиях в базе данных S'L.](sql-database-xevent-db-diff-from-svr.md)

## <a name="next-steps"></a>Дальнейшие действия

- Для получения дополнительной информации об интеллектуальных рекомендациях по производительности для отдельных и объединенных баз данных [см.](sql-database-advisor.md)
- Дополнительные сведения о мониторинге производительности базы данных с помощью автоматической диагностики и анализа первопричин проблем с производительностью см. в статье [Intelligent Insights](sql-database-intelligent-insights.md).
'''''''''