---
title: Модели приобретения для базы данных SQL Azure | Документы Майкрософт
description: Сведения о моделях приобретения, доступных для баз данных в службе "База данных SQL Azure".
services: sql-database
ms.service: sql-database
ms.subservice: service
ms.custom: ''
ms.devlang: ''
ms.topic: conceptual
author: stevestein
ms.author: sstein
ms.reviewer: carlrab
manager: craigg
ms.date: 04/26/2019
ms.openlocfilehash: 89ff11246c7cd36732df1332da94ec5318d7f1d7
ms.sourcegitcommit: 44a85a2ed288f484cc3cdf71d9b51bc0be64cc33
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "64574094"
---
# <a name="choose-between-the-vcore-and-the-dtu-purchasing-model"></a>Выбор между виртуальных ядер и модель приобретения DTU

База данных SQL Azure позволяет легко приобрести полностью управляемое ядро СУБД PaaS, которое соответствует потребностям производительности и стоимости. В зависимости от модели развертывания базы данных SQL Azure можно выбрать модель приобретения, которая соответствует вашим потребностям:

В моделях развертываний Базы данных SQL Azure доступны различные модели приобретения.

- Для [отдельных баз данных](sql-database-single-databases-manage.md) и [эластичных пулов](sql-database-elastic-pool.md) в [Базе данных SQL Azure](sql-database-technical-overview.md) предусмотрены две модели приобретения: [на основе единиц DTU](sql-database-service-tiers-dtu.md) и [на основе виртуальных ядер](sql-database-service-tiers-vcore.md).
- Вариант развертывания в виде [управляемого экземпляра](sql-database-managed-instance.md) в Базе данных SQL Azure предлагает только [модель приобретения на основе виртуальных ядер](sql-database-service-tiers-vcore.md).


Следующие таблицы и диаграммы сравнения и сравните виртуальных ядер и DTU, приобретение моделей.

|**Модель приобретения**|**Описание**|**Оптимально для**|
|---|---|---|
|Модель приобретения на основе единиц DTU|Эта модель основана на комплексной оценке вычислительных ресурсов, ресурсов хранилища и ресурсов для операций ввода-вывода. Объем вычислительных ресурсов выражается в единицах транзакций базы данных (DTU) для отдельных баз данных, а для эластичных пулов — в единицах транзакций эластичной базы данных (eDTU). См. дополнительные сведения о [единицах DTU и eDTU](sql-database-purchase-models.md#dtu-based-purchasing-model).|Для клиентов, которым нужны простые, предварительно настроенные варианты ресурсов.|
|Модель приобретения на основе виртуальных ядер|Эта модель позволяет независимо выбрать ресурсы вычисления и хранилища. Модель приобретения на основе виртуального ядра также позволяет применять [Преимущество гибридного использования Azure для SQL Server](https://azure.microsoft.com/pricing/hybrid-benefit/), чтобы добиться снижения затрат.|Для клиентов, которые ценят гибкость, контроль и прозрачность.|
||||  

![модель ценообразования](./media/sql-database-service-tiers/pricing-model.png)

## <a name="compute-costs"></a>Затраты на вычислительные ресурсы

### <a name="provisioned-compute-costs"></a>Затраты на подготовленных вычислительных ресурсов

На уровне подготовленных вычислительных ресурсов стоимость ресурсов вычисления отражает общую вычислительную мощность, которая подготавливается для приложения.  Для уровня служб "Критически важный для бизнеса" автоматически выделяется как минимум 3 реплики. Чтобы отразить это дополнительное распределение вычислительных ресурсов, цена в модели приобретения на основе виртуальных ядер примерно в 2,7 раза выше для уровня служб "Критически важный для бизнеса", чем для уровня служб общего назначения. По той же причине более высокая стоимость хранения за ГБ для уровня служб "Критически важный для бизнеса" отражает высокую производительность операций ввода-вывода и низкую задержку SSD-хранилища. В то же время стоимость хранилища резервных копий не отличается, так как в обоих уровнях служб используется хранилище ценовой категории "Стандартный".


## <a name="storage-costs"></a>Затраты на хранение

Модель выставления счетов зависит от типа хранилища. Для хранилища данных плата будет взиматься за подготовленное хранилище на основе выбранного максимального размера пула или базы данных. Стоимость изменится, если вы увеличите или уменьшите это максимальное значение. Хранилище резервных копий связано с автоматическими резервными копиями экземпляра и выделяется автоматически. Увеличение периода хранения резервных копий соответственно увеличивает объем хранилища резервных копий, используемого вашим экземпляром.

Резервные копии баз данных, автоматически созданные за последние 7 дней, по умолчанию копируются в хранилище BLOB-объектов RA-GRS ценовой категории "Стандартный". Хранилище используется для полных резервных копий, созданных за неделю, разностных резервных копий, созданных за день, и резервных копий журналов транзакций, копируемых каждые 5 минут. Размер журнала транзакций зависит от скорости изменения базы данных. Минимальный объем хранилища, соответствующий полному размеру базы данных, предоставляется без дополнительной оплаты. Плата за дополнительное пространство хранилища резервных копий будет взиматься за количество ГБ в месяц.

Дополнительные сведения о ценах на службу хранилища см. на странице [Обзор цен на хранилище Azure](https://azure.microsoft.com/pricing/details/sql-database/single/).

## <a name="vcore-based-purchasing-model"></a>Модель покупки на основе числа виртуальных ядер

Виртуальное ядро — это логический ЦП с возможностью выбора поколения аппаратного обеспечения и физических характеристик оборудования (например, количество ядер, памяти и размер хранилища). Модель приобретения на основе виртуальных ядер обеспечивает гибкость, контроль и прозрачность потребления отдельных ресурсов. Это эффективный способ удовлетворить свои требования к локальной рабочей нагрузке в облаке. Эта модель позволяет выбрать вычисление, память и хранилище с учетом потребностей рабочих нагрузок. В модели приобретения на основе виртуальных ядер можно выбирать между уровнями служб [Общего назначения](sql-database-high-availability.md#basic-standard-and-general-purpose-service-tier-availability) и [Критически важный для бизнеса](sql-database-high-availability.md#premium-and-business-critical-service-tier-availability) для [отдельных баз данных](sql-database-single-database-scale.md), [эластичных пулов](sql-database-elastic-pool.md) и [управляемых экземпляров](sql-database-managed-instance.md). Для отдельных баз данных можно также выбрать уровень служб [Гипермасштабирование (предварительная версия)](sql-database-service-tier-hyperscale.md).

Модель приобретения на основе виртуальных ядер позволяет независимо выбрать вычислительные ресурсы и ресурсы хранилища, обеспечивать производительность на уровне локальной среды и оптимизировать затраты. В модели приобретения на основе виртуальных ядер клиенты оплачивают:

- вычислительные ресурсы (уровень служб + количество виртуальных ядер и объем памяти + поколение программного обеспечения);
- тип и объем хранилища данных и журналов;
- хранилище резервных копий (геоизбыточное хранилище с доступом на чтение (RA-GRS)).

> [!IMPORTANT]
> Плата за вычислительные ресурсы, операции ввода-вывода, хранилища данных и журналов взимается для каждой базы данных или эластичного пула. Плата за хранилище резервных копий взимается для каждой базы данных. Дополнительные сведения о затратах на управляемый экземпляр см. в [этой статье](sql-database-managed-instance.md).
> **Ограничения по регионам:** Текущий список поддерживаемых регионов см. на странице [Доступность продуктов по регионам](https://azure.microsoft.com/global-infrastructure/services/?products=sql-database&regions=all). Если вы хотите создать Управляемый экземпляр в регионе, который в настоящее время не поддерживается, вы можете [отправить запрос на поддержку через портал Azure](sql-database-managed-instance-resource-limits.md#obtaining-a-larger-quota-for-sql-managed-instance).
.

Если ваша отдельная база данных или эластичный пул потребляет более 300 единиц DTU, переход на модель преобразования на основе виртуальных ядер может снизить ваши затраты. Если вы решили остановить свой выбор на преобразовании, можете перейти с помощью API или портала Azure без простоя. Однако преобразование не является обязательным и не выполняется автоматически. Если модель приобретения на основе единиц DTU соответствует вашим требованиям к производительности и бизнес-требованиям, продолжайте использовать ее. Если вы решите перейти с модели приобретения на основе единиц DTU на модель приобретения на основе виртуальных ядер, выберите объем вычислительных ресурсов, используя следующие правила бегунка.

- Для каждых 100 единиц DTU уровня служб "Стандартный" требуется как минимум 1 виртуальное ядро уровня общего назначения
- Для каждых 125 единиц DTU уровня "Премиум" требуется по крайней мере 1 виртуальное ядро уровня "Критически важный для бизнеса"

## <a name="dtu-based-purchasing-model"></a>Модель приобретения на основе единиц DTU

Единица транзакций базы данных (DTU) предоставляет объединенный показатель мощности ЦП, памяти, операций чтения и записи. Модель приобретения на основе единиц DTU предлагает ряд предварительно настроенных пакетов вычислительных ресурсов и включенный объем хранилища для обеспечения различных уровней производительности приложения. Эта модель подходит клиентам, которые предпочитают простоту предварительно настроенного пакета и фиксированные платежи каждый месяц. При использовании модели приобретения на основе единиц DTU клиенты могут выбрать между разными уровнями служб (**Базовый**, **Стандартный** и **Премиум**) для [отдельных баз данных](sql-database-single-database-scale.md) и [эластичных пулов](sql-database-elastic-pool.md). Эта модель покупки недоступна в [управляемых экземплярах](sql-database-managed-instance.md).

### <a name="database-transaction-units-dtus"></a>Единицы транзакций базы данных (DTU)

Для отдельной базы данных с определенным объемом вычислительных ресурсов на [уровне служб](sql-database-single-database-scale.md) Майкрософт гарантирует определенный уровень ресурсов (независимо от любой другой базы данных в облаке Azure) и обеспечивает предсказуемый уровень производительности. Объем ресурсов рассчитывается как количество единиц передачи данных или DTU и является комплексной оценкой вычислительных ресурсов, ресурсов хранилища и ресурсов ввода-вывода. Коэффициент этих ресурсов первоначально определялся по [тестовой рабочей нагрузке OLTP](sql-database-benchmark-overview.md), отражающей фактические рабочие нагрузки OLTP. Если рабочая нагрузка превышает объем любого из этих ресурсов, пропускная способность регулируется, что приводит к снижению производительности и простоям. Ресурсы, используемые вашей рабочей нагрузкой, не влияют на ресурсы, доступные для других баз данных SQL в облаке Azure, а ресурсы, используемые другими рабочими нагрузками, не влияют на ресурсы, доступные вашей базе данных SQL.

![ограничивающая рамка](./media/sql-database-what-is-a-dtu/bounding-box.png)

DTU лучше всего помогают определить относительный объем ресурсов баз данных SQL Azure с разными объемами вычислительных ресурсов и уровнями служб. Например, повысить объем вычислительных ресурсов базы данных (через удвоение DTU) означает удвоить количество ресурсов, доступных для этой базы данных. Например, база данных P11 уровня "Премиум" с 1750 единицами DTU обеспечивает в 350 раз больше вычислительной мощи, чем база данных уровня "Базовый" с 5 единицами DTU.  

Чтобы узнать, как потребляются ресурсы (DTU) в вашей рабочей нагрузке, используйте [анализ производительности запросов](sql-database-query-performance.md), чтобы:

- Выявлять запросы, максимально использующие ресурсы процессора, имеющие максимальную длительность или число выполнений, которые потенциально можно настроить, чтобы повысить производительность. Например, запрос на большое число операций ввода-вывода может выполняться быстрее за счет [методов оптимизации в памяти](sql-database-in-memory.md). Так вы сможете оптимизировать использование доступной памяти на определенном уровне служб и при определенном объеме вычислительных ресурсов.
- Перейти к подробным сведениям о запросе, просмотреть его текст и журнал использования ресурсов.
- Получать доступ к рекомендациям по настройке производительности, отображающим действия [Помощника по базам данных SQL](sql-database-advisor.md).

### <a name="elastic-database-transaction-units-edtus"></a>Единицы транзакций эластичной базы данных (eDTU)

Вместо выделения определенного набора ресурсов (DTU) базе данных SQL, доступных вне зависимости от того, нужны они или нет, вы можете поместить базы данных в [эластичный пул](sql-database-elastic-pool.md) на сервере Базы данных SQL, который распределяет пул ресурсов между этими базами данных. Общие ресурсы в эластичном пуле измеряются в эластичных единицах передачи данных или eDTU. Пулы эластичных баз данных обеспечивают простое и экономически выгодное решение для управления целевыми показателями производительности для нескольких баз данных с совершенно разными и непредсказуемыми моделями функционирования. Пул эластичных баз данных гарантирует, что ни одна из баз данных в пуле не использует все ресурсы и что каждой из них всегда доступен минимальный необходимый объем ресурсов.

Пулу предоставляется заданное количество единиц eDTU по фиксированной цене. Отдельным базам данных в пуле эластичных баз данных предоставляется возможность гибкого автоматического масштабирования в рамках заданных границ. Базы данных, на которые приходится значительная нагрузка, могут потреблять больше eDTU, чтобы обслужить имеющийся спрос. Базы данных с меньшей нагрузкой будут потреблять меньше eDTU. Базы данных без нагрузки не будут потреблять eDTU. Благодаря подготовке ресурсов для всего пула, а не одной базы данных, задачи управления упрощаются и вы можете спрогнозировать затраты на пул.

Добавить дополнительные единицы eDTU в имеющийся пул можно без простоя баз данных в пуле или снижения их производительности. Точно так же, если eDTU больше не нужны, их можно удалить из имеющегося пула в любой момент времени. Вы можете добавить базы данных в пул или удалить их либо ограничить количество eDTU, которые базы данных могут использовать в условиях интенсивной нагрузки, чтобы сохранить eDTU для остальных баз данных. Если у базы данных прогнозируемо низкие показатели использования ресурсов, ее можно переместить из пула и настроить в качестве отдельной базы данных с прогнозируемым объемом требуемых ресурсов.

### <a name="determine-the-number-of-dtus-needed-by-a-workload"></a>Определение числа единиц DTU, требуемых для рабочей нагрузки

Если нужно перенести существующую локальную рабочую нагрузку или нагрузку виртуальной машины SQL Server в Базу данных SQL Azure, вы можете приблизительно вычислить нужное количество единиц DTU с помощью [калькулятора DTU](https://dtucalculator.azurewebsites.net/). Чтобы узнать, как потребляются ресурсы (DTU) в существующей рабочей нагрузке Базы данных SQL Azure, и понять, как оптимизировать эту нагрузку, вы можете использовать [анализ производительности запросов](sql-database-query-performance.md). Кроме того, с помощью динамического административного представления [sys.dm_db_ resource_stats](https://msdn.microsoft.com/library/dn800981.aspx) можно просмотреть сведения об использовании ресурсов за последний час. Представление каталога [sys.resource_stats](https://msdn.microsoft.com/library/dn269979.aspx) содержит эти же сведения, но только за последние 14 дней, причем с менее точными средними значениями за пять минут.

### <a name="workloads-that-benefit-from-an-elastic-pool-of-resources"></a>Рабочие нагрузки, для которых эффективно используется эластичный пул ресурсов

Пулы подходят для большого числа баз данных с конкретными закономерностями использования. Для заданной базы данных эта закономерность характеризуется низким средним использованием с относительно редкими пиками использования. База данных SQL автоматически оценивает историю использования ресурсов баз данных на существующем сервере Базы данных SQL и рекомендует подходящую конфигурацию пула в портале Azure. Дополнительные сведения см. в статье [Когда следует использовать пул эластичных баз данных?](sql-database-elastic-pool.md)

## <a name="purchase-models-frequently-asked-questions-faq"></a>Приобрести моделей: часто задаваемые вопросы (FAQ)

### <a name="do-i-need-to-take-my-application-offline-to-convert-from-a-dtu-based-database-to-a-vcore-based-service-tier"></a>Нужно ли отключать приложение для перехода с базы данных на основе DTU на уровень служб на основе виртуальных ядер?

Новые уровни служб предлагают простой автоматический метод преобразования, который аналогичен имеющемуся процессу обновления баз данных с уровня служб "Стандартный" на "Премиум" и наоборот. Это преобразование можно инициировать с помощью портала Azure, PowerShell, Azure CLI, T-SQL или REST API. Ознакомьтесь со статьями [Управление ресурсами отдельной базы данных в Базе данных SQL Azure](sql-database-single-database-scale.md) и [Управление несколькими базами данных SQL Azure и их масштабирование с помощью эластичных пулов](sql-database-elastic-pool.md).

### <a name="can-i-convert-a-database-from-a-service-tier-using-the-vcore-based-purchase-to-a-service-tier-using-the-dtu-based-purchasing-model"></a>Могу ли я преобразовать базу данных из уровня служб с помощью приобретения на основе виртуальных ядер в уровень с использованием модели приобретения на основе единиц DTU

Да, вы можете легко перевести базу данных на любой поддерживаемый уровень производительности с помощью портала Azure, PowerShell, Azure CLI, T-SQL или REST API. См. статьи [Масштабирование ресурсов отдельной базы данных в Базе данных SQL Azure](sql-database-single-database-scale.md) и [Управление несколькими базами данных SQL Azure и их масштабирование с помощью эластичных пулов](sql-database-elastic-pool.md).

## <a name="next-steps"></a>Дальнейшие действия

- Узнайте больше о [модели приобретения на основе виртуальных ядер](sql-database-service-tiers-vcore.md).
- Узнайте больше о [модели приобретения на основе единиц DTU](sql-database-service-tiers-dtu.md).
