---
title: Модели приобретения
description: Узнайте о моделях закупок, доступных для базы данных Azure S'L.
services: sql-database
ms.service: sql-database
ms.subservice: service
ms.custom: ''
ms.devlang: ''
ms.topic: conceptual
author: stevestein
ms.author: sstein
ms.reviewer: carlrab
ms.date: 03/09/2020
ms.openlocfilehash: 97ce402045cfd2c990b457c5d4d06888cda632d5
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "79255994"
---
# <a name="choose-between-the-vcore-and-the-dtu-purchasing-models"></a>Выберите между vCore и DTU покупке моделей

База данных Azure S'L позволяет легко приобрести полностью управляемую платформу в качестве движка базы данных service (PaaS), который соответствует вашим потребностям в производительности и затратах. В зависимости от выбранной модели развертывания для базы данных Azure S'L можно выбрать модель покупки, которая работает для вас:

- [Виртуальная модель закупок на основе ядра (vCore)](sql-database-service-tiers-vcore.md) (рекомендуется). Эта модель покупки обеспечивает выбор между подготовленным уровнем вычислений и безсерверным уровнем вычислений. С помощью заданного вычислительного уровня вы выбираете точное количество вычислительных ресурсов, которые всегда подготовлены для рабочей нагрузки. С уровнем без серверов вычисляет автоматическое масштабирование вычислительных ресурсов по перенастраиваемому диапазону вычислений. С помощью этого вычислительного уровня можно автоматически приостановить и возобновить базу данных на основе действия рабочей нагрузки. Цена единицы vCore за единицу времени ниже в уровне предусмотренных вычислений, чем в безсерверном уровне вычислений.
- [База данных транзакционной единицы (DTU) на основе модели покупки](sql-database-service-tiers-dtu.md). Эта модель закупок обеспечивает пакеты вычислений и хранения данных, сбалансированные для общих рабочих нагрузок.

Различные модели закупок доступны для различных моделей развертывания базы данных Azure S'L:

- Для [отдельных баз данных](sql-database-single-databases-manage.md) и [эластичных пулов](sql-database-elastic-pool.md) в [Базе данных SQL Azure](sql-database-technical-overview.md) предусмотрены две модели приобретения: на основе [единиц DTU](sql-database-service-tiers-dtu.md) и [виртуальных ядер](sql-database-service-tiers-vcore.md).
- Опция [развертывания управляемых экземпляров](sql-database-managed-instance.md) в базе данных Azure S'L database предлагает только [модель покупки на основе vCore.](sql-database-service-tiers-vcore.md)
- [Уровень обслуживания Hyperscale](sql-database-service-tier-hyperscale.md) доступен для отдельных баз данных, использующих [модель покупки на основе vCore.](sql-database-service-tiers-vcore.md)

Следующая таблица и диаграмма сравнить и противопоставить vCore основе и DTU основе покупки моделей:

|**Модель приобретения**|**Описание**|**Оптимально для**|
|---|---|---|
|Модель приобретения на основе единиц DTU|Эта модель основана на комплекте показателей вычислений, хранения и ввоза и ввоза ресурсов. Размеры вычислений выражаются в DТУ для отдельных баз данных и в упругих единицах транзакций баз данных (eDTUs) для эластичных пулов. Для получения дополнительной информации о DTUs и eDTUs, [см.](sql-database-purchase-models.md#dtu-based-purchasing-model)|Лучше всего подходит для клиентов, которые хотят простые, заранее настроенные варианты ресурсов.|
|Модель приобретения на основе виртуальных ядер|Эта модель позволяет независимо выбрать ресурсы вычисления и хранилища. Модель приобретения на основе виртуальных ядер также позволяет применять [Преимущество гибридного использования Azure для SQL Server](https://azure.microsoft.com/pricing/hybrid-benefit/), чтобы добиться снижения затрат.|Для клиентов, которые ценят гибкость, контроль и прозрачность.|
||||  

![сравнение модели ценообразования](./media/sql-database-service-tiers/pricing-model.png)

## <a name="compute-costs"></a>Затраты на вычислительные ресурсы

### <a name="provisioned-compute-costs"></a>Предусмотренные затраты на вычисления

На уровне подготовленных вычислений вычислительная стоимость отражает общую вычислительную мощность, подготовленную для приложения.

Для уровня служб "Критически важный для бизнеса" автоматически выделяется как минимум 3 реплики. Чтобы отразить это дополнительное распределение вычислительных ресурсов, цена в модели закупок на основе vCore примерно в 2,7 раз выше в бизнес-критической службе, чем в уровне общего назначения службы. Аналогичным образом, более высокая цена хранения за ГБ в уровне обслуживания Business Critical отражает более высокие лимиты io и более низкую задержку хранилища SSD.

Стоимость резервного хранилища одинакова для уровня службы Business Critical и уровня общего назначения, поскольку оба уровня используют стандартное хранилище для резервного копирования.

### <a name="serverless-compute-costs"></a>Затраты на вычисления без серверов

Для описания того, как определяется вычислительная мощность и рассчитаны затраты на уровень без серверов, [см.](sql-database-serverless.md)

## <a name="storage-costs"></a>Затраты на хранение

Модель выставления счетов зависит от типа хранилища. При хранении данных взимается плата за подготовленное хранилище на основе выбранного вами максимального размера базы данных или пула. Стоимость не изменится, если вы не уменьшите или не увеличите этот максимум. Хранилище резервных копий связано с автоматическими резервными копиями экземпляра и выделяется автоматически. Увеличение периода резервного копирования увеличивает резервное хранилище, потребляемые экземпляром.

По умолчанию 7 дней автоматизированного резервного копирования баз данных копируются на стандартную учетную запись хранения данных Blob. Это хранилище используется еженедельными полными резервными копиями, ежедневными резервными копиями дифференциала и резервными копиями журналов транзакций, которые копируются каждые 5 минут. Размер журналов транзакций зависит от скорости изменения базы данных. Минимальная сумма хранения, равная 100 процентам от размера базы данных, предоставляется без дополнительной платы. Плата за дополнительное пространство хранилища резервных копий будет взиматься с расчетом ГБ в месяц.

Дополнительные сведения о ценах на службу хранилища см. на странице [Обзор цен на хранилище Azure](https://azure.microsoft.com/pricing/details/sql-database/single/).

## <a name="vcore-based-purchasing-model"></a>Модель приобретения на основе виртуальных ядер

Виртуальное ядро (vCore) представляет собой логический процессор и предлагает вам возможность выбора между поколениями оборудования и физических характеристик оборудования (например, количество ядер, память и размер хранилища). Модель покупки на основе vCore обеспечивает гибкость, контроль, прозрачность индивидуального потребления ресурсов и простой способ перевода требований к рабочей нагрузке в облаке. Эта модель позволяет выбирать ресурсы вычислений, памяти и хранения данных в зависимости от потребностей рабочей нагрузки.

В модели покупки на основе vCore вы можете выбрать между уровнями общего [назначения](sql-database-high-availability.md#basic-standard-and-general-purpose-service-tier-availability) и [бизнес-критическими](sql-database-high-availability.md#premium-and-business-critical-service-tier-availability) уровнями обслуживания для [отдельных баз данных,](sql-database-single-database-scale.md) [эластичных пулов](sql-database-elastic-pool.md)и [управляемых экземпляров.](sql-database-managed-instance.md) Для отдельных баз данных можно также выбрать [уровень обслуживания Hyperscale.](sql-database-service-tier-hyperscale.md)

Модель покупки на основе vCore позволяет самостоятельно выбирать ресурсы для вычислений и хранения данных, соответствовать производительности на местах и оптимизировать цену. В модели покупки на основе vCore вы платите за:

- Вычислите ресурсы (уровень обслуживания - количество vCores и количество памяти - генерация аппаратного обеспечения).
- Тип и объем данных и хранилище журналов.
- Резервное хранение (RA-GRS).

> [!IMPORTANT]
> Вычислить ресурсы, ввкий/чаты, а также хранение данных и журналов взимается за базу данных или эластичный пул. Резервное хранилище взимается за каждую базу данных. Дополнительные сведения о затратах на управляемый экземпляр см. в [этой статье](sql-database-managed-instance.md).
> **Ограничения по регионам:** Для текущего списка поддерживаемых [products available by region](https://azure.microsoft.com/global-infrastructure/services/?products=sql-database&regions=all)регионов см. Чтобы создать управляемый экземпляр в регионе, который в настоящее время не поддерживается, [отправьте запрос поддержки через портал Azure.](quota-increase-request.md)

Если в одной базе данных или эластичной пуле потребляется более 300 DTUs, переход на модель покупки на основе vCore может снизить ваши затраты. Преобразование можно с помощью API по выбору или с помощью портала Azure без простоев. Однако конверсия не требуется и не выполняется автоматически. Если модель приобретения на основе единиц DTU соответствует вашим требованиям к производительности и бизнес-требованиям, продолжайте использовать ее.

Чтобы преобразовать из модели закупок на основе DTU в модель покупки на основе vCore, выберите размер вычисления, используя следующие правила большого пальца:

- Каждые 100 DTUs в стандартном уровне требуют по крайней мере 1 vCore в уровне общего назначения службы.
- Каждые 125 DTUs в премиум-уровне требуют по крайней мере 1 vCore в бизнес-критического уровня обслуживания.

> [!NOTE]
> Руководящие принципы DTU для vCore по размеру являются приблизительными и предоставляются для оказания помощи в первоначальной оценке целевой цели обслуживания баз данных. Оптимальная конфигурация целевой базы данных зависит от рабочей нагрузки. 
> 
> Достижение оптимального соотношения цены и производительности может потребовать использования гибкости модели vCore для корректировки количества vCores, [генерации оборудования,](sql-database-service-tiers-vcore.md#hardware-generations) [уровня обслуживания](sql-database-service-tiers-vcore.md#service-tiers) и [вычислений,](sql-database-service-tiers-vcore.md#compute-tiers) а также настройки других параметров конфигурации базы данных, таких как [максимальная степень параллелизма.](https://docs.microsoft.com/sql/relational-databases/query-processing-architecture-guide#parallel-query-processing)

## <a name="dtu-based-purchasing-model"></a>Модель приобретения на основе единиц DTU

Блок транзакций базы данных (DTU) представляет собой смешанную меру процессора, памяти, считывания и записи. Модель приобретения на основе единиц DTU предлагает ряд предварительно настроенных пакетов вычислительных ресурсов и включенный объем хранилища для обеспечения различных уровней производительности приложений. Если вы предпочитаете простоту предварительно настроенного пакета и фиксированных платежей каждый месяц, модель на основе DTU может быть более подходящей для ваших нужд.

В модели закупок на основе DTU вы можете выбрать между базовым, стандартным и премиальным уровнем обслуживания как для [отдельных баз данных,](sql-database-single-database-scale.md) так и для [эластичных пулов.](sql-database-elastic-pool.md) Модель покупки на основе DTU недоступна для [управляемых экземпляров.](sql-database-managed-instance.md)

### <a name="database-transaction-units-dtus"></a>Единицы транзакций базы данных (DTU)

Для одной базы данных на определенном уровне вычислений в [уровне обслуживания](sql-database-single-database-scale.md)корпорация Майкрософт гарантирует определенный уровень ресурсов для этой базы данных (независимо от любой другой базы данных в облаке Azure). Эта гарантия обеспечивает предсказуемый уровень производительности. Объем ресурсов, выделяемых для базы данных, рассчитывается как количество DТУ и представляет собой комплексную меру вычислений, хранения и ресурсов ввоза/ввоза.

Соотношение между этими ресурсами первоначально определяется [контрольной рабочей нагрузкой онлайн-обработки транзакций (OLTP),](sql-database-benchmark-overview.md) разработанной для типичных для реальных рабочих нагрузок OLTP. Когда рабочая нагрузка превышает объем любого из этих ресурсов, пропускная способность задушена, что приводит к снижению производительности и тайм-аутов.

Ресурсы, используемые рабочей нагрузкой, не влияют на ресурсы, доступные для других баз данных S'L в облаке Azure. Аналогичным образом, ресурсы, используемые другими рабочими нагрузками, не влияют на ресурсы, доступные для вашей базы данных S'L.

![ограничивающая рамка](./media/sql-database-what-is-a-dtu/bounding-box.png)

DТУ наиболее полезны для понимания относительных ресурсов, которые выделяются для баз данных Azure S'L на различных вычислительных уровнях и уровнях обслуживания. Пример:

- Удвоение DTUs за счет увеличения вычислительного размера базы данных приравнивается к удвоению набора ресурсов, доступных для этой базы данных.
- База данных премиум-уровня P11 с 1750 DTU обеспечивает в 350 раз больше вычислительной мощности DTU, чем базовая база данных уровня обслуживания с 5 DTU.  

Чтобы получить более глубокое представление о потреблении ресурсов (DTU) рабочей нагрузки, используйте [информацию о производительности запроса,](sql-database-query-performance.md) чтобы:

- Определите верхние запросы по количеству процессоров/продолжительности/выполнению, которые потенциально могут быть настроены на повышение производительности. Например, ввод/о-интенсивный запрос может быть отдохнут от [методов оптимизации памяти,](sql-database-in-memory.md) чтобы лучше использовать доступную память на определенном уровне обслуживания и вычислить размер.
- Просчитайте детали запроса, чтобы просмотреть его текст и историю использования ресурсов.
- Доступ к рекомендациям по настройке производительности, которые показывают действия, предпринятые [советником по базам данных S'L.](sql-database-advisor.md)

### <a name="elastic-database-transaction-units-edtus"></a>Упругие единицы транзакций баз данных (eDTUs)

Для баз данных, которые всегда доступны, вместо того, чтобы предоставлять специальный набор ресурсов (DTUs), которые не всегда могут быть необходимы, вы можете поместить эти базы данных в [эластичный пул.](sql-database-elastic-pool.md) Базы данных в эластичной пуле находятся на одном сервере базы данных Azure s'L database и имеют общий запас ресурсов.

Общие ресурсы в эластичной пуле измеряются эластичными единицами транзакций баз данных (eDTUs). Упругие пулы обеспечивают простое и экономичное решение для управления целями производительности для нескольких баз данных, которые имеют широко меняющиеся и непредсказуемые шаблоны использования. Упругий пул гарантирует, что все ресурсы не могут быть использованы одной базой данных в пуле, обеспечивая при этом, что каждая база данных в пуле всегда имеет минимальное количество необходимых ресурсов.

Пулу предоставляется заданное количество единиц eDTU по фиксированной цене. В эластичном пуле отдельные базы данных могут автоматически масштабироваться в пределах настроенных границ. База данных под более тяжелой нагрузкой будет потреблять больше eDTUs для удовлетворения спроса. Базы данных при более легких нагрузках будут потреблять меньше eDTUs. Базы данных без нагрузки не будут потреблять eDTU. Поскольку ресурсы предоставляются для всего пула, а не для базы данных, эластичные пулы упрощают задачи управления и обеспечивают предсказуемый бюджет пула.

Вы можете добавить дополнительные eDTUs в существующий пул без простоя базы данных и без влияния на базы данных в пуле. Аналогичным образом, если вам больше не нужны дополнительные eDTUs, удалите их из существующего пула в любое время. Вы также можете добавить базы данных или вычесть базы данных из пула в любое время. Чтобы зарезервировать eDTUs для других баз данных, ограничьте количество eDTUs, которые база данных может использовать при большой нагрузке. Если база данных постоянно недосчиталась ресурсов, переместите ее из пула и назначаем ее как единую базу данных с предсказуемым количеством необходимых ресурсов.

### <a name="determine-the-number-of-dtus-needed-by-a-workload"></a>Определение числа единиц DTU, требуемых для рабочей нагрузки

Если вы хотите перенести существующую рабочую нагрузку виртуальной машины на сервер еили в базу данных Azure S'L, используйте [калькулятор DTU](https://dtucalculator.azurewebsites.net/) для приблизительного количества необходимых DTU. Для существующей рабочей нагрузки базы данных Azure S'L воспользуйтесь [информацией о производительности запросов,](sql-database-query-performance.md) чтобы понять потребление ресурсов базы данных (DTO) и получить более глубокие сведения для оптимизации рабочей нагрузки. Динамическое представление [управления sys.dm_db_resource_stats](https://docs.microsoft.com/sql/relational-databases/system-dynamic-management-views/sys-dm-db-resource-stats-azure-sql-database) (DMV) позволяет просматривать потребление ресурсов за последний час. Представление каталога [sys.resource_stats](https://docs.microsoft.com/sql/relational-databases/system-catalog-views/sys-resource-stats-azure-sql-database) отображает потребление ресурсов за последние 14 дней, но при более низкой точности в пятиминутных средних значениях.

### <a name="determine-dtu-utilization"></a>Определение использования ДТУ

Для определения среднего процента использования DTU/eDTU по отношению к пределу базы данных DTU/eDTU используйте следующую формулу:

`avg_dtu_percent = MAX(avg_cpu_percent, avg_data_io_percent, avg_log_write_percent)`

Значения ввода для этой формулы могут быть получены из [sys.dm_db_resource_stats,](https://docs.microsoft.com/sql/relational-databases/system-dynamic-management-views/sys-dm-db-resource-stats-azure-sql-database) [sys.resource_stats](https://docs.microsoft.com/sql/relational-databases/system-catalog-views/sys-resource-stats-azure-sql-database)и [sys.elastic_pool_resource_stats](https://docs.microsoft.com/sql/relational-databases/system-catalog-views/sys-elastic-pool-resource-stats-azure-sql-database) DMVs. Другими словами, чтобы определить процент использования DTU/eDTU в сторону предела dTU/eDTU базы данных или эластичного пула, выберите наибольшее процентное значение из следующих: `avg_cpu_percent`, `avg_data_io_percent`и `avg_log_write_percent` в данный момент времени.

> [!NOTE]
> Предел Базы данных DTU определяется процессором, читает, пишет и памяти доступны для базы данных. Однако, поскольку движок базы данных S'L Server обычно использует `avg_memory_usage_percent` всю имеющуюся память для кэша данных для повышения производительности, значение обычно приближается к 100% независимо от текущей загрузки базы данных. Таким образом, даже если память косвенно влияет на предел DTU, она не используется в формуле использования DTU.
>

### <a name="workloads-that-benefit-from-an-elastic-pool-of-resources"></a>Рабочие нагрузки, для которых эффективно используется эластичный пул ресурсов

Бассейны хорошо подходят для баз данных с низким средним уровнем использования ресурсов и относительно редкими всплесками использования. Для получения дополнительной информации см., [когда вы должны рассмотреть упругий пул базы данных S'L?.](sql-database-elastic-pool.md)

### <a name="hardware-generations-in-the-dtu-based-purchasing-model"></a>Аппаратные поколения в модели закупок на основе DTU

В модели закупок на основе DTU клиенты не могут выбрать аппаратную генерацию, используемую для их баз данных. В то время как данная база данных обычно остается на определенном аппаратном поколении в течение длительного времени (обычно в течение нескольких месяцев), Есть определенные события, которые могут привести к базе данных, которые будут перемещены в другое поколение оборудования.

Например, база данных может быть перемещена в другое аппаратное поколение, если она масштабируется вверх или вниз до другой цели обслуживания, или если текущая инфраструктура в центре обработки данных приближается к ее ограничениям емкости, или если используемое в настоящее время оборудование находится в стадии списаны в связи с его окончанием срока службы.

Если база данных перемещена на другое оборудование, производительность рабочей нагрузки может измениться. Модель DTU гарантирует, что пропускная стоимость и время отклика контрольной рабочей нагрузки [DTU](https://docs.microsoft.com/azure/sql-database/sql-database-service-tiers-dtu#dtu-benchmark) останутся практически идентичными по мере того, как база данных переходит к другой аппаратной генерации, если ее цель обслуживания (количество DTU) останется прежней. 

Однако в широком спектре рабочих нагрузок клиентов, работающих в базе данных Azure S'L Database, влияние использования различного оборудования для одной и той же задачи обслуживания может быть более выраженным. Различные рабочие нагрузки выиграют от различных конфигураций и функций оборудования. Таким образом, для рабочих нагрузок, помимо бенчмарка DTU, можно увидеть различия в производительности, если база данных перемещается из одного аппаратного поколения в другое.

Например, приложение, чувствительное к задержке сети, может видеть лучшую производительность на аппаратном обеспечении Gen5 против Gen4 из-за использования ускоренной сети в Gen5, но приложение с использованием интенсивного чтения IO может видеть лучшую производительность на оборудовании Gen4 против Gen5 из-за более высокая память на ядро соотношение на Gen4.

Клиенты с рабочими нагрузками, чувствительными к изменениям оборудования, или клиенты, желающие контролировать выбор аппаратного поколения для своей базы данных, могут использовать модель [vCore](https://docs.microsoft.com/azure/sql-database/sql-database-service-tiers-vcore) для выбора предпочтительного аппаратного поколения при создании базы данных и масштабировании. В модели vCore задокументированы ограничения ресурсов каждой цели службы для каждого аппаратного поколения как для [отдельных баз данных,](https://docs.microsoft.com/azure/sql-database/sql-database-vcore-resource-limits-single-databases) так и для [эластичных пулов.](https://docs.microsoft.com/azure/sql-database/sql-database-vcore-resource-limits-elastic-pools) Для получения дополнительной информации о аппаратных поколений в модели vCore, см [Аппаратные поколения](https://docs.microsoft.com/azure/sql-database/sql-database-service-tiers-vcore#hardware-generations).

## <a name="frequently-asked-questions-faqs"></a>Часто задаваемые вопросы (FAQ)

### <a name="do-i-need-to-take-my-application-offline-to-convert-from-a-dtu-based-service-tier-to-a-vcore-based-service-tier"></a>Нужно ли перевести приложение в автономный режим для перехода из уровня обслуживания на основе DTU в уровень обслуживания на основе vCore?

Нет. Вам не нужно принимать приложение в автономном режиме. Новые уровни обслуживания предлагают простой метод онлайн-конверсии, который похож на существующий процесс обновления баз данных от стандартного до уровня премиум-обслуживания и наоборот. Вы можете начать эту конверсию с помощью портала Azure, PowerShell, Azure CLI, T-S'L или АИП REST. Смотрите [Управление отдельными базами данных](sql-database-single-database-scale.md) и [управление эластичными пулами.](sql-database-elastic-pool.md)

### <a name="can-i-convert-a-database-from-a-service-tier-in-the-vcore-based-purchasing-model-to-a-service-tier-in-the-dtu-based-purchasing-model"></a>Могу ли я преобразовать базу данных из уровня обслуживания в модели покупки на основе vCore в уровень обслуживания в модели закупок на основе DTU?

Да, вы можете легко преобразовать базу данных в любую поддерживаемую цель производительности с помощью портала Azure, PowerShell, Azure CLI, T-S'L или REST API. Смотрите [Управление отдельными базами данных](sql-database-single-database-scale.md) и [управление эластичными пулами.](sql-database-elastic-pool.md)

## <a name="next-steps"></a>Дальнейшие действия

- Для получения дополнительной информации о vCore основе модели покупки, см [vCore основе модели покупки](sql-database-service-tiers-vcore.md).
- Для получения дополнительной информации о модели закупок на основе DTU, [см.](sql-database-service-tiers-dtu.md)
