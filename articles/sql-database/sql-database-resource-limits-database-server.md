---
title: Ограничения ресурсов сервера Базы данных SQL Azure | Документация Майкрософт
description: Статья представляет обзор ограничения ресурсов сервера Базы данных SQL Azure для отдельных баз данных и эластичных пулов. Здесь также содержится информация о том, что происходит, когда эти ограничения ресурсов соответствуют или превышают допустимые нормы.
services: sql-database
ms.service: sql-database
ms.subservice: single-database
ms.custom: ''
ms.devlang: ''
ms.topic: conceptual
author: stevestein
ms.author: sstein
ms.reviewer: sashan,moslake,josack
manager: craigg
ms.date: 04/18/2019
ms.openlocfilehash: 06e61d30f0d4e598c48f190572b8b4343f351043
ms.sourcegitcommit: d4dfbc34a1f03488e1b7bc5e711a11b72c717ada
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/13/2019
ms.locfileid: "65762788"
---
# <a name="sql-database-resource-limits-for-azure-sql-database-server"></a>Ограничения ресурсов для сервера Базы данных SQL Azure

Статья представляет обзор ограничения ресурсов для сервера Базы данных SQL, который управляет отдельными базами данных и эластичными пулами. Здесь также содержится информация о том, что происходит, когда эти ограничения ресурсов соответствуют или превышают допустимые нормы.

> [!NOTE]
> Ограничения управляемых экземпляров см. в статье [Общие сведения об ограничениях ресурсов Управляемого экземпляра Базы данных SQL Azure](sql-database-managed-instance-resource-limits.md).

## <a name="maximum-resource-limits"></a>Максимальное ограничение ресурсов

| Ресурс | Ограничение |
| :--- | :--- |
| Баз данных на сервер | 5000 |
| Количество серверов по умолчанию на одну подписку в любом регионе | 20 |
| Максимальное количество серверов на одну подписку в любом регионе | 200 |  
| Квота DTU или eDTU на сервер | 54 000 |  
| Квота виртуальных ядер на сервер или экземпляр | 540 |
| Максимальное число пулов на сервер | ограничено числом DTU или виртуальных ядер Например, если каждый пул поддерживает 1000 DTU, тогда один сервер может поддерживать 54 пула.|
|||

> [!NOTE]
> Чтобы увеличить квоту DTU или eDTU, квоту виртуальных ядер либо число серверов по умолчанию, отправьте запрос в службу поддержки на портале Azure для подписки, выбрав тип проблемы "Квота". Квота DTU или eDTU и предельное число баз данных на сервер ограничивают количество эластичных пулов на сервер.
> [!IMPORTANT]
> По мере приближения количества баз данных к пороговому значению для сервера Базы данных SQL может произойти следующее:
> - Увеличение задержки при выполнении запросов к базе данных master.  Сюда входят представления статистических данных использования ресурсов, такие как sys.resource_stats.
> - Увеличение задержки при управлении и отображении для точек наблюдения портала, включая перечисление баз данных на сервере.

## <a name="what-happens-when-database-resource-limits-are-reached"></a>Что происходит при достижении ограничения ресурсов базы данных?

### <a name="compute-dtus-and-edtus--vcores"></a>Вычислительные ресурсы (DTU и eDTU/виртуальные ядра)

Когда использование вычислительных ресурсов базы данных (измеряемое в DTU и eDTU или виртуальных ядрах) значительно возрастает, увеличиваются задержки и даже может истечь время ожидания. В этих условиях служба может ставить запросы в очередь и предоставлять ресурсы для их выполнения по мере освобождения этих ресурсов.
При интенсивном использовании вычислительных ресурсов возможны следующие варианты предотвращения последствий:

- Увеличение объема вычислительных ресурсов базы данных или эластичного пула для предоставления базе данных дополнительных вычислительных ресурсов. См. разделы [Масштабирование ресурсов отдельной базы данных](sql-database-single-database-scale.md) и [Масштабирование ресурсов эластичного пула](sql-database-elastic-pool-scale.md).
- Оптимизация запросов для уменьшения использования ресурсов каждым запросом. Дополнительные сведения см. в разделе [Настройка запросов и указания на них](sql-database-performance-guidance.md#query-tuning-and-hinting).

### <a name="storage"></a>Хранилище

Когда используемое пространство базы данных достигает максимального размера, операции вставки и обновления, увеличивающие размер данных, завершаются сбоем и клиенты получают [сообщение об ошибке](sql-database-develop-error-messages.md). Операции SELECT и DELETE с базой данных продолжают успешно выполняться.

При интенсивном использовании пространства возможны следующие варианты предотвращения последствий:

- Увеличение максимального размера базы данных или эластичного пула или увеличение объема хранилища. См. разделы [Масштабирование ресурсов отдельной базы данных](sql-database-single-database-scale.md) и [Масштабирование ресурсов эластичного пула](sql-database-elastic-pool-scale.md).
- Если база данных находится в эластичном пуле, то в качестве альтернативы ее можно переместить за пределы пула, чтобы ее дисковое пространство не использовалось совместно с другими базами данных.
- Сжатие базы данных для освобождения неиспользуемого пространства. Дополнительные сведения см. в статье об [управлении файловым пространством в Базе данных SQL Azure](sql-database-file-space-management.md).

### <a name="sessions-and-workers-requests"></a>Сеансы и рабочие роли (запросы)

Максимальное количество сеансов и рабочих ролей определяется уровнем служб и объемом вычислительных ресурсов (DTU и eDTU). При достижении ограничения числа сеансов или рабочих ролей новые запросы отклоняются, а клиенты получают сообщение об ошибке. Хотя приложение может управлять числом доступных подключений, число параллельных рабочих ролей зачастую существенно труднее оценивать и контролировать. Это особенно сильно проявляется в периоды пиковой нагрузки, когда достигаются ограничения ресурсов базы данных и рабочие роли накапливаются из-за увеличенной длительности выполнения запросов.

При интенсивном использовании сеансов и рабочих ролей возможны следующие варианты предотвращения последствий:

- Повышение уровня служб или объема вычислительных ресурсов базы данных или эластичного пула. См. разделы [Масштабирование ресурсов отдельной базы данных](sql-database-single-database-scale.md) и [Масштабирование ресурсов эластичного пула](sql-database-elastic-pool-scale.md).
- Оптимизация запросов для сокращения использования ресурсов, необходимых каждому запросу, если причиной повышенного использования рабочих ролей является состязание за вычислительные ресурсы. Дополнительные сведения см. в разделе [Настройка запросов и указания на них](sql-database-performance-guidance.md#query-tuning-and-hinting).

## <a name="transaction-log-rate-governance"></a>Управление скорость журнала транзакций 
Управление скорость журнала транзакций-это процесса в базе данных SQL Azure, используется для ограничения скорости приема высокого уровня для рабочих нагрузок, например bulk insert, SELECT INTO, и строит индекс. Эти ограничения отслеживаются и принудительно на уровне доли секунды, скорость создания записей журнала, ограничения пропускной способности независимо от того, сколько операций ввода-вывода могут быть выданы для файлов данных.  Скорость создания журнала транзакций в настоящее время линейно масштабировать до момента, который зависит от аппаратного обеспечения, в журнале Максимальная скорость разрешено, 96 МБ в секунду с помощью модели приобретения виртуальных ядер. 

> [!NOTE]
> Фактических физических операций для файлов журнала транзакций не регулируется и не ограничено. 

Журнал курсы, установленные таким образом, что их можно сделать и постоянно в различных сценариях, а всей системы могут сохранять свои функции с минимальным воздействием на пользовательскую нагрузку. Управление скорость журнала гарантирует, что журнал транзакций, резервные копии, оставаться в пределах опубликованных восстанавливаемости соглашения об уровне обслуживания.  Это регулирование также предотвращает чрезмерное невыполненной работы по во вторичных репликах.

Как создаются записи журнала, каждая операция вычисляется и оцениваться ли он должен быть задержан для поддержания ставку максимальное журнала (МБ/с в секунду). Задержки не добавляются при записи журнала записываются в хранилище, а управление скорость журнала применяется во время создания журнала скорости самого.

Создание журнала ставок, установленных во время выполнения может также влиять механизмы обратной связи, временно уменьшение ставок допустимый журнала, можно стабилизации системы. Управление пространством журнала файла, как избежать заканчивается в нехватки места в журнале и группы доступности механизмы репликации может временно привести к снижению ограничения общей системы. 

Журнал скорость регулятора управления скоростью обработки трафика будет отображена через следующие типы ожидания (в [sys.dm_db_wait_stats](https://docs.microsoft.com/sql/relational-databases/system-dynamic-management-views/sys-dm-db-wait-stats-azure-sql-database) динамическое административное Представление):

| Тип ожидания | Примечания |
| :--- | :--- |
| LOG_RATE_GOVERNOR | Ограничения базы данных |
| POOL_LOG_RATE_GOVERNOR | Ограничения пула |
| INSTANCE_LOG_RATE_GOVERNOR | Ограничение на уровне экземпляра |  
| HADR_THROTTLE_LOG_RATE_SEND_RECV_QUEUE_SIZE | Элемент управления обратной связи, репликации физических группы доступности в уровня "премиум" / критически важный для бизнеса не справляется |  
| HADR_THROTTLE_LOG_RATE_LOG_SIZE | Элемент управления обратной связи, ограничение скорости, чтобы избежать нехватки места условий журнала |
|||

При обнаружении ограничение скорости журнала, что снижают требуемой масштабируемости, рассмотрите следующие варианты:
- Масштабирование до большего размера уровня для получения максимальной скорости журнала 96 МБ в секунду. 
- Если данные, загружаемые является временной, т. е. обеспечивает промежуточное хранение данных в процессе ETL, его можно загрузить в базу данных tempdb (которая подлежит минимальному Протоколированию). 
- Для аналитических сценариев загрузки в таблицу охваченных кластеризованный индекс columnstore. Это позволяет сократить скорость журналов из-за сжатия. Этот метод повышения загрузки ЦП и применяется только к наборам данных, которые выигрывают от кластеризованных индексов columnstore. 

## <a name="next-steps"></a>Дальнейшие действия

- Сведения об общих ограничениях Azure см. в разделе [Подписка Azure, границы, квоты и ограничения службы](../azure-subscription-service-limits.md).
- Сведения о DTU и eDTU см. в разделе [Общие сведения об обычных единицах передачи данных (DTU) и единицах передачи данных в эластичной базе данных (eDTU)](sql-database-purchase-models.md#dtu-based-purchasing-model).
- Сведения об ограничениях на размер базы данных tempdb см. в [этом разделе](https://docs.microsoft.com/sql/relational-databases/databases/tempdb-database#tempdb-database-in-sql-database).
