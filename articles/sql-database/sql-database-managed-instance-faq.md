---
title: 'Управляемый экземпляр: вопросы и ответы'
description: Управляемый экземпляр базы данных S'L часто задаваемые вопросы (Часто задаваемые вопросы)
services: sql-database
ms.service: sql-database
ms.subservice: managed-instance
ms.custom: ''
ms.devlang: ''
ms.topic: conceptual
author: jovanpop-msft
ms.author: jovanpop
ms.reviewer: sstein, carlrab
ms.date: 03/17/2020
ms.openlocfilehash: 393d67b200a4f8d44cb001b3a7e2e491209e9d58
ms.sourcegitcommit: 07d62796de0d1f9c0fa14bfcc425f852fdb08fb1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/27/2020
ms.locfileid: "80364168"
---
# <a name="sql-database-managed-instance-frequently-asked-questions-faq"></a>Управляемый экземпляр базы данных S'L часто задаваемые вопросы (Часто задаваемые вопросы)

Эта статья содержит многие из наиболее распространенных вопросов о [управляемом экземпляре базы данных S'L.](sql-database-managed-instance.md)

## <a name="supported-features"></a>Поддерживаемые функции

**Где можно найти список функций, поддерживаемых в управляемом экземпляре?**

Список поддерживаемых функций в управляемом экземпляре можно узнать [по сравнению с базой данных Azure S'L по сравнению с сервером S'L.](sql-database-features.md)

Для различий в синтаксисе и поведении между управляемым экземпляром базы данных Azure S'L и натерритории сервера S'L— [см.](sql-database-managed-instance-transact-sql-information.md)


## <a name="tech-spec--resource-limits"></a>Технологическая спецификация & пределы ресурсов
 
**Где можно найти технические характеристики и лимиты ресурсов для управляемого экземпляра?**

Для доступных характеристик генерации оборудования, увидеть [технические различия в аппаратных поколений](sql-database-managed-instance-resource-limits.md#hardware-generation-characteristics).
Для доступных уровней обслуживания [technical differences between service tiers](sql-database-managed-instance-resource-limits.md#service-tier-characteristics)и их характеристик см.

## <a name="known-issues--bugs"></a>Известные проблемы & ошибок

**Где я могу найти известные проблемы и ошибки?**

Для ошибок и известных проблем см [известные проблемы](sql-database-release-notes.md#known-issues).

## <a name="new-features"></a>новые функции;

**Где я могу найти последние функции и функции в открытом доступе?**

Для новых функций [release notes](sql-database-release-notes.md?tabs=managed-instance)и функций предварительного просмотра см.

## <a name="deployment-times"></a>Время развертывания 

**Сколько времени уходит на создание или обновление экземпляра или восстановление базы данных?**

Ожидаемое время для создания нового управляемого экземпляра или изменения уровня обслуживания (vCores, хранилище) зависит от нескольких факторов. Взгляните на [управление операций](/azure/sql-database/sql-database-managed-instance#managed-instance-management-operations) 

## <a name="naming-convention"></a>Соглашение об именовании

**Может ли управляемый экземпляр иметь то же имя, что и на территории S'L Server?**

Изменение имени управляемого экземпляра не поддерживается.

Управляемый экземпляр зоны DNS по умолчанию *.database.windows.net* может быть изменен. 

Использовать другую зону DNS вместо по умолчанию, например, *.contoso.com:* 
- Используйте CliConfig для определения псевдонима. Инструмент является просто оберткой настроек реестра, так что это может быть сделано с помощью групповой политики или скрипта, а также.
- Используйте *CNAME* с опцией *TrustServerCertificate'true.*

## <a name="move-db-from-mi"></a>Перемещение DB от MI 

**Как переместить базу данных из управляемого экземпляра обратно в базу данных S'L Server или Базу данных Azure S-L?**

Вы можете [экспортировать базу данных в BACPAC,](sql-database-export.md) а затем [импортировать файл BACPAC.]( sql-database-import.md) Это рекомендуемый подход, если ваша база данных меньше 100 ГБ.

Транзакционная репликация может быть использована, если все таблицы в базе данных имеют первичные ключи.

Родные `COPY_ONLY` резервные копирования, взятые из управляемого экземпляра, не могут быть восстановлены в S'L Server, поскольку управляемый экземпляр имеет более высокую версию базы данных по сравнению с сервером S'L.

## <a name="migrate-instance-db"></a>Мигрировать экземпляр DB

**Как перенести свою базу данных экземпляров в единую базу данных Azure S'L?**

Одним из вариантов является [экспорт базы данных в BACPAC,](sql-database-export.md) а затем [импорт файла BACPAC.](sql-database-import.md) 

Это рекомендуемый подход, если база данных меньше 100 ГБ. Транзакционная репликация может быть использована, если все таблицы в базе данных имеют первичные ключи.

## <a name="switch-hardware-generation"></a>Переключение аппаратного поколения 

**Могу ли я переключить управляемое аппаратное поколение экземпляра между Gen 4 и Gen 5 онлайн?**

Автоматизированное онлайн-переключение между поколениями оборудования возможно, если оба поколения аппаратных средств доступны в регионе, где подготовлен ваш управляемый экземпляр. В этом случае вы можете проверить [страницу обзора модели vCore,](sql-database-service-tiers-vcore.md) объясняющую, как переключаться между поколениями оборудования.

Это длительная операция, так как новый управляемый экземпляр будет подготовлен в фоновом режиме, а базы данных автоматически передаются между старым и новым экземпляром с быстрой неудачей в конце процесса. 

Если оба поколения аппаратных средств не поддерживаются в одном регионе, изменение генерации оборудования возможно, но должно быть сделано вручную. Это требует предоставления нового экземпляра в регионе, где доступна необходимая генерация оборудования, и ручного резервного копирования и восстановления данных между старым и новым экземпляром.


## <a name="tune-performance"></a>Настройка производительности

**Как настроить производительность управляемого экземпляра?**

Управляемый экземпляр General Purpose использует удаленное хранилище, из-за которого размер данных и файлов журнала имеет значение для производительности. Для получения дополнительной информации [см. Влияние размера файла журнала на производительность управляемой инстанции общего назначения.](https://medium.com/azure-sqldb-managed-instance/impact-of-log-file-size-on-general-purpose-managed-instance-performance-21ad170c823e)

Если рабочая нагрузка состоит из множества небольших транзакций, подумайте о переключении типа соединения с прокси-сервера на режим перенаправления.

## <a name="maximum-storage-size"></a>Максимальный размер хранилища

**Каков максимальный размер хранилища для управляемого экземпляра?**

Размер хранилища для управляемого экземпляра зависит от выбранного уровня обслуживания (общая цель или критический бизнес). Для ограничений на хранение этих [Service tier characteristic](sql-database-service-tiers-general-purpose-business-critical.md)уровней обслуживания см.

## <a name="back-up-storage-cost"></a>Резервное копирование затрат на хранение 

**Вычитается ли резервное хранилище из моего управляемого хранилища экземпляра?**

Нет, резервное хранилище не вычитается из хранилища управляемого экземпляра. Хранилище резервного копирования не зависит от места хранения экземпляра и не ограничено по размеру. Резервное хранение ограничено периодом времени для сохранения резервного копирования баз данных экземпляров, настраиваемой от 7 до 35 дней. Для получения подробной информации [см.](https://docs.microsoft.com/azure/sql-database/sql-database-automated-backups)

## <a name="track-billing"></a>Отслеживание выставления счетов

**Есть ли способ отследить стоимость выставления счетов для моего управляемого экземпляра?**

Это можно сделать с помощью [решения Управления затратaz.](/azure/cost-management/) Перейдите к **подпискам** на [портале Azure](https://portal.azure.com) и выберите **анализ затрат.** 

Используйте опцию **накопленных затрат,** а `microsoft.sql/managedinstances`затем отфильтруйте **по типу ресурса** как. 
  
## <a name="inbound-nsg-rules"></a>Входящие правила NSG

**Как установить входящие правила NSG в портах управления?**

Управляемый самолет управления экземпляром поддерживает правила NSG, защищающие порты управления.

Вот для чего используются порты управления:

Порты 9000 и 9003 используются инфраструктурой Service Fabric. Основная роль Service Fabric заключается в том, чтобы сохранить виртуальный кластер здоровым и сохранить состояние цели с точки зрения количества реплик компонентов.

Порты 1438, 1440 и 1452 используются узлами агента. Агент узла — это приложение, которое работает внутри кластера и используется плоскостью управления для выполнения команд управления.

Помимо правил NSG встроенный брандмауэр защищает экземпляр на сетевом слое. На уровне приложения связь защищена сертификатами.
  
Для получения дополнительной информации и для проверки [Azure SQL Database managed instance built-in firewall](sql-database-managed-instance-management-endpoint-verify-built-in-firewall.md)встроенного брандмауэра см.


## <a name="mitigate-data-exfiltration-risks"></a>Снижение рисков эксфильтрации данных  

**Как уменьшить риски эксфильтрации данных?**

Для снижения рисков эксфильтрации данных клиентам рекомендуется применять набор параметров безопасности и элементов управления:

- Включите [прозрачное шифрование данных (TDE)](https://docs.microsoft.com/azure/sql-database/transparent-data-encryption-azure-sql) во всех базах данных.
- Выключите общее время выполнения языка (CLR). Это рекомендуется на месте, а также.
- Используйте только активную проверку подлинности Azure Active Directory (AAD).
- Доступ к экземпляру с низкой привилегировой учетной записью DBA.
- Налажить доступ к JiT jumpbox для учетной записи sysadmin.
- Включите [аудит S'L](https://docs.microsoft.com/sql/relational-databases/security/auditing/sql-server-audit-database-engine)и интегрируйте его с механизмами оповещения.
- Включите [обнаружение угроз](https://docs.microsoft.com/azure/sql-database/sql-database-threat-detection) из набора Advanced Data Security [(ADS).](https://docs.microsoft.com/azure/sql-database/sql-database-advanced-data-security)


## <a name="cost-saving-use-cases"></a>Случаи использования экономии средств

**Где можно найти случаи использования и, как следствие, экономию средств с управляемым экземпляром?**

Управляемые тематические исследования:

- [Комацу](https://customers.microsoft.com/story/komatsu-australia-manufacturing-azure)
- [Kmd](https://customers.microsoft.com/en-ca/story/kmd-professional-services-azure-sql-database)
- [PowerDETAILS](https://customers.microsoft.com/story/powerdetails-partner-professional-services-azure-sql-database-managed-instance)
- [Все скрипты](https://customers.microsoft.com/story/allscripts-partner-professional-services-azure)  
Чтобы лучше понять преимущества, затраты и риски, связанные с развертыванием управляемой базы данных Azure S'L, есть также исследование Forrester: [Общее экономическое воздействие MI.](https://azure.microsoft.com/resources/forrester-tei-sql-database-managed-instance)


## <a name="dns-refresh"></a>Обновление DNS 

**Могу ли я обновить DNS?**

В настоящее время мы не предоставляем функцию для обновления конфигурации DNS сервера для управляемого экземпляра.

Конфигурация DNS в конечном итоге обновляется:

- Когда заканчивается срок аренды DHCP.
- На платформе обновления.

Как обходной путь, понизить управляемый экземпляр до 4 vCore и обновить его снова потом. Это имеет побочный эффект обновления конфигурации DNS.


## <a name="ip-address"></a>IP-адрес

**Могу ли я подключиться к управляемому экземпляру с помощью IP-адреса?**

Подключение к управляемому экземпляру с помощью IP-адреса не поддерживается. Управляемые карты имен хост-хост экземпляра для загрузки балансоилира перед виртуальным кластером управляемого экземпляра. Поскольку один виртуальный кластер может размещать несколько управляемых экземпляров, соединение не может быть направлено в правильный управляемый экземпляр без указания его имени.

Для получения дополнительной информации об управляемой архитектуре виртуального кластера можно ознакомиться с [архитектурой виртуального кластерного кластера.](sql-database-managed-instance-connectivity-architecture.md#virtual-cluster-connectivity-architecture)

**Может ли управляемый экземпляр иметь статический IP-адрес?**

В редких, но необходимых ситуациях нам может потребоваться онлайн-миграция управляемого экземпляра в новый виртуальный кластер. При необходимости эта миграция происходит из-за изменений в нашем технологическом стеке, направленных на повышение безопасности и надежности службы. Переход к новому виртуальному кластеру приводит к изменению IP-адреса, отображаемого на имя узла управляемого экземпляра. Служба управляемого экземпляра не претендует на статическую поддержку IP-адреса и оставляет за собой право изменить ее без предварительного уведомления в рамках регулярных циклов обслуживания.

По этой причине мы настоятельно рекомендуем полагаться на неизменяемость IP-адреса, поскольку это может привести к ненужным простоям.

## <a name="change-time-zone"></a>Изменение часового пояса

**Могу ли я изменить часовой пояс для существующего управляемого экземпляра?**

Конфигурация часового пояса может быть установлена при первом подготовке управляемого экземпляра. Изменение часового пояса существующего управляемого экземпляра не поддерживается. Для получения подробной информации [см.](sql-database-managed-instance-timezone.md#limitations)

Обходные пути включают создание нового управляемого экземпляра с соответствующим часового поясом, а затем либо выполнять ручное резервное копирование и восстановление, или то, что мы рекомендуем, выполнить [перекрестный экземпляр в момент времени восстановления.](https://blogs.msdn.microsoft.com/sqlserverstorageengine/2018/06/07/cross-instance-point-in-time-restore-in-azure-sql-database-managed-instance/)


## <a name="resolve-performance-issues"></a>Устранение проблем с производительностью

**Как решить проблемы с производительностью с помощью управляемого экземпляра?**

Для сравнения производительности между управляемым экземпляром и сервером S'L, хорошей отправной точкой является [Наилучшая практика для сравнения производительности между экземпляром azure S'L и статьей S'L Server.](https://techcommunity.microsoft.com/t5/Azure-SQL-Database/The-best-practices-for-performance-comparison-between-Azure-SQL/ba-p/683210)

Загрузка данных часто происходит медленнее в управляемом экземпляре, чем в S'L Server, из-за обязательной модели полного восстановления и [ограничений](https://docs.microsoft.com/azure/sql-database/sql-database-managed-instance-resource-limits#service-tier-characteristics) на пропускную запись записи записи журнала транзакций. Иногда это можно обработать, загрузив переходные данные в tempdb вместо базы данных пользователя, или используя кластерный столбец или оптимизированные таблицы памяти.


## <a name="restore-encrypted-backup"></a>Восстановление зашифрованного резервного копирования

**Могу ли я восстановить зашифрованную базу данных в управляемый экземпляр?**

Да, вам не нужно расшифровывать базу данных, чтобы иметь возможность восстановить ее в управляемом экземпляре. Вам нужно предоставить сертификат/ключ, используемый в качестве протектора ключа шифрования в исходной системе, для управляемого экземпляра, чтобы иметь возможность читать данные из зашифрованного файла резервного копирования. Это можно осуществить двумя путями:

- *Загрузите сертификат-протектор в управляемый экземпляр.* Это может быть сделано только с помощью PowerShell. [Пример сценария](https://docs.microsoft.com/azure/sql-database/sql-database-managed-instance-migrate-tde-certificate) описывает весь процесс.
- *Загрузите асимметричный ключ-протектор в Azure Key Vault (AKV) и направьте*к нему экземпляр. Этот подход напоминает случай использования TDE bring-your-own-key (BYOK), который также использует интеграцию AKV для хранения ключа шифрования. Если вы не хотите использовать ключ в качестве протектора ключа шифрования, и просто хотите сделать ключ доступным для управляемого экземпляра для восстановления зашифрованной базы данных (ы), следуйте инструкциям по [настройке BYOK TDE](https://docs.microsoft.com/azure/sql-database/transparent-data-encryption-azure-sql#manage-transparent-data-encryption)и не проверяйте флажок *Сделать выбранный ключ протектором TDE по умолчанию.*

Как только вы сделаете протектор шифрования доступным для управляемого экземпляра, вы можете приступить к стандартной процедуре восстановления базы данных.

## <a name="migrate-from-single-db"></a>Мигрировать из одного DB 

**Как я могу перенестись из единого или эластичного пула базы данных Azure s-L в управляемый экземпляр?**

Управляемый экземпляр предлагает те же уровни производительности для вычислений и размера хранилища, что и другие варианты развертывания базы данных Azure S'L. Если вы хотите консолидировать данные в одном экземпляре, или вам просто нужна функция, поддерживаемая исключительно в управляемом экземпляре, вы можете перенести свои данные с помощью функциональности экспорта/импорта (BACPAC).
