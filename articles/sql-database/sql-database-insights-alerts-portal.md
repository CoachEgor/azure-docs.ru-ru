---
title: Настройка оповещений и уведомлений с помощью портала Azure | Документация Майкрософт
description: Используйте портал Azure для создания оповещений базы данных SQL, которые могут активировать уведомления или автоматизированные операции при выполнении заданных условий.
services: sql-database
ms.service: sql-database
ms.subservice: monitor
ms.custom: ''
ms.devlang: ''
ms.topic: conceptual
author: aamalvea
ms.author: aamalvea
ms.reviewer: jrasnik, carlrab
ms.date: 11/02/2018
ms.openlocfilehash: 9468dbd71ee8da88cbabc3ca9f76c77d47adc221
ms.sourcegitcommit: 7c4de3e22b8e9d71c579f31cbfcea9f22d43721a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/26/2019
ms.locfileid: "68567925"
---
# <a name="create-alerts-for-azure-sql-database-and-data-warehouse-using-azure-portal"></a>Создание оповещений для Базы данных SQL Azure и хранилища данных с помощью портала Azure

## <a name="overview"></a>Обзор
В этой статье показано, как настроить оповещения для базы данных SQL Azure и хранилища данных с помощью портала Azure. Оповещения могут отправить электронное сообщение или вызвать веб-перехватчик, когда какая-либо метрика достигает порога (например, размер базы данных или использование ЦП). В этой статье также приведены рекомендации по настройке периодов оповещений.    

> [!IMPORTANT]
> В Управляемом экземпляре эта функция пока недоступна. В качестве альтернативы можно использовать агент SQL, чтобы отправлять оповещения по электронной почте для некоторых метрик на основе [динамических административных представлений](https://docs.microsoft.com/sql/relational-databases/system-dynamic-management-views/system-dynamic-management-views).

Вы можете получать оповещения на основе отслеживания метрик или событий в службах Azure.

* **Значения метрик**. Оповещение активируется, когда значение указанной метрики выходит за рамки заданного порогового значения. То есть сначала оно активируется, когда условие выполняется, а затем — когда условие перестает выполняться.    
* **События журнала действий**. Оповещение может активироваться при *каждом* событии или только тогда, когда выполняется определенное число событий.

Для оповещения можно настроить действие, выполняемое при активации оповещения:

* отправка уведомлений по электронной почте администратору службы и соадминистраторам;
* отправка уведомления на указанные дополнительные электронные адреса;
* вызов webhook;

Для настройки правил генерации оповещений и получении сведений о них можно использовать:

* [портал Azure](../monitoring-and-diagnostics/insights-alerts-portal.md)
* [PowerShell](../azure-monitor/platform/alerts-classic-portal.md)
* [интерфейс командной строки (CLI)](../azure-monitor/platform/alerts-classic-portal.md)
* [Azure Monitor REST API](https://msdn.microsoft.com/library/azure/dn931945.aspx)

## <a name="create-an-alert-rule-on-a-metric-with-the-azure-portal"></a>Создание правила генерации оповещений на основе метрики с помощью портала Azure
1. На [портале](https://portal.azure.com/)найдите ресурс, который нужно отслеживать, и выберите его.
2. В разделе "Мониторинг" выберите **Оповещения (классические)** . Текст и значок для разных ресурсов могут незначительно отличаться.  
   
     ![Отслеживание](media/sql-database-insights-alerts-portal/AlertsClassicButton.JPG)
  
   - **Инструкция только для хранилищ данных SQL.** Выберите граф **Потребление DWU**. Щелкните **Просмотреть классические оповещения**

3. Нажмите кнопку **Добавить оповещение метрики (классическое)** и заполните поля.
   
    ![Добавить оповещение](media/sql-database-insights-alerts-portal/AddDBAlertPageClassic.JPG)
4. Введите **имя** правила генерации оповещений и укажите **описание**, отображаемое также в уведомлениях по электронной почте.
5. Если вы выбрали **метрику** для отслеживания, то выберите для нее **условие** и **пороговое значение**. Кроме того, выберите **период**, в течение которого должно быть выполнено правило метрики, прежде чем будет активировано оповещение. Например, если используется период "PT5M", а оповещение определяет загрузку ЦП выше 80 %, такое оповещение активируется, если **средняя** загрузка ЦП превышает 80 % не менее 5 минут. После первой активации оповещение активируется повторно, если средняя загрузка ЦП будет ниже 80 % не менее 5 минут. Измерение загрузки ЦП происходит раз в минуту. В следующей таблице представлены поддерживаемые временные окна и типы статистической обработки, используемые каждым оповещением. Не все оповещения используют среднее значение.   
6. Установите флажок **Владельцы, авторы и читатели электронных писем** , если администраторы и соадминистраторы должны получать электронные сообщения при активации оповещения.
7. Если вы хотите отправлять уведомления при активации оповещения на дополнительные электронные адреса, добавьте их в поле **Дополнительные адреса электронной почты администратора** . Несколько сообщений электронной почты разделяются точками с запятой — *Email\@contoso. com\@; email2 contoso.com*
8. Укажите допустимый универсальный код ресурса (URI) в поле **Webhook** , если его необходимо вызывать при срабатывании оповещения.
9. Завершив настройку, нажмите кнопку **ОК** , чтобы создать оповещение.   

Через несколько минут оповещение включится и будет активироваться, как было описано выше.

## <a name="managing-your-alerts"></a>Управление оповещениями
После создания оповещение можно выбрать и:

* просмотреть диаграмму, отображающую пороговое и фактические значения метрики за предыдущий день;
* изменить или удалить его;
* **отключить** или **включить** его, если нужно временно остановить или возобновить получение уведомлений для данного оповещения.


## <a name="sql-database-alert-values"></a>Значения оповещений базы данных SQL

| Тип ресурсов | Имя метрики | Понятное имя | Тип статистической обработки | Минимальный интервал времени для оповещений|
| --- | --- | --- | --- | --- |
| база данных SQL | cpu_percent | Процент ЦП | Average | 5 мин |
| база данных SQL | physical_data_read_percent | Процент операций ввода-вывода данных | Average | 5 мин |
| база данных SQL | log_write_percent | Процент операций ввода-вывода журнала | Average | 5 мин |
| база данных SQL | dtu_consumption_percent | Процент DTU | Average | 5 мин |
| база данных SQL | storage | Total database size | Максимум | 30 минут |
| база данных SQL | connection_successful | Успешные подключения | Всего | 10 минут |
| база данных SQL | connection_failed | Неудачные подключения | Всего | 10 минут |
| база данных SQL | blocked_by_firewall | Заблокировано брандмауэром | Всего | 10 минут |
| база данных SQL | deadlock | Взаимоблокировки | Всего | 10 минут |
| база данных SQL | storage_percent | Размер базы данных в процентах | Максимум | 30 минут |
| база данных SQL | xtp_storage_percent | In-Memory OLTP storage percent (Preview) | Average | 5 мин |
| база данных SQL | workers_percent | Процент рабочих ролей | Average | 5 мин |
| база данных SQL | sessions_percent | Sessions percent | Average | 5 мин |
| База данных SQL | dtu_limit | DTU limit | Average | 5 мин |
| база данных SQL | dtu_used | DTU used | Average | 5 минут |
||||||
| Эластичный пул | cpu_percent | Процент ЦП | Average | 10 минут |
| Эластичный пул | physical_data_read_percent | Процент операций ввода-вывода данных | Average | 10 минут |
| Эластичный пул | log_write_percent | Процент операций ввода-вывода журнала | Average | 10 минут |
| Эластичный пул | dtu_consumption_percent | Процент DTU | Average | 10 минут |
| Эластичный пул | storage_percent | Storage percentage | Average | 10 минут |
| Эластичный пул | workers_percent | Процент рабочих ролей | Average | 10 минут |
| Эластичный пул | eDTU_limit | eDTU limit | Average | 10 минут |
| Эластичный пул | storage_limit | Storage limit | Average | 10 минут |
| Эластичный пул | eDTU_used | eDTU used | Average | 10 минут |
| Эластичный пул | storage_used | Используемое хранилище | Average | 10 минут |
||||||               
| хранилище данных SQL | cpu_percent | Процент ЦП | Average | 10 минут |
| хранилище данных SQL | physical_data_read_percent | Процент операций ввода-вывода данных | Average | 10 минут |
| Хранилище данных SQL | connection_successful | Успешные подключения | Всего | 10 минут |
| хранилище данных SQL | connection_failed | Неудачные подключения | Всего | 10 минут |
| хранилище данных SQL | blocked_by_firewall | Заблокировано брандмауэром | Всего | 10 минут |
| хранилище данных SQL | service_level_objective | Уровень служб базы данных | Всего | 10 минут |
| хранилище данных SQL | dwu_limit | Лимит DWU. | Максимум | 10 минут |
| хранилище данных SQL | dwu_consumption_percent | DWU percentage | Average | 10 минут |
| хранилище данных SQL | dwu_used | DWU used | Average | 10 минут |
||||||


## <a name="next-steps"></a>Следующие шаги
* [Ознакомьтесь с общими сведениями о мониторинге Azure](../monitoring-and-diagnostics/monitoring-overview.md) , включая типы информации, которую можно собирать и отслеживать.
* Узнайте больше о [настройке веб-перехватчиков webhook в оповещениях](../azure-monitor/platform/alerts-webhooks.md).
* Ознакомьтесь с [обзором журналов диагностики](../azure-monitor/platform/diagnostic-logs-overview.md) , чтобы собирать подробные метрики о службе с высокой частотой.
* Прочитайте [обзор сбора метрики](../monitoring-and-diagnostics/insights-how-to-customize-monitoring.md) и узнайте, как можно обеспечить, чтобы служба была доступна и отвечала на запросы.
