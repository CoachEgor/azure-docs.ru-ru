---
title: Ведение журналов метрик и диагностики Базы данных SQL Azure | Документация Майкрософт
description: Узнайте, как включить диагностику в базе данных SQL Azure для хранения сведений об использовании ресурсов и статистику выполнения запросов.
services: sql-database
ms.service: sql-database
ms.subservice: monitor
ms.custom: seoapril2019
ms.devlang: ''
ms.topic: conceptual
author: danimir
ms.author: danil
ms.reviewer: jrasnik, carlrab
manager: craigg
ms.date: 05/21/2019
ms.openlocfilehash: 6824a7151a0c007d6fe4ba021f274886a3cf0dcb
ms.sourcegitcommit: f56b267b11f23ac8f6284bb662b38c7a8336e99b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/28/2019
ms.locfileid: "67447824"
---
# <a name="azure-sql-database-metrics-and-diagnostics-logging"></a>Метрики и журналы диагностики Базы данных SQL Azure

В этом разделе вы узнаете, как настроить ведение журнала диагностики телеметрии для базы данных SQL Azure через портал Azure, PowerShell, Azure CLI, Azure Monitor REST API и шаблона Azure Resource Manager. Эти диагностические можно использовать для оценки использования ресурсов и статистику выполнения запросов.

Отдельные базы данных, базы данных в эластичных пулах, базы данных экземпляра в управляемом экземпляре могут передавать потоки метрик и журналов диагностики для упрощения мониторинга производительности. Вы можете настроить базу данных для передачи сведений об использовании ресурсов, о рабочих ролях и сеансах, а также настроить подключение к одному из следующих ресурсов Azure:

- **Аналитика SQL Azure:** для интеллектуального мониторинга Баз данных SQL Azure, который включает в себя отчеты о производительности, оповещения и рекомендации по устранению рисков.
- **Центры событий Azure:** для интеграции данных телеметрии Базы данных SQL с настраиваемыми решениями для мониторинга или горячими конвейерами.
- **Служба хранилища Azure:** для архивации больших объемов данных телеметрии по сниженной цене.

    ![Архитектура](./media/sql-database-metrics-diag-logging/architecture.png)

Дополнительные сведения о метриках и категориях журналов, поддерживаемых различными службами Azure, см. в следующих статьях:

- [Обзор метрик в Microsoft Azure](../monitoring-and-diagnostics/monitoring-overview-metrics.md)
- [Обзор журналов Диагностики Azure](../azure-monitor/platform/diagnostic-logs-overview.md)

В этой статье приведены рекомендации, которые помогут включить диагностическую телеметрию для баз данных SQL Azure, эластичных пулов и управляемых экземпляров. Из статьи вы узнаете, как настроить Аналитику SQL Azure в качестве инструмента мониторинга для просмотра диагностических данных телеметрии базы данных.

## <a name="enable-logging-of-diagnostics-telemetry"></a>Включение ведения журнала диагностических данных телеметрии

Можно включить ведение таких журналов метрик и диагностической телеметрии и управлять ими, используя один из следующих методов:

- Портал Azure
- PowerShell
- Azure CLI
- REST API Azure Monitor
- Шаблон Azure Resource Manager

При включении метрик и ведения журнала диагностики, необходимо указать путь назначения ресурсов Azure, для сбора данных телеметрии системы диагностики. Доступны следующие варианты:

- Azure SQL Analytics
- Центры событий Azure
- Хранилище Azure

Вы можете подготовить новый ресурс Azure или выбрать имеющийся. После выбора ресурса с помощью настройки **Параметры диагностики** укажите, какие данные следует собирать.

## <a name="supported-diagnostic-logging-for-azure-sql-databases-and-instance-databases"></a>Поддерживается ведение журнала диагностики для баз данных Azure SQL и базы данных экземпляра

Включите ведение журналов метрик и диагностики в базе данных SQL. Они не включены по умолчанию.

Можно настроить Azure SQL и экземпляр базы данных для сбора следующие данные телеметрии диагностики:

| Мониторинг телеметрии для баз данных | Поддержка отдельной базы данных и базы данных в пуле | Поддержка баз данных экземпляра |
| :------------------- | ----- | ----- |
| [Базовые метрики](#basic-metrics): Сведения о проценте использования DTU и ЦП, ограничении DTU и ЦП, проценте чтения физических данных, проценте записей в журнал, проценте успешных, неудачных или заблокированных подключений брандмауэра, проценте сеансов, проценте рабочих ролей, хранилище, проценте хранилища и проценте хранилища XTP. | Yes | Нет |
| [QueryStoreRuntimeStatistics.](#query-store-runtime-statistics) Сведения о статистике выполнения запросов, такие как данные об использовании ЦП и длительность запросов. | Yes | Yes |
| [QueryStoreWaitStatistics.](#query-store-wait-statistics) Содержит сведения о статистике ожидания запросов (что ожидали запросы) например, ЦП, ЖУРНАЛ и БЛОКИРОВКУ. | Yes | Yes |
| [Ошибки.](#errors-dataset) Содержит сведения об ошибках SQL в базе данных. | Yes | Yes |
| [DatabaseWaitStatistics.](#database-wait-statistics-dataset) Содержит сведения о времени, в базу данных, потраченное на ожидание ожидания различных типов. | Yes | Нет |
| [Время ожидания.](#time-outs-dataset) Содержит сведения о времени ожидания в базе данных. | Yes | Нет |
| [Блоки.](#blockings-dataset) Содержит сведения о блокирующих событиях в базе данных. | Yes | Нет |
| [Взаимоблокировки](#deadlocks-dataset): Содержит сведения о событиях взаимоблокировки в базе данных. | Yes | Нет |
| [AutomaticTuning](#automatic-tuning-dataset): Содержит сведения о рекомендаций по автоматической настройке для базы данных. | Yes | Нет |
| [SQLInsights.](#intelligent-insights-dataset) Содержит Intelligent Insights в производительности для базы данных. Дополнительные сведения см. в статье об [Intelligent Insights](sql-database-intelligent-insights.md). | Yes | Yes |

> [!IMPORTANT]
> Пулы эластичных баз данных и управляемых экземпляров имеют свои собственные данные телеметрии диагностикой из баз данных, которые они содержат. Это важно отметить как данные телеметрии диагностики настраивается отдельно для каждого из этих ресурсов, как описано ниже.

> [!NOTE]
> Журналы аудита и безопасности SQLSecurityAuditEvents нельзя включить в параметрах диагностики базы данных (несмотря на то, что отображается на экране). Чтобы включить потоковую передачу журнала аудита, см. в разделе [Настройка аудита базы данных](sql-database-auditing.md#subheading-2), и [журналы в журналах Azure Monitor и концентраторов событий аудита](https://techcommunity.microsoft.com/t5/Azure-SQL-Database/SQL-Audit-logs-in-Azure-Log-Analytics-and-Azure-Event-Hubs/ba-p/386242).

## <a name="azure-portal"></a>Портал Azure

Можно использовать **параметры диагностики** меню для каждого единый пул, или экземпляре базы данных на портале Azure, чтобы настроить потоковую передачу данных телеметрии системы диагностики. Кроме того, телеметрия диагностики можно также настроить по отдельности для базы данных контейнеров: пулы эластичных баз данных и управляемых экземпляров. Можно задать следующие расположения для потоковой передачи данных телеметрии диагностики: Журналы Azure хранения, концентраторы событий Azure и Azure Monitor.

### <a name="configure-streaming-of-diagnostics-telemetry-for-elastic-pools"></a>Настройка потоковой передачи диагностических данных телеметрии для эластичных пулов

   ![Значок эластичного пула](./media/sql-database-metrics-diag-logging/icon-elastic-pool-text.png)

Вы можете настроить ресурс эластичного пула для сбора следующих диагностических данных телеметрии:

| Ресурс | Мониторинг телеметрии |
| :------------------- | ------------------- |
| **Эластичный пул** | [Базовые метрики](sql-database-metrics-diag-logging.md#basic-metrics) содержит процент eDTU/ЦП, ограничение eDTU/ЦП, физических данных чтения в процентах, журнала и записи в процентах, проценте сеансов, проценте рабочих ролей, хранилище, проценте хранилища, ограничение хранилища и проценте хранилища XTP. |

Чтобы настроить потоковую передачу данных телеметрии системы диагностики для эластичных пулов и баз данных в эластичных пулах, необходимо отдельно настроить **оба** из следующих:

- Включение потоковой передачи данных телеметрии системы диагностики для эластичного пула, **и**
- Включение потоковой передачи данных телеметрии системы диагностики для каждой базы данных в эластичном пуле

Это обусловлено эластичный пул — это контейнер базы данных с помощью свои собственные данные телеметрии, отдельно от отдельной базы данных телеметрии.

Чтобы включить потоковую передачу диагностических данных телеметрии для ресурса эластичного пула, выполните следующие действия:

1. Перейдите к **эластичного пула** ресурсов на портале Azure.
1. Выберите **Параметры диагностики**.
1. Выберите **Включить диагностику**, если предыдущие параметры отсутствуют, или **Настройка параметра**, чтобы изменить предыдущий параметр.

   ![Включение диагностики для эластичных пулов](./media/sql-database-metrics-diag-logging/diagnostics-settings-container-elasticpool-enable.png)

1. Введите имя настройки для вашей собственной ссылки.
1. Выберите целевой ресурс для потоковой передачи диагностических данных: **Архивировать в учетной записи хранения**, **Передать в концентратор событий** или **Отправить в Log Analytics**.
1. Для log analytics, выберите **Настройка** и создать рабочую область, выбрав **+ создать новую рабочую область**, или выберите существующую рабочую область.
1. Установите флажок для диагностических данных телеметрии эластичного пула: **Основные** метрики.
   ![Настройка диагностики для эластичных пулов](./media/sql-database-metrics-diag-logging/diagnostics-settings-container-elasticpool-selection.png)
1. Щелкните **Сохранить**.
1. Кроме того настройте потоковую передачу данных телеметрии системы диагностики для каждой базы данных в эластичном пуле, который вы хотите отслеживать, выполнив шаги, описанные в следующем разделе.

> [!IMPORTANT]
> В дополнение к настройке телеметрии диагностики для эластичного пула, необходимо также настроить данные телеметрии диагностики для каждой базы данных в эластичном пуле, как описано ниже.

### <a name="configure-streaming-of-diagnostics-telemetry-for-single-database-or-database-in-elastic-pool"></a>Настроить потоковую передачу данных телеметрии системы диагностики для отдельной базы данных или базы данных в эластичном пуле

   ![Значок Базы данных SQL](./media/sql-database-metrics-diag-logging/icon-sql-database-text.png)

Чтобы включить потоковую передачу данных телеметрии системы диагностики для одной или в составе пула баз данных, выполните следующие действия:

1. Перейдите в Azure **базы данных SQL** ресурсов.
1. Выберите **Параметры диагностики**.
1. Выберите **Включить диагностику**, если предыдущие параметры отсутствуют, или **Настройка параметра**, чтобы изменить предыдущий параметр.
   - Можно создать до трех параллельных соединений для потоковой передачи диагностических данных телеметрии.
   - Выберите **+Add diagnostic setting** (+ Добавить параметр диагностики), чтобы настроить параллельную потоковую передачу данных диагностики на несколько ресурсов.

   ![Включение диагностики для отдельных баз данных, баз данных в пуле или баз данных экземпляров](./media/sql-database-metrics-diag-logging/diagnostics-settings-database-sql-enable.png)
1. Введите имя настройки для вашей собственной ссылки.
1. Выберите целевой ресурс для потоковой передачи диагностических данных: **Архивировать в учетной записи хранения**, **Передать в концентратор событий** или **Отправить в Log Analytics**.
1. Для стандартного мониторинга на основе событий установите следующие флажки для данных телеметрии журнала диагностики базы данных: **SQLInsights**, **AutomaticTuning**, **QueryStoreRuntimeStatistics**, **QueryStoreWaitStatistics**, **Errors**, **DatabaseWaitStatistics**, **Timeouts**, **Blocks** и **Deadlocks**.
1. Дополнительные сведения о расширенной, единицы минуту мониторинга, установите флажок для **основные** метрики.
   ![Настройка диагностики для одной, в составе пула или экземпляре базы данных](./media/sql-database-metrics-diag-logging/diagnostics-settings-database-sql-selection.png)
1. Щелкните **Сохранить**.
1. Повторите эти шаги для каждой базы данных, которые вы хотите отслеживать.

> [!NOTE]
> Журналы аудита и безопасности SQLSecurityAuditEvents нельзя включить в параметрах диагностики базы данных (несмотря на то, что показано на экране). Чтобы включить потоковую передачу журнала аудита, см. в разделе [Настройка аудита базы данных](sql-database-auditing.md#subheading-2), и [журналы в журналах Azure Monitor и концентраторов событий аудита](https://techcommunity.microsoft.com/t5/Azure-SQL-Database/SQL-Audit-logs-in-Azure-Log-Analytics-and-Azure-Event-Hubs/ba-p/386242).
> [!TIP]
> Повторите эти шаги для каждой базы данных SQL Azure, которую вы хотите отслеживать.

### <a name="configure-streaming-of-diagnostics-telemetry-for-managed-instances"></a>Настройка потоковой передачи диагностических данных телеметрии для управляемого экземпляра

   ![Значок управляемого экземпляра](./media/sql-database-metrics-diag-logging/icon-managed-instance-text.png)

Можно настроить ресурс управляемого экземпляра для сбора следующей диагностической телеметрии:

| Ресурс | Мониторинг телеметрии |
| :------------------- | ------------------- |
| **Управляемый экземпляр** | [ResourceUsageStats](#resource-usage-stats-for-managed-instance) содержит количество виртуальных ядер, средний процент использования ЦП, а также сведения о запросах ввода-вывода, прочитанных и записанных байтах, зарезервированном и используемом дисковом пространстве. |

Чтобы настроить потоковую передачу данных телеметрии системы диагностики для управляемого экземпляра и базы данных экземпляра, необходимо отдельно настроить **оба** из следующих:

- Включение потоковой передачи данных телеметрии системы диагностики для управляемого экземпляра **и**
- Включение потоковой передачи данных телеметрии системы диагностики для каждой базы данных экземпляра

Это обусловлено управляемый экземпляр — это контейнер базы данных с помощью его собственной телеметрии, отдельно от телеметрии отдельный экземпляр базы данных.

Чтобы включить потоковую передачу диагностических данных телеметрии для ресурса управляемого экземпляра, сделайте следующее:

1. Перейдите к **управляемый экземпляр** ресурсов на портале Azure.
1. Выберите **Параметры диагностики**.
1. Выберите **Включить диагностику**, если предыдущие параметры отсутствуют, или **Настройка параметра**, чтобы изменить предыдущий параметр.

   ![Включение диагностики для управляемого экземпляра](./media/sql-database-metrics-diag-logging/diagnostics-settings-container-mi-enable.png)

1. Введите имя настройки для вашей собственной ссылки.
1. Выберите целевой ресурс для потоковой передачи диагностических данных: **Архивировать в учетной записи хранения**, **Передать в концентратор событий** или **Отправить в Log Analytics**.
1. Для log analytics, выберите **Настройка** и создать рабочую область, выбрав **+ создать новую рабочую область**, или использовать существующую рабочую область.
1. Установите флажок для диагностических данных телеметрии экземпляра: **ResourceUsageStats**.
   ![Настройка диагностики для управляемого экземпляра](./media/sql-database-metrics-diag-logging/diagnostics-settings-container-mi-selection.png)
1. Щелкните **Сохранить**.
1. Кроме того настройте потоковую передачу данных телеметрии системы диагностики для каждой базы данных экземпляра в управляемый экземпляр, который вы хотите отслеживать, выполнив действия, описанные в следующем разделе.

> [!IMPORTANT]
> В дополнение к настройке телеметрии диагностики для управляемого экземпляра, также необходимо настроить данные телеметрии диагностики для каждой базы данных экземпляра, как описано ниже.

### <a name="configure-streaming-of-diagnostics-telemetry-for-instance-databases"></a>Настроить потоковую передачу данных телеметрии системы диагностики для экземпляра базы данных

   ![Значок базы данных экземпляра в управляемом экземпляре](./media/sql-database-metrics-diag-logging/icon-mi-database-text.png)

Чтобы включить потоковую передачу данных телеметрии системы диагностики для экземпляра базы данных, выполните следующие действия:

1. Перейдите к **базы данных экземпляра** ресурса в управляемый экземпляр.
1. Выберите **Параметры диагностики**.
1. Выберите **Включить диагностику**, если предыдущие параметры отсутствуют, или **Настройка параметра**, чтобы изменить предыдущий параметр.
   - Вы можете создать до трех (3) параллельных соединений для потоковой передачи диагностических данных телеметрии.
   - Выберите **+Add diagnostic setting** (+ Добавить параметр диагностики), чтобы настроить параллельную потоковую передачу данных диагностики на несколько ресурсов.

   ![Включение диагностики для баз данных экземпляров](./media/sql-database-metrics-diag-logging/diagnostics-settings-database-mi-enable.png)

1. Введите имя настройки для вашей собственной ссылки.
1. Выберите целевой ресурс для потоковой передачи диагностических данных: **Архивировать в учетной записи хранения**, **Передать в концентратор событий** или **Отправить в Log Analytics**.
1. Установите флажки для телеметрии диагностики базы данных: **SQLInsights**, **QueryStoreRuntimeStatistics**, **QueryStoreWaitStatistics** и **Ошибки**.
   ![Настройка диагностики для экземпляра базы данных](./media/sql-database-metrics-diag-logging/diagnostics-settings-database-mi-selection.png)
1. Щелкните **Сохранить**.
1. Повторите эти шаги для каждого экземпляра базы данных, которые вы хотите отслеживать.

> [!TIP]
> Повторите эти шаги для каждого экземпляра базы данных, которые вы хотите отслеживать.

### <a name="powershell"></a>PowerShell

[!INCLUDE [updated-for-az](../../includes/updated-for-az.md)]
> [!IMPORTANT]
> Модуль PowerShell Azure Resource Manager по-прежнему поддерживается базой данных SQL Azure, но все будущие разработки — для модуля Az.Sql. Для этих командлетов см. в разделе [AzureRM.Sql](https://docs.microsoft.com/powershell/module/AzureRM.Sql/). Аргументы для команд в модуле Az и в модуле AzureRm практически идентичны.

Включить ведение журналов метрик и диагностики можно с помощью PowerShell.

- Выполните приведенную ниже команду, чтобы включить отправку журналов диагностики в учетную запись хранения:

   ```powershell
   Set-AzDiagnosticSetting -ResourceId [your resource id] -StorageAccountId [your storage account id] -Enabled $true
   ```

   Идентификатор учетной записи хранения представляет собой идентификатор ресурса целевой учетной записи хранения.

- Чтобы включить потоковую передачу журналов диагностики в концентратор событий, используйте следующую команду:

   ```powershell
   Set-AzDiagnosticSetting -ResourceId [your resource id] -ServiceBusRuleId [your service bus rule id] -Enabled $true
   ```

   Идентификатор правила служебной шины Azure — это строка в формате:

   ```powershell
   {service bus resource ID}/authorizationrules/{key name}
   ```

- Чтобы включить отправку журналов диагностики в рабочую область Log Analytics, используйте следующую команду:

   ```powershell
   Set-AzDiagnosticSetting -ResourceId [your resource id] -WorkspaceId [resource id of the log analytics workspace] -Enabled $true
   ```

- Идентификатор ресурса рабочей области Log Analytics можно получить с помощью следующей команды:

   ```powershell
   (Get-AzOperationalInsightsWorkspace).ResourceId
   ```

Можно объединять эти параметры, чтобы получить несколько вариантов вывода.

### <a name="to-configure-multiple-azure-resources"></a>Настройка нескольких ресурсов Azure

Чтобы обеспечить поддержку нескольких подписок, используйте сценарий PowerShell. Дополнительные сведения см. в статье [Enable Azure resource metrics logging using PowerShell](https://blogs.technet.microsoft.com/msoms/20../../enable-azure-resource-metrics-logging-using-powershell/) (Включение ведения журнала метрик ресурсов Azure с помощью PowerShell).

Укажите идентификатор ресурса рабочей области \<$WSID\> в качестве параметра при выполнении скрипта `Enable-AzureRMDiagnostics.ps1` для отправки данных диагностики из нескольких ресурсов в рабочую область.

- Чтобы получить идентификатор рабочей области \<$WSID\> места назначения для ваших диагностических данных, используйте следующий сценарий:

    ```powershell
    PS C:\> $WSID = "/subscriptions/<subID>/resourcegroups/<RG_NAME>/providers/microsoft.operationalinsights/workspaces/<WS_NAME>"
    PS C:\> .\Enable-AzureRMDiagnostics.ps1 -WSID $WSID
    ```

   Замените \<subID\> идентификатором подписки, \<RG_NAME\> именем группы ресурсов, а \<WS_NAME\> — именем рабочей области.

### <a name="azure-cli"></a>Инфраструктура CLI Azure

Можно включить ведение журналов метрик и диагностики с помощью Azure CLI.

> [!NOTE]
> Скрипты для включения ведения журнала диагностики поддерживаются для интерфейса командной строки Azure версии 1.0. Обратите внимание на то, что в настоящее время версии CLI 2.0 не поддерживается.

- Выполните приведенную ниже команду, чтобы включить отправку журналов диагностики в учетную запись хранения:

   ```azurecli-interactive
   azure insights diagnostic set --resourceId <resourceId> --storageId <storageAccountId> --enabled true
   ```

   Идентификатор учетной записи хранения представляет собой идентификатор ресурса целевой учетной записи хранения.

- Чтобы включить потоковую передачу журналов диагностики в концентратор событий, используйте следующую команду:

   ```azurecli-interactive
   azure insights diagnostic set --resourceId <resourceId> --serviceBusRuleId <serviceBusRuleId> --enabled true
   ```

   Идентификатор правила служебной шины — это строка в формате:

   ```azurecli-interactive
   {service bus resource ID}/authorizationrules/{key name}
   ```

- Чтобы включить отправку журналов диагностики в рабочую область Log Analytics, используйте следующую команду:

   ```azurecli-interactive
   azure insights diagnostic set --resourceId <resourceId> --workspaceId <resource id of the log analytics workspace> --enabled true
   ```

Можно объединять эти параметры, чтобы получить несколько вариантов вывода.

### <a name="rest-api"></a>REST API

Сведения об изменении параметров диагностики с помощью REST API Azure Monitor см. в [этом документе](https://docs.microsoft.com/rest/api/monitor/diagnosticsettings).

### <a name="resource-manager-template"></a>Шаблон Resource Manager

Сведения о включении параметров диагностики при создании ресурса из шаблона Resource Manager см. [здесь](../azure-monitor/platform/diagnostic-logs-stream-template.md).

## <a name="stream-into-azure-sql-analytics"></a>Потоковая передача данных в службу Аналитика SQL Azure

Аналитика SQL Azure — это облачное решение, которое отслеживает производительность баз данных SQL Azure, эластичных пулов и управляемого экземпляра в нужном масштабе и в нескольких подписках. Решение поможет собирать и визуализировать показатели производительности Базы данных SQL Azure, а также обладает встроенными интеллектуальными возможностями для устранения неполадок производительности.

![Обзор службы "Аналитика SQL Azure"](../azure-monitor/insights/media/azure-sql/azure-sql-sol-overview.png)

Журналы метрик и диагностики Базы данных SQL можно передать в службу "Аналитика SQL Azure" с помощью встроенной функции **Отправить в Log Analytics** на вкладке настроек диагностики на портале. Кроме того, вы можете включить log analytics с помощью параметра диагностики через командлеты PowerShell, Azure CLI или Azure Monitor REST API.

### <a name="installation-overview"></a>Обзор установки

Можно контролировать парк Баз данных SQL Azure с помощью службы "Аналитика SQL Azure". Выполните следующие действия:

1. Создайте решение "Аналитика SQL Azure" из Azure Marketplace.
2. Создайте рабочую область мониторинга в решении.
3. Настройте базы данных для потоковой передачи диагностических данных телеметрии в рабочую область.

Если вы используете эластичные пулы или управляемые экземпляры, вам также необходимо настроить потоковую передачу диагностических данных телеметрии из этих ресурсов.

### <a name="create-azure-sql-analytics-resource"></a>Создание ресурса Аналитика SQL Azure

1. Выполните поиск по запросу "Аналитика SQL Azure" в Azure Marketplace и выберите найденное решение.

   ![Поиск службы Аналитика SQL Azure на портале](./media/sql-database-metrics-diag-logging/sql-analytics-in-marketplace.png)

2. Выберите **Создать** на экране обзора решения.

3. В форме "Аналитика SQL Azure" введите необходимые дополнительные сведения: имя рабочей области, подписку, группу ресурсов, расположение и ценовую категорию.

   ![Настройка службы "Аналитика SQL Azure" на портале](./media/sql-database-metrics-diag-logging/sql-analytics-configuration-blade.png)

4. Нажмите **ОК** для подтверждения, а затем выберите **Создать**.

### <a name="configure-databases-to-record-metrics-and-diagnostics-logs"></a>Настройка баз данных для записи метрик и журналов диагностики

Самый простой способ настроить, где базы данных будут записывать метрики — с помощью портала Azure. Как описано выше, перейдите к ресурсу Базы данных SQL на портале Azure и выберите **Параметры диагностики**.

Если вы используете эластичные пулы или управляемый экземпляр, необходимо также настроить параметры диагностики в этих ресурсах, чтобы диагностические данные телеметрии могли передаваться в рабочую область.

### <a name="use-the-sql-analytics-solution"></a>Использование решения "Аналитика SQL"

Аналитику SQL можно использовать в качестве иерархической панели мониторинга для просмотра ресурсов Базы данных SQL. Дополнительные сведения об использовании решения "Аналитика SQL" см. в статье [Мониторинг Базы данных SQL Azure с помощью служб анализа SQL Azure (предварительная версия) в Log Analytics](../log-analytics/log-analytics-azure-sql.md).

## <a name="stream-into-event-hubs"></a>Потоковая передача в Центры событий

Можно передавать потоки метрик и журналов диагностики Базы данных SQL в концентраторы событий с помощью встроенного параметра **Передать в концентратор событий** на портале Azure. Можно также включить идентификатор правила служебной шины с помощью параметра диагностики через командлеты PowerShell, Azure CLI или Azure Monitor REST API.

### <a name="what-to-do-with-metrics-and-diagnostics-logs-in-event-hubs"></a>Что делать с журналами метрик и диагностики в Центрах событий

Выполнив потоковую передачу выбранных данных в Центры событий, вы становитесь на один шаг ближе к включению дополнительных сценариев мониторинга. Центры событий выступают в качестве "двери" для конвейера событий. После сбора данных в концентраторе событий их можно преобразовывать и сохранять с помощью поставщика аналитики в реальном времени или адаптера хранения. Центры событий отделяют производство потока событий от потребления этих событий. Таким образом потребители событий могут получать доступ к событиям по собственному расписанию. Дополнительные сведения о Центрах событий см. в следующих статьях:

- [Что такое Центры событий?](../event-hubs/event-hubs-what-is-event-hubs.md)
- [Начало работы с Центрами событий](../event-hubs/event-hubs-csharp-ephcs-getstarted.md)

Потоковые метрики в Центрах событий можно использовать для следующих целей:

- **Проверка работоспособности службы путем потоковой передачи данных критического пути в Power BI**. С помощью Центров событий, Stream Analytics и Power BI можно в близком к реальному времени получать аналитическую информацию о службах Azure на основе метрик и диагностических данных. Обзор настройки концентраторов событий, обработки данных в Stream Analytics и вывода информации через Power BI см. в статье [Stream Analytics и Power BI. Панель мониторинга для анализа потоковой передачи данных](../stream-analytics/stream-analytics-power-bi-dashboard.md).

- **Потоковая передача журналов в сторонние потоки ведения журналов и сбора телеметрии.** С помощью потоковой передачи Центров событий вы можете передать журналы метрик и диагностики в различные решения мониторинга и решения для анализа журналов.

- **Создание пользовательской платформы для телеметрии и ведения журнала**. У вас уже есть платформа телеметрии, созданная на заказ, или вы планируете ее создать? В Центрах событий реализованы возможности масштабирования, публикации и подписки. Решение обеспечивает гибкие функции приема журналов диагностики. Ознакомьтесь с [руководством Дэна Росановы (Dan Rosanova) по использованию Центров событий для глобальной платформы телеметрии](https://azure.microsoft.com/documentation/videos/build-2015-designing-and-sizing-a-global-scale-telemetry-platform-on-azure-event-Hubs/).

## <a name="stream-into-storage"></a>Потоковая передача в хранилище

Журналы метрик и диагностики Базы данных SQL можно хранить в службе хранилища Azure с помощью встроенной возможности **Архивировать в учетной записи хранения** на портале Azure. Хранилище также можно включить, воспользовавшись параметром диагностики с помощью командлетов PowerShell, Azure CLI или REST API Azure Monitor.

### <a name="schema-of-metrics-and-diagnostics-logs-in-the-storage-account"></a>Схема журналов метрик и диагностики в учетной записи хранения

После настройки сбора метрик и журналов диагностики в выбранной учетной записи хранения создается контейнер хранилища, как только первые строки данных станут доступными. Вот как выглядит структура большого двоичного объекта:

```powershell
insights-{metrics|logs}-{category name}/resourceId=/SUBSCRIPTIONS/{subscription ID}/ RESOURCEGROUPS/{resource group name}/PROVIDERS/Microsoft.SQL/servers/{resource_server}/ databases/{database_name}/y={four-digit numeric year}/m={two-digit numeric month}/d={two-digit numeric day}/h={two-digit 24-hour clock hour}/m=00/PT1H.json
```

Или даже еще проще:

```powershell
insights-{metrics|logs}-{category name}/resourceId=/{resource Id}/y={four-digit numeric year}/m={two-digit numeric month}/d={two-digit numeric day}/h={two-digit 24-hour clock hour}/m=00/PT1H.json
```

Например может быть имени большого двоичного объекта для основных метрик:

```powershell
insights-metrics-minute/resourceId=/SUBSCRIPTIONS/s1id1234-5679-0123-4567-890123456789/RESOURCEGROUPS/TESTRESOURCEGROUP/PROVIDERS/MICROSOFT.SQL/ servers/Server1/databases/database1/y=2016/m=08/d=22/h=18/m=00/PT1H.json
```

Имя BLOB-объекта для хранения данных из эластичного пула выглядит следующим образом:

```powershell
insights-{metrics|logs}-{category name}/resourceId=/SUBSCRIPTIONS/{subscription ID}/ RESOURCEGROUPS/{resource group name}/PROVIDERS/Microsoft.SQL/servers/{resource_server}/ elasticPools/{elastic_pool_name}/y={four-digit numeric year}/m={two-digit numeric month}/d={two-digit numeric day}/h={two-digit 24-hour clock hour}/m=00/PT1H.json
```

## <a name="data-retention-policy-and-pricing"></a>Политика хранения данных и цены

Если выбрать Центры событий или учетную запись хранения, можно указать политику хранения. Эта политика удаляет данные, которые хранятся дольше выбранного периода времени. При указании Log Analytics политика хранения определяется на основании выбранной ценовой категории. В этом случае предоставляемые бесплатные единицы приема данных позволяют выполнять бесплатный мониторинг нескольких баз данных каждый месяц. Любое потребление диагностических данных телеметрии в объеме свыше предоставляемых бесплатно единиц, может повлечь за собой затраты. Помните, что активные базы данных с более интенсивными рабочими нагрузками принимают больше данных, чем неактивные. Дополнительные сведения см. в разделе [цен на Log analytics](https://azure.microsoft.com/pricing/details/monitor/).

Если вы используете Аналитику SQL Azure, то можете отслеживать использование приема данных в решении, выбрав элемент **Рабочая область OMS** в меню навигации Аналитики SQL Azure, а затем выбрав **Потребление** и **Estimated Costs** (Оценка затрат).

## <a name="metrics-and-logs-available"></a>Доступные метрики и журналы

Мониторинг данные телеметрии, доступные для базы данных SQL Azure, эластичных пулов и управляемый экземпляр описана ниже. Собранных данных телеметрии мониторинга, внутри службы анализа SQL можно использовать для собственных пользовательских анализа и разработки приложений с помощью [запросов к журналу Azure Monitor](https://docs.microsoft.com/azure/log-analytics/query-language/get-started-queries) языка.

## <a name="basic-metrics"></a>Основные метрики

См. в следующих таблицах описаны базовые метрики по ресурсам.

> [!NOTE]
> Параметр базовые метрики называлось все метрики. Изменение, внесенное был только именования и не вносилось для метрик, зафиксированных. Это изменение было инициировано, чтобы получить общие сведения о дополнительных метрик категорий в будущем.

### <a name="basic-metrics-for-elastic-pools"></a>Основные метрики для эластичных пулов

|**Ресурс**|**Метрики**|
|---|---|
|Эластичный пул|Сведения о проценте использования DTU, используемых единицах DTU, ограничении DTU, проценте использования ЦП, проценте чтения физических данных, проценте записей в журнал, проценте сеансов, проценте рабочих ролей, хранилище, проценте хранилища, ограничении хранилища, проценте хранилища XTP. |

### <a name="basic-metrics-for-azure-sql-databases"></a>Основные метрики для баз данных SQL Azure

|**Ресурс**|**Метрики**|
|---|---|
|База данных SQL Azure|Сведения о проценте использования DTU, используемых единицах DTU, ограничении DTU, проценте использования ЦП, проценте чтения физических данных, проценте записей в журнал, проценте успешных, неудачных или заблокированных подключений брандмауэра, проценте сеансов, проценте рабочих ролей, хранилище, проценте хранилища, проценте хранилища XTP и взаимоблокировках. |

## <a name="basic-logs"></a>Базовых журналов

Дополнительные сведения доступны для всех журналов телеметрии см. в приведенных ниже таблицах. См. в разделе [поддерживается ведение журналов диагностики](#supported-diagnostic-logging-for-azure-sql-databases-and-instance-databases) для понять, какие журналы поддерживаются для flavor определенной базы данных — один, SQL Azure в пул, или экземпляре базы данных.

### <a name="resource-usage-stats-for-managed-instance"></a>Статистические данные по использованию ресурсов для управляемого экземпляра

|Свойство|ОПИСАНИЕ|
|---|---|
|TenantId|Идентификатор клиента |
|SourceSystem|Всегда: Таблицы Azure|
|TimeGenerated [UTC]|Метка времени, когда был записан журнал |
|type|Всегда: AzureDiagnostics |
|ResourceProvider|Имя поставщика ресурсов. Всегда: MICROSOFT.SQL |
|Категория|Имя категории. Всегда: ResourceUsageStats |
|Ресурс|Имя ресурса. |
|ResourceType|Имя типа ресурса. Всегда: MANAGEDINSTANCES |
|SubscriptionId|GUID подписки для базы данных |
|ResourceGroup|Имя группы ресурсов для базы данных |
|LogicalServerName_s|Имя управляемого экземпляра |
|ResourceId|Универсальный код ресурса (URI) |
|SKU_s|Номер SKU продукта управляемого экземпляра |
|virtual_core_count_s|Доступное количество виртуальных ядер |
|avg_cpu_percent_s|Average CPU percentage (Средний процент использования ЦП) |
|reserved_storage_mb_s|Зарезервированная емкость хранилища в управляемом экземпляре |
|storage_space_used_mb_s|Использованный объем хранилища в управляемом экземпляре |
|io_requests_s|Количество операций ввода-вывода |
|io_bytes_read_s|Количество считанных байтов операций ввода-вывода |
|io_bytes_written_s|Количество записанных байтов операций ввода-вывода |

### <a name="query-store-runtime-statistics"></a>Статистика среды выполнения хранилища запросов

|Свойство|ОПИСАНИЕ|
|---|---|
|TenantId|Идентификатор клиента |
|SourceSystem|Всегда: Таблицы Azure |
|TimeGenerated [UTC]|Метка времени, когда был записан журнал |
|type|Всегда: AzureDiagnostics |
|ResourceProvider|Имя поставщика ресурсов. Всегда: MICROSOFT.SQL |
|Категория|Имя категории. Всегда: QueryStoreRuntimeStatistics |
|OperationName|Имя операции. Всегда: QueryStoreRuntimeStatisticsEvent |
|Ресурс|Имя ресурса. |
|ResourceType|Имя типа ресурса. Всегда: SERVERS/DATABASES |
|SubscriptionId|GUID подписки для базы данных |
|ResourceGroup|Имя группы ресурсов для базы данных |
|LogicalServerName_s|Имя сервера для базы данных |
|ElasticPoolName_s|Имя эластичного пула для базы данных (при наличии) |
|DatabaseName_s|Имя базы данных. |
|ResourceId|Универсальный код ресурса (URI) |
|query_hash_s|Хэш запроса. |
|query_plan_hash_s|Хэш плана запроса. |
|statement_sql_handle_s|Дескриптор SQL инструкции. |
|interval_start_time_d|Начальное значение datetimeoffset интервала в тактах с 01.01.1900 |
|interval_end_time_d|Конечное значение datetimeoffset интервала в тактах с 01.01.1900 |
|logical_io_writes_d|Общее число логических операций записи ввода-вывода |
|max_logical_io_writes_d|Максимальное число логических операций записи ввода-вывода при выполнении каждого запроса |
|physical_io_reads_d|Общее число физических операций чтения ввода-вывода |
|max_physical_io_reads_d|Максимальное число логических операций чтения ввода-вывода при выполнении каждого запроса |
|logical_io_reads_d|Общее число логических операций чтения ввода-вывода |
|max_logical_io_reads_d|Максимальное число логических операций чтения ввода-вывода при выполнении каждого запроса |
|execution_type_d|Тип выполнения. |
|count_executions_d|Число выполнений запроса |
|cpu_time_d|Общее процессорное время, затраченное на выполнение запроса, в микросекундах |
|max_cpu_time_d|Максимальное потребление процессорного времени на выполнение одного запроса в микросекундах |
|dop_d|Сумма степеней параллелизма |
|max_dop_d|Максимальная степень параллелизма, используемая для выполнения одного запроса |
|rowcount_d|Общее число возвращаемых строк |
|max_rowcount_d|Максимальное число строк, возвращаемых при выполнении одного запроса |
|query_max_used_memory_d|Общий объем используемой памяти в килобайтах |
|max_query_max_used_memory_d|Максимальный объем памяти, используемой при выполнении одного запроса, в килобайтах |
|duration_d|Общее время выполнения запроса в миллисекундах |
|max_duration_d|Максимальное время выполнения одного запроса |
|num_physical_io_reads_d|Общее число физических операций чтения |
|max_num_physical_io_reads_d|Максимальное число физических операций чтения при выполнении каждого запроса |
|log_bytes_used_d|Общий объем записанного журнала в байтах |
|max_log_bytes_used_d|Максимальное число байтов журнала, используемых при выполнения каждого запроса |
|query_id_d|Идентификатор запроса в хранилище запросов |
|plan_id_d|Идентификатор плана в хранилище запросов |

[Дополнительные сведения о статистических данных среды выполнения хранилища запросов.](https://docs.microsoft.com/sql/relational-databases/system-catalog-views/sys-query-store-runtime-stats-transact-sql)

### <a name="query-store-wait-statistics"></a>Статистика времени ожидания хранилища запросов

|Свойство|ОПИСАНИЕ|
|---|---|
|TenantId|Идентификатор клиента |
|SourceSystem|Всегда: Таблицы Azure |
|TimeGenerated [UTC]|Метка времени, когда был записан журнал |
|type|Всегда: AzureDiagnostics |
|ResourceProvider|Имя поставщика ресурсов. Всегда: MICROSOFT.SQL |
|Категория|Имя категории. Всегда: QueryStoreWaitStatistics |
|OperationName|Имя операции. Всегда: QueryStoreWaitStatisticsEvent |
|Ресурс|Имя ресурса. |
|ResourceType|Имя типа ресурса. Всегда: SERVERS/DATABASES |
|SubscriptionId|GUID подписки для базы данных |
|ResourceGroup|Имя группы ресурсов для базы данных |
|LogicalServerName_s|Имя сервера для базы данных |
|ElasticPoolName_s|Имя эластичного пула для базы данных (при наличии) |
|DatabaseName_s|Имя базы данных. |
|ResourceId|Универсальный код ресурса (URI) |
|wait_category_s|Категория времени ожидания |
|is_parameterizable_s|Указывает, подлежит ли запрос параметризации |
|statement_type_s|Тип инструкции |
|statement_key_hash_s|Хэш ключа инструкции |
|exec_type_d|Типа выполнения. |
|total_query_wait_time_ms_d|Общее время ожидания запроса в определенной категории времени ожидания |
|max_query_wait_time_ms_d|Максимальное время ожидания запроса при отдельном выполнении в определенной категории времени ожидания. |
|query_param_type_d|0 |
|query_hash_s|Хэш запроса в хранилище запросов |
|query_plan_hash_s|Хэш плана запроса в хранилище запросов. |
|statement_sql_handle_s|Дескриптор инструкции в хранилище запросов. |
|interval_start_time_d|Начальное значение datetimeoffset интервала в тактах с 01.01.1900 |
|interval_end_time_d|Конечное значение datetimeoffset интервала в тактах с 01.01.1900 |
|count_executions_d|Количество выполнений запроса. |
|query_id_d|Идентификатор запроса в хранилище запросов |
|plan_id_d|Идентификатор плана в хранилище запросов |

Дополнительные сведения о [статистических данных времени ожидания хранилища запросов](https://docs.microsoft.com/sql/relational-databases/system-catalog-views/sys-query-store-wait-stats-transact-sql).

### <a name="errors-dataset"></a>Набор данных ошибок

|Свойство|ОПИСАНИЕ|
|---|---|
|TenantId|Идентификатор клиента |
|SourceSystem|Всегда: Таблицы Azure |
|TimeGenerated [UTC]|Метка времени, когда был записан журнал |
|type|Всегда: AzureDiagnostics |
|ResourceProvider|Имя поставщика ресурсов. Всегда: MICROSOFT.SQ |
|Категория|Имя категории. Всегда: Errors |
|OperationName|Имя операции. Всегда: ErrorEvent |
|Ресурс|Имя ресурса. |
|ResourceType|Имя типа ресурса. Всегда: SERVERS/DATABASES |
|SubscriptionId|GUID подписки для базы данных |
|ResourceGroup|Имя группы ресурсов для базы данных |
|LogicalServerName_s|Имя сервера для базы данных |
|ElasticPoolName_s|Имя эластичного пула для базы данных (при наличии) |
|DatabaseName_s|Имя базы данных. |
|ResourceId|Универсальный код ресурса (URI) |
|Сообщение|Сообщение об ошибке в виде обычного текста. |
|user_defined_b|Указывает, установлен ли бит ошибки пользователем. |
|error_number_d|Код ошибки |
|Уровень серьезности|Серьезность ошибки. |
|state_d|Состояние ошибки. |
|query_hash_s|Хэш запроса, завершившегося сбоем (при наличии) |
|query_plan_hash_s|Хэш плана запроса для запроса, завершившегося сбоем (при наличии) |

Дополнительные сведения о [сообщениях об ошибках SQL Server](https://msdn.microsoft.com/library/cc645603.aspx).

### <a name="database-wait-statistics-dataset"></a>Набор данных статистики времени ожидания базы данных

|Свойство|ОПИСАНИЕ|
|---|---|
|TenantId|Идентификатор клиента |
|SourceSystem|Всегда: Таблицы Azure |
|TimeGenerated [UTC]|Метка времени, когда был записан журнал |
|type|Всегда: AzureDiagnostics |
|ResourceProvider|Имя поставщика ресурсов. Всегда: MICROSOFT.SQL |
|Категория|Имя категории. Всегда: DatabaseWaitStatistics |
|OperationName|Имя операции. Всегда: DatabaseWaitStatisticsEvent |
|Ресурс|Имя ресурса. |
|ResourceType|Имя типа ресурса. Всегда: SERVERS/DATABASES |
|SubscriptionId|GUID подписки для базы данных |
|ResourceGroup|Имя группы ресурсов для базы данных |
|LogicalServerName_s|Имя сервера для базы данных |
|ElasticPoolName_s|Имя эластичного пула для базы данных (при наличии) |
|DatabaseName_s|Имя базы данных. |
|ResourceId|Универсальный код ресурса (URI) |
|wait_type_s|Имя типа времени ожидания. |
|start_utc_date_t [UTC]|Время начала измеренного периода |
|end_utc_date_t [UTC]|Время окончания измеренного периода |
|delta_max_wait_time_ms_d|Максимальное время ожидания при выполнении одного запроса. |
|delta_signal_wait_time_ms_d|Общее время ожидания сигнала |
|delta_wait_time_ms_d|Общее время ожидания в течение периода. |
|delta_waiting_tasks_count_d|Число ожидающих задач. |

Дополнительные сведения о [статистике времени ожидания базы данных](https://docs.microsoft.com/sql/relational-databases/system-dynamic-management-views/sys-dm-os-wait-stats-transact-sql).

### <a name="time-outs-dataset"></a>Набор данных времени ожидания

|Свойство|ОПИСАНИЕ|
|---|---|
|TenantId|Идентификатор клиента |
|SourceSystem|Всегда: Таблицы Azure |
|TimeGenerated [UTC]|Метка времени, когда был записан журнал |
|type|Всегда: AzureDiagnostics |
|ResourceProvider|Имя поставщика ресурсов. Всегда: MICROSOFT.SQL |
|Категория|Имя категории. Всегда: Время ожидания |
|OperationName|Имя операции. Всегда: TimeoutEvent |
|Ресурс|Имя ресурса. |
|ResourceType|Имя типа ресурса. Всегда: SERVERS/DATABASES |
|SubscriptionId|GUID подписки для базы данных |
|ResourceGroup|Имя группы ресурсов для базы данных |
|LogicalServerName_s|Имя сервера для базы данных |
|ElasticPoolName_s|Имя эластичного пула для базы данных (при наличии) |
|DatabaseName_s|Имя базы данных. |
|ResourceId|Универсальный код ресурса (URI) |
|error_state_d|Код состояния ошибки. |
|query_hash_s|Хэш запроса, если он доступен |
|query_plan_hash_s|Хэш плана запроса, если он доступен |

### <a name="blockings-dataset"></a>Набор данных блокировки

|Свойство|ОПИСАНИЕ|
|---|---|
|TenantId|Идентификатор клиента |
|SourceSystem|Всегда: Таблицы Azure |
|TimeGenerated [UTC]|Метка времени, когда был записан журнал |
|type|Всегда: AzureDiagnostics |
|ResourceProvider|Имя поставщика ресурсов. Всегда: MICROSOFT.SQL |
|Категория|Имя категории. Всегда: Блоки |
|OperationName|Имя операции. Всегда: BlockEvent |
|Ресурс|Имя ресурса. |
|ResourceType|Имя типа ресурса. Всегда: SERVERS/DATABASES |
|SubscriptionId|GUID подписки для базы данных |
|ResourceGroup|Имя группы ресурсов для базы данных |
|LogicalServerName_s|Имя сервера для базы данных |
|ElasticPoolName_s|Имя эластичного пула для базы данных (при наличии) |
|DatabaseName_s|Имя базы данных. |
|ResourceId|Универсальный код ресурса (URI) |
|lock_mode_s|Режим блокировки, используемый для запроса. |
|resource_owner_type_s|Владелец блокировки |
|blocked_process_filtered_s|Отчет о заблокированных процессах в формате XML |
|duration_d|Длительность блокировки в микросекундах |

### <a name="deadlocks-dataset"></a>Набор данных взаимоблокировки

|Свойство|ОПИСАНИЕ|
|---|---|
|TenantId|Идентификатор клиента |
|SourceSystem|Всегда: Таблицы Azure |
|TimeGenerated [UTC] |Метка времени, когда был записан журнал |
|type|Всегда: AzureDiagnostics |
|ResourceProvider|Имя поставщика ресурсов. Всегда: MICROSOFT.SQL |
|Категория|Имя категории. Всегда: Взаимоблокировки |
|OperationName|Имя операции. Всегда: DeadlockEvent |
|Ресурс|Имя ресурса. |
|ResourceType|Имя типа ресурса. Всегда: SERVERS/DATABASES |
|SubscriptionId|GUID подписки для базы данных |
|ResourceGroup|Имя группы ресурсов для базы данных |
|LogicalServerName_s|Имя сервера для базы данных |
|ElasticPoolName_s|Имя эластичного пула для базы данных (при наличии) |
|DatabaseName_s|Имя базы данных. |
|ResourceId|Универсальный код ресурса (URI) |
|deadlock_xml_s|Отчет о взаимоблокировке в формате XML |

### <a name="automatic-tuning-dataset"></a>Набор данных автоматической настройки

|Свойство|ОПИСАНИЕ|
|---|---|
|TenantId|Идентификатор клиента |
|SourceSystem|Всегда: Таблицы Azure |
|TimeGenerated [UTC]|Метка времени, когда был записан журнал |
|type|Всегда: AzureDiagnostics |
|ResourceProvider|Имя поставщика ресурсов. Всегда: MICROSOFT.SQL |
|Категория|Имя категории. Всегда: AutomaticTuning |
|Ресурс|Имя ресурса. |
|ResourceType|Имя типа ресурса. Всегда: SERVERS/DATABASES |
|SubscriptionId|GUID подписки для базы данных |
|ResourceGroup|Имя группы ресурсов для базы данных |
|LogicalServerName_s|Имя сервера для базы данных |
|LogicalDatabaseName_s|Имя базы данных. |
|ElasticPoolName_s|Имя эластичного пула для базы данных (при наличии) |
|DatabaseName_s|Имя базы данных. |
|ResourceId|Универсальный код ресурса (URI) |
|RecommendationHash_s|Уникальный хэш рекомендаций по автоматической настройке |
|OptionName_s|Операция автоматической настройки |
|Schema_s|Схема базы данных |
|Table_s|Затронутая таблица |
|IndexName_s|Имя индекса |
|IndexColumns_s|Имя столбца |
|IncludedColumns_s|Включенные столбцы |
|EstimatedImpact_s|Предполагаемое влияние JSON-файла рекомендаций по автоматической настройке |
|Event_s|Тип события автоматической настройки |
|Timestamp_t|Метка времени последнего обновления |

### <a name="intelligent-insights-dataset"></a>Набор данных Intelligent Insights

Дополнительные сведения о [формате журнала Intelligent Insights](sql-database-intelligent-insights-use-diagnostics-log.md).

## <a name="next-steps"></a>Дальнейшие действия

Чтобы научиться включать ведение журнала и узнать, какие метрики и категории журналов поддерживаются различными службами Azure, ознакомьтесь со следующими статьями:

- [Обзор метрик в Microsoft Azure](../monitoring-and-diagnostics/monitoring-overview-metrics.md)
- [Обзор журналов Диагностики Azure](../azure-monitor/platform/diagnostic-logs-overview.md)

Дополнительные сведения о Центрах событий см. в статье:

- [Что такое Центры событий Azure?](../event-hubs/event-hubs-what-is-event-hubs.md)
- [Начало работы с Центрами событий](../event-hubs/event-hubs-csharp-ephcs-getstarted.md)
