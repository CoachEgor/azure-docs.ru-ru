---
title: Бассейны инстанций (предварительный просмотр)
description: В этой статье описаны пулы экземпляров данных базы данных Azure S'L (предварительный просмотр).
services: sql-database
ms.service: sql-database
ms.subservice: managed-instance
ms.custom: ''
ms.devlang: ''
ms.topic: conceptual
author: bonova
ms.author: bonova
ms.reviewer: sstein, carlrab
ms.date: 09/05/2019
ms.openlocfilehash: 0938fbe94cb0d1e6dae3dcb84950a11f90dd9db8
ms.sourcegitcommit: 2d7910337e66bbf4bd8ad47390c625f13551510b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/08/2020
ms.locfileid: "80878159"
---
# <a name="what-are-sql-database-instance-pools-preview"></a>Что такое пулы экземпляров баз данных S'L (предварительный просмотр)?

Пулы экземпляров — это новый ресурс в базе данных Azure S'L, который обеспечивает удобный и экономичный способ переноса небольших экземпляров S'L в облако в масштабе.

Пулы ресурсов позволяют предварительно подготовить к работе вычислительные ресурсы в соответствии с общими требованиями к миграции. Вы можете развернуть несколько отдельных управляемых экземпляров до предварительно подготовленного уровня вычислений. Например, если вы предварительно предоставляете 8 vCores, вы можете развернуть два 2 экземпляра vCore и один 4 vCore, а затем перенести базы данных в эти экземпляры. До того, как доступны пулы экземпляров, меньшие и менее вычислительные нагрузки часто приходилось объединять в более крупный управляемый экземпляр при переходе в облако. Необходимость переноса групп баз данных в большой экземпляр обычно требует тщательного планирования емкости и управления ресурсами, дополнительных соображений безопасности и некоторых дополнительных работ по консолидации данных на уровне экземпляра.

Кроме того, пулы экземпляров поддерживают назаимную интеграцию VNet, чтобы можно было развернуть несколько пулов экземпляров и несколько отдельных экземпляров в одной подсети.


## <a name="key-capabilities-of-instance-pools"></a>Ключевые возможности пулов экземпляров

Бассейны инстанций предоставляют следующие преимущества:

1. Возможность размещения 2 экземпляров vCore. *Только для случаев в instance бассеинах . \**
2. Предсказуемое и быстрое время развертывания экземпляра (до 5 минут).
3. Минимальное распределение IP-адресов.

Следующая диаграмма иллюстрирует пул экземпляров с несколькими экземплярами, развернутыми в подсети виртуальной сети.

![экземпляр пула с несколькими экземплярами](./media/sql-database-instance-pools/instance-pools1.png)

Пулы экземпляров позволяют развертывать несколько экземпляров на одной виртуальной машине, где размер вычислений виртуальной машины основан на общем количестве vCores, выделенных для пула. Эта архитектура позволяет *разделить* виртуальную машину на несколько экземпляров, которые могут быть любым поддерживаемым размером, включая 2 vCores (2 экземпляра vCore доступны только для экземпляров в пулах).

Операции управления на экземплярах в пуле намного быстрее, как только пул изначально развернут. Эти операции быстрее, потому что развертывание или расширение [виртуального кластера](sql-database-managed-instance-connectivity-architecture.md#high-level-connectivity-architecture) (выделенный набор виртуальных машин) не является частью подготовки управляемого экземпляра.

Поскольку все экземпляры в пуле имеют одинаковую виртуальную машину, общее распределение IP не зависит от количества развернутых экземпляров, что удобно для развертывания в подсетях с узким диапазоном IP.

Каждый пул имеет фиксированное IP-распределение только девяти IP-адресов (не включая пять IP-адресов в подсети, которые зарезервированы для собственных нужд). Для получения подробной информации [см.](sql-database-managed-instance-determine-size-vnet-subnet.md)

## <a name="application-scenarios-for-instance-pools"></a>Сценарии применения, например пулы

В следующем перечне приводятся основные случаи использования, в которых следует учитывать пулы экземпляров:

- Миграция *группы экземпляров S'L* в то же время, где большинство меньшего размера (например, 2 или 4 vCores).
- Сценарии, в которых важно *предсказуемое и краткое создание или масштабирование экземпляров.* Например, развертывание нового клиента в среде приложений saaS с несколькими арендаторами, что требует возможностей уровня экземпляра.
- Сценарии, где наличие *фиксированной стоимости* или *лимита расходов* имеет важное значение. Например, запуск общих дев-тестов или демо-сред фиксированного (или нечасто меняющегося) размера, где при необходимости периодически развертываются управляемые экземпляры.
- Сценарии, где *минимальное распределение IP-адресов* в подсети VNet имеет важное значение. Все экземпляры в пуле совместно используют виртуальную машину, поэтому количество выделенных IP-адресов меньше, чем в случае отдельных экземпляров.


## <a name="architecture-of-instance-pools"></a>Архитектура бассейнов экземпляров

Пулы экземпляров имеют аналогичную архитектуру с обычными управляемыми экземплярами *(одиночные экземпляры).* Для [поддержки развертывания в виртуальных сетях Azure (VNets)](../virtual-network/virtual-network-for-azure-services.md) и обеспечения изоляции и безопасности для клиентов пулы экземпляров также полагаются на [виртуальные кластеры.](sql-database-managed-instance-connectivity-architecture.md#high-level-connectivity-architecture) Виртуальные кластеры представляют собой специальный набор изолированных виртуальных машин, развернутых внутри виртуальной сетевой подсети клиента.

Основное различие между двумя моделями развертывания заключается в том, что пулы экземпляров позволяют развертывать несколько процессов сервера S'L на одном виртуальном узле машины, которые управляются ресурсом с помощью [объектов работы Windows,](https://docs.microsoft.com/windows/desktop/ProcThread/job-objects)в то время как отдельные экземпляры всегда одни на виртуальном узлах машины.

На следующей диаграмме показан пул экземпляров и два отдельных экземпляра, развернутых в одной подсети, и иллюстрируются основные архитектурные детали для обеих моделей развертывания:

![экземпляр пула и два отдельных экземпляра](./media/sql-database-instance-pools/instance-pools2.png)

Каждый экземпляр пула создает отдельный виртуальный кластер внизу. Случаи в пуле и отдельные экземпляры, развернутые в одной подсети, не разделяют вычислительных ресурсов, выделенных на процессы сервера s и компоненты шлюза, что обеспечивает предсказуемость производительности.

## <a name="instance-pools-resource-limitations"></a>Резервобъединяет ресурсы

Относительно пулов экземпляров и экземпляров внутри пула действует несколько ограничений ресурсов.

- Пулы экземпляров доступны только на оборудовании Gen5.
- Инстанции в пуле имеют выделенный процессор и оперативную память, поэтому агрегированное количество vCores во всех экземплярах должно быть меньше или равно числу vCores, выделенных пулу.
- Все [ограничения уровня экземпляра](sql-database-managed-instance-resource-limits.md#service-tier-characteristics) применяются к экземплярам, созданным в пуле.
- В дополнение к ограничениям уровня экземпляра на уровне экземпляра на *уровне пула экземпляров*также установлены два ограничения:
  - Общий размер хранилища в пул (8 ТБ).
  - Общее количество баз данных на пул (100).

Общее распределение хранилища и количество баз данных во всех экземплярах должно быть ниже или равно ограничениям, которые выставляются пулами экземпляров.

- Бассейны инстанций поддерживают 8, 16, 24, 32, 40, 64 и 80 vCores.
- Управляемые экземпляры внутри бассейнов поддерживают 2, 4, 8, 16, 24, 32, 40, 64 и 80 vCores.
- Управляемые экземпляры внутри пулов поддерживают размеры хранилища от 32 ГБ до 8 ТБ, за исключением:
  - 2 vCore экземпляры поддерживают размеры между 32 ГБ и 640 ГБ
  - 4 экземпляра vCore поддерживают размеры от 32 ГБ до 2 ТБ

[Свойство уровня обслуживания](sql-database-managed-instance-resource-limits.md#service-tier-characteristics) связано с ресурсом пула экземпляров, поэтому все экземпляры в пуле должны быть на том же уровне обслуживания, что и уровень обслуживания пула. В настоящее время доступен только уровень службы общего назначения (см. следующий раздел об ограничениях в текущем предварительном просмотре).

### <a name="public-preview-limitations"></a>Ограничения общедоступной предварительной версии

Публичный предварительный просмотр имеет следующие ограничения:

- В настоящее время доступен только уровень общего назначения.
- Пулы экземпляров не могут быть масштабированы во время публичного предварительного просмотра, поэтому важно тщательное планирование емкости перед развертыванием.
- Поддержка портала Azure, например, создание и конфигурация пула пока недоступно. Все операции в пулах экземпляров поддерживаются только через PowerShell. Первоначальное развертывание экземпляра в предварительно созданном пуле также поддерживается только через PowerShell. После развертывания в пуле управляемые экземпляры могут обновляться с помощью портала Azure.
- Управляемые экземпляры, созданные за пределами пула, не могут быть перемещены в существующий пул, а экземпляры, созданные внутри пула, не могут быть перемещены снаружи как единый экземпляр или в другой пул.
- Зарезервированные цены экземпляров (включенная лицензия или с Azure Hybrid Benefit) недоступны.

## <a name="sql-features-supported"></a>Поддерживаемые функции SQL

Инстанции, созданные в пулах, поддерживают те же [уровни совместимости и функции, поддерживаемые в отдельных управляемых экземплярах.](sql-database-managed-instance.md#sql-features-supported)

Каждый управляемый экземпляр, развернутый в пуле, имеет отдельный экземпляр агента S'L.

Дополнительные функции или функции, требующие выбора определенных значений (таких как сопоставление уровня экземпляра, часовой пояс, общедоступные конечные точки для трафика данных, группы failover) настроены на уровне экземпляра и могут быть разными для каждого экземпляра в пуле.

## <a name="performance-considerations"></a>Вопросы производительности

Хотя управляемые экземпляры в пулах имеют выделенные vCore и ram, они разделяют локальный диск (для использования tempdb) и сетевые ресурсы. Это маловероятно, но можно испытать *эффект шумного соседа,* если несколько экземпляров в пуле имеют высокое потребление ресурсов в то же время. Если вы наблюдаете это поведение, рассмотрите возможность развертывания этих экземпляров в большем пуле или в виде отдельных экземпляров.

## <a name="security-considerations"></a>Вопросы безопасности

Поскольку экземпляры, развернутые в пуле, имеют одну и ту же виртуальную машину, можно рассмотреть возможность отключения функций, которые вводят более высокие риски безопасности, или надежно контролировать разрешения доступа к этим функциям. Например, интеграция CLR, нативное резервное копирование и восстановление, электронная почта базы данных и т.д.

## <a name="instance-pool-support-requests"></a>Запросы на поддержку пула инстанций

Создавайте и управляйте запросами поддержки например пулов на [портале Azure.](https://portal.azure.com)

Если возникли проблемы, связанные с развертыванием пула экземпляров (создание или удаление), убедитесь, что вы укажете **пулы экземпляров** в поле **подтипа проблемы.**

![запрос на поддержку резервов экземпляров](./media/sql-database-instance-pools/support-request.png)

Если возникли проблемы, связанные с отдельными экземплярами или базами данных в пуле, необходимо создать обычный билет поддержки для управляемых экземпляров базы данных Azure S'L.

Для создания более крупных управляемых развертываний экземпляров (с пулами экземпляров или без них) может потребоваться получить более крупную региональную квоту. Для получения дополнительной [Request quota increases for Azure SQL Database](quota-increase-request.md)информации см. Обратите внимание, что если вы используете пулы экземпляров, логика развертывания сравнивает общее потребление vCore *на уровне пула* с вашей квотой, чтобы определить, разрешено ли создавать новые ресурсы без дальнейшего увеличения квоты.

## <a name="instance-pool-billing"></a>Счет в пуле инстанций

Пулы инстанций позволяют самостоятельно масштабировать вычисления и хранение. Клиенты платят за вычисление, связанное с ресурсом пула, измеренным в vCores, и хранение, связанное с каждым экземпляром, измеренным в гигабайтах (первые 32 ГБ бесплатно для каждого экземпляра).

vCore цена для пула взимается независимо от того, сколько экземпляров развернуты в этом пуле.

Для цены compute (измеренной в vCores) доступны два варианта ценообразования:

  1. *Лицензия включена:* Цена лицензий S'L включена. Это предназначено для клиентов, которые предпочитают не применять существующие лицензии s'L Server с software Assurance.
  2. *Azure Hybrid Benefit:* Сниженная цена, которая включает в себя гибридную выгоду Azure для сервера S'L. Клиенты могут выбрать эту цену, используя свои существующие лицензии s'L Server с Software Assurance. Для получения права и других деталей, см [Azure Гибридные преимущества](https://azure.microsoft.com/pricing/hybrid-benefit/).

Установка различных вариантов ценообразования невозможна для отдельных экземпляров в пуле. Все экземпляры в родительском пуле должны быть либо по цене, включенной в лицензию, либо по цене Azure Hybrid Benefit. Модель лицензии для пула может быть изменена после создания пула.

> [!IMPORTANT]
> Если вы указываете модель лицензии для экземпляра, которая отличается от в пуле, используется цена пула и игнорируется значение уровня экземпляра.

При создании резервов экземпляров по [подпискам, имеющим право на получение льготы на dev-test,](https://azure.microsoft.com/pricing/dev-test/)вы автоматически получаете скидки до 55 процентов в управляемом экземпляре Azure S'L.

Для получения подробной информации о ценах на пулы экземпляров обратитесь в раздел *пулов экземпляров* на [странице ценообразования управляемого экземпляра.](https://azure.microsoft.com/pricing/details/sql-database/managed/)

## <a name="next-steps"></a>Дальнейшие действия

- Для начала работы с пулами экземпляров можно ознакомиться с [пулами экземпляров базы данных S'L.](sql-database-instance-pools-how-to.md)
- Чтобы узнать, как создать свой [Quickstart guide](sql-database-managed-instance-get-started.md)первый управляемый экземпляр, см.
- Сведения о функциях и список сравнения см. в статье [Сравнение функций Базы данных SQL Azure и SQL Server](sql-database-features.md).
- Для получения дополнительной информации [managed instance VNet configuration](sql-database-managed-instance-connectivity-architecture.md)о конфигурации VNet см.
- Для быстрого запуска, который создает управляемый экземпляр и восстанавливает базу [create a managed instance](sql-database-managed-instance-get-started.md)данных из файла резервного копирования, см.
- В учебнике, используемом миграционной службой базы данных Azure (DMS) для миграции, [см.](../dms/tutorial-sql-server-to-managed-instance.md)
- Для расширенного мониторинга производительности управляемой базы данных экземпляров со встроенным интеллектом для устранения неполадок [см.](../azure-monitor/insights/azure-sql.md)
- Для получения информации о ценах [см.](https://azure.microsoft.com/pricing/details/sql-database/managed/)
