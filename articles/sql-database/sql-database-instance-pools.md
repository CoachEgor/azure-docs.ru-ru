---
title: Пулы экземпляров (Предварительная версия)
description: В этой статье описываются пулы экземпляров базы данных SQL Azure (Предварительная версия).
services: sql-database
ms.service: sql-database
ms.subservice: managed-instance
ms.custom: ''
ms.devlang: ''
ms.topic: conceptual
author: bonova
ms.author: bonova
ms.reviewer: sstein, carlrab
ms.date: 09/05/2019
ms.openlocfilehash: 8738d1ad54d3ab63d8d2efc939aa9daacbe91c13
ms.sourcegitcommit: ac56ef07d86328c40fed5b5792a6a02698926c2d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/08/2019
ms.locfileid: "73810392"
---
# <a name="what-are-sql-database-instance-pools-preview"></a>Что такое пулы экземпляров базы данных SQL (Предварительная версия)?

Пулы экземпляров — это новый ресурс в базе данных SQL Azure, который предоставляет удобный и экономичный способ переноса небольших экземпляров SQL в облако в масштабе.

Пулы ресурсов позволяют предварительно подготовить к работе вычислительные ресурсы в соответствии с общими требованиями к миграции. Вы можете развернуть несколько отдельных управляемых экземпляров до предварительно подготовленного уровня вычислений. Например, при предварительной инициализации 8 виртуальных ядер можно развернуть два экземпляра Виртуальное ядро 2 и 4 Виртуальное ядро, а затем перенести базы данных в эти экземпляры. До тех пор, пока пулы экземпляров станут доступными, при переходе в облако часто приходится объединять рабочие нагрузки с большим объемом вычислений и без них в более крупный управляемый экземпляр. Необходимость переноса групп баз данных на крупные экземпляры, как правило, требует тщательного планирования ресурсов и управления ресурсами, дополнительных соображений безопасности и некоторых дополнительных операций консолидации данных на уровне экземпляра.

Кроме того, пулы экземпляров поддерживают встроенную интеграцию с виртуальной сетью, что позволяет развертывать несколько пулов экземпляров и несколько отдельных экземпляров в одной подсети.


## <a name="key-capabilities-of-instance-pools"></a>Основные возможности пулов экземпляров

Пулы экземпляров предоставляют следующие преимущества.

1. Возможность размещения 2 экземпляров Виртуальное ядро. *\*только для экземпляров в пулах экземпляров*.
2. Время прогнозируемого и быстрого развертывания экземпляра (до 5 минут).
3. Минимальное выделение IP-адресов.

На следующей схеме показан пул экземпляров с несколькими экземплярами, развернутыми в подсети виртуальной сети.

![пул экземпляров с несколькими экземплярами](./media/sql-database-instance-pools/instance-pools1.png)

Пулы экземпляров позволяют развертывать несколько экземпляров на одной виртуальной машине, для которых размер вычислений виртуальной машины зависит от общего количества виртуальных ядер, выделенного для пула. Эта архитектура позволяет *секционировать* виртуальную машину на несколько экземпляров, что может иметь любой поддерживаемый размер, включая 2 виртуальных ядер (2 экземпляра Виртуальное ядро доступны только для экземпляров в пулах).

Операции управления экземплярами в пуле выполняются гораздо быстрее после первоначального развертывания пула. Эти операции выполняются быстрее, поскольку развертывание или расширение [виртуального кластера](sql-database-managed-instance-connectivity-architecture.md#high-level-connectivity-architecture) (выделенного набора виртуальных машин) не является частью подготовки управляемого экземпляра.

Поскольку все экземпляры в пуле совместно используют одну и ту же виртуальную машину, общее выделение IP-адресов не зависит от числа развернутых экземпляров, что удобно для развертывания в подсетях с узким диапазоном IP-адресов.

Каждый пул имеет фиксированное выделение IP-адреса только девяти IP-адресов (не включая пять IP-адресов в подсети, которые зарезервированы для собственных нужд). Дополнительные сведения см. в разделе [требования к размеру подсети для отдельных экземпляров](sql-database-managed-instance-determine-size-vnet-subnet.md).

## <a name="application-scenarios-for-instance-pools"></a>Сценарии приложений для пулов экземпляров

В следующем списке приводятся основные варианты использования, в которых следует учитывать пулы экземпляров.

- Одновременное перемещение *группы экземпляров SQL* , где большинство — это меньший размер (например, 2 или 4 виртуальных ядер).
- Сценарии, в которых важно *прогнозируемое и короткое создание экземпляра или масштабирование* . Например, развертывание нового клиента в среде приложения SaaS с несколькими клиентами, для которого требуются возможности уровня экземпляра.
- Сценарии, в которых важна *фиксированная стоимость* или *предельная сумма расходов* . Например, выполнение общих сред разработки и тестирования или демонстрационной среды с фиксированным (или нечасто изменяющ меняющимся) размером, где при необходимости периодически развертываются управляемые экземпляры.
- Сценарии, в которых важно *выделение минимального количества IP-адресов* в подсети VNet. Все экземпляры в пуле совместно используют виртуальную машину, поэтому количество выделенных IP-адресов ниже, чем в случае с отдельными экземплярами.


## <a name="architecture-of-instance-pools"></a>Архитектура пулов экземпляров

Пулы экземпляров имеют схожую архитектуру с обычными управляемыми экземплярами (*одиночные экземпляры*). Для поддержки [развертываний в виртуальных сетях Azure (виртуальных сетей)](../virtual-network/virtual-network-for-azure-services.md#deploy-azure-services-into-virtual-networks) и для обеспечения изоляции и безопасности клиентов пулы экземпляров также используют [виртуальные кластеры](sql-database-managed-instance-connectivity-architecture.md#high-level-connectivity-architecture). Виртуальные кластеры представляют выделенный набор изолированных виртуальных машин, развернутых внутри подсети виртуальной сети клиента.

Основное различие между двумя моделями развертывания состоит в том, что пулы экземпляров допускают развертывание нескольких SQL Server процессов на одном узле виртуальной машины, который управляется ресурсами с помощью [объектов заданий Windows](https://docs.microsoft.com/windows/desktop/ProcThread/job-objects), тогда как отдельные экземпляры всегда включены в узел виртуальной машины.

На следующей схеме показан пул экземпляров и два отдельных экземпляра, развернутых в одной подсети, и показаны основные сведения об архитектуре для обеих моделей развертывания:

![пул экземпляров и два отдельных экземпляра](./media/sql-database-instance-pools/instance-pools2.png)

Каждый пул экземпляров создает отдельный виртуальный кластер под. Экземпляры в пуле и одиночные экземпляры, развернутые в одной подсети, не используют ресурсы вычислений, выделенные для процессов SQL Server и компонентов шлюза. Это обеспечивает предсказуемость производительности.

## <a name="instance-pools-resource-limitations"></a>Ограничения ресурсов для пулов экземпляров

Относительно пулов экземпляров и экземпляров внутри пула действует несколько ограничений ресурсов.

- Пулы экземпляров доступны только на го поколения оборудовании.
- Экземпляры в пуле имеют выделенный ЦП и оперативную память, поэтому Агрегированное количество виртуальных ядер на всех экземплярах должно быть меньше или равно количеству виртуальных ядер, выделенному для пула.
- Все [ограничения уровня экземпляра](sql-database-managed-instance-resource-limits.md#service-tier-characteristics) применяются к экземплярам, созданным в пуле.
- Кроме ограничений уровня экземпляра, на *уровне пула экземпляров*накладываются два ограничения:
  - Общий размер хранилища на пул (8 ТБ).
  - Общее число баз данных на пул (100).

Общий объем выделяемого хранилища и количество баз данных во всех экземплярах должны быть меньше или равны ограничениям, предоставляемым пулами экземпляров.

- Пулы экземпляров поддерживают 8, 16, 24, 32, 40, 64 и 80 виртуальных ядер.
- Управляемые экземпляры внутри пулов поддерживают 2, 4, 8, 16, 24, 32, 40, 64 и 80 виртуальных ядер.
- Управляемые экземпляры внутри пулов поддерживают размеры хранилищ от 32 ГБ до 8 ТБ, за исключением:
  - 2 экземпляра Виртуальное ядро поддерживают размеры от 32 ГБ до 640 ГБ
  - 4 экземпляра Виртуальное ядро поддерживают размеры от 32 ГБ до 2 ТБ.

[Свойство уровня службы](sql-database-managed-instance-resource-limits.md#service-tier-characteristics) связано с ресурсом пула экземпляров, поэтому все экземпляры в пуле должны быть того же уровня служб, что и уровень служб пула. В настоящее время доступен только уровень служб общего назначения (см. следующий раздел об ограничениях в текущей предварительной версии).

### <a name="public-preview-limitations"></a>Ограничения общедоступной предварительной версии

Общедоступная Предварительная версия имеет следующие ограничения.

- В настоящее время доступен только уровень служб общего назначения.
- Нельзя масштабировать пулы экземпляров во время общедоступной предварительной версии, поэтому важно тщательно спланировать емкость до развертывания.
- Портал Azure поддержка создания пула экземпляров и конфигурации еще недоступна. Все операции с пулами экземпляров поддерживаются только через PowerShell. Развертывание исходного экземпляра в предварительно созданном пуле также поддерживается только с помощью PowerShell. После развертывания в пул управляемые экземпляры можно обновить с помощью портал Azure.
- Управляемые экземпляры, созданные за пределами пула, нельзя переместить в существующий пул, и экземпляры, созданные в пуле, нельзя переместить за пределы одного экземпляра или другого пула.
- Ценообразование зарезервированного экземпляра (включенная лицензия или с Преимущество гибридного использования Azure) недоступна.

## <a name="sql-features-supported"></a>Поддерживаемые функции SQL

Экземпляры, созданные в пулах, поддерживают те же [уровни совместимости и функции, которые поддерживаются в отдельных управляемых экземплярах](sql-database-managed-instance.md#sql-features-supported).

Каждый управляемый экземпляр, развернутый в пуле, имеет отдельный экземпляр агента SQL.

Дополнительные функции или функции, требующие выбора конкретных значений (например, параметры сортировки на уровне экземпляра, часовой пояс, общедоступная конечная точка для трафика данных, групп отработки отказа), настраиваются на уровне экземпляра и могут различаться для каждого экземпляра в пуле.

## <a name="performance-considerations"></a>Рекомендации по производительности

Несмотря на то, что управляемые экземпляры в пулах имеют выделенные Виртуальное ядро и ОЗУ, они совместно используют локальный диск (для использования базы данных tempdb) и сетевые ресурсы. Скорее всего, это не так, но можно столкнуться с *помехами* , если несколько экземпляров в пуле имеют высокое потребление ресурсов одновременно. Если вы следите за этим поведением, рассмотрите возможность развертывания этих экземпляров в более крупном пуле или в виде отдельных экземпляров.

## <a name="security-considerations"></a>Вопросы безопасности

Поскольку экземпляры, развернутые в пуле, совместно используют одну и ту же виртуальную машину, можно рассмотреть возможность отключения функций, которые применяют более высокие риски безопасности, или для надежного управления правами доступа к этим функциям. Например, интеграция со средой CLR, встроенное резервное копирование и восстановление, электронная почта базы данных и т. д.

## <a name="instance-pool-support-requests"></a>Запросы на поддержку пула экземпляров

Создание запросов на поддержку для пулов экземпляров в [портал Azure](https://portal.azure.com)и управление ими.

При возникновении проблем, связанных с развертыванием пула экземпляров (созданием или удалением), убедитесь, что в поле **подтип проблемы** указаны **Пулы экземпляров** .

![запрос на поддержку пулов экземпляров](./media/sql-database-instance-pools/support-request.png)

При возникновении проблем, связанных с отдельными экземплярами или базами данных в пуле, следует создать обычный запрос в службу поддержки для управляемых экземпляров базы данных SQL Azure.

Для создания более крупных развертываний управляемого экземпляра (с пулами экземпляров или без них) может потребоваться получить более крупную региональную квоту. Используйте [стандартную процедуру управляемого экземпляра для запроса более крупной квоты](sql-database-managed-instance-resource-limits.md#obtaining-a-larger-quota-for-sql-managed-instance), но обратите внимание, что при использовании пулов экземпляров логика развертывания сравнивает Общее виртуальное ядро потребление *на уровне пула* с квотой, чтобы определить, выполняется ли разрешается создавать новые ресурсы без дальнейшего увеличения квоты.

## <a name="instance-pool-billing"></a>Выставление счетов за пул экземпляров

Пулы экземпляров позволяют независимо масштабировать вычислительные ресурсы и хранилища. Клиенты платят за вычислительные ресурсы, связанные с ресурсом пула, измеренным в виртуальных ядер, и хранилище, связанное с каждым экземпляром, измеренным в гигабайтах (первые 32 ГБ по бесплатному тарифу на каждый экземпляр).

плата за Виртуальное ядро за пул насчитывается независимо от того, сколько экземпляров развернуто в этом пуле.

Для цены на вычисления (измеряется в виртуальных ядер) доступны два варианта ценообразования:

  1. *Прилагаемая лицензия*: Примените существующие лицензии SQL Server к программе Software Assurance.
  2. *Преимущество гибридного использования Azure*: сниженная цена, которая включает Преимущество гибридного использования Azure для SQL Server. Клиенты могут принять участие в этой цене, используя существующие лицензии на SQL Server с Software Assurance. Сведения о допустимости и других деталях см. в разделе [преимущество гибридного использования Azure](https://azure.microsoft.com/pricing/hybrid-benefit/).

Установка различных параметров ценообразования невозможна для отдельных экземпляров в пуле. Все экземпляры в родительском пуле должны быть либо по цене, либо по прейскуранту, либо по цене Преимущество гибридного использования Azure. Модель лицензии для пула можно изменить после создания пула.

> [!IMPORTANT]
> При указании модели лицензии для экземпляра, который отличается от значения в пуле, используется цена пула, а значение уровня экземпляра игнорируется.

Если вы создаете пулы экземпляров в [подписках, доступных для преимуществ разработки и тестирования](https://azure.microsoft.com/pricing/dev-test/), вы автоматически получаете скидку со скидками до 55% на управляемом экземпляре SQL Azure.

Полные сведения о ценах на пул экземпляров см. в разделе *Пулы экземпляров* на [странице цен на управляемые экземпляры](https://azure.microsoft.com/pricing/details/sql-database/managed/).

## <a name="next-steps"></a>Дальнейшие действия

- Чтобы приступить к работе с пулами экземпляров, см. [руководство по пулам экземпляров базы данных SQL](sql-database-instance-pools-how-to.md).
- Сведения о создании первого управляемого экземпляра см. в [этом руководстве по началу работы](sql-database-managed-instance-get-started.md).
- Сведения о функциях и список сравнения см. в статье [Сравнение функций Базы данных SQL Azure и SQL Server](sql-database-features.md).
- Дополнительные сведения о настройке виртуальной сети для управляемого экземпляра базы данных SQL Azure см. в [этой статье](sql-database-managed-instance-connectivity-architecture.md).
- Сведения о создании управляемого экземпляра и восстановлении базы данных из файла резервной копии см. в [этой статье](sql-database-managed-instance-get-started.md).
- Сведения об использовании Azure Database Migration Service (DMS) для миграции см. в статье о [миграции SQL Server в управляемый экземпляр базы данных SQL Azure](../dms/tutorial-sql-server-to-managed-instance.md).
- Дополнительные сведения о производительности базы данных управляемого экземпляра с помощью встроенных средств аналитики по устранению неполадок см. в статье [мониторинг базы данных SQL Azure с использованием аналитика SQL Azure](../azure-monitor/insights/azure-sql.md).
- Информацию о ценах см. на странице [цен на управляемый экземпляр Базы данных SQL Azure](https://azure.microsoft.com/pricing/details/sql-database/managed/).