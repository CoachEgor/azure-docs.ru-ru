---
title: Ограничения ресурсов — управляемый экземпляр
description: В статье представлены общие сведения об ограничениях ресурсов Базы данных SQL Azure для управляемых экземпляров.
services: sql-database
ms.service: sql-database
ms.subservice: managed-instance
ms.custom: ''
ms.devlang: ''
ms.topic: conceptual
author: bonova
ms.author: bonova
ms.reviewer: carlrab, jovanpop, sachinp, sstein
ms.date: 02/25/2020
ms.openlocfilehash: b2871ec87e4d7f337c26b3ff3de83c1c3c88aea2
ms.sourcegitcommit: 849bb1729b89d075eed579aa36395bf4d29f3bd9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2020
ms.locfileid: "80365392"
---
# <a name="overview-azure-sql-database-managed-instance-resource-limits"></a>Общие сведения об ограничениях ресурсов управляемого экземпляра базы данных SQL Azure

В этой статье приводятся общие сведения о технических характеристиках и ограничениях ресурсов для управляемого экземпляра базы данных SQL Azure, а также сведения о том, как запросить увеличение этих ограничений.

> [!NOTE]
> Различия в поддерживаемых функциях и инструкциях T-SQL см. в статьях [Сравнение функций Базы данных SQL Azure и SQL Server](sql-database-features.md) и [Различия T-SQL между Управляемым экземпляром Базы данных SQL Azure и SQL Server](sql-database-managed-instance-transact-sql-information.md). Общие различия между уровнями служб в одной базе данных и управляемом экземпляре см. в статье [Сравнение уровней служб](sql-database-service-tiers-general-purpose-business-critical.md#service-tier-comparison).

## <a name="hardware-generation-characteristics"></a>Характеристики поколения оборудования

На управляемом экземпляре действуют ограничения характеристик и ресурсов, зависящие от базовой инфраструктуры и архитектуры. Управляемый экземпляр базы данных SQL Azure можно развернуть в двух поколениях оборудования: го поколения и го поколения. Поколения оборудования имеют различные характеристики, как описано в следующей таблице.

|   | **4-е поколение** | **5-го поколения** |
| --- | --- | --- |
| Оборудование | Процессоры Intel E5-2673 v3 (Haswell) с тактовой частотой 2,4 ГГц с присоединенным виртуальным ядром SSD = 1 PP (физическое ядро) | Процессоры Intel, 2673 V4 (Broadwell) 2,3-ГГц и Intel SP-8160 (Skylake), быстрый SSD NVMe, виртуальное ядро = 1 LP (Hyper-Thread) |
| Количество виртуальных ядер. | 8, 16, 24 виртуальных ядер | 4, 8, 16, 24, 32, 40, 64, 80 виртуальных ядер |
| Максимальный объем памяти (соотношение памяти и ядра) | 7 ГБ на виртуальное ядро<br/>Добавьте дополнительные виртуальных ядер, чтобы получить больше памяти. | 5,1 ГБ на виртуальное ядро<br/>Добавьте дополнительные виртуальных ядер, чтобы получить больше памяти. |
| Максимальная память выполняющейся в памяти OLTP | Ограничение экземпляра: 1 – 1,5 ГБ на виртуальное ядро| Ограничение экземпляров: 0,8-1,65 ГБ на виртуальное ядро |
| Максимальное зарезервированное хранилище экземпляра |  Общего назначения: 8 ТБ<br/>Критически важный для бизнеса: 1 ТБ | Общего назначения: 8 ТБ<br/> Критически важный для бизнеса 1 ТБ, 2 ТБ или 4 ТБ в зависимости от числа ядер |

> [!IMPORTANT]
> - Го поколенияное оборудование находится в стадии развертывания и больше не доступно для новых развертываний. Все новые управляемые экземпляры должны быть развернуты на го поколения оборудовании.
> - Рассмотрите возможность [перемещения управляемых экземпляров на оборудование поколения 5](sql-database-service-tiers-vcore.md) , чтобы получить более широкий спектр Виртуальное ядро и масштабируемости хранилища, ускоренную сеть, лучшую производительность операций ввода-вывода и минимальную задержку.

### <a name="in-memory-oltp-available-space"></a>Доступное пространство выполняющейся в памяти OLTP 

Объем пространства выполняющейся в памяти OLTP на уровне служб [критически важный для бизнеса](sql-database-service-tier-business-critical.md) зависит от числа виртуальных ядер и создания оборудования. В следующей таблице перечислены ограничения памяти, которые могут использоваться для объектов OLTP в памяти.

| Пространство выполняющейся в памяти OLTP  | **5-го поколения** | **4-е поколение** |
| --- | --- | --- |
| 4 виртуальных ядра  | 3,14 ГБ | |   
| 8 виртуальных ядер  | 6,28 ГБ | 8 ГБ |
| 16 виртуальных ядер | 15,77 ГБ | 20 ГБ |
| 24 виртуальных ядер | 25,25 ГБ | 36 ГБ |
| 32 виртуальных ядер | 37,94 ГБ | |
| 40 виртуальных ядер | 52,23 ГБ | |
| 64 виртуальных ядер | 99,9 ГБ    | |
| 80 виртуальных ядер | 131,68 ГБ| |

## <a name="service-tier-characteristics"></a>Характеристики уровней служб

Управляемый экземпляр имеет два уровня служб: [общего назначения](sql-database-service-tier-general-purpose.md) и [критически важный для бизнеса](sql-database-service-tier-business-critical.md). Эти уровни предоставляют [различные возможности](sql-database-service-tiers-general-purpose-business-critical.md), как описано в таблице ниже.

> [!Important]
> Критически важный для бизнеса уровня службы предоставляет дополнительную встроенную копию экземпляра (вторичную реплику), которую можно использовать для рабочей нагрузки только для чтения. Если вы можете разделить запросы на чтение и запись, а также запросы только для чтения/аналитических отчетов, вы получаете дважды виртуальных ядер и память для одной цены. Вторичная реплика может отставать от основного экземпляра до нескольких секунд, поэтому она предназначена для разгрузки рабочей нагрузки отчетов и аналитики, для которой не требуется точное текущее состояние данных. В приведенной ниже таблице **запросы только для чтения** — это запросы, выполняемые на вторичной реплике.

| **Компонент** | **общего назначения** | **Критически важный для бизнеса** |
| --- | --- | --- |
| Количество виртуальных ядер\* | 4-е поколение: 8, 16, 24<br/>Го поколения: 4, 8, 16, 24, 32, 40, 64, 80 | 4-е поколение: 8, 16, 24 <br/> Го поколения: 4, 8, 16, 24, 32, 40, 64, 80 <br/>\*Одинаковое число виртуальных ядер выделяется для запросов только для чтения. |
| Максимальный объем памяти | Го поколения: 56 ГБ — 168 ГБ (7 ГБ/Виртуальное ядро)<br/>Го поколения: 20,4 ГБ — 408 ГБ (5.1 ГБ/Виртуальное ядро)<br/>Добавьте дополнительные виртуальных ядер, чтобы получить больше памяти. | Го поколения: 56 ГБ — 168 ГБ (7 ГБ/Виртуальное ядро)<br/>Го поколения: 20,4 ГБ-408 ГБ (5.1 ГБ/Виртуальное ядро) для запросов на чтение и запись<br/>+ дополнительно 20,4 ГБ — 408 ГБ (5.1 ГБ/Виртуальное ядро) для запросов только для чтения.<br/>Добавьте дополнительные виртуальных ядер, чтобы получить больше памяти. |
| Максимальный размер хранилища экземпляра (зарезервировано) | -2 ТБ для 4 виртуальных ядер (только го поколения)<br/>-8 ТБ для других размеров | Го поколения: 1 ТБ <br/> 5-е поколение: <br/>-1 ТБ для 4, 8, 16 виртуальных ядер<br/>— 2 ТБ для 24 виртуальных ядер<br/>— 4 ТБ для 32, 40, 64, 80 виртуальных ядер |
| Максимальный размер базы данных | До текущего размера экземпляра (максимум 2 ТБ – 8 ТБ в зависимости от числа виртуальных ядер). | До текущего размера экземпляра (максимум 1 ТБ – 4 ТБ в зависимости от числа виртуальных ядер). |
| Максимальный размер tempdb | Ограничено 24 ГБ/Виртуальное ядро (96-1 920 ГБ) и доступным размером хранилища экземпляра.<br/>Добавьте дополнительные виртуальных ядер, чтобы получить больше пространства TempDB.<br/> Размер файла журнала ограничен 120 ГБ.| Размер хранилища до текущего доступного экземпляра. |
| Максимальное количество баз данных на экземпляр | 100, если не достигнут предел размера хранилища экземпляра. | 100, если не достигнут предел размера хранилища экземпляра. |
| Максимальное число файлов базы данных на экземпляр | До 280, если не достигнут размер хранилища экземпляра или превышено ограничение на [объем выделяемого пространства для хранилища на диске Azure Premium](sql-database-release-notes.md#exceeding-storage-space-with-small-database-files) . | 32 767 файлов на базу данных, если не достигнут предел размера хранилища экземпляра. |
| Максимальный размер файла данных | Ограниченный текущий доступный размер хранилища экземпляра (не более 2 ТБ-8 ТБ) и [место выделения памяти для хранилища на диске Azure класса Premium](sql-database-release-notes.md#exceeding-storage-space-with-small-database-files). | Ограниченный текущий доступный размер хранилища экземпляра (до 1 ТБ – 4 ТБ). |
| Максимальный размер файла журнала | Ограничение в 2 ТБ и доступный размер хранилища экземпляров. | Ограничение в 2 ТБ и доступный размер хранилища экземпляров. |
| Операции ввода-вывода в секунду для данных или журнала (приблизительно) | До 30-40 КБ в секунду на экземпляр *, 500-7500 на каждый файл<br/>\*[Увеличение размера файла для получения дополнительных операций ввода-вывода](#file-io-characteristics-in-general-purpose-tier)| 10 k-200 КБ (2500 операций ввода/вывода/Виртуальное ядро)<br/>Добавьте дополнительные виртуальных ядер, чтобы получить лучшую производительность ввода-вывода. |
| Ограничение пропускной способности записи в журнал (на экземпляр) | 3 МБ/с на виртуальное ядро<br/>Макс. 22 Мб/с | 4 МБ/с на виртуальное ядро<br/>Макс. 48 МБ/с |
| Пропускная способность данных (приблизительно) | 100–250 МБ/с на каждый файл<br/>\*[Увеличьте размер файла, чтобы получить лучшую производительность ввода-вывода](#file-io-characteristics-in-general-purpose-tier) | Не ограничено. |
| Задержка операций ввода-вывода хранилища (приблизительно) | 5–10 мс | 1–2 мс |
| Выполняющаяся в памяти OLTP | Не поддерживается | Доступно, [размер зависит от числа Виртуальное ядро](#in-memory-oltp-available-space) |
| Максимальное число сеансов | 30 000 | 30 000 |
| [Реплики только для чтения](sql-database-read-scale-out.md) | 0 | 1 (входит в цену) |

> [!NOTE]
> - **Текущий доступный размер хранилища экземпляра** — это разница между зарезервированным размером экземпляра и используемым дисковым пространством.
> - Размеры данных и файла журнала в системных базах данных и базах данных пользователей включаются в размер хранилища экземпляра, который сравнивается с пределом максимального размера хранилища. Используйте системное представление <a href="https://docs.microsoft.com/sql/relational-databases/system-catalog-views/sys-master-files-transact-sql">sys.master_files</a>, чтобы определить общий объем, используемый базами данных. Журналы ошибок не сохраняются и не включаются в размер. Резервные копии не включаются в размер хранилища.
> - Пропускная способность и операции ввода-вывода на уровне общего назначения также зависят от [размера файла](#file-io-characteristics-in-general-purpose-tier) , который явно не ограничивается управляемым экземпляром.
> - Вы можете создать другую доступную для чтения реплику в другом регионе Azure с помощью групп автоматической отработки отказа.
> - Максимальное число операций ввода-вывода для экземпляра зависит от структуры файла и распределения рабочей нагрузки. Например, если вы создадите 7-1 ТБ файлов с максимальным количеством операций ввода-вывода в секунду и 7 маленьких файлов (менее 128 ГБ) с 500 операций ввода-вывода в секунду, можно получить 38500 операций ввода-вывода в секунду на экземпляр (7x5000 + 7x500), если Рабочая нагрузка может использовать все файлы. Обратите внимание, что для автоматического резервного копирования также используется некоторый объем операций ввода-вывода в секунду.

> [!NOTE]
> Дополнительные сведения об [ограничениях ресурсов в пулах управляемых экземпляров см. в этой статье](sql-database-instance-pools.md#instance-pools-resource-limitations).

### <a name="file-io-characteristics-in-general-purpose-tier"></a>Характеристики ввода-вывода файла на уровне общего назначения

В общего назначения уровня служб каждый файл базы данных получает выделенные операции ввода-вывода и пропускную способность, зависящие от размера файла. Большие файлы повышают скорость операций ввода-вывода и пропускную способность. Характеристики ввода-вывода файлов базы данных показаны в следующей таблице:

| Размер файла | >= 0 и <= 128 гиб | >128 и <= 256 гиб | >256 и <= 512 гиб | >0,5 и <= 1 тиб    | >1 и <= 2 тиб    | >2 и <= 4 тиб | >4 и <= 8 тиб |
|---------------------|-------|-------|-------|-------|-------|-------|-------|
| Операций ввода-вывода на файл       | 500   | 1100 | 2300              | 5000              | 7500              | 7500              | 12 500   |
| Пропускная способность на файл | 100 МиБ/с | 125 МиБ/с | 150 МиБ/с | 200 МиБ/с | 250 МиБ/с | 250 МиБ/с | 480 MiB/с | 

Если вы заметили высокую задержку ввода-вывода для какого-либо файла базы данных или видите, что достигнут предел в операциях ввода/вывода, производительность может повыситься путем [увеличения размера файла](https://techcommunity.microsoft.com/t5/Azure-SQL-Database/Increase-data-file-size-to-improve-HammerDB-workload-performance/ba-p/823337).

Существуют также ограничения на уровне экземпляра, такие как максимальная пропускная способность записи в журнал 22 Мб/с, поэтому вы не сможете получить доступ к файлу по всему файлу журнала, так как достигнут предел пропускной способности экземпляра.

## <a name="supported-regions"></a>Поддерживаемые регионы

Управляемые экземпляры могут создаваться только в [поддерживаемых регионах](https://azure.microsoft.com/global-infrastructure/services/?products=sql-database&regions=all). Чтобы создать управляемый экземпляр в регионе, который сейчас не поддерживается, можно [Отправить запрос в службу поддержки через портал Azure](quota-increase-request.md).

## <a name="supported-subscription-types"></a>Поддерживаемые типы подписок

Сейчас управляемый экземпляр поддерживает развертывание только для следующих типов подписок:

- [Соглашение Enterprise (EA)](https://azure.microsoft.com/pricing/enterprise-agreement/)
- [Оплата по мере использования](https://azure.microsoft.com/offers/ms-azr-0003p/)
- [Поставщик облачных служб (CSP)](https://docs.microsoft.com/partner-center/csp-documents-and-learning-resources)
- [Enterprise — разработка и тестирование](https://azure.microsoft.com/offers/ms-azr-0148p/)
- [Разработка и тестирование с оплатой по мере использования](https://azure.microsoft.com/offers/ms-azr-0023p/)
- [Подписки с ежемесячным кредитом Azure для подписчиков Visual Studio](https://azure.microsoft.com/pricing/member-offers/credit-for-visual-studio-subscribers/)

## <a name="regional-resource-limitations"></a>Ограничение подписок по регионам

Поддерживаемые типы подписок могут содержать ограниченное число ресурсов на регион. У управляемого экземпляра есть два ограничения по умолчанию на регион Azure (которые можно увеличить по запросу, создав специальный [запрос на поддержку в портал Azure](quota-increase-request.md) в зависимости от типа подписки:

- **Ограничение подсети**. Максимальное количество подсетей, в которых развернуты управляемые экземпляры в одном регионе.
- **ограничение единицы Виртуальное ядро**: максимальное число единиц Виртуальное ядро, которые могут быть развернуты во всех экземплярах в одном регионе. Одна из Виртуальное ядро групповой политики использует одну единицу Виртуальное ядро, а один BC Виртуальное ядро — 4 Виртуальное ядро единиц. Общее число экземпляров не ограничено, если оно находится в пределах ограничения единицы Виртуальное ядро.

> [!Note]
> Эти ограничения являются параметрами по умолчанию, а не техническими ограничениями. Ограничения можно увеличить по запросу, создав специальный [запрос на поддержку в портал Azure](quota-increase-request.md) , если требуется больше управляемых экземпляров в текущем регионе. В качестве альтернативы можно создавать новые управляемые экземпляры в другом регионе Azure, не отправляя запросы на поддержку.

В следующей таблице показаны **региональные ограничения по умолчанию** для поддерживаемых типов подписки (ограничения по умолчанию можно расширить с помощью запроса на поддержку, описанного ниже).

|Тип подписки| Максимальное число подсетей управляемых экземпляров | Максимальное число единиц Виртуальное ядро * |
| :---| :--- | :--- |
|Оплата по мере использования|3|320|
|Поставщик служб шифрования |8 (15 в некоторых регионах * *)|960 (1440 в некоторых регионах * *)|
|Разработка и тестирование с оплатой по мере использования|3|320|
|Enterprise — разработка и тестирование|3|320|
|EA|8 (15 в некоторых регионах * *)|960 (1440 в некоторых регионах * *)|
|Visual Studio Enterprise|2 |64|
|Visual Studio Professional и MSDN Platforms|2|32|

\*При планировании развертываний примите во внимание, что для уровня служб критически важный для бизнеса (BC) требуется четыре (4) раза больше емкости, чем уровень служб общего назначения (GP). Например: 1 GP Виртуальное ядро = 1 Виртуальное ядро Unit и 1 BC Виртуальное ядро = 4 Виртуальное ядро единиц. Чтобы упростить анализ потребления по умолчанию, суммируйте единицы Виртуальное ядро во всех подсетях в регионе, где развернуты управляемые экземпляры, и сравните результаты с ограничениями единиц экземпляра для вашего типа подписки. Ограничение **максимального числа единиц Виртуальное ядро** применяется к каждой подписке в регионе. Ограничения на отдельные подсети отсутствуют, за исключением того, что сумма всех виртуальных ядер, развернутых в нескольких подсетях, должна быть меньше или равна **максимальному числу единиц Виртуальное ядро**.

\*\*Более крупные ограничения подсети и виртуальное ядро доступны в следующих регионах: Восточная Австралия, восток США, Восточная часть США 2, Северная Европа, Юго-Центральный регион США, Юго-Восточная Азия, южная часть Соединенного Королевства, Западная Европа, Западная часть США 2.

## <a name="request-a-quota-increase-for-sql-managed-instance"></a>Запрос увеличения квоты для управляемого экземпляра SQL

Если в текущих регионах требуется больше управляемых экземпляров, отправьте запрос в службу поддержки, чтобы расширить квоту с помощью портал Azure. Дополнительные сведения см. в статье [запрос увеличения квоты для базы данных SQL Azure](quota-increase-request.md).

## <a name="next-steps"></a>Дальнейшие шаги

- Дополнительные сведения об управляемом экземпляре см. [в разделе что такое управляемый экземпляр?](sql-database-managed-instance.md).
- Сведения о ценах см. на странице [цены на управляемый экземпляр базы данных SQL](https://azure.microsoft.com/pricing/details/sql-database/managed/).
- Сведения о создании первого управляемого экземпляра см. [в руководстве по быстрому](sql-database-managed-instance-get-started.md)запуску.
