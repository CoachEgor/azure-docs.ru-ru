---
title: Ограничения ресурсов - управляемый экземпляр
description: В статье представлены общие сведения об ограничениях ресурсов Базы данных SQL Azure для управляемых экземпляров.
services: sql-database
ms.service: sql-database
ms.subservice: managed-instance
ms.custom: ''
ms.devlang: ''
ms.topic: conceptual
author: bonova
ms.author: bonova
ms.reviewer: carlrab, jovanpop, sachinp, sstein
ms.date: 02/25/2020
ms.openlocfilehash: b2871ec87e4d7f337c26b3ff3de83c1c3c88aea2
ms.sourcegitcommit: 07d62796de0d1f9c0fa14bfcc425f852fdb08fb1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/27/2020
ms.locfileid: "80365392"
---
# <a name="overview-azure-sql-database-managed-instance-resource-limits"></a>Обзор ограничений ресурсов ресурсов ресурсов с использованием ресурсов azure S'L управляемых экземпляров

В этой статье содержится обзор технических характеристик и пределов ресурсов для управляемого экземпляра базы данных Azure S'L и приводится информация о том, как запросить увеличение до этих пределов.

> [!NOTE]
> Различия в поддерживаемых функциях и инструкциях T-SQL см. в статьях [Сравнение функций Базы данных SQL Azure и SQL Server](sql-database-features.md) и [Различия T-SQL между Управляемым экземпляром Базы данных SQL Azure и SQL Server](sql-database-managed-instance-transact-sql-information.md). Для общих различий между уровнями обслуживания в единой базе данных и управляемом экземпляре см. [сравнение уровня службы.](sql-database-service-tiers-general-purpose-business-critical.md#service-tier-comparison)

## <a name="hardware-generation-characteristics"></a>Характеристики поколения оборудования

Управляемый экземпляр имеет характеристики и ограничения ресурсов, которые зависят от базовой инфраструктуры и архитектуры. Управляемый экземпляр базы данных Azure S'L может быть развернут на двух поколениях оборудования: Gen4 и Gen5. Поколения оборудования имеют различные характеристики, как описано в следующей таблице:

|   | **4-е поколение** | **5-го поколения** |
| --- | --- | --- |
| Оборудование | Процессоры Intel E5-2673 v3 (Haswell) с тактовой частотой 2,4 ГГц с присоединенным виртуальным ядром SSD = 1 PP (физическое ядро) | Процессоры Intel E5-2673 v4 (Бродуэлл) 2,3 ГГц и процессоры Intel SP-8160 (Skylake), быстрый NVMe SSD, vCore-1 LP (гиперпоток) |
| Количество виртуальных ядер. | 8, 16, 24 виртуальных ядер | 4, 8, 16, 24, 32, 40, 64, 80 vCores |
| Максимальная память (соотношение памяти/ядра) | 7 ГБ на виртуальное ядро<br/>Добавьте больше vCores, чтобы получить больше памяти. | 5,1 ГБ на виртуальное ядро<br/>Добавьте больше vCores, чтобы получить больше памяти. |
| Максимальная память OLTP памяти | Предел инстанции: 1-1.5 ГБ на vCore| Предел инстанции: 0.8 - 1.65 GB в vCore |
| Зарезервированное хранилище Max instance |  Общая цель: 8 ТБ<br/>Бизнес-критический: 1 ТБ | Общая цель: 8 ТБ<br/> Бизнес критический 1 ТБ, 2 ТБ или 4 ТБ в зависимости от количества ядер |

> [!IMPORTANT]
> - Оборудование Gen4 постепенно выравливается и больше не доступно для новых развертываний. Все новые управляемые экземпляры должны быть развернуты на оборудовании Gen5.
> - Рассмотрите возможность [переноса управляемых экземпляров на](sql-database-service-tiers-vcore.md) аппаратное обеспечение Gen 5, чтобы испытать более широкий спектр масштабируемости vCore и хранилища, ускоренную сеть, лучшую производительность и минимальную задержку.

### <a name="in-memory-oltp-available-space"></a>Доступное пространство В памяти OLTP 

Количество пространства IN-memory OLTP в уровне [обслуживания Business Critical](sql-database-service-tier-business-critical.md) зависит от количества vCores и аппаратного поколения. В следующей таблице перечислены пределы памяти, которые могут быть использованы для объектов IN-memory OLTP.

| Пространство OLTP в памяти  | **5-го поколения** | **4-е поколение** |
| --- | --- | --- |
| 4 виртуальных ядра  | 3,14 ГБ | |   
| 8 виртуальных ядер  | 6,28 ГБ | 8 ГБ |
| 16 vCores | 15.77 ГБ | 20 ГБ |
| 24 vCores | 25.25 ГБ | 36 ГБ |
| 32 vCores | 37,94 ГБ | |
| 40 vCores | 52,23 ГБ | |
| 64 vCores | 99,9 ГБ    | |
| 80 vCores | 131,68 ГБ| |

## <a name="service-tier-characteristics"></a>Характеристики уровней служб

Управляемый экземпляр имеет два уровня обслуживания: [общее назначение](sql-database-service-tier-general-purpose.md) и [критический бизнес.](sql-database-service-tier-business-critical.md) Эти уровни обеспечивают [различные возможности,](sql-database-service-tiers-general-purpose-business-critical.md)как описано в таблице ниже.

> [!Important]
> Бизнес Критический сервис-уровень предоставляет дополнительную встроенную копию экземпляра (вторичную реплику), которая может быть использована для рабочей нагрузки только для чтения. Если вы можете отделить запросы на чтение-запись и только для чтения/аналитические/отчетные запросы, вы получаете дважды vCores и память по той же цене. Вторичная реплика может отставать на несколько секунд от основного экземпляра, поэтому она предназначена для разгрузки отчетов/аналитической рабочей нагрузки, которая не нуждается в точном текущем состоянии данных. В таблице ниже **запросы только** для чтения — это запросы, выполняемые на вторичной реплике.

| **Функция** | **Общая цель** | **Бизнес-критический** |
| --- | --- | --- |
| Количество виртуальных ядер\* | 4-е поколение: 8, 16, 24<br/>Gen5: 4, 8, 16, 24, 32, 40, 64, 80 | 4-е поколение: 8, 16, 24 <br/> Gen5: 4, 8, 16, 24, 32, 40, 64, 80 <br/>\*То же количество vCores предназначено для запросов только для чтения. |
| Максимальная память | Gen4: 56 ГБ - 168 ГБ (7 ГБ/vCore)<br/>Gen5: 20,4 ГБ - 408 ГБ (5,1 ГБ/vCore)<br/>Добавьте больше vCores, чтобы получить больше памяти. | Gen4: 56 ГБ - 168 ГБ (7 ГБ/vCore)<br/>Gen5: 20,4 ГБ - 408 ГБ (5,1 ГБ/vCore) для запросов на чтение<br/>дополнительные 20,4 ГБ - 408 ГБ (5,1 ГБ/vCore) для запросов только для чтения.<br/>Добавьте больше vCores, чтобы получить больше памяти. |
| Максимальный размер хранилища экземпляра (зарезервировано) | - 2 ТБ на 4 vCores (только Gen5)<br/>- 8 ТБ для других размеров | Gen4: 1 ТБ <br/> 5-е поколение: <br/>- 1 ТБ на 4, 8, 16 vCores<br/>— 2 ТБ для 24 виртуальных ядер<br/>— 4 ТБ для 32, 40, 64, 80 виртуальных ядер |
| Максимальный размер базы данных | До доступного в настоящее время размера экземпляра (максимум 2 ТБ - 8 ТБ в зависимости от количества vCores). | До доступного в настоящее время размера экземпляра (максимум 1 ТБ - 4 ТБ в зависимости от количества vCores). |
| Максимальный размер tempdb | Ограничено до 24 ГБ/vCore (96 - 1,920 ГБ) и в настоящее время доступны экземпляр размера хранения.<br/>Добавьте больше vCores, чтобы получить больше пространства TempDB.<br/> Размер файла входа ограничен 120 ГБ.| До доступного в настоящее время размера хранилища экземпляра. |
| Максимальное количество баз данных на экземпляр | 100, если не достигнут предел размера хранилища экземпляра. | 100, если не достигнут предел размера хранилища экземпляра. |
| Максимальное количество файлов баз данных в экземпляре | До 280 экземпляров, если не достигнут размер хранилища экземпляра или лимит [пространства для размещения пространства для хранения Azure Premium Disk.](sql-database-release-notes.md#exceeding-storage-space-with-small-database-files) | 32 767 файлов в базе данных, если не достигнут предел размера хранилища экземпляра. |
| Размер файла данных Max | Ограничено в настоящее время размером хранилища экземпляра (максимум 2 ТБ - 8 ТБ) и [пространством для распределения данных на премиум-диске Azure Premium Disk.](sql-database-release-notes.md#exceeding-storage-space-with-small-database-files) | Ограничено имеющимся в настоящее время размером хранения экземпляров (до 1 ТБ - 4 ТБ). |
| Размер файла журнала Max | Ограничено до 2 ТБ и в настоящее время доступны экземпляр хранения размера. | Ограничено до 2 ТБ и в настоящее время доступны экземпляр хранения размера. |
| Операции ввода-вывода в секунду для данных или журнала (приблизительно) | До 30-40 K IOPS за экземпляр, 500 - 7500 за файл<br/>\*[Увеличьте размер файла, чтобы получить больше IOPS](#file-io-characteristics-in-general-purpose-tier)| 10 K - 200 K (2500 IOPS/vCore)<br/>Добавьте больше vCores, чтобы получить лучшую производительность io. |
| Ограничение пропускной записи входа в журнал (в экземпляре) | 3 МБ/с на виртуальное ядро<br/>Макс 22 МБ/с | 4 МБ/с за vCore<br/>Макс. 48 МБ/с |
| Пропускная способность данных (приблизительно) | 100–250 МБ/с на каждый файл<br/>\*[Увеличьте размер файла, чтобы повысить производительность истогов](#file-io-characteristics-in-general-purpose-tier) | Не ограничено. |
| Задержка истого хранилища (приблизительная) | 5–10 мс | 1–2 мс |
| Выполняющаяся в памяти OLTP | Не поддерживается | Доступно, [размер зависит от количества vCore](#in-memory-oltp-available-space) |
| Макс сессий | 30 000 | 30 000 |
| [Только для чтения реплики](sql-database-read-scale-out.md) | 0 | 1 (включенв в цену) |

> [!NOTE]
> - **В настоящее время доступный размер хранилища экземпляра** — это разница между зарезервированным размером экземпляра и используемым пространством для хранения.
> - Размеры данных и файла журнала в системных базах данных и базах данных пользователей включаются в размер хранилища экземпляра, который сравнивается с пределом максимального размера хранилища. Используйте системное представление <a href="https://docs.microsoft.com/sql/relational-databases/system-catalog-views/sys-master-files-transact-sql">sys.master_files</a>, чтобы определить общий объем, используемый базами данных. Журналы ошибок не сохраняются и не включаются в размер. Резервные копии не включаются в размер хранилища.
> - Пропускная часть и IOPS на уровне Общего назначения также зависят от [размера файла,](#file-io-characteristics-in-general-purpose-tier) который явно не ограничен управляемым экземпляром.
> - Можно создать еще одну читаемую реплику в разных регионах Azure с помощью групп автоматического отказа.
> - Макс экземпляр IOPS зависит от макета файла и распределения рабочей нагрузки. Например, если вы создаете файлы 7 x 1 ТБ с максимальным 5K IOPS каждый и 7 небольших файлов (меньше, чем 128 ГБ) с 500 IOPS каждый, вы можете получить 38500 IOPS в экземпляре (7x5000'7x500), если ваша рабочая нагрузка может использовать все файлы. Обратите внимание, что некоторое количество IOPS также используется для автоматического резервного копирования.

> [!NOTE]
> В этой статье найти более подробную информацию об [ограничениях ресурсов в управляемых пулах экземпляров.](sql-database-instance-pools.md#instance-pools-resource-limitations)

### <a name="file-io-characteristics-in-general-purpose-tier"></a>Характеристики истогофайлного файла на уровне общего назначения

В общем уровне службы назначения каждый файл базы данных получает выделенные IOPS и пропускную систему, которая зависит от размера файла. Большие файлы получают больше IOPS и пропускной их. Характеристики IO файлов базы данных отображаются в следующей таблице:

| Размер файла | >No0 и <128 GiB | >128 и <No256 GiB | >256 и <512 GiB | >0,5 и <No1 TiB    | >1 и <No2 TiB    | >2 и <No4 TiB | >4 и <No8 TiB |
|---------------------|-------|-------|-------|-------|-------|-------|-------|
| IOPS на файл       | 500   | 1100 | 2300              | 5000              | 7500              | 7500              | 12 500   |
| Пропускная часть на файл | 100 МиБ/с | 125 МиБ/с | 150 МиБ/с | 200 МиБ/с | 250 МиБ/с | 250 МиБ/с | 480 МБ/с | 

Если вы заметили высокую задержку в итог в каком-либо файле базы данных или видите, что IOPS/пропускная способность достигает предела, вы можете повысить производительность за счет [увеличения размера файла.](https://techcommunity.microsoft.com/t5/Azure-SQL-Database/Increase-data-file-size-to-improve-HammerDB-workload-performance/ba-p/823337)

Существуют также ограничения уровня экземпляра, такие как максимальная пропускная запись журнала 22 МБ/с, так что вы не сможете достичь файла во всем файле журнала, потому что вы достигаете предела пропускной записи экземпляра.

## <a name="supported-regions"></a>Поддерживаемые регионы

Управляемые экземпляры могут быть созданы только в [поддерживаемых регионах.](https://azure.microsoft.com/global-infrastructure/services/?products=sql-database&regions=all) Для создания управляемого экземпляра в регионе, который в настоящее время не поддерживается, можно [отправить запрос поддержки через портал Azure.](quota-increase-request.md)

## <a name="supported-subscription-types"></a>Поддерживаемые типы подписок

Управляемый экземпляр в настоящее время поддерживает развертывание только по следующим типам подписок:

- [Соглашение Enterprise (EA)](https://azure.microsoft.com/pricing/enterprise-agreement/)
- [Оплата по мере того как-вы-go](https://azure.microsoft.com/offers/ms-azr-0003p/)
- [Поставщик облачных услуг (CSP)](https://docs.microsoft.com/partner-center/csp-documents-and-learning-resources)
- [Enterprise — разработка и тестирование](https://azure.microsoft.com/offers/ms-azr-0148p/)
- [Pay-As-You-Go Dev/Test](https://azure.microsoft.com/offers/ms-azr-0023p/)
- [Подписка с ежемесячным кредитом Azure для подписчиков Visual Studio](https://azure.microsoft.com/pricing/member-offers/credit-for-visual-studio-subscribers/)

## <a name="regional-resource-limitations"></a>Ограничение подписок по регионам

Поддерживаемые типы подписок могут содержать ограниченное число ресурсов на регион. Управляемый экземпляр имеет два лимита по умолчанию в регионе Azure (которые могут быть увеличены по требованию путем создания специального [запроса поддержки на портале Azure в](quota-increase-request.md) зависимости от типа подписки:

- **Ограничение подсети**. Максимальное количество подсетей, в которых развернуты управляемые экземпляры в одном регионе.
- **vCore ограничение единицы**: Максимальное количество единиц vCore, которые могут быть развернуты во всех экземплярах в одном регионе. Один GP vCore использует один vCore единицы и один до н.э. vCore занимает 4 vCore единиц. Общее количество экземпляров не ограничено до тех пор, пока оно находится в пределах лимита единицы vCore.

> [!Note]
> Эти ограничения являются параметрами по умолчанию, а не техническими ограничениями. Ограничения могут быть увеличены по запросу, создав специальный запрос поддержки на [портале Azure,](quota-increase-request.md) если вам нужно больше управляемых экземпляров в текущем регионе. В качестве альтернативы можно создать новые управляемые экземпляры в другом регионе Azure без отправки запросов поддержки.

В следующей таблице **показаны региональные ограничения по умолчанию** для поддерживаемых типов подписок (ограничения по умолчанию могут быть расширены с помощью запроса поддержки, описанного ниже):

|Тип подписки| Максимальное количество подсетей управляемых экземпляров | Максимальное количество единиц vCore |
| :---| :--- | :--- |
|Оплата по мере использования|3|320|
|CSP |8 (15 в некоторых регионах)|960 (1440 в некоторых регионах)|
|Разработка и тестирование с оплатой по мере использования|3|320|
|Enterprise — разработка и тестирование|3|320|
|EA|8 (15 в некоторых регионах)|960 (1440 в некоторых регионах)|
|Visual Studio Enterprise|2 |64|
|Визуальная студия Профессионал и MSDN Платформы|2|32|

\*При планировании развертывания, пожалуйста, примите во внимание, что уровень обслуживания Business Critical (BC) требует в четыре (4) раза больше емкости vCore, чем уровень обслуживания общего назначения (GP). Например: 1 GP vCore - 1 vCore единицы и 1 до н.э. vCore 4 vCore единиц. Чтобы упростить анализ потребления с ограничениями по умолчанию, обобщите единицы vCore во всех подсетях в регионе, где развернуты управляемые экземпляры, и сравните результаты с ограничениями единицы экземпляра для вашего типа подписки. **Максимальное количество ограничений vCore на** каждую подписку в регионе. Существует никаких ограничений на отдельные подсети, за исключением того, что сумма всех vCores развернуты через несколько подсетей должны быть ниже или равна **максимальному количеству vCore единиц.**

\*\*Более крупные ограничения подсети и vCore доступны в следующих регионах: Австралия Восток, Восточная ЧАСТЬ США, Восточная США 2, Северная Европа, южная центральная часть США, юго-восточная Азия, Великобритания на юге, Западная Европа, Западная США 2.

## <a name="request-a-quota-increase-for-sql-managed-instance"></a>Запросить увеличение квоты для управляемого экземпляра S'L

Если вам нужно больше управляемых экземпляров в текущих регионах, отправьте запрос поддержки на расширение квоты с помощью портала Azure. Для получения дополнительной [Request quota increases for Azure SQL Database](quota-increase-request.md)информации см.

## <a name="next-steps"></a>Дальнейшие действия

- Для получения дополнительной информации [What is a managed instance?](sql-database-managed-instance.md)об управляемом экземпляре см.
- Для получения информации о ценах [см.](https://azure.microsoft.com/pricing/details/sql-database/managed/)
- Чтобы узнать, как создать свой первый управляемый экземпляр, [см.](sql-database-managed-instance-get-started.md)
