---
title: Возможности работы с несколькими моделями в базе данных SQL Azure
description: База данных SQL Azure позволяет работать с несколькими моделями данных в одной базе данных.
services: sql-database
ms.service: sql-database
ms.subservice: development
ms.custom: ''
ms.devlang: ''
ms.topic: conceptual
author: jovanpop-msft
ms.author: jovanpop
ms.reviewer: ''
ms.date: 12/17/2018
ms.openlocfilehash: 0d59db65e940cab12dccaeeacc9083eb7fbba20e
ms.sourcegitcommit: 018e3b40e212915ed7a77258ac2a8e3a660aaef8
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/07/2019
ms.locfileid: "73795763"
---
# <a name="multi-model-capabilities-of-azure-sql-database"></a>Возможности при использовании нескольких моделей в службе "База данных SQL Azure"

Многомодельные базы данных позволяют хранить данные, представленные в нескольких форматах, например реляционные данные, графы, JSON- или XML-документы, пары "ключ — значение", и работать с ними.

## <a name="when-to-use-multi-model-capabilities"></a>Когда следует использовать возможности нескольких моделей

База данных SQL Azure предназначена для работы с реляционной моделью, которая в большинстве случаев обеспечивает лучшую эффективность для приложений общего назначения. Тем не менее База данных SQL Azure может работать и с другими данными, кроме реляционных. База данных SQL Azure позволяет использовать ряд нереляционных форматов, которые тесно интегрируются в реляционную модель.
Вы должны использовать Многомодельные возможности базы данных SQL Azure в следующих случаях:
- У вас есть некоторые сведения или структуры, которые лучше подходят для моделей NoSQL и вы не хотите использовать отдельную базу данных NoSQL.
- Большая часть данных подходит для реляционной модели, и необходимо моделировать некоторые части данных в стиле NoSQL.
- Вы хотите использовать многофункциональный язык Transact-SQL для запроса и анализа реляционных и NoSQL данных, а также интегрировать его с различными инструментами и приложениями, которые могут использовать язык SQL.
- Вы хотите применить такие функции базы данных, как [технологии в памяти](sql-database-in-memory.md) , чтобы повысить производительность аналитической или обрабатывающей структуры данных NoSQL, использовать [репликацию транзакций](sql-database-managed-instance-transactional-replication.md) или доступные для [чтения реплики](sql-database-read-scale-out.md) для создания копии данных. другое место и разгрузка некоторых аналитических рабочих нагрузок из базы данных источника.

## <a name="overview"></a>Обзор

Эта служба предоставляет следующие возможности при использовании нескольких моделей:
- [Функции графа](#graph-features). Позволяют представлять данные в виде набора узлов и ребер, а также запрашивать данные графа, используя стандартные запросы Transact-SQL, улучшенные за счет оператора графа `MATCH`.
- [Возможности JSON](#json-features). Позволяют помещать JSON-документы в таблицы, преобразовывать реляционные данные в JSON-документы и наоборот. Вы можете использовать стандартный язык Transact-SQL, расширенный с помощью функций JSON, чтобы выполнять синтаксический анализ документов, и некластеризованные индексы, индексы columnstore или таблицы, оптимизированные для памяти, чтобы оптимизировать запросы.
- [Пространственные функции](#spatial-features). Позволяют хранить географические и геометрические данные, индексировать их с использованием пространственных индексов и извлекать данные с помощью пространственных запросов.
- [Возможности XML](#xml-features). Позволяют хранить, индексировать XML-данные в базе данных и использовать собственные операции XQuery и XPath для работы с XML-данными. В базе данных SQL Azure есть специальный встроенный модуль XML-запросов, который обрабатывает XML-данные.
- [Пары "ключ-значение"](#key-value-pairs) не поддерживаются явно в качестве специальных функций, так как пары "ключ-значение" могут быть изначально смоделированы как таблицы с двумя столбцами.

  > [!Note]
  > Вы можете использовать выражение пути JSON, выражения XQuery/XPath, пространственные функции и выражения запроса по графам в одном запросе Transact-SQL для доступа к любым данным, хранящимся в базе данных. Кроме того, любое средство или язык, поддерживающие выполнение запросов Transact-SQL, также могут использовать этот интерфейс запросов для доступа к данным нескольких моделей. Это ключевое различие в сравнении с многомодельными базами данных, такими как [Azure Cosmos DB](/azure/cosmos-db/), которое предоставляет специальный API для различных моделей данных.

В следующих разделах вы узнаете о наиболее важных возможностях при использовании нескольких моделей, которые предоставляет служба "База данных SQL Azure".

## <a name="graph-features"></a>Функции графа

База данных SQL Azure предоставляет возможности графовой базы данных, чтобы моделировать связь "многие ко многим" в базе данных. Граф состоит из узлов (или вершин) и ребер (или связей). Узел представляет сущность (например, пользователя или организацию), а ребро — связь между двумя узлами, которые оно соединяет (например, отметки "Нравится" или друзья). Ниже приведены некоторые функции, благодаря которым графовая база данных является уникальной.
- Ребра или связи в графовой базе данных являются сущностями первого класса, с которым могут быть связаны атрибуты или свойства.
- Одно ребро может гибко соединить несколько узлов в графовой базе данных.
- Вы можете легко выразить запросы на сопоставление шаблонов и навигацию со множеством переходов.
- Вы можно легко выразить транзитивное замыкание и полиморфные запросы.

Связи графа и возможности запроса графа интегрированы в Transact-SQL и получают преимущества использования SQL Server в качестве основополагающей системы управления базами данных.
[Обработка графа](https://docs.microsoft.com/sql/relational-databases/graphs/sql-graph-overview) является ключевой возможностью ядра СУБД SQL Server. По этой ссылке вы можете найти дополнительные сведения об этой возможности.

### <a name="when-to-use-a-graph-capability"></a>Когда следует использовать возможности графа

Все, чего можно достигнуть с графовой базой данных, возможно и с реляционной базой данных. Тем не менее графовая база данных может упростить выражение определенных запросов. Графовую базу данных следует использовать при наличии следующих условий:

- При моделировании иерархических данных, в которых один узел может иметь несколько родительских элементов ( в таком случае HierarchyId нельзя использовать).
- Модель вашего приложения содержит сложные связи "многие ко многим": по мере развития приложения добавляются новые связи.
- Вам необходимо анализировать взаимосвязанные данные и связи.

## <a name="json-features"></a>Возможности JSON

База данных SQL Azure позволяет анализировать и запрашивать данные, представленные в формате [JSON](https://www.json.org/) (нотация объектов JavaScript), и экспортировать реляционные данные в виде текста JSON.

JSON – это распространенный формат данных, который используются для обмена данными в современных мобильных и веб-приложениях. Кроме того, формат JSON используется для хранения частично структурированных данных в файлах журнала или базах данных NoSQL, например [базе данных Azure Cosmos DB](https://azure.microsoft.com/services/cosmos-db/). Многие веб-службы REST возвращают результаты в виде текста JSON или принимают данные в формате JSON. Большинство служб Azure, таких как [azure когнитивный Поиск](https://azure.microsoft.com/services/search/), служба [хранилища Azure](https://azure.microsoft.com/services/storage/)и [Azure Cosmos DB](https://azure.microsoft.com/services/cosmos-db/) , имеют конечные точки RESTful, возвращающие или использующие JSON.

База данных SQL Azure позволяет легко работать с данными JSON и интегрировать свою базу данных с современными службами. База данных SQL Azure предоставляет следующие функции для работы с данными JSON.

![Функции JSON](./media/sql-database-json-features/image_1.png)

Если имеется текст JSON, то можно извлечь данные из JSON или проверить правильность его форматирования с помощью встроенных функций [JSON_VALUE](https://msdn.microsoft.com/library/dn921898.aspx), [JSON_QUERY](https://msdn.microsoft.com/library/dn921884.aspx) и [ISJSON](https://msdn.microsoft.com/library/dn921896.aspx). Функция [JSON_MODIFY](https://msdn.microsoft.com/library/dn921892.aspx) позволяет обновить значение внутри текста JSON. Если требуются более сложные запросы и анализ, то с помощью функции [OPENJSON](https://msdn.microsoft.com/library/dn921885.aspx) можно преобразовать массив объектов JSON в набор строк. С возвращенным результирующим набором можно выполнить любой SQL-запрос. Наконец, можно использовать предложение [FOR JSON](https://msdn.microsoft.com/library/dn921882.aspx) , которое позволяет форматировать данные, хранящиеся в реляционных таблицах в виде текста JSON.

Дополнительные сведения см. в статье о [работе с данными JSON в Базе данных SQL](sql-database-json-features.md).
[JSON](https://docs.microsoft.com/sql/relational-databases/json/json-data-sql-server) является ключевой возможностью ядра СУБД SQL Server. По этой ссылке вы можете найти дополнительные сведения о возможностях JSON.

### <a name="when-to-use-a-json-capability"></a>Когда следует использовать возможность JSON

Модели документов могут использоваться вместо реляционных моделей в некоторых конкретных сценариях:
- Высокая нормализация схемы не приносит значительных преимуществ, так как вы одновременно получаете доступ ко всем полям объектов или никогда не обновляете нормализованные части объектов. Тем не менее нормализованная модель увеличивает сложность запросов из-за большего количества таблиц, которые необходимо соединить для получения данных.
- Вы работаете с приложениями, которые изначально используют JSON-документы и в которых применяются модели обмена данными или модели данных, и вы не хотите вводить дополнительные уровни, преобразовывающие реляционные данные в формат JSON и наоборот.
- Необходимо упростить модель данных путем отмены нормализации дочерних таблиц или шаблонов "сущность — объект — значение".
- Вам нужно загрузить или экспортировать данные, хранящиеся в формате JSON, без использования какого-либо дополнительного средства, анализирующего данные.

## <a name="spatial-features"></a>Пространственные функции

Пространственные данные представляют сведения о физическом расположении и форме геометрических объектов. Эти объекты могут быть расположениями точек или более сложными объектами, такими как страны, регионы, дороги или озера.

База данных SQL Azure поддерживает два типа пространственных данных — геометрический и географический.
- Геометрический тип данных представляет данные в евклидовой (плоской) системе координат,
- а географический — в сферической.

В базе данных SQL Azure может использоваться ряд пространственных объектов, например [точка](https://docs.microsoft.com/sql/relational-databases/spatial/point), [ломаная](https://docs.microsoft.com/sql/relational-databases/spatial/linestring), [многоугольник](https://docs.microsoft.com/sql/relational-databases/spatial/polygon) и т. д.

База данных SQL Azure также предоставляет специализированные [пространственные индексы](https://docs.microsoft.com/sql/relational-databases/spatial/spatial-indexes-overview), которые можно использовать для повышения производительности пространственных запросов.

[Пространственная поддержка](https://docs.microsoft.com/sql/relational-databases/spatial/spatial-data-sql-server) является ключевой возможностью ядра СУБД SQL Server. По этой ссылке вы можете найти дополнительные сведения о пространственной функции.

## <a name="xml-features"></a>Функции XML

SQL Server предоставляет мощную платформу для разработки многофункциональных приложений, управляющих частично структурированными данными. Поддержка XML интегрирована во все компоненты в SQL Server и включает в себя следующее:

- Тип XML-данных. Значения XML можно изначально хранить в столбце типа XML-данных, который можно типизировать в соответствии с коллекцией схем XML или оставить нетипизированным. XML-столбец можно индексировать.
- Возможность указывать запросы XQuery к XML-данным, хранящимся в столбцах и переменных типа XML. Функции XQuery можно использовать в любом запросе Transact-SQL, который получает доступ к любой модели данных, используемой в базе данных.
- Можно автоматически индексировать все элементы в XML-документах с использованием [первичного XML-индекса](https://docs.microsoft.com/sql/relational-databases/xml/xml-indexes-sql-server#primary-xml-index) или указать точные пути, которые должны индексироваться с использованием [вторичного XML-индекса](https://docs.microsoft.com/sql/relational-databases/xml/xml-indexes-sql-server#secondary-xml-indexes).
- OPENROWSET, позволяющий применять массовую загрузку XML-данных.
- Преобразование реляционных данных в XML-формат.

[XML](https://docs.microsoft.com/sql/relational-databases/xml/xml-data-sql-server) является ключевой возможностью ядра СУБД SQL Server. По этой ссылке вы можете найти дополнительные сведения о ней.

### <a name="when-to-use-an-xml-capability"></a>Когда следует использовать возможность XML

Модели документов могут использоваться вместо реляционных моделей в некоторых конкретных сценариях:
- Высокая нормализация схемы не приносит значительных преимуществ, так как вы одновременно получаете доступ ко всем полям объектов или никогда не обновляете нормализованные части объектов. Тем не менее нормализованная модель увеличивает сложность запросов из-за большего количества таблиц, которые необходимо соединить для получения данных.
- Вы работаете с приложениями, которые изначально используют XML-документы и в которых применяются модели обмена данными или модели данных, и вы не хотите вводить дополнительные уровни, преобразовывающие реляционные данные в формат XML и наоборот.
- Необходимо упростить модель данных путем отмены нормализации дочерних таблиц или шаблонов "сущность — объект — значение".
- Вам нужно загрузить или экспортировать данные, хранящиеся в формате XML, без использования какого-либо дополнительного средства, анализирующего данные.

## <a name="key-value-pairs"></a>Пары "ключ-значение"

В Базе данных SQL Azure нет специализированных типов или структур, поддерживающих пары "ключ — значение", так как их структуры изначально представляются в виде стандартных реляционных таблиц:

```sql
CREATE TABLE Collection (
  Id int identity primary key,
  Data nvarchar(max)
)
```

Вы можете настраивать эту структуру пар "ключ — значение" в соответствии со своими потребностями без каких-либо ограничений. Например, значение может быть XML-документом, а не типом `nvarchar(max)`. Если значение является JSON-документом, вы можете поместить ограничение `CHECK`, которое проверяет правильность содержимого JSON. Вы можете помещать любое количество значений, связанных с одним ключом, в дополнительные столбцы, добавлять вычисляемые столбцы и индексы, чтобы упростить и оптимизировать доступ к данным, определить таблицу в качестве таблицы, оптимизированной для памяти, или таблицы, предназначенной только с оптимизированной схемой, чтобы достичь более высокой производительности и т. д.

Ознакомьтесь с тем, [как BWin использует выполняющуюся в памяти OLTP для достижения беспрецедентной производительности и масштаба](https://blogs.msdn.microsoft.com/sqlcat/20../../how-bwin-is-using-sql-server-2016-in-memory-oltp-to-achieve-unprecedented-performance-and-scale/) для своих решений кэширования ASP.NET, кэширующих 1 200 000 пакетов в секунду, для примера того, как реляционные модели могут эффективно использоваться в качестве решения пар "ключ — значение" на практике.

## <a name="next-steps"></a>Дальнейшие действия
Возможности при использовании нескольких моделей баз данных SQL Azure также выступают основными функциями ядра СУБД SQL Server, которые являются общими для Базы данных SQL Azure и SQL Server. Чтобы получить дополнительные сведения об этих возможностях, посетите страницы документации по реляционной базе данных SQL:

* [Обработка Graph](https://docs.microsoft.com/sql/relational-databases/graphs/sql-graph-overview)
* [Данные JSON](https://docs.microsoft.com/sql/relational-databases/json/json-data-sql-server)
* [Пространственные данные (SQL Server)](https://docs.microsoft.com/sql/relational-databases/spatial/spatial-data-sql-server)
* [XML-данные (SQL Server)](https://docs.microsoft.com/sql/relational-databases/xml/xml-data-sql-server)
