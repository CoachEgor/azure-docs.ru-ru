---
title: Оценка уязвимостей SQL
description: Узнайте, как настроить оценку уязвимости си-Л в базе данных Azure S'L и интерпретировать отчеты об оценке.
services: sql-database
ms.service: sql-database
ms.subservice: security
ms.custom: ''
ms.devlang: ''
ms.topic: conceptual
author: mibar
ms.author: mibar
ms.reviewer: vanto, carlrab
ms.date: 04/19/2020
tags: azure-synapse
ms.openlocfilehash: 80629898b56f81fc738cb30df63766ea39adea6d
ms.sourcegitcommit: acb82fc770128234f2e9222939826e3ade3a2a28
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/21/2020
ms.locfileid: "81684253"
---
# <a name="sql-vulnerability-assessment-helps-you-identify-database-vulnerabilities"></a>Оценка уязвимости ВЗЛ помогает выявить уязвимости базы данных

Оценка уязвимости S'L — это простая в настройке служба, которая может обнаруживать, отслеживать и помогать вам устранять потенциальные уязвимости базы данных. Используйте его, чтобы с упреждением повышать безопасность своей базы данных.

Оценка уязвимости является частью расширенного предложения [по безопасности данных,](sql-database-advanced-data-security.md) которое представляет собой единый пакет для передовых возможностей безопасности S'L. Оценка уязвимости может быть доступна и управляется через центральный портал расширенной безопасности данных S'L.

> [!NOTE]
> Оценка уязвимости поддерживается в базе данных Azure S'L, управляемом экземпляре базы данных Azure S'L и azure Synapse Analytics. Чтобы было проще, в этой статье База данных SQL используется при обращении к любой из этих служб управляемых баз данных.

## <a name="vulnerability-assessment"></a>Оценка уязвимости

Оценка уязвимости S'L — это служба, обеспечивающая видимость состояния безопасности. Оценка уязвимости включает в себя действия для решения проблем безопасности и повышения безопасности базы данных. Эта служба может помочь в выполнении следующих задач: 

- соблюдение нормативных требований, требующих отчетов о проверке базы данных;
- соблюдение стандартов конфиденциальности данных;
- мониторинг динамической среды базы данных, в которой сложно отслеживать изменения.

Оценка уязвимости — это служба сканирования, встроенная в базу данных Azure S'L. Служба использует базу знаний правил, которые помечают уязвимости безопасности. В нем освещаются отклонения от передовой практики, такие как неправильные настройки, чрезмерные разрешения и незащищенные конфиденциальные данные.

Правила основаны на рекомендациях корпорации Майкрософт и сосредоточены на вопросах безопасности, которые представляют наибольшие риски для вашей базы данных и ее ценных данных. Они охватывают проблемы уровня базы данных и безопасности сервера, такие как настройки брандмауэра сервера и разрешения на уровне сервера. В этих правилах также представлены многие требования различных контролирующих органов, что позволяет соблюдать стандарты соответствия.

Результаты проверки включают в себя практические действия по устранению каждой проблемы, а также настроенные скрипты исправления, если их можно применить. Вы можете настроить отчет об оценке для среды, установив приемлемый базовый упор для:
* Конфигурации разрешений.
* Конфигурации функций.
* Настройки базы данных.

## <a name="implement-vulnerability-assessment"></a>Реализация оценки уязвимости

Следующие шаги реализуют оценку уязвимости в базе данных S'L.

### <a name="1-run-a-scan"></a>1. Выполнить сканирование

В панели базы данных Azure S'L под заголовком **«Безопасность»** выберите **Расширенную безопасность данных.** Затем нажмите **Select Storage** на панели **оценки уязвимости,** чтобы открыть панель настроек оценки уязвимости для всего сервера S'L.

Налажить учетную запись хранения, где будут храниться результаты сканирования всех баз данных на сервере. Дополнительные сведения об учетных записях хранения см. в разделе [Об учетных записях хранения Azure](../storage/common/storage-create-storage-account.md). После настройки хранилища выберите **сканирование** для сканирования базы данных на наличие уязвимостей.

![Проверка базы данных](./media/sql-vulnerability-assessment/pp_va_initialize.png)

  > [!NOTE]
  > Проверка безопасна и не требует большого количества ресурсов. Запуск занимает несколько секунд, и он полностью читается только для чтения. Он не внося никаких изменений в базу данных.

### <a name="2-view-the-report"></a>2. Просмотр отчета

Когда сканирование завершено, отчет сканирования автоматически отображается на портале Azure. В отчете представлен обзор состояния безопасности. В нем перечисляется, сколько проблем было найдено, и их соответствующие проблемы. Результаты включают предупреждения об отклонениях от передовой практики и моментальный снимок параметров, связанных с безопасностью, таких как принципы базы данных и роли и связанные с ними разрешения. Отчет о сканировании также предоставляет карту конфиденциальных данных, обнаруженных в вашей базе данных. Он содержит рекомендации по классификации этих данных с помощью [обнаружения данных и классификации.](sql-database-data-discovery-and-classification.md)

![Просмотр отчета](./media/sql-vulnerability-assessment/pp_main_getstarted.png)

### <a name="3-analyze-the-results-and-resolve-issues"></a>3. Проанализируйте результаты и разрешите проблемы

Просмотрите результаты и определите, какие проблемы в отчете действительно нарушают безопасность в вашей среде. Изучите подробные сведения о каждой проблеме, чтобы понять, как она влияет на безопасность и почему проверка безопасности не пройдена. Используйте практические рекомендации по исправлению, представленные в отчете, чтобы устранить проблему.

![Анализ отчета](./media/sql-vulnerability-assessment/pp_fail_rule_show_remediation.png)

### <a name="4-set-your-baseline"></a>4. Установите базовый упор

При просмотре результатов оценки можно отметить конкретные результаты как приемлемый *базовый уклад* в среде. Базовые показатели — важные параметры, влияющие на содержимое отчета о проверке. При следующих проверках результаты, которые соответствуют базовым показателям, будут рассматриваться как прошедшие проверку. После того как вы установили базовое состояние безопасности, Оценка уязвимости сообщает только об отклонениях от базовой линии. Таким образом, вы можете сосредоточить свое внимание на соответствующих вопросах.

![Настройка базовых показателей](./media/sql-vulnerability-assessment/pp_fail_rule_show_baseline.png)

### <a name="5-run-a-new-scan-to-see-your-customized-tracking-report"></a>5. Выполнить новое сканирование, чтобы увидеть настраиваемый отчет о отслеживании

После завершения настройки **базовых правил**запустите новое сканирование для просмотра настраиваемого отчета. Оценка уязвимости теперь сообщает только о проблемах безопасности, которые отклоняются от утвержденного базового состояния.

![Просмотр настраиваемого отчета](./media/sql-vulnerability-assessment/pp_pass_main_with_baselines.png)

Теперь службу оценки уязвимостей можно использовать, чтобы постоянно отслеживать безопасность базы данных и обеспечивать ее высокий уровень, а также следить за соблюдением политик организации. При необходимости отчетов о соответствии отчеты об оценке уязвимости могут быть полезны для облегчения процесса соблюдения.

### <a name="6-set-up-periodic-recurring-scans"></a>6. Настройка периодических периодических сканирований

Перейдите к настройкам оценки уязвимости, чтобы включить **периодические повторяющиеся скана.** Эта настройка настраивает оценку уязвимости для автоматического выполнения сканирования в базе данных один раз в неделю. Резюме результатов сканирования отправляется на адреса электронной почты, которые вы предоставляете.

![Просмотр настраиваемого отчета](./media/sql-vulnerability-assessment/pp_recurring_scans.png)

### <a name="7-export-an-assessment-report"></a>7. Экспортный отчет об оценке

Выберите **результаты экспортного сканирования** для создания загружаемого отчета Excel о результатах сканирования. Этот отчет содержит сводку, в которой отображается резюме оценки. Отчет включает в себя все неудачные проверки. Она также включает в себя вкладку **Результаты,** которая содержит полный набор результатов сканирования. Результаты включают в себя все проверки, которые были запущены, и детали результата для каждого из них.

### <a name="8-view-scan-history"></a>8. Посмотреть историю сканирования

Выберите **историю сканирования** в панели оценки уязвимости для просмотра истории всех сканирований, ранее запущенных в этой базе данных. Выберите определенное сканирование из списка, чтобы просмотреть подробные результаты.

Теперь службу оценки уязвимостей можно использовать, чтобы постоянно отслеживать безопасность базы данных и обеспечивать ее высокий уровень, а также следить за соблюдением политик организации. При необходимости отчетов о соответствии отчеты об оценке уязвимости могут быть полезны для облегчения процесса соблюдения.

## <a name="manage-vulnerability-assessments-by-using-azure-powershell"></a>Управление оценками уязвимостей с помощью Azure PowerShell

[!INCLUDE [updated-for-az](../../includes/updated-for-az.md)]
> [!IMPORTANT]
> Модуль PowerShell Azure Resource Manager по-прежнему поддерживается базой данных Azure S'L, но все будущие разработки предназначены для модуля Az.Sql. Для этих cmdlets, см [AzureRM.Sql](https://docs.microsoft.com/powershell/module/AzureRM.Sql/). Аргументы для команд в модуле Az и в модулях Azrm существенно идентичны.

Для программного управления оценками уязвимостей можно использовать командлеты Azure PowerShell. Поддерживаемые командлеты:

| Название Cmdlet в качестве ссылки | Описание |
| :-------------------- | :---------- |
| [Clear-AzSqlDatabaseИнформацияОценкаОснование](https://docs.microsoft.com/powershell/module/az.sql/Clear-azSqlDatabaseVulnerabilityAssessmentRuleBaseline) | Очищает базовый условьек правила оценки уязвимости.<br/>Во-первых, установите базовый упор, прежде чем использовать этот cmdlet, чтобы очистить его. |
| [Clear-AzSqlDatabaseОценкаОценка](https://docs.microsoft.com/powershell/module/az.sql/Clear-azSqlDatabaseVulnerabilityAssessmentSetting) | Очищает настройки оценки уязвимости базы данных. |
| [Конверт-AzSqlDatabaseУязвимостьОценкаСкан](https://docs.microsoft.com/powershell/module/az.sql/Convert-azSqlDatabaseVulnerabilityAssessmentScan) | Преобразует результаты оценки уязвимости в файл Excel. |
| [Get-AzSqlDatabaseИнформацияОценкаОснование](https://docs.microsoft.com/powershell/module/az.sql/Get-azSqlDatabaseVulnerabilityAssessmentRuleBaseline) | Получает базовый базовый упор на правило оценки уязвимости для данного правила. |
| [Get-AzSqldatabaseУязвимостьОценкаСканrecord](https://docs.microsoft.com/powershell/module/az.sql/Get-azSqlDatabaseVulnerabilityAssessmentScanRecord) | Получает все записи сканирования уязвимости, связанные с данной базой данных. |
| [Get-AzSqlDatabaseОценкаОценка](https://docs.microsoft.com/powershell/module/az.sql/Get-azSqlDatabaseVulnerabilityAssessmentSetting) | Возвращает параметры оценки уязвимости базы данных. |
| [Set-AzSqlDatabaseИнформацияОценкаОснование](https://docs.microsoft.com/powershell/module/az.sql/Set-azSqlDatabaseVulnerabilityAssessmentRuleBaseline) | Устанавливает базовый укладывание правила оценки уязвимости. |
| [Start-AzSqlDatabaseVulnerabilityОценкаСкан](https://docs.microsoft.com/powershell/module/az.sql/Start-azSqlDatabaseVulnerabilityAssessmentScan) | Триггеры начала сканирования оценки уязвимости. |
| [Обновление-AzSqlDatabaseОценкаОценка](https://docs.microsoft.com/powershell/module/az.sql/Update-azSqlDatabaseVulnerabilityAssessmentSetting) | Обновляет настройки оценки уязвимости базы данных. |
| &nbsp; | &nbsp; |

Пример сценария см. в разделе [Azure SQL Vulnerability Assessment PowerShell support](https://blogs.msdn.microsoft.com/sqlsecurity/20../../azure-sql-vulnerability-assessment-now-with-powershell-support/) (Поддержка PowerShell для оценки уязвимостей Azure SQL).

## <a name="manage-vulnerability-assessment-baseline-rules-by-using-resource-manager-templates"></a>Управление базовыми правилами оценки уязвимости с помощью шаблонов «Менеджер ресурсов»

Для настройки `Microsoft.Sql/servers/databases/vulnerabilityAssessments/rules/baselines` базовых уровней оценки уязвимости с помощью шаблонов Azure Resource Manager используйте этот тип.

Убедитесь, что `vulnerabilityAssessments` перед добавлением базовых линий вы включили на компьютере, который работает с сервером S'L.

Вот пример для определения базового правила VA2065 для освоения и VA1143 для userdb в качестве ресурсов в шаблоне менеджера ресурсов:

```json
   "resources": [
      {
         "type": "Microsoft.Sql/servers/databases/vulnerabilityAssessments/rules/baselines",
         "apiVersion": "2018-06-01-preview",
         "name": "[concat(parameters('server_name'),'/', parameters('database_name') , '/default/VA2065/master')]",
         "properties": {
            "baselineResults": [
               {
                  "result": [
                     "FirewallRuleName3",
                     "StartIpAddress",
                     "EndIpAddress"
                  ]
               },
               {
                  "result": [
                     "FirewallRuleName4",
                     "62.92.15.68",
                     "62.92.15.68"
                  ]
               }
            ]
         },
         "type": "Microsoft.Sql/servers/databases/vulnerabilityAssessments/rules/baselines",
         "apiVersion": "2018-06-01-preview",
         "name": "[concat(parameters('server_name'),'/', parameters('database_name'), '/default/VA2130/Default')]",
         "dependsOn": [
            "[resourceId('Microsoft.Sql/servers/vulnerabilityAssessments', parameters('server_name'), 'Default')]"
         ],
         "properties": {
            "baselineResults": [
               {
                  "result": [
                     "dbo"
                  ]
               }
            ]
         }
      }
   ]
```

Для основной базы данных и базы данных пользователей имена ресурсов определяются по-разному:

* Мастер-база данных - "имя": "Конкат (параметры ("server_name"), "/", параметры ("database_name") ,<b>master</b>'/по умолчанию/VA2065/master ')) ",
* База данных пользователей - "имя": "Конкат (параметры ("server_name") "/", параметры ("database_name") ,<b>default</b>'/по умолчанию/VA2065/default ')) ",
 
 
 Для обработки типов Boolean как истинных/ложных, установите исходный результат с бинарным вводом типа "1"/"0".
 
```json
   {
      "type": "Microsoft.Sql/servers/databases/vulnerabilityAssessments/rules/baselines",
      "apiVersion": "2018-06-01-preview",
      "name": "[concat(parameters('server_name'),'/', parameters('database_name'), '/default/VA1143/Default')]",

      "dependsOn": [
         "[resourceId('Microsoft.Sql/servers/vulnerabilityAssessments', parameters('server_name'), 'Default')]"
      ],

      "properties": {
         "baselineResults": [
            {
               "result": [
                  "1"
               ]
            }
         ]
      }

   }
```

## <a name="next-steps"></a>Следующие шаги  

- Подробнее о [расширенной безопасности данных](sql-database-advanced-data-security.md).
- Подробнее об [открытии и классификации данных.](sql-database-data-discovery-and-classification.md)
