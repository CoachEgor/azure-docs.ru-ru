---
title: 'Служба "База данных SQL Azure": модель на основе виртуальных ядер | Документация Майкрософт'
description: Модель приобретения на основе виртуальное ядро позволяет независимо масштабировать ресурсы вычислений и хранения, сопоставлять локальную производительность и оптимизировать цену.
services: sql-database
ms.service: sql-database
ms.subservice: service
ms.custom: ''
ms.devlang: ''
ms.topic: conceptual
author: stevestein
ms.author: sstein
ms.reviewer: sashan, moslake, carlrab
ms.date: 08/29/2019
ms.openlocfilehash: 4af269faab21207e1a754e309cac16e5e0a94b69
ms.sourcegitcommit: 19a821fc95da830437873d9d8e6626ffc5e0e9d6
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/29/2019
ms.locfileid: "70164345"
---
# <a name="choose-among-the-vcore-service-tiers-and-migrate-from-the-dtu-service-tiers"></a>Выберите один из уровней служб Виртуальное ядро и выполните миграцию с уровней служб DTU.

Модель приобретения на основе виртуальных ядер (Виртуальное ядро) позволяет независимо масштабировать ресурсы вычислений и хранения, сопоставлять локальную производительность и оптимизировать цену. Он также позволяет выбрать поколение оборудования:

- **Го поколения**: До 24 логических процессоров на основе процессоров Intel 2673 v3 (Haswell) с тактовой частотой 2,4 ГГц, виртуальное ядро = 1 PP (физическое ядро), 7 ГБ на виртуальное ядро, подключенный SSD
- **Го поколения**: До 80 логических процессоров на основе процессоров Intel 2673 V4 (Broadwell) с частотой 2,3 ГГц, виртуальное ядро = 1 LP (Hyper-Thread), 5,1 ГБ на виртуальное ядро для подготовленных вычислений и до 24 ГБ на виртуальное ядро для бессерверных вычислений, Fast Енвм SSD

Аппаратное обеспечение 4-го поколения предлагает значительно больше памяти на одно виртуальное ядро. Однако аппаратное обеспечение 5-го поколения позволяет значительно увеличивать масштаб вычислительных ресурсов.

> [!IMPORTANT]
> Новые базы данных го поколения больше не поддерживаются в Восточная Австралия или Южная Бразилия регионах.
> [!NOTE]
> Дополнительные сведения об уровнях служб на основе DTU см. в разделе [уровни служб для модели приобретения на основе DTU](sql-database-service-tiers-dtu.md). Сведения о различиях между уровнями служб для моделей приобретения на основе DTU и виртуальное ядро см. в статье [модели приобретения базы данных SQL Azure](sql-database-purchase-models.md).

## <a name="service-tier-characteristics"></a>Характеристики уровня службы

Модель приобретения на основе виртуальное ядро предоставляет три уровня служб: общее назначение, масштабирование и критически важный для бизнеса. Эти уровни служб отличаются различными размерами вычислений, проектами с высоким уровнем доступности, методами изоляции ошибок, типами и размерами хранилища, а диапазонами ввода-вывода.

Необходимо отдельно настроить необходимое хранилище и период хранения резервных копий. Чтобы задать срок хранения резервной копии, откройте портал Azure, перейдите на сервер (а не в базу данных), а затем выберите **Управление резервными копиями** > **Настройка политики** > **восстановления на момент времени восстановление конфигурации** > **7 — 35 дней**.

В следующей таблице описаны различия между тремя уровнями.

||**Универсальные**|**Критически важный для бизнеса**|**Гипермасштабируемого**|
|---|---|---|---|
|Лучше всего подходит для|Большинства рабочих нагрузок. Предлагает бюджетные, сбалансированные и масштабируемые варианты вычислений и хранения.|Бизнес-приложения с высокими требованиями к вводу-выводу. Обеспечивает наивысшую устойчивость к сбоям, используя несколько изолированных реплик.|Большинство рабочих нагрузок с высоким уровнем масштабируемости и требованиями к масштабированию.|
|Службы вычислений|**Подготовленные вычислений**:<br/>4-е поколение: от 1 до 24 виртуальных ядер<br/>5-е поколение: от 2 до 80 виртуальных ядер<br/>**Бессерверные вычислений**:<br/>5-е поколение: 0,5-16 виртуальных ядер|**Подготовленные вычислений**:<br/>4-е поколение: от 1 до 24 виртуальных ядер<br/>5-е поколение: от 2 до 80 виртуальных ядер|**Подготовленные вычислений**:<br/>4-е поколение: от 1 до 24 виртуальных ядер<br/>5-е поколение: от 2 до 80 виртуальных ядер|
|Память|**Подготовленные вычислений**:<br/>4-е поколение: 7 ГБ на виртуальное ядро<br/>5-е поколение: 5,1 ГБ на виртуальное ядро<br/>**Бессерверные вычислений**:<br/>5-е поколение: До 24 ГБ на виртуальное ядро|**Подготовленные вычислений**:<br/>4-е поколение: 7 ГБ на виртуальное ядро<br/>5-е поколение: 5,1 ГБ на виртуальное ядро |**Подготовленные вычислений**:<br/>4-е поколение: 7 ГБ на виртуальное ядро<br/>5-е поколение: 5,1 ГБ на виртуальное ядро|
|Служба хранилища|Использует удаленное хранилище.<br/>**Подготовленные расчеты для одной базы данных и эластичного пула**:<br/>От 5 ГБ до 4 ТБ<br/>**Бессерверные вычислений**:<br/>5 ГБ — 3 ТБ<br/>**Управляемый экземпляр**: от 32 ГБ до 8 ТБ |Использует локальное хранилище SSD.<br/>**Подготовленные расчеты для одной базы данных и эластичного пула**:<br/>От 5 ГБ до 4 ТБ<br/>**Управляемый экземпляр**:<br/>от 32 ГБ до 4 ТБ |Гибкое автоматическое расширение хранилища при необходимости. Поддерживает до 100 ТБ хранилища. Использует локальное хранилище SSD для кэша локального буфера и локального хранилища данных. Использует удаленное хранилище Azure в качестве последнего долгосрочного хранилища данных. |
|Пропускная способность ввода-вывода (приблизительная)|**Одна база данных и эластичный пул**: 500 операций ввода-вывода в секунду на виртуальное ядро до 40000 максимум операций ввода-вывода.<br/>**Управляемый экземпляр**: Зависит от [размера файла](../virtual-machines/windows/premium-storage-performance.md#premium-storage-disk-sizes).|5000 операций ввода-вывода в секунду на ядро до 200 000 максимум операций ввода-вывода|Масштабирование — многоуровневая архитектура с кэшированием на нескольких уровнях. Действующие операции ввода-вывода будут зависеть от рабочей нагрузки.|
|Доступность|1 реплика, нет реплик для чтения и масштабирования|3 реплики, 1 [реплика чтения и масштабирования](sql-database-read-scale-out.md),<br/>высокий уровень доступности избыточной зоны (HA)|1 реплика для чтения и записи, а также 0-4 [реплики чтения и масштабирования](sql-database-read-scale-out.md)|
|Резервные|[Геоизбыточное хранилище с доступом на чтение (RA-GRS)](../storage/common/storage-designing-ha-apps-with-ragrs.md), 7-35 дней (по умолчанию 7 дней)|[RA-GRS](../storage/common/storage-designing-ha-apps-with-ragrs.md), 7–35 дней (7 дней по умолчанию)|Резервные копии на основе моментального снимка в удаленном хранилище Azure. Эти моментальные снимки используются для быстрого восстановления. Резервные копии создаются мгновенно и не влияют на производительность вычислений ввода-вывода. Восстановление выполняется быстро и не является операцией с объемом данных (в минутах, а не в часах или днях).|
|В памяти|Не поддерживается|Поддерживается|Не поддерживается|
|||

> [!NOTE]
> Бесплатную базу данных SQL Azure на уровне "базовый" можно получить в сочетании с бесплатной учетной записью Azure. Дополнительные сведения см. в статье [Создание управляемой облачной базы данных с помощью бесплатной учетной записи Azure](https://azure.microsoft.com/free/services/sql-database/).

- Дополнительные сведения об ограничениях ресурсов Виртуальное ядро см. в разделе ограничения [ресурсов Виртуальное ядро в пределах одной базы данных](sql-database-vcore-resource-limits-single-databases.md) и [ограничения ресурсов Виртуальное ядро в управляемом экземпляре](sql-database-managed-instance.md#vcore-based-purchasing-model).
- Дополнительные сведения о корпоративных и критически важных уровнях обслуживания см. в статье [Общие и критически важные для бизнеса уровни обслуживания](sql-database-service-tiers-general-purpose-business-critical.md).
- Дополнительные сведения о уровне службы "масштабирование" в модели приобретения на основе виртуальное ядро см. в статье [масштабирование уровня служб](sql-database-service-tier-hyperscale.md).  

## <a name="azure-hybrid-benefit"></a>Преимущество гибридного развертывания Azure

В подготовленной среде вычислений для модели приобретения на основе виртуальное ядро вы можете обмениваться существующими лицензиями по тарифам со скидкой в базе данных SQL с помощью [преимущество гибридного использования Azure для SQL Server](https://azure.microsoft.com/pricing/hybrid-benefit/). Это преимущество Azure позволяет сэкономить до 30% в базе данных SQL Azure, используя локальные лицензии SQL Server с Software Assurance.

![цены](./media/sql-database-service-tiers/pricing.png)

С помощью Преимущество гибридного использования Azure вы можете платить только за базовую инфраструктуру Azure, используя существующую лицензию SQL Server для самого ядра СУБД SQL (цены на базовые вычисления) или платить за базовую инфраструктуру и SQL Server Лицензия (цены, включаемые в лицензию).

Вы можете выбрать или изменить модель лицензирования с помощью портал Azure или с помощью одного из следующих API:

- Чтобы задать или обновить тип лицензии с помощью PowerShell, выполните следующие действия.

  - [New-AzSqlDatabase](https://docs.microsoft.com/powershell/module/az.sql/new-azsqldatabase)
  - [Set-AzSqlDatabase](https://docs.microsoft.com/powershell/module/az.sql/set-azsqldatabase)
  - [New-AzSqlInstance](https://docs.microsoft.com/powershell/module/az.sql/new-azsqlinstance)
  - [Set-AzSqlInstance](https://docs.microsoft.com/powershell/module/az.sql/set-azsqlinstance)

- Чтобы задать или обновить тип лицензии с помощью Azure CLI:

  - [az sql db create](https://docs.microsoft.com/cli/azure/sql/db#az-sql-db-create)
  - [az sql db update](https://docs.microsoft.com/cli/azure/sql/db#az-sql-db-update)
  - [az sql mi create](https://docs.microsoft.com/cli/azure/sql/mi#az-sql-mi-create)
  - [az sql mi update](https://docs.microsoft.com/cli/azure/sql/mi#az-sql-mi-update)

- Чтобы задать или обновить тип лицензии с помощью REST API:

  - [Базы данных: создание или обновление](https://docs.microsoft.com/rest/api/sql/databases/createorupdate)
  - [Базы данных: обновление](https://docs.microsoft.com/rest/api/sql/databases/update)
  - [Управляемые экземпляры. Создание или обновление](https://docs.microsoft.com/rest/api/sql/managedinstances/createorupdate)
  - [Управляемые экземпляры. Обновление](https://docs.microsoft.com/rest/api/sql/managedinstances/update)

## <a name="migrate-from-the-dtu-based-model-to-the-vcore-based-model"></a>Миграция из модели на основе DTU в модель на основе виртуальное ядро

### <a name="migrate-a-database"></a>Перенос базы данных

Перенос базы данных из модели приобретения на основе DTU в модель приобретения на основе виртуальное ядро аналогична обновлению или понижению уровня служб "Стандартный" и "Премиум" в модели приобретения на основе DTU.

### <a name="migrate-databases-with-geo-replication-links"></a>Перенос баз данных с помощью связей георепликации

Миграция из модели на основе DTU в модель приобретения на основе виртуальное ядро аналогична обновлению или понижению отношений георепликации между базами данных на уровнях служб "Стандартный" и "Премиум". Во время миграции не нужно прекращать георепликацию, но необходимо соблюдать следующие правила виртуализации:

- При повышении сначала повысьте уровень производительности базы данных-получателя, а затем — уровень базы данных-источника.
- При понижении следует действовать в обратном порядке: сначала нужно понизить уровень производительности базы данных-источника, а после этого — базы данных-получателя.

При использовании георепликации между двумя эластичными пулами рекомендуется назначить один пул основным, а другой — сервером-получателем. В этом случае при переносе эластичных пулов следует использовать одно и то же руководство по виртуализации. Однако если у вас есть эластичные пулы, которые содержат как первичную, так и базу данных-получатель, рассматривайте пул с более высоким уровнем использования в качестве сервера-источника и следуйте соответствующим правилам.  

В следующей таблице приведены рекомендации по конкретным сценариям миграции.

|Текущий уровень служб|Целевой уровень служб|Тип перемещения|Действия пользователя|
|---|---|---|---|
|Стандарт|Общее назначение|Горизонтальный|Можно выполнять миграцию в любом порядке, но необходимо обеспечить соответствующий размер виртуального ядра*|
|Премиум|Критически важный для бизнеса|Горизонтальный|Можно выполнять миграцию в любом порядке, но необходимо обеспечить соответствующий размер виртуального ядра*|
|Стандарт|Критически важный для бизнеса|Обновить|Сначала необходимо перенести базу данных-получатель|
|Критически важный для бизнеса|Стандарт|Перейти на более раннюю версию|Сначала необходимо перенести базу данных-источник|
|Премиум|Общее назначение|Перейти на более раннюю версию|Сначала необходимо перенести базу данных-источник|
|Общее назначение|Премиум|Обновить|Сначала необходимо перенести базу данных-получатель|
|Критически важный для бизнеса|Общее назначение|Перейти на более раннюю версию|Сначала необходимо перенести базу данных-источник|
|Общее назначение|Критически важный для бизнеса|Обновить|Сначала необходимо перенести базу данных-получатель|
||||

\*Каждые 100 DTU на уровне Standard требуется по крайней мере 1 Виртуальное ядро, а для каждых 125 DTU на уровне Premium требуется по крайней мере 1 Виртуальное ядро.

### <a name="migrate-failover-groups"></a>Перенос групп отработки отказа

Перемещение групп отработки отказа с несколькими базами данных требует отдельного перемещения базы данных-источника и базы данных-получателя. Во время этого процесса применяются те же рекомендации и правила последовательности. После преобразования баз данных в модель приобретения на основе виртуальное ядро группа отработки отказа останется в силе с теми же параметрами политики.

### <a name="create-a-geo-replication-secondary-database"></a>Создание базы данных-получателя георепликации

Базу данных-получатель георепликации (геовторичную реплику) можно создать только с помощью того же уровня служб, который использовался для базы данных-источника. Для баз данных с высокой частотой создания журналов рекомендуется создать геовторичный объект с тем же размером вычислений, что и у первичного.

Если вы создаете геовторичную реплику в эластичном пуле для одной базы данных-источника, убедитесь `maxVCore` , что параметр для пула соответствует размеру вычислений базы данных-источника. Если вы создаете геовторичную реплику для первичного пула в другом эластичном пуле, рекомендуется, чтобы пулы имели `maxVCore` одинаковые параметры.

### <a name="use-database-copy-to-convert-a-dtu-based-database-to-a-vcore-based-database"></a>Использование копирования базы данных для преобразования базы данных на основе DTU в базу данных на основе виртуальное ядро

Вы можете скопировать любую базу данных с объемом вычислительных ресурсов на основе DTU в базу данных с объемом вычислительных ресурсов на основе виртуальных ядер без ограничений или соблюдения специальной последовательности, если целевой объем вычислительных ресурсов поддерживает максимальный размер базы данных-источника. Копия базы данных создает моментальный снимок данных на момент начала операции копирования и не синхронизирует данные между источником и целевым объектом.

## <a name="next-steps"></a>Следующие шаги

- Сведения о конкретных размерах вычислений и размерах хранилища, доступных для отдельных баз данных, см. в статье [ограничения ресурсов на основе виртуальное ядро базы данных SQL для отдельных баз](sql-database-vcore-resource-limits-single-databases.md)данных.
- Конкретные размеры вычислений и выбор размера хранилища, доступные для эластичных пулов, см. в разделе [SQL Database Виртуальное ядро Limits for эластичные пулы](sql-database-vcore-resource-limits-elastic-pools.md#general-purpose-service-tier-storage-sizes-and-compute-sizes).
