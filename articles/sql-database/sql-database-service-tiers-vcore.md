---
title: 'Служба "База данных SQL Azure": модель на основе виртуальных ядер | Документация Майкрософт'
description: Модель приобретения на основе виртуальных ядер позволяет независимо масштабировать ресурсы вычисления и хранилища, соответствует производительности локального и оптимизировать затраты.
services: sql-database
ms.service: sql-database
ms.subservice: service
ms.custom: ''
ms.devlang: ''
ms.topic: conceptual
author: stevestein
ms.author: sstein
ms.reviewer: sashan, moslake, carlrab
manager: craigg
ms.date: 06/26/2019
ms.openlocfilehash: e9d1ce3bcd3bf958be0a7837e8416300af03f5a2
ms.sourcegitcommit: f56b267b11f23ac8f6284bb662b38c7a8336e99b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/28/2019
ms.locfileid: "67449749"
---
# <a name="choose-among-the-vcore-service-tiers-and-migrate-from-the-dtu-service-tiers"></a>Выбрать один из уровней служб виртуальное и перенос с уровней служб DTU

Виртуальное ядро (виртуальное)-модель приобретения на основе позволяет независимо масштабировать ресурсы вычисления и хранилища, соответствует производительности локального и оптимизировать затраты. Он также позволяет выбрать поколение аппаратного обеспечения:

- **4-го поколения**: До 24 логических процессоров на основе Intel E5-2673 v3 (Haswell) 2,4 ГГц, виртуальное ядро = 1 PP (физическое ядро), 7 ГБ на ядро, подключенные SSD
- **5-го поколения**: До 80 логических процессоров на основе Intel E5-2673 v4 (Broadwell) 2,3 ГГц, виртуальное ядро = 1 LP (технология hyper threading), 5.1 ГБ на ядро, быстрый диск SSD eNVM

Аппаратное обеспечение 4-го поколения предлагает значительно больше памяти на одно виртуальное ядро. Однако аппаратное обеспечение 5-го поколения позволяет значительно увеличивать масштаб вычислительных ресурсов.

> [!IMPORTANT]
> Новые 4-го поколения базы данных больше не поддерживаются в регионе, AustraliaEast.
> [!NOTE]
> Сведения об уровнях служб на основе DTU, см. в разделе [уровня для модели приобретения на основе DTU служб](sql-database-service-tiers-dtu.md). Сведения о различиях между уровнями служб для основе единиц DTU и модели приобретения на основе виртуальных ядер см. в разделе [базы данных SQL Azure, приобретение моделей](sql-database-purchase-models.md).

## <a name="service-tier-characteristics"></a>Характеристики уровня служб

Модель приобретения на основе виртуальных ядер обеспечивает три уровня служб: общего назначения "," гипермасштабируемость "и" критически важный для бизнеса. Эти уровни служб отличаются, широкий спектр вычислительных операциях разного размера, макеты высокого уровня доступности, изоляции сбоев методы, типы и размеры хранилища и диапазоны ввода-вывода.

Необходимо отдельно настроить необходимое хранилище и период хранения резервных копий. Чтобы настроить срок хранения резервной копии, откройте портал Azure, перейдите на сервер (не базу данных) и перейдите к **по управлению резервными копиями** > **Настройка политики**  >   **Точка на время восстановления конфигурации** > **7 – 35 дней**.

В следующей таблице описаны различия между трех уровней:

||**Универсальные**|**Критически важный для бизнеса**|**Гипермасштабируемый**|
|---|---|---|---|
|Оптимально для|Большинства рабочих нагрузок. Ориентированные на бюджет, Сбалансированные и масштабируемые вычислительные предложения и варианты хранилища.|Бизнес-приложений с высокими требованиями к ввода-вывода. Предлагает самую высокую отказоустойчивость к сбоям, с помощью нескольких изолированных реплик.|Большинства рабочих нагрузок с высокой степенью масштабируемости хранилища и требованиями чтения и масштабирования.|
|Среда выполнения приложений|**Подготовка вычислительных**:<br/>4-е поколение: от 1 до 24 виртуальных ядер<br/>5-е поколение: 2 до 80 виртуальных ядер<br/>**Бессерверных вычислений**:<br/>5-е поколение: 0,5 - 4 виртуальных ядра|**Подготовка вычислительных**:<br/>4-е поколение: от 1 до 24 виртуальных ядер<br/>5-е поколение: 2 до 80 виртуальных ядер|**Подготовка вычислительных**:<br/>4-е поколение: от 1 до 24 виртуальных ядер<br/>5-е поколение: 2 до 80 виртуальных ядер|
|Память|**Подготовка вычислительных**:<br/>4-е поколение: 7 ГБ на виртуальное ядро<br/>5-е поколение: 5,1 ГБ на виртуальное ядро<br/>**Бессерверных вычислений**:<br/>5-е поколение: 3 ГБ на виртуальное ядро|**Подготовка вычислительных**:<br/>4-е поколение: 7 ГБ на виртуальное ядро<br/>5-е поколение: 5,1 ГБ на виртуальное ядро |**Подготовка вычислительных**:<br/>4-е поколение: 7 ГБ на виртуальное ядро<br/>5-е поколение: 5,1 ГБ на виртуальное ядро|
|Хранилище|Использует удаленное хранилище.<br/>**Отдельная база данных подготовленных вычислительных**:<br/>От 5 ГБ до 4 ТБ<br/>**Отдельная база данных бессерверных вычислений**:<br/>5 ГБ — 1 ТБ<br/>**Управляемый экземпляр**: от 32 ГБ до 8 ТБ |Использует локальное хранилище SSD.<br/>**Отдельная база данных подготовленных вычислительных**:<br/>От 5 ГБ до 4 ТБ<br/>**Управляемый экземпляр**:<br/>от 32 ГБ до 4 ТБ |Гибкие автоматическое увеличение размера хранилища, при необходимости. Поддерживает до 100 ТБ хранилища. Использует локальное хранилище SSD для локального буферный пул кэша и локального хранения данных. Использует удаленного хранилища Azure в качестве окончательного долгосрочного хранилища данных. |
|Пропускная способность ввода-вывода (приблизительно)|**Отдельная база данных**: 500 операций ввода-ВЫВОДА на виртуальное ядро с 7000 максимальное значение IOPS.<br/>**Управляемый экземпляр**: Зависит от [размер файла](../virtual-machines/windows/premium-storage-performance.md#premium-storage-disk-sizes).|5 000 операций ввода-вывода в секунду на виртуальное ядро с максимальным количеством 200 000|ИТ — это многоуровневая архитектура с кэшированием на нескольких уровнях. Действующие операций ввода-вывода будет зависеть от рабочей нагрузки.|
|Доступность|1 реплика, отсутствуют реплики для чтения и масштабирования|3 реплики, 1 [реплика чтения и масштабирования](sql-database-read-scale-out.md),<br/>избыточные в пределах зоны высокого уровня доступности (HA)|1 реплика для чтения и записи, а также от 0 до 4 [реплик для чтения и масштабирования](sql-database-read-scale-out.md)|
|Резервные копии|[Геоизбыточное хранилище с доступом для чтения (RA-GRS)](../storage/common/storage-designing-ha-apps-with-ragrs.md), 7 – 35 дней (7 дней по умолчанию)|[RA-GRS](../storage/common/storage-designing-ha-apps-with-ragrs.md), 7–35 дней (7 дней по умолчанию)|На основе моментальных снимков резервных копий в хранилище Azure. Эти моментальные снимки используются для быстрого восстановления. Резервные копии происходят мгновенно и не повлиять на производительность операций ввода-вывода вычислений. Восстановление выполняются быстро и не операцию размер данных (ведения минуты, а не часы или дни).|
|В памяти|Не поддерживается|Поддерживаются|Не поддерживается|
|||

> [!NOTE]
> Вы можете получить бесплатную базу данных Azure SQL на уровень обслуживания basic, в сочетании с бесплатной учетной записью Azure. Дополнительные сведения см. в разделе [Создание управляемой облачной базы данных с помощью бесплатной учетной записи Azure](https://azure.microsoft.com/free/services/sql-database/).

- Дополнительные сведения об ограничениях ресурсов виртуальных ядер см. в разделе [виртуальное ограничения ресурсов в одной базе данных](sql-database-vcore-resource-limits-single-databases.md) и [виртуальное ограничения ресурсов в управляемом экземпляре](sql-database-managed-instance.md#vcore-based-purchasing-model).
- Дополнительные сведения о общего назначения и бизнес-уровнями важная служба, см. в разделе [уровня служб общего назначения "и" критически важный для бизнеса](sql-database-service-tiers-general-purpose-business-critical.md).
- Дополнительные сведения об уровне службы "гипермасштабируемость" в модели приобретения на основе виртуальных ядер см. в разделе [уровня службы Гипермасштабируемого](sql-database-service-tier-hyperscale.md).  

## <a name="azure-hybrid-benefit"></a>Преимущество гибридного использования Azure

В модели приобретения на основе виртуальных ядер на уровне подготовленных вычислительных ресурсов, можно обменять имеющиеся лицензии, получить сниженные тарифы на базу данных SQL с помощью [Преимущество гибридного использования Azure для SQL Server](https://azure.microsoft.com/pricing/hybrid-benefit/). Это преимущество Azure позволяет сохранить до 30% в базе данных SQL Azure с помощью локальной лицензии SQL Server с Software Assurance.

![цены](./media/sql-database-service-tiers/pricing.png)

Благодаря преимуществу гибридного использования Azure вы можете платить только за базовой инфраструктуры Azure с помощью имеющейся лицензии SQL Server для ядра СУБД SQL, сам (базовая вычислительных ресурсов по цене) или вы можете оплатить базовой инфраструктуры и SQL Server лицензия (включенной лицензией цены).

Можно выбрать или изменить модель лицензирования с помощью портала Azure или с помощью одного из следующих API-интерфейсов:

- Чтобы установить или обновить тип лицензии с помощью PowerShell:

  - [New-AzSqlDatabase](https://docs.microsoft.com/powershell/module/az.sql/new-azsqldatabase)
  - [Set-AzSqlDatabase](https://docs.microsoft.com/powershell/module/az.sql/set-azsqldatabase)
  - [New-AzSqlInstance](https://docs.microsoft.com/powershell/module/az.sql/new-azsqlinstance)
  - [Set-AzSqlInstance](https://docs.microsoft.com/powershell/module/az.sql/set-azsqlinstance)

- Чтобы установить или обновить тип лицензии с помощью Azure CLI:

  - [az sql db create](https://docs.microsoft.com/cli/azure/sql/db#az-sql-db-create)
  - [az sql db update](https://docs.microsoft.com/cli/azure/sql/db#az-sql-db-update)
  - [az sql mi create](https://docs.microsoft.com/cli/azure/sql/mi#az-sql-mi-create)
  - [az sql mi update](https://docs.microsoft.com/cli/azure/sql/mi#az-sql-mi-update)

- Чтобы установить или обновить тип лицензии с помощью REST API:

  - [Базы данных: создание или обновление](https://docs.microsoft.com/rest/api/sql/databases/createorupdate)
  - [Базы данных: обновление](https://docs.microsoft.com/rest/api/sql/databases/update)
  - [Управляемые экземпляры. Создание или обновление](https://docs.microsoft.com/rest/api/sql/managedinstances/createorupdate)
  - [Управляемые экземпляры. Обновление](https://docs.microsoft.com/rest/api/sql/managedinstances/update)

## <a name="migrate-from-the-dtu-based-model-to-the-vcore-based-model"></a>Миграция из модели на основе DTU на модель на основе виртуальных ядер

### <a name="migrate-a-database"></a>Миграция базы данных

Миграция базы данных с модель приобретения на основе единиц DTU на модель приобретения на основе виртуальных ядер аналогичен повышения или понижения между уровнями служб "стандартный" и "премиум" в модели приобретения на основе единиц DTU.

### <a name="migrate-databases-with-geo-replication-links"></a>Перенос баз данных с соединениями георепликации

Переход с модели на основе DTU на модель приобретения на основе виртуальных ядер аналогичен повышения или понижения связи георепликации между базами данных на уровнях служб "стандартный" и "премиум". Во время миграции вам не нужно остановить георепликацию, но должны соответствовать следующим правилам виртуализации:

- При повышении сначала повысьте уровень производительности базы данных-получателя, а затем — уровень базы данных-источника.
- При понижении следует действовать в обратном порядке: сначала нужно понизить уровень производительности базы данных-источника, а после этого — базы данных-получателя.

При использовании георепликации между двумя эластичными пулами, рекомендуется назначить один пул как первичный, а другой — как сервер-получатель. В этом случае при перемещении эластичных пулов следует использовать одно и то же руководство виртуализации. Однако при наличии эластичных пулов, содержащих базы данных основного и дополнительного рассматривать пул с более высокую степень использования в качестве основного и соответствующим образом следовать правилам последовательности.  

В следующей таблице приведены рекомендации для конкретных сценариев перемещения:

|Текущий уровень служб|Целевой уровень служб|Тип перемещения|Действия пользователя|
|---|---|---|---|
|Стандартная|Универсальные|Горизонтальный|Можно выполнять миграцию в любом порядке, но необходимо обеспечить соответствующий размер виртуального ядра*|
|"Премиум"|Критически важный для бизнеса|Горизонтальный|Можно выполнять миграцию в любом порядке, но необходимо обеспечить соответствующий размер виртуального ядра*|
|Стандартная|Критически важный для бизнеса|Обновление|Сначала необходимо перенести базу данных-получатель|
|Критически важный для бизнеса|Стандартная|Понижение уровня|Сначала необходимо перенести базу данных-источник|
|Премиум|Универсальные|Понижение уровня|Сначала необходимо перенести базу данных-источник|
|Универсальные|Премиум|Обновление|Сначала необходимо перенести базу данных-получатель|
|Критически важный для бизнеса|Универсальные|Понижение уровня|Сначала необходимо перенести базу данных-источник|
|Универсальные|Критически важный для бизнеса|Обновление|Сначала необходимо перенести базу данных-получатель|
||||

\* Каждые 100 Dtu уровня "стандартный" требуется по крайней мере 1 виртуальное ядро и каждые 125 Dtu уровня "премиум" требуется по крайней мере 1 виртуальное ядро.

### <a name="migrate-failover-groups"></a>Перенос групп отработки отказа

Перемещение групп отработки отказа с несколькими базами данных требует отдельного перемещения базы данных-источника и базы данных-получателя. Во время этого процесса применяются те же рекомендации и правила последовательности. После перевода базы данных модель приобретения на основе виртуальных ядер, группа отработки отказа будет работать с теми же параметрами политики.

### <a name="create-a-geo-replication-secondary-database"></a>Создание базы данных-получателя георепликации

Георепликация базы данных-получателя (данных-получателя георепликации) можно создать только с помощью тот же уровень обслуживания, которая использовалась для базы данных-источника. Для баз данных с частотой высокий уровень ведения журналов рекомендуется создать геореплицируемых данных того же размера вычислений как основной.

Если вы создаете данных-получателя георепликации в эластичном пуле для одной базы данных-источника, убедитесь, что `maxVCore` для пула соответствует размеру вычислений основной базы данных. Если вы создаете в другом пуле эластичных баз данных-получателя георепликации для основного, мы рекомендуем, то пулы имеют одинаковый `maxVCore` параметры.

### <a name="use-database-copy-to-convert-a-dtu-based-database-to-a-vcore-based-database"></a>Использовать копии базы данных для преобразования базы данных на основе DTU в базу данных на основе виртуальных ядер

Вы можете скопировать любую базу данных с объемом вычислительных ресурсов на основе DTU в базу данных с объемом вычислительных ресурсов на основе виртуальных ядер без ограничений или соблюдения специальной последовательности, если целевой объем вычислительных ресурсов поддерживает максимальный размер базы данных-источника. Копия базы данных создает моментальный снимок данных на время начала операции копирования и не будет синхронизировать данные между источником и целью.

## <a name="next-steps"></a>Дальнейшие действия

- Для конкретных вычислительных операциях разного размера и предлагаемыми размерами хранилища, доступные для отдельных баз данных, см. в разделе [ограничения ресурсов на основе виртуального ядра базы данных SQL для отдельных баз данных](sql-database-vcore-resource-limits-single-databases.md).
- Для конкретных вычислительных операциях разного размера и размерах хранилища для эластичных пулов, см. в разделе [ограничения ресурсов на основе виртуального ядра базы данных SQL для эластичных пулов](sql-database-vcore-resource-limits-elastic-pools.md#general-purpose-service-tier-storage-sizes-and-compute-sizes).
