---
title: Обслуживание импорта/экспорта занимает много времени
description: Служба импорта/экспорта базы данных Azure S'L занимает много времени для импорта или экспорта базы данных
ms.custom: seo-lt-2019
services: sql-database
ms.service: sql-database
ms.topic: troubleshooting
author: v-miegge
ms.author: ramakoni
ms.reviewer: ''
ms.date: 09/27/2019
manager: dcscontentpm
ms.openlocfilehash: cf2d9b218fe63414af2446b8562d3ba187b2d395
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "79535771"
---
# <a name="azure-sql-database-importexport-service-takes-a-long-time-to-import-or-export-a-database"></a>Служба импорта/экспорта базы данных Azure S'L занимает много времени для импорта или экспорта базы данных

При использовании службы импорта/экспорта базы данных Azure S'L процесс может занять больше времени, чем ожидалось. В этой статье описаны потенциальные причины такой задержки и альтернативные методы обхода.

## <a name="azure-sql-database-importexport-service"></a>Служба импорта/экспорта базы данных Azure S'L

Служба импорта/экспорта базы данных Azure s'L — это веб-сервис REST, который работает в каждом центре обработки данных Azure. Эта служба вызывается при использовании [базы данных импорта](sql-database-import.md#using-azure-portal) или опции [«Экспорт»](https://docs.microsoft.com/azure/sql-database/sql-database-export#export-to-a-bacpac-file-using-the-azure-portal) для перемещения базы данных S'L на портале Azure. Служба предоставляет бесплатные службы очередей запросов и вычисления для выполнения импорта и экспорта между базой данных Azure S'L и хранилищем Azure Blob.

Операции импорта и экспорта представляют собой не традиционную физическую резервную базу данных, а логические резервные данные базы данных, используюющие специальный формат BACPAC. Формат BACPAC позволяет избежать необходимости использовать физический формат, который может варьироваться между версиями сервера Microsoft S'L и базы данных Azure S'L. Таким образом, его можно использовать для безопасного восстановления базы данных в базе данных сервера S'L и в базе данных S'L.

## <a name="what-causes-delays-in-the-process"></a>Что приводит к задержкам в процессе?

Сервис по импорту/экспорту баз данных Azure S'L предоставляет ограниченное количество вычислительных виртуальных машин (ВМ) в регионе для обработки импортовых и экспортных операций. Вычисление VMs размещается в регионе, чтобы убедиться, что импорт или экспорт позволяет избежать межрегионской пропускной способности задержки и сборов. Если в одном и том же регионе одновременно будет сделано слишком много запросов, могут возникнуть значительные задержки в обработке операций. Время, необходимое для выполнения запросов, может варьироваться от нескольких секунд до нескольких часов.

> [!NOTE]
> Если запрос не обрабатывается в течение четырех дней, служба автоматически отменяет запрос.

## <a name="recommended-solutions"></a>Рекомендуемые решения

Если экспорт базы данных используется только для восстановления после случайного удаления данных, все выпуски базы данных Azure S'L обеспечивают возможность восстановления самообслуживания из системных резервных копирований. Но если вам нужны эти экспортные товары по другим причинам, и если вам требуется последовательно быстрее или более предсказуемые показатели импорта/экспорта, рассмотрим следующие варианты:

* [Экспорт в файл BACPAC с помощью утилиты S'LPackage.](https://docs.microsoft.com/azure/sql-database/sql-database-export#export-to-a-bacpac-file-using-the-sqlpackage-utility)
* [Экспорт в файл BACPAC с помощью студии управления серверами S'L (SSMS).](https://docs.microsoft.com/azure/sql-database/sql-database-export#export-to-a-bacpac-file-using-sql-server-management-studio-ssms)
* Запустите импорт или экспорт BACPAC непосредственно в коде, используя API приложений для базирования данных сервера Microsoft S'L (DacFx). Дополнительные сведения см. в следующих источниках:
  * [Экспорт приложения уровня данных](https://docs.microsoft.com/sql/relational-databases/data-tier-applications/export-a-data-tier-application)
  * [Microsoft.SqlServer.Dac Namespace](https://docs.microsoft.com/dotnet/api/microsoft.sqlserver.dac)
  * [Скачать DACFx](https://www.microsoft.com/download/details.aspx?id=55713)

## <a name="things-to-consider-when-you-export-or-import-an-azure-sql-database"></a>Следует учитывать при экспорте или импорте базы данных Azure S'L

* Все методы, обсуждаемые в этой статье, используют квоту Группы транзакций базы данных (DTU), которая вызывает регулирование службой базы данных Azure S'L. Вы можете [просмотреть статистику DTU для базы данных на портале Azure](https://docs.microsoft.com/azure/sql-database/sql-database-monitor-tune-overview#sql-database-resource-monitoring). Если база данных достигла своих пределов ресурсов, [обновите уровень обслуживания,](https://docs.microsoft.com/azure/sql-database/sql-database-scale-resources) чтобы добавить больше ресурсов.
* В идеале следует запускать клиентские приложения (например, утилиту sqlpackage или пользовательское приложение DAC) из VM в том же регионе, что и база данных S'L. В противном случае могут возникнуть проблемы с производительностью, связанные с задержкой сети.
* Экспорт больших таблиц без кластерных индексов может быть очень медленным или даже привести к сбою. Такое поведение происходит из-за того, что таблица не может быть разделена и экспортирована параллельно. Вместо этого он должен экспортироваться в одной транзакции, что приводит к медленной производительности и потенциальному сбою во время экспорта, особенно для больших таблиц.


## <a name="related-documents"></a>Связанные документы

[Рекомендации при экспорте базы данных SQL Azure](https://docs.microsoft.com/azure/sql-database/sql-database-export#considerations-when-exporting-an-azure-sql-database)
