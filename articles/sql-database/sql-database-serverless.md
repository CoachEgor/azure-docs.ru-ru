---
title: Azure базы данных SQL без сервера (Предварительная версия) | Документация Майкрософт
description: В этой статье описывается новый уровень бессерверных вычислений и сравнивает его с помощью существующего подготовленных вычислительных ресурсов уровня
services: sql-database
ms.service: sql-database
ms.subservice: service
ms.custom: ''
ms.devlang: ''
ms.topic: conceptual
author: oslake
ms.author: moslake
ms.reviewer: sstein, carlrab
manager: craigg
ms.date: 05/07/2019
ms.openlocfilehash: 2ab8f272fc264f153144803be772d381c1780512
ms.sourcegitcommit: f6ba5c5a4b1ec4e35c41a4e799fb669ad5099522
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/06/2019
ms.locfileid: "65143271"
---
# <a name="sql-database-serverless-preview"></a>База данных SQL без сервера (Предварительная версия)

## <a name="what-is-the-serverless-compute-tier"></a>Что такое уровня бессерверных вычислений

База данных SQL без сервера (Предварительная версия) — это уровень вычислений, который ведомостей для размере вычислений, используемый отдельной базы данных в секунду. Без использования сервера — оптимизированы для отдельных баз данных с шаблонами сгладить пиковые нагрузки, которые допускают некоторая задержка в период прогрева вычислений после простоя периоды цены производительности.
Напротив публично доступных предложений в счете сегодня базы данных SQL для размере вычислений подготовленных на почасовой основе. Этот уровень подготовленных вычислительных ресурсов является цены производительности, оптимизированный для отдельных баз данных или эластичного пула с более среднее время использования, не должны отключаться задержек в период прогрева вычислений.

Базы данных на уровне компьютера без сервера является параметризованным, он может использовать диапазон вычислений и autopause задержки.

![бессерверные выставления счетов](./media/sql-database-serverless/serverless-billing.png)

### <a name="performance"></a>Производительность

- `MinVcore` и `MaxVcore` можно настроить параметры, которые определяют область доступной емкости вычислений для базы данных. Ограничения операций ввода-ВЫВОДА и памяти пропорциональны указанный диапазон виртуальных ядер.  
- Autopause задержка — это настраиваемый параметр, который определяет период времени, базы данных должен оставаться неактивным, прежде чем она автоматически приостановлена. Базы данных возобновляется автоматически, при следующем входе в систему.

### <a name="pricing"></a>Цены

- Общая сумма для данных бессерверных баз данных — это совокупность Билла вычислений и счет за хранилище.
Выставление счетов за вычислительные ресурсы зависит объем используется виртуальных ядер и объем памяти, используемый в секунду.
- Минимальным количеством вычислительных выставлен счет основан на минимальное количество виртуальных ядер и памяти min.
- Во время приостановки базы данных, оплачивается только хранилище.

## <a name="scenarios"></a>Сценарии

Без использования сервера — цены и производительности, оптимизированный для отдельных баз данных с шаблонами сгладить пиковые нагрузки, которые допускают некоторая задержка в период прогрева вычислений после периоды простоя. Уровень подготовленных вычислительных ресурсов является цены и производительности, оптимизированный для баз данных одной или в составе пула с более среднее время использования, не должны отключаться задержек в период прогрева вычислений.

В следующей таблице сравниваются уровня бессерверных вычислений на уровне подготовленных вычислительных ресурсов:

||Бессерверные вычисления|Подготовленные вычислительные ресурсы|
|---|---|---|
|**Типичная ситуация**|Базы данных с множественными непредсказуемым использования смешивается с неактивные периоды|Базы данных или эластичные пулы с более обычного использования|
|**Издержек на управление производительностью**|нижний|Выше|
|**Вычисления масштабирование**|Автоматический|Руководство|
|**Вычисления скорости реагирования**|Нижний после неактивные периоды|Немедленно|
|**Степень детализации выставления счетов**|в секунду|В час|
|

### <a name="scenarios-well-suited-for-serverless-compute"></a>Сценарии, которые подходят для бессерверных вычислений

- Отдельные базы данных с множественными закономерностей, смешивается с периодом бездействия могут выиграть от цены экономия рассчитана для выставления счетов в секунду, объема использования вычислительных ресурсов.
- Отдельные базы данных с требований к ресурсам, сложно предсказать и клиенты, которые хотите делегировать вычислений изменения размера в службу.
- Отдельных баз данных на уровне подготовленных вычислительных ресурсов, которая часто менять уровни производительности.

### <a name="scenarios-well-suited-for-provisioned-compute"></a>Сценарии, хорошо подходит для подготовленных вычислительных ресурсов

- Использование со временем вычислительных отдельные базы данных с несколько обычных и более значительным.
- Базы данных, которые не допускают компромиссы с производительностью полученный от более частые памяти обрезки или откладывать в autoresuming из приостановленного состояния.
- Несколько баз данных с множественными закономерностей, которые могут быть объединены в один сервер и использованию эластичных пулов для более качественной оптимизации цены.


## <a name="purchasing-model-and-service-tier"></a>Приобретение модели и уровня службы

Без сервера базы данных SQL является в настоящее время поддерживается только на уровне общего назначения на в модели приобретения виртуальных ядер 5 поколения оборудования.

## <a name="autoscaling"></a>Автомасштабирование

### <a name="scaling-responsiveness"></a>Масштабирование скорость реагирования

Как правило, баз данных следует запускать на компьютере с емкостью, достаточной для удовлетворения требований к ресурсам без прерывания для любого объема вычислений, запрашиваемых в предел, установленный `maxVcores` значение. В некоторых случаях балансировки нагрузки автоматически возникает, если компьютеру не удается, для удовлетворения требований к ресурсам в течение нескольких минут. База данных остается в сети во время балансировки нагрузки, за исключением к краткому периоду в конце операции когда соединения прерываются.

### <a name="memory-management"></a>Управление памятью

Происходит освобождение памяти для бессерверных баз данных чаще, чем для подготовленных баз данных. Это важно для контроля над затратами в бессерверной. В отличие от подготовленных вычислительных ресурсов из кэша SQL происходит освобождение памяти из базы данных без сервера при низком уровне использования ЦП и кэша.

## <a name="autopause-and-autoresume"></a>Autopause и autoresume

### <a name="autopause"></a>Autopause

Autopause срабатывает в том случае, если все следующие условия верны для длительность задержки autopause:

- Количество сеансов = 0
- ЦП = 0 (для пользователя рабочую нагрузку, выполняемую в пуле пользователя)

Чтобы отключить autopause, при необходимости, предусмотрен специальный параметр.

### <a name="autoresume"></a>Autoresume

Autoresume активируется в том случае, если выполняется любое из следующих условий в любое время:

|Компонент|Триггер Autoresume|
|---|---|
|Аутентификация и авторизация|Вход|
|Обнаружение угроз|Включение и отключение настройки обнаружения угроз на уровне базы данных или сервера<br>Изменение настройки обнаружения угроз на уровне базы данных или сервера|
|Обнаружение и классификация данных|Добавление, изменение, удаление или просмотр меток конфиденциальности|
|Аудит|Просмотр записей аудита.<br>Обновление или Просмотр политики аудита|
|Маскирование данных|Добавление, изменение, удаление или Просмотр правил маскировки данных|
|Прозрачное шифрование данных|Представление состояния или состояние прозрачного шифрования данных|
|Хранилище запросов (производительность)|Изменение или просмотр параметров хранилища запросов; Автоматическая настройка|
|Автоматическую|Применение и проверка автоматическую рекомендации, такие как автоматическое индексирование|
|Копирование базы данных|Создание базы данных в качестве копии<br>Экспорт в bacpac-файл|
|Синхронизация данных SQL|Синхронизация между hub и member базами данных, которые выполняются по настраиваемому расписанию или выполняются вручную|
|Изменение некоторых метаданных базы данных|Добавление новых тегов базы данных<br>Изменение максимальное количество виртуальных ядер, минимальное количество виртуальных ядер, autopause задержки|
|SQL Server Management Studio (SSMS);|С помощью среды SSMS версии 18 и открыть новое окно запроса для любой базы данных на сервере будет возобновлена любой автоматическая остановка базы данных на том же сервере. Это происходит, если с помощью SSMS версии 17.9.1 с IntelliSense-отключен.|

### <a name="connectivity"></a>Соединение

Если без сервера базы данных приостановлена, первый вход в систему возобновите базу данных и возвращать сообщение о том, что база данных недоступна. После возобновления базы данных, учетная запись должна быть повторена для установления подключения. Клиенты базы данных с логикой повторных попыток подключения не следует изменять.

### <a name="latency"></a>Latency

Задержка autopause или autoresume данных бессерверных баз данных — обычно порядка 1 минуту.

### <a name="feature-support"></a>Поддержка функций

Следующие функции не поддерживают autopausing и autoresuming. То есть если используются любые из следующих компонентов, затем в оперативном независимо от того, Продолжительность бездействия базы данных:

- Георепликация (активной георепликации и автоматически группы отработки отказа)
- Долгосрочное хранение резервных копий (LTR)
- База данных синхронизации, используемые в синхронизации данных SQL.


## <a name="on-boarding-into-the-serverless-compute-tier"></a>Адаптации в уровня бессерверных вычислений

Создание новой базы данных или перемещение существующей базы данных на уровень бессерверных вычислений следует той же схеме, что и при создании новой базы данных в подготовленных уровня вычислений и состоит из следующих двух шагов:

1. Укажите имя целевой службы. Следующая таблица показывает уровень доступности службы и вычислительных операциях разного размера сейчас доступны в общедоступной предварительной версии.

   |Уровень служб|Объем вычислительных ресурсов|
   |---|---|
   |Общего назначения|GP_S_Gen5_1|
   |Общего назначения|GP_S_Gen5_2|
   |Общего назначения|GP_S_Gen5_4|

2. При необходимости укажите минимальное количество виртуальных ядер и autopause задержку позволяют изменять значения по умолчанию. В следующей таблице показаны доступные значения для этих параметров.

   |Параметр|Варианты значений|Значение по умолчанию|
   |---|---|---|---|
   |Минимальное количество виртуальных ядер|Любой из {0,5, 1, 2, 4} не превышает максимальное количество виртуальных ядер|0,5 виртуальных ядер|
   |Autopause задержки|Минимум: 360 минут (6 часов)<br>Максимум: значение 10080 минут (7 дней)<br>С шагом: 60 минут<br>Отключить autopause: -1|360 минут|

> [!NOTE]
> С помощью T-SQL для перемещения существующей базы данных в бессерверной или изменять свой размер вычислительных сейчас не поддерживается, но можно сделать с помощью портала Azure или PowerShell.

### <a name="create-new-database-using-the-azure-portal"></a>Создать новую базу данных с помощью портала Azure

См. [Краткое руководство. Создание отдельной базы данных в базе данных SQL Azure с помощью портала Azure](sql-database-single-database-get-started.md).

### <a name="create-new-database-using-powershell"></a>Создать новую базу данных с помощью PowerShell

В следующем примере создается новая база данных на уровне бессерверных вычислений, определяется цель службы с именем GP_S_Gen5_4 со значениями по умолчанию минимальное количество виртуальных ядер и autopause задержки.

Без использования сервера требуется более новая версия PowerShell не находится в коллекции, поэтому выполните `Update-Module Az.Sql` получить последнюю версию командлетов без сервера с поддержкой.

```powershell
New-AzSqlDatabase `
  -ResourceGroupName $resourceGroupName `
  -ServerName $serverName `
  -DatabaseName $databaseName `
  -ComputeModel Serverless `
  -Edition GeneralPurpose `
  -ComputeGeneration Gen5 `
  -MinVcore 0.5 `
  -MaxVcore 2 `
  -AutoPauseDelay 720
```

### <a name="move-existing-database-into-the-serverless-compute-tier"></a>Переместить существующую базу данных на уровень бессерверных вычислений

В следующем примере перемещается существующей базы данных одного из подготовленных вычислительных ресурсов уровня на уровень бессерверных вычислений. В этом примере использует значения по умолчанию минимальное количество виртуальных ядер, максимальное количество виртуальных ядер и autopause задержки.

```powershell
Set-AzSqlDatabase
  -ResourceGroupName $resourceGroupName `
  -ServerName $serverName `
  -DatabaseName $databaseName `
  -Edition GeneralPurpose `
  -ComputeModel Serverless `
  -ComputeGeneration Gen5 `
  -MinVcore 1 `
  -MaxVcore 4 `
  -AutoPauseDelay 1440
```

### <a name="move-a-database-out-of-the-serverless-compute-tier"></a>Перемещение базы данных за пределы уровня бессерверных вычислений

Без сервера базы данных можно переместить в подготовленных вычислительных ресурсов уровня в так же, как перемещение подготовленных вычислительных ресурсов базы данных на уровень бессерверных вычислений.

## <a name="modify-serverless-configuration-parameters"></a>Изменение параметров конфигурации без сервера

### <a name="maximum-vcores"></a>Максимальное количество виртуальных ядер

Изменение максимального числа виртуальных ядер выполняется с помощью [набора AzSqlDatabase](https://docs.microsoft.com/powershell/module/az.sql/set-azsqldatabase) команду в PowerShell с помощью `MaxVcore` аргумент.

### <a name="minimum-vcores"></a>Минимальное количество виртуальных ядер

Изменение максимального числа виртуальных ядер выполняется с помощью [набора AzSqlDatabase](https://docs.microsoft.com/powershell/module/az.sql/set-azsqldatabase) команду в PowerShell с помощью `MinVcore` аргумент.

### <a name="autopause-delay"></a>Autopause задержки

Изменение максимального числа виртуальных ядер выполняется с помощью [набора AzSqlDatabase](https://docs.microsoft.com/powershell/module/az.sql/set-azsqldatabase) команду в PowerShell с помощью `AutoPauseDelay` аргумент.

## <a name="monitor-serverless-database"></a>Мониторинг без сервера базы данных

### <a name="resources-used-and-billed"></a>Ресурсы, индивидуально и выставления счетов

Ресурсы данных бессерверных баз данных инкапсулируется следующие сущности:

#### <a name="app-package"></a>Пакет приложения

Пакет приложения имеет внешнюю границу большинство ресурсов управления для базы данных, независимо от того, является ли базы данных в рамках одного уровня вычислений без сервера или подготовленной. Пакет приложения содержит экземпляр SQL и внешних служб вместе области всех пользовательских и системных ресурсов, используемого базой данных в базе данных SQL. Внешние службы примеры R и компонент full-text search. Экземпляр SQL обычно преобладают общее использование ресурсов в пакете приложения.

#### <a name="user-resource-pool"></a>Пул пользовательских ресурсов

Пул пользовательских ресурсов — это внутренний большинство граница управления ресурсов для базы данных, независимо от того, является ли базы данных в рамках одного уровня вычислений без сервера или подготовленной. Пул пользовательских ресурсов области ЦП и ввода-ВЫВОДА для пользователя рабочую нагрузку, создаваемую DDL (например, CREATE, ALTER и др.) и DML запросы (например, SELECT, INSERT, UPDATE, DELETE, и т.д.). Эти запросы обычно представляют наиболее существенные долю использования в пакете приложения.

### <a name="metrics"></a>Метрики

|Сущность|Метрика|ОПИСАНИЕ|Units|
|---|---|---|---|
|Пакет приложения|app_cpu_percent|Процент числа виртуальных ядер, используемых в приложении относительно максимальное количество виртуальных ядер, разрешенное для приложения.|Процент|
|Пакет приложения|app_cpu_billed|Объем вычислений, приложение в счет за отчетный период. Сумма за этот период является произведение эта метрика и цена за единицу виртуальное.<br>Значения метрики определяются путем статистической обработки данных со временем, использовать не более ЦП и памяти используется каждую секунду.<br>Если сумма меньше, чем минимальная сумма, подготавливаются в качестве набора минимальное количество виртуальных ядер и памяти min, минимальный размер подготовленных оплачивается.  Чтобы сравнить ЦП и памяти для выставления счетов, памяти нормализуются в блоки виртуальных ядер масштабирование объем памяти в Гигабайтах по 3 ГБ на виртуальное ядро.|Виртуальное ядро секунд|
|Пакет приложения|app_memory_percent|Процент памяти, используемой приложением относительно максимальный объем памяти, разрешенное для приложения.|Процент|
|Пользовательский пул|cpu_percent|Процент числа виртуальных ядер, используемых рабочую нагрузку для пользователя относительно максимальное количество виртуальных ядер, разрешенное для пользователя рабочей нагрузки.|Процент|
|Пользовательский пул|data_IO_percent|Процент операций ввода-ВЫВОДА, используемых рабочую нагрузку для пользователя относительно данных max операций ввода-ВЫВОДА данных разрешена для пользователя рабочей нагрузки.|Процент|
|Пользовательский пул|log_IO_percent|Процент журнала МБ/с, использовать рабочей нагрузки пользователя относительно max журнала МБ/с может рабочую нагрузку для пользователя.|Процент|
|Пользовательский пул|workers_percent|Процент рабочих процессов, используемых рабочую нагрузку для пользователя относительно max работников, разрешенное для пользователя рабочей нагрузки.|Процент|
|Пользовательский пул|sessions_percent|Процент сеансов, используемые рабочую нагрузку для пользователя относительно максимальное число сеансов, разрешенное для пользователя рабочей нагрузки.|Процент|
____

> [!NOTE]
> Метрики на портале Azure доступны в области базы данных для отдельной базы данных в группе **мониторинг**.

### <a name="pause-and-resume-status"></a>Состояние приостановки и возобновления работы

На портале Azure в области "Обзор" сервера, список баз данных, содержащихся в нем отображается состояние базы данных. Состояние базы данных также отображается в области "Обзор" для базы данных.

Для запроса приостановки и возобновления состояния базы данных, используя следующую команду PowerShell:

```powershell
Get-AzSqlDatabase `
  -ResourceGroupName $resourcegroupname `
  -ServerName $servername `
  -DatabaseName $databasename `
  | Select -ExpandProperty "Status"
```

## <a name="resource-limits"></a>Ограничения ресурсов

Ограничения ресурсов, см. в разделе [уровня Бессерверных вычислений](sql-database-vCore-resource-limits-single-databases.md#serverless-compute-tier)

## <a name="billing"></a>Выставление счетов

Вычислительных ресурсов взимается каждую секунду является максимальным значением, ЦП и памяти, используемой каждую секунду. Если используемый объем ресурсов ЦП, память, используемая меньше, чем минимальная сумма, выделенные для каждого подготовленного объема оплачивается. Чтобы сравнить ЦП и памяти для выставления счетов, памяти нормализуются в блоки виртуальных ядер масштабирование объем памяти в Гигабайтах по 3 ГБ на виртуальное ядро.

- **Ресурс выставлен счет**: ЦП и память
- **Сумма выставлен счет ($)**: цена за единицу виртуальное * max (минимальное количество виртуальных ядер, используемый виртуальных ядер, память min ГБ * 1/3, память используется в ГБ * 1/3) 
- **Периодичность выставления счетов**: в секунду

Вычислительных ресурсов взимается предоставляется следующие метрики:

- **Метрика**: app_cpu_billed (виртуальное секунд)
- **Определение**: max (минимальное количество виртуальных ядер, используемый виртуальных ядер, память min ГБ * 1/3, память используется в ГБ * 1/3) *
- **Частота обращения**: В минуту

> [!NOTE]
> \* Это количество вычисляется каждую секунду и статистическая обработка проводится по 1 минуте.

**Пример**: Рассмотрим базу данных с помощью GP_S_Gen5_4 с следующее использование в течение одного часа.

|Время (часы: минуты)|app_cpu_billed (виртуальное секунд)|
|---|---|
|0:01|63|
|0:02|123|
|0:03|95|
|0:04|54|
|0:05|41|
|0:06 - 1:00|1255|
||Всего: 1631|

Предположим, что цена за единицу вычислительных составляет $0.2609/vCore/hour. Затем выставлен счет за этот период в один час вычислений определяется по следующей формуле: **$0.2609/vCore/hour * секунд виртуальное 1631 * 1 час/3600 секунд = $0.1232**

## <a name="available-regions"></a>Доступные регионы

На уровне бессерверных вычислений доступна во всех регионах, за исключением следующих: Восточная Австралия Central, Китай, Северной части Китая, Южная Франция, Германия центральная Германия, Западная Индия, Южная Корея, ЮАР, Запад, Северная часть соединенного Королевства, Южная часть соединенного Королевства, Западная часть соединенного Королевства и западно-Центральная часть США

## <a name="next-steps"></a>Дальнейшие действия

Ограничения ресурсов, см. в разделе [Бессерверных вычислений ограничениями ресурсов](sql-database-vCore-resource-limits-single-databases.md#serverless-compute-tier).