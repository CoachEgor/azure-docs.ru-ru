---
title: Обзор уровня служб "Гипермасштабирование" Базы данных SQL Azure | Документация Майкрософт
description: В этой статье описывается уровень служб ценовой категории "Гипермасштабирование" в рамках модели приобретения на основе виртуальных ядер в службе "База данных SQL Azure" и объясняется, как он отличается от уровней служб ценовых категорий "Общего назначения" и "Критически важный для бизнеса".
services: sql-database
ms.service: sql-database
ms.subservice: ''
ms.custom: ''
ms.devlang: ''
ms.topic: conceptual
author: stevestein
ms.author: sstein
ms.reviewer: ''
manager: craigg
ms.date: 05/06/2019
ms.openlocfilehash: 0fe098bd644762fb291eb623a7b41cd987c7fa26
ms.sourcegitcommit: 36c50860e75d86f0d0e2be9e3213ffa9a06f4150
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/16/2019
ms.locfileid: "65779192"
---
# <a name="hyperscale-service-tier-for-up-to-100-tb"></a>Уровень обслуживания Гипермасштабируемого до 100 ТБ

База данных SQL Azure основана на архитектуре ядра СУБД SQL Server, которая соответствует облачной среде, чтобы даже в случае сбоя инфраструктуры обеспечить доступность на уровне 99,99 %. Существует три модели архитектуры, которые используются в Базе данных SQL Azure:
- уровни "Общего назначения" или "Стандартный"; 
-  Уровень "Гипермасштабирование"
-  уровни "Критически важный для бизнеса" или "Премиум";

Уровень служб "Гипермасштабирование" в Базе данных SQL Azure — это новейший уровень в рамках модели приобретения на основе виртуальных ядер. Этот высокомасштабируемый уровень производительности ресурсов хранения и вычислений, который использует архитектуру Azure для масштабирования этих ресурсов для службы "База данных SQL Azure" за пределы, доступные для уровней служб "Общего назначения" и "Критически важный для бизнеса".

> 
> [!NOTE]
> См. подробнее об уровнях служб [Общего назначения](sql-database-service-tier-general-purpose.md) и [Критически важный для бизнеса](sql-database-service-tier-business-critical.md) в рамках модели приобретения на основе виртуальных ядер. Сравнение моделей приобретения на основе виртуальных ядер и единиц DTU см. в статье [Ресурсы и модели приобретения для базы данных SQL Azure](sql-database-service-tiers.md).


## <a name="what-are-the-hyperscale-capabilities"></a>Каковы возможности ценовой категории "Гипермасштабирование"?

Уровень служб "Гипермасштабирование" в службе "База данных SQL Azure" предоставляет следующие дополнительные возможности:

- Поддержка размера базы данных до 100 ТБ.
- Практически мгновенное создание резервных копий баз данных (на основе файлов моментальных снимков, хранящихся в хранилище BLOB-объектов Azure) независимо от размера, которое не влияет на операции ввода-вывода вычислительных ресурсов.   
- Быстрое восстановление баз данных (на основе файлов моментальных снимков) за несколько минут, а не часов или дней (вне зависимости от размера операции с данными).
- Более высокая общая производительность благодаря высокой пропускной способности ведения журнала и ускоренному выполнению транзакций независимо от объемов данных.
- Быстрое горизонтальное масштабирование. Вы можете подготовить один или несколько узлов только для чтения, чтобы переносить на них рабочие нагрузки чтения и использовать эти узлы в качестве узлов горячей замены.
- Быстрое увеличение масштаба. Вы можете постоянно увеличивать масштаб вычислительных ресурсов, чтобы размещать крупные рабочие нагрузки по мере необходимости, а затем уменьшать их масштаб, когда они не нужны.

Уровень служб "Гипермасштабирование" устраняет многие практические ограничения, традиционно наблюдаемые в облачных базах данных. В то время как большинство других баз данных ограничены ресурсами, доступными на одном узле, базы данных на уровне служб "Гипермасштабирование" не имеют таких ограничений. Благодаря гибкой архитектуре хранилища его объем растет по мере необходимости. На самом деле базы данных уровня "Гипермасштабирование" не создаются с определенным максимальным размером. База данных уровня "Гипермасштабирование" растет по мере необходимости, поэтому плата взимается только за ту емкость, которую вы используете. Для рабочих нагрузок интенсивного чтения уровень служб "Гипермасштабирование" обеспечивает быстрое горизонтальное масштабирование путем подготовки дополнительных реплик чтения при необходимости перенести рабочие нагрузки.

Кроме того, время, необходимое для создания резервных копий базы данных или увеличения/уменьшения масштаба, больше не привязано к объему данных в базе данных. Резервные копии баз данных уровня "Гипермасштабирование" могут создаваться практически мгновенно. Увеличивать или уменьшать масштаб баз данных с десятками терабайт данных можно за считаные минуты. Вы больше не ограничены первоначальными вариантами конфигурации.

Дополнительные сведения об объемах вычислительных ресурсов см. в разделе [Характеристики уровней служб](sql-database-service-tiers-vcore.md#service-tier-characteristics).

## <a name="who-should-consider-the-hyperscale-service-tier"></a>Кому рекомендуется использовать уровень служб "Гипермасштабирование"

Уровень служб "Гипермасштабирование" в первую очередь предназначен для клиентов с большими локальными базами данных, которые хотят модернизировать свои приложения, перейдя в облако, или для клиентов, которые уже находятся в облаке и ограничены максимальным размером базы данных (1–4 ТБ). Он также предназначен для клиентов, которым нужна высокая производительность и высокая масштабируемость для хранения и вычисления.

Уровень служб "Гипермасштабирование" поддерживает все рабочие нагрузки SQL Server, но в первую очередь он оптимизирован для OLTP. Он также поддерживает гибридные и аналитические (киоск данных) рабочие нагрузки.

> [!IMPORTANT]
> Эластичные пулы не поддерживают уровень служб "Гипермасштабирование".

## <a name="hyperscale-pricing-model"></a>Модель ценообразования для ценовой категории "Гипермасштабирование"

Уровень служб "Гипермасштабирование" доступен только в [модели на основе виртуальных ядер](sql-database-service-tiers-vcore.md). Ввиду новой архитектуры модель ценообразования несколько отличается от уровней служб "Общего назначения" или "Критически важный для бизнеса".

- **Среда выполнения приложений**

  Цена за единицу вычислений ценовой категории "Гипермасштабирование" на реплику. Цена [Преимущества гибридного использования Azure](https://azure.microsoft.com/pricing/hybrid-benefit/) автоматически применяется к репликам с масштабированием для чтения. Мы создадим первичная реплика и одна реплика только для чтения на Гипермасштабируемого базу данных по умолчанию.  Пользователи могут изменять общее число реплик, включая первичную реплику, от 1 до 5.

- **Хранилище**

  Указывать максимальный объем данных при настройке базы данных ценовой категории "Гипермасштабирование" не нужно. На уровне служб ценовой категории "Гипермасштабирование" счета за использование хранилища для базы данных выставляются в зависимости от фактического использования. Автоматически память распределяется между 10 и 100 ТБ с шагом, которые динамически корректируются от 10 до 40 ГБ.  

Дополнительные сведения о ценах категории "Гипермасштабирование" см. в разделе [цен на базу данных SQL Azure](https://azure.microsoft.com/pricing/details/sql-database/single/).

## <a name="distributed-functions-architecture"></a>Архитектура распределенных функций

В отличие от традиционных ядер СУБД, в которых все функции управления данными централизованы в одном месте или процессе (даже в так называемых распределенных базах данных есть несколько копий монолитного механизма обработки данных), база данных уровня "Гипермасштабирование" отделяет механизм обработки запросов, где семантики различных модулей обработки данных расходятся, от компонентов, которые обеспечивают долговременное хранение и устойчивость данных. Таким образом, емкость хранилища может быть плавно масштабирована по мере необходимости (исходная цель составляет 100 ТБ). Только для чтения реплики совместно используют те же компоненты хранилища, поэтому нет копии данных, необходимые для настройки новой реплики для чтения. 

На следующей схеме представлены различные типы узлов в базе данных уровня "Гипермасштабирование".

![архитектура](./media/sql-database-hyperscale/hyperscale-architecture.png)

Ниже описаны типы узлов, содержащиеся в базе данных уровня "Гипермасштабирование".

### <a name="compute-node"></a>Вычислительный узел.

На вычислительном узле расположен реляционный модуль, поэтому там находятся все элементы языка, операции обработки запросов и прочее. Все взаимодействия пользователя с базой данных уровня "Гипермасштабирование" происходят через эти вычислительные узлы. На вычислительных узлах выполняется кэширование на основе дисков SSD (именуемое на предыдущей схеме как RBPEX — отказоустойчивое расширение пула), чтобы минимизировать количество круговых путей в сети, необходимых для получения страницы данных. Существует один первичный вычислительный узел, где обрабатываются все транзакции и рабочие нагрузки чтения и записи. При этом есть один или несколько вторичных вычислительных узлов, которые выступают в качестве резервных узлов на случай отработки отказа, а также действуют как вычислительные узлы только для чтения для переноса рабочих нагрузок чтения (если эта функция необходима).

### <a name="page-server-node"></a>Узел сервера страниц

Серверы страниц — это системы, представляющие горизонтально масштабируемую подсистему хранилища.  Каждый сервер страниц отвечает за подмножество страниц в базе данных.  Пороговая каждая страница серверных элементов управления между 128 ГБ и 1 ТБ данных. Данные совместно размещаются только на одном сервере страниц (за пределами реплик, созданных для обеспечения избыточности и доступности). Задача сервера страниц заключается в том, чтобы предоставлять страницы базы данных для вычислительных узлов по требованию и обновлять страницы, когда транзакции обновляют данные. Актуальность данных на серверах страниц обеспечивается за счет воспроизведения записей журнала из службы журналов. Серверы страниц также поддерживают кэширование на основе диска SSD, чтобы повысить производительность. Для обеспечения дополнительной надежности за долгосрочное хранение страниц данных отвечает служба хранилища Azure.

### <a name="log-service-node"></a>Узел службы журнала

Узел службы журнала принимает записи журнала из первичного вычислительного узла, сохраняет их в надежном кэше и отправляет на остальные вычислительные узлы (чтобы они могли обновить свои кэши), а также соответствующие серверы страниц для обновления данных. Таким образом, все изменения данных с основного вычислительного узла распространяются через службу журнала на все вторичные вычислительные узлы и серверы страниц. Наконец, записи журнала вытесняются на долгосрочное хранение в службу хранилища Azure, которая представляет собой неограниченный репозиторий. Этот механизм устраняет необходимость в частом усечении журнала. Служба журнала также имеет локальный кэш, ускоряющий доступ.

### <a name="azure-storage-node"></a>Узел хранилища Azure

Узел хранилища Azure является конечным пунктом назначения данных, полученных с серверов страниц. Это хранилище используется для целей резервного копирования, а также для репликации между регионами Azure. Резервные копии состоят из моментальных снимков файлов данных. На основе этих моментальных снимков быстро выполняются операции восстановления, и данные могут быть восстановлены в любой момент времени.

## <a name="backup-and-restore"></a>Архивация и восстановление

Резервные копии основаны на моментальных снимках файлов, поэтому они почти мгновенные. Благодаря разделению хранения и вычисления можно перенести операции резервного копирования или восстановления на уровень хранения, чтобы снизить нагрузку на основной узел вычислений. В результате резервное копирование большой базы данных не влияет на производительность первичного вычислительного узла. Аналогичным образом восстановление выполняется путем копирования моментального снимка файла и поэтому не является объемной операцией с данными. Операция восстановления в той же учетной записи хранения выполняется быстро.

## <a name="scale-and-performance-advantages"></a>Преимущества масштабирования и производительности

Благодаря возможности быстро развертывать и свертывать дополнительные вычислительные узлы, предназначенные только для чтения, архитектура уровня "Гипермасштабирование" предоставляет значительные возможности масштабирования для чтения и также может освобождать первичный вычислительный узел для обслуживания большего количества запросов на запись. Кроме того, вычислительные узлы можно быстро увеличивать или уменьшать в масштабе благодаря архитектуре уровня "Гипермасштабирование" с общим хранилищем.

## <a name="create-a-hyperscale-database"></a>Создание базы данных ценовой категории "Гипермасштабирование"

Базу данных ценовой категории "Гипермасштабирование" можно создать с использованием [портала Azure](https://portal.azure.com), [T-SQL](https://docs.microsoft.com/sql/t-sql/statements/create-database-transact-sql?view=azuresqldb-current), [PowerShell](https://docs.microsoft.com/powershell/module/azurerm.sql/new-azurermsqldatabase) или [интерфейса командной строки](https://docs.microsoft.com/cli/azure/sql/db#az-sql-db-create). Базы данных ценовой категории "Гипермасштабирование"доступны только при использовании [модели приобретения на основе виртуальных ядер](sql-database-service-tiers-vcore.md).

Следующая команда T-SQL создает базу данных ценовой категории "Гипермасштабирование". Необходимо указать целевые выпуск и службу в инструкции `CREATE DATABASE`.

```sql
-- Create a HyperScale Database
CREATE DATABASE [HyperScaleDB1] (EDITION = 'HyperScale', SERVICE_OBJECTIVE = 'HS_Gen5_4');
GO
```
Это создаст базу данных Гипермасштабируемого на 5-го поколения оборудования с 4 ядрами.

## <a name="migrate-an-existing-azure-sql-database-to-the-hyperscale-service-tier"></a>Перенос имеющейся базы данных Azure SQL на уровень служб ценовой категории "Гипермасштабирование"

Можно переместить существующие базы данных SQL Azure на уровень служб ценовой категории "Гипермасштабирование" с помощью [портала Azure](https://portal.azure.com), [T-SQL](https://docs.microsoft.com/sql/t-sql/statements/alter-database-transact-sql?view=azuresqldb-current), [PowerShell](https://docs.microsoft.com/powershell/module/azurerm.sql/set-azurermsqldatabase) или [интерфейса командной строки](https://docs.microsoft.com/cli/azure/sql/db#az-sql-db-update). В настоящее время это односторонняя миграции. Невозможно переместить базы данных с уровня служб "Гипермасштабирование" на другой уровень служб. Мы рекомендуем сделать копию ваших рабочих баз данных и выполнить перенос на уровень "Гипермасштабирование" для подтверждения концепции.

Следующие команды T-SQL перемещает базу данных на уровень служб ценовой категории "Гипермасштабирование". Необходимо указать целевые выпуск и службу в инструкции `ALTER DATABASE`.

```sql
-- Alter a database to make it a HyperScale Database
ALTER DATABASE [DB2] MODIFY (EDITION = 'HyperScale', SERVICE_OBJECTIVE = 'HS_Gen5_4');
GO
```

## <a name="connect-to-a-read-scale-replica-of-a-hyperscale-database"></a>Подключение к реплике базы данных ценовой категории "Гипермасштабирование", доступной только для чтения

В базах данных ценовой категории "Гипермасштабирование" передаваемый клиентом аргумент `ApplicationIntent` в строке подключения определяет, куда направляется подключение: к реплике для записи или к вторичной реплике только для чтения. Если параметру `ApplicationIntent` присвоено значение `READONLY` и у базы данных нет вторичной реплике, подключение будет направляться к первичной реплике в режиме по умолчанию `ReadWrite`.

```cmd
-- Connection string with application intent
Server=tcp:<myserver>.database.windows.net;Database=<mydatabase>;ApplicationIntent=ReadOnly;User ID=<myLogin>;Password=<myPassword>;Trusted_Connection=False; Encrypt=True;
```
## <a name="disaster-recovery-for-hyperscale-databases"></a>Аварийное восстановление для баз данных Гипермасштабируемого
### <a name="restoring-a-hyperscale-database-to-a-different-geography"></a>Восстановление базы данных Гипермасштабируемого в другой географический регион
Если необходимо восстановить базу данных Гипермасштабируемого базы данных SQL Azure в регионе, отличном от того, в котором в настоящее время она размещается в, как часть операции аварийного восстановления или детализации, перемещение или любой другой причине, основной метод — выполнить геовосстановление базы данных.  Это включает в себя те же действия, как вы будет использовать для восстановления любой другой базы данных SQL AZURE в другом регионе:
1. Создание сервера базы данных SQL в целевом регионе, если у вас еще нет соответствующего сервера существует.  Этот сервер должен принадлежать той же подписке, расположен исходный сервер (источник).
2. Следуйте инструкциям в [геовосстановление](https://docs.microsoft.com/azure/sql-database/sql-database-recovery-using-backups#geo-restore) раздел страницы, на восстановление баз данных SQL Azure из архивных копий.

#### <a name="notes-on-geo-restores-of-a-hyperscale-database"></a>Примечания о geo восстановление Гипермасштабируемого базы данных
Так как источник и цель находятся в разных регионах, базы данных не могут совместно использовать моментальный снимок хранилища с источником данных, как и в прежнего отличных от регионов, которые очень быстро.  В случае геовосстановления Гипермасштабируемого базы данных его будет операцией размер данных, даже если целевой объект находится в парном регионе геореплицируемое хранилище.  Это означает, что это географического восстановления может занять время, пропорционален размеру восстанавливаемой базы данных.  Если целевой объект находится в парном регионе, копия будет в центре обработки данных, которые будут значительно быстрее, чем междугородние копирования через Интернет, но он по-прежнему будет копировать все биты.

## <a name=regions></a>Доступные регионы

Уровень обработки базы данных SQL Azure в настоящее время доступен в следующих регионах:

- Восточная часть Австралии
- Юго-Восточная часть Австралии
- Южная часть Бразилии
- Центральная Канада
- Центральный регион США
- Восточный Китай 2
- Северный Китай 2
- Восточная Азия
- Восточная часть США
- Восточная часть США 2
- Центральная Франция
- Восточная часть Японии
- Западная часть Японии
- Центральная Корея
- Корея, юг
- Центрально-северная часть США
- Северная Европа
- Север ЮАР
- Центрально-южная часть США
- Юго-Восточная Азия
- Южная часть Великобритании
- Западная часть Великобритании
- Западная Европа
- Запад США
- Западный регион США 2

Если вы хотите создать Гипермасштабируемого базы данных в регионе, который не указан как поддерживаемый, можно отправить запрос на подключение с помощью портала Azure. Мы работаем, чтобы развернуть список внимание следите за последней списка регионов, поддерживаемых регионов.

Чтобы запросить возможность создания Гипермасштабируемого баз данных в области отсутствует в списке:

1. Перейдите к [Azure справки и поддержки колонке](https://portal.azure.com/#blade/Microsoft_Azure_Support/HelpAndSupportBlade/overview)

2. Щелкните [ **новый запрос на поддержку**](https://ms.portal.azure.com/#blade/Microsoft_Azure_Support/HelpAndSupportBlade/newsupportrequest)

    ![Azure справки и поддержки колонке](media/sql-database-service-tier-hyperscale/whitelist-request-screen-1.png)

3. Для **тип проблемы**выберите **ограничения службы и подписки (квоты)**

4. Выберите подписку, которую можно использовать для создания баз данных

5. Для **тип квоты**выберите **базы данных SQL**

6. Щелкните **Далее: Решения**

1. Нажмите кнопку **сведениями**

    ![Сведения о проблеме](media/sql-database-service-tier-hyperscale/whitelist-request-screen-2.png)

8. Выберите **тип квоты базы данных SQL**: **Другой запрос на квоту**

9. Введите следующий шаблон:

    ![Сведения о квотах](media/sql-database-service-tier-hyperscale/whitelist-request-screen-3.png)

    В шаблоне укажите следующие сведения

    > Запрос на создание базы данных SQL Azure Гипермасштабируемого в новом регионе<br/> Регион: [Заполнения в вашем регионе запрошенного]  <br/>
    > Вычислительных ядер SKU/всего, включая реплики для чтения <br/>
    > Число оценка ТБ 
    >

10. Выберите **Уровень серьезности C**.

11. Выберите соответствующий способ связи и заполните сведения.

12. Нажмите кнопку **Сохранить** и **продолжить**

## <a name="known-limitations"></a>Известные ограничения
Ниже приведены текущие ограничения для уровня Гипермасштабируемого начиная с общедоступной версии.  Мы активно работаем как многие из этих ограничений можно удалить.

| Проблема | Описание |
| :---- | :--------- |
| В области "Управление резервными копиями" для логического сервера не отображаются отфильтрованные базы данных ценовой категории "Гипермасштабирование" на сервере SQL Server.  | Для ценовой категории "Гипермасштабирование" применяется отдельный метод управления резервными копиями, поэтому параметры "Долгосрочное хранение" и "Point in Time backup Retention" (Хранение резервных копий на определенный момент времени) не действуют. Следовательно, базы данных ценовой категории "Гипермасштабирование" не отображаются в области "Управление резервными копиями". |
| Восстановление до точки во времени | После переноса базы данных на уровень служб ценовой категории "Гипермасштабирование" восстановление на определенный момент времени, предшествующий переносу, не поддерживается.|
| Восстановить для не - Гипермасштабируемого DB Hypserscale и наоборот | Невозможно восстановить базу данных Гипермасштабируемого в базу данных без обработки, а также можно восстановить базу данных не Гипермасштабируемого в Гипермасштабируемого базу данных.|
| Если файл базы данных увеличивается во время переноса из-за активной рабочей нагрузкой и превышает максимальный размер файла, равный 1 ТБ, происходит сбой. | Устранение рисков: <br> Если это возможно, перенесите базу данных при отсутствии активных рабочих нагрузок.<br> Повторите попытку переноса. Она будет успешной, если во время переноса не будет превышен максимальный размер фа1ла, равный 1 ТБ.|
| Управляемый экземпляр | База данных управляемый экземпляр SQL Azure с базами данных Гипермасштабируемого в настоящее время не поддерживается. |
| Пулы эластичных БД |  Пулы эластичных баз данных с крупномасштабным базы данных SQL в настоящее время не поддерживаются.|
| Сейчас переход на ценовую категорию "Гипермасштабирование" является необратимой операцией. | После переноса базы данных на уровень служб ценовой категории "Гипермасштабирование" ее невозможно перенести непосредственно на другой уровень служб. Сейчас единственным способом перенести базу данных с уровня служб ценовой категории "Гипермасштабирование" на другой уровень служб является ее экспорт и импорт с помощью BACPAC-файла.|
| Перенос баз данных с объектами в памяти | Перед переносом базы данных на уровень служб ценовой категории "Гипермасштабирование" необходимо удалить выполняющиеся в памяти объекты и заново создать их как объекты, выполняющиеся не в памяти.|
| Отслеживание изменений данных | Вы не сможете использовать отслеживание изменений данных с крупномасштабным базами данных. |
| Георепликация  | Еще нельзя настроить георепликацию для обработки базы данных SQL Azure.  Можно выполнять geo восстановление (восстановление базы данных в другом географическом регионе для аварийного восстановления или в других целях) |
| Прозрачное шифрование данных/AKV интеграции | Прозрачное шифрование базы данных, с помощью Azure Key Vault (часто называется Bring-Your-собственных ключей или BYOK) не еще поддерживается для обработки базы данных SQL Azure, но прозрачное шифрование данных с помощью управляемых службой ключей полностью поддерживается. |
|Функции Intelligent базы данных | 1. CREATE Index, Drop Index adviser не обучения для обработки баз данных SQL. <br/>2. Ошибки схемы, DbParameterization - недавно добавленные советниками не поддерживаются для обработки базы данных.|



## <a name="next-steps"></a>Дальнейшие действия

- Вопросы и ответы о ценовой категории "Гипермасштабирование" приведены в разделе [часто задаваемых вопросов о ценовой категории "Гипермасштабирование"](sql-database-service-tier-hyperscale-faq.md).
- Сведения об уровнях служб см. в статье [Ресурсы и модели приобретения для базы данных SQL Azure](sql-database-service-tiers.md).
- Сведения об ограничениях на уровнях сервера и подписки см. в статье [SQL Database resource limits for single and pooled databases on a logical server](sql-database-resource-limits-logical-server.md) (Ограничения ресурсов Базы данных SQL для отдельных баз данных и баз данных в пуле на логическом сервере).
- Ограничения моделей приобретения для отдельной базы данных описаны в разделе [Ограничения ресурсов для отдельной базы данных в Базе данных SQL Azure при использовании модели приобретения на основе виртуальных ядер](sql-database-vcore-resource-limits-single-databases.md).
- Сведения о функциях и список сравнения см. в статье [Сравнение функций Базы данных SQL Azure и SQL Server](sql-database-features.md).
