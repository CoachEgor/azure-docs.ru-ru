---
title: Обзор уровня служб "Гипермасштабирование" Базы данных SQL Azure | Документация Майкрософт
description: В этой статье описывается уровень служб ценовой категории "Гипермасштабирование" в модели приобретения на основе виртуальных ядер в службе "База данных SQL Azure" и объясняется, как он отличается от уровней служб ценовых категорий "Общего назначения" и "Критически важный для бизнеса".
services: sql-database
ms.service: sql-database
ms.subservice: service
ms.custom: ''
ms.devlang: ''
ms.topic: conceptual
author: CarlRabeler
ms.author: carlrab
ms.reviewer: ''
manager: craigg
ms.date: 04/04/2019
ms.openlocfilehash: 5e323b28913e0ba259654d39f97e0436e6bff2db
ms.sourcegitcommit: c174d408a5522b58160e17a87d2b6ef4482a6694
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/18/2019
ms.locfileid: "59786028"
---
# <a name="hyperscale-service-tier-preview-for-up-to-100-tb"></a>Уровень служб "Гипермасштабирование" (предварительная версия) до 100 ТБ

База данных SQL Azure основана на архитектуре ядра СУБД SQL Server, которая соответствует облачной среде, чтобы даже в случае сбоя инфраструктуры обеспечить доступность на уровне 99,99 %. Существует три модели архитектуры, которые используются в Базе данных SQL Azure:

- уровни "Общего назначения" или "Стандартный"; 
- уровни "Критически важный для бизнеса" или "Премиум";
- Уровень "Гипермасштабирование"

Уровень служб "Гипермасштабирование" в Базе данных SQL Azure — это новейший уровень в модели приобретения на основе виртуальных ядер. Этот высокомасштабируемый уровень производительности ресурсов хранения и вычислений, который использует архитектуру Azure для масштабирования этих ресурсов для службы "База данных SQL Azure" за пределы, доступные для уровней служб "Общего назначения" и "Критически важный для бизнеса".

> [!IMPORTANT]
> Уровень служб "Гипермасштабирование" в настоящее время находится в общедоступной предварительной версии и доступен в ограниченном количестве регионов Azure. Полный список регионов приведен в разделе [Доступные регионы](#available-regions). Мы пока не рекомендуем выполнение любой рабочей нагрузки в базах данных уровня "Гипермасштабирование". Вы не можете обновить базу данных уровня "Гипермасштабирование" до других уровней служб. В целях тестирования рекомендуется сделать копию текущей базы данных и обновить ее до уровня служб "Гипермасштабирование".
> [!NOTE]
> См. дополнительные сведения об уровнях служб [Общего назначения](sql-database-service-tier-general-purpose.md) и [Критически важный для бизнеса](sql-database-service-tier-business-critical.md) в модели приобретения на основе виртуальных ядер. Сравнение модели приобретения на основе виртуальных ядер и DTU см. в статье [Ресурсы и модели приобретения для базы данных SQL Azure](sql-database-purchase-models.md).

## <a name="what-are-the-hyperscale-capabilities"></a>Каковы возможности ценовой категории "Гипермасштабирование"?

Уровень служб "Гипермасштабирование" в службе "База данных SQL Azure" предоставляет следующие дополнительные возможности:

- Поддержка размера базы данных до 100 ТБ.
- Практически мгновенное создание резервных копий баз данных (на основе файлов моментальных снимков, хранящихся в хранилище BLOB-объектов Azure) независимо от размера, которое не влияет на операции ввода-вывода вычислительных ресурсов.   
- Быстрое восстановление баз данных (на основе файлов моментальных снимков) за несколько минут, а не часов или дней (вне зависимости от размера операции с данными).
- Более высокая общая производительность благодаря высокой пропускной способности ведения журнала и ускоренному выполнению транзакций независимо от объемов данных.
- Быстрое горизонтальное масштабирование. Вы можете подготовить один или несколько узлов только для чтения, чтобы переносить на них рабочие нагрузки чтения и использовать эти узлы в качестве узлов горячей замены.
- Быстрое увеличение масштаба. Вы можете постоянно увеличивать масштаб вычислительных ресурсов, чтобы размещать крупные рабочие нагрузки по мере необходимости, а затем уменьшать их масштаб, когда они не нужны.

Уровень служб "Гипермасштабирование" устраняет многие практические ограничения, традиционно наблюдаемые в облачных базах данных. В то время как большинство других баз данных ограничены ресурсами, доступными на одном узле, базы данных на уровне служб "Гипермасштабирование" не имеют таких ограничений. Благодаря гибкой архитектуре хранилища его объем растет по мере необходимости. На самом деле базы данных уровня "Гипермасштабирование" не создаются с определенным максимальным размером. База данных уровня "Гипермасштабирование" растет по мере необходимости, поэтому плата взимается только за ту емкость, которую вы используете. Для рабочих нагрузок интенсивного чтения уровень служб "Гипермасштабирование" обеспечивает быстрое горизонтальное масштабирование путем подготовки дополнительных реплик чтения при необходимости перенести рабочие нагрузки.

Кроме того, время, необходимое для создания резервных копий базы данных или увеличения/уменьшения масштаба, больше не привязано к объему данных в базе данных. Резервные копии баз данных уровня "Гипермасштабирование" могут создаваться практически мгновенно. Увеличивать или уменьшать масштаб баз данных с десятками терабайт данных можно за считаные минуты. Вы больше не ограничены первоначальными вариантами конфигурации.

Дополнительные сведения о размерах вычислительных ресурсов см. в разделе [Характеристики уровней служб](sql-database-service-tiers-vcore.md#service-tier-characteristics).

## <a name="who-should-consider-the-hyperscale-service-tier"></a>Кому рекомендуется использовать уровень служб "Гипермасштабирование"

Уровень служб "Гипермасштабирование" в первую очередь предназначен для клиентов с большими локальными базами данных, которые хотят модернизировать свои приложения, перейдя в облако, или для клиентов, которые уже находятся в облаке и ограничены максимальным размером базы данных (1–4 ТБ). Он также предназначен для клиентов, которым нужна высокая производительность и высокая масштабируемость для хранения и вычисления.

Уровень служб "Гипермасштабирование" поддерживает все рабочие нагрузки SQL Server, но в первую очередь он оптимизирован для OLTP. Он также поддерживает гибридные и аналитические (киоск данных) рабочие нагрузки.

> [!IMPORTANT]
> Эластичные пулы не поддерживают уровень служб "Гипермасштабирование".

## <a name="hyperscale-pricing-model"></a>Модель ценообразования для ценовой категории "Гипермасштабирование"

Уровень служб "Гипермасштабирование" доступен только в [модели на основе виртуальных ядер](sql-database-service-tiers-vcore.md). Ввиду новой архитектуры модель ценообразования несколько отличается от уровней служб "Общего назначения" или "Критически важный для бизнеса".

- **Среда выполнения приложений**

  Цена за единицу вычислений ценовой категории "Гипермасштабирование" на реплику. Цена [Преимущества гибридного использования Azure](https://azure.microsoft.com/pricing/hybrid-benefit/) автоматически применяется к репликам с масштабированием для чтения. В общедоступной предварительной версии мы создадим 2 реплики для баз данных ценовой категории "Гипермасштабирование" по умолчанию.

- **Хранилище**

  Указывать максимальный объем данных при настройке базы данных ценовой категории "Гипермасштабирование" не нужно. На уровне служб ценовой категории "Гипермасштабирование" счета за использование хранилища для базы данных выставляются в зависимости от фактического использования. Динамически выделяемый объем хранилища — от 5 ГБ до 100 ТБ (с шагом в 1 ГБ).  

Дополнительные сведения о ценах категории "Гипермасштабирование" см. в разделе [цен на базу данных SQL Azure](https://azure.microsoft.com/pricing/details/sql-database/single/).

## <a name="distributed-functions-architecture"></a>Архитектура распределенных функций

В отличие от традиционных ядер СУБД, в которых все функции управления данными централизованы в одном месте или процессе (даже в так называемых распределенных базах данных есть несколько копий монолитного механизма обработки данных), база данных уровня "Гипермасштабирование" отделяет механизм обработки запросов, где семантики различных модулей обработки данных расходятся, от компонентов, которые обеспечивают долговременное хранение и устойчивость данных. Таким образом, емкость хранилища может быть плавно масштабирована по мере необходимости (исходная цель составляет 100 ТБ). Реплики, доступные только для чтения, используют одни и те же вычислительные компоненты, поэтому для развертывания новой такой реплики не требуется копия данных. На этапе предварительной версии поддерживается только 1 реплика для чтения.

На следующей схеме представлены различные типы узлов в базе данных уровня "Гипермасштабирование".

![архитектура](./media/sql-database-hyperscale/hyperscale-architecture.png)

Ниже описаны типы узлов, содержащиеся в базе данных уровня "Гипермасштабирование".

### <a name="compute-node"></a>Вычислительный узел.

На вычислительном узле расположен реляционный модуль, поэтому там находятся все элементы языка, операции обработки запросов и прочее. Все взаимодействия пользователя с базой данных уровня "Гипермасштабирование" происходят через эти вычислительные узлы. На вычислительных узлах выполняется кэширование на основе дисков SSD (именуемое на предыдущей схеме как RBPEX — отказоустойчивое расширение пула), чтобы минимизировать количество круговых путей в сети, необходимых для получения страницы данных. Существует один первичный вычислительный узел, где обрабатываются все транзакции и рабочие нагрузки чтения и записи. При этом есть один или несколько вторичных вычислительных узлов, которые выступают в качестве резервных узлов на случай отработки отказа, а также действуют как вычислительные узлы только для чтения для переноса рабочих нагрузок чтения (если эта функция необходима).

### <a name="page-server-node"></a>Узел сервера страниц

Серверы страниц — это системы, представляющие горизонтально масштабируемую подсистему хранилища.  Каждый сервер страниц отвечает за подмножество страниц в базе данных.  Каждый сервер страниц условно контролирует 1 терабайт данных. Данные совместно размещаются только на одном сервере страниц (за пределами реплик, созданных для обеспечения избыточности и доступности). Задача сервера страниц заключается в том, чтобы предоставлять страницы базы данных для вычислительных узлов по требованию и обновлять страницы, когда транзакции обновляют данные. Актуальность данных на серверах страниц обеспечивается за счет воспроизведения записей журнала из службы журналов. Серверы страниц также поддерживают кэширование на основе диска SSD, чтобы повысить производительность. Для обеспечения дополнительной надежности за долгосрочное хранение страниц данных отвечает служба хранилища Azure.

### <a name="log-service-node"></a>Узел службы журнала

Узел службы журнала принимает записи журнала из первичного вычислительного узла, сохраняет их в надежном кэше и отправляет на остальные вычислительные узлы (чтобы они могли обновить свои кэши), а также соответствующие серверы страниц для обновления данных. Таким образом, все изменения данных с основного вычислительного узла распространяются через службу журнала на все вторичные вычислительные узлы и серверы страниц. Наконец, записи журнала вытесняются на долгосрочное хранение в службу хранилища Azure, которая представляет собой неограниченный репозиторий. Этот механизм устраняет необходимость в частом усечении журнала. Служба журнала также имеет локальный кэш, ускоряющий доступ.

### <a name="azure-storage-node"></a>Узел хранилища Azure

Узел хранилища Azure является конечным пунктом назначения данных, полученных с серверов страниц. Это хранилище используется для целей резервного копирования, а также для репликации между регионами Azure. Резервные копии состоят из моментальных снимков файлов данных. На основе этих моментальных снимков быстро выполняются операции восстановления, и данные могут быть восстановлены в любой момент времени.

## <a name="backup-and-restore"></a>Архивация и восстановление

Резервные копии основаны на моментальных снимках файлов, поэтому они почти мгновенные. Благодаря разделению хранения и вычисления можно перенести операции резервного копирования или восстановления на уровень хранения, чтобы снизить нагрузку на основной узел вычислений. В результате резервное копирование большой базы данных не влияет на производительность первичного вычислительного узла. Аналогичным образом восстановление выполняется путем копирования моментального снимка файла и поэтому не является объемной операцией с данными. Операция восстановления в той же учетной записи хранения выполняется быстро.

## <a name="scale-and-performance-advantages"></a>Преимущества масштабирования и производительности

Благодаря возможности быстро развертывать и свертывать дополнительные вычислительные узлы, предназначенные только для чтения, архитектура уровня "Гипермасштабирование" предоставляет значительные возможности масштабирования для чтения и также может освобождать первичный вычислительный узел для обслуживания большего количества запросов на запись. Кроме того, вычислительные узлы можно быстро увеличивать или уменьшать в масштабе благодаря архитектуре уровня "Гипермасштабирование" с общим хранилищем.

## <a name="create-a-hyperscale-database"></a>Создание базы данных ценовой категории "Гипермасштабирование"

Гипермасштабируемый базы данных могут создаваться с использованием [портала Azure](https://portal.azure.com), [T-SQL](https://docs.microsoft.com/sql/t-sql/statements/create-database-transact-sql?view=azuresqldb-current), [PowerShell](https://docs.microsoft.com/powershell/module/az.sql/new-azsqldatabase) или [CLI](https://docs.microsoft.com/cli/azure/sql/db#az-sql-db-create). Базы данных ценовой категории "Гипермасштабирование"доступны только при использовании [модели приобретения на основе виртуальных ядер](sql-database-service-tiers-vcore.md).

Следующая команда T-SQL создает базу данных ценовой категории "Гипермасштабирование". Необходимо указать целевые выпуск и службу в инструкции `CREATE DATABASE`.

```sql
-- Create a HyperScale Database
CREATE DATABASE [HyperScaleDB1] (EDITION = 'HyperScale', SERVICE_OBJECTIVE = 'HS_Gen4_4');
GO
```

## <a name="migrate-an-existing-azure-sql-database-to-the-hyperscale-service-tier"></a>Перенос имеющейся базы данных Azure SQL на уровень служб ценовой категории "Гипермасштабирование"

Можно переместить существующие базы данных Azure SQL с помощью Гипермасштабируемого [портала Azure](https://portal.azure.com), [T-SQL](https://docs.microsoft.com/sql/t-sql/statements/alter-database-transact-sql?view=azuresqldb-current), [PowerShell](https://docs.microsoft.com/powershell/module/az.sql/set-azsqldatabase) или [CLI](https://docs.microsoft.com/cli/azure/sql/db#az-sql-db-update). В общедоступной предварительной версии это односторонняя миграция. Невозможно переместить базы данных с уровня служб "Гипермасштабирование" на другой уровень служб. Мы рекомендуем сделать копию ваших рабочих баз данных и выполнить перенос на уровень "Гипермасштабирование" для подтверждения концепции.

Следующие команды T-SQL перемещает базу данных на уровень служб ценовой категории "Гипермасштабирование". Необходимо указать целевые выпуск и службу в инструкции `ALTER DATABASE`.

```sql
-- Alter a database to make it a HyperScale Database
ALTER DATABASE [DB2] MODIFY (EDITION = 'HyperScale', SERVICE_OBJECTIVE = 'HS_Gen4_4');
GO
```

## <a name="connect-to-a-read-scale-replica-of-a-hyperscale-database"></a>Подключение к реплике базы данных ценовой категории "Гипермасштабирование", доступной только для чтения

В базах данных ценовой категории "Гипермасштабирование" передаваемый клиентом аргумент `ApplicationIntent` в строке подключения определяет, куда направляется подключение: к реплике для записи или к вторичной реплике только для чтения. Если параметру `ApplicationIntent` присвоено значение `READONLY` и у базы данных нет вторичной реплике, подключение будет направляться к первичной реплике в режиме по умолчанию `ReadWrite`.

```cmd
-- Connection string with application intent
Server=tcp:<myserver>.database.windows.net;Database=<mydatabase>;ApplicationIntent=ReadOnly;User ID=<myLogin>;Password=<myPassword>;Trusted_Connection=False; Encrypt=True;
```

## <a name="available-regions"></a>Доступные регионы

Уровень служб "Гипермасштабирование" сейчас представлен в общедоступной предварительной версии и доступен в таких регионах Azure: Восточная часть США 1, восточная часть США 2, Западная часть США 2, Центральная часть США, Северная CentralU S, Западная Европа, Северная Европа, Восточная Австралия, Юго-Восточная Австралия, Юго-Восточная Азия, Восточная Япония и центральная Корея

## <a name="known-limitations"></a>Известные ограничения

| Проблема | ОПИСАНИЕ |
| :---- | :--------- |
| В области "Управление резервными копиями" для сервера Базы данных SQL не отображаются отфильтрованные гипермасштабируемые базы данных на сервере SQL Server.  | Для ценовой категории "Гипермасштабирование" применяется отдельный метод управления резервными копиями, поэтому параметры "Долгосрочное хранение" и "Point in Time backup Retention" (Хранение резервных копий на определенный момент времени) не действуют. Следовательно, базы данных ценовой категории "Гипермасштабирование" не отображаются в области "Управление резервными копиями". |
| Восстановление до точки во времени | После переноса базы данных на уровень служб ценовой категории "Гипермасштабирование" восстановление на определенный момент времени, предшествующий переносу, не поддерживается.|
| Если файл базы данных увеличивается во время переноса из-за активной рабочей нагрузкой и превышает максимальный размер файла, равный 1 ТБ, происходит сбой. | Устранение рисков: <br> Если это возможно, перенесите базу данных при отсутствии активных рабочих нагрузок.<br> Повторите попытку переноса. Она будет успешной, если во время переноса не будет превышен максимальный размер фа1ла, равный 1 ТБ.|
| Управляемый экземпляр в настоящее время не поддерживается. | Сейчас не поддерживается |
| Сейчас переход на ценовую категорию "Гипермасштабирование" является необратимой операцией. | После переноса базы данных на уровень служб ценовой категории "Гипермасштабирование" ее невозможно перенести непосредственно на другой уровень служб. Сейчас единственным способом перенести базу данных с уровня служб ценовой категории "Гипермасштабирование" на другой уровень служб является ее экспорт и импорт с помощью BACPAC-файла.|
| Перенос баз данных с выполняющимися в памяти объектами в настоящее время не поддерживается. | Перед переносом базы данных на уровень служб ценовой категории "Гипермасштабирование" необходимо удалить выполняющиеся в памяти объекты и заново создать их как объекты, выполняющиеся не в памяти.|
| Отслеживание изменений данных сейчас не поддерживается. | Вы не сможете использовать отслеживание изменений данных с гипермасштабируемыми базами данных.

## <a name="next-steps"></a>Дальнейшие действия

- Вопросы и ответы о ценовой категории "Гипермасштабирование" приведены в разделе [часто задаваемых вопросов о ценовой категории "Гипермасштабирование"](sql-database-service-tier-hyperscale-faq.md).
- Сведения об уровнях служб см. в статье [Ресурсы и модели приобретения для базы данных SQL Azure](sql-database-purchase-models.md).
- Сведения об ограничениях на уровнях сервера и подписки см. в статье [SQL Database resource limits for Azure SQL Database server](sql-database-resource-limits-database-server.md) (Ограничения ресурсов Базы данных SQL для сервера Базы данных SQL).
- Ограничения моделей приобретения для отдельной базы данных описаны в разделе [Ограничения ресурсов для отдельной базы данных в Базе данных SQL Azure при использовании модели приобретения на основе виртуальных ядер](sql-database-vcore-resource-limits-single-databases.md).
- Сведения о функциях и список сравнения см. в статье [Сравнение функций Базы данных SQL Azure и SQL Server](sql-database-features.md).
