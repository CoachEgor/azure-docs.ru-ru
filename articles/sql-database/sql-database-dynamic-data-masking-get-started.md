---
title: Динамическое маскирование данных
description: Динамическое маскирование данных ограничивает раскрытие конфиденциальных данных путем маскирования пользователей, не имеющих привилегий, для базы данных SQL и хранилища данных.
services: sql-database
ms.service: sql-database
ms.subservice: security
titleSuffix: Azure SQL Database and SQL Data Warehouse
ms.custom: ''
ms.devlang: ''
ms.topic: conceptual
author: DavidTrigano
ms.author: datrigan
ms.reviewer: vanto
ms.date: 03/04/2019
ms.openlocfilehash: 149c42829762920583948958da8252a01e35ef1f
ms.sourcegitcommit: f52ce6052c795035763dbba6de0b50ec17d7cd1d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/24/2020
ms.locfileid: "76721920"
---
# <a name="dynamic-data-masking-for-azure-sql-database-and-data-warehouse"></a>Динамическое маскирование данных для базы данных и хранилища данных SQL Azure

Динамическое маскирование данных базы данных SQL Azure ограничивает возможность раскрытия конфиденциальных данных, маскируя их для обычных пользователей. 

Динамическое маскирование данных помогает предотвратить несанкционированный доступ к конфиденциальным данным, позволяя клиентам определить объем раскрываемых конфиденциальных данных с минимальным влиянием на уровень приложения. Эта функция безопасности на основе политики скрывает конфиденциальные данные в результирующем наборе запроса в заданных полях базы данных, а данные в базе данных не меняются.

Например, представитель отдела обслуживания клиентов в центре обработки вызовов может идентифицировать абонентов по нескольким цифрам номера кредитной карты, но эти элементы данных не должны предоставляться ему полностью. Правило маскирования может быть задано таким образом, чтобы в результатах выполнения запросов маскировалось все, кроме последних четырех цифр номера кредитной карты. Еще один пример — защита персональных данных с помощью соответствующей маски. Разработчик может отправлять запросы в рабочие среды для устранения неполадок, не нарушая при этом нормативные правила.

## <a name="dynamic-data-masking-basics"></a>Основные сведения о динамическом маскировании данных

Настройка политики динамического маскирования данных на портале Azure осуществляется посредством выбора операции "Динамическое маскирование данных" в колонке конфигурации или параметров базы данных SQL. Этот компонент нельзя задать с помощью портала для хранилища данных SQL (используйте PowerShell или REST API).

### <a name="dynamic-data-masking-permissions"></a>Разрешения для динамической маскировки данных

Динамическую маскировку данных может настраивать администратор базы данных SQL Azure, администратор сервера или [диспетчер безопасности SQL](https://docs.microsoft.com/azure/role-based-access-control/built-in-roles#sql-security-manager).

### <a name="dynamic-data-masking-policy"></a>Политика динамической маскировки данных

* **Пользователи SQL, исключенные из маскирования** — ряд пользователей SQL или удостоверений AAD, при использовании которых с данных, полученных в результатах SQL-запросов, снимается маска. Пользователи с привилегия администратора всегда исключаются из правил маскирования и видят исходные данные без какой-либо маски.
* **Правила маскирования** — набор правил, определяющих поля, подлежащие маскированию, и используемую функцию маскирования. Задать такие поля можно с помощью имени схемы базы данных, имени таблицы и имени столбца.
* **Функции маскирования** — набор методов, управляющих доступностью данных для различных сценариев.

| Функция маскирования | Логика маскирования |
| --- | --- |
| **Default** |**Полное маскирование в соответствии с типами данных предопределенных полей**<br/><br/>• Для строковых типов данных (nchar, ntext, nvarchar) используется XXXX или меньшее количество символов "X", если размер поля меньше 4 символов.<br/>• Для числовых типов данных (bigint, bit, decimal, int, money, numeric, smallint, smallmoney, tinyint, float, real) используется нулевое значение.<br/>• Для типов данных даты и времени (date, datetime2, datetime, datetimeoffset, smalldatetime, time) используется формат 01-01-1900.<br/>• Для варианта SQL используется значение по умолчанию текущего типа.<br/>• Для XML используется документ \<маскированный/>.<br/>.• Используйте пустое значение для специальных типов данных (таблица меток времени, hierarchyid, GUID, binary, image, пространственные типы varbinary). |
| **Кредитная карта** |**Метод маскирования, который предоставляет последние четыре цифры назначенных полей** и добавляет строковую константу в качестве префикса в формате номера кредитной карты.<br/><br/>XXXX-XXXX-XXXX-1234 |
| **Электронная почта** |**Метод маскирования, который предоставляет первую букву и домен**, используя строковую константу в качестве префикса в формате электронного адреса.<br/><br/>aXX@XXXX.com |
| **Случайное число** |**Метод маскирования, который формирует случайное число** в соответствии с выбранными границами и типами фактических данных. Если установленные границы равны, то функция маскирования будет постоянным числом.<br/><br/>![Область навигации](./media/sql-database-dynamic-data-masking-get-started/1_DDM_Random_number.png) |
| **Пользовательский текст** |**Метод маскирования, при котором видны первая и последняя буквы** и добавляется пользовательская строка заполнения в середине. Если исходная строка короче открытых префикса и суффикса, то будет использоваться только строка заполнения. <br/>префикс[заполнение]суффикс<br/><br/>![Область навигации](./media/sql-database-dynamic-data-masking-get-started/2_DDM_Custom_text.png) |

<a name="Anchor1"></a>

### <a name="recommended-fields-to-mask"></a>Рекомендуемые поля для маскирования

Система рекомендаций DDM помечает в базе данных поля, которые могут содержать конфиденциальные данные и являются хорошими кандидатами на применение маскирования. Список рекомендуемых для маскирования столбцов в вашей базе данных см. на портале в колонке «Динамическое маскирование данных». Вам нужно только щелкнуть **Добавить маску** для одного или нескольких столбцов, а затем щелкнуть **Сохранить**, чтобы применить маски к выбранным полям.

## <a name="set-up-dynamic-data-masking-for-your-database-using-powershell-cmdlets"></a>Настройка динамического маскирования данных для базы данных с помощью командлетов PowerShell

См. статью с описанием [командлетов Базы данных SQL Azure](https://docs.microsoft.com/powershell/module/az.sql).

## <a name="set-up-dynamic-data-masking-for-your-database-using-rest-api"></a>Настройка динамической маскировки данных для базы данных с помощью REST API

Дополнительные сведения см. в статье с описанием [операций для Базы данных SQL Azure](https://docs.microsoft.com/rest/api/sql/).
