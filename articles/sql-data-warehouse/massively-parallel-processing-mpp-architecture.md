---
title: Архитектура Azure синапсе Analytics (ранее — хранилище данных SQL)
description: Узнайте, как Azure синапсе Analytics (ранее — хранилище данных SQL) сочетает в себе массовую параллельную обработку (MPP) с хранилищем Azure для достижения высокой производительности и масштабируемости.
services: sql-data-warehouse
author: mlee3gsd
manager: craigg
ms.service: sql-data-warehouse
ms.topic: conceptual
ms.subservice: design
ms.date: 11/04/2019
ms.author: martinle
ms.reviewer: igorstan
ms.openlocfilehash: ea9629c63fcab97ba8ba83cd88592c37ae41818a
ms.sourcegitcommit: 359930a9387dd3d15d39abd97ad2b8cb69b8c18b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/06/2019
ms.locfileid: "73646392"
---
# <a name="azure-synapse-analytics-formerly-sql-dw-architecture"></a>Архитектура Azure синапсе Analytics (ранее — хранилище данных SQL) 

Azure синапсе — это неограниченная служба аналитики, которая объединяет корпоративные хранилища данных и аналитику больших данных. Она дает вам возможность запрашивать данные на своих условиях, используя ненужные или подготовленные ресурсы по запросу (в масштабе). Azure синапсе объединяет эти две возможности вместе с единым интерфейсом для приема, подготовки, управления и обслуживания данных для немедленных потребностей в бизнес-аналитике и машинного обучения.

 В Azure синапсе есть четыре компонента:
- Аналитика SQL: полная аналитика на основе T-SQL 
    - Пул SQL (оплата по DWU подготовлен) — общедоступная версия
    - SQL по запросу (оплата за обработанный ТБ) — (Предварительная версия)
- Spark: глубокая интегрированная Apache Spark (Предварительная версия) 
- Интеграция данных: Гибридная интеграция данных (Предварительная версия)
- Studio: унифицированное взаимодействие с пользователем.  (предварительная версия)

> [!VIDEO https://www.youtube.com/embed/PlyQ8yOb8kc]

## <a name="sql-analytics-mpp-architecture-components"></a>Компоненты архитектуры MPP SQL Analytics

[SQL Analytics](sql-data-warehouse-overview-what-is.md#sql-analytics-and-sql-pool-in-azure-synapse) использует архитектуру масштабирования для распределения вычислительной обработки данных между несколькими узлами. Единица масштабирования представляет собой абстракцию вычислительной мощности, известную как [единица использования хранилища данных](what-is-a-data-warehouse-unit-dwu-cdwu.md). Расчеты отделены от хранилища, что позволяет масштабировать вычисление независимо от данных в системе.

![Архитектура аналитики SQL](media/massively-parallel-processing-mpp-architecture/massively-parallel-processing-mpp-architecture.png)

В SQL Analytics используется архитектура на основе узлов. Приложения подключаются и выдают команды T-SQL управляющему узлу, который является единственной точкой входа для SQL Analytics. Управляющий узел запускает механизм MPP, оптимизирующий запросы параллельной обработки, а затем перенаправляет операции на вычислительные узлы, чтобы обеспечить таким образом параллельную работу. 

Вычислительные узлы хранят все данные пользователей в службе хранилища Azure и выполняют параллельные запросы. Служба перемещения данных (DMS) представляет собой внутреннюю службу на уровне системы, которая перемещает данные между узлами, что необходимо для выполнения параллельных запросов и возвращения точных результатов. 

В случае с несвязанным хранилищем и вычислением при использовании SQL Analytics один из них может:

* определение объема вычислительных ресурсов независимого от потребностей хранилища;
* Увеличение или уменьшение мощности вычислений в пуле SQL (хранилище данных) без перемещения данных.
* приостановка вычислений без изменения данных (вы платите только за хранилище);
* возобновление вычислений во время рабочих часов.

### <a name="azure-storage"></a>Хранилище Azure

SQL Analytics использует службу хранилища Azure для защиты данных пользователей.  Так как ваши данные хранятся и управляются службой хранилища Azure, за использование хранилища взимается отдельная плата. Для оптимизации производительности системы сами данные сегментированы в **дистрибутивы**. При определении таблицы вы можете выбрать шаблон сегментирования, который будет использоваться для распределения данных. Поддерживаются следующие шаблоны сегментирования:

* Хэш
* Циклический перебор,
* Репликация

### <a name="control-node"></a>Управляющий узел

Управляющий узел является мозгом архитектуры. Это внешний интерфейс, который взаимодействует со всеми приложениями и подключениями. Механизм MPP запускается на управляющем узле, чтобы оптимизировать и координировать параллельные запросы. При отправке запроса T-SQL в SQL Analytics управляющий узел преобразует его в запросы, выполняемые для каждого распределения параллельно.

### <a name="compute-nodes"></a>Вычислительные узлы

Вычислительные узлы обеспечивают вычислительную мощность. Чтобы выполнить обработку, дистрибутивы сопоставляются с вычислительными узлами. При оплате дополнительных ресурсов для вычислений SQL Analytics повторно сопоставляет дистрибутивы с доступными вычисленными узлами. Число расчетных узлов в диапазоне от 1 до 60 и определяется уровнем обслуживания для SQL Analytics.

У каждого вычислительного узла есть идентификатор узла, который видно в представлениях системы. Идентификатор вычислительного узла можно увидеть в столбце node_id в системных представлениях, имена которых начинаются с sys.pdw_nodes. Список системных представлений см. в [системном представлении MPP](https://docs.microsoft.com/sql/relational-databases/system-catalog-views/sql-data-warehouse-and-parallel-data-warehouse-catalog-views?view=aps-pdw-2016-au7).

### <a name="data-movement-service"></a>Служба перемещения данных
Служба перемещения данных (DMS) — это технология перемещения данных, которая координирует перемещение данных между вычислительными узлами. Некоторым запросам требуется перемещение данных, чтобы параллельные запросы вернули точные результаты. При необходимости перемещения данных DMS гарантирует, что нужные данные окажутся в нужном расположении. 

## <a name="distributions"></a>Дистрибутивы

Распределение представляет собой базовую единицу хранения и обработки параллельных запросов, выполняемых для распределенных данных. Когда SQL Analytics выполняет запрос, работа делится на 60 небольших запросов, выполняемых параллельно. 

Каждый из этих 60 небольших запросов выполняется в одном из распределений данных. Каждый вычислительный узел управляет одним или несколькими из 60 распределений. Пул SQL с максимальными ресурсами вычислений имеет по одному распределению на каждый узел вычислений. Пул SQL с минимальными ресурсами вычислений имеет все распределения на одном кластерном узле.  

## <a name="hash-distributed-tables"></a>Таблицы с хэш-распределением
С помощью распределенной хэш-таблицы можно обеспечить наибольшую производительность запроса для операций объединения и агрегирования для больших таблиц. 

Для сегментирования данных в распределенную хэш-таблицу аналитика SQL использует хэш-функцию для детерминированного назначения каждой строки одному распределению. В определении таблицы один из столбцов определяется как столбец распределения. Хэш-функция использует значения в столбце распределения для присвоения каждой строки распределению.

На следующей схеме показано, как полная (нераспределенная) таблица хранится в качестве хэш-распределенной. 

![Распределенная таблица](media/sql-data-warehouse-distributed-data/hash-distributed-table.png "Распределенная таблица")  

* Каждая строка относится к одному распределению.  
* Детерминированный хэш-алгоритм присваивает каждую строку одному распределению.  
* Количество строк таблицы в распределении зависит от размеров таблиц (как показано на схеме).

Существуют влияющие на производительность факторы, которые учитываются при выборе столбца распределения. Например, определенность, неравномерное смещение данных и типы запросов, выполняемых в системе.

## <a name="round-robin-distributed-tables"></a>Таблицы с распределением методом циклического перебора
Таблица с распределением методом циклического перебора — это самая простая таблица для создания и обеспечения высокой производительности, если ее использовать как промежуточную таблицу для нагрузок.

В таблице с распределением методом циклического перебора данные распределяются равномерно, но без какой-либо последующей оптимизации. Распределение сначала выбирается случайным образом, а затем буферы строк назначаются распределениям последовательно. Вы можете быстро загрузить данные в таблицу с распределением методом циклического перебора, но производительность запроса будет лучше, если использовать распределенные хэш-таблицы. Для объединения таблиц с распределением методом циклического перебора требуется перегруппировка данных, что требует дополнительного времени.


## <a name="replicated-tables"></a>Реплицированные таблицы
Реплицированная таблица обеспечивает наилучшую производительность запросов для небольших таблиц.

Полная копия реплицированной таблицы хранится на каждом вычислительном узле. В результате репликация таблицы устраняет необходимость передавать данные между вычислительными узлами перед операциями соединения или агрегирования. Реплицированные таблицы лучше всего использовать для небольших таблиц. Требуется дополнительное хранилище, и при записи данных возникают дополнительные издержки, которые делают большие таблицы непрактичными.  

На приведенной ниже схеме показана реплицированная таблица, которая кэшируется в первом распределении на каждом из этих кластерных узлов.  

![Реплицированная таблица](media/sql-data-warehouse-distributed-data/replicated-table.png "Реплицированная таблица") 

## <a name="next-steps"></a>Дальнейшие действия
Теперь, когда вы уже знакомы с Azure синапсе, Узнайте, как быстро [создать пул SQL][create a SQL pool] и [загрузить демонстрационные данные][load sample data]. Если вы раньше не работали с Azure, используйте [глоссарий Azure Глоссарий][Azure glossary] , чтобы узнать значение новых терминов. Или просмотрите некоторые из этих ресурсов Azure синапсе.  

* [Истории успеха клиентов]
* [Блоги]
* [Запросы функций]
* [Видео]
* [Блоги группы консультирования клиентов]
* [Создание запроса в службу поддержки]
* [Форум MSDN]
* [Форум Stack Overflow]
* [Twitter]

<!--Image references-->
[1]: ./media/sql-data-warehouse-overview-what-is/dwarchitecture.png

<!--Article references-->
[Создание запроса в службу поддержки]: ./sql-data-warehouse-get-started-create-support-ticket.md
[load sample data]: ./sql-data-warehouse-load-sample-databases.md
[create a SQL pool]: ./sql-data-warehouse-get-started-provision.md
[Migration documentation]: ./sql-data-warehouse-overview-migrate.md
[Azure Synapse solution partners]: ./sql-data-warehouse-partner-business-intelligence.md
[Integrated tools overview]: ./sql-data-warehouse-overview-integrate.md
[Backup and restore overview]: ./sql-data-warehouse-restore-database-overview.md
[Azure glossary]: ../azure-glossary-cloud-terminology.md

<!--MSDN references-->

<!--Other Web references-->
[Истории успеха клиентов]: https://azure.microsoft.com/case-studies/?service=sql-data-warehouse
[Блоги]: https://azure.microsoft.com/blog/tag/azure-sql-data-warehouse/
[Блоги группы консультирования клиентов]: https://blogs.msdn.microsoft.com/sqlcat/tag/sql-dw/
[Запросы функций]: https://feedback.azure.com/forums/307516-sql-data-warehouse
[Форум MSDN]: https://social.msdn.microsoft.com/Forums/azure/home?forum=AzureSQLDataWarehouse
[Форум Stack Overflow]: https://stackoverflow.com/questions/tagged/azure-sqldw
[Twitter]: https://twitter.com/hashtag/SQLDW
[Видео]: https://azure.microsoft.com/documentation/videos/index/?services=sql-data-warehouse
[SLA for Azure Synapse]: https://azure.microsoft.com/support/legal/sla/sql-data-warehouse/v1_0/
[Volume Licensing]: https://www.microsoftvolumelicensing.com/DocumentSearch.aspx?Mode=3&DocumentTypeId=37
[Service Level Agreements]: https://azure.microsoft.com/support/legal/sla/
