---
title: Уровень важности рабочей нагрузки
description: Руководство по настройке важности запросов в хранилище данных SQL Azure.
services: sql-data-warehouse
author: ronortloff
manager: craigg
ms.service: sql-data-warehouse
ms.topic: conceptual
ms.subservice: workload-management
ms.date: 05/01/2019
ms.author: rortloff
ms.reviewer: jrasnick
ms.custom: seo-lt-2019
ms.openlocfilehash: 76a77c1833ae1827f2a6a9b577b3cca51b35a344
ms.sourcegitcommit: f4f626d6e92174086c530ed9bf3ccbe058639081
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/25/2019
ms.locfileid: "75351427"
---
# <a name="azure-sql-data-warehouse-workload-importance"></a>Важность рабочей нагрузки хранилища данных SQL Azure

В этой статье объясняется, как важность рабочей нагрузки может повлиять на порядок выполнения запросов к хранилищу данных SQL.

## <a name="importance"></a>приоритет

> [!Video https://www.youtube.com/embed/_2rLMljOjw8]

Бизнес-потребности могут потребовать, чтобы рабочие нагрузки хранилища данных были более важными, чем другие.  Рассмотрим ситуацию, когда критически важные данные о продажах загружаются до закрытия финансового периода.  Загрузка данных для других источников, например данных о погоде, не имеет тщательного соглашения об уровне обслуживания. Задание высокой важности для запроса на загрузку данных о продажах и низкая важность запроса на загрузку данных о погоде гарантирует, что загрузка данных продаж получает первый доступ к ресурсам и завершается быстрее.

## <a name="importance-levels"></a>Уровни важности

Существует пять уровней важности: низкая, below_normal, обычная, above_normal и высокий.  Запросам, которые не задают важность, назначается Стандартный уровень "Стандартный". Запросы с одинаковым уровнем важности имеют одно и то же поведение планирования, существующее сегодня.

## <a name="importance-scenarios"></a>Сценарии важности

Помимо описанного выше сценария "базовый важность" с данными о продажах и погоде, существуют и другие сценарии, где важность рабочей нагрузки помогает удовлетворить потребности в обработке данных и запросах.

### <a name="locking"></a>Блокировка

Доступ к блокировкам для операций чтения и записи является одной областью естественного состязания. Для таких действий, как [Переключение секций](/azure/sql-data-warehouse/sql-data-warehouse-tables-partition) или [ПЕРЕименование объектов](/sql/t-sql/statements/rename-transact-sql?view=azure-sqldw-latest) , требуются повышенные блокировки.  Без важности рабочей нагрузки хранилище данных SQL оптимизирует для пропускной способности. Оптимизация для пропускной способности означает, что если запросы на выполнение и очереди имеют те же требования к блокировке и доступны ресурсы, запросы в очереди могут обходить запросы с более высокими требованиями к блокировке, которые поступили в очередь запросов ранее. После применения важности рабочей нагрузки к запросам с более высокими требованиями к блокировке. Запрос с повышенной важностью будет выполняться перед запросом с более низкой важностью.

Рассмотрим следующий пример:

- Q1 активно работает и выбирает данные из SalesFact.
- Q2 находится в состоянии ожидания завершения Q1.  Он был отправлен в 9:00 и пытается секционировать новые данные в SalesFact.
- Q3 отправляется по адресу 9:01am и хочет выбрать данные из SalesFact.

Если Q2 и Q3 имеют одинаковую важность, а Q1 по-прежнему выполняется, то Q3 начнет выполняться. Q2 будет продолжать ожидать монопольной блокировки на SalesFact.  Если Q2 имеет более высокий уровень важности, чем Q3, то Q3 будет ожидать завершения Q2, прежде чем он сможет начать выполнение.

### <a name="non-uniform-requests"></a>Неоднородные запросы

Другой сценарий, где важность может помочь удовлетворить требования запроса, — это то, что передаются запросы с разными классами ресурсов.  Как упоминалось ранее, хранилище данных SQL оптимизирует для пропускной способности. Если запросы смешанного размера (например, smallrc или mediumrc) помещаются в очередь, хранилище данных SQL выберет самый ранний запрос, помещающийся в доступных ресурсах. Если применяется важность рабочей нагрузки, запрос с наибольшей важностью будет назначен далее.
  
Рассмотрим следующий пример в DW500c:

- Q1, Q2, Q3 и Q4 выполняются с запросами smallrc.
- Вопрос 5 отправляется с классом ресурсов mediumrc по адресу 9:00.
- Вопрос 6 отправляется с классом ресурсов smallrc по адресу 9:01am.

Так как вопрос 5 — mediumrc, для него требуется два слота выдачи. Вопрос 5 должен ожидать завершения двух выполняющихся запросов.  Однако при завершении одного из выполняемых запросов (Q1-Q4) вопрос 6 планируется немедленно, так как существуют ресурсы для выполнения запроса.  Если вопрос 5 имеет более высокий уровень важности, чем вопрос 6, то вопрос 6 ждет, пока не будет запущен вопрос 5, прежде чем он сможет начать выполнение.

## <a name="next-steps"></a>Дальнейшие действия

- Дополнительные сведения о создании классификатора см. в разделе [Создание классификатора рабочей нагрузки (Transact-SQL)](/sql/t-sql/statements/create-workload-classifier-transact-sql).  
- Дополнительные сведения о классификации рабочей нагрузки хранилища данных SQL см. в разделе [классификация рабочей нагрузки](sql-data-warehouse-workload-classification.md).  
- Инструкции по созданию классификатора рабочей нагрузки см. в разделе Быстрый запуск [классификатора рабочей нагрузки](quickstart-create-a-workload-classifier-tsql.md) . 
- См. статьи с инструкциями по [настройке уровня важности рабочих нагрузок](sql-data-warehouse-how-to-configure-workload-importance.md), а также по [администрированию и мониторингу рабочих нагрузок](sql-data-warehouse-how-to-manage-and-monitor-workload-importance.md).
- Запросы и назначенную важность см. в разделе [sys.dm_pdw_exec_requests](/sql/relational-databases/system-dynamic-management-views/sys-dm-pdw-exec-requests-transact-sql?view=azure-sqldw-latest).
