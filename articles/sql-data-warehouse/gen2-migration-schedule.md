---
title: Перенос существующего хранилища данных SQL Azure в хранилище 2-го поколения | Документация Майкрософт
description: Инструкции по переносу существующего хранилища данных в хранилище 2-го поколения и планирование переноса по регионам.
services: sql-data-warehouse
author: mlee3gsd
ms.author: anjangsh
ms.reviewer: jrasnick
manager: craigg
ms.assetid: 04b05dea-c066-44a0-9751-0774eb84c689
ms.service: sql-data-warehouse
ms.topic: article
ms.date: 07/22/2019
ms.openlocfilehash: cd55e078e14ec34006df05096f161e7bdef39a03
ms.sourcegitcommit: 3073581d81253558f89ef560ffdf71db7e0b592b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/06/2019
ms.locfileid: "68827230"
---
# <a name="upgrade-your-data-warehouse-to-gen2"></a>Обновление до хранилища данных 2-го поколения

Корпорация Майкрософт помогает снизить стоимость работы хранилища данных на уровне ввода.  Теперь для хранилища данных SQL Azure доступны более низкие уровни вычислений, способные обрабатывать ресурсоемкие запросы. Ознакомьтесь с полным объявлением [о более низких уровнях вычислений для Gen2](https://azure.microsoft.com/blog/azure-sql-data-warehouse-gen2-now-supports-lower-compute-tiers/). Новое предложение доступно в регионах, указанных в таблице ниже. В поддерживаемых регионах существующие хранилища данных 1-го поколения можно обновить до 2-го поколения с помощью таких механизмов:

- **Процесс автоматического обновления**. Автоматическое обновление не запускается сразу после того, как служба будет доступна в регионе.  Когда автоматическое обновление будет запущено в определенном регионе, во время запланированного вами обслуживания произойдет обновление отдельных хранилищ данных.
- [**Самостоятельное обновление до Gen2:** ](#self-upgrade-to-gen2) Вы можете контролировать время обновления, выполняя самообновление до Gen2. Если регион еще не поддерживается, можно выполнить восстановление из точки восстановления непосредственно в экземпляр Gen2 в поддерживаемом регионе.

## <a name="automated-schedule-and-region-availability-table"></a>Таблица доступности по регионам и автоматического расписания

В следующей таблице приведены данные по регионам о том, когда будет доступен низкий уровень вычислений 2-го поколения и когда начнется автоматическое обновление. Даты могут меняться. Следите за обновлениями, чтобы узнать, когда ваш регион станет доступен.

\* указывает, что определенное расписание для региона в настоящее время недоступно.

| **Регион** | **Низкий уровень 2-ого поколения доступен** | **Начало автоматических обновлений** |
|:--- |:--- |:--- |
| Восточная Австралия |Доступно |Готов |
| Юго-восточная Австралия |Доступно |Готов |
| Южная Бразилия |Доступно |Готов |
| Центральная Канада |Доступно |Готов |
| Восточная Канада |1 июня 2020 г. |1 июля 2020 г. |
| Центральная часть США |Доступно |Готов |
| Восточный Китай |\* |\* |
| Восточный Китай 2 |Доступно |Готов |
| Северный Китай |\* |\* |
| Северный Китай 2 |Доступно |Готов |
| Восточная Азия |Доступно |Готов |
| East US |Доступно |Готов |
| Восточная часть США 2 |Доступно |Готов |
| Центральная Франция |Доступно |Идет |
| Центральная Германия |\* |\* |
| Центрально-западная Германия |1 сентября 2019 г.|1 октября 2019 г. |
| Центральная Индия |Доступно |Готов |
| Южная Индия |Доступно |Готов |
| Западная Индия |1 июля 2019 г. |Идет |
| Восточная Япония |Доступно |Готов |
| Западная Япония |Доступно |Готов |
| Центральная Корея |Доступно |Готов |
| Республика Корея, южный регион |Доступно |Готов |
| Центрально-северная часть США |Доступно |Готов |
| Северная Европа |Доступно |Готов |
| северная часть ЮАР |12 июля 2019 г. |Готов |
| Центрально-южная часть США |Доступно |Готов |
| Юго-Восточная Азия |Доступно |Готов |
| Северная часть ОАЭ |20 июля 2019 г. |Готов |
| Южная часть Соединенного Королевства |Доступно |Идет |
| Западная часть Соединенного Королевства |Доступно |Идет |
| Центрально-западная часть США |1 сентября 2019 г. |1 октября 2019 г.|
| Западная Европа |Доступно |Готов |
| Западная часть США |Доступно |Готов |
| Западная часть США 2 |Доступно |Готов |

## <a name="automatic-upgrade-process"></a>Процесс автоматического обновления

На основе приведенной выше диаграммы доступности мы будем планировать автоматические обновления для экземпляров Gen1. Чтобы избежать непредвиденного прерывания доступности хранилища данных, выполнение автоматических обновлений будет планироваться на период запланированного обслуживания. Возможность создания нового экземпляра Gen1 будет отключена в регионах, для которых выполняется автоматическое обновление до Gen2. После завершения автоматического обновления Gen1 будет считаться устаревшим. Дополнительные сведения о расписаниях см. в статье [Просмотр расписания обслуживания](viewing-maintenance-schedule.md).

Процесс обновления приведет к кратковременному сбросу подключения (приблизительно 5 минут), так как мы перезапускаем хранилище данных.  После перезапуска хранилище данных будет полностью доступно для использования. Однако при обновлении файлов данных в фоновом режиме может возникнуть снижение производительности. Общее время замедления зависит от размера файлов данных.

Вы можете ускорить процесс обновления файлов данных, выполнив команду [Alter Index rebuild](sql-data-warehouse-tables-index.md) во всех основных таблицах columnstore. После перезапуска этих таблиц будет использоваться более высокий целевой уровень обслуживания и класс ресурсов.

> [!NOTE]
> Операция "Alter Index rebuild" — это автономная операция. Таблицы будут недоступны до завершения повторной сборки.

## <a name="self-upgrade-to-gen2"></a>Самостоятельное обновление до 2-го поколения

Вы можете самостоятельно выполнить обновление, выполнив эти действия в существующем хранилище данных Gen1. Если вы решили самостоятельное обновление, необходимо выполнить его до начала процесса автоматического обновления в вашем регионе. Это гарантирует, что вы не рискуете автоматическое обновление, вызывающее конфликт.

Есть два варианта выполнения самостоятельного обновления.  Вы можете либо обновить текущее хранилище данных, либо восстановить хранилище данных 1-го поколения в экземпляре 2-го поколения.

- [Обновление на месте](upgrade-to-latest-generation.md). При выборе этого варианта имеющееся хранилище данных 1-го поколения будет обновлено до 2-го поколения. Процесс обновления приведет к кратковременному сбросу подключения (приблизительно 5 минут), так как мы перезапускаем хранилище данных.  После перезапуска хранилище данных будет полностью доступно для использования. Если во время обновления возникают проблемы, отправьте запрос в [службу поддержки](https://docs.microsoft.com/azure/sql-data-warehouse/sql-data-warehouse-get-started-create-support-ticket) и в качестве возможной причины щелкните "Gen2 Upgrade".
- [Обновления из точки восстановления](sql-data-warehouse-restore.md). При выборе этого варианта в текущем хранилище данных 1-го поколения создается определяемая пользователем точка восстановления, а затем выполняется восстановление напрямую в экземпляр 2-го поколения. Существующее хранилище данных 1-го поколения остается. После завершения восстановления хранилище данных 2-го поколения будет полностью доступно.  После выполнения всех процессов тестирования и проверки восстановленного экземпляра 2-го поколения первоначальный экземпляр 1-го поколения будет удален.

   - Шаг 1.: [Создайте на портале Azure точку восстановления, определяемую пользователем](sql-data-warehouse-restore-active-paused-dw.md#restore-an-existing-data-warehouse-through-the-azure-portal).
   - Шаг 2.: При восстановлении из определяемой пользователем точки восстановления задайте для уровня производительности предпочтительный уровень 2-го поколения.

Во время выполнения процесса обновления файлов данных в фоновом режиме вы можете столкнуться с временным снижением производительности. Общее время замедления зависит от размера файлов данных.

Для ускорения фонового процесса перемещения данных вы можете сразу инициировать перемещение данных, выполнив инструкцию [Alter Index rebuild](sql-data-warehouse-tables-index.md) для всех основных таблиц columnstore, которые вы сможете запрашивать при наличии более высокого целевого уровня обслуживания и оптимального класса ресурсов.

> [!NOTE]
> Операция "Alter Index rebuild" — это автономная операция. Таблицы будут недоступны до завершения повторной сборки.

Если с хранилищем данных возникнут проблемы, [создайте запрос в службу поддержки](sql-data-warehouse-get-started-create-support-ticket.md) и укажите в качестве возможной причины "Обновление до 2-го поколения".

Дополнительные сведения см. в статье [Оптимизация производительности путем обновления хранилища данных SQL](upgrade-to-latest-generation.md).

## <a name="migration-frequently-asked-questions"></a>Часто задаваемые вопросы о переносе

**Вопрос. Плата за 2-е поколение такая же, как и за 1-е поколение?**

- Ответ. Да.

**Вопрос. Как обновление повлияет на мои сценарии автоматизации?**

- Ответ. Любой сценарий автоматизации, который ссылается на целевой уровень обслуживания, должен быть изменен в соответствии с эквивалентом 2-го поколения.  Дополнительные сведения см. [здесь](upgrade-to-latest-generation.md#sign-in-to-the-azure-portal).

**Вопрос. Сколько обычно занимает самостоятельное обновление?**

- Ответ. Вы можете выполнять обновление на месте или обновление из точки восстановления.  
   - Обновление вызовет немедленную остановку и возобновление работы хранилища данных.  Фоновый процесс будет продолжать выполняться, пока хранилище данных подключено.  
   - Обновление через точку восстановления занимает больше времени, так как обновление будет проходить через полный процесс восстановления.

**Вопрос. Сколько времени займет автоматическое обновление?**

- Ответ. Фактический простой для обновления — это только время, необходимое для приостановки и возобновления обслуживания, которое составляет от 5 до 10 минут. После краткого простоя фоновый процесс выполнит перенос хранилища. Продолжительность фонового процесса зависит от размера хранилища данных.

**Вопрос. Когда будет происходить автоматическое обновление?**

- Ответ. Во время запланированного обслуживания. Использование выбранного расписания обслуживания минимизирует время простоя вашего бизнеса.

**Вопрос. Что делать, если фоновый процесс обновления завис?**

 - Ответ. Начните повторную индексацию таблиц Columnstore. Обратите внимание, что во время повторного индексирования таблица будет находиться в автономном режиме.

**Вопрос. Что, если 2-е поколение не обладает целевым уровнем обслуживания, который есть у меня в 1-ом поколении?**
- Ответ. Если вы используете хранилище DW600 или DW1200 1-го поколения, рекомендуется использовать DW500c или DW1000c соответственно, так как 2-е поколение предоставляет больше памяти, ресурсов и более высокую производительность по сравнению с 1-м поколением.

**Вопрос. Можно ли отключить геоизбыточное резервное копирование?**
- Ответ. Нет. Геоизбыточное резервное копирование — это корпоративная функция, обеспечивающая доступность хранилища данных в случае, если регион становится недоступным. Если у вас возникнут дополнительные вопросы, откройте [запрос в службу поддержки](sql-data-warehouse-get-started-create-support-ticket.md).

**Вопрос. Есть ли отличия в синтаксисе T-SQL между поколением 1 и 2?**

- Ответ. Различия в синтаксисе языка T-SQL между поколением 1 и 2 отсутствуют.

**Вопрос. Поддерживает ли поколение 2 периоды обслуживания устройств?**

- Ответ. Да.

**Вопрос. Могу ли я создать новый экземпляр 1-го поколения после обновления моего региона?**

- Ответ. Нет. После обновления региона создание новых экземпляров 1-го поколения будет отключено.

## <a name="next-steps"></a>Следующие шаги

- [Действия по обновлению](upgrade-to-latest-generation.md)
- [Период обслуживания](maintenance-scheduling.md)
- [Мониторинг работоспособности ресурсов](https://docs.microsoft.com/azure/service-health/resource-health-overview)
- [что нужно знать перед началом миграции](upgrade-to-latest-generation.md#before-you-begin)
- [Обновление на месте или обновление из точки восстановления](upgrade-to-latest-generation.md)
- [Создание определяемой пользователем точки восстановления](sql-data-warehouse-restore-points.md)
- [Сведения о восстановлении до поколения 2](sql-data-warehouse-restore-active-paused-dw.md#restore-an-existing-data-warehouse-through-the-azure-portal)
- [Открытие запроса в службу поддержки касательно Хранилища данных SQL Azure](https://go.microsoft.com/fwlink/?linkid=857950)
