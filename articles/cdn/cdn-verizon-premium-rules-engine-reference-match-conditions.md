---
title: Условия соответствия обработчика правил Azure CDN от Verizon уровня "премиум" | Документация Майкрософт
description: Условия соответствия обработчика правил справочная документация по сети доставки содержимого Azure от Verizon уровня "премиум".
services: cdn
author: mdgattuso
ms.service: azure-cdn
ms.topic: article
ms.date: 05/31/2019
ms.author: magattus
ms.openlocfilehash: 1660dca34b2f128ef5889145fcdeed0d2523b9bb
ms.sourcegitcommit: ccb9a7b7da48473362266f20950af190ae88c09b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/05/2019
ms.locfileid: "67593203"
---
# <a name="azure-cdn-from-verizon-premium-rules-engine-match-conditions"></a>Условия соответствия Azure CDN от Verizon Premium обработчика правил

В этой статье приводятся подробные описания доступные условия соответствия для Azure доставки содержимого сети (CDN) из Verizon уровня "премиум" [обработчик правил](cdn-verizon-premium-rules-engine.md).

Вторая часть правила — это условие соответствия. Условие соответствия определяет различные типы запросов, для которых будет выполнен ряд функций.

Например, с помощью условия соответствия вы сможете:

- Отфильтровать запросы содержимого в определенном расположении.
- Отфильтровать запросы, созданные из конкретного IP-адреса или страны или региона.
- Отфильтровать запросы по информации из заголовка.

## <a name="always-match-condition"></a>Условие соответствия "Всегда"

Условие соответствия "Всегда" применяет набор функций по умолчанию ко всем запросам.

ИМЯ | Цель
-----|--------
[Всегда](#always) | Применяет набор функций по умолчанию ко всем запросам.

## <a name="device-match-condition"></a>Условие соответствия "Устройство"

Условие соответствия "Устройство" определяет запросы, поступающие с мобильного устройства, на основе его свойств.  

Имя | Цель
-----|--------
[Устройство](#device) | Определяет запросы, поступающие с мобильного устройства, на основе его свойств.

## <a name="location-match-conditions"></a>Условия соответствия "Расположение"

Условия соответствия "Расположение" определяют запросы на основе расположения запрашивающей стороны.

Имя | Цель
-----|--------
[Номер AS](#as-number) | Определяет запросы, поступающие из конкретной сети.
[Страна](#country) | Определяет запросы, поступающие из указанной страны (регионы).

## <a name="origin-match-conditions"></a>Условия соответствия "Источник"

Условия соответствия "Источник" определяют запросы, которые указывают на хранилище сети доставки содержимого или сервер-источник клиента.

ИМЯ | Цель
-----|--------
[Источник CDN](#cdn-origin) | Определяет запросы к содержимому, хранящемуся в хранилище сети доставки контента.
[Источник клиента](#customer-origin) | Определяет запросы к содержимому, хранящемуся на конкретном сервере-источнике клиента.

## <a name="request-match-conditions"></a>Условия соответствия "Запрос"

Условия соответствия "Запрос" определяют запросы на основе их свойств.

ИМЯ | Цель
-----|--------
[IP-адрес клиента](#client-ip-address) | Определяет запросы, поступающие с конкретного IP-адреса.
[Параметр файла cookie](#cookie-parameter) | Проверяет файлы cookie, связанные с каждым запросом, на наличие указанного значения.
[Регулярное выражение параметра файла cookie](#cookie-parameter-regex) | Проверяет файлы cookie, связанные с каждым запросом, на наличие указанного регулярного выражения.
[Граничная запись CNAME](#edge-cname) | Определяет запрос, который указывает на конкретную граничную запись CNAME.
[Домен источников ссылок](#referring-domain) | Определяет запросы, на которые давались ссылки с указанных имен узла.
[Литерал заголовка запроса](#request-header-literal) | Определяет запросы, содержащие указанный заголовок, для которого задано указанное значение.
[Регулярное выражение заголовка запроса](#request-header-regex) | Определяет запросы, содержащие указанный заголовок, для которого задано значение, соответствующее указанному регулярному выражению.
[Шаблон заголовка запроса](#request-header-wildcard) | Определяет запросы, содержащие указанный заголовок, для которого задано значение, соответствующее указанному шаблону.
[Метод запроса](#request-method) | Определяет запросы по их HTTP-методу.
[Схема запроса](#request-scheme) | Определяет запросы по их HTTP-протоколу.

## <a name="url-match-conditions"></a>Условия соответствия "URL-адрес"

Условия соответствия "URL-адрес" определяют запросы на основе их URL-адресов.

ИМЯ | Цель
-----|--------
[Каталог URL-пути](#url-path-directory) | Определяет запросы по относительному пути.
[Расширение URL-пути](#url-path-extension) | Определяет запросы по их расширению имени файла.
[Имя файла URL-пути](#url-path-filename) | Определяет запросы по их имени файла.
[Литерал URL-пути](#url-path-literal) | Сравнивает относительный путь запроса с указанным значением.
[Регулярное выражение URL-пути](#url-path-regex) | Сравнивает относительный путь запроса с указанным регулярным выражением.
[Шаблон URL-пути](#url-path-wildcard) | Сравнивает относительный путь запроса с указанным шаблоном.
[Литерал запроса URL-адреса](#url-query-literal) | Сравнивает строку запроса с указанным значением.
[Параметр запроса URL-адреса](#url-query-parameter) | Определяет запросы, содержащие указанный параметр строки запроса, для которого задано значение, соответствующее указанному шаблону.
[Регулярное выражение запроса URL-адреса](#url-query-regex) | Определяет запросы, содержащие указанный параметр строки запроса, для которого задано значение, соответствующее указанному регулярному выражению.
[Шаблон запроса URL-адреса](#url-query-wildcard) | Сравнивает указанное значение со строкой запроса.

## <a name="reference-for-rules-engine-match-conditions"></a>Справка по условиям соответствия обработчика правил

---

### <a name="always"></a>Всегда

Условие соответствия "Всегда" применяет набор функций по умолчанию ко всем запросам.

[Вверх](#reference-for-rules-engine-match-conditions)

</br>

---

### <a name="as-number"></a>Номер AS

Сеть "Номер AS" определяется по собственному номеру автономной системы (ASN). 

Параметр **Соответствует**/**Не соответствует** определяет требования, при которых выполняется условие соответствия номера AS.

- **Соответствует**. ASN клиентской сети должен соответствовать одному из указанных ASN. 
- **Не соответствует**. ASN клиентской сети не должен соответствовать ни одному из указанных ASN.

Основные сведения

- Укажите несколько номеров AS, разделив их одним пробелом. Например, "64514 64515" соответствует запросам, которые поступают из сети 64514 или 64515.
- Некоторые запросы могут не возвращать допустимый номер AS. Вопросительный знак (?) будет соответствовать запросам, для которых невозможно определить допустимый ASN.
- Полностью укажите ASN для нужной сети. Частичные значения сопоставляться не будут.
- Из-за способа отслеживания параметров кэша это условие соответствия несовместимо со следующими функциями:
  - Завершение заполнения кэша
  - Внутренний максимальный срок по умолчанию
  - Принудительное использование внутреннего максимального срока
  - Не учитывать источник без кэша
  - Внутреннее максимальное значение устаревания

[Вверх](#reference-for-rules-engine-match-conditions)

</br>

---

### <a name="cdn-origin"></a>Источник CDN

Условие соответствия "Источник CDN" выполняется, если соблюдены оба следующих условия:

- Было запрошено содержимое из хранилища CDN.
- Универсальный код ресурса (URI) запроса использует тип точки доступа к содержимому (например, /000001), который определен в этом условии соответствия.
  - URL-адрес CDN. Универсальный код ресурса запроса должен содержать выбранную точку доступа к содержимому.
  - URL-адрес граничной CNAME. Соответствующая конфигурация граничной записи CNAME должна указывать на выбранную точку доступа к содержимому.
  
Основные сведения

- Точка доступа к содержимому определяет службу, которая будет обрабатывать запрошенное содержимое.
- Не используйте инструкцию AND IF для объединения определенных условий соответствия. Например, объединение условий соответствия "Источник CDN" и "Источник клиента" привело бы к созданию шаблона соответствия, который не может быть сопоставлен. Поэтому невозможно объединить два условия соответствия "Источник CDN" с помощью инструкции AND IF.

[Вверх](#reference-for-rules-engine-match-conditions)

</br>

---

### <a name="client-ip-address"></a>IP-адрес клиента

Параметр **Соответствует**/**Не соответствует** определяет требования, при которых будет выполняться условие соответствия IP-адреса клиента.

- **Соответствует**. IP-адрес клиента должен соответствовать одному из указанных IP-адресов. 
- **Не соответствует**. IP-адрес клиента не должен соответствовать ни одному из указанных IP-адресов. 

Основные сведения

- Используйте нотацию CIDR.
- Укажите несколько IP-адресов и/или блоков IP-адресов, разделив их одним пробелом. Пример:
  - **Пример IPv4**. 1.2.3.4 10.20.30.40 соответствует любым запросам, поступающим из адреса 1.2.3.4 или 10.20.30.40.
  - **Пример IPv6**. 1:2:3:4:5:6:7:8 10:20:30:40:50:60:70:80 соответствует любым запросам, поступающим из адреса 1:2:3:4:5:6:7:8 или 10:20:30:40:50:60:70:80.
- Синтаксис блока IP-адресов — базовый IP-адрес, за которым следуют косая черта и размер префикса. Пример:
  - **Пример IPv4**. 5.5.5.64/26 соответствует любым запросам, поступающим из диапазона адресов 5.5.5.64–5.5.5.127.
  - **Пример IPv6**. 1:2:3:/48 соответствует любым запросам, поступающим из диапазона адресов 1:2:3:0:0:0:0:0–1:2:3:ffff:ffff:ffff:ffff:ffff.
- Из-за способа отслеживания параметров кэша это условие соответствия несовместимо со следующими функциями:
  - Завершение заполнения кэша
  - Внутренний максимальный срок по умолчанию
  - Принудительное использование внутреннего максимального срока
  - Не учитывать источник без кэша
  - Внутреннее максимальное значение устаревания

[Вверх](#reference-for-rules-engine-match-conditions)

</br>

---

### <a name="cookie-parameter"></a>Параметр файла cookie

Параметр **Соответствует**/**Не соответствует** определяет требования, при которых будет выполняться условие соответствия "Параметр файла cookie".

- **Соответствует**. Необходим запрос, содержащий указанный файл cookie со значением, которое соответствует хотя бы одному из значений, определенных в этом условии соответствия.
- **Не соответствует**. Запрос должен соответствовать любому из следующих критериев:
  - Не содержит указанный файл cookie.
  - Содержит указанный файл cookie, но его значение не соответствует ни одному из значений, определенных в этом условии соответствия.
  
Основные сведения

- Имя файла cookie:
  - Так как подстановочные знаки, включая звездочки (*), не поддерживаются при указании имени файла cookie, для сравнения могут использоваться только точные соответствия имен файлов cookie.
  - Для каждого экземпляра этого условия соответствия можно указать только одно имя файла cookie.
  - Сравнение имен файлов cookie выполняется без учета регистра.
- Значение файла cookie:
  - Указывайте несколько значений файла cookie, разделяя их одним пробелом.
  - Для значения cookie можно использовать [подстановочные знаки](cdn-verizon-premium-rules-engine-reference.md#wildcard-values).
  - Если подстановочный знак не указан, этому условию соответствия может отвечать только точное соответствие. Например, "Значение" будет соответствовать варианту "Значение", а не "Значение 1" или "Значение 2".
  - Используйте параметр **Без учета регистра**, чтобы определить, будет ли учитываться регистр для значения cookie в запросе.
- Из-за способа отслеживания параметров кэша это условие соответствия несовместимо со следующими функциями:
  - Завершение заполнения кэша
  - Внутренний максимальный срок по умолчанию
  - Принудительное использование внутреннего максимального срока
  - Не учитывать источник без кэша
  - Внутреннее максимальное значение устаревания

[Вверх](#reference-for-rules-engine-match-conditions)
</br>

---

### <a name="cookie-parameter-regex"></a>Регулярное выражение параметра файла cookie

Условие соответствия "Регулярное выражение параметра файла cookie" определяет имя и значение файла cookie. Определить нужное значение cookie можно с помощью [регулярных выражений](cdn-verizon-premium-rules-engine-reference.md#regular-expressions).

Параметр **Соответствует**/**Не соответствует** определяет требования, при которых будет выполняться условие соответствия "Регулярное выражение параметра файла cookie".

- **Соответствует**. Необходим запрос, содержащий указанный файл cookie со значением, соответствующим указанному регулярному выражению.
- **Не соответствует**. Запрос должен соответствовать любому из следующих критериев:
  - Не содержит указанный файл cookie.
  - Содержит указанный файл cookie, но его значение не соответствует указанному регулярному выражению.
  
Основные сведения

- Имя файла cookie:
  - Так как регулярные выражения и подстановочные знаки, включая звездочки (*), не поддерживаются при указании имени файла cookie, для сравнения могут использоваться только точные соответствия имен файлов cookie.
  - Для каждого экземпляра этого условия соответствия можно указать только одно имя файла cookie.
  - Сравнение имен файлов cookie выполняется без учета регистра.
- Значение файла cookie:
  - Для значения файла cookie можно использовать регулярные выражения.
  - Используйте параметр **Без учета регистра**, чтобы определить, будет ли учитываться регистр для значения cookie в запросе.
- Из-за способа отслеживания параметров кэша это условие соответствия несовместимо со следующими функциями:
  - Завершение заполнения кэша
  - Внутренний максимальный срок по умолчанию
  - Принудительное использование внутреннего максимального срока
  - Не учитывать источник без кэша
  - Внутреннее максимальное значение устаревания

[Вверх](#reference-for-rules-engine-match-conditions)

</br>

---

### <a name="country"></a>Country

Вы можете определить страну, указав ее код. 

Параметр **Соответствует**/**Не соответствует** определяет требования, при которых будет выполняться условие соответствия "Страна".

- **Соответствует**. Запрос должен содержать указанные значения кода страны. 
- **Не соответствует**. Запрос не должен содержать указанные значения кода страны.

Основные сведения

- Укажите несколько кодов стран, разделяя их одним пробелом.
- При указании кода страны подстановочные знаки не поддерживаются.
- Коды стран Европы и Азии не охватывают всех IP-адресов в этих регионах.
- Некоторые запросы могут не возвращать допустимый код страны. Вопросительный знак (?) будет соответствовать запросам, для которых невозможно определить допустимый код страны.
- Коды стран нужно вводить с учетом регистра.
- Из-за способа отслеживания параметров кэша это условие соответствия несовместимо со следующими функциями:
  - Завершение заполнения кэша
  - Внутренний максимальный срок по умолчанию
  - Принудительное использование внутреннего максимального срока
  - Не учитывать источник без кэша
  - Внутреннее максимальное значение устаревания

#### <a name="implementing-country-filtering-by-using-the-rules-engine"></a>Реализация фильтрации по стране с помощью обработчика правил

Это условие соответствия позволяет выполнять множество настроек на основе расположения, из которого поступает запрос. Например, поведение функции фильтрации по стране можно реализовать с помощью следующей конфигурации:

- Соответствие подстановочного знака URL-пути. Задайте [условия соответствия подстановочного знака URL-пути](#url-path-wildcard) для каталога, который будет защищен. 
    Добавьте звездочку в конце относительного пути, чтобы с помощью этого правила ограничить доступ ко всем его дочерним элементам.

- Соответствие страны. Задайте для условия соответствия страны нужный набор стран.
  - Разрешить. Задайте для условия соответствия страны параметр **Не соответствует**, чтобы разрешить доступ к содержимому в расположении, определенном с помощью условия соответствия подстановочного знака URL-пути, только для указанных стран.
  - Блокировать. Задайте для условия соответствия страны параметр **Соответствует**, чтобы блокировать для указанных стран доступ к содержимому в расположении, определенном с помощью условия соответствия подстановочного знака URL-пути.

- Функция запрета доступа (403). Включите [функцию запрета доступа (403)](cdn-verizon-premium-rules-engine-reference-features.md#deny-access-403) для репликации части блокирования или разрешения функции фильтрации по стране.

[Вверх](#reference-for-rules-engine-match-conditions)

</br>

---

### <a name="customer-origin"></a>Источник клиента

Основные сведения

- Условие соответствия "Источник клиента" выполняется независимо от того, запрашивается ли содержимое через URL-адрес CDN или через URL-адрес граничной записи CNAME, указывающий на выбранный источник клиента.
- Конфигурацию источника клиента, на которую ссылается правило, невозможно удалить со страницы "Источник клиента". Прежде чем пытаться удалить конфигурацию источника клиента, убедитесь, что на нее не ссылаются следующие конфигурации:
  - условие соответствия "Источник клиента";
  - конфигурация граничной записи CNAME.
- Не используйте инструкцию AND IF для объединения определенных условий соответствия. Например, объединение условий соответствия "Источник клиента" и "Источник CDN" привело бы к созданию шаблона соответствия, который не может быть сопоставлен. Поэтому невозможно объединить два условия соответствия "Источник клиента" с помощью инструкции AND IF.

[Вверх](#reference-for-rules-engine-match-conditions)

</br>

---

### <a name="device"></a>Устройство

Условие соответствия "Устройство" определяет запросы, поступающие с мобильного устройства, на основе его свойств. Мобильные устройства обнаруживаются с помощью [WURFL](http://wurfl.sourceforge.net/). 

Параметр **Соответствует**/**Не соответствует** определяет требования, при которых будет выполняться условие соответствия "Устройство".

- **Соответствует**. Устройство запроса должно соответствовать указанному значению. 
- **Не соответствует**. Устройство запроса не должно соответствовать указанному значению.

Основные сведения

- Используйте параметр **Без учета регистра**, чтобы определить, будет ли учитываться регистр для указанного значения.
- Из-за способа отслеживания параметров кэша это условие соответствия несовместимо со следующими функциями:
  - Завершение заполнения кэша
  - Внутренний максимальный срок по умолчанию
  - Принудительное использование внутреннего максимального срока
  - Не учитывать источник без кэша
  - Внутреннее максимальное значение устаревания

#### <a name="string-type"></a>Тип строки

Возможность WURFL обычно принимает любое сочетание цифр, букв и знаков. Из-за гибкой структуры этой возможности необходимо выбрать способ интерпретации значения, связанного с этим условием соответствия. В таблице ниже описан доступный набор параметров:

Type     | Описание
---------|------------
Литерал  | Выберите этот параметр, чтобы с помощью [литерального значения](cdn-verizon-premium-rules-engine-reference.md#literal-values) большинства знаков предотвратить их преобразование в специальные значения.
Подстановочный знак | Выберите этот параметр, чтобы использовать все [подстановочные знаки](cdn-verizon-premium-rules-engine-reference.md#wildcard-values).
Регулярное выражение    | Выберите этот параметр, чтобы использовать [регулярные выражения](cdn-verizon-premium-rules-engine-reference.md#regular-expressions). Они позволяют определить шаблон знаков.

#### <a name="wurfl-capabilities"></a>Возможности WURFL

Возможность WURFL обозначает категорию, описывающую мобильные устройства. Выбранная возможность определяет тип описания мобильного устройства для идентификации запросов.

В следующей таблице перечислены возможности WURFL и их переменные для обработчика правил.

> [!NOTE]
> Следующие переменные поддерживаются в возможностях **Заголовок запроса Modify Client** и **Заголовок ответа Modify Client**.

Функция | Переменная | Описание | Примеры значений
-----------|----------|-------------|----------------
Название торговой марки | %{wurfl_cap_brand_name} | Строка, указывающая название торговой марки устройства. | Samsung
ОС устройства | %{wurfl_cap_device_os} | Строка, указывающая операционную систему, установленную на устройстве. | iOS
Версия ОС устройства | %{wurfl_cap_device_os_version} | Строка, указывающая номер версии операционной системы, установленной на устройстве. | 1.0.1
Двойная ориентация | %{wurfl_cap_dual_orientation} | Логическое значение, указывающее на то, поддерживает ли устройство двойную ориентацию. | true
Предпочитаемое DTD для HTML | %{wurfl_cap_html_preferred_dtd} | Строка, указывающая предпочитаемое определение типа документа (DTD) для HTML-содержимого для мобильного устройства. | none<br/>xhtml_basic<br/>html5
Встраивание изображения | %{wurfl_cap_image_inlining} | Логическое значение, указывающее на то, поддерживает ли устройство изображения в кодировке Base64. | False
Используется ОС Android | %{wurfl_vcap_is_android} | Логическое значение, указывающее на то, использует ли устройство ОС Android. | true
Используется ОС iOS | %{wurfl_vcap_is_ios} | Логическое значение, указывающее на то, использует ли устройство ОС iOS. | False
Является устройством типа Smart TV | %{wurfl_cap_is_smarttv} | Логическое значение, указывающее на то, является ли устройство устройством типа Smart TV. | False
Является смартфоном | %{wurfl_vcap_is_smartphone} | Логическое значение, указывающее на то, является ли устройство смартфоном. | true
Является планшетом | %{wurfl_cap_is_tablet} | Логическое значение, указывающее на то, является ли устройство планшетом. Это описание не зависит от операционной системы. | true
Является беспроводным устройством | %{wurfl_cap_is_wireless_device} | Логическое значение, указывающее на то, является ли устройство беспроводным. | true
Маркетинговое имя | %{wurfl_cap_marketing_name} | Строка, указывающая маркетинговое имя устройства. | BlackBerry 8100 Pearl
Браузер мобильного устройства | %{wurfl_cap_mobile_browser} | Строка, указывающая браузер, используемый для запроса содержимого на устройстве. | Chrome
Версия браузера мобильного устройства | %{wurfl_cap_mobile_browser_version} | Строка, указывающая версию браузера, используемого для запроса содержимого на устройстве. | 31
Имя модели | %{wurfl_cap_model_name} | Строка, указывающая имя модели устройства. | s3
Прогрессивное скачивание | %{wurfl_cap_progressive_download} | Логическое значение, указывающее на то, поддерживает ли устройство воспроизведение аудио- и видеофайлов во время скачивания. | true
Дата выпуска | %{wurfl_cap_release_date} | Строка, указывающая год и месяц добавления устройства в базу данных WURFL.<br/><br/>Формат: `yyyy_mm` | 2013_december
Высота в разрешении | %{wurfl_cap_resolution_height} | Целое число, указывающее высоту устройства в пикселях. | 768
Ширина в разрешении | %{wurfl_cap_resolution_width} | Целое число, указывающее ширину устройства в пикселях. | 1024

[Вверх](#reference-for-rules-engine-match-conditions)

</br>

---

### <a name="edge-cname"></a>Граничная запись Cname

Основные сведения

- Список доступных граничных записей CNAME ограничивается соответствующими записями, настроенными на странице "Записи CNAME" платформы, на которой настроен обработчик правил.
- Прежде чем удалять конфигурацию граничной записи CNAME, убедитесь, что условие соответствия "Граничная запись CNAME" не ссылается на нее. Конфигурации граничной записи CNAME, которые были определены в правиле, невозможно удалить со страницы "Граничные записи CNAME".
- Не используйте инструкцию AND IF для объединения определенных условий соответствия. Например, объединение условий соответствия "Граничная запись CNAME" и "Источник клиента" привело бы к созданию шаблона соответствия, который никогда не может быть сопоставлен. Поэтому невозможно объединить два условия соответствия "Источник граничной записи CNAME" с помощью инструкции AND IF.
- Из-за способа отслеживания параметров кэша это условие соответствия несовместимо со следующими функциями:
  - Завершение заполнения кэша
  - Внутренний максимальный срок по умолчанию
  - Принудительное использование внутреннего максимального срока
  - Не учитывать источник без кэша
  - Внутреннее максимальное значение устаревания

[Вверх](#reference-for-rules-engine-match-conditions)

</br>

---

### <a name="referring-domain"></a>Домен источников ссылок

Имя узла, связанное с источником ссылок, через которое запрашивалось содержимое, определяет, выполняется ли условие "Домен источников ссылок".

Параметр **Соответствует**/**Не соответствует** определяет требования, при которых будет выполняться условие соответствия "Домен источников ссылок".

- **Соответствует**. Имя узла источников ссылок должно соответствовать указанным значениям. 
- **Не соответствует**. Имя узла источников ссылок не должно соответствовать указанному значению.

Основные сведения

- Укажите несколько имен узла, разделив их одним пробелом.
- Это условие соответствия поддерживает [подстановочные знаки](cdn-verizon-premium-rules-engine-reference.md#wildcard-values).
- Если указанное значение не содержит звездочку, оно должно точно соответствовать имени узла источника ссылок. Например, значение "mydomain.com" не соответствует "www.mydomain.com."
- Используйте параметр **Без учета регистра**, чтобы определить, учитывается ли регистр при сравнении.
- Из-за способа отслеживания параметров кэша это условие соответствия несовместимо со следующими функциями:
  - Завершение заполнения кэша
  - Внутренний максимальный срок по умолчанию
  - Принудительное использование внутреннего максимального срока
  - Не учитывать источник без кэша
  - Внутреннее максимальное значение устаревания

[Вверх](#reference-for-rules-engine-match-conditions)

</br>

---  

### <a name="request-header-literal"></a>Литерал заголовка запроса

Параметр **Соответствует**/**Не соответствует** определяет требования, при которых будет выполняться условие соответствия "Литерал заголовка запроса".

- **Соответствует**. Необходим запрос, содержащий указанный заголовок. Его значение должно соответствовать значению, которое определено в этом условии соответствия.
- **Не соответствует**. Запрос должен соответствовать любому из следующих критериев:
  - Не содержит указанный заголовок.
  - Содержит указанный заголовок, но его значение не соответствует определенному значению в этом условии соответствия.
  
Основные сведения

- Сравнение имен заголовка всегда выполняется без учета регистра. Используйте параметр **Без учета регистра**, чтобы определить, будет ли учитываться регистр при сравнении значений заголовка.
- Из-за способа отслеживания параметров кэша это условие соответствия несовместимо со следующими функциями:
  - Завершение заполнения кэша
  - Внутренний максимальный срок по умолчанию
  - Принудительное использование внутреннего максимального срока
  - Не учитывать источник без кэша
  - Внутреннее максимальное значение устаревания

[Вверх](#reference-for-rules-engine-match-conditions)

</br>

---  

### <a name="request-header-regex"></a>Регулярное выражение заголовка запроса

Параметр **Соответствует**/**Не соответствует** определяет требования, при которых будет выполняться условие соответствия "Регулярное выражение заголовка запроса".

- **Соответствует**. Необходим запрос, содержащий указанный заголовок. Его значение должно соответствовать шаблону, определенному в указанном [регулярном выражении](cdn-verizon-premium-rules-engine-reference.md#regular-expressions).
- **Не соответствует**. Запрос должен соответствовать любому из следующих критериев:
  - Не содержит указанный заголовок.
  - Содержит указанный заголовок, но его значение не соответствует указанному регулярному выражению.

Основные сведения

- Имя заголовка:
  - Сравнения имен заголовка выполняются без учета регистра.
  - Замените пробелы в имени заголовка на "%20."
- Значение заголовка:
  - Для значения заголовка можно использовать регулярные выражения.
  - Используйте параметр **Без учета регистра**, чтобы определить, будет ли учитываться регистр при сравнении значений заголовка.
  - Условие соответствия выполняется, только если значение заголовка точно соответствует хотя бы одному из указанных шаблонов.
- Из-за способа отслеживания параметров кэша это условие соответствия несовместимо со следующими функциями:
  - Завершение заполнения кэша
  - Внутренний максимальный срок по умолчанию
  - Принудительное использование внутреннего максимального срока
  - Не учитывать источник без кэша
  - Внутреннее максимальное значение устаревания

[Вверх](#reference-for-rules-engine-match-conditions)

</br>

---

### <a name="request-header-wildcard"></a>Шаблон заголовка запроса

Параметр **Соответствует**/**Не соответствует** определяет требования, при которых будет выполняться условие соответствия "Шаблон заголовка запроса".

- **Соответствует**. Необходим запрос, содержащий указанный заголовок. Его значение должно соответствовать хотя бы одному из значений, определенных в этом условии соответствия.
- **Не соответствует**. Запрос должен соответствовать любому из следующих критериев:
  - Не содержит указанный заголовок.
  - Содержит указанный заголовок, но его значение не соответствует ни одному из указанных значений.
  
Основные сведения

- Имя заголовка:
  - Сравнения имен заголовка выполняются без учета регистра.
  - Пробелы в имени заголовка должны быть заменены на "%20." Вы также можете использовать это значение для указания пробелов в значении заголовка.
- Значение заголовка:
  - Для значения заголовка можно использовать [подстановочные знаки](cdn-verizon-premium-rules-engine-reference.md#wildcard-values).
  - Используйте параметр **Без учета регистра**, чтобы определить, будет ли учитываться регистр при сравнении значений заголовка.
  - Условие соответствия выполняется, если значение заголовка точно соответствует хотя бы одному из указанных шаблонов.
  - Укажите несколько значений, разделив их одним пробелом.
- Из-за способа отслеживания параметров кэша это условие соответствия несовместимо со следующими функциями:
  - Завершение заполнения кэша
  - Внутренний максимальный срок по умолчанию
  - Принудительное использование внутреннего максимального срока
  - Не учитывать источник без кэша
  - Внутреннее максимальное значение устаревания

[Вверх](#reference-for-rules-engine-match-conditions)

</br>

---

### <a name="request-method"></a>Метод запроса

Условие соответствия "Метод запроса" выполняется, только если ресурсы запрашиваются с помощью выбранного метода запроса. Доступны следующие методы запроса:

- GET
- HEAD
- ПОМЕСТИТЬ
- OPTIONS
- PUT
- DELETE
- TRACE;
- CONNECT.

Основные сведения

- По умолчанию только метод запроса GET может создавать кэшированное содержимое в сети. Все остальные методы запроса передаются через сеть.
- Из-за способа отслеживания параметров кэша это условие соответствия несовместимо со следующими функциями:
  - Завершение заполнения кэша
  - Внутренний максимальный срок по умолчанию
  - Принудительное использование внутреннего максимального срока
  - Не учитывать источник без кэша
  - Внутреннее максимальное значение устаревания

[Вверх](#reference-for-rules-engine-match-conditions)

</br>

---

### <a name="request-scheme"></a>Схема запроса

Условие соответствия "Схема запроса" выполняется, только если ресурсы запрашиваются с помощью выбранного протокола. Доступные протоколы:

- HTTP
- HTTPS

Основные сведения

- Из-за способа отслеживания параметров кэша это условие соответствия несовместимо со следующими функциями:
  - Завершение заполнения кэша
  - Внутренний максимальный срок по умолчанию
  - Принудительное использование внутреннего максимального срока
  - Не учитывать источник без кэша
  - Внутреннее максимальное значение устаревания

[Вверх](#reference-for-rules-engine-match-conditions)

</br>

---

### <a name="url-path-directory"></a>Каталог URL-пути

Идентифицирует запрос по его относительному пути, который исключает имя файла запрошенного ресурса.

Параметр **Соответствует**/**Не соответствует** определяет требования, при которых будет выполняться условие соответствия "Каталог URL-пути".

- **Соответствует**. Запрос должен содержать относительный URL-адрес, исключая имя файла, соответствующее указанному шаблону URL-адреса.
- **Не соответствует**. Запрос должен содержать путь относительного URL-адреса, исключая имя файла, которое не соответствует указанному шаблону URL-адреса.

Основные сведения

- Используйте параметр **Относительно**, чтобы указать, где начинается точка сравнения URL-адресов: перед точкой доступа к содержимому или после нее. Точка доступа к содержимому представляет собой часть пути и отображается между именем узла Verizon CDN и относительным путем к запрошенному ресурсу (например, /800001/CustomerOrigin). Она определяет расположение по типу сервера (например, источник CDN или клиента) и номеру счета заказчика.

   Для параметра **Относительно** доступны следующие значения:
  - **Корневой домен**. Указывает, что точка сравнения URL-адресов начинается непосредственно после имени узла CDN. 

  Например, http:\//wpc.0001.&lt;домен&gt;/**800001/myorigin/myfolder**/index.htm

  - **Исходный домен**. Указывает, что точка сравнения URL-адресов начинается после точки доступа к содержимому (например, /000001 или /800001/myorigin). Так как запись CNAME \*.azureedge.net создана относительно исходного каталога в имени узла Verizon CDN по умолчанию, пользователи Azure CDN должны использовать значение **Исходный домен**. 

  Например, https:\//&lt;конечная_точка&gt;.azureedge.net/**myfolder**/index.htm 

  Этот URL-адрес указывает следующее имя узла Verizon CDN: http:\//wpc.0001.&lt;домен&gt;/800001/myorigin/**myfolder**/index.htm

- URL-адрес граничной записи CNAME перезаписывается URL-адресом CDN перед сравнением URL-адресов.

    Например, оба URL-адреса ниже указывают на один ресурс и, таким образом, имеют один URL-путь.
  - URL-адрес CDN: http:\//wpc.0001.&lt;домен&gt;/800001/CustomerOrigin/path/asset.htm
    
  - URL-адрес граничной записи CNAME: http:\//&lt;конечная_точка&gt;.azureedge.net/path/asset.htm
    
    Дополнительные сведения:
  - Личный домен: https:\//my.domain.com/path/asset.htm
    
    - URL-адрес (относительно корневого домена): /800001/CustomerOrigin/path/
    
    - URL-адрес (относительно исходного домена): /path/

- Часть URL-адреса, используемая для сравнения URL-адресов, заканчивается непосредственно перед именем файла запрошенного ресурса. Завершающая косая черта является последним знаком в пути такого типа.

- Замените все пробелы в шаблоне URL-пути на "%20."

- Каждый шаблон URL-пути может содержать одну или несколько звездочек (*), где каждая звездочка соответствует последовательности одного или нескольких знаков.

- Укажите несколько URL-путей в шаблоне, разделив их одним пробелом.

    Например, */sales/ */marketing/

- Для спецификации URL-пути можно использовать [значения с подстановочными знаками](cdn-verizon-premium-rules-engine-reference.md#wildcard-values).

- Используйте параметр **Без учета регистра**, чтобы определить, выполняется ли для сравнения регистр.

[Вверх](#reference-for-rules-engine-match-conditions)

</br>

---

### <a name="url-path-extension"></a>Расширение URL-пути

Определяет запросы с помощью расширения файла запрошенного ресурса.

Параметр **Соответствует**/**Не соответствует** определяет требования, при которых будет выполняться условие соответствия "Расширение URL-пути".

- **Соответствует**. URL-адрес запроса должен содержать расширение файла, которое точно соответствует указанному шаблону.

   Например, если указать "htm", сопоставятся ресурсы "htm", а не "html".  

- **Не соответствует**. Запрос URL-адреса должен содержать расширение файла, которое не соответствует указанному шаблону.

Основные сведения

- Укажите расширения файла для сопоставления в поле **Значение**. Не используйте точку в начале. Например, используйте htm вместо .htm.

- Используйте параметр **Без учета регистра**, чтобы определить, выполняется ли для сравнения регистр.

- Укажите несколько расширений файла, разделив их одним пробелом. 

    Например, htm html.

- Так, если задать "htm", выполнится сопоставление для ресурсов "htm", а не "html".

#### <a name="sample-scenario"></a>Пример сценария

В примере конфигурации ниже предполагается, что это условие соответствия выполняется, если запрос соответствует одному из указанных расширений.

Спецификация значения: asp aspx php html

Это условие соответствия выполняется, если найдены URL-адреса, оканчивающиеся на такие расширения:

- .asp
- .aspx
- .php
- .html

[Вверх](#reference-for-rules-engine-match-conditions)

</br>

---

### <a name="url-path-filename"></a>Имя файла URL-пути

Определяет запросы по имени файла запрошенного ресурса. В целях этого условия соответствия имя файла состоит из имени запрошенного ресурса, точки и расширения файла (например, index.html).

Параметр **Соответствует**/**Не соответствует** определяет требования, при которых будет выполняться условие соответствия "Имя файла URL-пути".

- **Соответствует**. Запрос должен содержать имя файла в URL-пути, которое соответствует указанному шаблону.
- **Не соответствует**. Запрос должен содержать имя файла в URL-пути, которое не соответствует указанному шаблону.

Основные сведения

- Используйте параметр **Без учета регистра**, чтобы определить, выполняется ли для сравнения регистр.

- Чтобы указать несколько расширений файла, разделите их одним пробелом.

    Например, index.htm index.html.

- Замените пробелы в значении имени файла на "%20."

- Для значения имени файла можно использовать [подстановочные знаки](cdn-verizon-premium-rules-engine-reference.md#wildcard-values). Например, каждый шаблон имени файла может содержать одну или несколько звездочек (*), где каждая звездочка соответствует последовательности одного или нескольких знаков.

- Если подстановочные знаки не указаны, этому условию соответствия может отвечать только точное соответствие.

    Например, "presentation.ppt" будет соответствовать ресурсу с именем "presentation.ppt", а не "presentation.pptx".

[Вверх](#reference-for-rules-engine-match-conditions)

</br>

---

### <a name="url-path-literal"></a>Литерал URL-пути

Сравнивает URL-путь запроса, включая имя файла, с указанным значением.

Параметр **Соответствует**/**Не соответствует** определяет требования, при которых будет выполняться условие соответствия "Литерал URL-пути".

- **Соответствует**. Запрос должен содержать URL-путь, соответствующий указанному шаблону.
- **Не соответствует**. Запрос должен содержать URL-путь, не соответствующий указанному шаблону.

Основные сведения

- Используйте параметр **Относительно**, чтобы указать, где начинается точка сравнения URL-адресов: перед точкой доступа к содержимому или после нее. 

    Для параметра **Относительно** доступны следующие значения:
  - **Корневой домен**. Указывает, что точка сравнения URL-адресов начинается непосредственно после имени узла CDN.

    Например, http:\//wpc.0001.&lt;домен&gt;/**800001/myorigin/myfolder/index.htm**

  - **Исходный домен**. Указывает, что точка сравнения URL-адресов начинается после точки доступа к содержимому (например, /000001 или /800001/myorigin). Так как запись CNAME \*.azureedge.net создана относительно исходного каталога в имени узла Verizon CDN по умолчанию, пользователи Azure CDN должны использовать значение **Исходный домен**. 

    Например, https:\//&lt;конечная_точка&gt;.azureedge.net/**myfolder**/index.htm

  Этот URL-адрес указывает следующее имя узла Verizon CDN: http:\//wpc.0001.&lt;домен&gt;/800001/myorigin/**myfolder/index.htm**

- URL-адрес граничной записи CNAME перезаписывается URL-адресом CDN перед сравнением URL-адресов.

Например, оба URL-адреса ниже указывают на один ресурс и, таким образом, имеют один URL-путь:

- URL-адрес CDN: http:\//wpc.0001.&lt;домен&gt;/800001/CustomerOrigin/path/asset.htm
- URL-адрес граничной записи CNAME: http:\//&lt;конечная_точка&gt;.azureedge.net/path/asset.htm

    Дополнительные сведения:
    
    - URL-адрес (относительно корневого домена): /800001/CustomerOrigin/path/asset.htm
   
    - URL-адрес (относительно исходного домена): /path/asset.htm

- Строки запроса в URL-адресе не учитываются.
- Используйте параметр **Без учета регистра**, чтобы определить, выполняется ли для сравнения регистр.
- Значение, указанное для этого условия соответствия, сравнивается со значением относительного пути точного запроса, выполняемого клиентом.

- Чтобы сопоставить все запросы, выполненные для определенного каталога, используйте условие соответствия [Каталог URL-пути](#url-path-directory) или [Шаблон URL-пути](#url-path-wildcard).

[Вверх](#reference-for-rules-engine-match-conditions)

</br>

---

### <a name="url-path-regex"></a>Регулярное выражение URL-пути

Сравнивает URL-путь запроса с указанным [регулярным выражением](cdn-verizon-premium-rules-engine-reference.md#regular-expressions).

Параметр **Соответствует**/**Не соответствует** определяет требования, при которых будет выполняться условие соответствия "Регулярное выражение URL-пути".

- **Соответствует**. Запрос должен содержать URL-путь, соответствующий указанному регулярному выражению.
- **Не соответствует**. Запрос должен содержать URL-путь, не соответствующий указанному регулярному выражению.

Основные сведения

- URL-адрес граничной записи CNAME перезаписывается URL-адресом CDN перед сравнением URL-адресов.

    Например, оба URL-адреса указывают на один ресурс и, таким образом, имеют один URL-путь.

     - URL-адрес CDN: http:\//wpc.0001.&lt;домен&gt;/800001/CustomerOrigin/path/asset.htm

     - URL-адрес граничной записи CNAME: http:\//my.domain.com/path/asset.htm

    Дополнительные сведения:
    
     - URL-адрес: /800001/CustomerOrigin/path/asset.htm

- Строки запроса в URL-адресе не учитываются.
    
- Используйте параметр **Без учета регистра**, чтобы определить, выполняется ли для сравнения регистр.
    
- Пробелы в URL-пути нужно заменить на "%20."

[Вверх](#reference-for-rules-engine-match-conditions)

</br>

---

### <a name="url-path-wildcard"></a>Шаблон URL-пути

Сравнивает относительный URL-путь запроса с указанным шаблоном подстановочного знака.

Параметр **Соответствует**/**Не соответствует** определяет требования, при которых будет выполняться условие соответствия "Шаблон URL-пути".

- **Соответствует**. Запрос должен содержать URL-путь, соответствующий указанному шаблону подстановочного знака.
- **Не соответствует**. Запрос должен содержать URL-путь, не соответствующий указанному шаблону подстановочного знака.

Основные сведения

- Параметр **Относительно**. Определяет начало точки сравнения URL-адресов: перед точкой доступа к содержимому или после нее.

   Этот параметр может принимать следующие значения:
     - **Корневой домен**. Указывает, что точка сравнения URL-адресов начинается непосредственно после имени узла CDN.

       Например, http:\//wpc.0001.&lt;домен&gt;/**800001/myorigin/myfolder/index.htm**

     - **Исходный домен**. Указывает, что точка сравнения URL-адресов начинается после точки доступа к содержимому (например, /000001 или /800001/myorigin). Так как запись CNAME \*.azureedge.net создана относительно исходного каталога в имени узла Verizon CDN по умолчанию, пользователи Azure CDN должны использовать значение **Исходный домен**. 

       Например, https:\//&lt;конечная_точка&gt;.azureedge.net/**myfolder**/index.htm

     Этот URL-адрес указывает следующее имя узла Verizon CDN: http:\//wpc.0001.&lt;домен&gt;/800001/myorigin/**myfolder/index.htm**

- URL-адрес граничной записи CNAME перезаписывается URL-адресом CDN перед сравнением URL-адресов.

    Например, оба URL-адреса ниже указывают на один ресурс и, таким образом, имеют один URL-путь:
     - URL-адрес CDN: http://wpc.0001.&lt ;domain&gt; /800001/CustomerOrigin/path/asset.htm
     - URL-адрес граничной записи CNAME: http:\//&lt;конечная_точка&gt;.azureedge.net/path/asset.htm
    
    Дополнительные сведения:
    
     - URL-адрес (относительно корневого домена): /800001/CustomerOrigin/path/asset.htm
    
     - URL-адрес (относительно исходного домена): /path/asset.htm
    
- Укажите несколько URL-путей, разделив их одним пробелом.

   Например: /marketing/asset.* /sales/\*.htm

- Строки запроса в URL-адресе не учитываются.
    
- Используйте параметр **Без учета регистра**, чтобы определить, выполняется ли для сравнения регистр.
    
- Замените пробелы в URL-пути на "%20."
    
- Для значения, указанного для URL-пути, можно использовать [подстановочные знаки](cdn-verizon-premium-rules-engine-reference.md#wildcard-values). Каждый шаблон URL-пути может содержать одну или несколько звездочек (*), где каждая звездочка может соответствовать последовательности одного или нескольких знаков.

#### <a name="sample-scenarios"></a>Примеры сценариев

В примере конфигураций в таблице ниже предполагается, что это условие соответствия выполняется, если запрос соответствует указанному шаблону URL-адреса:

Значение                   | Относительно    | Результат 
------------------------|----------------|-------
\*/test.html \*/test.php  | Корневой или исходный домен | Этому шаблону соответствуют запросы ресурсов с именем "test.html" или "test.php" в любой папке.
/80ABCD/origin/text/*   | Корневой домен           | Для соответствия этому шаблону запрошенный ресурс должен отвечать следующим требованиям: <br />— находится в источнике клиента ("origin"); <br />— относительный путь начинается с папки с именем "text". То есть запрошенный ресурс может находиться в папке "text" или одной из ее рекурсивных вложенных папок.
*/css/* */js/*          | Корневой или исходный домен | Этому шаблону соответствуют все URL-адреса CDN и граничной записи CNAME, содержащие папку css или js.
*.jpg *.gif *.png       | Корневой или исходный домен | Этому шаблону соответствуют все URL-адреса CDN или граничной записи CNAME, оканчивающиеся на .jpg, .gif или .png. Альтернативный способ указать этот шаблон — использовать [условие соответствия "Расширение URL-пути"](#url-path-extension).
/images/\* /media/\*      | Исходный домен         | Этому шаблону соответствуют URL-адреса CDN или граничной записи CNAME, относительные пути которых начинаются с папки "images" или "media". <br />URL-адрес CDN: http:\//wpc.0001.&lt;домен&gt;/800001/myorigin/images/sales/event1.png<br />Пример URL-адреса граничной записи CNAME: http:\//cdn.mydomain.com/images/sales/event1.png

[Вверх](#reference-for-rules-engine-match-conditions)

</br>

---

### <a name="url-query-literal"></a>Литерал запроса URL-адреса

Сравнивает строку запроса с указанным значением.

Параметр **Соответствует**/**Не соответствует** определяет требования, при которых будет выполняться условие соответствия "Литерал запроса URL-адреса".

- **Соответствует**. Запрос должен содержать строку запроса URL-адреса, соответствующую указанной строке запроса.
- **Не соответствует**. Запрос должен содержать строку запроса URL-адреса, не соответствующую указанной строке запроса.

Основные сведения

- Только точные соответствия строки запроса отвечают этому условию соответствия.
    
- Используйте параметр **Без учета регистра** для управления чувствительностью к регистру сравнений строки запроса.
    
- Не используйте вопросительный знак (?) в начале в тексте значения строки запроса.
    
- Для некоторых знаков требуется кодирование в формат URL-адреса. Используйте знак процента для кодирования таких знаков в формат URL-адреса:

   Character | Кодирование в формат URL-адреса
   ----------|---------
   Пробел     | %20
   &         | %25

- Из-за способа отслеживания параметров кэша это условие соответствия несовместимо со следующими функциями:
   - Завершение заполнения кэша
   - Внутренний максимальный срок по умолчанию
   - Принудительное использование внутреннего максимального срока
   - Не учитывать источник без кэша
   - Внутреннее максимальное значение устаревания

[Вверх](#reference-for-rules-engine-match-conditions)

</br>

---

### <a name="url-query-parameter"></a>Параметр запроса URL-адреса

Определяет запросы, содержащие указанный параметр строки запроса. Для этого параметра задается значение, соответствующее указанному шаблону. Параметры строки запроса (например, параметр=значение) в URL-адресе запроса определяют, выполнено ли это условие. Это условие соответствия определяет параметр строки запроса по имени и принимает одно или несколько значений для значения параметра. 

Параметр **Соответствует**/**Не соответствует** определяет требования, при которых будет выполняться условие соответствия "Параметр запроса URL-адреса".

- **Соответствует**. Запрос должен содержать указанный параметр со значением, которое соответствует хотя бы одному из значений, определенных в этом условии соответствия.
- **Не соответствует**. Запрос должен соответствовать любому из следующих критериев:
  - не содержит указанный параметр;
  - содержит указанный параметр, но его значение не соответствует ни одному из значений, определенных в этом условии соответствия.

Это условие соответствия предоставляет простой способ указания сочетания имени и значения параметра. При сопоставлении параметра строки запроса для обеспечения большей гибкости можно использовать условие соответствия [Шаблон запроса URL-адреса](#url-query-wildcard).

Основные сведения

- Для каждого экземпляра этого условия соответствия можно указать только одно имя с параметром запроса URL-адреса.
    
- Так как подстановочные знаки не поддерживаются, если указано имя параметра, для сравнения могут использоваться только точные соответствия имен параметров.
- Значения параметра могут включать [подстановочные знаки](cdn-verizon-premium-rules-engine-reference.md#wildcard-values).
   - Каждый шаблон значения параметра может содержать одну или несколько звездочек (*), где каждая звездочка может соответствовать последовательности одного или нескольких знаков.
   - Для некоторых знаков требуется кодирование в формат URL-адреса. Используйте знак процента для кодирования таких знаков в формат URL-адреса:

       Character | Кодирование в формат URL-адреса
       ----------|---------
       Пробел     | %20
       &         | %25

- Укажите несколько значений параметра строки запроса, разделив их одним пробелом. Это условие соответствия выполняется, если запрос содержит одно из указанных сочетаний имени и значения.

   - Пример 1

     - Конфигурация:

       ValueA ValueB

     - Эта конфигурация соответствует параметрам строки запроса ниже:

       Parameter1=ValueA
    
       Parameter1=ValueB

   - Пример 2

     - Конфигурация: 

        Value%20A Value%20B

     - Эта конфигурация соответствует параметрам строки запроса ниже:

       Parameter1=Value%20A

       Parameter1=Value%20B

- Это условие соответствия выполняется, только если есть точное соответствие как минимум с одним из указанных сочетаний значения и имени в строке запроса.

   Например, если использовать конфигурацию в предыдущем примере, сочетание значения и имени параметра "Parameter1=ValueAdd" не будет считаться совпадением. Тем не менее, если указать одно из значений ниже, оно будет соответствовать этому сочетанию имени и значения:

   - ValueA ValueB ValueAdd
   - ValueA* ValueB

- Используйте параметр **Без учета регистра** для управления чувствительностью к регистру сравнений строки запроса.
    
- Из-за способа отслеживания параметров кэша это условие соответствия несовместимо со следующими функциями:
   - Завершение заполнения кэша
   - Внутренний максимальный срок по умолчанию
   - Принудительное использование внутреннего максимального срока
   - Не учитывать источник без кэша
   - Внутреннее максимальное значение устаревания

#### <a name="sample-scenarios"></a>Примеры сценариев

В следующем примере показано, как этот параметр действует в определенных ситуациях.

ИМЯ  | Значение |  Результат
------|-------|--------
пользователя  | Ivan   | Для соответствия этому шаблону строка запроса запрошенного URL-адреса должна быть "?user=ivan."
пользователя  | *     | Для соответствия этому шаблону строка запроса запрошенного URL-адреса должна содержать параметр пользователя.
Email | Ivan\* | Для соответствия этому шаблону строка запроса запрошенного URL-адреса должна содержать параметр адреса электронной почты, который начинается с "Ivan".

[Вверх](#reference-for-rules-engine-match-conditions)

</br>

---

### <a name="url-query-regex"></a>Регулярное выражение запроса URL-адреса

Определяет запросы, содержащие указанный параметр строки запроса. Для этого параметра задается значение, соответствующее указанному [регулярному выражению](cdn-verizon-premium-rules-engine-reference.md#regular-expressions).

Параметр **Соответствует**/**Не соответствует** определяет требования, при которых будет выполняться условие соответствия "Регулярное выражение запроса URL-адреса".

- **Соответствует**. Запрос должен содержать строку запроса URL-адреса, соответствующую указанному регулярному выражению.
- **Не соответствует**. Запрос должен содержать строку запроса URL-адреса, не соответствующую указанному регулярному выражению.

Основные сведения

- Только точные совпадения для указанного регулярного выражения отвечают этому условию соответствия.
    
- Используйте параметр **Без учета регистра** для управления чувствительностью к регистру сравнений строки запроса.
    
- В целях этого параметра строка запроса начинается с первого знака после разделителя вопросительного знака (?) строки запроса.
    
- Для некоторых знаков требуется кодирование в формат URL-адреса. Используйте знак процента для кодирования таких знаков в формат URL-адреса:

   Character | Кодирование в формат URL-адреса | Значение
   ----------|--------------|------
   Пробел     | %20          | \%20
   &         | %25          | \%25

   Note that percentage symbols must be escaped.

- Double-escape special regular expression characters (for example, \^$.+) to include a backslash in the regular expression.

   For example:

   Value | Interpreted As 
   ------|---------------
   \\+    | +
   \\\\+   | \\+

- Due to the manner in which cache settings are tracked, this match condition is incompatible with the following features:
   - Complete Cache Fill
   - Default Internal Max-Age
   - Force Internal Max-Age
   - Ignore Origin No-Cache
   - Internal Max-Stale

[Back to top](#reference-for-rules-engine-match-conditions)

</br>

---

### URL Query Wildcard

Compares the specified value(s) against the request's query string.

The **Matches**/**Does Not Match** option determines the conditions under which the URL Query Wildcard match condition is met.

- **Matches**: Requires the request to contain a URL query string that matches the specified wildcard value.
- **Does Not Match**: Requires the request to contain a URL query string that does not match the specified wildcard value.

Key information:

- For the purposes of this option, a query string starts with the first character after the question mark (?) delimiter for the query string.
- Parameter values can include [wildcard values](cdn-verizon-premium-rules-engine-reference.md#wildcard-values):
   - Each parameter value pattern can consist of one or more asterisks (*), where each asterisk can match a sequence of one or more characters.
   - Certain characters require URL encoding. Use the percentage symbol to URL encode the following characters:

     Character | URL Encoding
     ----------|---------
     Space     | %20
     &         | %25

- Specify multiple values by delimiting each one with a single space.

   For example: *Parameter1=ValueA* *ValueB* *Parameter1=ValueC&Parameter2=ValueD*

- Only exact matches to at least one of the specified query string patterns satisfy this match condition.
    
- Use the **Ignore Case** option to control the case-sensitivity of query string comparisons.
    
- Due to the manner in which cache settings are tracked, this match condition is incompatible with the following features:
   - Complete Cache Fill
   - Default Internal Max-Age
   - Force Internal Max-Age
   - Ignore Origin No-Cache
   - Internal Max-Stale

#### Sample scenarios

The following example demonstrates how this option works in specific situations:

 Name                 | Description
 ---------------------|------------
user=joe              | This pattern is matched when the query string for a requested URL is "?user=joe."
\*user=\* \*optout=\* | This pattern is matched when the CDN URL query contains either the user or optout parameter.

[Back to top](#reference-for-rules-engine-match-conditions)

</br>

## Next steps

- [Azure Content Delivery Network overview](cdn-overview.md)
- [Rules engine reference](cdn-verizon-premium-rules-engine-reference.md)
- [Rules engine conditional expressions](cdn-verizon-premium-rules-engine-reference-conditional-expressions.md)
- [Rules engine features](cdn-verizon-premium-rules-engine-reference-features.md)
- [Overriding default HTTP behavior using the rules engine](cdn-verizon-premium-rules-engine.md)\`20
title: Azure CDN from Verizon Premium rules engine match conditions | Microsoft Docs
description: Reference documentation for Azure Content Delivery Network from Verizon Premium rules engine match conditions.
services: cdn
author: mdgattuso

ms.service: azure-cdn
ms.topic: article
ms.date: 05/31/2019
ms.author: magattus

---

# Azure CDN from Verizon Premium rules engine match conditions

This article lists detailed descriptions of the available match conditions for the Azure Content Delivery Network (CDN) from Verizon Premium [rules engine](cdn-verizon-premium-rules-engine.md).

The second part of a rule is the match condition. A match condition identifies specific types of requests for which a set of features will be performed.

For example, you can use a match condition to:

- Filter requests for content at a particular location.
- Filter requests generated from a particular IP address or country/region.
- Filter requests by header information.

## Always match condition

The Always match condition applies a default set of features to all requests.

Name | Purpose
-----|--------
[Always](#always) | Applies a default set of features to all requests.

## Device match condition

The Device match condition identifies requests made from a mobile device based on its properties.  

Name | Purpose
-----|--------
[Device](#device) | Identifies requests made from a mobile device based on its properties.

## Location match conditions

The Location match conditions identify requests based on the requester's location.

Name | Purpose
-----|--------
[AS Number](#as-number) | Identifies requests that originate from a particular network.
[Country](#country) | Identifies requests that originate from the specified countries/regions.

## Origin match conditions

The Origin match conditions identify requests that point to Content Delivery Network storage or a customer origin server.

Name | Purpose
-----|--------
[CDN Origin](#cdn-origin) | Identifies requests for content stored in Content Delivery Network storage.
[Customer Origin](#customer-origin) | Identifies requests for content stored on a specific customer origin server.

## Request match conditions

The Request match conditions identify requests based on their properties.

Name | Purpose
-----|--------
[Client IP Address](#client-ip-address) | Identifies requests that originate from a particular IP address.
[Cookie Parameter](#cookie-parameter) | Checks the cookies associated with each request for the specified value.
[Cookie Parameter Regex](#cookie-parameter-regex) | Checks the cookies associated with each request for the specified regular expression.
[Edge Cname](#edge-cname) | Identifies requests that point to a specific edge CNAME.
[Referring Domain](#referring-domain) | Identifies requests that were referred from the specified host names.
[Request Header Literal](#request-header-literal) | Identifies requests that contain the specified header set to a specified value.
[Request Header Regex](#request-header-regex) | Identifies requests that contain the specified header set to a value that matches the specified regular expression.
[Request Header Wildcard](#request-header-wildcard) | Identifies requests that contain the specified header set to a value that matches the specified pattern.
[Request Method](#request-method) | Identifies requests by their HTTP method.
[Request Scheme](#request-scheme) | Identifies requests by their HTTP protocol.

## URL match conditions

The URL match conditions identify requests based on their URLs.

Name | Purpose
-----|--------
[URL Path Directory](#url-path-directory) | Identifies requests by their relative path.
[URL Path Extension](#url-path-extension) | Identifies requests by their file name extension.
[URL Path Filename](#url-path-filename) | Identifies requests by their file name.
[URL Path Literal](#url-path-literal) | Compares a request's relative path to the specified value.
[URL Path Regex](#url-path-regex) | Compares a request's relative path to the specified regular expression.
[URL Path Wildcard](#url-path-wildcard) | Compares a request's relative path to the specified pattern.
[URL Query Literal](#url-query-literal) | Compares a request's query string to the specified value.
[URL Query Parameter](#url-query-parameter) | Identifies requests that contain the specified query string parameter set to a value that matches a specified pattern.
[URL Query Regex](#url-query-regex) | Identifies requests that contain the specified query string parameter set to a value that matches a specified regular expression.
[URL Query Wildcard](#url-query-wildcard) | Compares the specified value against the request's query string.

## Reference for rules engine match conditions

---

### Always

The Always match condition applies a default set of features to all requests.

[Back to top](#reference-for-rules-engine-match-conditions)

</br>

---

### AS Number

The AS Number network is defined by its autonomous system number (ASN). 

The **Matches**/**Does Not Match** option determines the conditions under which the AS Number match condition is met:

- **Matches**: Requires that the ASN of the client network matches one of the specified ASNs. 
- **Does Not Match**: Requires that the ASN of the client network does not match any of the specified ASNs.

Key information:

- Specify multiple ASNs by delimiting each one with a single space. For example, 64514 64515 matches requests that arrive from either 64514 or 64515.
- Certain requests might not return a valid ASN. A question mark (?) will match requests for which a valid ASN could not be determined.
- Specify the entire ASN for the desired network. Partial values will not be matched.
- Due to the manner in which cache settings are tracked, this match condition is incompatible with the following features:
  - Complete Cache Fill
  - Default Internal Max-Age
  - Force Internal Max-Age
  - Ignore Origin No-Cache
  - Internal Max-Stale

[Back to top](#reference-for-rules-engine-match-conditions)

</br>

---

### CDN Origin

The CDN Origin match condition is met when both of the following conditions are met:

- Content from CDN storage was requested.
- The request URI uses the type of content access point (for example, /000001) that's defined in this match condition:
  - CDN URL: The request URI must contain the selected content access point.
  - Edge CNAME URL: The corresponding edge CNAME configuration must point to the selected content access point.
  
Key information:

- The content access point identifies the service that should serve the requested content.
- Don't use an AND IF statement to combine certain match conditions. For example, combining a CDN Origin match condition with a Customer Origin match condition would create a match pattern that could never be matched. For this reason, two CDN Origin match conditions cannot be combined through an AND IF statement.

[Back to top](#reference-for-rules-engine-match-conditions)

</br>

---

### Client IP Address

The **Matches**/**Does Not Match** option determines the conditions under which the Client IP Address match condition is met:

- **Matches**: Requires that the client's IP address matches one of the specified IP addresses. 
- **Does Not Match**: Requires that the client's IP address does not match any of the specified IP addresses. 

Key information:

- Use CIDR notation.
- Specify multiple IP addresses and/or IP address blocks by delimiting each one with a single space. For example:
  - **IPv4 example**: 1.2.3.4 10.20.30.40 matches any requests that arrive from either address 1.2.3.4 or 10.20.30.40.
  - **IPv6 example**: 1:2:3:4:5:6:7:8 10:20:30:40:50:60:70:80 matches any requests that arrive from either address 1:2:3:4:5:6:7:8 or 10:20:30:40:50:60:70:80.
- The syntax for an IP address block is the base IP address followed by a forward slash and the prefix size. For example:
  - **IPv4 example**: 5.5.5.64/26 matches any requests that arrive from addresses 5.5.5.64 through 5.5.5.127.
  - **IPv6 example**: 1:2:3:/48 matches any requests that arrive from addresses 1:2:3:0:0:0:0:0 through 1:2:3:ffff:ffff:ffff:ffff:ffff.
- Due to the manner in which cache settings are tracked, this match condition is incompatible with the following features:
  - Complete Cache Fill
  - Default Internal Max-Age
  - Force Internal Max-Age
  - Ignore Origin No-Cache
  - Internal Max-Stale

[Back to top](#reference-for-rules-engine-match-conditions)

</br>

---

### Cookie Parameter

The **Matches**/**Does Not Match** option determines the conditions under which the Cookie Parameter match condition is met.

- **Matches**: Requires a request to contain the specified cookie with a value that matches at least one of the values that are defined in this match condition.
- **Does Not Match**: Requires that the request meets either of the following criteria:
  - It does not contain the specified cookie.
  - It contains the specified cookie, but its value does not match any of the values that are defined in this match condition.
  
Key information:

- Cookie name:
  - Because wildcard values, including asterisks (*), are not supported when you're specifying a cookie name, only exact cookie name matches are eligible for comparison.
  - Only a single cookie name can be specified per instance of this match condition.
  - Cookie name comparisons are case-insensitive.
- Cookie value:
  - Specify multiple cookie values by delimiting each one with a single space.
  - A cookie value can take advantage of [wildcard values](cdn-verizon-premium-rules-engine-reference.md#wildcard-values).
  - If a wildcard value has not been specified, then only an exact match will satisfy this match condition. For example, specifying "Value" will match "Value," but not "Value1" or "Value2."
  - Use the **Ignore Case** option to control whether a case-sensitive comparison is made against the request's cookie value.
- Due to the manner in which cache settings are tracked, this match condition is incompatible with the following features:
  - Complete Cache Fill
  - Default Internal Max-Age
  - Force Internal Max-Age
  - Ignore Origin No-Cache
  - Internal Max-Stale

[Back to top](#reference-for-rules-engine-match-conditions)
</br>

---

### Cookie Parameter Regex

The Cookie Parameter Regex match condition defines a cookie name and value. You can use [regular expressions](cdn-verizon-premium-rules-engine-reference.md#regular-expressions) to define the desired cookie value.

The **Matches**/**Does Not Match** option determines the conditions under which the Cookie Parameter Regex match condition is met.

- **Matches**: Requires a request to contain the specified cookie with a value that matches the specified regular expression.
- **Does Not Match**: Requires that the request meets either of the following criteria:
  - It does not contain the specified cookie.
  - It contains the specified cookie, but its value does not match the specified regular expression.
  
Key information:

- Cookie name:
  - Because regular expressions and wildcard values, including asterisks (*), are not supported when you're specifying a cookie name, only exact cookie name matches are eligible for comparison.
  - Only a single cookie name can be specified per instance of this match condition.
  - Cookie name comparisons are case-insensitive.
- Cookie value:
  - A cookie value can take advantage of regular expressions.
  - Use the **Ignore Case** option to control whether a case-sensitive comparison is made against the request's cookie value.
- Due to the manner in which cache settings are tracked, this match condition is incompatible with the following features:
  - Complete Cache Fill
  - Default Internal Max-Age
  - Force Internal Max-Age
  - Ignore Origin No-Cache
  - Internal Max-Stale

[Back to top](#reference-for-rules-engine-match-conditions)

</br>

---

### Country

You can specify a country through its country code. 

The **Matches**/**Does Not Match** option determines the conditions under which the Country match condition is met:

- **Matches**: Requires the request to contain the specified country code values. 
- **Does Not Match**: Requires that the request does not contain the specified country code values.

Key information:

- Specify multiple country codes by delimiting each one with a single space.
- Wildcards are not supported when you're specifying a country code.
- The "EU" and "AP" country codes do not encompass all IP addresses in those regions.
- Certain requests might not return a valid country code. A question mark (?) will match requests for which a valid country code could not be determined.
- Country codes are case-sensitive.
- Due to the manner in which cache settings are tracked, this match condition is incompatible with the following features:
  - Complete Cache Fill
  - Default Internal Max-Age
  - Force Internal Max-Age
  - Ignore Origin No-Cache
  - Internal Max-Stale

#### Implementing Country Filtering by using the rules engine

This match condition allows you to perform a multitude of customizations based on the location from which a request originated. For example, the behavior of the Country Filtering feature can be replicated through the following configuration:

- URL Path Wildcard match: Set the [URL Path Wildcard match condition](#url-path-wildcard) to the directory that will be secured. 
    Append an asterisk to the end of the relative path to ensure that access to all of its children will be restricted by this rule.

- Country match: Set the Country match condition to the desired set of countries.
  - Allow: Set the Country match condition to **Does Not Match** to allow only the specified countries access to content stored in the location defined by the URL Path Wildcard match condition.
  - Block: Set the Country match condition to **Matches** to block the specified countries from accessing content stored in the location defined by the URL Path Wildcard match condition.

- Deny Access (403) Feature: Enable the [Deny Access (403) feature](cdn-verizon-premium-rules-engine-reference-features.md#deny-access-403) to replicate the allow or block portion of the Country Filtering feature.

[Back to top](#reference-for-rules-engine-match-conditions)

</br>

---

### Customer Origin

Key information:

- The Customer Origin match condition is met regardless of whether content is requested through a CDN URL or an edge CNAME URL that points to the selected customer origin.
- A customer origin configuration that's referenced by a rule cannot be deleted from the Customer Origin page. Before you attempt to delete a customer origin configuration, make sure that the following configurations do not reference it:
  - A Customer Origin match condition
  - An edge CNAME configuration
- Don't use an AND IF statement to combine certain match conditions. For example, combining a Customer Origin match condition with a CDN Origin match condition would create a match pattern that could never be matched. For this reason, two Customer Origin match conditions cannot be combined through an AND IF statement.

[Back to top](#reference-for-rules-engine-match-conditions)

</br>

---

### Device

The Device match condition identifies requests made from a mobile device based on its properties. Mobile device detection is achieved through [WURFL](http://wurfl.sourceforge.net/). 

The **Matches**/**Does Not Match** option determines the conditions under which the Device match condition is met:

- **Matches**: Requires the requester's device to match the specified value. 
- **Does Not Match**: Requires that the requester's device does not match the specified value.

Key information:

- Use the **Ignore Case** option to specify whether the specified value is case-sensitive.
- Due to the manner in which cache settings are tracked, this match condition is incompatible with the following features:
  - Complete Cache Fill
  - Default Internal Max-Age
  - Force Internal Max-Age
  - Ignore Origin No-Cache
  - Internal Max-Stale

#### String Type

A WURFL capability typically accepts any combination of numbers, letters, and symbols. Due to the flexible nature of this capability, you must choose how the value associated with this match condition is interpreted. The following table describes the available set of options:

Type     | Description
---------|------------
Literal  | Select this option to prevent most characters from taking on special meaning by using their [literal value](cdn-verizon-premium-rules-engine-reference.md#literal-values).
Wildcard | Select this option to take advantage of all [wildcard characters]([wildcard values](cdn-verizon-premium-rules-engine-reference.md#wildcard-values).
Regex    | Select this option to use [regular expressions](cdn-verizon-premium-rules-engine-reference.md#regular-expressions). Regular expressions are useful for defining a pattern of characters.

#### WURFL capabilities

A WURFL capability refers to a category that describes mobile devices. The selected capability determines the type of mobile device description that is used to identify requests.

The following table lists WURFL capabilities and their variables for the rules engine.

> [!NOTE]
> The following variables are supported in the **Modify Client Request Header** and **Modify Client Response Header** features.

Capability | Variable | Description | Sample values
-----------|----------|-------------|----------------
Brand Name | %{wurfl_cap_brand_name} | A string that indicates the brand name of the device. | Samsung
Device OS | %{wurfl_cap_device_os} | A string that indicates the operating system installed on the device. | IOS
Device OS Version | %{wurfl_cap_device_os_version} | A string that indicates the version number of the operating system installed on the device. | 1.0.1
Dual Orientation | %{wurfl_cap_dual_orientation} | A Boolean that indicates whether the device supports dual orientation. | true
HTML Preferred DTD | %{wurfl_cap_html_preferred_dtd} | A string that indicates the mobile device's preferred document type definition (DTD) for HTML content. | none<br/>xhtml_basic<br/>html5
Image Inlining | %{wurfl_cap_image_inlining} | A Boolean that indicates whether the device supports Base64 encoded images. | false
Is Android | %{wurfl_vcap_is_android} | A Boolean that indicates whether the device uses the Android OS. | true
Is IOS | %{wurfl_vcap_is_ios} | A Boolean that indicates whether the device uses iOS. | false
Is Smart TV | %{wurfl_cap_is_smarttv} | A Boolean that indicates whether the device is a smart TV. | false
Is Smartphone | %{wurfl_vcap_is_smartphone} | A Boolean that indicates whether the device is a smartphone. | true
Is Tablet | %{wurfl_cap_is_tablet} | A Boolean that indicates whether the device is a tablet. This description is  OS-independent. | true
Is Wireless Device | %{wurfl_cap_is_wireless_device} | A Boolean that indicates whether the device is considered a wireless device. | true
Marketing Name | %{wurfl_cap_marketing_name} | A string that indicates the device's marketing name. | BlackBerry 8100 Pearl
Mobile Browser | %{wurfl_cap_mobile_browser} | A string that indicates the browser that's used to request content from the device. | Chrome
Mobile Browser Version | %{wurfl_cap_mobile_browser_version} | A string that indicates the version of the browser that's used to request content from the device. | 31
Model Name | %{wurfl_cap_model_name} | A string that indicates the device's model name. | s3
Progressive Download | %{wurfl_cap_progressive_download} | A Boolean that indicates whether the device supports the playback of audio and video while it is still being downloaded. | true
Release Date | %{wurfl_cap_release_date} | A string that indicates the year and month on which the device was added to the WURFL database.<br/><br/>Format: `yyyy_mm` | 2013_december
Resolution Height | %{wurfl_cap_resolution_height} | An integer that indicates the device's height in pixels. | 768
Resolution Width | %{wurfl_cap_resolution_width} | An integer that indicates the device's width in pixels. | 1024

[Back to top](#reference-for-rules-engine-match-conditions)

</br>

---

### Edge Cname

Key information:

- The list of available edge CNAMEs is limited to those edge CNAMEs that have been configured on the Edge CNAMEs page for the platform on which the rules engine is being configured.
- Before you attempt to delete an edge CNAME configuration, make sure that an Edge Cname match condition does not reference it. Edge CNAME configurations that have been defined in a rule cannot be deleted from the Edge CNAMEs page.
- Don't use an AND IF statement to combine certain match conditions. For example, combining an Edge Cname match condition with a Customer Origin match condition would create a match pattern that could never be matched. For this reason, two Edge Cname match conditions cannot be combined through an AND IF statement.
- Due to the manner in which cache settings are tracked, this match condition is incompatible with the following features:
  - Complete Cache Fill
  - Default Internal Max-Age
  - Force Internal Max-Age
  - Ignore Origin No-Cache
  - Internal Max-Stale

[Back to top](#reference-for-rules-engine-match-conditions)

</br>

---

### Referring Domain

The host name associated with the referrer through which content was requested determines whether the Referring Domain condition is met.

The **Matches**/**Does Not Match** option determines the conditions under which the Referring Domain match condition is met:

- **Matches**: Requires the referring host name to match the specified values. 
- **Does Not Match**: Requires that the referring host name does not match the specified value.

Key information:

- Specify multiple host names by delimiting each one with a single space.
- This match condition supports [wildcard values](cdn-verizon-premium-rules-engine-reference.md#wildcard-values).
- If the specified value does not contain an asterisk, it must be an exact match for the referrer's host name. For example, specifying "mydomain.com" would not match "www.mydomain.com."
- Use the **Ignore Case** option to control whether a case-sensitive comparison is made.
- Due to the manner in which cache settings are tracked, this match condition is incompatible with the following features:
  - Complete Cache Fill
  - Default Internal Max-Age
  - Force Internal Max-Age
  - Ignore Origin No-Cache
  - Internal Max-Stale

[Back to top](#reference-for-rules-engine-match-conditions)

</br>

---  

### Request Header Literal

The **Matches**/**Does Not Match** option determines the conditions under which the Request Header Literal match condition is met.

- **Matches**: Requires the request to contain the specified header. Its value must match the one that's defined in this match condition.
- **Does Not Match**: Requires that the request meets either of the following criteria:
  - It does not contain the specified header.
  - It contains the specified header, but its value does not match the one that's defined in this match condition.
  
Key information:

- Header name comparisons are always case-insensitive. Use the **Ignore Case** option to control the case-sensitivity of header value comparisons.
- Due to the manner in which cache settings are tracked, this match condition is incompatible with the following features:
  - Complete Cache Fill
  - Default Internal Max-Age
  - Force Internal Max-Age
  - Ignore Origin No-Cache
  - Internal Max-Stale

[Back to top](#reference-for-rules-engine-match-conditions)

</br>

---  

### Request Header Regex

The **Matches**/**Does Not Match** option determines the conditions under which the Request Header Regex match condition is met.

- **Matches**: Requires the request to contain the specified header. Its value must match the pattern that's defined in the specified [regular expression](cdn-verizon-premium-rules-engine-reference.md#regular-expressions).
- **Does Not Match**: Requires that the request meets either of the following criteria:
  - It does not contain the specified header.
  - It contains the specified header, but its value does not match the specified regular expression.

Key information:

- Header name:
  - Header name comparisons are case-insensitive.
  - Replace spaces in the header name with "%20."
- Header value:
  - A header value can take advantage of regular expressions.
  - Use the **Ignore Case** option to control the case-sensitivity of header value comparisons.
  - The match condition is met only when a header value exactly matches at least one of the specified patterns.
- Due to the manner in which cache settings are tracked, this match condition is incompatible with the following features:
  - Complete Cache Fill
  - Default Internal Max-Age
  - Force Internal Max-Age
  - Ignore Origin No-Cache
  - Internal Max-Stale

[Back to top](#reference-for-rules-engine-match-conditions)

</br>

---

### Request Header Wildcard

The **Matches**/**Does Not Match** option determines the conditions under which the Request Header Wildcard match condition is met.

- **Matches**: Requires the request to contain the specified header. Its value must match at least one of the values that are defined in this match condition.
- **Does Not Match**: Requires that the request meets either of the following criteria:
  - It does not contain the specified header.
  - It contains the specified header, but its value does not match any of the specified values.
  
Key information:

- Header name:
  - Header name comparisons are case-insensitive.
  - Spaces in the header name should be replaced with "%20." You can also use this value to specify spaces in a header value.
- Header value:
  - A header value can take advantage of [wildcard values](cdn-verizon-premium-rules-engine-reference.md#wildcard-values).
  - Use the **Ignore Case** option to control the case-sensitivity of header value comparisons.
  - This match condition is met when a header value exactly matches to at least one of the specified patterns.
  - Specify multiple values by delimiting each one with a single space.
- Due to the manner in which cache settings are tracked, this match condition is incompatible with the following features:
  - Complete Cache Fill
  - Default Internal Max-Age
  - Force Internal Max-Age
  - Ignore Origin No-Cache
  - Internal Max-Stale

[Back to top](#reference-for-rules-engine-match-conditions)

</br>

---

### Request Method

The Request Method match condition is met only when assets are requested through the selected request method. The available request methods are:

- GET
- HEAD
- POST
- OPTIONS
- PUT
- DELETE
- TRACE
- CONNECT

Key information:

- By default, only the GET request method can generate cached content on the network. All other request methods are proxied through the network.
- Due to the manner in which cache settings are tracked, this match condition is incompatible with the following features:
  - Complete Cache Fill
  - Default Internal Max-Age
  - Force Internal Max-Age
  - Ignore Origin No-Cache
  - Internal Max-Stale

[Back to top](#reference-for-rules-engine-match-conditions)

</br>

---

### Request Scheme

The Request Scheme match condition is met only when assets are requested through the selected protocol. The available protocols are:

- HTTP
- HTTPS

Key information:

- Due to the manner in which cache settings are tracked, this match condition is incompatible with the following features:
  - Complete Cache Fill
  - Default Internal Max-Age
  - Force Internal Max-Age
  - Ignore Origin No-Cache
  - Internal Max-Stale

[Back to top](#reference-for-rules-engine-match-conditions)

</br>

---

### URL Path Directory

Identifies a request by its relative path, which excludes the file name of the requested asset.

The **Matches**/**Does Not Match** option determines the conditions under which the URL Path Directory match condition is met.

- **Matches**: Requires the request to contain a relative URL path, excluding the file name, that matches the specified URL pattern.
- **Does Not Match**: Requires the request to contain a relative URL path, excluding file name, that does not match the specified URL pattern.

Key information:

- Use the **Relative to** option to specify whether the URL comparison starts before or after the content access point. The content access point is the portion of the path that appears between the Verizon CDN hostname and the relative path to the requested asset (for example, /800001/CustomerOrigin). It identifies a location by server type (for example, CDN or customer origin) and your customer account number.

   The following values are available for the **Relative to** option:
  - **Root**: Indicates that the URL comparison point begins directly after the CDN hostname. 

  For example: http:\//wpc.0001.&lt;domain&gt;/**800001/myorigin/myfolder**/index.htm

  - **Origin**: Indicates that the URL comparison point begins after the content access point (for example, /000001 or /800001/myorigin). Because the \*.azureedge.net CNAME is created relative to the origin directory on the Verizon CDN hostname by default, Azure CDN users should use the **Origin** value. 

  For example: https:\//&lt;endpoint&gt;.azureedge.net/**myfolder**/index.htm 

  This URL points to the following Verizon CDN hostname: http:\//wpc.0001.&lt;domain&gt;/800001/myorigin/**myfolder**/index.htm

- An edge CNAME URL is rewritten to a CDN URL prior to the URL comparison.

    For example, both of the following URLs point to the same asset and therefore have the same URL path.
  - CDN URL: http:\//wpc.0001.&lt;domain&gt;/800001/CustomerOrigin/path/asset.htm
    
  - Edge CNAME URL: http:\//&lt;endpoint&gt;.azureedge.net/path/asset.htm
    
    Additional information:
  - Custom domain: https:\//my.domain.com/path/asset.htm
    
    - URL path (relative to root): /800001/CustomerOrigin/path/
    
    - URL path (relative to origin): /path/

- The portion of the URL that is used for the URL comparison ends just before the file name of the requested asset. A trailing forward slash is the last character in this type of path.

- Replace any spaces in the URL path pattern with "%20."

- Each URL path pattern can contain one or more asterisks (*), where each asterisk matches a sequence of one or more characters.

- Specify multiple URL paths in the pattern by delimiting each one with a single space.

    For example: */sales/ */marketing/

- A URL path specification can take advantage of [wildcard values](cdn-verizon-premium-rules-engine-reference.md#wildcard-values).

- Use the **Ignore Case** option to control whether a case-sensitive comparison is performed.

[Back to top](#reference-for-rules-engine-match-conditions)

</br>

---

### URL Path Extension

Identifies requests by the file extension of the requested asset.

The **Matches**/**Does Not Match** option determines the conditions under which the URL Path Extension match condition is met.

- **Matches**: Requires the URL of the request to contain a file extension that exactly matches the specified pattern.

   For example, if you specify "htm", "htm" assets are matched, but not "html" assets.  

- **Does Not Match**: Requires the URL request to contain a file extension that does not match the specified pattern.

Key information:

- Specify the file extensions to match in the **Value** box. Do not include a leading period; for example, use htm instead of .htm.

- Use the **Ignore Case** option to control whether a case-sensitive comparison is performed.

- Specify multiple file extensions by delimiting each extension with a single space. 

    For example: htm html

- For example, specifying "htm" matches "htm" assets, but not "html" assets.

#### Sample Scenario

The following sample configuration assumes that this match condition is met when a request matches one of the specified extensions.

Value specification: asp aspx php html

This match condition is met when it finds URLs that end with the following extensions:

- .asp
- .aspx
- .php
- .html

[Back to top](#reference-for-rules-engine-match-conditions)

</br>

---

### URL Path Filename

Identifies requests by the file name of the requested asset. For the purposes of this match condition, a file name consists of the name of the requested asset, a period, and the file extension (for example, index.html).

The **Matches**/**Does Not Match** option determines the conditions under which the URL Path Filename match condition is met.

- **Matches**: Requires the request to contain a file name in its URL path that matches the specified pattern.
- **Does Not Match**: Requires the request to contain a file name in its URL path that does not match the specified pattern.

Key information:

- Use the **Ignore Case** option to control whether a case-sensitive comparison is performed.

- To specify multiple file extensions, separate each extension with a single space.

    For example: index.htm index.html

- Replace spaces in a file name value with "%20."

- A file name value can take advantage of [wildcard values](cdn-verizon-premium-rules-engine-reference.md#wildcard-values). For example, each file name pattern can consist of one or more asterisks (*), where each asterisk matches a sequence of one or more characters.

- If wildcard characters are not specified, then only an exact match will satisfy this match condition.

    For example, specifying "presentation.ppt" matches an asset named "presentation.ppt," but not one named "presentation.pptx."

[Back to top](#reference-for-rules-engine-match-conditions)

</br>

---

### URL Path Literal

Compares a request's URL path, including file name, to the specified value.

The **Matches**/**Does Not Match** option determines the conditions under which the URL Path Literal match condition is met.

- **Matches**: Requires the request to contain a URL path that matches the specified pattern.
- **Does Not Match**: Requires the request to contain a URL path that does not match the specified pattern.

Key information:

- Use the **Relative to** option to specify whether the URL comparison point begins before or after the content access point. 

    The following values are available for the **Relative to** option:
  - **Root**: Indicates that the URL comparison point begins directly after the CDN hostname.

    For example: http:\//wpc.0001.&lt;domain&gt;/**800001/myorigin/myfolder/index.htm**

  - **Origin**: Indicates that the URL comparison point begins after the content access point (for example, /000001 or /800001/myorigin). Because the \*.azureedge.net CNAME is created relative to the origin directory on the Verizon CDN hostname by default, Azure CDN users should use the **Origin** value. 

    For example: https:\//&lt;endpoint&gt;.azureedge.net/**myfolder/index.htm**

  This URL points to the following Verizon CDN hostname: http:\//wpc.0001.&lt;domain&gt;/800001/myorigin/**myfolder/index.htm**

- An edge CNAME URL is rewritten to a CDN URL prior to a URL comparison.

For example, both of the following URLs point to the same asset and therefore have the same URL path:

- CDN URL: http:\//wpc.0001.&lt;domain&gt;/800001/CustomerOrigin/path/asset.htm
- Edge CNAME URL: http:\//&lt;endpoint&gt;.azureedge.net/path/asset.htm

    Additional information:
    
    - URL path (relative to root): /800001/CustomerOrigin/path/asset.htm
   
    - URL path (relative to origin): /path/asset.htm

- Query strings in the URL are ignored.
- Use the **Ignore Case** option to control whether a case-sensitive comparison is performed.
- The value specified for this match condition is compared against the relative path of the exact request made by the client.

- To match all requests made to a particular directory, use the [URL Path Directory](#url-path-directory) or the [URL Path Wildcard](#url-path-wildcard) match condition.

[Back to top](#reference-for-rules-engine-match-conditions)

</br>

---

### URL Path Regex

Compares a request's URL path to the specified [regular expression](cdn-verizon-premium-rules-engine-reference.md#regular-expressions).

The **Matches**/**Does Not Match** option determines the conditions under which the URL Path Regex match condition is met.

- **Matches**: Requires the request to contain a URL path that matches the specified regular expression.
- **Does Not Match**: Requires the request to contain a URL path that does not match the specified regular expression.

Key information:

- An edge CNAME URL is rewritten to a CDN URL prior to URL comparison.

    For example, both URLs point to the same asset and therefore have the same URL path.

     - CDN URL: http:\//wpc.0001.&lt;domain&gt;/800001/CustomerOrigin/path/asset.htm

     - Edge CNAME URL: http:\//my.domain.com/path/asset.htm

    Additional information:
    
     - URL path: /800001/CustomerOrigin/path/asset.htm

- Query strings in the URL are ignored.
    
- Use the **Ignore Case** option to control whether a case-sensitive comparison is performed.
    
- Spaces in the URL path should be replaced with "%20."

[Back to top](#reference-for-rules-engine-match-conditions)

</br>

---

### URL Path Wildcard

Compares a request's relative URL path to the specified wildcard pattern.

The **Matches**/**Does Not Match** option determines the conditions under which the URL Path Wildcard match condition is met.

- **Matches**: Requires the request to contain a URL path that matches the specified wildcard pattern.
- **Does Not Match**: Requires the request to contain a URL path that does not match the specified wildcard pattern.

Key information:

- **Relative to** option: This option determines whether the URL comparison point begins before or after the content access point.

   This option can have the following values:
     - **Root**: Indicates that the URL comparison point begins directly after the CDN hostname.

       For example: http:\//wpc.0001.&lt;domain&gt;/**800001/myorigin/myfolder/index.htm**

     - **Origin**: Indicates that the URL comparison point begins after the content access point (for example, /000001 or /800001/myorigin). Because the \*.azureedge.net CNAME is created relative to the origin directory on the Verizon CDN hostname by default, Azure CDN users should use the **Origin** value. 

       For example: https:\//&lt;endpoint&gt;.azureedge.net/**myfolder/index.htm**

     This URL points to the following Verizon CDN hostname: http:\//wpc.0001.&lt;domain&gt;/800001/myorigin/**myfolder/index.htm**

- An edge CNAME URL is rewritten to a CDN URL prior to URL comparison.

    For example, both of the following URLs point to the same asset and therefore have the same URL path:
     - CDN URL: http://wpc.0001.&lt;domain&gt;/800001/CustomerOrigin/path/asset.htm
     - Edge CNAME URL: http:\//&lt;endpoint&gt;.azureedge.net/path/asset.htm
    
    Additional information:
    
     - URL path (relative to root): /800001/CustomerOrigin/path/asset.htm
    
     - URL path (relative to origin): /path/asset.htm
    
- Specify multiple URL paths by delimiting each one with a single space.

   For example: /marketing/asset.* /sales/*.htm

- Query strings in the URL are ignored.
    
- Use the **Ignore Case** option to control whether a case-sensitive comparison is performed.
    
- Replace spaces in the URL path with "%20."
    
- The value specified for a URL path can take advantage of [wildcard values](cdn-verizon-premium-rules-engine-reference.md#wildcard-values). Each URL path pattern can contain one or more asterisks (*), where each asterisk can match a sequence of one or more characters.

#### Sample Scenarios

The sample configurations in the following table assume that this match condition is met when a request matches the specified URL pattern:

Value                   | Relative to    | Result 
------------------------|----------------|-------
*/test.html */test.php  | Root or Origin | This pattern is matched by requests for assets named "test.html" or "test.php" in any folder.
/80ABCD/origin/text/*   | Root           | This pattern is matched when the requested asset meets the following criteria: <br />- It must reside on a customer origin called "origin." <br />- The relative path must start with a folder called "text." That is, the requested asset can either reside in the "text" folder or one of its recursive subfolders.
*/css/* */js/*          | Root or Origin | This pattern is matched by all CDN or edge CNAME URLs that contain a css or js folder.
*.jpg *.gif *.png       | Root or Origin | This pattern is matched by all CDN or edge CNAME URLs ending with .jpg, .gif, or .png. An alternative way to specify this pattern is with the [URL Path Extension match condition](#url-path-extension).
/images/* /media/*      | Origin         | This pattern is matched by CDN or edge CNAME URLs whose relative path starts with an "images" or "media" folder. <br />- CDN URL: http:\//wpc.0001.&lt;domain&gt;/800001/myorigin/images/sales/event1.png<br />- Sample edge CNAME URL: http:\//cdn.mydomain.com/images/sales/event1.png

[Back to top](#reference-for-rules-engine-match-conditions)

</br>

---

### URL Query Literal

Compares a request's query string to the specified value.

The **Matches**/**Does Not Match** option determines the conditions under which the URL Query Literal match condition is met.

- **Matches**: Requires the request to contain a URL query string that matches the specified query string.
- **Does Not Match**: Requires the request to contain a URL query string that does not match the specified query string.

Key information:

- Only exact query string matches satisfy this match condition.
    
- Use the **Ignore Case** option to control the case-sensitivity of query string comparisons.
    
- Do not include a leading question mark (?) in the query string value text.
    
- Certain characters require URL encoding. Use the percentage symbol to URL encode the following characters:

   Character | URL Encoding
   ----------|---------
   Space     | %20
   &         | %25

- Due to the manner in which cache settings are tracked, this match condition is incompatible with the following features:
   - Complete Cache Fill
   - Default Internal Max-Age
   - Force Internal Max-Age
   - Ignore Origin No-Cache
   - Internal Max-Stale

[Back to top](#reference-for-rules-engine-match-conditions)

</br>

---

### URL Query Parameter

Identifies requests that contain the specified query string parameter. This parameter is set to a value that matches a specified pattern. Query string parameters (for example, parameter=value) in the request URL determine whether this condition is met. This match condition identifies a query string parameter by its name and accepts one or more values for the parameter value. 

The **Matches**/**Does Not Match** option determines the conditions under which the URL Query Parameter match condition is met.

- **Matches**: Requires a request to contain the specified parameter with a value that matches at least one of the values that are defined in this match condition.
- **Does Not Match**: Requires that the request meets either of the following criteria:
  - It does not contain the specified parameter.
  - It contains the specified parameter, but its value does not match any of the values that are defined in this match condition.

This match condition provides an easy way to specify parameter name/value combinations. For more flexibility if you are matching a query string parameter, consider using the [URL Query Wildcard](#url-query-wildcard) match condition.

Key information:

- Only a single URL query parameter name can be specified per instance of this match condition.
    
- Because wildcard values are not supported when a parameter name is specified, only exact parameter name matches are eligible for comparison.
- Parameter value(s) can include [wildcard values](cdn-verizon-premium-rules-engine-reference.md#wildcard-values).
   - Each parameter value pattern can consist of one or more asterisks (*), where each asterisk can match a sequence of one or more characters.
   - Certain characters require URL encoding. Use the percentage symbol to URL encode the following characters:

       Character | URL Encoding
       ----------|---------
       Space     | %20
       &         | %25

- Specify multiple query string parameter values by delimiting each one with a single space. This match condition is met when a request contains one of the specified name/value combinations.

   - Example 1:

     - Configuration:

       ValueA ValueB

     - This configuration matches the following query string parameters:

       Parameter1=ValueA
    
       Parameter1=ValueB

   - Example 2:

     - Configuration: 

        Value%20A Value%20B

     - This configuration matches the following query string parameters:

       Parameter1=Value%20A

       Parameter1=Value%20B

- This match condition is met only when there is an exact match to at least one of the specified query string name/value combinations.

   For example, if you use the configuration in the previous example, the parameter name/value combination "Parameter1=ValueAdd" would not be considered a match. However, if you specify either of the following values, it will match that name/value combination:

   - ValueA ValueB ValueAdd
   - ValueA* ValueB

- Use the **Ignore Case** option to control the case-sensitivity of query string comparisons.
    
- Due to the manner in which cache settings are tracked, this match condition is incompatible with the following features:
   - Complete Cache Fill
   - Default Internal Max-Age
   - Force Internal Max-Age
   - Ignore Origin No-Cache
   - Internal Max-Stale

#### Sample scenarios

The following example demonstrates how this option works in specific situations:

Name  | Value |  Result
------|-------|--------
User  | Joe   | This pattern is matched when the query string for a requested URL is "?user=joe."
User  | *     | This pattern is matched when the query string for a requested URL contains a User parameter.
Email | Joe\* | This pattern is matched when the query string for a requested URL contains an Email parameter that starts with "Joe."

[Back to top](#reference-for-rules-engine-match-conditions)

</br>

---

### URL Query Regex

Identifies requests that contain the specified query string parameter. This parameter is set to a value that matches a specified [regular expression](cdn-verizon-premium-rules-engine-reference.md#regular-expressions).

The **Matches**/**Does Not Match** option determines the conditions under which the URL Query Regex match condition is met.

- **Matches**: Requires the request to contain a URL query string that matches the specified regular expression.
- **Does Not Match**: Requires the request to contain a URL query string that does not match the specified regular expression.

Key information:

- Only exact matches to the specified regular expression satisfy this match condition.
    
- Use the **Ignore Case** option to control the case-sensitivity of query string comparisons.
    
- For the purposes of this option, a query string starts with the first character after the question mark (?) delimiter for the query string.
    
- Certain characters require URL encoding. Use the percentage symbol to URL encode the following characters:

   Character | URL Encoding | Value
   ----------|--------------|------
   Space     | %20          | \%20
   &         | %25          | \%25

   Note that percentage symbols must be escaped.

- Double-escape special regular expression characters (for example, \^$.+) to include a backslash in the regular expression.

   For example:

   Value | Interpreted As 
   ------|---------------
   \\+    | +
   \\\\+   | \\+

- Due to the manner in which cache settings are tracked, this match condition is incompatible with the following features:
   - Complete Cache Fill
   - Default Internal Max-Age
   - Force Internal Max-Age
   - Ignore Origin No-Cache
   - Internal Max-Stale

[Back to top](#reference-for-rules-engine-match-conditions)

</br>

---

### URL Query Wildcard

Compares the specified value(s) against the request's query string.

The **Matches**/**Does Not Match** option determines the conditions under which the URL Query Wildcard match condition is met.

- **Matches**: Requires the request to contain a URL query string that matches the specified wildcard value.
- **Does Not Match**: Requires the request to contain a URL query string that does not match the specified wildcard value.

Key information:

- For the purposes of this option, a query string starts with the first character after the question mark (?) delimiter for the query string.
- Parameter values can include [wildcard values](cdn-verizon-premium-rules-engine-reference.md#wildcard-values):
   - Each parameter value pattern can consist of one or more asterisks (*), where each asterisk can match a sequence of one or more characters.
   - Certain characters require URL encoding. Use the percentage symbol to URL encode the following characters:

     Character | URL Encoding
     ----------|---------
     Space     | %20
     &         | %25

- Specify multiple values by delimiting each one with a single space.

   For example: *Parameter1=ValueA* *ValueB* *Parameter1=ValueC&Parameter2=ValueD*

- Only exact matches to at least one of the specified query string patterns satisfy this match condition.
    
- Use the **Ignore Case** option to control the case-sensitivity of query string comparisons.
    
- Due to the manner in which cache settings are tracked, this match condition is incompatible with the following features:
   - Complete Cache Fill
   - Default Internal Max-Age
   - Force Internal Max-Age
   - Ignore Origin No-Cache
   - Internal Max-Stale

#### Sample scenarios

The following example demonstrates how this option works in specific situations:

 Name                 | Description
 ---------------------|------------
user=joe              | This pattern is matched when the query string for a requested URL is "?user=joe."
\*user=\* \*optout=\* | This pattern is matched when the CDN URL query contains either the user or optout parameter.

[Back to top](#reference-for-rules-engine-match-conditions)

</br>

## Next steps

- [Azure Content Delivery Network overview](cdn-overview.md)
- [Rules engine reference](cdn-verizon-premium-rules-engine-reference.md)
- [Rules engine conditional expressions](cdn-verizon-premium-rules-engine-reference-conditional-expressions.md)
- [Rules engine features](cdn-verizon-premium-rules-engine-reference-features.md)
- [Overriding default HTTP behavior using the rules engine](cdn-verizon-premium-rules-engine.md)\`25
title: Azure CDN from Verizon Premium rules engine match conditions | Microsoft Docs
description: Reference documentation for Azure Content Delivery Network from Verizon Premium rules engine match conditions.
services: cdn
author: mdgattuso

ms.service: azure-cdn
ms.topic: article
ms.date: 05/31/2019
ms.author: magattus

---

# Azure CDN from Verizon Premium rules engine match conditions

This article lists detailed descriptions of the available match conditions for the Azure Content Delivery Network (CDN) from Verizon Premium [rules engine](cdn-verizon-premium-rules-engine.md).

The second part of a rule is the match condition. A match condition identifies specific types of requests for which a set of features will be performed.

For example, you can use a match condition to:

- Filter requests for content at a particular location.
- Filter requests generated from a particular IP address or country/region.
- Filter requests by header information.

## Always match condition

The Always match condition applies a default set of features to all requests.

Name | Purpose
-----|--------
[Always](#always) | Applies a default set of features to all requests.

## Device match condition

The Device match condition identifies requests made from a mobile device based on its properties.  

Name | Purpose
-----|--------
[Device](#device) | Identifies requests made from a mobile device based on its properties.

## Location match conditions

The Location match conditions identify requests based on the requester's location.

Name | Purpose
-----|--------
[AS Number](#as-number) | Identifies requests that originate from a particular network.
[Country](#country) | Identifies requests that originate from the specified countries/regions.

## Origin match conditions

The Origin match conditions identify requests that point to Content Delivery Network storage or a customer origin server.

Name | Purpose
-----|--------
[CDN Origin](#cdn-origin) | Identifies requests for content stored in Content Delivery Network storage.
[Customer Origin](#customer-origin) | Identifies requests for content stored on a specific customer origin server.

## Request match conditions

The Request match conditions identify requests based on their properties.

Name | Purpose
-----|--------
[Client IP Address](#client-ip-address) | Identifies requests that originate from a particular IP address.
[Cookie Parameter](#cookie-parameter) | Checks the cookies associated with each request for the specified value.
[Cookie Parameter Regex](#cookie-parameter-regex) | Checks the cookies associated with each request for the specified regular expression.
[Edge Cname](#edge-cname) | Identifies requests that point to a specific edge CNAME.
[Referring Domain](#referring-domain) | Identifies requests that were referred from the specified host names.
[Request Header Literal](#request-header-literal) | Identifies requests that contain the specified header set to a specified value.
[Request Header Regex](#request-header-regex) | Identifies requests that contain the specified header set to a value that matches the specified regular expression.
[Request Header Wildcard](#request-header-wildcard) | Identifies requests that contain the specified header set to a value that matches the specified pattern.
[Request Method](#request-method) | Identifies requests by their HTTP method.
[Request Scheme](#request-scheme) | Identifies requests by their HTTP protocol.

## URL match conditions

The URL match conditions identify requests based on their URLs.

Name | Purpose
-----|--------
[URL Path Directory](#url-path-directory) | Identifies requests by their relative path.
[URL Path Extension](#url-path-extension) | Identifies requests by their file name extension.
[URL Path Filename](#url-path-filename) | Identifies requests by their file name.
[URL Path Literal](#url-path-literal) | Compares a request's relative path to the specified value.
[URL Path Regex](#url-path-regex) | Compares a request's relative path to the specified regular expression.
[URL Path Wildcard](#url-path-wildcard) | Compares a request's relative path to the specified pattern.
[URL Query Literal](#url-query-literal) | Compares a request's query string to the specified value.
[URL Query Parameter](#url-query-parameter) | Identifies requests that contain the specified query string parameter set to a value that matches a specified pattern.
[URL Query Regex](#url-query-regex) | Identifies requests that contain the specified query string parameter set to a value that matches a specified regular expression.
[URL Query Wildcard](#url-query-wildcard) | Compares the specified value against the request's query string.

## Reference for rules engine match conditions

---

### Always

The Always match condition applies a default set of features to all requests.

[Back to top](#reference-for-rules-engine-match-conditions)

</br>

---

### AS Number

The AS Number network is defined by its autonomous system number (ASN). 

The **Matches**/**Does Not Match** option determines the conditions under which the AS Number match condition is met:

- **Matches**: Requires that the ASN of the client network matches one of the specified ASNs. 
- **Does Not Match**: Requires that the ASN of the client network does not match any of the specified ASNs.

Key information:

- Specify multiple ASNs by delimiting each one with a single space. For example, 64514 64515 matches requests that arrive from either 64514 or 64515.
- Certain requests might not return a valid ASN. A question mark (?) will match requests for which a valid ASN could not be determined.
- Specify the entire ASN for the desired network. Partial values will not be matched.
- Due to the manner in which cache settings are tracked, this match condition is incompatible with the following features:
  - Complete Cache Fill
  - Default Internal Max-Age
  - Force Internal Max-Age
  - Ignore Origin No-Cache
  - Internal Max-Stale

[Back to top](#reference-for-rules-engine-match-conditions)

</br>

---

### CDN Origin

The CDN Origin match condition is met when both of the following conditions are met:

- Content from CDN storage was requested.
- The request URI uses the type of content access point (for example, /000001) that's defined in this match condition:
  - CDN URL: The request URI must contain the selected content access point.
  - Edge CNAME URL: The corresponding edge CNAME configuration must point to the selected content access point.
  
Key information:

- The content access point identifies the service that should serve the requested content.
- Don't use an AND IF statement to combine certain match conditions. For example, combining a CDN Origin match condition with a Customer Origin match condition would create a match pattern that could never be matched. For this reason, two CDN Origin match conditions cannot be combined through an AND IF statement.

[Back to top](#reference-for-rules-engine-match-conditions)

</br>

---

### Client IP Address

The **Matches**/**Does Not Match** option determines the conditions under which the Client IP Address match condition is met:

- **Matches**: Requires that the client's IP address matches one of the specified IP addresses. 
- **Does Not Match**: Requires that the client's IP address does not match any of the specified IP addresses. 

Key information:

- Use CIDR notation.
- Specify multiple IP addresses and/or IP address blocks by delimiting each one with a single space. For example:
  - **IPv4 example**: 1.2.3.4 10.20.30.40 matches any requests that arrive from either address 1.2.3.4 or 10.20.30.40.
  - **IPv6 example**: 1:2:3:4:5:6:7:8 10:20:30:40:50:60:70:80 matches any requests that arrive from either address 1:2:3:4:5:6:7:8 or 10:20:30:40:50:60:70:80.
- The syntax for an IP address block is the base IP address followed by a forward slash and the prefix size. For example:
  - **IPv4 example**: 5.5.5.64/26 matches any requests that arrive from addresses 5.5.5.64 through 5.5.5.127.
  - **IPv6 example**: 1:2:3:/48 matches any requests that arrive from addresses 1:2:3:0:0:0:0:0 through 1:2:3:ffff:ffff:ffff:ffff:ffff.
- Due to the manner in which cache settings are tracked, this match condition is incompatible with the following features:
  - Complete Cache Fill
  - Default Internal Max-Age
  - Force Internal Max-Age
  - Ignore Origin No-Cache
  - Internal Max-Stale

[Back to top](#reference-for-rules-engine-match-conditions)

</br>

---

### Cookie Parameter

The **Matches**/**Does Not Match** option determines the conditions under which the Cookie Parameter match condition is met.

- **Matches**: Requires a request to contain the specified cookie with a value that matches at least one of the values that are defined in this match condition.
- **Does Not Match**: Requires that the request meets either of the following criteria:
  - It does not contain the specified cookie.
  - It contains the specified cookie, but its value does not match any of the values that are defined in this match condition.
  
Key information:

- Cookie name:
  - Because wildcard values, including asterisks (*), are not supported when you're specifying a cookie name, only exact cookie name matches are eligible for comparison.
  - Only a single cookie name can be specified per instance of this match condition.
  - Cookie name comparisons are case-insensitive.
- Cookie value:
  - Specify multiple cookie values by delimiting each one with a single space.
  - A cookie value can take advantage of [wildcard values](cdn-verizon-premium-rules-engine-reference.md#wildcard-values).
  - If a wildcard value has not been specified, then only an exact match will satisfy this match condition. For example, specifying "Value" will match "Value," but not "Value1" or "Value2."
  - Use the **Ignore Case** option to control whether a case-sensitive comparison is made against the request's cookie value.
- Due to the manner in which cache settings are tracked, this match condition is incompatible with the following features:
  - Complete Cache Fill
  - Default Internal Max-Age
  - Force Internal Max-Age
  - Ignore Origin No-Cache
  - Internal Max-Stale

[Back to top](#reference-for-rules-engine-match-conditions)
</br>

---

### Cookie Parameter Regex

The Cookie Parameter Regex match condition defines a cookie name and value. You can use [regular expressions](cdn-verizon-premium-rules-engine-reference.md#regular-expressions) to define the desired cookie value.

The **Matches**/**Does Not Match** option determines the conditions under which the Cookie Parameter Regex match condition is met.

- **Matches**: Requires a request to contain the specified cookie with a value that matches the specified regular expression.
- **Does Not Match**: Requires that the request meets either of the following criteria:
  - It does not contain the specified cookie.
  - It contains the specified cookie, but its value does not match the specified regular expression.
  
Key information:

- Cookie name:
  - Because regular expressions and wildcard values, including asterisks (*), are not supported when you're specifying a cookie name, only exact cookie name matches are eligible for comparison.
  - Only a single cookie name can be specified per instance of this match condition.
  - Cookie name comparisons are case-insensitive.
- Cookie value:
  - A cookie value can take advantage of regular expressions.
  - Use the **Ignore Case** option to control whether a case-sensitive comparison is made against the request's cookie value.
- Due to the manner in which cache settings are tracked, this match condition is incompatible with the following features:
  - Complete Cache Fill
  - Default Internal Max-Age
  - Force Internal Max-Age
  - Ignore Origin No-Cache
  - Internal Max-Stale

[Back to top](#reference-for-rules-engine-match-conditions)

</br>

---

### Country

You can specify a country through its country code. 

The **Matches**/**Does Not Match** option determines the conditions under which the Country match condition is met:

- **Matches**: Requires the request to contain the specified country code values. 
- **Does Not Match**: Requires that the request does not contain the specified country code values.

Key information:

- Specify multiple country codes by delimiting each one with a single space.
- Wildcards are not supported when you're specifying a country code.
- The "EU" and "AP" country codes do not encompass all IP addresses in those regions.
- Certain requests might not return a valid country code. A question mark (?) will match requests for which a valid country code could not be determined.
- Country codes are case-sensitive.
- Due to the manner in which cache settings are tracked, this match condition is incompatible with the following features:
  - Complete Cache Fill
  - Default Internal Max-Age
  - Force Internal Max-Age
  - Ignore Origin No-Cache
  - Internal Max-Stale

#### Implementing Country Filtering by using the rules engine

This match condition allows you to perform a multitude of customizations based on the location from which a request originated. For example, the behavior of the Country Filtering feature can be replicated through the following configuration:

- URL Path Wildcard match: Set the [URL Path Wildcard match condition](#url-path-wildcard) to the directory that will be secured. 
    Append an asterisk to the end of the relative path to ensure that access to all of its children will be restricted by this rule.

- Country match: Set the Country match condition to the desired set of countries.
  - Allow: Set the Country match condition to **Does Not Match** to allow only the specified countries access to content stored in the location defined by the URL Path Wildcard match condition.
  - Block: Set the Country match condition to **Matches** to block the specified countries from accessing content stored in the location defined by the URL Path Wildcard match condition.

- Deny Access (403) Feature: Enable the [Deny Access (403) feature](cdn-verizon-premium-rules-engine-reference-features.md#deny-access-403) to replicate the allow or block portion of the Country Filtering feature.

[Back to top](#reference-for-rules-engine-match-conditions)

</br>

---

### Customer Origin

Key information:

- The Customer Origin match condition is met regardless of whether content is requested through a CDN URL or an edge CNAME URL that points to the selected customer origin.
- A customer origin configuration that's referenced by a rule cannot be deleted from the Customer Origin page. Before you attempt to delete a customer origin configuration, make sure that the following configurations do not reference it:
  - A Customer Origin match condition
  - An edge CNAME configuration
- Don't use an AND IF statement to combine certain match conditions. For example, combining a Customer Origin match condition with a CDN Origin match condition would create a match pattern that could never be matched. For this reason, two Customer Origin match conditions cannot be combined through an AND IF statement.

[Back to top](#reference-for-rules-engine-match-conditions)

</br>

---

### Device

The Device match condition identifies requests made from a mobile device based on its properties. Mobile device detection is achieved through [WURFL](http://wurfl.sourceforge.net/). 

The **Matches**/**Does Not Match** option determines the conditions under which the Device match condition is met:

- **Matches**: Requires the requester's device to match the specified value. 
- **Does Not Match**: Requires that the requester's device does not match the specified value.

Key information:

- Use the **Ignore Case** option to specify whether the specified value is case-sensitive.
- Due to the manner in which cache settings are tracked, this match condition is incompatible with the following features:
  - Complete Cache Fill
  - Default Internal Max-Age
  - Force Internal Max-Age
  - Ignore Origin No-Cache
  - Internal Max-Stale

#### String Type

A WURFL capability typically accepts any combination of numbers, letters, and symbols. Due to the flexible nature of this capability, you must choose how the value associated with this match condition is interpreted. The following table describes the available set of options:

Type     | Description
---------|------------
Literal  | Select this option to prevent most characters from taking on special meaning by using their [literal value](cdn-verizon-premium-rules-engine-reference.md#literal-values).
Wildcard | Select this option to take advantage of all [wildcard characters]([wildcard values](cdn-verizon-premium-rules-engine-reference.md#wildcard-values).
Regex    | Select this option to use [regular expressions](cdn-verizon-premium-rules-engine-reference.md#regular-expressions). Regular expressions are useful for defining a pattern of characters.

#### WURFL capabilities

A WURFL capability refers to a category that describes mobile devices. The selected capability determines the type of mobile device description that is used to identify requests.

The following table lists WURFL capabilities and their variables for the rules engine.

> [!NOTE]
> The following variables are supported in the **Modify Client Request Header** and **Modify Client Response Header** features.

Capability | Variable | Description | Sample values
-----------|----------|-------------|----------------
Brand Name | %{wurfl_cap_brand_name} | A string that indicates the brand name of the device. | Samsung
Device OS | %{wurfl_cap_device_os} | A string that indicates the operating system installed on the device. | IOS
Device OS Version | %{wurfl_cap_device_os_version} | A string that indicates the version number of the operating system installed on the device. | 1.0.1
Dual Orientation | %{wurfl_cap_dual_orientation} | A Boolean that indicates whether the device supports dual orientation. | true
HTML Preferred DTD | %{wurfl_cap_html_preferred_dtd} | A string that indicates the mobile device's preferred document type definition (DTD) for HTML content. | none<br/>xhtml_basic<br/>html5
Image Inlining | %{wurfl_cap_image_inlining} | A Boolean that indicates whether the device supports Base64 encoded images. | false
Is Android | %{wurfl_vcap_is_android} | A Boolean that indicates whether the device uses the Android OS. | true
Is IOS | %{wurfl_vcap_is_ios} | A Boolean that indicates whether the device uses iOS. | false
Is Smart TV | %{wurfl_cap_is_smarttv} | A Boolean that indicates whether the device is a smart TV. | false
Is Smartphone | %{wurfl_vcap_is_smartphone} | A Boolean that indicates whether the device is a smartphone. | true
Is Tablet | %{wurfl_cap_is_tablet} | A Boolean that indicates whether the device is a tablet. This description is  OS-independent. | true
Is Wireless Device | %{wurfl_cap_is_wireless_device} | A Boolean that indicates whether the device is considered a wireless device. | true
Marketing Name | %{wurfl_cap_marketing_name} | A string that indicates the device's marketing name. | BlackBerry 8100 Pearl
Mobile Browser | %{wurfl_cap_mobile_browser} | A string that indicates the browser that's used to request content from the device. | Chrome
Mobile Browser Version | %{wurfl_cap_mobile_browser_version} | A string that indicates the version of the browser that's used to request content from the device. | 31
Model Name | %{wurfl_cap_model_name} | A string that indicates the device's model name. | s3
Progressive Download | %{wurfl_cap_progressive_download} | A Boolean that indicates whether the device supports the playback of audio and video while it is still being downloaded. | true
Release Date | %{wurfl_cap_release_date} | A string that indicates the year and month on which the device was added to the WURFL database.<br/><br/>Format: `yyyy_mm` | 2013_december
Resolution Height | %{wurfl_cap_resolution_height} | An integer that indicates the device's height in pixels. | 768
Resolution Width | %{wurfl_cap_resolution_width} | An integer that indicates the device's width in pixels. | 1024

[Back to top](#reference-for-rules-engine-match-conditions)

</br>

---

### Edge Cname

Key information:

- The list of available edge CNAMEs is limited to those edge CNAMEs that have been configured on the Edge CNAMEs page for the platform on which the rules engine is being configured.
- Before you attempt to delete an edge CNAME configuration, make sure that an Edge Cname match condition does not reference it. Edge CNAME configurations that have been defined in a rule cannot be deleted from the Edge CNAMEs page.
- Don't use an AND IF statement to combine certain match conditions. For example, combining an Edge Cname match condition with a Customer Origin match condition would create a match pattern that could never be matched. For this reason, two Edge Cname match conditions cannot be combined through an AND IF statement.
- Due to the manner in which cache settings are tracked, this match condition is incompatible with the following features:
  - Complete Cache Fill
  - Default Internal Max-Age
  - Force Internal Max-Age
  - Ignore Origin No-Cache
  - Internal Max-Stale

[Back to top](#reference-for-rules-engine-match-conditions)

</br>

---

### Referring Domain

The host name associated with the referrer through which content was requested determines whether the Referring Domain condition is met.

The **Matches**/**Does Not Match** option determines the conditions under which the Referring Domain match condition is met:

- **Matches**: Requires the referring host name to match the specified values. 
- **Does Not Match**: Requires that the referring host name does not match the specified value.

Key information:

- Specify multiple host names by delimiting each one with a single space.
- This match condition supports [wildcard values](cdn-verizon-premium-rules-engine-reference.md#wildcard-values).
- If the specified value does not contain an asterisk, it must be an exact match for the referrer's host name. For example, specifying "mydomain.com" would not match "www.mydomain.com."
- Use the **Ignore Case** option to control whether a case-sensitive comparison is made.
- Due to the manner in which cache settings are tracked, this match condition is incompatible with the following features:
  - Complete Cache Fill
  - Default Internal Max-Age
  - Force Internal Max-Age
  - Ignore Origin No-Cache
  - Internal Max-Stale

[Back to top](#reference-for-rules-engine-match-conditions)

</br>

---  

### Request Header Literal

The **Matches**/**Does Not Match** option determines the conditions under which the Request Header Literal match condition is met.

- **Matches**: Requires the request to contain the specified header. Its value must match the one that's defined in this match condition.
- **Does Not Match**: Requires that the request meets either of the following criteria:
  - It does not contain the specified header.
  - It contains the specified header, but its value does not match the one that's defined in this match condition.
  
Key information:

- Header name comparisons are always case-insensitive. Use the **Ignore Case** option to control the case-sensitivity of header value comparisons.
- Due to the manner in which cache settings are tracked, this match condition is incompatible with the following features:
  - Complete Cache Fill
  - Default Internal Max-Age
  - Force Internal Max-Age
  - Ignore Origin No-Cache
  - Internal Max-Stale

[Back to top](#reference-for-rules-engine-match-conditions)

</br>

---  

### Request Header Regex

The **Matches**/**Does Not Match** option determines the conditions under which the Request Header Regex match condition is met.

- **Matches**: Requires the request to contain the specified header. Its value must match the pattern that's defined in the specified [regular expression](cdn-verizon-premium-rules-engine-reference.md#regular-expressions).
- **Does Not Match**: Requires that the request meets either of the following criteria:
  - It does not contain the specified header.
  - It contains the specified header, but its value does not match the specified regular expression.

Key information:

- Header name:
  - Header name comparisons are case-insensitive.
  - Replace spaces in the header name with "%20."
- Header value:
  - A header value can take advantage of regular expressions.
  - Use the **Ignore Case** option to control the case-sensitivity of header value comparisons.
  - The match condition is met only when a header value exactly matches at least one of the specified patterns.
- Due to the manner in which cache settings are tracked, this match condition is incompatible with the following features:
  - Complete Cache Fill
  - Default Internal Max-Age
  - Force Internal Max-Age
  - Ignore Origin No-Cache
  - Internal Max-Stale

[Back to top](#reference-for-rules-engine-match-conditions)

</br>

---

### Request Header Wildcard

The **Matches**/**Does Not Match** option determines the conditions under which the Request Header Wildcard match condition is met.

- **Matches**: Requires the request to contain the specified header. Its value must match at least one of the values that are defined in this match condition.
- **Does Not Match**: Requires that the request meets either of the following criteria:
  - It does not contain the specified header.
  - It contains the specified header, but its value does not match any of the specified values.
  
Key information:

- Header name:
  - Header name comparisons are case-insensitive.
  - Spaces in the header name should be replaced with "%20." You can also use this value to specify spaces in a header value.
- Header value:
  - A header value can take advantage of [wildcard values](cdn-verizon-premium-rules-engine-reference.md#wildcard-values).
  - Use the **Ignore Case** option to control the case-sensitivity of header value comparisons.
  - This match condition is met when a header value exactly matches to at least one of the specified patterns.
  - Specify multiple values by delimiting each one with a single space.
- Due to the manner in which cache settings are tracked, this match condition is incompatible with the following features:
  - Complete Cache Fill
  - Default Internal Max-Age
  - Force Internal Max-Age
  - Ignore Origin No-Cache
  - Internal Max-Stale

[Back to top](#reference-for-rules-engine-match-conditions)

</br>

---

### Request Method

The Request Method match condition is met only when assets are requested through the selected request method. The available request methods are:

- GET
- HEAD
- POST
- OPTIONS
- PUT
- DELETE
- TRACE
- CONNECT

Key information:

- By default, only the GET request method can generate cached content on the network. All other request methods are proxied through the network.
- Due to the manner in which cache settings are tracked, this match condition is incompatible with the following features:
  - Complete Cache Fill
  - Default Internal Max-Age
  - Force Internal Max-Age
  - Ignore Origin No-Cache
  - Internal Max-Stale

[Back to top](#reference-for-rules-engine-match-conditions)

</br>

---

### Request Scheme

The Request Scheme match condition is met only when assets are requested through the selected protocol. The available protocols are:

- HTTP
- HTTPS

Key information:

- Due to the manner in which cache settings are tracked, this match condition is incompatible with the following features:
  - Complete Cache Fill
  - Default Internal Max-Age
  - Force Internal Max-Age
  - Ignore Origin No-Cache
  - Internal Max-Stale

[Back to top](#reference-for-rules-engine-match-conditions)

</br>

---

### URL Path Directory

Identifies a request by its relative path, which excludes the file name of the requested asset.

The **Matches**/**Does Not Match** option determines the conditions under which the URL Path Directory match condition is met.

- **Matches**: Requires the request to contain a relative URL path, excluding the file name, that matches the specified URL pattern.
- **Does Not Match**: Requires the request to contain a relative URL path, excluding file name, that does not match the specified URL pattern.

Key information:

- Use the **Relative to** option to specify whether the URL comparison starts before or after the content access point. The content access point is the portion of the path that appears between the Verizon CDN hostname and the relative path to the requested asset (for example, /800001/CustomerOrigin). It identifies a location by server type (for example, CDN or customer origin) and your customer account number.

   The following values are available for the **Relative to** option:
  - **Root**: Indicates that the URL comparison point begins directly after the CDN hostname. 

  For example: http:\//wpc.0001.&lt;domain&gt;/**800001/myorigin/myfolder**/index.htm

  - **Origin**: Indicates that the URL comparison point begins after the content access point (for example, /000001 or /800001/myorigin). Because the \*.azureedge.net CNAME is created relative to the origin directory on the Verizon CDN hostname by default, Azure CDN users should use the **Origin** value. 

  For example: https:\//&lt;endpoint&gt;.azureedge.net/**myfolder**/index.htm 

  This URL points to the following Verizon CDN hostname: http:\//wpc.0001.&lt;domain&gt;/800001/myorigin/**myfolder**/index.htm

- An edge CNAME URL is rewritten to a CDN URL prior to the URL comparison.

    For example, both of the following URLs point to the same asset and therefore have the same URL path.
  - CDN URL: http:\//wpc.0001.&lt;domain&gt;/800001/CustomerOrigin/path/asset.htm
    
  - Edge CNAME URL: http:\//&lt;endpoint&gt;.azureedge.net/path/asset.htm
    
    Additional information:
  - Custom domain: https:\//my.domain.com/path/asset.htm
    
    - URL path (relative to root): /800001/CustomerOrigin/path/
    
    - URL path (relative to origin): /path/

- The portion of the URL that is used for the URL comparison ends just before the file name of the requested asset. A trailing forward slash is the last character in this type of path.

- Replace any spaces in the URL path pattern with "%20."

- Each URL path pattern can contain one or more asterisks (*), where each asterisk matches a sequence of one or more characters.

- Specify multiple URL paths in the pattern by delimiting each one with a single space.

    For example: */sales/ */marketing/

- A URL path specification can take advantage of [wildcard values](cdn-verizon-premium-rules-engine-reference.md#wildcard-values).

- Use the **Ignore Case** option to control whether a case-sensitive comparison is performed.

[Back to top](#reference-for-rules-engine-match-conditions)

</br>

---

### URL Path Extension

Identifies requests by the file extension of the requested asset.

The **Matches**/**Does Not Match** option determines the conditions under which the URL Path Extension match condition is met.

- **Matches**: Requires the URL of the request to contain a file extension that exactly matches the specified pattern.

   For example, if you specify "htm", "htm" assets are matched, but not "html" assets.  

- **Does Not Match**: Requires the URL request to contain a file extension that does not match the specified pattern.

Key information:

- Specify the file extensions to match in the **Value** box. Do not include a leading period; for example, use htm instead of .htm.

- Use the **Ignore Case** option to control whether a case-sensitive comparison is performed.

- Specify multiple file extensions by delimiting each extension with a single space. 

    For example: htm html

- For example, specifying "htm" matches "htm" assets, but not "html" assets.

#### Sample Scenario

The following sample configuration assumes that this match condition is met when a request matches one of the specified extensions.

Value specification: asp aspx php html

This match condition is met when it finds URLs that end with the following extensions:

- .asp
- .aspx
- .php
- .html

[Back to top](#reference-for-rules-engine-match-conditions)

</br>

---

### URL Path Filename

Identifies requests by the file name of the requested asset. For the purposes of this match condition, a file name consists of the name of the requested asset, a period, and the file extension (for example, index.html).

The **Matches**/**Does Not Match** option determines the conditions under which the URL Path Filename match condition is met.

- **Matches**: Requires the request to contain a file name in its URL path that matches the specified pattern.
- **Does Not Match**: Requires the request to contain a file name in its URL path that does not match the specified pattern.

Key information:

- Use the **Ignore Case** option to control whether a case-sensitive comparison is performed.

- To specify multiple file extensions, separate each extension with a single space.

    For example: index.htm index.html

- Replace spaces in a file name value with "%20."

- A file name value can take advantage of [wildcard values](cdn-verizon-premium-rules-engine-reference.md#wildcard-values). For example, each file name pattern can consist of one or more asterisks (*), where each asterisk matches a sequence of one or more characters.

- If wildcard characters are not specified, then only an exact match will satisfy this match condition.

    For example, specifying "presentation.ppt" matches an asset named "presentation.ppt," but not one named "presentation.pptx."

[Back to top](#reference-for-rules-engine-match-conditions)

</br>

---

### URL Path Literal

Compares a request's URL path, including file name, to the specified value.

The **Matches**/**Does Not Match** option determines the conditions under which the URL Path Literal match condition is met.

- **Matches**: Requires the request to contain a URL path that matches the specified pattern.
- **Does Not Match**: Requires the request to contain a URL path that does not match the specified pattern.

Key information:

- Use the **Relative to** option to specify whether the URL comparison point begins before or after the content access point. 

    The following values are available for the **Relative to** option:
  - **Root**: Indicates that the URL comparison point begins directly after the CDN hostname.

    For example: http:\//wpc.0001.&lt;domain&gt;/**800001/myorigin/myfolder/index.htm**

  - **Origin**: Indicates that the URL comparison point begins after the content access point (for example, /000001 or /800001/myorigin). Because the \*.azureedge.net CNAME is created relative to the origin directory on the Verizon CDN hostname by default, Azure CDN users should use the **Origin** value. 

    For example: https:\//&lt;endpoint&gt;.azureedge.net/**myfolder/index.htm**

  This URL points to the following Verizon CDN hostname: http:\//wpc.0001.&lt;domain&gt;/800001/myorigin/**myfolder/index.htm**

- An edge CNAME URL is rewritten to a CDN URL prior to a URL comparison.

For example, both of the following URLs point to the same asset and therefore have the same URL path:

- CDN URL: http:\//wpc.0001.&lt;domain&gt;/800001/CustomerOrigin/path/asset.htm
- Edge CNAME URL: http:\//&lt;endpoint&gt;.azureedge.net/path/asset.htm

    Additional information:
    
    - URL path (relative to root): /800001/CustomerOrigin/path/asset.htm
   
    - URL path (relative to origin): /path/asset.htm

- Query strings in the URL are ignored.
- Use the **Ignore Case** option to control whether a case-sensitive comparison is performed.
- The value specified for this match condition is compared against the relative path of the exact request made by the client.

- To match all requests made to a particular directory, use the [URL Path Directory](#url-path-directory) or the [URL Path Wildcard](#url-path-wildcard) match condition.

[Back to top](#reference-for-rules-engine-match-conditions)

</br>

---

### URL Path Regex

Compares a request's URL path to the specified [regular expression](cdn-verizon-premium-rules-engine-reference.md#regular-expressions).

The **Matches**/**Does Not Match** option determines the conditions under which the URL Path Regex match condition is met.

- **Matches**: Requires the request to contain a URL path that matches the specified regular expression.
- **Does Not Match**: Requires the request to contain a URL path that does not match the specified regular expression.

Key information:

- An edge CNAME URL is rewritten to a CDN URL prior to URL comparison.

    For example, both URLs point to the same asset and therefore have the same URL path.

     - CDN URL: http:\//wpc.0001.&lt;domain&gt;/800001/CustomerOrigin/path/asset.htm

     - Edge CNAME URL: http:\//my.domain.com/path/asset.htm

    Additional information:
    
     - URL path: /800001/CustomerOrigin/path/asset.htm

- Query strings in the URL are ignored.
    
- Use the **Ignore Case** option to control whether a case-sensitive comparison is performed.
    
- Spaces in the URL path should be replaced with "%20."

[Back to top](#reference-for-rules-engine-match-conditions)

</br>

---

### URL Path Wildcard

Compares a request's relative URL path to the specified wildcard pattern.

The **Matches**/**Does Not Match** option determines the conditions under which the URL Path Wildcard match condition is met.

- **Matches**: Requires the request to contain a URL path that matches the specified wildcard pattern.
- **Does Not Match**: Requires the request to contain a URL path that does not match the specified wildcard pattern.

Key information:

- **Relative to** option: This option determines whether the URL comparison point begins before or after the content access point.

   This option can have the following values:
     - **Root**: Indicates that the URL comparison point begins directly after the CDN hostname.

       For example: http:\//wpc.0001.&lt;domain&gt;/**800001/myorigin/myfolder/index.htm**

     - **Origin**: Indicates that the URL comparison point begins after the content access point (for example, /000001 or /800001/myorigin). Because the \*.azureedge.net CNAME is created relative to the origin directory on the Verizon CDN hostname by default, Azure CDN users should use the **Origin** value. 

       For example: https:\//&lt;endpoint&gt;.azureedge.net/**myfolder/index.htm**

     This URL points to the following Verizon CDN hostname: http:\//wpc.0001.&lt;domain&gt;/800001/myorigin/**myfolder/index.htm**

- An edge CNAME URL is rewritten to a CDN URL prior to URL comparison.

    For example, both of the following URLs point to the same asset and therefore have the same URL path:
     - CDN URL: http://wpc.0001.&lt;domain&gt;/800001/CustomerOrigin/path/asset.htm
     - Edge CNAME URL: http:\//&lt;endpoint&gt;.azureedge.net/path/asset.htm
    
    Additional information:
    
     - URL path (relative to root): /800001/CustomerOrigin/path/asset.htm
    
     - URL path (relative to origin): /path/asset.htm
    
- Specify multiple URL paths by delimiting each one with a single space.

   For example: /marketing/asset.* /sales/*.htm

- Query strings in the URL are ignored.
    
- Use the **Ignore Case** option to control whether a case-sensitive comparison is performed.
    
- Replace spaces in the URL path with "%20."
    
- The value specified for a URL path can take advantage of [wildcard values](cdn-verizon-premium-rules-engine-reference.md#wildcard-values). Each URL path pattern can contain one or more asterisks (*), where each asterisk can match a sequence of one or more characters.

#### Sample Scenarios

The sample configurations in the following table assume that this match condition is met when a request matches the specified URL pattern:

Value                   | Relative to    | Result 
------------------------|----------------|-------
*/test.html */test.php  | Root or Origin | This pattern is matched by requests for assets named "test.html" or "test.php" in any folder.
/80ABCD/origin/text/*   | Root           | This pattern is matched when the requested asset meets the following criteria: <br />- It must reside on a customer origin called "origin." <br />- The relative path must start with a folder called "text." That is, the requested asset can either reside in the "text" folder or one of its recursive subfolders.
*/css/* */js/*          | Root or Origin | This pattern is matched by all CDN or edge CNAME URLs that contain a css or js folder.
*.jpg *.gif *.png       | Root or Origin | This pattern is matched by all CDN or edge CNAME URLs ending with .jpg, .gif, or .png. An alternative way to specify this pattern is with the [URL Path Extension match condition](#url-path-extension).
/images/* /media/*      | Origin         | This pattern is matched by CDN or edge CNAME URLs whose relative path starts with an "images" or "media" folder. <br />- CDN URL: http:\//wpc.0001.&lt;domain&gt;/800001/myorigin/images/sales/event1.png<br />- Sample edge CNAME URL: http:\//cdn.mydomain.com/images/sales/event1.png

[Back to top](#reference-for-rules-engine-match-conditions)

</br>

---

### URL Query Literal

Compares a request's query string to the specified value.

The **Matches**/**Does Not Match** option determines the conditions under which the URL Query Literal match condition is met.

- **Matches**: Requires the request to contain a URL query string that matches the specified query string.
- **Does Not Match**: Requires the request to contain a URL query string that does not match the specified query string.

Key information:

- Only exact query string matches satisfy this match condition.
    
- Use the **Ignore Case** option to control the case-sensitivity of query string comparisons.
    
- Do not include a leading question mark (?) in the query string value text.
    
- Certain characters require URL encoding. Use the percentage symbol to URL encode the following characters:

   Character | URL Encoding
   ----------|---------
   Space     | %20
   &         | %25

- Due to the manner in which cache settings are tracked, this match condition is incompatible with the following features:
   - Complete Cache Fill
   - Default Internal Max-Age
   - Force Internal Max-Age
   - Ignore Origin No-Cache
   - Internal Max-Stale

[Back to top](#reference-for-rules-engine-match-conditions)

</br>

---

### URL Query Parameter

Identifies requests that contain the specified query string parameter. This parameter is set to a value that matches a specified pattern. Query string parameters (for example, parameter=value) in the request URL determine whether this condition is met. This match condition identifies a query string parameter by its name and accepts one or more values for the parameter value. 

The **Matches**/**Does Not Match** option determines the conditions under which the URL Query Parameter match condition is met.

- **Matches**: Requires a request to contain the specified parameter with a value that matches at least one of the values that are defined in this match condition.
- **Does Not Match**: Requires that the request meets either of the following criteria:
  - It does not contain the specified parameter.
  - It contains the specified parameter, but its value does not match any of the values that are defined in this match condition.

This match condition provides an easy way to specify parameter name/value combinations. For more flexibility if you are matching a query string parameter, consider using the [URL Query Wildcard](#url-query-wildcard) match condition.

Key information:

- Only a single URL query parameter name can be specified per instance of this match condition.
    
- Because wildcard values are not supported when a parameter name is specified, only exact parameter name matches are eligible for comparison.
- Parameter value(s) can include [wildcard values](cdn-verizon-premium-rules-engine-reference.md#wildcard-values).
   - Each parameter value pattern can consist of one or more asterisks (*), where each asterisk can match a sequence of one or more characters.
   - Certain characters require URL encoding. Use the percentage symbol to URL encode the following characters:

       Character | URL Encoding
       ----------|---------
       Space     | %20
       &         | %25

- Specify multiple query string parameter values by delimiting each one with a single space. This match condition is met when a request contains one of the specified name/value combinations.

   - Example 1:

     - Configuration:

       ValueA ValueB

     - This configuration matches the following query string parameters:

       Parameter1=ValueA
    
       Parameter1=ValueB

   - Example 2:

     - Configuration: 

        Value%20A Value%20B

     - This configuration matches the following query string parameters:

       Parameter1=Value%20A

       Parameter1=Value%20B

- This match condition is met only when there is an exact match to at least one of the specified query string name/value combinations.

   For example, if you use the configuration in the previous example, the parameter name/value combination "Parameter1=ValueAdd" would not be considered a match. However, if you specify either of the following values, it will match that name/value combination:

   - ValueA ValueB ValueAdd
   - ValueA* ValueB

- Use the **Ignore Case** option to control the case-sensitivity of query string comparisons.
    
- Due to the manner in which cache settings are tracked, this match condition is incompatible with the following features:
   - Complete Cache Fill
   - Default Internal Max-Age
   - Force Internal Max-Age
   - Ignore Origin No-Cache
   - Internal Max-Stale

#### Sample scenarios

The following example demonstrates how this option works in specific situations:

Name  | Value |  Result
------|-------|--------
User  | Joe   | This pattern is matched when the query string for a requested URL is "?user=joe."
User  | *     | This pattern is matched when the query string for a requested URL contains a User parameter.
Email | Joe\* | This pattern is matched when the query string for a requested URL contains an Email parameter that starts with "Joe."

[Back to top](#reference-for-rules-engine-match-conditions)

</br>

---

### URL Query Regex

Identifies requests that contain the specified query string parameter. This parameter is set to a value that matches a specified [regular expression](cdn-verizon-premium-rules-engine-reference.md#regular-expressions).

The **Matches**/**Does Not Match** option determines the conditions under which the URL Query Regex match condition is met.

- **Matches**: Requires the request to contain a URL query string that matches the specified regular expression.
- **Does Not Match**: Requires the request to contain a URL query string that does not match the specified regular expression.

Key information:

- Only exact matches to the specified regular expression satisfy this match condition.
    
- Use the **Ignore Case** option to control the case-sensitivity of query string comparisons.
    
- For the purposes of this option, a query string starts with the first character after the question mark (?) delimiter for the query string.
    
- Certain characters require URL encoding. Use the percentage symbol to URL encode the following characters:

   Character | URL Encoding | Value
   ----------|--------------|------
   Space     | %20          | \%20
   &         | %25          | \%25

   Обратите внимание, что знаки процента необходимо экранировать.

- Дважды экранируйте специальные знаки регулярного выражения (например, \^$.+), добавив обратную косую черту в регулярное выражение.

   Пример:

   Значение | Интерпретируется как 
   ------|---------------
   \\+    | +
   \\\\+   | \\+

- Из-за способа отслеживания параметров кэша это условие соответствия несовместимо со следующими функциями:
   - Завершение заполнения кэша
   - Внутренний максимальный срок по умолчанию
   - Принудительное использование внутреннего максимального срока
   - Не учитывать источник без кэша
   - Внутреннее максимальное значение устаревания

[Вверх](#reference-for-rules-engine-match-conditions)

</br>

---

### <a name="url-query-wildcard"></a>Шаблон запроса URL-адреса

Сравнивает указанное значение со строкой запроса.

Параметр **Соответствует**/**Не соответствует** определяет требования, при которых будет выполняться условие соответствия "Шаблон запроса URL-адреса".

- **Соответствует**. Запрос должен содержать строку запроса URL-адреса, соответствующую указанному значению подстановочного знака.
- **Не соответствует**. Запрос должен содержать строку запроса URL-адреса, не соответствующую указанному значению подстановочного знака.

Основные сведения

- В целях этого параметра строка запроса начинается с первого знака после разделителя вопросительного знака (?) строки запроса.
- Значения параметра могут содержать [подстановочные знаки](cdn-verizon-premium-rules-engine-reference.md#wildcard-values).
   - Каждый шаблон значения параметра может содержать одну или несколько звездочек (*), где каждая звездочка может соответствовать последовательности одного или нескольких знаков.
   - Для некоторых знаков требуется кодирование в формат URL-адреса. Используйте знак процента для кодирования таких знаков в формат URL-адреса:

     Character | Кодирование в формат URL-адреса
     ----------|---------
     Пробел     | %20
     &         | %25

- Укажите несколько значений, разделив их одним пробелом.

   Пример: *Parameter1=ValueA* *ValueB* *Parameter1=ValueC&Parameter2=ValueD*

- Этому условию отвечают только точные совпадения, соответствующие хотя бы одному из указанных шаблонов строки запроса.
    
- Используйте параметр **Без учета регистра** для управления чувствительностью к регистру сравнений строки запроса.
    
- Из-за способа отслеживания параметров кэша это условие соответствия несовместимо со следующими функциями:
   - Завершение заполнения кэша
   - Внутренний максимальный срок по умолчанию
   - Принудительное использование внутреннего максимального срока
   - Не учитывать источник без кэша
   - Внутреннее максимальное значение устаревания

#### <a name="sample-scenarios"></a>Примеры сценариев

В следующем примере показано, как этот параметр действует в определенных ситуациях.

 ИМЯ                 | Описание
 ---------------------|------------
user=ivan              | Для соответствия этому шаблону строка запроса запрошенного URL-адреса должна быть "?user=ivan."
\*user=\* \*optout=\* | Для соответствия этому шаблону запрос URL-адреса CDN должен содержать параметр пользователя или OptOut.

[Вверх](#reference-for-rules-engine-match-conditions)

</br>

## <a name="next-steps"></a>Следующие шаги

- [Общие сведения о сети доставки содержимого Azure](cdn-overview.md)
- [Обработчик правил Azure CDN](cdn-verizon-premium-rules-engine-reference.md)
- [Условные выражения обработчика правил Azure CDN](cdn-verizon-premium-rules-engine-reference-conditional-expressions.md)
- [Возможности обработчика правил](cdn-verizon-premium-rules-engine-reference-features.md)
- [Переопределение стандартного поведения через HTTP с помощью обработчика правил](cdn-verizon-premium-rules-engine.md)
