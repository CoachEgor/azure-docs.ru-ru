---
title: Ограничьте содержание Azure CDN по странам/регионам Документы Майкрософт
description: Узнайте, как ограничить доступ по странам/регионам к содержимому Azure CDN с помощью функции геофильтрации.
services: cdn
documentationcenter: ''
author: mdgattuso
manager: danielgi
editor: ''
ms.assetid: 12c17cc5-28ee-4b0b-ba22-2266be2e786a
ms.service: azure-cdn
ms.workload: tbd
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 06/19/2018
ms.author: magattus
ms.openlocfilehash: 75c422d456f2509ce478e2609a6509f78a6eb31e
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/27/2020
ms.locfileid: "67593431"
---
# <a name="restrict-azure-cdn-content-by-countryregion"></a>Ограничьте содержание Azure CDN по странам/регионам

## <a name="overview"></a>Обзор
По умолчанию запрашиваемое содержимое возвращается пользователю независимо от расположения, из которого был сделан запрос. Однако в некоторых случаях может потребоваться ограничить доступ к вашему контенту по странам/регионам. С функцией *геофильтрации* можно создавать правила на определенных путях на вашей конечной точке CDN, чтобы разрешить или заблокировать содержимое в отдельных странах/регионах.

> [!IMPORTANT]
> Профили **Azure CDN уровня "Стандартный" от Майкрософт** не поддерживают геофильтрацию на основе пути.
> 

## <a name="standard-profiles"></a>Профили (цен. категория "Стандартный")
Процедуры, описанные в этом разделе, относятся только к профилям **Azure CDN (цен. категория "Стандартный") от Akamai** и **Azure CDN (цен. категория "Стандартный") от Verizon**. 

Чтобы активировать геофильтрацию для профилей **Azure CDN (цен. категория "Премиум") от Verizon**, используйте портал **управления**. Дополнительные сведения см. в разделе о профилях [Azure CDN (цен. категория "Премиум") от Verizon](#azure-cdn-premium-from-verizon-profiles).

### <a name="define-the-directory-path"></a>Определение пути к каталогу
Чтобы получить доступ к функции геофильтрации, выберите свою конечную точку CDN на портале, а затем щелкните **Геофильтрация** в разделе параметров в меню слева. 

![Геофильтрация (цен. категория "Стандартный")](./media/cdn-filtering/cdn-geo-filtering-standard.png)

В поле **Путь** укажите относительный путь к каталогу, доступ к которому будет разрешен или запрещен. 

Геофильтрацию можно применить ко всем файлам в корневом каталоге, указав косую черту (/), или к выбранным каталогам, указав к ним пути, например */pictures/*. Геофильтрацию также можно применить к одному файлу, например */pictures/city.png*. Можете указать несколько правил. Когда вы введете первое правило, рядом появится пустая строка для ввода следующего.

Например, все следующие фильтры путей каталогов являются допустимыми:   
*/*                                 
*/Фото/*     
*/Фото/Страсбург/*     
*/Photos/Strasbourg/city.png*.

### <a name="define-the-type-of-action"></a>Определение типа действия

В списке **Действие** выберите **Разрешить** или **Запретить**: 

- **Разрешить**: Доступ к активам, запрошенным с рекурсивного пути, разрешается только пользователям из указанных стран/регионов.

- **Блок**: Пользователям из указанных стран/регионов отказано в доступе к активам, запрошенным с рекурсивного пути. Если для этого местоположения не были настроены параметры фильтрации других стран/регионов, то доступ всем остальным пользователям будет разрешен.

Например, правило геофильтрации для блокировки путей */фотографии/Strasbourg/* фильтрует следующие файлы:     
*\//http:\<endpoint>.azureedge.net/Photos/Strasbourg/1000.jpg*
*http:\//\<endpoint>.azureedge.net/Photos/Strasbourg/Cathedral/1000.jpg*

### <a name="define-the-countriesregions"></a>Определение стран/регионов
Из списка **COUNTRY CODES** выберите страны/регионы, которые вы хотите заблокировать или разрешить путь. 

После того как вы закончите выбор стран/регионов, выберите **Сохранить,** чтобы активировать новое правило геофильтрации. 

![Правила геофильтрации](./media/cdn-filtering/cdn-geo-filtering-rules.png)

### <a name="clean-up-resources"></a>Очистка ресурсов
Чтобы удалить правило, выберите его в списке на странице **Фильтрация по странам**, а затем щелкните **Удалить**.

## <a name="azure-cdn-premium-from-verizon-profiles"></a>Профили Azure CDN (цен. категория "Премиум") от Verizon
Пользовательский интерфейс для создания правила геофильтрации отличается для профилей **Azure CDN (цен. категория "Премиум") от Verizon**.

1. В меню профиля Azure CDN вверху выберите **Управление**.

2. На портале Verizon выберите **HTTP Large** (Большой HTTP-объект) и **Country Filtering** (Фильтрация по странам).

    ![Геофильтрация (цен. категория "Стандартный")](./media/cdn-filtering/cdn-geo-filtering-premium.png)

3. Нажмите кнопку **Add Country Filter** (Добавить фильтр по странам).

    Появится страница **Step One:** (Шаг 1).

4. Введите путь к каталогу, выберите **Block** (Блокировать) или **Add** (Добавить), а затем нажмите кнопку **Next** (Далее).

    Появится страница **Step Two:** (Шаг 2). 

5. Выберите одну или несколько стран/регионов из списка, а затем выберите **Завершение,** чтобы активировать правило. 
    
    Новое правило появится в таблице на странице **Country Filtering** (Фильтрация по странам).

    ![Правила геофильтрации](./media/cdn-filtering/cdn-geo-filtering-premium-rules.png)

### <a name="clean-up-resources"></a>Очистка ресурсов
В таблице правил фильтрации стран/регионов выберите значок удаления рядом с правилом, чтобы удалить его или значок для изменения.

## <a name="considerations"></a>Рекомендации
* Изменения в конфигурации геофильтрации для страны вступают в силу не сразу:
   * Для профилей **Azure CDN категории "Стандартный" от Майкрософт** распространение обычно выполняется в течение 10 минут. 
   * Для профилей **Azure CDN уровня "Стандартный" от Akamai** распространение обычно завершается в течение одной минуты. 
   * Для профилей **Azure CDN уровня "Стандартный" от Verizon** и **Azure CDN уровня "Премиум" от Verizon** распространение обычно выполняется в течение 10 минут. 
 
* Эта функция не поддерживает подстановочные знаки (например, *).

* Конфигурация геофильтрации, связанная с относительным путем, применяется рекурсивно к этому пути.

* Только одно правило может применяться к тому же относительному пути. То есть нельзя создавать несколько фильтров стран/регионов, которые указывают на один и тот же относительный путь. Однако, поскольку фильтры стран/регионов являются рекурсивными, папка может иметь несколько фильтров страны/региона. Другими словами, субфолдеру ранее настроенной папки может быть назначен другой фильтр страны/региона.

* Функция геофильтрации использует страновые коды для определения стран/регионов, из которых разрешен запрос или заблокирован для защищенного каталога. Хотя профили от Akamai и Verizon по большей части поддерживают одинаковые коды стран, существуют некоторые различия. Для получения дополнительной информации смотрите [коды страновых кодов Azure CDN.](/previous-versions/azure/mt761717(v=azure.100)) 

