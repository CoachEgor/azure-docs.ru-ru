---
title: Ограничение доступности содержимого Azure CDN по странам и регионам | Документация Майкрософт
description: Узнайте, как ограничить доступ по странам и регионам к содержимому Azure CDN с помощью функции геофильтрации.
services: cdn
documentationcenter: ''
author: mdgattuso
manager: danielgi
editor: ''
ms.assetid: 12c17cc5-28ee-4b0b-ba22-2266be2e786a
ms.service: azure-cdn
ms.workload: tbd
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 06/19/2018
ms.author: magattus
ms.openlocfilehash: 75c422d456f2509ce478e2609a6509f78a6eb31e
ms.sourcegitcommit: ccb9a7b7da48473362266f20950af190ae88c09b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/05/2019
ms.locfileid: "67593431"
---
# <a name="restrict-azure-cdn-content-by-countryregion"></a>Ограничение доступности содержимого Azure CDN по странам и регионам

## <a name="overview"></a>Обзор
По умолчанию запрашиваемое содержимое возвращается пользователю независимо от расположения, из которого был сделан запрос. Однако в некоторых случаях может потребоваться ограничить доступ к содержимому по странам и регионам. С помощью *геофильтрации* функцию, можно создать правила для определенных путей в конечной точке CDN, чтобы разрешить или блокировать содержимое в выбранных странах и регионах.

> [!IMPORTANT]
> Профили **Azure CDN уровня "Стандартный" от Майкрософт** не поддерживают геофильтрацию на основе пути.
> 

## <a name="standard-profiles"></a>Профили (цен. категория "Стандартный")
Процедуры, описанные в этом разделе, относятся только к профилям **Azure CDN (цен. категория "Стандартный") от Akamai** и **Azure CDN (цен. категория "Стандартный") от Verizon**. 

Чтобы активировать геофильтрацию для профилей **Azure CDN (цен. категория "Премиум") от Verizon**, используйте портал **управления**. Дополнительные сведения см. в разделе о профилях [Azure CDN (цен. категория "Премиум") от Verizon](#azure-cdn-premium-from-verizon-profiles).

### <a name="define-the-directory-path"></a>Определение пути к каталогу
Чтобы получить доступ к функции геофильтрации, выберите свою конечную точку CDN на портале, а затем щелкните **Геофильтрация** в разделе параметров в меню слева. 

![Геофильтрация (цен. категория "Стандартный")](./media/cdn-filtering/cdn-geo-filtering-standard.png)

В поле **Путь** укажите относительный путь к каталогу, доступ к которому будет разрешен или запрещен. 

Геофильтрацию можно применить ко всем файлам в корневом каталоге, указав косую черту (/), или к выбранным каталогам, указав к ним пути, например */pictures/* . Геофильтрацию также можно применить к одному файлу, например */pictures/city.png*. Можете указать несколько правил. Когда вы введете первое правило, рядом появится пустая строка для ввода следующего.

Например, все следующие фильтры путей каталогов являются допустимыми:   
*/*                                 
*/Photos/*    ;  
*/Photos/Strasbourg/*    ;  
*/Photos/Strasbourg/city.png*.

### <a name="define-the-type-of-action"></a>Определение типа действия

В списке **Действие** выберите **Разрешить** или **Запретить**: 

- **Разрешить**: Только пользователи из указанной страны (регионы) разрешен доступ к ресурсам запрашиваемым по указанному рекурсивному пути.

- **Блок**: Пользователей из указанной страны (регионы) запрещен доступ к ресурсам, запрашиваемым по указанному рекурсивному пути. Если нет другие страны или региона параметры фильтрации для этого расположения не настроены, то все остальные пользователи получат доступ.

Например, правило геофильтрации для блокировки путей */фотографии/Strasbourg/* фильтрует следующие файлы:     
*http:\//\<конечной точки >.azureedge.net/Photos/Strasbourg/1000.jpg*
*http:\//\<конечной точки >.azureedge.net/Photos/Strasbourg/Cathedral/1000.jpg*

### <a name="define-the-countriesregions"></a>Определите страны (регионы)
Из **КОДЫ СТРАН** выберите страны (регионы), которые вы хотите заблокировать или разрешить для пути. 

После завершения выбора страны (регионы), выберите **Сохранить** для активации нового правила геофильтрации. 

![Правила геофильтрации](./media/cdn-filtering/cdn-geo-filtering-rules.png)

### <a name="clean-up-resources"></a>Очистка ресурсов
Чтобы удалить правило, выберите его в списке на странице **Фильтрация по странам**, а затем щелкните **Удалить**.

## <a name="azure-cdn-premium-from-verizon-profiles"></a>Профили Azure CDN (цен. категория "Премиум") от Verizon
Пользовательский интерфейс для создания правила геофильтрации отличается для профилей **Azure CDN (цен. категория "Премиум") от Verizon**.

1. В меню профиля Azure CDN вверху выберите **Управление**.

2. На портале Verizon выберите **HTTP Large** (Большой HTTP-объект) и **Country Filtering** (Фильтрация по странам).

    ![Геофильтрация (цен. категория "Стандартный")](./media/cdn-filtering/cdn-geo-filtering-premium.png)

3. Нажмите кнопку **Add Country Filter** (Добавить фильтр по странам).

    Появится страница **Step One:** (Шаг 1).

4. Введите путь к каталогу, выберите **Block** (Блокировать) или **Add** (Добавить), а затем нажмите кнопку **Next** (Далее).

    Появится страница **Step Two:** (Шаг 2). 

5. Выберите один или несколько стран/регионов в списке, а затем выберите **Готово** чтобы активировать правило. 
    
    Новое правило появится в таблице на странице **Country Filtering** (Фильтрация по странам).

    ![Правила геофильтрации](./media/cdn-filtering/cdn-geo-filtering-premium-rules.png)

### <a name="clean-up-resources"></a>Очистка ресурсов
В таблице страны или региона фильтрации правил выберите значок «Удалить» рядом с правилом для его удаления или значок изменения, чтобы изменить его.

## <a name="considerations"></a>Рекомендации
* Изменения в конфигурации геофильтрации для страны вступают в силу не сразу:
   * Для профилей **Azure CDN категории "Стандартный" от Майкрософт** распространение обычно выполняется в течение 10 минут. 
   * Для профилей **Azure CDN уровня "Стандартный" от Akamai** распространение обычно завершается в течение одной минуты. 
   * Для профилей **Azure CDN уровня "Стандартный" от Verizon** и **Azure CDN уровня "Премиум" от Verizon** распространение обычно выполняется в течение 10 минут. 
 
* Эта функция не поддерживает подстановочные знаки (например, *).

* Конфигурация геофильтрации, связанная с относительным путем, применяется рекурсивно к этому пути.

* Только одно правило может применяться к тому же относительному пути. То есть не может создать несколько фильтров страны или региона, которые указывают на один и тот же относительный путь. Тем не менее поскольку фильтры страны или региона является рекурсивным, папки могут иметь несколько фильтров страны или региона. Другими словами вложенную папку ранее настроенного каталога можно назначить другую страну или регион фильтр.

* Функция геофильтрации использует коды стран для определения странах и регионах, с которых разрешен или блокируется к защищаемому каталогу запрос. Хотя профили от Akamai и Verizon по большей части поддерживают одинаковые коды стран, существуют некоторые различия. Дополнительные сведения см. в статье о [кодах стран Azure CDN](/previous-versions/azure/mt761717(v=azure.100)). 

