---
title: Руководство. Добавление личного домена к конечной точке CDN Azure | Документация Майкрософт
description: В руководстве показано, как добавить личный домен к конечной точке сети доставки содержимого Azure, чтобы его доменное имя присутствовало в URL-адресе.
services: cdn
documentationcenter: ''
author: asudbring
manager: danielgi
editor: ''
ms.service: azure-cdn
ms.workload: media
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: tutorial
ms.date: 06/11/2018
ms.author: allensu
ms.custom: mvc
ms.openlocfilehash: 08bbe1000d457cc4f4d6b655051ec640d4dcecf4
ms.sourcegitcommit: d95cab0514dd0956c13b9d64d98fdae2bc3569a0
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/25/2020
ms.locfileid: "91362101"
---
# <a name="tutorial-add-a-custom-domain-to-your-azure-cdn-endpoint"></a>Руководство по Добавление личного домена к конечной точке Azure CDN
Из этого руководства вы узнаете, как добавить личный домен к конечной точке сети доставки содержимого (CDN) Azure. При использовании конечной точки CDN для доставки содержимого личный домен требуется, если вы хотите обеспечить видимость своего доменного имени в URL-адресе CDN. Видимое доменное имя удобно для клиентов и эффективно используется для популяризации бренда. 

После создания конечной точки CDN в своем профиле имя конечной точки, которое является дочерним доменом azureedge.net, добавляется в URL-адрес для доставки содержимого CDN по умолчанию (например, https:\//contoso.azureedge.net/photo.png). Для удобства CDN Azure предоставляет возможность связать личный домен с конечной точкой CDN. Эта возможность позволяет доставить содержимое с личным доменом в URL-адресе, а не именем конечной точки (например, https:\//www.contoso.com/photo.png). 

В этом руководстве описано следующее:
> [!div class="checklist"]
> - создание записи CNAME DNS;
> - связывание личного домена с конечной точкой CDN;
> - проверка личного домена.

[!INCLUDE [quickstarts-free-trial-note](../../includes/quickstarts-free-trial-note.md)]

## <a name="prerequisites"></a>Предварительные требования

Прежде чем перейти к выполнению шагов в этом руководстве, сначала создайте профиль и как минимум одну конечную точку CDN. Дополнительные сведения см. в [кратком руководстве по созданию профиля и конечной точки Azure CDN](cdn-create-new-endpoint.md).

Если у вас еще нет личного домена, сначала нужно приобрести его у поставщика доменов. Например, ознакомьтесь с руководством [Приобретение имени личного домена для веб-приложений Azure](https://docs.microsoft.com/azure/app-service/manage-custom-dns-buy-domain).

Если вы используете Azure для размещения [доменов DNS](https://docs.microsoft.com/azure/dns/dns-overview), вам следует делегировать систему доменного имени поставщика домена (DNS) в Azure DNS. Дополнительные сведения см. в статье [Делегирование домена в Azure DNS](https://docs.microsoft.com/azure/dns/dns-delegate-domain-azure-dns). В противном случае при использовании поставщика доменов для обработки домена DNS перейдите к разделу [создания записей CNAME DNS](#create-a-cname-dns-record).


## <a name="create-a-cname-dns-record"></a>Создание записи CNAME DNS

Перед использованием личного домена с конечной точкой Azure CDN сначала необходимо создать запись канонического имени (CNAME) поставщика домена для указания конечной точки CDN. Запись CNAME — это тип записи DNS, позволяющий сопоставить имена исходного и конечного доменов. Для Azure CDN исходное доменное имя является именем вашего личного домена, а имя домена назначения представляет собой имя узла конечной точки CDN. После того, как Azure CDN проверит созданную запись CNAME, трафик, адресованный исходному личному домену (например, www\.contoso.com), будет направлен к указанному имени узла конечной точки CDN назначения (например, contoso.azureedge.net). 

Личный домен и его поддомен можно связать только с одной конечной точкой за раз. Однако можно использовать разные поддомены одного и того же личного домена для разных конечных точек службы Azure с помощью нескольких записей CNAME. Кроме того, можно сопоставить личный домен с разными поддоменами с одной конечной точкой CDN.

> [!NOTE]
> Для личных доменов можно использовать любой тип записи псевдонима, если в качестве поставщика доменов вы используете Azure DNS. В этом пошаговом руководстве используется тип записи CNAME. Если вы используете записи типа A или AAAA, просто выполните шаги ниже и замените тип CNAME нужным вам типом записи. Если вы используете запись псевдонима для добавления корневого домена в качестве личного домена и хотите включить протокол TLS, выполните проверку вручную, как описано в [этой статье](https://docs.microsoft.com/azure/cdn/cdn-custom-ssl?tabs=option-1-default-enable-https-with-a-cdn-managed-certificate#custom-domain-is-not-mapped-to-your-cdn-endpoint). См. подробнее о [привязке вершины зоны к конечной точке CDN Azure](https://docs.microsoft.com/azure/dns/dns-alias#point-zone-apex-to-azure-cdn-endpoints).

## <a name="map-the-temporary-cdnverify-subdomain"></a>Сопоставление промежуточного поддомена cdnverify

При сопоставлении имеющегося в рабочей среде домена стоит обратить внимание на следующее. При регистрации личного домена на портале Azure может возникнуть короткий период простоя домена. Чтобы избежать прерывания веб-трафика, сначала сопоставьте личный домен с именем узла конечной точки CDN с поддоменом cdnverify Azure, чтобы создать временное сопоставление CNAME. С помощью этого метода пользователи могут беспрепятственно получить доступ к вашему домену во время сопоставления DNS. 

В противном случае, если вы впервые используете свой личный домен и у него нет рабочего трафика, его можно напрямую сопоставить с конечной точкой CDN. Ознакомьтесь с разделом о [сопоставлении постоянного личного домена](#map-the-permanent-custom-domain).

Чтобы создать запись CNAME с поддоменом cdnverify, сделайте следующее.

1. Войдите на веб-сайт поставщика своего личного домена.

2. Найдите страницу для управления записями DNS. Для этого ознакомьтесь с документацией поставщика или поищите области веб-сайта, обозначенные как **Доменное имя**, **DNS** или **Name Server Management** (Управление сервером доменных имен). 

3. Создайте запись CNAME для своего личного домена и заполните поля, как показано в таблице ниже (имена полей могут отличаться):

    | Источник                    | Тип  | Назначение                     |
    |---------------------------|-------|---------------------------------|
    | cdnverify. www.contoso.com | CNAME | cdnverify.contoso.azureedge.net |

    - Источник: введите имя своего личного домена, включая поддомен cdnverify, в следующем формате: cdnverify.&lt;имя личного домена&gt;. Например, cdnverify. www.contoso.com.

    - Тип: введите *CNAME*.

    - Назначение: введите имя узла конечной точки CDN, включая поддомен cdnverify, в следующем формате: cdnverify. _&lt;имя конечной точки&gt;_ .azureedge.net. Например, cdnverify.contoso.azureedge.net.

4. Сохраните изменения.

Например, процедура для регистратора домена GoDaddy выглядит следующим образом:

1. Войдите в систему и выберите личный домен, который нужно использовать.

2. В разделе доменов выберите **Управление**, а затем — **DNS** | **Manage Zones** (Управление зонами).

3. Для **доменного имени** введите свой личный домен, а затем выберите **Поиск**.

4. На странице **управления DNS** выберите **Добавить**, а затем в списке **типа** выберите **CNAME**.

5. Заполните следующие поля записи CNAME:

    ![Снимок экрана: запись CNAME с заданными значениями в полях "Тип", "Узел", "Points to" (Указывает на) и "TTL" для временного поддомена cdnverify.](./media/cdn-map-content-to-custom-domain/cdn-cdnverify-cname-entry.png)

    - Тип: оставьте выбранное значение *CNAME*.

    - "Узел": введите поддомен своего личного домена, в том числе имя поддомена cdnverify. Например, cdnverify. www.

    - Points to (Указывает на): введите имя узла конечной точки CDN, включая имя поддомена cdnverify. Например, cdnverify.contoso.azureedge.net. 

    - "Срок жизни": оставьте выбранное значение *1 час*.

6. Щелкните **Сохранить**.
 
    Запись CNAME добавится к таблице записей DNS.

    ![Снимок экрана: запись CNAME добавлена в таблицу записей DNS для временного поддомена cdnverify.](./media/cdn-map-content-to-custom-domain/cdn-cdnverify-dns-table.png)


## <a name="associate-the-custom-domain-with-your-cdn-endpoint"></a>Связывание личного домена с конечной точкой CDN

После регистрации личного домена его можно добавить в конечную точку CDN. 

1. Войдите на [портал Azure](https://portal.azure.com/) и перейдите в профиль CDN, содержащий конечную точку, которую нужно сопоставить с личным доменом.
    
2. На странице **профиля CDN** выберите конечную точку CDN, чтобы связать ее с личным доменом.

   Откроется страница **Конечная точка**.
    
3. Нажмите кнопку **Личный домен**. 

   ![Кнопка личного домена CDN](./media/cdn-map-content-to-custom-domain/cdn-custom-domain-button.png)

   Откроется страница **добавления личного домена**.

4. Для параметра **Имя узла конечной точки**, значение, которое будет использоваться в качестве целевого домена записи CNAME, заполняется автоматически и выводится из URL-адреса конечной точки CDN: *&lt;имя узла конечной точки&gt;* .azureedge.net. Их невозможно изменить.

5. Для параметра **Пользовательское имя узла** укажите личный домен (включая дочерний домен), который будет использоваться в качестве исходного домена записи CNAME. Например, www\.contoso.com или cdn.contoso.com. Не используйте имя поддомена cdnverify.

   ![Диалоговое окно личного домена CDN](./media/cdn-map-content-to-custom-domain/cdn-add-custom-domain.png)

6. Выберите **Добавить**.

   Azure проверит наличие записи CNAME для введенного имени личного домена. Если запись CNAME правильна, пользовательский домен пройдет проверку. 

   Для применения новых параметров личного домена на всех граничных узлах CDN может потребоваться некоторое время: 
    - Для профилей **Azure CDN категории "Стандартный" от Майкрософт** распространение обычно выполняется в течение 10 минут. 
    - Для профилей **Azure CDN уровня "Стандартный" от Akamai** распространение обычно завершается в течение одной минуты. 
    - Для профилей **Azure CDN уровня "Стандартный" от Verizon** и **Azure CDN уровня "Премиум" от Verizon** распространение обычно выполняется в течение 10 минут.   


## <a name="verify-the-custom-domain"></a>Проверка личного домена.

После завершения регистрации личного домена убедитесь, что он ссылается на конечную точку CDN.
 
1. Убедитесь, что общедоступное содержимое кэшируется в конечной точке. Например, если конечная точка CDN связана с учетной записью хранения, Azure CDN кэширует содержимое в общедоступном контейнере. Чтобы проверить личный домен, убедитесь, что контейнер допускает открытый доступ и содержит не менее одного файла.

2. В браузере перейдите по адресу файла с помощью личного домена. Например, если ваш личный домен — `www.contoso.com`, URL-адрес кэшированного большого файла должен быть аналогичен следующему URL-адресу: `http://www.contoso.com/my-public-container/my-file.jpg`. Убедитесь, что результат такой же, как и при доступе непосредственно к конечной точке CDN *&lt;имя узла конечной точки&gt;* .azureedge.net.


## <a name="map-the-permanent-custom-domain"></a>Сопоставление постоянного личного домена

После проверки успешного сопоставления поддомена cdnverify с конечной точкой (или при использовании нового личного домена, который размещается не в рабочей среде) можно затем сопоставить личный домен напрямую с именем узла конечной точки CDN.

Чтобы создать запись CNAME для личного домена, сделайте следующее.

1. Войдите на веб-сайт поставщика своего личного домена.

2. Найдите страницу для управления записями DNS. Для этого ознакомьтесь с документацией поставщика или поищите области веб-сайта, обозначенные как **Доменное имя**, **DNS** или **Name Server Management** (Управление сервером доменных имен). 

3. Создайте запись CNAME для своего личного домена и заполните поля, как показано в таблице ниже (имена полей могут отличаться):

    | Источник          | Тип  | Назначение           |
    |-----------------|-------|-----------------------|
    | <www.contoso.com> | CNAME | contoso.azureedge.net |

   - Источник: введите имя личного домена (например, www\.contoso.com).

   - Тип: введите *CNAME*.

   - Назначение: введите имя узла конечной точки CDN. Должен использоваться следующий формат: _&lt;имя конечной точки&gt;_ .azureedge.net. Например, contoso.azureedge.net.

4. Сохраните изменения.

5. Если вы ранее создали временную запись CNAME поддомена cdnverify, удалите ее. 

6. Если вы используете этот личный домен в рабочей среде впервые, выполните действия для [связывания личного домена с конечной точкой CDN](#associate-the-custom-domain-with-your-cdn-endpoint) и [проверки этого личного домена](#verify-the-custom-domain).

Например, процедура для регистратора домена GoDaddy выглядит следующим образом:

1. Войдите в систему и выберите личный домен, который нужно использовать.

2. В разделе доменов выберите **Управление**, а затем — **DNS** | **Manage Zones** (Управление зонами).

3. Для **доменного имени** введите свой личный домен, а затем выберите **Поиск**.

4. На странице **управления DNS** выберите **Добавить**, а затем в списке **типа** выберите **CNAME**.

5. Заполните следующие поля записи CNAME:

    ![Снимок экрана: запись CNAME с заданными значениями в полях "Тип", "Узел", "Points to" (Указывает на) и "TTL" для постоянного личного домена.](./media/cdn-map-content-to-custom-domain/cdn-cname-entry.png)

    - Тип: оставьте выбранное значение *CNAME*.

    - "Узел": введите поддомен личного домена. Например, www или cdn.

    - Points to (Указывает на): введите имя узла конечной точки CDN. Например, contoso.azureedge.net. 

    - "Срок жизни": оставьте выбранное значение *1 час*.

6. Щелкните **Сохранить**.
 
    Запись CNAME добавится к таблице записей DNS.

    ![Снимок экрана: запись CNAME добавлена в таблицу записей DNS для постоянного личного домена.](./media/cdn-map-content-to-custom-domain/cdn-dns-table.png)

7. Если у вас есть запись CNAME cdnverify, нажмите значок карандаша рядом с ней, а затем выберите значок урны.

8. Выберите **Удалить**, чтобы удалить запись CNAME.


## <a name="clean-up-resources"></a>Очистка ресурсов

Ранее вы добавили личный домен к конечной точке CDN. Если вы больше не хотите связывать свою конечную точку с личным доменом, этот домен можно удалить, выполнив действия ниже.
 
1. В профиле CDN выберите конечную точку с личным доменом, который нужно удалить.

2. На странице **Конечная точка** в разделе личных доменов щелкните личный домен, который нужно удалить, правой кнопкой мыши, а затем в контекстном меню выберите **Удалить**.  

   Личный домен отсоединится от конечной точки.


## <a name="next-steps"></a>Дальнейшие действия

В этом руководстве вы узнали, как выполнять следующие задачи:

> [!div class="checklist"]
> - создание записи CNAME DNS;
> - связывание личного домена с конечной точкой CDN;
> - проверка личного домена.

Перейдите к следующему руководству, чтобы научиться настраивать протокол HTTPS в личном домене Azure CDN.

> [!div class="nextstepaction"]
> [Руководство. по настройке протокола HTTPS для личного домена в сети доставки содержимого Azure](cdn-custom-ssl.md)


