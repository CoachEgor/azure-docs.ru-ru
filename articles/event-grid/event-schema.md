---
title: Схема событий службы "Сетка событий Azure"
description: Описывает свойства и схему, которые имеются для всех событий. События состоят из пяти обязательных строковых свойств и требуемого объекта данных.
services: event-grid
author: banisadr
manager: timlt
ms.service: event-grid
ms.topic: reference
ms.date: 01/21/2020
ms.author: babanisa
ms.openlocfilehash: 35cea2e6df311d2f4071686c21c8e4c36477abc1
ms.sourcegitcommit: 509b39e73b5cbf670c8d231b4af1e6cfafa82e5a
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/05/2020
ms.locfileid: "78370588"
---
# <a name="azure-event-grid-event-schema"></a>Схема событий службы "Сетка событий Azure"

В этой статье описываются свойства и схемы, присутствующие во всех событиях. События состоят из пяти обязательных строковых свойств и требуемого объекта данных. Свойства являются общими для всех событий от любого издателя. Объект данных имеет свойства, характерные для каждого издателя. В случае с системными разделами эти свойства относятся к поставщику ресурсов, включая службу хранилища Azure или Центры событий Azure.

Источники событий отправляют события в службу "Сетка событий Azure" в массиве, в котором может быть несколько объектов событий. При отправке событий в службу "Сетка событий" общий размер массива не может превышать 1 МБ. Каждое событие в массиве ограничено 64 КБ (общая доступность) или 1 МБ (Предварительная версия). Если событие или массив превышает пределы размера, поступает ответ **413 (слишком большой объем полезных данных)** .

> [!NOTE]
> Событие размером до 64 КБ покрывается по общедоступной версии Соглашение об уровне обслуживания (SLA). В настоящее время доступна предварительная версия поддержки для события размером до 1 МБ. За событиями свыше 64 КБ начислено приращения в 64 КБ. 

Служба "Сетка событий" отправляет события подписчикам в массиве с одним событием. Это поведение может измениться в будущем.

Схему JSON для события сетки событий и полезные данные каждого издателя Azure вы найдете в [хранилище схемы событий](https://github.com/Azure/azure-rest-api-specs/tree/master/specification/eventgrid/data-plane).

## <a name="event-schema"></a>Схема событий

В следующем примере показаны свойства, которые используются все издатели событий:

```json
[
  {
    "topic": string,
    "subject": string,
    "id": string,
    "eventType": string,
    "eventTime": string,
    "data":{
      object-unique-to-each-publisher
    },
    "dataVersion": string,
    "metadataVersion": string
  }
]
```

Например, вот схема, опубликованная для события хранения больших двоичных объектов Azure:

```json
[
  {
    "topic": "/subscriptions/{subscription-id}/resourceGroups/Storage/providers/Microsoft.Storage/storageAccounts/xstoretestaccount",
    "subject": "/blobServices/default/containers/oc2d2817345i200097container/blobs/oc2d2817345i20002296blob",
    "eventType": "Microsoft.Storage.BlobCreated",
    "eventTime": "2017-06-26T18:41:00.9584103Z",
    "id": "831e1650-001e-001b-66ab-eeb76e069631",
    "data": {
      "api": "PutBlockList",
      "clientRequestId": "6d79dbfb-0e37-4fc4-981f-442c9ca65760",
      "requestId": "831e1650-001e-001b-66ab-eeb76e000000",
      "eTag": "0x8D4BCC2E4835CD0",
      "contentType": "application/octet-stream",
      "contentLength": 524288,
      "blobType": "BlockBlob",
      "url": "https://oc2d2817345i60006.blob.core.windows.net/oc2d2817345i200097container/oc2d2817345i20002296blob",
      "sequencer": "00000000000004420000000000028963",
      "storageDiagnostics": {
        "batchId": "b68529f3-68cd-4744-baa4-3c0498ec19f0"
      }
    },
    "dataVersion": "",
    "metadataVersion": "1"
  }
]
```

## <a name="event-properties"></a>Свойства события

Во всех событиях есть следующие одинаковые данные верхнего уровня:

| Свойство | Тип | Обязательно | Описание |
| -------- | ---- | -------- | ----------- |
| Раздел | string | Нет, но если он указан, он должен точно соответствовать разделу сетки событий Azure Resource Manager ID. Если не включена, то сетка событий будет отмечаться на событие. | Полный путь к ресурсу для источника событий. Это поле защищено от записи. Это значение предоставляет служба "Сетка событий". |
| subject | string | Да | Определенный издателем путь к субъекту событий. |
| eventType | string | Да | Один из зарегистрированных типов событий для этого источника событий. |
| eventTime | string | Да | Время создания события с учетом времени поставщика в формате UTC. |
| id | string | Да | Уникальный идентификатор события. |
| data | object | Нет | Данные события, относящиеся к поставщику ресурсов. |
| dataVersion | string | Нет, но будет отмечено пустым значением. | Версия схемы для объекта данных. Версию схемы определяет издатель. |
| metadataVersion | string | Не требуется, но если он указан, должен совпадать со схемой сетки событий `metadataVersion` точно (в настоящее время `1`). Если не включена, то сетка событий будет отмечаться на событие. | Версия схемы для метаданных события. Служба "Сетка событий" определяет схему свойств верхнего уровня. Это значение предоставляет служба "Сетка событий". |

Дополнительные сведения о свойствах в объекте данных см. в источнике события:

* [Подписки Azure (операции управления)](event-schema-subscriptions.md)
* [Реестр контейнеров](event-schema-container-registry.md)
* [Хранилище BLOB-объектов](event-schema-blob-storage.md)
* [Центры событий](event-schema-event-hubs.md)
* [Центр Интернета вещей](event-schema-iot-hub.md)
* [Службы мультимедиа](../media-services/latest/media-services-event-schemas.md?toc=%2fazure%2fevent-grid%2ftoc.json)
* [Группы ресурсов (операции управления)](event-schema-resource-groups.md)
* [Служебная шина](event-schema-service-bus.md)
* [Azure SignalR](event-schema-azure-signalr.md)
* [Машинное обучение Azure](event-schema-machine-learning.md)

Для настраиваемых разделов объект данных определяет издатель. Данные верхнего уровня должны иметь те же поля, что и стандартные определенные события ресурса.

При публикации событий в пользовательских разделах создавайте темы для событий, чтобы подписчикам было проще определить, представляет ли событие для них интерес. Подписчики используют темы для фильтрации и маршрутизации событий. Рекомендуем указать путь к расположению, в котором произошло событие, чтобы подписчики могли выполнить фильтрацию по сегментам этого пути. Путь позволяет подписчикам сузить или расширить область фильтрации. Например, если указать в теме трехсегментный путь, такой как `/A/B/C`, подписчики смогут выполнить фильтрацию по первому сегменту `/A`, чтобы получить широкий набор событий. Эти подписчики получат события с такими темами, как `/A/B/C` или `/A/D/E`. Другие подписчики могут выполнить фильтрацию по `/A/B`, чтобы получить более узкий набор событий.

Иногда в теме требуется подробнее указать, что произошло. Например, при добавлении файла в контейнер издатель **учетных записей хранения** указывает тему `/blobServices/default/containers/<container-name>/blobs/<file>`. Подписчик может выполнять фильтрацию по пути `/blobServices/default/containers/testcontainer`, чтобы получить все события этого контейнера, но не других контейнеров в учетной записи хранения. Также подписчик может выполнить фильтрацию или маршрутизацию по суффиксу `.txt`, чтобы работать только с текстовыми файлами.

## <a name="next-steps"></a>Следующие шаги

* См. общие сведения о [службе "Сетка событий Azure"](overview.md).
* Дополнительные сведения о создании подписки на Сетку событий Azure см. в статье [Схема подписки для службы "Сетка событий"](subscription-creation-schema.md).
