---
title: Выпускное пакетирование в Azure Event Grid IoT Edge (ru) Документы Майкрософт
description: Выпускное пакетирование в Event Grid на IoT Edge.
author: HiteshMadan
manager: rajarv
ms.author: himad
ms.reviewer: spelluru
ms.date: 10/06/2019
ms.topic: article
ms.service: event-grid
services: event-grid
ms.openlocfilehash: a6f033af34088081090251f2e5e7cd4a07ce43cc
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/27/2020
ms.locfileid: "76841753"
---
# <a name="output-batching"></a>Пакетная обработка выходных данных

Event Grid имеет поддержку для доставки более одного события в одном запросе на доставку. Эта функция позволяет увеличить общую пропускную стоимость доставки без уплаты накладных расходов HTTP за запрос. Пакетирование отключено по умолчанию и может быть включено за подписку.

> [!WARNING]
> Максимальная разрешенная продолжительность обработки каждого запроса на доставку не меняется, даже несмотря на то, что код абонента потенциально должен выполнять больше работы по пакетированному запросу. Тайм-аут доставки по умолчанию до 60 секунд.

## <a name="batching-policy"></a>Политика пакетирования

Пакетирование поведения Event Grid может быть настроено на одного абонента, настраивая следующие две настройки:

* Максимальное количество событий на партию

  Этот параметр устанавливает верхний предел количества событий, которые могут быть добавлены в пакетный запрос доставки.

* Предпочтительный размер пакета в килобаитах

  Эта ручка используется для дальнейшего контроля максимального количества килобайт, которые могут быть отправлены на запрос доставки

## <a name="batching-behavior"></a>Поведение пакетирования

* Все или нет

  Event Grid работает с семантикой «все или нет». Он не поддерживает частичный успех доставки партии. Абоненты должны быть осторожны, чтобы только просить столько событий на партию, как они могут разумно обрабатывать в 60 секунд.

* Оптимистичная партийная партия

  Параметры политики пакетирования не являются строгими границами поведения пакетирования и соблюдаются на основе наилучших усилий. При низких скоростях событий вы часто наблюдаете, что размер партии меньше запрашиваемых максимальных событий на партию.

* По умолчанию установлен на OFF

  По умолчанию Event Grid добавляет только одно событие к каждому запросу на доставку. Способ включить пакетирование состоит в том, чтобы установить одну из параметров, упомянутых ранее в статье в подписке событий JSON.

* Значения по умолчанию

  При создании подписки на событие не требуется указывать как параметры (максимальные события на партию, так и приблизительный размер пакета в килограммовых байтах. Если установлен только один параметр, Event Grid использует (настраиваемые) значения по умолчанию. Ознакомьтесь со следующими разделами значений по умолчанию и как их переопределить.

## <a name="turn-on-output-batching"></a>Включить выходную партию

```json
{
    "properties":
    {
        "destination":
        {
            "endpointType": "WebHook",
            "properties":
             {
                "endpointUrl": "<your_webhook_url>",
                "maxEventsPerBatch": 10,
                "preferredBatchSizeInKilobytes": 64
             }
        },
    }
}
```

## <a name="configuring-maximum-allowed-values"></a>Настройка максимально допустимых значений

Следующие параметры времени развертывания контролируют максимальное значение, допустимое при создании подписки события.

| Имя свойства | Описание |
| ------------- | ----------- | 
| `api__deliveryPolicyLimits__maxpreferredBatchSizeInKilobytes` | Максимальное значение, `PreferredBatchSizeInKilobytes` допустимое для ручки. По `1033`умолчанию .
| `api__deliveryPolicyLimits__maxEventsPerBatch` | Максимальное значение, `MaxEventsPerBatch` допустимое для ручки. По `50`умолчанию .

## <a name="configuring-runtime-default-values"></a>Настройка значений по умолчанию времен выполнения

Следующие параметры времени развертывания управляют значением по умолчанию времени выполнения каждой ручки, когда она не указана в подписке события. Повторяю, по крайней мере одна ручка должна быть установлена на подписке событий, чтобы включить поведение пакетирования.

| Имя свойства | Описание |
| ------------- | ----------- |
| `broker__defaultMaxBatchSizeInBytes` | Максимальный размер запроса на доставку, когда указано только. `MaxEventsPerBatch` По `1_058_576`умолчанию .
| `broker__defaultMaxEventsPerBatch` | Максимальное количество событий, чтобы добавить к пакету, когда только `MaxBatchSizeInBytes` указано. По `10`умолчанию .
