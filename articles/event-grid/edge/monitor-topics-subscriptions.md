---
title: Мониторинг тем и подписки на события - Azure Event Grid IoT Edge Документы Майкрософт
description: Мониторинг тем и подписки на мероприятия
author: banisadr
ms.author: babanisa
ms.reviewer: spelluru
ms.date: 01/09/2020
ms.topic: article
ms.service: event-grid
services: event-grid
ms.openlocfilehash: ce7c92f121fb458d528d63d0af0aad025b377386
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/27/2020
ms.locfileid: "77086676"
---
# <a name="monitor-topics-and-event-subscriptions"></a>Мониторинг тем и подписки на мероприятия

Event Grid on Edge предоставляет ряд метрик по темам и подпискам на мероприятия в [формате экспозиции Prometheus.](https://prometheus.io/docs/instrumenting/exposition_formats/) В этой статье описаны доступные метрики и способы их включения.

## <a name="enable-metrics"></a>Включить метрики

Настроили модуль для испускания `metrics__reporterType` метрик, установив переменную среды `prometheus` в контейнере создать параметры:

 ```json
        {
          "Env": [
            "metrics__reporterType=prometheus"
          ],
          "HostConfig": {
            "PortBindings": {
              "4438/tcp": [
                {
                    "HostPort": "4438"
                }
              ]
            }
          }
        }
 ```    

Метрика будет доступна `5888/metrics` в модуле `4438/metrics` для http и https. Например, `http://<modulename>:5888/metrics?api-version=2019-01-01-preview` для http. На этом этапе модуль метрик может опросить конечную точку для сбора метрик, как в этой [архитектуре примера.](https://github.com/veyalla/ehm)

## <a name="available-metrics"></a>Доступные метрики

Как темы, так и подписки на события излучают метрики, чтобы дать вам представление о доставке событий и производительности модуля.

### <a name="topic-metrics"></a>Метрики темы

| Метрика | Описание |
| ------ | ----------- |
| СобытияПолучено | Количество событий, опубликованных на эту тему
| НепревзойденныеСобытия | Количество событий, опубликованных на тему, которые не соответствуют подписке на события и отброшены
| УспехЗапросы | Количество входящих запросов публикации, полученных по теме
| СистемаОшибкАЗапросы | Количество входящих запросов на публикацию не удалось из-за внутренней системной ошибки
| UserErrorRequests | Номер на входящих запросах публикации не удалось из-за ошибки пользователя, такие как недополученные JSON
| УспехЗапросЛаентиМы | Публикация задержки ответа запроса за миллисекунды


### <a name="event-subscription-metrics"></a>Метрики подписки на события

| Метрика | Описание |
| ------ | ----------- |
| ДоставкаУспехКстом | Количество событий, успешно доставленных в настроенную конечную точку
| ДоставкаFailureCounts | Количество событий, которые не были доставлены в настроенную конечную точку
| DeliverySuccessLatencyMs | Задержка событий, успешно доставленных в миллисекундах
| ДоставкаFailureLatencyMs | Задержка сбоев доставки событий в миллисекундах
| SystemdelayForFirstAttemptms | Задержка событий перед первой попыткой доставки в миллисекундах
| ДоставкаПопыткиCount | Количество попыток доставки событий - успех и неудача
| Срок действия | Количество событий, срок действия которых истек и не были доставлены в настроенную конечную точку