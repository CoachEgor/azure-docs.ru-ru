---
title: Обновление с базового внутреннего на стандартный внутренний - Балансер загрузки Azure
description: В этой статье показано, как обновить балансер внутренней нагрузки Azure с базового SKU в Standard SKU
services: load-balancer
author: irenehua
ms.service: load-balancer
ms.topic: article
ms.date: 02/23/2020
ms.author: irenehua
ms.openlocfilehash: 239dc0f3133a5adf59a23d333131c91d3a655597
ms.sourcegitcommit: d57d2be09e67d7afed4b7565f9e3effdcc4a55bf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/22/2020
ms.locfileid: "81770388"
---
# <a name="upgrade-azure-internal-load-balancer--no-outbound-connection-required"></a>Обновление баланса внутренней нагрузки Azure - Не требуется исходящие подключения
[Azure Standard Load Balancer](load-balancer-overview.md) предлагает богатый набор функциональных возможностей и высокую доступность за счет избыточности зон. Чтобы узнать больше о Загружение балансер SKU, [см.](https://docs.microsoft.com/azure/load-balancer/concepts-limitations#skus)

В этой статье представлен скрипт PowerShell, который создает балансер стандартной нагрузки с той же конфигурацией, что и балансер basic Load, а также миграционный трафик от Basic Load Balancer к балансу стандартной нагрузки.

## <a name="upgrade-overview"></a>Общие сведения об обновлении

Доступен скрипт Azure PowerShell, который делает следующее:

* Создает стандартный внутренний балансосиватель загрузки SKU в указанном вами месте. Обратите внимание, что [исходящие соединения](https://docs.microsoft.com/azure/load-balancer/load-balancer-outbound-connections) не будут предоставляться Standard Internal Load Balancer.
* Бесшовно копирует конфигурации Базового балансировора загрузки SKU на недавно созданный Standard Load Balancer.
* Бесшовно перемещать частные I-провайдеры с Basic Load Balancer на недавно созданный Standard Load Balancer.
* Бесшовно переместить VMs из бэкэндпула базового баланса нагрузки в бэкэнд бассейн балансировки стандартной нагрузки

### <a name="caveatslimitations"></a>Ограничения оговорок

* Сценарий поддерживает только обновление внутреннего баланса нагрузки, где не требуется исходящих подключений. Если вам требуется [исходящие соединения](https://docs.microsoft.com/azure/load-balancer/load-balancer-outbound-connections) для некоторых из ваших VMs, пожалуйста, обратитесь к этой [странице](upgrade-InternalBasic-To-PublicStandard.md) для получения инструкций. 
* Если балансомер стандартной нагрузки создан в другом регионе, вы не сможете связать ВМ, существующие в старом регионе, с недавно созданным балансом стандартной нагрузки. Чтобы обойти это ограничение, убедитесь, что создать новый VM в новом регионе.
* Если ваш балансер нагрузки не имеет конфигурации IP-адреса переднего энда или пула бэкэнда, вы, скорее всего, поразите ошибку, управляя скриптом. Убедитесь, что они не пусты.

## <a name="download-the-script"></a>Скачать сценарий

Скачать скрипт миграции из [галереи PowerShell](https://www.powershellgallery.com/packages/AzureILBUpgrade/2.0).
## <a name="use-the-script"></a>Использование сценария

Есть два варианта для вас в зависимости от локальной настройки среды PowerShell и предпочтений:

* Если у вас нет установленных модулей Azure Az или нет ничего плохого в установке модулей Azure Az, лучшим вариантом является использование `Install-Script` опции для запуска скрипта.
* Если вам необходимо сохранить модули Azure Az, лучше всего загрузить скрипт и запустить его напрямую.

Чтобы определить, установлены ли модули `Get-InstalledModule -Name az`Azure Az, запустите. Если вы не видите `Install-Script` установленных модулей Az, то вы можете использовать метод.

### <a name="install-using-the-install-script-method"></a>Установка с помощью метода установки-скрипта

Для использования этой опции на компьютер не должны быть установлены модули Azure Az. Если они установлены, следующая команда отображает ошибку. Вы можете удалить модули Azure Az, либо использовать другой вариант для загрузки скрипта вручную и запуска его.
  
Выполните скрипт с помощью следующей команды:

`Install-Script -Name AzureILBUpgrade`

Эта команда также устанавливает необходимые модули Az.  

### <a name="install-using-the-script-directly"></a>Установка с помощью сценария напрямую

Если у вас установлены некоторые модули Azure Az, которые не могут их удалить (или не хотите их унифицировать), вы можете вручную загрузить скрипт с помощью вкладки **Ручной загрузки** в ссылке загрузки скрипта. Скрипт загружается в виде необработанного файла nupkg. Чтобы установить скрипт из этого файла nupkg, [см.](/powershell/scripting/gallery/how-to/working-with-packages/manual-download)

Выполните следующее, чтобы запустить этот сценарий.

1. Используйте `Connect-AzAccount` для подключения к Azure.

1. Используйте `Import-Module Az` для импорта модулей Az.

1. Изучите необходимые параметры:

   * **rgName: «String»: Требуется** - это группа ресурсов для существующего базового баланса нагрузки и нового балансировора стандартной нагрузки. Чтобы найти это значение строки, перейдите на портал Azure, выберите исходный элемент Basic Load Balancer и нажмите **обзор** для балансоилира нагрузки. Группа ресурсов находится на этой странице.
   * **OldLBName: «String»: Требуется** - Это имя вашего существующего базового балансера, который вы хотите обновить. 
   * **newlocation: «String»: Требуется** - Это место, в котором будет создан балансер стандартной нагрузки. Рекомендуется унаследовать то же место расположение выбранного базового балансора на балансе стандартной нагрузки для лучшей связи с другими существующими ресурсами.
   * **newLBName: «String»: Требуется** - это имя для балансора стандартной нагрузки, которая будет создана.
1. Выполнить скрипт с использованием соответствующих параметров. Это может занять от пяти до семи минут, чтобы закончить.

    **Пример**

   ```azurepowershell
   AzureILBUpgrade.ps1 -rgName "test_InternalUpgrade_rg" -oldLBName "LBForInternal" -newlocation "centralus" -newLbName "LBForUpgrade"
   ```

## <a name="common-questions"></a>Часто задаваемые вопросы

### <a name="are-there-any-limitations-with-the-azure-powershell-script-to-migrate-the-configuration-from-v1-to-v2"></a>Существуют ли какие-либо ограничения со скриптом Azure PowerShell для переноса конфигурации из v1 в v2?

Да. Смотрите [Пещеры / Ограничения](#caveatslimitations).

### <a name="does-the-azure-powershell-script-also-switch-over-the-traffic-from-my-basic-load-balancer-to-the-newly-created-standard-load-balancer"></a>Переключается ли также скрипт Azure PowerShell с моего базового баланса нагрузки на недавно созданный балансер стандартной нагрузки?

Да, он мигрирует трафика. Если вы хотите мигрировать трафик лично, используйте [этот скрипт,](https://www.powershellgallery.com/packages/AzureILBUpgrade/1.0) который не перемещает ввоз в обиходы для вас.

### <a name="i-ran-into-some-issues-with-using-this-script-how-can-i-get-help"></a>Я столкнулся с некоторыми проблемами с использованием этого сценария. Как я могу получить помощь?
  
Вы можете отправить slbupgradesupport@microsoft.comэлектронное письмо, открыть кейс поддержки с помощью поддержки Azure или сделать и то, и другое.

## <a name="next-steps"></a>Следующие шаги

[Узнайте о балансе standard Load Balancer](load-balancer-overview.md)
