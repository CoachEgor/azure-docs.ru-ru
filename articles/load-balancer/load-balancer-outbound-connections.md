---
title: Исходящие подключения в Azure
titleSuffix: Azure Load Balancer
description: В этой статье рассказывается о том, как Azure обеспечивает взаимодействие виртуальных машин с общедоступными службами Интернета.
services: load-balancer
documentationcenter: na
author: asudbring
ms.service: load-balancer
ms.custom: seodec18
ms.devlang: na
ms.topic: conceptual
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 06/24/2020
ms.author: allensu
ms.openlocfilehash: 738b54d9fcd86313c2581c5d0f055a7cca8230b8
ms.sourcegitcommit: e0785ea4f2926f944ff4d65a96cee05b6dcdb792
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/21/2020
ms.locfileid: "88706070"
---
# <a name="outbound-connections-in-azure"></a>Исходящие подключения в Azure

Azure Load Balancer предоставляет исходящие подключения с помощью различных механизмов. В этой статье описываются сценарии и способы управления ими. Если у вас возникают проблемы с исходящим подключением через Azure Load Balancer, см. [руководство по устранению неполадок для исходящих подключений](../load-balancer/troubleshoot-outbound-connection.md).

>[!NOTE]
>В этой статье рассматриваются диспетчер ресурсов развертывания. Корпорация Майкрософт рекомендует диспетчер ресурсов для рабочих нагрузок.

## <a name="terminology"></a>Терминология

| Термин | Применимые протоколы | Подробности|
| ---------|---------| -------|
| Преобразование адресов исходной сети (SNAT) | TCP, UDP | Развертывания в Azure могут взаимодействовать с конечными точками за пределами Azure в пространстве общедоступных IP-адресов. Когда экземпляр инициирует исходящий поток к месту назначения в пространстве общедоступных IP-адресов, Azure динамически сопоставляет частный IP-адрес виртуальной машины с общедоступным IP-адресом. После создания этого сопоставления обратный трафик исходящего потока можно также направлять по частному IP-адресу, с которого изначально отправлен поток. Azure использует **преобразование адресов исходной сети (SNAT)** для выполнения этой функции.|
| SNAT с маскировкой портов (PAT)| TCP, UDP |  Если несколько частных IP-адресов маскируются под одним общедоступным IP-адресом, Azure использует **преобразование адресов портов (PAT)** для маскировки или скрытия частных IP-адресов. Для PAT используются временные порты, которые [предварительно выделяются](#preallocatedports) в зависимости от размера пула. Когда общедоступный ресурс Load Balancer связан с экземплярами виртуальной машины, которым не назначены выделенные общедоступные IP-адреса, источник каждого исходящего подключения перезаписывается. Источник перезаписывается из частного IP-адреса виртуальной сети в общедоступный IP-адрес внешнего интерфейса Load Balancer. В пространстве общедоступных IP-адресов поток из 5 кортежей (исходного IP-адреса, исходного порта, транспортного IP-протокола, конечного IP-адреса, конечного порта) должен быть уникальным. SNAT, маскирующий порты, может использоваться с протоколами TCP или UDP IP. Для обеспечения этого используются временные порты (порты SNAT) после перезаписи частного исходного IP-адреса, так как из одного общедоступного IP-адреса исходят несколько потоков. Алгоритм SNAT, маскирующий порт, распределяет SNAT-порты по-разному для UDP и TCP.|
| Порты SNAT| TCP | Порты SNAT — это временные порты, доступные для конкретного общедоступного исходного IP-адреса. Для одного потока к конечному IP-адресу используется один порт SNAT. При наличии нескольких потоков TCP к одним и тем же конечным IP-адресу, порту и протоколу каждый поток TCP использует отдельный порт SNAT. Это гарантирует уникальность потоков, отправляемых с одного и того же общедоступного IP-адреса к одним и тем же конечным IP-адресу, порту и протоколу. Несколько потоков, каждый из которых направляется к разным конечным IP-адресу, порту и протоколу, используют отдельный порт SNAT. Конечный IP-адрес, порт и протокол делают потоки уникальными, устраняя необходимость в дополнительных портах источника, чтобы различать потоки в пространстве общедоступных IP-адресов.|
|Порты SNAT | UDP | Для управления портами SNAT UDP и SNAT TCP используются разные алгоритмы.  Load Balancer использует алгоритм, известный как "конусный NAT с ограниченным числом портов" для UDP.  Один порт SNAT используется для каждого потока независимо от порта IP-адреса назначения.|
| Исчерпание | - | Если ресурс портов SNAT исчерпан, исходящие потоки прекращаются, пока имеющиеся потоки не освободят порты SNAT. Когда поток закрывается, подсистема балансировки нагрузки освобождает порты SNAT. Для их освобождения от простаивающих потоков используется [4-минутный период ожидания простоя](../load-balancer/troubleshoot-outbound-connection.md#idletimeout). Порты SNAT для UDP исчерпываются обычно гораздо быстрее, чем порты SNAT для TCP из-за разницы в алгоритме использования. Вы должны проектировать и масштабировать тест с учетом этой разницы.|
| Поведение при выпуске порта SNAT | TCP | Если клиент или сервер отправляют флажки FIN и ACK, порт SNAT освобождается через 240 секунд. Если получен сегмент с флагом RST, порт SNAT освобождается через 15 секунд. При достижении времени ожидания простоя порт освобождается.|
| Поведение при выпуске порта SNAT | UDP |При достижении времени ожидания простоя порт освобождается.|
| Повторное использование порта SNAT | TCP, UDP | После освобождения порта он доступен для повторного использования по мере необходимости.  Порты SNAT можно рассматривать как последовательность от наименьшего до наибольшего, доступную для данного сценария, и для новых подключений используется первый доступный порт SNAT.|

### <a name="port-allocation-algorithm"></a><a name="preallocatedports"></a>Алгоритм выделения портов

Azure использует алгоритм для определения количества предварительно выданных портов SNAT, доступных в зависимости от размера внутреннего пула при использовании PAT. Для каждого общедоступного IP-адреса, связанного с подсистемой балансировки нагрузки, в качестве портов SNAT для каждого транспортного протокола IP доступны 64 000 портов. Для UDP и TCP заранее выделяется одинаковое число портов SNAT. Они потребляются независимо для каждого транспортного протокола IP.  Однако использование порта SNAT различается в зависимости от того, передается ли поток по протоколу UDP или TCP. При создании исходящих потоков эти порты потребляются динамически (вплоть до предельного выделения) и освобождаются, когда происходит закрытие потока или истечение [времени ожидания простоя](../load-balancer/troubleshoot-outbound-connection.md#idletimeout) . Порты используются, только если это необходимо, чтобы сделать поток уникальным.

#### <a name="default-snat-ports-allocated"></a><a name="snatporttable"></a> Порты SNAT по умолчанию выделены

В таблице ниже указаны предварительно выделяемые порты SNAT для уровней размера внутреннего пула.

| Размер пула (экземпляры виртуальных машин) | Предварительно выделяемые порты SNAT на каждую конфигурацию IP-адресов |
| --- | --- |
| 1–50 | 1024 |
| 51–100 | 512 |
| 101–200 | 256 |
| 201–400 | 128 |
| 401–800 | 64 |
| 801–1000 | 32 |

Изменение размера серверного пула может повлиять на некоторые из установленных потоков:

- Если размер внутреннего пула увеличивается и он переходит на следующий уровень. Половина предварительно выделенных портов освобождается при переходе. Время ожидания потоков, связанных с освобожденным портом SNAT, истечет, и их нужно будет отправить повторно. Если предварительно выделенные порты доступны, новые потоки сразу успешно передаются.
- Если размер серверного пула уменьшается с размера одного уровня до следующего размера, количество доступных портов SNAT растет. В этом случае имеющиеся выделенные порты SNAT и их потоки не будут затронуты.

## <a name="outbound-connections-scenario-overview"></a><a name="scenarios"></a>Обзор сценария исходящих подключений

| Сценарий | Метод | Протоколы IP | Описание |
|  --- | --- | --- | --- |
|  1. Виртуальная машина с общедоступным IP-адресом (с Azure Load Balancer или без них | SNAT, маскировка портов не используется | TCP, UDP, ICMP, ESP | Azure использует общедоступный IP-адрес, назначенный IP-конфигурации сетевого адаптера экземпляра для всех исходящих потоков. Доступны все временные порты экземпляра. Не имеет значения, сбалансирована ли виртуальная машина. Этот сценарий приоритетнее остальных. Общедоступный IP-адрес назначается виртуальной машине в соотношении "один к одному" (а не "один ко многим") через NAT типа "один к одному" без отслеживания состояния. |
| 2. общедоступные Load Balancer, связанные с виртуальной машиной (без общедоступного IP-адреса на виртуальной машине или экземпляре) | SNAT с маскировкой портов (PAT) с использованием подсистем балансировки нагрузки | TCP, UDP | В этом сценарии ресурс Load Balancer должен быть настроен с помощью правила подсистемы балансировки нагрузки для создания связи между общедоступным IP-интерфейсом и внутренним пулом. Если вы не завершите эту конфигурацию правила, поведение будет описано в сценарии 3. Для правильной работы правила не обязательно, чтобы был прослушиватель во внутреннем пуле для успешной проверки работоспособности. Когда виртуальная машина создает исходящий поток, Azure преобразует частный исходный IP-адрес исходящего потока в общедоступный IP-адрес общедоступного Load Balancer внешнего интерфейса через SNAT. Временные порты внешнего общедоступного IP-адреса балансировщика нагрузки используются для различения отдельных потоков, исходящих от виртуальной машины. При создании исходящих потоков в ходе SNAT динамически используются [предварительно выделенные временные порты](#preallocatedports). В этом контексте временные порты, используемые для SNAT, называются портами SNAT. Порты SNAT предварительно выделяются, как описано в [таблице выделенные порты SNAT по умолчанию](#snatporttable). |
| 3. VM (без Load Balancer, без общедоступных IP-адресов) или виртуальной машины, связанной с базовым внутренним Load Balancer | SNAT с маскировкой портов (PAT) | TCP, UDP | Когда виртуальная машина создает исходящий поток, Azure преобразует частный исходный IP-адрес исходящего потока в общедоступный исходный IP-адрес. Этот общедоступный IP-адрес **не настраивается**, не может быть зарезервирован и не учитывается в ограничении ресурсов общедоступного IP-адреса подписки. При повторном развертывании виртуальной машины или набора доступности, либо масштабируемого набора виртуальных машин этот публичный IP-адрес будет выпущен и появится запрос на новый публичный IP-адрес. Не используйте этот сценарий для списка разрешенных IP-адресов. Вместо этого используйте сценарий 1 или 2, где явно объявляется поведение исходящего трафика. Порты SNAT предварительно выделяются, как описано в [таблице выделенные порты SNAT по умолчанию](#snatporttable).

## <a name="outbound-rules"></a><a name="outboundrules"></a>Правила исходящего трафика

 С помощью правил для исходящего трафика можно легко настроить общедоступное исходящее преобразование сетевых адресов (NAT) [Load Balancer (цен. категория "Стандартный")](load-balancer-standard-overview.md).  Вы получаете полный декларативный контроль над исходящим подключением для масштабирования и настройки этой возможности в соответствии с определенными потребностями. Этот раздел разворачивает сценарий 2 (B), описанный выше.

![Правила для исходящего трафика Load Balancer](media/load-balancer-outbound-rules-overview/load-balancer-outbound-rules.png)

С помощью правил исходящего трафика можно использовать Load Balancer для определения исходящего NAT с нуля. Можно также масштабировать и настраивать поведение существующего исходящего NAT.

Правила для исходящего трафика позволяют управлять следующим:

- тем, какие виртуальные машины нужно преобразовать в определенные общедоступные IP-адреса;
- как распределить исходящие порты SNAT;
- для каких протоколов обеспечить исходящее преобразование;
- какую длительность использовать для времени ожидания перед переходом в режим простоя для исходящего подключения (от 4 до 120 минут);
- следует ли отправить сброс TCP при превышении времени ожидания простоя
- протоколы транспорта TCP и UDP с одним правилом

### <a name="outbound-rule-definition"></a>Определение правила для исходящего трафика

Как и все правила Load Balancer, исходящие правила следуют тем же знакомому синтаксису, что и правила балансировки нагрузки и входящего трафика NAT: **интерфейсный**  +  **parameters**  +  **Пул внутренних**параметров. Правило для исходящего трафика настраивает NAT для исходящего трафика, предусматривающее преобразование _всех виртуальных машин, определенных с помощью серверного пула_, во _внешний интерфейс_.  _Параметры_ обеспечивают дополнительный детализированный контроль над алгоритмом исходящего трафика NAT.

### <a name="scale-outbound-nat-with-multiple-ip-addresses"></a><a name="scale"></a> Масштабирование NAT для исходящего трафика при использовании нескольких IP-адресов

Каждый дополнительный IP-адрес, предоставляемый интерфейсом, предоставляет дополнительные 64 000 временных портов для Load Balancer для использования в качестве портов SNAT. Вы можете использовать несколько IP-адресов для планирования крупномасштабных сценариев, а также применять правила для исходящего трафика для обхода шаблонов, подверженных [нехватке SNAT](troubleshoot-outbound-connection.md#snatexhaust).  

[Префикс общедоступного IP-адреса](https://aka.ms/lbpublicipprefix) можно также использовать непосредственно с исходящим правилом.  Использование префикса IP-адреса упрощает масштабирование и добавление в список разрешений потоков, которые поступают из развертывания Azure. Вы можете настроить внешнюю IP-конфигурацию в ресурсе Load Balancer, чтобы напрямую ссылаться на префикс общедоступного IP-адреса.  Это обеспечивает отдельный контроль Load Balancer над префиксом общедоступного IP-адреса, а правило для исходящего трафика будет автоматически использовать все общедоступные IP-адреса, содержащиеся в префиксе общедоступного IP-адреса, для исходящих подключений.  Каждый IP-адрес в пределах префикса общедоступного IP-адреса предоставляет дополнительные 64 000 временных портов для каждого IP-адреса Load Balancer для использования в качестве портов SNAT.

### <a name="outbound-flow-idle-timeout-and-tcp-reset"></a><a name="idletimeout"></a> Тайм-аут простоя исходящего потока и сброс TCP

Правила для исходящего трафика обеспечивают параметр конфигурации для управления временем ожидания перед переходом исходящего потока в режим простоя и сопоставляют его с потребностями приложения. По умолчанию время ожидания перед переходом исходящего потока в режим простоя составляет 4 минуты. Вы можете научиться [настраивать время ожидания простоя](load-balancer-tcp-idle-timeout.md#tcp-idle-timeout). Поведение по умолчанию Load Balancer заключается в том, чтобы автоматически отключить поток по истечении времени ожидания перехода в режим простоя для исходящего потока.  С помощью `enableTCPReset` параметра можно включить более предсказуемое поведение приложения и указать, следует ли отсылать ДВУНАПРАВЛЕННЫЙ TCP Reset (TCP RST) во время истечения времени ожидания простоя исходящего трафика. Чтобы получить сведения о доступности региона, проверьте [Сброс TCP на время ожидания простоя](https://aka.ms/lbtcpreset) .

### <a name="preventing-outbound-connectivity"></a><a name="preventoutbound"></a>Запрет исходящих подключений

Правила балансировки нагрузки обеспечивают автоматическое программирование исходящего NAT. Однако некоторые сценарии включают преимущества или требуют отключить автоматическое программирование NAT для исходящего трафика с помощью правила балансировки нагрузки, чтобы вы могли управлять поведением или настраивать его.  
Этот параметр можно использовать двумя способами:

1. Необязательное подавление использования входящего IP-адреса для исходящей SNAT с помощью отключения исходящей SNAT для правила балансировки нагрузки
  
2. Настройте параметры исходящего трафика SNAT для IP-адреса, используемого для входящих и исходящих подключений одновременно.  Автоматическое программирование NAT для исходящего трафика должно быть отключено, чтобы предоставить управление правилу для исходящего трафика.  Например, чтобы изменить распределение портов SNAT для адреса, также используемого для входящего трафика, `disableOutboundSnat` параметр должен иметь значение true.  Если вы попытаетесь использовать правило для исходящего трафика для переопределения параметров IP-адреса, также используемого для входящего трафика, без использования программирования NAT для исходящего трафика правила балансировки нагрузки, операция по настройке правила для исходящего трафика завершится сбоем.

>[!IMPORTANT]
> Виртуальная машина не будет иметь исходящего подключения, если для этого параметра задано значение true и отсутствует правило исходящего трафика для определения исходящих подключений.  Некоторые операции на виртуальной машине или в приложении могут зависеть от доступности исходящего подключения. Ознакомьтесь с зависимостями сценария и проанализируйте влияние этого изменения.

Иногда создание виртуальной машиной исходящих потоков может быть нежелательным. Кроме того, вам может понадобиться ограничить пункты назначения, доступные для исходящих потоков или назначений, инициирующих входящие потоки. В таком случае можно использовать [группы безопасности сети](../virtual-network/security-overview.md), чтобы управлять пунктами назначений, доступными для виртуальной машины. Кроме того, с их помощью можно выбирать общедоступные назначения, способные инициировать входящие потоки.

При использовании NSG для виртуальной машины с балансировкой нагрузки обратите внимание на [теги службы](../virtual-network/security-overview.md#service-tags) и [правила безопасности по умолчанию](../virtual-network/security-overview.md#default-security-rules). Следует убедиться, что виртуальная машина может получать запросы проверки состояния работоспособности из Azure Load Balancer.

Если NSG блокирует такие запросы от тега по умолчанию AZURE_LOADBALANCER, запрос завершается сбоем, а виртуальная машина помечается как отключенная. Подсистема балансировки нагрузки прекращает отправку новых потоков на эту виртуальную машину.

## <a name="scenarios-with-outbound-rules"></a>Сценарии с правилами исходящего трафика

| # | Сценарий| Подробности|
|---|---|---|
| I |  Оптимизация исходящих подключений для определенного набора общедоступных IP-адресов| Вы можете использовать правило для исходящего трафика, разрешающее принятие исходящих подключений из определенного набора общедоступных IP-адресов, чтобы упростить сценарии со списком разрешений.  Общедоступный IP-адрес источника может быть IP-адресом, который используется правилом балансировки нагрузки, или другим набором общедоступных IP-адресов.  1. Создание [префикса общедоступного IP-](https://aka.ms/lbpublicipprefix) адреса (или общедоступных IP-адресов из префикса общедоступного IP) 2 Создайте общедоступный Load Balancer (цен. категория "Стандартный") 3. Создание интерфейсов, ссылающихся на общедоступный IP-адрес (или общедоступные IP-адреса), который вы хотите использовать 4. Повторно используйте серверный пул или создайте внутренний пул и поместите виртуальные машины в серверный пул общедоступного Load Balancer 5. Настройте правило исходящего трафика для общедоступной Load Balancer, чтобы программировать исходящие NAT для этих виртуальных машин с помощью интерфейсов. Если вы не хотите, чтобы правило балансировки нагрузки использовалось для исходящих подключений, вам необходимо отключить исходящие SNAT-подключения в правиле балансировки нагрузки.
| II |  Изменение распределения портов SNAT| Вы можете использовать правила для исходящего трафика, чтобы настроить [автоматическое распределение SNAT-портов на основе размера серверного пула](load-balancer-outbound-connections.md#preallocatedports). Например, если у вас есть две виртуальные машины, совместно использующие один общедоступный IP-адрес NAT для исходящего трафика, вы можете увеличить количество портов SNAT, выделенных из 1024 портов по умолчанию, в случае нехватки SNAT. Каждый общедоступный IP-адрес может принимать участие в работе до 64 000 эфемерных портов.  Если вы настроите правило для исходящего трафика с внешним интерфейсом единого общедоступного IP-адреса, вы можете распределить в целом 64 000 портов SNAT для виртуальных машин в серверном пуле.  Для двух виртуальных машин с помощью правила для исходящего трафика можно выделить максимум 32 000 портов SNAT (2 x 32 000 = 64 000). Для настройки портов SNAT, выделенных по умолчанию, можно использовать правила для исходящего трафика. Вы выделяете больше или меньше, чем выделение портов SNAT по умолчанию. Каждый общедоступный IP-адрес всех интерфейсов правила исходящего трафика составляет до 64 000 временных портов для использования в качестве портов SNAT.  Load Balancer выделяет порты SNAT в количестве, кратном 8. Если вы предоставляете значение, которое не делится на 8, операция конфигурации будет отклонена.  Если вы попытаетесь выделить больше портов SNAT, чем доступно на основе количества общедоступных IP-адресов, операция конфигурации будет отклонена.  Например, если вы выделили 10 000 портов на каждую виртуальную машину, а 7 виртуальных машин в серверном пуле будут совместно использовать один общедоступный IP-адрес, конфигурация отклоняется (7 x 10 000 портов SNAT > 64 000 портов SNAT).  Для реализации этого сценария можно добавить больше общедоступных IP-адресов во внешний интерфейс правила для исходящего трафика. Можно вернуться к [выделению портов SNAT по умолчанию на основе размера внутреннего пула](load-balancer-outbound-connections.md#preallocatedports) , указав 0 для параметра число портов. В этом случае первые 50 экземпляров виртуальных машин получат порты 1024, 51-100 экземпляры виртуальных машин будут получать 512 и т. д. в соответствии с [таблицей](#snatporttable).|
| РРР|  Включение только NAT для исходящего трафика | Вы можете использовать общедоступный Load Balancer (цен. категория "Стандартный"), чтобы обеспечить NAT для исходящего трафика для группы виртуальных машин. В этом случае вы можете использовать только правило для исходящего трафика без какой-либо необходимости в дополнительных правилах.|
| IV | NAT для исходящего трафика только для виртуальных машин (без входящего трафика) | Определите общедоступный Load Balancer (цен. категория "Стандартный"), разместите виртуальные машины в серверный пул и настройте правило для исходящего трафика для программирования NAT для исходящего трафика и принятие исходящих подключений из определенного общедоступного IP-адреса. Вы также можете использовать префикс общедоступного IP-адреса, чтобы упростить размещение источника исходящих подключений в списке разрешений. 1. Создайте общедоступный Load Balancer (цен. категория "Стандартный"). 2. Создайте серверный пул и разместите в этом пуле общедоступного Load Balancer виртуальные машины. 3. Настройте в общедоступном Load Balancer правило для исходящего трафика, позволяющее программно управлять NAT для исходящего трафика этих виртуальных машин.
| V| NAT для исходящего трафика для внутренних сценариев Load Balancer (цен. категория "Стандартный")| При использовании внутреннего Load Balancer (цен. категория "Стандартный") NAT для исходящего трафика недоступно, пока явным образом не объявлено исходящее подключение. Вы можете определить исходящее подключение с помощью правила исходящего трафика, чтобы создать исходящее подключение для виртуальных машин за внутренним Load Balancer (цен. категория "Стандартный"), выполнив следующие действия: 1. Создайте общедоступный Load Balancer (цен. категория "Стандартный"). 2. Создайте серверный пул и в дополнение к внутреннему Load Balancer поместите виртуальные машины в серверный пул общедоступного Load Balancer. 3. Настройте в общедоступном Load Balancer правило для исходящего трафика, позволяющее программно управлять NAT для исходящего трафика этих виртуальных машин. Дополнительные сведения об этом сценарии см. в [этом примере](https://docs.microsoft.com/azure/load-balancer/egress-only). |
| VI | Включение протоколов TCP и UDP для NAT для исходящего трафика при использовании общедоступного Load Balancer (цен. категория "Стандартный") | При использовании общедоступного Load Balancer (цен. категория "Стандартный") предоставленное автоматическое программирование NAT для исходящего трафика сопоставляет транспортный протокол правила балансировки нагрузки. 1. Отключите исходящие SNAT-подключения в правиле балансировки нагрузки. 2. Настройте правило для исходящего трафика в одной подсистеме Load Balancer. 3. Повторно используйте серверный пул, который уже использовался для виртуальных машин. 4. Укажите для протокола значение "Все" как часть правила для исходящего трафика. Если используются только правила NAT для входящего трафика, NAT для исходящего трафика обеспечиваться не будет. 1. Поместите виртуальные машины в серверный пул. 2. Определите одну или несколько конфигураций интерфейсных IP-адресов с общедоступными IP-адресами или префиксом общедоступного IP-адреса 3. Настройте правило для исходящего трафика в одной подсистеме Load Balancer. 4. Укажите для протокола значение "Все" как часть правила для исходящего трафика. |


## <a name="limitations"></a>Ограничения

- Максимальное количество используемых эфемерных портов на один интерфейсный IP-адрес составляет 64 000.
- Диапазон настраиваемого времени ожидания перед переходом исходящих подключений в режим простоя составляет 4–120 минут (240–7200 секунд).
- Load Balancer не поддерживает ICMP для NAT для исходящего трафика.
- Правила исходящего трафика могут применяться только к основной IP-конфигурации сетевого адаптера.  Невозможно создать правило исходящего трафика для вторичного IP-адреса виртуальной машины или NVA. Поддерживается несколько сетевых карт.
- Рабочие веб-роли без виртуальной сети и другие службы платформы Майкрософт могут быть доступны при использовании только внутренней подсистемы Load Balancer уровня "Стандартный" из-за побочного эффекта от того, как работают службы, созданные до использования виртуальной сети, и другие функции служб платформы. Не рассчитывайте на этот побочный эффект, так как соответствующая служба или базовая платформа могут измениться без уведомления. Вы всегда должны предполагать, что вам при необходимости нужно явно создать исходящее подключение при использовании только Load Balancer уровня "Стандартный". Сценарий 3, описанный в этой статье, недоступен.

## <a name="next-steps"></a>Дальнейшие действия

- Узнайте больше об [Azure Load Balancer уровня "Стандартный"](load-balancer-standard-overview.md).
- См. Ответы на [часто задаваемые вопросы о Azure Load Balancer](load-balancer-faqs.md).
- Дополнительные сведения о [правилах для исходящего трафика](load-balancer-outbound-rules-overview.md) для общедоступного Load Balancer категории "Стандартный".
- [Обзор Azure Load Balancer](load-balancer-overview.md)
- Дополнительные сведения о группах безопасности сети см. в статье [Фильтрация сетевого трафика с помощью групп безопасности сети](../virtual-network/security-overview.md).
- Дополнительные сведения о некоторых других ключевых [сетевых возможностях](../networking/networking-overview.md) Azure.
