---
title: Load Balancer ценовой категории "Стандартный" и зоны доступности
titleSuffix: Azure Load Balancer
description: По этой схеме обучения приступайте к работе с Azure Load Balancer (цен. категория "Стандартный") и Зоны доступности.
services: load-balancer
documentationcenter: na
author: asudbring
ms.custom: seodec18
ms.service: load-balancer
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 05/07/2020
ms.author: allensu
ms.openlocfilehash: 6deb5714a43d61f5ceb793757d49bd099f09f2b7
ms.sourcegitcommit: 999ccaf74347605e32505cbcfd6121163560a4ae
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/08/2020
ms.locfileid: "82977666"
---
# <a name="standard-load-balancer-and-availability-zones"></a>Azure Load Balancer ценовой категории "Стандартный" и зоны доступности

Azure Load Balancer (цен. категория "Стандартный") поддерживает сценарии зон доступности. Вы можете использовать стандартную подсистему балансировки нагрузки для повышения доступности по всему сценарию путем согласования ресурсов с и распределения по зонам. Зоны доступности в сочетании с подсистемой балансировки нагрузки "Стандартный" являются обширным и гибким набором функций, который может создавать множество различных сценариев.  Просмотрите этот документ, чтобы получить представление об этих [понятиях](#concepts) и [руководство по разработке](#design) основного сценария.

## <a name="availability-zones-concepts-applied-to-load-balancer"></a><a name="concepts"></a> Концепции зон доступности, применимые к Load Balancer

Подсистема балансировки нагрузки наследует конфигурацию зоны от ее компонентов: 

* Внешний интерфейс
* Правила
* Определение серверного пула

В контексте зон доступности поведение и свойства правила балансировщика нагрузки описаны как избыточные в рамках зоны или зональные.  В контексте балансировщика нагрузки избыточность в зонах всегда означает, что **несколько зон** и зональные означают изоляцию службы в **одной зоне**. Azure Load Balancer имеет два типа: public и internal. Оба типа балансировщика нагрузки поддерживают избыточность зоны и зональные развертывание.  Оба типа подсистемы балансировки нагрузки могут направлять трафик между зонами по мере необходимости.

## <a name="frontend"></a>Внешний интерфейс

Интерфейсная подсистема балансировки нагрузки — это внешняя IP-конфигурация, ссылающаяся на общедоступный IP-адрес или частный IP-адрес в подсети виртуальной сети. Он формирует конечную точку с балансировкой нагрузки, где предоставляется ваша служба.

Ресурс балансировщика нагрузки может содержать правила с зональные и внешними интерфейсами, избыточными в зонах одновременно. Если для зоны гарантируется общедоступный или частный IP-адрес, зональность (или его отсутствие) нельзя изменить. Чтобы изменить или опустить зональность для внешнего или частного IP-адреса, повторно создайте IP-адрес в соответствующей зоне. 

Зоны доступности не изменяют ограничения для нескольких внешних интерфейсов. Дополнительные сведения об этой возможности см. в [Load Balancer нескольких внешних интерфейсов](load-balancer-multivip-overview.md) .

### <a name="zone-redundant"></a>Избыточное в пределах зоны 

В регионе с зонами доступности стандартный интерфейс балансировщика нагрузки может быть избыточным в пределах зоны. Несколько зон могут обслуживать входящий или исходящий трафик в регионе. Этот трафик обслуживается одним IP-адресом. Схемы избыточности DNS не являются обязательными. 

Один интерфейсный IP-адрес будет выдерживаться при сбое зоны. Интерфейсный IP-адрес может использоваться для доступа ко всем (не затронутым) членам внутреннего пула вне зоны. Одна или несколько зон доступности могут завершиться ошибкой, и путь к данным останется в рабочем состоянии, если одна зона в регионе остается работоспособной. 

IP-адрес внешнего интерфейса обрабатывается одновременно несколькими независимыми развертываниями инфраструктуры в нескольких зонах доступности. Любые повторные попытки или повторное выполнение будут успешно выполнены в других зонах, не затронутых сбоем зоны. 

:::image type="content" source="./media/az-zonal/zone-redundant-lb-1.svg" alt-text="Избыточное в пределах зоны" border="true":::

*Рисунок. Подсистема балансировки нагрузки с избыточностью зоны*

### <a name="zonal"></a>Зональные

Вы можете гарантировать внешний интерфейс одной зоне, что называется *зональным внешним интерфейсом*.  Этот сценарий означает, что любой входящий или исходящий поток обслуживается одной зоной в регионе.  Ваш внешний интерфейс разделяет работоспособность зоны.  На путь к данным не оказывают влияние сбои в зонах за исключением случаев, где это гарантировано. Зональные внешние интерфейсы можно использовать для предоставления IP-адреса каждой зоне доступности.  

Кроме того, поддерживается использование интерфейсов зональные непосредственно для конечных точек с балансировкой нагрузки в пределах каждой зоны. Эту конфигурацию можно использовать для предоставления конечным точкам с балансировкой нагрузки каждой зоны для индивидуального мониторинга каждой зоны. Для общедоступных конечных точек их можно интегрировать с продуктом балансировки нагрузки DNS, например [диспетчером трафика](../traffic-manager/traffic-manager-overview.md) , и использовать одно DNS-имя.

:::image type="content" source="./media/az-zonal/zonal-lb-1.svg" alt-text="Избыточное в пределах зоны" border="true":::

Если вы хотите использовать эти концепции совместно (избыточные между зонами и зональные для одной и той же серверной части), см. [этот документ](load-balancer-multivip-overview.md).

Для внешнего интерфейса общедоступной подсистемы балансировки нагрузки необходимо добавить параметр **Zones** в общедоступный IP-адрес. На этот общедоступный IP-адрес ссылается конфигурация интерфейсной IP-конфигурации, используемая соответствующим правилом.

Для внешнего интерфейса внутренней подсистемы балансировки нагрузки добавьте параметр **Zones** во внутреннюю IP-конфигурацию внутренней подсистемы балансировки нагрузки. Интерфейс зональные гарантирует IP-адрес в подсети для определенной зоны.

## <a name="backend"></a>Серверная часть

Azure Load Balancer работает с экземплярами виртуальных машин. Эти экземпляры могут быть автономными, группами доступности или масштабируемыми наборами виртуальных машин. Любая виртуальная машина в одной виртуальной сети может быть частью внутреннего пула, любой зоны, которой гарантируется виртуальная машина.

Чтобы выстроить и гарантировать внешний интерфейс и серверную часть с одной зоной, разместите виртуальные машины в пределах одной зоны в соответствующем внутреннем пуле.

Для адресации виртуальных машин в нескольких зонах размещайте виртуальные машины из нескольких зон в один серверный пул. 

При использовании масштабируемых наборов виртуальных машин разместите один или несколько масштабируемых наборов виртуальных машин в одном серверном пуле. Масштабируемые наборы могут находиться в одной или нескольких зонах.

## <a name="outbound-connections"></a>Исходящие подключения

Избыточные в зонах и зональные применяются к [исходящим подключениям](load-balancer-outbound-connections.md). Общедоступный IP-адрес, избыточный в виде зоны, используемый для исходящих соединений, обслуживается всеми зонами. Общедоступный IP-адрес зональные обслуживается только зоной, в которой он гарантирован. 

Выделение портов SNAT исходящего подключения не позволяет выдерживать сбои зоны, и ваш сценарий продолжит предоставлять исходящие подключения SNAT, если это не повлияет на сбой зоны. Если трафик был обслужен затронутой зоной, сбои зоны могут потребовать восстановления соединения для сценариев, избыточных в зоне. Потоки в зонах, отличных от затронутых зон, не затрагиваются.

Алгоритм предварительного выделения портов SNAT аналогичен и без зон доступности.

## <a name="health-probes"></a>Пробы работоспособности

Существующие определения проверки работоспособности остаются без зон доступности. Однако мы расширили модель работоспособности на уровне инфраструктуры. 

При использовании внешних интерфейсов, избыточных в зонах, балансировщик нагрузки расширяет свою внутреннюю проверку работоспособности. Подсистема балансировки нагрузки независимо проверяет доступность виртуальной машины из каждой зоны и завершает работу путей в зонах, которые завершились сбоем без вмешательства пользователя.  

Другие зоны, которые могут достичь этой виртуальной машины, могут продолжать обслуживать виртуальную машину из своих соответствующих внешних интерфейсов. Во время событий сбоя каждая зона может иметь разные распределения новых потоков, одновременно защищая общую работоспособность службы.

## <a name="design-considerations"></a><a name="design"></a>Рекомендации по проектированию

Подсистема балансировки нагрузки является гибкой в контексте зон доступности. Для каждого правила можно выполнить выровняйте по зонам или использовать избыточность в виде зоны. Повышение уровня доступности может быть выгодно за счет повышения сложности. Проектирование для обеспечения доступности для оптимальной производительности.

### <a name="automatic-zone-redundancy"></a>Автоматическая избыточность в пределах зоны

С помощью Load Balancer можно использовать всего один IP-адрес в качестве внешнего интерфейса, избыточного между зонами. Избыточный в зоне IP-адрес может обслуживать ресурс зональные в любой зоне.  IP-адрес может содержаться в одном или нескольких сбоях зоны, если одна зона остается работоспособной в пределах региона.  Вместо этого зональныеный интерфейс — это сокращение службы на единую зону и совместное судьба с соответствующей зоной.

Избыточность в зоне не подразумевает хитлесс путь или плоскость управления. это плоскость данных. Избыточные между зонами потоки могут использовать любые зоны, а потоки клиента будут использовать все работоспособные зоны в регионе. В случае сбоя в зоне потоки трафика, использующие работоспособные зоны, не затрагиваются. 

Потоки трафика, использующие зону во время сбоя зоны, могут быть затронуты, но приложения могут быть восстановлены. Трафик переходит в работоспособные зоны в пределах региона после повторной передачи, когда Azure выполнил схождение по причине сбоя зоны.

### <a name="cross-zone-boundaries"></a><a name="xzonedesign"></a> Границы между зонами

Важно понимать, что всякий раз, когда служба пересекает зоны, вы предоставляете общий доступ к судьба с помощью не одной зоны, но даже нескольких зон. В результате служба не сможет получить доступ к зональные развертываниям.

Старайтесь не использовать нежелательные зависимости между зонами, что будет аннулируются с ростом доступности при использовании зон доступности. Если приложение содержит несколько критически важных компонентов, убедитесь в наличии сбоя в зоне.

Один важный компонент приложения может повлиять на приложение целиком, если оно существует только в зоне, отличной от зоны. Рассмотрите возможность восстановления зоны и того, как ваше приложение сходится. Узнайте, как приложение реагирует на сбои частей ИТ. Изучите ключевые моменты и используйте их для вопросов, когда вы думаете о вашем конкретном сценарии.

- Если приложение содержит два компонента:

    * IP-адрес
    * Виртуальная машина с управляемым диском

Они настроены в зоне 1 и зоне 2. При сбое зоны 1 служба не сохранятся. Не следует пересекать зоны с зональные сценариями, если вы не знаете полное представление о создании потенциально опасного режима сбоя. Этот сценарий может обеспечить гибкость.

- Если приложение содержит два компонента:

    * IP-адрес
    * Виртуальная машина с управляемым диском

Они настроены для резервирования на уровне зоны и зоны 1. Служба будет выдерживать сбой зоны 2, зоны 3 или и то, и другое, если только зона 1 не была выполнена. Однако вы теряете некоторые возможности по поводу работоспособности службы, если все, что вы пройдете, является достижимостью внешнего интерфейса.  Рассмотрите возможность разработки более сложной модели работоспособности и производительности.  Чтобы получить больше информации и расширить возможности управляемости, концепции избыточности между зонами и зональности можно использовать совместно.

- Если приложение содержит два компонента:

    * Внешний интерфейс балансировщика нагрузки с избыточностью зоны
    * Масштабируемый набор виртуальных машин между зонами в трех зонах

Ресурсы в зонах, на которые не влияет сбой, будут доступны. При сбое производительность службы может снизиться. С точки зрения инфраструктуры развертывание может содержаться в одном или нескольких сбоях зоны. Этот сценарий вызывает следующие вопросы.

  - Вы понимаете, как ваше приложение реагирует на сбои и снижает емкость?
  - Необходимо ли вам принять меры безопасности в службе, чтобы принудительно выполнить отработку отказа в пару регионов при необходимости?
  - Каким образом вы будете отслеживать, обнаруживать и избегать такую ситуацию? Для дополнительного мониторинга производительности службы можно использовать диагностику стандартной подсистемы балансировки нагрузки. Оцените доступные возможности и то, что может потребовать приращения.

- Зоны помогут упростить распознавание сбоев. Сбой зоны отличается от других сбоев, когда происходит время ожидания, повторные попытки и алгоритмы отхода. Azure Load Balancer предоставляет пути, избыточные в виде зоны. Подсистема балансировки нагрузки пытается быстро восстановиться на уровне пакетов в режиме реального времени. Повторная передача или восстановление может произойти в течение SES сбоя. Важно понимать, как ваше приложение может справиться со сбоями. Схема балансировки нагрузки будет содержаться, но необходимо спланировать следующие вопросы:

  - В случае сбоя зоны служба понимает этот сбой и, если состояние потеряно, как будет выполнено восстановление?
  - При возврате из зоны понимает ли приложение, как безопасно выполнить объединение?

Ознакомьтесь с [шаблонами разработки облачных служб Azure](https://docs.microsoft.com/azure/architecture/patterns/) , чтобы повысить устойчивость приложения к сценариям сбоя.

## <a name="next-steps"></a>Дальнейшие действия
- Дополнительные сведения о [зоны доступности](../availability-zones/az-overview.md)
- Дополнительные сведения о [Load Balancer (цен. Категория "Стандартный")](load-balancer-standard-overview.md)
- Узнайте, как [распределять нагрузку виртуальных машин в рамках зоны с помощью Load Balancer уровня "Стандартный" с зональным внешним интерфейсом](load-balancer-standard-public-zonal-cli.md).
- Узнайте, как [распределять нагрузку виртуальных машин по зонам с помощью Load Balancer уровня "Стандартный" с избыточным между зонами интерфейсным сервером](load-balancer-standard-public-zone-redundant-cli.md).
- Узнайте о [шаблонах разработки облачных служб Azure](https://docs.microsoft.com/azure/architecture/patterns/) , чтобы повысить устойчивость приложения к сценариям сбоя.
