---
title: Load Balancer ценовой категории "Стандартный" и зоны доступности
titleSuffix: Azure Load Balancer
description: С помощью этого пути обучения начинайте работу с балансо-баланса стандартной нагрузки Azure и зон доступности.
services: load-balancer
documentationcenter: na
author: asudbring
ms.custom: seodec18
ms.service: load-balancer
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 08/07/2019
ms.author: allensu
ms.openlocfilehash: 5a65982c5c13eb4e4273efcfd8d14910b0f35572
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "78197153"
---
# <a name="standard-load-balancer-and-availability-zones"></a>Azure Load Balancer ценовой категории "Стандартный" и зоны доступности

Балансизатор стандартной нагрузки Azure поддерживает [сценарии зон доступности.](../availability-zones/az-overview.md) Стандартный балансомер нагрузки можно использовать для оптимизации доступности в сквозном сценарии путем выравнивания ресурсов с зонами и их распределения по зонам.  Проанализируйте [зоны доступности](../availability-zones/az-overview.md) для руководства о том, какие зоны доступности, какие регионы в настоящее время поддерживают зоны доступности, и другие связанные с ними концепции и продукты. Зоны доступности в сочетании со Standard Load Balancer — это обширный и гибкий набор функций, который может создавать множество различных сценариев.  Просмотрите этот документ, чтобы получить представление об этих [понятиях](#concepts) и [руководство по разработке](#design) основного сценария.

## <a name="availability-zones-concepts-applied-to-load-balancer"></a><a name="concepts"></a> Концепции зон доступности, применимые к Load Balancer

Ресурс Load Balancer сам по себе является региональным и никогда не бывает зональным. Детализация того, что можно настроить, ограничена каждой конфигурацией определения пула фронтэнда, правила и бэкэнда.
В контексте зон доступности поведение и свойства правила «Балансора нагрузки» описываются как зональные или зональные.  Избыточные между зонами и зональные описывают зональность свойства.  В контексте Load Balancer зона-избыточная всегда означает *несколько зон* и зональных средств изоляции службы в *одной зоне.*
Как внешний, так и внутренний Load Balancer поддерживают избыточные между зонами и зональные сценарии и могут направлять трафик в различных зонах при необходимости (*распределение нагрузки между зонами*). 

### <a name="frontend"></a>Внешний интерфейс

Фронтенд Load Balancer — это конфигурация IP-адреса, ссылающаяся либо на общедоступный ресурс IP-адреса, либо на частный IP-адрес в подсети виртуального сетевого ресурса.  Он формирует конечную точку с балансировкой нагрузки, где предоставляется ваша служба.
Ресурс Грузобаланса может содержать правила с зональными и зонально-излишними фронтеями одновременно. Когда общедоступный РЕСУРС IP или частный IP-адрес гарантированзоне, зональность (или ее отсутствие) не изменяется.  Если вы хотите изменить или опустить зональность публичного IP или частного IP-адреса, вам необходимо воссоздать общественный IP в соответствующей зоне.  Зоны доступности не меняют ограничений для нескольких фронтейлеров, просмотрите [несколько фронтенов для Load Balancer](load-balancer-multivip-overview.md) для деталей для этой способности.

#### <a name="zone-redundant"></a>Избыточное в пределах зоны 

В регионе с зонами доступности фронтенд standard Load Balancer может быть излишним зоной.  Зона-излияльная означает, что все входящие или исходящие потоки обслуживаются несколькими зонами доступности в регионе одновременно с использованием одного IP-адреса. Схемы избыточности DNS не являются обязательными. Один IP-адрес переднего энда может выдержать сбой зоны и может быть использован для охвата всех (не затронутых) членов пула бэкэнда, независимо от зоны. Одна или несколько зон доступности могут выполнить свою непоправу, и путь передачи данных сохраняется до тех пор, пока одна зона в регионе остается здоровой. Единый IP-адрес фронтового адреса обслуживается одновременно несколькими независимыми развертываниями инфраструктуры в зонах множественной доступности.  Это не означает бесхитростный путь передачи данных, но любые повторы или восстановление будут успешными в других зонах, не затронутых сбоем зоны.   

#### <a name="optional-zone-isolation"></a>Дополнительная изоляция зоны

Вы можете гарантировать внешний интерфейс одной зоне, что называется *зональным внешним интерфейсом*.  Это означает, что любой входящий и исходящий поток обслуживается одной зоной в регионе.  Ваш внешний интерфейс разделяет работоспособность зоны.  На путь к данным не оказывают влияние сбои в зонах за исключением случаев, где это гарантировано. Зональные внешние интерфейсы можно использовать для предоставления IP-адреса каждой зоне доступности.  

Кроме того, вы можете потреблять зональные фронтели непосредственно для загрузки сбалансированных конечных точек в каждой зоне. Их также можно использовать для предоставления каждой зоне конечных точек с балансировкой нагрузки, чтобы выполнять мониторинг каждой зоны по отдельности.  Или для общедоступных конечных точек вы можете интегрировать их с продуктом, балансирующий с нагрузкой DNS, таким как [Traffic Manager,](../traffic-manager/traffic-manager-overview.md) и использовать одно имя DNS. Затем клиент разберется с этим dNS-именем с несколькими зональными IP-адресами.  

Если вы хотите использовать эти концепции совместно (избыточные между зонами и зональные для одной и той же серверной части), см. [этот документ](load-balancer-multivip-overview.md).

Для общедоступного фронтовика грузоподъемности вы добавляете параметр *зон* к общедоступному ресурсу IP, на который ссылается конфигурация IP-адреса, используемая соответствующим правилом.

При использовании внутреннего интерфейса Load Balancer добавьте параметр *zones* во внешнюю IP-конфигурацию внутреннего IP-адреса. Зональный внешний интерфейс приводит к тому, что Load Balancer гарантирует IP-адрес в подсети для конкретной зоны.

### <a name="cross-zone-load-balancing"></a>Распределение нагрузки между зонами

Распределение нагрузки между зонами — это возможность Load Balancer достичь конечной точки серверной части в любой из зон. Она не зависит от внешнего интерфейса и его зональности.  Любое правило балансировки нагрузки может быть нацелено на пример бэкэнда в любой зоне доступности или региональных экземплярах.

Необходимо позаботиться о построении сценария таким образом, чтобы высеяловать понятие зон доступности. Например, вам нужно гарантировать развертывание виртуальной машины в пределах одной зоны или нескольких зон, а также выровнять зональные передние и зональные ресурсы бэкэнда в одну и ту же зону.  Если вы пересекаете зоны доступности только с зональными ресурсами, сценарий будет работать, но может не иметь четкого режима сбоя в отношении зон доступности. 

### <a name="backend"></a>Серверная часть

Load Balancer работает с экземплярами виртуальных машин.  Это могут быть автономные наборы доступности или виртуальные наборы машин.  Любой виртуальный экземпляр машины в одной виртуальной сети может быть частью пула бэкэнда, независимо от того, была ли она гарантирована зоне или какая зона была гарантирована.

Если вы хотите выровнять и гарантировать переднее и бэкэнд с одной зоной, только место виртуальных машин в той же зоне в соответствующий пул бэкэнда.

Если вы хотите обратиться к виртуальным машинам в нескольких зонах, просто поместите виртуальные машины из нескольких зон в один и тот же пул бэкэнда.  При использовании наборов для масштабирования виртуальных машин можно поместить один или несколько этих наборов в один и тот же внутренний пул.  И каждый из этих наборов для масштабирования виртуальных машин может находиться в одной или нескольких зонах.

### <a name="outbound-connections"></a>Исходящие подключения

Те же зональные избыточные и зональные свойства применяются к [исходящим соединениям.](load-balancer-outbound-connections.md)  Зона-излишним публичный IP-адрес, используемый для исходящих соединений, обслуживается всеми зонами. Зональный публичный IP-адрес обслуживается только зоной, в которую он гарантирован.  Выделения портов исходящих соединений SNAT выдерживают сбои в зоне, и ваш сценарий будет продолжать обеспечивать исходящие подключения SNAT, если не будет затронут осваиваться сбоем зоны.  Это может потребовать передачи или восстановления соединений для сценариев, избыточных в зоне, если поток обслуживался пораженной зоной.  Потоки в зонах, не относясь от затронутых зон, не затрагиваются.

Алгоритм предварительного распределения порта SNAT одинаков с зонами доступности или без нее.

### <a name="health-probes"></a>Пробы работоспособности

Существующие определения зонда работоспособности остаются такими, как они не имеют зон доступности.  Тем не менее, мы расширили модель работоспособности на уровне инфраструктуры. 

При использовании резервных фронтов, Load Balancer расширяет свою внутреннюю модель работоспособности, чтобы самостоятельно исследовать доступность виртуальной машины из каждой зоны доступности и выключать пути в разных зонах, которые могут быть неудачными без вмешательства клиента.  Если данный путь недоступен от инфраструктуры грузосом баланса одной зоны до виртуальной машины в другой зоне, Load Balancer может обнаружить и избежать этого сбоя. Другие зоны, которые могут достичь этой виртуальной машины, могут продолжать обслуживать виртуальную машину из своих соответствующих внешних интерфейсов.  В результате возможно, что во время событий сбоя каждая зона может иметь несколько разные распределения новых потоков, защищая при этом общее состояние вашего сквозного обслуживания.

## <a name="design-considerations"></a><a name="design"></a>Соображения дизайна

Балансом нагрузки намеренно гибок в контексте зон доступности. Вы можете выбрать выравнивание зон или вы можете выбрать, чтобы быть зонально-излишним для каждого правила.  Повышение доступности достигается за счет возрастающей сложности. Вам необходимо выполнять проектирование для обеспечения доступности оптимальной производительности.  Давайте рассмотрим некоторые важные рекомендации по проектированию.

### <a name="automatic-zone-redundancy"></a>Автоматическая избыточность в пределах зоны

С помощью Load Balancer можно использовать всего один IP-адрес в качестве внешнего интерфейса, избыточного между зонами. Избыточный между зонами IP-адрес может безопасно обслуживать зональный ресурс в любой из зон и выдерживает один или несколько сбоев зоны, пока одна зона остается работоспособной внутри региона. И наоборот, зональный внешний интерфейс является уменьшением службы в единую зону и разделяет участь соответствующей зоны.

Избыточность зон не подразумевает отсутствие помех в пути к данным или плоскости управления. Это явно плоскость данных. Избыточные между зонами потоки могут использовать любые зоны, а потоки клиента будут использовать все работоспособные зоны в регионе. В случае сбоя зоны потоки трафика, поступающие с помощью работоспособных зон на тот момент времени, не затрагиваются.  Потоки трафика, использующие зону во время сбоя зоны, могут быть затронуты, но приложения могут восстановиться. Эти потоки могут продолжаться в оставшихся здоровых зонах в регионе после ретрансляции или восстановления, как только Azure сошелась вокруг сбоя зоны.

### <a name="cross-zone-boundaries"></a><a name="xzonedesign"></a> Границы между зонами

Важно понимать, что каждый раз, когда комплексная служба пересекает границу зоны, вы разделяете участь не одной зоны, а потенциально нескольких зон.  В результате комплексная служба может быть недоступной в незональных развертываниях.

Избегайте введения непреднамеренных межзональных зависимостей, что сведет на нет преимущества доступности при использовании зон доступности.  Если ваше приложение состоит из нескольких компонентов и вы хотите быть устойчивым к сбоям зоны, необходимо обеспечить стойкость достаточного количества важных компонентов в случае сбоя зоны.  Например, один критически важный компонент для вашего приложения может повлиять на все приложение, если он просто находится в зоне, которая не выдерживает сбоев.  Кроме того, также рассмотрите возможность восстановления зоны и каким образом ваше приложение будет объединяться. Вы должны понять, как ваше приложение причины в отношении сбоев части его. Давайте рассмотрим некоторые ключевые моменты, которые вы можете использовать для поиска вопросов о вашем конкретном сценарии.

- Если ваше приложение имеет два компонента, таких как IP-адрес и виртуальная машина с управляемым диском, и они гарантированы в зоне 1 и зоне 2, когда зона 1 выходит из строя, служба сквозного завершения не выживет, когда зона 1 выходит из строя.  Не пересекайте зоны с зональными сценариями, если вы не полностью понимаете, что создаете потенциально опасный режим сбоя.  Этот сценарий позволяет обеспечить гибкость.

- Если ваше приложение имеет два компонента, такие как IP-адрес и виртуальная машина с управляемым диском, и они гарантированно будут зональными и зоной 1 соответственно, ваш сквозной сервис выживет в зоне отказа зоны 2, зоны 3 или обоих, если зона 1 не выйдет из строя.  Тем не менее вы не сможете узнать о работоспособности службы, если наблюдаете только за достижимостью внешнего интерфейса.  Рассмотрите возможность разработки более сложной модели работоспособности и производительности.  Чтобы получить больше информации и расширить возможности управляемости, концепции избыточности между зонами и зональности можно использовать совместно.

- Если приложение состоит из двух компонентов, таких как внешний интерфейс Load Balancer, избыточный между зонами, и набор для масштабирования виртуальных машин между зонами в трех зонах, ваши ресурсы в зонах, которые не подвержены влиянию сбоя будут доступны, но производительность вашей комплексной службы может снизиться во время сбоя зоны. С точки зрения инфраструктуры ваше развертывание может выдержать один или несколько сбоев зоны, и в результате этого возникают следующие вопросы:
  - Понимаете ли вы, каким образом приложение получает сведения о таких сбоях и сниженной производительности?
  - Необходимо ли вам принять меры безопасности в службе, чтобы принудительно выполнить отработку отказа в пару регионов при необходимости?
  - Каким образом вы будете отслеживать, обнаруживать и избегать такую ситуацию? Возможно, вы сможете расширить возможности мониторинга производительности вашей комплексной службы с помощью диагностики Load Balancer уровня "Стандартный". Выясните, что доступно, а также что может потребоваться расширить для получения полного представления.

- Зоны помогут упростить распознавание сбоев.  Тем не менее сбой зоны не отличается от других сбоев, когда дело доходит до основных понятий, таких как истечение времени ожидания, повторные попытки и алгоритмы отсрочки. Несмотря на то, что Azure Load Balancer предоставляет пути, избыточные между зонами, и пытается выполнить восстановление быстро на уровне пакетов в реальном времени, в начале сбоя могут возникнуть повторные передачи или повторные установки подключения, и важно понимать, каким образом приложение справляется со сбоями. Схема балансировки нагрузки выдержит сбой, но необходимо оценить следующее:
  - При сбое зоны распознает ли его комплексная служба и каким образом вы выполните восстановление в случае утери сведений о состоянии?
  - При возврате из зоны понимает ли приложение, как безопасно выполнить объединение?

Просмотрите [шаблоны проектирования облачных технологий Azure,](https://docs.microsoft.com/azure/architecture/patterns/) чтобы повысить устойчивость приложения к сценариям сбоев.

## <a name="next-steps"></a>Дальнейшие действия
- Подробнее о [зонах доступности](../availability-zones/az-overview.md)
- Подробнее о [балансеstandardе стандартной нагрузки](load-balancer-standard-overview.md)
- Узнайте, как [распределять нагрузку виртуальных машин в рамках зоны с помощью Load Balancer уровня "Стандартный" с зональным внешним интерфейсом](load-balancer-standard-public-zonal-cli.md).
- Узнайте, как [распределять нагрузку виртуальных машин по зонам с помощью Load Balancer уровня "Стандартный" с избыточным между зонами интерфейсным сервером](load-balancer-standard-public-zone-redundant-cli.md).
- Узнайте о [шаблонах проектирования облачных технологий Azure,](https://docs.microsoft.com/azure/architecture/patterns/) чтобы повысить устойчивость приложения к сценариям сбоев.
