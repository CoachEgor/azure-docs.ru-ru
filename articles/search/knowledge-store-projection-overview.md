---
title: Работа с проекциями в хранилище знаний (Предварительная версия)
titleSuffix: Azure Cognitive Search
description: Сохраняйте обогащенные данные из конвейера индексирования искусственного интеллекта ии в хранилище знаний для использования в сценариях, отличных от полнотекстового поиска. Хранилище знаний сейчас находится в общедоступной предварительной версии.
manager: nitinme
author: vkurpad
ms.author: vikurpad
ms.service: cognitive-search
ms.topic: conceptual
ms.date: 11/04/2019
ms.openlocfilehash: bb6af4be232810c1f5d135e459238e2e4f2cd5d8
ms.sourcegitcommit: bc7725874a1502aa4c069fc1804f1f249f4fa5f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/07/2019
ms.locfileid: "73720040"
---
# <a name="working-with-projections-in-a-knowledge-store-in-azure-cognitive-search"></a>Работа с проекциями в хранилище знаний Azure Когнитивный поиск

> [!IMPORTANT] 
> Хранилище знаний сейчас находится в общедоступной предварительной версии. Функции предварительной версии предоставляются без соглашения об уровне обслуживания и не рекомендуются для рабочих нагрузок. Дополнительные сведения см. в статье [Дополнительные условия использования предварительных выпусков Microsoft Azure](https://azure.microsoft.com/support/legal/preview-supplemental-terms/). [REST API версия 2019-05-06-Preview](search-api-preview.md) предоставляет функции предварительной версии. В настоящее время поддерживается ограниченная поддержка портала и поддержка пакета SDK для .NET.

Azure Когнитивный поиск позволяет расширить содержимое с помощью встроенных навыков и пользовательских навыков в процессе индексирования. Дополнения добавляют структуру к документам и делают поиск более эффективным. Во многих случаях обогащенные документы полезны для сценариев, отличных от поиска, например для интеллектуального анализа знаний.

Проекции, компонент [хранилища знаний](knowledge-store-concept-intro.md), представляют собой представления расширенных документов, которые можно сохранить в физическом хранилище в целях интеллектуального анализа знаний. Проекция позволяет "проецировать" свои данные в фигуру, которая соответствует вашим потребностям, сохраняя связи, чтобы такие средства, как Power BI, могли считывать данные без дополнительных усилий.

Проекции могут быть табличными, с данными, хранящимися в строках и столбцах в хранилище таблиц Azure, или в объектах JSON, хранящихся в хранилище BLOB-объектов Azure. Можно определить несколько проекций данных, так как они дополняются углублением. Несколько проекций удобно использовать, если вы хотите, чтобы одни и те же данные отличались для отдельных вариантов использования.

Хранилище базы знаний поддерживает три типа проекций:

+ **Таблицы**. для данных, которые лучше представить в виде строк и столбцов, проекции таблиц позволяют определить схематизированных форму или проекцию в хранилище таблиц.

+ **Объекты**. Если вам нужно представление JSON данных и дополнений, проекции объектов сохраняются как большие двоичные объекты.

+ **Файлы**. Если необходимо сохранить изображения, извлеченные из документов, проектные проекции позволяют сохранить нормализованные изображения.

Чтобы увидеть проекции, определенные в контексте, пошаговое [руководство по началу работы с хранилищем знаний](knowledge-store-howto.md).

## <a name="projection-groups"></a>Группы проекций

В некоторых случаях необходимо проецировать обогащенные данные на разных фигурах в соответствии с различными целями. Хранилище знаний позволяет определить несколько групп проекций. Группы проекций имеют следующие основные характеристики взаимной исключительные праваи и взаимосвязи.

### <a name="mutual-exclusivity"></a>Взаимная исключительные права

Все содержимое, проецированное в одну группу, не зависит от данных, проецируемых в другие группы проекций.
Эта независимость подразумевает, что одни и те же данные могут быть разными, но повторяться в каждой группе проекций.

### <a name="relatedness"></a>Взаимосвязь

Группы проекции теперь позволяют проецировать документы между типами проекции, сохраняя связи между типами проекций. Все содержимое, проецируемое в одной группе проекции, сохраняет связи между данными в разных типах проекций. В таблицах связи основываются на созданном ключе, и каждый дочерний узел оставляет ссылку на родительский узел. В разных типах (таблицах, объектах и файлах) связи сохраняются, когда один узел проецируется по разным типам. Например, рассмотрим сценарий, в котором есть документ, содержащий изображения и текст. Можно проецировать текст в таблицы или объекты, а изображения — в файлы, в которых таблицы или объекты имеют свойство, содержащее URL-адрес файла.

## <a name="input-shaping"></a>Формирование ввода

Получение данных в правой форме или структуре является ключом к эффективному использованию, они являются таблицами или объектами. Возможность формирования или структурирования данных в зависимости от того, как вы планируете обращаться к ним и использовать ее, является ключевой возможностью, предоставляемой **в качестве навыка** для набора навыков.  

Проекции проще определить при наличии в дереве обогащения объекта, соответствующего схеме проекции. Обновленные [навыки работы с фигурами](cognitive-search-skill-shaper.md) позволяют создать объект из различных узлов дерева обогащения и сделать его родительским для нового узла. Уровень навыка " **фигура** " позволяет определять сложные типы с вложенными объектами.

Если определена новая фигура, содержащая все элементы, которые необходимо проецировать, эту фигуру теперь можно использовать в качестве источника для проекций или в качестве входных данных для другого навыка.

## <a name="projection-slicing"></a>Срез проекции

При определении группы проекций один узел в дереве обогащения может быть разбит на несколько связанных таблиц или объектов. Добавление проекции с исходным путем, который является дочерним по отношению к существующей проекции, приведет к тому, что дочерний узел выделится из родительского узла и проецируется в новую, но связанную таблицу или объект. Этот метод позволяет определить один узел в навыке, который может быть источником для всех проекций.

## <a name="table-projections"></a>Проекции таблиц

Так как это упрощает импорт, мы рекомендуем использовать проекции таблиц для просмотра данных с помощью Power BI. Кроме того, проекции таблиц позволяют изменять количество элементов между связями между таблицами. 

Можно проецировать один документ в индексе в несколько таблиц, сохраняя связи. При проецировании на несколько таблиц в каждой таблице будет отображаться полная фигура, если только дочерний узел не является источником другой таблицы в той же группе.

### <a name="defining-a-table-projection"></a>Определение проекции таблицы

При определении проекции таблицы в элементе `knowledgeStore` набора навыков Начните с сопоставления узла в дереве обогащения с источником таблицы. Обычно этот узел является выходными данными о **навыках** , добавленных в список навыков для создания конкретной формы, необходимой для проецирования в таблицы. Выбранный для проекта узел можно разделить на несколько таблиц. Определение таблиц — это список таблиц, которые необходимо проецировать.

Для каждой таблицы требуются три свойства:

+ tableName: имя таблицы в службе хранилища Azure.

+ Женератедкэйнаме: имя столбца для ключа, уникально идентифицирующего эту строку.

+ Источник. узел из дерева обогащения, из которого вы исследуете свои дополнения. Этот узел обычно является выходными данными фигуры, но может быть выходом любого из навыков.

Ниже приведен пример проекций таблицы.

```json
{
    "name": "your-skillset",
    "skills": [
      …your skills
    ],
"cognitiveServices": {
… your cognitive services key info
    },

    "knowledgeStore": {
      "storageConnectionString": "an Azure storage connection string",
      "projections" : [
        {
          "tables": [
            { "tableName": "MainTable", "generatedKeyName": "SomeId", "source": "/document/EnrichedShape" },
            { "tableName": "KeyPhrases", "generatedKeyName": "KeyPhraseId", "source": "/document/EnrichedShape/*/KeyPhrases/*" },
            { "tableName": "Entities", "generatedKeyName": "EntityId", "source": "/document/EnrichedShape/*/Entities/*" }
          ]
        },
        {
          "objects": [ ]
        },
        {
            "files": [ ]
        }
      ]
    }
}
```

Как показано в этом примере, ключевые фразы и сущности моделируются в разные таблицы и будут содержать ссылку на родительский элемент (MainTable) для каждой строки.

На следующем рисунке приведена ссылка на упражнение по закону в статье как приступить к [работе с хранилищем знаний](knowledge-store-howto.md). В сценарии, где обращение имеет несколько мнений, и каждое из них дополняется путем определения сущностей, содержащихся в нем, можно моделировать проекции, как показано ниже.

![Сущности и связи в таблицах](media/knowledge-store-projection-overview/TableRelationships.png "Моделирование отношений в проекциях таблиц")

## <a name="object-projections"></a>Проекции объектов

Проекции объектов — это представления JSON дерева обогащения, которые могут быть источником из любого узла. Во многих случаях для создания проекции объекта можно использовать **тот же навык** , который создает проекцию таблицы. 

```json
{
    "name": "your-skillset",
    "skills": [
      …your skills
    ],
"cognitiveServices": {
… your cognitive services key info
    },

    "knowledgeStore": {
      "storageConnectionString": "an Azure storage connection string",
      "projections" : [
        {
          "tables": [ ]
        },
        {
          "objects": [
            {
              "storageContainer": "Reviews", 
              "format": "json", 
              "source": "/document/Review", 
              "key": "/document/Review/Id" 
            }
          ]
        },
        {
            "files": [ ]
        }
      ]
    }
}
```

Для создания проекции объекта требуется несколько атрибутов, характерных для объекта:

+ storageContainer: контейнер, в котором будут сохранены объекты
+ Source: путь к узлу дерева обогащения, который является корнем проекции
+ Key: путь, представляющий уникальный ключ для сохраняемого объекта. Он будет использоваться для создания имени большого двоичного объекта в контейнере.

## <a name="file-projection"></a>Проекция файла

Проекции файлов похожи на проекции объектов и работают только с коллекцией `normalized_images`. Аналогично проекциям объектов, проекции файлов сохраняются в контейнере больших двоичных объектов с префиксом в виде папки для идентификатора документа в кодировке Base64. Проекции файлов не могут совместно использовать один контейнер с проекциями объектов и должны быть проецированы в другой контейнер.

```json
{
    "name": "your-skillset",
    "skills": [
      …your skills
    ],
"cognitiveServices": {
… your cognitive services key info
    },

    "knowledgeStore": {
      "storageConnectionString": "an Azure storage connection string",
      "projections" : [
        {
          "tables": [ ]
        },
        {
          "objects": [ ]
        },
        {
            "files": [
                 {
                  "storageContainer": "ReviewImages",
                  "source": "/document/normalized_images/*"
                }
            ]
        }
      ]
    }
}
```

## <a name="projection-lifecycle"></a>Жизненный цикл проекции

У ваших проекций есть жизненный цикл, связанный с исходными данными в источнике данных. По мере обновления и повторного индексирования данных проекции обновляются с учетом результатов обогащения, гарантируя, что проекции в конечном итоге согласуются с данными в источнике данных. Проекции наследуют политику удаления, настроенную для индекса. Проекции не удаляются при удалении индексатора или самой службы поиска.

## <a name="using-projections"></a>Использование проекций

После выполнения индексатора можно считывать проецированные данные в контейнерах или таблицах, заданных с помощью проекций.

Для аналитики исследование в Power BI — это просто Настройка табличного хранилища Azure в качестве источника данных. Вы можете легко создать набор визуализаций на основе данных, используя связи в.

Кроме того, если необходимо использовать обогащенные данные в конвейере обработки и анализа данных, вы можете [загрузить данные из больших двоичных объектов в Pandas](../machine-learning/team-data-science-process/explore-data-blob.md).

Наконец, если необходимо экспортировать данные из хранилища знаний, в фабрике данных Azure есть соединители для экспорта данных и их размещения в выбранной базе данных. 

## <a name="next-steps"></a>Дальнейшие действия

В качестве следующего шага создайте первое хранилище знаний, используя образцы данных и инструкции.

> [!div class="nextstepaction"]
> [Создание хранилища знаний](knowledge-store-howto.md).
