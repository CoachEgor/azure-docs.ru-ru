---
title: Как запланировать индексаторы - поиска Azure
description: Запланируйте индексаторы поиска Azure для индексирования содержания, периодически или в определенное время.
ms.date: 05/31/2019
author: RobDixon22
manager: HeidiSteen
ms.author: v-rodixo
services: search
ms.service: search
ms.devlang: rest-api
ms.topic: conceptual
ms.custom: seodec2018
ms.openlocfilehash: 4bf931b19b7490a94f30afde49038cdc7573fab3
ms.sourcegitcommit: 82efacfaffbb051ab6dc73d9fe78c74f96f549c2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/20/2019
ms.locfileid: "67302245"
---
# <a name="how-to-schedule-indexers-for-azure-search"></a>Как запланировать индексаторы поиска Azure
Индексатор, который обычно выполняется один раз, сразу же после его создания. Его можно запустить снова по запросу с помощью портала, REST API или пакет SDK для .NET. Можно также настроить индексатор для периодического запуска по расписанию.

Иногда, где планирование индексатора полезно:

* Исходные данные будут меняться со временем, и требуется, чтобы в индексаторах поиска Azure для автоматической обработки измененные данные.
* Индекс будет заполнен из нескольких источников данных и вы хотите убедиться, что индексаторы запускались в разное время, чтобы уменьшить конфликты.
* Источник данных очень велик и вы хотите распределить индексатор обработки со временем. Дополнительные сведения об индексировании больших объемов данных, см. в разделе [как индексировать большие наборы данных в службе поиска Azure](search-howto-large-index.md).

Планировщик — это встроенный компонент службы поиска Azure. Для управления индексаторы поиска невозможно использовать внешний планировщик.

## <a name="define-schedule-properties"></a>Определение свойства расписания

Расписание индексатора имеет два свойства:
* **Интервал**, который определяет количество времени в диапазоне от запланированных выполнений индексатора. Допускается наименьший интервал составляет 5 минут, а самая большая — 24 часа.
* **Запуск времени (UTC)** , который указывает, в первый раз, по которому следует запускать индексатор.

При первоначальном создании индексатора или обновлении индексатора свойства позже, можно указать расписание. Расписания индексаторов могут задаваться с использованием [портала](#portal), [REST API](#restApi), или [пакета SDK для .NET](#dotNetSdk).

Одновременно можно выполнить только один запуск выбранного индексатора. Если индексатор уже выполняется, при его следующем выполнении запланировано, эту выполнение откладывается до следующего запланированного времени.

Для большей ясности рассмотрим пример. Предположим, что мы настроим расписание индексатора с **интервал** из каждый час и **время начала** из 1 июня 2019 г. в 8:00:00 AM (UTC). Вот, что может произойти, если запуск индексатора выполняется дольше часа.

* Первый запуск индексатора ровно или приблизительно 1 июня 2019 г. в 8:00:00 (UTC). Предположим, выполнение займет 20 минут (или иное количество времени в пределах часа).
* Второй запуск ровно или приблизительно 1 июня 2019 г. 9:00 по UTC. Предположим, что выполнение занимает 70 минут - более часа — и не будет завершено до 10:10 по UTC.
* Третий запуск запланирован запуск в 10:00 по UTC, но в этот момент все еще выполняется предыдущего выполнения. Это запланировано выполнение затем пропущено. Следующего выполнения индексатора не запустится до 11:00 по UTC.

> [!NOTE]
> Если индексатор, который присваивается определенному расписанию, но несколько раз происходит сбой на том же ее следует задокументировать снова и снова каждый раз выполняется, индексатор будет начинаться на более продолжительный интервал (максимум по крайней мере один раз каждые 24 часа) до его успешному выполнению делает Ага хода выполнения в.  Если вы считаете, что Вы устранили все, что эту проблему, которая вызывала индексатора "зависнуть" в определенной точке, можно выполнять по требованию выполнения индексатора, и, успешно вносятся хода выполнения, индексатор будет возвращать его интервал расписания набора еще раз.

<a name="portal"></a>

## <a name="define-a-schedule-in-the-portal"></a>Создание расписания на портале

Мастер импорта данных на портале позволяет определить расписание для индексатора во время создания. Расписание по умолчанию является **почасовой**, означающее индексатор выполняется один раз после его создания и запускается снова каждый час позже.

Можно изменить параметр расписания для **после** Если вы не хотите снова автоматически выполняющегося индексатора или **ежедневного** для запуска один раз в день. Задайте для него значение **Custom** Если вы хотите указать другой интервал или определенных будущих времени начала.

Если задано расписание **Custom**, отображаются поля, чтобы вы могли указать **интервал** и **запустить времени (UTC)** . Наименьшее время интервала времени, разрешенного — 5 минут и самая длинная — 1440 минут (24 часа).

   ![Расписание индексатора параметр в мастере импорта данных](media/search-howto-schedule-indexers/schedule-import-data.png "параметр расписание индексатора в мастере импорта данных")

После создания индексатора можно изменить параметры расписания, с помощью индексатора панели редактирования. Поля расписания являются так же, как мастер импорта данных.

   ![Настройка расписаний на панели редактирования индексатора](media/search-howto-schedule-indexers/schedule-edit.png "Настройка расписаний на панели редактирования индексатора")

<a name="restApi"></a>

## <a name="define-a-schedule-using-the-rest-api"></a>Создание расписания с помощью REST API

Можно определить расписание для индексатора с помощью REST API. Чтобы сделать это, включите **расписание** свойства при создании или обновлении индексатора. В приведенном ниже примере показан запрос PUT для обновления существующего индексатора:

    PUT https://myservice.search.windows.net/indexers/myindexer?api-version=2019-05-06
    Content-Type: application/json
    api-key: admin-key

    {
        "dataSourceName" : "myazuresqldatasource",
        "targetIndexName" : "target index name",
        "schedule" : { "interval" : "PT10M", "startTime" : "2015-01-01T00:00:00Z" }
    }

Параметр **interval** обязателен. Он указывает время между двумя последовательными запусками индексатора. Наименьшее допустимое значение — 5 минут, наибольшее — один день. Значение должно быть отформатировано как значение dayTimeDuration XSD (ограниченное подмножество значения [продолжительности ISO 8601](https://www.w3.org/TR/xmlschema11-2/#dayTimeDuration) ). Используется следующий шаблон: `P(nD)(T(nH)(nM))`. Примеры: `PT15M` для каждых 15 минут, `PT2H` для каждых 2 часов.

Необязательный **startTime** указывает, когда должно начаться выполнение по расписанию. Если опустить этот параметр, используется текущее время в формате UTC. Это время может быть в прошлом, в котором случае первое выполнение планируется так, как если бы индексатор прекращал обработку со времени исходного **startTime**.

Можно также запустить индексатор по требованию в любое время, используя вызов запуск индексатора. Дополнительные сведения о выполнении индексаторов и задание расписания индексаторов см. в разделе [запуск индексатора](https://docs.microsoft.com/rest/api/searchservice/run-indexer), [Get Indexer](https://docs.microsoft.com/rest/api/searchservice/get-indexer), и [Update индексатор](https://docs.microsoft.com/rest/api/searchservice/update-indexer) в справочнике по REST API.

<a name="dotNetSdk"></a>

## <a name="define-a-schedule-using-the-net-sdk"></a>Создание расписания с помощью пакета SDK для .NET

Можно определить расписание для индексатора, с помощью пакета SDK для .NET для поиска Azure. Чтобы сделать это, включите **расписание** свойства при создании или обновлении индексатора.

Следующие C# примере создается индексатор, используя предварительно определенный источник данных и индекса и задает его расписание выполняется один раз ежедневно, начиная с настоящего 30 минут:

```
    Indexer indexer = new Indexer(
        name: "azure-sql-indexer",
        dataSourceName: dataSource.Name,
        targetIndexName: index.Name,
        schedule: new IndexingSchedule(
                        TimeSpan.FromDays(1), 
                        new DateTimeOffset(DateTime.UtcNow.AddMinutes(30))
                    )
        );
    await searchService.Indexers.CreateOrUpdateAsync(indexer);
```
Если **расписание** параметр опущен, индексатор будет выполняться только один раз сразу после его создания.

**StartTime** параметру можно присвоить значение времени в прошлом. В этом случае первое выполнение планируется так, как если бы индексатор прекращал обработку со времени заданного **startTime**.

Расписание определяется с помощью [IndexingSchedule](https://docs.microsoft.com/dotnet/api/microsoft.azure.search.models.indexingschedule?view=azure-dotnet) класса. **IndexingSchedule** конструктор требует **интервал** параметр, указанный с помощью **TimeSpan** объекта. Наименьшее допустимое значение интервала составляет 5 минут, а самая большая — 24 часа. Второй **startTime** указан как параметр **DateTimeOffset** объекта, не является обязательной.

Пакет SDK для .NET позволяет с помощью операции с индексаторами управления [SearchServiceClient](https://docs.microsoft.com/dotnet/api/microsoft.azure.search.searchserviceclient) класса и его [индексаторы](https://docs.microsoft.com/dotnet/api/microsoft.azure.search.searchserviceclient.indexers) свойство, которое реализует методы из **IIndexersOperations**интерфейс. 

Индексатор можно запустить по требованию в любое время с помощью одного из [запуска](https://docs.microsoft.com/dotnet/api/microsoft.azure.search.indexersoperationsextensions.run), [RunAsync](https://docs.microsoft.com/dotnet/api/microsoft.azure.search.indexersoperationsextensions.runasync), или [RunWithHttpMessagesAsync](https://docs.microsoft.com/dotnet/api/microsoft.azure.search.iindexersoperations.runwithhttpmessagesasync) методы.

Дополнительные сведения о создании, обновлении и выполнение индексаторов, см. в разделе [IIindexersOperations](https://docs.microsoft.com/dotnet/api/microsoft.azure.search.iindexersoperations?view=azure-dotnet).
