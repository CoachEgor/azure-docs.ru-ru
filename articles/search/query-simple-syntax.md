---
title: Простой синтаксис запросов в службе "Поиск Azure"
description: Справочные материалы по простому синтаксису запросов, используемому для запросов полнотекстового поиска в службе "Поиск Azure".
services: search
ms.service: search
ms.topic: conceptual
ms.date: 08/08/2019
author: brjohnstmsft
ms.author: brjohnst
manager: nitinme
translation.priority.mt:
- de-de
- es-es
- fr-fr
- it-it
- ja-jp
- ko-kr
- pt-br
- ru-ru
- zh-cn
- zh-tw
ms.openlocfilehash: e6c5ea86534001e0e5de2b02c4151af70631e4ef
ms.sourcegitcommit: bb8e9f22db4b6f848c7db0ebdfc10e547779cccc
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2019
ms.locfileid: "69650017"
---
# <a name="simple-query-syntax-in-azure-search"></a>Простой синтаксис запросов в службе "Поиск Azure"
Поиск Azure реализует два языковых механизма запросов на основе Lucene: [простое средство синтаксического анализа запросов](https://lucene.apache.org/core/6_6_1/queryparser/org/apache/lucene/queryparser/simple/SimpleQueryParser.html) и [средство синтаксического анализа запросов Lucene](https://lucene.apache.org/core/6_6_1/queryparser/org/apache/lucene/queryparser/classic/package-summary.html). В Поиске Azure простой синтаксис запросов исключает поиск нечетких соответствий.  

> [!NOTE]  
>  Служба "Поиск Azure" предоставляет альтернативный [синтаксис запросов Lucene](query-lucene-syntax.md) для более сложных запросов. Дополнительные сведения об архитектуре синтаксического анализа запросов и преимуществах каждого синтаксиса см. в статье [Как работает полнотекстовый поиск в службе поиска Azure](search-lucene-query-architecture.md).

## <a name="how-to-invoke-simple-parsing"></a>Вызов простого синтаксического анализа

Простой синтаксис включен по умолчанию. Вызов необходим только в том случае, если вы сбрасываете синтаксис с полного на простой. Чтобы явно установить синтаксис, используйте параметр поиска `queryType`. Допустимые значения: `simple|full` (`simple` как значение по умолчанию, а `full` как значение Lucene). 

## <a name="query-behavior-anomalies"></a>Аномальные поведения запросов

Любой текст с одним или несколькими терминами считается допустимой отправной точкой для выполнения запроса. Поиск Azure будет сопоставлять документы, содержащие любые или все термины, включая любые вариации, обнаруженные в ходе анализа текста. 

Как бы просто это ни звучало, в Поиске Azure существует один аспект выполнения запроса, который *может* приводить к неожиданным результатам, увеличивая, а не уменьшая количество результатов поиска, так как к строке входных данных добавлено больше условий и операторов. То, происходит ли такое расширение, зависит от наличия оператора NOT в сочетании с параметром `searchMode`, который определяет, как NOT интерпретируется в условиях с операторами AND или OR. Заданный по умолчанию режим `searchMode=Any` и оператор NOT приводят к тому, что операция вычисляется как действие OR, так что условие `"New York" NOT Seattle` вернет все города, кроме Сиэтла.  

Как правило, такое поведение с большей вероятностью можно увидеть в шаблонах взаимодействия пользователя с приложениями, которые выполняют поиск по содержимому. В таких шаблонах пользователи чаще включают в свои запросы операторы, в отличие от сайтов электронной коммерции, которые имеют больше встроенных структур навигации. Дополнительные сведения см. в разделе [Оператор NOT](#not-operator). 

## <a name="boolean-operators-and-or-not"></a>Логические операторы (AND, OR, NOT) 

Можно внедрить операторы в строку запроса, чтобы создать обширный набор критериев для поиска соответствующих документов. 

### <a name="and-operator-"></a>Оператор AND `+`

Оператор AND представляет собой знак плюс. Например, условие `wifi+luxury` будет искать документы, содержащие и `wifi`, и `luxury`.

### <a name="or-operator-"></a>Оператор OR `|`

Оператор OR представляет собой вертикальную черту. Например, условие `wifi | luxury` будет искать документы, содержащие `wifi` или `luxury`, или и то и другое.

<a name="not-operator"></a>

### <a name="not-operator--"></a>Оператор NOT `-`

Оператор NOT представляет собой знак минус. Например, условие `wifi –luxury` будет искать документы, содержащие `wifi` и/или не содержащие `luxury` (это условие и/или контролируется параметром `searchMode`).

> [!NOTE]  
>  Параметр `searchMode` контролирует, является ли условие с оператором NOT логическим AND или логическим OR с другими условиями запроса в отсутствие операторов `+` или `|`. Напомним, что для `searchMode` можно установить значение `any` (по умолчанию) или `all`. Значение `any` увеличит количество повторных вызовов запросов, что даст большее количество результатов, и `-` по умолчанию интерпретируется как "OR NOT". Например, `wifi -luxury` соответствует документам, которые содержат термин `wifi`, или документам, которые не содержат термин `luxury`. Значение `all` увеличит точность запроса, что даст меньшее количество результатов, и "-" по умолчанию интерпретируется как "AND NOT". Например, `wifi -luxury` соответствует документам, которые содержат термин `wifi` и не содержат термин "luxury". Вероятно, это более интуитивное поведение оператора `-`. Поэтому вам следует рассмотреть возможность использования `searchMode=all` вместо `searchMode=any`, если вы хотите оптимизировать точность поиска (в ущерб повторным вызовам) *и* если ваши пользователи часто используют оператор `-` в своих поисковых запросах.

## <a name="suffix-operator"></a>Оператор суффикса

Суффиксом оператора является звездочка `*`. Например, при `lux*` будут найдены все документы, содержащие термин, начинающийся с `lux` (регистр игнорируется).  

## <a name="phrase-search-operator"></a>Оператор поиска фраз

Оператор Phrase заключает фразу в кавычки `" "`. Например, при `Roach Motel` (без кавычек) будут найдены документы, содержащие `Roach` и/или `Motel` (в любом порядке), а при `"Roach Motel"` (с кавычками) будут найдены только те документы, в которых есть эта фраза целиком и с таким же порядком слов (анализ текста по-прежнему применяется).

## <a name="precedence-operator"></a>Оператор приоритета

Оператор приоритета заключает строку в круглые скобки `( )`. Например, `motel+(wifi | luxury)` будет искать документы, содержащие термин Motel `wifi` , а также `luxury` либо (или), либо (или).  

## <a name="escaping-search-operators"></a>Поисковые операторы экранирования  

 Чтобы использовать вышеуказанные символы в качестве фактической части текста поиска, их следует экранировать, добавив к ним обратную косую черту. Например, `luxury\+hotel` в результате даст термин `luxury+hotel`. Чтобы упростить задачу для более типичных случаев, существует два исключения из этого правила, в которых экранирование не требуется.  

- Оператор NOT `-` необходимо экранировать только в том случае, если он является первым знаком после пробела, а не находится в середине термина. Например, `wi-fi` — это один термин, при этом значения GUID (например, `3352CDD0-EF30-4A2E-A512-3B30AF40F3FD`) обрабатываются как один токен.
- Постфиксный оператор `*` необходимо экранировать только в том случае, если он является последним знаком перед пробелом, а не находится в середине термина. Например, `wi*fi` обрабатывается как один токен.

> [!NOTE]  
>  Хотя экранирование сохраняет токены вместе, при анализе текста они могут разделяться в зависимости от режима анализа. Дополнительные сведения см. в статье [Добавление анализатора языка в индекс Поиска Azure](index-add-language-analyzers.md).  

## <a name="see-also"></a>См. также  

+ [Search Documents (Azure Search Service REST API)](https://docs.microsoft.com/rest/api/searchservice/Search-Documents) (Поиск по документам (REST API службы "Поиск Azure")) 
+ [Синтаксис запросов Lucene](query-lucene-syntax.md)
+ [Синтаксис выражений OData](query-odata-filter-orderby-syntax.md) 
