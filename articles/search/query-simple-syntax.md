---
title: Простой синтаксис запросов
titleSuffix: Azure Cognitive Search
description: Ссылка на простой синтаксис запроса, используемый для поиска полного текста в Azure Cognitive Search.
manager: nitinme
author: brjohnstmsft
ms.author: brjohnst
ms.service: cognitive-search
ms.topic: conceptual
ms.date: 04/03/2020
translation.priority.mt:
- de-de
- es-es
- fr-fr
- it-it
- ja-jp
- ko-kr
- pt-br
- ru-ru
- zh-cn
- zh-tw
ms.openlocfilehash: 3d5a4ddf863115747c27efbca1808d51444aac8c
ms.sourcegitcommit: 62c5557ff3b2247dafc8bb482256fef58ab41c17
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/03/2020
ms.locfileid: "80656170"
---
# <a name="simple-query-syntax-in-azure-cognitive-search"></a>Простой синтаксис запроса в когнитивном поиске Azure

Azure Cognitive Search реализует два языка запроса на основе Lucene: [простой запрос Parser](https://lucene.apache.org/core/6_6_1/queryparser/org/apache/lucene/queryparser/simple/SimpleQueryParser.html) и [Lucene Query Parser.](https://lucene.apache.org/core/6_6_1/queryparser/org/apache/lucene/queryparser/classic/package-summary.html) В Azure Cognitive Search простой синтаксис запроса исключает нечеткие/пологие варианты.  

> [!NOTE]
> Простой синтаксис запроса используется для выражения запроса, передаваемого в параметре **поиска** API [Поисковых документов,](https://docs.microsoft.com/rest/api/searchservice/search-documents) не следует путать с [синтаксисом OData,](query-odata-filter-orderby-syntax.md) используемым для [$filter](search-filters.md) параметра этого API. Эти различные синтаксисы имеют свои собственные правила для построения запросов, избегая строк и так далее.
>
> Azure Cognitive Search предоставляет альтернативный [полный синтаксис запроса Lucene](query-lucene-syntax.md) для более сложных запросов в параметре **поиска.** Чтобы узнать больше об архитектуре поиска запросов и преимуществах каждого синтаксиса, [см.](search-lucene-query-architecture.md)

## <a name="how-to-invoke-simple-parsing"></a>Вызов простого синтаксического анализа

Простой синтаксис включен по умолчанию. Вызов необходим только в том случае, если вы сбрасываете синтаксис с полного на простой. Чтобы явно установить синтаксис, используйте параметр поиска `queryType`. Допустимые значения: `simple|full` (`simple` как значение по умолчанию, а `full` как значение Lucene). 

## <a name="query-behavior-anomalies"></a>Аномальные поведения запросов

Любой текст с одним или несколькими терминами считается допустимой отправной точкой для выполнения запроса. Azure Cognitive Search будет соответствовать документам, содержащим все или все термины, включая любые вариации, найденные при анализе текста. 

Как бы просто это ни звучало, в Azure Cognitive Search есть один аспект выполнения запроса, который *может* привести к неожиданным результатам, увеличивая, а не уменьшая результаты поиска по мере добавления в строку ввода большего числа терминов и операторов. То, происходит ли такое расширение, зависит от наличия оператора NOT в сочетании с параметром `searchMode`, который определяет, как NOT интерпретируется в условиях с операторами AND или OR. Заданный по умолчанию режим `searchMode=Any` и оператор NOT приводят к тому, что операция вычисляется как действие OR, так что условие `"New York" NOT Seattle` вернет все города, кроме Сиэтла.  

Как правило, такое поведение с большей вероятностью можно увидеть в шаблонах взаимодействия пользователя с приложениями, которые выполняют поиск по содержимому. В таких шаблонах пользователи чаще включают в свои запросы операторы, в отличие от сайтов электронной коммерции, которые имеют больше встроенных структур навигации. Дополнительные сведения см. в разделе [Оператор NOT](#not-operator). 

## <a name="boolean-operators-and-or-not"></a>Boolean операторов (И, ИЛИ, НЕ) 

Можно встроить операторов в строку запроса, чтобы создать богатый набор критериев, по которым находятся соответствующие документы. 

### <a name="and-operator-"></a>Оператор AND `+`

Оператор AND представляет собой знак плюс. Например, условие `wifi+luxury` будет искать документы, содержащие и `wifi`, и `luxury`.

### <a name="or-operator-"></a>Оператор OR `|`

Оператор OR представляет собой вертикальную черту. Например, условие `wifi | luxury` будет искать документы, содержащие `wifi` или `luxury`, или и то и другое.

<a name="not-operator"></a>

### <a name="not-operator--"></a>Оператор NOT `-`

Оператор NOT представляет собой знак минус. Например, условие `wifi –luxury` будет искать документы, содержащие `wifi` и/или не содержащие `luxury` (это условие и/или контролируется параметром `searchMode`).

> [!NOTE]  
>  Параметр `searchMode` контролирует, является ли условие с оператором NOT логическим AND или логическим OR с другими условиями запроса в отсутствие операторов `+` или `|`. Напомним, что для `searchMode` можно установить значение `any` (по умолчанию) или `all`. Значение `any` увеличит количество повторных вызовов запросов, что даст большее количество результатов, и `-` по умолчанию интерпретируется как "OR NOT". Например, `wifi -luxury` соответствует документам, которые содержат термин `wifi`, или документам, которые не содержат термин `luxury`. Значение `all` увеличит точность запроса, что даст меньшее количество результатов, и "-" по умолчанию интерпретируется как "AND NOT". Например, `wifi -luxury` соответствует документам, которые содержат термин `wifi` и не содержат термин "luxury". Вероятно, это более интуитивное поведение оператора `-`. Поэтому вам следует рассмотреть возможность использования `searchMode=all` вместо `searchMode=any`, если вы хотите оптимизировать точность поиска (в ущерб повторным вызовам) *и* если ваши пользователи часто используют оператор `-` в своих поисковых запросах.

<a name="prefix-search"></a>

## <a name="suffix--operator-for-prefix-search"></a>Оператор суффикса `*` для поиска префикса

Оператор суффикса является `*`звездочкой. Например, при `cap*` будут найдены все документы, содержащие термин, начинающийся с `cap` (регистр игнорируется). 

Как и в том, что фильтры, запрос префикса ищет точное соответствие. Как таковой, нет актуальности скоринга (все результаты получают результаты поиска 1,0). Запросы префикса могут быть медленными, особенно если индекс большой и префикс состоит из небольшого количества символов. 

Если вы хотите выполнить запрос суффикса, соответствующий на последней части строки, используйте [поиск подстановочных знаков](query-lucene-syntax.md#bkmk_wildcard) и полный синтаксис Lucene.

## <a name="phrase-search-operator"></a>Оператор поиска по фразам 

Оператор фразы привязав `" "`фразу в кавычки. Например, при `Roach Motel` (без кавычек) будут найдены документы, содержащие `Roach` и/или `Motel` (в любом порядке), а при `"Roach Motel"` (с кавычками) будут найдены только те документы, в которых есть эта фраза целиком и с таким же порядком слов (анализ текста по-прежнему применяется).

## <a name="precedence-operator"></a>Оператор захвата 

Оператор приоритета замыкает строку в `( )`скобках. Например, `motel+(wifi | luxury)` будет искать документы, содержащие `wifi` термин `luxury` мотеля и либо или (или оба).  

## <a name="escaping-search-operators"></a>Поисковые операторы экранирования  

 Чтобы использовать вышеуказанные символы в качестве фактической части текста поиска, их следует экранировать, добавив к ним обратную косую черту. Например, `luxury\+hotel` в результате даст термин `luxury+hotel`. Чтобы упростить задачу для более типичных случаев, существует два исключения из этого правила, в которых экранирование не требуется.  

- Оператор NOT `-` необходимо экранировать только в том случае, если он является первым знаком после пробела, а не находится в середине термина. Например, `wi-fi` — это один термин, при этом значения GUID (например, `3352CDD0-EF30-4A2E-A512-3B30AF40F3FD`) обрабатываются как один токен.
- Постфиксный оператор `*` необходимо экранировать только в том случае, если он является последним знаком перед пробелом, а не находится в середине термина. Например, `wi*fi` обрабатывается как один токен.

> [!NOTE]  
>  Хотя экранирование сохраняет токены вместе, при анализе текста они могут разделяться в зависимости от режима анализа. Подробнее о [&#40;API Azure Cognitive Search REST&#41;](index-add-language-analyzers.md)  

## <a name="see-also"></a>См. также  

+ [Поиск документов &#40;Azure Когнитивный поиск REST API&#41;](https://docs.microsoft.com/rest/api/searchservice/Search-Documents) 
+ [Синтаксис запросов Lucene](query-lucene-syntax.md)
+ [Синтаксис выражений OData](query-odata-filter-orderby-syntax.md) 
