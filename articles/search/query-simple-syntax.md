---
title: Простой синтаксис запросов
titleSuffix: Azure Cognitive Search
description: Ссылка на простой синтаксис запроса, используемый для поиска полного текста в Azure Cognitive Search.
manager: nitinme
author: brjohnstmsft
ms.author: brjohnst
ms.service: cognitive-search
ms.topic: conceptual
ms.date: 04/12/2020
ms.openlocfilehash: 066190ff6b735d30db351ff90c0b6e5173b7f583
ms.sourcegitcommit: 8dc84e8b04390f39a3c11e9b0eaf3264861fcafc
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/13/2020
ms.locfileid: "81258870"
---
# <a name="simple-query-syntax-in-azure-cognitive-search"></a>Простой синтаксис запроса в когнитивном поиске Azure

Azure Cognitive Search реализует два языка запроса на основе Lucene: [простой запрос Parser](https://lucene.apache.org/core/6_6_1/queryparser/org/apache/lucene/queryparser/simple/SimpleQueryParser.html) и [Lucene Query Parser.](https://lucene.apache.org/core/6_6_1/queryparser/org/apache/lucene/queryparser/classic/package-summary.html) 

В Azure Cognitive Search простой синтаксис запроса исключает нечеткие поисковые операции. Вместо этого используйте полный синтаксис Lucene для [нечеткого поиска.](search-query-fuzzy.md)

> [!NOTE]
> Простой синтаксис запроса используется для выражения запроса, передаваемого в параметре **поиска** API [Поисковых документов,](https://docs.microsoft.com/rest/api/searchservice/search-documents) не следует путать с [синтаксисом OData,](query-odata-filter-orderby-syntax.md) используемым для [$filter](search-filters.md) параметра этого API. Эти различные синтаксисы имеют свои собственные правила для построения запросов, избегая строк и так далее.
>
> Azure Cognitive Search предоставляет альтернативный [полный синтаксис запроса Lucene](query-lucene-syntax.md) для более сложных запросов в параметре **поиска.** Чтобы узнать больше об архитектуре поиска запросов и преимуществах каждого синтаксиса, [см.](search-lucene-query-architecture.md)

## <a name="invoke-simple-parsing"></a>Вызвать простой разбор

Простой синтаксис включен по умолчанию. Вызов необходим только в том случае, если вы сбрасываете синтаксис с полного на простой. Чтобы явно установить синтаксис, используйте параметр поиска `queryType`. Допустимые `queryType=simple` значения `queryType=full`включают `simple` или , `full` где находится значение по умолчанию, и вызывает [полный parser запроса Lucene](query-lucene-syntax.md) для более продвинутых запросов. 

## <a name="syntax-fundamentals"></a> Основные сведения о синтаксисе

Любой текст с одним или несколькими терминами считается допустимой отправной точкой для выполнения запроса. Azure Cognitive Search будет соответствовать документам, содержащим все или все термины, включая любые вариации, найденные при анализе текста.

Как бы просто это ни звучало, в Azure Cognitive Search есть один аспект выполнения запроса, который *может* привести к неожиданным результатам, увеличивая, а не уменьшая результаты поиска по мере добавления в строку ввода большего числа терминов и операторов. Действительно ли это расширение происходит, зависит от включения оператора NOT, в сочетании с параметром **searchMode,** который определяет, как НЕ интерпретируется с точки зрения и или или поведения. Дополнительные сведения см. в разделе [Оператор NOT](#not-operator).

### <a name="precedence-operators-grouping"></a>Операторы прецедента (группировка)

Вы можете использовать круглые скобки, чтобы создать вложенные запросы, включая операторы в заключенной в скобки инструкции. Например, `motel+(wifi||luxury)` будет выполнять поиск документов, содержащих термин "motel" и "wifi" или "luxury" (или оба).

Группирование полей аналогично, но группирование ограничивается одним полем. Например, `hotelAmenities:(gym+(wifi||pool))` ищет в поле "hotelAmenities" термины "gym" и "wifi" или "gym" и "pool".  

### <a name="escaping-search-operators"></a>Поисковые операторы экранирования  

Для того, чтобы использовать любой из поисковых операторов в качестве части текста поиска, избежать символа, предварительно его с одной backslash (`\`). Например, для поиска подстановочных знаков на, `https://`где `://` находится `search=https\:\/\/*`часть строки запроса, вы укажете. Аналогичным образом, сбежавший шаблон `\+1 \(800\) 642\-7676`номера телефона может выглядеть следующим образом.

Специальные символы, требующие побега, включают в себя следующее:`- * ? \ /`  

Чтобы упростить задачу для более типичных случаев, существует два исключения из этого правила, в которых экранирование не требуется.  

+ Оператор NOT `-` необходимо экранировать только в том случае, если он является первым знаком после пробела, а не находится в середине термина. Например, следующий GUID действителен без `3352CDD0-EF30-4A2E-A512-3B30AF40F3FD`персонажа побега: .

+ Постфиксный оператор `*` необходимо экранировать только в том случае, если он является последним знаком перед пробелом, а не находится в середине термина. Например, `4*4=16` не требуется backslash.

> [!NOTE]  
> Хотя побег держит токены вместе, [лексический анализ](search-lucene-query-architecture.md#stage-2-lexical-analysis) во время индексации может лишить их. Например, стандартный анализатор Lucene будет удалять и ломать слова на дефисах, белом пространстве и других символах. Если требуется специальные символы в строке запроса, может потребоваться анализатор, который сохраняет их в индексе. Некоторые варианты включают [анализаторы](index-add-language-analyzers.md)естественного языка Майкрософт , который сохраняет дефисные слова, или пользовательский анализатор для более сложных шаблонов. Для получения дополнительной [информации см.](search-query-partial-matching.md)

### <a name="encoding-unsafe-and-reserved-characters-in-urls"></a>Кодирование небезопасных и зарезервированных знаков в URL-адресах

Убедитесь, что в URL-адресе закодированы все небезопасные и зарезервированные знаки. Например, «К» — это небезопасный символ, поскольку он является идентификатором фрагмента/якоря в URL-адресе. Знак должен быть закодирован как `%23`, если он используется в URL-адресе. «&» и «я» — это примеры зарезервированных символов, поскольку они разграничели параметры и указывают значения в Azure Cognitive Search. Для получения более подробной информации осваивай тесьмы [rFC1738: Единые локаторы ресурсов (URL)](https://www.ietf.org/rfc/rfc1738.txt) для получения более подробной информации.

Небезопасными знаками являются: ``" ` < > # % { } | \ ^ ~ [ ]``. Зарезервированными знаками являются: `; / ? : @ = + &`.

###  <a name="query-size-limits"></a><a name="bkmk_querysizelimits"></a>Ограничения по размеру запроса

 Размер запросов, которые можно отправить в Azure Cognitive Search, ограничен. В частности, вы можете иметь не более 1024 предложений (выражения, разделенные AND, OR и т. д.). Кроме того, размер любого отдельного термина в запросе не может превышать 32 КБ. Если приложение создает поисковые запросы программным способом, рекомендуется разрабатывать его таким образом, чтобы оно не создавало запросы неограниченного размера.  

## <a name="boolean-search"></a>Булеан поиска

Вы можете встроить boolean операторов (И, ИЛИ, НЕ) в строку запроса, чтобы построить богатый набор критериев, по которым находятся соответствующие документы. 

### <a name="and-operator-"></a>Оператор AND `+`

Оператор AND представляет собой знак плюс. Например, условие `wifi+luxury` будет искать документы, содержащие и `wifi`, и `luxury`.

### <a name="or-operator-"></a>Оператор OR `|`

Оператор OR представляет собой вертикальную черту. Например, условие `wifi | luxury` будет искать документы, содержащие `wifi` или `luxury`, или и то и другое.

<a name="not-operator"></a>

### <a name="not-operator--"></a>Оператор NOT `-`

Оператор NOT представляет собой знак минус. Например, `wifi –luxury` будет искать документы, которые имеют `wifi` термин `luxury`и / или не имеют .

Параметр **searchMode** в запросе запроса запроса контролирует, является ли термин с оператором NOT ANDed `+` `|` или ORed с другими терминами в запросе (при условии, что нет или оператора на других терминах). Допустимые значения: `any` и `all`.

`searchMode=any`увеличивает отзыв запросов, включив больше `-` результатов, и по умолчанию будет интерпретироваться как "ИЛИ НЕ". Например, `wifi -luxury` соответствует документам, которые содержат термин `wifi`, или документам, которые не содержат термин `luxury`.

`searchMode=all`повышает точность запросов, включая меньше результатов, и по умолчанию - будет интерпретироваться как "И НЕ". Например, `wifi -luxury` соответствует документам, которые содержат термин `wifi` и не содержат термин "luxury". Вероятно, это более интуитивное поведение оператора `-`. Поэтому следует использовать `searchMode=all` вместо `searchMode=any` того, чтобы оптимизировать поиск точности, а `-` не напомнить, *а* также использовать оператора в поисковых запросах.

При принятии решения о настройках **searchMode** учитывайте шаблоны взаимодействия пользователей для запросов в различных приложениях. Пользователи, которые ищут информацию, с большей вероятностью включают оператора в запрос, в отличие от сайтов электронной коммерции, которые имеют более встроенные навигационные структуры.

<a name="prefix-search"></a>

## <a name="prefix-search"></a>Поиск префикса

Оператор суффикса является `*`звездочкой. Например, `lingui*` найдут "лингвистический" или "лингвини", игнорируя случай. 

Как и в том, что фильтры, запрос префикса ищет точное соответствие. Как таковой, нет актуальности скоринга (все результаты получают результаты поиска 1,0). Запросы префикса могут быть медленными, особенно если индекс большой и префикс состоит из небольшого количества символов. 

Если вы хотите выполнить запрос суффикса, соответствующий на последней части строки, используйте [поиск подстановочных знаков](query-lucene-syntax.md#bkmk_wildcard) и полный синтаксис Lucene.

## <a name="phrase-search-"></a>Поиск фраз`"`

Поиск термина — это запрос на один или несколько терминов, где любой из терминов считается совпадением. Поиск фразы — это точная `" "`фраза, оговоренная в кавычках. Например, при `Roach Motel` (без кавычек) будут найдены документы, содержащие `Roach` и/или `Motel` (в любом порядке), а при `"Roach Motel"` (с кавычками) будут найдены только те документы, в которых есть эта фраза целиком и с таким же порядком слов (анализ текста по-прежнему применяется).

## <a name="see-also"></a>См. также раздел  

+ [Примеры запросов для простого поиска](search-query-simple-examples.md)
+ [Примеры запросов для полного поиска Lucene](search-query-lucene-examples.md)
+ [Поиск документов &#40;Azure Когнитивный поиск REST API&#41;](https://docs.microsoft.com/rest/api/searchservice/Search-Documents)
+ [Синтаксис запросов Lucene](query-lucene-syntax.md)
+ [Синтаксис выражений OData](query-odata-filter-orderby-syntax.md) 
