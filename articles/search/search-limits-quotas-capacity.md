---
title: Ограничения службы для уровней и SKU
titleSuffix: Azure Cognitive Search
description: Ограничения службы, используемые для планирования емкости и максимальных ограничений на запросы и ответы для Когнитивный поиск Azure.
manager: nitinme
author: HeidiSteen
ms.author: heidist
ms.service: cognitive-search
ms.topic: conceptual
ms.date: 12/17/2019
ms.openlocfilehash: 690a9751111ca4c86ebb34825f2845ea59d6f186
ms.sourcegitcommit: f4f626d6e92174086c530ed9bf3ccbe058639081
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/25/2019
ms.locfileid: "75462491"
---
# <a name="service-limits-in-azure-cognitive-search"></a>Ограничения службы в Azure Когнитивный поиск

Максимальные ограничения на хранилище, рабочие нагрузки и количество индексов и других объектов зависят от того, [подготавливаются ли когнитивный Поиск Azure](search-create-service-portal.md) на уровне " **бесплатный**", " **базовый**", " **стандартный**" или " **оптимизированный для хранилища** " ценовой уровень.

+ **Бесплатный** представляет собой мультитенантную службу, которая предоставляется вместе с подпиской Azure. Запросы индексирования и запросов выполняются в репликах и секциях, используемых другими клиентами.

+ **Basic** предоставляет выделенные вычислительные ресурсы для рабочих нагрузок меньшего размера, но использует некоторую сетевую инфраструктуру с другими клиентами.

+ Для уровня **Стандартный** используются выделенные виртуальные машины. Это обеспечивает увеличение емкости хранилища и вычислительной мощности на всех уровнях. В категории "Стандартный" доступно четыре уровня: S1, S2, S3 и S3 HD (S3, высокая плотность).

+ **Оптимизация хранилища** выполняется на выделенных компьютерах с более общим хранилищем, пропускной способностью хранилища и памятью, чем **стандартные**. Оптимизированный для хранилища объем в 2 уровня: L1 и L2

> [!NOTE]
> По состоянию на 1 июля все уровни общедоступны, включая уровень, оптимизированный для хранилища. Все цены можно найти на странице [сведений о ценах](https://azure.microsoft.com/pricing/details/search/) .

  Уровень S3 HD (S3, высокая плотность) разработан для рабочих нагрузок с особыми характеристиками: [мультитенантность](search-modeling-multitenant-saas-applications.md) и большое количество небольших индексов (до миллиона документов на индекс, до трех тысяч индексов на каждую службу). На этом уровне не предоставляется [компонент индексатора](search-indexer-overview.md). На уровне S3 HD прием данных необходимо выполнять через механизм push, то есть передавать данные из источника в индекс с помощью вызовов API. 

> [!NOTE]
> Служба подготавливается на определенном уровне. Чтобы перейти к другому уровню для получения дополнительной емкости, нужно подготовить новую службу (обновление на месте не поддерживается). Дополнительные сведения см. в статье [Выбор SKU или ценовой категории для службы поиска Azure](search-sku-tier.md). Чтобы узнать больше о настройке емкости в уже подготовленной службе, ознакомьтесь с разделом [Масштабирование уровней ресурсов для рабочих нагрузок запросов и индексирования в Поиске Azure](search-capacity-planning.md).
>

## <a name="subscription-limits"></a>Ограничения подписки
[!INCLUDE [azure-search-limits-per-subscription](../../includes/azure-search-limits-per-subscription.md)]

## <a name="storage-limits"></a>Ограничения хранилища
[!INCLUDE [azure-search-limits-per-service](../../includes/azure-search-limits-per-service.md)]

<a name="index-limits"></a>

## <a name="index-limits"></a>Ограничения индексов

| Ресурс | Бесплатные | Базовый&nbsp;<sup>1</sup>  | S1 | S2 | S3 | S3&nbsp;HD | L1 | L2 |
| -------- | ---- | ------------------- | --- | --- | --- | --- | --- | --- |
| Максимальное число индексов |3 |5 или 15 |50 |200 |200 |1000 на секцию или 3000 на службу |10 |10 |
| Максимальное число простых полей на индекс |1000 |100 |1000 |1000 |1000 |1000 |1000 |1000 |
| Максимум сложных полей коллекций на индекс |40 |40 |40 |40 |40 |40 |40 |40 |
| Максимальное число элементов во всех сложных коллекциях на документ&nbsp;<sup>2</sup> |3000 |3000 |3000 |3000 |3000 |3000 |3000 |3000 |
| Максимальная глубина сложных полей |10 |10 |10 |10 |10 |10 |10 |10 |
| Максимальное число [средств подбора](https://docs.microsoft.com/rest/api/searchservice/suggesters) на индекс |1 |1 |1 |1 |1 |1 |1 |1 |
| Максимальное число [профилей оценки](https://docs.microsoft.com/rest/api/searchservice/add-scoring-profiles-to-a-search-index) на индекс |100 |100 |100 |100 |100 |100 |100 |100 |
| Максимальное число функций на профиль |8 |8 |8 |8 |8 |8 |8 |8 |

<sup>1</sup> базовые службы, созданные до декабря 2017, имеют низкие пределы (5 вместо 15) на индексах. Уровень "Базовый" — единственный SKU с ограничением в минимум 100 полей на индекс.

<sup>2</sup> наличие очень большого количества элементов в сложных коллекциях на один документ в настоящее время приводит к высокой загрузке хранилища. Это известная проблема В то же время ограничение в 3000 является надежной верхней границей для всех уровней служб. Это ограничение применяется только для операций индексирования, использующих самую раннюю общедоступную версию API, которая поддерживает поля сложных типов (`2019-05-06`). Чтобы не прерывать работу клиентов, которые могут использовать более ранние версии API предварительного просмотра (поддерживающие поля сложных типов), мы не будем применять это ограничение для операций индексирования, использующих эти версии API предварительного просмотра. Обратите внимание, что версии API предварительного просмотра не предназначены для использования в рабочих сценариях, и мы настоятельно рекомендуем клиентам перейти на последнюю версию API общедоступной версии.

<a name="document-limits"></a>

## <a name="document-limits"></a>Ограничения документов 

По состоянию на октябрь 2018 года больше нет никаких ограничений для новых служб, созданных на каком либо платном уровне (Basic, S1, S2, S3, S3 HD) в любом регионе. В то время как в большинстве регионов количество документов не ограничено с ноября по Декабрьу 2017, в течение этого времени существовало несколько регионов, которые продолжают накладывать ограничения документа. В зависимости от того, когда и где вы создали службу поиска, вы можете запустить службу, которая по-прежнему накладывает ограничения на документ.

Чтобы определить, есть ли у службы ограничения по документам, используйте [REST API получения статистики службы](https://docs.microsoft.com/rest/api/searchservice/get-service-statistics). Ограничения документов отражаются в ответе с `null`, указывающей на отсутствие ограничений.

> [!NOTE]
> Несмотря на отсутствие ограничений для конкретного номера SKU, каждый индекс по-прежнему подвергается максимально надежному ограничению, чтобы обеспечить стабильность работы службы. Это ограничение поступает из Lucene. Каждый документ Azure Когнитивный поиск внутренне индексируется как один или несколько документов Lucene. Число документов Lucene на документ поиска зависит от общего числа элементов в сложных полях коллекции. Каждый элемент индексируется как отдельный документ Lucene. Например, документ с 3 элементами в сложном поле коллекции будет индексироваться как 4 документа Lucene — 1, а для элементов — 3. Максимальное число документов Lucene — примерно 25 000 000 000 на индекс.

### <a name="regions-previously-having-document-limits"></a>Регионы, ранее имеющие ограничения на документы

Если на портале указано ограничение на число документов, то служба была создана до выхода последних 2017 или создана в центре обработки данных с использованием кластеров более низкого уровня для размещения служб Когнитивный поиск Azure:

+ Восточная Австралия
+ Восточная Азия
+ Центральная Индия
+ Западная Япония
+ Центрально-западная часть США

Для соответствующих служб применяются следующие ограничения:

|  Бесплатные | "Базовый" | S1 | S2 | S3 | S3&nbsp;HD |
|-------|-------|----|----|----|-------|
|  10 000 |1&nbsp;миллион |15 млн на секцию или 180 млн на службу |60 млн на секцию или 720 млн на службу |120 млн на секцию или 1,4 млрд на службу |1 млн на индекс или 200 млн на секцию |

Если служба имеет ограничения, которые блокируют вас, создать новую службу и повторно опубликуйте все содержимое в эту службу. Не существует механизма для беспрепятственного воспроизведения службы на новом оборудовании сопутствующих ресурсов.

> [!Note] 
> В службах уровня S3 с высокой плотностью, созданных в конце 2017 года, устранено ограничение в 200 миллионов документов на раздел, но ограничение в 1 миллион документов на индекс осталось.


### <a name="document-size-limits-per-api-call"></a>Ограничения размера документа на один вызов API

Максимальный размер документа при вызове API индекса составляет примерно 16 МБ.

Фактически размер документа ограничивает размер текста запроса API индекса. Так как API индекса позволяет одновременно передать пакет из нескольких документов, фактически предельный размер зависит от количества документов в таком пакете. Для пакета с одним документом максимальный размер документа составляет 16 МБ данных JSON.

Чтобы уменьшить размер документа, не забудьте исключить из запроса недоступные для запроса данные. Образы и другие двоичные данные не запрашиваются напрямую и не должны храниться в индексе. Чтобы добавить в результаты поиска недоступные для запроса данные, определите поле, недоступное для поиска, в котором хранится ссылка на URL-адрес ресурса.

## <a name="indexer-limits"></a>Ограничения индексатора

Для обеспечения баланса и стабильности службы в целом существует максимально допустимое время выполнения, но большие наборы данных могут потребовать больше времени индексирования, чем максимально допустимое. Если задание индексирования не может завершиться в течение максимально допустимого времени ожидания, попробуйте запустить его по расписанию. Планировщик сохраняет сведения о состоянии индексирования. Если запланированное задание индексирования прервано по какой-либо причине, индексатор может продолжить выполнение с того же места при следующем запланированном выполнении.


| Ресурс | Бесплатный&nbsp;<sup>1</sup> | Базовый&nbsp;<sup>2</sup>| S1 | S2 | S3 | S3&nbsp;HD&nbsp;<sup>3</sup>|L1 |L2 |
| -------- | ----------------- | ----------------- | --- | --- | --- | --- | --- | --- |
| Максимальное число индексаторов |3 |5 или 15|50 |200 |200 |Н/Д |10 |10 |
| Максимальное количество источников данных |3 |5 или 15 |50 |200 |200 |Н/Д |10 |10 |
| Максимальное число наборов квалификационных навыков <sup>4</sup> |3 |5 или 15 |50 |200 |200 |Н/Д |10 |10 |
| Максимальная нагрузка индексирования на вызов |10 000 документов |Ограничивается только максимальным числом документов |Ограничивается только максимальным числом документов |Ограничивается только максимальным числом документов |Ограничивается только максимальным числом документов |Н/Д |Без ограничений |Без ограничений |
| Минимальное расписание | 5 мин |5 мин |5 мин |5 мин |5 мин |5 мин |5 мин | 5 мин |
| Максимальное время выполнения<sup>5</sup> | 1–3 мин |24 часа |24 часа |24 часа |24 часа |Н/Д  |24 часа |24 часа |
| Максимальное время выполнения наборов квалификационных навыков когнитивного поиска или индексирования больших двоичных объектов с помощью анализа образов<sup>5</sup> | 3–10 минут |2 часа |2 часа |2 часа |2 часа |Н/Д  |2 часа |2 часа |
| Индексатор BLOB-объектов: максимальный размер BLOB-объектов в МБ |16 |16 |128 |256 |256 |Н/Д  |256 |256 |
| Индексатор BLOB-объектов: максимальное число символов в содержимом, извлеченном из BLOB-объекта |32 000 |64 000 |4&nbsp;млн |4&nbsp;млн |4&nbsp;млн |Н/Д |4&nbsp;млн |4&nbsp;млн |

<sup>1</sup> Максимальное время выполнения индексатора для служб уровня "Бесплатный" составляет 3 минуты для источников больших двоичных объектов или 1 минуту для прочих источников данных. Для индексирования искусственного интеллекта, которое вызывает Cognitive Services, бесплатные службы ограничены 20 свободными транзакциями в день, где транзакция определяется как документ, успешно прошедший через конвейер обогащения.

<sup>2</sup> базовые службы, созданные до декабря 2017, имеют более низкие пределы (5 вместо 15) на индексаторах, источниках данных и навыков.

<sup>3</sup> Службы уровня S3 HD не поддерживают индексаторы.

<sup>4</sup> До 30 навыков на набор квалификационных навыков.

<sup>5</sup>. Рабочие нагрузки когнитивного поиска и анализ образов в индексировании больших двоичных объектов Azure выполняются быстрее, чем обычное индексирование текста. Анализ образов и обработка естественного языка требуют интенсивных вычислений и потребляют непропорциональные объемы доступных вычислительных мощностей. Время выполнения было уменьшено, чтобы могли выполняться другие задания в очереди.  

> [!NOTE]
> Как указано в [ограничениях индекса](#index-limits), индексаторы также применяют верхний предел 3000 элементов во всех сложных коллекциях к документу, начиная с последней версии API общедоступного типа, которая поддерживает сложные типы (`2019-05-06`). Это означает, что если вы создали индексатор с предыдущей версией API, вы не будете подвергаться этому ограничению. Чтобы сохранить максимальную совместимость, индексатор, созданный с помощью предыдущей версии API, а затем обновленный с помощью API версии `2019-05-06` или более поздней, будет по-прежнему **исключен** из ограничений. Клиентам следует знать о неблагоприятных последствиях наличия очень больших сложных коллекций (как упоминалось ранее), и мы настоятельно рекомендуем создавать новые индексаторы с последней версией API общедоступной версии.

## <a name="synonym-limits"></a>Ограничения синонимов

Максимально допустимое число сопоставлений синонимов зависит от ценовой категории. Каждое правило может иметь до 20 расширений, в которых расширение является эквивалентным термином. Например, при наличии "Cat" Ассоциация с "мяу", "фелине" и "Фелис" (женус для кошки) будет считаться 3 расширениями.

| Ресурс | Бесплатные | "Базовый" | S1 | S2 | S3 | S3 — HD |L1 | L2 |
| -------- | -----|------ |----|----|----|-------|---|----|
| Максимальное число сопоставлений синонимов |3 |3|5 |10 |20 |20 | 10 | 10 |
| Максимальное число правил на карту |5000 |20 000|20 000 |20 000 |20 000 |20 000 | 20 000 | 20 000  |

## <a name="queries-per-second-qps"></a>Число запросов в секунду (QPS)

Оценка QPS должна отдельно проводиться каждым клиентом. Основными определителями QPS являются размер и сложность индексов, размер и сложность запросов, а также объем трафика. Если такие факторы неизвестны, оценка не будет информативной.

Прогнозируемость показателей повышается, если оцениваются службы, работающие в выделенных ресурсах (категорий "Базовый" и "Стандартный"). Можно точнее оценить QPS, так как вы можете контролировать больше параметров. Рекомендации по оценке см. в статье [производительность и оптимизация когнитивный Поиск Azure](search-performance-optimization.md).

Для уровней, оптимизированных для хранилища, следует рассчитывать на меньшую пропускную способность запросов и более высокую задержку по сравнению со стандартными уровнями.  Методология оценки производительности запросов, которую вы будете испытывать, аналогична стандартным уровням.

## <a name="data-limits-ai-enrichment"></a>Ограничения данных (обогащение искусственного интеллекта)

[Конвейер обогащения искусственного интеллекта](cognitive-search-concept-intro.md) , который обращается к анализ текста ресурсу для [распознавания сущностей](cognitive-search-skill-entity-recognition.md), [извлечения ключевых фраз](cognitive-search-skill-keyphrases.md), [анализа тональности](cognitive-search-skill-sentiment.md)и [определения языка](cognitive-search-skill-language-detection.md) , зависит от ограничений данных. Максимальный размер записи должен составлять 50 000 символов, измеряемый [`String.Length`](https://docs.microsoft.com/dotnet/api/system.string.length). Если вам нужно разбить данные перед отправкой в анализатор тональности, можно воспользоваться [навыком разделения текста](cognitive-search-skill-textsplit.md).

## <a name="throttling-limits"></a>Ограничения регулирования

Запросы поиска и индексирования будут регулироваться, так как система приближается к пиковой емкости. Регулирование ведет себя по-разному для разных интерфейсов API. API запросов (Поиск/предложение/автозаполнение) и API индексирования динамически регулируются в зависимости от нагрузки на службу. API-интерфейсы индекса имеют статические ограничения частоты запросов. 

Ограничения запросов статической скорости для операций, связанных с индексом:

+ Список индексов (GET/индексес): 5 в секунду на единицу поиска
+ Получение индекса (GET/индексес/Миндекс): 10 в секунду на единицу поиска
+ Создание индекса (POST/индексес): 12 в минуту на единицу поиска
+ Создание или обновление индекса (помещает/индексес/Миндекс): 6 в секунду на единицу поиска
+ Удаление индекса (DELETE/индексес/Миндекс): 12 в минуту на единицу поиска 

## <a name="api-request-limits"></a>Ограничения запросов API
* Максимум 16 МБ на один запрос <sup>1</sup>
* Максимальная длина URL-адреса — 8 КБ.
* Максимум 1000 документов на одну операцию загрузки индексов, объединения или удаления.
* Максимум 32 поля в предложении $orderby.
* Максимальный размер поискового запроса — 32 766 байтов (32 КБ минус 2 байта) текста в кодировке UTF-8.

<sup>1</sup> в Azure когнитивный Поиск в тексте запроса наложено верхнее ограничение в 16 МБ, установления практический лимит на содержимое отдельных полей или коллекций, которые в противном случае не ограничены теоретическыми ограничениями (см. раздел [Поддерживаемые типы данных](https://docs.microsoft.com/rest/api/searchservice/supported-data-types) для получения дополнительных сведений о составлении полей и ограничениях).

## <a name="api-response-limits"></a>Ограничения ответа API
* Максимум 1000 документов на одну страницу результатов поиска.
* Максимум 100 предложений на один запрос API предложений.

## <a name="api-key-limits"></a>Ограничения ключей API
Ключи API используются для проверки подлинности служб. Существует два типа ключей. Ключи администратора указываются в заголовке запроса и предоставляют доступ к службе на чтение и запись. Ключи запросов доступны только для чтения, они указываются в URL-адресе и обычно передаются в клиентские приложения.

* Максимум 2 ключа администратора на одну службу.
* Максимум 50 ключей запросов на одну службу.