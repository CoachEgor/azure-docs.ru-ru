---
title: Ограничения обслуживания для уровней и skus
titleSuffix: Azure Cognitive Search
description: Ограничения служб, используемые для планирования емкости, и максимальные ограничения на запросы и ответы для Azure Cognitive Search.
manager: nitinme
author: HeidiSteen
ms.author: heidist
ms.service: cognitive-search
ms.topic: conceptual
ms.date: 12/17/2019
ms.openlocfilehash: 6ee339cb709a5d825b39b4accf294761c99ee41a
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "79282982"
---
# <a name="service-limits-in-azure-cognitive-search"></a>Service limits in Azure Cognitive Search (Ограничения службы в Когнитивном поиске Azure)

Максимальные ограничения на хранение, рабочие нагрузки и количество индексов и других объектов зависят от того, предоставляете ли вы [Azure Cognitive Search](search-create-service-portal.md) в **Свободном,** **Базовом,** **Стандартном, Или** **Оптимизированном** уровне цен на хранилище.

+ **Бесплатный** представляет собой мультитенантную службу, которая предоставляется вместе с подпиской Azure. Запросы индексирования и запроса выполняются на репликах и разделах, используемых другими арендаторами.

+ **Basic** предоставляет специальные вычислительные ресурсы для производственных нагрузок в меньших масштабах, но разделяет некоторую сетевую инфраструктуру с другими арендаторами.

+ **Стандарт** работает на специализированных машинах с большим объемом памяти и обработки на каждом уровне. В категории "Стандартный" доступно четыре уровня: S1, S2, S3 и S3 HD (S3, высокая плотность).

+ **Хранение Оптимизированные** работает на выделенных машинах с более полным объемом хранения, пропускной способностью и памятью, чем **Standard.** Оптимизированное хранилище поставляется в двух уровнях: L1 и L2

> [!NOTE]
> По состоянию на 1 июля, все уровни, как правило, доступны, в том числе хранения Оптимизированный уровень. Все цены можно найти на странице [Цены Подробная информация.](https://azure.microsoft.com/pricing/details/search/)

  Уровень S3 HD (S3, высокая плотность) разработан для рабочих нагрузок с особыми характеристиками: [мультитенантность](search-modeling-multitenant-saas-applications.md) и большое количество небольших индексов (до миллиона документов на индекс, до трех тысяч индексов на каждую службу). На этом уровне не предоставляется [компонент индексатора](search-indexer-overview.md). На уровне S3 HD прием данных необходимо выполнять через механизм push, то есть передавать данные из источника в индекс с помощью вызовов API. 

> [!NOTE]
> Служба подготавливается на определенном уровне. Чтобы перейти к другому уровню для получения дополнительной емкости, нужно подготовить новую службу (обновление на месте не поддерживается). Дополнительные сведения см. в статье [Выбор SKU или ценовой категории для службы поиска Azure](search-sku-tier.md). Чтобы узнать больше о настройке емкости в уже подготовленной службе, ознакомьтесь с разделом [Масштабирование уровней ресурсов для рабочих нагрузок запросов и индексирования в Поиске Azure](search-capacity-planning.md).
>

## <a name="subscription-limits"></a>Ограничения подписки
[!INCLUDE [azure-search-limits-per-subscription](../../includes/azure-search-limits-per-subscription.md)]

## <a name="storage-limits"></a>Ограничения хранилища
[!INCLUDE [azure-search-limits-per-service](../../includes/azure-search-limits-per-service.md)]

<a name="index-limits"></a>

## <a name="index-limits"></a>Ограничения индексов

| Ресурс | Free | Базовый&nbsp;<sup>1</sup>  | S1 | S2 | S3 | S3&nbsp;HD | L1 | L2 |
| -------- | ---- | ------------------- | --- | --- | --- | --- | --- | --- |
| Максимальное число индексов |3 |5 или 15 |50 |200 |200 |1000 на секцию или 3000 на службу |10 |10 |
| Максимальное количество простых полей на индекс |1000 |100 |1000 |1000 |1000 |1000 |1000 |1000 |
| Максимальное сложное поле сбора на индекс |40 |40 |40 |40 |40 |40 |40 |40 |
| Максимальные элементы во&nbsp;всех сложных коллекциях на документ<sup>2</sup> |3000 |3000 |3000 |3000 |3000 |3000 |3000 |3000 |
| Максимальная глубина сложных полей |10 |10 |10 |10 |10 |10 |10 |10 |
| Максимальное число [средств подбора](https://docs.microsoft.com/rest/api/searchservice/suggesters) на индекс |1 |1 |1 |1 |1 |1 |1 |1 |
| Максимальное число [профилей оценки](https://docs.microsoft.com/rest/api/searchservice/add-scoring-profiles-to-a-search-index) на индекс |100 |100 |100 |100 |100 |100 |100 |100 |
| Максимальное число функций на профиль |8 |8 |8 |8 |8 |8 |8 |8 |

<sup>1</sup> Базовые услуги, созданные до декабря 2017 года, имеют более низкие лимиты (5 вместо 15) по индексам. Уровень "Базовый" — единственный SKU с ограничением в минимум 100 полей на индекс.

<sup>2</sup> Наличие очень большого количества элементов в сложных коллекциях на один документ в настоящее время приводит к высокому использованию хранилища. Это известная проблема В то же время, предел 3000 является безопасной верхней границы для всех уровней обслуживания. Это ограничение применяется только для операций индексирования, использующих самую раннюю общедоступную (GA) версию API, которая поддерживает сложные поля типа ()`2019-05-06`далее. Чтобы не ломать клиентов, которые могут использовать более ранние версии API(поддерживающие сложные поля типа), мы не будем применять этот предел для операций по индексации, использующих эти версии API предварительного просмотра. Обратите внимание, что версии API предварительного просмотра не предназначены для использования в производственных сценариях, и мы настоятельно рекомендуем клиентам перейти к последней версии GA API.

<a name="document-limits"></a>

## <a name="document-limits"></a>Ограничения документов 

По состоянию на октябрь 2018 года больше нет никаких ограничений для новых служб, созданных на каком либо платном уровне (Basic, S1, S2, S3, S3 HD) в любом регионе. Хотя с ноября-декабря 2017 года в большинстве регионов было неограниченное количество документов, в ряде регионов, которые продолжали вводить ограничения на документы после этой даты. В зависимости от того, когда и где вы создали службу поиска, вы можете запустить службу, которая по-прежнему накладывает ограничения на документ.

Чтобы определить, есть ли в вашей службе ограничения на документы, используйте [API статистики обслуживания GET.](https://docs.microsoft.com/rest/api/searchservice/get-service-statistics) Ограничения документов отражаются в ответе, с `null` указанием никаких ограничений.

> [!NOTE]
> Несмотря на то, что нет никаких ограничений sKU, каждый индекс по-прежнему подвергается максимальному безопасному ограничению для обеспечения стабильности службы. Это ограничение исходит от Люсины. Каждый документ Azure Cognitive Search внутренне проиндексирован как один или несколько документов Lucene. Количество документов Lucene на один поисковый документ зависит от общего количества элементов в сложных полях сбора. Каждый элемент проиндексирован как отдельный документ Lucene. Например, документ с 3 элементами в области сложного сбора будет проиндексирован как 4 lucene документа - 1 для самого документа и 3 для элементов. Максимальное количество документов Lucene составляет примерно 25 миллиардов на индекс.

### <a name="regions-previously-having-document-limits"></a>Регионы, ранее имеющие ограничения на документы

Если портал указывает лимит документов, служба была создана либо до конца 2017 года, либо она была создана в центре обработки данных с использованием кластеров с низкой емкости для размещения служб Azure Cognitive Search:

+ Восточная Австралия
+ Восточная Азия
+ Центральная Индия
+ Западная Япония
+ центрально-западная часть США

Для соответствующих служб применяются следующие ограничения:

|  Free | Basic | S1 | S2 | S3 | S3&nbsp;HD |
|-------|-------|----|----|----|-------|
|  10 000 |1&nbsp;миллион |15 млн на секцию или 180 млн на службу |60 млн на секцию или 720 млн на службу |120 млн на секцию или 1,4 млрд на службу |1 млн на индекс или 200 млн на секцию |

Если служба имеет ограничения, которые блокируют вас, создать новую службу и повторно опубликуйте все содержимое в эту службу. Не существует механизма для беспрепятственного воспроизведения службы на новом оборудовании сопутствующих ресурсов.

> [!Note] 
> В службах уровня S3 с высокой плотностью, созданных в конце 2017 года, устранено ограничение в 200 миллионов документов на раздел, но ограничение в 1 миллион документов на индекс осталось.


### <a name="document-size-limits-per-api-call"></a>Ограничения размера документа на один вызов API

Максимальный размер документа при вызове API индекса составляет примерно 16 МБ.

Фактически размер документа ограничивает размер текста запроса API индекса. Так как API индекса позволяет одновременно передать пакет из нескольких документов, фактически предельный размер зависит от количества документов в таком пакете. Для пакета с одним документом максимальный размер документа составляет 16 МБ данных JSON.

Чтобы уменьшить размер документа, не забудьте исключить из запроса недоступные для запроса данные. Образы и другие двоичные данные не запрашиваются напрямую и не должны храниться в индексе. Чтобы добавить в результаты поиска недоступные для запроса данные, определите поле, недоступное для поиска, в котором хранится ссылка на URL-адрес ресурса.

## <a name="indexer-limits"></a>Ограничения индексатора

Максимальное время работы существует, чтобы обеспечить баланс и стабильность службы в целом, но большие наборы данных, возможно, потребуется больше времени на индексацию, чем максимум позволяет. Если задание индексирования не может завершиться в течение максимально допустимого времени ожидания, попробуйте запустить его по расписанию. Планировщик сохраняет сведения о состоянии индексирования. Если запланированное задание индексирования прервано по какой-либо причине, индексатор может продолжить выполнение с того же места при следующем запланированном выполнении.


| Ресурс | Бесплатный&nbsp;<sup>1</sup> | Базовый&nbsp;<sup>2</sup>| S1 | S2 | S3 | S3&nbsp;HD&nbsp;<sup>3</sup>|L1 |L2 |
| -------- | ----------------- | ----------------- | --- | --- | --- | --- | --- | --- |
| Максимальное число индексаторов |3 |5 или 15|50 |200 |200 |Недоступно |10 |10 |
| Максимальное количество источников данных |3 |5 или 15 |50 |200 |200 |Недоступно |10 |10 |
| Максимальное число наборов квалификационных навыков <sup>4</sup> |3 |5 или 15 |50 |200 |200 |Недоступно |10 |10 |
| Максимальная нагрузка индексирования на вызов |10 000 документов |Ограничивается только максимальным числом документов |Ограничивается только максимальным числом документов |Ограничивается только максимальным числом документов |Ограничивается только максимальным числом документов |Недоступно |Без ограничений |Без ограничений |
| Минимальное расписание | 5 мин |5 мин |5 мин |5 мин |5 мин |5 мин |5 мин | 5 мин |
| Максимальное время выполнения<sup>5</sup> | 1–3 мин |24 часа |24 часа |24 часа |24 часа |Недоступно  |24 часа |24 часа |
| Максимальное время выполнения наборов квалификационных навыков когнитивного поиска или индексирования больших двоичных объектов с помощью анализа образов<sup>5</sup> | 3–10 минут |2 часа |2 часа |2 часа |2 часа |Недоступно  |2 часа |2 часа |
| Индексатор BLOB-объектов: максимальный размер BLOB-объектов в МБ |16 |16 |128 |256 |256 |Недоступно  |256 |256 |
| Индексатор BLOB-объектов: максимальное число символов в содержимом, извлеченном из BLOB-объекта |32 000 |64 000 |4&nbsp;миллиона |8&nbsp;миллионов |16&nbsp;миллионов |Недоступно |4&nbsp;миллиона |4&nbsp;миллиона |

<sup>1</sup> Максимальное время выполнения индексатора для служб уровня "Бесплатный" составляет 3 минуты для источников больших двоичных объектов или 1 минуту для прочих источников данных. Для индексации ИИ, которая переходит в Cognitive Services, бесплатные услуги ограничены 20 бесплатными транзакциями в день, когда транзакция определяется как документ, который успешно проходит через конвейер обогащения.

<sup>2</sup> Базовые сервисы, созданные до декабря 2017 года, имеют более низкие лимиты (5 вместо 15) на индексы, источники данных и навыки.

<sup>3</sup> Службы уровня S3 HD не поддерживают индексаторы.

<sup>4</sup> До 30 навыков на набор квалификационных навыков.

<sup>5</sup>. Рабочие нагрузки когнитивного поиска и анализ образов в индексировании больших двоичных объектов Azure выполняются быстрее, чем обычное индексирование текста. Анализ образов и обработка естественного языка требуют интенсивных вычислений и потребляют непропорциональные объемы доступных вычислительных мощностей. Время выполнения было уменьшено, чтобы могли выполняться другие задания в очереди.  

> [!NOTE]
> Как указано в [ограничениях индекса,](#index-limits)индексы также будут применять верхний предел 3000 элементов во всех сложных коллекциях на документ, начиная с последней версии GA API, которая поддерживает сложные типы ()`2019-05-06`далее. Это означает, что если вы создали индексатор с предварительной версией API, на вас не будет распространяться этот лимит. Чтобы сохранить максимальную совместимость, индексер, который был создан с предыдущей версией API, а затем обновлен с версией `2019-05-06` API или позже, по-прежнему будет **исключен** из лимитов. Клиенты должны знать о негативном воздействии наличия очень больших сложных коллекций (как указано ранее), и мы настоятельно рекомендуем создавать новые индексы с последней версией GA API.

## <a name="synonym-limits"></a>Ограничения синонимов

Максимальное количество разрешенных синонимных карт варьируется в зависимости от уровня ценообразования. Каждое правило может иметь до 20 расширений, где расширение является эквивалентным термином. Например, учитывая "кошка", ассоциация с "китти", "кошачий", и "фелис" (род для кошек) будет рассчитывать как 3 расширения.

| Ресурс | Free | Basic | S1 | S2 | S3 | S3-HD |L1 | L2 |
| -------- | -----|------ |----|----|----|-------|---|----|
| Максимальные карты синонимов |3 |3|5 |10 |20 |20 | 10 | 10 |
| Максимальное количество правил на карту |5000 |20 000|20 000 |20 000 |20 000 |20 000 | 20 000 | 20 000  |

## <a name="queries-per-second-qps"></a>Число запросов в секунду (QPS)

Оценка QPS должна отдельно проводиться каждым клиентом. Основными определителями QPS являются размер и сложность индексов, размер и сложность запросов, а также объем трафика. Если такие факторы неизвестны, оценка не будет информативной.

Прогнозируемость показателей повышается, если оцениваются службы, работающие в выделенных ресурсах (категорий "Базовый" и "Стандартный"). Можно точнее оценить QPS, так как вы можете контролировать больше параметров. Для получения рекомендаций о [Azure Cognitive Search performance and optimization](search-performance-optimization.md)том, как подойти к оценке, см.

Для оптимизированных уровней хранения следует ожидать более низкую пропускную емкость запроса и более высокую задержку, чем стандартные уровни.  Методология оценки производительности запроса, которая будет проходить, такая же, как и уровень Стандарта.

## <a name="data-limits-ai-enrichment"></a>Ограничения данных (обогащение ИИ)

[Конвейер обогащения ИИ,](cognitive-search-concept-intro.md) который делает звонки на ресурс Text Analytics для [распознавания сущности,](cognitive-search-skill-entity-recognition.md) [извлечение ключевых фраз,](cognitive-search-skill-keyphrases.md) [анализ настроений,](cognitive-search-skill-sentiment.md) [обнаружение языка](cognitive-search-skill-language-detection.md)и обнаружение [PII,](cognitive-search-skill-pii-detection.md) подлежит ограничению данных. Максимальный размер записи должен соразмеровать 50 000 [`String.Length`](https://docs.microsoft.com/dotnet/api/system.string.length)символов. Если вам нужно разбить данные перед отправкой в анализатор тональности, можно воспользоваться [навыком разделения текста](cognitive-search-skill-textsplit.md).

## <a name="throttling-limits"></a>Ограничения для дроссельной заслонки

Запросы на поиск запросов и индексирования замедляются по мере приближения к пиковой емкости системы. Дроссевание ведет себя по-разному для различных AIS. AIS запросов (Search/Suggest/Autocomplete) и индексация AIS динамически на основе нагрузки на службу. Индексные AIS имеют статические ограничения скорости запроса. 

Ограничения запроса статической ставки для операций, связанных с индексом:

+ Индексы списка (GET /индексы): 5 в секунду на единицу поиска
+ Получить индекс (GET /индексы/мииндекс): 10 в секунду на единицу поиска
+ Создание индекса (POST /индексы): 12 в минуту на единицу поиска
+ Создание или обновление индекса (PUT /индексы/мииндекс): 6 в секунду на единицу поиска
+ Удаление индекса (DELETE /индексы/мииндекс): 12 в минуту на единицу поиска 

## <a name="api-request-limits"></a>Ограничения запроса API
* Максимум 16 МБ на один запрос <sup>1</sup>
* Максимальная длина URL-адреса — 8 КБ.
* Максимум 1000 документов на одну операцию загрузки индексов, объединения или удаления.
* Максимум 32 поля в предложении $orderby.
* Максимальный размер поискового запроса — 32 766 байтов (32 КБ минус 2 байта) текста в кодировке UTF-8.

<sup>1</sup> В Azure Cognitive Search тело запроса подлежит верхнему пределу в 16 МБ, налагая практический лимит на содержимое отдельных полей или коллекций, которые в противном случае не ограничены теоретическими ограничениями (см. [Поддерживаемые типы данных](https://docs.microsoft.com/rest/api/searchservice/supported-data-types) для получения дополнительной информации о составе поля и ограничениях).

## <a name="api-response-limits"></a>Ограничения на ответ API
* Максимум 1000 документов на одну страницу результатов поиска.
* Максимум 100 предложений на один запрос API предложений.

## <a name="api-key-limits"></a>Ограничения ключевых клавиш API
Ключи API используются для проверки подлинности службы. Существует два типа ключей. Ключи администратора указываются в заголовке запроса и предоставляют доступ к службе на чтение и запись. Ключи запросов доступны только для чтения, они указываются в URL-адресе и обычно передаются в клиентские приложения.

* Максимум 2 ключа администратора на одну службу.
* Максимум 50 ключей запросов на одну службу.