---
title: Присоединение Cognitive Services к набору навыков
titleSuffix: Azure Cognitive Search
description: Инструкции по присоединению Cognitive Services "все в одной" к конвейеру обогащения искусственного интеллекта в Azure Когнитивный поиск.
manager: nitinme
author: LuisCabrer
ms.author: luisca
ms.service: cognitive-search
ms.topic: conceptual
ms.date: 12/17/2019
ms.openlocfilehash: 254c912114e3f1c7a495f389bc6a6416cbde7e11
ms.sourcegitcommit: 64def2a06d4004343ec3396e7c600af6af5b12bb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/19/2020
ms.locfileid: "77472457"
---
# <a name="attach-a-cognitive-services-resource-to-a-skillset-in-azure-cognitive-search"></a>Подключение Cognitive Services ресурса к набору навыков в Azure Когнитивный поиск 

При настройке конвейера обогащения в Azure Когнитивный поиск можно освободить ограниченное количество документов. Для более крупных и часто выполняемых рабочих нагрузок следует присоединить оплачиваемый Cognitive Services ресурс.

В этой статье вы узнаете, как подключить ресурс, назначив ключ набору знаний, который определяет конвейер обогащения.

## <a name="resources-used-during-enrichment"></a>Ресурсы, используемые во время обогащения

Когнитивный поиск Azure зависит от Cognitive Services, включая [компьютерное зрение](https://azure.microsoft.com/services/cognitive-services/computer-vision/) для анализа образов и оптического распознавания символов (OCR), [анализ текста](https://azure.microsoft.com/services/cognitive-services/text-analytics/) для обработки на естественном языке и другие обогащения, такие как [Преобразование текста](https://azure.microsoft.com/services/cognitive-services/translator-text-api/). В контексте обогащения в Azure Когнитивный поиск эти алгоритмы искусственного интеллекта упаковываются внутри *навыка*, помещаются в набор *навыков*, и на него ссылается *индексатор* во время индексирования.

## <a name="how-billing-works"></a>Как работает выставление счетов

+ Когнитивный поиск Azure использует ключ ресурса Cognitive Services, предоставленный в наборе навыков, для выставления счетов за использование образа и текста. Выполнение оплачиваемых навыков относится к цене за [Cognitive Services с оплатой по мере](https://azure.microsoft.com/pricing/details/cognitive-services/)использования.

+ Извлечение изображений — это операция Azure Когнитивный поиск, которая происходит при взломе документов перед обогащением. Продается оплата за извлечение изображений. Сведения о ценах на извлечение изображений см. на [странице цен на когнитивный Поиск Azure](https://go.microsoft.com/fwlink/?linkid=2042400).

+ Извлечение текста также происходит во время взлома документа. Оплата не взимается.

+ Навыки, не вызывающие Cognitive Services, в том числе условные, формы, слияния и разбиения текста, не оплачиваются.

## <a name="same-region-requirement"></a>Требования к одному региону

Для этого необходимо, чтобы Azure Когнитивный поиск и Azure Cognitive Services существовали в одном регионе. В противном случае это сообщение будет получено во время выполнения: `"Provided key is not a valid CognitiveServices type key for the region of your search service."` 

Перемещение службы между регионами невозможно. При возникновении этой ошибки необходимо создать новый ресурс Cognitive Services в том же регионе, что и Когнитивный поиск Azure.

> [!NOTE]
> Некоторые встроенные навыки основаны на нестандартном Cognitive Services (например, [навыке перевода текста](cognitive-search-skill-text-translation.md)). Использование нерегионального навыка означает, что ваш запрос может быть обслуживаться в регионе, отличном от региона Azure Когнитивный поиск. Дополнительные сведения о службах, не являющихся региональными, см. на странице [Cognitive Services продукт по регионам](https://aka.ms/allinoneregioninfo) .

## <a name="use-free-resources"></a>Использование бесплатных ресурсов

Для завершения учебника по созданию искусственного интеллекта и краткого руководства можно использовать ограниченный бесплатный режим обработки.

Для бесплатных (ограниченных) ресурсов ограничено 20 документов в день на индексатор. Чтобы сбросить счетчик, можно удалить и повторно создать индексатор.

1. Откройте мастер импорта данных.

   ![Открытие мастера импорта данных](media/search-get-started-portal/import-data-cmd.png "Открытие мастера импорта данных")

1. Выберите источник данных и продолжайте **добавлять обогащение искусственного интеллекта (необязательно)** . Пошаговое руководство по этому мастеру см. [в разделе Создание индекса в портал Azure](search-get-started-portal.md).

1. Разверните узел **Attach Cognitive Services** и выберите **Free (ограниченные дополнения)** :

   ![Развернутый раздел Cognitive Services присоединения](./media/cognitive-search-attach-cognitive-services/attach1.png "Развернутый раздел Cognitive Services присоединения")

1. Теперь вы можете перейти к следующим шагам, в том числе **Добавить новые навыки**.

## <a name="use-billable-resources"></a>Использование ресурсов, которые подлежат оплате

Для рабочих нагрузок, которые создают более 20 дополнений в день, необходимо присоединить оплачиваемый Cognitive Services ресурс. Рекомендуется всегда присоединять оплачиваемый Cognitive Services ресурс, даже если вы никогда не планируете вызывать API-интерфейсы Cognitive Services. Присоединение ресурса переопределяет дневное ограничение.

Плата наследуется только за навыки, которые вызывают API-интерфейсы Cognitive Services. Вам не взимается плата за [пользовательские навыки](cognitive-search-create-custom-skill-example.md)или навыки, такие как [слияние текста](cognitive-search-skill-textmerger.md), [разделитель текста](cognitive-search-skill-textsplit.md)и [форма](cognitive-search-skill-shaper.md), не основанная на API.

1. Откройте мастер импорта данных, выберите источник данных и продолжайте **добавлять обогащение искусственного интеллекта (необязательно)** .

1. Разверните узел **присоединить Cognitive Services** , а затем выберите **создать новый Cognitive Services ресурс**. Откроется новая вкладка, в которой можно будет создать ресурс:

   ![Создание Cognitive Services ресурса](./media/cognitive-search-attach-cognitive-services/cog-services-create.png "Создание ресурса Cognitive Services")

1. В списке **Расположение** выберите регион, в котором находится служба когнитивный Поиск Azure. Обязательно используйте этот регион для повышения производительности. Использование этого региона также аннулирует исходящие расходы на пропускную способность в регионах.

1. В списке **ценовая** Категория выберите значение **S0** , чтобы получить коллекцию Cognitive Services функций, включая концепцию и языковые функции, которые поддерживают встроенные навыки, предоставляемые когнитивный Поиск Azure.

   Для уровня S0 можно найти тарифы для конкретных рабочих нагрузок на [странице цен на Cognitive Services](https://azure.microsoft.com/pricing/details/cognitive-services/).
  
   + Убедитесь, что в списке **выбрать предложение** выбрано **Cognitive Services** .
   + В разделе функции **языка** ставки для **анализ текста Standard** применяются к индексированию искусственного интеллекта.
   + В разделе функции **концепции** применяются тарифы на **компьютерное зрение S1** .

1. Выберите **создать** , чтобы подготавливает новый ресурс Cognitive Services.

1. Вернитесь на предыдущую вкладку, содержащую мастер импорта данных. Выберите **Обновить** , чтобы отобразить ресурс Cognitive Services, а затем выберите ресурс:

   ![Выберите ресурс Cognitive Services](./media/cognitive-search-attach-cognitive-services/attach2.png "Выберите ресурс Cognitive Services")

1. Разверните раздел **Добавление данных о навыках** , чтобы выбрать конкретные навыки, которые необходимо выполнить с данными. Выполните остальные инструкции мастера.

## <a name="attach-an-existing-skillset-to-a-cognitive-services-resource"></a>Присоединение ресурса Cognitive Services с существующим набором навыков

Если вы уже имеете существующий набор навыков, вы можете присоединить его к новому или другому ресурсу Cognitive Services.

1. На странице **Обзор службы** выберите **навыков**:

   ![Вкладка навыков](./media/cognitive-search-attach-cognitive-services/attach-existing1.png "Вкладка навыков")

1. Выберите имя набора навыков, а затем выберите существующий ресурс или создайте новый. Для подтверждения изменений нажмите кнопку **OK**.

   ![Список ресурсов набора навыков](./media/cognitive-search-attach-cognitive-services/attach-existing2.png "Список ресурсов набора навыков")

   Помните, что параметр **Free (ограниченные дополнения)** ограничивает доступ к 20 документам ежедневно, и вы можете использовать **Создание нового Cognitive Services ресурса** для предоставления нового оплачиваемого ресурса. Создав новый ресурс, щелкните **Обновить**, чтобы обновить список ресурсов Cognitive Services, и выберите ресурс.

## <a name="attach-cognitive-services-programmatically"></a>Присоединение Cognitive Services программным способом

При определении набора навыков программным способом добавьте раздел `cognitiveServices` к набору навыков. В этом разделе включите ключ ресурса Cognitive Services, который необходимо связать с набором навыков. Помните, что ресурс должен находиться в том же регионе, что и ресурс Azure Когнитивный поиск. Также включите `@odata.type` и присвойте ему значение `#Microsoft.Azure.Search.CognitiveServicesByKey`.

Этот шаблон приведен в примере ниже. Обратите внимание на раздел `cognitiveServices` в конце определения.

```http
PUT https://[servicename].search.windows.net/skillsets/[skillset name]?api-version=2019-05-06
api-key: [admin key]
Content-Type: application/json
```
```json
{
    "name": "skillset name",
    "skills": 
    [
      {
        "@odata.type": "#Microsoft.Skills.Text.EntityRecognitionSkill",
        "categories": [ "Organization" ],
        "defaultLanguageCode": "en",
        "inputs": [
          {
            "name": "text", "source": "/document/content"
          }
        ],
        "outputs": [
          {
            "name": "organizations", "targetName": "organizations"
          }
        ]
      }
    ],
    "cognitiveServices": {
        "@odata.type": "#Microsoft.Azure.Search.CognitiveServicesByKey",
        "description": "mycogsvcs",
        "key": "<your key goes here>"
    }
}
```

## <a name="example-estimate-costs"></a>Пример. Оценка затрат

Чтобы оценить затраты, связанные с использованием индексированного поиска, начните с понимания того, как выглядит средний документ, чтобы можно было выполнить несколько цифр. Например, вы можете приблизительно:

+ 1 000. PDF.
+ По шесть страниц.
+ Одно изображение на страницу (6 000 изображений).
+ 3 000 символов на страницу.

Предположим, что конвейер состоит из взлома документов для каждого документа PDF, извлечения изображений и текста, оптического распознавания символов (OCR) и распознавания сущностей в организациях.

Представленные в этой статье цены являются гипотетическими. Они используются для иллюстрации процесса оценки. Ваши затраты могут быть ниже. Фактические цены на транзакции см. в разделе [цены на Cognitive Services](https://azure.microsoft.com/pricing/details/cognitive-services).

1. Для открытия документа с содержимым в виде текста и изображения извлечение текста в настоящее время предоставляется бесплатно. Для образов 6 000 предполагается $1 для каждого извлеченного образа 1 000. Это стоимость $6,00 для этого шага.

2. Для OCR 6000 образов на английском языке когнитивные навыки OCR используют наилучший алгоритм (DescribeText). При условии что 1000 изображений для анализа будет стоить 2,50 долл., вы выплатите 15,00 долл. за этот шаг.

3. Для извлечения сущностей у вас будет всего три текстовых записи на страницу. (каждая запись — 1000 символов). Три текстовых записи на страницу, умноженные на 6 000 страниц, совпадают с текстовыми записями 18 000. При тарифе 2,00 долл. за 1000 текстовых записей этот шаг будет стоить 36,00 долл.

Поместив все вместе, вы платите примерно $57,00, чтобы принять 1 000 PDF-документов этого типа с описанным набором навыков.

## <a name="next-steps"></a>Следующие шаги
+ [Страница цен на Когнитивный поиск Azure](https://azure.microsoft.com/pricing/details/search/)
+ [Определение набора навыков](cognitive-search-defining-skillset.md)
+ [Создание набора навыков (REST)](https://docs.microsoft.com/rest/api/searchservice/create-skillset)
+ [Сопоставление обогащенных полей](cognitive-search-output-field-mapping.md)
