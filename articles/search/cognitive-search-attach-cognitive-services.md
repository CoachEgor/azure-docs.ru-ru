---
title: Прикрепите когнитивные службы к набору навыков
titleSuffix: Azure Cognitive Search
description: Инструкции по подключению подписки Cognitive Services «все-в-одном» к конвейеру обогащения ИИ в Azure Cognitive Search.
manager: nitinme
author: LuisCabrer
ms.author: luisca
ms.service: cognitive-search
ms.topic: conceptual
ms.date: 12/17/2019
ms.openlocfilehash: 254c912114e3f1c7a495f389bc6a6416cbde7e11
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/27/2020
ms.locfileid: "77472457"
---
# <a name="attach-a-cognitive-services-resource-to-a-skillset-in-azure-cognitive-search"></a>Прикрепите ресурс Cognitive Services к набору навыков в Azure Cognitive Search 

При настройке конвейера обогащения в Azure Cognitive Search можно обогатить ограниченное количество документов бесплатно. Для больших и более частых рабочих нагрузок следует прикрепить ресурс Cognitive Services.

В этой статье вы узнаете, как прикрепить ресурс, назначив ключ к набору навыков, определяющим конвейер обогащения.

## <a name="resources-used-during-enrichment"></a>Ресурсы, используемые при обогащении

Azure Cognitive Search имеет зависимость от когнитивных служб, включая [компьютерное зрение](https://azure.microsoft.com/services/cognitive-services/computer-vision/) для анализа изображений и оптического распознавания символов (OCR), [text Analytics](https://azure.microsoft.com/services/cognitive-services/text-analytics/) для обработки естественного языка и другие обогащения, такие как [текстовый перевод.](https://azure.microsoft.com/services/cognitive-services/translator-text-api/) В контексте обогащения в Azure Cognitive Search эти алгоритмы ИИ заворачиваются в *навык,* помещаются в *набор навыков*и ссылаются *на индексатора* во время индексации.

## <a name="how-billing-works"></a>Как работает выставление счетов

+ Azure Cognitive Search использует ключ ресурса Cognitive Services, который вы предоставляете на наборе навыков для выставления счетов за обогащение изображений и текста. Выполнение оплачиваемых навыков в [когнитивных услуг платить по мере того, как вы идете цена](https://azure.microsoft.com/pricing/details/cognitive-services/).

+ Извлечение изображений — это операция Azure Cognitive Search, которая происходит при взломе документов до обогащения. Извлечение изображений является оплачиваемым. Для ценообразования на извлечение изображений можно найти [страницу ценообразования Azure Cognitive Search.](https://go.microsoft.com/fwlink/?linkid=2042400)

+ Извлечение текста также происходит во время взлома фразы документа. Это не является оплачиваемым.

+ Навыки, которые не называют когнитивные службы, в том числе Условные, Shaper, Text Merge, и Навыки Сплита текста, не являются оплачиваемыми.

## <a name="same-region-requirement"></a>Требование одного региона

Мы требуем, чтобы когнитивные поисковые службы Azure и когнитивные службы Azure существовали в одном регионе. В противном случае вы получите это сообщение во время выполнения:`"Provided key is not a valid CognitiveServices type key for the region of your search service."` 

Перемещение службы по регионам невозможно. Если вы получили эту ошибку, необходимо создать новый ресурс Когнитивных Служб в том же регионе, что и Azure Cognitive Search.

> [!NOTE]
> Некоторые встроенные навыки основаны на нерегиональных когнитивных услуг (например, [навык перевода текста](cognitive-search-skill-text-translation.md)). Использование нерегиональных навыков означает, что ваш запрос может обслуживаться в другом регионе, кроме региона когнитивного поиска Azure. Для получения дополнительной информации, [Cognitive Services product by region](https://aka.ms/allinoneregioninfo) неявляя региональных услуг, см.

## <a name="use-free-resources"></a>Использование бесплатных ресурсов

Вы можете использовать ограниченный, бесплатный вариант обработки для завершения учебника по обогащению ИИ и упражнений быстрого запуска.

Бесплатные (ограниченные ресурсы обогащения) ограничены 20 документами в день, на индексатор. Вы можете удалить и воссоздать индексер для сбросить счетчик.

1. Откройте мастер данных импорта:

   ![Откройте мастер данных импорта](media/search-get-started-portal/import-data-cmd.png "Откройте мастер данных импорта")

1. Выберите источник данных и продолжайте **добавлять обогащение ИИ (необязательно).** Для поэтапного прохождения этого мастера [см.](search-get-started-portal.md)

1. Расширить **функции присоединения когнитивных услуг,** а затем выбрать **бесплатный (ограниченное обогащение)**:

   ![Расширенный раздел Когнитивных Услуг Присоединения](./media/cognitive-search-attach-cognitive-services/attach1.png "Расширенный раздел Когнитивных Услуг Присоединения")

1. Теперь вы можете продолжить следующие шаги, в том числе **добавить когнитивные навыки.**

## <a name="use-billable-resources"></a>Использование ресурсов, которые подлежат оплате

Для рабочих нагрузок, которые создают более 20 обогащений в день, не забудьте прикрепить оплачиваемый ресурс Когнитивных Услуг. Мы рекомендуем всегда прикреплять оплачиваемый ресурс Cognitive Services, даже если вы никогда не собираетесь вызывать AA-ино., связанные с когнитивными службами. Присоединение ресурса перекрывает дневной лимит.

Плата взимается только за навыки, которые вызывают AA- службы когнитивных услуг. Вы не выставлен счет за [пользовательские навыки,](cognitive-search-create-custom-skill-example.md)или навыки, такие как [текст слияния](cognitive-search-skill-textmerger.md), [текст сплиттер](cognitive-search-skill-textsplit.md), и [формовщик](cognitive-search-skill-shaper.md), которые не aPI основе.

1. Откройте мастер данных Импорта, выберите источник данных и продолжайте **добавлять обогащение ИИ (необязательно).**

1. Расширьте **когнитивные службы attach,** а затем выберите **Создать новый ресурс Когнитивных Услуг.** Открывается новая вкладка, чтобы можно было создать ресурс:

   ![Создание ресурса Cognitive Services](./media/cognitive-search-attach-cognitive-services/cog-services-create.png "Создание ресурса Cognitive Services")

1. В списке **местоположений** выберите область, в которой находится служба когнитивного поиска Azure. Убедитесь в том, чтобы использовать этот регион по причинам производительности. Использование этого региона также освобождает от исходящих платежей пропускной способности в разных регионах.

1. В списке **уровня ценообразования** выберите **S0,** чтобы получить все-в-одном коллекцию функций когнитивных служб, включая функции Vision и Language, которые обратно встроенные навыки, предоставляемые Azure Cognitive Search.

   Для уровня S0 вы можете найти тарифы для конкретных рабочих нагрузок на [странице ценообразования Когнитивных Услуг.](https://azure.microsoft.com/pricing/details/cognitive-services/)
  
   + В списке **«Выберите предложение»** убедитесь, что **когнитивные услуги** выбраны.
   + В соответствии с функциями **Language** тарифы для **Text Analytics Standard** применяются к индексации ИИ.
   + В соответствии с функциями **Vision** применяются тарифы на **Computer Vision S1.**

1. Выберите **Создать** для предоставления нового ресурса когнитивных услуг.

1. Возврат к предыдущей вкладке, содержащей мастер данных импорта. Выберите **обновление,** чтобы показать ресурс Когнитивных Услуг, а затем выберите ресурс:

   ![Выберите ресурс Когнитивных Услуг](./media/cognitive-search-attach-cognitive-services/attach2.png "Выберите ресурс Когнитивных Услуг")

1. Расширьте раздел **когнитивных навыков Add,** чтобы выбрать конкретные когнитивные навыки, которые вы хотите запустить на ваших данных. Выполните остальные инструкции мастера.

## <a name="attach-an-existing-skillset-to-a-cognitive-services-resource"></a>Присоединение ресурса Cognitive Services с существующим набором навыков

Если вы уже имеете существующий набор навыков, вы можете присоединить его к новому или другому ресурсу Cognitive Services.

1. На странице **обзора службы** выберите **Skillsets:**

   ![Вкладка Skillsets](./media/cognitive-search-attach-cognitive-services/attach-existing1.png "Вкладка Skillsets")

1. Выберите имя набора навыков, а затем выберите существующий ресурс или создайте новый. Для подтверждения изменений нажмите кнопку **OK**.

   ![Список ресурсов Skillset](./media/cognitive-search-attach-cognitive-services/attach-existing2.png "Список ресурсов Skillset")

   Помните, что опция **Free (Limited enrichments)** ограничивает вас 20 документами ежедневно, и что вы можете использовать **Новый ресурс Cognitive Services** для предоставления нового ресурса, оплачиваемого по счетам. Создав новый ресурс, щелкните **Обновить**, чтобы обновить список ресурсов Cognitive Services, и выберите ресурс.

## <a name="attach-cognitive-services-programmatically"></a>Присоединение Cognitive Services программным способом

При определении набора навыков программным способом добавьте раздел `cognitiveServices` к набору навыков. В этом разделе включите ключ ресурса Cognitive Services, который вы хотите связать с набором навыков. Помните, что ресурс должен находиться в том же регионе, что и ваш ресурс Azure Cognitive Search. Также включите `@odata.type` и присвойте ему значение `#Microsoft.Azure.Search.CognitiveServicesByKey`.

Этот шаблон приведен в примере ниже. Обратите `cognitiveServices` внимание на раздел в конце определения.

```http
PUT https://[servicename].search.windows.net/skillsets/[skillset name]?api-version=2019-05-06
api-key: [admin key]
Content-Type: application/json
```
```json
{
    "name": "skillset name",
    "skills": 
    [
      {
        "@odata.type": "#Microsoft.Skills.Text.EntityRecognitionSkill",
        "categories": [ "Organization" ],
        "defaultLanguageCode": "en",
        "inputs": [
          {
            "name": "text", "source": "/document/content"
          }
        ],
        "outputs": [
          {
            "name": "organizations", "targetName": "organizations"
          }
        ]
      }
    ],
    "cognitiveServices": {
        "@odata.type": "#Microsoft.Azure.Search.CognitiveServicesByKey",
        "description": "mycogsvcs",
        "key": "<your key goes here>"
    }
}
```

## <a name="example-estimate-costs"></a>Пример: Оценка затрат

Чтобы оценить затраты, связанные с индексацией когнитивного поиска, начните с представления о том, как выглядит средний документ, чтобы можно было запустить несколько чисел. Например, можно приблизиться к:

+ 1000 PDF-файлов.
+ Шесть страниц каждая.
+ Одно изображение на страницу (6000 изображений).
+ 3000 символов на страницу.

Предположим, что конвейер состоит из взлома документов каждого PDF, извлечения изображений и текста, оптического распознавания символов (OCR) изображений и распознавания сущности организаций.

Цены, указанные в этой статье, являются гипотетическими. Они используются для иллюстрации процесса оценки. Ваши расходы могут быть ниже. Для фактических цен сделок, [см.](https://azure.microsoft.com/pricing/details/cognitive-services)

1. Для открытия документа с содержимым в виде текста и изображения извлечение текста в настоящее время предоставляется бесплатно. Для 6000 изображений, предположим, $ 1 за каждые 1000 изображений, извлеченных. Это стоимость $ 6,00 за этот шаг.

2. Для OCR 6000 образов на английском языке когнитивные навыки OCR используют наилучший алгоритм (DescribeText). При условии что 1000 изображений для анализа будет стоить 2,50 долл., вы выплатите 15,00 долл. за этот шаг.

3. Для извлечения сущности на страницу можно иметь в общей сложности три текстовых записи. (каждая запись — 1000 символов). Три текстовых записи на страницу умноженна на 6000 страниц равно 18000 текстовых записей. При тарифе 2,00 долл. за 1000 текстовых записей этот шаг будет стоить 36,00 долл.

Положив все это вместе, вы бы платить около $ 57,00 глотать 1000 документов PDF этого типа с описанным skillset.

## <a name="next-steps"></a>Дальнейшие действия
+ [Страница ценообразования по когнитивному поиску Azure](https://azure.microsoft.com/pricing/details/search/)
+ [Определение набора навыков](cognitive-search-defining-skillset.md)
+ [Создание набора навыков (REST)](https://docs.microsoft.com/rest/api/searchservice/create-skillset)
+ [Сопоставление обогащенных полей](cognitive-search-output-field-mapping.md)
