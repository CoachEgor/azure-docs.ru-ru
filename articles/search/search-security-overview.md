---
title: Общие сведения о безопасности
titleSuffix: Azure Cognitive Search
description: Azure Когнитивный поиск соответствует требованиям SOC 2, HIPAA и другим сертификатам. Подключение и шифрование данных, проверка подлинности и доступ к удостоверениям с помощью идентификаторов безопасности пользователей и групп в выражениях фильтра.
manager: nitinme
author: HeidiSteen
ms.author: heidist
ms.service: cognitive-search
ms.topic: conceptual
ms.date: 07/30/2020
ms.openlocfilehash: b5e408eeac024f63eb8e7ce47039dc4c0a6aa5b5
ms.sourcegitcommit: 11e2521679415f05d3d2c4c49858940677c57900
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/31/2020
ms.locfileid: "87501497"
---
# <a name="security-in-azure-cognitive-search---overview"></a>Безопасность в Azure Когнитивный поиск — обзор

В этой статье описаны основные функции безопасности в Azure Когнитивный поиск, которые могут защищать содержимое и операции. 

+ На уровне хранилища задается уровень шифрования неактивных данных, но Когнитивный поиск также предоставляет ключи, управляемые клиентом, с помощью Azure Key Vault для дополнительного уровня шифрования.

+ Безопасность входящего трафика защищает конечную точку службы поиска по возрастанию уровней безопасности: от ключей API запроса до правил входящего трафика в брандмауэре до частных конечных точек, которые полностью защищают службу от общедоступного Интернета.

+ Безопасность исходящего трафика применяется к индексаторам, которые извлекают содержимое из внешних источников. Для исходящих запросов настройте управляемое удостоверение, чтобы сделать поиск доверенной службой при доступе к данным из службы хранилища Azure, SQL Azure, Cosmos DB или других источников данных Azure. Управляемое удостоверение — это замена учетных данных или ключей доступа в соединении. Безопасность исходящего трафика в этой статье не рассматривается. Дополнительные сведения об этой возможности см. в разделе [Подключение к источнику данных с помощью управляемого удостоверения](search-howto-managed-identities-data-sources.md).

Просмотрите это видео с краткими сведениями о архитектуре безопасности и каждой категории компонентов.

> [!VIDEO https://channel9.msdn.com/Shows/AI-Show/Azure-Cognitive-Search-Whats-new-in-security/player]

## <a name="encrypted-transmissions-and-storage"></a>Зашифрованные передачи и хранение

Шифрование выполняется в Azure Когнитивный поиск, начиная с подключений и передач, которые расширяются до содержимого, хранящегося на диске. Для служб поиска в общедоступном Интернете Когнитивный поиск Azure прослушивает HTTPS порт 443. Все подключения клиента к службе используют шифрование TLS 1,2. Более ранние версии (1,0 или 1,1) не поддерживаются.

### <a name="data-encryption-at-rest"></a>Шифрование неактивных данных

Когнитивный поиск Azure хранит определения и содержимое индекса, определения источников данных, определения индексаторов, определения навыков и карты синонимов.

На уровне хранилища данные шифруются на диске с помощью ключей, управляемых корпорацией Майкрософт. Вы не можете включить или отключить шифрование или просмотреть параметры шифрования на портале или программно. Шифрование является полностью внутренним и не влияет на время индексирования или размер индекса. Оно выполняется автоматически во всех процессах индексирования, включая добавочные обновления индекса, который не полностью зашифрован (создан до января 2018 г.).

На внутреннем уровне шифрование основывается на [шифровании службы хранилища Azure](../storage/common/storage-service-encryption.md) с использованием 256-разрядного [шифрования AES](https://en.wikipedia.org/wiki/Advanced_Encryption_Standard).

> [!NOTE]
> Шифрование неактивных обновлений было объявлено 24 января 2018 и относится ко всем уровням служб, включая уровень Free, во всех регионах. Для полного шифрования индексы, созданные до этой даты, необходимо удалить и создать заново, чтобы шифрование вступило в силу. В противном случае будут зашифрованы только новые данные, добавленные после 24 января.

### <a name="customer-managed-key-cmk-encryption"></a>Шифрование ключа, управляемого клиентом (CMK)

Клиенты, которым требуется дополнительная защита хранилища, могут шифровать данные и объекты, прежде чем они будут сохранены и зашифрованы на диске. Этот подход основан на ключе пользователя, управляемом и хранимом с помощью Azure Key Vault независимо от корпорации Майкрософт. Шифрование содержимого перед его шифрованием на диске называется двойным шифрованием. В настоящее время можно выборочно дважды шифровать индексы и карты синонимов. Дополнительные сведения см. [в разделе ключи шифрования, управляемые клиентом, в когнитивный Поиск Azure](search-security-manage-encryption-keys.md).

> [!NOTE]
> Шифрование CMK обычно доступно для служб поиска, созданных после января 2019. Она не поддерживается в бесплатных (общих) службах. 
>
>Включение этой функции увеличит размер индекса и снизит производительность запросов. Исходя из наблюдений на дату, можно увидеть увеличение 30%-60% времени выполнения запроса, хотя фактическая производительность зависит от определения индекса и типов запросов. В связи с этим влиянием на производительность рекомендуется включить эту функцию только для индексов, которые действительно необходимы.

<a name="service-access-and-authentication"></a>

## <a name="inbound-security-and-endpoint-protection"></a>Безопасность входящего трафика и защита конечных точек

Функции безопасности для входящих подключений защищают конечную точку службы поиска, повышая уровень безопасности и сложности. Во-первых, для всех запросов требуется ключ API для доступа с проверкой подлинности. Во-вторых, при необходимости можно задать правила брандмауэра, ограничивающие доступ к конкретным IP адресам. Для расширенной защиты третий вариант — включить частную ссылку Azure, чтобы защитить конечную точку службы от всего трафика Интернета.

### <a name="public-access-using-api-keys"></a>Открытый доступ с использованием ключей API

По умолчанию доступ к службе поиска осуществляется через общедоступное облако с использованием проверки подлинности на основе ключей для администрирования или доступа к запросам к конечной точке службы поиска. Ключ API является строкой, состоящей из случайно сгенерированных букв и цифр. Тип ключа (администратор или запрос) определяет уровень доступа. Отправка допустимого ключа представляет собой доказательство того, что запрос исходит от доверенной сущности. 

Существует два уровня доступа к службе поиска, которые включаются следующими ключами API:

+ Ключ администратора (разрешает доступ на чтение и запись для операций [создания, чтения, обновления и удаления](https://en.wikipedia.org/wiki/Create,_read,_update_and_delete) в службе поиска)

+ Ключ запроса (разрешает доступ только для чтения к коллекции документов индекса)

*Ключи администратора* создаются при подготовке службы. Существует два ключа администратора, обозначенные для упорядочения как *первичный* и *вторичный*, хотя в действительности они являются взаимозаменяемыми. У каждой службы есть два ключа администратора, чтобы вы могли сменять их, не теряя доступа к службе. Вы можете периодически [повторно создать ключ администратора](search-security-api-keys.md#regenerate-admin-keys) в соответствии с рекомендациями по обеспечению безопасности Azure, но нельзя добавить общее число ключей администратора. Для одной службы поиска существует не более двух ключей администрирования.

*Ключи запроса* создаются по мере необходимости и предназначены для клиентских приложений, которые выдают запросы. Вы можете создать до 50 ключей поисковых запросов. В коде приложения укажите URL-адрес поиска и ключ API запроса, чтобы разрешить доступ только для чтения к коллекции Documents определенного индекса. Используемые вместе конечная точка, ключ API с доступом только для чтения и целевой индекс определяют область применения и уровень доступа для подключения из клиентского приложения.

Проверка подлинности требуется для каждого запроса, который состоит из обязательного ключа, операции и объекта. Для обеспечения полной безопасности операций службы достаточно двух уровней разрешений (полные или только для чтения) и контекста (например, для операции запроса к индексу). Дополнительные сведения о ключах см. в статье о [создании ключей api и управлении ими](search-security-api-keys.md).

### <a name="ip-restricted-access"></a>Доступ с ограниченным IP-адресом

Для дальнейшего управления доступом к службе поиска можно создать правила брандмауэра для входящих подключений, которые разрешают доступ к определенному IP-адресу или диапазону IP-адресов. Все клиентские соединения должны быть выполнены через разрешенный IP-адрес, иначе соединение будет отклонено.

Для [настройки входящего доступа](service-configure-firewall.md)можно использовать портал. 

Кроме того, можно использовать API-интерфейсы RESTFUL для управления. API версии 2020-03-13 с параметром [ипруле](https://docs.microsoft.com/rest/api/searchmanagement/2019-10-01-preview/createorupdate-service#IpRule) позволяет ограничить доступ к службе, определив IP-адреса, по отдельности или в пределах диапазона, которым вы хотите предоставить доступ к службе поиска. 

### <a name="private-endpoint-no-internet-traffic"></a>Частная конечная точка (без трафика Интернета)

[Частная конечная точка](../private-link/private-endpoint-overview.md) Azure когнитивный Поиск позволяет клиенту в [виртуальной сети](../virtual-network/virtual-networks-overview.md) безопасно получать доступ к данным в индексе поиска по [закрытому каналу](../private-link/private-link-overview.md). 

Частная конечная точка использует IP-адрес из адресного пространства виртуальной сети для подключений к службе поиска. Сетевой трафик между клиентом и службой поиска проходит по виртуальной сети и частной связи в магистральной сети Майкрософт, что устраняет уязвимость в общедоступном Интернете. ВИРТУАЛЬная сеть обеспечивает безопасное взаимодействие между ресурсами с локальной сетью и Интернетом. 

Хотя это решение является наиболее безопасным, использование дополнительных служб является дополнительными затратами, поэтому убедитесь, что у вас есть четкое понимание преимуществ, прежде чем углубляться в. Дополнительные сведения о затратах см. на [странице с ценами](https://azure.microsoft.com/pricing/details/private-link/). Дополнительные сведения о совместной работе этих компонентов см. в видеоролике в верхней части этой статьи. Покрытие параметра закрытой конечной точки начинается с 5:48 в видео. Инструкции по настройке конечной точки см. в статье [Создание частной конечной точки для Azure когнитивный Поиск](service-create-private-endpoint.md).

## <a name="index-access"></a>Доступ к индексу

В Когнитивный поиск Azure отдельный индекс не является защищаемым объектом. Вместо этого доступ к индексу определяется на уровне служб (доступ на чтение или запись к службе) вместе с контекстом операции.

В случае с доступом пользователей можно структурировать запросы для подключения с использованием ключа запроса (после чего любой запрос становится доступным только для чтения) и добавить конкретный индекс, используемый приложением. В запросе невозможно объединить индексы или получить доступ к нескольким индексам одновременно, поэтому все запросы по определению направляются к одному индексу. Таким образом, структура самого запроса (ключ и один целевой индекс) определяет границы безопасности.

Доступ администратора и разработчика к индексам недифференцированный: для обоих типов доступа необходимо разрешение на запись для создания, удаления и обновления объектов, управляемых службой. Любой пользователь, имеющий ключ администратора к службе, может прочитать, изменить или удалить любой индекс в той же службе. Решением для защиты от случайного или злонамеренного удаления индексов являются внутренние средства управления исходным кодом для ресурсов кода, которые позволяют отменить нежелательное удаление или изменение индекса. Когнитивный поиск Azure отработка отказа в кластере для обеспечения доступности, но не сохраняет и не выполняет собственный код, используемый для создания или загрузки индексов.

Для мультитенантных решений, границы безопасности которых должны находиться на уровне индексов, такие решения, как правило, содержат средний уровень, на котором клиенты обрабатывают изоляцию индекса. Дополнительные сведения о варианте использования для нескольких клиентов см. в статье [шаблоны разработки для многоклиентских приложений SaaS и Azure когнитивный Поиск](search-modeling-multitenant-saas-applications.md).

## <a name="user-access"></a>Доступ пользователей

Как пользователь получает доступ к индексу, а другие объекты определяются по типу ключа API в запросе. Большинство разработчиков создают и назначают [*ключи запросов*](search-security-api-keys.md) для поисковых запросов на стороне клиента. Ключ запроса предоставляет доступ только для чтения к содержимому с возможностью поиска в индексе.

Если требуется детальный контроль над результатами поиска, можно создать фильтры безопасности для запросов, возвращая документы, связанные с данным удостоверением безопасности. Вместо предопределенных ролей и назначений ролей управление доступом на основе удостоверений реализуется как *фильтр*, обрезающий результаты поиска документов и содержимого на основе удостоверений. В следующей таблице описаны два подхода к обрезке результатов поиска несанкционированного содержимого.

| Подход | Описание |
|----------|-------------|
|[Security filters for trimming results in Azure Search](search-security-trimming-for-azure-search.md) (Фильтры безопасности для обрезки результатов Поиска Azure)  | Документирует базовый рабочий процесс для реализации управления доступом на основе удостоверений пользователей. Описывает добавление удостоверений безопасности в индекс, а также объясняет фильтрацию этого поля для усечения результатов запрещенного содержимого. |
|[Security filters for trimming Azure Search results using Active Directory identities](search-security-trimming-for-azure-search-with-aad.md) (Фильтры безопасности для обрезки результатов Поиска Azure с использованием удостоверений Active Directory)  | Эта статья дополняет предыдущую статью, в ней приведены действия для получения удостоверений из Azure Active Directory (AAD), одной из [бесплатных служб](https://azure.microsoft.com/free/) на облачной платформе Azure. |

## <a name="administrative-rights"></a>Права администратора

[Доступ на основе ролей (RBAC)](../role-based-access-control/overview.md) — это система авторизации, основанная на [Azure Resource Manager](../azure-resource-manager/management/overview.md) для подготовки ресурсов Azure. В Когнитивный поиск Azure диспетчер ресурсов используется для создания или удаления службы, управления ключами API и масштабирования службы. Таким образом, назначения ролей Azure определяют, кто может выполнять эти задачи, независимо от того, используете ли они [портал](search-manage.md), [PowerShell](search-manage-powershell.md)или [API-интерфейсы других функций управления](https://docs.microsoft.com/rest/api/searchmanagement/search-howto-management-rest-api).

Напротив, права администратора для содержимого, размещенного в службе, например возможность создания или удаления индекса, выводятся через ключи API, как описано в [предыдущем разделе](#index-access).

> [!TIP]
> Используя механизмы Azure, можно заблокировать подписку или ресурс, чтобы предотвратить случайное или несанкционированное удаление службы поиска пользователями с правами администратора. Дополнительные сведения см. [в разделе Блокировка ресурсов для предотвращения непредвиденного удаления](../azure-resource-manager/management/lock-resources.md).

## <a name="certifications-and-compliance"></a>Соответствие требованиям и сертификаты

Когнитивный поиск Azure сертифицирована для нескольких глобальных, региональных и отраслевых стандартов общедоступного облака и Azure для государственных организаций. Чтобы получить полный список, скачайте [технический документ о **предложениях соответствия Microsoft Azure** ](https://azure.microsoft.com/resources/microsoft-azure-compliance-offerings/) на официальной странице отчетов об аудите.

Для обеспечения соответствия требованиям вы можете использовать [политику Azure](../governance/policy/overview.md) для реализации рекомендаций по обеспечению [безопасности Azure](../security/benchmarks/introduction.md)с высоким уровнем безопасности. Производительность системы безопасности Azure — это набор рекомендаций по обеспечению безопасности, кодифицированные в средства управления безопасностью, которые соответствуют ключевым действиям, которые необходимо предпринять для уменьшения угроз для служб и данных. В настоящее время существует 11 элементов управления безопасностью, включая [безопасность сети](../security/benchmarks/security-control-network-security.md), [ведение журнала и мониторинг](../security/benchmarks/security-control-logging-monitoring.md), а также [защиту данных](../security/benchmarks/security-control-data-protection.md) .

Политика Azure — это возможность, встроенная в Azure, которая помогает управлять соответствием нескольким стандартам, включая показатели производительности системы безопасности Azure. Для хорошо известных тестов производительности политика Azure предоставляет встроенные определения, которые предоставляют как критерии, так и реагирование на действия, которые не соответствуют требованиям. 

Для Когнитивный поиск Azure в настоящее время имеется встроенное определение. Он предназначен для ведения журнала диагностики. С помощью этого встроенного средства можно назначить политику, определяющую любую службу поиска, в которой отсутствует Диагностическое протоколирование, а затем включить ее. Дополнительные сведения см. в статье [Управление соответствием нормативным требованиям политики Azure для когнитивный Поиск Azure](security-controls-policy.md).

## <a name="see-also"></a>См. также

+ [Основы обеспечения безопасности в Azure](../security/fundamentals/index.yml)
+ [Безопасность Azure](https://azure.microsoft.com/overview/security)
+ [Центр безопасности Azure](../security-center/index.yml)