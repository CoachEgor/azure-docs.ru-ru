---
title: Работа с результатами поиска
titleSuffix: Azure Cognitive Search
description: Структурирование и сортировка результатов поиска, получение числа документов и Навигация по содержимому в результатах поиска в Azure Когнитивный поиск.
manager: nitinme
author: HeidiSteen
ms.author: heidist
ms.service: cognitive-search
ms.topic: conceptual
ms.date: 11/04/2019
ms.openlocfilehash: 31af550d4f499b4b4440a27037dc210bfdf0cb6f
ms.sourcegitcommit: b050c7e5133badd131e46cab144dd5860ae8a98e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/23/2019
ms.locfileid: "72793453"
---
# <a name="how-to-work-with-search-results-in-azure-cognitive-search"></a>Работа с результатами поиска в Azure Когнитивный поиск
В данной статье приводятся рекомендации по реализации стандартных элементов страницы результатов поиска, например, общего подсчета, извлечения документа, порядка сортировки и навигации. Параметры, связанные со страницей, которые вносят данные или сведения в результаты поиска, задаются с помощью запросов [документов поиска](https://docs.microsoft.com/rest/api/searchservice/Search-Documents) , отправленных в службу когнитивный Поиск Azure. 

В REST API запросы включают команду GET, путь и параметры запроса, уведомляющие службу о том, что запрашивается и как сформировать ответ. В пакете SDK для .NET эквивалентным API является [класс DocumentSearchResult](https://docs.microsoft.com/dotnet/api/microsoft.azure.search.models.documentsearchresult-1).

В несколько примеров кода входит интерфейс веб-интерфейса, который можно найти здесь: [New Москва — демонстрационное приложение](https://azjobsdemo.azurewebsites.net/) и [когнитивесеарчфронтенд](https://github.com/LuisCabrer/CognitiveSearchFrontEnd).

> [!NOTE]
> Допустимый запрос содержит несколько элементов, например URL-адрес службы и путь, HTTP-команду, `api-version` и т. д. Для краткости в примерах указывается только синтаксис, касающийся разбивки на страницы. Дополнительные сведения о синтаксисе запросов см. в статье [Azure когнитивный Поиск API-интерфейсы RESTful](https://docs.microsoft.com/rest/api/searchservice).
>

## <a name="total-hits-and-page-counts"></a>Общее количество совпадений и страниц

Практически для всех страниц поиска основным является отображение общего количества результатов запроса с последующим их выводом более мелкими порциями.

![][1]

В Когнитивный поиск Azure для возврата этих значений используются параметры `$count`, `$top`и `$skip`. В следующем примере показан пример запроса на общее число попаданий в индексе с именем "Online-Catalog", возвращаемый как `@odata.count`:

    GET /indexes/online-catalog/docs?$count=true

Получать документы группами по 15, а также показывать общее количество совпадений, начиная с первой страницы:

    GET /indexes/online-catalog/docs?search=*&$top=15&$skip=0&$count=true

Разбивка результатов на страницы требует наличия как `$top`, так и `$skip`, где `$top` показывает количество выводимых элементов на странице, а `$skip` — количество элементов, которые нужно пропустить. В следующем примере на каждой странице отображаются очередные 15 элементов, на что указывает пошаговое увеличение параметра `$skip` .

    GET /indexes/online-catalog/docs?search=*&$top=15&$skip=0&$count=true

    GET /indexes/online-catalog/docs?search=*&$top=15&$skip=15&$count=true

    GET /indexes/online-catalog/docs?search=*&$top=15&$skip=30&$count=true

## <a name="layout"></a>Макет

На странице результатов поиска может потребоваться отобразить эскиз страницы, подмножество полей и ссылку на страницу полной версии продукта.

 ![][2]

В Когнитивный поиск Azure для реализации этого интерфейса можно использовать `$select` и [запрос API поиска](https://docs.microsoft.com/rest/api/searchservice/search-documents) .

Чтобы получить подмножество полей для мозаичного макета:

    GET /indexes/online-catalog/docs?search=*&$select=productName,imageFile,description,price,rating

Непосредственный поиск в изображениях и файлах мультимедиа невозможен. Для уменьшения расходов они должны сохраняться на другой платформе хранения, такой как хранилище BLOB-объектов Azure. В индексе и документах определите поле, в котором содержится URL-адрес внешнего контента. Затем можно использовать это поле как ссылку на изображение. URL-адрес изображения должен находиться в документе.

Чтобы получить страницу описания продукта для события **onClick** , используйте [Поиск документа](https://docs.microsoft.com/rest/api/searchservice/Lookup-Document) для передачи ключа документа, который нужно получить. Тип данных ключа — `Edm.String`. В данном примере это *246810*.

    GET /indexes/online-catalog/docs/246810

## <a name="sort-by-relevance-rating-or-price"></a>Сортировка по соответствию, оценке или цене

Порядок сортировки по соответствию часто задан по умолчанию, но обычно альтернативные порядки сортировки подготавливаются заранее, чтобы клиенты могли быстро реорганизовать имеющиеся результаты в другом порядке приоритетности.

 ![][3]

В Когнитивный поиск Azure сортировка основана на `$orderby` выражении для всех полей, индексируемых как `"Sortable": true.` предложение `$orderby` является выражением OData. Дополнительные сведения о синтаксисе см. в статье [Синтаксис выражений OData для предложений фильтрации и упорядочивания в службе "Поиск Azure"](query-odata-filter-orderby-syntax.md).

Соответствие тесно связано с профилями оценки. Можно использовать оценки по умолчанию, зависящие от анализа текста и статистики для расстановки всех результатов по критерию выбора, при этом более высокая оценка дается документам с большим количеством или более точными совпадениями с условием поиска.

Альтернативные порядки сортировки обычно связаны с событиями **onClick** , вызывающими метод, который строит выбранный порядок сортировки. Например, если взять этот элемент страницы:

 ![][4]

Можно создать метод, который принимает выбранный параметр сортировки в качестве ввода и возвращает список, упорядоченный по критериям, связанным с этим параметром.

 ![][5]

> [!NOTE]
> В то время как оценка по умолчанию является достаточной для многих сценариев, рекомендуется, чтобы соответствие основывалось на пользовательском профиле оценки. Пользовательский профиль оценки предоставляет способ повышения приоритета элементов, имеющих большее значение для бизнеса. Дополнительную информацию см. в статье [Добавление профилей повышения в индекс службы "Поиск Azure"](index-add-scoring-profiles.md).
>

## <a name="faceted-navigation"></a>Фасетная навигация

Навигация поиска обычно находится на странице результатов, часто сбоку или вверху страницы. В Когнитивный поиск Azure область навигации с аспектами обеспечивает самостоятельный поиск на основе предопределенных фильтров. Дополнительные сведения см. [в разделе Навигация с аспектами в когнитивный Поиск Azure](search-faceted-navigation.md) .

## <a name="filters-at-the-page-level"></a>Фильтры на уровне страницы

Если структура решения включала выделенные страницы поиска для конкретных типов содержимого (например, Интернет-приложение розничной торговли, в котором есть подразделения, перечисленные в верхней части страницы), можно вставить [выражение фильтра](search-filters.md) вместе с событием **OnClick** , чтобы Откройте страницу в предварительно отфильтрованном состоянии.

Можно отправлять фильтр с выражением поиска или без него. Например, следующий запрос осуществляет фильтрацию по имени бренда, выводя только те документы, которые соответствуют ему.

    GET /indexes/online-catalog/docs?$filter=brandname eq 'Microsoft' and category eq 'Games'

Дополнительные сведения о выражениях `$filter` см. в разделе [Поиск документов (Azure КОГНИТИВНЫЙ Поиск API)](https://docs.microsoft.com/rest/api/searchservice/Search-Documents) .

## <a name="see-also"></a>См. также

- [REST API Когнитивный поиск Azure](https://docs.microsoft.com/rest/api/searchservice)
- [Операции с индексами](https://docs.microsoft.com/rest/api/searchservice/Index-operations)
- [Операции с документом.](https://docs.microsoft.com/rest/api/searchservice/Document-operations)
- [Навигация с аспектами в Azure Когнитивный поиск](search-faceted-navigation.md)

<!--Image references-->
[1]: ./media/search-pagination-page-layout/Pages-1-Viewing1ofNResults.PNG
[2]: ./media/search-pagination-page-layout/Pages-2-Tiled.PNG
[3]: ./media/search-pagination-page-layout/Pages-3-SortBy.png
[4]: ./media/search-pagination-page-layout/Pages-4-SortbyRelevance.png
[5]: ./media/search-pagination-page-layout/Pages-5-BuildSort.png
