---
title: Как работать с результатами поиска в службе "Поиск Azure"
description: Структурируйте и сортируйте результаты поиска, получайте число документов и добавляйте навигацию содержимого к результатам поиска в службе "Поиск Azure".
author: HeidiSteen
manager: cgronlun
services: search
ms.service: search
ms.devlang: ''
ms.topic: conceptual
ms.date: 05/02/2019
ms.author: heidist
ms.custom: seodec2018
ms.openlocfilehash: dc208f3231882a0726733c897e70557c657cddf3
ms.sourcegitcommit: 4b9c06dad94dfb3a103feb2ee0da5a6202c910cc
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/02/2019
ms.locfileid: "65024522"
---
# <a name="how-to-work-with-search-results-in-azure-search"></a>Как работать с результатами поиска в службе "Поиск Azure"
В данной статье приводятся рекомендации по реализации стандартных элементов страницы результатов поиска, например, общего подсчета, извлечения документа, порядка сортировки и навигации. Связанные со страницей параметры, добавляющие данные или информацию к результатам поиска, задаются в запросах [поиска в документе](https://docs.microsoft.com/rest/api/searchservice/Search-Documents), отправляемых службе "Поиск Azure". 

В REST API запросы включают команду GET, путь и параметры запроса, уведомляющие службу о том, что запрашивается и как сформировать ответ. В пакете SDK для .NET эквивалентным API является [класс DocumentSearchResult](https://docs.microsoft.com/dotnet/api/microsoft.azure.search.models.documentsearchresult?view=azure-dotnet).

В некоторых примерах кода предусмотрен пользовательский веб-интерфейс, который можно найти здесь: [демонстрационное приложение New York City Jobs](https://azjobsdemo.azurewebsites.net/) и [CognitiveSearchFrontEnd](https://github.com/LuisCabrer/CognitiveSearchFrontEnd).

> [!NOTE]
> Допустимый запрос содержит несколько элементов, например URL-адрес службы и путь, HTTP-команду, `api-version` и т. д. Для краткости в примерах указывается только синтаксис, касающийся разбивки на страницы. Дополнительные сведения о синтаксисе запроса см. в разделе [REST службы поиска Azure](https://docs.microsoft.com/rest/api/searchservice).
>

## <a name="total-hits-and-page-counts"></a>Общее количество совпадений и страниц
Практически для всех страниц поиска основным является отображение общего количества результатов запроса с последующим их выводом более мелкими порциями.

![][1]

В поиске Azure используйте параметры `$count`, `$top` и `$skip` для вывода этих значений. В следующем примере показан пример запроса для общего количества совпадений, в индексе onlineCatalog, возвращаемого как `@OData.count`.

        GET /indexes/onlineCatalog/docs?$count=true

Получать документы группами по 15, а также показывать общее количество совпадений, начиная с первой страницы:

        GET /indexes/onlineCatalog/docs?search=*$top=15&$skip=0&$count=true

Разбивка результатов на страницы требует наличия как `$top`, так и `$skip`, где `$top` показывает количество выводимых элементов на странице, а `$skip` — количество элементов, которые нужно пропустить. В следующем примере на каждой странице отображаются очередные 15 элементов, на что указывает пошаговое увеличение параметра `$skip` .

        GET /indexes/onlineCatalog/docs?search=*$top=15&$skip=0&$count=true

        GET /indexes/onlineCatalog/docs?search=*$top=15&$skip=15&$count=true

        GET /indexes/onlineCatalog/docs?search=*$top=15&$skip=30&$count=true

## <a name="layout"></a>Макет
На странице результатов поиска может потребоваться отобразить эскиз страницы, подмножество полей и ссылку на страницу полной версии продукта.

 ![][2]

Для реализации данного интерфейса в Поиске Azure используйте `$select` и команду поиска.

Чтобы получить подмножество полей для мозаичного макета:

        GET /indexes/ onlineCatalog/docs?search=*&$select=productName,imageFile,description,price,rating 

Непосредственный поиск в изображениях и файлах мультимедиа невозможен. Для уменьшения расходов они должны сохраняться на другой платформе хранения, такой как хранилище BLOB-объектов Azure. В индексе и документах определите поле, в котором содержится URL-адрес внешнего контента. Затем можно использовать это поле как ссылку на изображение. URL-адрес изображения должен находиться в документе.

Чтобы получить страницу описания продукта для события **onClick** , используйте [Поиск документа](https://docs.microsoft.com/rest/api/searchservice/Lookup-Document) для передачи ключа документа, который нужно получить. Тип данных ключа — `Edm.String`. В данном примере это *246810*. 

        GET /indexes/onlineCatalog/docs/246810

## <a name="sort-by-relevance-rating-or-price"></a>Сортировка по соответствию, оценке или цене
Порядок сортировки по соответствию часто задан по умолчанию, но обычно альтернативные порядки сортировки подготавливаются заранее, чтобы клиенты могли быстро реорганизовать имеющиеся результаты в другом порядке приоритетности.

 ![][3]

В службе "Поиск Azure" сортировка основывается на выражении `$orderby` для всех полей, которые индексируются как `"Sortable": true.`. Предложение `$orderby` является выражением OData. Дополнительные сведения о синтаксисе см. в статье [Синтаксис выражений OData для предложений фильтрации и упорядочивания в службе "Поиск Azure"](query-odata-filter-orderby-syntax.md).

Соответствие тесно связано с профилями оценки. Можно использовать оценки по умолчанию, зависящие от анализа текста и статистики для расстановки всех результатов по критерию выбора, при этом более высокая оценка дается документам с большим количеством или более точными совпадениями с условием поиска.

Альтернативные порядки сортировки обычно связаны с событиями **onClick** , вызывающими метод, который строит выбранный порядок сортировки. Например, если взять этот элемент страницы:

 ![][4]

Можно создать метод, который принимает выбранный параметр сортировки в качестве ввода и возвращает список, упорядоченный по критериям, связанным с этим параметром.

 ![][5]

> [!NOTE]
> В то время как оценка по умолчанию является достаточной для многих сценариев, рекомендуется, чтобы соответствие основывалось на пользовательском профиле оценки. Пользовательский профиль оценки предоставляет способ повышения приоритета элементов, имеющих большее значение для бизнеса. Дополнительную информацию см. в статье [Добавление профилей повышения в индекс службы "Поиск Azure"](index-add-scoring-profiles.md). 
> 
> 

## <a name="faceted-navigation"></a>Фасетная навигация
Навигация поиска обычно находится на странице результатов, часто сбоку или вверху страницы. В Поиске Azure фасетная навигация обеспечивает самостоятельный поиск на основе предварительно заданных фильтров. Дополнительные сведения см. в статье [Как реализовать фасетную навигацию в службе поиска Azure](search-faceted-navigation.md).

## <a name="filters-at-the-page-level"></a>Фильтры на уровне страницы
Если схема решения предусматривает специальные поисковые страницы для содержимого определенных типов (например, приложение для розничной торговли в Интернете с перечнем отделов в верхней части страницы), вы можете вставить [выражение фильтра](search-filters.md) наряду с событием **onClick**, чтобы затем открыть страницу в состоянии после первичного фильтра. 

Можно отправлять фильтр с выражением поиска или без него. Например, следующий запрос осуществляет фильтрацию по имени бренда, выводя только те документы, которые соответствуют ему.

        GET /indexes/onlineCatalog/docs?$filter=brandname eq ‘Microsoft’ and category eq ‘Games’

Дополнительные сведения о выражениях `$filter` см. в статье [Search Documents (Azure Search Service REST API)](https://docs.microsoft.com/rest/api/searchservice/Search-Documents) (Поиск документов (REST API службы поиска Azure)).

## <a name="see-also"></a>См. также
* [REST API службы поиска Azure](https://docs.microsoft.com/rest/api/searchservice)
* [Операции с индексами](https://docs.microsoft.com/rest/api/searchservice/Index-operations)
* [Операции с документом.](https://docs.microsoft.com/rest/api/searchservice/Document-operations)
* [Фасетная навигация в службе поиска Azure](search-faceted-navigation.md)

<!--Image references-->
[1]: ./media/search-pagination-page-layout/Pages-1-Viewing1ofNResults.PNG
[2]: ./media/search-pagination-page-layout/Pages-2-Tiled.PNG
[3]: ./media/search-pagination-page-layout/Pages-3-SortBy.png
[4]: ./media/search-pagination-page-layout/Pages-4-SortbyRelevance.png
[5]: ./media/search-pagination-page-layout/Pages-5-BuildSort.png 
