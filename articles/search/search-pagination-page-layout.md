---
title: Как работать с результатами поиска
titleSuffix: Azure Cognitive Search
description: Структурируйте и сортируйте результаты поиска, получайте количество документов и добавляйте навигацию содержимого в результаты поиска в Azure Cognitive Search.
manager: nitinme
author: HeidiSteen
ms.author: heidist
ms.service: cognitive-search
ms.topic: conceptual
ms.date: 01/24/2020
ms.openlocfilehash: 124f1ce3d30ce87d5e9d8fa027e5a7d6c0b3cb17
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "79481608"
---
# <a name="how-to-work-with-search-results-in-azure-cognitive-search"></a>Как работать с результатами поиска в Azure Cognitive Search
В данной статье приводятся рекомендации по реализации стандартных элементов страницы результатов поиска, например, общего подсчета, извлечения документа, порядка сортировки и навигации. Параметры, связанные со страницей, которые вносят данные или информацию в результаты поиска, определяются через запросы [поисковых документов,](https://docs.microsoft.com/rest/api/searchservice/Search-Documents) отправленные в службу когнитивного поиска Azure. 

В REST API запросы включают команду GET, путь и параметры запроса, уведомляющие службу о том, что запрашивается и как сформировать ответ. В пакете SDK для .NET эквивалентным API является [класс DocumentSearchResult](https://docs.microsoft.com/dotnet/api/microsoft.azure.search.models.documentsearchresult-1).

Чтобы быстро создать страницу поиска для клиента, изучите следующие варианты:

+ Используйте [генератор приложений](search-create-app-portal.md) на портале для создания HTML-страницы с панелью поиска, граненой навигацией и областью результатов.
+ Следуйте [Создать свое первое приложение в](tutorial-csharp-create-first-app.md) учебнике по C, чтобы создать функционального клиента.

Несколько образцов кода включают веб-интерфейс интерфейса, который вы можете найти здесь: [New York City Jobs демо-приложение,](https://aka.ms/azjobsdemo) [JavaScript образец кода с живой демо-сайт](https://github.com/liamca/azure-search-javascript-samples), и [CognitiveSearchFrontEnd](https://github.com/LuisCabrer/CognitiveSearchFrontEnd).

> [!NOTE]
> Допустимый запрос содержит несколько элементов, например URL-адрес службы и путь, HTTP-команду, `api-version` и т. д. Для краткости в примерах указывается только синтаксис, касающийся разбивки на страницы. Для получения дополнительной информации [Azure Cognitive Search REST APIs](https://docs.microsoft.com/rest/api/searchservice)о синтаксисе запроса см.
>

## <a name="total-hits-and-page-counts"></a>Общее количество совпадений и страниц

Практически для всех страниц поиска основным является отображение общего количества результатов запроса с последующим их выводом более мелкими порциями.

![][1]

В Azure Cognitive Search `$count`вы `$top`используете , и `$skip` параметры, чтобы вернуть эти значения. Следующий пример показывает пример запроса для общего количества хитов на `@odata.count`индекс под названием "онлайн-каталог", возвращенный как:

    GET /indexes/online-catalog/docs?$count=true

Получать документы группами по 15, а также показывать общее количество совпадений, начиная с первой страницы:

    GET /indexes/online-catalog/docs?search=*&$top=15&$skip=0&$count=true

Разбивка результатов на страницы требует наличия как `$top`, так и `$skip`, где `$top` показывает количество выводимых элементов на странице, а `$skip` — количество элементов, которые нужно пропустить. В следующем примере на каждой странице отображаются очередные 15 элементов, на что указывает пошаговое увеличение параметра `$skip` .

    GET /indexes/online-catalog/docs?search=*&$top=15&$skip=0&$count=true

    GET /indexes/online-catalog/docs?search=*&$top=15&$skip=15&$count=true

    GET /indexes/online-catalog/docs?search=*&$top=15&$skip=30&$count=true

## <a name="layout"></a>Макет

На странице результатов поиска может потребоваться отобразить эскиз страницы, подмножество полей и ссылку на страницу полной версии продукта.

 ![][2]

В Azure Cognitive Search `$select` вы будете использовать [и запрос API поиска](https://docs.microsoft.com/rest/api/searchservice/search-documents) для реализации этого опыта.

Чтобы получить подмножество полей для мозаичного макета:

    GET /indexes/online-catalog/docs?search=*&$select=productName,imageFile,description,price,rating

Непосредственный поиск в изображениях и файлах мультимедиа невозможен. Для уменьшения расходов они должны сохраняться на другой платформе хранения, такой как хранилище BLOB-объектов Azure. В индексе и документах определите поле, в котором содержится URL-адрес внешнего контента. Затем можно использовать это поле как ссылку на изображение. URL-адрес изображения должен находиться в документе.

Чтобы получить страницу описания продукта для события **onClick** , используйте [Поиск документа](https://docs.microsoft.com/rest/api/searchservice/Lookup-Document) для передачи ключа документа, который нужно получить. Тип данных ключа — `Edm.String`. В данном примере это *246810*.

    GET /indexes/online-catalog/docs/246810

## <a name="sort-by-relevance-rating-or-price"></a>Сортировка по соответствию, оценке или цене

Порядок сортировки по соответствию часто задан по умолчанию, но обычно альтернативные порядки сортировки подготавливаются заранее, чтобы клиенты могли быстро реорганизовать имеющиеся результаты в другом порядке приоритетности.

 ![][3]

В Azure Cognitive Search сортировка основана на `$orderby` выражении, `"Sortable": true.` `$orderby` поскольку все поля, индексированные как оговорка, являются выражением OData. Дополнительные сведения о синтаксисе см. в статье [Синтаксис выражений OData для предложений фильтрации и упорядочивания в службе "Поиск Azure"](query-odata-filter-orderby-syntax.md).

Соответствие тесно связано с профилями оценки. Можно использовать оценки по умолчанию, зависящие от анализа текста и статистики для расстановки всех результатов по критерию выбора, при этом более высокая оценка дается документам с большим количеством или более точными совпадениями с условием поиска.

Альтернативные порядки сортировки обычно связаны с событиями **onClick** , вызывающими метод, который строит выбранный порядок сортировки. Например, если взять этот элемент страницы:

 ![][4]

Можно создать метод, который принимает выбранный параметр сортировки в качестве ввода и возвращает список, упорядоченный по критериям, связанным с этим параметром.

 ![][5]

> [!NOTE]
> В то время как оценка по умолчанию является достаточной для многих сценариев, рекомендуется, чтобы соответствие основывалось на пользовательском профиле оценки. Пользовательский профиль оценки предоставляет способ повышения приоритета элементов, имеющих большее значение для бизнеса. Для получения дополнительной информации можно [добавить профили скоринга.](index-add-scoring-profiles.md)
>

## <a name="hit-highlighting"></a>Выделение совпадений

Вы можете применить форматирование к подходящим терминам в результатах поиска, что позволяет легко обнаружить совпадение. Инструкции по подсветке хита предоставляются в [запросе запроса.](https://docs.microsoft.com/rest/api/searchservice/search-documents) 

Форматирование применяется к запросам всего срока. Запросы на частичных терминах, таких как нечеткий поиск или поиск подстановочных знаков, которые приводят к расширению запроса в движке, не могут использовать выделение хита.

```http
POST /indexes/hotels/docs/search?api-version=2019-05-06 
    {  
      "search": "something",  
      "highlight": "Description"  
    }
```

> [!IMPORTANT]
> Услуги, созданные после 15 июля 2020 года, предоставят другой опыт выделения. Службы, созданные до этой даты, не изменятся в поведении выделений. С этим изменением будут возвращены только фразы, которые соответствуют полному запросу фразы. Также можно будет указать размер фрагмента, возвращенный для изюминки.
>
> Когда вы пишете клиентский код, который реализует выделение хита, будьте в курсе этого изменения. Обратите внимание, что это не повлияет на вас, если вы не создадите совершенно новый поисковый сервис.

## <a name="faceted-navigation"></a>Фасетная навигация

Навигация поиска обычно находится на странице результатов, часто сбоку или вверху страницы. В Azure Cognitive Search граненый поиск обеспечивает самостоятельный поиск на основе предопределенных фильтров. См [Faceted навигации в Azure когнитивного поиска](search-faceted-navigation.md) для получения подробной информации.

## <a name="filters-at-the-page-level"></a>Фильтры на уровне страницы

Если дизайн решения включал выделенные страницы поиска для определенных типов контента (например, онлайн-приложение розничной торговли, в которое перечислены отделы в верхней части страницы), можно вставить [выражение фильтра](search-filters.md) рядом с событием **onClick,** чтобы открыть страницу в предварительно отфильтрованное состояние.

Можно отправлять фильтр с выражением поиска или без него. Например, следующий запрос осуществляет фильтрацию по имени бренда, выводя только те документы, которые соответствуют ему.

    GET /indexes/online-catalog/docs?$filter=brandname eq 'Microsoft' and category eq 'Games'

Для получения дополнительной информации о `$filter` выражениях можно ознакомиться с [поиском документов (Azure Cognitive Search API).](https://docs.microsoft.com/rest/api/searchservice/Search-Documents)

## <a name="see-also"></a>См. также

- [Azure Search Service REST](https://docs.microsoft.com/rest/api/searchservice) (Руководство по REST Службы поиска Azure)
- [Операции индекса](https://docs.microsoft.com/rest/api/searchservice/Index-operations)
- [Операции с документами](https://docs.microsoft.com/rest/api/searchservice/Document-operations)
- [Смягчная навигация в когнитивном поиске Azure](search-faceted-navigation.md)

<!--Image references-->
[1]: ./media/search-pagination-page-layout/Pages-1-Viewing1ofNResults.PNG
[2]: ./media/search-pagination-page-layout/Pages-2-Tiled.PNG
[3]: ./media/search-pagination-page-layout/Pages-3-SortBy.png
[4]: ./media/search-pagination-page-layout/Pages-4-SortbyRelevance.png
[5]: ./media/search-pagination-page-layout/Pages-5-BuildSort.png
