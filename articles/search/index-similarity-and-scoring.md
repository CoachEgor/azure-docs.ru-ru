---
title: Обзор сходства и оценки
titleSuffix: Azure Cognitive Search
description: Объясняются понятия сходства и оценки, а также действия, которые разработчик может выполнить для настройки результатов оценки.
manager: nitinme
author: luiscabrer
ms.author: luisca
ms.service: cognitive-search
ms.topic: conceptual
ms.date: 04/27/2020
ms.openlocfilehash: 9f9cc4c29b117c83595a36c4e28b1edb428c3cde
ms.sourcegitcommit: 58faa9fcbd62f3ac37ff0a65ab9357a01051a64f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2020
ms.locfileid: "82254126"
---
# <a name="similarity-and-scoring-in-azure-cognitive-search"></a>Сходство и оценка в Azure Когнитивный поиск

Оценка — это вычисление оценки поиска для каждого элемента, возвращаемого в результатах поиска для запросов полнотекстового поиска. Это показатель релевантности элемента в контексте текущей операции поиска. Чем выше оценка, тем более релевантен элемент. Элементы в результатах поиска упорядочиваются по рангу (от наивысшего до наинизшего) на основе оценок поиска, вычисленных для каждого элемента. 

По умолчанию первые 50 возвращаются в ответе, но можно использовать параметр **$Top** для возврата меньшего или большего числа элементов (до 1000 в одном ответе) и **$Skip** для получения следующего набора результатов.

Оценка поиска вычисляется на основе статистических свойств данных и запроса. Azure Когнитивный поиск находит документы, которые соответствуют условиям поиска (некоторые или все, в зависимости от [searchMode](https://docs.microsoft.com/rest/api/searchservice/search-documents#searchmodeany--all-optional)), и документы, содержащие много экземпляров условия поиска. Оценка поиска выполняется еще более высоко, если в индексе данных слишком редко встречается термин, но в документе. Базовый подход к вычислению релевантности называется *TF-IDF или* периодичностью терминов — инверсией документа.

Значения оценки поиска в результирующем наборе могут повторяться. Если несколько попаданий имеют одинаковый показатель поиска, порядок тех же оцененных элементов не определяется и не является стабильным. Выполните запрос еще раз, и вы увидите позиции сдвига элементов, особенно если используется бесплатная служба или оплачиваемая служба с несколькими репликами. Если есть два элемента с одинаковой оценкой, невозможно определить, какой из них отобразится первым.

Если требуется разорвать связь между повторяющимися показателями, можно добавить предложение **$OrderBy** , чтобы сначала упорядочить по оценке, а затем упорядочить по другому полю, допускающему сортировку (например `$orderby=search.score() desc,Rating desc`,). Дополнительные сведения см. в разделе [$OrderBy](https://docs.microsoft.com/azure/search/search-query-odata-orderby).

> [!NOTE]
> Объект `@search.score = 1.00` указывает на результирующий набор без оценки или без ранжирования. Оценка одинакова для всех результатов. Неоцененные результаты происходят, когда форма запроса является нечетким поиском, запросами с подстановочными знаками или регулярными выражениями или выражением **$Filter** . 

## <a name="scoring-profiles"></a>Профили оценки

Можно настроить способ ранжирования различных полей, определив настраиваемый *профиль оценки*. Профили оценки позволяют управлять приоритетом элементов в результатах поиска. Например, может потребоваться повысить приоритет элементов на основе потенциального дохода, повысить уровень более новых элементов или, возможно, элементов, которые слишком долго находились на складе. 

Профиль повышения — часть определения индекса, состоящая из взвешенных полей, функций и параметров. Дополнительные сведения об определении одного см. в разделе [Профили оценки](index-add-scoring-profiles.md).

## <a name="scoring-statistics"></a>Статистика оценки

Для масштабируемости Azure Когнитивный поиск распределяет каждый индекс по горизонтали через процесс сегментирования, что означает физическое разделение частей индекса.

По умолчанию Оценка документа вычисляется на основе статистических свойств данных *внутри сегмента*. Как правило, этот подход не является проблемой для больших совокупности данных и обеспечивает лучшую производительность, чем вычисление оценки на основе информации по всем сегментам. С другой стороны, использование этой оптимизации производительности может привести к тому, что два очень похожих документа (или даже идентичные документы) будут иметь разные показатели релевантности, если они будут находиться в разных сегментах.

Если вы предпочитаете вычислить оценку на основе статистических свойств для всех сегментов, это можно сделать, добавив *скорингстатистикс = Global* в качестве [параметра запроса](https://docs.microsoft.com/rest/api/searchservice/search-documents) (или добавив *"скорингстатистикс": "Global"* в качестве параметра Body [запроса](https://docs.microsoft.com/rest/api/searchservice/search-documents)).

```http
GET https://[service name].search.windows.net/indexes/[index name]/docs?scoringStatistics=global
  Content-Type: application/json
  api-key: [admin key]  
```

> [!NOTE]
> Для `scoringStatistics` параметра требуется ключ API администратора.

## <a name="similarity-ranking-algorithms"></a>Алгоритмы ранжирования подобия

Azure Когнитивный поиск поддерживает два разных алгоритма ранжирования сходства: *классический алгоритм подобия* и официальную реализацию алгоритма *BM25 Окапи* (в настоящее время в предварительной версии). Классический алгоритм подобия является алгоритмом по умолчанию, но начиная с 15 июля все новые службы, созданные после этой даты, используют новый алгоритм BM25. Это единственный алгоритм, доступный для новых служб.

Сейчас можно указать алгоритм ранжирования сходства, который вы хотите использовать. Дополнительные сведения см. в разделе [алгоритм ранжирования](index-ranking-similarity.md).

## <a name="watch-this-video"></a>Рекомендуемый видеоролик

В этом 16-минутном видео инженер по Раауф Мерауче объясняет процесс индексирования, выполнения запросов и создания профилей оценки. Это дает хорошее представление о том, что происходит в процессе индексирования и извлечения документов.

>[!VIDEO https://channel9.msdn.com/Shows/AI-Show/Similarity-and-Scoring-in-Azure-Cognitive-Search/player]

+ 2-3 минут обсудим индексирование: обработка текста и лексический анализ.
+ 3-4 минут обсудим индексирование: Инвертированные индексы.
+ 4-6 минут, охватывающих запросы: получение и ранжирование.
+ 7-16 минут охватывает профили оценки.

## <a name="see-also"></a>См. также

 [REST API Справочник](https://docs.microsoft.com/rest/api/searchservice/) по [профилям оценки](index-add-scoring-profiles.md)   
 [API поиска документов](https://docs.microsoft.com/rest/api/searchservice/search-documents)   
 [Пакет SDK Azure Когнитивный поиск для .NET](https://docs.microsoft.com/dotnet/api/overview/azure/search?view=azure-dotnet)  
