---
title: Распространенные ошибки и предупреждения — Поиск Azure
description: Эта статья содержит сведения и решения для распространенных ошибок и предупреждений, которые могут возникнуть во время обогащения искусственного интеллекта в службе поиска Azure.
services: search
manager: heidist
author: amotley
ms.service: search
ms.workload: search
ms.topic: conceptual
ms.date: 09/18/2019
ms.author: abmotley
ms.openlocfilehash: b5a161e570489e6382f2226ab5dc9a1c34dc67df
ms.sourcegitcommit: 11265f4ff9f8e727a0cbf2af20a8057f5923ccda
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/08/2019
ms.locfileid: "72028321"
---
# <a name="common-errors-and-warnings-of-the-ai-enrichment-pipeline-in-azure-search"></a>Распространенные ошибки и предупреждения конвейера обогащения искусственного интеллекта в службе поиска Azure

Эта статья содержит сведения и решения для распространенных ошибок и предупреждений, которые могут возникнуть во время обогащения искусственного интеллекта в службе поиска Azure.

## <a name="errors"></a>Errors
Индексирование останавливается, если число ошибок превышает ["максфаиледитемс"](cognitive-search-concept-troubleshooting.md#tip-3-see-what-works-even-if-there-are-some-failures). 

Если вы хотите, чтобы индексаторы проигнорировали эти ошибки (и пропустить "документы с ошибками"), обновите `maxFailedItems` и `maxFailedItemsPerBatch`, как описано [здесь](https://docs.microsoft.com/rest/api/searchservice/create-indexer#general-parameters-for-all-indexers).

> [!NOTE]
> Каждый неудачный документ вместе с ключом документа (если он доступен) будет отображаться как ошибка в состоянии выполнения индексатора. Можно использовать [API индексов](https://docs.microsoft.com/rest/api/searchservice/addupdate-or-delete-documents) , чтобы вручную отправить документы в более поздний момент, если вы настроили индексатор для допуска сбоев.

Следующие разделы помогут устранить ошибки, допуская индексацию для продолжения.

### <a name="could-not-read-document"></a>Не удалось прочитать документ
Индексатору не удалось прочитать документ из источника данных. Это может произойти по следующим причинам.

| `Reason` | Пример | Action |
| --- | --- | --- |
| несогласованные типы полей в разных документах | Тип значения не соответствует типу столбца. Не удалось сохранить `'{47.6,-122.1}'` в столбце Authors.  Ожидаемый тип — Жаррай. | Убедитесь, что тип каждого поля одинаков для разных документов. Например, если первый документ `'startTime'` является типом DateTime, а во втором — строкой, будет достигнута эта ошибка. |
| ошибки базовой службы источника данных | (от Cosmos DB) `{"Errors":["Request rate is large"]}` | Проверьте экземпляр хранилища, чтобы убедиться в его работоспособности. Возможно, потребуется настроить масштабирование или секционирование. |
| временные проблемы | ошибка на транспортном уровне при получении результатов с сервера. (поставщик: Поставщик TCP, ошибка: 0 — существующее подключение было принудительно закрыто удаленным узлом | Иногда возникают непредвиденные проблемы с подключением. Попробуйте снова запустить документ через индексатор позже. |

### <a name="could-not-extract-document-content"></a>Не удалось извлечь содержимое документа
Индексатору с источником данных большого двоичного объекта не удалось извлечь содержимое из документа (например, PDF-файл). Это может произойти по следующим причинам.

| `Reason` | Пример | Action |
| --- | --- | --- |
| Превышен предельный размер BLOB-объекта | Размер документа составляет `'150441598'` байт, что превышает максимальную длину `'134217728'` байт для извлечения документа для текущего уровня служб. | [ошибки индексирования BLOB-объектов](search-howto-indexing-azure-blob-storage.md#dealing-with-errors) |
| тип содержимого BLOB-объекта не поддерживается | Документ имеет неподдерживаемый тип содержимого `'image/png'` | [ошибки индексирования BLOB-объектов](search-howto-indexing-azure-blob-storage.md#dealing-with-errors) |
| BLOB-объект зашифрован | Документ не может быть обработан. он может быть зашифрован или защищен паролем. | [Параметры большого двоичного объекта](search-howto-indexing-azure-blob-storage.md#controlling-which-parts-of-the-blob-are-indexed) |
| временные проблемы | Ошибка обработки большого двоичного объекта: Запрос был прерван: Запрос был отменен. | Иногда возникают непредвиденные проблемы с подключением. Попробуйте снова запустить документ через индексатор позже. |

### <a name="could-not-parse-document"></a>Не удалось проанализировать документ
Индексатор считывает документ из источника данных, но возникла ошибка при преобразовании содержимого документа в указанную схему сопоставления полей. Это может произойти по следующим причинам.

| `Reason` | Пример | Action |
| --- | --- | --- |
| Отсутствует ключ документа | Ключ документа не может быть указан или пуст | Убедитесь, что все документы содержат допустимые ключи документов |
| Недопустимый ключ документа | Длина ключа документа не должна превышать 1024 символов | Измените ключ документа в соответствии с требованиями проверки. |
| Не удалось применить сопоставление полей к полю | Не удалось применить функцию сопоставления `'functionName'` к полю `'fieldName'`. Массив не может иметь значение null. Имя параметра: байт | Дважды проверьте [сопоставления полей](search-indexer-field-mappings.md) , определенные в индексаторе, и сравните с данными указанного поля документа, в котором произошел сбой. Может потребоваться изменить сопоставления полей или данные документа. |
| Не удалось прочитать значение поля | Не удалось считать значение столбца `'fieldName'` в индексе `'fieldIndex'`. ошибка на транспортном уровне при получении результатов с сервера. (поставщик: Поставщик TCP, ошибка: 0 — существующее подключение было принудительно закрыто удаленным узлом.) | Эти ошибки обычно возникают из-за непредвиденных проблем с подключением к базовой службе источника данных. Попробуйте снова запустить документ через индексатор позже. |

### <a name="could-not-index-document"></a>Не удалось индексировать документ
Документ был прочитан и обработан, но индексатор не смог добавить его в индекс поиска. Это может произойти по следующим причинам.

| `Reason` | Пример | Action |
| --- | --- | --- |
| Поле содержит слишком большой термин | Срок в документе превышает [ограничение в 32 КБ](search-limits-quotas-capacity.md#api-request-limits) | Это ограничение можно избежать, убедившись, что поле не настроено в качестве фильтруемого, аспекта или сортировки.
| Документ слишком велик для индексирования | Размер документа больше [максимального размера запроса API](search-limits-quotas-capacity.md#api-request-limits) | [Индексирование больших наборов данных](search-howto-large-index.md)

### <a name="skill-input-languagecode-has-the-following-language-codes-xyz-at-least-one-of-which-is-invalid"></a>Ввод навыка "languageCode" имеет следующие коды языка "X, Y, Z", по крайней мере один из которых является недопустимым.
Одно или несколько значений, переданных в необязательный ввод `languageCode` для подчиненного навыка, не поддерживаются. Это может произойти, если вы передаете выходные данные [лангуажедетектионскилл](cognitive-search-skill-language-detection.md) в последующие навыки, а выходные данные состоят из большего числа языков, чем поддерживаются в этих нижестоящих навыках.

Если известно, что набор данных находится на одном языке, следует удалить [лангуажедетектионскилл](cognitive-search-skill-language-detection.md) и `languageCode`, а также использовать параметр навыка `defaultLanguageCode` для этого навыка, предполагая, что язык поддерживается для этого навыка.

Если вы уверены, что набор данных содержит несколько языков и поэтому вам нужны входные данные [лангуажедетектионскилл](cognitive-search-skill-language-detection.md) и `languageCode`, рассмотрите возможность добавления [кондитионалскилл](cognitive-search-skill-conditional.md) для фильтрации текста с использованием языков, которые не поддерживаются до передачи в текст к подчиненному навыку.  Ниже приведен пример того, как это может выглядеть для Ентитирекогнитионскилл:

```json
{
    "@odata.type": "#Microsoft.Skills.Util.ConditionalSkill",
    "context": "/document",
    "inputs": [
        { "name": "condition", "source": "= $(/document/language) == 'de' || $(/document/language) == 'en' || $(/document/language) == 'es' || $(/document/language) == 'fr' || $(/document/language) == 'it'" },
        { "name": "whenTrue", "source": "/document/content" },
        { "name": "whenFalse", "source": "= null" }
    ],
    "outputs": [ { "name": "output", "targetName": "supportedByEntityRecognitionSkill" } ]
}
```

Ниже приведены некоторые ссылки на языки, поддерживаемые в настоящее время для каждого из навыков, которые могут вызвать это сообщение об ошибке:
* [Анализ текста поддерживаемых языков](https://docs.microsoft.com/azure/cognitive-services/text-analytics/text-analytics-supported-languages) (для [кэйфрасикстрактионскилл](cognitive-search-skill-keyphrases.md), [ентитирекогнитионскилл](cognitive-search-skill-entity-recognition.md)и [сентиментскилл](cognitive-search-skill-sentiment.md))
* [Языки, поддерживаемые переводчиками](https://docs.microsoft.com/azure/cognitive-services/translator/language-support) (для [текста транслатионскилл](cognitive-search-skill-text-translation.md))
* [Сплитскилл текста](cognitive-search-skill-textsplit.md) Поддерживаемые языки: `da, de, en, es, fi, fr, it, ko, pt`

### <a name="skill-did-not-execute-within-the-time-limit"></a>Навык не выполнялся в течение отведенного времени
Существует два варианта, при которых может возникнуть это сообщение об ошибке, каждое из которых должно обрабатываться по-разному. Следуйте приведенным ниже инструкциям в зависимости от того, какой навык возвращает эту ошибку.

#### <a name="built-in-cognitive-service-skills"></a>Встроенные навыки работы со службой
Многие из встроенных функций, таких как определение языка, распознавание сущностей или распознавание текста, поддерживаются конечной точкой API-интерфейса для перекрывающегося службы. Иногда существуют временные проблемы с этими конечными точками, и время ожидания запроса истечет. Для временных проблем нет ограничений, за исключением ожидания, и повторите попытку. В качестве меры по устранению рисков рассмотрите возможность установки индексатора для [выполнения по расписанию](search-howto-schedule-indexers.md). Запланированное индексирование принимается с того места, на котором она была прервана. Если решены временные проблемы, обработка индексирования и обработки персонала должна продолжаться при следующем запланированном запуске.

#### <a name="custom-skills"></a>Пользовательские навыки
Если возникла ошибка времени ожидания с пользовательским навыком, который вы создали, то можете попробовать несколько вещей. Во-первых, проверьте свой пользовательский навык и убедитесь, что он не зависает в бесконечном цикле и что он возвращает результат согласованно. Убедившись в том, что это так, определите время выполнения вашего навыка. Если вы не установили явно значение `timeout` для пользовательского определения навыка, по умолчанию `timeout` составляет 30 секунд. Если 30 секунд не хватает для выполнения вашего навыка, вы можете указать более высокое значение `timeout` для пользовательского определения навыка. Ниже приведен пример пользовательского определения навыка, в котором время ожидания равно 90 секунд:

```json
  {
        "@odata.type": "#Microsoft.Skills.Custom.WebApiSkill",
        "uri": "<your custom skill uri>",
        "batchSize": 1,
        "timeout": "PT90S",
        "context": "/document",
        "inputs": [
          {
            "name": "input",
            "source": "/document/content"
          }
        ],
        "outputs": [
          {
            "name": "output",
            "targetName": "output"
          }
        ]
      }
```

Максимальное значение, которое можно задать для параметра `timeout`, составляет 230 секунд.  Если пользовательский навык не может выполняться постоянно в течение 230 секунд, вы можете уменьшить `batchSize` вашего пользовательского навыка, чтобы в нем было меньше документов для обработки в рамках одного выполнения.  Если вы уже установили `batchSize` в 1, вам потребуется переписать навык, чтобы он мог выполняться в течение 230 секунд или иным образом разделить его на несколько пользовательских навыков, чтобы время выполнения для любого отдельного пользовательского навыка было не более 230 секунд. Дополнительные сведения см. в [документации по пользовательской квалификации](cognitive-search-custom-skill-web-api.md) .

### <a name="could-not-mergeorupload--delete-document-to-the-search-index"></a>Не удалось "`MergeOrUpload`" | документ "`Delete`" в индекс поиска

Документ был прочитан и обработан, но индексатор не смог добавить его в индекс поиска. Это может произойти по следующим причинам.

| `Reason` | Пример | Action |
| --- | --- | --- |
| Срок в документе превышает [ограничение в 32 КБ](search-limits-quotas-capacity.md#api-request-limits) | Поле содержит слишком большой термин | Это ограничение можно избежать, убедившись, что поле не настроено в качестве фильтруемого, аспекта или сортировки.
| Размер документа больше [максимального размера запроса API](search-limits-quotas-capacity.md#api-request-limits) | Документ слишком велик для индексирования | [Индексирование больших наборов данных](search-howto-large-index.md)
| Не удается подключиться к целевому индексу (который сохраняется после повторных попыток), так как служба находится под другой нагрузкой, такой как запросы или индексирование. | Не удалось установить соединение с обновлением индекса. Служба поиска работает под высокой нагрузкой. | [Масштабирование службы поиска](search-capacity-planning.md)
| Служба поиска подготавливается к установке обновления службы или находится в процессе перенастройки топологии. | Не удалось установить соединение с обновлением индекса. Служба поиска в настоящее время находится в состоянии "отключена" или "служба поиска". | Настройка службы с по крайней мере 3 репликами для обеспечения доступности 99,9% на [документацию по соглашению об уровне обслуживания](https://azure.microsoft.com/support/legal/sla/search/v1_0/)
| Сбой в базовом ресурсе COMPUTE/Network (редких) | Не удалось установить соединение с обновлением индекса. Произошла неизвестная ошибка. | Настройте индексаторы для [выполнения по расписанию](search-howto-schedule-indexers.md) , чтобы выбрать состояние сбоя.

##  <a name="warnings"></a>Предупреждения
Предупреждения не останавливают индексирование, но они указывают на условия, которые могут привести к непредвиденным результатам. Принимается ли действие или не зависит от данных и сценария.

### <a name="skill-input-was-truncated"></a>Ввод навыка был усечен
Эти навыки имеют ограничения на длину текста, который можно проанализировать одновременно. Если текстовые входные данные для этих навыков превышены, мы будем усекать текст, чтобы соответствовать пределу, а затем выполнить этот Усеченный текст. Это означает, что навык выполняется, но не все данные.

В примере, приведенном ниже, поле ввода `'text'` может активировать это предупреждение, если оно превышает предельное число символов. Ограничения на входные данные навыков можно найти в [документации по навыкам](cognitive-search-predefined-skills.md).

```json
 {
    "@odata.type": "#Microsoft.Skills.Text.LanguageDetectionSkill",
    "inputs": [
      {
        "name": "text",
        "source": "/document/text"
      }
    ],
    "outputs": [...]
  }
```

Если вы хотите убедиться, что весь текст проанализировался, рассмотрите возможность использования функции [разбиения](cognitive-search-skill-textsplit.md).