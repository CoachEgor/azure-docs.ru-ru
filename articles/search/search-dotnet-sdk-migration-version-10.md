---
title: Обновление до Azure Когнитивный поиск .NET SDK версия 10
titleSuffix: Azure Cognitive Search
description: Переносите код в версию Azure Cognitive Search .NET SDK 10 из старых версий. Сведения о новых возможностях и необходимых изменениях кода.
manager: nitinme
author: arv100kri
ms.author: arjagann
ms.service: cognitive-search
ms.devlang: dotnet
ms.topic: conceptual
ms.date: 11/04/2019
ms.openlocfilehash: ad912eb0b26354d40a654a1c8782dfcb960235e5
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/27/2020
ms.locfileid: "73847522"
---
# <a name="upgrade-to-azure-cognitive-search-net-sdk-version-10"></a>Обновление до Azure Когнитивный поиск .NET SDK версия 10

Если вы используете версию 9.0 или старше [Azure Search .NET SDK,](https://aka.ms/search-sdk)эта статья поможет вам обновить приложение, чтобы использовать версию 10.

Поиск Azure переименован в Azure Cognitive Search в версии 10, но области имен и имена пакетов остаются неизменными. Предыдущие версии SDK (9.0 и ранее) продолжают использовать прежнее название. Для получения дополнительной информации об использовании SDK, включая примеры, [см.](search-howto-dotnet-sdk.md)

Версия 10 добавляет несколько функций и исправлений ошибок, доводя ее `2019-05-06`до того же функционального уровня, что и последний выпуск версии REST API. В тех случаях, когда изменение нарушает существующий код, мы проведем вас через [шаги, необходимые для решения проблемы.](#UpgradeSteps)

> [!NOTE]
> Если вы используете версию 8.0-предварительный просмотр или старше, вы должны обновить до версии 9, а затем обновить до версии 10. Для получения инструкций смотрите [обновление до версии Azure Search .NET SDK.](search-dotnet-sdk-migration-version-9.md)
>
> Экземпляр поисковой службы поддерживает несколько версий REST API, включая последнюю. Можно продолжать использовать версию, которая больше не является последней, но рекомендуется выполнить перенос кода, чтобы использовать последнюю версию. При использовании REST API необходимо указывать версию API в каждом запросе с помощью параметра api-version. При использовании пакета SDK для .NET версия пакета SDK, которую вы используете, определяет соответствующую версию REST API. Если вы используете устаревшую версию пакета SDK, можно продолжать выполнять этот код без изменений, даже если служба обновлена для поддержки более новой версии API.

<a name="WhatsNew"></a>

## <a name="whats-new-in-version-10"></a>Что нового в версии 10
Версия 10 Azure Cognitive Search .NET SDK нацелена на последнюю`2019-05-06`общедоступную версию REST API ( ) с этими обновлениями:

* Введение двух новых навыков - [Условный навык](cognitive-search-skill-conditional.md) и [навык и текст перевод.](cognitive-search-skill-text-translation.md)
* [Вводнавык Shaper](cognitive-search-skill-shaper.md) был реструктурирован для размещения консолидации из вложенных контекстов. Для получения дополнительной информации смотрите этот [пример определения JSON](https://docs.microsoft.com/azure/search/cognitive-search-skill-shaper#scenario-3-input-consolidation-from-nested-contexts).
* Добавление двух новых [функций картирования полей:](search-indexer-field-mappings.md)
    - [urlEncode](https://docs.microsoft.com/azure/search/search-indexer-field-mappings#urlencode-function)
    - [urlDecode](https://docs.microsoft.com/azure/search/search-indexer-field-mappings#urldecode-function)
* В некоторых случаях ошибки и предупреждения, отображаемые в [состоянии выполнения индекса,](https://docs.microsoft.com/rest/api/searchservice/get-indexer-status) могут иметь дополнительные сведения, помогающие в отладке. `IndexerExecutionResult`был обновлен, чтобы отразить это поведение.
* Индивидуальные навыки, определенные в [наборе навыков,](cognitive-search-defining-skillset.md) могут быть дополнительно определены путем указания `name` свойства.
* `ServiceLimits`показывает ограничения для [сложных типов](https://docs.microsoft.com/azure/search/search-howto-complex-data-types) и `IndexerExecutionInfo` показывает соответствующие ограничения индекса/квоты.

<a name="UpgradeSteps"></a>

## <a name="steps-to-upgrade"></a>Действия по обновлению

1. Обновите ссылку NuGet для `Microsoft.Azure.Search` использования консоли NuGet Package Manager или путем нажатия на ссылки на проект и выбора "Управление Пакетами NuGet..." в Визуальной студии.

2. После того как NuGet загрузит новые пакеты и их зависимости, перестройте проект. 

3. Если сборка завершается неудачей, необходимо исправить каждую ошибку сборки. Подробную информацию о том, как устранить каждую потенциальную ошибку сборки, читайте в материале [«Нарушение изменений» в версии 10.](#ListOfChanges)

4. После устранения предупреждений и ошибок сборки при необходимости можно внести изменения в приложение, чтобы воспользоваться преимуществами новых функциональных возможностей. Новые функции в SDK подробно описаны в [What's new в версии 10](#WhatsNew).

<a name="ListOfChanges"></a>

## <a name="breaking-changes-in-version-10"></a>Нарушение изменений в версии 10

В версии 10 есть несколько изменений, которые могут потребовать изменения кода в дополнение к восстановлению приложения.

> [!NOTE]
> Приведенный ниже список изменений не является исчерпывающим. Некоторые изменения, скорее всего, не приведут к ошибкам сборки, но технически нарушаются, поскольку они нарушают двоичную совместимость с сборками, которые зависят от более ранних версий сборок Azure Cognitive Search .NET SDK. Значительные изменения, подпадающие под эту категорию, также перечислены вместе с рекомендациями. Пожалуйста, перестроить приложение при обновлении до версии 10, чтобы избежать любых проблем с двоичной совместимости.

### <a name="custom-web-api-skill-definition"></a>Пользовательское определение навыков Web API

Определение [навыка Custom Web API](cognitive-search-custom-skill-web-api.md) было неправильно указано в версии 9 и старше. 

Модель для `WebApiSkill` `HttpHeaders` указанного в качестве свойства объекта, _содержащего_ словарь. Создание набора навыков `WebApiSkill` с построенной таким образом приведет к исключению, поскольку API REST будет считать запрос плохо сформированным. Эта проблема была исправлена, `HttpHeaders` сделав **свойство словаря верхнего уровня** на самой `WebApiSkill` модели, которое считается действительным запросом от REST API.

Например, если вы ранее пытались `WebApiSkill` мгновенно выставить следующее:

```csharp

var webApiSkill = new WebApiSkill(
            inputs, 
            outputs,
            uri: "https://contoso.example.org")
{
    HttpHeaders = new WebApiHttpHeaders()
    {
        Headers = new Dictionary<string, string>()
        {
            ["header"] = "value"
        }
    }
};

```

изменить его на следующее, чтобы избежать ошибки проверки от REST API:

```csharp

var webApiSkill = new WebApiSkill(
            inputs, 
            outputs,
            uri: "https://contoso.example.org")
{
    HttpHeaders = new Dictionary<string, string>()
    {
        ["header"] = "value"
    }
};

```

## <a name="shaper-skill-allows-nested-context-consolidation"></a>Навык и процеживания позволяет консолидации вложенных контекстов

Навык и навык Shaper теперь может позволить консолидацию ввода из вложенных контекстов. Чтобы включить это изменение, `InputFieldMappingEntry` мы изменили так, что оно может `Source` быть мгновенно, `SourceContext` `Inputs` указав только свойство, или как и свойства.

Скорее всего, вам не нужно будет вносить какие-либо изменения в код; однако обратите внимание, что допускается только одна из этих двух комбинаций. Это означает следующее:

- Создание `InputFieldMappingEntry` места, `Source` где только инициализированы является действительным.
- Создание, `InputFieldMappingEntry` где `SourceContext` `Inputs` только и инициализированы является действительным.
- Все остальные комбинации, связанные с этими тремя свойствами, недействительны.

Если вы решили начать использовать эту новую возможность, убедитесь, что все ваши клиенты обновлены, чтобы использовать версию 10 во-первых, прежде чем развертывание этого изменения. В противном случае существует вероятность того, что обновление клиентом (с использованием старой версии SDK) для навыка Shaper может привести к ошибкам проверки.

> [!NOTE]
> Несмотря на `InputFieldMappingEntry` то, что базовая модель была изменена, чтобы позволить консолидацию из вложенных контекстов, ее использование допустимо только в определении навыка Shaper. Использование этой возможности в других навыках, хотя и является действительным во время компиляции, приведет к ошибке проверки во время выполнения.

## <a name="skills-can-be-identified-by-a-name"></a>Навыки могут быть идентифицированы по имени

Каждый навык в наборе навыков теперь имеет новое свойство, `Name`которое может быть инициализировано в коде, чтобы помочь определить навык. Это необязательно - когда не определено (что является по умолчанию, если явное изменение кода не было сделано), ему присваивается имя по умолчанию, используя 1-основанный индекс навыка в наборе навыков, прикрепляемый с символом '' . Например, в следующем определении набора навыков (большинство инициалов пропущено для краткости):

```csharp
var skillset = new Skillset()
{
    Skills = new List<Skill>()
    {
        new SentimentSkill(),
        new WebApiSkill(),
        new ShaperSkill(),
        ...
    }
}
```

`SentimentSkill`присваивается `WebApiSkill` имя, `#2` `#1` `ShaperSkill` назначается, `#3` назначается и так далее.

Если вы решили определить навыки по заказу имени, убедитесь, что обновить все экземпляры ваших клиентов в версию 10 Из SDK в первую очередь. В противном случае существует вероятность того, что клиент, `null` использующий `Name` старую версию SDK, может вычеркнет свойство навыка, в результате чего клиент отступит от схемы именования по умолчанию.

## <a name="details-about-errors-and-warnings"></a>Подробная информация об ошибках и предупреждениях

`ItemError`и `ItemWarning` модели, инкапсулирующих детали ошибок и предупреждений (соответственно), которые происходят во время выполнения индекса, были изменены, чтобы включить три новых свойства с целью помочь в отладке индексатора. К этим свойствам относятся следующие.

- `Name`: Имя источника, при котором возникла ошибка. Например, это может относиться к определенному навыку в прилагаемом наборе навыков.
- `Details`: Дополнительные подробные сведения об ошибке или предупреждении.
- `DocumentationLink`: Ссылка на руководство по устранению неполадок для конкретной ошибки или предупреждения.

> [!NOTE]
> Мы начали структурировать наши ошибки и предупреждения, чтобы включить эти полезные детали, когда это возможно. Мы работаем над тем, чтобы все ошибки и предупреждения присутствовали, но это незавершенная работа, и эти дополнительные детали не всегда могут быть заселены.

## <a name="next-steps"></a>Дальнейшие действия

- Изменения в навыке Shaper оказывают наибольшее потенциальное влияние на новый или существующий код. В качестве следующего шага не забудьте вернуться к этому примеру, иллюстрирующей структуру ввода: [пример определения навыка Shaper JSON](cognitive-search-skill-shaper.md)
- Пройдите обзор [обогащения ИИ.](cognitive-search-concept-intro.md)
- Будем рады вашим отзывам о пакете SDK. Если вы столкнулись с проблемами, не стесняйтесь обратиться к нам за помощью на [стек переполнения](https://stackoverflow.com/questions/tagged/azure-search). При обнаружении ошибки можно зарегистрировать проблему в [репозитории GitHub пакета SDK .NET для Azure](https://github.com/Azure/azure-sdk-for-net/issues). Убедитесь в том, чтобы префиксировать заголовок проблемы с помощью «Azure Cognitive Search».

