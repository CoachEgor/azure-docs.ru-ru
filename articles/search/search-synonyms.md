---
title: Синонимы для расширения запроса по индексу поиска
titleSuffix: Azure Cognitive Search
description: Создайте карту синонимов, чтобы расширить область поискового запроса по индексу Azure Когнитивный поиск. В область поиска включаются эквивалентные термины, указанные в списке.
manager: nitinme
author: brjohnstmsft
ms.author: brjohnst
ms.service: cognitive-search
ms.topic: conceptual
ms.date: 08/26/2020
ms.openlocfilehash: a8f1fa07b94072d37cf83320b6c8956d3b412f12
ms.sourcegitcommit: e2dc549424fb2c10fcbb92b499b960677d67a8dd
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/17/2020
ms.locfileid: "94701122"
---
# <a name="synonyms-in-azure-cognitive-search"></a>Синонимы в Azure Когнитивный поиск

Synonyms представляет собой поисковые системы, связывающие эквивалентные термины, которые неявно расширяют область запроса, даже если пользователь не указал их. Например, если имеется термин "пес" с синонимами "собака" и "щенок", то документы, содержащие термины "пес", "собака" и "щенок", попадут в область запроса.

В Когнитивный поиск Azure расширение синонимов выполняется во время запроса. Можно добавить карту синонимов в службу, не прерывая текущие операции. Можно добавить свойство **synonymMaps** в определение поля, не перестраивая индекс.

## <a name="create-synonyms"></a>Создание синонимов

На портале не поддерживается создание синонимов, но можно использовать REST API или пакет SDK для .NET. Чтобы начать работу с ОСТАВШЕЙся, мы рекомендуем [публиковать или Visual Studio Code](search-get-started-rest.md) и формулировку запросов с помощью этого API: [Создание карт синонимов](/rest/api/searchservice/create-synonym-map). Для разработчиков на C# вы можете приступить к работе с [добавлением синонимов в функции поиска в Azure с помощью c#](search-synonyms-tutorial-sdk.md).

При необходимости, если вы используете [управляемые клиентом ключи](search-security-manage-encryption-keys.md) для шифрования на стороне службы, вы можете применить эту защиту к содержимому схемы синонимов.

## <a name="use-synonyms"></a>Использование синонимов

В Когнитивный поиск Azure Поддержка синонимов основана на сопоставлениях синонимов, которые вы определяете и отправляете в службу. Эти карты представляют собой независимый ресурс (как индексы или источники данных) и могут использоваться любым полем, поддерживающим поиск, в любом индекс в службе поиска.

Карты синонимов и индексы обслуживаются независимо друг от друга. После определения карты синонимов и ее передачи в службу можно включить функцию синонимов для поля, добавив новое свойство **synonymMaps** в определение этого поля. Создание, обновление и удаление карты синоним всегда относится ко всему документу. Это означает, что нельзя постепенно создавать, обновлять или удалять части карты синонимов. Для обновления даже одной записи требуется перезагрузка.

Внедрение синонимов в приложение поиска состоит из двух этапов:

1.  Добавление карты синонимов в службу поиска с помощью интерфейсов API, приведенных ниже.  

2.  Настройка поля, поддерживающего поиск, для использования карты синонимов в определении индекса.

Можно создать несколько карт синонимов для приложения поиска (например, для разных языков, если приложение поддерживает многоязычную базу клиентов). В настоящее время поле может использовать только одну карту. Свойство synonymMaps поля можно обновить в любое время.

### <a name="synonymmaps-resource-apis"></a>Интерфейсы API ресурсов SynonymMaps

#### <a name="add-or-update-a-synonym-map-under-your-service-using-post-or-put"></a>Добавить или обновить кату синонимов в службе можно с помощью запроса POST или PUT.

Для передачи карты синонимов в службу используется запрос POST или PUT. Правила должны быть разделены символами новой строки (\n). Вы можете определить до 5 000 правил на карту синонимов в бесплатной службе и в правилах 20 000 для каждой схемы в других SKU. Каждое правило может содержать до 20 расширений.

Должны использоваться карты синонимов в формате Apache Solr, который описан ниже. Если у вас есть словарь синонимов в другом формате и вы хотите использовать его напрямую, сообщите нам об этом с помощью [UserVoice](https://feedback.azure.com/forums/263029-azure-search).

Карту синонимов можно создать с помощью запроса HTTP POST, как показано в следующем примере.

```synonym-map
    POST https://[servicename].search.windows.net/synonymmaps?api-version=2020-06-30
    api-key: [admin key]

    {
       "name":"mysynonymmap",
       "format":"solr",
       "synonyms": "
          USA, United States, United States of America\n
          Washington, Wash., WA => WA\n"
    }
```

Кроме того, можно использовать запрос PUT и указать имя карты синонимов в универсальном коде ресурса (URI). Если такой карты синонимов не существует, она будет создана.

```synonym-map
    PUT https://[servicename].search.windows.net/synonymmaps/mysynonymmap?api-version=2020-06-30
    api-key: [admin key]

    {
       "format":"solr",
       "synonyms": "
          USA, United States, United States of America\n
          Washington, Wash., WA => WA\n"
    }
```

##### <a name="apache-solr-synonym-format"></a>Формат синонимов Apache Solr

Формат Solr поддерживает эквивалентные и явные сопоставления синонимов. Правила сопоставления соответствуют спецификации фильтра синонимов с открытым исходным кодом в Apache Solr, описанном в этом документе: [синонимфилтер](https://cwiki.apache.org/confluence/display/solr/Filter+Descriptions#FilterDescriptions-SynonymFilter). Ниже приведен пример правила для эквивалентных синонимов.

```
USA, United States, United States of America
```

При использовании этого правила поисковый запрос "США" будет расширен до следующего запроса: "США" ИЛИ "Соединенные Штаты" ИЛИ "Соединенные Штаты Америки".

Явное сопоставление обозначается стрелкой "=>". Если этот параметр задан, то последовательность условий поискового запроса, которая соответствует левой части "=>", будет заменена альтернативными вариантами в правой части. Согласно приведенному ниже правилу, поисковые запросы "Санкт-Петербург", "Питер" или "СПБ" будут перезаписаны запросом "СПБ". Явное сопоставление применяется только в указанном направлении, и в этом случае запрос "СПБ" не будет перезаписан запросом "Санкт-Петербург".

```
Washington, Wash., WA => WA
```

Если необходимо определить синонимы, содержащие запятые, можно отформатировать их с помощью обратной косой черты, как в следующем примере:

```
WA\, USA, WA, Washington
```

Поскольку обратная косая черта сама по себе является специальным символом в других языках, например JSON и C#, вам, вероятно, потребуется дважды его escape-последовательность. Например, формат JSON, отправленный в REST API для приведенной выше карте синонимов, будет выглядеть следующим образом:

```json
    {
       "format":"solr",
       "synonyms": "WA\\, USA, WA, Washington"
    }
```

#### <a name="list-synonym-maps-under-your-service"></a>Вывод карт синонимов в службе.

```synonym-map
    GET https://[servicename].search.windows.net/synonymmaps?api-version=2020-06-30
    api-key: [admin key]
```

#### <a name="get-a-synonym-map-under-your-service"></a>Получение карты синонимов в службе.

```synonym-map
    GET https://[servicename].search.windows.net/synonymmaps/mysynonymmap?api-version=2020-06-30
    api-key: [admin key]
```

#### <a name="delete-a-synonyms-map-under-your-service"></a>Удаление карты синонимов в службе.

```synonym-map
    DELETE https://[servicename].search.windows.net/synonymmaps/mysynonymmap?api-version=2020-06-30
    api-key: [admin key]
```

### <a name="configure-a-searchable-field-to-use-the-synonym-map-in-the-index-definition"></a>Настройка поля, поддерживающего поиск, для использования карты синонимов в определении индекса.

Новое свойство поля **synonymMaps** можно использовать для указания карты синонимов для поля, поддерживающего поиск. Карты синонимов — это ресурсы уровня службы, и на них может ссылаться любое поле индекса в службе.

```synonym-map
    POST https://[servicename].search.windows.net/indexes?api-version=2020-06-30
    api-key: [admin key]

    {
       "name":"myindex",
       "fields":[
          {
             "name":"id",
             "type":"Edm.String",
             "key":true
          },
          {
             "name":"name",
             "type":"Edm.String",
             "searchable":true,
             "analyzer":"en.lucene",
             "synonymMaps":[
                "mysynonymmap"
             ]
          },
          {
             "name":"name_jp",
             "type":"Edm.String",
             "searchable":true,
             "analyzer":"ja.microsoft",
             "synonymMaps":[
                "japanesesynonymmap"
             ]
          }
       ]
    }
```

Свойство **synonymMaps** можно указать полей, поддерживающих поиск, типа Edm.String или Collection(Edm.String).

> [!NOTE]
> Вы можете использовать только одну карту синонимов на поле. Если вы хотите использовать несколько карт синонимов, сообщите нам об этом с помощью [UserVoice](https://feedback.azure.com/forums/263029-azure-search).

## <a name="impact-of-synonyms-on-other-search-features"></a>Влияние синонимов на другие функции поиска

Функция синонимов перезаписывает исходный запрос, добавляя синонимы с оператором ИЛИ. По этой причине функция выделения совпадений и профиль повышения считают исходный термин и его синонимы эквивалентными.

Функция синонимов применяется к поисковым запросам и не действует для фильтров и аспектов. Аналогичным образом, предложения основываются только на исходном термине. Совпадения для синонимов в ответе не отображаются.

Расширения синонимов не применяются к поисковым терминам с подстановочными знаками. Это также относится к терминам, содержащим префикс, нечеткое условие и регулярное выражение.

Если вам нужно сделать один запрос, который применяет расширение синонимов, подстановочные знаки, регулярные выражения или нечеткий поиск, можно объединить запросы с использованием синтаксиса OR. Например, чтобы объединить синонимы с подстановочными знаками для обеспечения простого синтаксиса запросов, термин будет выглядеть так: `<query> | <query>*`.

Если у вас есть индекс в среде разработки (не в рабочей среде), поэкспериментируйте с небольшим словарем, чтобы узнать, как добавление синонимов изменяет результаты поиска, включая влияние на профили повышения, выделение совпадений и предложения.

## <a name="next-steps"></a>Следующие шаги

> [!div class="nextstepaction"]
> [Создание схемы синонимов](/rest/api/searchservice/create-synonym-map)