---
title: Синонимы для расширения запроса через индекс поиска. Поиск Azure
description: Создайте карту синонимов, чтобы расширить область запроса поиска в индексе службы "Поиск Azure". В область поиска включаются эквивалентные термины, указанные в списке.
author: brjohnstmsft
services: search
ms.service: search
ms.devlang: rest-api
ms.topic: conceptual
ms.date: 05/02/2019
manager: jlembicz
ms.author: brjohnst
ms.custom: seodec2018
ms.openlocfilehash: 99abcc70a81622e4efbe85722d457bd1846b6e15
ms.sourcegitcommit: 9b80d1e560b02f74d2237489fa1c6eb7eca5ee10
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/01/2019
ms.locfileid: "67485214"
---
# <a name="synonyms-in-azure-search"></a>Синонимы в службе "Поиск Azure"

Synonyms представляет собой поисковые системы, связывающие эквивалентные термины, которые неявно расширяют область запроса, даже если пользователь не указал их. Например, если имеется термин "пес" с синонимами "собака" и "щенок", то документы, содержащие термины "пес", "собака" и "щенок", попадут в область запроса.

В Поиске Azure добавление синонимов выполняется во время обработки запроса. Можно добавить карту синонимов в службу, не прерывая текущие операции. Можно добавить свойство **synonymMaps** в определение поля, не перестраивая индекс.

## <a name="create-synonyms"></a>Создание синонимов

Отсутствует поддержка портала для создания синонимы, но можно использовать REST API или пакет SDK для .NET. Чтобы приступить к работе с REST, мы рекомендуем [с помощью Postman](search-get-started-postman.md) и формирование запросов, с помощью этого API: [Создание карт синонимов](https://docs.microsoft.com/rest/api/searchservice/create-synonym-map). Для C# разработчиков, вы можете начать работу с [Добавление синонимов в поиске Azure с помощью C# ](search-synonyms-tutorial-sdk.md).

При необходимости Если вы используете [управляемых клиентом ключей](search-security-manage-encryption-keys.md) для со стороны службы шифрования при хранении, эта защита можно применить к содержимому карты синонимов.

## <a name="use-synonyms"></a>Использование синонимов

В Поиске Azure функция синонимов основана на картах синонимов, определяемых и передаваемых в службу пользователем. Эти карты представляют собой независимый ресурс (как индексы или источники данных) и могут использоваться любым полем, поддерживающим поиск, в любом индекс в службе поиска.

Карты синонимов и индексы обслуживаются независимо друг от друга. После определения карты синонимов и ее передачи в службу можно включить функцию синонимов для поля, добавив новое свойство **synonymMaps** в определение этого поля. Создание, обновление и удаление карты синоним всегда относится ко всему документу. Это означает, что нельзя постепенно создавать, обновлять или удалять части карты синонимов. Для обновления даже одной записи требуется перезагрузка.

Внедрение синонимов в приложение поиска состоит из двух этапов:

1.  Добавление карты синонимов в службу поиска с помощью интерфейсов API, приведенных ниже.  

2.  Настройка поля, поддерживающего поиск, для использования карты синонимов в определении индекса.

### <a name="synonymmaps-resource-apis"></a>Интерфейсы API ресурсов SynonymMaps

#### <a name="add-or-update-a-synonym-map-under-your-service-using-post-or-put"></a>Добавить или обновить кату синонимов в службе можно с помощью запроса POST или PUT.

Для передачи карты синонимов в службу используется запрос POST или PUT. Правила должны быть разделены символами новой строки (\n). Можно определить до 5000 правил на карту синонимов в службе уровня "Бесплатный" и до 10 000 правил для всех прочих номеров SKU. Каждое правило может содержать до 20 расширений.

Должны использоваться карты синонимов в формате Apache Solr, который описан ниже. Если у вас есть словарь синонимов в другом формате и вы хотите использовать его напрямую, сообщите нам об этом с помощью [UserVoice](https://feedback.azure.com/forums/263029-azure-search).

Карту синонимов можно создать с помощью запроса HTTP POST, как показано в следующем примере.

    POST https://[servicename].search.windows.net/synonymmaps?api-version=2019-05-06
    api-key: [admin key]

    {
       "name":"mysynonymmap",
       "format":"solr",
       "synonyms": "
          USA, United States, United States of America\n
          Washington, Wash., WA => WA\n"
    }

Кроме того, можно использовать запрос PUT и указать имя карты синонимов в универсальном коде ресурса (URI). Если такой карты синонимов не существует, она будет создана.

    PUT https://[servicename].search.windows.net/synonymmaps/mysynonymmap?api-version=2019-05-06
    api-key: [admin key]

    {
       "format":"solr",
       "synonyms": "
          USA, United States, United States of America\n
          Washington, Wash., WA => WA\n"
    }

##### <a name="apache-solr-synonym-format"></a>Формат синонимов Apache Solr

Формат Solr поддерживает эквивалентные и явные сопоставления синонимов. Правила сопоставления соответствуют спецификации фильтра синонимов с открытым исходным кодом Apache solr, описанной в этом документе: [SynonymFilter](https://cwiki.apache.org/confluence/display/solr/Filter+Descriptions#FilterDescriptions-SynonymFilter). Ниже приведен пример правила для эквивалентных синонимов.
```
USA, United States, United States of America
```

При использовании этого правила поисковый запрос "США" будет расширен до следующего запроса: "США" ИЛИ "Соединенные Штаты" ИЛИ "Соединенные Штаты Америки".

Явное сопоставление обозначается стрелкой "=>". При указании такого сопоставления последовательность терминов поискового запроса, соответствующий левый операнд оператора «= >» будет заменена альтернативными вариантами соответствует источнику справа. Согласно приведенному ниже правилу, поисковые запросы "Санкт-Петербург", "Питер" или "СПБ" будут перезаписаны запросом "СПБ". Явное сопоставление применяется только в указанном направлении, и в этом случае запрос "СПБ" не будет перезаписан запросом "Санкт-Петербург".
```
Washington, Wash., WA => WA
```

#### <a name="list-synonym-maps-under-your-service"></a>Вывод карт синонимов в службе.

    GET https://[servicename].search.windows.net/synonymmaps?api-version=2019-05-06
    api-key: [admin key]

#### <a name="get-a-synonym-map-under-your-service"></a>Получение карты синонимов в службе.

    GET https://[servicename].search.windows.net/synonymmaps/mysynonymmap?api-version=2019-05-06
    api-key: [admin key]

#### <a name="delete-a-synonyms-map-under-your-service"></a>Удаление карты синонимов в службе.

    DELETE https://[servicename].search.windows.net/synonymmaps/mysynonymmap?api-version=2019-05-06
    api-key: [admin key]

### <a name="configure-a-searchable-field-to-use-the-synonym-map-in-the-index-definition"></a>Настройка поля, поддерживающего поиск, для использования карты синонимов в определении индекса.

Новое свойство поля **synonymMaps** можно использовать для указания карты синонимов для поля, поддерживающего поиск. Карты синонимов — это ресурсы уровня службы, и на них может ссылаться любое поле индекса в службе.

    POST https://[servicename].search.windows.net/indexes?api-version=2019-05-06
    api-key: [admin key]

    {
       "name":"myindex",
       "fields":[
          {
             "name":"id",
             "type":"Edm.String",
             "key":true
          },
          {
             "name":"name",
             "type":"Edm.String",
             "searchable":true,
             "analyzer":"en.lucene",
             "synonymMaps":[
                "mysynonymmap"
             ]
          },
          {
             "name":"name_jp",
             "type":"Edm.String",
             "searchable":true,
             "analyzer":"ja.microsoft",
             "synonymMaps":[
                "japanesesynonymmap"
             ]
          }
       ]
    }

Свойство **synonymMaps** можно указать полей, поддерживающих поиск, типа Edm.String или Collection(Edm.String).

> [!NOTE]
> Вы можете использовать только одну карту синонимов на поле. Если вы хотите использовать несколько карт синонимов, сообщите нам об этом с помощью [UserVoice](https://feedback.azure.com/forums/263029-azure-search).

## <a name="impact-of-synonyms-on-other-search-features"></a>Влияние синонимов на другие функции поиска

Функция синонимов перезаписывает исходный запрос, добавляя синонимы с оператором ИЛИ. По этой причине функция выделения совпадений и профиль повышения считают исходный термин и его синонимы эквивалентными.

Функция синонимов применяется к поисковым запросам и не действует для фильтров и аспектов. Аналогичным образом, предложения основываются только на исходном термине. Совпадения для синонимов в ответе не отображаются.

Расширения синонимов не применяются к поисковым терминам с подстановочными знаками. Это также относится к терминам, содержащим префикс, нечеткое условие и регулярное выражение.

Если вам нужно сделать один запрос, который применяет расширение синонимов, подстановочные знаки, регулярные выражения или нечеткий поиск, можно объединить запросы с использованием синтаксиса OR. Например, чтобы объединить синонимы с подстановочными знаками для обеспечения простого синтаксиса запросов, термин будет выглядеть так: `<query> | <query>*`.

## <a name="tips-for-building-a-synonym-map"></a>Советы по созданию карты синонимов

- Краткая и хорошо спроектированная карта синонимов намного эффективнее, чем всеобъемлющий список возможных совпадений. Слишком большие или сложные словари увеличивают длительность анализа и задерживают обработку запросов, если в запрос добавляется несколько синонимов. Вместо того, чтобы гадать, какие термины могут использоваться, можно получить фактические термины, воспользовавшись [отчетом об анализе трафика поиска](search-traffic-analytics.md).

- В качестве предварительного и проверочного упражнения включите и используйте этот отчет, чтобы точно определять, для каких терминов подходит поиск синонимов, и продолжайте использовать его, чтобы проверять, улучшаются ли результаты карты синонимов. В стандартном отчете элементы "Most common search queries" (Последние поисковые запросы) и "Zero-result search queries" (Поисковые запросы с нулевым результатом) будут содержать необходимые сведения.

- Можно создать несколько карт синонимов для приложения поиска (например, для разных языков, если приложение поддерживает многоязычную базу клиентов). В настоящее время поле может использовать только одну карту. Свойство synonymMaps поля можно обновить в любое время.

## <a name="next-steps"></a>Дальнейшие действия

- Если у вас есть индекс в среде разработки (не в рабочей среде), поэкспериментируйте с небольшим словарем, чтобы узнать, как добавление синонимов изменяет результаты поиска, включая влияние на профили повышения, выделение совпадений и предложения.

- [Включите аналитику трафика поиска](search-traffic-analytics.md) и используйте стандартный отчет Power BI, чтобы узнать, какие термины указываются чаще всего и какие возвращают ноль документов. Получив эти сведения, отредактируйте словарь, добавив синонимы для неэффективных запросов, которые должны выдавать документы из индекса.
