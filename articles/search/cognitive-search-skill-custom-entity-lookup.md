---
title: Пользовательские Entity Поиск когнитивных навыков поиска
titleSuffix: Azure Cognitive Search
description: Извлекайте различные пользовательские сущности из текста в конвейере когнитивного поиска Azure Cognitive Search. Этот навык в настоящее время в публичном предварительном просмотре.
manager: nitinme
author: luiscabrer
ms.author: luisca
ms.service: cognitive-search
ms.topic: conceptual
ms.date: 01/30/2020
ms.openlocfilehash: 3659070d4ffd4346a8827d2748e67db436fc15b3
ms.sourcegitcommit: 09a124d851fbbab7bc0b14efd6ef4e0275c7ee88
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2020
ms.locfileid: "82085745"
---
#     <a name="custom-entity-lookup-cognitive-skill-preview"></a>Пользовательские Entity Поиск когнитивных навыков (Предварительный просмотр)

> [!IMPORTANT] 
> Этот навык в настоящее время в публичном предварительном просмотре. Для предварительной версии функции соглашение об уровне обслуживания не предусмотрено. Мы не рекомендуем использовать ее в рабочей среде. Дополнительные сведения см. в статье [Дополнительные условия использования предварительных выпусков Microsoft Azure](https://azure.microsoft.com/support/legal/preview-supplemental-terms/). В настоящее время нет портала или поддержки .NET SDK.

Навык **поиска пользовательских сущностей** ищет текст из пользовательского, определенного пользователем списка слов и фраз. Используя этот список, он маркирует все документы с любыми соответствующими сущностями. Навык также поддерживает степень нечеткого соответствия, которые могут быть применены, чтобы найти совпадения, которые похожи, но не совсем точны.  

Этот навык не привязан к API Когнитивных Услуг и может использоваться бесплатно в период предварительного просмотра. Однако необходимо [прикрепить ресурс Cognitive Services,](https://docs.microsoft.com/azure/search/cognitive-search-attach-cognitive-services)чтобы переопределить дневной лимит обогащения. Дневной лимит распространяется на бесплатный доступ к когнитивным службам при доступе через Azure Cognitive Search.

## <a name="odatatype"></a>@odata.type  
Microsoft.Skills.Text.CustomEntityLookUpSkill 

## <a name="data-limits"></a>Ограничения данных
+ Максимальный размер входной записи, поддерживаемый, составляет 256 МБ. Если вам нужно разбить данные перед отправкой на пользовательский навык поиска сущности, рассмотрите возможность использования [навыка Text Split.](cognitive-search-skill-textsplit.md)
+ Максимальная приведенная таблица определения сущностей составляет 10 МБ, если она предоставляется с использованием параметра *entitiesDefinitionUri.* 
+ Если сущности определены в строке, используя параметр *inlineEntitiesDefinition,* максимальный поддерживаемый размер составляет 10 кБ.

## <a name="skill-parameters"></a>Параметры навыков

Параметры зависят от регистра.

| Имя параметра     | Описание |
|--------------------|-------------|
| сущностиОпределениеУри    | Путь к файлу JSON или CSV, содержащему весь целевой текст, с тем чтобы они соответствовали. Это определение сущности читается в начале запуска индексатора; любые обновления этого файла в середине запуска не будут реализованы до последующих запусков. Эта конфигурация должна быть доступна через HTTPS. Смотрите [формат определения пользовательских сущностей"](#custom-entity-definition-format) ниже для ожидаемой схемы CSV или JSON.|
|inlineEntitiesОпределение | Определения сущности Inline JSON. Этот параметр заменяет параметры entitiesDefinitionUri, если он присутствует. Не более 10 КБ конфигурации могут быть предоставлены в режиме line. Ниже [приведено определение пользовательских сущностей](#custom-entity-definition-format) для ожидаемой схемы JSON. |
|defaultLanguageCode |    (Необязательно) Языковой код входном текста, используемого для токенизации и разграничения входиного текста. Поддерживаются следующие `da, de, en, es, fi, fr, it, ko, pt`языки: . По умолчанию`en`является английский (). При передаче формата languagecode-countrycode используется только часть languagecode формата.  |


## <a name="skill-inputs"></a>Входные данные навыков

| Ввод имени      | Описание                   |
|---------------|-------------------------------|
| text          | Текст для анализа.          |
| languageCode    | Необязательный параметр. Значение по умолчанию — `"en"`.  |


## <a name="skill-outputs"></a>Выходные данные навыка


| Имя вывода      | Описание                   |
|---------------|-------------------------------|
| Сущности | Массив объектов, содержащих информацию об обнаруженных совпадениях и связанных с ними метаданных. Каждая из выявленных объектов может содержать следующие поля:  <ul> <li> *имя*: Идентифицирована сущность верхнего уровня. Сущность представляет "нормализованную" форму. </li> <li> *id*: Уникальный идентификатор для сущности, определенный пользователем в "Формате определения пользовательских сущностей".</li> <li> *описание*: Описание сущности, определяемое пользователем в "Формате определения пользовательских сущностей". </li> <li> *тип:* Тип сущности, определяемый пользователем в "Формате определения пользовательских сущностей".</li> <li> *подтип:* Подтип сущности, определяемый пользователем в "Формате определения пользовательских сущностей".</li>  <li> *совпадает*: Коллекция, описывающая каждое из совпадений для этой сущности в исходном тексте. Каждый матч будет иметь следующие члены: </li> <ul> <li> *текст*: Необработанный текст совпадает с исходного документа. </li> <li> *смещение*: Место, где матч был найден в тексте. </li> <li> *длина*: Длина совмещенных текста. </li> <li> *matchDistance*: Количество символов, отличающихся от этого матча, было от первоначального имени сущности или псевдонима.  </li> </ul> </ul>
  |

## <a name="custom-entity-definition-format"></a>Формат определения пользовательских сущностей

Есть 3 различных способа предоставить список пользовательских сущностей для навыка custom Entity Lookup. Вы можете предоставить список в . CSV файл, a . Файл JSON или как внееопределение как часть определения навыка.  

Если файл определения является . CSV или . Файл JSON, путь файла должен быть предоставлен как часть параметра *entitiesDefinitionUri.* В этом случае файл загружается один раз в начале каждого запуска индекса. Файл должен быть доступен до тех пор, пока индексер предназначен для запуска. Кроме того, файл должен быть закодирован UTF-8.

Если определение приведено в соответствии, оно должно быть предоставлено как в строке, так и содержание параметра навыка *inlineEntitiesDefinition.* 

### <a name="csv-format"></a>Формат CSV

Можно предоставить определение пользовательских сущностей для поиска в файле Comma-Separated Value (CSV), предоставив путь к файлу и установив его в параметре навыка *entitiesDefinitionUri.* Путь должен быть в месте https. Размер файла определения может составить до 10 МБ.

Формат CSV прост. Каждая строка представляет собой уникальную сущность, как показано ниже:

```
Bill Gates, BillG, William H. Gates
Microsoft, MSFT
Satya Nadella 
```

В этом случае есть три сущности, которые могут быть возвращены в виде найденных сущностей (Билл Гейтс, Сатья Наделла, Microsoft), но они будут идентифицированы, если какой-либо из терминов на линии (псевдонимы) совпадают с текстом. Например, если строка "Уильям Х. Гейтс" найдена в документе, будет возвращена совпадение для сущности "Билл Гейтс".

### <a name="json-format"></a>Формат JSON

Вы также можете предоставить определение пользовательских сущностей для поиска в файле JSON. Формат JSON дает вам немного больше гибкости, так как он позволяет определить соответствующие правила на семестр. Например, можно указать нечеткое расстояние соответствия (расстояние Damerau-Levenshtein) для каждого термина или же соответствие должно быть чувствительным к делу или нет. 

 Так же, как с файлами CSV, вам нужно предоставить путь к файлу JSON и установить его в параметры навыка *entitiesDefinitionUri.* Путь должен быть в месте https. Размер файла определения может составить до 10 МБ.

Наиболее основным определением списка пользовательских сущностей JSON может быть список сущностей, которые соответствуют:

```json
[ 
    { 
        "name" : "Bill Gates"
    }, 
    { 
        "name" : "Microsoft"
    }, 
    { 
        "name" : "Satya Nadella"
    }
]
```

Более сложный пример определения JSON может дополнительно предоставить идентификатор, описание, тип и подтип каждой сущности, а также другие *псевдонимы.* Если псевдоним совпадает, сущность также будет возвращена:

```json
[ 
    { 
        "name" : "Bill Gates",
        "description" : "Microsoft founder." ,
        "aliases" : [ 
            { "text" : "William H. Gates", "caseSensitive" : false },
            { "text" : "BillG", "caseSensitive" : true }
        ]
    }, 
    { 
        "name" : "Xbox One", 
        "type": "Harware",
        "subtype" : "Gaming Device",
        "id" : "4e36bf9d-5550-4396-8647-8e43d7564a76",
        "description" : "The Xbox One product"
    }, 
    { 
        "name" : "LinkedIn" , 
        "description" : "The LinkedIn company", 
        "id" : "differentIdentifyingScheme123", 
        "fuzzyEditDistance" : 0 
    }, 
    { 
        "name" : "Microsoft" , 
        "description" : "Microsoft Corporation", 
        "id" : "differentIdentifyingScheme987", 
        "defaultCaseSensitive" : false, 
        "defaultFuzzyEditDistance" : 1, 
        "aliases" : [ 
            { "text" : "MSFT", "caseSensitive" : true }
        ]
    } 
] 
```

В приведенных ниже таблицах более подробно описаны различные параметры конфигурации, которые можно установить при определении сущностей, чтобы соответствовать:

|  Имя поля  |        Описание  |
|--------------|----------------------|
| name | Дескриптор сущности верхнего уровня. Совпадения в выходе навыка будут сгруппированы по этому имени, и он должен представлять "нормализованную" форму найденного текста.  |
| description  | (Необязательно) Это поле может быть использовано в качестве проходного для пользовательских метаданных о соответствующем тексте (ы). Значение этого поля будет отображаться с каждым совпадением его сущности в выводе навыков. |
| type | (Необязательно) Это поле может быть использовано в качестве проходного для пользовательских метаданных о соответствующем тексте (ы). Значение этого поля будет отображаться с каждым совпадением его сущности в выводе навыков. |
| subtype | (Необязательно) Это поле может быть использовано в качестве проходного для пользовательских метаданных о соответствующем тексте (ы). Значение этого поля будет отображаться с каждым совпадением его сущности в выводе навыков. |
| идентификатор | (Необязательно) Это поле может быть использовано в качестве проходного для пользовательских метаданных о соответствующем тексте (ы). Значение этого поля будет отображаться с каждым совпадением его сущности в выводе навыков. |
| caseSensitive | (Необязательно) По умолчанию ложным. Значение Boolean, обозначающее, должны ли сравнения с именем сущности быть чувствительными к оболочке символов. Примером случае нечувствительных совпадений "Microsoft" может быть: Microsoft, microSoft, MICROSOFT |
| fuzzyEditDistance | (Необязательно) По умолчанию до 0. Максимальное значение 5. Обозначает приемлемое количество разнонаправленных символов, которые по-прежнему представляют собой совпадение с именем сущности. Возвращается наименьшая возможная нечеткость для любого данного матча.  Например, если расстояние отсвагания будет установлено до 3, "Windows 10" будет по-прежнему соответствовать "Windows", "Windows10" и "Windows 7". <br/> Когда чувствительность случая установлена к ложному, разницы случаев не учитываютки к нечеткости допускаемости, но в противном случае делают. |
| по умолчаниюCaseчувствие | (Необязательно) Изменяет значение чувствительности случая по умолчанию для этой сущности. Он используется для изменения значения по умолчанию всех значений caseSensitive. |
| defaultFuzzyEditDistance | (Необязательно) Изменяет нечеткое значение расстояния по умолчанию для этой сущности. Он может быть использован для изменения значения по умолчанию всех значений нечеткихEditDistance. |
| псевдонимы | (Необязательно) Массив сложных объектов, которые могут быть использованы для указания альтернативных орфографий или синонимов имени корневой сущности. |

| Свойства псевдонимов | Описание |
|------------------|-------------|
| text  | Альтернативное написание или представление некоторых имен целевого объекта.  |
| caseSensitive | (Необязательно) Действует так же, как корневой сущности "caseSensitive" параметр выше, но применяется только к этому один псевдоним. |
| fuzzyEditDistance | (Необязательно) Действует так же, как корневой сущности "fuzzyEditDistance" параметр выше, но применяется только к этому один псевдоним. |


### <a name="inline-format"></a>Формат inline

В некоторых случаях может быть удобнее предоставить список пользовательских сущностей, которые будут сопоставляться непосредственно с определением навыков. В этом случае вы можете использовать аналогичный формат JSON к описанной выше, но он встроен в определение навыков.
Только конфигурации размером менее 10 кБ (серийный размер) могут быть определены в строке. 

##    <a name="sample-definition"></a>Пример определения

Ниже показано определение навыка образца с использованием вонного формата:

```json
  {
    "@odata.type": "#Microsoft.Skills.Text.CustomEntityLookupSkill",
    "context": "/document",
    "inlineEntitiesDefinition": 
    [
      { 
        "name" : "Bill Gates",
        "description" : "Microsoft founder." ,
        "aliases" : [ 
            { "text" : "William H. Gates", "caseSensitive" : false },
            { "text" : "BillG", "caseSensitive" : true }
        ]
      }, 
      { 
        "name" : "Xbox One", 
        "type": "Harware",
        "subtype" : "Gaming Device",
        "id" : "4e36bf9d-5550-4396-8647-8e43d7564a76",
        "description" : "The Xbox One product"
      }
    ],    
    "inputs": [
      {
        "name": "text",
        "source": "/document/content"
      }
    ],
    "outputs": [
      {
        "name": "entities",
        "targetName": "matchedEntities"
      }
    ]
  }
```
Кроме того, если вы решите предоставить указатель файла определения сущностей, ниже отображается определение выборки навыков с использованием формата entitiesDefinitionUri:

```json
  {
    "@odata.type": "#Microsoft.Skills.Text.CustomEntityLookupSkill",
    "context": "/document",
    "entitiesDefinitionUri": "https://myblobhost.net/keyWordsConfig.csv",    
    "inputs": [
      {
        "name": "text",
        "source": "/document/content"
      }
    ],
    "outputs": [
      {
        "name": "entities",
        "targetName": "matchedEntities"
      }
    ]
  }

```

##    <a name="sample-input"></a>Пример ввода

```json
{
    "values": [
      {
        "recordId": "1",
        "data":
           {
             "text": "The company microsoft was founded by Bill Gates. Microsoft's gaming console is called Xbox",
             "languageCode": "en"
           }
      }
    ]
}
```

##    <a name="sample-output"></a>Пример выходных данных

```json
  { 
    "values" : 
    [ 
      { 
        "recordId": "1", 
        "data" : { 
          "entities": [
            { 
              "name" : "Microsoft", 
              "description" : "This document refers to Microsoft the company", 
              "id" : "differentIdentifyingScheme987", 
              "matches" : [ 
                { 
                  "text" : "microsoft", 
                  "offset" : 13, 
                  "length" : 9, 
                  "matchDistance" : 0 
                }, 
                { 
                  "text" : "Microsoft",
                  "offset" : 49, 
                  "length" : 9, 
                  "matchDistance" : 0
                }
              ] 
            },
            { 
              "name" : "Bill Gates",
              "description" : "William Henry Gates III, founder of Microsoft.", 
              "matches" : [
                { 
                  "text" : "Bill Gates",
                  "offset" : 37, 
                  "length" : 10,
                  "matchDistance" : 0 
                }
              ]
            }
          ] 
        } 
      } 
    ] 
  } 
```

## <a name="errors-and-warnings"></a>Ошибки и предупреждения

### <a name="warning-reached-maximum-capacity-for-matches-skipping-all-further-duplicate-matches"></a>Предупреждение: Достигнута максимальная емкость для матчей, пропуская все дальнейшие дублирующиеся совпадения.

Это предупреждение будет излучаться, если количество обнаруженных совпадений превышает максимально допустимое. В этом случае мы перестанем включать дубликаты совпадений. Если это неприемлемо для вас, пожалуйста, подайте [билет на поддержку,](https://ms.portal.azure.com/#create/Microsoft.Support) чтобы мы могли помочь вам с вашим индивидуальным случаем использования.

## <a name="see-also"></a>См. также раздел

+ [Встроенные навыки](cognitive-search-predefined-skills.md)
+ [Определение набора навыков](cognitive-search-defining-skillset.md)
+ [Навыки распознавания объектов (для поиска известных объектов)](cognitive-search-skill-entity-recognition.md)
