---
title: Общие сведения об использовании хранилища знаний (предварительная версия)
titleSuffix: Azure Cognitive Search
description: Отправьте документы в службу хранилища Azure, где вы сможете просматривать, изменять и использовать расширенные документы в Azure Когнитивный поиск и в других приложениях. Эта функция предоставляется в общедоступной предварительной версии.
author: HeidiSteen
manager: nitinme
ms.author: heidist
ms.service: cognitive-search
ms.topic: conceptual
ms.date: 12/11/2019
ms.openlocfilehash: 9a6fa62384615f60da88bb41da8ad3538d34e62a
ms.sourcegitcommit: 380e3c893dfeed631b4d8f5983c02f978f3188bf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2020
ms.locfileid: "75754110"
---
# <a name="introduction-to-knowledge-stores-in-azure-cognitive-search"></a>Общие сведения о хранилищах знаний в Когнитивном поиске Azure

> [!IMPORTANT] 
> Сейчас предоставляется общедоступная предварительная версия хранилища знаний. Для предварительной версии функции соглашение об уровне обслуживания не предусмотрено. Мы не рекомендуем использовать ее в рабочей среде. Дополнительные сведения см. в статье [Дополнительные условия использования предварительных выпусков Microsoft Azure](https://azure.microsoft.com/support/legal/preview-supplemental-terms/). [Версия REST API 2019-05-06-Preview](search-api-preview.md) предоставляет предварительные версии функций. Сейчас доступна ограниченная поддержка портала. Поддержка пакета SDK для .NET пока не реализована.

Хранилище знаний — это функция Azure Когнитивный поиск, которая сохраняет выходные данные [конвейера обогащения искусственного интеллекта](cognitive-search-concept-intro.md) для независимого анализа или обработки. *Обогащенный документ* — это выходные данные конвейера, созданные из содержимого, которое было извлечено, структурировано и проанализировано с использованием процессов ИИ. В стандартном конвейере на основе ИИ обогащенные документы являются временными и используются только во время индексирования, а затем удаляются. В хранилище знаний сохраняются обогащенные документы. 

Если вы уже использовали «автообучение» в прошлом, вам известно, что *навыков* перемещает документ с помощью последовательности дополнений. Результатом этого процесса может быть индекс поиска или проекции документа в хранилище знаний (нововведение в этой предварительной версии). Два выхода, индекс поиска и хранилище знаний — это продукты одного конвейера; производные от одних и тех же входных данных, но результат структурирован, сохранен и использован очень разными способами.

Физически хранилищем знаний является [служба хранилища Azure](https://docs.microsoft.com/azure/storage/common/storage-account-overview) (хранилище таблиц Azure, хранилище BLOB-объектов Azure или оба). Любой инструмент или процесс, который может подключиться к службе хранилища Azure, может использовать содержимое хранилища знаний.

![Хранилище знаний на схеме конвейера](./media/knowledge-store-concept-intro/knowledge-store-concept-intro.svg "Хранилище знаний на схеме конвейера")

## <a name="benefits-of-knowledge-store"></a>Преимущества хранилища знаний

Хранилище знаний предоставляет структуру, контекст и реальное содержимое, которое выводится из неструктурированных и частично структурированных файлов данных, таких как большие двоичные объекты, файлы изображений, которые прошли анализ или даже структурированные данные, передаются в новые формы. В пошаговом [руководстве](knowledge-store-create-rest.md)можно увидеть, как сжатый документ JSON разбивается на разделы в виде вложенных структур, воспроизводится в новых структурах, и другим образом становятся доступными для нисходящих процессов, таких как машинное обучение и рабочие нагрузки для обработки и анализа данных.

Хотя полезно понять, что может создать конвейер обогащения искусственного интеллекта, реальный потенциал хранилища знаний — возможность перерисовки данных. Можно начать с базового набора навыков и совершенствовать его цикл за циклом, чтобы увеличить число уровней структур. Это позволит создавать структуры, пригодные для использования другими приложениями, помимо службы "Когнитивный поиск Azure".

Хранилище знаний обеспечивает следующие преимущества:

+ Обогащенные документы может использовать не только служба поиска, но и [средства аналитики и создания отчетов](#tools-and-apps). Power BI с Power Queryом является привлекательным выбором, но любое средство или приложение, которое может подключиться к службе хранилища Azure, может извлечь из созданного хранилища знаний.

+ Улучшение конвейера индексирования на основе ИИ в ходе отладки и определений набора навыков. Хранилище знаний предоставляет результат определения набора навыков в конвейере индексирования на основе ИИ. Эти результаты можно использовать для создания усовершенствованного набора навыков, так как вы можете отслеживать воздействие процесса обогащения. Вы можете использовать [Обозреватель службы хранилища](https://docs.microsoft.com/azure/vs-azure-tools-storage-manage-with-storage-explorer?tabs=windows) в службе хранилища Azure для просмотра содержимого хранилища знаний.

+ Преобразование данных в новые формы. Теперь доступна функция преобразования данных, реализованная в коде набора навыков. [Навык формирователя](cognitive-search-skill-shaper.md) в службе "Когнитивный поиск Azure" был доработан для выполнения этой задачи. Преобразование формы позволяет определять проекцию, которая соответствует предполагаемому способу применения данных, сохраняя при этом взаимосвязи.

> [!Note]
> Не знакомы с совершенствованием и обучением искусственного интеллекта? Когнитивный поиск Azure интегрируется с функциями распознавания изображений и текста Cognitive Services. С помощью этих функций извлекаются сведения из файлов изображений, распознаются сущности, извлекаются ключевые фразы из текстовых файлов и т. д., после чего обогащаются исходные данные. Дополнительные сведения см. в статье [Что такое когнитивный поиск в службе "Поиск Azure"?](cognitive-search-concept-intro.md).

## <a name="physical-storage"></a>Физическое хранилище

Физическое выражение хранилища знаний обозначается с помощью элемента `projections` `knowledgeStore` определения в наборе навыков. Проекция определяет структуру выходных данных, чтобы она соответствовала предполагаемому использованию.

Проекции можно сформулировать как таблицы, объекты или файлы.

```json
"knowledgeStore": { 
    "storageConnectionString": "<YOUR-AZURE-STORAGE-ACCOUNT-CONNECTION-STRING>", 
    "projections": [ 
        { 
            "tables": [ ], 
            "objects": [ ], 
            "files": [ ]
        },
                { 
            "tables": [ ], 
            "objects": [ ], 
            "files": [ ]
        }
```

Тип проекции, заданный в этой структуре, определяет тип хранилища, используемого хранилищем знаний.

+ Хранилище таблиц используется при определении `tables`. Определите проекцию таблицы, если необходимы табличные структуры отчетов для входных данных в средства аналитики или экспорта в виде кадров данных в другие хранилища данных. Можно указать несколько `tables`, чтобы получить подмножество или перекрестную секцию расширенных документов. В той же группе проекции связи между таблицами сохраняются, чтобы можно было работать со всеми ними.

+ Хранилище BLOB-объектов используется при определении `objects` или `files`. Физическое представление `object` представляет собой иерархическую структуру JSON, которая представляет собой обогащенный документ. `file` — это изображение, извлеченное из документа, которое не переносится в хранилище BLOB-объектов.

Один объект проекции содержит один набор `tables`, `objects`, `files`, а во многих случаях создание одной проекции может быть достаточно. 

Однако можно создать несколько наборов `table`-`object`-`file` проекций, и вы можете сделать это, если хотите использовать разные связи данных. В наборе данные связаны, предполагая, что эти связи существуют и могут быть обнаружены. При создании дополнительных наборов документы в каждой группе никогда не будут связаны. Примером использования нескольких групп проекции может быть то, что те же данные, предназначенные для использования в интерактивной системе, необходимо представить особым образом, Кроме того, необходимо, чтобы те же данные были запланированы для использования в конвейере обработки и анализа данных, представленном по-разному.

## <a name="requirements"></a>Требования 

Требуется [хранилище Azure](https://docs.microsoft.com/azure/storage/) . Он обеспечивает физическое хранение. Вы можете использовать хранилище BLOB-объектов, хранилище таблиц или и то, и другое. Хранилище BLOB-объектов используется для нетронутых обогащенных документов, обычно когда выходные данные переводятся в нисходящие процессы. Хранилище таблиц предназначено для фрагментов обогащенных документов, обычно используемых для анализа и создания отчетов.

Набор [навыков](cognitive-search-working-with-skillsets.md) является обязательным. Он содержит определение `knowledgeStore` и определяет структуру и композицию обогащенного документа. Нельзя создать хранилище знаний, используя пустой набор навыков. Необходимо иметь по крайней мере один навык в наборе навыков.

Требуется [индексатор](search-indexer-overview.md) . Набор навыков вызывается индексатором, который управляет выполнением. Индексаторы поставляются с собственным набором требований и атрибутов. Некоторые из этих атрибутов имеют прямую повлиять на хранилище знаний:

+ Для индексаторов требуется [поддерживаемый источник данных Azure](search-indexer-overview.md#supported-data-sources) (конвейер, который в конечном итоге создает хранилище знаний, начинается с извлечения данных из поддерживаемого источника в Azure). 

+ Для индексаторов необходим индекс поиска. Для индексатора требуется, чтобы была предоставлена схема индекса, даже если вы никогда не планируете ее использовать. Минимальный индекс имеет одно строковое поле, обозначенное как ключ.

+ Индексаторы предоставляют необязательные сопоставления полей, используемые для присвоения псевдониму исходного поля конечному полю. Если для сопоставления полей по умолчанию требуется изменение (для использования другого имени или типа), можно создать [сопоставление полей](search-indexer-field-mappings.md) в индексаторе. Для выходных данных хранилища знаний назначение может быть полем в объекте или таблице большого двоичного объекта.

+ Индексаторы имеют расписания и другие свойства, такие как механизмы обнаружения изменений, предоставляемые различными источниками данных, также могут применяться к хранилищу знаний. Например, можно [запланировать](search-howto-schedule-indexers.md) обогащение с регулярными интервалами для обновления содержимого. 

## <a name="how-to-create-a-knowledge-store"></a>Создание хранилища знаний

Чтобы создать хранилище знаний, используйте портал или предварительный просмотр REST API (`api-version=2019-05-06-Preview`).

### <a name="use-the-azure-portal"></a>Использование портала Azure

Мастер **импорта данных** включает параметры для создания хранилища знаний. Для первоначального исследования [Создайте свое первое хранилище знаний в четыре этапа](knowledge-store-connect-power-bi.md).

1. Выберите поддерживаемый источник данных.

1. Укажите обогащение: Присоедините ресурс, выберите навыки и укажите хранилище знаний. 

1. Создание схемы индекса. Мастер требует его и может вывести его.

1. Запустите мастер. В этом последнем шаге происходят извлечение, дополнение и хранение.

### <a name="use-create-skillset-and-the-preview-rest-api"></a>Использование создания набора навыков и предварительной версии REST API

`knowledgeStore` определяется в наборе [навыков](cognitive-search-working-with-skillsets.md), который, в свою очередь, вызывается [индексатором](search-indexer-overview.md). Во время обогащения Azure Когнитивный поиск создает место в учетной записи хранения Azure и проецирует Расширенные документы как большие двоичные объекты или таблицы в зависимости от конфигурации.

В настоящее время предварительная версия REST API является единственным механизмом, с помощью которого можно создать хранилище знаний программным способом. Простой способ просмотра — [создать первое хранилище знаний, используя POST и REST API](knowledge-store-create-rest.md).

Справочное содержимое для этой предварительной версии функции находится в разделе [Справочник по API](#kstore-rest-api) этой статьи. 

<a name="tools-and-apps"></a>

## <a name="how-to-connect-with-tools-and-apps"></a>Подключение с помощью средств и приложений

После помещения обогащенных документов в хранилище любое средство или технология, способные подключаться к хранилищу BLOB-объектов или таблиц Azure, можно использовать для изучения, анализа или использования их содержимого. Вот список основных таких средств:

+ [Обозреватель службы хранилища](knowledge-store-view-storage-explorer.md) позволяет просматривать структуру и содержимое обогащенных документов. Его можно считать базовым средством для просмотра содержимого хранилища знаний.

+ [Power BI](knowledge-store-connect-power-bi.md) для создания отчетов и анализа. 

+ [Фабрика данных Azure](https://docs.microsoft.com/azure/data-factory/) позволяет выполнять дальнейшую обработку данных.

<a name="kstore-rest-api"></a>

## <a name="api-reference"></a>Справочные материалы по API

Этот раздел представляет собой версию справочного документа [Создание набора навыков (REST API)](https://docs.microsoft.com/rest/api/searchservice/create-skillset) , измененную для включения определения `knowledgeStore`. 

### <a name="example---knowledgestore-embedded-in-a-skillset"></a>Пример — Кновледжесторе, внедренный в набор навыков

В следующем примере показано `knowledgeStore` в нижней части определения набора навыков. 

* Используйте **POST** или **WHERE** для формирования запроса.
* Используйте `api-version=2019-05-06-Preview` версию REST API для доступа к функциональным возможностям магазина базы знаний. 

```http
POST https://[servicename].search.windows.net/skillsets?api-version=2019-05-06-Preview
api-key: [admin key]
Content-Type: application/json
```

Тело запроса — это документ JSON, который определяет набор навыков, включающий `knowledgeStore`.

```json
{
  "name": "my-skillset-name",
  "description": "Extract organization entities and generate a positive-negative sentiment score from each document.",
  "skills":
  [
    {
      "@odata.type": "#Microsoft.Skills.Text.EntityRecognitionSkill",
      "categories": [ "Organization" ],
      "defaultLanguageCode": "en",
      "inputs": [
        {
          "name": "text",
          "source": "/document/content"
        }
      ],
      "outputs": [
        {
          "name": "organizations",
          "targetName": "organizations"
        }
      ]
    },
    {
      "@odata.type": "#Microsoft.Skills.Text.SentimentSkill",
      "inputs": [
        {
          "name": "text",
          "source": "/document/content"
        }
      ],
      "outputs": [
        {
          "name": "score",
          "targetName": "mySentiment"
        }
      ]
    },
  ],
  "cognitiveServices": 
    {
    "@odata.type": "#Microsoft.Azure.Search.CognitiveServicesByKey",
    "description": "mycogsvcs resource in West US 2",
    "key": "<YOUR-COGNITIVE-SERVICES-KEY>"
    },
    "knowledgeStore": { 
        "storageConnectionString": "<YOUR-AZURE-STORAGE-ACCOUNT-CONNECTION-STRING>", 
        "projections": [ 
            { 
                "tables": [  
                { "tableName": "Organizations", "generatedKeyName": "OrganizationId", "source": "/document/organizations*"}, 
                { "tableName": "Sentiment", "generatedKeyName": "SentimentId", "source": "/document/mySentiment"}
                ], 
                "objects": [ ], 
                "files": [  ]       
            }    
        ]     
    } 
}
```

### <a name="request-body-syntax"></a>Синтаксис текста запроса  

В следующем JSON указывается `knowledgeStore`, который является частью [`skillset`](https://docs.microsoft.com/rest/api/searchservice/create-skillset), который вызывается `indexer` (не показано). Если вы уже знакомы с обогащением искусственного интеллекта, набор навыков определяет композицию обогащенного документа. Набор навыков должен содержать по крайней мере один навык, который, скорее всего, является навыком формирователя, если вы модулируете структуры данных.

Ниже описан синтаксис полезных данных запроса.

```json
{   
    "name" : "Required for POST, optional for PUT requests which sets the name on the URI",  
    "description" : "Optional. Anything you want, or null",  
    "skills" : "Required. An array of skills. Each skill has an odata.type, name, input and output parameters",
    "cognitiveServices": "A key to Cognitive Services, used for billing.",
    "knowledgeStore": { 
        "storageConnectionString": "<YOUR-AZURE-STORAGE-ACCOUNT-CONNECTION-STRING>", 
        "projections": [ 
            { 
                "tables": [ 
                    { "tableName": "<NAME>", "generatedKeyName": "<FIELD-NAME>", "source": "<DOCUMENT-PATH>" },
                    { "tableName": "<NAME>", "generatedKeyName": "<FIELD-NAME>", "source": "<DOCUMENT-PATH>" },
                    . . .
                ], 
                "objects": [ 
                    {
                    "storageContainer": "<BLOB-CONTAINER-NAME>", 
                    "source": "<DOCUMENT-PATH>", 
                    }
                ], 
                "files": [ 
                    {
                    "storageContainer": "<BLOB-CONTAINER-NAME>",
                    "source": "/document/normalized_images/*"
                    }
                ]  
            },
            {
                "tables": [ ],
                "objects": [ ],
                "files":  [ ]
            }  
        ]     
    } 
}
```

У `knowledgeStore` есть два свойства: `storageConnectionString` учетной записи хранения Azure и `projections`, определяющие физическое хранилище. Вы можете использовать любую учетную запись хранения, но экономично использовать службы в том же регионе.

Коллекция `projections` содержит объекты проекции. Каждый объект проекции должен иметь `tables`, `objects`, `files` (по одному каждому из них), которые либо указаны, либо имеют значение null. В приведенном выше синтаксисе показаны два объекта, один полностью заданный и другой полностью null. В объекте проекции, когда он выражается в хранилище, все связи между данными, если они обнаружены, сохраняются. 

Создайте столько объектов проекции, сколько требуется для поддержки изоляции и конкретных сценариев (например, структуры данных, используемые для исследования, и те, которые необходимы в рабочей нагрузке для обработки и анализа данных). Можно получить изоляцию и настройку для конкретных сценариев, установив `source` и `storageContainer` или `table` различные значения в объекте. Дополнительные сведения и примеры см. [в разделе Работа с проекциями в хранилище знаний](knowledge-store-projection-overview.md).

|Свойство      | Применяется к | Description|  
|--------------|------------|------------|  
|`storageConnectionString`| `knowledgeStore` | Обязательный элемент. В следующем формате: `DefaultEndpointsProtocol=https;AccountName=<ACCOUNT-NAME>;AccountKey=<ACCOUNT-KEY>;EndpointSuffix=core.windows.net`|  
|`projections`| `knowledgeStore` | Обязательный элемент. Коллекция объектов свойств, состоящая из `tables`, `objects`, `files` и их соответствующих свойств. Неиспользуемые проекции могут иметь значение null.|  
|`source`| Все проекции| Путь к узлу дерева обогащения, который является корнем проекции. Этот узел является выходным результатом любого опыта в наборе навыков. Пути начинаются с `/document/`, представляющих расширенный документ, но могут быть расширены для `/document/content/` или для узлов в дереве документов. Примеры: `/document/countries/*` (все страны) или `/document/countries/*/states/*` (все Штаты во всех странах). Дополнительные сведения о путях документов см. в разделе [концепции и композиция набора навыков](cognitive-search-working-with-skillsets.md).|
|`tableName`| `tables`| Таблица, создаваемая в хранилище таблиц Azure. |
|`storageContainer`| `objects`, `files`| Имя контейнера, создаваемого в хранилище BLOB-объектов Azure. |
|`generatedKeyName`| `tables`| Столбец, созданный в таблице, который однозначно определяет документ. Конвейер обогащения заполняет этот столбец сгенерированными значениями.|


### <a name="response"></a>Ответ  

 При успешном выполнении запроса возвращается код состояния 201 (создан). По умолчанию текст ответа содержит объект JSON для созданного определения набора данных. Помните, что хранилище знаний не создается до тех пор, пока не будет вызван индексатор, который ссылается на этот набор навыков.

## <a name="next-steps"></a>Дальнейшие действия

Хранилище знаний обеспечивает стойкость обогащенных документов, полезных при разработке набора навыков или создании структур и содержимого для использования любыми клиентскими приложениями, которые могут получить доступ к учетной записи службы хранилища Azure.

Самый простой подход к созданию обогащенных документов — [на портале](knowledge-store-create-portal.md), но вы можете использовать post и REST API, что более удобно, если вы хотите получить представление о том, как создаются и указываются ссылки на объекты.

> [!div class="nextstepaction"]
> [Создание хранилища знаний с помощью POST и RESTFUL](knowledge-store-create-rest.md)
