---
title: Создание хранилища знаний на портале Azure. Поиск Azure
description: Создайте хранилище знаний службы "Поиск Azure" для сохранения дополнений из конвейера когнитивного поиска с помощью мастера импорта данных на портале Azure.
author: lisaleib
services: search
ms.service: search
ms.subservice: cognitive-search
ms.topic: tutorial
ms.date: 09/03/2019
ms.author: v-lilei
ms.openlocfilehash: 14996d0ac9ee4e086a5dccd9275ef694adca06ca
ms.sourcegitcommit: dd69b3cda2d722b7aecce5b9bd3eb9b7fbf9dc0a
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/12/2019
ms.locfileid: "70963191"
---
# <a name="create-an-azure-search-knowledge-store-in-the-azure-portal"></a>Создание хранилища знаний службы поиска Azure на портале Azure

> [!Note]
> Хранилище знаний предоставляется в предварительной версии и не предназначено для использования в рабочей среде. Этот компонент предоставляется в [REST API версии 2019-05-06-Preview](search-api-preview.md). Поддержка пакета SDK для .NET пока не реализована.
>

Хранилище знаний — это компонент Поиска Azure, который сохраняет выходные данные конвейера обогащения, выполняемого с помощью ИИ, для последующего анализа или обработки. Конвейер обогащения с помощью ИИ способен получать файлы изображений или неструктурированные текстовые файлы, отправлять их для индексирования в Поиск Azure, применять результаты обогащения ИИ, выполняемого службами Cognitive Services (например, анализ изображений и обработку естественного языка), а затем сохранять результаты в хранилище знаний в службе хранилища Azure. Затем можно использовать такие средства, как Power BI или Обозреватель службы хранилища, чтобы исследовать хранилище знаний.

В этой статье вы используете мастер импорта данных на портале Azure для приема, индексирования и применения дополнений искусственного интеллекта к набору отзывов об отеле. Отзывы об отеле импортируются в хранилище блогов Azure, а результаты сохраняются как хранилище знаний в Хранилище таблиц Azure.

После создания хранилища знаний вы можете узнать, как получить к нему доступ с помощью Обозревателя службы хранилища или Power BI.

## <a name="prerequisites"></a>Предварительные требования

+ [Создайте службу "Поиск Azure"](search-create-service-portal.md) или [найдите имеющуюся службу](https://ms.portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Search%2FsearchServices) в рамках текущей подписки. Вы можете использовать бесплатную службу для выполнения инструкций, описанных в этом учебнике.

+ [Создайте учетную запись хранения Azure](https://docs.microsoft.com/azure/storage/common/storage-quickstart-create-account) для хранения примера данных и хранилища знаний. Ваша учетная запись хранения должна использовать то же расположение (например, US-WE), что и служба "Поиск Azure", а *тип учетной записи* должен быть *Хранилище версии 2 (учетная запись общего назначения версии 2)* (по умолчанию) или *Хранилище (учетная запись общего назначения версии 1)* .

## <a name="load-the-data"></a>Загрузка данных

Загрузите CSV-файл с отзывами об отеле в хранилище BLOB-объектов Azure, чтобы получить доступ к нему через индексатор службы "Поиск Azure" и провести через конвейер обогащения искусственного интеллекта.

### <a name="create-an-azure-blob-container-with-the-data"></a>Создание контейнера BLOB-объектов Azure с данными

1. [Скачайте данные отзывов об отеле, сохраненные в CSV-файле (HotelReviews_Free.csv)](https://knowledgestoredemo.blob.core.windows.net/hotel-reviews/HotelReviews_Free.csv?st=2019-07-29T17%3A51%3A30Z&se=2021-07-30T17%3A51%3A00Z&sp=rl&sv=2018-03-28&sr=c&sig=LnWLXqFkPNeuuMgnohiz3jfW4ijePeT5m2SiQDdwDaQ%3D). Эти данные получены с сайта Kaggle.com и содержат отзывы клиентов об отелях.
1. [Войдите на портал Azure](https://portal.azure.com) и перейдите в учетную запись хранения Azure.
1. [Создайте контейнер BLOB-объектов](https://docs.microsoft.com/azure/storage/blobs/storage-quickstart-blobs-portal). Для этого в левой панели навигации для своей учетной записи хранения щелкните **BLOB-объекты**, а затем щелкните **+ Container** (+ Контейнер) на панели команд.
1. В качестве нового **имени** контейнера введите `hotel-reviews`.
1. Выберите любой **уровень общего доступа**. В нашем примере используется значение по умолчанию.
1. Нажмите кнопку **ОК**, чтобы создать контейнер BLOB-объектов Azure.
1. Откройте новый контейнер `hotels-review`, нажмите кнопку **Отправить** и выберите файл **HotelReviews-Free.csv**, скачанный на первом шаге.

    ![Отправка данных](media/knowledge-store-create-portal/upload-command-bar.png "Отправка отзывов отеля")

1. Нажмите кнопку **Отправить**, чтобы импортировать CSV-файл в хранилище BLOB-объектов Azure. Появится новый контейнер.

    ![Создание контейнера BLOB-объектов Azure](media/knowledge-store-create-portal/hotel-reviews-blob-container.png "Create the Azure Blob container")

### <a name="get-the-azure-storage-account-connection-string"></a>Получение строки подключения учетной записи службы хранилища Azure

1. Войдите в свою учетную запись службы хранилища Azure на портале.
1. В левой области навигации щелкните **Ключи доступа**.
1. В разделе **Ключ 1** скопируйте и сохраните *строку подключения*. Строка начинается с `DefaultEndpointsProtocol=https`. Имя и ключ учетной записи хранения внедряются в строку. Держите эту строку под рукой. Она понадобится в дальнейшем.

## <a name="create-and-run-ai-enrichments"></a>Создание и запуск обогащений, выполняемых с помощью ИИ

Используйте мастер импорта данных для создания хранилища знаний. Нужно создать источник данных, выбрать обогащения, настроить хранилище знаний и индекс, а затем выполнить.

### <a name="start-the-import-data-wizard"></a>Запуск мастера импорта данных

1. [Найдите службу поиска](https://ms.portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Search%2FsearchServices) на портале Azure.

1. На панели команд нажмите кнопку **Импорт данных**, чтобы запустить мастер импорта.

### <a name="connect-to-your-data-import-data-wizard"></a>Подключение к данным (мастер импорта данных)

На этом шаге мастера вы создадите источник данных из большого двоичного объекта Azure с данными об отелях.

1. В списке **Источник данных** выберите **Хранилище BLOB-объектов Azure**.
1. Для параметра **Имя** введите `hotel-reviews-ds`.
1. Для параметра **Режима анализа** выберите **Текстовый файл с разделителями**, а затем установите флажок **Первая строка содержит заголовок**. Убедитесь, что в качестве **символа разделителя** задана запятая (,).
1. Введите **строку подключения** службы хранилища, сохраненную на предыдущем шаге.
1. В качестве **имени контейнера** введите `hotel-reviews`.
1. Щелкните **Далее: добавление когнитивного поиска (необязательно)** .

      ![Создание объекта источника данных](media/knowledge-store-create-portal/hotel-reviews-ds.png "Создание объекта источника данных")

## <a name="add-cognitive-search-import-data-wizard"></a>Добавление когнитивного поиска (мастер импорта данных)

На этом шаге мастера будет создан набор навыков с обогащениями когнитивных навыков. Навыки, используемые в этом примере, извлекают ключевые фразы и определяют язык и тональность. Эти обогащения будут «проектироваться» в хранилище знаний как таблицы Azure.

1. Разверните раздел **Подключение Cognitive Services**. По умолчанию выбраны **бесплатные (ограниченные обогащения)** . Этот ресурс можно использовать, так как число записей в HotelReviews-Free.csv равно 19, а этот бесплатный ресурс позволяет выполнять до 20 транзакций в день.
1. Разверните раздел **Добавление обогащений**.
1. В поле **Имя набора навыков** введите `hotel-reviews-ss`.
1. В поле **исходных данных** выберите **reviews_text*.
1. Для **степени детализации обогащения** выберите **Pages (5000 characters chunks)** (Страницы (блоки по 5000 знаков)).
1. Выберите следующие когнитивные навыки:
    + **Извлечение ключевых фраз**
    + **Пример. Как определить язык с помощью Анализа текста**
    + **Определение тональности**

      ![Создание набора навыков](media/knowledge-store-create-portal/hotel-reviews-ss.png "Создание набора навыков")

1. Разверните раздел **Save enrichments to knowledge store** (Сохранить обогащения в хранилище знаний).
1. Введите **строку подключения учетной записи хранения**, сохраненную на предыдущем шаге.
1. Выберите эти **проекции таблиц Azure**:
    + **Документы**
    + **Страницы**
    + **Ключевые фразы**

    ![Настройка хранилища знаний](media/knowledge-store-create-portal/hotel-reviews-ks.png "Настройка хранилища знаний")

1. Щелкните **Далее: настройка целевого индекса**.

### <a name="import-data-import-data-wizard"></a>Импорт данных (мастер импорта данных)

На этом шаге мастера будет настроен индекс для необязательных запросов полнотекстового поиска. Мастер выберет образец источника данных, чтобы вывести поля и типы данных. Необходимо только выбрать атрибуты для нужного поведения. Например, атрибут **Доступный для получения** позволяет службе поиска возвращать значение поля, а **Доступный для поиска** активирует полнотекстовый поиск по полю.

1. В поле **имени индекса** введите `hotel-reviews-idx`.
1. Для атрибутов сделайте следующее:
    + Выберите **Доступный для получения** для всех полей.
    + Выберите **Фильтруемый** и **Аспектируемый** для этих полей: *Тональность*, *Язык*, *Ключевые фразы*
    + Выберите **Доступный для поиска** для следующих полей: *город*, *имя*, *reviews_text*, *язык*, *Ключевые фразы*

    Индекс должен выглядеть примерно так, как показано на следующем рисунке. Так как список длинный, на изображении видны не все поля.

    ![Настройка индекса](media/knowledge-store-create-portal/hotel-reviews-idx.png "Настройка индекса")

1. Щелкните **Далее: создание индексатора**.

### <a name="create-an-indexer"></a>Создание индексатора

На этом шаге мастера мы настроим индексатор, который объединит источник данных, набор навыков и индекс, определенный на предыдущих шагах мастера.

1. Для параметра **Имя** введите `hotel-reviews-idxr`.
1. В поле **Расписание** следует использовать значение по умолчанию **Один раз**.
1. Щелкните **Отправить**, чтобы запустить индексатор. Извлечение данных, индексирование и применение когнитивных навыков выполняются на этом шаге.

### <a name="monitor-the-notifications-queue-for-status"></a>Мониторинг состояния очереди уведомлений

1. На портале Azure найдите в журнале действий уведомлений ссылку состояния **уведомления поиска Azure**, которую можно щелкнуть. Выполнение может занять несколько минут.

## <a name="next-steps"></a>Дополнительная информация

Теперь, когда вы обогатили данные с помощью Cognitive Services и спроецировали результаты в хранилище знаний, вы можете изучить обогащенный набор данных с помощью Обозревателя службы хранилища или Power BI.

Сведения о том, как исследовать это хранилище знаний с помощью Обозревателя службы хранилища, см. в следующем пошаговом руководстве.

> [!div class="nextstepaction"]
> [Просмотр данных с помощью Обозревателя службы хранилища](knowledge-store-view-storage-explorer.md)

Сведения о том, как подключить это хранилище знаний к Power BI, см. в следующем пошаговом руководстве.

> [!div class="nextstepaction"]
> [Подключение с помощью Power BI](knowledge-store-connect-power-bi.md)

Если вы хотите повторить это упражнение или выполнить инструкции из другого пошагового руководства по обогащению с помощью ИИ, удалите только индексатор *hotel-reviews-idxr*. При удалении индексатора счетчик бесплатных ежедневных транзакций будет обнулен.
