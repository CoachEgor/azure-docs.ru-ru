---
title: Краткое руководство. Создание индекса службы поиска Azure на языке Java
description: Объясняется, как создать индекс, загрузить данные и выполнить запросы с помощью Java и интерфейсов API службы "Поиск Azure".
services: search
author: jj09
manager: jlembicz
ms.service: search
ms.topic: conceptual
ms.date: 08/26/2018
ms.author: jjed
ms.custom: seodec2018, seo-java-july2019
ms.openlocfilehash: 7deb9d2cf16aa82de7ce4ea163652c2936819063
ms.sourcegitcommit: 040abc24f031ac9d4d44dbdd832e5d99b34a8c61
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/16/2019
ms.locfileid: "69533236"
---
# <a name="quickstart-create-an-azure-search-index-in-java"></a>Краткое руководство. Создание индекса службы поиска Azure на языке Java
> [!div class="op_single_selector"]
> * [Портал](search-get-started-portal.md)
> * [.NET](search-howto-dotnet-sdk.md)
> 
> 

Узнайте, как создать собственное приложение поиска на Java, использующее Поиск Azure. В этом руководстве [REST API службы поиска Azure](https://msdn.microsoft.com/library/dn798935.aspx) используется для создания объектов и операций, используемых в этом уроке.

Чтобы запустить этот пример, вам потребуется служба поиска Azure. Создать в ней учетную запись можно на [портале Azure](https://portal.azure.com). Пошаговые инструкции приведены в статье [Создание службы "Поиск Azure" на портале](search-create-service-portal.md).

При создании и проверке этого примера мы использовали следующее программное обеспечение:

* [Интегрированная среда разработки Eclipse для разработчиков Java EE](https://www.eclipse.org/downloads/packages/release/photon/r/eclipse-ide-java-ee-developers). Обязательно загрузите версию EE. На одном из этапов проверки требуется функция, доступная только в этом выпуске.
* [JDK 8u181](https://aka.ms/azure-jdks).
* [Apache Tomcat 8.5.33](https://tomcat.apache.org/download-80.cgi#8.5.33).

## <a name="about-the-data"></a>О данных
В этом примере приложения используются данные [Геологической службы США (USGS)](https://geonames.usgs.gov/domestic/download_data.htm), отфильтрованные по штату Род-Айленд для сокращения размера набора данных. Мы будем использовать эти данные при создании приложения поиска, возвращающего важные здания, такие как больницы и школы, а также геологические объекты, например реки, озера и вершины.

В этом приложении программа **сеарчсервлет. Java** создает и загружает индекс с помощью конструкции [индексатора](https://msdn.microsoft.com/library/azure/dn798918.aspx) , получая отфильтрованный набор данных USGS из базы данных SQL Azure. Готовые учетные данные и сведения о подключении к сетевому источнику данных предоставляются в программном коде. С точки зрения доступа к данным дальнейшая настройка не требуется.

> [!NOTE]
> Мы применили фильтр к этому набору данных, чтобы не превысить ограничение бесплатной ценовой категории в 10 000 документов. При использовании стандартной категории это ограничение не накладывается, и вы можете изменять этот код для использования большего набора данных. Подробнее об ограничениях каждой ценовой категории см. в разделе [Ограничения](search-limits-quotas-capacity.md).
> 
> 

## <a name="about-the-program-files"></a>Сведения о файлах программы
Ниже перечислены файлы, относящиеся к этому примеру.

* Search.jsp: предоставляет пользовательский интерфейс;
* SearchServlet.java: предоставляет методы (аналогично контроллеру в MVC);
* SearchServiceClient.java: обрабатывает HTTP-запросы;
* SearchServiceHelper.java: вспомогательный класс, предоставляющий статические методы;
* Document.java: предоставляет модель данных;
* config.properties: Задает URL-адрес службы поиска и`api-key`
* pom.xml: зависимость Maven.

<a id="sub-2"></a>

## <a name="find-the-service-name-and-api-key-of-your-azure-search-service"></a>Поиск имени службы и `api-key` службы поиска Azure
Для всех вызовов REST API в службу поиска Azure необходимо указать URL-адрес службы и `api-key`. 

1. Войдите на [портале Azure](https://portal.azure.com).
2. На панели переходов выберите **Служба поиска** , чтобы получить список всех служб поиска Azure, подготовленных для вашей подписки.
3. Выберите службу, которую вы хотите использовать.
4. На панели мониторинга службы вы увидите элементы, указывающие на важную информацию, а также значок ключа для доступа к ключам администратора.
   
      ![Снимок экрана, показывающий, как получить доступ к ключам администратора на панели мониторинга службы][3]
5. Скопируйте URL-адрес службы и ключ администратора. Все эти элементы потребуются вам позже, при добавлении их в файл **config.properties** .

## <a name="download-the-sample-files"></a>Загрузка примеров файлов
1. Перейдите в раздел [search-java-indexer-demo](https://github.com/Azure-Samples/search-java-indexer-demo) на портале GitHub.
2. Выберите **скачать ZIP**-файл, сохраните его на диск, а затем извлеките все содержащиеся в нем файлы. Вы можете извлечь файлы в рабочую область Java, чтобы облегчить поиск проекта в дальнейшем.
3. Примеры файлов доступны только для чтения. Щелкните правой кнопкой мыши папку, откройте ее свойства и снимите атрибут только для чтения.

Все последующие изменения и операторы выполнения будут применяться к файлам в этой папке.  

## <a name="import-project"></a>Импорт проекта
1. В Eclipse выберите **файл** > **Импорт** > общихсуществующих > **проектов в рабочую область**.
   
    ![Снимок экрана, показывающий, как импортировать существующий проект][4]
2. В поле **Выберите корневой каталог**перейдите в папку, содержащую примеры файлов. Выберите папку, содержащую папку .project. Проект должен отобразиться в списке **Проекты** как выбранный элемент.
   
    ![Снимок экрана, показывающий список проектов в окне "Импорт проектов"][12]
3. Выберите **Готово**.
4. Используйте **Обозреватель проектов** для просмотра и редактирования файлов. Если он еще не открыт, выберите **окно** > **Показать представление** > **Обозреватель проектов** или используйте ярлык, чтобы открыть его.

## <a name="configure-the-service-url-and-api-key"></a>Настройте URL-адрес службы и`api-key`
1. В **обозревателе проектов**дважды щелкните **файл config. Properties** , чтобы изменить параметры конфигурации, содержащие имя сервера и `api-key`.
2. Ознакомьтесь с действиями, приведенными ранее в этой статье, где вы нашли URL `api-key` -адрес службы и в [портал Azure](https://portal.azure.com), чтобы получить значения, которые теперь будут введены в **файл config. Properties**.
3. В **файле config. Properties**замените "ключ API" `api-key` для вашей службы. Затем имя службы (первый компонент URL-адреса https://servicename.search.windows.net) заменяет "service name" в том же файле.
   
    ![Снимок экрана, показывающий, как заменить ключ API][5]

## <a name="configure-the-project-build-and-runtime-environments"></a>Настройка сред проекта, создания и выполнения
1. В Eclipse в обозревателе проектов щелкните проект правой кнопкой мыши, а затем выберите **Свойства** > **Project Facets** (Аспекты проекта).
2. Выберите **Dynamic Web Module** (Динамический веб-модуль), **Java** и **JavaScript**.
   
    ![Снимок экрана, показывающий, как выбрать аспекты проекта для проекта][6]
3. Нажмите кнопку **Применить**.
4. Выберите **Окно** > **Параметры** > **Сервер** > **Runtime Environments** (Среды выполнения) > **Добавить...** .
5. Разверните Apache и выберите ранее установленную версию Apache Tomcat. В нашей системе мы установили версию 8.
   
    ![Снимок экрана, на котором показано, где в окне среды выполнения можно выбрать версию Apache Tomcat][7]
6. На следующей странице укажите каталог установки Tomcat. На компьютере под управлением Windows это, скорее всего, будет C:\Program Files\Apache Software Foundation\Tomcat *версия*.
7. Выберите **Готово**.
8. Выберите **Окно** > **Параметры** > **Java** > **Installed JREs** (Установленные JRE) > **Добавить...** .
9. В окне **Add JRE** (Добавить JRE) выберите **Standard VM** (Стандартная виртуальная машина).
10. Щелкните **Далее**.
11. В определении JRE на главной странице JRE выберите **Каталог**.
12. Перейдите в папку **Program Files** > **Java** и выберите ранее установленный пакет JDK. Важно выбрать пакет JDK в качестве JRE.
13. В списке установленные JRE выберите **JDK**. Ваши параметры должны выглядеть примерно так.
    
    ![Снимок экрана, показывающий, как выбрать JDK в качестве установленного JRE][9]
14. При необходимости выберите **Окно** > **Веб-браузер** > **Internet Explorer**, чтобы открыть приложение во внешнем окне браузера. Использование внешнего браузера обеспечивает лучшую работу веб-приложения.
    
    ![Снимок экрана, показывающий, как выбрать Internet Explorer в качестве внешнего окна обзора][8]

Процедура настройки завершена. Далее вы соберете и запустите проект.

## <a name="build-the-project"></a>Сборка проекта
1. В обозревателе проектов щелкните правой кнопкой мыши имя проекта и выберите **Запуск от имени** > **Maven Build** , чтобы настроить проект.
   
    ![Снимок экрана, показывающий, как выбрать сборку Maven в окне обозревателя проектов][10]
2. В окне "изменение конфигурации" в списке "цели" введите "чистая установка", а затем выберите **выполнить**.

Сообщения о состоянии выводятся в окне консоли. Вы увидите сообщение "СБОРКА ПРОШЛА УСПЕШНО", указывающее на выполнение сборки проекта без ошибок.

## <a name="run-the-app"></a>Запуск приложения
На последнем этапе вы запустите приложение в среде выполнения локального сервера.

Если вы еще не указали среду выполнения сервера в Eclipse, сделайте это в первую очередь.

1. В обозревателе проектов разверните **WebContent**.
2. Щелкните правой кнопкой мыши **Search.jsp** > **Запуск от имени** > **Запустить на сервере**. Выберите сервер Apache Tomcat и нажмите кнопку **выполнить**.

> [!TIP]
> Если для хранения проекта использовалась рабочая область не по умолчанию, вам придется изменить **конфигурацию при запуске** и указать расположение проекта, чтобы избежать ошибки при запуске сервера. В обозревателе проектов щелкните правой кнопкой мыши **Search.jsp** > **Запуск от имени** > **Run Configurations** (Конфигурации запуска). Выберите сервер Apache Tomcat. Выберите **аргументы**. Выберите **Рабочая область** или **Файловая система** , чтобы задать папку, содержащую проект.
> 
> 

При запуске приложения должно отобразиться окно браузера с полем поиска для ввода условий поиска.

Подождите около минуты, прежде чем выбрать **Поиск** , чтобы предоставить время службы для создания и загрузки индекса. Если возникает ошибка HTTP 404, подождите еще немного и попробуйте снова.

## <a name="search-on-usgs-data"></a>Поиск по данным USGS
Набор данных USGS включает записи, относящиеся к штату Род-Айленд. Если выбрать **Поиск** в пустом поле поиска, будут получены первые 50 записей, которые являются значениями по умолчанию.

Если ввести условие поиска, поисковая система будет искать конкретные записи. Попробуйте ввести региональное имя или название. "Роджер Уильямс" был первым губернатором Род-Айленда. В его честь названы многие парки, здания и школы.

![Снимок экрана, показывающий, как искать данные USGS][11]

Вы также можете попробовать одно из следующих условий поиска:

* Потакет
* Пемброк
* гусь +мыс

## <a name="next-steps"></a>Следующие шаги
Это первый учебник по Поиску Azure на базе Java и набора данных USGS. Мы будем постепенно расширять это руководство, чтобы рассказать о дополнительных функциях поиска, которые вы можете использовать в собственных решениях.

Если у вас уже есть опыт работы со службой поиска Azure, вы можете использовать этот пример как фундамент для дальнейших исследований, таких как улучшение [страницы поиска](search-pagination-page-layout.md) или внедрение [фасетной навигации](search-faceted-navigation.md). Вы также можете улучшить страницу результатов поиска, добавив счетчики и пакетную обработку документов, чтобы пользователи могли просматривать результаты постранично.

Новичок в Поиске Azure? Мы рекомендуем ознакомиться с другими учебниками, чтобы получить представление о том, что вы можете создать. Посетите нашу [страницу документации](https://azure.microsoft.com/documentation/services/search/), чтобы найти дополнительные ресурсы. 

<!--Image references-->
[1]: ./media/search-get-started-java/create-search-portal-1.PNG
[2]: ./media/search-get-started-java/create-search-portal-21.PNG
[3]: ./media/search-get-started-java/create-search-portal-31.PNG
[4]: ./media/search-get-started-java/AzSearch-Java-Import1.PNG
[5]: ./media/search-get-started-java/AzSearch-Java-config1.PNG
[6]: ./media/search-get-started-java/AzSearch-Java-ProjectFacets1.PNG
[7]: ./media/search-get-started-java/AzSearch-Java-runtime1.PNG
[8]: ./media/search-get-started-java/AzSearch-Java-Browser1.PNG
[9]: ./media/search-get-started-java/AzSearch-Java-JREPref1.PNG
[10]: ./media/search-get-started-java/AzSearch-Java-BuildProject1.PNG
[11]: ./media/search-get-started-java/rogerwilliamsschool1.PNG
[12]: ./media/search-get-started-java/AzSearch-Java-SelectProject.png
