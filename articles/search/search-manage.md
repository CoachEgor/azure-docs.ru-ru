---
title: Администрация сервиса на портале
titleSuffix: Azure Cognitive Search
description: Управление сервисом Cognitive Search Azure, размещенным облачным поисковым сервисом microsoft Azure, с помощью портала Azure.
manager: nitinme
author: HeidiSteen
ms.author: heidist
tags: azure-portal
ms.service: cognitive-search
ms.topic: conceptual
ms.date: 11/04/2019
ms.openlocfilehash: 3abbf2c8e0734d17aabadd2ae5f61cc03889964b
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "79282930"
---
# <a name="service-administration-for-azure-cognitive-search-in-the-azure-portal"></a>Администрирование сервиса для когнитивного поиска Azure на портале Azure
> [!div class="op_single_selector"]
> * [PowerShell](search-manage-powershell.md)
> * [REST API](https://docs.microsoft.com/rest/api/searchmanagement/)
> * [Пакет SDK для .NET](https://docs.microsoft.com/dotnet/api/microsoft.azure.management.search)
> * [Портал](search-manage.md)
> * [Python](https://pypi.python.org/pypi/azure-mgmt-search/0.1.0)> 

Azure Cognitive Search — это полностью управляемый облачный поисковый сервис, используемый для создания богатого поиска в пользовательских приложениях. В этой статье описываются задачи администрирования службы , которые можно выполнять на [портале Azure](https://portal.azure.com) в отношении службы поиска, которая уже была подготовлена. Администрирование службы имеет упрощенный дизайн, который ограничивается следующими задачами:

> [!div class="checklist"]
> * управление *ключами API*, используемыми для доступа на чтение и запись к службе;
> * регулирование емкости службы за счет изменения выделения секций и реплик;
> * отслеживание использования ресурсов относительно ограничений уровня служб.

Обратите внимание, что *обновление* не входит в список задач администрирования. Так как ресурсы выделяются при подготовке службы, при переходе к другой категории требуется новая служба. Для получения подробной информации [см.](search-create-service-portal.md)

Вы можете отслеживать объем запросов и другие метрики, а также использовать эти сведения для настройки службы для более быстрого времени отклика. Дополнительные сведения см. в статьях [Контроль использования и статистики в службе поиска Azure](search-monitor-usage.md) и [Рекомендации по производительности и оптимизации Поиска Azure](search-performance-optimization.md).

<a id="admin-rights"></a>

## <a name="administrator-rights"></a>Права администратора
Подготовку или выведение из эксплуатации самой службы могут выполнять администраторы подписки Azure или соадминистраторы.

Любой пользователь службы, имеющий доступ к ее URL-адресу и ключ api-key администратора, имеет доступ к службе с правами на чтение и запись. Доступ для чтения и записи дает возможность добавлять, удалять и изменять объекты сервера, включая ключи api-key, индексы, индексаторы, источники данных, расписания и назначения ролей, реализованные посредством [определенных RBAC ролей](search-security-rbac.md).

Все взаимодействие пользователя с Azure Cognitive Search относится к одному из этих режимов: доступ к сервису считывания записи (права администратора) или доступ к службе только для чтения (права запроса). Дополнительные сведения см. в разделе [Управление ключами API](search-security-api-keys.md).

<a id="sys-info"></a>

## <a name="logging-and-system-information"></a>Ведение журнала и сведения о системе
Azure Cognitive Search не предоставляет файлы журналов для отдельной службы ни через портал, ни через программные интерфейсы. На базовом уровне и выше корпорация Майкрософт отслеживает все службы когнитивного поиска Azure для получения 99,9% доступности для соглашений уровня обслуживания (SLA). Если служба работает медленно, или пропускная способность опускается ниже пороговых значений, предусмотренных соглашением об уровне обслуживания, то группы поддержки изучают доступные файлы журналов и пытаются устранить проблему.

Общие сведения о службе можно получить следующими способами:

* на портале на панели мониторинга службы посредством уведомлений, свойств и сообщений о состоянии;
* с помощью [PowerShell](search-manage-powershell.md) или [REST API управления](https://docs.microsoft.com/rest/api/searchmanagement/) для [получения свойств службы](https://docs.microsoft.com/rest/api/searchmanagement/services) или сведений об уровне использования ресурсов индексом;


<a id="sub-5"></a>

## <a name="monitor-resource-usage"></a>Отслеживание использования ресурсов
На панели мониторинга отслеживание ресурсов ограничивается информацией, показанной на панели мониторинга службы, а также несколькими метриками, которые вы можете получить с помощью запроса к службе. В панели мониторинга службы, в разделе «Использование», вы можете быстро определить, являются ли уровни ресурсов раздела достаточными для вашего приложения. Можно предоставить внешние ресурсы, такие как мониторинг Azure, если требуется ухватить и упорствовать в зарегистрированных событиях. Для получения дополнительной информации [см.](search-monitor-usage.md)

Используя поисковый сервис REST API, вы можете получить счет на документы и индексы программно: 

* [Получение статистики индексов](https://docs.microsoft.com/rest/api/searchservice/Get-Index-Statistics)
* [Подсчет документов](https://docs.microsoft.com/rest/api/searchservice/count-documents)

## <a name="disaster-recovery-and-service-outages"></a>Аварийное восстановление и простои службы

Несмотря на то, что мы можем спасти ваши данные, Azure Cognitive Search не обеспечивает мгновенного сбоя службы при сбое на уровне кластера или центра обработки данных. Если сбой кластера произойдет в центре обработки данных, то рабочая группа обнаружит проблему и сделает все возможное для восстановления службы. Во время восстановления службы может произойти простой, но вы можете запросить компенсацию кредитов за недоступность службы в соответствии с условиями [Соглашения об уровне обслуживания (SLA)](https://azure.microsoft.com/support/legal/sla/search/v1_0/). 

Если требуется непрерывное обслуживание в случае критических сбоев, не контролируемых корпорацией Майкрософт, можно [подготовить дополнительную службу](search-create-service-portal.md) в другом регионе и реализовать стратегию георепликации, чтобы обеспечить полную избыточность индексов для всех служб.

Пользователи, использующие [индексаторы](search-indexer-overview.md) для заполнения и обновления индексов, могут выполнять аварийное восстановление с помощью индексаторов в определенном географическом регионе, используя один источник данных. Две службы в разных регионах, в каждой из которых выполняется индексатор, могут индексировать один источник данных для обеспечения географической избыточности. Если вы индексируете из источников данных, которые также являются геоизлишними, имейте в виду, что индексы Azure Cognitive Search могут выполнять только инкрементную индексацию (слияние обновлений из новых, измененных или удаленных документов) из первичных реплик. В случае отработки отказа свяжите индексатор с новой первичной репликой. 

Если вы не используете индексаторы, вместо них будет использоваться код приложения, одновременно передающий объекты и данные в различные службы поиска. Для получения дополнительной информации [см. Производительность и оптимизация в Azure Cognitive Search](search-performance-optimization.md).

## <a name="backup-and-restore"></a>Резервное копирование и восстановление

Поскольку Azure Cognitive Search не является основным решением для хранения данных, мы не предоставляем формальный механизм резервного копирования и восстановления самообслуживания. Тем не менее, вы можете использовать код образца **резервного копирования-восстановления индекса** в этом [azure Cognitive Search .NET образец репо](https://github.com/Azure-Samples/azure-search-dotnet-samples) для резервного копирования определения индекса и моментального снимка в серии файлов JSON, а затем использовать эти файлы для восстановления индекса, если это необходимо. Этот инструмент также может перемещать индексы между уровнями обслуживания.

В противном случае код приложения, используемый для создания и заполнения индекса, является вариантом фактического восстановления, если вы удалите индекс по ошибке. Чтобы перестроить индекс, необходимо удалить его (если он существует), заново создать индекс в службе и перезагрузить, получив данные из основного хранилища данных.

<a id="scale"></a>

## <a name="scale-up-or-down"></a>Масштабирование вверх или вниз
Каждая поисковая служба стартует минимум с одной реплики и одного раздела. Если у вас [категория, предоставляющая выделенные ресурсы](search-limits-quotas-capacity.md), щелкните плитку **Масштаб** на панели мониторинга службы, чтобы настроить использование ресурсов.

При добавлении емкости или мощности с помощью какого-либо ресурса служба начинает использовать его автоматически. Никаких дополнительных действий с вашей стороны не требуется, но будет небольшая задержка, прежде чем произойдет задействование нового ресурса. Подготовка дополнительных ресурсов может занять 15 и более минут.

 ![][10]

### <a name="add-replicas"></a>Добавление реплик
Увеличение количества запросов в секунду (QPS) или достижение высокой производительности осуществляется посредством добавления реплик. Каждая реплика имеет одну копию индекса, так что добавление еще ​​одной реплики означает перенос еще одного индекса, доступного для обработки запросов службы. Для обеспечения высокой доступности требуется не менее 3 реплик (дополнительные сведения см. в статье [Масштабирование уровней ресурсов для рабочих нагрузок запросов и индексирования в Поиске Azure](search-capacity-planning.md)).

Служба поиска с большим количеством реплик может загружать баланс поисковых запросов по большему числу индексов. Учитывая уровень объема запросов, пропускная способность запросов будет выше, когда существует больше копий индекса, доступных для обслуживания запроса. При возникновении задержки запросов возможен позитивный эффект на производительность, как только дополнительные реплики окажутся в сети.

Несмотря на то, что дополнительные реплики повышают пропускную способность, она в точности не удваивается или утраивается при добавлении реплик к вашей службе. Все приложения поиска могут зависеть от внешних факторов, которые могут противоречить показателям производительности запросов. Сложные запросы и задержки в сети являются факторами, влияющими на изменение времени ответа на запрос.

### <a name="add-partitions"></a>Добавление разделов
Большинство приложений-служб имеет встроенную потребность в большем количестве реплик, а не секций. В случае необходимости повысить количество документов нужно добавить секции, если вы подписаны на службу ценовой категории "Стандартный". Для категории "Базовый" дополнительные секции не предоставляются.

Для категории "Стандартный" секции добавляются кратно 12 (в частности, 1, 2, 3, 4, 6 или 12). Это артефакт сегментирования. Индекс создается в 12 сегментах, которые все вместе могут храниться в одной секции или равномерно распределяться по 2, 3, 4, 6 или 12 секциям (один сегмент на секцию).

### <a name="remove-replicas"></a>Удаление реплик
После окончания периода большого количества запросов вы можете сократить число реплик с помощью ползунка, когда нагрузки поисковых запросов нормализуются (например, после окончания периода сезонных распродаж). Больше с вашей стороны ничего делать не нужно. Уменьшение количества реплик освобождает виртуальные машины в центре обработки данных. Теперь ваши запросы и операции приема данных будут работать на меньшем количестве виртуальных машин, чем раньше. Минимальное требование — одна реплика.

### <a name="remove-partitions"></a>Удаление разделов
В отличие от удаления реплик, не требующего дополнительных усилий с вашей стороны, удаление пространства хранения - более сложная задача, особенно если вы используете больше хранилищ, чем может быть удалено. Например, если ваше решение использует три секции, то уменьшение размера до одной или двух секций приведет к ошибке, так как новое дисковое пространство меньше, чем требуется для хранения вашего индекса. Поэтому, как вы могли предположить, в такой ситуации рекомендуется удалить индексы или документы в соответствующем индексе для освобождения пространства, или сохранить текущую конфигурацию.

Не существует метода, задающего конкретные сегменты индекса, хранящиеся в каждом разделе. Каждый раздел обеспечивает примерно 25 ГБ в хранилище, так что вам нужно будет сократить хранилище до размера, который может быть размещен на имеющемся количестве разделов. Если вы хотите вернуться к одному разделу, то нужно вместить в него все 12 сегментов.

Чтобы помочь при планировании работы, вы можете проверить хранилище (с использованием раздела [Получение статистики индексов](https://docs.microsoft.com/rest/api/searchservice/Get-Index-Statistics)), чтобы посмотреть, какой объем на самом деле используется. 

<a id="next-steps"></a>

## <a name="next-steps"></a>Дальнейшие действия
Разобравшись с понятиями, связанными с администрированием службы, вы можете перейти к использованию [PowerShell](search-manage-powershell.md) для автоматизации задач.

Мы также рекомендуем ознакомиться со статьей, посвященной [производительности и оптимизации](search-performance-optimization.md).

<!--Image references-->
[10]: ./media/search-manage/Azure-Search-Manage-3-ScaleUp.png



