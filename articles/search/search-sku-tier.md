---
title: Выберите ценовую категорию или номер SKU
titleSuffix: Azure Cognitive Search
description: 'Когнитивный поиск Azure можно подготовить в следующих SKU: Free, Basic, Standard и Standard доступны в различных конфигурациях ресурсов и уровнях емкости.'
manager: nitinme
author: HeidiSteen
ms.author: heidist
ms.service: cognitive-search
ms.topic: conceptual
ms.date: 01/30/2020
ms.openlocfilehash: 35dbd064a09a96dae58e1b15a6d8889bda45ee0d
ms.sourcegitcommit: 67e9f4cc16f2cc6d8de99239b56cb87f3e9bff41
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/31/2020
ms.locfileid: "76899849"
---
# <a name="choose-a-pricing-tier-for-azure-cognitive-search"></a>Выберите ценовую категорию для Azure Когнитивный поиск

При создании службы Когнитивный поиск Azure [ресурс создается](search-create-service-portal.md) в ценовой категории (или номере SKU), фиксированной на время существования службы. Уровни включают в себя бесплатное, базовое, стандартное и оптимизированное для хранилища. Стандартные и оптимизированные для хранилища устройства доступны с несколькими конфигурациями и емкостью.

Большинство клиентов начинают с уровня Free, чтобы они могли оценить службу. После ознакомления обычно создается вторая служба на одном из более высоких уровней для разработки и развертывания в рабочей среде.

## <a name="feature-availability-by-tier"></a>Доступность функций по уровням

Почти все функции доступны на каждом уровне, включая бесплатный, но функция или рабочий процесс, интенсивно работающие ресурсы, могут работать плохо, если не предоставить достаточную емкость. Например, [обогащение искусственного интеллекта](cognitive-search-concept-intro.md) имеет долгосрочные навыки, которые истечения времени ожидания в бесплатной службе, если набор данных не является небольшим.

В следующей таблице описаны ограничения на функции, связанные с уровнями.

| Функция | Ограничения |
|---------|-------------|
| [индексаторов](search-indexer-overview.md) | Индексаторы недоступны на S3 HD. |
| [Ключи шифрования, управляемые клиентом](search-security-manage-encryption-keys.md) | Недоступно на уровне Free. |

## <a name="tiers-skus"></a>Уровни (SKU)

Уровни различаются по следующим параметрам:

+ Количество индексов и индексаторов, которые можно создать
+ скорость секционирования и размер секций (физического хранилища).

Выбранный уровень определяет коэффициент оплаты. На следующем снимке экрана из портал Azure показаны доступные уровни минус цены (которые можно найти на портале и на [странице цен](https://azure.microsoft.com/pricing/details/search/). Основные уровни — **Free**, **Basic**и **Standard** .

**Free** создает ограниченную службу поиска в кластере, совместно используемую с другими подписчиками. Можно выполнять небольшие проекты, в том числе краткие руководства и учебники, но нельзя масштабировать службу или выполнять значительные рабочие нагрузки. **Основные** и **стандартные** — наиболее часто используемые оплачиваемые уровни со **стандартом** по умолчанию.

![Ценовые категории Когнитивный поиск Azure](media/search-sku-tier/tiers.png "Ценовые категории Когнитивный поиск Azure")

Некоторые уровни оптимизированы для определенных типов работы. Например, **стандартный 3 высокой плотности (S3 HD)** — это *режим размещения* для S3, где базовое оборудование оптимизировано для большого количества небольших индексов и предназначено для многотелефонных сценариев. На уровне S3 HD взимается такая же плата за единицу, как и S3, но оборудование оптимизировано для быстрого чтения файлов с большим количеством небольших индексов.

Уровни, **оптимизированные для хранилища** , обеспечивают более низкую емкость хранилища по меньшей цене за ТБ, чем стандартные уровни. Основной компромисс — это более высокая задержка запросов, которую следует проверить на соответствие конкретным требованиям приложения.  Дополнительные сведения о вопросах производительности этого уровня см. в статье [вопросы производительности и оптимизации](search-performance-optimization.md).

Дополнительные сведения о различных уровнях см. на [странице с ценами](https://azure.microsoft.com/pricing/details/search/), в разделе [ограничения службы в когнитивный Поиск Azure](search-limits-quotas-capacity.md) и на странице портала при подготовке службы.

## <a name="billable-events"></a>Оплачиваемые события

Решение, созданное на Когнитивный поиск Azure, может повлечь за собой следующие виды затрат:

+ Базовая стоимость обслуживания в минимальной конфигурации (создание службы)
+ Добавочные затраты при масштабировании (Добавление реплик или секций)
+ Плата за пропускную способность (передача исходящих данных) 
+ Поиск со вознанием (присоединение Cognitive Services для обогащения искусственного интеллекта, служба хранилища Azure для хранилища знаний)

### <a name="service-costs"></a>Стоимость обслуживания

В отличие от виртуальных машин или других ресурсов, которые можно "приостановить", чтобы избежать расходов, служба Когнитивный поиск Azure всегда доступна на оборудовании, выделенном для монопольного использования. Таким образом, создание службы — это оплачиваемое событие, которое запускается при создании службы и завершается при удалении службы. 

Минимальная стоимость — это первая единица поиска (одна реплика x одна секция) на коэффициенте оплаты. Это минимальное значение фиксируется во время существования службы, так как служба не может работать ни на что меньше этой конфигурации. Помимо минимума можно добавлять реплики и секции независимо друг от друга. Добавочное увеличение емкости с помощью реплик и секций увеличит счет на основе следующей формулы: [(количество реплик x секции x)](#search-units), где плата зависит от выбранной ценовой категории.

При оценке стоимости решения поиска учитывайте, что цены и емкость не являются линейными. (Удвоение емкости больше, чем удвоение стоимости.) Пример того, как работает формула, см. в разделе [как выделить реплики и секции](search-capacity-planning.md#how-to-allocate-replicas-and-partitions).

### <a name="bandwidth-charges"></a>Плата за пропускную способность

Использование [индексаторов когнитивный Поиск Azure](search-indexer-overview.md) может повлиять на выставление счетов в зависимости от расположения служб. При создании службы Когнитивный поиск Azure в том же регионе, в котором находятся данные, плата за исходящие данные может быть полностью устранена. Ниже приведены некоторые сведения на [странице цены на пропускную способность](https://azure.microsoft.com/pricing/details/bandwidth/).

+ Корпорация Майкрософт не взимается за любые входящие данные в любой службе в Azure или на исходящие данные из Azure Когнитивный поиск.
+ В многосервисных решениях плата за данные, передаваемые по сети, не взимается, если все службы находятся в одном регионе.

Если службы находятся в разных регионах, плата взимается за исходящие данные. Эти расходы не являются частью счета Azure Когнитивный поиск. Они упомянуты здесь, потому что если вы используете данные или более обогащенные индексаторы для извлечения данных из разных регионов, вы увидите, что затраты отражены в общем счете.

### <a name="ai-enrichment-with-cognitive-services"></a>Обогащение искусственного интеллекта с помощью Cognitive Services

Для [обогащения искусственного интеллекта](cognitive-search-concept-intro.md)необходимо запланировать [подключение оплачиваемого Cognitive Services ресурса Azure](cognitive-search-attach-cognitive-services.md)в том же регионе, что и когнитивный Поиск Azure, на ценовой категории S0 для обработки с оплатой по мере использования. Нет фиксированных затрат, связанных с присоединением Cognitive Services. Вы платите только за необходимую обработку.

| Операция | Принцип выставления счетов |
|-----------|----------------|
| Взлом документов, извлечение текста | Free |
| Взлом документов, Извлечение изображений | Счета выставляются в соответствии с количеством образов, извлеченных из документов. В [конфигурации индексатора](https://docs.microsoft.com/rest/api/searchservice/create-indexer#indexer-parameters) **имажеактион** — это параметр, который запускает извлечение изображений. Если для **имажеактион** задано значение "нет" (по умолчанию), вы не будете получать оплату за извлечение изображений. Скорость извлечения образа описана на странице [сведений о ценах](https://azure.microsoft.com/pricing/details/search/) на когнитивный Поиск Azure.|
| [Встроенные когнитивные навыки](cognitive-search-predefined-skills.md) | Счет выставляется по той же ставке, что и при выполнении задачи с помощью Cognitive Services напрямую. |
| Пользовательские навыки | Пользовательский навык — это предоставляемые вами функции. Затраты на использование пользовательского навыка полностью зависят от того, вызывает ли пользовательский код другие службы с оплатой. |

<a name="search-units"></a>

## <a name="billing-formula-r-x-p--su"></a>Формула выставления счетов (R x P = SU)

Наиболее важной концепцией выставления счетов, которую следует знать для Azure Когнитивный поиск Operations, является *единица поиска* (SU). Поскольку Когнитивный поиск Azure зависит как от реплик, так и секций для индексирования и запросов, она не имеет смысла выставлять счет только для одного или другого. Вместо этого выставление счетов основано на всех частях.

SU — это произведение *реплик* и *секций* , используемых службой: **(R x P = SU)** .

Каждая служба имеет как минимум одну единицу поиска (одна реплика, умноженная на одну секцию). Максимальное значение для любой службы — 36. Это максимальное значение можно получить несколькими способами: Например, 6 секций x 6 реплик или 3 раздела по 12 реплик. Обычно используется меньше общей емкости (например, 3-реплика, 3-секционная служба выставляется как 9 SUs). Допустимые сочетания см. на диаграмме с [комбинациями разделов и реплик](search-capacity-planning.md#chart) .

Ставка выставления счетов Почасовая цена на SU. Каждый уровень имеет более высокую скорость. Более высокие уровни поставляются с большими и спидиер разделами, и это влияет на общую почасовую ставку для этого уровня. Вы можете просмотреть ставки для каждого уровня на странице [сведения о ценах](https://azure.microsoft.com/pricing/details/search/) .

Большинство клиентов используют часть полной емкости в сети, удерживая остальные ресурсы в резерве. Для выставления счетов количество секций и реплик, которые вы переводите в оперативный режим, вычисляется формулой SU, определяет, что вы оплачиваете почасовой основе.

## <a name="how-to-manage-costs"></a>Управление затратами

Следующие рекомендации помогут вам сократить затраты.

- Создайте все ресурсы в одном и том же регионе или как можно меньшее количество регионов, чтобы свести к сведению или исключить плату за пропускную способность.

- Объедините все службы в одну группу ресурсов, например Azure Когнитивный поиск, Cognitive Services и другие службы Azure, используемые в решении. В портал Azure найдите группу ресурсов и используйте команды **управления затратами** для анализа фактических и прогнозируемых расходов.

- Рассмотрим веб-приложение Azure для внешнего приложения, чтобы запросы и ответы оставались в пределах границ центра обработки данных.

- Увеличение масштаба для ресурсоемких операций, таких как индексирование, а затем изменение их вниз для обычных рабочих нагрузок запросов. Начните с минимальной конфигурации Когнитивный поиск Azure (одной SU, состоящей из одной секции и одной реплики), а затем Отслеживайте действия пользователей, чтобы определить закономерности использования, которые свидетельствуют о необходимости увеличения емкости. Если имеется прогнозируемый шаблон, вы можете синхронизировать масштабирование с действием (для автоматизации этого потребуется написать код).

Кроме того, см. [руководство по выставлению счетов и управлению затратами](https://docs.microsoft.com/azure/billing/billing-getting-started) для встроенных средств и функций, связанных с затратами.

Не удается завершить работу службы поиска на временной основе. Выделенные ресурсы всегда работают, выделяются для монопольного использования в течение срока службы. Удаление службы является постоянной, а также удаляет связанные с ней данные.

В терминах самой службы единственным способом снижения счета является сокращение количества реплик и секций до уровня, который по-прежнему обеспечивает приемлемое соответствие производительности и [соглашений об уровне обслуживания](https://azure.microsoft.com/support/legal/sla/search/v1_0/), или создание службы на более низком уровне (часовые тарифы S1 ниже S2 или S3). Предполагая, что вы подготавливаете службу в нижней части проекций нагрузки, если вы масштабируемостьи службу, вы можете создать вторую более крупную службу, перестроить индексы во второй службе, а затем удалить первую из них.

## <a name="how-to-evaluate-capacity-requirements"></a>Оценка требований к емкости

В Когнитивный поиск Azure емкость структурирована как *реплики* и *Секции*.

+ Реплики — это экземпляры службы поиска. Каждая реплика содержит одну копию индекса с балансировкой нагрузки. Например, служба с шестью репликами имеет шесть копий каждого индекса, загруженного в службу.

+ Секции хранят индексы и автоматически разбивают данные, поддерживающие поиск. Два раздела делят индекс на две части, три секции разбивают их на третьи и т. д. С точки зрения емкости *размер секции* является основной отличительной особенностью уровней.

> [!NOTE]
> Все уровни Standard и оптимизированные для хранилища поддерживают [гибкие сочетания реплик и секций](search-capacity-planning.md#chart) , что позволяет [оптимизировать систему для ускорения или хранения](search-performance-optimization.md) , изменяя баланс. Уровень "базовый" предлагает до трех реплик для обеспечения высокой доступности, но имеет только один раздел. Бесплатные уровни не предоставляют выделенные ресурсы: вычислительные ресурсы совместно используются несколькими подписчиками.


### <a name="evaluating-capacity"></a>Оценка емкости

Емкость и стоимость работы службы. Уровни накладывают ограничения на два уровня: хранилище и ресурсы. Следует подумать о обоих случаях, так как достигнуто максимально допустимое ограничение.

Бизнес-требования обычно определяют необходимое количество индексов. Например, может потребоваться глобальный индекс для большого репозитория документов. Или может потребоваться несколько индексов на основе региона, приложения или бизнес-нишу.

Чтобы определить размер индекса, необходимо [создать его](search-create-index-portal.md). Его размер будет основан на импортированных данных и конфигурации индекса, например о включении предложений, фильтрации и сортировки. Дополнительные сведения о влиянии конфигурации на размер см. в разделе [Создание базового индекса ](search-what-is-an-index.md).

Для полнотекстового поиска Первичная структура данных является [инвертированной](https://en.wikipedia.org/wiki/Inverted_index) структурой индекса, которая имеет различные характеристики, чем исходные данные. Для инвертированного индекса размер и сложность определяются по содержимому, а не к объему данных, которые вы передаете в него. Большой источник данных с высокой избыточностью может привести к тому, что индекс будет меньше, чем меньший набор данных, содержащий сильно изменяемое содержимое. Поэтому редко бывает возможно определить размер индекса на основе размера исходного набора данных.

> [!NOTE] 
> Несмотря на то, что оценка будущих потребностей для индексов и хранилища может показаться предоставляяй, она стоит делать. Если емкость уровня оказывается слишком низкой, необходимо создать новую службу на более высоком уровне, а затем [перезагрузить индексы](search-howto-reindex.md). Обновление службы на месте с одного SKU на другой не выполняется.
>

### <a name="estimate-with-the-free-tier"></a>Оценка на уровне Free

Один из подходов к оценке емкости — начать с уровня Free. Помните, что бесплатная служба предлагает до трех индексов, 50 МБ хранилища и 2 минуты времени индексирования. Оценка предполагаемого размера индекса с этими ограничениями может быть непростой, но это шаги:

+ [Создайте бесплатную службу](search-create-service-portal.md).
+ Подготовьте небольшой репрезентативный набор данных.
+ [Создайте исходный индекс на портале](search-create-index-portal.md) и запишите его размер. Функции и атрибуты оказывают влияние на хранилище. Например, добавление предложений (typeahead) увеличит требования к хранилищу. Используя тот же набор данных, вы можете попытаться создать несколько версий индекса с различными атрибутами для каждого поля, чтобы увидеть, как требования к хранилищу различны. Дополнительные сведения см. [в разделе "влияние на хранилище" раздела Создание базового индекса](search-what-is-an-index.md#index-size).

Выполнив приблизительную оценку, вы можете вдвое воздействовать на бюджет для двух индексов (разработки и рабочей среды), а затем выбрать свой уровень соответствующим образом.

### <a name="estimate-with-a-billable-tier"></a>Оценка с помощью оплачиваемого уровня

Выделенные ресурсы могут поддерживать большую выборку и время обработки для более реалистичных оценок объема индексов, размера и запросов во время разработки. Некоторые клиенты переходят вправо с помощью оплачиваемого уровня, а затем повторно вычисляют проект разработки.

1. [Просмотрите ограничения службы на каждом уровне](https://docs.microsoft.com/azure/search/search-limits-quotas-capacity#index-limits) , чтобы определить, могут ли более низкие уровни поддерживать необходимое количество индексов. Для уровней Basic, S1 и S2 ограничения индекса равны 15, 50 и 200 соответственно. Уровень, оптимизированный для хранилища, имеет ограничение в 10 индексов, поскольку оно предназначено для поддержки небольшого количества очень больших индексов.

1. [Создайте службу на платном уровне](search-create-service-portal.md):

    + Если вы не уверены в прогнозируемой нагрузке, начните с Low, Basic или S1.
    + Если вы знаете, что планируется крупномасштабное индексирование и загрузка запросов, начните с уровня S2 или даже S3.
    + Начните с оптимизированного хранилища на уровне L1 или L2, если вы индексируете большой объем данных, а загрузка запросов относительно низкая, как в случае внутреннего бизнес-приложения.

1. [Создайте начальный индекс](search-create-index-portal.md), чтобы определить, как исходные данные преобразуются в индекс. Это единственный способ оценки размера индекса.

1. [Отслеживайте хранилище, ограничения служб, объем запросов и задержку](search-monitor-usage.md) в портале. На портале отображаются запросы в секунду, регулируемые запросы и задержки поиска. Все эти значения помогут решить, выбран ли подходящий уровень. 

Порядковый номер и размер индекса не менее важны для вашего анализа. Это связано с тем, что максимальное количество ограничений достигается за счет полного использования хранилища (секций) или максимальных ограничений на ресурсы (индексы, индексаторы и т. д.), в зависимости от того, что происходит первым. Портал помогает отслеживать и то, и другое, показывая текущее использование и максимальные ограничения на странице "Обзор".

> [!NOTE]
> Требования к хранилищу могут быть сведены, если документы содержат лишние данные. В идеале документы содержат только те данные, которые необходимы для поиска. Двоичные данные недоступны для поиска и должны храниться отдельно (возможно, в таблице Azure или хранилище BLOB-объектов). Поле должно быть добавлено в индекс для хранения URL-ссылки на внешние данные. Максимальный размер отдельного документа составляет 16 МБ (или меньше, если вы выполняете небольшую загрузку нескольких документов в одном запросе). Дополнительные сведения см. [в статье ограничения службы в когнитивный Поиск Azure](search-limits-quotas-capacity.md).
>

**Рекомендации по объему запросов**

Количество запросов в секунду (QPS) является важной метрикой во время настройки производительности, но обычно это относится только к уровню, если предполагается, что вы планируете высокий объем запросов.

Уровни Standard могут обеспечивать баланс между репликами и секциями. Вы можете увеличить количество запросов, добавив реплики для балансировки нагрузки или добавив секции для параллельной обработки. Затем можно настроить производительность после подготовки службы.

Если вы предполагали, что самые высокие объемы запросов будут задерживаться с самого начала, следует рассмотреть более высокие уровни уровня Standard, которые поддерживаются более мощным оборудованием. После этого можно перевести секции и реплики в автономный режим или даже переключиться на службу более низкого уровня, если эти тома запросов не выполняются. Дополнительные сведения о том, как вычислить пропускную способность запросов, см. в статье [производительность и оптимизация когнитивный Поиск Azure](search-performance-optimization.md).

Уровни, оптимизированные для хранилища, полезны для рабочих нагрузок с большими данными и поддерживают более общее Доступное хранилище индексов, когда требования к задержке запросов менее важны. Вы по-прежнему должны использовать дополнительные реплики для балансировки нагрузки и дополнительные секции для параллельной обработки. Затем можно настроить производительность после подготовки службы.

**Соглашения об уровне обслуживания**

Бесплатные функции уровня и предварительной версии не обеспечивают [соглашения об уровне обслуживания (SLA)](https://azure.microsoft.com/support/legal/sla/search/v1_0/). Для всех оплачиваемых уровней соглашения об уровне обслуживания вступают в силу, если для службы обеспечена достаточная избыточность. Для запроса соглашения об уровне обслуживания (Read) необходимо иметь две или более реплики. Необходимо иметь три или более реплики для запросов SLA и индексирования (для чтения и записи). Количество секций не влияет на соглашения об уровне обслуживания.

## <a name="tips-for-tier-evaluation"></a>Советы по оценке уровня

+ Разрешить метрикам создавать запросы и собирать данные по шаблонам использования (запросы в рабочее время, индексирование в часы наименьшей нагрузки). Используйте эти данные для информирования решений о подготовке службы. Хотя это непрактично для почасовой или ежедневной ритмичности, можно динамически корректировать секции и ресурсы, чтобы учесть запланированные изменения в томах запросов. Вы также можете обеспечить незапланированные, но устойчивые изменения, если уровни достаточно долго, чтобы гарантировать выполнение действий.

+ Помните, что единственным недостатком недоподготовки является то, что вам может потребоваться разорвать службу, если фактические требования больше ваших прогнозов. Чтобы избежать прерывания работы служб, создайте новую службу на более высоком уровне и запустите ее параллельно, пока все приложения и запросы не будут нацелены на новую конечную точку.

## <a name="next-steps"></a>Дальнейшие действия

Начните с уровня Free и создайте начальный индекс с помощью подмножества данных, чтобы понять его характеристики. Структура данных в Когнитивный поиск Azure — это обратная структура индекса. Размер и сложность инвертированного индекса определяются содержимым. Помните, что высокоизбыточное содержимое имеет тенденцию приводить к созданию индекса меньшего объема, чем более неоднородное содержимое. Поэтому характеристики содержимого, а не размер набора данных, определяют требования к хранению индекса.

После первоначальной оценки размера индекса [подготавливается к оплате](search-create-service-portal.md) на одном из уровней, описанных в этой статье: Базовый, стандартный или оптимизированный для хранилища. Ослабляете любые искусственные ограничения на размер данных и [перестройте индекс](search-howto-reindex.md) , чтобы включить в него все данные, которые необходимо найти.

[Выделите секции и реплики](search-capacity-planning.md) по мере необходимости, чтобы получить требуемую производительность и масштабирование.

Если производительность и емкость являются достаточными, то все готово. В противном случае повторно создайте службу поиска на другом уровне, более точно соответствующем вашим потребностям.

> [!NOTE]
> Если у вас есть вопросы, опубликуйте их по адресу [StackOverflow](https://stackoverflow.com/questions/tagged/azure-search) [или обратитесь в службу поддержки Azure](https://azure.microsoft.com/support/options/)
