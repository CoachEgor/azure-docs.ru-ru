---
title: Выберите ценовой уровень или SKU
titleSuffix: Azure Cognitive Search
description: 'Когнитивный поиск Azure может быть подготовлен в следующих SkUS: Free, Basic и Standard, а стандарт доступен в различных конфигурациях ресурсов и уровнях емкости.'
manager: nitinme
author: HeidiSteen
ms.author: heidist
ms.service: cognitive-search
ms.topic: conceptual
ms.date: 01/30/2020
ms.openlocfilehash: 35dbd064a09a96dae58e1b15a6d8889bda45ee0d
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/27/2020
ms.locfileid: "76899849"
---
# <a name="choose-a-pricing-tier-for-azure-cognitive-search"></a>Выберите ценовой уровень для когнитивного поиска Azure

При создании службы когнитивного поиска Azure [ресурс создается](search-create-service-portal.md) на уровне ценообразования (или SKU), который фиксируется на протяжении всего срока службы. Уровни включают в себя бесплатно, основной, стандартный и хранения оптимизированы. Стандартные и хранения Оптимизированные доступны с несколькими конфигурациями и емкостями.

Большинство клиентов начинают с бесплатного уровня, чтобы они могли оценить услугу. После оценки обычно создается вторая служба на одном из высших уровней для развертывания разработки и развертывания.

## <a name="feature-availability-by-tier"></a>Доступность функций по уровню

Почти каждая функция доступна на каждом уровне, включая Free, но функция или рабочий процесс, который является ресурсоемким, может не работать хорошо, если вы не предоставите ей достаточную емкость. Например, [обогащение ИИ](cognitive-search-concept-intro.md) имеет долгосрочные навыки, которые тайм-аут на бесплатную услугу, если набор данных не мал.

В следующей таблице описаны ограничения функций, связанных с уровнем.

| Компонент | Ограничения |
|---------|-------------|
| [Индексаторы](search-indexer-overview.md) | Индексы недоступны на S3 HD. |
| [Ключи шифрования, управляемые заказчиком](search-security-manage-encryption-keys.md) | Недоступно на свободноя ярусе. |

## <a name="tiers-skus"></a>Уровни (СКУ)

Уровни дифференцированы по:

+ Количество индексов и индексеров, которые можно создать
+ скорость секционирования и размер секций (физического хранилища).

Выбраное уровень определяет оплачиваемую ставку. На следующем скриншоте с портала Azure показаны доступные уровни, минус цены (которые вы можете найти на портале и на [странице ценообразования.](https://azure.microsoft.com/pricing/details/search/) **Бесплатные,** **Основные**, и **стандарт** являются наиболее распространенными уровнями.

**Free** создает ограниченный поисковый сервис в кластере, общий с другими абонентами. Вы можете выполнять небольшие проекты, включая quickstarts и учебники, но вы не можете масштабировать службу или выполнять значительные рабочие нагрузки. **Basic** и **Standard** являются наиболее часто используемыми оплачиваемыми уровнями, при этом **Стандартный** является по умолчанию.

![Уровни ценообразования в когнитивном поиске Azure](media/search-sku-tier/tiers.png "Уровни ценообразования в когнитивном поиске Azure")

Некоторые уровни оптимизированы для определенных типов работ. Например, **Standard 3 High Density (S3 HD)** — это режим *хостинга* для S3, где базовое оборудование оптимизировано для большого количества меньших индексов и предназначено для сценариев с многотенантностью. S3 HD имеет тот же заряд за единицу, что и S3, но оборудование оптимизировано для быстрого чтения файлов на большом количестве меньших индексов.

**Оптимизированные** уровни хранения обеспечивают большую емкость по более низкой цене за ТБ, чем стандартные уровни. Основным компромиссом является более высокая задержка запроса, которую следует проверить для ваших конкретных требований к приложению.  Чтобы узнать больше о соображениях производительности этого уровня, [см.](search-performance-optimization.md)

Вы можете узнать больше о различных уровнях на [странице ценообразования,](https://azure.microsoft.com/pricing/details/search/)в [статье Службы когнитивного поиска](search-limits-quotas-capacity.md) и на странице портала при предоставлении услуги.

## <a name="billable-events"></a>Оплачиваемые события

Решение, построенное на Azure Cognitive Search, может понести расходы следующим образом:

+ Базовая стоимость обслуживания при минимальной конфигурации (создание службы)
+ Дополнительные затраты при масштабировании (добавить реплики или разделы)
+ Плата за пропускную способность (исходящие передачи данных) 
+ Когнитивный поиск (прикрепите когнитивные службы для обогащения ИИ, хранилище Azure для хранения знаний)

### <a name="service-costs"></a>Стоимость обслуживания

В отличие от виртуальных машин или других ресурсов, которые могут быть «приостановлены», чтобы избежать платежей, служба когнитивного поиска Azure всегда доступна на оборудовании, предназначенном для вашего исключительного использования. Таким образом, создание службы является плативным событием, которое начинается при создании службы и заканчивается при удалении службы. 

Минимальная плата является первым блоком поиска (одна реплика х одна раздельное соединение) по оплачиваемой ставке. Этот минимум фиксируется на весь срок службы, поскольку служба не может работать на что-либо меньшее, чем эта конфигурация. Помимо минимума, можно добавлять реплики и разделы независимо друг от друга. Инкрементное увеличение емкости за счет реплик и разделов увеличит ваш счет на основе следующей [формулы: (реплики x разделы x ставка)](#search-units), где ставка, которую вы взимаете, зависит от выбранного уровня цен.

При оценке стоимости поискового решения имейте в виду, что цены и емкость не являются линейными. (Удвоение емкости более чем удваивает стоимость.) Например, как работает формула, [см., как распределить реплики и разделы.](search-capacity-planning.md#how-to-allocate-replicas-and-partitions)

### <a name="bandwidth-charges"></a>Плата за пропускную способность

Использование [индексов когнитивного поиска Azure](search-indexer-overview.md) может повлиять на выставление счетов в зависимости от местоположения ваших служб. Вы можете полностью исключить сборы за выемку данных, если вы создаете службу когнитивного поиска Azure в том же регионе, что и данные. Вот некоторая информация со [страницы ценообразования пропускной способности:](https://azure.microsoft.com/pricing/details/bandwidth/)

+ Корпорация Майкрософт не взимает плату за входящие данные в какой-либо службе Azure или за исходящие данные из Azure Cognitive Search.
+ В многофункциональных решениях плата за передачу данных по проводу не взимается, когда все службы находятся в одном регионе.

Сборы применяются для исходящих данных, если службы находятся в разных регионах. Эти сборы на самом деле не являются частью вашего счета Azure Cognitive Search. Они упоминаются здесь, потому что если вы используете данные или индексы, обогащенные ИИ, для сбора данных из разных регионов, вы увидите затраты, отраженные в общем счете.

### <a name="ai-enrichment-with-cognitive-services"></a>Обогащение ИИ с помощью когнитивных услуг

Для [обогащения ИИ](cognitive-search-concept-intro.md)следует [запланировать присоединение платного ресурса Cognitive Services Azure](cognitive-search-attach-cognitive-services.md)в том же регионе, что и Azure Cognitive Search, в уровне ценообразования S0 для обработки с оплатой по мере использования. Нет фиксированных затрат, связанных с присоединением когнитивных служб. Вы платите только за необходимую обработку.

| Операция | Принцип выставления счетов |
|-----------|----------------|
| Растрескивание документов, извлечение текста | Free |
| Растрескивание документов, извлечение изображений | Счет в соответствии с количеством изображений, извлеченных из ваших документов. В [конфигурации индекса](https://docs.microsoft.com/rest/api/searchservice/create-indexer#indexer-parameters) **imageAction** — это параметр, который запускает извлечение изображения. Если **imageAction** настроен на "нет" (по умолчанию), вы не будете платить за извлечение изображения. Ставка для извлечения изображений задокументирована на странице [ценовых данных](https://azure.microsoft.com/pricing/details/search/) для Azure Cognitive Search.|
| [Встроенные когнитивные навыки](cognitive-search-predefined-skills.md) | Счет выставлен с той же скоростью, как если бы вы выполнили задачу с помощью когнитивных служб напрямую. |
| Пользовательские навыки | Пользовательский навык — это функциональность, которая предоставляется. Стоимость использования пользовательского навыка полностью зависит от того, вызывает ли пользовательский код другие дозированные службы. |

<a name="search-units"></a>

## <a name="billing-formula-r-x-p--su"></a>Формула выставления счетов (R x P и SU)

Наиболее важной концепцией выставления счетов для операций Azure Cognitive Search является *поисковое подразделение* (SU). Поскольку Azure Cognitive Search зависит как от реплик, так и от разделов для индексации и запросов, не имеет смысла выставлять счета одним или другим. Вместо этого выставление счетов основано на всех частях.

SU является продуктом реплик и *перегородок,* *используемых* службой: **(R x P и SU)**.

Каждая служба имеет как минимум одну единицу поиска (одна реплика, умноженная на одну секцию). Максимум для любой услуги 36 SUs. Этот максимум может быть достигнут несколькими способами: 6 разделов x 6 реплик, или 3 раздела x 12 реплик, например. Обычно используется меньше, чем общая емкость (например, 3-реплика, 3-раздел службы выставлен счет как 9 SUs). Ознакомьтесь с [диаграммой комбинаций разделов и реплик](search-capacity-planning.md#chart) для допустимых комбинаций.

Ставка выставления счетов почасовая посУ. Каждый уровень имеет постепенно более высокую скорость. Более высокие уровни поставляются с более крупными и более быстрыми перегородками, и это способствует общей более высокой почасовой ставке для этого уровня. Вы можете просмотреть тарифы для каждого уровня на странице [ценовых деталей.](https://azure.microsoft.com/pricing/details/search/)

Большинство клиентов используют часть полной емкости в сети, удерживая остальные ресурсы в резерве. Для выставления счетов количество перегородок и реплик, которые вы приносите в Интернете, рассчитывается по формуле SU, определяет, что вы платите на почасовой основе.

## <a name="how-to-manage-costs"></a>Как управлять затратами

Следующие предложения могут помочь вам свести расходы на минимальное:

- Создайте все ресурсы в одном регионе или в как можно меньшем числе регионов, чтобы свести к минимуму или устранить расходы на пропускную способность.

- Консолидировать все службы в одну группу ресурсов, такие как Azure Cognitive Search, Cognitive Services и любые другие службы Azure, используемые в вашем решении. На портале Azure найдите группу ресурсов и воспользуйтесь командами **управления затратами** для получения информации о фактических и прогнозируемых расходах.

- Рассмотрим Web App Azure для переднего приложения, чтобы запросы и ответы оставались в пределах границы центра обработки данных.

- Масштабируйте для ресурсоемких операций, таких как индексация, а затем спотыкайся вниз для регулярных рабочих нагрузок запроса. Начните с минимальной конфигурации для Azure Cognitive Search (один SU, состоящий из одной разделительки и одной реплики), а затем проследите активность пользователя для определения шаблонов использования, которые указывают на необходимость увеличения емкости. При наличии предсказуемого шаблона можно синхронизировать масштаб с активностью (для автоматизации необходимо написать код).

Кроме того, посетите [Биллинг и управление затратами](https://docs.microsoft.com/azure/billing/billing-getting-started) для встроенных инструментов и функций, связанных с расходами.

Закрытие поисковой службы на временной основе невозможно. Выделенные ресурсы всегда работают, выделяются для исключительного использования на протяжении всего срока службы. Удаление службы является постоянным, а также удаляет связанные с ней данные.

С точки зрения самой службы, единственный способ снизить ваш счет заключается в сокращении реплик и перегородок до уровня, который по-прежнему обеспечивает приемлемую производительность и [соответствие SLA](https://azure.microsoft.com/support/legal/sla/search/v1_0/), или создать службу на более низком уровне (S1 почасовые ставки ниже, чем S2 или S3 ставки). Предполагая, что вы предоставляете услугу в нижнем конце ваших прогнозов нагрузки, если вы перерастете службу, вы можете создать вторую услугу большего уровня, восстановить индексы на второй службе, а затем удалить первый.

## <a name="how-to-evaluate-capacity-requirements"></a>Как оценить требования к емкости

В Azure Cognitive Search емкость структурирована как реплики и *разделы.* *partitions*

+ Реплики являются экземплярами поисковой службы. Каждая реплика содержит одну сбалансированную с нагрузкой копию индекса. Например, служба с шестью репликами имеет шесть копий каждого индекса, загруженного в службу.

+ Разделы хранят индексы и автоматически делят данные, пригодные для поиска. Два раздела делят индекс пополам, три раздела делят его на третьи и так далее. С точки зрения емкости *размер раздела* является основной функцией дифференциации между уровнями.

> [!NOTE]
> Все стандартные и складские оптимизированные уровни поддерживают [гибкие комбинации реплик и перегородок,](search-capacity-planning.md#chart) чтобы [оптимизировать систему для скорости или хранения,](search-performance-optimization.md) изменив баланс. Базовый уровень предлагает до трех реплик для высокой доступности, но имеет только одну раздел. Бесплатные уровни не предоставляют выделенных ресурсов: вычислительные ресурсы используются несколькими подписчиками.


### <a name="evaluating-capacity"></a>Оценка емкости

Емкость и затраты на запуск службы идут рука об руку. Уровни накладывают ограничения на два уровня: хранение и ресурсы. Вы должны думать о обоих, потому что какой бы предел вы достигнете первого является эффективным пределом.

Бизнес-требования обычно диктуют количество необходимых индексов. Например, для большого репозитория документов может потребоваться глобальный индекс. Или вам может понадобиться несколько индексов, основанных на регионе, приложении или нише бизнеса.

Чтобы определить размер индекса, необходимо [создать его](search-create-index-portal.md). Его размер будет основываться на импортируемых данных и конфигурации индекса, например, позволяете ли вы предлагать, фильтровать и сортировать. Для получения дополнительной информации о воздействии конфигурации на размер [см. ](search-what-is-an-index.md)

Для полного поиска текста основная структура данных представляет собой [перевернутую](https://en.wikipedia.org/wiki/Inverted_index) структуру индекса, которая имеет иные характеристики, чем исходные данные. Для перевернутого индекса размер и сложность определяются содержанием, а не обязательно объемом данных, которые вы в него ввожете. Большой источник данных с высокой избыточностью может привести к меньшему индексу, чем меньший набор данных, содержащий высокое содержание. Таким образом, редко можно сделать вывод о размере индекса в зависимости от размера исходного набора данных.

> [!NOTE] 
> Несмотря на то, что оценка будущих потребностей в индексах и хранении может быть похожа на догадки, это стоит сделать. Если емкость уровня окажется слишком низкой, необходимо предоставить новую услугу на более высоком уровне, а затем [перезагрузить индексы.](search-howto-reindex.md) Там нет на месте обновления службы от одного SKU к другому.
>

### <a name="estimate-with-the-free-tier"></a>Оценка с бесплатным уровнем

Один из способов оценки емкости — начать с бесплатного уровня. Помните, что Бесплатный сервис предлагает до трех индексов, 50 МБ памяти и 2 минуты времени индексации. Оценить прогнозируемый размер индекса с помощью этих ограничений может быть сложно, но это следующие шаги:

+ [Создайте бесплатный сервис.](search-create-service-portal.md)
+ Подготовьте небольшой репрезентативный набор данных.
+ [Создайте начальный индекс на портале](search-create-index-portal.md) и обратите внимание на его размер. Функции и атрибуты влияют на хранение. Например, добавление предложить (typeahead) увеличит требования к хранению. Используя один и тот же набор данных, можно попробовать создать несколько версий индекса с различными атрибутами на каждом поле, чтобы увидеть, как различаются требования к хранению. Для получения дополнительной информации [см.](search-what-is-an-index.md#index-size)

При грубой оценке в руках, вы можете удвоить эту сумму в бюджет для двух индексов (разработка и производство), а затем выбрать свой уровень соответственно.

### <a name="estimate-with-a-billable-tier"></a>Оценка с помощью оплачиваемого уровня

Выделенные ресурсы могут учитывать большее время выборки и обработки для более реалистичных оценок количества, размера и объемов запросов во время разработки. Некоторые клиенты прыгают прямо с оплачиваемым уровнем, а затем переоценивают по мере развития проекта созревает.

1. [Обзор службы ограничения на каждом уровне,](https://docs.microsoft.com/azure/search/search-limits-quotas-capacity#index-limits) чтобы определить, нижние уровни могут поддерживать количество индексов вам нужно. На уровне базовых, S1 и S2 лимиты индексов составляют 15, 50 и 200 соответственно. Оптимизированный уровень хранения имеет ограничение в 10 индексов, поскольку он предназначен для поддержки низкого числа очень больших индексов.

1. [Создайте службу на платном уровне](search-create-service-portal.md):

    + Начните с низкого, на Basic или S1, если вы не уверены в прогнозируемой нагрузке.
    + Начните с высоты, на S2 или даже S3, если вы знаете, что вы собираетесь иметь крупномасштабные индексы и запросы нагрузки.
    + Начните с оптимизации хранилища, с L1 или L2, если вы индексируете большой объем данных, и нагрузка на запрос относительно низка, как и в случае внутреннего бизнес-приложения.

1. [Создайте начальный индекс](search-create-index-portal.md), чтобы определить, как исходные данные преобразуются в индекс. Это единственный способ оценки размера индекса.

1. [Отслеживайте хранилище, ограничения служб, объем запросов и задержку](search-monitor-usage.md) в портале. Портал показывает запросы в секунду, задушенные запросы и задержку поиска. Все эти значения могут помочь вам решить, выбрали ли вы правильный уровень. 

Значение и размер индекса одинаково важны для анализа. Это объясняется тем, что максимальные пределы достигаются за счет полного использования хранилища (разделов) или максимальных ограничений на ресурсы (индексы, индексы и т.д.), в зависимости от того, что наступит ра-таке. Портал помогает отслеживать и то, и другое, показывая текущее использование и максимальные ограничения на странице "Обзор".

> [!NOTE]
> Требования к хранению могут быть завышены, если документы содержат посторонние данные. В идеале документы содержат только те данные, которые необходимы для поиска. Двоичные данные не могут быть поискаи и должны храниться отдельно (возможно, в таблице Azure или хранилище капли). Затем в индекс следует добавить поле для удержания ссылки на внешние данные. Максимальный размер отдельного документа составляет 16 МБ (или меньше, если вы навалом загружаете несколько документов в одном запросе). Для получения дополнительной информации смотрите [ограничения службы в Azure Cognitive Search](search-limits-quotas-capacity.md).
>

**Рекомендации по объему запросов**

Запросы в секунду (КПС) являются важной метрикой при настройке производительности, но, как правило, это только рассмотрение уровня, если вы ожидаете высокий объем запроса в начале.

Стандартные уровни могут обеспечить баланс реплик и перегородок. Можно увеличить оборот запроса, добавив реплики для балансировки нагрузки или добавить разделы для параллельной обработки. Затем можно настроиться на производительность после предоставления услуги.

Если с самого начала ожидается высокий объем устойчивых запросов, следует учитывать более высокие уровни Стандартных уровней, поддерживаемые более мощным оборудованием. Затем можно взять разделы и реплики в автономном режиме или даже переключиться на службу более низкого уровня, если эти объемы запросов не происходят. Для получения дополнительной информации о том, [Azure Cognitive Search performance and optimization](search-performance-optimization.md)как рассчитать пропускную способность запроса, см.

Оптимизированные уровни хранения данных полезны для больших рабочих нагрузок данных, поддерживая более общее доступное хранилище индексов для того, когда требования к задержкам запроса менее важны. Вы все равно должны использовать дополнительные реплики для балансировки нагрузки и дополнительные разделы для параллельной обработки. Затем можно настроиться на производительность после предоставления услуги.

**Соглашения на уровне обслуживания**

Функции бесплатного уровня и предварительного просмотра не предоставляют [соглашений об уровне обслуживания (SLAs).](https://azure.microsoft.com/support/legal/sla/search/v1_0/) Для всех оплачиваемых уровней соглашения об уровне обслуживания вступают в силу, если для службы обеспечена достаточная избыточность. Вы должны иметь две или более реплик для запроса (читай) SLAs. Необходимо иметь три или более реплик для запроса и индексации (читай-написать) SLAs. Количество перегородок не влияет на SLAs.

## <a name="tips-for-tier-evaluation"></a>Советы по оценке уровня

+ Разрешить метрики для построения вокруг запросов, и собирать данные о шаблонах использования (запросы в рабочее время, индексация в непиковые часы). Используйте эти данные для информирования о решениях по предоставлению услуг. Хотя это и не практично при почасовой или ежедневной каденции, можно динамически настроить разделы и ресурсы для размещения запланированных изменений в объемах запросов. Вы также можете разместить незапланированные, но устойчивые изменения, если уровни держатся достаточно долго, чтобы оправдать принятие мер.

+ Помните, что единственным недостатком недостаточного обслуживания является то, что вам, возможно, придется снести службу, если фактические требования больше, чем ваши прогнозы. Чтобы избежать сбоев в обслуживании, необходимо создать новую службу на более высоком уровне и запустить ее бок о бок до тех пор, пока все приложения и запросы не нацелится на новую конечную точку.

## <a name="next-steps"></a>Дальнейшие действия

Начните с свободного уровня и создайте начальный индекс, используя подмножество данных, чтобы понять его характеристики. Структура данных в Azure Cognitive Search является перевернутой структурой индекса. Размер и сложность перевернутого индекса определяются содержанием. Помните, что высокоизбыточное содержимое имеет тенденцию приводить к созданию индекса меньшего объема, чем более неоднородное содержимое. Таким образом, характеристики содержимого, а не размер набора данных определяют требования к хранению индексов.

После первоначальной оценки размера индекса [направьте платежную услугу](search-create-service-portal.md) на один из уровней, обсуждаемых в этой статье: Basic, Standard или Storage Optimized. Расслабьте любые искусственные ограничения на размер данных и [перестроить индекс,](search-howto-reindex.md) чтобы включить все данные, которые вы хотите быть поиска.

[Выделите секции и реплики](search-capacity-planning.md) по мере необходимости, чтобы получить требуемую производительность и масштабирование.

Если производительность и емкость в порядке, вы сделали. В противном случае повторно создайте службу поиска на другом уровне, более точно соответствующем вашим потребностям.

> [!NOTE]
> Если у вас есть вопросы, разместите сообщение в [службу поддержки StackOverflow](https://stackoverflow.com/questions/tagged/azure-search) или [обратитесь в службу поддержки Azure.](https://azure.microsoft.com/support/options/)
