---
title: Создание средства подбора
titleSuffix: Azure Cognitive Search
description: Включите действия запроса типа вперед в Azure Cognitive Search, создавая предложители и формулируя запросы, которые ссылают сядебные или автопредлагаемые термины запроса.
manager: nitinme
author: HeidiSteen
ms.author: heidist
ms.service: cognitive-search
ms.topic: conceptual
ms.date: 04/10/2020
ms.openlocfilehash: a6c4051a5b3d557f9ac2927a62492425e7636c0d
ms.sourcegitcommit: fb23286d4769442631079c7ed5da1ed14afdd5fc
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/10/2020
ms.locfileid: "81113481"
---
# <a name="create-a-suggester-to-enable-autocomplete-and-suggestions-in-azure-cognitive-search"></a>Создание подсказчика для автоматического заполнения и предложений в Azure Cognitive Search

В Azure Cognitive Search функциональность "поиск по типу" или typeahead основана на конструкции **отсылки,** которую вы добавляете к [индексу поиска.](search-what-is-an-index.md) Suggester поддерживает два варианта поиска по мере вас типа: *автозаполнение,* которое завершает термин или фразу, которую вы вводите, и *предложения,* которые возвращают короткий список соответствующих документов.  

Следующий скриншот из первого приложения в образце [Си-Ке](tutorial-csharp-type-ahead-and-suggestions.md) иллюстрирует оба опыта. Autocomplete предвидит, что пользователь может ввести, заканчивая "tw" с "в" в качестве потенциального термина поиска. Предложения являются фактическими результатами поиска, каждый из которых представляет соответствующий документ. Для предложений можно вывести любую часть документа, которая лучше всего описывает результат. В этом примере предложения представлены полем имени отеля.

![Визуальное сравнение автозаполнения и предлагаемых запросов](./media/index-add-suggesters/hotel-app-suggestions-autocomplete.png "Визуальное сравнение автозаполнения и предлагаемых запросов")

Для реализации этих функций в Azure Cognitive Search существует компонент индекса и запроса. 

+ В индексе добавьте подсыплятеля к индексу. Вы можете использовать портал, [REST API](https://docs.microsoft.com/rest/api/searchservice/create-index)или [.NET SDK](https://docs.microsoft.com/dotnet/api/microsoft.azure.search.models.suggester?view=azure-dotnet). Остальная часть этой статьи сосредоточена на создании подсобного предложения.

+ В запросе запроса позвоните в один из [AIS, перечисленных ниже.](#how-to-use-a-suggester)

Поддержка поиска по типу включена на основе на полевых условиях. Вы можете реализовать оба поведения typeahead в одном и том же решении поиска, если вы хотите опыт, аналогичный тому, который указан на скриншоте. Оба запроса нацелены на сбор *документов* конкретного индекса, и ответы возвращаются после того, как пользователь предоставил по крайней мере три строки ввода символов.

## <a name="what-is-a-suggester"></a>Что такое подсобие?

Подсобитель — это структура данных, которая поддерживает поведение типа поиска по мере использования путем хранения префиксов для сопоставления по частичным запросам. Подобно токенизированным терминам, префиксы хранятся в перевернутых индексах, по одному для каждого поля, указанного в коллекции полей отосводного.

При создании префиксов, предложить имеет свою собственную цепочку анализа, похожую на тот, который используется для полного поиска текста. Однако, в отличие от анализа при полном текстовом поиске, предложить может использовать только предопределенные анализаторы (стандартные Lucene, [анализаторы языка](index-add-language-analyzers.md)или другие анализаторы в [заранее определенном списке анализаторов.](index-add-custom-analyzers.md#predefined-analyzers-reference) [Пользовательские анализаторы](index-add-custom-analyzers.md) и конфигурации специально запрещены, чтобы избежать случайных конфигураций, которые дают плохие результаты.

> [!NOTE]
> Если вам нужно обойти ограничение анализатора, используйте два отдельных поля для одного и того же содержимого. Это позволит одному из полей иметь предложить, в то время как другое может быть настроено с пользовательской конфигурацией анализатора.

## <a name="create-a-suggester"></a>Создание средства подбора

Хотя наводящий имеет несколько свойств, это в первую очередь коллекция полей, для которых вы позволяете typeahead опыт. Например, для приложения для путешествий необходимо включить упреждающий поиск по пунктам назначения, городам и достопримечательностям. Таким образом, все три поля будут идти в сбор полей.

Чтобы создать подсобие, добавьте его в схему индекса. Вы можете иметь один наводящий в индексе (в частности, один наводящий в коллекции предложить).

### <a name="when-to-create-a-suggester"></a>Когда создать наводящего

Лучшее время для создания подсобного предложения — это когда вы также создаете само определение поля.

Если вы попытаетесь создать предложить с помощью уже существующих полей, API запретит его. Текст Typeahead создается во время индексации, когда частичные термины в двух или более комбинациях символов токенизируются вместе с целыми терминами. Учитывая, что существующие поля уже токенизированы, вам придется перестроить индекс, если вы хотите добавить их в предложить. Для получения дополнительной информации о переиндексации [см.](search-howto-reindex.md)

### <a name="create-using-the-rest-api"></a>Создание с помощью REST API

В REST API добавьте предложить через [Создать индекс](https://docs.microsoft.com/rest/api/searchservice/create-index) или [индекс обновления](https://docs.microsoft.com/rest/api/searchservice/update-index). 

  ```json
  {
    "name": "hotels",
    "fields": [
      . . .
    ],
    "suggesters": [
      {
        "name": "sg",
        "searchMode": "analyzingInfixMatching",
        "sourceFields": ["hotelName", "category"]
      }
    ],
    "scoringProfiles": [
      . . .
    ]
  }
  ```

### <a name="create-using-the-net-sdk"></a>Создание с помощью .NET SDK

В C q определите [объект Suggester.](https://docs.microsoft.com/dotnet/api/microsoft.azure.search.models.suggester?view=azure-dotnet) `Suggesters`представляет собой коллекцию, но она может принимать только один элемент. 

```csharp
private static void CreateHotelsIndex(SearchServiceClient serviceClient)
{
    var definition = new Index()
    {
        Name = "hotels",
        Fields = FieldBuilder.BuildForType<Hotel>(),
        Suggesters = new List<Suggester>() {new Suggester()
            {
                Name = "sg",
                SourceFields = new string[] { "HotelId", "Category" }
            }}
    };

    serviceClient.Indexes.Create(definition);

}
```

### <a name="property-reference"></a>Справочные данные по свойствам

|Свойство      |Описание      |
|--------------|-----------------|
|`name`        |Имя средства подбора.|
|`searchMode`  |Стратегия, используемая для поиска фраз кандидата. В настоящее время поддерживается только режим `analyzingInfixMatching`, в рамках которого выполняется гибкий поиск совпадений в начале и середине фраз.|
|`sourceFields`|Список из одного или нескольких полей, которые служат источником содержимого для предложений. Поля должны быть `Edm.String` `Collection(Edm.String)`типа и . Если анализатор указан на поле, он должен быть названным анализатором из [этого списка](https://docs.microsoft.com/dotnet/api/microsoft.azure.search.models.analyzername?view=azure-dotnet) (не пользовательский анализатор).<p/>В качестве наилучшей практики укажите только те области, которые поддаются ожидаемому и соответствующему ответу, будь то завершенная строка в строке поиска или список выпадающих.<p/>Название отеля является хорошим кандидатом, потому что он имеет точность. Области verbose, такие как описания и комментарии, слишком плотны. Аналогичным образом, повторяющиеся поля, такие как категории и теги, менее эффективны. В примерах мы включаем "категорию" в любом случае, чтобы продемонстрировать, что вы можете включить несколько полей. |

<a name="how-to-use-a-suggester"></a>

## <a name="use-a-suggester-in-a-query"></a>Использование наводящего в запросе

После создания наводящего запроса позвоните в соответствующий API в логике запроса, чтобы вызвать функцию. 

+ [Предложения REST API](https://docs.microsoft.com/rest/api/searchservice/suggestions) 
+ [Автополный REST API](https://docs.microsoft.com/rest/api/searchservice/autocomplete) 
+ [Предложитьметодhttpсообщенияасасинки](https://docs.microsoft.com/dotnet/api/microsoft.azure.search.idocumentsoperations.suggestwithhttpmessagesasync?view=azure-dotnet)
+ [Метод AutocompleteWithMessagesasync](https://docs.microsoft.com/dotnet/api/microsoft.azure.search.idocumentsoperations.autocompletewithhttpmessagesasync?view=azure-dotnet&viewFallbackFrom=azure-dotnet)

Использование API иллюстрируется в следующем вызове на Autocomplete REST API. Есть два вынос из этого примера. Во-первых, как и во всех запросах, операция противоречит сбору документов индекса. Во-вторых, можно добавить параметры запроса. Хотя многие параметры запроса являются общими для обоих AA, список отличается для каждого из них.

```http
GET https://[service name].search.windows.net/indexes/[index name]/docs/autocomplete?[query parameters]  
api-key: [admin or query key]
```

Если в индексе не определен указатель, вызов к автозаполнению или предложениям не будет выполнен.

## <a name="sample-code"></a>Образец кода

+ [Создание первого приложения в](tutorial-csharp-type-ahead-and-suggestions.md) образце СЗ демонстрирует наводящую конструкцию, предлагаемые запросы, автозаполнение и граненые навигации. Этот образец кода работает на службе когнитивного поиска Azure и использует предварительно загруженный индекс Отелей, так что все, что вам нужно сделать, это нажать F5 для запуска приложения. Подписка или ввоза не требуется.

+ [DotNetHowToAutocomplete](https://github.com/Azure-Samples/search-dotnet-getting-started/tree/master/DotNetHowToAutocomplete) — это старый образец, содержащий код как на C-е, так и на Java. Он также демонстрирует предполагаемое строительство, предлагаемые запросы, автозаполнение и граненую навигацию. В этом примере кода используются размещенные данные образца [NYCJobs.](https://github.com/Azure-Samples/search-dotnet-asp-net-mvc-jobs) 


## <a name="next-steps"></a>Дальнейшие действия

Мы рекомендуем следующий пример, чтобы увидеть, как формулируются запросы.

> [!div class="nextstepaction"]
> [Предложения и примеры автозаполнения](search-autocomplete-tutorial.md) 
