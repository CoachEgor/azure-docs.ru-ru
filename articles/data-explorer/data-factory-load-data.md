---
title: Копирование данных из фабрики данных Azure в Azure обозреватель данных
description: В этом разделе вы узнаете, как принять (загрузить) данные в Azure обозреватель данных с помощью средства копирования фабрики данных Azure.
services: data-explorer
author: orspod
ms.author: orspodek
ms.reviewer: jasonh
ms.service: data-explorer
ms.topic: conceptual
ms.date: 04/15/2019
ms.openlocfilehash: 5eb05df7ed97839ef80798a752565234d180f0e2
ms.sourcegitcommit: 263a69b70949099457620037c988dc590d7c7854
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/25/2019
ms.locfileid: "71268825"
---
# <a name="copy-data-to-azure-data-explorer-using-azure-data-factory"></a>Копирование данных в Azure обозреватель данных с помощью фабрики данных Azure 

Azure обозреватель данных — это быстрая, полностью управляемая служба аналитики данных для анализа больших объемов потоковых данных из различных источников, таких как приложения, веб-сайты и устройства IoT. Итеративное изучение данных и выявление шаблонов и аномалий для улучшения продуктов, улучшения взаимодействия с клиентами, мониторинга устройств и повышения эффективности операций. Исследуйте новые вопросы и получайте ответы на них за считаные минуты. Фабрика данных Azure — это полностью управляемая облачная служба интеграции данных. Вы можете использовать службу, чтобы заполнить базу данных Azure обозреватель данных данными из существующей системы и сэкономить время при создании решений аналитики.

Фабрика данных Azure предоставляет следующие преимущества для загрузки данных в обозреватель данных Azure:

* **Простота настройки**: Интуитивно понятный мастер с пятью шагами без необходимости написания сценариев.
* **Поддержка расширенного хранилища данных**: Встроенная поддержка широкого набора локальных и облачных хранилищ данных. Подробный список см. в таблице [Поддерживаемые хранилища данных и форматы](/azure/data-factory/copy-activity-overview#supported-data-stores-and-formats).
* **Безопасность и соответствие требованиям**: Данные передаются по протоколу HTTPS или ExpressRoute. Наличие глобальной службы гарантирует, что ваши данные никогда не покинут заданных географических границ.
* **Высокая производительность**. Скорость загрузки данных до 1 ГБ/с в Azure обозреватель данных. Дополнительные сведения см. в руководстве [по настройке производительности действия копирования](/azure/data-factory/copy-activity-performance).

В этой статье показано, как использовать средство Копирование данных фабрики данных для загрузки данных из Amazon S3 в Azure обозреватель данных. Вы можете выполнить аналогичные действия, чтобы скопировать данные из других хранилищ данных, таких как [хранилище BLOB-объектов Azure](/azure/data-factory/connector-azure-blob-storage), [база данных SQL](/azure/data-factory/connector-azure-sql-database)Azure, [хранилище данных SQL Azure](/azure/data-factory/connector-azure-sql-data-warehouse), [Google BigQuery](/azure/data-factory/connector-google-bigquery),[Oracle](/azure/data-factory/connector-oracle)и [Файловая система](/azure/data-factory/connector-file-system).

## <a name="prerequisites"></a>Предварительные требования

* Если у вас еще нет подписки Azure, создайте [бесплатную учетную запись](https://azure.microsoft.com/free/) Azure, прежде чем начинать работу.
* [Кластер и база данных Azure обозреватель данных](create-cluster-database-portal.md)
* Источник данных.

## <a name="create-a-data-factory"></a>Создание фабрики данных

1. Нажмите кнопку **создать ресурс** (+) в левом верхнем углу портала > **Analytics** > **data Factory**.

   ![Создание фабрики данных](media/data-factory-load-data/create-adf.png)

1. На странице **Новая фабрика данных** укажите значения для следующих полей, а затем нажмите кнопку **создать**.

    ![Страница "Новая фабрика данных"](media/data-factory-load-data/my-new-data-factory.png)

    **Параметр**  | **Описание поля**
    |---|---|
    | **Name** | Введите глобально уникальное имя фабрики данных. Если появляется сообщение об ошибке *" \"имя фабрики\" данных лоададксдемо недоступно"* , введите другое имя для фабрики данных. Правила именования артефактов фабрики данных см. в разделе [правила именования фабрики данных](/azure/data-factory/naming-rules).|
    | **подписка** | Выберите подписку Azure, в рамках которой нужно создать фабрику данных. |
    | **Группа ресурсов** | Выберите **создать** и введите имя новой группы ресурсов. Если у вас уже есть группа ресурсов, выберите **использовать существующий**. |
    | **Версия** | Выберите **V2**. |
    | **Location** | Укажите расположение фабрики данных. В раскрывающемся списке отображаются только поддерживаемые расположения. Хранилища данных, используемые фабрикой данных, могут находиться в других расположениях или регионах. |
    | | |

1. На панели инструментов выберите уведомления, чтобы отслеживать процесс создания. После завершения создания перейдите к созданной фабрике данных. Откроется домашняя страница **фабрики данных** .

   ![Домашняя страница фабрики данных](media/data-factory-load-data/data-factory-home-page.png)

1. Щелкните плитку " **автор & монитор** ", чтобы запустить приложение на отдельной вкладке.

## <a name="load-data-into-azure-data-explorer"></a>Загрузка данных в Azure обозреватель данных

Данные можно загружать из различных типов [хранилищ данных](/azure/data-factory/copy-activity-overview#supported-data-stores-and-formats) в Azure обозреватель данных. В этом разделе описывается загрузка данных из Amazon S3.

Существует два способа загрузки данных в Azure обозреватель данных с помощью фабрики данных Azure.

* Пользовательский интерфейс фабрики данных Azure — [вкладка « **Автор** »](/azure/data-factory/quickstart-create-data-factory-portal#create-a-data-factory)
* [Средство **копирование данных** фабрики данных Azure](/azure/data-factory/quickstart-create-data-factory-copy-data-tool) , используемое в этой статье.

### <a name="copy-data-from-amazon-s3-source"></a>Копирование данных из Amazon S3 (источник)

1. На странице Приступая к **работе** выберите плитку **копирование данных** , чтобы запустить средство копирование данных.

   ![Плитка копирования данных](media/data-factory-load-data/copy-data-tool-tile.png)

1. На странице **Свойства** укажите **имя задачи** и нажмите кнопку **Далее**.

    ![Копирование из свойств источника](media/data-factory-load-data/copy-from-source.png)

1. На странице **исходное хранилище данных** щелкните **+ создать новое соединение**.

    ![Создание подключения для исходных данных](media/data-factory-load-data/source-create-connection.png)

1. Выберите **Amazon S3**и нажмите кнопку **продолжить** .

    ![Новая связанная служба](media/data-factory-load-data/amazons3-select-new-linked-service.png)

1. На странице **Новая связанная служба (Amazon S3)** выполните следующие действия.

    ![Указание связанной службы Amazon S3](media/data-factory-load-data/amazons3-new-linked-service-properties.png)

    * Укажите **имя** новой связанной службы.
    * В раскрывающемся списке выберите **подключиться через значение среды выполнения интеграции** .
    * Укажите **идентификатор ключа доступа**.
    * Укажите **секретный ключ доступа**.
    * Выберите **проверить подключение** , чтобы проверить созданное соединение связанной службы.
    * Выберите **Готово**.
    
    > [!NOTE]
    > В Amazon S3 выберите имя пользователя Amazon на панели навигации, а затем выберите **Мои учетные данные безопасности** , чтобы указать **ключ доступа**. 

1. На странице **исходного хранилища данных** вы увидите новое подключение AmazonS31. Щелкните **Далее**.

   ![Подключение к исходному хранилищу данных создано](media/data-factory-load-data/source-data-store-created-connection.png)

1. На странице **Выбор входного файла или папки** :

    1. Перейдите к папке или файлу, которые необходимо скопировать. Выберите папку или файл.
    1. Выберите нужное поведение при копировании. Не проверять **двоичное копирование** .
    1. Щелкните **Далее**.

    ![Выбор файла или папки входных данных](media/data-factory-load-data/source-choose-input-file.png)

1. На странице **параметры форматов файлов** выберите соответствующие параметры для файла и нажмите кнопку **Далее**.

   ![Выбор файла или папки входных данных](media/data-factory-load-data/source-file-format-settings.png)

### <a name="copy-data-into-azure-data-explorer-destination"></a>Копирование данных в обозреватель данных Azure (назначение)

В Azure обозреватель данных создана связанная служба для копирования данных в целевую таблицу обозреватель данных Azure (приемник), указанную ниже.

#### <a name="create-the-azure-data-explorer-linked-service"></a>Создание связанной службы Azure обозреватель данных

1. На странице **целевое хранилище данных** можно использовать существующее подключение к хранилищу данных или указать новое хранилище данных, щелкнув **+ создать новое соединение**.

    ![Страница целевого хранилища данных](media/data-factory-load-data/destination-create-connection.png)

1. На странице **Новая связанная служба** выберите **Azure обозреватель данных**и нажмите кнопку **продолжить** .

    ![Выбор обозреватель данных Azure — новая связанная служба](media/data-factory-load-data/adx-select-new-linked-service.png)

1. На странице **Новая связанная служба (Azure обозреватель данных)** выполните следующие действия.

    ![Новая связанная служба ADX](media/data-factory-load-data/adx-new-linked-service.png)

   * Выберите **имя** для связанной службы Azure обозреватель данных.
   * В **методе выбора учетной записи**: 
        * Выберите переключатель **из подписки Azure** и выберите свою учетную запись **подписки Azure** . Затем выберите свой **кластер**. Обратите внимание, что в раскрывающемся списке будут перечислены только те кластеры, которые принадлежат пользователю.
        * Кроме того, можно нажать кнопку **ввести переключатель вручную** и ввести **конечную точку**.
    * Укажите **клиент**.
    * Введите **идентификатор субъекта-службы**.
    * Нажмите кнопку **ключ субъекта-службы** и введите **ключ субъекта-службы**.
    * Выберите свою **базу данных** в раскрывающемся меню. Кроме того, можно установить флажок **изменить** и ввести имя базы данных.
    * Выберите **проверить подключение** , чтобы проверить созданное соединение связанной службы. Если вы можете подключиться к программе установки, появится зеленая галочка **успешное подключение** .
    * Нажмите кнопку **Готово** , чтобы завершить создание связанной службы.

    > [!NOTE]
    > Этот субъект-служба используется фабрикой данных Azure для доступа к службе обозреватель данных Azure. В качестве субъекта-службы [Создайте субъект-службу Azure Active Directory (Azure AD)](/azure-stack/operator/azure-stack-create-service-principals#manage-an-azure-ad-service-principal). Не используйте метод **Azure Key Vault** .

#### <a name="configure-the-azure-data-explorer-data-connection"></a>Настройка подключения к данным Azure обозреватель данных

1. Откроется **целевое хранилище данных** . Созданное подключение к данным Azure обозреватель данных доступно для использования. Нажмите кнопку **Далее** , чтобы настроить подключение.

    ![Целевое хранилище данных ADX](media/data-factory-load-data/destination-data-store.png)

1. В поле **Сопоставление таблиц**задайте имя целевой таблицы и нажмите кнопку **Далее**.

    ![Сопоставление таблицы целевых наборов данных](media/data-factory-load-data/destination-dataset-table-mapping.png)

1. На странице **сопоставление столбцов** выполните следующие действия.
    * Первое сопоставление выполняется модулем ADF в соответствии с [сопоставлением схемы ADF](/azure/data-factory/copy-activity-schema-and-type-mapping)
        * Задайте **сопоставления столбцов** для целевой таблицы фабрики данных Azure. Сопоставление по умолчанию отображается из источника в целевую таблицу ADF.
        * Отмените выбор столбцов, для которых не нужно определять сопоставление столбцов.
    * Второе сопоставление происходит, когда эти табличные данные принимаются в Azure обозреватель данных. Сопоставление выполняется в соответствии с [правилами сопоставления CSV](/azure/kusto/management/mappings#csv-mapping). Обратите внимание, что даже если исходные данные не были в формате CSV, ADF преобразует их в табличный формат, поэтому сопоставление CSV является единственным релевантным сопоставлением на этом этапе.
        * В разделе **Свойства приемника Azure обозреватель данных (Kusto)** добавьте соответствующее **имя сопоставления приема** (необязательно), чтобы можно было использовать сопоставление столбцов.
        * Если **имя сопоставления приема** не указано, будет использоваться порядок сопоставления "по имени", определенный в разделе **сопоставления столбцов** . Если сопоставление по имени завершается неудачей, Azure обозреватель данных попытается принять данные в порядке "по столбцу" (сопоставление по умолчанию выполняется по положению).
    * Щелкните **Далее**.

    ![Сопоставление столбцов целевого набора данных](media/data-factory-load-data/destination-dataset-column-mapping.png)

1. На странице **Параметры** :
    * Задайте соответствующие **параметры отказоустойчивости**.
    * **Параметры производительности**: Включение промежуточного хранения не применяется. **Дополнительные параметры** включают в себя вопросы затрат. Оставьте как есть, если какие-либо конкретные потребности отсутствуют.
    * Щелкните **Далее**.

    ![Копирование параметров данных](media/data-factory-load-data/copy-data-settings.png)

1. На странице **Сводка**проверьте параметры и нажмите кнопку **Далее**.

    ![Копировать сводку данных](media/data-factory-load-data/copy-data-summary.png)

1. На **странице Развертывание**:
    * Выберите **монитор** , чтобы перейти на вкладку **монитор** и просмотреть состояние конвейера (ход выполнения, ошибки и поток данных).
    * Выберите **изменить конвейер** , чтобы изменить связанные службы, наборы данных и конвейеры.
    * Нажмите кнопку **"Готово"** для завершения задачи копирования данных

    ![Страница развертывания](media/data-factory-load-data/deployment.png)

## <a name="next-steps"></a>Следующие шаги

* Сведения о [соединителе azure обозреватель данных](/azure/data-factory/connector-azure-data-explorer) в фабрике данных Azure.

* Дополнительные сведения об изменении связанных служб, наборов данных и конвейеров в [пользовательском интерфейсе фабрики данных](/azure/data-factory/quickstart-create-data-factory-portal).

* Дополнительные сведения о запросах [Обозреватель данных Azure](/azure/data-explorer/web-query-data) для запросов к данным.
