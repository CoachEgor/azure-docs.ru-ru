---
title: Использование шаблона фабрики данных Azure для выполнения операций копирования из базы данных в Azure обозреватель данных
description: В этом разделе вы узнаете, как использовать шаблон фабрики данных Azure для выполнения операций копирования из базы данных в Azure обозреватель данных
services: data-explorer
author: orspod
ms.author: orspodek
ms.reviewer: tzgitlin
ms.service: data-explorer
ms.topic: conceptual
ms.date: 09/08/2019
ms.openlocfilehash: acfcee6e8308bc508bd709c40bd1794beab3130f
ms.sourcegitcommit: 95b180c92673507ccaa06f5d4afe9568b38a92fb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/08/2019
ms.locfileid: "70804734"
---
# <a name="use-azure-data-factory-template-for-bulk-copy-from-database-to-azure-data-explorer"></a>Использование шаблона фабрики данных Azure для выполнения операций копирования из базы данных в Azure обозреватель данных

Azure обозреватель данных — это быстрая, полностью управляемая служба аналитики данных для анализа больших объемов потоковых данных из различных источников, таких как приложения, веб-сайты и устройства IoT. Фабрика данных Azure — это полностью управляемая облачная служба интеграции данных. Вы можете использовать службу фабрики данных Azure, чтобы заполнить базу данных Azure обозреватель данных данными из существующей системы и сэкономить время при создании решений аналитики. 

[Шаблоны фабрики данных Azure](/azure/data-factory/solution-templates-introduction) — это предопределенные конвейеры фабрики данных Azure, которые позволяют быстро приступить к работе с фабрикой данных и сократить время разработки для создания проектов интеграции данных. Шаблон " **групповое копирование из базы данных в Azure обозреватель данных** " создается с помощью операций **поиска** и **foreach** . Шаблон можно использовать для создания нескольких конвейеров на базу данных или таблицу для ускорения копирования данных. 

> [!IMPORTANT]
> * Используйте шаблон " **групповое копирование из базы данных в Azure обозреватель данных** " для копирования больших объемов данных из баз данных, таких как SQL Server и Google BigQuery, в Azure обозреватель данных. 
> * Используйте [средство копирования](data-factory-load-data.md) , чтобы скопировать несколько таблиц с небольшими или средними объемами данных в обозреватель данных Azure. 

## <a name="prerequisites"></a>Предварительные требования

* Если у вас еще нет подписки Azure, создайте [бесплатную учетную запись](https://azure.microsoft.com/free/) Azure, прежде чем начинать работу.
* [Кластер и база данных Azure обозреватель данных](create-cluster-database-portal.md)
* [Создание фабрики данных](data-factory-load-data.md#create-a-data-factory)
* Источник данных в базе данных

## <a name="create-controltabledataset"></a>Создание Контролтабледатасет

**Контролтабледатасет** указывает, какие данные будут скопированы из источника в место назначения в конвейере. Число строк указывает общее число конвейеров, необходимых для копирования данных. **Контролтабледатасет** должен быть определен как часть базы данных источника.

Пример формата исходной таблицы SQL Server:
    
    ```sql   
    CREATE TABLE control_table (
        PartitionId int,
        SourceQuery varchar(255),
        ADXTableName varchar(255)
    );
    ```
    
        |Свойство  |Описание  | Пример
        |---------|---------| ---------|
        |PartitionId   |   Порядок копирования | 1  |  
        |саурцекуери   |   запрос, указывающий, какие данные будут скопированы во время выполнения конвейера | <br>`select * from table where lastmodifiedtime  LastModifytime >= ''2015-01-01 00:00:00''>` </br>    
        |адкстабленаме  |  имя целевой таблицы | мядкстабле       |  

Если **контролтабледатасет** имеет другой формат, создайте сравнимый **контролтабледатасет** для вашего формата.

## <a name="use-bulk-copy-from-database-to-azure-data-explorer-template"></a>Использование операции копирования из базы данных в шаблон обозреватель данных Azure

1. На странице Приступая к **работе** выберите элемент **создать конвейер из плитки шаблона** или щелкните значок карандаша (вкладка "**Автор** ") справа **+** >  >  **конвейера из шаблона** , чтобы открыть галерею шаблонов.

    ![Приступая к работе с фабрикой данных Azure](media/data-factory-template/adf-get-started.png)

1. Выберите шаблон **групповое копирование из базы данных в обозреватель данных Azure**.
 
    ![Выбор конвейера из шаблона](media/data-factory-template/pipeline-from-template.png)

1.  В окне " **групповое копирование из базы данных в Azure обозреватель данных** выберите существующие наборы данных из раскрывающегося списка. 

    * **Контролтабледатасет** — связанная служба для управления таблицей, которая указывает, какие данные копируются из источника в место назначения и где они будут помещены в место назначения. 
    * **SourceDataset** — связанная служба с базой данных-источником. 
    * **Азуредатаексплорертабле** — таблица обозреватель данных Azure. Если набор данных не существует, [Создайте связанную службу Azure обозреватель данных](data-factory-load-data.md#create-the-azure-data-explorer-linked-service) , чтобы добавить набор данных.
    * Выберите **использовать этот шаблон**.

    ![Настройка шаблона Azure обозреватель данных с массовым копированием](media/data-factory-template/configure-bulk-copy-adx-template.png)

1. Выберите область на холсте вне действий, чтобы получить доступ к конвейеру шаблона. Выберите **Параметры** , чтобы ввести параметры для таблицы, включая **имя** (имя таблицы управления) и **значение по умолчанию** (имена столбцов).

    ![Параметры конвейера](media/data-factory-template/pipeline-parameters.png)

1.  Выберите действие поиска **жетпартитионлист**, чтобы просмотреть параметры по умолчанию. Запрос создается автоматически.
1.  Выберите действие команды **фореачпартитион**, выберите **Параметры** .
    * **Число пакетов**: Выберите число от 1-50. Этот выбор определяет количество параллельно выполняемых конвейеров до тех пор, пока не будет достигнуто **контролтабледатасет** число строк. 
    * НЕ устанавливайте флажок **последовательный** , чтобы пакеты конвейера выполнялись параллельно.

    ![Параметры Фореачпартитион](media/data-factory-template/foreach-partition-settings.png)

    > [!TIP]
    > Рекомендуется выполнять несколько конвейеров параллельно, поэтому данные можно копировать быстрее. Чтобы повысить эффективность, разбейте данные в исходной таблице и распределите секцию на конвейер в соответствии с датой и таблицей.

1. Выберите **проверить все** , чтобы проверить конвейер ADF. См. раздел **выходные данные проверки конвейера**.

    ![Проверка конвейеров шаблонов](media/data-factory-template/validate-template-pipelines.png)

1. При необходимости выберите **Отладка**, а затем **добавьте триггер** , чтобы запустить конвейер.

    ![Запустить конвейер](media/data-factory-template/trigger-run-of-pipeline.png)    


Теперь можно использовать шаблон " **групповое копирование из базы данных в Azure обозреватель данных** " для эффективного копирования больших объемов данных из баз данных и таблиц.

## <a name="next-steps"></a>Следующие шаги

* Сведения о процедуре [копирования данных в azure обозреватель данных с помощью фабрики данных Azure](data-factory-load-data.md).

* Сведения о [соединителе azure обозреватель данных](/azure/data-factory/connector-azure-data-explorer) в фабрике данных Azure.

* Дополнительные сведения о запросах [Обозреватель данных Azure](/azure/data-explorer/web-query-data) для запросов к данным.






