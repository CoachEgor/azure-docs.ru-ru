---
title: Мониторинг производительности, работоспособности и использования Azure обозреватель данных с помощью метрик
description: Узнайте, как использовать метрики обозреватель данных Azure для наблюдения за производительностью, работоспособностью и использованием кластера.
author: orspod
ms.author: orspodek
ms.reviewer: gabil
ms.service: data-explorer
ms.topic: conceptual
ms.date: 04/01/2019
ms.openlocfilehash: 1bc63ac4dc3930ad0423baa98453bd927c295a72
ms.sourcegitcommit: 49e14e0d19a18b75fd83de6c16ccee2594592355
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/14/2020
ms.locfileid: "75945752"
---
# <a name="monitor-azure-data-explorer-performance-health-and-usage-with-metrics"></a>Мониторинг производительности, работоспособности и использования Azure обозреватель данных с помощью метрик

Azure Data Explorer — это быстрая и полностью управляемая служба для анализа большого объема потоковых данных в реальном времени из приложений, с веб-сайтов, с устройств Интернета вещей и т. д. Чтобы использовать обозреватель данных Azure, сначала нужно создать кластер и одну или несколько баз данных в этом кластере. Затем вы должны принять (загрузить) данные в базы данных, чтобы к ним можно было выполнять запросы. Метрики обозреватель данных Azure предоставляют ключевые индикаторы работоспособности и производительности ресурсов кластера. Используйте метрики, описанные в этой статье, чтобы отслеживать работоспособность и производительность кластера Azure обозреватель данных в конкретном сценарии в качестве отдельных метрик. Вы также можете использовать метрики в качестве базиса для рабочих [панелей мониторинга Azure](/azure/azure-portal/azure-portal-dashboards) и [оповещений Azure](/azure/azure-monitor/platform/alerts-metric-overview).

## <a name="prerequisites"></a>Технические условия

* Если у вас нет подписки Azure, создайте [бесплатную учетную запись Azure](https://azure.microsoft.com/free/).

* Создайте [кластер и базу данных](create-cluster-database-portal.md).

## <a name="sign-in-to-the-azure-portal"></a>Вход на портал Azure

Войдите на [портал Azure](https://portal.azure.com/).

## <a name="using-metrics"></a>Использование метрик

В кластере Azure обозреватель данных выберите **метрики** , чтобы открыть панель метрики и начать анализ кластера.

![Выбор метрик](media/using-metrics/select-metrics.png)

В области метрики выполните следующие действия.

![Панель "метрики"](media/using-metrics/metrics-pane.png)

1. Чтобы создать диаграмму метрики, выберите имя **метрики** и соответствующую **статистическую** функцию для каждой метрики, как описано ниже. Выбранные в кластере Azure обозреватель данных **ресурсы** и выбор **пространства имен метрик** предварительно выбраны.

    **Метрика** | **Единица измерения** | **Агрегирование** | **Описание метрики**
    |---|---|---|---|
    | Использование кэша | Процент | AVG, Max, min | Процент выделенных ресурсов кэша, используемых в данный момент кластером. Кэш — это размер SSD, выделенного для действий пользователя в соответствии с заданной политикой кэширования. Среднее использование кэша, равное 80% или меньше, является устойчивым состоянием для кластера. Если среднее использование кэша превышает 80%, кластер следует [масштабировать](manage-cluster-vertical-scaling.md) до ценовой категории, оптимизированной для хранилища, или [масштабировать](manage-cluster-horizontal-scaling.md) до большего количества экземпляров. Кроме того, можно адаптировать политику кэширования (меньшее количество дней в кэше). Если использование кэша превышает 100%, размер данных для кэширования в соответствии с политикой кэширования превышает общий размер кэша в кластере. |
    | ЦП | Процент | AVG, Max, min | Процент выделенных ресурсов вычислений, которые сейчас используются компьютерами в кластере. Средняя загрузка ЦП в 80% или менее является устойчивой для кластера. Максимальное значение ЦП — 100%, что означает отсутствие дополнительных вычислительных ресурсов для обработки данных. Если кластер не работает хорошо, проверьте максимальное значение ЦП, чтобы определить, имеются ли заблокированные ЦП. |
    | Обработано событий (для концентраторов событий) | Количество | Max, min, Sum | Общее число событий, считанных из концентраторов событий и обработанных кластером. События разбиваются на события, отклоненные, и на события, принятые ядром кластера. |
    | Задержка приема | Секунды | AVG, Max, min | Задержка приема данных с момента получения данных в кластере до их подготовки к выполнению запроса. Период задержки приема зависит от сценария приема. |
    | Результат приема | Количество | Количество | Общее число успешно выполненных операций приема. Используйте **разделение Apply** , чтобы создать контейнеры результатов успеха и сбоя и проанализировать измерения (**значение** > **состояние**).|
    | Использование приема | Процент | AVG, Max, min | Процент фактических ресурсов, используемых для приема данных из общего числа выделенных ресурсов в политике емкости для выполнения приема. Политика емкости по умолчанию составляет не более 512 параллельных операций приема или 75% ресурсов кластера, вложенных в прием. Среднее использование приема, равное 80% или меньше, является устойчивым состоянием для кластера. Максимальное значение использования приема — 100%. Это означает, что используется вся возможность приема кластера и может возникнуть очередь приема. |
    | Объем приема (в МБ) | Количество | Max, min, Sum | Общий объем данных, принимаемых в кластер (в МБ) до сжатия. |
    | Срок поддержания активности | Количество | Avg | Отслеживает скорость реагирования кластера. Полностью реагирующий кластер возвращает значение 1, а заблокированный или отключенный кластер возвращает 0. |
    | Query duration (Длительность запросов) | Секунды | Счетчик, AVG, min, Max, Sum | Общее время до получения результатов запроса (не включает задержку в сети). |
    | Общее число одновременных запросов | Количество | AVG, Max, min, Sum | Число запросов, выполняемых параллельно в кластере. Эта метрика является хорошим способом оценки нагрузки на кластер. |
    | Общее число регулируемых запросов | Количество | AVG, Max, min, Sum | Число регулируемых (отклоненных) запросов в кластере. Максимально допустимое число одновременных (параллельных) запросов определяется в политике параллельных запросов. |
    | Общее число регулируемых команд | Количество | AVG, Max, min, Sum | Количество регулируемых (отклоненных) команд в кластере, так как достигнуто максимально допустимое число одновременных (параллельных) команд. |
    | Общее число экстентов | Количество | AVG, Max, min, Sum | Общее число экстентов данных в кластере. Изменения в этой метрике могут привести к значительным изменениям в структуре данных и высокой нагрузке в кластере, так как объединение экстентов данных — это активность ЦП. |
    | | | | |

    Дополнительные сведения о [поддерживаемых метриках кластера Azure обозреватель данных](/azure/azure-monitor/platform/metrics-supported#microsoftkustoclusters)

2. Нажмите кнопку **Добавить метрику** , чтобы увидеть несколько метрик, отображенных на одной диаграмме.
3. Нажмите кнопку **+ создать диаграмму** , чтобы просмотреть несколько диаграмм в одном представлении.
4. Для изменения диапазона времени используйте средство выбора времени (по умолчанию — последние 24 часа).
5. Используйте [ **Добавление фильтра** и **Примените разбиение** ](/azure/azure-monitor/platform/metrics-getting-started#apply-dimension-filters-and-splitting) для метрик, имеющих измерения.
6. Выберите **закрепить на панели мониторинга** , чтобы добавить конфигурацию диаграммы на панели мониторинга, чтобы ее можно было просмотреть снова.
7. Задайте **новое правило генерации оповещений** , чтобы визуализировать метрики с помощью набора критериев. В новом правиле генерации оповещений будет указан целевой ресурс, метрика, разделение и измерения фильтров из диаграммы. Измените эти параметры на [панели создания правила генерации оповещений](/azure/azure-monitor/platform/metrics-charts#create-alert-rules).

Дополнительные сведения об использовании [Обозреватель метрик](/azure/azure-monitor/platform/metrics-getting-started).


## <a name="next-steps"></a>Дальнейшие действия

* [Учебник. прием и запрос данных мониторинга в Azure обозреватель данных](/azure/data-explorer/ingest-data-no-code)
* [Monitor Azure Data Explorer ingestion operations using diagnostic logs (Preview)](/azure/data-explorer/using-diagnostic-logs) (Мониторинг операций приема Azure Data Explorer с помощью журналов диагностики (предварительная версия))
* [Краткое руководство. Запрос данных в обозревателе данных Azure](web-query-data.md)
