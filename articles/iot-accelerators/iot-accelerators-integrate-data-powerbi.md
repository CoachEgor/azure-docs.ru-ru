---
title: Визуализация данных удаленного мониторинга с помощью Power BI в Azure | Документация Майкрософт
description: В этом руководстве используется Power BI Desktop и Cosmos DB для интеграции данных из решения удаленного мониторинга в настраиваемую визуализацию. Таким образом, пользователи могут создавать собственные настраиваемые панели мониторинга и делиться ими с другими пользователями вне решения.
author: dominicbetts
manager: hegate
ms.author: dobett
ms.service: iot-accelerators
services: iot-accelerators
ms.date: 05/01/2018
ms.topic: conceptual
ms.openlocfilehash: 8b0f395936c8628ff7b8dab601168538f97ccdb7
ms.sourcegitcommit: dbde4aed5a3188d6b4244ff7220f2f75fce65ada
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/19/2019
ms.locfileid: "74184243"
---
# <a name="visualize-remote-monitoring-data-using-power-bi"></a>Визуализация данных удаленного мониторинга с помощью Power BI

Из этого руководства вы узнаете, как подключить данные решения для удаленного мониторинга из CosmosDB в Power BI. Установив это подключение, вы сможете создавать собственные настраиваемые панели мониторинга и добавлять их обратно на панель мониторинга решения для удаленного мониторинга. Этот рабочий поток позволяет создавать более специализированные графики в дополнение к стандартным. Затем вы можете использовать это руководство, чтобы выполнить интеграцию с другими потоками данных или создать настраиваемые панели мониторинга для использования за пределами решения для удаленного мониторинга. При создании панелей мониторинга в Power BI можно настроить их взаимодействие друг с другом, выбирая определенные элементы. Например, можно создать фильтр, который показывает только сведения о ваших смоделированных грузовиках, и каждый элемент панели мониторинга будет взаимодействовать для отображения только этих сведений. Если вы хотите использовать средство, отличное от Power BI, вы также можете использовать инструмент визуализации и подключить базу данных Cosmos или пользовательскую базу данных, если она настроена. 

## <a name="prerequisites"></a>предварительным требованиям

- У вас должно быть запущено решение для удаленного мониторинга.
- Необходимо иметь доступ к [портал Azure](https://portal.azure.com) и подписке, в которой работают центр Интернета вещей и решение
- Необходимо иметь установленный [Power BI Desktop](https://powerbi.microsoft.com) (любой версии).


## <a name="information-needed-from-azure-portal"></a>Сведения, необходимые из портал Azure

1. Перейдите к [портал Azure](https://portal.azure.com) и войдите в систему, если это необходимо.

2. В области слева щелкните "Группы ресурсов".

    ![Боковая панель навигации](./media/iot-accelerators-integrate-data-powerbi/side_panel.png)

3. Перейдите в группу ресурсов, где запущено решение Интернета вещей, и щелкните для перехода на страницу обзора группы ресурсов. 

4. На этой странице обзора щелкните элемент с типом "Учетная запись Azure Cosmos DB", и вы будете перенаправлены на страницу обзора потока Cosmos DB для этого решения Интернета вещей.

    ![resource group](./media/iot-accelerators-integrate-data-powerbi/resource_groups.png)

5. На панели слева щелкните раздел "Ключи" и запишите следующие значения для использования в Power BI:

   - URI
   - Первичный ключ

     ![Ключи](./media/iot-accelerators-integrate-data-powerbi/keys.png)

## <a name="setting-up-the-stream-in-power-bi"></a>Настройка потока в Power BI
  
1. Откройте приложение Power BI Desktop и нажмите кнопку "Получить данные" в левом верхнем углу. 

    ![Получение данных](./media/iot-accelerators-integrate-data-powerbi/get_data.png)

2. При запросе на ввод данных укажите поисковой запрос "Azure Cosmos DB", а затем выберите этот соединитель. Этот соединитель фактически получает данные непосредственно из базы данных Cosmos для решения Интернета вещей Azure.
  
    ![База данных Cosmos](./media/iot-accelerators-integrate-data-powerbi/cosmos_db.png)
  
3. Введите сведения, которые вы записали выше:

    * URI
    * Первичный ключ

4. Выберите все таблицы, которые нужно импортировать в Power BI. Это действие запустит загрузку данных. Чем дольше выполняется решение, тем больше времени может понадобиться для загрузки данных (до нескольких часов). 

    ![Импорт таблиц](./media/iot-accelerators-integrate-data-powerbi/import_tables.png)

5. После загрузки данных нажмите кнопку "Изменить запросы" в верхней строке Power BI и разверните все таблицы, щелкнув стрелки на желтой панели для каждой из таблиц. После этого отобразятся все столбцы. Вы заметите, что такие данные, как влажность, скорость и т. д., имеют неправильный тип.

    ![Новый столбец](./media/iot-accelerators-integrate-data-powerbi/new_column.png)
  
    Например, данные, поступающие в Power BI, были преобразованы во время UNIX, когда они проходили через соединитель. Для исправления этого преобразования можно создать отдельный столбец и использовать следующую формулу для получения данных в формате времени: 

    ```text
    #datetime(1970, 1, 1, 0, 0, 0) + #duration(0, 0, 0, [Document.device.msg.received]/1000)
    ```

    ![Обновленная таблица](./media/iot-accelerators-integrate-data-powerbi/updated_table.png)
  
    Document.device.msg.received является одним из столбцов с форматированием UNIX. Вместо него можно использовать другие столбцы, которым необходимо преобразование. 
  
    Другие точки данных были преобразованы в строковой тип. Их можно преобразовать в тип Doubles или Int по такому же принципу, как описано выше.

## <a name="creating-a-dashboard"></a>Создание панели мониторинга

Подключив поток, вы можете приступить к созданию персонализированных панелей мониторинга. Ниже приведен пример панели мониторинга, которая с помощью наших имитированных устройств принимает данные телеметрии и показывает разные сводки на их основе: 

* расположение устройства на карте (справа);
* устройства вместе с состоянием и серьезностью (вверху слева);
* устройства с правилами и сведения о том, возникают ли для них предупреждения (внизу слева).

![Визуализация в Power BI](./media/iot-accelerators-integrate-data-powerbi/visual_data.png)

## <a name="publishing-the-dashboard-and-refreshing-the-data"></a>Публикация панели мониторинга и обновление данных

После успешного создания панелей мониторинга Power BI мы рекомендуем вам [опубликовать их](https://docs.microsoft.com/power-bi/desktop-upload-desktop-files), чтобы поделиться ими с другими пользователями.

Вы также можете [обновить данные](https://docs.microsoft.com/power-bi/refresh-data) на опубликованной панели мониторинга для отображения актуального набора данных.

## <a name="next-steps"></a>Дополнительная информация

Из этой статьи вы узнали о визуализации данных удаленного мониторинга с помощью Power BI.

Дополнительные сведения о решении для удаленного мониторинга см. здесь:

* [Настройка предварительно настроенного решения для удаленного мониторинга](iot-accelerators-remote-monitoring-customize.md)
* [Справочник разработчика](https://github.com/Azure/azure-iot-pcs-remote-monitoring-dotnet/wiki/Developer-Reference-Guide)
* [Руководство по устранению неполадок для разработчиков](https://github.com/Azure/azure-iot-pcs-remote-monitoring-dotnet/wiki/Developer-Troubleshooting-Guide)

