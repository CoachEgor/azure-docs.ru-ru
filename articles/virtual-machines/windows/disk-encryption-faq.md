---
title: Часто задаваемые вопросы о шифровании дисков Azure для виртуальных машин Windows
description: В этой статье содержатся ответы на часто задаваемые вопросы о Microsoft Azure шифровании дисков для виртуальных машин IaaS Windows.
author: msmbaldwin
ms.service: virtual-machines-windows
ms.subservice: security
ms.topic: article
ms.author: mbaldwin
ms.date: 11/01/2019
ms.custom: seodec18
ms.openlocfilehash: b71384e0a42af5481af7b17b91cd0b1d0ed82ee8
ms.sourcegitcommit: 849bb1729b89d075eed579aa36395bf4d29f3bd9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2020
ms.locfileid: "82082600"
---
# <a name="azure-disk-encryption-for-windows-virtual-machines-faq"></a>Часто задаваемые вопросы о шифровании дисков Azure для виртуальных машин Windows

Эта статья содержит ответы на часто задаваемые вопросы о шифровании дисков Azure для виртуальных машин Windows. Дополнительные сведения об этой службе см. в статье [Общие сведения о шифровании дисков Azure](disk-encryption-overview.md).

## <a name="what-is-azure-disk-encryption-for-windows-vms"></a>Что такое шифрование дисков Azure для виртуальных машин Windows?

Шифрование дисков Azure для виртуальных машин Windows использует функцию BitLocker в Windows для обеспечения полного шифрования диска операционной системы и дисков данных. Кроме того, он обеспечивает шифрование временного диска ресурсов, если [параметр параметра volumetype значение имеет значение ALL](disk-encryption-windows.md#enable-encryption-on-a-newly-added-data-disk).  Содержимое передается в зашифрованном виде из виртуальной машины в серверную часть хранилища. Таким образом, обеспечивается сквозное шифрование с помощью управляемого клиентом ключа.
 
См. раздел [Поддерживаемые виртуальные машины и операционные системы](disk-encryption-overview.md#supported-vms-and-operating-systems).
 
## <a name="where-is-azure-disk-encryption-in-general-availability-ga"></a>В каких регионах предоставляется общедоступная версия шифрования дисков Azure?

Шифрование дисков Azure находится в общем доступе во всех общедоступных регионах Azure.

## <a name="what-user-experiences-are-available-with-azure-disk-encryption"></a>Какие возможности предоставляет шифрование дисков Azure?

Шифрование дисков Azure (общедоступная версия) поддерживает шаблоны Azure Resource Manager, Azure PowerShell и Azure CLI. Благодаря таким различным возможностям обеспечивается гибкость. Существует три разных варианта включения шифрования дисков для виртуальных машин. Дополнительные сведения о пользовательском интерфейсе и пошаговом руководстве, доступных в разделе Шифрование дисков Azure, см. в статье [сценарии шифрования дисков Azure для Windows](disk-encryption-windows.md).

## <a name="how-much-does-azure-disk-encryption-cost"></a>Какова стоимость шифрования дисков Azure?

Плата за шифрование дисков виртуальной машины с помощью шифрования дисков Azure не взимается, но плата взимается за использование Azure Key Vault. Дополнительные сведения о ценах на Azure Key Vault см. на [этой странице](https://azure.microsoft.com/pricing/details/key-vault/).

## <a name="how-can-i-start-using-azure-disk-encryption"></a>Как приступить к работе с шифрованием дисков Azure?

Чтобы приступить к работе, ознакомьтесь с [обзором шифрования дисков Azure](disk-encryption-overview.md).

## <a name="what-vm-sizes-and-operating-systems-support-azure-disk-encryption"></a>Какие размеры виртуальных машин и операционные системы поддерживают шифрование дисков Azure?

В статье [Общие сведения о шифровании дисков Azure](disk-encryption-overview.md) перечислены [размеры виртуальных машин](disk-encryption-overview.md#supported-vms) и [операционные системы виртуальных машин](disk-encryption-overview.md#supported-operating-systems) , поддерживающие шифрование дисков Azure.

## <a name="can-i-encrypt-both-boot-and-data-volumes-with-azure-disk-encryption"></a>Можно ли с помощью шифрования дисков Azure зашифровать загрузочные тома и тома данных?

Вы можете зашифровать как загрузочные тома, так и данные, но не шифровать их без предварительного шифрования тома операционной системы.

После шифрования тома операционной системы отключение шифрования тома операционной системы не поддерживается.

## <a name="can-i-encrypt-an-unmounted-volume-with-azure-disk-encryption"></a>Можно ли зашифровать неподключенный том с помощью шифрования дисков Azure?

Нет, шифрование дисков Azure шифрует только подключенные тома.

## <a name="what-is-storage-server-side-encryption"></a>Что такое шифрование на стороне сервера хранилища?

Шифрование на стороне сервера хранилища шифрует управляемые диски Azure в службе хранилища Azure. Управляемые диски шифруются по умолчанию с помощью шифрования на стороне сервера с ключом, управляемым платформой (начиная с 10 июня 2017 г.). Вы можете управлять шифрованием управляемых дисков с помощью собственных ключей, указав ключ, управляемый клиентом. Дополнительные сведения см. в статье [Шифрование управляемых дисков Azure на стороне сервера](disk-encryption.md).
 
## <a name="how-is-azure-disk-encryption-different-from-storage-server-side-encryption-with-customer-managed-key-and-when-should-i-use-each-solution"></a>Чем шифрование дисков Azure отличается от шифрования на стороне сервера хранилища с помощью ключа, управляемого клиентом, и когда следует использовать каждое решение?

Шифрование дисков Azure обеспечивает сквозное шифрование диска операционной системы, дисков данных и временного диска ресурсов с помощью управляемого клиентом ключа.

- Если ваши требования включают шифрование всех указанных выше и сквозного шифрования, используйте шифрование дисков Azure. 
- Если ваши требования включают шифрование только неактивных данных с помощью управляемого клиентом ключа, используйте [Шифрование на стороне сервера с ключами, управляемыми клиентом](disk-encryption.md). Вы не можете зашифровать диск с помощью шифрования дисков Azure и шифрования на стороне сервера хранилища с помощью управляемых пользователем ключей.
- Если вы используете сценарий, вызываемый в [неподдерживаемых сценариях для Windows](disk-encryption-windows.md#unsupported-scenarios), рассмотрите возможность [шифрования на стороне сервера с помощью управляемых клиентом ключей](disk-encryption.md). 
- Если политика вашей организации позволяет шифровать содержимое неактивных данных с помощью управляемого Azure ключа, никаких действий не требуется — содержимое шифруется по умолчанию. Для управляемых дисков содержимое в хранилище шифруется по умолчанию с помощью шифрования на стороне сервера с ключом, управляемым платформой. Ключ управляется службой хранилища Azure. 

## <a name="how-do-i-rotate-secrets-or-encryption-keys"></a>Разделы справки поворачивать секреты или ключи шифрования?

Для смены секретов просто вызовите ту же команду, которая использовалась изначально для включения шифрования диска, указав другой Key Vault. Чтобы повернуть ключ шифрования ключа, вызовите ту же команду, которая использовалась изначально для включения шифрования диска, указав новое шифрование ключа. 

>[!WARNING]
> - Если вы ранее использовали [Шифрование дисков Azure с приложением Azure AD](disk-encryption-windows-aad.md) , указав учетные данные Azure AD для шифрования этой виртуальной машины, вам потребуется продолжить использовать этот параметр для шифрования виртуальной машины. Вы не можете использовать шифрование дисков Azure на этой зашифрованной виртуальной машине, так как это не поддерживаемый сценарий, что означает, что переключение из приложения AAD для этой зашифрованной виртуальной машины пока не поддерживается.

## <a name="how-do-i-add-or-remove-a-key-encryption-key-if-i-didnt-originally-use-one"></a>Разделы справки добавить или удалить ключ шифрования ключа, если я не использовал его изначально?

Чтобы добавить ключ шифрования ключа, вызовите команду Enable еще раз, передав параметр ключа шифрования ключа. Чтобы удалить ключ шифрования ключа, вызовите команду Enable еще раз без параметра ключа шифрования ключа.

## <a name="does-azure-disk-encryption-allow-you-to-bring-your-own-key-byok"></a>Дает ли служба шифрования дисков Azure возможность создания собственных ключей (BYOK)?

Да, вы можете предоставить собственные ключи шифрования ключей. Эти ключи хранятся в Azure Key Vault, что представляет собой хранилище ключей для шифрования дисков Azure. Дополнительные сведения о сценариях поддержки ключей шифрования ключей см. в статье [Создание и Настройка хранилища ключей для шифрования дисков Azure](disk-encryption-key-vault.md).

## <a name="can-i-use-an-azure-created-key-encryption-key"></a>Можно ли использовать ключ шифрования ключей, созданный в Azure?

Да, можно использовать Azure Key Vault, чтобы создать ключ шифрования ключей для использования шифрования дисков Azure. Эти ключи хранятся в Azure Key Vault, что представляет собой хранилище ключей для шифрования дисков Azure. Дополнительные сведения о ключе шифрования ключа см. в статье [Создание и Настройка хранилища ключей для шифрования дисков Azure](disk-encryption-key-vault.md).

## <a name="can-i-use-an-on-premises-key-management-service-or-hsm-to-safeguard-the-encryption-keys"></a>Можно ли использовать локальную службу управления ключами или HSM для защиты ключей шифрования?

Использовать локальную службу управления ключами или HSM для защиты ключей шифрования с шифрованием дисков Azure нельзя. Для защиты ключей шифрования можно использовать только Azure Key Vault. Дополнительные сведения о сценариях поддержки ключей шифрования ключей см. в статье [Создание и Настройка хранилища ключей для шифрования дисков Azure](disk-encryption-key-vault.md).

## <a name="what-are-the-prerequisites-to-configure-azure-disk-encryption"></a>Каковы предварительные требования для настройки шифрования дисков Azure?

Для использования шифрования дисков Azure существуют предварительные требования. См. статью [Создание и Настройка хранилища ключей для шифрования дисков Azure](disk-encryption-key-vault.md) , чтобы создать новое хранилище ключей, или настройте существующее хранилище ключей для доступа к шифрованию диска, чтобы включить шифрование и защитить секреты и ключи. Дополнительные сведения о сценариях поддержки ключей шифрования ключей см. в статье [Создание и Настройка хранилища ключей для шифрования дисков Azure](disk-encryption-key-vault.md).

## <a name="what-are-the-prerequisites-to-configure-azure-disk-encryption-with-an-azure-ad-app-previous-release"></a>Каковы предварительные требования для настройки шифрования дисков Azure с использованием приложения Azure AD (предыдущий выпуск)?

Для использования шифрования дисков Azure существуют предварительные требования. См. раздел [Шифрование дисков Azure с помощью Azure AD](disk-encryption-windows-aad.md) , чтобы создать приложение Azure Active Directory, создать новое хранилище ключей или настроить существующее хранилище ключей для доступа к шифрованию диска, чтобы включить шифрование, а также защитить секреты и ключи. Дополнительные сведения о сценариях поддержки ключей шифрования ключей см. в статье [Создание и Настройка хранилища ключей для шифрования дисков Azure с помощью Azure AD](disk-encryption-key-vault-aad.md).

## <a name="is-azure-disk-encryption-using-an-azure-ad-app-previous-release-still-supported"></a>Поддерживается ли по-прежнему шифрование дисков Azure с помощью приложения Azure AD (предыдущий выпуск)?
Да. Шифрование дисков с помощью приложения Azure AD по-прежнему поддерживается. Тем не менее при шифровании новых виртуальных машин мы рекомендуем использовать новый метод, а не шифрование с помощью приложения Azure AD. 

## <a name="can-i-migrate-vms-that-were-encrypted-with-an-azure-ad-app-to-encryption-without-an-azure-ad-app"></a>Можно ли перевести виртуальные машины, зашифрованные с помощью приложения Azure AD, на шифрование без приложения Azure AD?
  Сейчас для компьютеров, зашифрованных с помощью приложения Azure AD, нет прямого пути миграции к шифрованию без приложения Azure AD. Кроме того, нет прямого пути от шифрования без приложения Azure AD к шифрованию с помощью приложения AD. 

## <a name="what-version-of-azure-powershell-does-azure-disk-encryption-support"></a>Какую версию Azure PowerShell поддерживает шифрование дисков Azure?

Для настройки шифрования дисков Azure используйте последнюю версию пакета SDK для Azure PowerShell. Скачайте последнюю версию [Azure PowerShell](https://github.com/Azure/azure-powershell/releases). Шифрование дисков Azure *не* поддерживается в пакете SDK для Azure версии 1.1.0.

## <a name="what-is-the-disk-bek-volume-or-mntazure_bek_disk"></a>Что такое том BEK или /mnt/azure_bek_disk?

"Том bek" — это локальный том данных, который безопасно сохраняет ключи шифрования для зашифрованных виртуальных машин Azure.

> [!NOTE]
> Не удаляйте и не изменяйте содержимое на этом диске. Не отключайте диск, так как ключ шифрования необходим для любой операции шифрования на виртуальной машине IaaS.

## <a name="what-encryption-method-does-azure-disk-encryption-use"></a>Какой метод шифрования используется в шифровании дисков Azure?

Шифрование дисков Azure выбирает метод шифрования в BitLocker на основе версии Windows следующим образом.

| Версии Windows                 | Версия | Метод шифрования        |
|----------------------------------|--------|--------------------------|
| Windows Server 2012, Windows 10 или более поздней версии  | >= 1511 |XTS-AES 256 bit           |
| Windows Server 2012, Windows 8, 8,1, 10 | < 1511 |AES 256 bit *              |
| Windows Server 2008 R2            |        |Бит AES 256 с диффузором |

\*Бит AES 256 с диффузором не поддерживается в Windows 2012 и более поздних версиях.

Чтобы определить версию ОС Windows, запустите на виртуальной машине средство winver.

## <a name="if-i-use-encryptformatall-and-specify-all-volume-types-will-it-erase-the-data-on-the-data-drives-that-we-already-encrypted"></a>Если используется параметр EncryptFormatAll и указаны все типы томов, удалятся ли данные из уже зашифрованных дисков?
Нет. Данные не удаляются из дисков, которые уже зашифрованы с помощью службы шифрования дисков Azure. Так же как и в случае с диском ОС, параметр EncryptFormatAll не шифрует повторно уже зашифрованные диски данных. 

## <a name="can-i-backup-and-restore-an-encrypted-vm"></a>Можно ли выполнять резервное копирование и восстановление зашифрованной виртуальной машины? 

Azure Backup предоставляет механизм резервного копирования и восстановления зашифрованных виртуальных машин в той же подписке и регионе.  Инструкции см. в статье [резервное копирование и восстановление зашифрованных виртуальных машин с помощью Azure Backup](../../backup/backup-azure-vms-encryption.md).  Восстановление зашифрованной виртуальной машины в другой регион в настоящее время не поддерживается.  

## <a name="where-can-i-go-to-ask-questions-or-provide-feedback"></a>Где можно задать вопрос или оставить отзыв?

Задать вопрос или оставить отзыв можно на [форуме по шифрованию дисков Azure](https://social.msdn.microsoft.com/Forums/en-US/home?forum=AzureDiskEncryption).

## <a name="next-steps"></a>Дальнейшие шаги
Из этого документа вы получили ответы на самые распространенные вопросы, связанные с шифрованием дисков Azure. Дополнительные сведения об этой службе см. в следующих статьях:

- [Общие сведения о шифровании дисков Azure](disk-encryption-overview.md)
- [Шифрование диска в центре безопасности Azure](https://docs.microsoft.com/azure/security-center/security-center-apply-disk-encryption)
- [Шифрование неактивных данных в Azure](../../security/fundamentals/encryption-atrest.md)
