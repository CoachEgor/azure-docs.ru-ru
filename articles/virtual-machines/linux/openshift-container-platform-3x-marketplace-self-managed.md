---
title: Развертывание OpenShift контейнерная платформа 3.11 Самоуправляемое предложение рынка в Azure
description: Развертывание OpenShift контейнерной платформы 3.11 Самоуправляемое предложение рынка в Azure.
author: haroldwongms
manager: mdotson
ms.service: virtual-machines-linux
ms.subservice: workloads
ms.topic: article
ms.tgt_pltfrm: vm-linux
ms.workload: infrastructure
ms.date: 10/14/2019
ms.author: haroldw
ms.openlocfilehash: 1cf6c7417aa86d47e59e08786e7807e32c175a25
ms.sourcegitcommit: 31e9f369e5ff4dd4dda6cf05edf71046b33164d3
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/22/2020
ms.locfileid: "81759572"
---
# <a name="configure-prerequisites"></a>Настройка необходимых компонентов

Прежде чем использовать предложение Marketplace для развертывания самоуправляемого кластера OpenShift Container Platform 3.11 в Azure необходимо настроить несколько предпосылок.  Прочитайте статью [ОПозаблок OpenShift](https://docs.microsoft.com/azure/virtual-machines/linux/openshift-container-platform-3x-prerequisites) для инструкций по созданию ключа ssh (без фразы), хранилища ключей Azure, секрета хранилища ключей и директора службы.

 
## <a name="deploy-using-the-marketplace-offer"></a>Развертывание с помощью предложения Marketplace

Самый простой способ развертывания самоуправляемой контейнерной платформы OpenShift 3.11 в Azure — это использовать [предложение Azure Marketplace.](https://azuremarketplace.microsoft.com/marketplace/apps/osatesting.open-shift-azure-proxy)

Этот вариант является самым простым, но он также имеет ограниченные возможности настройки. Предложение Marketplace развертывает платформу OpenShift Container Platform 3.11.82 и включает в себя следующие параметры конфигурации:

- **Master Nodes** (Главные узлы): три главных узла, для которых можно указать тип экземпляра.
- **Infra Nodes** (Узлы Infra): три узла Infra, для которых можно указать тип экземпляра.
- **Узлы**: количество узлов (между 1 и 9) и тип экземпляра настраиваются.
- **Disk Type** (Тип диска): используются Управляемые диски.
- **Сеть**: Поддержка новой или существующей сети и пользовательского диапазона CIDR.
- **CNS**: позволяет включить CNS.
- **Метрики**: Хоукулярная метрика может быть включена.
- **Регистрация:** EFK Logging может быть включена.
- **Поставщик облачных услуг Azure:** включенный по умолчанию, может быть отключен.

В верхнем левом углу портала Azure нажмите **«Создайте ресурс»,** введите контейнерную платформу с открытым смещением» в поле поиска и нажмите Enter.

   ![Поиск новых ресурсов](media/openshift-marketplace-self-managed/ocp-search.png)  
<br>

Страница Результаты откроется с **Red Hat OpenShift контейнерной платформы 3.11 Самостоятельное управление** в списке. 

   ![Новый результат поиска ресурсов](media/openshift-marketplace-self-managed/ocp-searchresult.png)  
<br>

Нажмите на предложение, чтобы просмотреть детали предложения. Чтобы развернуть это предложение, нажмите **Создать**. Появится uI для ввода необходимых параметров. Первый экран - лезвие **Основы.**

   ![Страница заголовка предложения](media/openshift-marketplace-self-managed/ocp-titlepage.png)  
<br>

**Основы**

Чтобы получить помощь по любому из параметров ввода, нависте над ***i*** рядом с именем параметра.

Введите значения для параметров ввода и нажмите **OK**.

| Параметр ввода | Описание параметра |
|-----------------------|-----------------|
| Имя пользователя VM Admin | Пользователь администратора, который будет создан во всех экземплярах VM |
| SSH Общественный ключ для пользователя админ | SSH публичный ключ, используемый для входа в VM - не должны иметь пароль |
| Подписка | Подписка Azure для развертывания кластера в |
| Группа ресурсов | Создание новой группы ресурсов или выбор существующей пустой группы ресурсов для кластерных ресурсов |
| Расположение | Azure для развертывания кластера в |

   ![Предложение основы лезвия](media/openshift-marketplace-self-managed/ocp-basics.png)  
<br>

**Настройки инфраструктуры**

Введите значения для параметров ввода и нажмите **OK**.

| Параметр ввода | Описание параметра |
|-----------------------|-----------------|
| Префикс названия кластера OCP | Кластерная префикс, используемая для настройки узлов для всех узлов. От 1 до 20 символов |
| Размер мастера-узла | Примите размер VM по умолчанию или нажмите **Изменение размера,** чтобы выбрать другой размер VM.  Выберите подходящий размер VM для рабочей нагрузки |
| Размер узла инфраструктуры | Примите размер VM по умолчанию или нажмите **Изменение размера,** чтобы выбрать другой размер VM.  Выберите подходящий размер VM для рабочей нагрузки |
| Количество узлов приложений | Примите размер VM по умолчанию или нажмите **Изменение размера,** чтобы выбрать другой размер VM.  Выберите подходящий размер VM для рабочей нагрузки |
| Размер узла приложения | Примите размер VM по умолчанию или нажмите **Изменение размера,** чтобы выбрать другой размер VM.  Выберите подходящий размер VM для рабочей нагрузки |
| Размер хозяина бастиона | Примите размер VM по умолчанию или нажмите **Изменение размера,** чтобы выбрать другой размер VM.  Выберите подходящий размер VM для рабочей нагрузки |
| Новая или существующая виртуальная сеть | Создание нового vNet (по умолчанию) или использование существующего vNet |
| Выберите настройки CIDR по умолчанию или настройте диапазон IP (CIDR) | Примите диапазоны CIDR по умолчанию или выберите **пользовательский диапазон IP** и введите пользовательскую информацию CIDR.  Настройки по умолчанию создадут vNet с CIDR 10.0.0.0/14, мастер-подсеть с 10.1.0.0/16, инфра-субнет с 10.2.0.0/16, а также вычислительную и cns подсеть с 10.3.0.0/16 |
| Название группы ресурсов Key Vault | Название Группы ресурсов, содержащей Ключевое Убежище |
| Имя хранилища ключей | Название Key Vault, содержащее секрет с закрытым ключом ssh.  Разрешены только алфавитные символы и тире, и от 3 до 24 символов |
| Секретное имя | Название секрет, который содержит ssh частный ключ.  Разрешены только алфавитные символы и тире |

   ![Предложение лезвия инфраструктуры](media/openshift-marketplace-self-managed/ocp-inframain.png)  
<br>

**Изменение размера**

Чтобы выбрать другой размер VM, нажмите ***Изменение размера***.  Откроется окно выбора VM.  Выберите выбранный размер VM и нажмите **«Выберите».**

   ![Выберите размер VM](media/openshift-marketplace-self-managed/ocp-selectvmsize.png)  
<br>

**Существующая виртуальная сеть**

| Параметр ввода | Описание параметра |
|-----------------------|-----------------|
| Существующее название виртуальной сети | Название существующей vNet |
| Название подсети для мастер-узлов | Название существующей подсети для мастер-узлов.  Потребности содержать по крайней мере 16 IP-адресов и следовать RFC 1918 |
| Название подсети для инфраузлов | Название существующей подсети для инфраузлов.  Потребности содержать по крайней мере 32 IP-адреса и следовать RFC 1918 |
| Название подсети для вычислительных и cns узлов | Название существующей подсети для вычислительных и cns узлов.  Потребности содержать по крайней мере 32 IP-адреса и следовать RFC 1918 |
| Группа ресурсов для существующей виртуальной сети | Название группы ресурсов, содержащей существующую vNet |

   ![Предложение инфраструктуры существующих vnet](media/openshift-marketplace-self-managed/ocp-existingvnet.png)  
<br>

**Пользовательский диапазон IP**

| Параметр ввода | Описание параметра |
|-----------------------|-----------------|
| Диапазон адресов для виртуальной сети | Пользовательские CIDR для vNet |
| Диапазон адресов для подсети, содержащей мастер-узлы | Пользовательские CIDR для мастер-подсети |
| Диапазон адресов для подсети, содержащей узлы инфраструктуры | Пользовательский CIDR для инфраструктурной подсети |
| Диапазон адресов для подсети, содержащей вычислительные и cns узлы | Пользовательский CIDR для вычислительных и cns узлов |

   ![Предложение инфраструктуры пользовательский диапазон IP](media/openshift-marketplace-self-managed/ocp-customiprange.png)  
<br>

**Платформа контейнеров OpenShift 3.11**

Введите значения для параметров ввода и нажмите **OK**

| Параметр ввода | Описание параметра |
|-----------------------|-----------------|
| Пароль пользователя OpenShift Admin | Пароль для исходного пользователя OpenShift.  Этот пользователь также будет кластерным админ |
| Подтверждение Паролей пользователя Admin OpenShift | Перепечатай пароль пользователя OpenShift Admin |
| Имя менеджера подписки Red Hat | Имя пользователя для доступа к подписке Red Hat или идентификатору организации.  Этот учетный сбор используется для регистрации экземпляра RHEL в вашей подписке и не будет храниться корпорацией Майкрософт или Red Hat |
| Пароль пользователя менеджера подписки Red Hat | Пароль для доступа к подписке или активации Red Hat.  Этот учетный сбор используется для регистрации экземпляра RHEL в вашей подписке и не будет храниться корпорацией Майкрософт или Red Hat |
| Red Hat Менеджер подписки OpenShift бассейн ID | Идентификатор пула, содержащий право на контейнерную платформу OpenShift. Убедитесь, что у вас достаточно прав на платформу OpenShift Container Platform для установки кластера |
| Red Hat Менеджер подписки OpenShift бассейн ID для брокера / Мастер узлов | Идентификатор пула, содержащий права на контейнерную платформу OpenShift для Брокера / Мастер-узлов. Убедитесь, что у вас достаточно прав на платформу OpenShift Container Platform для установки кластера. Если не используете идентификатор брокера /мастер пула, введите идентификатор пула для узлов приложений |
| Настройка облачного поставщика Azure | Нанастройка OpenShift для использования облачного поставщика Azure. Необходимо при использовании диска Azure прикрепить для постоянных объемов.  По умолчанию да |
| Основной идентификатор клиента Azure AD GUID | Azure AD службы основной клиент ID GUID - также известный как AppID. Только необходимо, если настроить облачный провайдер Azure в **Да** |
| Azure AD Службы Основные секрет клиента ID | Основной идентификационный представитель клиента Azure AD Secret. Только необходимо, если настроить облачный провайдер Azure в **Да** |
 
   ![Предложение лезвия OpenShift](media/openshift-marketplace-self-managed/ocp-ocpmain.png)  
<br>

**Дополнительные настройки**

Лезвие дополнительных настроек позволяет конфигурацию CNS для хранения глухоты, журнальных журналов, метрик и домена Router Sub.  По умолчанию не будет устанавливаться любой из этих параметров и будет использовать nip.io в качестве доменсуб-портала для тестирования целей. Включение ЦНС установит три дополнительных вычислительных узла с тремя дополнительными прикрепленными дисками, которые будут принимать стручки глухот.  

Введите значения для параметров ввода и нажмите **OK**

| Параметр ввода | Описание параметра |
|-----------------------|-----------------|
| Настройка контейнера родного хранения (CNS) | Устанавливает CNS в кластер OpenShift и включает его в качестве хранилища. Будет по умолчанию, если поставщик Azure отключен |
| Настройка кластерного заготовки | Устанавливает функциональность регистрации EFK в кластер.  Размер инфра-узлов надлежащим образом для размещения стручков EFK |
| Настройка метрик для кластера | Устанавливает метрики Hawkular в кластер OpenShift.  Размер инфра-узлов надлежащим образом для размещения Хокулярные метрики стручки |
| Домен Маршрутизатор по умолчанию | Выберите nipio для тестирования или обычай ввести свой собственный суб-домен для производства |
 
   ![Предложите дополнительное лезвие](media/openshift-marketplace-self-managed/ocp-additionalmain.png)  
<br>

**Дополнительные настройки - Дополнительные параметры**

| Параметр ввода | Описание параметра |
|-----------------------|-----------------|
| (CNS) Размер узла | Примите размер узла по умолчанию или выберите **размер изменения,** чтобы выбрать новый размер VM |
| Введите пользовательский поддомен | Пользовательский домен маршрутизации, который будет использоваться для разоблачения приложений через маршрутизатор в кластере OpenShift.  Обязательно создайте соответствующую запись подстановочного знака DNS |
 
   ![Предложение дополнительных CNS Установить](media/openshift-marketplace-self-managed/ocp-additionalcnsall.png)  
<br>

**Сводка**

Проверка происходит на данном этапе для проверки основной квоты достаточно для развертывания общего числа MMs, выбранных для кластера.  Просмотрите все введенные параметры.  Если входные данные являются приемлемыми, нажмите **OK,** чтобы продолжить.

   ![Предложение резюме лезвие](media/openshift-marketplace-self-managed/ocp-summary.png)  
<br>

**Купить**

Подтвердите контактную информацию на странице Купить и нажмите **Покупка,** чтобы принять условия использования и начать развертывание кластера контейнерной платформы OpenShift.

   ![Предложение покупки лезвие](media/openshift-marketplace-self-managed/ocp-purchase.png)  
<br>


## <a name="connect-to-the-openshift-cluster"></a>Подключение к кластеру OpenShift

Когда завершится развертывание, получите данные для подключения из раздела выходных данных развертывания. Подключайтесь к консоли OpenShift с помощью браузера с помощью **URL-адреса OpenShift Console.** Вы также можете SSH к хозяину Бастиона. В следующем примере в качестве имени администратора указано clusteradmin, а для полного доменного имени DNS с общедоступным IP-адресом узла-бастиона — bastiondns4hawllzaavu6g.eastus.cloudapp.azure.com.

```bash
$ ssh clusteradmin@bastiondns4hawllzaavu6g.eastus.cloudapp.azure.com
```

## <a name="clean-up-resources"></a>Очистка ресурсов

Если группа ресурсов, кластер OpenShift и все связанные ресурсы больше не нужны, их можно удалить с помощью команды [az group delete](/cli/azure/group).

```azurecli 
az group delete --name openshiftrg
```

## <a name="next-steps"></a>Следующие шаги

- [Задачи, выполняемые после развертывания](./openshift-container-platform-3x-post-deployment.md)
- [Устранение неполадок с развертыванием OpenShift в Azure](./openshift-container-platform-3x-troubleshooting.md)
- [Overview](https://docs.openshift.com) (Обзор)
- 