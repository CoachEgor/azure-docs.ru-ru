---
title: Руководство. Использование интегрированного пакета DevOps для IaaS и PaaS в Azure
description: Узнайте, как настроить непрерывную интеграцию (CI) и непрерывное развертывание (CD) приложения на виртуальных машинах Azure с помощью Azure Pipelines.
author: ushan
manager: jpconnock
tags: azure-devops-pipelines
ms.assetid: ''
ms.service: virtual-machines-linux
ms.topic: tutorial
ms.tgt_pltfrm: azure-pipelines
ms.workload: infrastructure
ms.date: 1/16/2020
ms.author: ushan
ms.custom: devops
ms.openlocfilehash: 5707a99b329915b35131fe793b0dfabd02348677
ms.sourcegitcommit: 3c925b84b5144f3be0a9cd3256d0886df9fa9dc0
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/28/2020
ms.locfileid: "77912534"
---
# <a name="tutorial-integrated-devops-for-iaas-and-paas-on-azure"></a>Руководство по Использование интегрированного пакета DevOps для IaaS и PaaS в Azure

Благодаря полнофункциональным решениям в Azure разработчики могут внедрять методики DevOps для любого этапа жизненного цикла приложения, включая планирование, разработку, доставку и эксплуатацию. 

Ниже перечислены некоторые службы Azure, которые упрощают облачные рабочие нагрузки и хорошо сочетаются, создавая невероятно мощные сценарии.
Эти технологии, используемые специалистами вместе с соответствующими процессами, повышают ценность предложений для клиентов. 

- Azure (https://portal.azure.com ) — портал для создания облачных рабочих нагрузок. Администрируйте и отслеживайте все решения, начиная от простых веб-приложений и заканчивая сложными облачными приложениями. 
- Azure DevOps (https://dev.azure.com ) — набор современных служб разработки оптимизирует планирование, улучшает взаимодействие и ускоряет доставку. 
- Студия Машинного обучения Azure (https://ml.azure.com ) — позволяет подготавливать данные, обучать и развертывать модели машинного обучения 
 

Azure DevOps — это встроенная служба Azure, которая автоматизирует выполнение каждой части процесса DevOps и применяет непрерывную интеграцию и непрерывную поставку для любого ресурса Azure.
Независимо от того, использует ли ваше приложение виртуальные машины, веб-приложения, Kubernetes или любой другой ресурс, вы можете реализовать подход "инфраструктура как код", включая непрерывную интеграцию, непрерывное тестирование, непрерывную поставку и непрерывный мониторинг с использованием Azure и Azure DevOps подход  
![AzDevOps_portalView](media/tutorial-devops-azure-pipelines-classic/azdevops-view.png) 
 
 
## <a name="iaas---configure-cicd"></a>IaaS — настройка CI/CD 
Azure Pipelines предоставляет комплексный и полнофункциональный набор инструментов для автоматизации CI/CD при развертывании на виртуальных машинах. Вы можете настроить конвейер непрерывной поставки для виртуальной машины Azure непосредственно на портале Azure. В этом документе описывается, как настроить конвейер CI/CD для развертываний с несколькими компьютерами с использованием портала Azure. Настройка CI/CD для виртуальных машин.

Виртуальные машины можно добавлять в качестве целевых объектов в [группу развертывания](https://docs.microsoft.com/azure/devops/pipelines/release/deployment-groups) и назначать для последовательного обновления на нескольких компьютерах. Представления журнала развертываний в группах развертывания позволяют отслеживать передачу данных с виртуальной машины в конвейер и затем на фиксацию. 
 
**Последовательное обновление.** При последовательном развертывании экземпляры предыдущей версии приложения в каждой итерации заменяются экземплярами новой версии в фиксированном наборе виртуальных машин (наборе последовательного обновления). Давайте подробно рассмотрим процесс настройки последовательного обновления для виртуальных машин.  
Вы можете настроить последовательные обновления для **виртуальных машин** на портале Azure с помощью механизма непрерывной поставки. 

Ниже представлено пошаговое руководство. 
1. Войдите на портал Azure и перейдите к нужной виртуальной машине. 
2. На панели слева для виртуальной машины перейдите в меню  **Непрерывная поставка** . Затем щелкните  **Настроить**. 
   ![AzDevOps_configure](media/tutorial-devops-azure-pipelines-classic/azdevops-configure.png) 
3. На панели конфигурации щелкните "Организация Azure DevOps", чтобы выбрать существующую учетную запись или создать новую. Затем выберите проект, в котором вы хотите настроить конвейер.  
   ![AzDevOps_project](media/tutorial-devops-azure-pipelines-classic/azdevops-project.png) 
4. Группа развертывания — это логический набор целевых компьютеров для развертывания, который представляет определенную физическую среду, например среду разработки, тестирования и пользовательского приемочного тестирования, а также рабочую среду. Вы можете создать новую группу развертывания или выбрать существующую. При желании можно присвоить компьютеру тег, обозначающий роль. Например, web или db.  
5. Щелкните **ОК** в диалоговом окне, чтобы настроить конвейер непрерывной поставки. 
6. Когда процесс завершится, вы получите конвейер непрерывной поставки, настроенный для развертывания на виртуальной машине.  
   ![AzDevOps_pipeline](media/tutorial-devops-azure-pipelines-classic/azdevops-pipeline.png)
7. Вы увидите, что на виртуальной машине выполняется развертывание. Можно щелкнуть ссылку, чтобы перейти к этому конвейеру. Щелкните **Release-1**, чтобы просмотреть развертывание. Можно также щелкнуть **Изменить**, чтобы изменить определение для конвейера выпуска. 
8. Если вам нужно настроить несколько виртуальных машин, повторите шаги 2–5 для добавления других виртуальных машин в группу развертывания. 
9. Затем щелкните определение конвейера, перейдите к организации Azure DevOps и выберите **Изменить** для конвейера выпуска. 
   ![AzDevOps_edit_pipeline](media/tutorial-devops-azure-pipelines-classic/azdevops-edit-pipeline.png)
10. Щелкните ссылку **1 задание, 1 задача** на этапе **Разработка**. Щелкните этап **Развертывание**.  
   ![AzDevOps_deploymentGroup](media/tutorial-devops-azure-pipelines-classic/azdevops-deployment-group.png)
11. В области конфигурации справа можно увидеть, что по умолчанию в конвейере настроено последовательное обновление одновременно для всех целевых объектов. Вы можете настроить выполнение развертываний по одному за раз или указать долю в процентах с помощью ползунка.  
  
  
Использование варианта **Раннее развертывание** снижает риск, так как развертывание выполняется медленно для небольшой группы пользователей. Когда вы будете уверены в новой версии, ее можно будет выпустить на другие серверы в инфраструктуре, предоставив ее большему количеству пользователей. Вы можете настроить режим раннего развертывания для **виртуальных машин** на портале Azure, используя механизм непрерывной поставки. Ниже представлено пошаговое руководство. 
1. Войдите на портал Azure и перейдите к нужной виртуальной машине. 
2. Выполните шаги 2–5 из предыдущего раздела, чтобы добавить несколько виртуальных машин в группу развертывания. 
3. Добавьте пользовательский тег к виртуальным машинам, для которых будет применяться ранее развертывание. Например, тег canary.
4. Настроив конвейер для виртуальных машин, щелкните этот конвейер, запустите организацию Azure DevOps, выберите **Изменить** для конвейера и перейдите к этапу **Разработка**. Добавьте фильтрацию по тегу canary. 
5. Добавьте еще один этап для группы развертывания и с помощью тегов отметьте остальные виртуальные машины из той же группы развертывания.  
6. При желании настройте шаг подтверждения вручную, на котором можно подтвердить или отклонить раннее развертывание. 
   ![AzDevOps_Canary](media/tutorial-devops-azure-pipelines-classic/azdevops-canary-deploy.png)

Применение схемы **Сине-зеленое** сокращает время простоя при развертывании путем использования идентичной резервной среды. В любой момент времени одна из этих сред является активной. При подготовке к новому выпуску вы выполняете последний этап тестирования в зеленой среде. Когда программное обеспечение будет правильно работать в зеленой среде, переключите на нее весь трафик входящих запросов, и теперь синяя среда станет неактивной.
Вы можете настроить схему "Синее-зеленое" для **виртуальных машин** на портале Azure, используя механизм непрерывной поставки. 

Ниже представлено пошаговое руководство. 

1. Войдите на портал Azure и перейдите к нужной виртуальной машине. 
2. Выполните шаги 2–5 из раздела **Последовательное обновление**, чтобы добавить несколько виртуальных машин в группу развертывания. Добавьте пользовательский тег к виртуальным машинам, для которых будет применяться схема"Синее-зеленое". Например, теги blue и green для виртуальных машин в рабочей и резервной ролях, соответственно. 
3. Настроив конвейер для виртуальных машин, щелкните этот конвейер, запустите организацию Azure DevOps, выберите **Изменить** для конвейера и перейдите к этапу **Разработка**. Добавьте фильтрацию по тегу green. 
4. Добавьте этап без агента, настройте для этого этапа подтверждение вручную и вызовите из него обращение к API REST, которое меняет местами теги. 
   ![AzDevOps_BlueGreen](media/tutorial-devops-azure-pipelines-classic/azdevops-blue-green-deploy.png)
 
 
## <a name="azure-devops-project"></a>Azure DevOps Projects 
Начать работу с Azure теперь стало еще проще.
 
С помощью Azure DevOps Projects вы можете запустить приложение в любой службе Azure, выполнив всего три шага: выбрав язык приложения, среду разработки и службу Azure.
 
[Подробнее](https://azure.microsoft.com/features/devops-projects/ ).
 
## <a name="additional-resources"></a>Дополнительные ресурсы 
- [Руководство по развертыванию приложения ASP.NET на виртуальных машинах Azure с помощью Azure DevOps Projects](https://docs.microsoft.com/azure/devops-project/azure-devops-project-vms)
- [Реализация непрерывного развертывания приложения в масштабируемом наборе виртуальных машин Azure](https://docs.microsoft.com/azure/devops/pipelines/apps/cd/azure/deploy-azure-scaleset)
