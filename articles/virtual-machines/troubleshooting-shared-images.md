---
title: Устранение неполадок с общими образами в Azure
description: Подробные сведения об устранении неполадок c коллекциями общих образов.
author: cynthn
ms.service: virtual-machines
ms.subservice: imaging
ms.topic: troubleshooting
ms.workload: infrastructure
ms.date: 06/15/2020
ms.author: cynthn
ms.reviewer: cynthn
ms.openlocfilehash: 3a206a7aabee9f75524ab4715afa30ec05c612bf
ms.sourcegitcommit: 829d951d5c90442a38012daaf77e86046018e5b9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/09/2020
ms.locfileid: "91328069"
---
# <a name="troubleshooting-shared-image-galleries-in-azure"></a>Устранение неполадок с общими галереями изображений в Azure

Если возникнут проблемы при выполнении операций с коллекциями общих образов, определениями и версиями образов, выполните команду, которая дала сбой, в режиме отладки. Режим отладки активируется путем передачи `--debug` коммутатора с помощью интерфейса командной строки и `-Debug` коммутатора с помощью PowerShell. Обнаружив ошибку, следуйте инструкциям в этом документе для ее устранения.


## <a name="unable-to-create-a-shared-image-gallery"></a>Не удалось создать коллекцию общих образов

Возможные причины:

*Недопустимое имя коллекции.*

Допустимыми знаками для имени коллекции являются прописные или строчные буквы, цифры и точки. Имя коллекции не должно содержать дефисы. Измените имя коллекции и повторите попытку. 

*Имя коллекции не является уникальным в рамках подписки.*

Выберите другое имя коллекции и повторите попытку.


## <a name="unable-to-create-an-image-definition"></a>Не удалось создать определение образа 

Возможные причины:

*Недопустимое имя определения образа.*

Допустимые символы для определения образа: прописные или строчные буквы, цифры, точки, тире и точки. Измените имя определения образа и повторите попытку.

*Обязательные свойства для создания определения образа не заполнены.*

Такие свойства, как имя, издатель, предложение, SKU и тип ОС, являются обязательными. Проверьте, передаются ли все свойства.

Убедитесь, что **OSType**(Linux или Windows) определения образа совпадает с источником, используемым для создания версии образа. 


## <a name="unable-to-create-an-image-version"></a>Не удалось создать версию образа 

Возможные причины:

*Недопустимое имя версии образа.*

Допустимыми знаками для имени версии образа являются цифры и точки. Числа должны быть в диапазоне 32-битного целого числа. Формат: *MajorVersion. minorversion. patch*. Измените имя версии образа и повторите попытку.

*Исходный управляемый образ, из которого создается версия образа, не найден.* 

Проверьте, существует ли исходный образ и находится ли он в том же регионе, что и версия образа.

*Управляемый образ еще не подготовлен к работе.*

Убедитесь, что состояние подготовки исходного управляемого образа — **Успешно**.

*Список целевых регионов не включает исходный регион.*

Список целевых регионов должен содержать исходный регион версии образа. Убедитесь, что вы включили исходный регион в список целевых регионов, куда нужно реплицировать версию образа с помощью Azure.

*Репликация во все целевые регионы не завершена.*

Используйте параметр **--expand ReplicationStatus**, чтобы проверить, завершена ли репликация во все указанные целевые регионы. Если это не так, дождитесь завершения задания. Это может занять до 6 часов. Если происходит сбой, выполните команду еще раз, чтобы создать и реплицировать версию образа. Если у вас много целевых регионов для репликации версии образа, то рассмотрите возможность выполнения репликации поэтапно.

## <a name="unable-to-create-a-vm-or-a-scale-set"></a>Не удалось создать виртуальную машину или масштабируемый набор 

Возможные причины:

*У пользователя, пытающегося создать виртуальную машину или масштабируемый набор виртуальных машин, нет доступа на чтение к версии образа.*

Обратитесь к владельцу подписки и попросите предоставить ему доступ на чтение к версии образа или к родительским ресурсам (например, к коллекции общих образов или определению образа) через [Управление доступом на основе ролей Azure (Azure RBAC)](https://docs.microsoft.com/azure/role-based-access-control/rbac-and-directory-admin-roles). 

*Версия образа не найдена.*

Убедитесь, что вы пытаетесь создать виртуальную машину или масштабируемый набор виртуальных машин в регионе, который включен в список целевых регионов версии образа. Если регион уже находится в списке целевых регионов, то проверьте, завершено ли задание репликации. Вы можете использовать параметр **-ReplicationStatus**, чтобы проверить, завершена ли репликация во все указанные целевые регионы. 

*Создание виртуальной машины или масштабируемого набора виртуальных машин занимает много времени.*

Убедитесь, что **OSType** версии образа, с которой вы пытаетесь создать виртуальную машину или масштабируемый набор виртуальных машин, имеет тот же **OSType** источника, который использовался для создания версии образа. 

## <a name="unable-to-share-resources"></a>Не удается предоставить общий доступ к ресурсам

Совместное использование общей коллекции образов, определения образа и версий изображений в подписках включено с помощью [управления доступом на основе ролей Azure (Azure RBAC)](https://docs.microsoft.com/azure/role-based-access-control/rbac-and-directory-admin-roles). 

## <a name="replication-is-slow"></a>Медленная репликация

Используйте параметр **--expand ReplicationStatus**, чтобы проверить, завершена ли репликация во все указанные целевые регионы. Если это не так, дождитесь завершения задания. Это может занять до 6 часов. Если происходит сбой, активируйте команду еще раз, чтобы создать и реплицировать версию образа. Если у вас много целевых регионов для репликации версии образа, то рассмотрите возможность выполнения репликации поэтапно.

## <a name="azure-limits-and-quotas"></a>Ограничения и квоты Azure 

[Ограничения и квоты Azure](https://docs.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits) применяются ко всем ресурсам коллекции общих образов, определения и версии образа. Убедитесь, что вы не превысили пределы для своей подписки. 


## <a name="next-steps"></a>Дальнейшие действия

Дополнительные сведения см. в статье [Обзор коллекции общих образов](./linux/shared-image-galleries.md).
