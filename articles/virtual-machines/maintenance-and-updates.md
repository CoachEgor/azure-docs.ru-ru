---
title: Обслуживание и обновления
description: Обзор обслуживания и обновлений для виртуальных машин, работающих в Azure.
author: shants123
ms.service: virtual-machines
ms.workload: infrastructure-services
ms.topic: article
ms.date: 11/18/2019
ms.author: shants
ms.openlocfilehash: eaf7616b3bd69828829342b4dca9247c009d3475
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "79250235"
---
# <a name="maintenance-for-virtual-machines-in-azure"></a>Обслуживание виртуальных машин Linux в Azure

Azure периодически обновляет свою платформу для повышения надежности, производительности и безопасности инфраструктуры-хозяина для виртуальных машин. Причины этих обновлений разные: от исправлений программных компонентов в среде размещения до обновления сетевых компонентов или вывода оборудования из эксплуатации. 

Обновления редко влияют на размещенные VMs. Когда обновления имеют эффект, Azure выбирает наименее эффективный метод для обновлений:

- Если обновление не требует перезагрузки, VM приостанавливается во время обновления хоста или VM переносится в уже обновленный хост. 
- Если техническое обслуживание требует перезагрузки, вы будете уведомлены о планируемом техническом обслуживании. Azure также предоставляет временное окно, в котором вы можете начать обслуживание самостоятельно, в то время, которое работает для вас. Окно самообслуживания, как правило, 30 дней, если обслуживание является срочным. Azure инвестирует в технологии, чтобы уменьшить количество случаев, когда запланированное обслуживание платформы требует перезагрузки ВМ. Для получения инструкций по управлению запланированным обслуживанием см. Обработка запланированных уведомлений по техническому обслуживанию с помощью Azure [CLI,](maintenance-notifications-cli.md) [PowerShell](maintenance-notifications-powershell.md) или [портала.](maintenance-notifications-portal.md)

На этой странице описано, как Azure выполняет обслуживание обоих типов. Для получения дополнительной информации о незапланированных событиях (перебоях) [см. Управление доступностью vMs для Windows](./windows/manage-availability.md) или соответствующая статья для [Linux](./linux/manage-availability.md).

В рамках VM вы можете получать уведомления о предстоящем техническом обслуживании [с помощью запланированных событий для Windows](./windows/scheduled-events.md) или Для [Linux.](./linux/scheduled-events.md)



## <a name="maintenance-that-doesnt-require-a-reboot"></a>Обслуживание, не требуя перезагрузки

Большинство обновлений платформы не влияют на вывмилидля клиентов. Если обновление без воздействия невозможно, Azure выбирает механизм обновления, который наименее эффективен для клиентских вс-игр. 

Большинство ненулевого обслуживания приостанавливает VM менее 10 секунд. В некоторых случаях Azure использует механизмы обслуживания, сохраняющие память. Эти механизмы приостанавливают VM до 30 секунд и сохраняют память в оперативной памяти. Затем VM возобновляется, и его часы автоматически синхронизируются. 

Обслуживание, сохраняющее память, работает для более чем 90 процентов VMs Azure. Он не работает для серии G, M, N и H. Azure все чаще использует технологии живой миграции и совершенствует механизмы обслуживания, сохраняющие память, чтобы уменьшить продолжительность паузы.  

Эти операции по техническому обслуживанию, не требующие перезагрузки, применяются по одному домену неисправности одновременно. Они останавливаются, если они получают какие-либо предупредительные сигналы здоровья. 

Эти типы обновлений могут повлиять на некоторые приложения. Когда VM переносится в другой узла, некоторые чувствительные рабочие нагрузки могут показать небольшое ухудшение производительности в течение нескольких минут, ведущих к паузе VM. Чтобы подготовиться к обслуживанию VM и уменьшить воздействие во время обслуживания Azure, попробуйте [использовать запланированные события для Windows](./windows/scheduled-events.md) или [Linux](./linux/scheduled-events.md) для таких приложений. 

Существует также функция, управление обслуживанием, в общедоступном предварительном просмотре, который может помочь управлять обслуживанием, которое не требует перезагрузки. Вы должны использовать либо [выделенные хосты Azure,](./linux/dedicated-hosts.md) либо [изолированный VM.](../security/fundamentals/isolation-choices.md) Управление обслуживанием дает возможность пропускать обновления платформы и применять обновления по выбору времени в течение 35-дневного прокатного окна. Для получения дополнительной информации смотрите [обновления управления с помощью управления обслуживанием и Azure CLI.](maintenance-control-cli.md)


### <a name="live-migration"></a>Динамическая миграция

Миграция в реальном времени — это операция, которая не требует перезагрузки и сохраняет память для VM. Это вызывает паузу или замораживание, обычно длятся не более 5 секунд. За исключением серий G, M, N и H, вся инфраструктура как сервис (IaaS) VMs, имеют право на живую миграцию. Подходящие визы составляют более 90 процентов IaaS VMs, развернутых на флоте Azure. 

Платформа Azure начинает миграцию в следующих сценариях:
- Плановое техническое обслуживание
- Сбой оборудования
- Оптимизация распределения

В некоторых сценариях планового обслуживания используется живая миграция, и можно использовать запланированные события, чтобы знать заранее, когда начнутся операции живой миграции.

Миграция в реальном времени также может использоваться для перемещения вс-матов, когда алгоритмы машинного обучения Azure предсказывают предстоящий аппаратный сбой или когда вы хотите оптимизировать распределение VM. Для получения дополнительной информации о прогностическом моделировании, которое обнаруживает случаи деградироваваоборудования, [см. Улучшение устойчивости Azure VM с помощью прогностического машинного обучения и живой миграции.](https://azure.microsoft.com/blog/improving-azure-virtual-machine-resiliency-with-predictive-ml-and-live-migration/?WT.mc_id=thomasmaurer-blog-thmaure) Уведомления о миграции в реальном времени отображаются на портале Azure в журналах мониторинга и работоспособности службы, а также в запланированных событиях, если вы используете эти службы.

## <a name="maintenance-that-requires-a-reboot"></a>Обслуживание, требующее перезагрузки

В тех редких случаях, когда ВМ необходимо перезагрузить для планового обслуживания, вы будете уведомлены заранее. Запланированное техническое обслуживание состоит из двух этапов: этапа самообслуживания и планового этапа технического обслуживания.

Во время *фазы самообслуживания,* которая обычно длится четыре недели, вы начинаете техническое обслуживание на ваших VMs. В рамках самообслуживания вы можете запросить каждый VM, чтобы увидеть его статус и результат вашего последнего запроса на техническое обслуживание.

При запуске самостоятельного обслуживания виртуальная машина повторно развертывается на уже обновленном узле. Из-за перезагрузки VM временный диск теряется, а динамические IP-адреса, связанные с виртуальным сетевым интерфейсом, обновляются.

Если при обслуживании самообслуживания возникает ошибка, операция прекращается, VM не обновляется, и вы получаете возможность повторно гостевого обслуживания. 

По окончании фазы самообслуживания начинается *плановое обслуживание.* На этом этапе вы все еще можете запросить этап обслуживания, но вы не можете начать обслуживание самостоятельно.

Для получения дополнительной информации об управлении обслуживанием, которое требует [CLI](maintenance-notifications-cli.md)перезагрузки, [PowerShell](maintenance-notifications-powershell.md) [portal](maintenance-notifications-portal.md)см. **Handling planned maintenance notifications** 

### <a name="availability-considerations-during-scheduled-maintenance"></a>Соображения доступности во время планового обслуживания 

Если вы решили подождать до запланированного этапа обслуживания, есть несколько вещей, которые следует учитывать для поддержания максимальной доступности ваших ВМ. 

#### <a name="paired-regions"></a>Пары регионов

Каждый регион Azure в паре с другим регионом в пределах той же географической близости. Вместе они составляют пару регионов. На этапе планового обслуживания Azure обновляет только водной области пары регионов. Например, при обновлении VM в Северо-Центральном США Azure не обновляет VM в южной части Центральной США одновременно. Однако в других регионах, например в Северной Европе, обслуживание может происходить одновременно с обслуживанием в восточной части США. Чтобы лучше распределить виртуальные машины по регионам, ознакомьтесь с принципами работы пар регионов. Дополнительные сведения см. в статье [Непрерывность бизнес-процессов и аварийное восстановление в службах BizTalk: пары регионов Azure](https://docs.microsoft.com/azure/best-practices-availability-paired-regions).

#### <a name="availability-sets-and-scale-sets"></a>Группы доступности и масштабируемые наборы

При развертывании рабочей нагрузки на M-ми-классах Azure можно создать в *наборе доступности в наборе доступности,* чтобы обеспечить высокую доступность приложения. Используя наборы доступности, можно гарантировать, что во время простоя или событий обслуживания, требующих перезагрузки, доступен по крайней мере один VM.

Отдельные виртуальные машины в группе доступности могут быть распределены между максимум 20 доменами обновления. Во время планового обслуживания в любой момент времени обновляется только один домен обновления. Области обновления не обязательно обновляются последовательно. 

Виртуальные *наборы масштабов* машин — это вычислительный ресурс Azure, который можно использовать для развертывания и управления набором идентичных виртуальных технологий в качестве одного ресурса. Набор масштабов автоматически развертывается в uD, например, vMs в наборе доступности. Как и в случае с наборами доступности, при использовании наборов масштабов только один UD обновляется в любой момент времени во время планового обслуживания.

Для получения дополнительной информации о настройке вашего ИВ для высокой доступности, [см. Управление наличием ваших VMs для Windows](./windows/manage-availability.md) или соответствующей статьи для [Linux](./linux/manage-availability.md).

#### <a name="availability-zones"></a>Зоны доступности

Зоны доступности являются уникальными физическими местоположениями в регионе Azure. Каждая зона состоит из одного или нескольких центров обработки данных, оснащенных независимыми системами электроснабжения, охлаждения и сетевого взаимодействия. Чтобы обеспечить отказоустойчивость, во всех включенных регионах используются минимум три отдельные зоны. 

Зона доступности представляет собой сочетание домена неисправности и домена обновления. При создании трех или более vMs в трех зонах в регионе Azure ваши вс-технологий эффективно распределены по трем доменам неисправностей и трем доменам обновления. Платформа Azure поддерживает такое распределение между доменами обновления, чтобы виртуальные машины в различных зонах не обновлялись одновременно.

Каждое обновление инфраструктуры выкатывает зоны за зоной, в пределах одного региона. Но развертывание может происходить в зоне 1, и различное развертывание происходит в зоне 2, в то же время. Развертывания не все сериализованы. Но одно развертывание выкатывает только одну зону за один раз, чтобы уменьшить риск.

## <a name="next-steps"></a>Дальнейшие действия 

Для управления плановым обслуживанием можно использовать [Azure CLI,](maintenance-notifications-cli.md) [Azure PowerShell](maintenance-notifications-powershell.md) или [портал.](maintenance-notifications-portal.md) 