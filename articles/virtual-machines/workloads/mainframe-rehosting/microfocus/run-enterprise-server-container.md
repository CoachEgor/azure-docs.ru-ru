---
title: Выполнить Micro Focus Enterprise Server 4.0 в докер-контейнере на виртуальных машинах Azure
description: Перехвачивайте рабочие нагрузки IBM z/OS, запуская корпоративный сервер Micro Focus в контейнере Docker на виртуальных машинах Azure.
services: virtual-machines-linux
documentationcenter: ''
author: njray
ms.author: sread
ms.date: 04/02/2019
ms.topic: article
ms.service: multiple
ms.openlocfilehash: 30d99c3f4767eb50361f7074c0d508fcf309faca
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/27/2020
ms.locfileid: "61488458"
---
# <a name="run-micro-focus-enterprise-server-40-in-a-docker-container-on-azure"></a>Выполнить Micro Focus Enterprise Server 4.0 в докерном контейнере на Azure

Вы можете запустить Micro Focus Enterprise Server 4.0 в контейнере Docker на Azure. Этот учебник показывает вам, как это сделать. Он использует Windows CICS (Система контроля информации о клиентах) acctdemo демонстрации для корпоративного сервера.

Docker добавляет портативность и изоляцию в приложения. Например, можно экспортировать изображение Докера с одного Windows VM для запуска на другом или из репозитория на сервер Windows с Docker. Изображение Docker работает в новом месте с той же конфигурацией, без установки Enterprise Server. Это часть изображения. Вопросы лицензирования по-прежнему применяются.

В этом учебнике установлен **центр обработки данных Windows 2016 с виртуальным** компьютером Контейнеров (VM) из Azure Marketplace. Это VM включает в себя **Docker 18.09.0**. Приведенные ниже шаги показывают, как развернуть контейнер, запустить его, а затем подключить к нему эмулятор 3270.

## <a name="prerequisites"></a>Предварительные требования

Перед тем, как приходить к работе, ознакомьтесь с этими предпосылками:

- Подписка Azure. Если у вас еще нет подписки Azure, создайте [бесплатную учетную запись](https://azure.microsoft.com/free/?WT.mc_id=A261C142F), прежде чем начать работу.

- Программное обеспечение Micro Focus и действительная лицензия (или пробная лицензия). Если вы являетесь существующим клиентом Micro Focus, свяжитесь со своим представителем Micro Focus. В противном случае [запросите пробную версию.](https://www.microfocus.com/products/enterprise-suite/enterprise-server/trial/)

     > [!NOTE]
     > Демонстрационные файлы Docker включены в список Enterprise Server 4.0. Этот учебник\_использует\_ent\_сервер dockerfiles 4.0\_windows.zip. Доступ к нему из того же места, где вы получили доступ к файлу установки Enterprise Server, или перейдите на *Micro Focus,* чтобы начать работу.

- Документация для [корпоративного сервера и корпоративного разработчика](https://www.microfocus.com/documentation/enterprise-developer/#").

## <a name="create-a-vm"></a>Создание виртуальной машины

1. Защищайте мультимедиа\_от\_докерфайлов\_сервера ent\_4.0 windows.zip. Защищайте файл лицензирования ES-Docker-Prod-XXXXXXXX.mflic (требуется для создания изображений Docker).

2. Создайте виртуальную машину. Для этого откройте портал Azure, выберите **Создать ресурс** из левого верха и отфильтровать на *сервере Windows.* В результатах выберите **Windows Server 2016 Центр обработки данных – с контейнерами.**

     ![Результаты поиска портала Azure](media/01-portal.png)

3. Для настройки свойств для VM выберите детали экземпляра:

    1. Выберите размер виртуальной машины. Для этого учебника, рассмотреть вопрос об использовании **стандартного\_DS2 v2** VM с 2 vCPUs и 7 ГБ памяти.

    2. Выберите Группу **регионов** и **ресурсов,** в которых вы хотели бы развернуть.

    3. Для **вариантов доступности**используйте настройки по умолчанию.

    4. Для **имени пользователя**введите учетную запись администратора, которая вы хотите использовать, и пароль.

    5. Убедитесь, что **порт 3389 RDP** открыт. Только этот порт должен быть публично разоблачен, так что вы можете войти в VM. Затем примите все значения по умолчанию и нажмите **Обзор создать**.

     ![Создание виртуального машинного стекла](media/container-02.png)

4. Подождите, пока развертывание завершится (пару минут). Сообщение гласит, что ваш VM был создан.

5. Нажмите **Перейдите к ресурсу,** чтобы перейти к лезвию **обзор** для вашего VM.

6. Справа щелкните кнопку **Connect.** **Параметры подключения к виртуальной машине** отображаются справа.

7. Нажмите кнопку **Скачать RDP файл,** чтобы загрузить файл RDP, который позволяет прикрепляться к VM.

8. После того, как файл закончил загрузку, откройте его и введите имя пользователя и пароль, созданный для VM.

     > [!NOTE]
     > Не используйте корпоративные учетные данные для входиный в. (Клиент RDP предполагает, что вы можете использовать их. Вы этого не сделаете.)

9.  Выберите **больше вариантов,** а затем выберите ваши учетные данные VM.

На данный момент, VM работает и прилагается через RDP. Вы подписаны и готовы к следующему шагу.

## <a name="create-a-sandbox-directory-and-upload-the-zip-file"></a>Создайте каталог песочницы и загрузите почтовый файл

1.  Создайте каталог на VM, где вы можете загрузить демо-файлы и лицензии. Например, **C:\\Песочница**.

2.  Загрузите **файл ent\_server\_\_dockerfiles\_4.0 windows.zip** и файл **ES-Docker-Prod-XXXXXXXX.mflic** в созданный каталог.

3.  Извлеките содержимое файла застежки-молнии в каталог **\_ent server\_dockerfiles\_4.0\_Windows,** созданный процессом экстракта. Этот каталог включает файл чтения (как .html и .txt файл) и два субдиректора, **EnterpriseServer** и **примеры**.

4.  Копировать **ES-Docker-Prod-XXXXXXXXXXXX.mflic** \\к C: Песочница\\ent\_серверdockerfiles\_\_4.0\_\_windows\_\\EnterpriseServer\_и\_C:\\Песочница\\ent серверdockerfiles 4.0 windows\\Примеры\\каталогов CICS.

> [!NOTE]
> Убедитесь, что вы копируете файл лицензирования в обоих каталогах. Они необходимы для шага сборки Docker, чтобы убедиться, что изображения должным образом лицензированы.

## <a name="check-docker-version-and-create-base-image"></a>Проверьте версию Docker и создайте базовое изображение

> [!IMPORTANT]
> Создание соответствующего изображения Docker — это двухэтапный процесс. Во-первых, создайте базовое изображение Enterprise Server 4.0.Затем создайте другое изображение для платформы x64. Хотя вы можете создать изображение x86 (32 бита), используйте 64-битное изображение.

1. Откройте командную строку.

2. Проверьте, установлен ли Докер. В командной строке введите:

    ```
        docker version
    ```

     Например, версия была 18.09.0, когда это было написано.

3. Чтобы изменить каталог, введите **cd «Sandbox» ent_server_dockerfiles_4.0_windows-EnterpriseServer**.

4. Введите **bld.bat IacceptEULA,** чтобы начать процесс сборки для исходного базового изображения. Подождите несколько минут, пока этот процесс будет запущен. В результатах обратите внимание на два созданных изображения : один для x64 и один для x86:

     ![Окно команды, отображающее изображения](media/container-04.png)

5. Чтобы создать окончательное изображение для демонстрации CICS, переключитесь на каталог CICS, введя **cd\\Sandbox\\ent\_server\_dockerfiles\_4.0\_Windows\\Примеры\\CICS.**

6. Для создания изображения введите **bld.bat x64**. Подождите несколько минут, пока процесс заработает, и сообщение о том, что изображение было создано.

7. Введите **изображения докеров** для отображения списка всех изображений Докера, установленных на VM. Убедитесь, что **микрофокус/эс-акктдемо** является одним из них.

     ![Окно командования, показывающее изображение es-acctdemo](media/container-05.png)

## <a name="run-the-image"></a>Запуск образа 

1.  Для запуска Enterprise Server 4.0 и приложения acctdemo, в типе запроса команды:

    ```
         docker run -p 16002:86/tcp -p 16002:86/udp -p 9040-9050:9040-9050 -p 9000-9010:9000-9010 -ti --network="nat" --rm microfocus/es-acctdemo:win_4.0_x64
    ```

2.  Установите эмулятор терминала 3270, такой как [x3270,](http://x3270.bgp.nu/) и используйте его для присоединения через порт 9040 к работаемому изображению.

3.  Получите IP-адрес контейнера acctdemo, чтобы Docker мог выступать в качестве сервера DHCP для управляемых контейнеров:

    1.  Получите идентификатор бегущего контейнера. Тип **Docker ps** в команде подскажут и заметят ID **(22a0fe3159d0** в этом примере). Сохраните его для следующего шага.

    2.  Чтобы получить IP-адрес для контейнера acctdemo, используйте идентификатор контейнера с предыдущего шага следующим образом:

    ```
       docker inspect <containerID> --format="{{range .NetworkSettings.Networks}}{{.IPAddress}}{{end}}"
    ```

       Пример:

    ```   
        docker inspect 22a0fe3159d0 --format="{{range .NetworkSettings.Networks}}{{.IPAddress}}{{end}}"
    ```
4. Обратите внимание на IP-адрес для изображения acctdemo. Например, адрес в следующем выпуске 172.19.202.52.

     ![Окно командования с указанием IP-адреса](media/container-06.png)

5. Смонтировать изображение с помощью эмулятора. Напередите эмулятор, чтобы использовать адрес изображения acctdemo и порт 9040. Здесь, это **172.19.202.52:9040**. Ваш будет похож. Открывается экран **Signon to CICS.**

    ![Signon к экрану CICS](media/container-07.png)

6. Войдя в регион CICS, введя **SYSAD** для **USERID** и **SYSAD** для **пароля.**

7. Очистите экран, используя ключевую карту эмулятора. Для x3270 выберите опцию меню **Keymap.**

8. Для запуска приложения acctdemo введите **ACCT.** Отображается начальный экран приложения.

     ![Демо-экран учетной записи](media/container-08.png)

9. Экспериментируйте с типами учетных записей дисплея. Например, введите **D** для запроса и **11111** для **ACCOUNT**. Другие номера счетов, чтобы попробовать 22222, 33333, и так далее.

     ![Демо-экран учетной записи](media/container-09.png)

10. Для отображения консоли Enterprise Server Administration перейдите в запрос команды и введите **запуск http:172.19.202.52:86**

     ![Консоль администрирования корпоративных серверов](media/container-010.png)

Вот и все! Теперь вы работаете и управляете приложением CICS в контейнере Docker.

## <a name="next-steps"></a>Дальнейшие действия

- [Установка Micro Focus Enterprise Server 4.0 и Enterprise Developer 4.0 на Azure](./set-up-micro-focus-azure.md)
- [Перенос приложений с мейнфреймов](/azure/architecture/cloud-adoption/infrastructure/mainframe-migration/application-strategies)
