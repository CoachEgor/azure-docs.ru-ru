---
title: Запуск Micro Focus Enterprise Server 4,0 в контейнере DOCKER на виртуальных машинах Azure
description: Перемещайте рабочие нагрузки мэйнфреймов IBM z/OS, запустив Micro Focus Enterprise Server в контейнере DOCKER на виртуальных машинах Azure.
services: virtual-machines-linux
documentationcenter: ''
author: njray
ms.author: sread
ms.date: 04/02/2019
ms.topic: article
ms.service: multiple
ms.openlocfilehash: 30d99c3f4767eb50361f7074c0d508fcf309faca
ms.sourcegitcommit: f7fb9e7867798f46c80fe052b5ee73b9151b0e0b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/26/2020
ms.locfileid: "61488458"
---
# <a name="run-micro-focus-enterprise-server-40-in-a-docker-container-on-azure"></a>Запуск Micro Focus Enterprise Server 4,0 в контейнере DOCKER в Azure

Вы можете запустить Micro Focus Enterprise Server 4,0 в контейнере DOCKER в Azure. В этом руководстве показано, как это делать. В нем используется демонстрация Windows CICS (система управления сведениями о клиентах) акктдемо для Enterprise Server.

DOCKER добавляет в приложения переносимость и изоляцию. Например, можно экспортировать образ DOCKER с одной виртуальной машины Windows для запуска в другой или из репозитория в Windows Server с помощью DOCKER. Образ DOCKER выполняется в новом расположении с той же конфигурацией, без необходимости установки Enterprise Server. Он является частью образа. Рекомендации по лицензированию по-прежнему применяются.

В этом руководстве в Azure Marketplace устанавливается **Windows 2016 Datacenter с контейнерами** виртуальной машины (ВМ). Эта виртуальная машина включает **DOCKER 18.09.0**. Ниже показано, как развернуть контейнер, запустить его, а затем подключиться к нему с помощью эмулятора 3270.

## <a name="prerequisites"></a>Предварительные условия

Прежде чем приступить к работе, ознакомьтесь с этими предварительными условиями.

- Подписка Azure. Если у вас еще нет подписки Azure, создайте [бесплатную учетную запись](https://azure.microsoft.com/free/?WT.mc_id=A261C142F), прежде чем начать работу.

- Программное обеспечение Micro Focus и действующая лицензия (или лицензия на пробную версию). Если вы являетесь существующим клиентом Micro Focus, свяжитесь с вашим представителям Micro Focus. В противном случае [запросите пробную версию](https://www.microfocus.com/products/enterprise-suite/enterprise-server/trial/).

     > [!NOTE]
     > Демонстрационные файлы DOCKER включены в состав Enterprise Server 4,0. В этом руководстве используется\_ENT\_Server\_файлы dockerfile\_4,0 Windows. zip. Откройте его из того же места, где был получен доступ к файлу установки Enterprise Server, или перейдите в раздел " *Micro Focus* ", чтобы приступить к работе.

- Документация для [Enterprise Server и разработчика Enterprise](https://www.microfocus.com/documentation/enterprise-developer/#").

## <a name="create-a-vm"></a>Создание виртуальной машины

1. Защитите носитель из файла ENT\_server\_файлы dockerfile\_4,0\_Windows. zip. Обеспечьте безопасность файла лицензирования ES-DOCKER-мфлик-XXXXXXXX. (требуется для создания образов DOCKER).

2. Создайте виртуальную машину. Для этого откройте портал Azure, выберите **создать ресурс** в верхнем левом углу и отфильтруйте по *Windows Server*. В результатах выберите **Windows Server 2016 Datacenter — с контейнерами**.

     ![Результаты поиска портал Azure](media/01-portal.png)

3. Чтобы настроить свойства виртуальной машины, выберите сведения об экземпляре:

    1. Выберите размер виртуальной машины. Для работы с этим руководством рекомендуется использовать **стандартную\_** виртуальную машину DS2 v2 с 2 виртуальных ЦП и 7 ГБ памяти.

    2. Выберите **регион** и **группу ресурсов** , в которых вы хотите выполнить развертывание.

    3. Для **параметров доступности**используйте значение по умолчанию.

    4. В поле **username (имя пользователя**) введите учетную запись администратора, которую вы хотите использовать, и пароль.

    5. Убедитесь, что **порт 3389 RDP** открыт. Только этот порт должен быть общедоступным, чтобы вы могли войти на виртуальную машину. Затем примите все значения по умолчанию и нажмите кнопку **проверить и создать**.

     ![Создание области виртуальной машины](media/container-02.png)

4. Дождитесь завершения развертывания (несколько минут). Появится сообщение о том, что виртуальная машина создана.

5. Щелкните **"переход к ресурсу** ", чтобы открыть колонку " **Обзор** " для виртуальной машины.

6. Справа нажмите кнопку **подключить** . Параметры **Подключение к виртуальной машине** отображаются справа.

7. Нажмите кнопку **скачать RDP-файл** , чтобы скачать RDP-файл, который позволяет присоединиться к виртуальной машине.

8. После завершения загрузки файла откройте его и введите имя пользователя и пароль, созданные для виртуальной машины.

     > [!NOTE]
     > Не используйте корпоративные учетные данные для входа. (Предполагается, что клиент RDP может использовать эти данные. Это не так.)

9.  Выберите **Дополнительные параметры**, а затем выберите учетные данные виртуальной машины.

На этом этапе виртуальная машина работает и подключена через RDP. Вы вошли и готовы к следующему шагу.

## <a name="create-a-sandbox-directory-and-upload-the-zip-file"></a>Создание каталога "песочницы" и отправка Zip-файла

1.  Создайте каталог на виртуальной машине, где можно передать файлы демонстрационной версии и лицензии. Например, **C:\\песочницей**.

2.  Отправьте **файл\_ent\_Server\_файлы dockerfile\_4,0 Windows. zip** и **ES-DOCKER--XXXXXXXX. мфлик** в созданный каталог.

3.  Извлеките содержимое ZIP-файла в каталог **Windows ENT\_Server\_файлы dockerfile\_4,0\_** , созданный процессом извлечения. Этот каталог содержит файл сведений (в формате HTML и txt) и два подкаталога, **ентерприсесервер** и **примеры**.

4.  Скопируйте **ES-DOCKER-мфлик-XXXXXXXX.** \\в папку C: sandbox\\ENT\_Server\_файлы dockerfile\_4,0\_Windows\\ентерприсесервер and C:\\Песочница\\ENT\_Server\_файлы dockerfile\_4,0\_Windows\\examples\\CICS Directories.

> [!NOTE]
> Обязательно скопируйте файл лицензирования в оба каталога. Они необходимы для этапа сборки DOCKER, чтобы убедиться, что образы должным образом лицензированы.

## <a name="check-docker-version-and-create-base-image"></a>Проверка версии DOCKER и создание базового образа

> [!IMPORTANT]
> Создание соответствующего образа DOCKER — это двухэтапный процесс. Сначала создайте базовый образ Enterprise Server 4,0.Затем создайте еще один образ для платформы x64. Несмотря на то, что можно создать образ x86 (32-bit), используйте 64-разрядный образ.

1. Откройте командную строку.

2. Убедитесь, что DOCKER установлен. В командной строке введите:

    ```
        docker version
    ```

     Например, при написании этой версии была 18.09.0.

3. Чтобы изменить каталог, введите **CD \сандбокс\ ent_server_dockerfiles_4.0_windows \ентерприсесервер**.

4. Введите **BLD. bat иакцептеула** , чтобы начать процесс сборки для первоначального базового образа. Подождите несколько минут, пока этот процесс будет выполнен. В результатах Обратите внимание на два созданных образа — один для x64 и один для x86:

     ![командное окно отображения изображений](media/container-04.png)

5. Чтобы создать окончательный образ для демонстрации CICS, перейдите в каталог CICS, введя команду **CD\\\\Песочница ENT\_Server\_файлы dockerfile\_4,0\_Windows\\examples\\CICS**.

6. Чтобы создать образ, введите " **BLD. bat x64**". Подождите несколько минут, пока процесс будет выполнен, и сообщение о том, что образ был создан.

7. Введите **образы DOCKER** , чтобы отобразить список всех образов DOCKER, установленных на виртуальной машине. Убедитесь, что для **микрофокуса/ES-акктдемо** один из них.

     ![Командное окно изображения ES-акктдемо](media/container-05.png)

## <a name="run-the-image"></a>Запуск образа 

1.  Чтобы запустить Enterprise Server 4,0 и приложение акктдемо, в командной строке введите:

    ```
         docker run -p 16002:86/tcp -p 16002:86/udp -p 9040-9050:9040-9050 -p 9000-9010:9000-9010 -ti --network="nat" --rm microfocus/es-acctdemo:win_4.0_x64
    ```

2.  Установите эмулятор терминала 3270, например [x3270](http://x3270.bgp.nu/) , и используйте его для подключения через порт 9040 к образу, который работает.

3.  Получите IP-адрес контейнера акктдемо, чтобы служба DOCKER могла работать в качестве DHCP-сервера для контейнеров, которыми он управляет:

    1.  Возвращает идентификатор выполняющегося контейнера. Введите **DOCKER PS** в командной строке и запишите идентификатор (**22a0fe3159d0** в этом примере). Сохраните его для следующего шага.

    2.  Чтобы получить IP-адрес для контейнера акктдемо, используйте идентификатор контейнера из предыдущего шага следующим образом:

    ```
       docker inspect <containerID> --format="{{range .NetworkSettings.Networks}}{{.IPAddress}}{{end}}"
    ```

       Пример:

    ```   
        docker inspect 22a0fe3159d0 --format="{{range .NetworkSettings.Networks}}{{.IPAddress}}{{end}}"
    ```
4. Запишите IP-адрес для образа акктдемо. Например, адрес в следующем выводе — 172.19.202.52.

     ![командное окно отображения IP-адреса](media/container-06.png)

5. Подключите образ с помощью эмулятора. Настройте эмулятор для использования адреса образа акктдемо и порта 9040. Здесь это **172.19.202.52:9040**. Ваш вид будет похожим. Откроется экран **Signon to CICS** .

    ![Signon на CICS экран](media/container-07.png)

6. Войдите в регион CICS, введя **СИСАД** для **UserID** и **СИСАД** в качестве **пароля**.

7. Очистите экран, используя кэймап эмулятора. Для x3270 выберите пункт меню " **кэймап** ".

8. Чтобы запустить приложение акктдемо, введите **acct**. Отобразится начальный экран приложения.

     ![Экран демонстрации учетной записи](media/container-08.png)

9. Поэкспериментируйте с отображением типов учетных записей. Например, введите **D** для запроса и **11111** для **учетной записи**. Другие номера учетных записей для попыток — 22222, 33333 и т. д.

     ![Экран демонстрации учетной записи](media/container-09.png)

10. Чтобы отобразить консоль администрирования Enterprise Server, откройте командную строку и введите команду **start http: 172.19.202.52:86.**

     ![Консоль администрирования Enterprise Server](media/container-010.png)

Вот и все! Теперь вы используете приложение CICS и управляете им в контейнере DOCKER.

## <a name="next-steps"></a>Следующие шаги

- [Установка Micro Focus Enterprise Server 4,0 и Enterprise Developer 4,0 в Azure](./set-up-micro-focus-azure.md)
- [Перенос приложений с мейнфреймов](/azure/architecture/cloud-adoption/infrastructure/mainframe-migration/application-strategies)
