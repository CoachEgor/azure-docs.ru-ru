---
title: Перемещение мейнфреймов в виртуальные машины Azure
description: Ресурсы Azure сравнивают ресурсы с мэйнфреймом, чтобы можно было мигрировать и модернизировать приложения IBM z14.
author: njray
ms.author: larryme
ms.date: 04/02/2019
ms.topic: article
ms.service: multiple
ms.openlocfilehash: 97f354d0a313d58c671366dd0e5f485504823e13
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/27/2020
ms.locfileid: "76288937"
---
# <a name="move-mainframe-compute-to-azure"></a>Перемещение мейнфреймов в Azure

Mainframes имеют репутацию высокой надежности и доступности и продолжают оставаться надежным костяком многих предприятий. Они часто думают, что почти безграничная масштабируемость и вычислительная мощность, а также. Тем не менее, некоторые предприятия переросли возможности крупнейших доступных мэйнфреймов. Если это похоже на вас, Azure предлагает гибкость, охват и экономию инфраструктуры.

Для выполнения рабочих нагрузок мейнфреймов в Microsoft Azure необходимо знать, как вычислительные возможности мейнфрейма соотносятся с возможностями Azure. На основе мейнфрейма IBM z14 (самая актуальная модель на момент написания настоящего письма) в этой статье рассказывается о том, как получить сопоставимые результаты на Azure.

Чтобы начать работу, рассмотрим среды бок о бок. Следующая цифра сравнивает среду мейнфрейма для работы приложений с средой хостинга Azure.

![Службы Azure и среды эмуляции обеспечивают сопоставимую поддержку и упрощают миграцию](media/mainframe-compute-azure.png)

Мощность мэйнфреймов часто используется для онлайн-обработки транзакций (OLTP) систем, которые обрабатывают миллионы обновлений для тысяч пользователей. Эти приложения часто используют программное обеспечение для обработки транзакций, обработки экрана и ввода формы. Они могут использовать систему контроля информации о клиентах (CICS), систему управления информацией (IMS) или пакет интерфейса транзакций (TIP).

Как видно на рисунке, эмулятор TPM на Azure может обрабатывать рабочие нагрузки CICS и IMS. Эмулятор пакетной системы на Azure выполняет роль языка управления работой (JCL). Данные мейнфрейма мигрируют в базы данных Azure, такие как база данных Azure S'L. Для управления системой можно использовать сервисы Azure или другое программное обеспечение, размещенные в виртуальных машинах Azure.

## <a name="mainframe-compute-at-a-glance"></a>Мейнфрейм вычислить с первого взгляда

В мейнфрейме z14 процессоры расположены в четырех *ящиках.* *Ящик* — это просто кластер процессоров и чипсетов. Каждый ящик может иметь шесть активных чипов центрального процессора (CP), и каждый CP имеет 10 чипов системного контроллера (SC). В терминологии Intel x86 имеется шесть розеток на ящик, 10 ядер на розетку и четыре ящика. Эта архитектура обеспечивает грубый эквивалент 24 розеток и 240 ядер, максимум, для z14.

Быстрый z14 CP имеет скорость часов 5,2 ГГц. Как правило, z14 поставляется со всеми CPs в коробке. Они активированы по мере необходимости. Клиент обычно взимается по крайней мере четыре часа вычислительного времени в месяц, несмотря на фактическое использование.

Процессор мэйнфрейма можно настроить как один из следующих типов:

- Процессор общего назначения (GP)
- Комплексный информационный процессор System z (zIIP)
- Интегрированный процессор для Linux (IFL)
- Системный процессор помощи (SAP)
- Интегрированный процессор coupling Facility (ICF)

## <a name="scaling-mainframe-compute-up-and-out"></a>Масштабирование мейнфреймов вычисляется вверх и выход

Мейнфреймы IBM предлагают возможность масштабирования до 240 ядер (текущий размер z14 для одной системы). Кроме того, мэйнфреймы IBM могут масштабироваться с помощью функции, называемой Coupling Facility (CF). CF позволяет нескольким мэйнфреймным системам одновременно получить доступ к тем же данным. Используя CF, технология Parallel Sysplex группирует мейнфреймы процессоров в кластерах. Когда это руководство было написано, функция Parallel Sysplex поддерживала 32 группы из 64 процессоров каждая. Таким образом можно сгруппировать до 2048 процессоров для масштабирования вычислительной мощности.

CF позволяет вычислительным кластерам обмениваться данными с прямым доступом. Он используется для блокировки информации, кэша и списка общих ресурсов данных. Параллельный Sysplex, использующий один или несколько CFs, можно рассматривать как масштабирование кластера «общее все». Для получения более подробной [Parallel Sysplex on IBM Z](https://www.ibm.com/it-infrastructure/z/technologies/parallel-sysplex-resources) информации об этих функциях см.

Приложения могут использовать эти функции для обеспечения как масштабирования, так и высокой доступности. Для получения информации о том, как CICS может использовать Parallel Sysplex с CF, загрузите [IBM CICS и переоборажённый фонд: Beyond the Basics.](https://www.redbooks.ibm.com/redbooks/pdfs/sg248420.pdf)

## <a name="azure-compute-at-a-glance"></a>Azure вычисляет с первого взгляда

Некоторые люди ошибочно думают, что серверы на базе Intel не так сильны, как мэйнфреймы. Тем не менее, новые основные системы на базе Intel имеют такой же вычислительной мощности, как и мэйнфреймы. В этом разделе описаны параметры инфраструктуры Azure как службы (IaaS) для вычислений и хранения. Azure также предоставляет параметры платформы как службы (PaaS), но в этой статье основное внимание уделяется выбору IaaS, обеспечивающим сопоставимую емкость мэйнфрейма.

Виртуальные машины Azure обеспечивают вычислительную мощность в различных размерах и типах. В Azure виртуальный процессор (VCPU) примерно приравнивается к ядру на мэйнфрейме.

В настоящее время диапазон размеров виртуальной машины Azure обеспечивает от 1 до 128 vCPUs. Типы виртуальных машин (VM) оптимизированы для определенных рабочих нагрузок. Например, в следующем списке показаны типы VM (текущий на момент написания настоящего письма) и рекомендуемые методы использования:

| Размер     | Тип и описание                                                                 |
|----------|--------------------------------------------------------------------------------------|
| D-серия | Общее назначение с 64 vCPU и до скорости часов 3,5 ГГц                           |
| E-серия | Память оптимизирована до 64 vCPUs                                                 |
| F-серия | Вычислительная оптимизирована с частотой часов до 64 vCPUs и частотой часов 3,7 ГГц                       |
| H-серия | Оптимизирован для высокопроизводительных вычислительных (HPC) приложений                          |
| L-серия | Хранение, оптимизированное для приложений с высокой пропускной памятью, опирайаемых на базы данных, такие как НоСЗЛ |
| Серия M | Крупнейшие вычислительные и оптимизированные vMs-компьютеры с до 128 vCPUs                        |

Для получения подробной информации о доступных Виртуальных VMs, [см.](https://azure.microsoft.com/pricing/details/virtual-machines/series/)

Мэйнфрейм z14 может иметь до 240 ядер. Тем не менее, mainframes z14 почти никогда не используют все ядра для одного приложения или рабочей нагрузки. Вместо этого мэйнфрейм сегрегирует рабочие нагрузки на логические разделы (LPARs), а LpARs имеют рейтинги-MIPS (Миллионы инструкций за второй) или МГУ (Миллион сервисная группа). При определении сопоставимого размера VM, необходимого для выполнения рабочей нагрузки на Azure, учитываются рейтинг MIPS (или MSU).

Ниже приведены общие оценки:

-   150 MIPS за VCPU

-   1000 MIPS на процессор

Чтобы определить правильный размер VM для заданной рабочей нагрузки в LPAR, сначала оптимизируйте VM для рабочей нагрузки. Затем определите количество необходимых vCP. Консервативная оценка составляет 150 MIPS за VCPU. На основе этой оценки, например, VM F-серии с 16 vCPUs может легко поддерживать рабочую нагрузку IBM Db2, поступающую от LPAR с 2400 MIPS.

## <a name="azure-compute-scale-up"></a>Масштабирование вычислений Azure

M-серии VMs могут масштабироваться до 128 vCPUs (на момент написания этой статьи). Используя консервативную оценку 150 MIPS за VCPU, M-серия VM приравнивается к около 19000 MIPS. Общее правило для оценки MIPS для мэйнфрейма составляет 1000 MIPS на процессор. Мейнфрейм z14 может иметь до 24 процессоров и обеспечить около 24 000 MIPS для одной мэйнфреймовой системы.

Самый большой мейнфрейм z14 имеет примерно на 5000 MIPS больше, чем самый большой VM, доступный в Azure. Однако важно сравнить, как развертываются рабочие нагрузки. Если система мэйнфрейма имеет как приложение, так и соотношения базы данных, они обычно развертываются на одном физическом мэйнфрейме – каждый в своем собственном LPAR. Одно и то же решение на Azure часто развертывается с использованием одного VM для приложения и отдельного VM для базы данных.

Например, если система M64 vCPU поддерживает приложение, а для базы данных используется M96 vCPU, необходимо около 150 vCP, или около 24 000 MIPS, как показано на следующем рисунке.

![Сравнение рабочих развертываний 24 000 MIPS](media/mainframe-compute-mips.png)

Подход заключается в переносе ЛПАРов на отдельные ВМ. Затем Azure легко масштабируется до размера, необходимого для большинства приложений, развернутых в одной системе мэйнфрейма.

## <a name="azure-compute-scale-out"></a>Масштабaz-масштаб Azure

Одним из преимуществ решения на основе Azure является возможность масштабирования. Масштабирование делает практически безграничную вычислительную емкость доступной для приложения. Azure поддерживает несколько методов для масштабирования вычислительной мощности:

- **Нагрузка балансировки между кластером.** В этом случае приложение может использовать [балансомер нагрузки](/azure/load-balancer/load-balancer-overview) или менеджер ресурсов для распределения рабочей нагрузки между несколькими ВМ в кластере. При необходимости увеличения вычислительной мощности в кластер добавляются дополнительные ВМ.

- **Наборы виртуального масштаба машины.** В этом сценарии всплеска приложение может масштабироваться до дополнительных [вычислительных ресурсов](/azure/virtual-machine-scale-sets/overview) на основе использования VM. При падении спроса количество вс-м в группах также может снизиться, обеспечивая эффективное использование вычислительной мощности.

- **Масштабирование PaaS.** Предложения Azure PaaS масштабируют вычислительные ресурсы. Например, [Служба обслуживания Azure](/azure/service-fabric/service-fabric-overview) распределяет вычислительные ресурсы для удовлетворения увеличения объема запросов.

- **Кластеры Кубернете.** Приложения в Azure могут использовать [кластеры Kubernetes](/azure/aks/concepts-clusters-workloads) для вычисления служб для определенных ресурсов. Служба Azure Kubernetes (AKS) — управляемая служба, которая управляет узлами, пулами и кластерами Kubernetes в Azure.

Чтобы выбрать правильный метод масштабирования вычислительных ресурсов, важно понять, чем отличаются Azure и мэйнфреймы. Ключевым моментом является то, как данные и если они передаются вычислительными ресурсами. В Azure данные (по умолчанию) обычно не передаются нескольким ими. Если обмен данными требуется несколькими вс-мизантами в масштабированном вычислительном кластере, общие данные должны находиться в ресурсе, поддерживающем эту функциональность. В Azure обмен данными предполагает хранение при обсуждении в следующем разделе.

## <a name="azure-compute-optimization"></a>Оптимизация вычислений Azure

Можно оптимизировать каждый уровень обработки в архитектуре Azure. Используйте наиболее подходящий тип VMs и функций для каждой среды. На следующем рисунке показан один потенциальный шаблон для развертывания ВМ в Azure для поддержки приложения CICS, использующее Db2. На основном сайте виртуальные машины для производственной, подготовительной и тестовой версии приложения развертываются с высоким уровнем доступности. Дополнительный сайт используется для резервного копирования и аварийного восстановления.

Каждый уровень может также предоставлять соответствующие службы аварийного восстановления. Например, для виртуальных машин, используемых в рабочей среде, и виртуальных машин с базами данных, возможно, потребуется "горячее" или "теплое" восстановление. А виртуальные машины для разработки и тестирования поддерживают "холодное" восстановление.

![Высокодоступное развертывание, поддерживающее аварийное восстановление](media/mainframe-compute-dr.png)

## <a name="next-steps"></a>Дальнейшие действия

- [Миграция мейнфреймов](/azure/architecture/cloud-adoption/infrastructure/mainframe-migration/overview)
- [Мейнфрейм rehosting на Azure виртуальных машин](/azure/virtual-machines/workloads/mainframe-rehosting/overview)
- [Перемещение хранилища мэйнфрейма в Azure](mainframe-storage-Azure.md)

### <a name="ibm-resources"></a>Ресурсы IBM

- [Параллельный Sysplex на IBM](https://www.ibm.com/it-infrastructure/z/technologies/parallel-sysplex-resources)
- [IBM CICS и механизм объединения: помимо основ](https://www.redbooks.ibm.com/redbooks/pdfs/sg248420.pdf)
- [Создание обязательных пользователей для установки Db2 pureScale Feature](https://www.ibm.com/support/knowledgecenter/en/SSEPGG_11.1.0/com.ibm.db2.luw.qb.server.doc/doc/t0055374.html?pos=2)
- [Db2icrt: команда для создания экземпляра](https://www.ibm.com/support/knowledgecenter/en/SSEPGG_11.1.0/com.ibm.db2.luw.admin.cmd.doc/doc/r0002057.html)
- [Db2 чистомасштабное кластерное решение для баз данных](https://www.ibmbigdatahub.com/blog/db2-purescale-clustered-database-solution-part-1)
- [IBM Data Studio](https://www.ibm.com/developerworks/downloads/im/data/index.html/)

### <a name="azure-government"></a>Azure для государственных организаций

- [Облако правительства Microsoft Azure для приложений с мэйнфреймом](https://azure.microsoft.com/resources/microsoft-azure-government-cloud-for-mainframe-applications/)
- [Microsoft и FedRAMP](https://www.microsoft.com/TrustCenter/Compliance/FedRAMP)

### <a name="more-migration-resources"></a>Дополнительные миграционные ресурсы

- [Виртуальный центр обработки данных Azure: руководство по миграции методом lift-and-shift](https://azure.microsoft.com/resources/azure-virtual-datacenter-lift-and-shift-guide/)
- [iSCSI GlusterFS](https://docs.gluster.org/en/latest/Administrator%20Guide/GlusterFS%20iSCSI/)
