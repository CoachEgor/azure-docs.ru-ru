---
title: Масштабирование приложений HPC - виртуальных машинах Azure | Документация Майкрософт
description: Сведения о масштабировании приложений HPC на виртуальных машинах Azure.
services: virtual-machines
documentationcenter: ''
author: vermagit
manager: jeconnoc
editor: ''
tags: azure-resource-manager
ms.service: virtual-machines
ms.workload: infrastructure-services
ms.topic: article
ms.date: 05/15/2019
ms.author: amverma
ms.openlocfilehash: e2e2476449f956361639e42e7c398e53e42d44ab
ms.sourcegitcommit: d4dfbc34a1f03488e1b7bc5e711a11b72c717ada
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/13/2019
ms.locfileid: "66810117"
---
# <a name="scaling-hpc-applications"></a>Масштабирование приложений HPC

Оптимальной производительности вертикальное и горизонтальное масштабирование приложений HPC в Azure требуется настройка производительности и оптимизации эксперименты для конкретной рабочей нагрузки. В этом разделе и страницы, характерные для ряда виртуальных Машин предоставляют общие рекомендации по масштабированию приложений.

## <a name="compiling-applications"></a>Компиляция приложений

То, что это не обязательно, компиляция приложений с флагами соответствующих оптимизация обеспечивает лучшую производительность вертикального масштабирования на HB и виртуальные машины серии гибридного подключения.

### <a name="amd-optimizing-cc-compiler"></a>AMD, оптимизация C /C++ компилятора

Оптимизация C AMD /C++ компилятор (AOCC) компилятора система предлагает высокую степень оптимизации расширенный, многопоточности и поддержка процессоров, включающий глобальная оптимизация, Векторизация, межпроцедурные анализа, цикл преобразования, и Создание кода. Двоичные файлы компилятора AOCC подходят для систем Linux, с библиотека C GNU версии 2.17 (glibc версии от) и более поздних версий. В компилятор набор состоит из C /C++ компилятор (clang), Fortran compiler (FLANG) и Fortran внешнего интерфейса до Clang (Dragon Egg).

### <a name="clang"></a>Clang

Clang является C, C++и Objective-C компилятора обработки предварительной обработки, синтаксический анализ, оптимизацию, создание кода, сборки и компоновки. Clang поддерживает `-march=znver1` флаг, включающий лучшие создание кода и настройке для AMD Zen на основе x86 архитектуры.

### <a name="flang"></a>FLANG

Компилятор FLANG возможность появился только недавно в набор AOCC (добавляется апреля 2018 г.) и в настоящее время находится в предварительной версии для разработчиков загрузить и проверить. Исходя из Fortran 2008, AMD расширяет GitHub версию FLANG (https://github.com/flangcompiler/flang). Компилятор FLANG поддерживает все параметры компилятора Clang и дополнительное количество FLANG параметры компилятора.

### <a name="dragonegg"></a>DragonEgg

DragonEgg представляют собой gcc подключаемый модуль, который заменяет Оптимизаторы GCC и генераторы кода из проекта LLVM. DragonEgg, входящий в состав AOCC работает с gcc-4.8.x был протестирован для целевых объектов x86-32/x86-64 и был успешно использован для различных платформ для Linux.

GFortran является фактический внешний интерфейс для программы Fortran, ответственного за предварительную обработку, синтаксический анализ и семантический анализ, Создание промежуточного представления GCC GIMPLE (IR). DragonEgg — это подключаемый модуль GNU, подключить GFortran компиляции потока. Она реализует GNU API подключаемого модуля. С архитектурой подключаемый модуль DragonEgg становится драйвера компилятора, обеспечивая тем самым различные фазы компиляции.  После выполнения инструкций, загрузки и установки, Dragon которого можно вызывать с помощью: 

```bash
$ gfortran [gFortran flags] 
   -fplugin=/path/AOCC-1.2-Compiler/AOCC-1.2-     
   FortranPlugin/dragonegg.so [plugin optimization flags]     
   -c xyz.f90 $ clang -O3 -lgfortran -o xyz xyz.o $./xyz
```
   
### <a name="pgi-compiler"></a>PGI компилятора
PGI Community Edition ver. для работы с AMD EPYC подтверждено 17. Скомпилированный PGI версию ПОТОКА доставки пропускной способности всей памяти платформы. Аналогичным образом должен подойти более новые Community Edition 18.10 (ноября 2018 г.). Ниже приведен пример интерфейса командной строки для компилятора оптимально с помощью компилятора Intel.

```bash
pgcc $(OPTIMIZATIONS_PGI) $(STACK) -DSTREAM_ARRAY_SIZE=800000000 stream.c -o stream.pgi
```

### <a name="intel-compiler"></a>Компилятор Intel
Версии компилятора Intel для работы с AMD EPYC подтверждено 18. Ниже приведен пример интерфейса командной строки для компилятора оптимально с помощью компилятора Intel.

```bash
icc -o stream.intel stream.c -DSTATIC -DSTREAM_ARRAY_SIZE=800000000 -mcmodel=large -shared-intel -Ofast –qopenmp
```

### <a name="gcc-compiler"></a>Компилятора GCC 
Для HPC AMD рекомендует компилятора GCC 7.3 или более поздней версии. Более старые версии, например 4.8.5, включенные в RHEL и CentOS 7.4, не рекомендуется. GCC 7.3 и более поздних обеспечивает значительно более высокую производительность на HPL, HPCG и DGEMM тестов.

```bash
gcc $(OPTIMIZATIONS) $(OMP) $(STACK) $(STREAM_PARAMETERS) stream.c -o stream.gcc
```

## <a name="scaling-applications"></a>Масштабирование приложений 

Для оптимальной приложения, масштабирование, эффективности, производительности и согласованности применяются следующие рекомендации:

* ПИН-код обрабатывает ядер 0-59 использованию последовательного закрепляющий подход (в отличие от балансировки автоматически подход). 
* Привязка по Numa/Core/HwThread лучше, чем привязка по умолчанию.
* Для гибридных параллельных приложений (OpenMP + MPI) используйте потоков — 4 и 1 ранг MPI на CCX.
* Для чистых приложений MPI Поэкспериментируйте с 1 – 4, который определяет ранг MPI на CCX для обеспечения оптимальной производительности.
* Некоторые приложения с extreme чувствительности к пропускной способности памяти выгоден с помощью меньшего числа ядер на CCX. Для этих приложений используя 3 или 2 ядрами в расчете на CCX может уменьшить количество конфликтов пропускной способности памяти и дает более высокую производительность реальных или более согласованным масштабируемости. В частности такие MPI может выиграть от этого.
* Значительно больше запусков масштабирования рекомендуется использовать транспорт, RC + домене обновления UD или гибридной. Многие библиотеки библиотек и сред выполнения MPI этого внутренним образом (например, UCX или MVAPICH2). Проверьте конфигурации транспорта для крупномасштабных запусков.

## <a name="next-steps"></a>Дальнейшие действия

Дополнительные сведения о [HPC](https://docs.microsoft.com/azure/architecture/topics/high-performance-computing/) в Azure.
