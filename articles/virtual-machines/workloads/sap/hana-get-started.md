---
title: Краткое руководство по установке одного экземпляра SAP HANA вручную на виртуальных машинах Azure | Документация Майкрософт
description: Краткое руководство по установке одного экземпляра SAP HANA вручную на виртуальных машинах Azure
services: virtual-machines-linux
documentationcenter: ''
author: hermanndms
manager: gwallace
editor: ''
tags: azure-resource-manager
keywords: ''
ms.assetid: c51a2a06-6e97-429b-a346-b433a785c9f0
ms.service: virtual-machines-linux
ms.topic: article
ms.tgt_pltfrm: vm-linux
ms.workload: infrastructure-services
ms.date: 09/06/2018
ms.author: hermannd
ms.openlocfilehash: 630f094ffc6c57a0137d1abc46476f5abe64f616
ms.sourcegitcommit: 8074f482fcd1f61442b3b8101f153adb52cf35c9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/22/2019
ms.locfileid: "72750371"
---
# <a name="quickstart-manual-installation-of-single-instance-sap-hana-on-azure-virtual-machines"></a>Краткое руководство. Ручная установка SAP HANA с одним экземпляром на виртуальных машинах Azure
## <a name="introduction"></a>Общие сведения
Это руководством поможет вам настроить SAP HANA на виртуальных машинах Azure с одним экземпляром при установке SAP NetWeaver 7,5 и SAP HANA 1,0 SP12 вручную. Основное внимание в этом руководство посвящено развертыванию SAP HANA в Azure. Она не заменяет документацию по SAP. 

> [!NOTE]
> Это руководство описывает развертывание SAP HANA на виртуальных машинах Azure. Сведения о развертывании SAP HANA в крупных экземплярах HANA см. в статье [использование SAP на виртуальных машинах Azure](https://docs.microsoft.com/azure/virtual-machines/workloads/sap/get-started).
 
## <a name="prerequisites"></a>Технические условия
В этом руководство предполагается, что вы знакомы с основами инфраструктуры как услуги (IaaS) следующим образом:
 * Развертывание виртуальных машин (ВМ) или виртуальных сетей с помощью портал Azure или PowerShell.
 * Кросс-платформенный интерфейс командной строки (CLI) Azure, который включает возможность использования шаблонов нотация объектов JavaScript (JSON).

Кроме того, в этом руководство предполагается, что вы знакомы с:
* SAP HANA и SAP NetWeaver и их локальная установка.
* Установка и работа SAP HANA и экземпляров приложений SAP в Azure.
* Основные понятия и процедуры.
   * Планирование развертывания SAP в Azure, включающее Планирование виртуальных сетей Azure и использование хранилища Azure. См. раздел [SAP NetWeaver на виртуальных машинах Azure — руководством по планированию и реализации](https://docs.microsoft.com/azure/virtual-machines/workloads/sap/planning-guide).
   * Принципы и способы развертывания виртуальных машин в Azure. См. статью [Развертывание программного обеспечения SAP на виртуальных машинах Azure](https://docs.microsoft.com/azure/virtual-machines/workloads/sap/deployment-guide).
   * Высокий уровень доступности для SAP NetWeaver ABAP SAP Central Services (ASCS), службы SAP Central Services (SCS) и сервер репликации в очереди (ERS) в Azure. См. статью [Высокий уровень доступности SAP NetWeaver на виртуальных машинах Azure](https://docs.microsoft.com/azure/virtual-machines/workloads/sap/high-availability-guide).
   * Сведения о том, как повысить эффективность установки с несколькими идентификаторами безопасности в ASCS/SCS в Azure. См. статью [Создание конфигурации с несколькими идентификаторами безопасности SAP NetWeaver](https://docs.microsoft.com/azure/virtual-machines/workloads/sap/high-availability-multi-sid). 
   * Принципы работы SAP NetWeaver на виртуальных машинах Linux в Azure. См. раздел [Запуск SAP NetWeaver на виртуальных машинах SUSE Linux Microsoft Azure](https://docs.microsoft.com/azure/virtual-machines/workloads/sap/suse-quickstart). В этом разделе приведены конкретные параметры для Linux на виртуальных машинах Azure. Здесь также приводятся сведения о том, как правильно подключить диски хранилища Azure к виртуальным машинам Linux.

Типы виртуальных машин Azure, которые можно использовать для производственных сценариев, можно найти [в документации SAP для IAAS](https://www.sap.com/dmc/exp/2014-09-02-hana-hardware/enEN/iaas.html). Для непроизводственных сценариев доступен более широкий спектр собственных типов виртуальных машин Azure.
Дополнительные сведения о конфигурации и операциях виртуальной машины см. [в статье SAP HANA конфигурациям и операциям инфраструктуры в Azure](https://docs.microsoft.com/azure/virtual-machines/workloads/sap/hana-vm-operations).
Сведения о высокой доступности SAP HANA см. в статье [SAP HANA высокая доступность для виртуальных машин Azure](https://docs.microsoft.com/azure/virtual-machines/workloads/sap/sap-hana-availability-overview).

Если вы хотите быстро развернуть SAP HANA экземпляр или S/4HANA или BW/4HANA, рассмотрите возможность использования [библиотеки SAP Cloud Appliance Library](https://cal.sap.com). Документацию по развертыванию системы S/4HANA см. в статье как использовать библиотеку SAP Cloud Appliance Library в Azure, например в [этом руководстве](https://docs.microsoft.com/azure/virtual-machines/workloads/sap/cal-s4h). Вам потребуется только подписка Azure и пользователь SAP, которые могут быть зарегистрированы в библиотеке SAP Cloud Appliance.

## <a name="additional-resources"></a>Дополнительные ресурсы
### <a name="sap-hana-backup"></a>Резервное копирование SAP HANA
Сведения о резервном копировании баз данных SAP HANA на виртуальных машинах Azure см. в следующих статьях:
* [Инструкции по резервному копированию для SAP HANA на виртуальных машинах Azure](https://docs.microsoft.com/azure/virtual-machines/workloads/sap/sap-hana-backup-guide).
* [SAP HANA Azure Backup на уровне файлов](https://docs.microsoft.com/azure/virtual-machines/workloads/sap/sap-hana-backup-file-level).
* [SAP HANA резервную копию на основе моментальных снимков хранилища](https://docs.microsoft.com/azure/virtual-machines/workloads/sap/sap-hana-backup-storage-snapshots).

### <a name="sap-cloud-appliance-library"></a>Библиотека SAP Cloud Appliance Library
Сведения о том, как использовать библиотеку SAP Cloud Appliance для развертывания S/4HANA или BW/4HANA, см. [в статье Развертывание SAP s/4HANA или BW/4HANA на Microsoft Azure](https://docs.microsoft.com/azure/virtual-machines/workloads/sap/cal-s4h).

### <a name="sap-hana-supported-operating-systems"></a>Операционные системы, поддерживаемые платформой SAP HANA
Дополнительные сведения об операционных системах, поддерживаемых SAP HANA, см. в статье [SAP Note 2235581-SAP Hana: Поддерживаемые операционные системы](https://launchpad.support.sap.com/#/notes/2235581/E). На виртуальных машинах Azure поддерживаются только эти операционные системы. Следующие операционные системы поддерживаются для развертывания SAP HANA в Azure: 

* SUSE Linux Enterprise Server 12.x;
* Red Hat Enterprise Linux 7.2

Дополнительную документацию SAP по платформе SAP HANA и разным дистрибутивах Linux см. по ссылкам ниже.

* [Примечание sap 171356: Общие сведения о программном обеспечении SAP в Linux](https://launchpad.support.sap.com/#/notes/1984787).
* [Примечание SAP 1944799. SAP HANA рекомендации по установке операционной системы SLES](http://service.sap.com/sap/support/notes/1944799).
* [Примечание SAP 2205917 SAP HANA. Рекомендуемые параметры ОС для SLES 12 для приложений SAP](https://launchpad.support.sap.com/#/notes/2205917/E).
* [Примечание SAP 1391070. решения UUID Linux](https://launchpad.support.sap.com/#/notes/1391070).
* [Примечание SAP 2009879. рекомендации по SAP HANA для операционной системы Red Hat Enterprise Linux (RHEL)](https://launchpad.support.sap.com/#/notes/2009879).
* [Примечание SAP 2292690. SAP HANA DB: Рекомендуемые параметры ОС для RHEL 7](https://launchpad.support.sap.com/#/notes/2292690/E).

### <a name="sap-monitoring-in-azure"></a>Мониторинг SAP в Azure
Сведения о мониторинге SAP в Azure:

* [Примечание SAP 2191498](https://launchpad.support.sap.com/#/notes/2191498/E) обсуждает Улучшенное наблюдение SAP с виртуальными машинами Linux в Azure. 
* [Примечание SAP 1102124](https://launchpad.support.sap.com/#/notes/1102124/E) обсуждаются сведения о SAPOSCOL в Linux. 
* [Примечание SAP 2178632](https://launchpad.support.sap.com/#/notes/2178632/E) обсуждаются ключевые показатели мониторинга для SAP на Microsoft Azure.

### <a name="azure-vm-types"></a>Типы виртуальных машин Azure
Типы виртуальных машин Azure и сценарии рабочей нагрузки, поддерживаемые SAP, используемые с SAP HANA, описаны на [сертифицированных платформах IaaS SAP](https://www.sap.com/dmc/exp/2014-09-02-hana-hardware/enEN/iaas.html). 

Типы виртуальных машин Azure, сертифицированные SAP для SAP NetWeaver или уровня приложений S/4HANA, описаны в статье [SAP Note 1928533: приложения SAP в Azure: Поддерживаемые продукты и типы виртуальных машин Azure](https://launchpad.support.sap.com/#/notes/1928533/E).

> [!NOTE]
> Интеграция SAP, Linux и Azure поддерживается только в модели развертывания с помощью Azure Resource Manager и не поддерживается в классической модели развертывания. 

## <a name="manual-installation-of-sap-hana"></a>Установка SAP HANA вручную

> [!IMPORTANT]
> Убедитесь, что выбранная ОС является сертификатом SAP для SAP HANA на конкретных типах используемых виртуальных машин. Список сертифицированных SAP HANA типов виртуальных машин и выпусков ОС для этих типов виртуальных машин можно найти в [SAP HANA сертифицированных платформах IaaS](https://www.sap.com/dmc/exp/2014-09-02-hana-hardware/enEN/iaas.html#categories=Microsoft%20Azure). Обязательно щелкните сведения о типе виртуальной машины в списке, чтобы получить полный список поддерживаемых SAP HANA выпусков ОС для конкретного типа виртуальной машины. Для примера в этом документе мы использовали выпуск ОС SUSE Linux Enterprise Server (SLES), который не поддерживается SAP для SAP HANA на виртуальных машинах серии M.
>

В этом руководстве описываются два разных способа установки SAP HANA на виртуальных машинах Azure вручную:

* Используйте диспетчер подготовки программного обеспечения SAP (SWPM) в составе распределенной установки NetWeaver на шаге "установить экземпляр базы данных".
* Используйте средство диспетчера жизненного цикла базы данных SAP HANA (HDBLCM), а затем установите NetWeaver.

SWPM также можно использовать для установки всех компонентов, таких как SAP HANA, сервер приложений SAP и экземпляр ASCS, на одной виртуальной машине. Действия описаны в этом [SAP HANA объявления блога](https://blogs.saphana.com/2013/12/31/announcement-sap-hana-and-sap-netweaver-as-abap-deployed-on-one-server-is-generally-available/). Этот параметр не описан в этом кратком руководстве, но проблемы, которые необходимо учитывать, одинаковы.

Перед началом установки рекомендуется ознакомиться с разделом "подготовка виртуальных машин Azure для ручной установки SAP HANA" Далее в этом руководстве. Это поможет предотвратить несколько основных ошибок, которые могут возникнуть при использовании только конфигурации виртуальной машины Azure по умолчанию.

## <a name="key-steps-for-sap-hana-installation-when-you-use-sap-swpm"></a>Основные шаги по установке SAP HANA при использовании SAP SWPM
В этом разделе перечислены основные шаги для установки SAP HANA на уровне отдельного экземпляра вручную при использовании SAP SWPM для выполнения распределенной установки SAP NetWeaver 7.5. Отдельные шаги более подробно объясняются в этом руководстве на снимках экрана.

1. Создайте виртуальную сеть Azure с двумя тестовыми виртуальными машинами.
2. Разверните две виртуальные машины Azure с операционными системами в соответствии с моделью Azure Resource Manager. В этом примере используются SUSE Linux Enterprise Server и SLES для приложений SAP 12 с пакетом обновления 1 (SP1). 
3. Подключите два диска хранилища Azure уровня "Стандартный" или "Премиум" (например, диски 75-GB или 500-ГБ) к виртуальной машине сервера приложений.
4. Присоедините диски хранилища класса Premium к виртуальной машине сервера базы данных HANA. Дополнительные сведения см. в подразделе «Настройка диска» далее в этом пошаговом окне.
5. В зависимости от требований к размеру или пропускной способности Подключите несколько дисков. Затем создайте чередующиеся тома. Используйте средство управления логическим томом (LVM) или администрирование нескольких устройств (mdadm) на уровне ОС в виртуальной машине.
6. Создайте на подключенных дисках или логических томах файловые системы XFS.
7. Подключите новые файловые системы XFS на уровне операционной системы. Используйте одну файловую систему для всего программного обеспечения SAP. Используйте другую файловую систему для каталога /sapmnt и резервных копий. На сервере базы данных SAP HANA подключите файловые системы XFS на дисках хранилища класса Premium, такие как /hana и /usr/sap. Этот процесс необходим, чтобы предотвратить заполнение корневой файловой системы. Корневая файловая система не велика на виртуальных машинах Azure под управлением Linux. 
8. Добавьте в файл /etc/hosts локальные IP-адреса тестовых виртуальных машин.
9. Добавьте в файл /etc/fstab параметр **nofail**.
10. Задайте параметры ядра Linux в соответствии с используемым выпуском ОС Linux. Дополнительные сведения см. в примечаниях SAP, посвященных HANA, и в разделе "Параметры ядра" этого руководством.
11. Добавьте область буфера.
12. При необходимости установите на тестовых виртуальных машинах графический рабочий стол. В противном случае используйте удаленную установку SAPinst.
13. Скачайте программное обеспечение SAP из SAP Service Marketplace.
14. Установите экземпляр SAP ASCS на виртуальной машине сервера приложений.
15. Предоставьте общий доступ к каталогу /sapmnt для тестовых виртуальных машин с помощью NFS. Виртуальная машина сервера приложений — это сервер NFS.
16. Установите экземпляр базы данных, который включает HANA, с помощью SWPM на виртуальной машине сервера базы данных.
17. Установите основной сервер приложений (PAS) на виртуальной машине сервера приложений.
18. Запустите консоль управления SAP (SAP MC). Подключитесь к консоли с помощью графического пользовательского интерфейса SAP или HANA Studio.

## <a name="key-steps-for-sap-hana-installation-when-you-use-hdblcm"></a>Основные шаги по установке SAP HANA при использовании HDBLCM
В этом разделе перечислены основные шаги по установке SAP HANA на уровне отдельного экземпляра вручную при использовании SAP HDBLCM для выполнения распределенной установки SAP NetWeaver 7.5. Отдельные шаги более подробно объясняются в этом руководстве на снимках экрана.

1. Создайте виртуальную сеть Azure с двумя тестовыми виртуальными машинами.
2. Развертывание двух виртуальных машин Azure с операционными системами в соответствии с моделью Azure Resource Manager. В этом примере используются SLES и SLES для приложений SAP 12 с пакетом обновления 1 (SP1).
3. Подключите два диска хранилища Azure уровня "Стандартный" или "Премиум" (например, диски 75-GB или 500-ГБ) к виртуальной машине сервера приложений.
4. Присоедините диски хранилища класса Premium к виртуальной машине сервера базы данных HANA. Дополнительные сведения см. в подразделе «Настройка диска» далее в этом пошаговом окне.
5. В зависимости от требований к размеру или пропускной способности Подключите несколько дисков. Создайте чередующиеся тома с помощью средства управления логическим томом или mdadm на уровне операционной системы виртуальной машины.
6. Создайте на подключенных дисках или логических томах файловые системы XFS.
7. Подключите новые файловые системы XFS на уровне операционной системы. Используйте одну файловую систему для всего программного обеспечения SAP. Используйте другую файловую систему для каталога /sapmnt и резервных копий. На сервере базы данных SAP HANA подключите файловые системы XFS на дисках хранилища класса Premium, такие как /hana и /usr/sap. Этот процесс необходим, чтобы помочь предотвратить заполнение корневой файловой системы. Корневая файловая система не велика на виртуальных машинах Azure под управлением Linux.
8. Добавьте в файл /etc/hosts локальные IP-адреса тестовых виртуальных машин.
9. Добавьте в файл /etc/fstab параметр **nofail**.
10. Задайте параметры ядра в соответствии с используемым выпуском ОС Linux. Дополнительные сведения см. в примечаниях SAP, посвященных HANA, и в разделе "Параметры ядра" этого руководством.
11. Добавьте область буфера.
12. При необходимости установите на тестовых виртуальных машинах графический рабочий стол. В противном случае используйте удаленную установку SAPinst.
13. Скачайте программное обеспечение SAP из SAP Service Marketplace.
14. Создайте на виртуальной машине сервера базы данных HANA группу sapsys с идентификатором 1001.
15. Установите SAP HANA на виртуальную машину сервера базы данных с помощью диспетчера жизненного цикла СУБД HANA.
16. Установите экземпляр SAP ASCS на виртуальной машине сервера приложений.
17. Предоставьте общий доступ к каталогу /sapmnt для тестовых виртуальных машин с помощью NFS. Виртуальная машина сервера приложений — это сервер NFS.
18. Установите экземпляр базы данных, который включает HANA, с помощью SWPM на виртуальной машине сервера базы данных HANA.
19. Установите основной сервер приложений на виртуальной машине сервера приложений.
20. Запустите консоль управления SAP. Подключитесь к консоли с помощью графического пользовательского интерфейса SAP или HANA Studio.

## <a name="prepare-azure-vms-for-a-manual-installation-of-sap-hana"></a>Подготовка виртуальных машин Azure к установке SAP HANA вручную
В этом разделе описываются следующие темы:

* обновления ОС;
* настройка диска;
* параметры ядра;
* Файловые системы
* файл/etc/hosts;
* файл /etc/fstab.

### <a name="os-updates"></a>обновления ОС;
Перед установкой дополнительного программного обеспечения проверьте наличие обновлений ОС Linux и исправлений. Устанавливая исправление, вы можете избежать обращения в службу поддержки.

Убедитесь, что используется:
* SUSE Linux Enterprise Server for SAP Applications;
* Red Hat Enterprise Linux for SAP Applications или Red Hat Enterprise Linux for SAP HANA. 

Если вы еще не сделали этого, зарегистрируйте развертывание ОС в подписке Linux от поставщика Linux. SUSE содержит образы ОС для приложений SAP, которые уже включают службы и которые регистрируются автоматически.

Ниже приведен пример того, как проверить наличие доступных исправлений для SUSE Linux с помощью команды **zypper** :

 `sudo zypper list-patches`

В зависимости от типа ошибки исправления классифицируются по категориям и уровню серьезности. Для категории часто используются следующие значения: 
- Безопасность
- Рекомендуется
- Необязательно
- Компонент
- Базы данных документов
- YaST

Часто используемые значения для серьезности:

- Критический
- Важная
- Средняя
- Низкая
- Unspecified

Команда **zypper** находит только те обновления, которые требуются для установленных пакетов. Например, можно использовать следующую команду:

`sudo zypper patch  --category=security,recommended --severity=critical,important`

Можно добавить параметр `--dry-run`, чтобы протестировать обновление без фактического обновления системы.


### <a name="disk-setup"></a>настройка диска;
Размер корневой файловой системы на виртуальных машинах Linux в Azure ограничен. Поэтому необходимо подключить дополнительное дисковое пространство к виртуальной машине Azure для запуска SAP. Для виртуальных машин Azure сервера приложений SAP использование дисков хранилища Azure уровня "Стандартный" может быть достаточно. Для виртуальных машин Azure SAP HANA DBMS использование дисков хранилища Azure класса "Премиум" для рабочей и непроизводственной реализации является обязательным.

Согласно [требованиям к хранилищу TDI SAP HANA](https://www.sap.com/documents/2015/03/74cdb554-5a7c-0010-82c7-eda71af511fa.html), предлагается следующая конфигурация хранилища Azure уровня "Премиум": 

| SKU виртуальной машины | ОЗУ |  /hana/data и /hana/log, <br /> чередующийся с LVM или mdadm | /hana/shared | том /root | /usr/sap |
| --- | --- | --- | --- | --- | --- |
| GS5 | 448 ГБ | 2 x P30 | 1 x P20 | 1 x P10 | 1 x P10 | 

В предлагаемой конфигурации диска том данных HANA и том журнала помещаются на том же наборе дисков хранилища Azure класса Premium, которые были распределены с помощью LVM или mdadm. Нет необходимости определять уровень избыточности RAID, так как хранилище Azure класса Premium хранит три образа дисков для обеспечения избыточности. 

Сведения о том, как настроить достаточный объем хранилища, см. в разделе [SAP HANA требования к хранилищу TDI](https://www.sap.com/documents/2015/03/74cdb554-5a7c-0010-82c7-eda71af511fa.html) , а также [инструкции по установке и обновлению сервера SAP HANA](https://help.sap.com/saphelp_hanaplatform/helpdata/en/4c/24d332a37b4a3caad3e634f9900a45/frameset.htm). Кроме того, рассмотрим различные объемы пропускной способности виртуальных жестких дисков (VHD) различных дисков хранилища Azure класса Premium, как описано в статье [высокопроизводительное хранилище класса Premium и управляемые диски для виртуальных машин](../../windows/disks-types.md). 

Для хранения резервных копий базы данных или журнала транзакций можно добавить дополнительные диски хранилища класса Premium на виртуальные машины СУБД HANA.

Дополнительные сведения о двух основных инструментах, используемых для настройки чередования, см. в следующих статьях:

* [Настройка программного RAID-массива в Linux](../../linux/configure-raid.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json).
* [Настройка диспетчера логических томов на виртуальной машине Linux в Azure](../../linux/configure-lvm.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json).

Дополнительные сведения о том, как подключить диски к виртуальным машинам Azure под управлением Linux в качестве гостевой ОС, см. в статье [Добавление диска к виртуальной машине Linux](../../linux/add-disk.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json).

В Azure Premium SSD можно определить режимы кэширования диска. Для чередующегося набора, содержащего/Hana/Data и/Hana/log, отключите кэширование диска. Для других томов, то есть дисков, установите режим кэширования "только для **чтения**".

Чтобы найти примеры шаблонов JSON для создания виртуальных машин, см. шаблоны быстрого запуска [Azure](https://github.com/Azure/azure-quickstart-templates).
Шаблон vm-simple-sles является базовым. Оно содержит раздел хранилища с дополнительным диском данных размером 100 ГБ. Используйте этот шаблон в качестве основы. Шаблон можно адаптировать для конкретной конфигурации.

> [!NOTE]
> Важно подключить диск хранилища Azure с помощью UUID, как описано в статье [Запуск SAP NetWeaver на виртуальных машинах SUSE Linux Microsoft Azure](suse-quickstart.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json).

В тестовой среде два диска хранилища Azure уровня "Стандартный" подключены к виртуальной машине сервера приложений SAP, как показано на следующем снимке экрана. На одном диске хранится все программное обеспечение SAP, например NetWeaver 7,5, графический интерфейс SAP и SAP HANA, для установки. Второй диск гарантирует наличие достаточного свободного места для дополнительных требований. Например, данные резервного копирования и тестирования и каталог/sapmnt, то есть профили SAP, должны быть общими для всех виртуальных машин, принадлежащих к одной и той же ландшафту SAP.

![Окно дисков сервера приложений SAP HANA, отображающее два диска данных и их размеры](./media/hana-get-started/image003.jpg)


### <a name="kernel-parameters"></a>параметры ядра;
Для SAP HANA требуются определенные параметры ядра Linux. Эти параметры ядра не являются частью стандартных образов коллекции Azure и должны быть заданы вручную. Для SUSE или Red Hat параметры могут отличаться. В перечисленных выше комментариях к SAP предоставляются сведения об этих параметрах. На снимках экрана используется SUSE Linux 12 с пакетом обновления 1 (SP1). 

В SLES for SAP Applications 12 общая доступность и SLES для приложений SAP 12 с пакетом обновления 1 (SP1) имеется новое средство, **настроенное**с помощью ADM, заменяющее старое средство **sapconf** . Для средства **tuned-adm** существует специальный профиль SAP HANA. Чтобы настроить систему для SAP HANA, введите следующий профиль в качестве привилегированного пользователя:

   `tuned-adm profile sap-hana`

Дополнительные сведения о средстве **tuned-adm** см. в [ соответствующей документации по SUSE](https://www.suse.com/documentation/sles-for-sap-12/pdfdoc/sles-for-sap-12-sp1.zip).

На приведенном ниже снимке экрана показано, как **настроенные параметры-ADM** изменили `transparent_hugepage` и `numa_balancing` значения в соответствии с требуемыми параметрами SAP Hana:

![Инструмент tuned-adm изменяет значения в соответствии с требуемыми параметрами SAP HANA](./media/hana-get-started/image005.jpg)

Чтобы сделать параметры ядра SAP HANA постоянными, используйте в SLES 12 загрузчик **grub2**. Дополнительные сведения о **grub2**см. в разделе [Структура файла конфигурации](https://www.suse.com/documentation/sles-for-sap-12/pdfdoc/sles-for-sap-12-sp1.zip) документации SUSE.

На следующем снимке экрана показаны измененные в файле конфигурации, а затем скомпилированные с помощью **grub2-mkconfig** параметры ядра:

![Параметры ядра, измененные в файле конфигурации и скомпилированные с помощью grub2-mkconfig](./media/hana-get-started/image006.jpg)

Параметры ядра также можно изменить, используя YaST или выбрав параметры **Boot Loader** > **Kernel Parameters** (Загрузчик > Параметры ядра):

![Вкладка параметров Kernel Parameters (Параметры ядра) в загрузчике YaST](./media/hana-get-started/image007.jpg)

### <a name="file-systems"></a>Файловые системы
На следующем снимке экрана показаны две файловые системы, созданные на виртуальной машине сервера приложений SAP поверх двух подключенных дисков стандартного хранилища Azure. Обе файловые системы имеют тип XFS и подключены к/sapdata и/sapsoftware.

Не обязательно структурировать файловые системы таким образом. У вас есть и другие варианты структурирования дискового пространства. Наиболее важно предотвратить нехватку свободного места в корневой файловой системе.

![Две файловые системы, созданные на виртуальной машине сервера приложений SAP](./media/hana-get-started/image008.jpg)

Для виртуальной машины SAP HANA DB во время установки базы данных при использовании SAPinst с SWPM и **типичном** варианте установки все компоненты устанавливаются в/Hana и/usr/SAP. Резервная копия журналов SAP HANA по умолчанию хранится в расположении /usr/sap. Опять же, важно предотвратить нехваткой дискового пространства для корневой файловой системы. Убедитесь, что в разделе/Hana и/usr/SAP достаточно свободного места, прежде чем устанавливать SAP HANA с помощью SWPM.

Описание стандартной структуры файловой системы SAP HANA см. в разделе [руководства по установке и обновлению сервера SAP HANA](https://help.sap.com/saphelp_hanaplatform/helpdata/en/4c/24d332a37b4a3caad3e634f9900a45/frameset.htm).

![Дополнительные файловые системы, созданные на виртуальной машине сервера приложений SAP](./media/hana-get-started/image009.jpg)

При установке SAP NetWeaver в стандартном образе Azure SLES/SLES for SAP Applications 12 в виде сообщения отображается сообщение о том, что пространство подкачки отсутствует, как показано на следующем снимке экрана. Чтобы закрыть это сообщение, можно вручную добавить файл подкачки с помощью **dd**, **mkswap** и **swapon**. Чтобы узнать, как это выполнить, выполните поиск по запросу "Добавление файла подкачки вручную" в разделе [Использование средства секционирования YaST](https://www.suse.com/documentation/sles-for-sap-12/pdfdoc/sles-for-sap-12-sp1.zip) документации SUSE.

Область буфера можно также настроить с помощью агента виртуальной машины Linux. Дополнительные сведения см. в [руководстве пользователя агента Linux Azure](../../extensions/agent-linux.md).

![Всплывающее сообщение, в котором указано недостаточное пространство для подкачки](./media/hana-get-started/image010.jpg)


### <a name="the-etchosts-file"></a>файл/etc/hosts;
Перед началом установки SAP необходимо добавить в файл /etc/hosts имена узлов и IP-адреса виртуальных машин SAP. Разверните все виртуальные машины SAP в одной виртуальной сети Azure. Затем используйте внутренние IP-адреса, как показано ниже:

![Имена узлов и IP-адреса виртуальных машин SAP, приведенные в файле /etc/hosts](./media/hana-get-started/image011.jpg)

### <a name="the-etcfstab-file"></a>файл /etc/fstab.

Рекомендуется **Добавить параметр fstab в файл** . Таким образом, если что-то пойдет не так с дисками, виртуальная машина не будет отвечать на запросы в процессе загрузки. Помните, что на диске может не быть дополнительного места и процессы могут заполнить корневую файловую систему. Если /hana отсутствует, SAP HANA не запустится.

![Добавление параметра nofail в файл fstab](./media/hana-get-started/image000c.jpg)

## <a name="graphical-gnome-desktop-on-sles-12sles-for-sap-applications-12"></a>Графический рабочий стол GNOME в SLES 12 или SLES for SAP Applications 12
В этом разделе объясняется, как выполнить такие задачи:

* Установите GNOME Desktop и xrdp на SLES 12/SLES для приложений SAP 12.
* Запуск приложения SAP на основе Java с помощью Firefox в SLES 12/SLES для приложений SAP 12.

Вы также можете использовать альтернативные варианты, такие как Xterminal или VNC, которые не описаны в этом разделе.

### <a name="install-the-gnome-desktop-and-xrdp-on-sles-12sles-for-sap-applications-12"></a>Установка GNOME Desktop и xrdp на SLES 12/SLES для приложений SAP 12
Если у вас есть фон Windows, вы можете легко использовать графический Настольный компьютер непосредственно на виртуальных машинах SAP Linux для запуска Firefox, SAPinst, графического пользовательского интерфейса SAP, SAP MC или HANA Studio. Затем можно подключиться к виртуальной машине с помощью протокол удаленного рабочего стола (RDP) с компьютера Windows. В зависимости от политик организации по добавлению ГИП в рабочие и непроизводственные системы на базе Linux может потребоваться установить GNOME на сервере. Выполните следующие действия, чтобы установить рабочий стол GNOME на виртуальную машину Azure SLES 12/SLES для SAP Applications 12.

1. Установите Рабочий стол GNOME, введя следующую команду, например, в следующем окне:

   `zypper in -t pattern gnome-basic`

2. Чтобы разрешить подключение к виртуальной машине через удаленный рабочий стол, установите xrdp:

   `zypper in xrdp`

3. Измените файл /etc/sysconfig/windowmanager и установите GNOME в качестве диспетчера окон по умолчанию:

   `DEFAULT_WM="gnome"`

4. Выполните команду **chkconfig**, чтобы убедиться, что xrdp автоматически запустится после перезагрузки:

   `chkconfig -level 3 xrdp on`

5. Если у вас возникли проблемы с подключением к удаленному рабочему столу, попробуйте перезапустить, например, из окна вывода:

   `/etc/xrdp/xrdp.sh restart`

6. Если перезапуск xrdp, упомянутый на предыдущем шаге, не работает, проверьте наличие PID-файла:

   `check /var/run` 

   Поищите `xrdp.pid`. Если вы найдете этот файл, удалите его и попробуйте еще раз перезагрузить систему.

### <a name="start-sap-mc"></a>Запуск SAP MC
После установки GNOME Desktop Запустите графический интерфейс SAP на основе Java из Firefox. Если он выполняется в Azure SLES 12/SLES для SAP Applications 12, может появиться сообщение об ошибке. Эта ошибка возникает из-за отсутствия подключаемого модуля браузера Java.

Чтобы запустить консоль управления SAP, используйте следующий URL-адрес: `<server>:5<instance_number>13`.

Дополнительные сведения см. [в разделе Запуск веб-консоли управления SAP](https://help.sap.com/saphelp_nwce10/helpdata/en/48/6b7c6178dc4f93e10000000a42189d/frameset.htm).

На следующем снимке экрана показано сообщение об ошибке, отображаемое при отсутствии подключаемого модуля Java-Browser:

![Сообщение об ошибке, указывающее на отсутствие в браузере подключаемого модуля Java](./media/hana-get-started/image013.jpg)

Чтобы решить эту проблему, установите отсутствующий подключаемый модуль с помощью YaST, как показано на следующем снимке экрана:

![Использование YaST для установки отсутствующего подключаемого модуля](./media/hana-get-started/image014.jpg)

При повторном вводе URL-адреса консоли управления SAP вам будет предложено активировать подключаемый модуль:

![Диалоговое окно с запросом на активацию подключаемого модуля](./media/hana-get-started/image015.jpg)

Также может появиться сообщение об отсутствующем файле javafx.properties. Он связан с требованием Oracle Java 1,8 для SAP GUI 7,4. Дополнительные сведения см. в разделе [SAP Note 2059429](https://launchpad.support.sap.com/#/notes/2059424).
Версия IBM Java и пакет OpenJDK, поставляемые вместе с SLES/SLES для приложений SAP 12, не включают необходимый файл JavaFX. Properties. Рекомендуется скачать и установить Java SE8 с сайта Oracle.

Сведения о подобной проблеме с openjdk в openSUSE см. в обсуждении [SAPGui 7.4 Java for openSUSE 42.1 Leap](https://scn.sap.com/thread/3908306).

## <a name="manual-installation-of-sap-hana-swpm"></a>Установка SAP HANA вручную: SWPM
Ряд снимков экрана в этом разделе содержит основные шаги по установке SAP NetWeaver 7,5 и SAP HANA SP12 при использовании SWPM с SAPinst. В рамках установки NetWeaver 7,5 SWPM также может установить базу данных HANA как один экземпляр.

В образце тестовой среды мы установили один сервер приложений Advanced бизнес-приложений (ABAP). Как показано на следующем снимке экрана, мы использовали параметр **распределенная система** для установки экземпляров ASCS и основного сервера приложений на одной виртуальной машине Azure. Мы использовали SAP HANA в качестве системы баз данных на другой виртуальной машине Azure.

![ASCS и основные экземпляры сервера приложений, установленные с помощью параметра "Distributed System" (Распределенная система)](./media/hana-get-started/image012.jpg)

После установки экземпляра ASCS на виртуальной машине сервера приложений он определяется зеленым значком в консоли управления SAP. Каталог/sapmnt, который содержит каталог профиля SAP, должен быть общим для виртуальной машины сервера SAP HANA DB. Доступ к этому каталогу требуется во время установки базы данных. Лучший способ предоставить доступ — использовать клиент NFS, который можно настроить с помощью Yast.

![Консоль управления SAP, в которой отображается экземпляр ASCS, установленный на виртуальной машине сервера приложений с помощью зеленого значка](./media/hana-get-started/image016.jpg)

На виртуальной машине сервера приложений каталог/sapmnt предоставляется через NFS с помощью параметров **RW** и **no_root_squash** . По умолчанию используются параметры **ro** и **root_squash**, но при установке экземпляра базы данных из-за них могут возникать проблемы.

![Предоставление общего доступа к каталогу /sapmnt через NFS-клиент с использованием параметров rw и no_root_squash](./media/hana-get-started/image017b.jpg)

Как показано на следующем снимке экрана, общий ресурс/sapmnt на виртуальной машине сервера приложений должен быть настроен на виртуальной машине сервера SAP HANA DB с помощью **NFS Client** и YaST:

![Общая папка/sapmnt, настроенная с помощью NFS Client](./media/hana-get-started/image018b.jpg)

Чтобы выполнить распределенную установку NetWeaver 7,5, то есть **экземпляр базы данных**, войдите на виртуальную машину SAP HANA DB Server и запустите SWPM:

![Установка экземпляра базы данных путем входа на виртуальную машину сервера базы данных SAP HANA и запуска SWPM](./media/hana-get-started/image019.jpg)

После выбора **обычной** установки и пути к установочному носителю введите идентификатор безопасности базы данных, имя узла, номер экземпляра и пароль системного администратора базы данных:

![Страница входа в систему системного администратора базы данных SAP HANA](./media/hana-get-started/image035b.jpg)

Введите пароль схемы DBACOCKPIT:

![Поле для ввода пароля для схемы DBACockpit](./media/hana-get-started/image036b.jpg)

Введите вопрос для пароля схемы SAPABAP1:

![Ввод вопроса для пароля схемы SAPABAP1](./media/hana-get-started/image037b.jpg)

После выполнения каждого задания рядом с каждым этапом процесса установки базы данных появится зеленая галочка. Сообщение «выполнение... Экземпляр базы данных завершен "отображается.

![Окно выполнения задачи, содержащее сообщение с подтверждением](./media/hana-get-started/image023.jpg)

После успешной установки консоль управления SAP также отображает экземпляр базы данных с зеленым значком. В нем отображается полный список процессов SAP HANA, таких как hdbindexserver и hdbcompileserver.

![Окно консоли управления SAP со списком процессов SAP HANA](./media/hana-get-started/image024.jpg)

На следующем снимке экрана показаны части структуры файла в каталоге /hana/shared, созданном SWPM во время установки HANA. Поскольку невозможно указать другой путь, важно подключить дополнительное дисковое пространство в каталоге/Hana перед установкой SAP HANA с помощью SWPM. На этом этапе в корневой файловой системе не хватает свободного места.

![Структура файла каталога /hana/shared, созданного во время установки HANA](./media/hana-get-started/image025.jpg)

На этом снимке экрана показана структура файла каталога /usr/sap:

![Структура файла каталога usr/sap/](./media/hana-get-started/image026.jpg)

Последний шаг распределенной установки ABAP — это установка основного экземпляра сервера приложений:

![Установка ABAP, отображающая основной экземпляр сервера приложений в качестве завершающего этапа](./media/hana-get-started/image027b.jpg)

После установки основного экземпляра сервера приложений и графического пользовательского интерфейса SAP используйте транзакцию **базы данных DBA** , чтобы убедиться, что установка SAP HANA завершена правильно:

![Окно DBACockpit с подтверждением успешной установки](./media/hana-get-started/image028b.jpg)

В качестве последнего шага вам может потребоваться сначала установить HANA Studio на виртуальной машине сервера приложений SAP. Затем подключитесь к экземпляру SAP HANA, который работает на виртуальной машине сервера базы данных.

![Установка SAP HANA Studio на виртуальной машине сервера приложений SAP](./media/hana-get-started/image038b.jpg)

## <a name="manual-installation-of-sap-hana-hdblcm"></a>Установка SAP HANA вручную: HDBLCM
Кроме установки SAP HANA в рамках распределенной установки с помощью SWPM, можно сначала установить только HANA с помощью HDBLCM. Затем можно установить SAP NetWeaver 7.5. Процесс показан на снимках экрана в этом разделе.

Дополнительные сведения о средстве HDBLCM HANA см. в следующих источниках:

* [Выберите правильный SAP HANA HDBLCM для своей задачи](https://help.sap.com/saphelp_hanaplatform/helpdata/en/68/5cff570bb745d48c0ab6d50123ca60/content.htm).
* [SAP HANA средства управления жизненным циклом](https://www.tutorialspoint.com/sap_hana_administration/sap_hana_administration_lifecycle_management.htm).
* [Инструкции по установке и обновлению SAP HANA Server](https://help.sap.com/hana/SAP_HANA_Server_Installation_Guide_en.pdf).

Необходимо избежать проблем с параметром идентификатора группы по умолчанию для `\<HANA SID\>adm user`, который создается средством HDBLCM. Перед установкой SAP HANA через HDBLCM, определите новую группу с именем `sapsys` с помощью идентификатора группы `1001`.

![Новая группа sapsys, определенная с использованием идентификатора группы 1001](./media/hana-get-started/image030.jpg)

При первом запуске HDBLCM появляется простое меню "Пуск". Выберите элемент 1, **установите новую систему**:

![Параметр "Install new system" (Установка новой системы) в окне запуска HDBLCM](./media/hana-get-started/image031.jpg)

На следующем снимке экрана отображаются все ранее выбранные основные параметры.

> [!IMPORTANT]
> Каталоги с именами для журналов и томов данных HANA, а также путь установки, который/Hana/Shared в этом примере, и/usr/SAP не должны быть частью корневой файловой системы. Эти каталоги относятся к дискам данных Azure, подключенным к виртуальной машине. Дополнительные сведения см. в разделе "Настройка диска". 

Такой подход обеспечивает достаточный объем памяти для корневой файловой системы. Обратите внимание, что системный администратор HANA имеет идентификатор пользователя `1005` и входит в группу `sapsys` с ИДЕНТИФИКАТОРом `1001`, которая была определена перед установкой.

![Список всех выбранных ранее основных компонентов SAP HANA](./media/hana-get-started/image032.jpg)

Проверьте сведения о `\<HANA SID\>adm user` в каталоге/etc/passwd. Найдите `azdadm`, как показано на следующем снимке экрана:

![Сведения о пользователе \<HANA SID\>adm user в каталоге /etc/passwd](./media/hana-get-started/image033.jpg)

После установки SAP HANA с помощью HDBLCM в SAP HANA Studio отобразится структура файла, как показано на следующем снимке экрана. Схема SAPABAP1 со всеми таблицами SAP NetWeaver еще недоступна.

![Структура файла SAP HANA в SAP HANA Studio](./media/hana-get-started/image034.jpg)

После установки SAP HANA на его основе можно установить SAP NetWeaver. Как показано на следующем снимке экрана, установка была выполнена как распределенная установка с помощью SWPM. Этот процесс описан в предыдущем разделе. При установке экземпляра базы данных с помощью SWPM вы вводите те же данные с помощью HDBLCM. Например, введите имя узла, идентификатор безопасности HANA и номер экземпляра. Затем SWPM использует имеющуюся установку HANA и добавляет дополнительные схемы.

![Распределенная установка, выполненная с помощью SWPM](./media/hana-get-started/image035b.jpg)

На следующем снимке экрана показан этап установки SWPM с вводом данных о схеме DBACOCKPIT:

![Этап установки SWPM, на котором вводятся данные о схеме DBACockpit](./media/hana-get-started/image036b.jpg)

Введите данные о схеме SAPABAP1:

![Ввод данных о схеме SAPABAP1](./media/hana-get-started/image037b.jpg)

После завершения установки экземпляра базы данных SWPM можно увидеть схему SAPABAP1 в SAP HANA Studio:

![Схема SAPABAP1 в SAP HANA Studio](./media/hana-get-started/image038b.jpg)

Наконец, после завершения установки сервера приложений SAP и графического пользовательского интерфейса SAP проверьте экземпляр базы данных HANA с помощью транзакции **панели администраторов** .

![Экземпляр базы данных HANA, проверенный с помощью транзакции DBA Cockpit](./media/hana-get-started/image039b.jpg)


## <a name="sap-software-downloads"></a>Скачивания программного обеспечения SAP
Программное обеспечение можно скачать с SAP Service Marketplace, как показано на следующих снимках экрана.

Скачивание NetWeaver 7.5 для Linux и HANA.

 ![Окно установки и обновления службы SAP для загрузки NetWeaver 7,5](./media/hana-get-started/image001.jpg)

Скачивание выпуска HANA SP12 Platform.

 ![Окно установки и обновления службы SAP для скачивания HANA SP12 Platform Edition](./media/hana-get-started/image002.jpg)

