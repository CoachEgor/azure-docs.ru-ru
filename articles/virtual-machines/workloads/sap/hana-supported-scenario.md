---
title: Поддерживаемые сценарии SAP HANA в Azure (крупные экземпляры) | Документация Майкрософт
description: Поддерживаемые сценарии SAP HANA в Azure (крупные экземпляры) и сведения об их архитектуре
services: virtual-machines-linux
documentationcenter: ''
author: saghorpa
manager: gwallace
editor: ''
ms.service: virtual-machines-linux
ms.topic: article
ms.tgt_pltfrm: vm-linux
ms.workload: infrastructure
ms.date: 11/26/2019
ms.author: saghorpa
ms.custom: H1Hack27Feb2017
ms.openlocfilehash: 7ed63f5caa6b1f1c0072a92f6a60ad43c5431af0
ms.sourcegitcommit: 36eb583994af0f25a04df29573ee44fbe13bd06e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/26/2019
ms.locfileid: "74538387"
---
# <a name="supported-scenarios-for-hana-large-instances"></a>Поддерживаемые сценарии для крупных экземпляров HANA
В этом документе описаны поддерживаемые сценарии с крупными экземплярами HANA (HLI), а также сведения об их архитектуре.

>[!NOTE]
>Если требуемый сценарий не упоминается здесь, обратитесь к команде по управлению службами Майкрософт, чтобы они оценили ваши требования.
Прежде чем перейти к подготовке единицы HLI, попросите проверить ваш проект компанию SAP или вашего партнера по внедрению служб.

## <a name="terms-and-definitions"></a>Термины и определения
Давайте рассмотрим термины и определения, используемые в документе.

- SID: идентификатор системы HANA.
- HLI: крупные экземпляры HANA.
- DR: сайт аварийного восстановления.
- Обычный сайт аварийного восстановления: система с выделенным ресурсом, предназначенным только для аварийного восстановления.
- Многоцелевой сайт аварийного восстановления: система на сайте аварийного восстановления, настроенная на использование непроизводственной среды вместе с рабочим экземпляром, настроенным для события аварийного восстановления. 
- Одноэкземплярная система: система с одним установленным экземпляром.
- Многоэкземплярная система: система с несколькими настроенными экземплярами. Также называется средой MCOS.
- HSR: SAP HANA репликация системы.

## <a name="overview"></a>Обзор
Крупные экземпляры HANA поддерживают разнообразные архитектуры, соответствующие разным бизнес-требованиям. Ниже перечислены сценарии и подробности их конфигурации. 

Производная схема архитектуры основана исключительно на инфраструктуре, для развертывания HANA необходимо обратиться к SAP или вашим партнерам по внедрению. Если ваши сценарии не перечислены, обратитесь к службе технической поддержки учетных записей Майкрософт. Она рассмотрит вашу архитектуру и определит подходящее решение.

**Эти архитектуры полностью совместимы с TDI (Tailored Data Integration) и поддерживаются SAP.**

В этом документе описаны сведения о двух компонентах каждой поддерживаемой архитектуры:

- Ethernet
- Служба хранилища

### <a name="ethernet"></a>Ethernet

Каждый подготовленный сервер поставляется с предварительно настроенными наборами интерфейсов Ethernet. Ниже приведены сведения об интерфейсах Ethernet, настроенных на каждой единице HLI.

- **A**: этот интерфейс используется для клиентского доступа.
- **B**: этот интерфейс используется для обмена данными между узлами. Этот интерфейс настраивается на всех серверах (независимо от запрошенной топологии), но используется только для 
- сценариев горизонтального масштабирования.
- **C**: этот интерфейс используется для подключения узла к хранилищу.
- **D**: этот интерфейс используется для подключения узла к устройству ISCSI при установке STONITH. Он настраивается только в том случае, когда запрашивается установка HSR.  

| Логические интерфейсы сетевого адаптера | Тип SKU | Имя с ОС SUSE | Имя с ОС RHEL | Вариант использования|
| --- | --- | --- | --- | --- |
| Файл , | Тип I | eth0.tenant | eno1.tenant | Между клиентом и HLI |
| b | Тип I | eth2.tenant | eno3.tenant | Между узлами |
| C | Тип I | eth1.tenant | eno2.tenant | Между узлом и хранилищем |
| D | Тип I | eth4.tenant | eno4.tenant | STONITH |
| Файл , | Тип II | Виртуальная ЛС\<Тенантно > | team0.tenant | Между клиентом и HLI |
| b | Тип II | Виртуальная ЛС\<Тенантно + 2 > | team0.tenant+2 | Между узлами |
| C | Тип II | VLAN\<Тенантно + 1 > | team0.tenant+1 | Между узлом и хранилищем |
| D | Тип II | Виртуальная ЛС\<Тенантно + 3 > | team0.tenant+3 | STONITH |

Интерфейсы используются на основе топологии, настроенной в единице HLI. Например, интерфейс "B" настроен для связи между узлами, что полезно при наличии топологии горизонтального масштабирования. В случае с конфигурацией горизонтального масштабирования с одним узлом этот интерфейс не применим. Рассмотрите необходимые сценарии (далее в этом документе), чтобы получить дополнительные сведения об использовании интерфейса. 

Если требуется, можно самостоятельно определить дополнительные сетевые адаптеры. Однако конфигурацию имеющихся сетевых адаптеров изменить невозможно.

>[!NOTE]
>Вы можете найти дополнительные физические интерфейсы или интерфейсы соединения. Рассмотрите возможность применения упомянутых выше интерфейсов в вашем варианте использования, остальные можно игнорировать или не регулировать.

Распределение для единиц с двумя IP-адресами выполняется следующим образом:

- Интерфейс Ethernet "A" должен иметь IP-адрес из диапазона IP-адресов серверного пула, отправленного в Майкрософт. Этот IP-адрес нужно указать в файле /etc/hosts операционной системы.

- Ethernet "C" должен иметь IP-адрес, используемый для взаимодействия с NFS. Таким образом, эти адреса **не** нужно сохранять в файле etc/hosts, чтобы разрешить трафик между экземплярами в одном клиенте.

При развертывании репликации системы HANA или масштабировании HANA конфигурация колонки с двумя назначенными IP-адресами не подходит. При развертывании таких конфигураций обратитесь в службу поддержки SAP HANA для Azure Service Management, чтобы получить третий IP-адрес в третьей виртуальной локальной сети. В единицах крупных экземпляров HANA при наличии трех назначенных IP-адресов в трех портах сетевого адаптера применяются следующие правила использования:

- Интерфейс Ethernet "A" должен иметь IP-адрес из диапазона IP-адресов серверного пула, отправленного в Майкрософт. Поэтому этот IP-адрес не нужно указывать в файле /etc/hosts операционной системы.

- Ethernet "B" должен использоваться исключительно в файле etc/hosts, чтобы обеспечить взаимодействие между разными экземплярами. Эти адреса также применяются в конфигурациях масштабирования HANA как IP-адреса, используемые системой HANA для конфигурации между узлами.

- Ethernet "C" должен иметь IP-адрес, используемый для взаимодействия с хранилищем NFS. Этот тип адресов не нужно указывать в файле etc/hosts.

- Ethernet "D" должен использоваться исключительно для доступа устройства STONITH к Pacemaker. Этот интерфейс требуется при настройке репликации системы HANA (HSR) и когда нужна автоматическая отработка отказа на уровне операционной системы с использованием устройства, основанного на SBD.


### <a name="storage"></a>Служба хранилища
Хранилище предварительно настроено на основе запрошенной топологии. Размеры томов и точки подключения различаются в зависимости от количества серверов, SKU и топологии. Рассмотрите необходимые сценарии (далее в этом документе), чтобы получить дополнительные сведения. Если требуется больший объем хранилища, вы можете приобрести его с шагом приращения в 1 ТБ.

>[!NOTE]
>> Mountpoint/usr/SAP/\<SID — это символьная ссылка на точку подключения/Hana/Shared.


## <a name="supported-scenarios"></a>Поддерживаемые сценарии

В схемах архитектуры для графики используются следующие нотации:

[![условные обозначения. PNG](media/hana-supported-scenario/Legends.png)](media/hana-supported-scenario/Legends.png#lightbox)

В следующем списке перечислены поддерживаемые сценарии:

1. Одноэкземплярная система с одним узлом
2. Среда MCOS с отдельным узлом
3. Один узел с обычным сайтом аварийного восстановления.
4. Один узел с многоцелевым сайтом аварийного восстановления.
5. HSR со STONITH
6. HSR с обычным и многоцелевым сайтами аварийного восстановления. 
7. Автоматическая отработка отказа узла (1+1). 
8. Горизонтальное масштабирование с резервным узлом
9. Горизонтальное масштабирование без резервного узла
10. Горизонтальное масштабирование с использованием аварийного восстановления



## <a name="1-single-node-with-one-sid"></a>1. один узел с одним идентификатором безопасности

Эта топология поддерживает один узел в конфигурации горизонтального масштабирования с одноэкземплярной системой.

### <a name="architecture-diagram"></a>Схема архитектуры  

![Single-node-with-one-SID.png](media/hana-supported-scenario/Single-node-with-one-SID.png)

### <a name="ethernet"></a>Ethernet
Ниже приведены предварительно настроенные сетевые интерфейсы.

| Логические интерфейсы сетевого адаптера | Тип SKU | Имя с ОС SUSE | Имя с ОС RHEL | Вариант использования|
| --- | --- | --- | --- | --- |
| Файл , | Тип I | eth0.tenant | eno1.tenant | Между клиентом и HLI |
| b | Тип I | eth2.tenant | eno3.tenant | Настроен, но не используется |
| C | Тип I | eth1.tenant | eno2.tenant | Между узлом и хранилищем |
| D | Тип I | eth4.tenant | eno4.tenant | Настроен, но не используется |
| Файл , | Тип II | Виртуальная ЛС\<Тенантно > | team0.tenant | Между клиентом и HLI |
| b | Тип II | Виртуальная ЛС\<Тенантно + 2 > | team0.tenant+2 | Настроен, но не используется |
| C | Тип II | VLAN\<Тенантно + 1 > | team0.tenant+1 | Между узлом и хранилищем |
| D | Тип II | Виртуальная ЛС\<Тенантно + 3 > | team0.tenant+3 | Настроен, но не используется |

### <a name="storage"></a>Служба хранилища
Ниже приведены предварительно настроенные точки подключения.

| Точка подключения | Вариант использования | 
| --- | --- |
|/hana/shared/SID | Установка HANA | 
|/hana/data/SID/mnt00001 | Установка файлов данных | 
|/hana/log/SID/mnt00001 | Установка файлов журнала | 
|/hana/logbackups/SID | Журналы повторяемых операций |

### <a name="key-considerations"></a>Основные рекомендации
- /usr/sap/SID является символической ссылкой на /hana/shared/SID.

## <a name="2-single-node-mcos"></a>2. МКОС одного узла

Эта топология поддерживает один узел в конфигурации горизонтального масштабирования с многоэкземплярной системой.

### <a name="architecture-diagram"></a>Схема архитектуры  

![single-node-mcos.png](media/hana-supported-scenario/single-node-mcos.png)

### <a name="ethernet"></a>Ethernet
Ниже приведены предварительно настроенные сетевые интерфейсы.

| Логические интерфейсы сетевого адаптера | Тип SKU | Имя с ОС SUSE | Имя с ОС RHEL | Вариант использования|
| --- | --- | --- | --- | --- |
| Файл , | Тип I | eth0.tenant | eno1.tenant | Между клиентом и HLI |
| b | Тип I | eth2.tenant | eno3.tenant | Настроен, но не используется |
| C | Тип I | eth1.tenant | eno2.tenant | Между узлом и хранилищем |
| D | Тип I | eth4.tenant | eno4.tenant | Настроен, но не используется |
| Файл , | Тип II | Виртуальная ЛС\<Тенантно > | team0.tenant | Между клиентом и HLI |
| b | Тип II | Виртуальная ЛС\<Тенантно + 2 > | team0.tenant+2 | Настроен, но не используется |
| C | Тип II | VLAN\<Тенантно + 1 > | team0.tenant+1 | Между узлом и хранилищем |
| D | Тип II | Виртуальная ЛС\<Тенантно + 3 > | team0.tenant+3 | Настроен, но не используется |

### <a name="storage"></a>Служба хранилища
Ниже приведены предварительно настроенные точки подключения.

| Точка подключения | Вариант использования | 
| --- | --- |
|/hana/shared/SID1 | Установка HANA для SID1 | 
|/hana/data/SID1/mnt00001 | Установка файлов данных для SID1 | 
|/hana/log/SID1/mnt00001 | Установка файлов журнала для SID1 | 
|/hana/logbackups/SID1 | Журналы повторяемых операций для SID1 |
|/hana/shared/SID2 | Установка HANA для SID2 | 
|/hana/data/SID2/mnt00001 | Установка файлов данных для SID2 | 
|/hana/log/SID2/mnt00001 | Установка файлов журнала для SID2 | 
|/hana/logbackups/SID2 | Журналы повторяемых операций для SID1 |

### <a name="key-considerations"></a>Основные рекомендации
- /usr/sap/SID является символической ссылкой на /hana/shared/SID.
- Распределение размера тома зависит от размера базы данных в памяти. Чтобы узнать, какие размеры базы данных в памяти поддерживаются с многоэкземплярной системой, ознакомьтесь с [этим разделом](https://docs.microsoft.com/azure/virtual-machines/workloads/sap/hana-overview-architecture).

## <a name="3-single-node-with-dr-using-storage-replication"></a>3. отдельный узел с аварийным восстановлением с помощью репликации хранилища
 
Эта топология поддерживает один узел в конфигурации горизонтального масштабирования с одним или несколькими экземплярами системы SID с репликацией на основе хранилища на сайт аварийного восстановления для основной системы SID. На схеме показана только одноэкземплярная система на основном сайте, однако также поддерживается многоэкземплярная система (MCOS).

### <a name="architecture-diagram"></a>Схема архитектуры  

![Single-node-with-dr.png](media/hana-supported-scenario/Single-node-with-dr.png)

### <a name="ethernet"></a>Ethernet
Ниже приведены предварительно настроенные сетевые интерфейсы.

| Логические интерфейсы сетевого адаптера | Тип SKU | Имя с ОС SUSE | Имя с ОС RHEL | Вариант использования|
| --- | --- | --- | --- | --- |
| Файл , | Тип I | eth0.tenant | eno1.tenant | Между клиентом и HLI |
| b | Тип I | eth2.tenant | eno3.tenant | Настроен, но не используется |
| C | Тип I | eth1.tenant | eno2.tenant | Между узлом и хранилищем |
| D | Тип I | eth4.tenant | eno4.tenant | Настроен, но не используется |
| Файл , | Тип II | Виртуальная ЛС\<Тенантно > | team0.tenant | Между клиентом и HLI |
| b | Тип II | Виртуальная ЛС\<Тенантно + 2 > | team0.tenant+2 | Настроен, но не используется |
| C | Тип II | VLAN\<Тенантно + 1 > | team0.tenant+1 | Между узлом и хранилищем |
| D | Тип II | Виртуальная ЛС\<Тенантно + 3 > | team0.tenant+3 | Настроен, но не используется |

### <a name="storage"></a>Служба хранилища
Ниже приведены предварительно настроенные точки подключения.

| Точка подключения | Вариант использования | 
| --- | --- |
|/hana/shared/SID | Установка HANA для системы SID | 
|/hana/data/SID/mnt00001 | Установка файлов данных для системы SID | 
|/hana/log/SID/mnt00001 | Файлы журнала установки для системы SID | 
|/hana/logbackups/SID | Журналы повторяемых операций для SID |


### <a name="key-considerations"></a>Основные рекомендации
- /usr/sap/SID является символической ссылкой на /hana/shared/SID.
- В MCOS распределение размера тома зависит от размера базы данных в памяти. Чтобы узнать, какие размеры базы данных в памяти поддерживаются с многоэкземплярной системой, ознакомьтесь с [этим разделом](https://docs.microsoft.com/azure/virtual-machines/workloads/sap/hana-overview-architecture).
- При аварийном восстановлении тома и точки подключения настраиваются (помечены как Required for HANA installation (требуются для установки HANA)) для установки экземпляра HANA в производственной среде в единице HLI для аварийного восстановления. 
- При аварийном восстановлении данные, резервные копии журналов и общие тома (помечены как Storage Replication (репликация хранилища)) реплицируются путем создания моментального снимка на рабочем сайте. Эти тома подключены только на время перехода на другой ресурс. Дополнительные сведения см. в документе [Процедура отработки отказа при аварийном восстановлении](https://docs.microsoft.com/azure/virtual-machines/workloads/sap/hana-overview-high-availability-disaster-recovery).
- Загрузочный том для **класса SKU типа I** реплицируется на узел аварийного восстановления.


## <a name="4-single-node-with-dr-multipurpose-using-storage-replication"></a>4. отдельный узел с аварийным восстановлением (многоцелевые) с использованием репликации хранилища
 
Эта топология поддерживает один узел в конфигурации горизонтального масштабирования с одним или несколькими экземплярами системы SID с репликацией на основе хранилища на сайт аварийного восстановления для основной системы SID. На схеме показана только одноэкземплярная система на основном сайте, однако также поддерживается многоэкземплярная система (MCOS). На сайте аварийного восстановления единица HLI используется в качестве экземпляра контроля качества во время выполнения производственных операций на основном сайте. Во время отработки отказа с аварийным восстановлением (или проверки отработки отказа) экземпляр контроля качества на сайте аварийного восстановления выключается.

### <a name="architecture-diagram"></a>Схема архитектуры  

![single-node-with-dr-multipurpose.png](media/hana-supported-scenario/single-node-with-dr-multipurpose.png)

### <a name="ethernet"></a>Ethernet
Ниже приведены предварительно настроенные сетевые интерфейсы.

| Логические интерфейсы сетевого адаптера | Тип SKU | Имя с ОС SUSE | Имя с ОС RHEL | Вариант использования|
| --- | --- | --- | --- | --- |
| Файл , | Тип I | eth0.tenant | eno1.tenant | Между клиентом и HLI |
| b | Тип I | eth2.tenant | eno3.tenant | Настроен, но не используется |
| C | Тип I | eth1.tenant | eno2.tenant | Между узлом и хранилищем |
| D | Тип I | eth4.tenant | eno4.tenant | Настроен, но не используется |
| Файл , | Тип II | Виртуальная ЛС\<Тенантно > | team0.tenant | Между клиентом и HLI |
| b | Тип II | Виртуальная ЛС\<Тенантно + 2 > | team0.tenant+2 | Настроен, но не используется |
| C | Тип II | VLAN\<Тенантно + 1 > | team0.tenant+1 | Между узлом и хранилищем |
| D | Тип II | Виртуальная ЛС\<Тенантно + 3 > | team0.tenant+3 | Настроен, но не используется |

### <a name="storage"></a>Служба хранилища
Ниже приведены предварительно настроенные точки подключения.

| Точка подключения | Вариант использования | 
| --- | --- |
|**На основном сайте**|
|/hana/shared/SID | Установка HANA для производственной системы SID | 
|/hana/data/SID/mnt00001 | Установка файлов данных для производственной системы SID | 
|/hana/log/SID/mnt00001 | Установка файлов журналов для производственной системы SID | 
|/hana/logbackups/SID | Журналы повторяемых операций для производственной системы SID |
|**На сайте аварийного восстановления**|
|/hana/shared/SID | Установка HANA для производственной системы SID | 
|/hana/data/SID/mnt00001 | Установка файлов данных для производственной системы SID | 
|/hana/log/SID/mnt00001 | Установка файлов журналов для производственной системы SID | 
|/hana/shared/QA-SID | Установка HANA для экземпляра SID для контроля качества | 
|/hana/data/QA-SID/mnt00001 | Установка файлов данных для экземпляра SID для контроля качества | 
|/hana/log/QA-SID/mnt00001 | Установка файлов журналов для экземпляра SID для контроля качества |
|/hana/logbackups/QA-SID | Журналы повторяемых операций для экземпляра SID для контроля качества |

### <a name="key-considerations"></a>Основные рекомендации
- /usr/sap/SID является символической ссылкой на /hana/shared/SID.
- В MCOS распределение размера тома зависит от размера базы данных в памяти. Чтобы узнать, какие размеры базы данных в памяти поддерживаются с многоэкземплярной системой, ознакомьтесь с [этим разделом](https://docs.microsoft.com/azure/virtual-machines/workloads/sap/hana-overview-architecture).
- При аварийном восстановлении тома и точки подключения настраиваются (помечены как Required for HANA installation (требуются для установки HANA)) для установки экземпляра HANA в производственной среде в единице HLI для аварийного восстановления. 
- При аварийном восстановлении данные, резервные копии журналов и общие тома (помечены как Storage Replication (репликация хранилища)) реплицируются путем создания моментального снимка на рабочем сайте. Эти тома подключены только на время перехода на другой ресурс. Дополнительные сведения см. в документе [Процедура отработки отказа при аварийном восстановлении](https://docs.microsoft.com/azure/virtual-machines/workloads/sap/hana-overview-high-availability-disaster-recovery). 
- При аварийном восстановлении данные, резервные копии журналов, общие тома для контроля качества (помечены как QA Instance installation (установка экземпляра контроля качества)) настраиваются для установки экземпляра контроля качества.
- Загрузочный том для **класса SKU типа I** реплицируется на узел аварийного восстановления.

## <a name="5-hsr-with-stonith-for-high-availability"></a>5. HSR с STONITH для обеспечения высокой доступности
 
Эта топология поддерживает два узла для конфигурации репликации системы HANA (HSR). Эта конфигурация поддерживается только для отдельных экземпляров HANA на узле. То есть сценарии MCOS не поддерживаются.

**Сейчас эта архитектура поддерживается только для операционной системы SUSE.**


### <a name="architecture-diagram"></a>Схема архитектуры  

![HSR-with-STONITH.png](media/hana-supported-scenario/HSR-with-STONITH.png)



### <a name="ethernet"></a>Ethernet
Ниже приведены предварительно настроенные сетевые интерфейсы.

| Логические интерфейсы сетевого адаптера | Тип SKU | Имя с ОС SUSE | Имя с ОС RHEL | Вариант использования|
| --- | --- | --- | --- | --- |
| Файл , | Тип I | eth0.tenant | eno1.tenant | Между клиентом и HLI |
| b | Тип I | eth2.tenant | eno3.tenant | Настроен, но не используется |
| C | Тип I | eth1.tenant | eno2.tenant | Между узлом и хранилищем |
| D | Тип I | eth4.tenant | eno4.tenant | Используется для STONITH |
| Файл , | Тип II | Виртуальная ЛС\<Тенантно > | team0.tenant | Между клиентом и HLI |
| b | Тип II | Виртуальная ЛС\<Тенантно + 2 > | team0.tenant+2 | Настроен, но не используется |
| C | Тип II | VLAN\<Тенантно + 1 > | team0.tenant+1 | Между узлом и хранилищем |
| D | Тип II | Виртуальная ЛС\<Тенантно + 3 > | team0.tenant+3 | Используется для STONITH |

### <a name="storage"></a>Служба хранилища
Ниже приведены предварительно настроенные точки подключения.

| Точка подключения | Вариант использования | 
| --- | --- |
|**На основном узле**|
|/hana/shared/SID | Установка HANA для производственной системы SID | 
|/hana/data/SID/mnt00001 | Установка файлов данных для производственной системы SID | 
|/hana/log/SID/mnt00001 | Установка файлов журналов для производственной системы SID | 
|/hana/logbackups/SID | Журналы повторяемых операций для производственной системы SID |
|**На дополнительном узле**|
|/hana/shared/SID | Установка HANA для дополнительной системы SID | 
|/hana/data/SID/mnt00001 | Файлы данных для дополнительной системы SID | 
|/hana/log/SID/mnt00001 | Файлы журналов для дополнительной системы SID | 
|/hana/logbackups/SID | Журналы повторяемых операций для дополнительной системы SID |

### <a name="key-considerations"></a>Основные рекомендации
- /usr/sap/SID является символической ссылкой на /hana/shared/SID.
- В MCOS распределение размера тома зависит от размера базы данных в памяти. Чтобы узнать, какие размеры базы данных в памяти поддерживаются с многоэкземплярной системой, ознакомьтесь с [этим разделом](https://docs.microsoft.com/azure/virtual-machines/workloads/sap/hana-overview-architecture).
- STONITH. Устройство SBD настраивается для установки STONITH. Однако использование STONITH не является обязательным.


## <a name="6-high-availability-with-hsr-and-dr-with-storage-replication"></a>6. высокий уровень доступности с помощью HSR и DR с репликацией хранилища
 
Эта топология поддерживает два узла для конфигурации репликации системы HANA (HSR). Поддерживается как обычное, так и многоцелевое аварийное восстановление. Эти конфигурации поддерживаются только для отдельных экземпляров HANA на узле. То есть сценарии MCOS не поддерживаются с такими конфигурациями.

На схеме многоцелевой сценарий представлен на сайте аварийного восстановления, единица HLI используется в качества экземпляра контроля качества во время выполнения производственных операций на основном сайте. Во время отработки отказа с аварийным восстановлением (или проверки отработки отказа) экземпляр контроля качества на сайте аварийного восстановления выключается. 



### <a name="architecture-diagram"></a>Схема архитектуры  

![HSR-with-DR.png](media/hana-supported-scenario/HSR-with-DR.png)

### <a name="ethernet"></a>Ethernet
Ниже приведены предварительно настроенные сетевые интерфейсы.

| Логические интерфейсы сетевого адаптера | Тип SKU | Имя с ОС SUSE | Имя с ОС RHEL | Вариант использования|
| --- | --- | --- | --- | --- |
| Файл , | Тип I | eth0.tenant | eno1.tenant | Между клиентом и HLI |
| b | Тип I | eth2.tenant | eno3.tenant | Настроен, но не используется |
| C | Тип I | eth1.tenant | eno2.tenant | Между узлом и хранилищем |
| D | Тип I | eth4.tenant | eno4.tenant | Используется для STONITH |
| Файл , | Тип II | Виртуальная ЛС\<Тенантно > | team0.tenant | Между клиентом и HLI |
| b | Тип II | Виртуальная ЛС\<Тенантно + 2 > | team0.tenant+2 | Настроен, но не используется |
| C | Тип II | VLAN\<Тенантно + 1 > | team0.tenant+1 | Между узлом и хранилищем |
| D | Тип II | Виртуальная ЛС\<Тенантно + 3 > | team0.tenant+3 | Используется для STONITH |

### <a name="storage"></a>Служба хранилища
Ниже приведены предварительно настроенные точки подключения.

| Точка подключения | Вариант использования | 
| --- | --- |
|**На основном узле на основном сайте**|
|/hana/shared/SID | Установка HANA для производственной системы SID | 
|/hana/data/SID/mnt00001 | Установка файлов данных для производственной системы SID | 
|/hana/log/SID/mnt00001 | Установка файлов журналов для производственной системы SID | 
|/hana/logbackups/SID | Журналы повторяемых операций для производственной системы SID |
|**На дополнительном узле на основном сайте**|
|/hana/shared/SID | Установка HANA для дополнительной системы SID | 
|/hana/data/SID/mnt00001 | Файлы данных для дополнительной системы SID | 
|/hana/log/SID/mnt00001 | Файлы журналов для дополнительной системы SID | 
|/hana/logbackups/SID | Журналы повторяемых операций для дополнительной системы SID |
|**На сайте аварийного восстановления**|
|/hana/shared/SID | Установка HANA для производственной системы SID | 
|/hana/data/SID/mnt00001 | Установка файлов данных для производственной системы SID | 
|/hana/log/SID/mnt00001 | Установка файлов журналов для производственной системы SID | 
|/hana/shared/QA-SID | Установка HANA для экземпляра SID для контроля качества | 
|/hana/data/QA-SID/mnt00001 | Установка файлов данных для экземпляра SID для контроля качества | 
|/hana/log/QA-SID/mnt00001 | Установка файлов журналов для экземпляра SID для контроля качества |
|/hana/logbackups/QA-SID | Журналы повторяемых операций для экземпляра SID для контроля качества |

### <a name="key-considerations"></a>Основные рекомендации
- /usr/sap/SID является символической ссылкой на /hana/shared/SID.
- В MCOS распределение размера тома зависит от размера базы данных в памяти. Чтобы узнать, какие размеры базы данных в памяти поддерживаются с многоэкземплярной системой, ознакомьтесь с [этим разделом](https://docs.microsoft.com/azure/virtual-machines/workloads/sap/hana-overview-architecture).
- STONITH. Устройство SBD настраивается для установки STONITH. Однако использование STONITH не является обязательным.
- При аварийном восстановлении **требуется два набора томов хранилища**: для основного и дополнительного узлов репликации.
- При аварийном восстановлении тома и точки подключения настраиваются (помечены как Required for HANA installation (требуются для установки HANA)) для установки экземпляра HANA в производственной среде в единице HLI для аварийного восстановления. 
- При аварийном восстановлении данные, резервные копии журналов и общие тома (помечены как Storage Replication (репликация хранилища)) реплицируются путем создания моментального снимка на рабочем сайте. Эти тома подключены только на время перехода на другой ресурс. Дополнительные сведения см. в документе [Процедура отработки отказа при аварийном восстановлении](https://docs.microsoft.com/azure/virtual-machines/workloads/sap/hana-overview-high-availability-disaster-recovery). 
- При аварийном восстановлении данные, резервные копии журналов, общие тома для контроля качества (помечены как QA Instance installation (установка экземпляра контроля качества)) настраиваются для установки экземпляра контроля качества.
- Загрузочный том для **класса SKU типа I** реплицируется на узел аварийного восстановления.


## <a name="7-host-auto-failover-11"></a>7. Автоматическая отработка отказа узла (1 + 1)
 
Эта топология поддерживает два узла в конфигурации автоматической отработки отказа узла. В частности, один узел с ролью главного или рабочей ролью и другой в качестве резервного. **SAP поддерживает этот сценарий только для S/4 HANA.** Дополнительные сведения см. в [этом примечании по SAP S/4HANA о поддержке нескольких узлов](https://launchpad.support.sap.com/#/notes/2408419).



### <a name="architecture-diagram"></a>Схема архитектуры  

![sca](media/hana-supported-scenario/scaleup-with-standby.png)

### <a name="ethernet"></a>Ethernet
Ниже приведены предварительно настроенные сетевые интерфейсы.

| Логические интерфейсы сетевого адаптера | Тип SKU | Имя с ОС SUSE | Имя с ОС RHEL | Вариант использования|
| --- | --- | --- | --- | --- |
| Файл , | Тип I | eth0.tenant | eno1.tenant | Между клиентом и HLI |
| b | Тип I | eth2.tenant | eno3.tenant | Обмен данными между узлами |
| C | Тип I | eth1.tenant | eno2.tenant | Между узлом и хранилищем |
| D | Тип I | eth4.tenant | eno4.tenant | Настроен, но не используется |
| Файл , | Тип II | Виртуальная ЛС\<Тенантно > | team0.tenant | Между клиентом и HLI |
| b | Тип II | Виртуальная ЛС\<Тенантно + 2 > | team0.tenant+2 | Обмен данными между узлами |
| C | Тип II | VLAN\<Тенантно + 1 > | team0.tenant+1 | Между узлом и хранилищем |
| D | Тип II | Виртуальная ЛС\<Тенантно + 3 > | team0.tenant+3 | Настроен, но не используется |

### <a name="storage"></a>Служба хранилища
Ниже приведены предварительно настроенные точки подключения.

| Точка подключения | Вариант использования | 
| --- | --- |
|**На главном и резервном узлах**|
|/hana/shared | Установка HANA для производственной системы SID | 
|/hana/data/SID/mnt00001 | Установка файлов данных для производственной системы SID | 
|/hana/log/SID/mnt00001 | Установка файлов журналов для производственной системы SID | 
|/hana/logbackups/SID | Журналы повторяемых операций для производственной системы SID |



### <a name="key-considerations"></a>Основные рекомендации
- /usr/sap/SID является символической ссылкой на /hana/shared/SID.
- Резервный узел. Тома и конечные точки настроены (помечены как Required for HANA installation (требуются для установки HANA)) для установки экземпляра HANA в резервной единице.
 

## <a name="8-scale-out-with-standby"></a>8. горизонтальное масштабирование с резервом
 
В этой топологии поддерживается несколько узлов в конфигурации горизонтального масштабирования. В частности, один узел с ролью главного, один или несколько узлов с рабочими ролями и один или несколько резервных узлов. Однако в любой один момент времени может существовать только один главный узел.


### <a name="architecture-diagram"></a>Схема архитектуры  

![scaleout-nm-standby.png](media/hana-supported-scenario/scaleout-nm-standby.png)

### <a name="ethernet"></a>Ethernet
Ниже приведены предварительно настроенные сетевые интерфейсы.

| Логические интерфейсы сетевого адаптера | Тип SKU | Имя с ОС SUSE | Имя с ОС RHEL | Вариант использования|
| --- | --- | --- | --- | --- |
| Файл , | Тип I | eth0.tenant | eno1.tenant | Между клиентом и HLI |
| b | Тип I | eth2.tenant | eno3.tenant | Обмен данными между узлами |
| C | Тип I | eth1.tenant | eno2.tenant | Между узлом и хранилищем |
| D | Тип I | eth4.tenant | eno4.tenant | Настроен, но не используется |
| Файл , | Тип II | Виртуальная ЛС\<Тенантно > | team0.tenant | Между клиентом и HLI |
| b | Тип II | Виртуальная ЛС\<Тенантно + 2 > | team0.tenant+2 | Обмен данными между узлами |
| C | Тип II | VLAN\<Тенантно + 1 > | team0.tenant+1 | Между узлом и хранилищем |
| D | Тип II | Виртуальная ЛС\<Тенантно + 3 > | team0.tenant+3 | Настроен, но не используется |

### <a name="storage"></a>Служба хранилища
Ниже приведены предварительно настроенные точки подключения.

| Точка подключения | Вариант использования | 
| --- | --- |
|**На главном, рабочем и резервном узлах**|
|/hana/shared | Установка HANA для производственной системы SID | 
|/hana/data/SID/mnt00001 | Установка файлов данных для производственной системы SID | 
|/hana/log/SID/mnt00001 | Установка файлов журналов для производственной системы SID | 
|/hana/logbackups/SID | Журналы повторяемых операций для производственной системы SID |


## <a name="9-scale-out-without-standby"></a>9. горизонтальное масштабирование без резервирования
 
В этой топологии поддерживается несколько узлов в конфигурации горизонтального масштабирования. В частности, один узел с ролью главного и один или несколько узлов с рабочей ролью. Однако в любой один момент времени может существовать только один главный узел.


### <a name="architecture-diagram"></a>Схема архитектуры  

![scaleout-nm.png](media/hana-supported-scenario/scaleout-nm.png)


### <a name="ethernet"></a>Ethernet
Ниже приведены предварительно настроенные сетевые интерфейсы.

| Логические интерфейсы сетевого адаптера | Тип SKU | Имя с ОС SUSE | Имя с ОС RHEL | Вариант использования|
| --- | --- | --- | --- | --- |
| Файл , | Тип I | eth0.tenant | eno1.tenant | Между клиентом и HLI |
| b | Тип I | eth2.tenant | eno3.tenant | Обмен данными между узлами |
| C | Тип I | eth1.tenant | eno2.tenant | Между узлом и хранилищем |
| D | Тип I | eth4.tenant | eno4.tenant | Настроен, но не используется |
| Файл , | Тип II | Виртуальная ЛС\<Тенантно > | team0.tenant | Между клиентом и HLI |
| b | Тип II | Виртуальная ЛС\<Тенантно + 2 > | team0.tenant+2 | Обмен данными между узлами |
| C | Тип II | VLAN\<Тенантно + 1 > | team0.tenant+1 | Между узлом и хранилищем |
| D | Тип II | Виртуальная ЛС\<Тенантно + 3 > | team0.tenant+3 | Настроен, но не используется |

### <a name="storage"></a>Служба хранилища
Ниже приведены предварительно настроенные точки подключения.

| Точка подключения | Вариант использования | 
| --- | --- |
|**На главном и рабочих узлах**|
|/hana/shared | Установка HANA для производственной системы SID | 
|/hana/data/SID/mnt00001 | Установка файлов данных для производственной системы SID | 
|/hana/log/SID/mnt00001 | Установка файлов журналов для производственной системы SID | 
|/hana/logbackups/SID | Журналы повторяемых операций для производственной системы SID |


### <a name="key-considerations"></a>Основные рекомендации
- /usr/sap/SID является символической ссылкой на /hana/shared/SID.

## <a name="10-scale-out-with-dr-using-storage-replication"></a>10. масштабирование с помощью аварийного восстановления с использованием репликации хранилища
 
В этой топологии поддерживается несколько узлов в горизонтальном масштабировании с аварийным восстановлением. Поддерживается как обычное, так и многоцелевое аварийное восстановление. На схеме показано только аварийное восстановление узкого назначения. Эту топологию можно запросить с резервным узлом или без него.


### <a name="architecture-diagram"></a>Схема архитектуры  

![scaleout-with-dr.png](media/hana-supported-scenario/scaleout-with-dr.png)


### <a name="ethernet"></a>Ethernet
Ниже приведены предварительно настроенные сетевые интерфейсы.

| Логические интерфейсы сетевого адаптера | Тип SKU | Имя с ОС SUSE | Имя с ОС RHEL | Вариант использования|
| --- | --- | --- | --- | --- |
| Файл , | Тип I | eth0.tenant | eno1.tenant | Между клиентом и HLI |
| b | Тип I | eth2.tenant | eno3.tenant | Обмен данными между узлами |
| C | Тип I | eth1.tenant | eno2.tenant | Между узлом и хранилищем |
| D | Тип I | eth4.tenant | eno4.tenant | Настроен, но не используется |
| Файл , | Тип II | Виртуальная ЛС\<Тенантно > | team0.tenant | Между клиентом и HLI |
| b | Тип II | Виртуальная ЛС\<Тенантно + 2 > | team0.tenant+2 | Обмен данными между узлами |
| C | Тип II | VLAN\<Тенантно + 1 > | team0.tenant+1 | Между узлом и хранилищем |
| D | Тип II | Виртуальная ЛС\<Тенантно + 3 > | team0.tenant+3 | Настроен, но не используется |

### <a name="storage"></a>Служба хранилища
Ниже приведены предварительно настроенные точки подключения.

| Точка подключения | Вариант использования | 
| --- | --- |
|**На основном узле**|
|/hana/shared | Установка HANA для производственной системы SID | 
|/hana/data/SID/mnt00001 | Установка файлов данных для производственной системы SID | 
|/hana/log/SID/mnt00001 | Установка файлов журналов для производственной системы SID | 
|/hana/logbackups/SID | Журналы повторяемых операций для производственной системы SID |
|**На узле аварийного восстановления**|
|/hana/shared | Установка HANA для производственной системы SID | 
|/hana/data/SID/mnt00001 | Установка файлов данных для производственной системы SID | 
|/hana/log/SID/mnt00001 | Установка файлов журналов для производственной системы SID | 


### <a name="key-considerations"></a>Основные рекомендации
- /usr/sap/SID является символической ссылкой на /hana/shared/SID.
-  При аварийном восстановлении тома и точки подключения настраиваются (помечены как Required for HANA installation (требуются для установки HANA)) для установки экземпляра HANA в производственной среде в единице HLI для аварийного восстановления. 
- При аварийном восстановлении данные, резервные копии журналов и общие тома (помечены как Storage Replication (репликация хранилища)) реплицируются путем создания моментального снимка на рабочем сайте. Эти тома подключены только на время перехода на другой ресурс. Дополнительные сведения см. в документе [Процедура отработки отказа при аварийном восстановлении](https://docs.microsoft.com/azure/virtual-machines/workloads/sap/hana-overview-high-availability-disaster-recovery). 
- Загрузочный том для **класса SKU типа I** реплицируется на узел аварийного восстановления.


## <a name="11-single-node-with-dr-using-hsr"></a>11. один узел с аварийным восстановлением с помощью HSR
 
Эта топология поддерживает один узел в конфигурации масштабирования с одним идентификатором безопасности с репликацией системы HANA на сайт аварийного восстановления для основного идентификатора безопасности. На схеме показана только одноэкземплярная система на основном сайте, однако также поддерживается многоэкземплярная система (MCOS).

### <a name="architecture-diagram"></a>Схема архитектуры  

![Single-node-HSR-Dr-111. png](media/hana-supported-scenario/single-node-hsr-dr-111.png)

### <a name="ethernet"></a>Ethernet
Ниже приведены предварительно настроенные сетевые интерфейсы.

| Логические интерфейсы сетевого адаптера | Тип SKU | Имя с ОС SUSE | Имя с ОС RHEL | Вариант использования|
| --- | --- | --- | --- | --- |
| Файл , | Тип I | eth0.tenant | eno1.tenant | Клиент-ХЛИ/HSR |
| b | Тип I | eth2.tenant | eno3.tenant | Настроен, но не используется |
| C | Тип I | eth1.tenant | eno2.tenant | Между узлом и хранилищем |
| D | Тип I | eth4.tenant | eno4.tenant | Настроен, но не используется |
| Файл , | Тип II | Виртуальная ЛС\<Тенантно > | team0.tenant | Клиент-ХЛИ/HSR |
| b | Тип II | Виртуальная ЛС\<Тенантно + 2 > | team0.tenant+2 | Настроен, но не используется |
| C | Тип II | VLAN\<Тенантно + 1 > | team0.tenant+1 | Между узлом и хранилищем |
| D | Тип II | Виртуальная ЛС\<Тенантно + 3 > | team0.tenant+3 | Настроен, но не используется |

### <a name="storage"></a>Служба хранилища
Следующие точки подключения предварительно настроены в единицах ХЛИ (основной и АВАРИЙный):

| Точка подключения | Вариант использования | 
| --- | --- |
|/hana/shared/SID | Установка HANA для системы SID | 
|/hana/data/SID/mnt00001 | Установка файлов данных для системы SID | 
|/hana/log/SID/mnt00001 | Файлы журнала установки для системы SID | 
|/hana/logbackups/SID | Журналы повторяемых операций для SID |


### <a name="key-considerations"></a>Основные рекомендации
- /usr/sap/SID является символической ссылкой на /hana/shared/SID.
- В MCOS распределение размера тома зависит от размера базы данных в памяти. Чтобы узнать, какие размеры базы данных в памяти поддерживаются с многоэкземплярной системой, ознакомьтесь с [этим разделом](https://docs.microsoft.com/azure/virtual-machines/workloads/sap/hana-overview-architecture).
- Получение синхронизации для узла аварийного восстановления на основном узле с помощью репликации системы HANA. 
- [Global REACH](https://docs.microsoft.com/azure/expressroute/expressroute-global-reach) используется для связи каналов ExpressRoute, чтобы сделать частную сеть между регионами.



## <a name="12-single-node-hsr-to-dr-cost-optimized"></a>12. единый узел HSR в аварийное восстановление (оптимизированные затраты) 
 
 Эта топология поддерживает один узел в конфигурации масштабирования с одним идентификатором безопасности с репликацией системы HANA на сайт аварийного восстановления для основного идентификатора безопасности. На схеме показана только одноэкземплярная система на основном сайте, однако также поддерживается многоэкземплярная система (MCOS). На сайте аварийного восстановления единица HLI используется в качестве экземпляра контроля качества во время выполнения производственных операций на основном сайте. Во время отработки отказа с аварийным восстановлением (или проверки отработки отказа) экземпляр контроля качества на сайте аварийного восстановления выключается.

### <a name="architecture-diagram"></a>Схема архитектуры  

![Single-node-HSR-Dr-Cost-Optimized-121. png](media/hana-supported-scenario/single-node-hsr-dr-cost-optimized-121.png)

### <a name="ethernet"></a>Ethernet
Ниже приведены предварительно настроенные сетевые интерфейсы.

| Логические интерфейсы сетевого адаптера | Тип SKU | Имя с ОС SUSE | Имя с ОС RHEL | Вариант использования|
| --- | --- | --- | --- | --- |
| Файл , | Тип I | eth0.tenant | eno1.tenant | Клиент-ХЛИ/HSR |
| b | Тип I | eth2.tenant | eno3.tenant | Настроен, но не используется |
| C | Тип I | eth1.tenant | eno2.tenant | Между узлом и хранилищем |
| D | Тип I | eth4.tenant | eno4.tenant | Настроен, но не используется |
| Файл , | Тип II | Виртуальная ЛС\<Тенантно > | team0.tenant | Клиент-ХЛИ/HSR |
| b | Тип II | Виртуальная ЛС\<Тенантно + 2 > | team0.tenant+2 | Настроен, но не используется |
| C | Тип II | VLAN\<Тенантно + 1 > | team0.tenant+1 | Между узлом и хранилищем |
| D | Тип II | Виртуальная ЛС\<Тенантно + 3 > | team0.tenant+3 | Настроен, но не используется |

### <a name="storage"></a>Служба хранилища
Ниже приведены предварительно настроенные точки подключения.

| Точка подключения | Вариант использования | 
| --- | --- |
|**На основном сайте**|
|/hana/shared/SID | Установка HANA для производственной системы SID | 
|/hana/data/SID/mnt00001 | Установка файлов данных для производственной системы SID | 
|/hana/log/SID/mnt00001 | Установка файлов журналов для производственной системы SID | 
|/hana/logbackups/SID | Журналы повторяемых операций для производственной системы SID |
|**На сайте аварийного восстановления**|
|/hana/shared/SID | Установка HANA для производственной системы SID | 
|/hana/data/SID/mnt00001 | Установка файлов данных для производственной системы SID | 
|/hana/log/SID/mnt00001 | Установка файлов журналов для производственной системы SID | 
|/hana/logbackups/SID | Журналы повторяемых операций для производственной системы SID |
|/hana/shared/QA-SID | Установка HANA для экземпляра SID для контроля качества | 
|/hana/data/QA-SID/mnt00001 | Установка файлов данных для экземпляра SID для контроля качества | 
|/hana/log/QA-SID/mnt00001 | Установка файлов журналов для экземпляра SID для контроля качества |
|/hana/logbackups/QA-SID | Журналы повторяемых операций для экземпляра SID для контроля качества |

### <a name="key-considerations"></a>Основные рекомендации
- /usr/sap/SID является символической ссылкой на /hana/shared/SID.
- В MCOS распределение размера тома зависит от размера базы данных в памяти. Чтобы узнать, какие размеры базы данных в памяти поддерживаются с многоэкземплярной системой, ознакомьтесь с [этим разделом](https://docs.microsoft.com/azure/virtual-machines/workloads/sap/hana-overview-architecture).
- В АВАРИЙном восстановлении: тома и точки подключения настроены (помечены как "рабочий экземпляр на сайте аварийного восстановления") для установки рабочего экземпляра HANA в блоке ХЛИ аварийного восстановления. 
- При аварийном восстановлении данные, резервные копии журналов, общие тома для контроля качества (помечены как QA Instance installation (установка экземпляра контроля качества)) настраиваются для установки экземпляра контроля качества.
- Получение синхронизации для узла аварийного восстановления на основном узле с помощью репликации системы HANA. 
- [Global REACH](https://docs.microsoft.com/azure/expressroute/expressroute-global-reach) используется для связи каналов ExpressRoute, чтобы сделать частную сеть между регионами.

## <a name="13-high-availability-and-disaster-recovery-with-hsr"></a>13. высокий уровень доступности и аварийное восстановление с помощью HSR 
 
 Эта топология поддерживает два узла для конфигурации репликации системы HANA (HSR) в локальных регионах с высокой доступностью. Для аварийного восстановления третий узел в регионе АВАРИЙного восстановления получает синхронизацию с первичного сайта с помощью HSR (асинхронный режим). 

### <a name="architecture-diagram"></a>Схема архитектуры  

![Hana-System-Replication-Dr-131. png](media/hana-supported-scenario/hana-system-replication-dr-131.png)

### <a name="ethernet"></a>Ethernet
Ниже приведены предварительно настроенные сетевые интерфейсы.

| Логические интерфейсы сетевого адаптера | Тип SKU | Имя с ОС SUSE | Имя с ОС RHEL | Вариант использования|
| --- | --- | --- | --- | --- |
| Файл , | Тип I | eth0.tenant | eno1.tenant | Клиент-ХЛИ/HSR |
| b | Тип I | eth2.tenant | eno3.tenant | Настроен, но не используется |
| C | Тип I | eth1.tenant | eno2.tenant | Между узлом и хранилищем |
| D | Тип I | eth4.tenant | eno4.tenant | Настроен, но не используется |
| Файл , | Тип II | Виртуальная ЛС\<Тенантно > | team0.tenant | Клиент-ХЛИ/HSR |
| b | Тип II | Виртуальная ЛС\<Тенантно + 2 > | team0.tenant+2 | Настроен, но не используется |
| C | Тип II | VLAN\<Тенантно + 1 > | team0.tenant+1 | Между узлом и хранилищем |
| D | Тип II | Виртуальная ЛС\<Тенантно + 3 > | team0.tenant+3 | Настроен, но не используется |

### <a name="storage"></a>Служба хранилища
Ниже приведены предварительно настроенные точки подключения.

| Точка подключения | Вариант использования | 
| --- | --- |
|**На основном сайте**|
|/hana/shared/SID | Установка HANA для производственной системы SID | 
|/hana/data/SID/mnt00001 | Установка файлов данных для производственной системы SID | 
|/hana/log/SID/mnt00001 | Установка файлов журналов для производственной системы SID | 
|/hana/logbackups/SID | Журналы повторяемых операций для производственной системы SID |
|**На сайте аварийного восстановления**|
|/hana/shared/SID | Установка HANA для производственной системы SID | 
|/hana/data/SID/mnt00001 | Установка файлов данных для производственной системы SID | 
|/hana/log/SID/mnt00001 | Установка файлов журналов для производственной системы SID | 
|/hana/logbackups/SID | Журналы повторяемых операций для производственной системы SID |


### <a name="key-considerations"></a>Основные рекомендации
- /usr/sap/SID является символической ссылкой на /hana/shared/SID.
- В АВАРИЙном восстановлении: тома и точки подключения настроены (помечены как "производственный АВАРИЙный экземпляр") для установки рабочего экземпляра HANA на единицу ХЛИ аварийного восстановления. 
- Узел первичного сайта получение синхронизации с узлом аварийного восстановления с помощью репликации системы HANA. 
- [Global REACH](https://docs.microsoft.com/azure/expressroute/expressroute-global-reach) используется для связи каналов ExpressRoute, чтобы сделать частную сеть между регионами.

## <a name="14-high-availability-and-disaster-recovery-with-hsr-cost-optimized"></a>14. высокий уровень доступности и аварийное восстановление с помощью HSR (оптимизированные затраты)
 
 Эта топология поддерживает два узла для конфигурации репликации системы HANA (HSR) в локальных регионах с высокой доступностью. Для аварийного восстановления третий узел в регионе АВАРИЙного восстановления получает синхронизацию с первичного сайта с помощью HSR (асинхронный режим), а другой экземпляр (например, Вопросы и ответы) уже запущены из узла аварийного восстановления. 

### <a name="architecture-diagram"></a>Схема архитектуры  

![Hana-System-Replication-Dr-Cost-Optimized-141. png](media/hana-supported-scenario/hana-system-replication-dr-cost-optimized-141.png)

### <a name="ethernet"></a>Ethernet
Ниже приведены предварительно настроенные сетевые интерфейсы.

| Логические интерфейсы сетевого адаптера | Тип SKU | Имя с ОС SUSE | Имя с ОС RHEL | Вариант использования|
| --- | --- | --- | --- | --- |
| Файл , | Тип I | eth0.tenant | eno1.tenant | Клиент-ХЛИ/HSR |
| b | Тип I | eth2.tenant | eno3.tenant | Настроен, но не используется |
| C | Тип I | eth1.tenant | eno2.tenant | Между узлом и хранилищем |
| D | Тип I | eth4.tenant | eno4.tenant | Настроен, но не используется |
| Файл , | Тип II | Виртуальная ЛС\<Тенантно > | team0.tenant | Клиент-ХЛИ/HSR |
| b | Тип II | Виртуальная ЛС\<Тенантно + 2 > | team0.tenant+2 | Настроен, но не используется |
| C | Тип II | VLAN\<Тенантно + 1 > | team0.tenant+1 | Между узлом и хранилищем |
| D | Тип II | Виртуальная ЛС\<Тенантно + 3 > | team0.tenant+3 | Настроен, но не используется |

### <a name="storage"></a>Служба хранилища
Ниже приведены предварительно настроенные точки подключения.

| Точка подключения | Вариант использования | 
| --- | --- |
|**На основном сайте**|
|/hana/shared/SID | Установка HANA для производственной системы SID | 
|/hana/data/SID/mnt00001 | Установка файлов данных для производственной системы SID | 
|/hana/log/SID/mnt00001 | Установка файлов журналов для производственной системы SID | 
|/hana/logbackups/SID | Журналы повторяемых операций для производственной системы SID |
|**На сайте аварийного восстановления**|
|/hana/shared/SID | Установка HANA для производственной системы SID | 
|/hana/data/SID/mnt00001 | Установка файлов данных для производственной системы SID | 
|/hana/log/SID/mnt00001 | Установка файлов журналов для производственной системы SID | 
|/hana/logbackups/SID | Журналы повторяемых операций для производственной системы SID |
|/hana/shared/QA-SID | Установка HANA для экземпляра SID для контроля качества | 
|/hana/data/QA-SID/mnt00001 | Установка файлов данных для экземпляра SID для контроля качества | 
|/hana/log/QA-SID/mnt00001 | Установка файлов журналов для экземпляра SID для контроля качества |
|/hana/logbackups/QA-SID | Журналы повторяемых операций для экземпляра SID для контроля качества |

### <a name="key-considerations"></a>Основные рекомендации
- /usr/sap/SID является символической ссылкой на /hana/shared/SID.
- В АВАРИЙном восстановлении: тома и точки подключения настроены (помечены как "производственный АВАРИЙный экземпляр") для установки рабочего экземпляра HANA на единицу ХЛИ аварийного восстановления. 
- При аварийном восстановлении данные, резервные копии журналов, общие тома для контроля качества (помечены как QA Instance installation (установка экземпляра контроля качества)) настраиваются для установки экземпляра контроля качества.
- Узел первичного сайта получение синхронизации с узлом аварийного восстановления с помощью репликации системы HANA. 
- [Global REACH](https://docs.microsoft.com/azure/expressroute/expressroute-global-reach) используется для связи каналов ExpressRoute, чтобы сделать частную сеть между регионами.

## <a name="15-scale-out-with-dr-using-hsr"></a>15. масштабирование с помощью аварийного восстановления с использованием HSR
 
В этой топологии поддерживается несколько узлов в горизонтальном масштабировании с аварийным восстановлением. Эту топологию можно запросить с резервным узлом или без него. Узлы первичного сайта синхронизируются с узлами сайта аварийного восстановления с помощью репликации системы HANA (асинхронный режим).


### <a name="architecture-diagram"></a>Схема архитектуры  

[![Scale-out-Dr-HSR-151. png](media/hana-supported-scenario/scale-out-dr-hsr-151.png)](media/hana-supported-scenario/scale-out-dr-hsr-151.png#lightbox)


### <a name="ethernet"></a>Ethernet
Ниже приведены предварительно настроенные сетевые интерфейсы.

| Логические интерфейсы сетевого адаптера | Тип SKU | Имя с ОС SUSE | Имя с ОС RHEL | Вариант использования|
| --- | --- | --- | --- | --- |
| Файл , | Тип I | eth0.tenant | eno1.tenant | Клиент-ХЛИ/HSR |
| b | Тип I | eth2.tenant | eno3.tenant | Обмен данными между узлами |
| C | Тип I | eth1.tenant | eno2.tenant | Между узлом и хранилищем |
| D | Тип I | eth4.tenant | eno4.tenant | Настроен, но не используется |
| Файл , | Тип II | Виртуальная ЛС\<Тенантно > | team0.tenant | Клиент-ХЛИ/HSR |
| b | Тип II | Виртуальная ЛС\<Тенантно + 2 > | team0.tenant+2 | Обмен данными между узлами |
| C | Тип II | VLAN\<Тенантно + 1 > | team0.tenant+1 | Между узлом и хранилищем |
| D | Тип II | Виртуальная ЛС\<Тенантно + 3 > | team0.tenant+3 | Настроен, но не используется |

### <a name="storage"></a>Служба хранилища
Ниже приведены предварительно настроенные точки подключения.

| Точка подключения | Вариант использования | 
| --- | --- |
|**На основном узле**|
|/hana/shared | Установка HANA для производственной системы SID | 
|/hana/data/SID/mnt00001 | Установка файлов данных для производственной системы SID | 
|/hana/log/SID/mnt00001 | Установка файлов журналов для производственной системы SID | 
|/hana/logbackups/SID | Журналы повторяемых операций для производственной системы SID |
|**На узле аварийного восстановления**|
|/hana/shared | Установка HANA для производственной системы SID | 
|/hana/data/SID/mnt00001 | Установка файлов данных для производственной системы SID | 
|/hana/log/SID/mnt00001 | Установка файлов журналов для производственной системы SID | 
|/hana/logbackups/SID | Журналы повторяемых операций для производственной системы SID |


### <a name="key-considerations"></a>Основные рекомендации
- /usr/sap/SID является символической ссылкой на /hana/shared/SID.
- В АВАРИЙном восстановлении: тома и точки подключения настроены для установки рабочего экземпляра HANA в модуле аварийного восстановления ХЛИ. 
- Узлы первичного сайта получают синхронизацию с узлами аварийного восстановления с помощью репликации системы HANA. 
- [Global REACH](https://docs.microsoft.com/azure/expressroute/expressroute-global-reach) используется для связи каналов ExpressRoute, чтобы сделать частную сеть между регионами.


## <a name="next-steps"></a>Дополнительная информация
- Ознакомьтесь со статьей [Инфраструктура и возможности подключения SAP HANA в Azure (крупные экземпляры)](https://docs.microsoft.com/azure/virtual-machines/workloads/sap/hana-overview-infrastructure-connectivity)
- Ознакомьтесь со статьей [Высокий уровень доступности и аварийное восстановление SAP HANA в Azure (крупные экземпляры)](https://docs.microsoft.com/azure/virtual-machines/workloads/sap/hana-overview-high-availability-disaster-recovery)
