---
title: Архитектура хранилища SAP HANA в Azure (крупные экземпляры) | Документация Майкрософт
description: Архитектура хранилища при развертывании SAP HANA в Azure (крупные экземпляры).
services: virtual-machines-linux
documentationcenter: ''
author: RicksterCDN
manager: jeconnoc
editor: ''
ms.service: virtual-machines-linux
ms.devlang: NA
ms.topic: article
ms.tgt_pltfrm: vm-linux
ms.workload: infrastructure
ms.date: 03/05/2019
ms.author: rclaus
ms.custom: H1Hack27Feb2017
ms.openlocfilehash: 02272ee16cf3303890a8ba6d35d38676e98c788c
ms.sourcegitcommit: 3102f886aa962842303c8753fe8fa5324a52834a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "60478656"
---
# <a name="sap-hana-large-instances-storage-architecture"></a>Архитектура хранилища SAP HANA (крупные экземпляры)

Структура хранилища для SAP HANA в Azure (крупные экземпляры) настраивается с помощью классической модели развертывания в соответствии с рекомендациями SAP. Рекомендации описаны в техническом документе с описанием [требований к хранилищу для SAP HANA](https://go.sap.com/documents/2015/03/74cdb554-5a7c-0010-82c7-eda71af511fa.html).

Обычно объем памяти крупных экземпляров HANA класса типа 1 в 4 раза больше объема памяти тома хранилища. Хранилище единиц крупных экземпляров HANA класса типа 2 не будет иметь в четыре раза больший объем памяти. Такой объем предназначен для хранения резервных копий журналов транзакций HANA. Дополнительные сведения см. в статье [Как установить и настроить SAP HANA в Azure (крупные экземпляры)](hana-installation.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json).

См. следующую таблицу, где представлены сведения о выделении объема хранилища. В таблице приведена примерная емкость для разных томов, предоставляемых в составе единиц крупных экземпляров HANA.

| SKU крупных экземпляров HANA | hana/data; | hana/log; | hana/shared. | /hana/logbackups |
| --- | --- | --- | --- | --- |
| S72 | 1280 ГБ | 512 ГБ | 768 ГБ | 512 ГБ |
| S72m | 3328 ГБ | 768 ГБ |1280 ГБ | 768 ГБ |
| S96 | 1280 ГБ | 512 ГБ | 768 ГБ | 512 ГБ |
| S192 | 4608 ГБ | 1024 ГБ | 1536 ГБ | 1024 ГБ |
| S192m | 11 520 ГБ | 1536 ГБ | 1792 ГБ | 1536 ГБ |
| S192xm |  11 520 ГБ |  1536 ГБ |  1792 ГБ |  1536 ГБ |
| S384 | 11 520 ГБ | 1536 ГБ | 1792 ГБ | 1536 ГБ |
| S384m | 12 000 ГБ | 2050 ГБ | 2050 ГБ | 2040 ГБ |
| S384xm | 16 000 ГБ | 2050 ГБ | 2050 ГБ | 2040 ГБ |
| S384xxm |  20 000 ГБ | 3100 ГБ | 2050 ГБ | 3100 ГБ |
| S576m | 20 000 ГБ | 3100 ГБ | 2050 ГБ | 3100 ГБ |
| S576xm | 31 744 ГБ | 4096 ГБ | 2048 ГБ | 4096 ГБ |
| S768m | 28 000 ГБ | 3100 ГБ | 2050 ГБ | 3100 ГБ |
| S768xm | 40 960 ГБ | 6144 ГБ | 4096 ГБ | 6144 ГБ |
| S960m | 36 000 ГБ | 4100 ГБ | 2050 ГБ | 4100 ГБ |


Фактический размер развернутого тома может изменяться в зависимости от развертывания и инструмента, который используется для отображения размера тома.

Если вы разделите SKU крупных экземпляров HANA, примеры возможного деления будут выглядеть следующим образом:

| Секция памяти в ГБ | hana/data; | hana/log; | hana/shared. | hana/log/backup |
| --- | --- | --- | --- | --- |
| 256 | 400 ГБ | 160 ГБ | 304 ГБ | 160 ГБ |
| 512 | 768 ГБ | 384 ГБ | 512 ГБ | 384 ГБ |
| 768 | 1280 ГБ | 512 ГБ | 768 ГБ | 512 ГБ |
| 1024 | 1792 ГБ | 640 ГБ | 1024 ГБ | 640 ГБ |
| 1536 | 3328 ГБ | 768 ГБ | 1280 ГБ | 768 ГБ |


Это примерные объемы томов, которые могут незначительно отличаться в зависимости от развертывания и средств, используемых для просмотра томов. Также существуют другие размеры разделов, например 2,5 ТБ. Размеры этих хранилищ вычисляются по аналогичной формуле, как для разделов выше. Термин "разделы" не подразумевает, что операционная система, память или ресурсы ЦП каким-либо образом разделяются. Таким образом указываются разделы хранения различных экземпляров HANA, которые можно развернуть в одной единице крупных экземпляров HANA. 

Вам может потребоваться больший объем хранилища. Вы можете заказать дополнительное пространство в единицах по 1 ТБ. Это дополнительное хранилище можно добавить в качестве дополнительного тома или использовать для расширения одного или нескольких существующих томов. Невозможно уменьшить размер первоначально развернутых томов, а также перечисленных в таблице выше. Также невозможно изменить имена томов или имена подключений. Тома описанных выше хранилищ присоединяются к единицам крупных экземпляров HANA в качестве томов NFS4.

Вы также можете использовать моментальные снимки хранилища для резервного копирования и восстановления, а также аварийного восстановления. Дополнительные сведения см. в статье [Высокий уровень доступности и аварийное восстановление SAP HANA в Azure (крупные экземпляры)](hana-overview-high-availability-disaster-recovery.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json).

См. руководство по [поддерживаемым сценариям HLI](hana-supported-scenario.md) для изучения конфигурации хранилища для вашего сценария.

## <a name="run-multiple-sap-hana-instances-on-one-hana-large-instance-unit"></a>Запуск нескольких экземпляров SAP HANA в одной единице крупных экземпляров HANA

В единицах крупных экземпляров HANA можно разместить несколько активных экземпляров SAP HANA. Чтобы иметь доступ к моментальным снимкам хранилища и аварийному восстановлению, в такой конфигурации требуется настроить том в каждом экземпляре. В данный момент единицы крупных экземпляров HANA можно разделить следующим образом:

- **S72, S72m, S96, S144, S192**: Шагом приращения 256 ГБ, 256 ГБ и наименьшей начальной единицей. Можно комбинировать шаги приращения 256 ГБ и 512 ГБ до достижения максимального значения объема памяти единицы.
- **S144m и S192m**: Шагом приращения 256 ГБ, с наименьшей единицей 512 ГБ. Можно комбинировать шаги приращения 512 ГБ и 768 ГБ до достижения максимального значения объема памяти единицы.
- **Класс типа II**: С шагом приращения 512 ГБ и наименьшей начальной единицей 2 ТБ. Можно комбинировать шаги приращения 512 ГБ, 1 TБ и 1,5 ТБ до достижения максимального значения объема памяти единицы.

Некоторые примеры использования нескольких экземпляров SAP HANA могут выглядеть так:

| SKU | Размер памяти | Размер хранилища | Размеры с несколькими базами данных |
| --- | --- | --- | --- |
| S72 | 768 ГБ | 3 TБ | 1 экземпляр HANA на 768 ГБ<br /> или 1 экземпляр на 512 ГБ и 1 экземпляр на 256 ГБ<br /> или 3 экземпляра по 256 ГБ | 
| S72m | 1,5 ТБ | 6 TБ | 3 экземпляра HANA 512 ГБ<br />или 1 экземпляр на 512 ГБ и 1 экземпляр на 1 ТБ<br />или 6 экземпляров по 256 ГБ<br />или 1 экземпляр на 1,5 ТБ | 
| S192m | 4 TБ | 16 ТБ | 8 экземпляров по 512 ГБ<br />или 4 экземпляра по 1 ТБ<br />или 4 экземпляра на 512 ГБ и 2 экземпляра на 1 ТБ<br />или 4 экземпляра на 768 ГБ и 2 экземпляра на 512 ГБ<br />или 1 экземпляр на 4 ТБ |
| S384xm | 8 ТБ | 22 ТБ | 4 экземпляра по 2 ТБ<br />или 2 экземпляра по 4 ТБ<br />или 2 экземпляра по 3 ТБ и 1 экземпляр на 2 ТБ<br />или 2 экземпляра по 2,5 ТБ и 1 экземпляр на 3 ТБ<br />или 1 экземпляр на 8 ТБ |


Также существуют другие варианты. 

## <a name="encryption-of-data-at-rest"></a>Шифрование неактивных данных
Хранилище, используемое для крупных экземпляров HANA, обеспечивает прозрачное шифрование данных, так как оно хранится на дисках. Во время развертывания единицы крупных экземпляров HANA вы можете включить шифрование такого типа. После развертывания вы также можете переключиться на зашифрованные тома. Переход от незашифрованных к зашифрованным томам прозрачен и не вызывает простоя. 

Для категории номеров SKU класса 1 том с загрузочным логическим номером LUN зашифрован. Для номеров SKU класса типа 2 крупных экземпляров HANA загрузочный логический номер LUN необходимо зашифровать с помощью методов ОС. Чтобы получить дополнительные сведения, обратитесь к команде по управлению службами Майкрософт.

## <a name="required-settings-for-larger-hana-instances-on-hana-large-instances"></a>Необходимые параметры для крупных экземпляров HANA в крупных экземплярах HANA
Хранилище, используемое в крупных экземплярах HANA имеет ограничение размера файла. [Ограничение размера — 16 ТБ](https://docs.netapp.com/ontap-9/index.jsp?topic=%2Fcom.netapp.doc.dot-cm-vsmg%2FGUID-AA1419CF-50AB-41FF-A73C-C401741C847C.html) каждого файла. В отличие от ограничений на размер файла в файловых системах EXT3, HANA не поддерживает неявно из хранилища ограничение, принудительно хранилища крупных экземпляров HANA. В результате HANA не будет автоматически создавать новый файл данных при достижении максимального размера файла 16 ТБ. Как HANA пытается роста файла 16 ТБ, HANA сообщит, что ошибки и сервер индекса будет завершаться со сбоем в конце.

> [!IMPORTANT]
> Во избежание HANA при попытке увеличения файлов данных за пределы максимального размера файла 16 ТБ хранилища крупных экземпляров HANA, необходимо задать следующие параметры в файле конфигурации global.ini, из HANA
> 
> - datavolume_striping=true
> - datavolume_striping_size_gb = 15000
> - См. также SAP Примечание [#2400005](https://launchpad.support.sap.com/#/notes/2400005)
> - Помните о примечании SAP [#2631285](https://launchpad.support.sap.com/#/notes/2631285)




**Дальнейшие действия**
- См. статью о [поддерживаемых сценариях для крупных экземпляров HANA](hana-supported-scenario.md)