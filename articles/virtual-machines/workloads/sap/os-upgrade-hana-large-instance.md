---
title: Обновление операционной системы для SAP HANA в Azure (крупные экземпляры) | Документация Майкрософт
description: Выполнение обновления операционной системы для SAP HANA в Azure (крупные экземпляры).
services: virtual-machines-linux
documentationcenter: ''
author: saghorpa
manager: juergent
editor: ''
ms.service: virtual-machines-linux
ms.topic: article
ms.tgt_pltfrm: vm-linux
ms.workload: infrastructure
ms.date: 07/04/2019
ms.author: juergent
ms.custom: H1Hack27Feb2017
ms.openlocfilehash: 3a0a5d39a7cb2162186291ea534a623ef45c40d4
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "78675632"
---
# <a name="operating-system-upgrade"></a>Обновление операционной системы
В этом документе описывается обновление операционной системы в HANA (крупные экземпляры).

>[!NOTE]
>Обновление ОС является ответственностью клиента, служба операций Майкрософт может направлять вас к ключевым областям, чтобы следить во время обновления. Перед планированием обновления необходимо обратиться к поставщику операционной системы.

Во время подготовки единицЫ HLI оперативная группа Майкрософт устанавливает операционную систему.
Со временем вам потребуется обслуживать операционную систему (пример: установка исправлений, настройка, обновление и т. д.) на модуле HLI.

Прежде чем внести серьезные изменения в операционную систему (например, обновить SP1 до SP2), необходимо связаться с командой Microsoft Operations, открыв для консультаций билет на поддержку.

Включите в свой билет:

* Идентификатор подписки HLI.
* Имя вашего сервера.
* Уровень исправления, который необходимо применить.
* Дата планирования этого изменения. 

Мы рекомендуем вам открыть этот запрос по крайней мере за неделю до желаемой даты обновления, поскольку команда Operations проверяет необходимость обновления прошивки в колонке сервера.


Сведения о совместимости другой версии SAP HANA с другими версиями Linux см. в [примечании SAP № 2235581](https://launchpad.support.sap.com/#/notes/2235581).


## <a name="known-issues"></a>Известные проблемы

Ниже приведены некоторые распространенные известные проблемы, возникающие во время обновления.
- Для категории номеров SKU класса II после установки новой версии операционной системы удаляется Software Foundation Server (SFS). Необходимо переустановить совместимый SFS после обновления ОС.
- Драйверы карт Ethernet (ENIC и FNIC) откатываются до предыдущей версии. Необходимо переустановить совместимую версию драйверов после обновления.

## <a name="sap-hana-large-instance-type-i-recommended-configuration"></a>Рекомендуемая конфигурация SAP HANA Large Instance (тип I)

Конфигурация операционной системы может со временем отойти от рекомендуемых настроек из-за исправления, обновления системы и изменений, внесенных клиентами. Кроме того, корпорация Майкрософт определяет обновления, необходимые для существующих систем, чтобы убедиться, что они оптимально настроены для наилучшей производительности и устойчивости. В соответствии с инструкциями излагаются рекомендации, которые касаются производительности сети, стабильности системы и оптимальной производительности HANA.

### <a name="compatible-enicfnic-driver-versions"></a>Совместимые версии драйверов eNIC/fNIC
  Для обеспечения надлежащей производительности сети и стабильности системы рекомендуется обеспечить установку соответствующей версии eNIC и fNIC для ОС, как показано в следующей таблице совместимости. Серверы поставляются клиентам с совместимыми версиями. Обратите внимание, что в некоторых случаях во время исправления ОС/Ядра драйверы могут откатиться к версиям драйверов по умолчанию. Убедитесь, что соответствующая версия драйвера работает после OS / Ядра патч операций.
       
      
  |  Поставщик ОС    |  Версия пакета ОС     |  Версия встроенного ПО  |  водитель eNIC |  FNIC Драйвер | 
  |---------------|-------------------------|--------------------|--------------|--------------|
  |   Suse        |  SLES 12 SP2            |   3.1.3ч           |  2.3.0.40    |   1.6.0.34   |
  |   Suse        |  SLES 12 с пакетом обновления 3 (SP3)            |   3.1.3ч           |  2.3.0.44    |   1.6.0.36   |
  |   Red Hat     |  RHEL 7.2;               |   3.1.3ч           |  2.3.0.39    |   1.6.0.34   |
 

### <a name="commands-for-driver-upgrade-and-to-clean-old-rpm-packages"></a>Команды для обновления драйвера и очистки старых пакетов об / мин
```
rpm -U driverpackage.rpm
rpm -e olddriverpackage.rpm
```

#### <a name="commands-to-confirm"></a>Команды для подтверждения
```
modinfo enic
modinfo fnic
```

### <a name="suse-hlis-grub-update-failure"></a>Сбой обновления SuSE HLIS GRUB
SAP на Azure HANA Large Instances (тип I) может находиться в незагружаемом состоянии после обновления. Ниже процедура фиксирует эту проблему.
#### <a name="execution-steps"></a>Шаги выполнения


*   Выполняйте `multipath -ll` команду.
*   Получить идентификатор LUN, размер которого составляет около 50G, или используйте команду:`fdisk -l | grep mapper`
*   Обновление `/etc/default/grub_installdevice` файла `/dev/mapper/<LUN ID>`с строкой . Пример: /dev/mapper/3600a09803830372f483f495242534a56
>[!NOTE]
>Идентификатор LUN варьируется от сервера к серверу.


### <a name="disable-edac"></a>Неуправляемый EDAC 
   Модуль обнаружения и коррекции ошибок (EDAC) помогает в обнаружении и исправлении ошибок памяти. Однако базовое оборудование для SAP HANA на Azure Large Instances (тип I) уже выполняет ту же функцию. Наличие той же функции, включенной на уровнях аппаратного обеспечения и операционной системы (ОС), может привести к конфликтам и может привести к случайным, незапланированным отключениям сервера. Поэтому рекомендуется отключить модуль от ОС.

#### <a name="execution-steps"></a>Шаги выполнения

* Проверьте, включен ли модуль EDAC. Если вывод возвращается ниже команды, это означает, что модуль включен. 
```
lsmod | grep -i edac 
```
* Отойти от модулей, приложив следующие строки к файлу`/etc/modprobe.d/blacklist.conf`
```
blacklist sb_edac
blacklist edac_core
```
Для внесения изменений требуется перезагрузка. Выполнить `lsmod` команду и проверить модуль не присутствует там в выходе.


### <a name="kernel-parameters"></a>параметры ядра;
   Убедитесь, что `transparent_hugepage`правильные `processor.max_cstate` `ignore_ce` настройки для , `intel_idle.max_cstate` `numa_balancing`и применяются.

* intel_idle.max_cstate-1
* процессор.max_cstateNo1
* transparent_hugepage никогда
* numa_balancing-неудательная
* мбезignore_ce


#### <a name="execution-steps"></a>Шаги выполнения

* Добавьте эти параметры `GRB_CMDLINE_LINUX` в строку в файле`/etc/default/grub`
```
intel_idle.max_cstate=1 processor.max_cstate=1 transparent_hugepage=never numa_balancing=disable mce=ignore_ce
```
* Создайте новый файл grub.
```
grub2-mkconfig -o /boot/grub2/grub.cfg
```
* Система перезагрузки.


## <a name="next-steps"></a>Дальнейшие действия
- Ознакомьтесь с [резервным копированием и восстановлением](hana-overview-high-availability-disaster-recovery.md) операционной системы для номеров SKU класса I.
- Обратите [резервное копирование ОС для II типа SkUs марок Revision 3](os-backup-type-ii-skus.md) для класса SKU типа II.
