---
title: Размеры виртуальных машин Azure — HPC | Документация Майкрософт
description: Список различных размеров, доступных для высокопроизводительных вычислительных виртуальных машин в Azure. Сведения о количестве виртуальных ЦП, дисков данных и сетевых адаптеров, а также о пропускной способности хранилища и сети для размеров виртуальных машин этой серии.
services: virtual-machines
documentationcenter: ''
author: vermagit
manager: gwallace
editor: ''
tags: azure-resource-manager,azure-service-management
ms.assetid: ''
ms.service: virtual-machines
ms.devlang: na
ms.topic: article
ms.workload: infrastructure-services
ms.date: 02/03/2020
ms.author: amverma
ms.reviewer: jonbeck
ms.openlocfilehash: a5b0eb0c8bd56a28889945480e95b6413dc9b4dd
ms.sourcegitcommit: 747a20b40b12755faa0a69f0c373bd79349f39e3
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/27/2020
ms.locfileid: "77660025"
---
# <a name="high-performance-compute-vm-sizes"></a>Размеры виртуальных машин, оптимизированных для высокопроизводительных вычислений

Виртуальные машины Azure серии H предназначены для обеспечения производительности классов, масштабируемости MPI и экономичности для различных реальных рабочих нагрузок HPC.

[Серия HBv2](hbv2-series.md) Виртуальные машины 200 ГБ/с Mellanox HDR InfiniBand, а для виртуальных машин серии ХБ и HC — 100 ГБ/с Mellanox ЕДР InfiniBand. Каждый из этих типов виртуальных машин подключен в неблокирующем дереве FAT для обеспечения оптимальной и стабильной производительности RDMA. HBv2 виртуальные машины поддерживают адаптивную маршрутизацию и динамический подключенный транспорт (ДКТ, дополнительно к стандартным транспортам RC и обновления). Эти функции улучшают производительность, масштабируемость и согласованность приложений, а их использование настоятельно рекомендуется.

[Серия ХБ](hb-series.md) Виртуальные машины оптимизированы для приложений, управляемых с помощью пропускной способности памяти, например для жидкости Dynamics, явного анализа конечных элементов и моделирования погоды. ХБ VMS 60 ядра процессора AMD ЕПИК 7551, 4 ГБ ОЗУ на ядро ЦП и без технологии hypering. Платформа AMD ЕПИК предоставляет более 260 ГБ/с для пропускной способности памяти.

[Серия HC](hc-series.md) Виртуальные машины оптимизированы для приложений, управляемых с помощью сжатых вычислений, например неявного анализа конечных элементов, молекулярное Dynamics и вычислительных химия. HC VMS 44 процессорных ядер Intel Xeon Platinum 8168, 8 ГБ ОЗУ на ядро ЦП и без технологии hypering. Платформа Intel Xeon Platinum поддерживает обширную экосистему программных средств Intel, например библиотеку Intel Math Kernel.

[Серия H](h-series.md) Виртуальные машины оптимизированы для приложений, которые управляются высокой частотой ЦП или большими объемами памяти на базовые требования. Виртуальные машины серии H с 8 или 16 процессоров Intel Xeon 3 2667 v3, 7 или 14 ГБ ОЗУ на ядро ЦП и без технологии Hyper-Threading. Функции серии H 56 ГБ/с Mellanox FDR InfiniBand в неблокирующей конфигурации дерева FAT для обеспечения постоянной производительности RDMA. Виртуальные машины серии H поддерживают Intel MPI 5. x и MS-MPI.

## <a name="deployment-considerations"></a>Рекомендации по развертыванию

- **Подписка Azure.** Чтобы развернуть большое число экземпляров для ресурсоемких вычислений, рекомендуем подписку с оплатой по мере использования или другие варианты покупки. Если вы используете [бесплатную учетную запись Azure](https://azure.microsoft.com/free/), вам доступно ограниченное количество вычислительных ядер Azure.

- **Цены и доступность.** Виртуальные машины предлагаются только в ценовой категории уровня "Стандартный". Проверьте [доступность продуктов по регионам](https://azure.microsoft.com/global-infrastructure/services/) , чтобы узнать, в каких регионах Azure их можно использовать.
- **Квота ядер**. Вам может потребоваться увеличить стандартную квоту на число ядер в подписке Azure. Кроме того, количество ядер, которые можно развернуть для некоторых семейств размеров виртуальных машин (включая серию H), может быть ограничено условиями вашей подписки. Чтобы увеличить квоту, [отправьте запрос в службу поддержки](../azure-supportability/how-to-create-azure-support-request.md). Это бесплатная услуга. (Ограничения по умолчанию могут быть разными в зависимости от категории подписки).

  > [!NOTE]
  > Если вам нужны ресурсы в очень большом объеме, обратитесь в службу поддержки Azure. Квоты Azure — это ограничения по кредитам, а не гарантированная емкость. Вне зависимости от квоты с вас будет взиматься плата только за используемые ядра.
  
- **Виртуальная сеть** — [виртуальная сеть](https://azure.microsoft.com/documentation/services/virtual-network/) Azure не требуется для использования ресурсоемких экземпляров. Но для нескольких развертываний вам потребуется по крайней мере облачная виртуальная сеть Azure или подключение типа "сеть — сеть", если нужен доступ к локальным ресурсам. При необходимости создайте виртуальную сеть, чтобы развернуть экземпляры. Добавление виртуальных машин для ресурсоемких вычислений в виртуальную сеть в территориальной группе не поддерживается.
- **Изменение размера.** Из-за специализированного оборудования изменить можно только размер экземпляров для ресурсоемких вычислений одного семейства размеров (серии H или серии A для ресурсоемких вычислений). Например, можно изменить только размер виртуальной машины серии H (один размер из серии H на другой размер из этой же серии). Кроме того, не поддерживается изменение размера экземпляра, не предназначенного для ресурсоемких вычислений, на размер экземпляра, предназначенного для таких вычислений.  
## <a name="rdma-capable-instances"></a>Экземпляры с поддержкой RDMA

Подмножество экземпляров с ресурсоемкими вычислениями (A8, A9, H16r, H16mr, ХБ и HC) — это сетевой интерфейс для подключения удаленного доступа к памяти (RDMA). Выбранные размеры серии N, обозначенные r, такие как конфигурации конфигурация nc24rs (NC24rs_v2 и NC24rs_v3), также поддерживают RDMA. Этот интерфейс является дополнением к стандартному сетевому интерфейсу Azure, который доступен для виртуальных машин других размеров.

Этот интерфейс позволяет экземплярам, поддерживающим RDMA, взаимодействовать через сеть InfiniBand (геодоступность), работающую на скорости ЕДР для хб, HC, FDR для H16r, H16mr и виртуальных машин серии N, поддерживающих RDMA, а также ставок QDR для виртуальных машин A8 и A9. Эти возможности RDMA позволяют увеличить масштабируемость и производительность определенных приложений с интерфейсом MPI. Дополнительные сведения о скорости см. в таблицах на этой странице.

> [!NOTE]
> В Azure избыточные IP-адреса поддерживаются только на виртуальных машинах с поддержкой SR-IOV (SR-IOV для InfiniBand, в настоящее время ХБ и HC). Для всех экземпляров с поддержкой RDMA поддерживается RDMA.
- **Операционная система** — Windows Server 2016 на всех перечисленных выше виртуальных машинах серии HPC. Windows Server 2012 R2, Windows Server 2012 также поддерживаются на виртуальных машинах, не использующих SR-IOV (таким образом, исключая ХБ и HC).

- **MPI** . размеры виртуальных машин с поддержкой SR-IOV в Azure (ХБ, HC) позволяют использовать почти любую версию MPI с Mellanox офед.
На виртуальных машинах, не использующих SR-IOV, поддерживаемые реализации MPI используют интерфейс Microsoft Network Direct (ND) для обмена данными между экземплярами. Таким образом, поддерживаются только версии Microsoft MPI (MS-MPI) 2012 R2 и более поздних версий и Intel MPI 5. x. Более поздние версии (2017, 2018) библиотеки Intel MPI Runtime могут быть несовместимыми с драйверами Azure RDMA.

- **Расширение виртуальной машины инфинибанддривервиндовс** . на виртуальных машинах с поддержкой RDMA добавьте расширение инфинибанддривервиндовс, чтобы включить InfiniBand. Это расширение виртуальной машины Windows устанавливает драйверы сетевого Direct Windows (на виртуальных машинах без SR-IOV) или драйверы Mellanox ОФЕД (на виртуальных машинах SR-IOV) для подключения RDMA.
В некоторых развертываниях экземпляров A8 и A9 расширение HpcVmDrivers добавляется автоматически. Обратите внимание, что расширение виртуальной машины HpcVmDrivers является устаревшим. Он не будет обновлен. Чтобы добавить в виртуальную машину расширение виртуальной машины, можно использовать командлеты [Azure PowerShell](/powershell/azure/overview). 

  Следующая команда устанавливает последнюю версию расширения Инфинибанддривервиндовс версии 1,0 на существующую виртуальную машину с поддержкой RDMA с именем *myVM* , развернутую в группе ресурсов с именем *MyResourceGroup* в регионе *Западная часть США* :

  ```powershell
  Set-AzVMExtension -ResourceGroupName "myResourceGroup" -Location "westus" -VMName "myVM" -ExtensionName "InfiniBandDriverWindows" -Publisher "Microsoft.HpcCompute" -Type "InfiniBandDriverWindows" -TypeHandlerVersion "1.0"
  ```

  Кроме того, расширения ВМ можно добавить в шаблоны Azure Resource Manager для упрощения развертывания со следующим элементом JSON:

  ```json
  "properties":{
  "publisher": "Microsoft.HpcCompute",
  "type": "InfiniBandDriverWindows",
  "typeHandlerVersion": "1.0",
  } 
  ```

  Следующая команда устанавливает последнюю 1,0 версию расширения Инфинибанддривервиндовс на всех виртуальных машинах с поддержкой RDMA в существующем масштабируемом наборе виртуальных машин с именем *myVMSS* , развернутом в группе ресурсов с именем *myResourceGroup*:

  ```powershell
  $VMSS = Get-AzVmss -ResourceGroupName "myResourceGroup" -VMScaleSetName "myVMSS"
  Add-AzVmssExtension -VirtualMachineScaleSet $VMSS -Name "InfiniBandDriverWindows" -Publisher "Microsoft.HpcCompute" -Type "InfiniBandDriverWindows" -TypeHandlerVersion "1.0"
  Update-AzVmss -ResourceGroupName "myResourceGroup" -VMScaleSetName "MyVMSS" -VirtualMachineScaleSet $VMSS
  Update-AzVmssInstance -ResourceGroupName "myResourceGroup" -VMScaleSetName "myVMSS" -InstanceId "*"
  ```

  Дополнительные сведения см. в статье [Обзор расширений и компонентов виртуальной машины под управлением Windows](./extensions/overview.md). Вы также можете работать с расширениями для виртуальных машин, развернутых в рамках [классической модели развертывания](https://docs.microsoft.com/previous-versions/azure/virtual-machines/windows/classic/agents-and-extensions-classic).

- **Адресное пространство сети RDMA.** Сеть RDMA в Azure резервирует адресное пространство 172.16.0.0/16. Чтобы выполнять приложения MPI в экземплярах, развернутых в виртуальной сети Azure, убедитесь, что адресное пространство виртуальной сети не пересекается с сетью RDMA.

## <a name="cluster-configuration-options"></a>Параметры конфигурации кластера

Azure предоставляет несколько вариантов для создания кластеров виртуальных машин для Windows HPC, которые могут взаимодействовать с помощью сети RDMA. 

- **Виртуальные машины**. Разверните виртуальные машины HPC с поддержкой RDMA в одну группу доступности (используя модель развертывания Azure Resource Manager). Если вы используете классическую модель развертывания, разверните виртуальные машины в одну облачную службу. 

- **Масштабируемые наборы виртуальных машин** — в масштабируемом наборе виртуальных машин убедитесь, что развертывание ограничивается одной группой размещения. Например, в шаблоне Resource Manager задайте значение `singlePlacementGroup` для свойства `true`. 

- **MPI между виртуальными машинами** . Если между виртуальными машинами требуется подключение MPI, убедитесь, что виртуальные машины находятся в одной группе доступности или на виртуальной машине с одинаковым масштабируемым набором.

- **Azure CycleCloud**. Создайте кластер HPC в [Azure CycleCloud](/azure/cyclecloud/), чтобы запустить задания MPI на узлах Windows.

- **Пакетная служба Azure**. Создайте пул [пакетной службы Azure](/azure/batch/) для выполнения рабочих нагрузок MPI на вычислительных узлах Windows Server. Дополнительные сведения см. в статье [Использование экземпляров с поддержкой RDMA или графического процессора (GPU) в пулах пакетной службы](../batch/batch-pool-compute-intensive-sizes.md). Чтобы запустить рабочие нагрузки на основе контейнера в пакетной службе, ознакомьтесь с проектом [Batch Shipyard](https://github.com/Azure/batch-shipyard).

- Пакет **Microsoft HPC pack** - [Пакет HPC](https://docs.microsoft.com/powershell/high-performance-computing/overview) включает среду выполнения для MS-MPI, которая использует сеть Azure RDMA при развертывании на виртуальных машинах Linux с поддержкой RDMA. Примеры развертываний см. [в разделе Настройка кластера RDMA Linux с пакетом HPC для запуска приложений MPI](https://docs.microsoft.com/powershell/high-performance-computing/hpcpack-linux-openfoam).

## <a name="other-sizes"></a>Остальные размеры

- [Универсальные](sizes-general.md)
- [Оптимизированные для вычислений](sizes-compute.md)
- [Оптимизированные для памяти](sizes-memory.md)
- [Оптимизированные для хранилища](sizes-storage.md)
- [Оптимизированные для GPU](sizes-gpu.md)
- [Предыдущие поколения](sizes-previous-gen.md)

## <a name="next-steps"></a>Следующие шаги

- Сведения о том, как использовать экземпляры с большим объемом вычислений с пакетом HPC на Windows Server, см. в статье [Настройка кластера RDMA Linux с помощью пакета HPC для запуска приложений MPI](https://docs.microsoft.com/powershell/high-performance-computing/hpcpack-linux-openfoam).

- Сведения об использовании экземпляров для ресурсоемких вычислений при запуске приложений MPI с использованием пакетной службы Azure см. в статье [Использование задач с несколькими экземплярами для запуска приложений с интерфейсом передачи сообщений в пакетной службе](../batch/batch-mpi.md).

- Узнайте больше о том, как с помощью [единиц вычислений Azure (ACU)](acu.md) сравнить производительность вычислений для различных номеров SKU Azure.