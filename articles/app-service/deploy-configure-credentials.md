---
title: Настройка учетных данных развертывания
description: Сведения о типах учетных данных развертывания в службе приложений Azure, их настройке и использовании.
ms.topic: article
ms.date: 08/14/2019
ms.reviewer: byvinyal
ms.custom: seodec18
ms.openlocfilehash: 653110b953b6947254d5063a9e389505d45ea4cb
ms.sourcegitcommit: dbe434f45f9d0f9d298076bf8c08672ceca416c6
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/17/2020
ms.locfileid: "92149022"
---
# <a name="configure-deployment-credentials-for-azure-app-service"></a>Настройка учетных данных развертывания службы приложений Azure
[Служба приложений Azure](./overview.md) поддерживает два типа учетных данных для [развертывания локальной системы Git](deploy-local-git.md) и [развертывания FTP(S)](deploy-ftp.md). Эти учетные данные не совпадают с учетными данными подписки Azure.

[!INCLUDE [app-service-deploy-credentials](../../includes/app-service-deploy-credentials.md)]

## <a name="configure-user-level-credentials"></a><a name="userscope"></a>Настройка учетных данных на уровне пользователя

Учетные данные на уровне пользователя можно настроить на [странице ресурсов](../azure-resource-manager/management/manage-resources-portal.md#manage-resources) любого приложения. Независимо от того, в каком приложении вы настроите эти учетные данные, они будут применяться для всех приложений и всех подписок в учетной записи Azure. 

### <a name="in-the-cloud-shell"></a>В Cloud Shell

Чтобы настроить пользователя развертывания, выполните в [Cloud Shell](https://shell.azure.com) команду [az webapp deployment user set](/cli/azure/webapp/deployment/user?view=azure-cli-latest#az-webapp-deployment-user-set). Вместо \<username> и \<password> укажите имя пользователя и пароль развертывания. 

- Имя пользователя должно быть уникальным в Azure. Кроме того, чтобы отправка в локальный репозиторий Git работала, имя пользователя не должно содержать символ @. 
- Пароль должен содержать не менее восьми символов и включать два из трех следующих элементов: буквы, цифры и символы. 

```azurecli-interactive
az webapp deployment user set --user-name <username> --password <password>
```

В выходных данных JSON пароль отображается как `null`. Если появляется сообщение об ошибке `'Conflict'. Details: 409`, измените имя пользователя. Если появляется сообщение об ошибке `'Bad Request'. Details: 400`, используйте более надежный пароль. 

### <a name="in-the-portal"></a>Просмотр на портале

Чтобы можно было открыть страницу учетных данных развертывания, на портале Azure должно существовать хотя бы одно приложение. Чтобы настроить учетные данные на уровне пользователя, выполните следующие действия.

1. В [портал Azure](https://portal.azure.com)в меню слева выберите панель мониторинга **службы приложений**  >  **\<any_app>**  >  **центр развертывания**  >  **FTP**  >  **Dashboard**.

    ![Здесь показано, как можно выбрать панель мониторинга FTP в центре развертывания в службах приложений Azure.](./media/app-service-deployment-credentials/access-no-git.png)

    Если вы уже настроили развертывание Git, выберите **Службы приложений** >  **&lt;any_app >**  > **Центр развертывания** > **FTP/Учетные данные**.

    ![Здесь показано, как можно выбрать панель мониторинга FTP в центре развертывания в службах приложений Azure для настроенного развертывания Git.](./media/app-service-deployment-credentials/access-with-git.png)

2. Выберите **Учетные данные пользователя**, укажите имя пользователя и пароль, а затем нажмите кнопку **Сохранить учетные данные**.

Когда вы настроите учетные данные развертывания, имя пользователя для развертывания *Git* можно будет найти на странице **Обзор** приложения.

![Здесь показано, как найти имя пользователя развертывания Git на странице обзора приложения.](./media/app-service-deployment-credentials/deployment_credentials_overview.png)

Если развертывание Git настроено, на странице отображается **имя пользователя Git или развертывания**; в противном случае **имя пользователя FTP или развертывания**.

> [!NOTE]
> Azure не отображает пароль развертывания на уровне пользователя. Если вы забыли пароль, можно сбросить учетные данные, выполнив действия, описанные в этом разделе.
>
> 

## <a name="use-user-level-credentials-with-ftpftps"></a>Использование учетных данных на уровне пользователя с помощью FTP или FTPS

Проверка подлинности в конечной точке FTP или FTPS с использованием учетных данных уровня пользователя требует имени пользователя в следующем формате: `<app-name>\<user-name>`

Так как учетные данные на уровне пользователя привязаны к пользователю, а не к конкретному ресурсу, имя пользователя должно быть в этом формате для направления действия входа в подходящую конечную точку приложения.

## <a name="get-and-reset-app-level-credentials"></a><a name="appscope"></a>Установка и сброс учетных данных на уровне приложений
Получить такие учетные данные можно так.

1. На [портале Azure](https://portal.azure.com) в меню слева последовательно выберите **Службы приложений** >  **&lt;любое_приложение>**  > **Центр развертывания** > **FTP/Учетные данные**.

2. Выберите **Учетные данные приложения**. Скопируйте имя пользователя или пароль с помощью ссылки **Копировать**.

Чтобы сбросить учетные данные на уровне приложения, выберите **Сбросить учетные данные** в том же диалоговом окне.

## <a name="disable-basic-authentication"></a>Отключить обычную проверку подлинности

Некоторые организации должны удовлетворять требованиям безопасности, а отключать доступ через FTP или WebDeploy. Таким образом, члены Организации могут получать доступ к своим службам приложений только через API-интерфейсы, управляемые Azure Active Directory (Azure AD).

### <a name="ftp"></a>FTP

Чтобы отключить FTP-доступ к сайту, выполните следующую команду интерфейса командной строки. Замените заполнители своей группой ресурсов и именем сайта. 

```bash
az resource update --resource-group <resource-group> --name ftp --namespace Microsoft.Web --resource-type basicPublishingCredentialsPolicies --parent sites/<site-name> --set properties.allow=false
```

Чтобы убедиться, что FTP-доступ заблокирован, можно попытаться выполнить проверку подлинности с помощью FTP-клиента, например FileZilla. Чтобы получить учетные данные публикации, перейдите в колонку "Обзор" сайта и щелкните Скачать профиль публикации. Для проверки подлинности используйте имя узла FTP, имя пользователя и пароль, и вы получите ответ об ошибке 401, указывающий на то, что вы не прошли авторизацию.

### <a name="webdeploy-and-scm"></a>WebDeploy и SCM

Чтобы отключить базовый доступ с проверкой подлинности к порту веб-развертывания и сайту SCM, выполните следующую команду CLI. Замените заполнители своей группой ресурсов и именем сайта. 

```bash
az resource update --resource-group <resource-group> --name scm --namespace Microsoft.Web --resource-type basicPublishingCredentialsPolicies --parent sites/<site-name> --set properties.allow=false
```

Чтобы убедиться, что учетные данные профиля публикации заблокированы для WebDeploy, попробуйте [Опубликовать веб-приложение с помощью Visual Studio 2019](/visualstudio/deployment/quickstart-deploy-to-azure?view=vs-2019).

### <a name="disable-access-to-the-api"></a>Отключить доступ к API

API в предыдущем разделе является резервной системой управления доступом на основе ролей Azure (Azure RBAC). Это означает, что вы можете [создать настраиваемую роль](../role-based-access-control/custom-roles.md#steps-to-create-a-custom-role) и назначить ей пользователей с низкими привелджедми, чтобы они не могли включить обычную проверку подлинности на всех сайтах. Чтобы настроить пользовательскую роль, [выполните следующие инструкции](https://azure.github.io/AppService/2020/08/10/securing-data-plane-access.html#create-a-custom-rbac-role).

Можно также использовать [Azure Monitor](https://azure.github.io/AppService/2020/08/10/securing-data-plane-access.html#audit-with-azure-monitor) для аудита любых успешных запросов проверки подлинности и применения [политики Azure](https://azure.github.io/AppService/2020/08/10/securing-data-plane-access.html#enforce-compliance-with-azure-policy) для применения этой конфигурации ко всем сайтам в подписке.

## <a name="next-steps"></a>Дальнейшие действия

Узнайте, как использовать эти учетные данные для развертывания приложения из [локального репозитория Git](deploy-local-git.md) или с помощью [FTP(S)](deploy-ftp.md).