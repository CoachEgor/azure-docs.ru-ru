---
title: Настройка приложения службы приложений для использования входа по учетной записи Майкрософт
description: Узнайте, как настроить аутентификацию учетной записи Майкрософт в качестве поставщика идентификационных данных для службы приложений приложений или приложений Azure Functions.
ms.assetid: ffbc6064-edf6-474d-971c-695598fd08bf
ms.topic: article
ms.date: 08/08/2019
ms.custom: fasttrack-edit
ms.openlocfilehash: ea745aa00f8990a2d1232a19780fdc70e2f78996
ms.sourcegitcommit: ced98c83ed25ad2062cc95bab3a666b99b92db58
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/31/2020
ms.locfileid: "80437968"
---
# <a name="configure-your-app-service-or-azure-functions-app-to-use-microsoft-account-login"></a>Настройте приложение App Service или приложение Azure Functions для использования входа в учетную запись Майкрософт

[!INCLUDE [app-service-mobile-selector-authentication](../../includes/app-service-mobile-selector-authentication.md)]

Эта тема показывает, как настроить службу приложений Azure или функции Azure для использования AAD для поддержки личных логинов учетной записи Майкрософт.

> [!NOTE]
> Как личные учетные записи Майкрософт, так и организационные учетные записи используют поставщика идентификационных данных AAD. В настоящее время невозможно настроить этого поставщика идентификационных данных для поддержки обоих типов входов в систему.

## <a name="register-your-app-with-microsoft-account"></a><a name="register-microsoft-account"> </a>Регистрация приложения с использованием учетной записи Майкрософт

1. Перейдите на [**регистрацию приложений**](https://portal.azure.com/#blade/Microsoft_AAD_RegisteredApps/ApplicationsListBlade) на портале Azure. При необходимости вопийте с учетной записью Майкрософт.
1. Выберите **новую регистрацию,** затем введите имя приложения.
1. Под **типами поддерживаемых учетных записей**выберите **учетные записи в любом каталоге организационных данных (любой каталог Azure AD - Multitenant) и личных учетных записях Майкрософт (например, Skype, Xbox)**
1. В **перенаправить URIs**, выберите `https://<app-domain-name>/.auth/login/aad/callback` **веб**, а затем введите . Замените>* \<доменного имени приложения* доменным именем доменным именем вашего приложения.  Например, `https://contoso.azurewebsites.net/.auth/login/aad/callback`. Обязательно используйте схему HTTPS в URL.

1. Выберите **Зарегистрировать**.
1. Копирование **идентификатора приложения (клиента).** Он понадобится вам позднее.
1. С левой панели, выберите **Сертификаты & секреты** > **Новый секрет клиента**. Введите описание, выберите продолжительность действия и выберите **Добавить**.
1. Копирование значения, которое отображается на странице **«Сертификаты & секреты».** После того, как вы покинете страницу, она больше не будет отображаться.

    > [!IMPORTANT]
    > Секретное значение клиента (пароль) является важным учетным данным безопасности. Не сообщайте пароль никому и не раскрывайте его в клиентском приложении.

## <a name="add-microsoft-account-information-to-your-app-service-application"></a><a name="secrets"> </a>Добавление данных учетной записи Майкрософт в приложение службы приложений

1. Зайдите в приложение на [портале Azure].
1. Выберите **Настройки** > **Аутентификации / Авторизации**, и убедитесь, что проверка **подлинности службы приложений** находится **на**.
1. В разделе **Поставщики проверки подлинности** выберите **Azure Active Directory**. Выберите **Расширенный** **режим управления.** Вставьте в id-идентификатор приложения (клиента) и секрет клиента, который вы получили ранее. Используется **https://login.microsoftonline.com/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0** для поля **Эмитентур Url.**
1. Щелкните **ОК**.

   Служба приложений обеспечивает аутентификацию, но не ограничивает авторизованный доступ к содержимому вашего сайта и AA. Авторизация пользователей должна быть включена в код приложения.

1. (Необязательно) Чтобы ограничить доступ к пользователям учетных записей Майкрософт, установите **действие Action, если запрос не проверен** для входа в журнал с active **Directory Azure.** При настройке этой функции приложение требует проверки подлинности всех запросов. Он также перенаправляет все непроверенные запросы на использование AAD для проверки подлинности. Обратите внимание, что, поскольку вы настроили свой **url-адрес для** использования клиента учетной записи Майкрософт, только личные учетные данные будут успешно аутентифицироваться.

   > [!CAUTION]
   > Ограничение доступа таким образом распространяется на все вызовы в ваше приложение, что может оказаться нежелательным для приложений, имеющих общедоступную домашнюю страницу, как во многих одностраничных приложениях. Для таких приложений может быть предпочтительнее **разрешить анонимные запросы (без действия),** чтобы приложение вручную начало аутентификацию. Для получения дополнительной информации [см.](overview-authentication-authorization.md#authentication-flow)

1. Щелкните **Сохранить**.

Теперь вы можете использовать учетную запись Майкрософт для проверки подлинности в приложении.

## <a name="next-steps"></a><a name="related-content"> </a>Следующие шаги

[!INCLUDE [app-service-mobile-related-content-get-started-users](../../includes/app-service-mobile-related-content-get-started-users.md)]

<!-- URLs. -->

[My Applications]: https://go.microsoft.com/fwlink/p/?LinkId=262039
[Портал Azure]: https://portal.azure.com/
