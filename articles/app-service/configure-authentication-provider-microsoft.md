---
title: Настройка проверки подлинности Майкрософт
description: Узнайте, как настроить проверку подлинности учетной записи Майкрософт в качестве поставщика удостоверений для приложения службы приложений.
ms.assetid: ffbc6064-edf6-474d-971c-695598fd08bf
ms.topic: article
ms.date: 08/08/2019
ms.custom: seodec18
ms.openlocfilehash: 95c603d4a10eb0e4d0817e20755c0f9b36baa96f
ms.sourcegitcommit: 5d6ce6dceaf883dbafeb44517ff3df5cd153f929
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/29/2020
ms.locfileid: "76842339"
---
# <a name="configure-your-app-service-app-to-use-microsoft-account-login"></a>Настройка приложения службы приложений для использования входа в учетную запись Майкрософт

[!INCLUDE [app-service-mobile-selector-authentication](../../includes/app-service-mobile-selector-authentication.md)]

В этом разделе показано, как настроить службу приложений Azure для использования AAD для поддержки имен входа в личную учетная запись Майкрософт.

> [!NOTE]
> И личные учетные записи Майкрософт, и учетные записи организации используют поставщик удостоверений AAD. В настоящее время невозможно настроить этот поставщик удостоверений для поддержки обоих типов входа.

## <a name="register-microsoft-account"> </a>Регистрация приложения с помощью учетной записи Майкрософт

1. Перейдите к [**Регистрация приложений**](https://portal.azure.com/#blade/Microsoft_AAD_RegisteredApps/ApplicationsListBlade) в портал Azure. При необходимости выполните вход с помощью учетная запись Майкрософт.
1. Выберите **Новая регистрация**, а затем введите имя приложения.
1. В разделе **Поддерживаемые типы учетных записей**выберите **учетные записи в любом каталоге организации (любой каталог Azure AD — клиент) и личные учетные записи Майкрософт (например, Skype, Xbox)** .
1. В списке **URI перенаправления**выберите **веб**и введите `https://<app-domain-name>/.auth/login/aad/callback`. Замените *\<app-domain-name >* именем домена приложения.  Например, `https://contoso.azurewebsites.net/.auth/login/aad/callback`. Не забудьте использовать схему HTTPS в URL-адресе.

1. Выберите **Зарегистрировать**.
1. Скопируйте **идентификатор приложения (клиента)** . Он понадобится вам позднее.
1. На левой панели выберите **сертификаты & секреты** > **новый секрет клиента**. Введите описание, выберите длительность действия и нажмите кнопку **Добавить**.
1. Скопируйте значение, которое отображается на странице **сертификаты & секреты** . После выхода из этой страницы она не будет отображаться снова.

    > [!IMPORTANT]
    > Значение секрета клиента (пароль) — это важные учетные данные безопасности. Не сообщайте пароль никому и не раскрывайте его в клиентском приложении.

## <a name="secrets"> </a>Добавление сведений об учетной записи Майкрософт в приложение службы приложений

1. Перейдите к приложению в [портал Azure].
1. Выберите **параметры** > **Проверка подлинности и авторизация**и убедитесь, что **Проверка подлинности службы приложений** **включена.**
1. В разделе **Поставщики проверки подлинности** выберите **Azure Active Directory**. Выберите пункт **Дополнительно** в **режиме управления**. Вставьте идентификатор приложения (клиента) и секрет клиента, полученные ранее. Используйте **https://login.microsoftonline.com/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0** в поле **URL-адрес издателя** .
1. Щелкните **ОК**.

   Служба приложений обеспечивает проверку подлинности, но не ограничивает разрешенный доступ к содержимому и API-интерфейсам сайта. Авторизация пользователей должна быть включена в код приложения.

1. Используемых Чтобы ограничить доступ к учетная запись Майкрософт пользователям, задайте **действие, которое будет выполняться, если запрос не прошел проверку подлинности** для **входа с помощью Azure Active Directory**. При установке этой функции приложению требуется проверка подлинности всех запросов. Он также перенаправляет все запросы, не прошедшие проверку подлинности, на использование AAD для проверки подлинности. Обратите внимание, что, так как вы настроили **URL-адрес издателя** для использования клиента учетной записи Майкрософт, проверка подлинности будет успешной только для персональных записей.

   > [!CAUTION]
   > Таким образом, ограниченный доступ применяется ко всем вызовам приложения, что может быть нежелательно для приложений, имеющих общедоступную домашнюю страницу, как во многих одностраничных приложениях. Для таких приложений рекомендуется **Разрешить анонимные запросы (без действий)** , чтобы приложение вручную начинало проверку подлинности. Дополнительные сведения см. в разделе [поток проверки подлинности](overview-authentication-authorization.md#authentication-flow).

1. Щелкните **Сохранить**.

Теперь вы можете использовать учетную запись Майкрософт для проверки подлинности в приложении.

## <a name="related-content"> </a>Дальнейшие действия

[!INCLUDE [app-service-mobile-related-content-get-started-users](../../includes/app-service-mobile-related-content-get-started-users.md)]

<!-- URLs. -->

[My Applications]: https://go.microsoft.com/fwlink/p/?LinkId=262039
[Портал Azure]: https://portal.azure.com/
