---
title: Настройка приложения службы приложений для использования входа по учетной записи Майкрософт
description: Узнайте, как настроить проверку подлинности учетной записи Майкрософт в качестве поставщика удостоверений для службы приложений или приложения функций Azure.
ms.assetid: ffbc6064-edf6-474d-971c-695598fd08bf
ms.topic: article
ms.date: 08/08/2019
ms.custom:
- seodec18
- fasttrack-edit
ms.openlocfilehash: 6fe0e39584cbaa001e11f712bb2f60b45dba6914
ms.sourcegitcommit: 67bddb15f90fb7e845ca739d16ad568cbc368c06
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2020
ms.locfileid: "82203494"
---
# <a name="configure-your-app-service-or-azure-functions-app-to-use-microsoft-account-login"></a>Настройка службы приложений или приложения функций Azure для использования входа в учетную запись Майкрософт

[!INCLUDE [app-service-mobile-selector-authentication](../../includes/app-service-mobile-selector-authentication.md)]

В этом разделе показано, как настроить службу приложений Azure или функцию Azure для использования AAD для поддержки имен входа в личную учетная запись Майкрософт.

> [!NOTE]
> И личные учетные записи Майкрософт, и учетные записи организации используют поставщик удостоверений AAD. В настоящее время невозможно настроить этот поставщик удостоверений для поддержки обоих типов входа.

## <a name="register-your-app-with-microsoft-account"></a><a name="register-microsoft-account"> </a>Регистрация приложения с использованием учетной записи Майкрософт

1. Перейдите к [**Регистрация приложений**](https://portal.azure.com/#blade/Microsoft_AAD_RegisteredApps/ApplicationsListBlade) в портал Azure. При необходимости выполните вход с помощью учетная запись Майкрософт.
1. Выберите **Новая регистрация**, а затем введите имя приложения.
1. В разделе **Поддерживаемые типы учетных записей**выберите **учетные записи в любом каталоге организации (любой каталог Azure AD — клиент) и личные учетные записи Майкрософт (например, Skype, Xbox)** .
1. В списке **URI перенаправления**выберите **веб**, а затем `https://<app-domain-name>/.auth/login/aad/callback`введите. Замените * \<App-Domain-Name>* именем домена приложения.  Например, `https://contoso.azurewebsites.net/.auth/login/aad/callback`. Не забудьте использовать схему HTTPS в URL-адресе.

1. Выберите **Зарегистрировать**.
1. Скопируйте **идентификатор приложения (клиента)**. Он понадобится вам позднее.
1. На левой панели выберите **Сертификаты & секреты** > **новый секрет клиента**. Введите описание, выберите длительность действия и нажмите кнопку **Добавить**.
1. Скопируйте значение, которое отображается на странице **сертификаты & секреты** . После выхода из этой страницы она не будет отображаться снова.

    > [!IMPORTANT]
    > Значение секрета клиента (пароль) — это важные учетные данные безопасности. Не сообщайте пароль никому и не раскрывайте его в клиентском приложении.

## <a name="add-microsoft-account-information-to-your-app-service-application"></a><a name="secrets"> </a>Добавление данных учетной записи Майкрософт в приложение службы приложений

1. Перейдите к приложению в [портал Azure].
1. Выберите **Параметры** > **Проверка подлинности и авторизация**и убедитесь, что **Проверка подлинности службы приложений** **включена.**
1. В разделе **Поставщики проверки подлинности** выберите **Azure Active Directory**. Выберите пункт **Дополнительно** в **режиме управления**. Вставьте идентификатор приложения (клиента) и секрет клиента, полученные ранее. Используется **`https://login.microsoftonline.com/9188040d-6c67-4c5b-b112-36a304b66dad/v2.0`** для поля **URL-адрес издателя** .
1. Нажмите кнопку **OK**.

   Служба приложений обеспечивает проверку подлинности, но не ограничивает разрешенный доступ к содержимому и API-интерфейсам сайта. Авторизация пользователей должна быть включена в код приложения.

1. Используемых Чтобы ограничить доступ к учетная запись Майкрософт пользователям, задайте **действие, которое будет выполняться, если запрос не прошел проверку подлинности** для **входа с помощью Azure Active Directory**. При установке этой функции приложению требуется проверка подлинности всех запросов. Он также перенаправляет все запросы, не прошедшие проверку подлинности, на использование AAD для проверки подлинности. Обратите внимание, что, так как вы настроили **URL-адрес издателя** для использования клиента учетной записи Майкрософт, проверка подлинности будет успешной только для персональных записей.

   > [!CAUTION]
   > Таким образом, ограниченный доступ применяется ко всем вызовам приложения, что может быть нежелательно для приложений, имеющих общедоступную домашнюю страницу, как во многих одностраничных приложениях. Для таких приложений рекомендуется **Разрешить анонимные запросы (без действий)** , чтобы приложение вручную начинало проверку подлинности. Дополнительные сведения см. в разделе [поток проверки подлинности](overview-authentication-authorization.md#authentication-flow).

1. Нажмите кнопку **Сохранить**.

Теперь вы можете использовать учетную запись Майкрософт для проверки подлинности в приложении.

## <a name="next-steps"></a><a name="related-content"> </a>Дальнейшие шаги

[!INCLUDE [app-service-mobile-related-content-get-started-users](../../includes/app-service-mobile-related-content-get-started-users.md)]

<!-- URLs. -->

[My Applications]: https://go.microsoft.com/fwlink/p/?LinkId=262039
[Портал Azure]: https://portal.azure.com/
