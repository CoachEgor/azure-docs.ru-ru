---
title: Рекомендации по развертыванию
description: Узнайте о ключевых механизмах развертывания в службе приложений Azure. Найдите рекомендации по языку и другие предостережения.
keywords: лазурный сервис приложений, веб-приложение, развертывание, развертывание, конвейеры, сборка
author: jasonfreeberg
ms.assetid: bb51e565-e462-4c60-929a-2ff90121f41d
ms.topic: article
ms.date: 07/31/2019
ms.author: jafreebe
ms.openlocfilehash: 14946a05f021a9b155fd9a9621f73bde980970fa
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/27/2020
ms.locfileid: "75750467"
---
# <a name="deployment-best-practices"></a>Рекомендации по развертыванию

Каждая команда разработчиков имеет уникальные требования, которые могут затруднить реализацию эффективного конвейера развертывания на любом облачном сервисе. В этой статье представлены три основных компонента развертывания в службе приложений: источники развертывания, сборка конвейеров и механизмы развертывания. В этой статье также рассматриваются некоторые рекомендации и советы по конкретным языковым стеки.

## <a name="deployment-components"></a>Компоненты развертывания

### <a name="deployment-source"></a>Источник развертывания

Источник развертывания — это расположение кода приложения. Для производственных приложений источник развертывания обычно является репозиторием, размещенным программным обеспечением управления версиями, таким как [GitHub, BitBucket или Azure Repos.](deploy-continuous-deployment.md) Для сценариев разработки и тестирования источником развертывания может быть [проект локальной машины.](deploy-local-git.md) Служба поддержки приложений также поддерживает [папки OneDrive и Dropbox](deploy-content-sync.md) в качестве источников развертывания. В то время как облачные папки могут легко начать работу с App Service, обычно не рекомендуется использовать этот источник для производственных приложений корпоративного уровня. 

### <a name="build-pipeline"></a>Конвейер сборки

После того, как вы решите источник развертывания, следующим шагом будет выбор конвейера сборки. Конвейер сборки считывает исходный код из источника развертывания и выполняет ряд шагов (таких как компиляция кода, минимация HTML и JavaScript, запущенные тесты и компоненты упаковки), чтобы получить приложение в исполнимом состоянии. Конкретные команды, выполняемые конвейером сборки, зависят от стека языка. Эти операции могут выполняться на сервере сборки, например Azure Pipelines, или выполняться локально.

### <a name="deployment-mechanism"></a>Механизм развертывания

Механизм развертывания — это действие, используемое для размещения встроенного приложения в *каталог /home/site/wwwroot* вашего веб-приложения. *Каталог /wwwroot* — это смонтированное место хранения, совместно ехатое всеми экземплярами вашего веб-приложения. Когда механизм развертывания помещает приложение в этот каталог, экземпляры получают уведомление для синхронизации новых файлов. Служба приложений поддерживает следующие механизмы развертывания:

- Конечные точки Kudu: [Kudu](https://github.com/projectkudu/kudu/wiki) — это инструмент производительности разработчиков с открытым исходным кодом, который работает как отдельный процесс в службе Windows App Service и как второй контейнер в Linux App Service. Kudu обрабатывает непрерывные развертывания и предоставляет конечные точки HTTP для развертывания, такие как zipdeploy.
- FTP и WebDeploy: Используя свой [сайт или учетные данные пользователей,](deploy-configure-credentials.md)вы можете загружать файлы [через FTP](deploy-ftp.md) или WebDeploy. Эти механизмы не проходят через Куду.  

Инструменты развертывания, такие как Azure Pipelines, Jenkins и плагины редактора, используют один из этих механизмов развертывания.

## <a name="language-specific-considerations"></a>Языковые соображения

### <a name="java"></a>Java

Используйте Kudu [zipdeploy/](deploy-zip.md) API для развертывания приложений JAR и [wardeploy/для](deploy-zip.md#deploy-war-file) приложений WAR. Если вы используете Jenkins, вы можете использовать эти AA непосредственно на этапе развертывания. Дополнительные сведения см. в [этой статье](../jenkins/execute-cli-jenkins-pipeline.md).

### <a name="node"></a>Узел

По умолчанию Kudu выполняет шаги сборки для`npm install`вашего приложения Узла (). Если вы используете службу сборки, такую как Azure DevOps, то сборка Kudu не нужна. Чтобы отключить сборку Kudu, создайте `SCM_DO_BUILD_DURING_DEPLOYMENT`настройку приложения, `false`со значением.

### <a name="net"></a>.NET 

По умолчанию Kudu выполняет шаги сборки для`dotnet build`вашего приложения .Net (). Если вы используете службу сборки, такую как Azure DevOps, то сборка Kudu не нужна. Чтобы отключить сборку Kudu, создайте `SCM_DO_BUILD_DURING_DEPLOYMENT`настройку приложения, `false`со значением.

## <a name="other-deployment-considerations"></a>Другие соображения о развертывании

### <a name="use-deployment-slots"></a>Используйте слоты развертывания

По возможности используйте [слоты развертывания](deploy-staging-slots.md) при развертывании новой сборки. При использовании уровня Standard App Service Plan или лучше можно развернуть приложение в среде постановки, проверить изменения и сделать тесты на курение. Когда вы будете готовы, вы можете поменять свои постановочные и производственные слоты. Операция свопа разогревает необходимые экземпляры работника, чтобы соответствовать вашей производственной шкале, тем самым устраняя время простоя. 

### <a name="local-cache"></a>локальный кэш

Содержимое Службы приложений Azure хранится в Службе хранилища Azure; оно доступно в долгосрочном режиме в общей папке содержимого. Тем не менее, некоторые приложения просто нуждаются в высокопроизводительном магазине контента только для чтения, который они могут работать с высокой доступностью. Эти приложения могут извлечь выгоду из использования [локального кэша.](overview-local-cache.md) Местный кэш не рекомендуется для сайтов управления контентом, таких как WordPress.

Всегда используйте локальный кэш в сочетании с [слотами развертывания,](deploy-staging-slots.md) чтобы предотвратить простои. Смотрите [этот раздел](overview-local-cache.md#best-practices-for-using-app-service-local-cache) для получения информации об использовании этих функций вместе.

### <a name="high-cpu-or-memory"></a>Высокий процессор или память

Если ваш план службы приложений использует более 90% доступного процессора или памяти, базовая виртуальная машина может столкнуться с проблемами с обработкой развертывания. Когда это происходит, временно масштабируйте количество экземпляров для выполнения развертывания. После завершения развертывания можно вернуть количество экземпляров в прежнее значение.

Для получения дополнительной информации о наилучшей практике посетите [службу диагностики приложений,](https://docs.microsoft.com/azure/app-service/overview-diagnostics) чтобы узнать, что наилучшие практики, характерные для вашего ресурса.

- Перейдите к веб-приложению на [портале Azure.](https://portal.azure.com)
- Нажмите на **Диагностика и решить проблемы** в левой навигации, которая открывает App Service Diagnostics.
- Выберите плитку на главной странице **«Лучшие практики».**
- Нажмите на **рекомендации по доступности & производительности** или **рекомендации для оптимальной конфигурации,** чтобы просмотреть текущее состояние вашего приложения в отношении этих рекомендаций.

Вы также можете использовать эту ссылку, чтобы непосредственно `https://ms.portal.azure.com/?websitesextension_ext=asd.featurePath%3Ddetectors%2FParentAvailabilityAndPerformance#@microsoft.onmicrosoft.com/resource/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Web/sites/{siteName}/troubleshoot`открыть службу app Diagnostics для вашего ресурса: .
