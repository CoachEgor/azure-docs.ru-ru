---
title: Списки исключений брандмауэра веб-приложения в передней дверце Azure — портал Azure
description: В этой статье содержатся сведения о конфигурации списков исключений в Azure спереди с портал Azure.
services: web-application-firewall
author: vhorne
ms.service: web-application-firewall
ms.date: 02/25/2020
ms.author: victorh
ms.topic: conceptual
ms.openlocfilehash: 43565e812abcf0b7dbb992ac4d25a62a4d08df2b
ms.sourcegitcommit: 2c586a0fbec6968205f3dc2af20e89e01f1b74b5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/14/2020
ms.locfileid: "92018650"
---
# <a name="web-application-firewall-waf-with-front-door-service-exclusion-lists"></a>Брандмауэр веб-приложения (WAF) с списками исключений службы Front дверь 

Иногда брандмауэр веб-приложения (WAF) может блокировать запрос, который требуется разрешить приложению. Например, Active Directory вставляет маркеры, используемые для проверки подлинности. Эти токены могут содержать специальные символы, которые могут вызывать ложное срабатывание из правил WAF. Списки исключений WAF позволяют пропустить некоторые атрибуты запроса при проверке WAF.  Список исключений можно настроить с помощью  [повсершелл](https://docs.microsoft.com/powershell/module/az.frontdoor/New-AzFrontDoorWafManagedRuleExclusionObject?view=azps-3.5.0), [Azure CLI](https://docs.microsoft.com/cli/azure/ext/front-door/network/front-door/waf-policy/managed-rules/exclusion?view=azure-cli-latest#ext-front-door-az-network-front-door-waf-policy-managed-rules-exclusion-add), [интерфейса API](https://docs.microsoft.com/rest/api/frontdoorservice/webapplicationfirewall/policies/createorupdate)или портал Azure. В следующем примере показана конфигурация портал Azure. 
## <a name="configure-exclusion-lists-using-the-azure-portal"></a>Настройка списков исключений с помощью портал Azure
**Управление исключениями** доступно на портале WAF в разделе **управляемые правила** .

![Управление исключениями ](../media/waf-front-door-exclusion/exclusion1.png)
 ![ Управление exclusion_add](../media/waf-front-door-exclusion/exclusion2.png)

 Пример списка исключений: ![ управление exclusion_define](../media/waf-front-door-exclusion/exclusion3.png)

Этот пример исключает значение в поле заголовка *пользователя* . Допустимый запрос может включать в себя поле *пользователя* , содержащее строку, которая активирует правило внедрения кода SQL. Вы можете исключить параметр *пользователя* в этом случае, чтобы правило WAF не вычислит что-либо в поле.

Следующие атрибуты могут быть добавлены к спискам исключений по имени. Значения используемых полей не оцениваются по правилам WAF, но их имена оцениваются. Список исключений удаляет проверку значения поля.

* Имя заголовка запроса
* Имя файла Cookie запроса
* Имя аргументов строки запроса
* Имя запроса текст записи аргументов

Вы можете указать точное соответствие заголовка запроса, текста, файла cookie или атрибута строки запроса.  Либо при необходимости вы можете задать частичное соответствие. Поддерживаются следующие операторы соответствия:

- **Equals**: этот оператор используется для точного совпадения. Например, чтобы выбрать заголовок с именем **беарертокен**, используйте оператор Equals с селектором, установленным как **беарертокен**.
- **Starts with**: этот оператор находит все поля, которые начинаются с указанного значения селектора.
- **Ends with**: этот оператор находит все поля запроса, заканчивающиеся на указанное значение селектора.
- **Contains**: этот оператор находит все поля запроса, которые содержат указанное значение селектора.
- **Равно Any**: Этот оператор соответствует всем полям запроса. * — значение селектора.

Имена заголовков и файлов cookie не чувствительны к регистру.

Список исключений можно применить ко всем правилам в наборе управляемых правил, к правилам для конкретной группы правил или к одному правилу, как показано в предыдущем примере. 

## <a name="define-exclusion-based-on-web-application-firewall-logs"></a>Определение исключения на основе журналов брандмауэра веб-приложения
 [Мониторинг и ведение журнала брандмауэра веб-приложения Azure](waf-front-door-monitor.md) отображает соответствующие сведения о заблокированном запросе. Если значение заголовка, значение cookie, значение аргумента POST или значение аргумента запроса выдают ложные срабатывания для некоторых правил, то эту часть запроса можно исключить из рассмотрения правилом. В следующей таблице показаны примеры значений из журналов WAF и соответствующие условия исключения.

|Матчвариабленаме из журналов WAF    |Исключение правила на портале|
|--------|------|
|Кукиевалуе: SOME_NAME  |Имя файла Cookie запроса равно SOME_NAME|
|HeaderValue: SOME_NAME  |Имя заголовка запроса равно SOME_NAME|
|Постпарамвалуе: SOME_NAME|  Текст запроса POST args name равно SOME_NAME|
|Куерипарамвалуе: SOME_NAME| Имя аргументов строки запроса равно SOME_NAME|


## <a name="next-steps"></a>Дальнейшие действия

После настройки параметров WAF Узнайте, как просматривать журналы WAF. Дополнительные сведения см. в статье [Диагностика передней дверцы](../afds/waf-front-door-monitor.md).
