---
title: Обзор политики Azure Web Application Firewall (WAF)
description: Эта статья представляет собой обзор глобальной политики Web Application Firewall (WAF), на сайте и в рамках URI.
services: web-application-firewall
ms.topic: article
author: winthrop28
ms.service: web-application-firewall
ms.date: 02/01/2020
ms.author: victorh
ms.openlocfilehash: fff4fb5707c07098fd7fac261a36909224365cdf
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "80060271"
---
# <a name="azure-web-application-firewall-waf-policy-overview"></a>Обзор политики Azure Web Application Firewall (WAF)

Политики веб-приложений firewall содержат все настройки и конфигурации WAF. Это включает исключения, пользовательские правила, управляемые правила и так далее. Эти политики затем связаны с шлюзом приложения (глобальный), слушателем (на сайте) или правилом, основанным на пути (per-URI), чтобы они вступили в силу.

> [!NOTE]
> Azure Web Application Firewall (WAF) на сайте и в отношении политик и политик и средств для uri находятся в публичном предварительном просмотре.
> 
> Эта общедоступная предварительная версия предоставляется без соглашения об уровне обслуживания и не должна использоваться в рабочей среде. Некоторые функции могут не поддерживаться, иметь ограничения и быть доступными не во всех расположениях Azure. Дополнительные сведения см. в статье [Дополнительные условия использования предварительных выпусков Microsoft Azure](https://azure.microsoft.com/support/legal/preview-supplemental-terms/).

Количество политик, которые можно создать, не ограничено. При создании политики она должна быть связана с шлюзом приложения, чтобы ввести в действие. Это может быть связано с любой комбинацией шлюзов приложений, слушателей и правил, основанных на пути.

## <a name="global-waf-policy"></a>Глобальная политика WAF

При общении политики WAF каждый сайт, стоящий за WAF приложения, защищен теми же управляемыми правилами, пользовательскими правилами, исключениями и любыми другими настроенными настройками.

Если вы хотите, чтобы единая политика применялась ко всем сайтам, вы можете связать политику с шлюзом приложения. Для получения дополнительной информации [см. Создать политики веб-приложений Firewall для портала приложений](create-waf-policy-ag.md) для создания и применения политики WAF с помощью портала Azure. 

## <a name="per-site-waf-policy"></a>Политика WAF на сайте

С помощью полисов WAF на каждом участке вы можете защитить несколько сайтов с различными потребностями безопасности за одним WAF, используя политики на каждом сайте. Например, если за WAF стоит пять сайтов, вы можете иметь пять отдельных политик WAF (по одному для каждого слушателя) для настройки исключений, пользовательских правил, управляемых наборов правил и всех других настроек WAF для каждого сайта.

Скажем, ваш шлюз приложения имеет глобальную политику, применяемую к нему. Затем вы применяете другую политику к слушателю на этом шлюзе приложения. Политика слушателя теперь вступает в силу только для этого слушателя. Глобальная политика шлюза приложения по-прежнему применяется ко всем другим слушателям и правилам, основанным на путях, которые не имеют конкретной политики, возложенной на них.

## <a name="per-uri-policy"></a>Политика per-URI

Для еще большей настройки до уровня URI можно связать политику WAF с правилом, основанным на пути. Если на одном сайте есть определенные страницы, требующие различных политик, можно внести изменения в политику WAF, которые влияют только на данный URI. Это может относиться к странице оплаты или ввоза, или любой другой URIs, которые нуждаются в еще более конкретной политике WAF, чем другие сайты за WAF.

Как и в отношении политик WAF на сайте, более конкретные политики перекрывает менее конкретные политики. Это означает, что политика для URL-uri на карте траектории URL перекрывает любую политику в зависимости от сайта или глобальную политику WAF над ней.

## <a name="example"></a>Пример

Скажем, у вас есть три сайта: contoso.com, fabrikam.com, и adatum.com все за тем же шлюзом приложения. Вы хотите, чтобы WAF применялся ко всем трем сайтам, но вам нужна дополнительная безопасность с adatum.com, потому что именно здесь клиенты посещают, просматривают и покупают продукты.

Вы можете применить глобальную политику к WAF, с некоторыми основными настройками, исключениями или пользовательскими правилами, если это необходимо, чтобы остановить некоторые ложные срабатывания от блокирования трафика. В этом случае нет необходимости в том, чтобы глобальные правила впрыска S'L запускались, потому что fabrikam.com и contoso.com являются статическими страницами без бэкэнда. Таким образом, вы можете отключить эти правила в глобальной политике.

Эта глобальная политика подходит для contoso.com и fabrikam.com, но вы должны быть более осторожны с adatum.com, где войти в информацию и платежи обрабатываются. Вы можете применить политику на сайте к слушателю adatum и оставить правила S'L в рабочем состоянии. Также предположим, что есть файл cookie, блокирующий трафик, так что вы можете создать исключение для этого файла cookie, чтобы остановить ложное срабатывание. 

В adatum.com/payments URI, где вы должны быть осторожны. Так применить другую политику на том, что URI и оставить все правила включены, а также удалить все исключения.

В этом примере у вас есть глобальная политика, которая применяется к двум сайтам. У вас есть политика для сайта, которая применяется к одному сайту, а затем к политике для uri, которая применяется к одному конкретному правилу, основанному на пути. Смотрите (вставьте ссылку здесь, когда она существует) как создать для сайта и для соответствующих политик PowerShell для этого примера.

## <a name="existing-waf-configurations"></a>Существующие конфигурации WAF

Все новые параметры WAF-режима web-application Firewall (таможенные правила, управляемые конфигурации наборов правил, исключения и т.д.) существуют в политике WAF. Если у вас есть существующий WAF, эти параметры могут по-прежнему существовать в вашей конфигурации WAF. Для получения дополнительной информации о переходе на новую политику WAF, [Мимид WAF Config к политике WAF](https://docs.microsoft.com/azure/web-application-firewall/ag/migrate-policy). 


## <a name="next-steps"></a>Дальнейшие действия

Создавайте политики для сайтов и для URI с помощью Azure PowerShell.
