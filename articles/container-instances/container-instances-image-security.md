---
title: Рекомендации по безопасности экземпляры контейнеров Azure
description: Рекомендации для обеспечения безопасности образов и секреты для экземпляров контейнеров Azure, а также Общие соображения безопасности для любой платформы контейнера
services: container-instances
author: dlepow
manager: jeconnoc
ms.service: container-instances
ms.topic: article
ms.date: 04/29/2019
ms.author: danlep
ms.custom: ''
ms.openlocfilehash: dc516277d79e37500e73e1aee6b88c908acb9b1c
ms.sourcegitcommit: c53a800d6c2e5baad800c1247dce94bdbf2ad324
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/30/2019
ms.locfileid: "64944001"
---
# <a name="security-considerations-for-azure-container-instances"></a>Вопросы безопасности для экземпляров контейнеров Azure

В этой статье рассматриваются вопросы безопасности для запуска приложения-контейнеры с помощью экземпляров контейнеров Azure. Будут рассмотрены следующие задачи:

> [!div class="checklist"]
> * **Рекомендации по обеспечению безопасности** для управления образами и секреты для экземпляров контейнеров Azure
> * **Рекомендации по экосистема контейнеров** на протяжении жизненного цикла контейнеров, для любой платформы контейнера

## <a name="security-recommendations-for-azure-container-instances"></a>Рекомендации по безопасности для экземпляров контейнеров Azure

### <a name="use-a-private-registry"></a>Использование частного реестра

Контейнеры состоят из образов, которые хранятся в одном или нескольких репозиториях. Эти репозитории могут принадлежать общедоступного реестра, например [Docker Hub](https://hub.docker.com), или в частный реестр. Примером частного реестра является [Docker Trusted Registry](https://docs.docker.com/datacenter/dtr/2.0/), который можно установить локально или в виртуальном частном облаке. Можно также использовать облачные частные службы реестров контейнеров, включая [реестр контейнеров Azure](../container-registry/container-registry-intro.md). 

Общедоступный образ контейнера не может гарантировать безопасность. Образы контейнеров состоят из нескольких программных слоев, и каждый программный слой может содержать уязвимости. Уменьшить угрозу атак, следует хранить и получать изображения из частного реестра, такие как реестр контейнеров Azure или доверенный реестр Docker. Кроме предоставления управляемого частного реестра, реестр контейнеров Azure поддерживает [проверки подлинности на основе субъекта-службы](../container-registry/container-registry-authentication.md) через Azure Active Directory для базовых потоков аутентификации. Эта проверка подлинности включает доступ на основе ролей для только для чтения (по запросу), запись (отправка) и разрешения владельца.

### <a name="monitor-and-scan-container-images"></a>Мониторинг и сканирования образов контейнера

Мониторинг безопасности и сканирования решений, таких как [Twistlock](https://azuremarketplace.microsoft.com/marketplace/apps/twistlock.twistlock?tab=Overview) и [Aqua Security](https://azuremarketplace.microsoft.com/marketplace/apps/aqua-security.aqua-security?tab=Overview) доступны в Azure Marketplace. Их можно использовать для сканирования образов контейнера в частном реестре и определения потенциальных уязвимостей. Важно понимать уровень сканирования, что обеспечивают различные решения. 

### <a name="protect-credentials"></a>Защита учетных данных

Контейнеры можно распределить на несколько кластеров и регионов Azure. Таким образом необходимо защитить учетные данные, необходимые для входа или доступ через API, такие как пароли или маркеры. Убедитесь, что только привилегированным пользователям доступ к этих контейнеров, при передаче и хранении. Все секреты учетных данных инвентаризации и затем требовать от разработчиков с помощью новых средств Управление секретами, предназначенные для контейнерных платформ.  Убедитесь, что решение содержит зашифрованные базы данных, шифрование TLS для данных секреты в транспорте и минимальными [управление доступом на основе ролей](../role-based-access-control/overview.md). [Azure Key Vault](../key-vault/key-vault-secure-your-key-vault.md) — это облачная служба, который защищает ключи шифрования и секреты (например, сертификаты, строки соединения и пароли) для контейнерных приложений. Так как эти данные конфиденциальный "и" критически важный для бизнеса, безопасный доступ к ключу хранилища таким образом, чтобы только авторизованным приложениям и пользователям доступа к ним.

## <a name="considerations-for-the-container-ecosystem"></a>Рекомендации по экосистема контейнеров

Следующие меры безопасности, также реализует и контролирует эффективно, может помочь в обеспечении безопасности и защиты вашей экосистемы контейнеров. Эти меры действовать в течение всего жизненного цикла контейнеров — от разработки до развертывания в рабочей среде и широкий спектр платформ, оркестраторов контейнеров и узлов. 

### <a name="use-vulnerability-management-as-part-of-your-container-development-lifecycle"></a>Используйте Управление уязвимостями как часть жизненного цикла разработки контейнеров 

С помощью управления уязвимостями действующих на протяжении жизненного цикла разработки контейнеров, повысить вероятность, что обнаруживать и устранять проблемы безопасности, прежде чем они станут более серьезную проблему. 

### <a name="scan-for-vulnerabilities"></a>Проверять наличие уязвимостей 

Новые уязвимости обнаруживаются постоянно, поэтому проверку и выявления уязвимостей — это непрерывный процесс. Включить сканирование на протяжении всего жизненного цикла контейнеров уязвимостей:

* В качестве последней проверки разработки прежде чем отправлять изображения в открытом или закрытом реестре следует выполнять сканирование уязвимостей в контейнерах. 
* По-прежнему сканирования образов контейнера в реестре и чтобы обнаружить дефекты, каким-либо образом не пропущены во время разработки и устранить любые недавно обнаруженные уязвимости, которые могут существовать в коде, используемом в образах контейнеров.  

### <a name="map-image-vulnerabilities-to-running-containers"></a>Сопоставить уязвимостей образ для запуска контейнеров 

Необходимо иметь средства сопоставления уязвимостей, определенных в образах контейнеров для контейнерами, поэтому проблем безопасности можно устранить или устранены.  

### <a name="ensure-that-only-approved-images-are-used-in-your-environment"></a>Убедитесь, что только утвержденные образы используются в вашей среде 

Имеется достаточное количество изменений и изменчивости в экосистеме контейнеров не позволяя Неизвестный с контейнерами. Разрешить только утвержденные контейнера изображения. Предусмотреть средства и процессы для мониторинга и предотвращения использования образов контейнеров «не утверждено». 

Для управления потоком образов контейнеров в среде разработки является эффективным способом снизить риск атак и предотвращения разработчикам ошибок с точки зрения безопасности. Например, может одобрить единый дистрибутив Linux с базовым образом, рекомендуется экономичные (Alpine или CoreOS, а не Ubuntu), чтобы свести к минимуму поверхность потенциальных атак. 

Изображения подписи или использования отпечатка можно предоставить цепочки обеспечения сохранности, дающий возможность проверки целостности контейнеров. Например, реестр контейнеров Azure поддерживает Docker [содержимого доверия](https://docs.docker.com/engine/security/trust/content_trust) модели, что позволяет издателей образов для подписывания образов, которые помещаются в реестр, а потребители изображения для извлечения только подписанных образов.

### <a name="permit-only-approved-registries"></a>Разрешить только утвержденные реестров 

Расширение гарантировать, что в среде используется только утвержденные образы — разрешение только использование реестры контейнеров утвержденных. Необходимости использования реестры контейнеров утвержденных снижает риски риска, блокируя для введения неизвестных уязвимостей или проблем безопасности. 

### <a name="ensure-the-integrity-of-images-throughout-the-lifecycle"></a>Обеспечить целостность образы на протяжении жизненного цикла 

Является частью управления безопасности на протяжении всего жизненного цикла контейнеров для обеспечения целостности образов контейнеров в реестре и как они изменяются и развернуты в рабочей среде. 

* Образы с уязвимостями, даже небольшие, которым запрещено для запуска в рабочей среде. В идеале все образы, развернутые в рабочей среде необходимо сохранить в частном реестре немногим избранным. Уменьшайте убедитесь, что ими можно управлять эффективно число образов в рабочей среде.

* Так как это сложно выявить источник программного обеспечения из общедоступного образа контейнера, создание образов из источника для обеспечения уверенности в источнике слоя. Когда в автоматически созданном образе контейнера появляется уязвимость, клиенты могут достаточно быстро устранить эту проблему. Что касается общедоступного образа пользователям необходимо найти корень образа, чтобы исправить его, или получить другой безопасный образ от издателя. 

* Тщательно сканированный образ, развернутый в рабочей среде не обязательно быть в обновленном состоянии в течение времени существования приложения. Вы можете получить сообщения об уязвимостях системы безопасности для слоев образа, с которыми вы не сталкивались ранее или которые были представлены после развертывания в рабочей среде. 

  Периодически выполняйте аудит образов, развернутых в рабочей среде для идентификации изображения, которые являются устаревшими или не были обновлены в некоторое время. Чтобы обновлять образы контейнеров без простоя можно использовать методы развертывания сине зеленый и последовательное обновление. Вы можете отсканировать образов с помощью средств, описанных в предыдущем разделе. 

* Использование конвейера для непрерывной интеграции (CI) с использованием встроенной безопасности, сканирование для сборки безопасной образов и отправьте их в закрытый реестр. Сканирование уязвимостей, встроенное в решение непрерывной интеграции, обеспечивает отправку прошедших все проверки образов в частный реестр, из которого развертываются производственные рабочие нагрузки. 

  Сбой конвейера CI гарантирует, что уязвимые образы не отправляются в частный реестр, который используется для развертываний производственных рабочих нагрузок. Также запускается автоматическая проверка значительное число образов является их безопасности. Выполнение аудита образов вручную для обнаружения уязвимостей системы безопасности очень долгий процесс, подверженный ошибкам. 

### <a name="enforce-least-privileges-in-runtime"></a>Принудительное применение минимальных прав в среде выполнения 

Принцип наименьших прав доступа рекомендуется безопасности, относящиеся к контейнерам. Если уязвимость, она обычно предоставляет злоумышленнику доступ и права равно те скомпрометированные приложения или процесса. То, что контейнеры работают с самый низкий уровень привилегий и доступа, необходимых для выполнения задачи сокращает подверженность риску. 

### <a name="reduce-the-container-attack-surface-by-removing-unneeded-privileges"></a>Снизить вероятность атак контейнера, удалив ненужные привилегии 

Можно также свести к минимуму потенциальных атак, удалив все неиспользуемые или ненужные процессы или привилегии из среды выполнения контейнера. Привилегированные контейнеры запустить в качестве привилегированного пользователя. Если злонамеренный пользователь или рабочая нагрузка экранирует в привилегированных контейнер, контейнер будет запускаться в качестве привилегированного пользователя в этой системе.

### <a name="whitelist-files-and-executables-that-the-container-is-allowed-to-access-or-run"></a>Список разрешений файлов и исполняемые файлы, которые контейнер может быть доступ к также выполнять 

Уменьшение числа переменных или неизвестных позволяет поддерживать это устойчивая, надежная среда. Ограничение контейнеры, поэтому они могут получить доступ или выполнения, которые были предварительно утверждены только или список разрешений файлов и исполняемых файлов является проверенным способом ограничения предотвращении создания угроз.  

Это гораздо проще управлять список разрешенных, при реализации с самого начала. Список разрешенных представляет меру того, управления и управляемости, как вы узнаете, какие файлы и исполняемые файлы необходимы для правильной работы приложения. 

Список разрешенных не только снижает уязвимость, но можно создать основу для аномалий и предотвратить варианты использования «шумный сосед» и тематических сценариях с контейнерами. 

### <a name="enforce-network-segmentation-on-running-containers"></a>Принудительное применение сегментации сети на работающие контейнеры  

Для защиты контейнеров в одной подсети, от угроз безопасности в другую подсеть, Ведение сегментации сети (или сегментации nano) или разделения между запущенными контейнерами. Обслуживание сегментации сети, также может потребоваться использования контейнеров в отрасли, которые требуются для удовлетворения требований соответствия нормам.  

Например, средство partner [Aqua](https://azuremarketplace.microsoft.com/marketplace/apps/aqua-security.aqua-security?tab=Overview) предоставляет автоматизированный подход для сегментации nano. Aqua отслеживает контейнер сетевых операций в среде выполнения. Он определяет все входящие и исходящие сетевые подключения с другими контейнерами, служб, IP-адресов и общедоступный Интернет. Nano сегментации автоматически создается на основе на отслеживаемом трафике. 

### <a name="monitor-container-activity-and-user-access"></a>Мониторинг действий и пользователей доступ к контейнеру 

Как и в случае с любой ИТ-средой, вы постоянно отслеживать действия и доступа пользователей в свою экосистему контейнеров для быстрого выявления любой подозрительной или вредоносные действия. Azure предоставляет контейнер, включая решения для мониторинга:

* [Azure Monitor для контейнеров](../azure-monitor/insights/container-insights-overview.md) для наблюдения за производительностью рабочих нагрузок, развернутых для сред Kubernetes, размещенных в службе Azure Kubernetes (AKS). С помощью Azure Monitor для контейнеров можно отслеживать производительность, собирая данные метрик памяти и процессора из контроллеров, узлов и контейнеров, доступных в Kubernetes, используя API метрик. 

* [Решение для мониторинга контейнеров Azure](../azure-monitor/insights/containers.md) помогает просматривать и управлять другими Docker и Windows узлов контейнеров в одном месте. Например: 

  * Просмотр подробных сведений аудита, который показывает команды, используемые с контейнерами. 
  * Устранять неполадки контейнеров, просмотра и поиска централизованные журналы без необходимости удаленного просмотра узлов Docker или Windows.  
  * Находить контейнеры, которые могут быть искажены и занимает слишком много ресурсов на узле.
  * Просмотр централизованного ЦП, памяти, хранения и сведения об использовании и производительности сети для контейнеров.  

  Решение поддерживает оркестраторов контейнеров, включая Docker Swarm, DC/OS, неуправляемые Kubernetes, Service Fabric и Red Hat OpenShift. 

### <a name="monitor-container-resource-activity"></a>Действие ресурса контейнера монитора 

Отслеживайте действия ресурсов, такие как файлы, сети и другие ресурсы, которые обращаются к контейнеров. Отслеживание ресурсов действий и использование может быть полезно, из соображений безопасности и для наблюдения за производительностью. 

[Azure Monitor](../azure-monitor/overview.md) обеспечивает базовый мониторинг служб Azure, позволяя собирать метрики, журналы действий и журналы диагностики. Например, журнал действий содержит сведения о создании ресурсов или их изменении. 

Доступны метрики, которые предоставляют статистику производительности разных ресурсов, а также операционной системы в виртуальной машине. Вы можете просмотреть эти данные с помощью нескольких инструментов на портале Azure, а также создать предупреждения на базе этих метрик. Azure Monitor предоставляет метрики быстрый конвейера (5 минут до 1 минуты), поэтому его следует использовать для критичных по времени оповещения и уведомления. 

### <a name="log-all-container-administrative-user-access-for-auditing"></a>Вход пользователя с правами администратора доступ к контейнеру для аудита 

Ведение точные аудита административный доступ к вашей экосистемы контейнеров, реестр контейнеров и образы контейнеров. Эти журналы могут быть необходимы для проведения аудита и будут использоваться считаться вещественными после нарушения системы безопасности. Можно использовать [решение для мониторинга контейнеров Azure](../azure-monitor/insights/containers.md) для достижения этой цели. 

## <a name="next-steps"></a>Дальнейшие действия

* Дополнительные сведения об управлении уязвимостей контейнера с помощью решений для управления [Twistlock](https://www.twistlock.com/solutions/microsoft-azure-container-security/) и [Aqua Security](https://www.aquasec.com/solutions/azure-container-security/).

* Дополнительные сведения о [безопасность контейнера в Azure](https://azure.microsoft.com/resources/container-security-in-microsoft-azure/).