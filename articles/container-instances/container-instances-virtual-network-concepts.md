---
title: Сценарии использования виртуальной сети
description: Сценарии, ресурсы и ограничения для развертывания групп контейнеров в виртуальной сети Azure.
ms.topic: article
ms.date: 08/11/2020
ms.author: danlep
ms.openlocfilehash: 0474a5f85829080a89a74195483484c464de5840
ms.sourcegitcommit: 927dd0e3d44d48b413b446384214f4661f33db04
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/26/2020
ms.locfileid: "88870771"
---
# <a name="virtual-network-scenarios-and-resources"></a>Сценарии и ресурсы виртуальной сети

[Виртуальная сеть Azure](../virtual-network/virtual-networks-overview.md) обеспечивает безопасное и конфиденциальное сетевое подключение для Azure и локальных ресурсов. Развертывание групп контейнеров в виртуальной сети Azure позволяет контейнерам безопасно обмениваться данными с другими ресурсами в виртуальной сети. 

В этой статье содержатся общие сведения о сценариях виртуальной сети, ограничениях и ресурсах. Примеры развертывания с помощью Azure CLI см. в статье [развертывание экземпляров контейнеров в виртуальной сети Azure](container-instances-vnet.md).

## <a name="scenarios"></a>Сценарии

Группы контейнеров, развернутых в виртуальной сети Azure, позволяют реализовать такие сценарии:

* прямой обмен данными между группами контейнеров в одной и той же подсети;
* отправка выходных данных рабочей нагрузки [на основе задач](container-instances-restart-policy.md) из экземпляров контейнеров в базу данных в виртуальной сети;
* получение содержимого для экземпляров контейнеров из [конечной точки службы](../virtual-network/virtual-network-service-endpoints-overview.md) в виртуальной сети;
* Включение взаимодействия контейнеров с локальными ресурсами через [VPN-шлюз](../vpn-gateway/vpn-gateway-about-vpngateways.md) или [ExpressRoute](../expressroute/expressroute-introduction.md)
* Интеграция с [брандмауэром Azure](../firewall/overview.md) для обнаружения исходящего трафика из контейнера 
* Разрешение имен с помощью внутренних Azure DNS для взаимодействия с ресурсами Azure в виртуальной сети, например для виртуальных машин
* Использование правил NSG для управления доступом контейнеров к подсетям или другим сетевым ресурсам

## <a name="unsupported-networking-scenarios"></a>Неподдерживаемые сценарии сети 

* **Azure Load Balancer** -размещение Azure Load Balancer перед экземплярами контейнера в сетевой группе контейнеров не поддерживается
* **Глобальный пиринг между виртуальными сетями** — глобальный пиринг (подключение виртуальных сетей в регионах Azure) не поддерживается.
* **Общедоступные IP-адреса или метки DNS** . группы контейнеров, развернутые в виртуальной сети, сейчас не поддерживают предоставление контейнеров непосредственно в Интернете с общедоступным IP-адресом или полным доменным именем.

## <a name="other-limitations"></a>Другие ограничения

* Сейчас в группе контейнеров, развернутой в виртуальной сети, поддерживаются только контейнеры Linux.
* Чтобы развернуть группы контейнеров в подсети, подсеть не может содержать другие типы ресурсов. Удалите все существующие ресурсы из существующей подсети, прежде чем развернуть в ней группы контейнеров, или создайте новую подсеть.
* [Управляемое удостоверение](container-instances-managed-identity.md) нельзя использовать в группе контейнеров, развернутой в виртуальной сети.
* Вы не можете включить [проверку актуальности](container-instances-liveness-probe.md) или [проверку готовности](container-instances-readiness-probe.md) в группе контейнеров, развернутой в виртуальной сети.
* Из-за дополнительных сетевых ресурсов развертывания в виртуальной сети обычно выполняются медленнее, чем развертывание стандартного экземпляра контейнера.

[!INCLUDE [container-instances-restart-ip](../../includes/container-instances-restart-ip.md)]

## <a name="where-to-deploy"></a>Выберите для себя решение "Многофакторная идентификация Microsoft Azure"

Для развертывания группы контейнеров в виртуальной сети Azure доступны следующие регионы и максимальные ресурсы.

[!INCLUDE [container-instances-vnet-limits](../../includes/container-instances-vnet-limits.md)]

## <a name="required-network-resources"></a>Необходимые сетевые ресурсы

Для развертывания групп контейнеров в виртуальной сети требуется три ресурса виртуальной сети Azure: сама [виртуальная сеть](#virtual-network), [делегированная подсеть](#subnet-delegated) в пределах этой виртуальной сети и [сетевой профиль](#network-profile). 

### <a name="virtual-network"></a>Виртуальная сеть

Виртуальная сеть определяет адресное пространство, в котором можно создать одну или несколько подсетей. Затем следует развернуть ресурсы Azure (например, группы контейнеров) в подсетях виртуальной сети.

### <a name="subnet-delegated"></a>Подсеть (делегированная)

Подсети сегментируют виртуальную сеть на отдельные адресные пространства, которые применяются для размещения ресурсов Azure. В виртуальной сети следует создать одну или несколько подсетей.

Подсеть, используемая для групп контейнеров, может содержать только группы контейнеров. При первом развертывании группы контейнеров в подсети Azure делегирует эту подсеть службе "Экземпляры контейнеров Azure". После делегирования подсеть можно использовать только для групп контейнеров. Если попытаться развернуть в делегированной подсети ресурсы, отличные от групп контейнеров, операция завершится ошибкой.

### <a name="network-profile"></a>сетевой профиль.

Сетевой профиль — это шаблон конфигурации сети для ресурсов Azure. Он задает определенные свойства сети для ресурса, например подсеть, в который его следует развернуть. При первом использовании команды [az container create][az-container-create] для развертывания группы контейнеров в подсеть (и, соответственно, в виртуальную сеть) Azure создаст сетевой профиль. Затем этот сетевой профиль можно использовать для будущих развертываний в подсети. 

Чтобы использовать шаблон Resource Manager, файл YAML или программный метод для развертывания группы контейнеров в подсеть, необходимо указать полный идентификатор ресурса Resource Manager сетевого профиля. Вы можете использовать профиль, созданный ранее с использованием команды [az container create][az-container-create], или создать профиль с помощью шаблона Resource Manager (ознакомьтесь с [примером шаблона](https://github.com/Azure/azure-quickstart-templates/tree/master/101-aci-vnet) и [справочной документацией](/azure/templates/microsoft.network/networkprofiles)). Чтобы получить идентификатор ранее созданного профиля, используйте команду [az network profile list][az-network-profile-list]. 

На следующей схеме несколько групп контейнеров развернуты в подсети, делегированной службе "Экземпляры контейнеров Azure". Развернув одну группу контейнеров в подсети, можно развернуть в ней дополнительные группы контейнеров, указав тот же сетевой профиль.

![Группы контейнеров в виртуальной сети][aci-vnet-01]

## <a name="next-steps"></a>Дальнейшие шаги

* Примеры развертывания с Azure CLI см. в статье [развертывание экземпляров контейнеров в виртуальной сети Azure](container-instances-vnet.md).
* Чтобы развернуть новую виртуальную сеть, подсеть, сетевой профиль и группу контейнеров с помощью шаблона Resource Manager, см. страницу [создания группы контейнеров Azure с виртуальной сетью](https://github.com/Azure/azure-quickstart-templates/tree/master/101-aci-vnet
).
* При использовании [портал Azure](container-instances-quickstart-portal.md) для создания экземпляра контейнера можно также указать параметры для новой или ексстинг виртуальной сети на вкладке " **сеть** ".


<!-- IMAGES -->
[aci-vnet-01]: ./media/container-instances-virtual-network-concepts/aci-vnet-01.png

<!-- LINKS - Internal -->
[az-container-create]: /cli/azure/container#az-container-create
[az-network-profile-list]: /cli/azure/network/profile#az-network-profile-list
