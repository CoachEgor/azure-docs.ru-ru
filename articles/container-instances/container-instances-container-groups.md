---
title: Группы контейнеров в службе "Экземпляры контейнеров Azure"
description: Общие сведения о работе групп с несколькими контейнерами в службе "экземпляры контейнеров Azure"
services: container-instances
author: dlepow
manager: gwallace
ms.service: container-instances
ms.topic: article
ms.date: 03/20/2019
ms.author: danlep
ms.custom: mvc
ms.openlocfilehash: cc9b11ba5fe0cd015d0879f28b9e85fb46b11955
ms.sourcegitcommit: 83df2aed7cafb493b36d93b1699d24f36c1daa45
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/22/2019
ms.locfileid: "71178580"
---
# <a name="container-groups-in-azure-container-instances"></a>Группы контейнеров в службе "Экземпляры контейнеров Azure"

Ресурс верхнего уровня в службе "Экземпляры контейнеров Azure" — это *группа контейнеров*. В этой статье представлены сведения о группах контейнеров и описаны сценарии, которые можно реализовать с их помощью.

## <a name="how-a-container-group-works"></a>Принцип работы группы контейнеров

Группа контейнеров — это набор контейнеров, которые можно планировать на одном хост-компьютере. Контейнеры в группе контейнеров совместно используют жизненный цикл, ресурсы, локальную сеть и тома хранилища. Он похож на понятие для *Pod* в [Kubernetes][kubernetes-pod].

На схеме ниже показан пример группы контейнеров, включающей несколько контейнеров:

![Диаграмма групп контейнеров][container-groups-example]

Группа контейнеров в этом примере:

* Планируется на одном хост-компьютере.
* Принимает назначенную метку DNS-имени.
* Предоставляет один общедоступный IP-адрес с одним предоставленным портом.
* Состоит из двух частей. Один контейнер ожидает передачи данных на порте 80, а другой — на порте 5000.
* Включает два общих файловых ресурса Azure в качестве подключенных томов. При этом к каждому контейнеру локально подключен один из общих ресурсов.

> [!NOTE]
> В настоящее время группы с несколькими контейнерами поддерживают только контейнеры Linux. Для контейнеров Windows служба "экземпляры контейнеров Azure" поддерживает только развертывание одного экземпляра. Пока мы работаем над переносом всех компонентов в контейнеры Windows, в [обзоре](container-instances-overview.md#linux-and-windows-containers) службы можно найти различия в текущих платформах.

## <a name="deployment"></a>Развертывание

Ниже приведены два распространенных способа развертывания группы с несколькими контейнерами. Используйте [шаблон диспетчер ресурсов][resource-manager template] или [YAML-файл][yaml-file]. Шаблон диспетчер ресурсов рекомендуется использовать, если требуется развернуть дополнительные ресурсы службы Azure (например, файловый [ресурс Azure][azure-files]) при развертывании экземпляров контейнера. Из-за более краткой природы формата YAML рекомендуется использовать файл YAML, если развертывание включает только экземпляры контейнеров. Дополнительные сведения о свойствах, которые можно задать, см. в [справочнике по шаблону диспетчер ресурсов](/azure/templates/microsoft.containerinstance/containergroups) или в [справочной](container-instances-reference-yaml.md) документации по YAML.

Чтобы сохранить конфигурацию группы контейнеров, можно экспортировать конфигурацию в файл YAML с помощью команды Azure CLI [AZ Container Export][az-container-export]. Экспорт позволяет хранить конфигурации групп контейнеров в системе управления версиями для "конфигурации как кода". Или вы можете использовать экспортированный файл в качестве отправной точки при разработке новой конфигурации в YAML-файле.



## <a name="resource-allocation"></a>Выделение ресурсов

Служба "экземпляры контейнеров Azure" выделяет ресурсы, такие как ЦП, память и (необязательно) [GPU][gpus] (Предварительная версия), в группу контейнеров, добавляя [запросы ресурсов][resource-requests] к экземплярам в группе. Использование ресурсов ЦП в качестве примера. Если вы создадите группу контейнеров с двумя экземплярами, каждый из которых запрашивает 1 ЦП, то Группа контейнеров выделила 2 процессора.

Максимальное количество ресурсов, доступных для группы контейнеров, зависит от [региона Azure][region-availability] , используемого для развертывания.

### <a name="container-resource-requests-and-limits"></a>Запросы и ограничения ресурсов контейнера

* По умолчанию экземпляры контейнеров в группе совместно используют запрошенные ресурсы группы. В группе с двумя экземплярами, запрашивающими 1 ЦП, группа в целом имеет доступ к двум процессорам. Каждый экземпляр может использовать до 2 ЦП, и экземпляры могут конкурировать за ресурсы ЦП во время их работы.

* Для ограничения использования ресурсов экземпляром в группе, при необходимости, можно задать [ограничение ресурсов][resource-limits] для экземпляра. В группе с двумя экземплярами, запрашивающими 1 ЦП, для работы одного из контейнеров может потребоваться больше процессоров, чем у другого.

  В этом сценарии можно задать ограничение ресурсов ЦП 0,5 для одного экземпляра и ограничение в 2 ЦП для второго. Эта конфигурация ограничивает использование ресурсов первого контейнера до 0,5 ЦП, позволяя второму контейнеру использовать до 2 ЦП, если они доступны.

Дополнительные сведения см. в описании свойства [ресаурцерекуирементс][resource-requirements] в группах контейнеров REST API.

### <a name="minimum-and-maximum-allocation"></a>Минимальное и максимальное выделение

* Выделите не **менее** 1 ЦП и 1 ГБ памяти для группы контейнеров. Отдельные экземпляры контейнера в группе могут быть подготовлены с использованием менее 1 ЦП и 1 ГБ памяти. 

* Сведения о **максимальном объеме** ресурсов в группе контейнеров см. в разделе [доступность ресурсов][region-availability] для экземпляров контейнеров Azure в регионе развертывания.

## <a name="networking"></a>Сети

Группы контейнеров совместно используют IP-адрес и пространство имен порта для этого IP-адреса. Чтобы внешние клиенты могли получить доступ к контейнеру в группе, необходимо предоставить порт по IP-адресу и из контейнера. Поскольку контейнеры в группе совместно используют пространство имен портов, сопоставление портов не поддерживается. Контейнеры внутри группы могут обращаться друг к другу через localhost на предоставляемых им портах, даже если эти порты не предоставляются извне на IP-адрес группы.

При необходимости разверните группы контейнеров в [виртуальной сети Azure][virtual-network] (Предварительная версия), чтобы обеспечить безопасное взаимодействие контейнеров с другими ресурсами в виртуальной сети.

## <a name="storage"></a>Служба хранилища

Вы можете указать внешние тома для подключения в пределах группы контейнеров. Эти тома можно сопоставить с конкретными путями в пределах отдельных контейнеров в группе.

## <a name="common-scenarios"></a>Распространенные сценарии

Многоконтейнерные группы удобны в случаях, когда нужно разделить одну функциональную задачу на небольшое число образов контейнеров. Эти образы затем могут доставляться различными командами сотрудников и иметь отдельные требования к ресурсам.

Пример использования может включать следующее:

* Контейнер, обслуживающий веб-приложение, и контейнер, извлекающий последнее содержимое из системы управления версиями.
* Контейнер приложения и журнала. Контейнер журнала собирает журналы и выходные данные метрик для основного приложения и записывает их в хранилище для долговременного хранения.
* Контейнер приложения и мониторинга. Контейнер мониторинга периодически выполняет запрос к приложению, чтобы убедиться, что оно правильно работает и отвечает, и выдает предупреждение, если это не так.
* Интерфейсный контейнер и серверный контейнер. Внешний интерфейс может обслуживать веб-приложение с серверной частью службы для получения данных. 

## <a name="next-steps"></a>Следующие шаги

Узнайте, как развертывать группу контейнеров с несколькими контейнерами с использованием шаблона Azure Resource Manager:

> [!div class="nextstepaction"]
> [Развертывание группы контейнеров][resource-manager template]

<!-- IMAGES -->
[container-groups-example]: ./media/container-instances-container-groups/container-groups-example.png

<!-- LINKS - External -->
[dcos-pod]: https://dcos.io/docs/1.10/deploying-services/pods/
[kubernetes-pod]: https://kubernetes.io/docs/concepts/workloads/pods/pod/

<!-- LINKS - Internal -->
[resource-manager template]: container-instances-multi-container-group.md
[yaml-file]: container-instances-multi-container-yaml.md
[region-availability]: container-instances-region-availability.md
[resource-requests]: /rest/api/container-instances/containergroups/createorupdate#resourcerequests
[resource-limits]: /rest/api/container-instances/containergroups/createorupdate#resourcelimits
[resource-requirements]: /rest/api/container-instances/containergroups/createorupdate#resourcerequirements
[azure-files]: container-instances-volume-azure-files.md
[virtual-network]: container-instances-vnet.md
[gpus]: container-instances-gpu.md
[az-container-export]: /cli/azure/container#az-container-export
