---
title: 'Основные понятия: поток данных в функции соединителя IoT (Предварительная версия) API Azure для FHIR'
description: Общие сведения о потоке данных в соединителе IoT. Соединитель Интернета вещей принимает, нормализует, группирует, преобразует и сохраняет данные Иомт в Azure API для FHIR.
services: healthcare-apis
author: ms-puneet-nagpal
ms.service: healthcare-apis
ms.subservice: iomt
ms.topic: conceptual
ms.date: 05/13/2020
ms.author: punagpal
ms.openlocfilehash: c2d150fcd35bc51478a1d7f4a0407abce1446c06
ms.sourcegitcommit: 3d79f737ff34708b48dd2ae45100e2516af9ed78
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/23/2020
ms.locfileid: "87100280"
---
# <a name="iot-connector-preview-data-flow"></a>Поток данных для соединителя IoT (Предварительная версия)

В этой статье приводятся общие сведения о потоке данных в соединителе IoT. Вы узнаете о различных стадиях обработки данных в соединителе IoT, которые преобразуют данные устройства в ресурсы [наблюдения](https://www.hl7.org/fhir/observation.html) на основе FHIR.

![Поток данных соединителя IoT](media/concepts-iot-data-flow/iot-connector-data-flow.png)

На схеме выше показаны различные этапы потока данных в соединителе IoT. 

## <a name="ingest"></a>Прием
Прием — это первый этап, в который данные устройства поступают в соединитель IoT. Конечная точка приема данных устройства размещается в [концентраторе событий Azure](https://docs.microsoft.com/azure/event-hubs/). Платформа концентратора событий Azure поддерживает высокую масштабируемость и пропускную способность с возможностью получения и обработки миллионов сообщений в секунду. Он также позволяет соединителю IoT асинхронно потреблять сообщения, устраняя необходимость ожидания устройств при обработке данных устройства.

> [!NOTE]
> В настоящее время формат JSON поддерживается только для данных устройства.

## <a name="normalize"></a>Нормализовать
Нормализация — это следующий этап, в котором данные устройства извлекаются из указанного выше концентратора событий Azure и обрабатываются с помощью шаблонов сопоставления устройств. Этот процесс сопоставления приводит к преобразованию данных устройства в нормализованную схему. 

Процесс нормализации упрощает обработку данных на более поздних стадиях, но также предоставляет возможность проецирования одного входного сообщения в несколько нормализованных сообщений. Например, устройство может отправить несколько важнейших знаков для основной температуры, скорости импульса, кровяного давления и нормы дыхания в одном сообщении. Это входное сообщение создаст четыре отдельных ресурса FHIR. Каждый ресурс будет представлять собой свой важный знак, а входное сообщение, запланированное на четыре разных нормализованных сообщения.

## <a name="group"></a>Группа
Группа — это следующий этап, в котором нормализованные сообщения, доступные на предыдущем этапе, группируются с использованием трех различных параметров: удостоверение устройства, тип измерения и период времени.

При группировании удостоверений устройств и типов измерений включить использование типа измерения [сампледдата](https://www.hl7.org/fhir/datatypes.html#SampledData) . Этот тип обеспечивает краткий способ представления ряда измерений на основе времени с устройства в FHIR. И период времени определяет задержку, с которой ресурсы наблюдения, создаваемые соединителем IoT, записываются в API Azure для FHIR.

> [!NOTE]
> Значение периода времени по умолчанию равно 15 минутам и не может быть настроено для просмотра.

## <a name="transform"></a>Преобразование
На этапе преобразования сгруппированные нормализованные сообщения обрабатываются с помощью шаблонов сопоставления FHIR. Сообщения, соответствующие типу шаблона, преобразуются в ресурсы наблюдения на основе FHIR, как указано в сопоставлении.

На этом этапе ресурс [устройства](https://www.hl7.org/fhir/device.html) и связанный с ним ресурс [пациента](https://www.hl7.org/fhir/patient.html) также получаются с сервера FHIR с использованием идентификатора устройства, присутствующего в сообщении. Эти ресурсы добавляются в качестве ссылки на создаваемый ресурс наблюдения.

> [!NOTE]
> Все поисковые идентификаторы кэшируются после разрешения, чтобы снизить нагрузку на сервер FHIR. Если вы планируете повторно использовать устройства с несколькими пациентов, рекомендуется создать ресурс виртуального устройства, относящийся к пациентам, и отправить идентификатор виртуального устройства в полезные данные сообщения. Виртуальное устройство может быть связано с фактическим ресурсом устройства в качестве родительского.

Если на сервере FHIR не существует ресурса устройства для данного идентификатора устройства, результат зависит от значения `Resolution Type` Set во время создания. Если задано значение `Lookup` , то конкретное сообщение игнорируется и конвейер продолжает обрабатывать другие входящие сообщения. Если задано значение `Create` , соединитель IOT создаст устройство с исходными костями и ресурсы пациента на сервере FHIR.  

## <a name="persist"></a>Сохранить
После создания ресурса наблюдения FHIR на этапе преобразования ресурс сохраняется в API Azure для FHIR. Если ресурс FHIR является новым, он будет создан на сервере. Если ресурс FHIR уже существовал, он будет обновлен.

## <a name="next-steps"></a>Дальнейшие действия

Щелкните ниже следующий шаг, чтобы узнать, как создать шаблоны сопоставления устройств и FHIR.

>[!div class="nextstepaction"]
>[Шаблоны сопоставления для соединителя IoT](iot-mapping-templates.md)


FHIR — это зарегистрированная торговая марка организации HL7, которая используется с разрешения HL7.
