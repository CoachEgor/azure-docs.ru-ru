---
title: Настройка хранилища vFXT Avere для Azure
description: Как добавить серверную систему хранения в Avere vFXT для Azure
author: ekpgh
ms.service: avere-vfxt
ms.topic: conceptual
ms.date: 01/13/2020
ms.author: rohogue
ms.openlocfilehash: dfffef90201ba4bbb5a912df6101e8338012df44
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "79252614"
---
# <a name="configure-storage"></a>Настройка хранилища

Здесь рассматривается, как настроить серверную систему хранения для кластера vFXT.

> [!TIP]
> Если вы создали новый контейнер Azure Blob вместе с кластером Avere vFXT, этот контейнер уже настроен и готов к использованию.

Если вы не создавали контейнер BLOB-объектов вместе с кластером или если вам нужно добавить дополнительное оборудование либо облачную систему хранения, следуйте приведенным ниже инструкциям.

Существуют две основные задачи.

1. [Создайте основной файлер,](#create-a-core-filer)который соединяет кластер vFXT с существующей системой хранения данных или контейнером учетной записи Azure Storage.

1. [Создайте соединение по пространству имен](#create-a-junction) для определения пути, который будут подключать клиенты.

Для этих шагов используется панель управления Avere. Дополнительные сведения см. в статье о [получении доступа к кластеру vFXT](avere-vfxt-cluster-gui.md).

## <a name="create-a-core-filer"></a>Создание основного файлового хранилища

"Core filer" - это термин vFXT для системы хранения бэк-энда. Хранилище может быть аппаратным устройством NAS, таким как NetApp или Isilon, или же облачным хранилищем объектов. Более подробную информацию о основных регистраторах можно найти в [руководстве по настройкам кластера Avere.](https://azure.github.io/Avere/legacy/ops_guide/4_7/html/settings_overview.html#managing-core-filers)

Чтобы добавить основное файловое хранилище, выберите один из двух основных типов хранилищ:

* [Основное файловое хранилище NAS](#nas-core-filer) — в разделе по этой ссылке описано, как добавить основное файловое хранилище NAS.
* [Файлер ядра облака хранилища Лазурного хранилища](#azure-blob-storage-cloud-core-filer) - описывает, как добавить контейнер хранения Azure Blob в качестве файлера ядра облака

### <a name="nas-core-filer"></a>Основное файловое хранилище NAS

Основной файлер NAS может быть припредствием к приложению NetApp или Isilon или конечная точка NAS в облаке. Система хранения должна иметь надежное высокоскоростное соединение с кластером Avere vFXT, например подключение ExpressRoute (а не VPN) 1 Гбит/с, и предоставлять доступ с правами root к используемым экспортируемым файлам NAS.

Выполните следующие действия, чтобы добавить основной файлер NAS:

1. На панели управления Avere щелкните вкладку **Settings** (Параметры) вверху.

1. Нажмите **Core Filer** > **Управлять ядром Filers** слева.

1. Нажмите кнопку **Создать**.

   ![Снимок экрана со страницей добавления основного файлового хранилища с курсором над кнопкой создания](media/avere-vfxt-add-core-filer-start.png)

1. Заполните в мастере необходимые сведения:

   * Присвойте файловому хранилищу имя.
   * Укажите полное доменное имя (FQDN), если оно доступно. В противном случае укажите IP-адрес или имя узла, которое разрешается в основное файловое хранилище.
   * Выберите класс хранилища из списка. Если не уверены, выберите **Other** (Другое).

     ![Снимок экрана со страницей добавления нового основного файлового хранилища и указанным полным доменным именем](media/avere-vfxt-add-core-filer.png)
  
   * Нажмите кнопку **Next** (Далее) и выберите политику кэширования.
   * Щелкните **Add Filer** (Добавить файловое хранилище).
   * Дополнительные сведения см. в разделе [Adding a New Core Filer - NAS Core Filer](https://azure.github.io/Avere/legacy/ops_guide/4_7/html/new_core_filer_nas.html) (Добавление нового основного файлового хранилища NAS) руководства по параметрам кластера Avere.

Затем перейдите к [созданию соединения](#create-a-junction).  

### <a name="azure-blob-storage-cloud-core-filer"></a>Файлер облачного ядра хранилища Azure Blob

Для использования хранилища Azure Blob в качестве резервного хранилища кластера vFXT требуется пустой контейнер для добавления в качестве основного файлера.

Чтобы добавить хранилище BLOB-объектов к кластеру, нужно выполнить следующие задачи:

* Создание учетной записи хранения (шаг 1 ниже).
* Создание пустого контейнера больших двоичных объектов (шаги 2–3).
* Добавление ключа доступа к хранилищу в качестве облачных учетных данных для кластера vFXT (шаги 4–6).
* Добавление контейнера больших двоичных объектов в качестве основного файлового хранилища для кластера vFXT (шаги 7–9).
* Создание соединения по пространству имен, которое клиенты используют для подключения к основному файловому хранилищу (раздел [Создание соединения](#create-a-junction); создайте одинаковое соединение для аппаратного и облачного хранилищ).

> [!TIP]
> При создании нового контейнера Blob при создании кластера Avere vFXT для кластера Azure шаблон развертывания автоматически настраивает контейнер в качестве основного файлера. (Это также верно, если вы используете сценарий создания, который доступен по запросу.) Вам не нужно настраивать основной файлер после этого.
>
> Инструмент создания кластера выполняет следующие задачи конфигурации для вас:
>
> * Создает новый контейнер Blob в предоставленном счету хранения
> * Определяет контейнер как основной файлер
> * Создает пространство имен, которое является перекрестком с контейнером
> * Создает конечную точку службы хранения данных внутри виртуальной сети кластера

Чтобы добавить хранилище BLOB-объектов после создания кластера, выполните следующие действия.

1. Создайте учетную запись хранения общего назначения версии 2 со следующими параметрами:

   * **Подписка** — та же, что и для кластера vFXT.
   * **Группа ресурсов** — та же, что и для группы кластера vFXT (необязательно).
   * **Расположение** — то же, что и для кластера vFXT.
   * **Производительность** — категория "Стандартный" (хранилище класса "Премиум" не поддерживается).
   * **Тип учетной записи** — общего назначения версии 2 (StorageV2).
   * **Репликация** — локально избыточное хранилище (LRS).
   * **Уровень доступа** — "Горячий".
   * **Требуется безопасное перемещение** — отключите этот параметр (значение не по умолчанию).
   * **Виртуальные сети** — необязательно.

   Нажмите кнопку "Развертывание в Azure" или используйте портал Azure.

   [![кнопка для создания учетной записи хранилища](media/deploytoazure.png)](https://ms.portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2FAzure%2FAvere%2Fmaster%2Fsrc%2Fvfxt%2Fstorageaccount%2Fazuredeploy.json)

1. После создания учетной записи перейдите к странице учетной записи хранения.

   ![Новая учетная запись хранения на портале Azure](media/avere-vfxt-new-storage-acct.png)

1. Создайте новый контейнер Blob: Нажмите **контейнеры** на странице обзора, а затем нажмите **кнопку «Контейнер**». Используйте любое имя контейнера и убедитесь, что для доступа установлено значение **Частный**.

   ![Страница хранения капли с кнопкой «контейнер» обведена и создается новый контейнер на всплывающем странице](media/avere-vfxt-new-blob.png)

1. Получите ключ учетной записи Хранилища Azure, нажав **клавиши доступа** под **настройками.** Копируйте один из предоставленных ключей.

   ![Интерфейс портала Azure для копирования ключа](media/avere-vfxt-copy-storage-key.png)

1. Откройте панель управления Avere для кластера. Щелкните вкладку **Settings** (Параметры), а затем выберите **Cluster** > **Cloud Credentials** (Кластер > Учетные данные облака) на левой панели навигации. На странице учетных данных облака нажмите кнопку **Add Credential** (Добавить учетные данные).

   ![Кнопка добавления учетных данных на странице настройки учетных данных облака](media/avere-vfxt-new-credential-button.png)

1. Введите следующие сведения, чтобы создать учетные данные для облачного файлового хранилища:

   | Поле | Значение |
   | --- | --- |
   | Credential name (Имя учетных данных) | любое описательное имя |
   | Service type (Тип службы) | (выберите ключ доступа к хранилищам Azure) |
   | Клиент | имя учетной записи хранения; |
   | Подписка | Идентификатор подписки |
   | Storage Access Key (Ключ доступа к хранилищу) | Ключ учетной записи хранения Azure (скопирован на предыдущем шаге) |

   Щелкните элемент **Отправить**.

   ![Заполненная форма облачных учетных данных на панели управления Avere](media/avere-vfxt-new-credential-submit.png)

1. Затем создайте основное файловое хранилище. В левой части панели управления Avere щелкните **Core Filer** >  **Manage Core Filers.**

1. Нажмите кнопку **Create** (Создать) на странице параметров **Manage Core Filers** (Управление основными файловыми хранилищами).

1. Заполните значения в мастере:

   * Выберите тип хранилища **Cloud** (Облачное).
   * Укажите имя нового облачного файлового хранилища и нажмите кнопку **Next** (Далее).
   * Примите политику кэширования по умолчанию и перейдите на страницу 3.
   * В разделе **Service type** (Тип службы) выберите **Azure storage** (Хранилище Azure).
   * Выберите учетные данные, созданные ранее.
   * Для параметра **Bucket contents** (Содержимое контейнера) укажите значение **Empty** (Пусто).
   * Установите для параметра **Certificate verification** (Проверка сертификатов) значение **Disabled** (Отключено).
   * Для параметра **Compression mode** (Режим сжатия) выберите **None** (Нет).
   * Нажмите кнопку **Далее**.
   * На четвертой странице введите имя контейнера в поле **Bucket name** (Имя контейнера) в формате *имя_учетной_записи_хранения*/*имя_контейнера*.
   * При необходимости задайте для параметра **Encryption type** (Тип шифрования) значение **None** (Нет).  Служба хранилища Azure шифруется по умолчанию.
   * Щелкните **Add Filer** (Добавить файловое хранилище).

   Дополнительные сведения см. в статье [Adding a New Core Filer - Cloud Core Filer](<https://azure.github.io/Avere/legacy/ops_guide/4_7/html/new_core_filer_cloud.html>) (Добавление нового облачного основного файлового хранилища) руководства по параметрам кластера Avere.

Страница будет обновлена или вы можете сами обновить страницу, чтобы отобразить новое основное файловое хранилище.

Затем нужно [создать соединение](#create-a-junction).

## <a name="create-a-junction"></a>Создание соединения

Соединение — это путь, который создается для клиентов. Клиенты подключают путь и переходят в выбранное вами место назначения.

Например, вы можете создать `/vfxt/files` для сопоставления с папкой экспорта файлового хранилища NetApp `/vol0/data` и подкаталогом `/project/resources`.

Дополнительные сведения о соединениях см. в [разделе о пространствах имен в руководстве по настройке кластера Avere](https://azure.github.io/Avere/legacy/ops_guide/4_7/html/gui_namespace.html).

Выполните следующие действия в интерфейсе панели управления Avere:

* Нажмите на**имя** **VServer** > в левом верхнем углу.
* Укажите путь для пространства имен, который начинается с / (косая черта), например ``/vfxt/data``.
* Выберите основное файловое хранилище.
* Выберите экспорт основного файлового хранилища.
* Нажмите кнопку **Далее**.

  ![Снимок экрана страницы добавления нового соединения с заполненными полями для соединения, основного файлового хранилища и экспорта](media/avere-vfxt-add-junction.png)

Соединение отобразится через несколько секунд. Создавайте дополнительные соединения по мере необходимости.

После создания соединения клиенты используют путь пространства имен для доступа к файлам из системы хранения данных.

## <a name="next-steps"></a>Дальнейшие действия

* [Подключение кластера Avere vFXT](avere-vfxt-mount-clients.md)
* Узнайте эффективные способы [перемещения данных в новый контейнер Blob](avere-vfxt-data-ingest.md)
