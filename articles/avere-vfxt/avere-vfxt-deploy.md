---
title: Развертывание Avere vFXT для Azure
description: Шаги по развертыванию кластера Avere vFXT в Azure
author: ekpgh
ms.service: avere-vfxt
ms.topic: conceptual
ms.date: 01/13/2020
ms.author: rohogue
ms.openlocfilehash: e70d1dfebcf25ee8f4e90a062cee6dd72a663e02
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "79252601"
---
# <a name="deploy-the-vfxt-cluster"></a>Развертывание кластера vFXT

Эта процедура описывает использование мастера развертывания, который предоставляется в Azure Marketplace. Этот мастер автоматически развертывает кластер с помощью шаблона Azure Resource Manager. После ввода параметров в форме и нажмите **«Создать»** Azure автоматически выполняет следующие задачи:

* Создает кластерный контроллер, который является базовым VM, который содержит программное обеспечение, необходимое для развертывания и управления кластером.
* Настройка группы ресурсов и виртуальной сетевой инфраструктуры, включая создание новых элементов.
* Создает кластерный узлы VM и настраивает их как кластер Avere.
* При запросе создается новый контейнер Azure Blob и настраивает его в качестве файлера ядра кластера.

После выполнения инструкций в этом документе у вас будет виртуальная сеть, подсеть, кластерный контроллер и кластер vFXT, как показано на следующей диаграмме. На этой диаграмме показан дополнительный основной файлер Azure Blob, который включает в себя новый контейнер для хранения Blob (в новой учетной записи хранилища, не показан) и конечную точку службы для хранения Microsoft внутри подсети.

![диаграмма, показывающая три концентрических прямоугольника с компонентами кластера Avere. Внешний прямоугольник помечен как «Группа ресурсов» и содержит шестиугольник с надписью «Blob storage (необязательно)». Следующий прямоугольник помечен как «Виртуальная сеть: 10.0.0.0/16» и не содержит уникальных компонентов. Внутренний прямоугольник помечен как 'Subnet:10.0.0.0/24' и содержит VM помеченный 'Кластерный контроллер', стек из трех VMs помеченных 'vFXT узлами (vFXT кластер)', и шестиугольник с пометкой 'Служба конечной точки'. В группе ресурсов есть стрелка, соединяющая конечную точку обслуживания (которая находится внутри подсети) и хранилище капли (которая находится за пределами подсети и vnet). Стрелка проходит через подсеть и виртуальные границы сети.](media/avere-vfxt-deployment.png)

Перед запуском шаблона создания убедитесь, что у вас есть следующие необходимые компоненты:  

* [Новая подписка](avere-vfxt-prereqs.md#create-a-new-subscription).
* [Разрешения владельца подписки](avere-vfxt-prereqs.md#configure-subscription-owner-permissions).
* [Квота для кластера vFXT](avere-vfxt-prereqs.md#quota-for-the-vfxt-cluster).
* [Конечная точка службы хранения данных (при необходимости)](avere-vfxt-prereqs.md#create-a-storage-service-endpoint-in-your-virtual-network-if-needed) - Требуется для развертывания, использующем существующую виртуальную сеть и создающая хранилище кабов

Дополнительные сведения о шагах развертывания кластера и планировании см. в статьях [Plan your Avere vFXT system](avere-vfxt-deploy-plan.md) (Планирование системы Avere vFXT) и [Avere vFXT for Azure - deployment overview](avere-vfxt-deploy-overview.md) (Общие сведения о развертывании Avere vFXT для Azure).

## <a name="create-the-avere-vfxt-for-azure"></a>Создание кластера Avere vFXT для Azure

Получите доступ к шаблону создания на портале Azure, испоиском Avere и выбором «Avere vFXT для шаблона Azure ARM».

![В окне браузера отображается портал Azure с выделенными элементами "Создать > Marketplace > Все". На странице «Все» поле поиска имеет термин «avere», а второй результат, «Avere vFXT для шаблона Azure ARM», выделен красным цветом, чтобы выделить его.](media/avere-vfxt-template-choose.png)

После прочтения подробной информации о avere vFXT для страницы Azure ARM Template, нажмите кнопку **«Создание»,** чтобы начать.

![Сайт Azure Marketplace, где отображается первая страница шаблона развертывания](media/avere-vfxt-deploy-first.png)

Этот шаблон состоит из четырех шагов — две страницы для сбора информации, а затем шаги проверки и подтверждения.

* Страница 1 собирает настройки для кластерного контроллера VM.
* Страница 2 собирает параметры для создания кластера и дополнительные ресурсы, такие как подсети и хранилище.
* Страница 3 обобщает ваш выбор и проверяет конфигурацию.
* Четвертая страница описывает условия использования программного обеспечения, позволяя начать создание кластера.

## <a name="page-one-parameters---cluster-controller-information"></a>Параметры на первой странице для сведений о контроллере кластера

Первая страница шаблона развертывания фокусируется на контроллере кластера.

![Первая страница шаблона развертывания](media/avere-vfxt-deploy-1.png)

Заполните следующие сведения:

* **Cluster controller name** (Имя контроллера кластера). Введите имя виртуальной машины для контроллера кластера.

* **Имя пользователя контроллера** - Установите имя пользователя root для кластерного контроллера VM.

* **Authentication type** (Тип проверки подлинности). Выберите проверку подлинности на основе пароля или открытого ключа SSH, которая будет применяться при подключениях к контроллеру. Мы рекомендуем использовать метод с открытым ключом SSH (см. инструкции по [созданию и использованию ключей SSH](https://docs.microsoft.com/azure/virtual-machines/linux/ssh-from-windows)).

* **Password** (Пароль) или **SSH public key** (Открытый ключ SSH) — в зависимости выбранного типа проверки подлинности в следующих полях нужно предоставить открытый ключ RSA или пароль. Эти учетные данные используются в сочетании с указанным выше именем пользователя.

* **Subscription** (Подписка). Выберите подписку для Avere vFXT.

* **Группа ресурсов**. Выберите существующую пустую группу ресурсов для кластера Avere vFXT или щелкните "Создать" и введите имя новой группы ресурсов.

* **Location** (Расположение). Укажите расположение кластера и ресурсов Azure.

Нажмите **OK,** когда закончите.

> [!NOTE]
> Если для контроллера кластера нужно настроить доступный из Интернета IP-адрес, создайте для этого кластера новую виртуальную сеть и не используйте существующие сети. Этот параметр вы найдете на второй странице.

## <a name="page-two-parameters---vfxt-cluster-information"></a>Параметры на второй странице для сведений о кластере vFXT

Вторая страница шаблона развертывания позволяет задать размер кластера, тип узлов, размер кэша, параметры хранилища и еще несколько параметров.

![Вторая страница шаблона развертывания](media/avere-vfxt-deploy-2.png)

* **Количество кластерных узлов Avere vFXT** - Выберите количество узлов в кластере. Допускаются значения в диапазоне от трех до двенадцати узлов.

* **Cluster administration password** (Пароль для администрирования кластера). Создайте пароль для администрирования кластера. Этот пароль используется с ```admin``` именем пользователя для вхотливки в панель управления кластера, где можно контролировать настройки кластера и настраивать настройки кластера.

* **Avere vFXT cluster name** (Имя кластера Avere vFXT). Присвойте кластеру уникальное имя.

* **Размер** - В этом разделе показан тип VM, который будет использоваться для кластерных узлов. Хотя есть только один рекомендуемый вариант, ссылка **размер изменения** открывает таблицу с подробной информацией об этом типе экземпляра и ссылкой на калькулятор цен.

* **Размер кэша на узла** - кластерный кэш размещается по кластерным узлам, поэтому общий размер кэша в кластере Avere vFXT будет размером, умноженный на количество узлов.

  Рекомендуемая конфигурация: Используйте 4 ТБ на узла для Standard_E32s_v3 узлов.

* **Виртуальная сеть** - Определите новую виртуальную сеть для размещения кластера или выберите существующую сеть, которая отвечает предпосылкам, описанным в [системе Plan your Avere vFXT.](avere-vfxt-deploy-plan.md#subscription-resource-group-and-network-infrastructure)

  > [!NOTE]
  > При создании новой виртуальной сети контроллер кластера будет иметь общедоступный IP-адрес, чтобы вы могли получить доступ к новой частной сети. Если вы выбираете существующую виртуальную сеть, контроллер кластера настраивается без публичного IP-адреса.
  >
  > Общедоступный IP-адрес для контроллера кластера обеспечивает более удобный доступ к кластеру vFXT, но создает небольшую угрозу безопасности.
  >* Благодаря наличию общедоступного IP-адреса контроллер кластера можно использовать в качестве узла перехода для подключения к кластеру Avere vFXT за пределами частной подсети.
  >* Если у вас нет общедоступного IP-адреса на контроллере, вам нужен другой хост, VPN-соединение или ExpressRoute для доступа к кластеру. Например, используйте существующую виртуальную сеть, которая уже настроена на подключение VPN.
  >* Если вы создаете контроллер с общедоступным IP-адресом, необходимо защитить виртуальную машину контроллера с помощью группы безопасности сети. По умолчанию Avere vFXT для развертывания Azure создает группу сетевой безопасности, которая ограничивает входящий доступ только к порту 22 для контроллеров с общедоступными IP-адресами. Вы можете дополнительно защитить систему, ограничив доступ по выбранному диапазону исходных IP-адресов, то есть разрешая подключения только от тех компьютеров, с которых вам нужен доступ к этому кластеру.

  Новая виртуальная сеть также настроена с конечным пунктом службы хранения для хранения Azure Blob и с блоком управления доступом к сети, чтобы позволить только I-центру из подсети кластера.

* **Subnet** - Выберите подсеть или создайте новую.

* **Создайте и используйте хранилище каплей** - Выберите **верно,** чтобы создать новый контейнер Azure Blob и настроить его в качестве запасного хранилища для нового кластера Avere vFXT. Эта опция также создает новую учетную запись хранилища в группе ресурсов кластера и создает конечную точку службы хранения Майкрософт внутри подсети кластера.
  
  Если вы поставляете существующую виртуальную сеть, она должна иметь конечную точку службы хранения перед созданием кластера. (Для получения дополнительной информации, прочитайте [план avere vFXT системы](avere-vfxt-deploy-plan.md).)

  Задайте этому полю значение **false**, если вы не хотите создавать контейнер. В этом случае необходимо прикрепить и настроить хранилище после создания кластера. Дополнительные инструкции см. в статье [Настройка хранилища](avere-vfxt-add-storage.md).

* **(Новая) учетная запись хранения** - При создании нового контейнера Azure Blob введите имя для новой учетной записи хранилища.

## <a name="validation-and-purchase"></a>Проверка и приобретение

Страница 3 обобщает конфигурацию и проверяет параметры. После успешной проверки проверьте резюме и нажмите кнопку **OK.**

> [!TIP]
> Вы можете сохранить настройки создания этого кластера, нажав **на шаблон Скачать и параметры** ссылку рядом с кнопкой **OK.** Эта информация может быть полезна, если вам нужно создать аналогичный кластер позже - например, для создания кластера замены в сценарии аварийного восстановления. (Читайте [руководство по восстановлению стихийных бедствий,](disaster-recovery.md) чтобы узнать больше.)

![Третья страница шаблона развертывания, проверка параметров](media/avere-vfxt-deploy-3.png)

Страница 4 предоставляет условия использования и ссылки на конфиденциальность и информацию о ценах.

Введите любую недостающую контактную информацию, а затем нажмите кнопку **«Создание»,** чтобы принять условия и создать кластер Avere vFXT для кластера Azure.

![Четвертая страница шаблона развертывания с описанием условий и кнопкой создания](media/avere-vfxt-deploy-4.png)

Развертывание кластера занимает 15–20 минут.

## <a name="gather-template-output"></a>Сбор выходных данных шаблона

Когда шаблон Avere vFXT завершает создание кластера, он выводит важную информацию о новом кластере.

> [!TIP]
> Убедитесь в том, чтобы скопировать **IP-адрес управления** из вывода шаблона. Этот адрес вам понадобится для администрирования кластера.

Чтобы найти информацию:

1. Перейдите к группе ресурсов для контроллера кластера.

1. В левой части страницы щелкните **Развертывания**, а затем — **microsoft-avere.vfxt-template**.

   ![Страница портала для группы ресурсов, где слева выбран пункт "Развертывания", а в таблице для имени развертывания указано значение microsoft-avere.vfxt-template](media/avere-vfxt-outputs-deployments.png)

1. В левой части страницы щелкните **Выходные данные**. Скопируйте значения в каждом из полей.

   ![Страница выходных значений со значениями SSHSTRING, RESOURCE_GROUP, LOCATION, NETWORK_RESOURCE_GROUP, NETWORK, SUBNET, SUBNET_ID, VSERVER_IPs и MGMT_IP в полях с метками](media/avere-vfxt-outputs-values.png)

## <a name="next-steps"></a>Дальнейшие действия

Теперь, когда кластер запущен и вы знаете его IP-адрес управления, [подключитесь к инструменту конфигурации кластера.](avere-vfxt-cluster-gui.md)

Используйте интерфейс конфигурации для настройки кластера, включая следующие задачи настройки:

* [Включение поддержки](avere-vfxt-enable-support.md)
* [Добавление хранилища](avere-vfxt-add-storage.md) (при необходимости)
