---
title: Развертывание Avere vFXT для Azure
description: Шаги по развертыванию кластера Avere vFXT в Azure
author: ekpgh
ms.service: avere-vfxt
ms.topic: conceptual
ms.date: 04/05/2019
ms.author: rohogue
ms.openlocfilehash: 6ddf950bf2d138a94675ee394109a0d227ea206b
ms.sourcegitcommit: 1c2659ab26619658799442a6e7604f3c66307a89
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/10/2019
ms.locfileid: "72255449"
---
# <a name="deploy-the-vfxt-cluster"></a>Развертывание кластера vFXT

Эта процедура описывает использование мастера развертывания, который предоставляется в Azure Marketplace. Этот мастер автоматически развертывает кластер с помощью шаблона Azure Resource Manager. Когда вы введете в форму параметры и нажмете кнопку **Создать**, Azure автоматически выполнит следующие действия:

* Создает контроллер кластера, который представляет собой базовую виртуальную машину, которая содержит программное обеспечение, необходимое для развертывания кластера и управления им.
* Настраивает группу ресурсов и инфраструктуру виртуальной сети, включая создание новых элементов.
* Создает виртуальные машины узла кластера и настраивает их в качестве кластера Авере.
* При запросе создает новый контейнер больших двоичных объектов Azure и настраивает его в качестве основного фильтр кластера.

После выполнения инструкций, приведенных в этом документе, вы получите виртуальную сеть, подсеть, контроллер и кластер Вфкст, как показано на следующей схеме. На этой схеме показаны дополнительные фильтры BLOB-объектов Azure, в том числе новый контейнер хранилища больших двоичных объектов (в новой учетной записи хранения, не показан) и конечная точка службы для хранилища Microsoft в подсети. 

![на схеме показаны три концентрических прямоугольника с компонентами кластера Авере. Внешний прямоугольник помечен как "Группа ресурсов" и содержит шестиугольник с меткой "хранилище BLOB-объектов (необязательно)". Следующий прямоугольник в помечен как "Виртуальная сеть: 10.0.0.0/16 "и не содержит уникальных компонентов. Внутренний прямоугольник помечен как "Subnet: 10.0.0.0/24" и содержит виртуальную машину с меткой "контроллер кластера", стек из трех виртуальных машин с меткой "Вфкст nodes (кластер Вфкст)" и шестиугольник с меткой "конечная точка службы". В группе ресурсов имеется стрелка, соединяющая конечную точку службы (которая находится в подсети) и хранилище BLOB-объектов (которое находится за пределами подсети и виртуальной сети). Стрелка проходит через границы подсети и виртуальной сети.](media/avere-vfxt-deployment.png)  

Перед запуском шаблона создания убедитесь, что у вас есть следующие необходимые компоненты:  

1. [Новая подписка](avere-vfxt-prereqs.md#create-a-new-subscription).
1. [Разрешения владельца подписки](avere-vfxt-prereqs.md#configure-subscription-owner-permissions).
1. [Квота для кластера vFXT](avere-vfxt-prereqs.md#quota-for-the-vfxt-cluster).
1. [Конечная точка службы хранилища (при необходимости)](avere-vfxt-prereqs.md#create-a-storage-service-endpoint-in-your-virtual-network-if-needed) — требуется для развертывания с использованием существующей виртуальной сети и создания хранилища BLOB-объектов.

Дополнительные сведения о шагах развертывания кластера и планировании см. в статьях [Plan your Avere vFXT system](avere-vfxt-deploy-plan.md) (Планирование системы Avere vFXT) и [Avere vFXT for Azure - deployment overview](avere-vfxt-deploy-overview.md) (Общие сведения о развертывании Avere vFXT для Azure).

## <a name="create-the-avere-vfxt-for-azure"></a>Создание кластера Avere vFXT для Azure

Чтобы получить доступ к шаблону создания в портал Azure, найдите Авере и выберите Авере Вфкст для шаблона Azure ARM. 

![В окне браузера отображается портал Azure с выделенными элементами "Создать > Marketplace > Все". На странице все в поле поиска есть слово «авере», а во втором — «Авере Вфкст для шаблона ARM для Azure» выделены красным цветом.](media/avere-vfxt-template-choose.png)

Прочитав сведения на странице шаблона Авере Вфкст для Azure ARM, нажмите кнопку **создать** , чтобы начать. 

![Сайт Azure Marketplace, где отображается первая страница шаблона развертывания](media/avere-vfxt-deploy-first.png)

Этот шаблон состоит из четырех шагов — две страницы для сбора информации, а затем шаги проверки и подтверждения. 

* Первая страница посвящена параметрам виртуальной машины для контроллера кластера. 
* На второй странице указываются параметры для создания кластера и связанных с ним ресурсов, таких как подсети и хранилище. 
* Третья страница отображает все введенные параметры и проверяет правильность конфигурации. 
* Четвертая страница описывает условия использования программного обеспечения, позволяя начать создание кластера. 

## <a name="page-one-parameters---cluster-controller-information"></a>Параметры на первой странице для сведений о контроллере кластера

На первой странице шаблона развертывания собираются данные о контроллера кластера. 

![Первая страница шаблона развертывания](media/avere-vfxt-deploy-1.png)

Заполните следующие сведения:

* **Cluster controller name** (Имя контроллера кластера). Введите имя виртуальной машины для контроллера кластера.

* **Controller username** (Имя пользователя контроллера). Введите имя привилегированного пользователя для виртуальной машины контроллера кластера. 

* **Authentication type** (Тип проверки подлинности). Выберите проверку подлинности на основе пароля или открытого ключа SSH, которая будет применяться при подключениях к контроллеру. Мы рекомендуем использовать метод с открытым ключом SSH (см. инструкции по [созданию и использованию ключей SSH](https://docs.microsoft.com/azure/virtual-machines/linux/ssh-from-windows)).

* **Password** (Пароль) или **SSH public key** (Открытый ключ SSH) — в зависимости выбранного типа проверки подлинности в следующих полях нужно предоставить открытый ключ RSA или пароль. Эти учетные данные используются в сочетании с указанным выше именем пользователя.

* **Subscription** (Подписка). Выберите подписку для Avere vFXT. 

* **Группа ресурсов**. Выберите существующую пустую группу ресурсов для кластера Avere vFXT или щелкните "Создать" и введите имя новой группы ресурсов. 

* **Location** (Расположение). Укажите расположение кластера и ресурсов Azure.

Щелкните **OK**, когда все будет готово. 

> [!NOTE]
> Если для контроллера кластера нужно настроить доступный из Интернета IP-адрес, создайте для этого кластера новую виртуальную сеть и не используйте существующие сети. Этот параметр вы найдете на второй странице.

## <a name="page-two-parameters---vfxt-cluster-information"></a>Параметры на второй странице для сведений о кластере vFXT

Вторая страница шаблона развертывания позволяет задать размер кластера, тип узлов, размер кэша, параметры хранилища и еще несколько параметров. 

![Вторая страница шаблона развертывания](media/avere-vfxt-deploy-2.png)

* **Avere vFXT cluster node count** (Количество узлов кластера Avere vFXT). Выберите количество узлов, которое вы намерены использовать в кластере. Допускаются значения в диапазоне от трех до двенадцати узлов. 

* **Cluster administration password** (Пароль для администрирования кластера). Создайте пароль для администрирования кластера. Этот пароль будет использоваться с именем пользователя ```admin``` для входа на панель управления кластером, где доступны функции мониторинга и настройки кластера.

* **Avere vFXT cluster name** (Имя кластера Avere vFXT). Присвойте кластеру уникальное имя. 

* **Size (размер** ). в этом разделе показан тип виртуальной машины, который будет использоваться для узлов кластера. Хотя существует только один рекомендуемый вариант, ссылка **изменить размер** открывает таблицу со сведениями об этом типе экземпляра и ссылкой на калькулятор цен.  

* **Cache size per node** (Размер кэша для каждого узла). Кэш кластера распределяется между узлами кластера, то есть общий размер кэша в кластере Avere vFXT вычисляется как размер кэша для каждого узла, умноженный на количество узлов. 

  Рекомендуемая конфигурация — использование 4 ТБ на узел для узлов Standard_E32s_v3.

* **Виртуальная сеть** . Определите новую виртуальную локальную сеть для размещения кластера или выберите существующую виртуальную сеть, которая соответствует предварительным требованиям, описанным в разделе [Планирование системы авере вфкст](avere-vfxt-deploy-plan.md#resource-group-and-network-infrastructure). 

  > [!NOTE]
  > Во втором случае контроллеру кластера будет назначен общедоступный IP-адрес для организации доступа к этой новой частной сети. Если вы выберете существующую виртуальную сеть, контроллер кластера настраивается без общедоступного IP-адреса. 
  > 
  > Общедоступный IP-адрес для контроллера кластера обеспечивает более удобный доступ к кластеру vFXT, но создает небольшую угрозу безопасности. 
  >  * Благодаря наличию общедоступного IP-адреса контроллер кластера можно использовать в качестве узла перехода для подключения к кластеру Avere vFXT за пределами частной подсети.
  >  * Если вы не настроили общедоступный IP-адрес в контроллере, для доступа к кластеру необходимо использовать другой узел перехода, подключение VPN или ExpressRoute. Например, создайте контроллер в виртуальной сети, для которой уже настроено VPN-подключение.
  >  * Если вы создаете контроллер с общедоступным IP-адресом, необходимо защитить виртуальную машину контроллера с помощью группы безопасности сети. По умолчанию развертывание Avere vFXT для Azure создает для контроллеров с общедоступными IP-адресами группу безопасности сети и разрешает входящий доступ только к порту 22. Вы можете дополнительно защитить систему, ограничив доступ по выбранному диапазону исходных IP-адресов, то есть разрешая подключения только от тех компьютеров, с которых вам нужен доступ к этому кластеру.

  Шаблон развертывания также настраивает новую виртуальную сеть с конечной точкой службы хранилища для хранилища BLOB-объектов Azure, а Управление доступом к сети блокируется только IP-адресами из подсети кластера. 

* **Subnet** (Подсеть). Выберите подсеть из существующей виртуальной сети или создайте новую. 

* **Создание и использование хранилища BLOB-объектов** . Выберите **значение true** , чтобы создать новый контейнер больших двоичных объектов Azure и настроить его в качестве серверного хранилища для нового кластера авере вфкст. Этот параметр также создает новую учетную запись хранения в той же группе ресурсов, что и кластер, и конечную точку службы хранилища Майкрософт в подсети кластера. 
  
  При указании существующей виртуальной сети перед созданием кластера она должна иметь конечную точку службы хранилища. (Дополнительные сведения см. в статье [планирование Авере вфкст System](avere-vfxt-deploy-plan.md).)

  Задайте этому полю значение **false**, если вы не хотите создавать контейнер. В этом случае необходимо подключить и настроить хранилище после создания кластера. Дополнительные инструкции см. в статье [Настройка хранилища](avere-vfxt-add-storage.md). 

* **(Новая) учетная запись хранения** . при создании нового контейнера больших двоичных объектов Azure введите имя новой учетной записи хранения. 

## <a name="validation-and-purchase"></a>Проверка и приобретение

На третьей странице представлена сводная информация о конфигурации и проверка параметров. Если проверка завершится успешно, щелкните кнопку **ОК** для продолжения работы. 

![Третья страница шаблона развертывания, проверка параметров](media/avere-vfxt-deploy-3.png)

На четвертой странице введите необходимые контактные данные и нажмите кнопку **создать** , чтобы принять условия и создать авере вфкст для кластера Azure. 

![Четвертая страница шаблона развертывания с описанием условий и кнопкой создания](media/avere-vfxt-deploy-4.png)

Развертывание кластера занимает 15–20 минут.

## <a name="gather-template-output"></a>Сбор выходных данных шаблона

Когда шаблон Avere vFXT завершит создание кластера, выводится ряд важных сведений об этом новом кластере. 

> [!TIP]
> Обязательно скопируйте из выходных данных шаблона IP-адрес управления. Этот адрес вам понадобится для администрирования кластера.

Чтобы найти эти сведения, выполните следующие действия:

1. Перейдите к группе ресурсов для контроллера кластера.

1. В левой части страницы щелкните **Развертывания**, а затем — **microsoft-avere.vfxt-template**.

   ![Страница портала для группы ресурсов, где слева выбран пункт "Развертывания", а в таблице для имени развертывания указано значение microsoft-avere.vfxt-template](media/avere-vfxt-outputs-deployments.png)

1. В левой части страницы щелкните **Выходные данные**. Скопируйте значения в каждом из полей. 

   ![Страница выходных значений со значениями SSHSTRING, RESOURCE_GROUP, LOCATION, NETWORK_RESOURCE_GROUP, NETWORK, SUBNET, SUBNET_ID, VSERVER_IPs и MGMT_IP в полях с метками](media/avere-vfxt-outputs-values.png)

## <a name="next-step"></a>Дальнейшие действия

Теперь, когда кластер запущен и вам известен его IP-адрес управления, вы можете [подключиться к средству конфигурации кластера](avere-vfxt-cluster-gui.md), чтобы включить поддержку, добавить хранилище и настроить другие параметры кластера.
