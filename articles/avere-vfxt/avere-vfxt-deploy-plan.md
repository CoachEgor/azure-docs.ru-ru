---
title: Планирование системы Avere vFXT — Azure
description: Здесь описывается планирование, которое нужно выполнить перед развертыванием системы Avere vFXT для Azure
author: ekpgh
ms.service: avere-vfxt
ms.topic: conceptual
ms.date: 12/03/2019
ms.author: rohogue
ms.openlocfilehash: d4fc2a6b7def4b7c55faa37fbed756fbb830ff73
ms.sourcegitcommit: f4f626d6e92174086c530ed9bf3ccbe058639081
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/25/2019
ms.locfileid: "75415436"
---
# <a name="plan-your-avere-vfxt-system"></a>Планирование системы Avere vFXT

В этой статье объясняется, как спланировать новый Авере Вфкст для кластера Azure, который расположен в соответствии с вашими потребностями.

Прежде чем перейти в Azure Marketplace или к созданию виртуальных машин, подумайте, как кластер будет взаимодействовать с другими элементами в Azure. Спланируйте, где в частной сети и подсети будут находиться ресурсы кластера, а также решите, где будет ваше серверное хранилище. Создаваемые узлы кластера должны обладать достаточной производительностью для поддержки рабочих процессов.

Продолжайте, чтобы узнать больше.

## <a name="learn-the-components-of-the-system"></a>Знакомство с компонентами системы

При начале планирования может оказаться полезным понять компоненты Авере Вфкст для системы Azure.

* Узлы кластера — кластер состоит из трех или более виртуальных машин, настроенных в качестве узлов кластера. Дополнительные узлы обеспечивают большую пропускную способность системы и кэш большего размера.

* Кэш. емкость кэша делится между узлами кластера. Задайте размер кэша каждого узла при создании кластера. Размеры узлов добавляются к общему размеру кэша.

* Контроллер кластера. контроллер кластера — это дополнительная виртуальная машина, расположенная в той же подсети, что и узлы кластера. Контроллер необходим для создания кластера и для текущих задач управления.

* Хранилище серверной части. данные, которые требуется кэшировать, хранятся в долгосрочной перспективе в системе хранения оборудования или в контейнере больших двоичных объектов Azure. Хранилище можно добавить после создания Вфкст Авере для кластера Azure. Если вы используете хранилище BLOB-объектов, вы можете добавить и настроить контейнер при создании кластера.

* Клиенты. клиентские компьютеры, использующие кэшированные файлы, подключаются к кластеру по пути к виртуальному файлу, а не напрямую обращаются к системам хранения. (Дополнительные сведения см. в статье [Подключение кластера Авере вфкст](avere-vfxt-mount-clients.md).)

## <a name="subscription-resource-group-and-network-infrastructure"></a>Подписка, Группа ресурсов и сетевая инфраструктура

Определите, где будут находиться элементы развертывания Avere vFXT для Azure. На схеме ниже показано возможное упорядочение компонентов Avere vFXT для Azure:

![На схема отображается контроллер кластера и виртуальные машины кластера в одной подсети. Вокруг периметра подсети находится периметр виртуальной сети. Внутри виртуальной сети есть шестиугольник, представляющий конечную точку службы хранилища. Он связан с хранилищем BLOB-объектов за пределами виртуальной сети с помощью пунктирной стрелки.](media/avere-vfxt-components-option.png)

При планировании сетевой инфраструктуры системы Avere vFXT нужно следовать таким рекомендациям:

* Создайте новую подписку для каждого Авере Вфкст для развертывания Azure и управляйте всеми компонентами в этой подписке. Преимущества:
  * Упрощенное отслеживание расходов — просмотр и аудит всех расходов на ресурсы, инфраструктуру и вычислительные циклы в одной подписке.
  * Более простая очистка — возможность удалить всю подписку по завершении работы с проектом.
  * Удобное секционирование квот ресурсов. Защитите другие критически важные рабочие нагрузки от возможного регулирования ресурсов, изолируя клиенты Авере Вфкст и кластер в одной подписке. Это позволяет избежать конфликта при создании большого количества клиентов для рабочего процесса высокопроизводительных вычислений.

* Разместите клиентские системы вычисления близко к кластеру vFXT. Серверное хранилище может находиться на более дальнем расстоянии.  

* Совместное размещение кластера Вфкст и виртуальной машины контроллера кластера (в частности, они должны быть:

  * В той же виртуальной сети
  * В той же группе ресурсов
  * В одной учетной записи хранения
  
  Шаблон автоматического создания кластера обрабатывает это в большинстве случаев.

* Кластер должен находиться в собственной подсети, чтобы избежать конфликтов IP-адресов с клиентами или другими ресурсами вычислений.

* Используйте шаблон создания кластера, чтобы создать большую часть необходимых ресурсов инфраструктуры для кластера, включая группы ресурсов, виртуальные сети, подсети и учетные записи хранения.

  Если вы хотите использовать уже существующие ресурсы, убедитесь, что они соответствуют требованиям, приведенным в этой таблице.

  | Ресурс | Использовать существующий? | Требования |
  |----------|-----------|----------|
  | Группа ресурсов | Да, если пусто | Должно быть пустым|
  | Учетная запись хранения | **Да** , если после создания кластера подключить существующий контейнер больших двоичных объектов <br/>  **Нет** , если при создании кластера создается новый контейнер больших двоичных объектов | Существующий контейнер больших двоичных объектов должен быть пустым <br/> &nbsp; |
  | Виртуальная сеть | Да | При создании нового контейнера больших двоичных объектов Azure необходимо включить конечную точку службы хранилища. |
  | Подсеть | Да |   |

## <a name="ip-address-requirements"></a>Требования к IP-адресам

Убедитесь, что у кластера подсети есть достаточно большой диапазон IP-адресов для поддержки кластера.

Кластер Avere vFXT использует следующие IP-адреса:

* IP-адрес для управления одним кластером. Этот адрес может перемещаться с узла на узел кластера по мере необходимости, чтобы он всегда был доступен. Используйте этот адрес для подключения к средству настройки панели управления Авере.
* Для каждого узла кластера требуется:
  * По крайней мере один IP-адрес, ориентированный на клиента. (Все адреса, ориентированные на клиента, управляются кластером *vserver*, который при необходимости может перемещать их между узлами.)
  * Один IP-адрес для взаимодействия с кластером.
  * Один IP-адрес экземпляра (назначенный виртуальной машине).

Если вы используете хранилище BLOB-объектов Azure, вам также могут потребоваться IP адреса из виртуальной сети кластера:  

* Учетной записи хранилища BLOB-объектов Azure нужно по крайней мере пять IP-адресов. При обнаружении хранилища BLOB-объектов в той же виртуальной сети, что и кластер, учитывайте это требование.
* Если вы используете хранилище BLOB-объектов Azure, которое находится за пределами виртуальной сети кластера, создайте конечную точку службы хранения в виртуальной сети. Конечная точка не использует IP-адрес.

У вас есть возможность найти сетевые ресурсы и хранилище BLOB-объектов (если используется) в разных группах ресурсов кластера.

## <a name="vfxt-node-size"></a>размер узла Вфкст

Виртуальные машины, выступающие в качестве узлов кластера, определяют пропускную способность запросов и емкость хранилища кэша. <!-- The instance type offered has been chosen for its memory, processor, and local storage characteristics. You can choose from two instance types, with different memory, processor, and local storage characteristics. -->

Каждый узел vFXT будет идентичен. То есть если вы создаете кластер с тремя узлами, вы получите три виртуальные машины одинакового типа и размера.

| Тип экземпляра | Число виртуальных ЦП | Память  | Локальное хранилище на SSD-накопителях  | Макс. количество дисков данных | Пропускная способность диска без кэширования | Сетевая карта (количество) |
| --- | --- | --- | --- | --- | --- | --- |
| Standard_E32s_v3 | 32  | 256 Гиб | 512 ГБ  | 32 | 51 200 операций ввода-вывода в секунду <br/> 768 Мбит/с | 16 000 Мбит/с (8)  |

Кэш диска на каждый узел настраивается и может быть размером от 1000 до 8000 ГБ. Размер кэша, рекомендуемый для Standard_E32s_v3 узлов, составляет 4 ТБ на узел.

Дополнительные сведения об этих виртуальных машинах см. в документации по Microsoft Azure.

* [Размеры виртуальных машин, оптимизированных для операций в памяти](https://docs.microsoft.com/azure/virtual-machines/windows/sizes-memory)

## <a name="account-quota"></a>Квота учетной записи

Убедитесь, что в вашей подписке достаточно ресурсов для запуска кластера Avere vFXT, а также используемых вычислительных или клиентских систем. Дополнительные сведения см. в разделе [Quota for the vFXT cluster](avere-vfxt-prereqs.md#quota-for-the-vfxt-cluster) (Квота для кластера vFXT).

## <a name="back-end-data-storage"></a>Серверное хранилище данных

Серверные системы хранения данных предоставляют файлы в кэш кластера, а также получают измененные данные из кэша. Определите, где будет храниться ваш рабочий набор долгосрочно: в новом контейнере больших двоичных объектов или в имеющейся облачной или аппаратной системе хранения. Эти серверные системы хранения называются *основными фильтрами определенными*.

### <a name="hardware-core-filers"></a>Оборудование Core фильтрами определенными

После создания кластера добавьте системы хранения оборудования в кластер Вфкст. Вы можете использовать любую существующую локальную аппаратную систему, включая локальные системы, при условии, что система хранения данных доступна из подсети кластера.

Подробные инструкции о том, как добавить существующую систему хранения в кластер vFXT Avere, см. в разделе [Configure storage](avere-vfxt-add-storage.md) (Настройка контейнера).

### <a name="cloud-core-filers"></a>Облачное ядро фильтрами определенными

Авере Вфкст для системы Azure может использовать пустые контейнеры больших двоичных объектов для серверного хранилища. Контейнеры должны быть пустыми при добавлении в кластер. система Вфкст должна иметь возможность управлять хранилищем объектов без необходимости сохранять существующие данные.

> [!TIP]
> Если вы хотите использовать хранилище BLOB-объектов Azure для серверной части, создайте новый контейнер в рамках создания кластера Вфкст. Шаблон создания кластера может создать и настроить новый контейнер больших двоичных объектов, чтобы он был готов к использованию, как только кластер станет доступен. Добавление контейнера будет более сложным.
>
> Дополнительные сведения см. в разделе о [создании Avere vFXT для Azure](avere-vfxt-deploy.md#create-the-avere-vfxt-for-azure).

После добавления пустого контейнера хранилища BLOB-объектов в качестве основного фильтр можно скопировать данные в него через кластер. Использование параллельного многопоточного механизма копирования. Чтобы узнать, как эффективно копировать данные в новый контейнер кластера с использованием клиентских компьютеров и кэша vFXT Avere, обратитесь к статье [Moving data to the vFXT cluster - Parallel data ingest](avere-vfxt-data-ingest.md) (Перемещение данных в кластер vFXT. Прием параллельных данных).

## <a name="cluster-access"></a>Доступ к кластеру

Кластер Avere vFXT для Azure расположен в частной подсети и не имеет общедоступного IP-адреса. Необходим некоторый способ доступа к частной подсети для администрирования кластера и клиентских подключений.

Варианты доступа включают в себя:

* Узел перехода — назначьте общедоступный IP-адрес отдельной виртуальной машине в частной сети и используйте его для создания туннеля SSL к узлам кластера.

  > [!TIP]
  > Если вы настроите общедоступный IP-адрес на контроллере кластера, контроллер можно использовать в качестве узла перехода. Дополнительные сведения см. в разделе [Контроллер кластера как узел перехода](#cluster-controller-as-jump-host).

* Виртуальная частная сеть (VPN) — настройте VPN типа "точка — сеть" или "сеть — сеть" для частной сети.

* Azure ExpressRoute — настройте частное подключение через партнер ExpressRoute.

Дополнительные сведения об этих параметрах см. в разделе [Обмен данными через Интернет](../virtual-network/virtual-networks-overview.md#communicate-with-the-internet).

### <a name="cluster-controller-as-jump-host"></a>Контроллер кластера как узел перехода

Контроллер кластера с настроенным общедоступным IP-адресом можно использовать в качестве узла перехода для подключения к кластеру Avere vFXT за пределами частной подсети. Однако, так как контроллер имеет права доступа для изменения узлов кластера, это создает небольшую угрозу безопасности.

Для повышения безопасности контроллера с общедоступным IP-адресом скрипт развертывания автоматически создает группу безопасности сети, которая разрешает входящий доступ только к порту 22. Вы можете дополнительно защитить систему, ограничив доступ по выбранному диапазону исходных IP-адресов, то есть разрешая подключения только от тех компьютеров, с которых вам нужен доступ к этому кластеру.

При создании кластера можно выбрать, следует ли создавать общедоступный IP-адрес на контроллере кластера.

* При создании **новой виртуальной сети** или **новой подсети**контроллеру кластера будет назначен **общедоступный IP-адрес**.
* При выборе существующей виртуальной сети и подсети контроллер кластера будет иметь только **частные** IP-адреса.

## <a name="vm-access-roles"></a>Роли доступа к виртуальной машине

Azure использует [Управление доступом на основе ролей](../role-based-access-control/index.yml) (RBAC) для авторизации виртуальных машин кластера для выполнения определенных задач. Например, контроллеру кластера требуется авторизация для создания и настройки виртуальных машин узла кластера. Узлы кластера должны иметь возможность назначать или переназначениять IP-адреса другим узлам кластера.

Для Авере Вфкст для виртуальных машин Azure используются две встроенные роли Azure:

* Контроллер кластера использует встроенный [участник роли авере](../role-based-access-control/built-in-roles.md#avere-contributor).
* Узлы кластера используют встроенный [оператор авере](../role-based-access-control/built-in-roles.md#avere-operator) роли

Если необходимо настроить роли доступа для компонентов Авере Вфкст, необходимо определить собственную роль и назначить ее виртуальным машинам во время их создания. Вы не можете использовать шаблон развертывания в Azure Marketplace. Обратитесь в службу поддержки пользователей Майкрософт, открыв билет в портал Azure, как описано в разделе [Получение справки по системе](avere-vfxt-open-ticket.md).

## <a name="next-step-understand-the-deployment-process"></a>Следующий шаг: ознакомление с процессом развертывания

[Общие сведения о развертывании](avere-vfxt-deploy-overview.md) дают представление о шагах, необходимых для создания авере вфкст для системы Azure и подготовки ее к работе с данными.
