---
title: Планирование системы Avere vFXT — Azure
description: Здесь описывается планирование, которое нужно выполнить перед развертыванием системы Avere vFXT для Azure
author: ekpgh
ms.service: avere-vfxt
ms.topic: conceptual
ms.date: 01/21/2020
ms.author: rohogue
ms.openlocfilehash: cd0c74c8aa40b3e96716ef37aa27b08b5f6aece1
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/27/2020
ms.locfileid: "76547546"
---
# <a name="plan-your-avere-vfxt-system"></a>Планирование системы Avere vFXT

В этой статье объясняется, как спланировать новый кластер Avere vFXT для кластера Azure, который расположен и имеет соответствующий размер для ваших нужд.

Перед тем, как перейти на рынок Azure или создать любые vMs, подумайте следующие сведения:

* Как кластер будет взаимодействовать с другими ресурсами Azure?
* Где должны располагаться элементы кластера в частных сетях и подсетях?
* Какой тип бэк-энда хранения вы будете использовать, и как кластер будет получать к нему доступ?
* Насколько мощными должны быть кластерные узлы для поддержки рабочего процесса?

Ознакомьтесь с дополнительными сведениями, чтобы узнать больше.

## <a name="learn-the-components-of-the-system"></a>Изучить компоненты системы

При запуске планирования может быть полезно понять компоненты системы Avere vFXT для системы Azure.

* Кластерные узлы - кластер состоит из трех или более VM, настроенных как кластерные узлы. Больше узлов дают системе более высокую пропускную, а кэш больше.

* Кэш - Емкость кэша делится поровну между кластерными узлами. Установите размер кэша в узлах при создании кластера; размеры узлов добавляются, чтобы стать общим размером кэша.

* Кластерный контроллер - контроллер кластера является дополнительным VM, расположенным внутри той же подсети, что и кластерные узлы. Контроллер необходим для создания кластера и для текущих задач управления.

* Резервное хранилище - Данные, которые вы хотите кэшировать, длительное время хранятся в аппаратной системе хранения или контейнере Azure Blob. Можно добавить хранилище после создания avere vFXT для кластера Azure или при использовании хранилища Blob можно добавить и настроить контейнер при создании кластера.

* Клиенты - Клиентские машины, использующие кэшированные файлы, подключаются к кластеру, используя виртуальный путь файла вместо прямого доступа к системам хранения. (Подробнее читайте в [кластере Avere vFXT](avere-vfxt-mount-clients.md).)

## <a name="subscription-resource-group-and-network-infrastructure"></a>Подписка, ресурсная группа и сетевая инфраструктура

Определите, где будут находиться элементы развертывания Avere vFXT для Azure. На схеме ниже показано возможное упорядочение компонентов Avere vFXT для Azure:

![На схема отображается контроллер кластера и виртуальные машины кластера в одной подсети. Вокруг периметра подсети находится периметр виртуальной сети. Внутри виртуальной сети есть шестиугольник, представляющий конечную точку службы хранилища. Он связан с хранилищем BLOB-объектов за пределами виртуальной сети с помощью пунктирной стрелки.](media/avere-vfxt-components-option.png)

Следуйте этим рекомендациям при планировании сетевой инфраструктуры кластера Avere vFXT:

* Создайте новую подписку для каждого Avere vFXT для развертывания Azure. Управление всеми компонентами в этой подписке.

  Преимущества использования новой подписки для каждого развертывания включают в себя:
  * Упрощенное отслеживание расходов — просмотр и аудит всех расходов на ресурсы, инфраструктуру и вычислительные циклы в одной подписке.
  * Более простая очистка — возможность удалить всю подписку по завершении работы с проектом.
  * Удобное распределение квот ресурсов - Изолировать клиентов Avere vFXT и кластер в единую подписку для защиты других критически важных рабочих нагрузок от возможного регулирования ресурсов. Такое разделение предотвращает конфликт при привлечении большого числа клиентов для высокопроизводительного вычислительного рабочего процесса.

* Разместите клиентские системы вычисления близко к кластеру vFXT. Серверное хранилище может находиться на более дальнем расстоянии.  

* Найдите кластер vFXT и кластерный контроллер VM вместе - в частности, они должны быть:

  * В той же виртуальной сети
  * В той же группе ресурсов
  * Использование одной и той же учетной записи хранилища
  
  Шаблон создания кластера обрабатывает эту конфигурацию в большинстве ситуаций.

* Кластер должен располагаться в собственной подсети, чтобы избежать конфликтов IP-адресов с клиентами или другими вычислительными ресурсами.

* Используйте шаблон создания кластера для создания большинства необходимых инфраструктурных ресурсов для кластера, включая группы ресурсов, виртуальные сети, подсети и учетные записи хранения.

  Если вы хотите использовать ресурсы, которые уже существуют, убедитесь, что они отвечают требованиям в этой таблице.

  | Ресурс | Использовать существующие? | Требования |
  |----------|-----------|----------|
  | Группа ресурсов | Да, если пустой | Должно быть пусто|
  | Учетная запись хранения | **Да,** если соединение существующего контейнера Blob после создания кластера <br/>  **Нет,** если создание нового контейнера Blob при создании кластера | Существующий контейнер Blob должен быть пустым <br/> &nbsp; |
  | Виртуальная сеть | Да | При создании нового контейнера Azure Blob необходимо включить конечную точку службы хранения данных |
  | Подсеть | Да | Не удается сдержать другие ресурсы |

## <a name="ip-address-requirements"></a>Требования к IP-адресам

Убедитесь, что у кластера подсети есть достаточно большой диапазон IP-адресов для поддержки кластера.

Кластер Avere vFXT использует следующие IP-адреса:

* IP-адрес для управления одним кластером. Этот адрес может перемещаться от узла к узлам в кластере по мере необходимости, чтобы он всегда был доступен. Используйте этот адрес для подключения к инструменту конфигурации панели управления Avere.
* Для каждого узла кластера требуется:
  * По крайней мере один IP-адрес, ориентированный на клиента. (Все адреса, обращенные к клиентам, управляются *vserver*кластера, который может перемещать IP-адреса между узлами по мере необходимости.)
  * Один IP-адрес для взаимодействия с кластером.
  * Один IP-адрес экземпляра (назначенный виртуальной машине).

Если вы используете хранилище Azure Blob, это также может потребовать IP-адресов из виртуальной сети кластера:  

* Учетной записи хранилища BLOB-объектов Azure нужно по крайней мере пять IP-адресов. Имейте это требование в виду, если вы обнаружите хранилище Blob в той же виртуальной сети, что и ваш кластер.
* Если вы используете хранилище Azure Blob, находящиеся за пределами виртуальной сети кластера, создайте конечную точку службы хранения данных внутри виртуальной сети. Конечная точка не использует IP-адрес.

У вас есть возможность найти сетевые ресурсы и хранилище BLOB-объектов (если используется) в разных группах ресурсов кластера.

## <a name="vfxt-node-size"></a>vFXT размер узла

Виртуальные машины, выступающие в качестве узлов кластера, определяют пропускную способность запросов и емкость хранилища кэша. <!-- The instance type offered has been chosen for its memory, processor, and local storage characteristics. You can choose from two instance types, with different memory, processor, and local storage characteristics. -->

Каждый узел vFXT будет идентичен. То есть если вы создаете кластер с тремя узлами, вы получите три виртуальные машины одинакового типа и размера.

| Тип экземпляра | Число виртуальных ЦП | Память  | Локальное хранилище на SSD-накопителях  | Максимальное число дисков данных | Пропускная способность диска без кэширования | Сетевая карта (количество) |
| --- | --- | --- | --- | --- | --- | --- |
| Standard_E32s_v3 | 32  | 256 Гиб | 512 ГБ  | 32 | 51 200 операций ввода-вывода в секунду <br/> 768 Мбит/с | 16 000 Мбит/с (8)  |

Кэш диска на каждый узел настраивается и может быть размером от 1000 до 8000 ГБ. 4 ТБ на узла является рекомендуемым размером кэша для Standard_E32s_v3 узлов.

Для получения дополнительной информации об этих виртуальных свиах прочитайте документацию Microsoft Azure: [Оптимизированные размеры виртуальных машин](https://docs.microsoft.com/azure/virtual-machines/windows/sizes-memory)

## <a name="account-quota"></a>Квота учетной записи

Убедитесь, что в вашей подписке достаточно ресурсов для запуска кластера Avere vFXT, а также используемых вычислительных или клиентских систем. Дополнительные сведения см. в разделе [Quota for the vFXT cluster](avere-vfxt-prereqs.md#quota-for-the-vfxt-cluster) (Квота для кластера vFXT).

## <a name="back-end-data-storage"></a>Серверное хранилище данных

Системы резервного хранения как поставляют файлы в кэш кластера, так и получают измененные данные из кэша. Решите, будет ли ваш рабочий набор храниться в долгосрочной перспективе в новом контейнере Blob или в существующей системе хранения данных (облако или аппаратное обеспечение). Эти системы хранения бэк-энда называются *основными регистраторами.*

### <a name="hardware-core-filers"></a>Аппаратные ядро файлеров

Добавление систем хранения оборудования в кластер vFXT после создания кластера. Вы можете использовать различные популярные аппаратные системы, в том числе на местах, до тех пор, как система хранения может быть достигнута из подсети кластера.

Подробные инструкции о том, как добавить существующую систему хранения в кластер vFXT Avere, см. в разделе [Configure storage](avere-vfxt-add-storage.md) (Настройка контейнера).

### <a name="cloud-core-filers"></a>Файлеры облачных ядер

Система Avere vFXT для Azure может использовать пустые контейнеры Blob для хранения бэк-энда. Контейнеры должны быть пустыми при добавлении в кластер - система vFXT должна быть в состоянии управлять своим хранилищем объектов без сохранения существующих данных.

> [!TIP]
> Если требуется использовать хранилище Azure Blob для задней части, создайте новый контейнер в рамках создания кластера vFXT. Шаблон создания кластера может создать и настроить новый контейнер Blob таким образом, чтобы он был готов к использованию, как только кластер будет доступен. Добавление контейнера позже является более сложным.
>
> Дополнительные сведения см. в разделе о [создании Avere vFXT для Azure](avere-vfxt-deploy.md#create-the-avere-vfxt-for-azure).

После добавления пустого контейнера для хранения Blob в качестве основного файлера можно скопировать данные через кластер. Используйте параллельный многопоточный механизм копирования. Чтобы узнать, как эффективно копировать данные в новый контейнер кластера с использованием клиентских компьютеров и кэша vFXT Avere, обратитесь к статье [Moving data to the vFXT cluster - Parallel data ingest](avere-vfxt-data-ingest.md) (Перемещение данных в кластер vFXT. Прием параллельных данных).

## <a name="cluster-access"></a>Доступ к кластеру

Кластер Avere vFXT для Azure расположен в частной подсети и не имеет общедоступного IP-адреса. Вы должны иметь какой-то доступ к частной подсети для управления кластером и клиентских соединений.

Варианты доступа включают в себя:

* Узел перехода — назначьте общедоступный IP-адрес отдельной виртуальной машине в частной сети и используйте его для создания туннеля SSL к узлам кластера.

  > [!TIP]
  > Если вы настроите общедоступный IP-адрес на контроллере кластера, контроллер можно использовать в качестве узла перехода. Дополнительные сведения см. в разделе [Контроллер кластера как узел перехода](#cluster-controller-as-jump-host).

* Виртуальная частная сеть (VPN) - Настройте VPN от точки к сайту или от места к сайту между вашей частной сетью в Azure и корпоративными сетями.

* Azure ExpressRoute — настройте частное подключение через партнер ExpressRoute.

Дополнительные сведения об этих параметрах см. в разделе [Обмен данными через Интернет](../virtual-network/virtual-networks-overview.md#communicate-with-the-internet).

### <a name="cluster-controller-as-jump-host"></a>Контроллер кластера как узел перехода

Контроллер кластера с настроенным общедоступным IP-адресом можно использовать в качестве узла перехода для подключения к кластеру Avere vFXT за пределами частной подсети. Однако, так как контроллер имеет права доступа для изменения узлов кластера, это создает небольшую угрозу безопасности.

Для повышения безопасности контроллера с общедоступным IP-адресом скрипт развертывания автоматически создает группу сетевой безопасности, которая ограничивает входящий доступ только к порту 22. Вы можете дополнительно защитить систему, ограничив доступ по выбранному диапазону исходных IP-адресов, то есть разрешая подключения только от тех компьютеров, с которых вам нужен доступ к этому кластеру.

При создании кластера можно выбрать, следует ли создавать общедоступный IP-адрес на контроллере кластера.

* При создании **новой виртуальной сети** или **новой подсети**контроллеру кластера будет присвоен **общедоступный** IP-адрес.
* При выборе существующей виртуальной сети и подсети контроллер кластера будет иметь только **частные** IP-адреса.

## <a name="vm-access-roles"></a>Роли доступа VM

Azure использует [элемент управления доступом на основе ролей](../role-based-access-control/index.yml) (RBAC) для разрешения кластерных ВМ выполнять определенные задачи. Например, контроллеркластера требует сяреутверждения для создания и настройки кластерных узлов VM. Кластерные узлы должны быть в состоянии присвоить или переназначить IP-адреса другим кластерным узлам.

Для виртуальных машин Avere vFXT используются две встроенные роли Azure:

* Кластерный контроллер использует встроенную роль [Avere Contributor.](../role-based-access-control/built-in-roles.md#avere-contributor)
* Кластерные узлы используют встроенную роль [Оператора Avere.](../role-based-access-control/built-in-roles.md#avere-operator)

Если вам нужно настроить роли доступа для компонентов Avere vFXT, необходимо определить свою собственную роль, а затем назначить ее в том время, когда они создаются. Шаблон развертывания не используется в Azure Marketplace. Проконсультируйтесь с службой поддержки и поддержки корпорации Майкрософт, открыв билет на портале Azure, как описано в [справке с вашей системой.](avere-vfxt-open-ticket.md)

## <a name="next-steps"></a>Дальнейшие действия

[Обзор развертывания](avere-vfxt-deploy-overview.md) дает представление о шагах, необходимых для создания системы Avere vFXT для системы Azure и подготовке к обработке данных.
