---
title: Создание, изменение или удаление общедоступного IP-адреса Azure | Документация Майкрософт
description: Сведения о создании, изменении и удалении общедоступного IP-адреса.
services: virtual-network
documentationcenter: na
author: KumudD
manager: twooley
editor: ''
tags: azure-resource-manager
ms.assetid: bb71abaf-b2d9-4147-b607-38067a10caf6
ms.service: virtual-network
ms.devlang: NA
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 08/06/2019
ms.author: kumud
ms.openlocfilehash: 5e3307afab30848560b21d4a0f0069541889b03e
ms.sourcegitcommit: 4c831e768bb43e232de9738b363063590faa0472
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/23/2019
ms.locfileid: "74420161"
---
# <a name="create-change-or-delete-a-public-ip-address"></a>Создание, изменение и удаление общедоступного IP-адреса

Общие сведения об общедоступном IP-адресе, а также о его создании, изменении и удалении. Общедоступный IP-адрес — это ресурс с собственными настраиваемыми параметрами. Назначение общедоступного IP-адреса ресурсу Azure, который поддерживает общие IP-адреса, позволяет следующее.
- Входящий трафик из Интернета к ресурсам, таким как виртуальные машины Azure, шлюзы приложений Azure, подсистемы балансировки нагрузки Azure, VPN-шлюзы Azure и другие. Можно по-прежнему взаимодействовать с некоторыми ресурсами из Интернета, такими как виртуальные машины, если виртуальная машина не имеет назначенного ей общего IP-адреса. Пока виртуальная машина является частью пула внутренней подсистемы балансировки нагрузки, то взаимодействовать невозможно, потому что подсистема балансировки нагрузки имеет назначенный общедоступный IP-адрес. Чтобы определить, можно ли ресурсу для определенной службы Azure назначить общедоступный IP-адрес или он может обращаться через общедоступный IP-адрес другого ресурса Azure, см. документацию для службы.
- Исходящие подключения к Интернету используют предсказуемый IP-адрес. Например, виртуальная машина может отправлять данные в Интернет, не имея назначенного общедоступного IP-адреса. Ее адресом по умолчанию будет сетевой адрес, преобразуемый Azure в непредсказуемый общедоступный адрес. Назначение ресурсу общедоступного IP-адреса позволяет узнать, какой IP-адрес используется для исходящих соединений. Хоть адрес и предсказуемый, он может измениться в зависимости от выбранного метода назначения. Дополнительные сведения см. в разделе [Создание общедоступного IP-адреса](#create-a-public-ip-address). Дополнительную информацию об исходящих подключениях ресурсов Azure см. в разделе [Основные сведения об исходящих подключениях](../load-balancer/load-balancer-outbound-connections.md?toc=%2fazure%2fvirtual-network%2ftoc.json).

## <a name="before-you-begin"></a>Перед началом работы

[!INCLUDE [updated-for-az](../../includes/updated-for-az.md)]

Перед выполнением действий, описанных в любом разделе этой статьи, выполните следующие задачи.

- Если у вас нет учетной записи Azure, зарегистрируйтесь для получения [бесплатной пробной учетной записи](https://azure.microsoft.com/free).
- При использовании портала перейдите по адресу https://portal.azure.com и войдите с использованием своей учетной записи Azure.
- При использовании команд PowerShell для работы с этой статьей выполняйте их в [Azure Cloud Shell](https://shell.azure.com/powershell) или в PowerShell на своем компьютере. Azure Cloud Shell — это бесплатная интерактивная оболочка, с помощью которой можно выполнять действия, описанные в этой статье. Она включает предварительно установленные общие инструменты Azure и настроена для использования с вашей учетной записью. Для работы с этим руководством требуется модуль Azure PowerShell версии 1.0.0 и выше. Выполните командлет `Get-Module -ListAvailable Az`, чтобы узнать установленную версию. Если вам необходимо выполнить обновление, ознакомьтесь со статьей, посвященной [установке модуля Azure PowerShell](/powershell/azure/install-az-ps). Если модуль PowerShell запущен локально, необходимо также выполнить командлет `Connect-AzAccount`, чтобы создать подключение к Azure.
- При использовании команд интерфейса командной строки Azure (CLI) для работы с этой статьей выполняйте их в [Azure Cloud Shell](https://shell.azure.com/bash) или в интерфейсе командной строки на своем компьютере. Для этого руководства требуется Azure CLI 2.0.31 или более поздней версии. Выполните командлет `az --version`, чтобы узнать установленную версию. Если вам необходимо выполнить установку или обновление, см. статью [Установка Azure CLI 2.0](/cli/azure/install-azure-cli). Если Azure CLI запущен локально, необходимо также выполнить командлет `az login`, чтобы создать подключение к Azure.

Учетной записи, в которую вы входите или с помощью которой подключаетесь к Azure, должна быть назначена роль [Участник сетей](../role-based-access-control/built-in-roles.md?toc=%2fazure%2fvirtual-network%2ftoc.json#network-contributor) или [пользовательская роль](../role-based-access-control/custom-roles.md?toc=%2fazure%2fvirtual-network%2ftoc.json), которой назначены соответствующие действия, перечисленные в таблице [Разрешения](#permissions).

За использование общедоступных IP-адресов взимается номинальная плата. Сведения о расценках см. на странице с [ценами на IP-адреса](https://azure.microsoft.com/pricing/details/ip-addresses).

## <a name="create-a-public-ip-address"></a>Создание общедоступного IP-адреса

1. На **домашней странице** или в меню портала Azure выберите команду **Создать ресурс**.
2. В поле *Поиск в Marketplace* введите *общедоступный IP-адрес*. Когда в результатах поиска появится пункт **Общедоступный IP-адрес**, щелкните его.
3. В колонке **Общедоступный IP-адрес** щелкните **Создать**.
4. Введите или выберите значения для перечисленных ниже параметров в разделе **Создать общедоступный IP-адрес**, а затем щелкните **Создать**.

   |Настройка|Обязательный?|Подробная информация|
   |---|---|---|
   |имя|Yes|Имя должно быть уникальным в пределах выбранной группы ресурсов.|
   |Sku|Yes|До появления номеров SKU все общедоступные IP-адреса имеют номер SKU категории **Базовый**. Номер SKU нельзя изменить после создания общедоступного IP-адреса. Изолированные виртуальные машины, виртуальные машины в группе доступности или масштабируемые наборы виртуальных машин могут использовать номера SKU категории "Базовый" или "Стандартный". Смешивание номеров SKU между виртуальными машинами в группах доступности или масштабируемыми наборами или отдельными виртуальными машинами не допускается. Номер SKU **Базовый**. При создании общедоступного IP-адреса в регионе, который поддерживает зоны доступности, параметр **Availability zone** (Зона доступности) принимает значение *Нет* по умолчанию. Базовые общедоступные IP-адреса не поддерживают зоны доступности. Номер SKU **Стандартный**. Общедоступный IP-адрес стандартного номера SKU может быть связан с виртуальной машиной или интерфейсной частью подсистемы балансировки нагрузки. При создании общедоступного IP-адреса в регионе, который поддерживает зоны доступности, параметр **Availability zone** (Зона доступности) принимает значение *Избыточное между зонами* по умолчанию. Дополнительные сведения о зонах доступности см. в параметре **Зона доступности**. Стандартный номер SKU необходим при связывании адреса с подсистемой балансировки нагрузки категории "Стандартный". Дополнительные сведения о подсистемах балансировки нагрузки см. в статье [Azure Load Balancer Standard overview (Preview)](../load-balancer/load-balancer-standard-overview.md?toc=%2fazure%2fvirtual-network%2ftoc.json) (Обзор Azure Load Balancer категории "Стандартный" (предварительная версия)). Если вы назначаете общедоступный IP-адрес с номером SKU "Стандартный" сетевому интерфейсу виртуальной машины, необходимо явно разрешить предполагаемый трафик в [группе безопасности сети](security-overview.md#network-security-groups). Обмен данными с ресурсом будет невозможен, пока вы не создадите группу безопасности сети, не свяжете ее с ресурсом и не разрешите соответствующий трафик.|
   |Версия IP-адреса|Yes| Выберите IPv4 или IPv6. Общедоступные IPv4-адреса можно назначить нескольким ресурсам Azure, а общедоступный IPv6-адрес — только балансировщику нагрузки с доступом к Интернету. Балансировщик нагрузки может выполнять балансировку нагрузки трафика IPv6 на виртуальных машинах Azure. Дополнительные сведения о балансировке нагрузки IPv6-трафика к виртуальным машинам см. в статье [Общие сведения о поддержке IPv6 для Azure Load Balancer](../load-balancer/load-balancer-ipv6-overview.md?toc=%2fazure%2fvirtual-network%2ftoc.json). При выборе **Standard SKU** (Номер SKU "Стандартный") у вас нет возможности выбрать *IPv6*. При использовании **Standard SKU** (Номер SKU "Стандартный") можно создать только IPv4-адрес.|
   |Назначение IP-адресов|Yes|**Динамическое** — динамические адреса назначаются, только если общедоступный IP-адрес связан с ресурсом Azure, который запускается в первый раз. Динамические адреса, назначенные ресурсу (например, виртуальной машине), могут измениться после остановки (освобождения) и последующего перезапуска этой виртуальной машины. Если виртуальная машина перезагружается или остановлена (не освобождается), адрес не изменится. Динамические адреса освобождаются, когда удаляется связь ресурса общедоступного IP-адреса и связанного с ним ресурса. **Статическое** — статические адреса назначаются при создании общедоступного IP-адреса. Статические адреса не освобождаются, пока не будет удален ресурс общедоступного IP-адреса. Если адрес не связан с ресурсом, его метод назначения можно изменить после создания адреса. Если адрес связан с ресурсом, то его метод назначения невозможно изменить. При выборе *IPv6* в качестве **версии IP** метод назначения — *динамический*. При выборе *Стандартный* для **номера SKU** метод назначения — *статический*.|
   |Время ожидания простоя (в минутах)|Нет|Время (в минутах), в течение которого подключение TCP или HTTP остается открытым без привязки к клиентам при отправке запросов для проверки активности. При выборе IPv6 в качестве **версии IP** это значение невозможно изменить. |
   |Метка имени DNS|Нет|Должна быть уникальной в пределах расположения Azure, в котором создается имя (для всех подписок и клиентов). Azure автоматически регистрирует имя и IP-адрес в своей DNS (вы можете подключаться к ресурсу, используя это имя). Azure добавляет подсеть по умолчанию, например *location.cloudapp.azure.com* (где location — это выбранное вами расположение) к имени, которое вы предоставили, для создания полного имени DNS. Если вы решили создать обе версии адресов, им назначается одинаковое имя DNS. Служба Azure DNS по умолчанию содержит обе записи имен IPv4 (A) и IPv6 (AAAA) и отвечает на поиск имени DNS, используя обе записи. Клиент выбирает, с каким адресом (IPv4 или IPv6) взаимодействовать. Вместо или в дополнение к использованию метки DNS-имени с суффиксом по умолчанию можно использовать службу Azure DNS для настройки DNS-имени с пользовательским суффиксом, которое преобразуется в общедоступный IP-адрес. Дополнительные сведения см. в разделе [Общедоступный IP-адрес](../dns/dns-custom-domain.md?toc=%2fazure%2fvirtual-network%2ftoc.json#public-ip-address).|
   |"Create an IPv6 (or IPv4) address" (Создание IPv6- или IPv4-адреса)|Нет| То, какой из адресов отображается (IPv6 и IPv4) зависит от выбора **версии IP**. Например, при выборе **IPv4** в качестве **версии IP** здесь отображается **IPv6**. При выборе *Стандартный* для **номера SKU** отсутствует возможность создания IPv6-адреса.
   |Имя (отображается, только если установлен флажок **Create an IPv6 (or IPv4) address** (Создание IPv6- или IPv4-адреса)).|Да, если установлен флажок **Create an IPv6 (or IPv4)** (Создание IPv6 или IPv4).|Имя должно отличаться от того, что вы ввели для первого **имени** в этом списке. Если вы решили создать IPv4- и IPv6-адрес, портал создаст два отдельных ресурса общедоступных IP-адресов, каждому из которых назначена своя версия.|
   |Назначение IP-адресов (отображается, только если установлен флажок **Create an IPv6 (or IPv4) address** (Создание IPv6- или IPv4-адреса))|Да, если установлен флажок **Create an IPv6 (or IPv4)** (Создание IPv6 или IPv4).|Если отображается флажок **Create an IPv4 address** (Создание IPv4-адреса), можно выбрать метод назначения. Если отображается флажок **Create an IPv6 address** (Создание IPv6-адреса), невозможно выбрать метод назначения, так как он должен быть **динамическим**.|
   |подписку|Yes|Ресурс в пределах одной и той же [подписки](../azure-glossary-cloud-terminology.md?toc=%2fazure%2fvirtual-network%2ftoc.json#subscription), с которым будет связан общедоступный IP-адрес.|
   |Группа ресурсов|Yes|Ресурс в пределах одной или разных [групп ресурсов](../azure-glossary-cloud-terminology.md?toc=%2fazure%2fvirtual-network%2ftoc.json#resource-group), с которым будет связан общедоступный IP-адрес.|
   |Место проведения|Yes|Ресурс в пределах одного и того же [расположения](https://azure.microsoft.com/regions), с которым будет связан общедоступный IP-адрес.|
   |Зона доступности| Нет | Этот параметр отображается только в том случае, если выбрано поддерживаемое расположение. Список поддерживаемых расположений см. в статье [Общие сведения о зонах доступности в Azure (предварительная версия)](../availability-zones/az-overview.md?toc=%2fazure%2fvirtual-network%2ftoc.json). При выборе номера SKU **Базовый**, значение *Нет* будет выбрано автоматически. Если нужно гарантировать наличие определенной зоны, можно выбрать ее. Ни один вариант нельзя считать избыточным между зонами. При выборе номера SKU **Стандартный** автоматически выбирается избыточность между зонами, благодаря чему путь к данным становится устойчивым к сбоям зоны. Если нужно обеспечить определенную зону, неустойчивую к сбоям зоны, можно выбрать ее.

**Команды**

Хотя на портале предоставляется возможность создания двух ресурсов общедоступных IP-адресов (IPv4 и IPv6), следующие команды PowerShell и интерфейса командной строки создают один ресурс с адресом для одной или другой версии IP. Если требуется два ресурса общедоступных IP-адресов (по одному на каждую версию IP), необходимо выполнить команду дважды, указав разные имена и версии для ресурсов общедоступных IP-адресов.

|Средство|Команда|
|---|---|
|Интерфейс командной строки|[az network public-ip create](/cli/azure/network/public-ip#az-network-public-ip-create)|
|PowerShell|[New-AzPublicIpAddress](/powershell/module/az.network/new-azpublicipaddress)|

## <a name="view-change-settings-for-or-delete-a-public-ip-address"></a>Просмотр, изменение параметров или удаление общедоступного IP-адреса

1. В верхней части портала Azure в поле с текстом *Поиск ресурсов* введите *общедоступный IP-адрес*. Когда в результатах поиска появится пункт **Общедоступные IP-адреса**, щелкните его.
2. Выберите из списка имя общедоступного IP-адреса для просмотра, изменения параметров или удаления.
3. Выполните одно из следующих действий (в зависимости от того, нужно ли просмотреть, удалить или изменить этот общедоступный IP-адрес).
   - **Просмотр**. В разделе **Обзор** отображаются основные параметры общедоступного IP-адреса, например сетевой интерфейс, с которым он связан (если адрес связан с сетевым интерфейсом). На портале не отображается версия адреса (IPv4 или IPv6). Чтобы просмотреть сведения о версии, выполните команду PowerShell или интерфейса командной строки для просмотра общедоступного IP-адреса. Если версия IP-адреса IPv6, назначенный адрес не отображается на портале, в PowerShell или интерфейсе командной строки.
   - **Удаление**. Чтобы удалить общедоступный IP-адрес, в разделе **Обзор** щелкните **Удалить**. Если адрес связан с IP-конфигурацией, удалить его не получится. В таком случае щелкните **Отменить связь**, чтобы разорвать связь с конфигурацией IP.
   - **Изменение**. Выберите **Конфигурация**. Измените параметры, используя сведения, описанные в шаге 4 в разделе [Создание общедоступного IP-адреса](#create-a-public-ip-address). Чтобы изменить назначение IPv4-адреса со статического на динамическое, необходимо сначала разорвать связь между общедоступным IPv4-адресом и IP-конфигурацией. Затем можно изменить способ назначения на динамическое и щелкнуть **Связать**, чтобы связать IP-адрес с той же или другой конфигурацией IP либо оставить его несвязанным. Чтобы удалить связь с общедоступным IP-адресом, в разделе **Обзор** щелкните **Отменить связь**.

   >[!WARNING]
   >Изменив способ назначения со статического на динамический, вы потеряете IP-адрес, который был назначен общедоступному IP-адресу. В Azure общедоступные DNS-серверы поддерживают сопоставление между статическими или динамическими адресами и метками (определенными) имени DNS. При этом динамический IP-адрес можно изменить при запуске виртуальной машины, которая была остановлена (освобождена). Чтобы предотвратить изменение адреса, назначьте статический IP-адрес.

**Команды**

|Средство|Команда|
|---|---|
|Интерфейс командной строки|Команда [az network public-ip list](/cli/azure/network/public-ip#az-network-public-ip-list) выводит список общедоступных IP-адресов, [az network public-ip show](/cli/azure/network/public-ip#az-network-public-ip-show) — отображает параметры, [az network public-ip update](/cli/azure/network/public-ip#az-network-public-ip-update) — обновляет IP-адрес, а [az network public-ip delete](/cli/azure/network/public-ip#az-network-public-ip-delete) — удаляет IP-адрес.|
|PowerShell|[Get-азпублиЦипаддресс](/powershell/module/az.network/get-azpublicipaddress) для получения объекта общедоступного IP-адреса и просмотра его параметров, [Set-азпублиЦипаддресс](/powershell/module/az.network/set-azpublicipaddress) для обновления параметров; [Remove-азпублиЦипаддресс](/powershell/module/az.network/remove-azpublicipaddress) to delete|

## <a name="assign-a-public-ip-address"></a>Назначение общедоступного IP-адреса

Узнайте, как назначать общедоступные IP-адреса следующим ресурсам:

- виртуальной машине [Windows](../virtual-machines/virtual-machines-windows-hero-tutorial.md?toc=%2fazure%2fvirtual-network%2ftoc.json) или [Linux](../virtual-machines/linux/quick-create-portal.md?toc=%2fazure%2fvirtual-network%2ftoc.json) при создании или [существующей виртуальной машине](virtual-network-network-interface-addresses.md#add-ip-addresses);
- [службе Load Balancer, доступной в Интернете](../load-balancer/load-balancer-get-started-internet-portal.md?toc=%2fazure%2fvirtual-network%2ftoc.json);
- [Шлюз приложений Azure](../application-gateway/application-gateway-create-gateway-portal.md?toc=%2fazure%2fvirtual-network%2ftoc.json)
- [подключения типа "сеть — сеть" с помощью VPN-шлюза Azure](../vpn-gateway/vpn-gateway-howto-site-to-site-resource-manager-portal.md?toc=%2fazure%2fvirtual-network%2ftoc.json);
- [масштабируемого набора виртуальных машин Azure](../virtual-machine-scale-sets/virtual-machine-scale-sets-portal-create.md?toc=%2fazure%2fvirtual-network%2ftoc.json).

## <a name="permissions"></a>Разрешения

Для выполнения задач с общедоступными IP-адресами учетной записи должна быть назначена роль [Участник сетей](../role-based-access-control/built-in-roles.md?toc=%2fazure%2fvirtual-network%2ftoc.json#network-contributor) или [пользовательская](../role-based-access-control/custom-roles.md?toc=%2fazure%2fvirtual-network%2ftoc.json) роль, которой назначены соответствующие разрешения, перечисленные в таблице ниже.

| Действие                                                             | имя                                                           |
| ---------                                                          | -------------                                                  |
| Microsoft.Network/publicIPAddresses/read                           | Чтение общедоступного IP-адреса.                                          |
| Microsoft.Network/publicIPAddresses/write                          | Создание или обновление общедоступного IP-адреса.                           |
| Microsoft.Network/publicIPAddresses/delete                         | Удаление общедоступного IP-адреса                                     |
| Microsoft.Network/publicIPAddresses/join/action                    | Связывание общедоступного IP-адреса с ресурсом.                    |

## <a name="next-steps"></a>Дополнительная информация

- Создайте общедоступный IP-адрес с помощью примеров сценариев [PowerShell](powershell-samples.md) или [Azure CLI](cli-samples.md) либо на основе [шаблонов Azure Resource Manager](template-samples.md).
- Создайте и примените [политику Azure](policy-samples.md) для общедоступных IP-адресов.
