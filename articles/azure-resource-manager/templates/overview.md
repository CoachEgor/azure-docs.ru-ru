---
title: Обзор шаблонов
description: Описывает преимущества использования шаблонов Azure Resource Manager для развертывания ресурсов.
ms.topic: conceptual
ms.date: 03/25/2020
ms.openlocfilehash: 4570f5471ef6baf6f3f4a920be4d93c3f5a90438
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "80258130"
---
# <a name="what-are-arm-templates"></a>Что такое шаблоны ARM?

С переходом в облако многие команды внедрили методы гибкой разработки. Эти команды быстро итерировать. Им необходимо постоянно развертывать свои решения в облаке и знать, что их инфраструктура находится в надежном состоянии. По мере того, как инфраструктура стала частью итеративного процесса, исчезло разделение между операциями и разработками. Команды должны управлять инфраструктурой и кодом приложений с помощью единого процесса.

Чтобы решить эти задачи, можно автоматизировать развертывание и использовать практику инфраструктуры в качестве кода. В коде определяется инфраструктура, которая должна быть развернута. Код инфраструктуры становится частью вашего проекта. Так же, как код приложения, вы храните код инфраструктуры в исходном репозитории и версии его. Любой человек в вашей команде может запустить код и развернуть аналогичные среды.

Для реализации инфраструктуры в качестве кода для решений Azure используйте шаблоны Azure Resource Manager (ARM). Шаблон представляет собой файл JavaScript Object Notation (JSON), определяющий инфраструктуру и конфигурацию проекта. Шаблон использует декларативный синтаксис, который позволяет указать объект, который вы собираетесь развернуть. При этом, для развертывания объекта, не нужно писать последовательность команд. В шаблоне указаны ресурсы для развертывания и свойства для этих ресурсов.

## <a name="why-choose-arm-templates"></a>Почему стоит выбрать шаблоны ARM?

Если вы пытаетесь выбрать между использованием шаблонов ARM и одной из других инфраструктур в качестве кодовых служб, рассмотрите следующие преимущества использования шаблонов:

* **Декларативный синтаксис**: шаблоны ARM позволяют декларативно создавать и развертывать всю инфраструктуру Azure. Например, можно развернуть не только виртуальные машины, но и сетевую инфраструктуру, системы хранения данных и любые другие ресурсы, которые могут понадобиться.

* **Повторяющиеся результаты**: Повторно развертывайте инфраструктуру на протяжении всего жизненного цикла разработки и уверены, что ваши ресурсы развертываются последовательно. Шаблоны являются идемпотентными, что означает, что вы можете развернуть один и тот же шаблон много раз и получить одни и те же типы ресурсов в одном и том же состоянии. Можно разработать один шаблон, представляющий желаемое состояние, а не разрабатывать множество отдельных шаблонов для представления обновлений.

* **Оркестровка**: Вам не придется беспокоиться о сложностях операций заказа. Диспетчер ресурсов организует развертывание взаимозависимых ресурсов, поэтому они создаются в правильном порядке. По возможности диспетчер ресурсов развертывает ресурсы параллельно, чтобы развертывание заканчивался быстрее, чем серийные развертывания. Развертываете шаблон с помощью одной команды, а не с помощью нескольких императивных команд.

   ![Сравнение развертывания шаблонов](./media/overview/template-processing.png)

* **Встроенная проверка:** Ваш шаблон развертывается только после прохождения проверки. Диспетчер ресурсов проверяет шаблон перед запуском развертывания, чтобы убедиться, что развертывание будет успешным. Развертывание с меньшей вероятностью прекратится в полузаконченном состоянии.

* **Модульные файлы:** Вы можете разбить шаблоны на более мелкие многоразовые компоненты и связать их вместе во время развертывания. Вы также можете вложить один шаблон в другой шаблон.

* **Создайте любой ресурс Azure:** Вы можете сразу же использовать новые службы и функции Azure в шаблонах. Как только поставщик ресурсов вводит новые ресурсы, эти ресурсы можно развернуть через шаблоны. Вам не придется ждать, пока инструменты или модули будут обновлены, прежде чем использовать новые службы.

* **Отслеживаемые развертывания:** На портале Azure можно просмотреть историю развертывания и получить информацию о развертывании шаблонов. Можно увидеть развернутый шаблон, значения параметров, передаваемые, и любые значения вывода. Другая инфраструктура как службы кода не отслеживаются через портал.

   ![Журнал развертывания](./media/overview/deployment-history.png)

* **Политика как код**: [Политика Azure](../../governance/policy/overview.md) — это политика как кодовая платформа для автоматизации управления. Если вы используете политики Azure, исправление политики выполняется на ресурсах, не совместимых с несоблюдением, при развертывании шаблонов.

* **Планы развертывания:** Вы можете воспользоваться [преимуществами чертежей, предоставленных](../../governance/blueprints/overview.md) корпорацией Майкрософт для соответствия нормативным требованиям и стандартам соответствия требованиям. Эти чертежи включают в себя заранее построенные шаблоны для различных архитектур.

* **Интеграция CI/CD:** Вы можете интегрировать шаблоны в инструменты непрерывной интеграции и непрерывного развертывания (CI/CD), которые могут автоматизировать конвейеры выпуска для быстрого и надежного обновления приложений и инфраструктуры. Используя задачу шаблонов Azure DevOps и resource Manager, можно использовать конвейеры Azure для непрерывной сборки и развертывания проектов шаблонов ARM. Чтобы узнать больше, смотрите [проект VS с конвейерами](add-template-to-azure-pipelines.md) и [непрерывной интеграцией с Azure Pipelines.](template-tutorial-use-azure-pipelines.md)

* **Экспортируемый код**: Вы можете получить шаблон для существующей группы ресурсов, экспортируя текущее состояние группы ресурсов или просматривая шаблон, используемый для конкретного развертывания. Чтобы лучше понять синтаксис шаблона, изучите [экспортированный шаблон](export-template-portal.md).

* **Авторинговые инструменты**: Вы можете автор шаблонов с [Visual Studio Code](use-vs-code-to-create-template.md) и расширением шаблона. Вы получаете intellisense, выделение синтаксиса, помощь в строке и многие другие языковые функции. В дополнение к коду Visual Studio, вы также можете использовать [Visual Studio.](create-visual-studio-deployment-project.md)

## <a name="template-file"></a>Шаблон файла

В шаблоне можно писать [выражения шаблонов,](template-expressions.md) расширяющие возможности JSON. Эти выражения используют [функции,](template-functions.md) предоставляемые менеджером ресурсов.

Шаблон имеет следующие разделы:

* [Параметры](template-parameters.md) - Укажите значения во время развертывания, которые позволяют использовать один и тот же шаблон с различными средами.

* [Переменные](template-variables.md) - Определите значения, которые повторно используются в шаблонах. Они могут быть построены из параметров значения.

* [Функции, определяемые пользователем](template-user-defined-functions.md) - Создавайте индивидуальные функции, упрощающие шаблон.

* [Ресурсы](template-syntax.md#resources) - Укажите ресурсы для развертывания.

* [Выводы](template-outputs.md) - Значения возврата из развернутых ресурсов.

## <a name="template-deployment-process"></a>Процесс развертывания шаблонов

При развертывании шаблона диспетчер ресурсов преобразует шаблон в операции REST API. Например, Resource Manager получает шаблон со следующим определением ресурса:

```json
"resources": [
  {
    "type": "Microsoft.Storage/storageAccounts",
    "apiVersion": "2016-01-01",
    "name": "mystorageaccount",
    "location": "westus",
    "sku": {
      "name": "Standard_LRS"
    },
    "kind": "Storage",
    "properties": {}
  }
]
```

В таком случае Resource Manager преобразует определение в операцию REST API, которая отправляется поставщику ресурсов Microsoft.Storage:

```HTTP
PUT
https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Storage/storageAccounts/mystorageaccount?api-version=2016-01-01
REQUEST BODY
{
  "location": "westus",
  "sku": {
    "name": "Standard_LRS"
  },
  "kind": "Storage",
  "properties": {}
}
```

## <a name="template-design"></a>Дизайн шаблона

Вы выбираете определение шаблонов и групп ресурсов по своему усмотрению в зависимости от того, как нужно управлять решением. Например, трехуровневое приложение можно развернуть из одного шаблона в одной группе ресурсов.

![трехуровневый шаблон](./media/overview/3-tier-template.png)

Но определять всю инфраструктуру в одном шаблоне не нужно. Во многих случаях целесообразно разделять требования к развертыванию между несколькими наборами шаблонов, предназначенными для определенных задач. Эти шаблоны можно многократно использовать для различных решений. Чтобы развернуть конкретное решение, создайте главный шаблон, связывающий все необходимые шаблоны. Ниже показано, как развернуть трехуровневое решение из родительского шаблона, в который входят три вложенных шаблона.

![вложенный шаблон](./media/overview/nested-tiers-template.png)

Если в вашем случае у уровней отдельные жизненные циклы, эти уровни можно развернуть в отдельные группы ресурсов. Обратите внимание, что ресурсы по-прежнему могут быть связаны с ресурсами в других группах.

![шаблон уровня](./media/overview/tier-templates.png)

Дополнительные сведения см. в статье [Использование связанных шаблонов в Azure Resource Manager](linked-templates.md).

## <a name="next-steps"></a>Дальнейшие действия

* Для поэтапного учебника, который проведет вас через процесс создания шаблона, [см.](template-tutorial-create-first-template.md)
* Для получения информации о свойствах в файлах [шаблонов см.](template-syntax.md)
* Чтобы узнать об экспорте [Quickstart: Create and deploy ARM templates by using the Azure portal](quickstart-create-templates-use-the-portal.md)шаблонов, см.
