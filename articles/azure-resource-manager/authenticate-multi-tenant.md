---
title: Аутентификация в клиентах — Azure Resource Manager
description: В этой статье описывается, как Azure Resource Manager обрабатывает запросы на аутентификацию в разных клиентах.
services: azure-resource-manager
documentationcenter: ''
author: tfitzmac
ms.service: azure-resource-manager
ms.workload: multiple
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: conceptual
ms.date: 01/07/2019
ms.author: tomfitz
ms.openlocfilehash: 6554c05f40f580a6d7ae086e1d09834298f86621
ms.sourcegitcommit: 41ca82b5f95d2e07b0c7f9025b912daf0ab21909
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/13/2019
ms.locfileid: "60550773"
---
# <a name="authenticate-requests-across-tenants"></a>Запросы на аутентификацию в разных клиентах

При создании мультитенантного приложения может потребоваться обработка запросов на аутентификацию для ресурсов, которые находятся в разных клиентах. Распространенным является сценарий, когда виртуальная машина на одном клиенте должна присоединиться к виртуальной сети на другом клиенте. Azure Resource Manager предоставляет значение заголовка для хранения вспомогательных токенов, которые будут использоваться для аутентификации запросов в различных клиентах.

## <a name="header-values-for-authentication"></a>Значения заголовков для аутентификации

Запрос содержит следующие значения заголовков аутентификации.

| Имя заголовка | Описание | Пример значения |
| ----------- | ----------- | ------------ |
| Авторизация | Основной токен | Bearer &lt;основной_токен&gt; |
| x-ms-authorization-auxiliary | Вспомогательные токены | Bearer &lt;вспомогательный_токен1&gt;; EncryptedBearer &lt;вспомогательный_токен2&gt;; Bearer &lt;вспомогательный_токен3&gt; |

Дополнительный заголовок может содержать до трех вспомогательных токенов. 

В коде мультитенантного приложения получите токены аутентификации для других клиентов и сохраните их в дополнительных заголовках. Все токены должны быть от одного пользователя или одного приложения. Пользователь или приложение должно быть приглашено к другим клиентам в качестве гостя.

## <a name="processing-the-request"></a>Обработка запроса

Когда приложение отправляет запрос к Resource Manager, запрос выполняется под идентификатором из основного токена. Основной токен должен быть допустимым и действующим. Он должен поступать от клиента, который может управлять подпиской.

Если запрос ссылается на ресурс из другого клиента, Resource Manager проверяет вспомогательные токены, чтобы определить, может ли запрос быть обработан. Все вспомогательные токены в заголовке должны быть допустимыми и действующими. Если срок действия токена истек, Resource Manager возвращает код отклика 401. Ответ включает идентификатор клиента и идентификатор арендатора токена, который недопустим. Если дополнительный заголовок содержит допустимый для клиента токен, запрос между клиентами обрабатывается.

## <a name="next-steps"></a>Дальнейшие действия
* Дополнительные сведения об отправке запросов на аутентификацию с помощью API Azure Resource Manager см. в статье [Использование API аутентификации Resource Manager для доступа к подпискам](resource-manager-api-authentication.md).
* Дополнительные сведения о токенах см. в статье [Маркеры доступа в Azure Active Directory](/azure/active-directory/develop/access-tokens).
