---
title: Аутентификация в клиентах — Azure Resource Manager
description: В этой статье описывается, как Azure Resource Manager обрабатывает запросы на аутентификацию в разных клиентах.
author: tfitzmac
ms.service: azure-resource-manager
ms.topic: conceptual
ms.date: 10/11/2019
ms.author: tomfitz
ms.openlocfilehash: b85ed32ac333402caeca4901e4d91bbe4d1d112c
ms.sourcegitcommit: 8b44498b922f7d7d34e4de7189b3ad5a9ba1488b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/13/2019
ms.locfileid: "72300348"
---
# <a name="authenticate-requests-across-tenants"></a>Запросы на аутентификацию в разных клиентах

При создании мультитенантного приложения может потребоваться обработка запросов на аутентификацию для ресурсов, которые находятся в разных клиентах. Распространенным является сценарий, когда виртуальная машина на одном клиенте должна присоединиться к виртуальной сети на другом клиенте. Azure Resource Manager предоставляет значение заголовка для хранения вспомогательных токенов, которые будут использоваться для аутентификации запросов в различных клиентах.

## <a name="header-values-for-authentication"></a>Значения заголовков для аутентификации

Запрос содержит следующие значения заголовков аутентификации.

| Имя заголовка | Описание | Пример значения |
| ----------- | ----------- | ------------ |
| Authorization | Основной токен | Bearer &lt;основной_токен&gt; |
| x-ms-authorization-auxiliary | Вспомогательные токены | Bearer &lt;auxiliary-токен1 @ no__t-1, Енкриптедбеарер &lt;auxiliary-токен2 @ no__t-3, Bearer &lt;auxiliary-token3 @ no__t-5 |

Дополнительный заголовок может содержать до трех вспомогательных токенов. 

В коде мультитенантного приложения получите токены аутентификации для других клиентов и сохраните их в дополнительных заголовках. Все токены должны быть от одного пользователя или одного приложения. Пользователь или приложение должно быть приглашено к другим клиентам в качестве гостя.

## <a name="processing-the-request"></a>Обработка запроса

Когда приложение отправляет запрос к Resource Manager, запрос выполняется под идентификатором из основного токена. Основной токен должен быть допустимым и действующим. Он должен поступать от клиента, который может управлять подпиской.

Если запрос ссылается на ресурс из другого клиента, Resource Manager проверяет вспомогательные токены, чтобы определить, может ли запрос быть обработан. Все вспомогательные токены в заголовке должны быть допустимыми и действующими. Если срок действия токена истек, Resource Manager возвращает код отклика 401. Ответ включает идентификатор клиента и идентификатор арендатора токена, который недопустим. Если дополнительный заголовок содержит допустимый для клиента токен, запрос между клиентами обрабатывается.

## <a name="next-steps"></a>Следующие шаги

* Дополнительные сведения о запросах проверки подлинности см. в разделе [потоки проверки подлинности и сценарии приложений](../active-directory/develop/authentication-flows-app-scenarios.md).
* Дополнительные сведения о токенах см. в статье [Маркеры доступа в Azure Active Directory](../active-directory/develop/access-tokens.md).
