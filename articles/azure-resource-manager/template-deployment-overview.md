---
title: Шаблоны Azure Resource Manager
description: Описывает использование шаблонов Azure Resource Manager для развертывания ресурсов.
author: tfitzmac
ms.service: azure-resource-manager
ms.topic: conceptual
ms.date: 08/29/2019
ms.author: tomfitz
ms.openlocfilehash: 95c127b3a7c9c47c96b292066bf1597a02896806
ms.sourcegitcommit: 19a821fc95da830437873d9d8e6626ffc5e0e9d6
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/29/2019
ms.locfileid: "70166528"
---
# <a name="azure-resource-manager-templates"></a>Шаблоны Azure Resource Manager

С помощью Azure Resource Manager можно создавать шаблоны, которые определяют, что нужно развернуть в Azure. Шаблон — это файл нотация объектов JavaScript (JSON), который содержит инфраструктуру и конфигурацию решения Azure. Этот шаблон можно использовать, чтобы повторно развертывать решение на протяжении всего его жизненного цикла и гарантировать, что ресурсы развертываются в согласованном состоянии.

В шаблоне используется декларативный синтаксис, который позволяет указать, что вы планируете развернуть, не создавая последовательность команд программирования для ее создания. В шаблоне укажите ресурсы для развертывания и свойства этих ресурсов.

## <a name="benefits-of-resource-manager-templates"></a>Преимущества шаблонов диспетчер ресурсов

Шаблоны диспетчер ресурсов предоставляют несколько преимуществ.

* Вы можете развертывать и отслеживать все ресурсы вашего решения как единую группу, а не работать с ними по отдельности.

* Вы можете повторно развертывать решение на протяжении всего цикла разработки и гарантировать, что ресурсы развертываются в согласованном состоянии.

* Инфраструктурой можно управлять с помощью декларативных шаблонов, а не сценариев.

* Вы можете определять зависимости между ресурсами, чтобы их развертывание выполнялось в правильном порядке.

Следующие рекомендации помогут использовать все преимущества Resource Manager при работе с решениями.

* Определите и разверните инфраструктуру с помощью декларативного синтаксиса в шаблонах диспетчера ресурсов, а не с помощью безусловных команд.

* Определите все шаги развертывания и настройки в шаблоне. При настройке решения вы не должны выполнять какие-либо действия вручную.

* Используйте безусловные команды для управления ресурсами, например для запуска и остановки приложения или компьютера.

* Следуйте рекомендациям [Azure Resource Manager шаблона](template-best-practices.md).

## <a name="template-deployment-process"></a>Процесс Шаблоны развертывания

При развертывании шаблона диспетчер ресурсов анализирует шаблон и преобразует его синтаксис в операции REST API. Он отправляет эти операции соответствующим поставщикам ресурсов. Например, Resource Manager получает шаблон со следующим определением ресурса:

```json
"resources": [
  {
    "apiVersion": "2016-01-01",
    "type": "Microsoft.Storage/storageAccounts",
    "name": "mystorageaccount",
    "location": "westus",
    "sku": {
      "name": "Standard_LRS"
    },
    "kind": "Storage",
    "properties": {
    }
  }
]
```

В таком случае Resource Manager преобразует определение в операцию REST API, которая отправляется поставщику ресурсов Microsoft.Storage:

```HTTP
PUT
https://management.azure.com/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Storage/storageAccounts/mystorageaccount?api-version=2016-01-01
REQUEST BODY
{
  "location": "westus",
  "properties": {
  }
  "sku": {
    "name": "Standard_LRS"
  },
  "kind": "Storage"
}
```

## <a name="template-structure"></a>Структура шаблона

Вы выбираете определение шаблонов и групп ресурсов по своему усмотрению в зависимости от того, как нужно управлять решением. Например, трехуровневое приложение можно развернуть из одного шаблона в одной группе ресурсов.

![трехуровневый шаблон](./media/resource-group-overview/3-tier-template.png)

Но определять всю инфраструктуру в одном шаблоне не нужно. Во многих случаях целесообразно разделять требования к развертыванию между несколькими наборами шаблонов, предназначенными для определенных задач. Эти шаблоны можно многократно использовать для различных решений. Чтобы развернуть конкретное решение, создайте главный шаблон, связывающий все необходимые шаблоны. Ниже показано, как развернуть трехуровневое решение из родительского шаблона, в который входят три вложенных шаблона.

![вложенный шаблон](./media/resource-group-overview/nested-tiers-template.png)

Если в вашем случае у уровней отдельные жизненные циклы, эти уровни можно развернуть в отдельные группы ресурсов. Обратите внимание, что ресурсы по-прежнему могут быть связаны с ресурсами в других группах.

![шаблон уровня](./media/resource-group-overview/tier-templates.png)

Дополнительные сведения см. в статье [Использование связанных шаблонов в Azure Resource Manager](resource-group-linked-templates.md).

Azure Resource Manager анализирует зависимости, чтобы обеспечить создание ресурсов в правильном порядке. Если один ресурс зависит от значения в другом ресурсе (например, виртуальная машина, для которой требуется учетная запись хранения диска), можно задать зависимость. Дополнительные сведения см. в статье [Определение зависимостей в шаблонах диспетчера ресурсов Azure](resource-group-define-dependencies.md).

Кроме того, шаблон можно использовать для внесения обновлений в инфраструктуру. Например, можно добавить новый ресурс в решение и правила конфигурации для уже развернутых ресурсов. Если шаблон определяет ресурс, который уже существует, Resource Manager обновляет существующий ресурс вместо создания нового.

Диспетчер ресурсов предоставляет расширения для сценариев, когда необходимы дополнительные операции, такие как установка определенного программного обеспечения, не включенного в программу установки. Если вы уже работаете со службой управления конфигурацией, такую как DSC, Chef или Puppet, это можно делать и дальше, используя расширения. Дополнительные сведения о расширениях виртуальных машин см. в статье [Обзор расширений и компонентов виртуальной машины](../virtual-machines/windows/extensions-features.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).

Если решение создается на портале, оно автоматически включает в себя шаблон развертывания. Вам не нужно создавать шаблон с нуля, так как можно начать с шаблона для своего решения и настроить его в соответствии с конкретными потребностями. Пример см. в [кратком руководстве по созданию и развертыванию шаблонов Azure Resource Manager с помощью портала Azure](./resource-manager-quickstart-create-templates-use-the-portal.md). Шаблон для существующей группы ресурсов можно получить, либо экспортировав текущее состояние группы ресурсов, либо просмотрев шаблон, использованный для конкретного развертывания. Чтобы лучше понять синтаксис шаблона, изучите [экспортированный шаблон](./manage-resource-groups-portal.md#export-resource-groups-to-templates).

Наконец, шаблон становится частью исходного кода для вашего приложения. Можно включить его в репозиторий исходного кода и обновлять по мере развития приложения. Шаблон можно изменить в Visual Studio.

## <a name="next-steps"></a>Следующие шаги

Дополнительные сведения о файлах шаблонов см. [в разделе сведения о структуре и синтаксисе шаблонов Azure Resource Manager](resource-group-authoring-templates.md).

Определив шаблон, можно приступить к развертыванию ресурсов в Azure. Дополнительные сведения о развертывании ресурсов см. в следующих источниках.

* [Развертывание ресурсов с использованием шаблонов Resource Manager и Azure PowerShell](resource-group-template-deploy.md)
* [Развертывание ресурсов с использованием шаблонов Resource Manager и Azure CLI](resource-group-template-deploy-cli.md)
* [Развертывание ресурсов с использованием шаблонов Resource Manager и портала Azure](resource-group-template-deploy-portal.md)
* [Развертывание ресурсов с использованием шаблонов и REST API Resource Manager](resource-group-template-deploy-rest.md)

