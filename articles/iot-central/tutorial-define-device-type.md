---
title: Определение типа нового устройства в Azure IoT Central | Документация Майкрософт
description: В этом руководстве показано, как разработчики могут определить тип нового устройства в своем приложении Azure IoT Central. Вы определите телеметрию, состояние, свойства и параметры для вашего типа.
author: dominicbetts
ms.author: dobett
ms.date: 06/07/2019
ms.topic: tutorial
ms.service: iot-central
services: iot-central
ms.custom: mvc
manager: philmea
ms.openlocfilehash: db9f7e75af01ed83c39ef3a37ab2612426ef6ea4
ms.sourcegitcommit: 44e85b95baf7dfb9e92fb38f03c2a1bc31765415
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/28/2019
ms.locfileid: "70099605"
---
# <a name="tutorial-define-a-new-device-type-in-your-azure-iot-central-application"></a>Руководство по Определение типа нового устройства в приложении Azure IoT Central

[!INCLUDE [iot-central-original-pnp](../../includes/iot-central-original-pnp-note.md)]

В этом руководстве показано, как разработчики могут использовать шаблон устройства для определения типа нового устройства в приложении Microsoft Azure IoT Central. Шаблон устройства определяет телеметрию, состояние, свойства и параметры для типа устройства.

Чтобы вы могли протестировать приложение перед подключением реального устройства, при создании шаблона устройства в IoT Central создается имитируемое устройство на основе этого шаблона.

В этом руководстве вы создаете шаблон устройства **подключенного кондиционера**. Подключенный кондиционер:

* отправляет данные телеметрии, например температуру и влажность;
* сообщает о состоянии, например, включен ли он;
* содержит свойства, такие как версия встроенного ПО и серийный номер;
* содержит настройки, например целевую температуру.

Из этого руководства вы узнаете, как выполнять следующие задачи:

> [!div class="checklist"]
> * Создание шаблона нового устройства
> * Добавление телеметрии для устройства.
> * Отображение имитированной телеметрии.
> * Определение измерения событий.
> * Отображение имитированных событий.
> * Определение измерения состояния.
> * Отображение имитированного состояния.
> * Параметры и свойства
> * Использование команд
> * Просмотр имитированного устройства на панели мониторинга

## <a name="prerequisites"></a>Предварительные требования

Для работы с этим руководством вам потребуется приложение Azure IoT Central. Если вы завершили работу с руководством по [созданию приложения Azure IoT Central](quick-deploy-iot-central.md), вы можете повторно использовать созданное в нем приложение. В противном случае выполните следующие шаги для создания пустого приложения Azure IoT Central:

1. Перейдите на веб-сайт [диспетчера приложений в Azure IoT Central](https://aka.ms/iotcentral).

2. Введите адрес электронной почты и пароль, которые вы используете для доступа к подписке Azure:

    ![Ввод учетной записи организации](./media/tutorial-define-device-type/sign-in.png)

3. Чтобы начать создание приложения Azure IoT Central, выберите **Новое приложение**.

    ![Страница диспетчера приложений Azure IoT Central](./media/tutorial-define-device-type/iotcentralhome.png)

4. Чтобы создать приложение Azure IoT Central, сделайте следующее:
    
   * Выберите **Пробная версия**. Для создания приложения в рамках пробной версии вам не потребуется подписка Azure.
    
      Дополнительные сведения о каталогах и подписках см. в статье [Создание приложения Azure IoT Central](quick-deploy-iot-central.md).
    
   * Выберите **Custom Application** (Пользовательское приложение).
    
   * Дополнительно можно указать понятное имя приложения, например **Contoso Air Conditioners** (Кондиционеры Contoso). Azure IoT Central создаст уникальный префикс URL-адреса. Вы можете изменить этот префикс на что-то более запоминающееся.
    
   * Нажмите кнопку **Создать**.

     ![Страница создания приложения Azure IoT Central](./media/tutorial-define-device-type/iotcentralcreate.png)

     Дополнительные сведения см. в [кратком руководстве по созданию приложения](quick-deploy-iot-central.md).

## <a name="create-a-device-template"></a>Создание шаблона устройства

В качестве разработчика вы можете создавать и редактировать шаблоны устройств в своем приложении. Когда вы создаете шаблон устройства, Azure IoT Central генерирует имитируемое устройство из шаблона. Имитированное устройство генерирует телеметрию, которая позволяет вам проверить поведение вашего приложения перед подключением реального устройства.

Чтобы добавить новый шаблон устройства в приложение, вам нужно перейти на страницу **шаблонов устройств**. Для этого выберите **Шаблоны устройств** в меню навигации слева.

![Страница шаблонов устройств](./media/tutorial-define-device-type/devicetemplates.png)

## <a name="add-a-device-template"></a>Добавление шаблона устройства

На следующих шагах показано, как создать новый шаблон устройства **подключенного кондиционера** для устройств, отправляющих телеметрию температуры в ваше приложение:

1. На странице **Шаблоны устройств** выберите **+ Создать**:

    ![Страница шаблонов устройств, создание шаблонов устройств](./media/tutorial-define-device-type/newtemplate.png)

2. На странице отображаются шаблоны, которые можно выбрать.

    ![Библиотека шаблонов устройств](./media/tutorial-define-device-type/devicetemplatelibrary.png)

3. Выберите **Настраиваемый** введите имя шаблона устройства **Подключенный кондиционер**, а затем нажмите кнопку **Создать**. Можно также передать изображение устройства, которое будет видимым для операторов в обозревателе устройства:

    ![Пользовательское устройство](./media/tutorial-define-device-type/createcustomdevice.png)

4. В шаблоне устройства **Подключенный кондиционер** откройте вкладку **Измерения**, где вы определяете телеметрию. Каждый шаблон устройства, который вы определяете, имеет отдельные вкладки, где вы можете:

   * указать _измерения_, такие как телеметрия, событие и состояние, отправляемые устройством;

   * определить _параметры_, используемые для управления устройством;

   * определить _свойства_, являющиеся метаданными устройства;

   * определить _команды_, которые будут выполняться непосредственно на устройстве;

   * определить _правила_, связанные с устройством;

   * настроить _панель мониторинга_ устройства для операторов.

     ![Измерения кондиционера](./media/tutorial-define-device-type/airconmeasurements.png)

     > [!NOTE]
     > Чтобы изменить имя шаблона устройства, выберите имя шаблона вверху страницы.

5. Чтобы добавить данные измерения телеметрии температуры, щелкните **+ Новое измерение**. Затем выберите **Телеметрия** как тип измерения:

    ![Измерения подключенного кондиционера](./media/tutorial-define-device-type/airconmeasurementsnew.png)

6. Каждый тип телеметрии, который вы определяете для шаблона устройства, включает в себя [параметры конфигурации](howto-set-up-template.md), такие как:

   * параметры отображения;

   * сведения о телеметрии;

   * параметры имитации.

     Для настройки телеметрии **температуры** используйте сведения в следующей таблице:

     | Параметр              | Значение         |
     | -------------------- | -----------   |
     | Отображаемое имя         | температура;   |
     | Имя поля           | Температура   |
     | Units                | F             |
     | Min                  | 60            |
     | Max                  | 110           |
     | Число десятичных знаков       | 0             |

     Вы также можете выбрать цвет для отображения данных телеметрии. Чтобы сохранить определение телеметрии, щелкните **Сохранить**:

     ![Настройка моделирования температуры](./media/tutorial-define-device-type/temperaturesimulation.png)

7. Через некоторое время на вкладке **измерений** отобразится диаграмма телеметрии температуры с вашего имитированного подключенного кондиционера. Используйте элементы управления для настройки видимости, агрегации или для редактирования определения телеметрии:
 
    > [!NOTE]
    > Для телеметрии **среднее значение** задается как агрегирование по умолчанию. 

    ![Просмотр моделирования температуры](./media/tutorial-define-device-type/viewsimulation.png)

8. Вы также можете настроить диаграмму, используя элементы управления **График**, **С накоплением** и **Изменить диапазон времени**:

    ![Настройка диаграммы](./media/tutorial-define-device-type/customizechart.png)

## <a name="add-an-event-measurement"></a>Добавление измерения события

Используйте события для определения данных точки во времени, фиксируемой во время такого события как ошибка или сбой компонента. Azure IoT Central может имитировать события устройства, чтобы вы могли проверить поведение своего приложения перед подключением реального устройства. Определите измерения событий для вашего шаблона устройства в представлении **измерений**.

1. Чтобы добавить измерение события **Fan Motor Error** (Ошибка двигателя вентилятора), выберите **+ Новое измерение**. Затем выберите **Событие** как тип измерения:

    ![Измерения подключенного кондиционера](./media/tutorial-define-device-type/eventnew.png)

2. Каждый тип события, которое вы определяете для шаблона устройства, включает в себя [параметры конфигурации](howto-set-up-template.md), такие как:

   * отображаемое имя;

   * имя поля;

   * серьезность.

     Для настройки события **ошибки вентилятора** используйте сведения в следующей таблице:

     | Параметр              | Значение             |
     | -------------------- | -----------       |
     | Отображаемое имя         | Ошибка вентилятора   |
     | Имя поля           | fanmotorerr       |
     | Уровень серьезности             | Ошибка             |

     Чтобы сохранить определение события, выберите **Сохранить**:

     ![Настройка измерения событий](./media/tutorial-define-device-type/eventconfiguration.png)

3. Через некоторое время на вкладке **измерений** отобразится диаграмма случайно созданных событий с вашего имитированного подключенного кондиционера. Используйте элементы управления для настройки видимости или для редактирования определения события:

    ![Просмотр имитации события](./media/tutorial-define-device-type/eventview.png)

1. Чтобы просмотреть дополнительные сведения о событии, выберите его имя на диаграмме.

    ![Просмотр подробностей о событии](./media/tutorial-define-device-type/eventviewdetail.png)

## <a name="define-a-state-measurement"></a>Определение измерения состояния

Вы можете использовать вкладку для определения и визуализации состояния устройства или его компонента за конкретный период времени. Azure IoT Central может имитировать состояние устройства, чтобы вы могли проверить поведение своего приложения перед подключением реального устройства. Определите измерения состояния вашего типа устройства в представлении **измерений**.

1. Чтобы добавить измерение состояния **режима вентилятора**, выберите **+ Новое измерение**. Затем выберите **Состояние** как тип измерения:

    ![Измерения состояния подключенного кондиционера](./media/tutorial-define-device-type/statenew.png)

2. Каждый тип состояния, который вы определяете для шаблона устройства, включает в себя [параметры конфигурации](howto-set-up-template.md), такие как:

   * отображаемое имя;

   * имя поля;

   * значения с необязательными метками отображения;

   * цвет для каждого значения.

     Для настройки состояния **режима вентилятора** используйте сведения в следующей таблице:

     | Параметр              | Значение             |
     | -------------------- | -----------       |
     | Отображаемое имя         | Режим вентилятора          |
     | Имя поля           | fanmode           |
     | Значение                | 1                 |
     | Метка отображения        | Operating (Работает)         |
     | Значение                | 0                 |
     | Метка отображения        | Остановлено           |

     Чтобы сохранить определение измерения состояния, выберите **Сохранить**:

     ![Настройка измерения состояния](./media/tutorial-define-device-type/stateconfiguration.png)

3. Через некоторое время на странице **измерений** отобразится диаграмма произвольно созданных состояний с вашего имитированного подключенного кондиционера. Используйте элементы управления для настройки видимости или для редактирования определения состояния:

    ![Просмотр имитации состояния](./media/tutorial-define-device-type/stateview.png)

4. Если в течение небольшого периода времени количество отправленных устройством точек данных слишком велико, измерение состояния отображается с другими визуальными элементами. Выберите диаграмму, чтобы увидеть все точки данных за этот период времени, которые будут отображаться в хронологическом порядке. Вы также можете сузить диапазон времени, чтобы увидеть подробные сведения об измерениях.

## <a name="settings-properties-and-commands"></a>Параметры, свойства и команды

Параметры, свойства и команды — это разные значения, определенные в шаблоне устройства и связанные с каждым отдельным устройством:

* Используйте _параметры_ для отправки данных конфигурации на устройство из приложения. Например, оператор может использовать параметр, чтобы изменить интервал телеметрии устройства с двух до пяти секунд. Когда оператор изменяет параметр, он отмечается как ожидающий в пользовательском интерфейсе, пока устройство не выдаст подтверждение.

* Вы можете использовать _свойства_, чтобы определить метаданные, связанные с устройством. Существует две категории свойств:
    
  * Вы можете использовать _свойства приложения_ для записи сведений об устройстве в свое приложение. Например, можно использовать свойства приложения для записи расположения устройства и даты его последнего обслуживания. Эти свойства хранятся в приложении и не синхронизируются с устройством. Оператор может присваивать значения свойствам.

  * Используйте _свойства устройства_, чтобы позволить устройству отправлять значения свойств в ваше приложение. Сообщаемые свойства могут обновляться только устройством. Для оператора свойства устройства доступны только для чтения. В сценарии подключения кондиционера версия встроенного ПО и серийный номер устройства — это свойства, сообщаемые устройством.
    
    Дополнительные сведения см. в разделе [Свойства](howto-set-up-template.md#properties) руководства по настройке шаблона устройства.

* Используйте _команды_ для удаленного управления устройством из приложения. Для управления устройствами можно напрямую выполнять команды на устройстве из облака. Например, оператор может выполнить команды, такие как перезагрузка, для мгновенной перезагрузки устройства.

## <a name="use-settings"></a>Использование параметров

Используйте *параметры*, чтобы оператор мог отправлять данные конфигурации на устройство. В этом разделе вы добавите параметр в шаблон **подключенного кондиционера**, который позволяет оператору устанавливать целевую температуру подключенного кондиционера.

1. Перейдите на вкладку **Параметры** для своего шаблона устройства **подключенного кондиционера**.

2. Вы можете создавать параметры различных типов, например цифровые или текстовые. Выберите **Номер**, чтобы добавить параметр номера для устройства.

3. Для настройки параметра **Set Temperature** (Установить температуру) используйте сведения в следующей таблице:

    | Поле                | Значение           |
    | -------------------- | -----------     |
    | Отображаемое имя         | Установить температуру |
    | Имя поля           | setTemperature  |
    | Единица измерения      | F               |
    | Число десятичных знаков       | 1               |
    | Минимальное значение        | 20              |
    | Максимальное значение        | 200             |
    | Начальное значение        | 80              |
    | ОПИСАНИЕ          | Настройка целевой температуры для кондиционера |

    Затем выберите **Сохранить**.

    ![Настройка параметра установки температуры](./media/tutorial-define-device-type/configuresetting.png)

    > [!NOTE]
    > Когда устройство подтверждает изменение параметра, состояние параметра изменяется на **синхронизировано**.

4. Вы можете настроить макет вкладки **Параметры**, перемещая и изменяя размеры плиток параметров:

    ![Настройка макета параметров](./media/tutorial-define-device-type/settingslayout.png)

## <a name="use-properties"></a>Использование свойств

Вы можете использовать *свойства приложения* для хранения сведений о своем устройстве в приложении. В этом разделе описано, как добавить свойства приложения в шаблон **подключенного кондиционера** для хранения сведений о расположении устройства и дате последнего обслуживания. Эти свойства доступны для редактирования в приложении. Устройство также предоставляет сведения о свойствах, например серийный номер и версию встроенного ПО, которые доступны только для чтения в приложении.

1. Перейдите на вкладку **​Свойства** вашего шаблона устройства **подключенного кондиционера**.

1. Вы можете создавать свойства устройства разных типов, например цифровые или текстовые. Чтобы добавить свойство расположения в шаблон устройства, выберите **Расположение**. Для настройки свойства расположения используйте сведения из следующей таблицы:

    | Поле                | Значение                |
    | -------------------- | -------------------- |
    | Отображаемое имя         | Location             |
    | Имя поля           | location             |
    | Начальное значение        | Сиэтл, Вайоминг          |
    | ОПИСАНИЕ          | Расположение устройства      |

    Оставьте в других полях значения по умолчанию.

    ![Настройка свойств устройства](./media/tutorial-define-device-type/configureproperties.png)

    Щелкните **Сохранить**.

1. Чтобы добавить свойство даты обслуживания в шаблон устройства, выберите **Дата**.

1. Для настройки свойства даты последнего обслуживания используйте сведения из следующей таблицы:

    | Поле                | Значение                   |
    | -------------------- | ----------------------- |
    | Отображаемое имя         | Дата последнего обслуживания       |
    | Имя поля           | serviceDate             |
    | Начальное значение        | 01/01/2019                |
    | ОПИСАНИЕ          | Дата последнего обслуживания           |

    ![Настройка свойств устройства](./media/tutorial-define-device-type/configureproperties2.png)

    Щелкните **Сохранить**.

1. Вы можете настроить макет вкладки **Свойства**, перемещая и изменяя размеры плиток свойств.

1. Чтобы добавить свойство устройства, например версию встроенного ПО, в шаблон устройства, выберите **Device Property** (Свойство устройства).

1. Чтобы настроить версию встроенного ПО, используйте сведения в следующей таблице:

    | Поле                | Значение                   |
    | -------------------- | ----------------------- |
    | Отображаемое имя         | Версия встроенного ПО        |
    | Имя поля           | FirmwareVersion         |
    | Тип данных            | text                    |
    | ОПИСАНИЕ          | Версия встроенного ПО кондиционера |

    ![Настройка версии встроенного ПО](./media/tutorial-define-device-type/configureproperties3.png)

    Щелкните **Сохранить**.

1. Чтобы добавить свойство устройства, например серийный номер, в шаблон устройства, выберите **Device Property** (Свойство устройства).

1. Чтобы настроить серийный номер, используйте информацию в следующей таблице:

    | Поле                | Значение                   |
    | -------------------- | ----------------------- |
    | Отображаемое имя         | Серийный номер           |
    | Имя поля           | SerialNumber            |
    | Тип данных            | text                    |
    | ОПИСАНИЕ          | Серийный номер кондиционера  |

    ![Настройка серийного номера](./media/tutorial-define-device-type/configureproperties4.png)

    Щелкните **Сохранить**.

    > [!NOTE]
    > Свойство устройства отправляется из устройства в приложение. Значения версии встроенного ПО и серийного номера будут обновлены, когда реальное устройство подключится к IoT Central.

## <a name="use-commands"></a>Использование команд

Используйте _команды_, чтобы позволить оператору выполнять команды непосредственно на устройстве. В этом разделе вы добавили команды в свой шаблон **подключенного кондиционера**, который позволяет оператору отсылать определенное сообщение обратно на подключенный кондиционер.

1. Перейдите на вкладку **Команды** шаблона **подключенного кондиционера**, чтобы изменить шаблон.

1. Щелкните **+ Новая команда**, чтобы добавить команду для устройства и начать ее настройку.

1. Для настройки новой команды используйте сведения в следующей таблице:

    | Поле                | Значение           |
    | -------------------- | -----------     |
    | Отображаемое имя         | Команда вывода на экран    |
    | Имя поля           | echo (вывод на экран)            |
    | Default Timeout (Время ожидания по умолчанию)      | 30              |
    | Display Type (Отображаемый тип)         | text            |
    | ОПИСАНИЕ          | Команда устройства  |  

    Вы можете добавить дополнительные входные данные для команды, выбрав **+** в разделе **Поля ввода**.

    ![Подготовка к добавлению параметра](./media/tutorial-define-device-type/commandsecho1.png)

     Щелкните **Сохранить**.

1. Вы можете настроить макет вкладки **Команды**, перемещая плитки команд и изменяя их размер.

## <a name="view-your-simulated-device"></a>Просмотр имитированного устройства

Теперь, когда вы определили шаблон устройства **подключенного кондиционера**, вы можете настроить его **панель мониторинга**, чтобы включить измерения, параметры и свойства, которые вы определили. Затем вы можете просмотреть панель мониторинга в качестве оператора:

1. Выберите вкладку **Панель мониторинга** вашего шаблона устройства **подключенного кондиционера**.

1. Выберите **График**, чтобы добавить компонент на **панель мониторинга**.

1. Настройте компонент **Линейная диаграмма**, используя информацию в следующей таблице:

    | Параметр      | Значение       |
    | ------------ | ----------- |
    | Название        | температура; |
    | Диапазон времени   | За последние 30 минут |
    | Показатели     | Температура (щелкните значок **видимости** рядом с параметром **Температура**). |

    ![Параметры линейной диаграммы](./media/tutorial-define-device-type/linechartsettings.png)

    Затем нажмите кнопку **Save** (Сохранить).

1. Выберите компонент **Журнал событий**, используя информацию в следующей таблице:

    | Параметр      | Значение       |
    | ------------ | ----------- |
    | Название        | События двигателя вентилятора |
    | Диапазон времени   | За последние 30 минут |
    | Показатели     | Ошибка двигателя вентилятора (щелкните значок **видимости** рядом с параметром **Fan Motor Error** (Ошибка двигателя вентилятора)). |

    ![Параметры диаграммы событий](./media/tutorial-define-device-type/dashboardeventchartsetting.png)

    Затем нажмите кнопку **Save** (Сохранить).

1. Настройте компонент **State History** (История состояния), используя информацию в следующей таблице:

    | Параметр      | Значение       |
    | ------------ | ----------- |
    | Название        | Режим вентилятора |
    | Диапазон времени   | За последние 30 минут |
    | Показатели | Режим вентилятора (щелкните значок **видимости** рядом с параметром **Fan Mode** (Режим вентилятора)). |

    ![Параметры линейной диаграммы](./media/tutorial-define-device-type/dashboardstatechartsetting.png)

    Затем нажмите кнопку **Save** (Сохранить).

1. Чтобы добавить на панель мониторинга параметры и свойства устройства, щелкните **Settings and Properties** (Параметры и свойства). Выберите **Добавление и удаление**, чтобы добавить параметры или свойства, которые должны отображаться на панели мониторинга.

1. Настройте компонент **Settings and Properties** (Параметры и свойства), используя сведения в следующей таблице:

    | Параметр                 | Значение         |
    | ----------------------- | ------------- |
    | Название                   | Свойства устройства |
    | Параметры и свойства | Установить температуру<br/>Серийный номер<br/>Версия встроенного ПО |

    Параметры и свойства, которые были ранее заданы на страницах **Settings and Properties** (Параметры и свойства), отображаются в разделе **Доступные столбцы**.

    ![Настройка свойства температуры](./media/tutorial-define-device-type/propertysettings4.png)

    Затем нажмите кнопку **Save** (Сохранить).

1. Теперь вы видите смоделированные данные для подключенного кондиционера на панели мониторинга. Вы можете изменить плитки и макет для панели мониторинга:

    ![Просмотр панели мониторинга](./media/tutorial-define-device-type/dashboard.png)

## <a name="next-steps"></a>Дополнительная информация

Из этого руководства вы узнали, как выполнить следующие задачи:

<!-- Repeat task list from intro -->
> [!div class="nextstepaction"]
> * Создание шаблона нового устройства
> * Добавление телеметрии для устройства.
> * Отображение имитированной телеметрии.
> * Определение событий устройства.
> * Отображение имитированных событий.
> * Определение состояния.
> * Отображение имитированного состояния.
> * Параметры и свойства
> * Использование команд
> * Просмотр имитированного устройства на панели мониторинга

Теперь, когда вы определили шаблон устройства в своем приложении Azure IoT Central, предлагаем следующие шаги:

* [Настройка правил и действий для устройства](tutorial-configure-rules.md)
* [Настройка представлений оператора](tutorial-customize-operator.md)