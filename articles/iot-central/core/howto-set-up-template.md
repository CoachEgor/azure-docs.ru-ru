---
title: Настройка шаблона устройства в приложении Azure IoT Central | Документация Майкрософт
description: Подробные сведения о настройке измерений, параметров, свойств, правил и панели мониторинга в шаблоне устройства.
author: viv-liu
ms.author: viviali
ms.date: 06/19/2019
ms.topic: conceptual
ms.service: iot-central
services: iot-central
manager: peterpr
ms.openlocfilehash: c4df07174a5d8826acd7682fa3035fcfd201c5c9
ms.sourcegitcommit: 4c3d6c2657ae714f4a042f2c078cf1b0ad20b3a4
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/25/2019
ms.locfileid: "72953100"
---
# <a name="set-up-a-device-template"></a>Настройка шаблона устройства

[!INCLUDE [iot-central-original-pnp](../../../includes/iot-central-original-pnp-note.md)]

Шаблон устройства — это схема, которая определяет характеристики и поведение типа устройства, которое подключается к приложению Azure IoT Central.

Например, построитель может создать шаблон устройства для подключенного вентилятора со следующими характеристиками:

- измерение телеметрии температуры;
- Измерение расположения
- измерение событий ошибки двигателя вентилятора;
- измерение состояния работы вентилятора;
- параметр скорости вентилятора;
- правила отправки оповещений;
- панель мониторинга, которая обеспечивает общее представление устройства.

На основе этого шаблона устройства можно создавать и подключать реальные вентиляторы с такими именами, как **fan-1** и **fan-2**. Все эти вентиляторы имеют измерения, параметры, свойства, правила и панель мониторинга, которые пользователи приложения могут отслеживать и контролировать.

> [!NOTE]
> Только администраторы и конструкторы могут создавать, изменять и удалять шаблоны устройств. Любой пользователь может создавать устройства на странице **Device Explorer** из имеющихся шаблонов устройств.

## <a name="create-a-device-template"></a>Создание шаблона устройства

1. Перейдите на страницу **Шаблоны устройств**.

2. Чтобы создать шаблон, сначала выберите **+ создать**.

3. Чтобы быстро приступить к работе, выберите один из существующих готовых шаблонов. В противном случае выберите **Настраиваемый**, введите имя и нажмите кнопку **создать** , чтобы создать собственный шаблон с нуля.

   ![Библиотека шаблонов устройств](./media/howto-set-up-template/newtemplate.png)

4. При создании пользовательского шаблона отображается страница **сведений об устройстве** для нового шаблона устройства. IoT Central автоматически создает имитированное устройство во время создания шаблона устройства. Имитированное устройство позволяет вам проверить поведение вашего приложения перед подключением реального устройства.

В следующих разделах описывается каждая из вкладок на странице **шаблона устройства**.

## <a name="measurements"></a>Измерения

Измерения — это данные, поступающие с устройства. Можно добавить несколько измерений в шаблон устройства в зависимости от его возможностей.

- Измерения **телеметрии** — это точка числовых данных, которые устройство собирает с течением времени. Они представлены в виде непрерывного потока. Например, температура.
- Измерения **событий** представляют собой данные определенной точки во времени, которые представляют что-то значимое, связанное с устройством. Уровень серьезности указывает на важность события. Например, ошибка мотора вентилятора.
- **Измерения состояния** представляют состояние устройства или его компонентов в течение определенного периода времени. К примеру, режим вентилятора, который может быть определен как **работающий** и **остановленный**.
- Измерения **расположения** — это координаты долготы и широты на устройстве в течение определенного времени. Например, Вентилятор можно переместить из одного расположения в другое.

### <a name="create-a-telemetry-measurement"></a>Создание измерения телеметрии

Чтобы добавить новое измерение телеметрии, выберите **+ новое измерение**, выберите данные **телеметрии** в качестве типа измерения и введите сведения в форме.

> [!NOTE]
> Имена полей в шаблоне устройства должны совпадать с именами в соответствующем коде устройства. Это нужно для отображения в приложении данных телеметрии при подключении реального устройства. Того же принципа следует придерживаться при настройке параметров, свойств устройства и команд. Вы сможете определить шаблон устройства в последующих разделах.

Например, можно добавить новое измерение телеметрии температуры:

| Отображаемое имя        | Имя поля    |  Единицы    | Min   |Максимальное количество|
| --------------------| ------------- |-----------|-------|---|
| Температура         | temp          |  градус Цельсия     |  0    |100|

![Форма создания телеметрии с подробными сведениями об измерении температуры](./media/howto-set-up-template/measurementsform.png)

Если щелкнуть **Сохранить**, в списке измерений отобразятся данные измерения **температуры**. Вскоре отобразится визуализация данных температуры из имитированного устройства.

При отображении данных телеметрии можно выбрать один из следующих параметров статистической обработки: СРЗНАЧ, минимум, максимум, сумма и количество. В качестве статистической функции по умолчанию на диаграмме выбрано **среднее значение** .

> [!NOTE]
> Данные телеметрии передаются в формате чисел с плавающей запятой.

### <a name="create-an-event-measurement"></a>Создание измерения события

Чтобы добавить новое измерение событий, выберите **+ создать измерение** и выберите **событие** в качестве типа измерения. Введите сведения в форму **создания события**.

Укажите сведения об **отображаемом имени**, **имени поля** и **серьезности** события. Вы можете выбрать из трех доступных уровней серьезности — **Ошибка**, **Предупреждение** и **Сведения**.

Например, можно добавить новое событие **Ошибка мотора вентилятора**.

| Отображаемое имя        | Имя поля    |  Серьезность по умолчанию |
| --------------------| ------------- |-----------|
| Ошибка вентилятора     | fanmotorerror |  Ошибка    |

![Форма создания события с подробными сведениями о событии мотора вентилятора](./media/howto-set-up-template/eventmeasurementsform.png)

Если щелкнуть **Сохранить**, в списке измерений отобразятся данные измерения **ошибки мотора вентилятора**. Вскоре отобразится визуализация данных события из имитированного устройства.

Чтобы просмотреть дополнительные сведения о событии, щелкните значок события на диаграмме:

![Подробные сведения о событии "Ошибка мотора вентилятора"](./media/howto-set-up-template/eventmeasurementsdetail.png)

> [!NOTE]
> Для измерения событий используется строковый тип данных.

### <a name="create-a-state-measurement"></a>Создание измерения состояния

Чтобы добавить новое измерение состояний, нажмите кнопку **+ создать измерение** и выберите **состояние** в качестве типа измерения. Введите сведения в форму **создания состояния**.

Укажите сведения об **отображаемом имени**, **имени поля** и **значениях** состояния. Каждое значение также может иметь отображаемое имя, которое будет использоваться при отображении значения в диаграммах и таблицах.

Например, вы можете добавить новое состояние **Режим вентилятора**, которое имеет два возможных значения, отправляемых устройством: **Работает** и **Остановлено**.

| Отображаемое имя | Имя поля    |  Значение 1   | Отображаемое имя | Значение 2    |Отображаемое имя  |
| -------------| ------------- |----------- | -------------| -----------| -------------|
| Режим вентилятора     | fanmode       |  1         | Operating (Работает)    |     0      | Остановлена      |

![Форма изменения состояния с подробными сведениями о режиме вентилятора](./media/howto-set-up-template/statemeasurementsform.png)

Если щелкнуть **Сохранить**, в списке измерений отобразится состояние измерения **мотора вентилятора**. Вскоре отобразится визуализация данных состояния из имитированного устройства.

Если в течение небольшого периода времени количество отправленных устройством точек данных слишком велико, измерение состояния отображается с другими визуальными элементами. Выберите диаграмму, чтобы просмотреть все точки данных за этот период в хронологическом порядке. Вы также можете сузить диапазон времени, чтобы увидеть измерения, нанесенные на график.

> [!NOTE]
> Для измерения состояния используется строковый тип данных.

### <a name="create-a-location-measurement"></a>Создание измерения местоположения

Чтобы добавить новое измерение местоположений, выберите **+ новое измерение**, выберите **Расположение** в качестве типа измерения и введите сведения в форме **Создание измерения** .

Например, можно добавить новое измерение телеметрии расположения:

| Отображаемое имя        | Имя поля    |
| --------------------| ------------- |
| Расположение ресурса      |  ассетлок     |

![Форма "Создание расположения" со сведениями об измерении местоположения](./media/howto-set-up-template/locationmeasurementsform.png)

После выбора параметра **сохранить**в списке измерений появится измерение **Расположение** . В течение короткого промежутка вы увидите визуализацию данных расположения из имитации устройства.

При отображении расположения можно выбрать один из следующих параметров: Последнее расположение и журнал расположения. **Журнал расположений** применяется только к выбранному диапазону времени.

Тип данных измерения «расположение» — это объект, который содержит долготу, широту и дополнительную высоту. В следующем фрагменте кода показана структура JavaScript:

```javascript
assetloc: {
  lon: floating point number,
  lat: floating point number,
  alt?: floating point number
}
```

После подключения реального устройства к расположению, добавленному в качестве измерения, будет добавлено значение, отправленное устройством. После настройки измерения местоположения можно [Добавить карту для визуализации расположения на панели мониторинга устройства](#add-a-location-measurement-in-the-dashboard).

## <a name="settings"></a>Настройки

Параметры предназначены для управления устройством. Они позволяют операторам предоставлять входные данные для устройства. Вы можете добавить несколько параметров в шаблон устройства, которые отображаются в виде плиток на вкладке **Параметры** для использования операторами. Можно добавить различные типы параметров: число, текст, Дата, переключатель и подпись раздела.

Параметры могут быть в одном из трех состояний. Устройство сообщает об этих состояниях.

- **Синхронизированное**: устройство изменилось с учетом значения параметра.

- **В ожидании**: устройство в настоящее время меняется в соответствии со значением параметра.

- **Ошибка**: устройство вернуло ошибку.

Например, можно добавить новый параметр «скорость вентилятора», выбрав **Параметры** и введя новое значение в поле «новый **номер** »:

| Отображаемое имя  | Имя поля    |  Единицы  | Десятичные знаки |Initial|
| --------------| ------------- |---------| ---------|---- |
| Скорость вращения вентилятора     | fanSpeed      | Об/мин     | 2        | 0   |

![Форма настройки числа со сведениями о параметрах скорости](./media/howto-set-up-template/settingsform.png)

После того как вы выберете **Сохранить**, параметр **Скорость вращения вентилятора** появится в виде плитки. Оператор может использовать этот параметр на странице **Device Explorer**, чтобы изменить скорость вращения вентилятора устройства.

## <a name="properties"></a>properties

Свойства — это метаданные, связанные с устройством, такие как фиксированное расположение устройства и серийный номер. Добавьте в шаблон устройства несколько свойств, которые отображаются в виде плиток на вкладке **Свойства** . Свойство имеет такой тип, как число, текст, Дата, переключатель, свойство устройства, метка или фиксированное расположение. Оператор задает значения свойств при создании устройства и может изменять эти значения в любое время. Свойства устройства доступны только для чтения и отправляются с устройства в приложение. Оператор не может изменять свойства устройства. При подключении реального устройства плитка свойств устройства обновляется в приложении.

Существует две категории свойств:

- _Свойства устройства_, которые устройство передает в приложение IoT Central. Они содержат атрибут "только для чтения" и обновляются при подключении реального устройства.
- _Свойства приложения_, которые хранятся в приложении. Оператор может их изменить. Свойства приложения хранятся только в приложении и никогда не отображаются устройством.

Например, можно добавить дату последнего обслуживания для устройства как новое свойство **Дата** (свойство приложения) на вкладке **Свойства**.

| Отображаемое имя  | Имя поля | Начальное значение   |
| --------------| -----------|-----------------|
| Дата последнего обслуживания      | lastServiced        | 29.01.2019     |

![Форма настройки даты последнего обслуживания на вкладке "Свойства"](./media/howto-set-up-template/propertiesform.png)

Когда вы нажмете кнопку **Сохранить**, дата последнего обслуживания для устройства появится в виде плитки.

После создания плитки можно изменить значение свойства приложения на вкладке **Device Explorer**.

### <a name="create-a-location-property"></a>Создание свойства Location

Вы можете предоставить географический контекст для данных о местоположении в Azure IoT Central и сопоставлять любые координаты широты и долготы или почтовый адрес. Azure Maps позволяет использовать эту возможность в IoT Central.

Вы можете добавить два типа свойств расположения:

- **Расположение как свойство приложения**, которое хранится в приложении. Свойства приложения хранятся только в приложении и никогда не отображаются устройством.
- **Расположение как свойство устройства.** Эти данные устройство передает в приложение. Этот тип свойства лучше использовать для статического расположения.

> [!NOTE]
> В качестве свойства Location не записывается журнал. Если требуется журнал, используйте измерение Location.

#### <a name="add-location-as-an-application-property"></a>Добавление расположения в качестве свойства приложения

Вы можете создать свойство расположения как свойство приложения, используя службы Azure Maps в своем приложении IoT Central. Например, вы можете добавить адрес установки устройства.

1. Перейдите на вкладку **Свойства**.

2. В библиотеке выберите **Расположение**.

3. Укажите для расположения **отображаемое имя**, **имя поля** и **начальное значение**.

    | Отображаемое имя  | Имя поля | Начальное значение |
    | --------------| -----------|---------|
    | Адрес установки | installAddress | Microsoft, 1 Microsoft Way, Redmond, WA 98052   |

   ![Форма настройки расположения с подробными сведениями о расположении](./media/howto-set-up-template/locationcloudproperty2.png)

   Для добавления расположения существует два поддерживаемых формата:
   - **расположение в виде адреса**;
   - **расположение в виде координат**.

4. Щелкните **Сохранить**. Оператор может обновить значение расположения в **Device Explorer**.

#### <a name="add-location-as-a-device-property"></a>Добавление расположения в качестве свойства устройства

Вы можете создать свойство расположения в качестве свойства устройства, которое сообщается устройством. Например, если нужно отслеживать расположение устройства:

1. Перейдите на вкладку **Свойства**.

2. Выберите **Device Property** (Свойство устройства) в библиотеке.

3. Укажите отображаемое имя и имя поля, а затем выберите **Расположение** в качестве типа данных.

    | Отображаемое имя  | Имя поля | Тип данных |
    | --------------| -----------|-----------|
    | Расположение устройства | deviceLocation | location  |

   > [!NOTE]
   > Имена полей должны совпадать с именами свойств в соответствующем коде устройства.

   ![Форма настройки свойств устройства с подробными сведениями о расположении](./media/howto-set-up-template/locationdeviceproperty2.png)

После подключения реального устройства к расположению, добавленному в качестве свойства устройства, будет добавлено значение, отправленное устройством. После настройки свойства Location можно [Добавить карту для визуализации расположения на панели мониторинга устройства](#add-a-location-property-in-the-dashboard).

## <a name="commands"></a>Команды

Команды используются для удаленного управления устройством. Они позволяют операторам выполнять команды на устройстве. Вы можете добавить несколько команд в шаблон устройства, которые отображаются в виде плиток на вкладке **Команды** для использования операторами. Как создатель устройства, вы можете определить команды в соответствии с требованиями.

Чем команда отличается от параметра?

- **Параметр**. параметр — это конфигурация, которую необходимо применить к устройству. Вы хотите, чтобы устройство сохраняло эту конфигурацию, пока вы не измените ее. Например, вам нужно задать температуру охлаждающего устройства, которая не должна изменяться даже после его перезагрузки.

- **Команда.** Позволяет мгновенно удаленно выполнять команду на устройстве из IoT Central. Если устройство не подключено, время ожидания команды истекает и ее выполнение завершается сбоем. Например, вам требуется перезагрузить устройство.

Например, можно добавить новую команду **echo** , выбрав вкладку **команды** , затем выбрав **+ создать команду**и введя сведения о новой команде:

| Отображаемое имя  | Имя поля | Default Timeout (Время ожидания по умолчанию) | Тип данных |
| --------------| -----------|---------------- | --------- |
| Команда вывода на экран  | echo (вывод на экран)       |  30             | текст      |

![Форма настройки команды с подробными сведениями о выводе на экран](./media/howto-set-up-template/commandsecho1.png)

Если выбрать **Сохранить**, команда **вывода на экран** будет отображаться в виде плитки. При подключении реального устройства ее можно использовать в **Device Explorer**. Имена полей команды должны совпадать с именами свойств в соответствующем коде устройства, чтобы команды выполнялись успешно.

[Ниже приведена ссылка на пример кода устройства C.](https://github.com/Azure/iot-central-firmware/blob/ad40358906aeb8f2040a822ba5292df866692c16/MXCHIP/mxchip_advanced/src/AzureIOTClient.cpp#L34)

## <a name="rules"></a>Правила

Правила позволяют операторам наблюдать за устройствами почти в реальном времени. При срабатывании правила автоматически вызывают действия, такие как отправка сообщения электронной почты. На сегодня существует один тип правил:

- **Правило телеметрии**, срабатывающее, когда данные телеметрии выбранного устройства превышают указанное пороговое значение. [Узнайте больше о правилах телеметрии](howto-create-telemetry-rules.md).

## <a name="dashboard"></a>панель мониторинга

На панели мониторинга находится оператор, позволяющий просматривать сведения об устройстве. В качестве построителя вы добавляете плитки на эту страницу, чтобы помочь операторам понять, как работает устройство. Вы можете добавить несколько типов плиток для панели мониторинга: изображения, графики, гистограммы, ключевые показатели эффективности, параметры, свойства и метки.

Например, можно добавить плитку **Параметры и свойства**, чтобы отображать текущие значения параметров и свойств из некоторого набора, выбрав вкладку **Панель мониторинга** и плитку из библиотеки.

![Форма настройки сведений об устройстве со сведениями о параметрах и свойствах](./media/howto-set-up-template/dashboardsettingsandpropertiesform1.png)

Теперь, когда оператор просматривает панель мониторинга в **Device Explorer**, он может видеть плитку.

### <a name="add-a-location-measurement-in-the-dashboard"></a>Добавление измерения местоположения на панели мониторинга

Если вы настроили измерение местоположения, вы можете визуализировать расположение с картой на панели мониторинга устройства. Для измерений расположения имеется возможность построить журнал расположения.

1. Перейдите на вкладку **Панель мониторинга**.

1. На панели мониторинга устройства выберите **карту** из библиотеки.

1. Укажите название карты. В следующем примере показано **Текущее расположение устройства**заголовков. Затем выберите измерение расположение, настроенное ранее на вкладке **измерения** . В следующем примере выбрано измерение **местонахождение ресурса** :

   ![Форма настройки карты со сведениями о заголовке и свойствах](./media/howto-set-up-template/locationcloudproperty5map.png)

1. Щелкните **Сохранить**. Теперь на фрагменте карты отображается выбранное расположение.

Можно изменить размер плитки карты. Когда оператор просматривает панель мониторинга в **Device Explorer**, отображаются все плитки панели мониторинга, которые вы настроили, включая карту расположения.

### <a name="add-a-location-property-in-the-dashboard"></a>Добавление свойства Location на панели мониторинга

Если вы настроили свойство Location, вы можете визуализировать расположение с картой на панели мониторинга устройства.

1. Перейдите на вкладку **Панель мониторинга**.

1. На панели мониторинга устройства выберите **карту** из библиотеки.

1. Укажите название карты. В следующем примере показано **Текущее расположение устройства**заголовков. Затем выберите свойство Location, настроенное ранее на вкладке **Свойства** . В следующем примере выбрано измерение **расположения устройства** :

   ![Настройка формы Map с подробными сведениями о заголовке и свойствах](./media/howto-set-up-template/locationcloudproperty6map.png)

1. Щелкните **Сохранить**. Теперь на фрагменте карты отображается выбранное расположение.

Можно изменить размер плитки карты. Когда оператор просматривает панель мониторинга в **Device Explorer**, отображаются все плитки панели мониторинга, которые вы настроили, включая карту расположения.

Дополнительные сведения об использовании плиток в Azure IoT Central см. в статье [использование плиток панели мониторинга](howto-use-tiles.md).

## <a name="next-steps"></a>Дальнейшие действия

Вы узнали, как настраивать шаблон устройства в приложении Azure IoT Central, а значит вы готовы к следующему шагу:

- [Создание версии шаблона нового устройства](howto-version-device-template.md)
- [Connect an MXChip IoT DevKit device to your Azure IoT Central application](howto-connect-devkit.md) (Подключение устройства MXChip IoT DevKit к приложению Azure IoT Central)
- [Подключение универсального клиентского приложения к приложению IoT Central Azure (Node. js)](howto-connect-nodejs.md)
