---
title: Определение нового типа устройства Интернета вещей в Azure IoT Central | Документация Майкрософт
description: В этой статье показано, как создать новый шаблон устройства Azure IoT в приложении IoT Central Azure. Вы определите данные телеметрии, состояние, свойства и команды для своего типа.
author: dominicbetts
ms.author: dobett
ms.date: 12/06/2019
ms.topic: how-to
ms.service: iot-central
services: iot-central
ms.custom:
- contperfq1
- device-developer
ms.openlocfilehash: aa70c9e5d67c759afe905e9e110d6bcd18555a8c
ms.sourcegitcommit: 43558caf1f3917f0c535ae0bf7ce7fe4723391f9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/11/2020
ms.locfileid: "90019246"
---
# <a name="define-a-new-iot-device-type-in-your-azure-iot-central-application"></a>Определение типа нового устройства Интернета вещей в приложении Azure IoT Central

*Эта статья предназначена для создателей решений и разработчиков устройств.*

Шаблон устройства — это схема, которая определяет характеристики и поведение типа устройства, которое подключается к [приложению Azure IOT Central](concepts-app-templates.md).

Например, сборщик может создать шаблон устройства для подключенного вентилятора со следующими возможностями и компонентами:

- отправка данных телеметрии температуры;
- отправка свойства расположения;
- отправка событий ошибки двигателя вентилятора;
- отправка состояния работы вентилятора;
- предоставление свойства скорости вращения вентилятора с возможностью записи;
- предоставление команды для перезагрузки устройства;
- предоставление панели мониторинга, которая обеспечивает общее представление устройства.

На основе этого шаблона устройства можно создавать и подключать реальные вентиляторы. Все эти вентиляторы имеют измерения, свойства и команды, которые операторы используют для отслеживания их работы и управления ими. Операторы используют [панели мониторинга](#add-dashboards) и формы устройства для взаимодействия с устройствами вентиляторов. Разработчик устройства использует шаблон, чтобы понять, как устройство взаимодействует с приложением. Дополнительные сведения см. в разделе [данные телеметрии, свойства и команды](concepts-telemetry-properties-commands.md).

> [!NOTE]
> Только администраторы и конструкторы могут создавать, изменять и удалять шаблоны устройств. На странице **Устройства** любой пользователь может создавать устройства на основе имеющихся шаблонов устройств.

В IoT Centralном приложении шаблон устройства использует модель возможностей устройства для описания возможностей устройства. Как у сборщика, у вас есть несколько вариантов создания шаблонов устройств:

- Разработайте шаблон устройства в IoT Central, а затем [реализуйте его модель возможностей устройства в коде устройства](concepts-telemetry-properties-commands.md).
- Импортируйте модель возможностей устройства из [каталога устройств Azure Certified for IoT](https://aka.ms/iotdevcat). Затем добавьте любые облачные свойства, настройки и панели мониторинга, необходимые приложению IoT Central.
- Создайте модель возможностей устройства с помощью Visual Studio Code. Реализуйте код вашего устройства из модели. Вручную импортируйте модель возможностей устройства в приложение IoT Central, а затем добавьте все облачные свойства, настройки и панели мониторинга, необходимые этому приложению.
- Создайте модель возможностей устройства с помощью Visual Studio Code. Реализуйте код устройства из модели и подключите устройство к приложению IoT Central, используя подключение нового устройства. IoT Central находит и импортирует модель возможностей устройства из общедоступного репозитория. Затем можно добавить любые облачные свойства, настройки и панели мониторинга, необходимые приложению IoT Central, в шаблон устройства.

Кроме того, можно добавлять шаблоны устройств в IoT Central приложение с помощью [REST API](https://docs.microsoft.com/learn/modules/manage-iot-central-apps-with-rest-api/) или [интерфейса командной строки](howto-manage-iot-central-from-cli.md).

Некоторые [шаблоны приложений](concepts-app-templates.md) уже содержат шаблоны устройств, которые полезны в сценарии, поддерживаемом шаблоном приложения. Например, см. раздел [архитектура аналитики в магазине](../retail/store-analytics-architecture.md).

## <a name="create-a-device-template-from-the-device-catalog"></a>Создание шаблона устройства из каталога устройств

Как создатель решения вы можете быстро приступить к работе с использованием сертифицированного устройства IoT Plug and Play (предварительная версия). Ознакомьтесь со списком в [каталоге устройств Azure IoT](https://catalog.azureiotsolutions.com/alldevices). IoT Central интегрируется с каталогом устройств, что позволяет импортировать модель возможностей устройства с любого из этих сертифицированных устройств IoT Plug and Play (предварительная версия). Чтобы создать шаблон устройства из одного из этих устройств в IoT Central, сделайте следующее:

1. Перейдите на страницу **Шаблоны устройств** в приложении IoT Central.
1. Щелкните **+ Создать** и выберите любое из сертифицированных устройств IoT Plug and Play (предварительная версия) в каталоге. IoT Central создает шаблон устройства на основе этой модели возможностей устройства.
1. Добавьте в шаблон устройства любые свойства облака, настройки или представления.
1. Щелкните **Опубликовать**, чтобы шаблон стал доступен операторам для просмотра и подключения устройств.

## <a name="create-a-device-template-from-scratch"></a>Создание шаблона устройства с нуля

Шаблон устройства содержит следующее:

- _Модель возможностей устройства_, определяющая телеметрию, свойства и команды, реализуемые устройством. Эти возможности упорядочены в виде одного или нескольких интерфейсов.
- _Свойства облака_, определяющие сведения, которые хранятся в приложении IoT Central для ваших устройств. Например, свойство облака может записывать данные о последнем обслуживании устройства. Эти сведения никогда не предоставляются устройству.
- _Настройки_ позволяют сборщику переопределять некоторые определения в модели возможностей устройства. Например, он может переопределить имя свойства устройства. Имена свойств отображаются на панелях мониторинга и в формах IoT Central.
- _Панели мониторинга и формы_, позволяющие сборщику создавать пользовательский интерфейс, чтобы операторы могли отслеживать устройства, подключенные к приложению, и управлять ими.

Чтобы создать шаблон устройства в IoT Central, сделайте следующее.

1. Перейдите на страницу **Шаблоны устройств** в приложении IoT Central.
1. Выберите **+ создать**  >  **Настраиваемый**.
1. Введите имя шаблона, например **Датчик окружающей среды**.
1. Нажмите клавишу **ВВОД**. IoT Central создаст пустой шаблон устройства.

## <a name="manage-a-device-template"></a>Управление шаблоном устройства

Вы можете переименовать или удалить шаблон на его домашней странице.

После добавления модели возможностей устройства в шаблон ее можно опубликовать. Пока вы не опубликуете шаблон, вы не сможете подключить устройство на основе этого шаблона, чтобы операторы могли видеть его на странице **Устройства**.

## <a name="create-a-capability-model"></a>Создание модели возможностей

Создать модель возможностей устройства можно таким образом:

- Используйте IoT Central для создания настраиваемой модели с нуля.
- Импортируйте модель из JSON-файла. Сборщик устройств может создавать модель возможностей устройства для приложения с помощью Visual Studio Code.
- Выберите одно из устройств в каталоге устройств. При использовании этого варианта импортируется модель возможностей устройства, опубликованная производителем для этого устройства. Модель возможностей устройства, импортированная подобным образом, публикуется автоматически.

## <a name="manage-a-capability-model"></a>Управление моделью возможностей

После создания модели возможностей устройства можно сделать следующее:

- Добавить интерфейсы в модель. Модель должна иметь по крайней мере один интерфейс.
- Изменить метаданные модели, такие как идентификатор, пространство имен и имя.
- Удалить модель.

## <a name="create-an-interface"></a>Создание интерфейса

Модель возможностей устройства должна иметь по крайней мере один интерфейс. Интерфейс — это многократно используемый набор возможностей.

Чтобы создать интерфейс, сделайте следующее:

1. Перейдите к модели возможностей устройства и выберите **+ добавить интерфейс**.

1. На странице **Выбор интерфейса** можно выполнить следующие действия:

    - Создать настраиваемый интерфейс с нуля.
    - Импортировать имеющийся интерфейс из файла. Сборщик устройств может создавать интерфейс для вашего устройства с помощью Visual Studio Code.
    - Выберите один из стандартных интерфейсов, например интерфейс **сведений об устройстве** . Стандартные интерфейсы определяют возможности, общие для многих устройств. Эти интерфейсы публикуются с помощью Azure IoT и не поддерживают управление версиями или изменения.

1. Создав интерфейс, щелкните **Изменить удостоверение**, чтобы изменить отображаемое имя интерфейса.

1. При создании настраиваемого интерфейса с нуля можно добавить возможности устройства. Возможности устройства — это данные телеметрии, свойства и команды.

### <a name="telemetry"></a>Телеметрия

Телеметрия — это поток значений, отправляемых с устройства (обычно из датчика). Например, датчик может передавать температуру окружающей среды.

В следующей таблице показаны параметры конфигурации для возможностей телеметрии.

| Поле | Описание |
| ----- | ----------- |
| Отображаемое имя | Отображаемое имя для значения телеметрии, используемое на панелях мониторинга и формах. |
| name | Имя поля в сообщении телеметрии. IoT Central создает значение для этого поля на основе отображаемого имени, но при необходимости можно выбрать собственное значение. Это поле должно быть буквенно-цифровым. |
| Тип возможности | Телеметрия. |
| Семантический тип | Семантический тип телеметрии, например температура, состояние или событие. Выбор семантического типа определяет, какие из следующих полей будут доступны. |
| схема | Тип данных телеметрии, например double, string или vector. Доступные варианты определяются семантическим типом. Для семантических типов событий и состояний схема недоступна. |
| Статус | Доступно только для семантического типа события. Возможны такие степени серьезности: **Ошибка**, **Сведения** или **Предупреждение**. |
| Значения состояния | Доступно только для семантического типа состояния. Определите возможные значения состояния, для каждого из которых есть отображаемое имя, название, тип перечисления и значение. |
| Единицы | Единица измерения для значения телеметрии, например **миль/ч**, **%** или ** &deg; C**. |
| Единица отображения | Отображаемая единица для использования на панелях мониторинга и в формах. |
| Комментировать | Любые комментарии о возможности "Телеметрия". |
| Описание | Описание возможности "Телеметрия". |

### <a name="properties"></a>Свойства

Свойства представляют собой значения на момент во времени. Например, устройство может использовать свойство для передачи значения целевой температуры, которого пытается достичь устройство. Записываемые свойства можно задать в IoT Central.

В следующей таблице показаны параметры конфигурации для возможности "Свойства".

| Поле | Описание |
| ----- | ----------- |
| Отображаемое имя | Отображаемое имя для значения свойств, используемое на панелях мониторинга и в формах. |
| name | Имя свойства. IoT Central создает значение для этого поля на основе отображаемого имени, но при необходимости можно выбрать собственное значение. Это поле должно быть буквенно-цифровым. |
| Тип возможности | Свойство. |
| Семантический тип | Семантический тип свойства, например температура, состояние или событие. Выбор семантического типа определяет, какие из следующих полей будут доступны. |
| схема | Тип данных свойства, например double, string или vector. Доступные варианты определяются семантическим типом. Для семантических типов событий и состояний схема недоступна. |
| Writeable (Доступно для записи) | Если свойство недоступно для записи, устройство может передавать значения свойств в IoT Central. Если свойство доступно для записи, устройство может передавать значения свойств в IoT Central, а IoT Central может передавать обновленные свойства на устройство.
| Статус | Доступно только для семантического типа события. Возможны такие степени серьезности: **Ошибка**, **Сведения** или **Предупреждение**. |
| Значения состояния | Доступно только для семантического типа состояния. Определите возможные значения состояния, для каждого из которых есть отображаемое имя, название, тип перечисления и значение. |
| Единицы | Единица измерения для значения свойства, например **миль/ч**, **%** или ** &deg; C**. |
| Единица отображения | Отображаемая единица для использования на панелях мониторинга и в формах. |
| Комментировать | Любые комментарии о возможности "Свойство". |
| Описание | Описание возможности "Свойство". |

### <a name="commands"></a>Команды

Команды устройства можно вызывать в IoT Central. Команды при необходимости передают параметры на устройство и получают от него ответ. Например, можно вызвать команду для перезагрузки устройства через 10 секунд.

В следующей таблице показаны параметры конфигурации для возможности "Команда".

| Поле | Описание |
| ----- | ----------- |
| Отображаемое имя | Отображаемое имя для команды, используемое на панелях мониторинга и в формах. |
| name | Имя команды. IoT Central создает значение для этого поля на основе отображаемого имени, но при необходимости можно выбрать собственное значение. Это поле должно быть буквенно-цифровым. |
| Тип возможности | Команда |
| Get-Help | `SynchronousExecutionType`. |
| Комментировать | Любые комментарии о возможности "Команда". |
| Описание | Описание возможности "Команда". |
| Запрос | Если параметр включен, определение параметра запроса включает в себя: название, отображаемое имя, схему, единицу измерения и отображаемую единицу. |
| Ответ | Если параметр включен, определение ответа команды включает в себя: название, отображаемое имя, схему, единицу измерения и отображаемую единицу. |

## <a name="manage-an-interface"></a>Управление интерфейсом

Если интерфейс не опубликован, определяемые им возможности можно изменить. Чтобы внести изменения после публикации интерфейса, необходимо создать другую версию шаблона устройства и версию интерфейса. Изменения, для которых не требуется управление версиями, такие как отображаемые имена или единицы, можно выполнить в разделе **Настройка**.

Вы также можете экспортировать интерфейс в виде JSON-файла, если хотите использовать его в другой модели возможностей.

## <a name="add-cloud-properties"></a>Добавление свойств облака

Свойства облака можно использовать для хранения сведений об устройствах в IoT Central. Свойства облака никогда не отправляются на устройство. Например, свойства облака можно использовать для хранения имени клиента, установившего устройство, или даты последнего обслуживания устройства.

В следующей таблице показаны параметры конфигурации для свойства облака.

| Поле | Описание |
| ----- | ----------- |
| Отображаемое имя | Отображаемое имя для значения свойств облака, используемое на панелях мониторинга и в формах. |
| name | Имя свойства облака. IoT Central создает значение для этого поля на основе отображаемого имени, но при необходимости можно выбрать собственное значение. |
| Семантический тип | Семантический тип свойства, например температура, состояние или событие. Выбор семантического типа определяет, какие из следующих полей будут доступны. |
| схема | Тип данных свойства облака, например double, string или vector. Доступные варианты определяются семантическим типом. |

## <a name="add-customizations"></a>Добавление настройки

С помощью настроек можно изменить импортированный интерфейс или добавить функции IoT Central для возможности. Настраивать можно только те поля, которые не нарушают совместимость интерфейса. Например, администратор может сделать следующее:

- Настроить отображаемое имя и единицы измерения для возможности.
- Добавить цвет по умолчанию, который используется для значений на диаграмме.
- Указать начальные, минимальные и максимальные значения для свойства.

Вы не сможете изменить имя или тип возможности. Если есть изменения, которые нельзя внести в разделе **Настройка**, вам потребуется создать версию шаблона устройства и интерфейса, чтобы изменить эту возможность.

### <a name="generate-default-views"></a>Создание представлений по умолчанию

Представления по умолчанию позволяют быстро визуализировать важную информацию об устройстве. Для шаблона устройства можно создать до трех представлений по умолчанию.

- **Команды** — представление с командами устройства, которое позволяет оператору отправлять их на устройство.
- **Обзор** — представление с данными телеметрии устройства, в котором отображаются диаграммы и метрики.
- **Об устройстве** — представление со сведениями об устройстве, содержащее свойства устройства.

Выбрав действие **Создать представления по умолчанию**, представления автоматически добавляются в раздел **Представления** в шаблоне устройства.

## <a name="add-dashboards"></a>Добавление панелей мониторинга

Добавьте панели мониторинга в шаблон устройства, чтобы позволить операторам визуализировать работу устройства с помощью диаграмм и метрик. Для шаблона устройства можно использовать несколько панелей мониторинга.

Чтобы добавить панель мониторинга в шаблон устройства, сделайте следующее:

1. Перейдите к шаблону устройства и выберите **представления**.
1. Щелкните **Визуализация устройства**.
1. Введите имя панели мониторинга в поле **Имя панели мониторинга**.
1. Добавьте плитки на панель мониторинга из списка плиток статических свойств, свойств облака, телеметрии и команд. Перетащите плитки, которые вы хотите добавить на панель мониторинга.
1. Чтобы построить несколько значений телеметрии на одной плитке диаграммы, выберите значения телеметрии, а затем нажмите кнопку **объединить**.
1. Настройте каждую добавляемую плитку, указав для нее метод отображения данных. Для этого щелкните значок шестеренки или нажмите кнопку **Изменить конфигурацию** на плитке графика.
1. Упорядочьте плитки и измените их размер на панели мониторинга.
1. Сохраните изменения.

### <a name="configure-preview-device-to-view-dashboard"></a>Настройка предварительной версии устройства для просмотра панели мониторинга

Чтобы просмотреть и проверить панель мониторинга, выберите **Configure preview device** (Настройка предварительной версии устройства). Это позволяет просматривать панель мониторинга так, как ее видит оператор после публикации. Используйте этот параметр, чтобы проверить, отображаются ли в представлениях правильные данные. Вы можете выбрать один из следующих параметров:

- устройство без предварительной версии;
- реальное устройство для тестирования, настроенное для шаблона устройства;
- имеющееся устройство в приложении (с указанием идентификатора устройства).

## <a name="add-forms"></a>Добавление форм

Добавьте формы в шаблон устройства, чтобы операторы могли управлять устройством путем просмотра и настройки свойств. Операторы могут изменять только свойства облака и доступные для записи свойства устройства. Для шаблона устройства можно использовать несколько форм.

Чтобы добавить форму в шаблон устройства, сделайте следующее:

1. Перейдите к шаблону устройства и выберите **представления**.
1. Щелкните **Изменение устройства и облачных данных**.
1. Введите имя формы в поле **Имя формы**.
1. Выберите число столбцов, которое будет использоваться при создании макета формы.
1. Добавьте свойства в имеющийся раздел формы или выберите свойства и нажмите кнопку **Добавить раздел**. Используйте разделы для группировки свойств в форме. В раздел можно добавить заголовок.
1. Настройте каждое свойство в форме, чтобы изменить его поведение.
1. Расположите свойства в форме нужным образом.
1. Сохраните изменения.

## <a name="publish-a-device-template"></a>Публикация шаблона устройства

Прежде чем подключать устройство, реализующее модель возможностей устройства, необходимо опубликовать шаблон устройства.

После публикации шаблона устройства можно вносить только ограниченные изменения в модель возможностей устройства. Чтобы изменить интерфейс, необходимо [создать и опубликовать новую версию](./howto-version-device-template.md).

Чтобы опубликовать шаблон устройства, перейдите к шаблону устройства и выберите **опубликовать**.

После публикации шаблона устройства оператор может перейти на страницу **Устройства** и добавить реальные или имитированные устройства, использующие шаблон устройства. Вы можете продолжать изменять и сохранять шаблон устройства по мере внесения изменений. Если вы хотите отправить эти изменения оператору для просмотра на странице **Устройства**, необходимо каждый раз выбирать **Опубликовать**.

## <a name="next-steps"></a>Дальнейшие действия

Если вы являетесь разработчиком устройства, рекомендуем следующий шаг — ознакомиться с [управлением версиями шаблонов устройств](./howto-version-device-template.md).
