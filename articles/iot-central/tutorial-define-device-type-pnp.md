---
title: Определение типа нового устройства в Azure IoT Central | Документация Майкрософт
description: В этом руководстве показано, как разработчики могут создать новый тип устройства в приложении Azure IoT Central. Вы определите данные телеметрии, состояние, свойства и команды для своего типа.
author: dominicbetts
ms.author: dobett
ms.date: 08/06/2019
ms.topic: tutorial
ms.service: iot-central
services: iot-central
ms.custom: mvc
manager: philmea
ms.openlocfilehash: a622aa85d1d0a9dcd5d5ad9b2b30e7a3120ea974
ms.sourcegitcommit: b3bad696c2b776d018d9f06b6e27bffaa3c0d9c3
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/21/2019
ms.locfileid: "69878635"
---
# <a name="tutorial-define-a-new-device-type-in-your-azure-iot-central-application-preview-features"></a>Руководство по Определение нового типа устройства в приложении Azure IoT Central (предварительная версия функций)

[!INCLUDE [iot-central-pnp-original](../../includes/iot-central-pnp-original-note.md)]

В этом руководстве показано, как разработчики могут использовать шаблон устройства для определения типа нового устройства в приложении Microsoft Azure IoT Central. Шаблон устройства определяет возможности устройства. К возможностям относятся отправляемые устройством данные телеметрии, свойства этого устройства и команды, на которые оно реагирует.

В рамках этого руководства вы создадите шаблон устройства **датчика среды**. Устройство датчика среды выполняет следующие функции:

* отправляет данные телеметрии, например температуру;
* информирует о свойствах самого устройства, например об уровне яркости;
* реагирует на команды, например включения и отключения;
* информирует о базовых свойствах устройств, таких как версия встроенного ПО и серийный номер.

Из этого руководства вы узнаете, как выполнять следующие задачи:

> [!div class="checklist"]
> * создание шаблона устройства;
> * импорт модели возможностей устройства;
> * создание свойств облака;
> * определение визуализации для данных телеметрии устройства;
> * публикация шаблона устройства;
> * создание имитированного устройства по шаблону устройства;
> * просмотр имитированного устройства.

## <a name="prerequisites"></a>Предварительные требования

Для работы с этим руководством вам потребуется приложение Azure IoT Central. Если вы завершили работу с руководством по [созданию приложения Azure IoT Central](quick-deploy-iot-central-pnp.md?toc=/azure/iot-central-pnp/toc.json&bc=/azure/iot-central-pnp/breadcrumb/toc.json), вы можете повторно использовать созданное в нем приложение. В противном случае выполните следующие шаги для создания пустого приложения Azure IoT Central:

1. Перейдите на страницу [диспетчера приложений](https://aka.ms/iotcentral) в Azure IoT Central.

1. Если у вас есть подписка Azure, выполните вход с учетными данными для доступа к ней. Если ее нет, используйте учетную запись Майкрософт:

    ![Ввод учетной записи организации](./media/tutorial-define-device-type-pnp/sign-in.png)

1. Чтобы начать создание приложения Azure IoT Central, выберите **Новое приложение**.

Чтобы создать новое приложение Azure IoT Central, которое использует IoT Plug and Play и (или) другие функции предварительной версии, сделайте следующее:

1. Выберите **Пробная версия**. Для создания приложения в рамках пробной версии вам не потребуется подписка Azure.

    Дополнительные сведения о каталогах и подписках см. в статье [Создание приложения Azure IoT Central](quick-deploy-iot-central-pnp.md?toc=/azure/iot-central-pnp/toc.json&bc=/azure/iot-central-pnp/breadcrumb/toc.json).

1. Щелкните **Предварительная версия приложения**.

1. Дополнительно можно указать понятное имя приложения, например **Contoso Air Conditioners** (Кондиционеры Contoso). Azure IoT Central создаст уникальный префикс URL-адреса. Вы можете изменить этот префикс на что-то более запоминающееся.

1. Для пробной версии приложения укажите свои контактные данные.

1. Нажмите кнопку **Создать**.

    ![Страница создания приложения Azure IoT Central](./media/tutorial-define-device-type-pnp/iotcentralcreate.png)

    Дополнительные сведения см. в [кратком руководстве по созданию приложения](quick-deploy-iot-central-pnp.md?toc=/azure/iot-central-pnp/toc.json&bc=/azure/iot-central-pnp/breadcrumb/toc.json).

Также вам потребуется локальная копия файла **EnvironmentalSensorInline.capabilitymodel.json**, который содержит модель возможностей устройства [IoT Plug and Play](https://aka.ms/iot-pnp-docs). Скачать эту версию можно [здесь](https://raw.githubusercontent.com/Azure/IoTPlugandPlay/master/samples/EnvironmentalSensorInline.capabilitymodel.json). Щелкните страницу правой кнопкой мыши и выберите **Сохранить как**.

Когда скачивание файла завершится, откройте его в текстовом редакторе и замените два вхождения строки `<YOUR_COMPANY_NAME_HERE>` своим именем. Используйте только символы a–z, A–Z, 0–9 и знак подчеркивания.

## <a name="create-a-template"></a>Создание шаблона

Вы (как разработчик) можете создавать и редактировать шаблоны устройств в своем приложении. После публикации шаблона устройства вы можете создать имитацию устройства или подключить реальные устройства, реализующие этот шаблон устройства. Имитированные устройства позволяют проверять поведение приложения перед подключением реального устройства.

Чтобы добавить в приложение новый шаблон устройства, перейдите к странице **Шаблоны устройств**. Для этого выберите вкладку **Шаблоны устройств** в меню навигации слева.

![Страница шаблонов устройств](./media/tutorial-define-device-type-pnp/devicedefinitions.png)

### <a name="add-a-device-capability-model"></a>Добавление модели возможностей устройства

В IoT Central есть несколько способов создать модель возможностей устройства. Вы можете создать пользовательскую модель с нуля, импортировать ее из файла, выбрать из каталога устройств или с помощью функции подключения устройств подключить устройство IoT Plug and Play, модель возможностей для которого опубликована в общедоступном репозитории. В рамках этого руководства вы импортируете модель возможностей устройства из файла.

Ниже описано, как импортировать модель возможностей для **датчика среды**. Эти устройства отправляют в приложение данные телеметрии, например показатели температуры и давления.

1. Чтобы добавить новый шаблон устройства, щелкните **Создать** на странице **Шаблоны устройств**.

1. Выберите вариант **Пользовательский** в списке моделей возможностей устройства.

1. Введите для шаблона устройства имя **Environmental Sensor** (Датчик среды).

1. Выберите **Импорт модели возможностей**, чтобы создать новую модель возможностей устройства на основе JSON-файла. Перейдите на локальном компьютере к папке, в которой ранее сохранили файл **EnvironmentalSensorInline.capabilitymodel.json**. Выберите файл **EnvironmentalSensorInline.capabilitymodel.json** и щелкните "Импорт". Модель возможностей датчика среды включает интерфейсы **Environmental Sensor** (Датчик среды) и **Device Information** (Сведения об устройстве):

    ![Модель возможностей устройства для датчика среды](./media/tutorial-define-device-type-pnp/newdevicecapabilitymodel.png)

    Эти интерфейсы определяют возможности **датчика среды**. К этим возможностям относятся данные телеметрии, свойства этого устройства и команды, на которые оно реагирует.

### <a name="add-cloud-properties"></a>Добавление свойств облака

Шаблон устройства может содержать свойства облака. Свойства облака существуют только в приложении IoT Central и никогда не отправляются на устройство и не принимаются с него.

1. Выберите **Свойства облака**, а затем **+ Добавить облачное свойство**. Воспользуйтесь сведениями в следующей таблице, чтобы добавить свойство облака в шаблон устройства.

    | Отображаемое имя      | Семантический тип | Схема |
    | ----------------- | ------------- | ------ |
    | Дата последнего обслуживания | Нет          | Дата   |
    | Имя клиента.     | Нет          | Строка, |

1. Щелкните **Сохранить**, чтобы сохранить изменения.

    ![Свойства облака](media/tutorial-define-device-type-pnp/cloudproperties.png)

### <a name="add-customizations"></a>Добавление настройки

С помощью настроек можно изменить интерфейс или добавить функции IoT Central для возможности, которая не требует создания новой версии модели возможностей устройства. Вы можете изменять поля, когда модель возможностей находится в черновом или опубликованном состоянии. Настраивать можно только те поля, которые не нарушают совместимость интерфейса. Например, вы можете просматривать:

- Настроить отображаемое имя и единицы измерения для возможности.
- Добавить цвет по умолчанию, который используется для значений на диаграмме.
- Указать начальные, минимальные и максимальные значения для свойства.

Вы не сможете изменить имя или тип возможности.


## <a name="create-views"></a>Создание представлений

Вы (как разработчик) можете настроить в приложении отображение для оператора сведений о подключенном датчике среды. Ваши настройки позволят оператору управлять устройствами датчиков среды, подключенными к приложению. Вы можете создать два типа представлений, которые позволят оператору взаимодействовать с устройствами.

* Формы для просмотра и редактирования свойств устройства и облака.
* Панели мониторинга для визуализации устройств.

### <a name="generate-default-views"></a>Создание представлений по умолчанию

Представления по умолчанию позволяют быстро визуализировать важную информацию об устройстве. Для шаблона устройства можно создать до трех представлений по умолчанию.

* Представление **Команды** позволяет оператору отправлять команды на устройство.
* В представлении **Обзор** отображаются данные телеметрии с устройства в виде схем и метрик.
* В представлении **Сведения** отображаются свойства устройства.

Когда вы выбираете действие **Generate default views** (Создать представления по умолчанию), представления автоматически добавляются в раздел **Представления** в шаблоне устройства.

### <a name="configure-a-view-to-visualize-devices"></a>Настройка представления для визуализации устройств

Панель мониторинга устройства позволяет оператору визуализировать устройство с помощью диаграмм и метрик. Как конструктор вы можете определить, какие сведения будут отображаться на панели мониторинга устройства. Вы можете определить для устройства несколько панелей мониторинга. Чтобы создать панель мониторинга для визуализации телеметрии датчика среды, выберите **Представления**, а затем **Визуализация устройства**:

1. Все свойства устройства, свойства облака, данные телеметрии и статические параметры перечислены на панели справа. Вы можете перетащить любой из этих элементов в представление. Перетащите свойство в представление. Плитку можно настроить с помощью значка шестеренки.

1. Чтобы добавить диаграмму для данных телеметрии, выберите параметры **Humidity** (Влажность) и **Temperature** (Температура), а затем щелкните **Объединить**. Чтобы просмотреть эту диаграмму в любом другом формате, например в виде круговой диаграммы или линейчатой диаграммы, нажмите кнопку **Изменить визуализацию** в верхней части плитки.

1. Выберите **Сохранить**, чтобы сохранить представление.

Вы можете добавить дополнительные плитки для других свойств или значений телеметрии. Можно также добавить статический текст, ссылки и (или) изображения. Чтобы переместить плитку на панели мониторинга или изменить ее размер, наведите указатель мыши на плитку, а затем перетащите ее на новое место или перетащите границу.

### <a name="add-a-device-form"></a>Добавление формы устройств

Форма устройства позволяет оператору изменять доступные для записи свойства устройства и свойства облака. Вы (как разработчик) можете определить несколько форм и выбрать, какие свойства устройства и облака будут отображаться в каждой из них. В форме также можно отображать свойства устройства, доступные только для чтения.

Чтобы создать форму для просмотра и редактирования свойств датчика среды, сделайте следующее:

1. Щелкните плитку **Изменение устройства и облачных данных**.

1. Введите имя формы **Environmental Sensor properties** (Свойства датчика среды).

1. Перетащите свойства облака **Customer name** (Имя клиента) и **Last service date** (Дата последнего обслуживания) в существующий раздел формы.

1. Выберите свойства **Brightness Level** (Уровень яркости) и **Device State** (Состояние устройства). Затем щелкните **Добавить раздел**. Измените заголовок раздела, присвоив ему значение **Sensor properties** (Свойства датчика). Нажмите кнопку **Применить**.

1. Выберите свойства устройства **Battery remaining** (Заряд аккумулятора), **Device model** (Модель устройства), **Firmware version** (Версия встроенного ПО), **Manufacturer** (Производитель) и **Serial number** (Серийный номер). Затем щелкните **Добавить раздел**. Измените заголовок раздела, присвоив ему значение **Device properties** (Свойства устройства). Нажмите кнопку **Применить**.

1. Выберите **Сохранить**, чтобы сохранить представление.


## <a name="publish-device-template"></a>Публикация шаблона устройства

Прежде чем создать имитированный датчик среды или подключить реальный датчик, необходимо опубликовать шаблон устройства.

Для публикации шаблона устройства сделайте следующее:

1. Откройте шаблон устройства на странице **Шаблоны устройств**.

1. Нажмите кнопку **Опубликовать**.

1. В диалоговом окне **Publish a Device Template** (Публикация шаблона устройства) щелкните **Опубликовать**:

    ![Опубликованная модель](media/tutorial-define-device-type-pnp/publishedmodel.png)

После публикации шаблона устройства он отображается на странице **Устройства** и в представлении для оператора. В опубликованном шаблоне устройства уже нельзя изменить модель возможностей устройства без создания новой версии. Но вы можете вносить изменения в свойства облака, настройки и представления в шаблоне опубликованного устройства, не создавая новых версий. После внесения изменений щелкните **Опубликовать**, чтобы передать эти изменения оператору.

## <a name="next-steps"></a>Дополнительная информация

Из этого руководства вы узнали, как выполнить следующие задачи:

* Создание шаблона нового устройства
* импорт модели возможностей устройства;
* создание свойств облака;
* создание настроек;
* определение визуализации для данных телеметрии устройства;
* публикация шаблона устройства.

Итак, вы определили шаблон устройства в приложении Azure IoT Central и можете перейти к следующему этапу:

> [!div class="nextstepaction"]
> [Добавление устройства](tutorial-add-device-pnp.md?toc=/azure/iot-central-pnp/toc.json&bc=/azure/iot-central-pnp/breadcrumb/toc.json)
