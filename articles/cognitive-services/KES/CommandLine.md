---
title: Интерфейс командной строки — API службы поиска и распознавания данных
titlesuffix: Azure Cognitive Services
description: Используйте интерфейс командной строки для создания индекса и файлов грамматики на основе структурированных данных, а затем разверните их как веб-службы.
services: cognitive-services
author: bojunehsu
manager: nitinme
ms.service: cognitive-services
ms.subservice: knowledge-exploration
ms.topic: conceptual
ms.date: 03/24/2016
ms.author: paulhsu
ms.openlocfilehash: 018552982a8ece3bbbaea2d60e2a6e64f681f822
ms.sourcegitcommit: 3102f886aa962842303c8753fe8fa5324a52834a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "60815140"
---
# <a name="command-line-interface"></a>Интерфейс командной строки

Интерфейс службы поиска и распознавания данных (KES) командной строки предоставляет возможность создавать файлы индекса и грамматики структурированных данных и развертывать их как веб-службы.  Используется следующий общий синтаксис: `kes.exe <command> <required_args> [<optional_args>]`.  Можно выполнить `kes.exe` без аргументов, чтобы отобразить список команд, или можно выполнить `kes.exe <command>`, чтобы отобразить список аргументов для заданной команды.  Ниже приведен список доступных команд:

* build_index
* build_grammar
* host_service
* deploy_service
* describe_index
* describe_grammar

<a name="build_index-command"></a>

## <a name="buildindex-command"></a>Команда build_index

Команда **build_index** выполняет сборку двоичного файла индекса на основе файла определения схемы и файла данных индексируемых объектов.  Полученный файл индекса можно использовать для вычисления структурированных выражений запросов или создания интерпретаций для запросов на естественном языке в сочетании со скомпилированным файлом грамматики.

`kes.exe build_index <schemaFile> <dataFile> <indexFile> [options]`

| Параметр      | ОПИСАНИЕ               |
|----------------|---------------------------|
| `<schemaFile>` | Путь к входной схеме |
| `<dataFile>`   | Путь к входным данным   |
| `<indexFile>`  | Путь к выходному индексу |
| `--description <description>` | Строка описания |
| `--remote <vmSize>`           | Размер виртуальной машины для удаленной сборки |

Можно указать локальные пути к файлам или URL-адреса больших двоичных объектов Azure.  Файл схемы описывает структуру индексируемых объектов, а также поддерживаемые операции (см. раздел [Формат схемы](SchemaFormat.md)).  В файле данных перечислены объекты и значения атрибутов для индексирования (см. раздел [Формат данных](DataFormat.md)).  После успешного создания выходной файл индекса содержит сжатое представление входных данных, поддерживающее требуемые операции.  

Строка описания может быть указана по желанию, чтобы обеспечить последующее определение двоичного индекса с помощью команды **describe_index**.  

По умолчанию сбора индекса выполняется на локальном компьютере.  Вне среды Azure поддерживаются локальные сборки на основе файлов данных, содержащих до 10 000 объектов.  Если указан флаг --remote, индекс будет создан на временно созданной виртуальной машине Azure указанного размера.  Это позволяет эффективно создавать большие индексы с помощью виртуальных машин Azure с большим объемом памяти.  Во избежание подкачки, которая замедляет процесс сборки, рекомендуется использовать виртуальную машину, объем ОЗУ которой в три раза превышает размер файла входных данных.  Список доступных размеров виртуальных машин приведен в разделе [Размеры виртуальных машин Windows в Azure](../../../articles/virtual-machines/virtual-machines-windows-sizes.md).

> [!TIP] 
> Чтобы ускорить создание, предварительно отсортируйте объекты в файле данных в порядке убывания вероятности.

<a name="build_grammar-command"></a>

## <a name="buildgrammar-command"></a>Команда build_grammar

Команда **build_grammar** компилирует грамматику, указанную в XML-файле, преобразуя ее в двоичную грамматику.  Полученный файл грамматики можно использовать с файлом индекса для формирования интерпретаций запросов на естественном языке.

`kes.exe build_grammar <xmlFile> <grammarFile>`

| Параметр       | ОПИСАНИЕ               |
|-----------------|---------------------------|
| `<xmlFile>`     | Путь к входной спецификации грамматики в формате XML |
| `<grammarFile>` | Путь к выходной скомпилированной грамматике         |

Можно указать локальные пути к файлам или URL-адреса больших двоичных объектов Azure.  Спецификация грамматики описывает набор взвешенных выражений на естественном языке и их семантических интерпретаций (см. раздел [Формат грамматики](GrammarFormat.md)).  После успешного создания выходной файл грамматики будет содержать двоичное представление спецификации грамматики, что обеспечит быстрое декодирование.

<a name="host_service-command"/>

## <a name="hostservice-command"></a>Команда host_service

Команда **host_service** размещает экземпляр службы KES на локальном компьютере.

`kes.exe host_service <grammarFile> <indexFile> [options]`

| Параметр       | ОПИСАНИЕ                |
|-----------------|----------------------------|
| `<grammarFile>` | Путь к входной двоичной грамматике         |
| `<indexFile>`   | Путь к входному двоичному индексу           |
| `--port <port>` | Номер локального порта.  Значение по умолчанию: 8000 |

Можно указать локальные пути к файлам или URL-адреса больших двоичных объектов Azure.  Веб-служба будет размещена по адресу http://localhost:&lt;порт&gt;/.  В разделе о [веб-API](WebAPI.md) представлен список поддерживаемых операций.

За пределами среды Azure для локально размещенных служб действуют следующие ограничения при индексировании: размер файла до 1 МБ, до 10 запросов в секунду и до 1000 вызовов.  Чтобы устранить эти ограничения, выполните команду **host_service** на виртуальной машине Azure или выполните развертывание в облачной службе Azure с помощью команды **deploy_service**.

<a name="deploy_service-command"/>

## <a name="deployservice-command"></a>Команда deploy_service

Команда **deploy_service** выполняет развертывание экземпляра службы KES в облачной службе Azure.

`kes.exe deploy_service <grammarFile> <indexFile> <serviceName> <vmSize>[options]`

| Параметр       | ОПИСАНИЕ                  |
|-----------------|------------------------------|
| `<grammarFile>` | Путь к входной двоичной грамматике           |
| `<indexFile>`   | Путь к входному двоичному индексу             |
| `<serviceName>` | Имя целевой облачной службы. |
| `<vmSize>`      | Размер виртуальной машины облачной службы     |
| `--slot <slot>` | Слот облачной службы: "staging" (по умолчанию), "production" |

Можно указать локальные пути к файлам или URL-адреса больших двоичных объектов Azure.  Имя службы указывает предварительно настроенную облачную службу Azure (см. раздел [Создание и развертывание облачной службы](../../../articles/cloud-services/cloud-services-how-to-create-deploy-portal.md)).  Команда автоматически развернет службу KES в указанной облачной службе Azure с использованием виртуальных машин указанного размера.  Во избежание подкачки, которая значительно снижает производительность, рекомендуется использовать виртуальную машину, размер ОЗУ которой на 1 ГБ превышает размер входного файла индекса.  Список доступных размеров виртуальных машин приведен в разделе [Размеры для облачных служб](../../../articles/cloud-services/cloud-services-sizes-specs.md).

По умолчанию служба развертывается в промежуточной среде, при необходимости ее можно переопределить с помощью параметра --slot.  В разделе о [веб-API](WebAPI.md) представлен список поддерживаемых операций.

<a name="describe_index-command"/>

## <a name="describeindex-command"></a>Команда describe_index

Команда **describe_index** выводит сведения о файле индекса, включая описание и схему.

`kes.exe describe_index <indexFile>`

| Параметр     | ОПИСАНИЕ      |
|---------------|------------------|
| `<indexFile>` | Путь к входному индексу |

Можно указать путь к локальному файлу или URL-адрес большого двоичного объекта Azure.  Выходную строку описания можно задать с помощью параметра --description команды **build_index**.

<a name="describe_grammar-command"/>

## <a name="describegrammar-command"></a>Команда describe_grammar

Команда **describe_grammar** выводит исходную спецификацию грамматики, использованную для создания двоичной грамматики.

`kes.exe describe_grammar <grammarFile>`

| Параметр       | ОПИСАНИЕ      |
|-----------------|------------------|
| `<grammarFile>` | Путь к входной грамматике |

Можно указать путь к локальному файлу или URL-адрес большого двоичного объекта Azure.

