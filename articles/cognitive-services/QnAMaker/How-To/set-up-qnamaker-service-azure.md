---
title: Настройка сервиса для создателей - NA Maker
description: Перед созданием базы знаний службы QnA Maker необходимо настроить эту службу в Azure. Настроить службу QnA Maker может любой пользователь с правами на создание ресурсов в подписке.
ms.topic: conceptual
ms.date: 03/19/2020
ms.openlocfilehash: 563a56fdb288568e7fe667fa54658400064a560f
ms.sourcegitcommit: b80aafd2c71d7366838811e92bd234ddbab507b6
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/16/2020
ms.locfileid: "81402989"
---
# <a name="manage-qna-maker-resources"></a>Управление ресурсами компании «NA Maker»

Перед созданием базы знаний службы QnA Maker необходимо настроить эту службу в Azure. Настроить службу QnA Maker может любой пользователь с правами на создание ресурсов в подписке.

Перед созданием ресурса полезно глубокое понимание следующих понятий:

* [Ресурсы QnA Maker](../Concepts/azure-resources.md)
* [Авторство и публикация ключей](../Concepts/azure-resources.md#keys-in-qna-maker)

## <a name="create-a-new-qna-maker-service"></a>Создание службы QnA Maker

Эта процедура создает ресурсы Azure, необходимые для управления содержанием базы знаний. После завершения этих шагов ключи _подписки_ на странице **Ключей** для ресурса на портале Azure.

1. Вопийте на портале Azure и создавайте ресурс [NA Maker.](https://ms.portal.azure.com/#create/Microsoft.CognitiveServicesQnAMaker)

1. Выберите **Создать** после прочтения условий:

    ![Создание службы QnA Maker](../media/qnamaker-how-to-setup-service/create-new-resource-button.png)

1. В **компании «NA Maker»** выберите соответствующие уровни и регионы:

    ![Создание службы QnA Maker — ценовая категория и регионы](../media/qnamaker-how-to-setup-service/enter-qnamaker-info.png)

    * В поле **Name** введите уникальное имя, чтобы идентифицировать эту услугу «NA Maker». Это имя также определяет конечную точку, с которую будут связаны ваши базы знаний.
    * Выберите **Подписку,** в соответствии с которой будет развернут ресурс NA Maker.
    * Выберите **уровень ценообразования** для услуг по управлению snA Maker (аПОИ портала и управления). Подробнее [о ценах SKU.](https://aka.ms/qnamaker-pricing)
    * Создайте новую **группу ресурсов** (рекомендуется) или используйте существующую группу, в которой развернуть этот ресурс NA Maker. Создатель NA создает несколько ресурсов Azure. При создании группы ресурсов для хранения этих ресурсов можно легко найти, управлять и удалять эти ресурсы по имени группы ресурсов.
    * Выберите **месторасположение группы ресурсов.**
    * Выберите **уровень ценообразования в поиске** службы когнитивного поиска Azure. Если опция Free tier недоступна (появляется затемненной), это означает, что у вас уже есть бесплатная услуга, развернутая через подписку. В этом случае вам нужно начать с базового уровня. Смотрите [сведения о ценах на azure Cognitive Search.](https://azure.microsoft.com/pricing/details/search/)
    * Выберите **место поиска,** где необходимо развернуть индексы когнитивного поиска Azure Cognitive Search. Ограничения на хранение данных клиентов помогут определить место, где вы выбираете место для Azure Cognitive Search.
    * В поле **имени приложения** введите имя для экземпляра службы приложений Azure.
    * По умолчанию служба app по умолчанию по умолчанию перешел на стандартный (S1) уровень. Вы можете изменить выбранный план после создания службы. Узнайте больше о ценах на [службу приложений](https://azure.microsoft.com/pricing/details/app-service/).
    * Выберите **место расположение веб-сайта,** где будет развернута служба приложений.

        > [!NOTE]
        > **Местоположение поиска** может отличаться от **местоположения веб-сайта.**

    * Выберите, хотите ли вы включить **Application Insights.** Если **Application Insights** включена, QnA Maker собирает данные телеметрии по трафику, журналам чата и ошибкам.
    * Выберите место, где будет развернут ресурс Application Insights, выберите **местоположение приложения.**
    * Для экономии затрат вы можете [предоставить общий доступ](#configure-qna-maker-to-use-different-cognitive-search-resource) к некоторым (не всем) ресурсам Azure, созданным для QnA Maker.

1. После того, как все поля проверены, выберите **Создать**. Процесс может занять несколько минут.

1. После завершения развертывания в подписке будут созданы следующие ресурсы:

   ![Ресурс, созданный в службе QnA Maker](../media/qnamaker-how-to-setup-service/resources-created.png)

    Ресурс с типом _Cognitive Services_ имеет ключи _подписки._

## <a name="find-subscription-keys-in-the-azure-portal"></a>Найти ключи подписки на портале Azure

Вы можете просматривать и сбрасывать ключи подписки с портала Azure, где был создан ресурс NA Maker.

1. Перейдите на ресурс «Создатель» на портале Azure и выберите ресурс с типом _когнитивных служб:_

    ![Список ресурсов QnA Maker](../media/qnamaker-how-to-key-management/qnamaker-resource-list.png)

2. Перейти к **ключам**:

    ![Ключ подписки](../media/qnamaker-how-to-key-management/subscription-key.PNG)

## <a name="find-endpoint-keys-in-the-qna-maker-portal"></a>Найдите ключи от конечных точек на портале «NA Maker»

Конечная точка находится в том же регионе, что и ресурс, поскольку ключи конечных точек используются для вызова в базу знаний.

Ключами конечной точки можно управлять на [портале QnA Maker](https://qnamaker.ai).

1. Войдите на [портал NA Maker,](https://qnamaker.ai)перейдите в свой профиль, а затем выберите **настройки службы:**

    ![Ключ конечной точки](../media/qnamaker-how-to-key-management/Endpoint-keys.png)

2. Просмотр или сбросить клавиши:

    > [!div class="mx-imgBorder"]
    > ![Ключевой менеджер endpoint](../media/qnamaker-how-to-key-management/Endpoint-keys1.png)

    >[!NOTE]
    >Освежите ключи, если вы думаете, что они были скомпрометированы. Для этого может потребоваться внести соответствующие изменения в код клиентского приложения или бота.

## <a name="upgrade-qna-maker-sku"></a>Обновление ЗНА Maker SKU

Если вы хотите иметь больше вопросов и ответов в вашей базе знаний, за пределами текущего уровня, обновить ваш уровень ценообразования на услуги NA Maker.

Чтобы обновить номер SKU для управления службой QnA Maker, сделайте следующее:

1. Перейдите к ресурсу QnA Maker на портале Azure и выберите **Ценовая категория**.

    ![Ресурс QnA Maker](../media/qnamaker-how-to-upgrade-qnamaker/qnamaker-resource.png)

1. Определите соответствующий номер SKU и нажмите **Выбрать**.

    ![Цены на QnA Maker](../media/qnamaker-how-to-upgrade-qnamaker/qnamaker-pricing-page.png)

## <a name="upgrade-app-service"></a>Обновление службы приложений

 Когда вашей базе знаний необходимо обслуживать больше запросов от клиентского приложения, обновите уровень ценообразования Службы App Service.

Вы можете [масштабировать](https://docs.microsoft.com/azure/app-service/manage-scale-up) или масштабировать службу приложений.

Перейдите на ресурс службы приложений на портале Azure и при необходимости выберите опцию **«Масштаб вверх»** или **«Масштабирование».**

![Шкала app-услуг создателя NA](../media/qnamaker-how-to-upgrade-qnamaker/qnamaker-appservice-scale.png)

## <a name="upgrade-the-azure-cognitive-search-service"></a>Обновление службы когнитивного поиска Azure

Если вы планируете иметь много баз знаний, обновите уровень ценообразования службы Azure Cognitive Search.

В настоящее время вы не можете выполнить обновление sKU поиска Azure. Но можно создать новый ресурс Поиска Azure с требуемым номером SKU, восстановить туда данные, а затем привязать его к стеку QnA Maker. Для этого выполните следующие действия.

1. Создайте новый поисковый ресурс Azure на портале Azure и выберите нужный SKU.

    ![Ресурс Поиска Azure в QnA Maker](../media/qnamaker-how-to-upgrade-qnamaker/qnamaker-azuresearch-new.png)

1. Восстановите индексы из исходного ресурса Поиска Azure на новый. Смотрите [код резервного восстановления образца.](https://github.com/pchoudhari/QnAMakerBackupRestore)

1. После восстановления данных перейдите на новый поисковый ресурс Azure, выберите **ключи**и запишите **имя** и **ключ админа:**

    ![Ключи поиска Azure в QnA Maker](../media/qnamaker-how-to-upgrade-qnamaker/qnamaker-azuresearch-keys.png)

1. Чтобы связать новый поисковый ресурс Azure со стеком «Создатель» — перейдите в экземпляр службы приложений «NA Maker».

    ![Экземпляр службы приложений создателя NA](../media/qnamaker-how-to-upgrade-qnamaker/qnamaker-resource-list-appservice.png)

1. Выберите **настройки приложения** и измените настройки в полях **AzureSearchName** и **AzureSearchAdminKey** со ступени 3.

    ![Настройка приложения для создателя NA](../media/qnamaker-how-to-upgrade-qnamaker/qnamaker-appservice-settings.png)

1. Перезапустите экземпляр службы приложений.

    ![Перезагрузка экземпляра службы приложений для создателя приложения «NA»](../media/qnamaker-how-to-upgrade-qnamaker/qnamaker-appservice-restart.png)

## <a name="get-the-latest-runtime-updates"></a>Получайте последние обновления времени выполнения

Время выполнения в SnAMaker является частью экземпляра службы приложений Azure, который развертывается при [создании службы nAMaker](./set-up-qnamaker-service-azure.md) на портале Azure. Периодически устанавливаются обновления для этой среды выполнения. Экземпляр службы приложений «nA Maker» находится в автоматическом обновлении после релиза расширения сайта в апреле 2019 года (версия 5). Это обновление предназначено для ухода за нулевой простоя во время обновления.

Вы можете проверить текущую версию на https://www.qnamaker.ai/UserSettings. Если версия старше версии 5.x, необходимо перезапустить службу app Service для применения последних обновлений:

1. Перейдите на службу «NAMaker» (ресурсная группа) на [портале Azure.](https://portal.azure.com)

    > [!div class="mx-imgBorder"]
    > ![Группа ресурсов Azure для QnA Maker](../media/qnamaker-how-to-troubleshoot/qnamaker-azure-resourcegroup.png)

1. Выберите экземпляр службы приложений и откройте раздел **«Обзор».**

    > [!div class="mx-imgBorder"]
    > ![Экземпляр службы приложений nAMaker](../media/qnamaker-how-to-troubleshoot/qnamaker-azure-appservice.png)


1. Перезагрузка службы приложений. Процесс обновления должен завершиться через пару секунд. Любые зависимые приложения или боты, которые используют эту услугу nAMaker, будут недоступны для конечных пользователей в течение этого периода перезагрузки.

    ![Перезагрузка экземпляра службы приложений «NAMaker»](../media/qnamaker-how-to-upgrade-qnamaker/qnamaker-appservice-restart.png)

## <a name="configure-qna-maker-to-use-different-cognitive-search-resource"></a>Наконфигурировать nA Maker для использования различных ресурсов когнитивного поиска

Если вы создаете службу nA и ее зависимости (например, поиск) через портал, для вас создается служба поиска, которая связана с сервисом NA Maker. После создания этих ресурсов можно обновить настройки Службы app, чтобы использовать ранее существующую службу поиска и удалить только что созданный вами сервис.

Ресурс **службы приложений** создателя NA использует ресурс Cognitive Search. Для того, чтобы изменить ресурс Cognitive Search, используемый создателем NA, необходимо изменить настройку на портале Azure.

1. Получите **ключ от admin** и **имя** ресурса Cognitive Search, который вы хотите использовать.

1. Войдите на [портал Azure](https://portal.azure.com) и найдите **службу приложений,** связанную с вашим ресурсом «NA Maker». Оба с одинаковым именем.

1. Выберите **настройки,** затем **конфигурация**. При этом будут отображаться все существующие настройки для службы app SnA Maker.

    > [!div class="mx-imgBorder"]
    > ![Скриншот портала Azure, показывающий настройки конфигурации службы приложений](../media/qnamaker-how-to-upgrade-qnamaker/change-search-service-app-service-configuration.png)

1. Измените значения для следующих ключей:

    * **AzureSearchAdminKey**
    * **AzureSearchName**

1. Чтобы использовать новые настройки, необходимо перезапустить службу App. Выберите **Обзор,** затем выберите **перезагрузку.**

    > [!div class="mx-imgBorder"]
    > ![Скриншот перезагрузки портала Azure App Service после изменения настроек конфигурации](../media/qnamaker-how-to-upgrade-qnamaker/screenshot-azure-portal-restart-app-service.png)

При создании службы nA через шаблоны Azure Resource Manager можно создать все ресурсы и управлять созданием службы приложений, чтобы использовать существующий сервис поиска.

Узнайте больше о том, как настроить [настройки приложений службы](../../../app-service/configure-common.md#configure-app-settings)приложений App.

## <a name="configure-app-service-idle-setting-to-avoid-timeout"></a>Настройка простоя службы приложений, чтобы избежать тайм-аута

Служба приложений, которая обслуживает время выполнения прогноза NA Maker для опубликованной базы знаний, имеет конфигурацию тайм-аута простоя, которая по умолчанию автоматически выполняет тайм-аут, если служба простаивает. Для создателя NA это означает, что время выполнения прогноза генерирует API ответа, время от времени выходя из периода отсутствия трафика.

Для того, чтобы приложение с конечным прогнозом было загружено даже при отсутствии трафика, установите простоя, чтобы всегда.

1. Войдите на [портал Azure](https://portal.azure.com).
1. Поиск и выберите службу приложения ресурса nA Maker. Он будет иметь то же имя, что и ресурс NA Maker, но он будет иметь другой **тип** службы приложений.
1. Найдите **настройки,** а затем выберите **Конфигурацию.**
1. На панели конфигурации выберите **общие настройки,** затем найдите **Always on**и выберите **в** качестве значения.

    > [!div class="mx-imgBorder"]
    > ![На панели конфигурации выберите «Общие настройки», затем найдите «Всегда на» и выберите в качестве значения значение.](../media/qnamaker-how-to-upgrade-qnamaker/configure-app-service-idle-timeout.png)

1. Нажмите кнопку **Сохранить**, чтобы сохранить конфигурацию.
1. Вас спрашивают, хотите ли вы перезапустить приложение для использования новой настройки. Выберите **Continue** (Продолжить).

Узнайте больше о том, как настроить [общие настройки службы](../../../app-service/configure-common.md#configure-general-settings)приложений.

## <a name="delete-azure-resources"></a>Удаление ресурсов Azure

Если удалить любой из ресурсов Azure, используемых для ваших баз знаний QnA Maker, базы знаний перестанут работать. Перед удалением любых ресурсов на странице **Настройки** убедитесь, что вы экспортируете свои базы знаний.

## <a name="next-steps"></a>Дальнейшие действия

Подробнее об [службе app](../../../app-service/index.yml) и [службе поиска.](../../../search/index.yml)

> [!div class="nextstepaction"]
> [Создание и публикация базы знаний](../Quickstarts/create-publish-knowledge-base.md)
