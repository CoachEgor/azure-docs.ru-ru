---
title: Оценка доверия - NA Maker
titleSuffix: Azure Cognitive Services
description: Должна быть опубликована база знаний. После публикации база знаний запрашивается в точке прогнозирования времени выполнения с помощью API-известь.
services: cognitive-services
author: diberry
manager: nitinme
ms.service: cognitive-services
ms.subservice: qna-maker
ms.topic: conceptual
ms.date: 01/27/2020
ms.author: diberry
ms.custom: seodec18
ms.openlocfilehash: d901a803311805825c22503af6098e805a67e8f6
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "76843458"
---
# <a name="the-confidence-score-of-an-answer"></a>Оценка доверия ответа
Когда пользовательский запрос сопоставляется с базой знаний, API службы QnA Maker возвращает соответствующие ответы вместе с оценкой достоверности. Эта оценка означает степень достоверности того, что ответ соответствует этому запросу пользователя.

Оценка достоверности находится в пределах от 0 до 100. Оценка 100, скорее всего, указывает на точное соответствие, а оценка 0 означает, что соответствия не обнаружено. Чем выше оценка — тем больше уверенность в ответе. Для запроса может вернуться несколько ответов. В этом случае ответы возвращаются в порядке уменьшения оценки достоверности.

В приведенном ниже примере представлена одна сущность QnA с 2 вопросами.


![Пример пары QnA](../media/qnamaker-concepts-confidencescore/ranker-example-qna.png)

В приведенном выше примере для разных типов пользовательских запросов можно ожидать такие оценки, как в диапазоне оценок ниже:


![Ранжированный диапазон оценок](../media/qnamaker-concepts-confidencescore/ranker-score-range.png)


В этой таблице приведено описание типичной достоверности и связанная с ней оценка.

|Значение оценки|Описание оценки|Пример запроса|
|--|--|--|
|90–100|Практически точное совпадение с запросом пользователя и вопросом о базе знаний|"После публикации мои изменения в базе знаний не обновляются"|
|> 70|Высокий уровень достоверности. Обычно это правильный ответ, который полностью отвечает на запрос пользователя|"Опубликованная база знаний не обновляется"|
|50–70|Средний уровень достоверности. Обычно довольно хороший ответ, соответствующий основному намерению в запросе пользователя.|"Следует ли сохранять обновления перед публикацией базы знаний?"|
|30–50|Низкий уровень достоверности. Обычно связанный ответ, который частично соответствует намерению в запросе пользователя.|"Что делает сохранение и обучение?"|
|< 30|Очень низкая достоверность. Обычно ответ на запрос пользователя не предоставляется, но выводятся некоторые совпадения слов или фраз. |"Где можно добавить синонимы в мою базу знаний"|
|0|Нет соответствия, поэтому ответ не возвращается.|"Сколько стоит использование службы"|

## <a name="choose-a-score-threshold"></a>Указание порогового значения оценки
В приведенной выше таблице показаны оценки, ожидаемые в большинстве баз знаний. Однако, поскольку каждый КБ отличается, и имеет различные типы слов, намерений и целей, мы рекомендуем вам проверить и выбрать порог, который лучше всего работает для вас. По умолчанию порог установлен до 0, так что все возможные ответы возвращаются. Рекомендуемый порог, который должен работать для большинства КБ, составляет **50**.

При выборе порогового значения не забывайте про баланс между точностью и охватом и настраивайте порог в соответствии со своими требованиями.

- Если **точность** важнее для вашего сценария, увеличьте пороговое значение. Таким образом, каждый возвращаемый ответ будет иметь гораздо более высокую степень достоверности и намного вероятнее будет соответствовать запросу пользователя. В этом случае многие другие вопросы могут остаться без ответа. *Например*, если пороговое значение — **70**, можно пропустить некоторые неоднозначные примеры, такие как "Что такое сохранение и обучение?".

- Если **охват** (или полнота) важнее, снизьте пороговое значение. Это поможет ответить на максимальное количество вопросов, даже при наличии только частичного отношения к вопросу пользователя. Это означает, что может быть больше случаев, когда ответ не соответствует фактическому запросу пользователя, а предоставляет лишь некоторые связанные сведения. *Например:* если вы делаете порог **30,** вы можете дать ответы на такие вопросы, как "Где я могу изменить мой КБ?"

> [!NOTE]
> В новых версиях QnA Maker улучшена логика оценки, что может повлиять на пороговые значения. Каждый раз при обновлении службы проверяйте и, при необходимости, изменяйте пороговые значения. Узнать текущую версию службы QnA вы можете [здесь](https://www.qnamaker.ai/UserSettings). Сведения о том, как получить последние обновления см. [здесь](../How-To/set-up-qnamaker-service-azure.md#get-the-latest-runtime-updates).

## <a name="set-threshold"></a>Установить порог

Установите пороговый балл как свойство [тела GenerateAnswer API JSON.](../how-to/metadata-generateanswer-usage.md#generateanswer-request-configuration) Это означает, что вы устанавливаете его для каждого вызова GenerateAnswer.

Из фреймворка бота установите оценку как часть объекта опций с [помощью C-](../how-to/metadata-generateanswer-usage.md?#use-qna-maker-with-a-bot-in-c) или [Node.js.](../how-to/metadata-generateanswer-usage.md?#use-qna-maker-with-a-bot-in-nodejs)

## <a name="improve-confidence-scores"></a>Улучшение оценок достоверности
Чтобы улучшить оценку достоверности конкретного ответа на запрос пользователя, можно добавить запрос пользователя в базу знаний в качестве альтернативного вопроса для этого ответа. Вы можете также использовать [исправление слов](https://docs.microsoft.com/rest/api/cognitiveservices/qnamaker/alterations/replace) без учета регистра, чтобы добавить синонимы к ключевым словам в базе знаний.


## <a name="similar-confidence-scores"></a>Аналогичные оценки достоверности
Если несколько ответов имеют аналогичные оценки достоверности, вполне вероятно, что запрос был слишком общим и, следовательно, соответствовал с равной вероятностью с несколькими ответами. Попытайтесь структурировать QnAs лучше, чтобы каждый объект QnA имел четкое намерение.


## <a name="confidence-score-differences-between-test-and-production"></a>Различия в показателях доверия между тестом и производством
Оценка достоверности ответа может незначительно измениться между тестируемой и опубликованной версией базы знаний, даже если содержимое одинаковое. Это связано с тем, что содержание теста и опубликованная база знаний расположены в различных индексах когнитивного поиска Azure.

Индекс тестирования содержит все пары nA ваших баз знаний. При запросе индекса тестирования запрос применяется ко всему индексу, затем результаты ограничиваются разделом для этой конкретной базы знаний. Если результаты запроса теста негативно влияют на вашу способность проверять базу знаний, можно:
* организовать свою базу знаний, используя одно из следующих:
    * 1 ресурс, ограниченный 1 КБ: ограничьте один ресурс (и, как следствие, индекс когнитивного поиска Azure) в единую базу знаний.
    * 2 ресурса - 1 для тестирования, 1 для производства: есть два ресурса NA Maker, используя один для тестирования (с собственными тестовыми и производственными индексами) и один для продукта (также имеющий собственные тестовые и производственные индексы)
* и, всегда используйте те же параметры, такие как **[сверху](../how-to/improve-knowledge-base.md#use-the-top-property-in-the-generateanswer-request-to-get-several-matching-answers)** при запросе как тест и базы производственных знаний

При публикации базы знаний ее содержимое раздела вопросов и ответов переносится из тестового индекса в рабочий индекс в службе "Поиск Azure". См. [здесь](../Quickstarts/create-publish-knowledge-base.md#publish-the-knowledge-base), чтобы узнать, как работает процесс публикации.

Если у вас есть база знаний в разных регионах, каждый регион использует свой собственный индекс когнитивного поиска Azure. Так как используются разные индексы, оценки не обязательно будут совпадать.


## <a name="no-match-found"></a>Совпадения не найдены
Если ни одно из подходящих совпадений не найдено ранжировщиком, возвращается оценка достоверности 0.0 или "Нет", а ответ по умолчанию – "Нет хорошего соответствия в базе знаний". Вы можете переопределить этот [ответ по умолчанию](../How-To/metadata-generateanswer-usage.md) в боте или коде приложения, вызывая конечную точку. В качестве альтернативы вы также можете установить переопределение ответа в Azure, и это изменит значение по умолчанию для всех баз знаний, развернутых в определенной службе QnA Maker.

## <a name="next-steps"></a>Дальнейшие действия
> [!div class="nextstepaction"]
> [Рекомендации](./best-practices.md)

