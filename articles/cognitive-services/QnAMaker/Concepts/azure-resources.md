---
title: Ресурсы Azure - NA Maker
description: Создатель NA использует несколько источников Azure, каждый из которых имеет различную цель. Понимание того, как они используются индивидуально, позволяет планировать и выбирать правильный уровень ценообразования или знать, когда изменить свой уровень ценообразования. Понимание того, как они используются в сочетании позволяет найти и исправить проблемы, когда они возникают.
ms.topic: conceptual
ms.date: 03/25/2020
ms.openlocfilehash: 581029d2372f7a2ef704dcf02f266b66440aa246
ms.sourcegitcommit: 2d7910337e66bbf4bd8ad47390c625f13551510b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/08/2020
ms.locfileid: "80873911"
---
# <a name="azure-resources-for-qna-maker"></a>Ресурсы Azure для создателя NA

Создатель NA использует несколько источников Azure, каждый из которых имеет различную цель. Понимание того, как они используются индивидуально, позволяет планировать и выбирать правильный уровень ценообразования или знать, когда изменить свой уровень ценообразования. Понимание того, как они используются _в сочетании_ позволяет найти и исправить проблемы, когда они возникают.

## <a name="resource-planning"></a>Планирование ресурсов

При первой разработке базы знаний nA Maker на этапе прототипа часто возникает единый ресурс для тестирования и производства.

При переходе на этап разработки проекта следует учитывать:

* сколько языков будет хранить ваша база знаний
* сколько регионов вам нужно, чтобы ваша база знаний была доступна в /от
* сколько документов в каждом домене будет храниться в вашей системе

Планируйте иметь единый ресурс NA Maker, содержать все базы знаний, которые имеют один и тот же язык, один и тот же регион и ту же комбинацию доменов предмета.

## <a name="pricing-tier-considerations"></a>Соображения уровня ценообразования

Обычно необходимо учитывать три параметра:

* **Требуемая пропускная способность службы**:
    * выберите соответствующий [план приложений](https://azure.microsoft.com/pricing/details/app-service/plans/) для службы приложений с учетом требований. Масштаб приложения можно [увеличить](https://docs.microsoft.com/azure/app-service/manage-scale-up) или уменьшить.
    * Это также должно повлиять на ваш выбор SKU **azure Cognitive Search,** смотрите более подробную информацию [здесь.](https://docs.microsoft.com/azure/search/search-sku-tier) Кроме того, может потребоваться настроить [емкость](../../../search/search-capacity-planning.md) когнитивного поиска с помощью реплик.

* **Размер и количество баз знаний**: выберите соответствующий номер [SKU Поиска Azure](https://azure.microsoft.com/pricing/details/search/) для вашего сценария. Как правило, вы определяете количество баз знаний, необходимых вам на основе ряда различных доменов предмета. После того, как предмет домена (для одного языка) должны быть в одной базе знаний.

    На определенном уровне можно опубликовать N-1 баз знаний, где N — максимальное разрешенное на этом уровне количество индексов. Также проверьте максимальный размер и количество документов, разрешенные для каждого уровня.

    Например, если для уровня допускается 15 индексов, можно опубликовать 14 баз знаний (1 индекс для каждой опубликованной базы знаний). Пятнадцатый индекс используется для разработки и тестирования всех баз знаний.

* **Количество документов в качестве источников**: SKU службы управления QnA Maker ценовой категории "Бесплатный" разрешает управлять через портал и API-интерфейсы только тремя документами размером 1 МБ каждый. Номер SKU уровня "Стандартный"не имеет ограничений на число документов, которыми можно управлять. Дополнительные сведения см. [здесь](https://aka.ms/qnamaker-pricing).

В следующей таблице приведен ряд общих рекомендаций.

|                        | Управление службой QnA Maker | Служба приложений | Когнитивный поиск Azure | Ограничения                      |
| ---------------------- | -------------------- | ----------- | ------------ | -------------------------------- |
| Экспериментирование        | Номер SKU уровня "Бесплатный"             | Уровень "Бесплатный"   | Уровень "Бесплатный"    | Публикация до 2 баз знаний размером 50 Мбайт  |
| Среда разработки и тестирования   | SKU "Стандартный"         | Shared      | Basic        | Публикация до 14 баз знаний размером 2 ГБ    |
| Рабочая среда | SKU "Стандартный"         | Basic       | Standard     | Публикация до 49 баз знаний размером 25 Гбайт |

## <a name="recommended-settings"></a>Рекомендуемые настройки

|Целевая цель КПС | Служба приложений | Когнитивный поиск Azure |
| -------------------- | ----------- | ------------ |
| 3             | S1, 1 экземпляр   | S1, 1 экземпляр    |
| 50         | S3, 10 Инстанции       | S1, 12 Инстанции         |
| 80         | S3, 10 Инстанции      |  S3, 12 Инстанции  |
| 100         | P3V2, 10 инстанций  | S3, 12 Инстанции, 3 раздела   |
| от 200 до 250         | P3V2, 20 инстанций | S3, 12 Инстанции, 3 раздела    |

## <a name="when-to-change-a-pricing-tier"></a>Когда менять уровень ценообразования

|Обновление|Причина|
|--|--|
|[Обновление](../How-to/set-up-qnamaker-service-azure.md#upgrade-qna-maker-sku) ЗНА Maker управления SKU|Вы хотите иметь больше пар nA или источников документов в вашей базе знаний.|
|[Обновление](../How-to/set-up-qnamaker-service-azure.md#upgrade-app-service) App Service SKU и проверить уровень когнитивного поиска и [создать когнитивные реплики поиска](../../../search/search-capacity-planning.md)|Ваша база знаний должна обслуживать больше запросов от вашего клиентского приложения, таких как чат-бот.|
|[Обновление](../How-to/set-up-qnamaker-service-azure.md#upgrade-the-azure-cognitive-search-service) Служба когнитивного поиска Azure|Вы планируете иметь много баз знаний.|

Получите последние обновления времени выполнения, [обновив службу приложений на портале Azure.](../how-to/set-up-qnamaker-service-azure.md#get-the-latest-runtime-updates)

## <a name="resource-naming-considerations"></a>Соображения именования ресурсов

Название ресурса для ресурса NA `qna-westus-f0-b`Maker, например, используется для названия других ресурсов.

Окно создания портала Azure позволяет создать ресурс nA Maker и выбрать уровни ценообразования для других ресурсов.

> [!div class="mx-imgBorder"]
> ![Скриншот портала Azure для создания ресурсов Компании «NA Maker»](../media/concept-azure-resource/create-blade.png)

После создания ресурсов они имеют то же имя, за исключением дополнительного ресурса Application Insights, который откладывает символы на имя.

> [!div class="mx-imgBorder"]
> ![Скриншот списка ресурсов портала Azure](../media/concept-azure-resource/all-azure-resources-created-qnamaker.png)

> [!TIP]
> Создание новой группы ресурсов при создании ресурса «NA Maker». Это позволяет просматривать все ресурсы, связанные с ресурсом «NA Maker», при поиске по группе ресурсов.

> [!TIP]
> Используйте конвенцию именования для указания уровней ценообразования в названии ресурса или группы ресурсов. Когда вы получаете ошибки от создания новой базы знаний или добавления новых документов, предел уровня ценообразования когнитивного поиска является общей проблемой.

## <a name="resource-purposes"></a>Ресурсные цели

Каждый ресурс Azure, созданный с помощью nA Maker, имеет определенную цель:

* Ресурс QnA Maker
* Ресурс когнитивного поиска
* Служба приложений
* Служба плана приложений
* Служба Анализа приложений


### <a name="cognitive-search-resource"></a>Ресурс когнитивного поиска

Ресурс [Когнитивного поиска](../../../search/index.yml) используется для:

* Храните пары ЗНА
* Обеспечить первоначальный рейтинг (ranker #1) пар ЗНА во время выполнения

#### <a name="index-usage"></a>Использование индекса

Ресурс сохраняет один индекс, чтобы выступать в качестве индекса тестирования, а остальные индексы соотносятся с одной опубликованной базой знаний каждый.

Ресурс, рассчитанный на 15 индексов, будет содержать 14 опубликованных баз знаний, а один индекс используется для тестирования всех баз знаний. Этот индекс теста разделен базой знаний, так что запрос с использованием интерактивного тестового стекла будет использовать индекс теста, но только результаты возврата из конкретного раздела, связанного с конкретной базой знаний.

#### <a name="language-usage"></a>Использование языка

Первая база знаний, созданная в ресурсе NA Maker, используется для определения _единого_ набора языков для ресурса Cognitive Search и всех его индексов. Для сервиса «NA Maker» можно иметь только _один набор языков._

### <a name="qna-maker-resource"></a>Ресурс QnA Maker

Ресурс «NA Maker» предоставляет доступ к авторским и публикационным AIS, а также к обработке естественного языка (НЛП), основанному на втором уровне (ranker #2) пар nA во время выполнения.

Второй рейтинг применяет интеллектуальные фильтры, которые могут включать метаданные и последующие запросы.

#### <a name="qna-maker-resource-configuration-settings"></a>Настройки конфигурации ресурсов создателя NA

При создании новой базы знаний на [портале «NA Maker»](https://qnamaker.ai)настройка **языка** является единственным параметром, который применяется на уровне ресурсов. Вы выбираете язык при создании первой базы знаний ресурса.

### <a name="app-service-and-app-service-plan"></a>Обслуживание приложений и план обслуживания приложений

[Служба App](../../../app-service/index.yml) используется вашим клиентским приложением для доступа к опубликованным базам знаний через конечную точку выполнения.

Для запроса опубликованной базы знаний все опубликованные базы знаний используют одну и ту же конечную точку URL, но указывают **идентификатор базы знаний** в маршруте.

`{RuntimeEndpoint}/qnamaker/knowledgebases/{kbId}/generateAnswer`

### <a name="application-insights"></a>Application Insights

[Приложение Insights](../../../azure-monitor/app/app-insights-overview.md) используется для сбора журналов чатов и телеметрии. Просмотрите общие [запросы Kusto](../how-to/get-analytics-knowledge-base.md) для получения информации о вашей услуге.

## <a name="share-services-with-qna-maker"></a>Поделиться услугами с nA Maker

Создатель NA создает несколько ресурсов Azure. Чтобы уменьшить управление и извлечь выгоду из совместного несения расходов, используйте следующую таблицу, чтобы понять, что можно и чего нельзя делиться:

|Служба|Share (Предоставить общий доступ)|Причина|
|--|--|--|
|Cognitive Services|X|Невозможно по дизайну|
|План службы приложений|✔|Фиксированное дисковое пространство, выделенное для плана службы приложений. Если другие приложения, которые используют тот же план Службы App, используют значительное дисковое пространство, экземпляр службы приложений qnAMaker столкнется с проблемами.|
|Служба приложений|X|Невозможно по дизайну|
|Application Insights|✔|Может быть в общем доступе.|
|Служба поиска|✔|1. `testkb` является зарезервированным названием для службы nAMaker; он не может быть использован другими.<br>2. Карта Synonym `synonym-map` по названию зарезервирована для сервиса «NAMaker».<br>3. Количество опубликованных баз знаний ограничено уровнем службы поиска. Если доступны бесплатные индексы, ими могут воспользоваться другие службы.|

### <a name="using-a-single-cognitive-search-service"></a>Использование единого сервиса когнитивного поиска

Если вы создаете службу nA и ее зависимости (например, поиск) через портал, для вас создается служба поиска, которая связана с сервисом NA Maker. После создания этих ресурсов можно обновить настройки Службы app, чтобы использовать ранее существующую службу поиска и удалить только что созданный вами сервис.

[Узнайте, как настроить](../How-To/set-up-qnamaker-service-azure.md#configure-qna-maker-to-use-different-cognitive-search-resource) nA Maker для использования другого ресурса Cognitive Service, чем тот, который был создан в рамках процесса создания ресурсов NA Maker.

## <a name="management-service-region"></a>Регион услуг по управлению

Служба управления компании «Зна Maker» используется только для портала «NA Maker» и для первоначальной обработки данных. Эта услуга доступна только в западном регионе **США.** В этой службе в Западном США данные о клиентах не хранятся.

## <a name="keys-in-qna-maker"></a>Ключи в КНА Maker

Ваш сервис SnA Maker имеет дело с двумя типами ключей: **авторством ключей** и **ключами конечных точек запроса,** используемыми при размещении времени выполнения в службе App.

Если вы ищете ключ [подписки, терминология изменилась.](#subscription-keys) **subscription key**

Используйте эти ключи при запросах в службу через AA.

![Управление ключами](../media/qnamaker-how-to-key-management/key-management.png)

|Имя|Местоположение|Назначение|
|--|--|--|
|Ключ разработки|[Портал Azure](https://azure.microsoft.com/free/?WT.mc_id=A261C142F)|используются для доступа к [API службы управления QnA Maker](https://go.microsoft.com/fwlink/?linkid=2092179). Эти AA позволяют отсеивать вопросы и ответы в вашей базе знаний и публиковать свою базу знаний. Эти ключи создаются при создании нового сервиса «NA Maker».<br><br>Найдите эти ключи на ресурсе **Cognitive Services** на странице **Ключей.**|
|Ключ конечных точек запроса|[Портал QnA Maker](https://www.qnamaker.ai)|Эти ключи используются для запроса опубликованной базы знаний, чтобы получить ответ на вопрос пользователя. Обычно эта конечная точка запроса используется в чат-боте или в коде клиентского приложения, который подключается к сервису «NA Maker». Эти ключи создаются при публикации базы знаний NA Maker.<br><br>Найдите эти ключи на странице **настроек Службы.** Найдите эту страницу из меню пользователя в правом верхнем углу страницы в выпадающем меню.|

### <a name="subscription-keys"></a>Ключи подписки

Термины авторизации и ключа конечных точек запроса являются корректирующими терминами. Предыдущий срок был **ключом подписки**. Если вы видите другую документацию, относящуюся к ключам подписки, они эквивалентны клавишам конечных точек авторства и запроса (используемым во времени выполнения).

Вы должны знать, что ключ доступа, управления базой знаний или запрос базы знаний, чтобы знать, какой ключ вам нужно найти.

## <a name="next-steps"></a>Дальнейшие действия

* Узнайте о базе [знаний](knowledge-base.md) компании «NA Maker»
* Понимание [жизненного цикла базы знаний](development-lifecycle-knowledge-base.md)
* Обзор сервиса и [базовых ограничений](../limits.md) знаний

