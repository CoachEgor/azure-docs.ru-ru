---
title: Пакетное тестирование
titleSuffix: Language Understanding - Azure Cognitive Services
description: Используйте пакетное тестирование для постоянной работы над приложением, чтобы усовершенствовать его и улучшить функции распознавания речи.
services: cognitive-services
author: diberry
manager: nitinme
ms.custom: seodec18
ms.service: cognitive-services
ms.subservice: language-understanding
ms.topic: conceptual
ms.date: 03/29/2019
ms.author: diberry
ms.openlocfilehash: acb561970b6a8576d1219fc15758e21a3032c9e5
ms.sourcegitcommit: 3102f886aa962842303c8753fe8fa5324a52834a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "60813291"
---
# <a name="batch-testing-with-1000-utterances-in-luis-portal"></a>Пакетное тестирование 1000 высказываний на портале LUIS

При пакетном тестировании проверяется [активная](luis-concept-version.md#active-version) обученная модель для оценки точности прогнозирования. По завершении пакетного тестирования отображается диаграмма точности для каждого намерения и каждой сущности в текущей обученной модели. Изучив результаты пакетного тестирования, вы сможете предпринять меры для повышения точности, например добавить в намерение новые примеры высказываний, если приложение часто ошибается с определением намерений.

## <a name="group-data-for-batch-test"></a>Группировка данных для пакетного тестирования

Очень важно применять для пакетного тестирования высказывания, еще не знакомые службе LUIS. Если у вас есть готовый набор высказываний, разделите его на три части: высказывания, добавленные в намерение; высказывания, полученные от опубликованной конечной точки; высказывания для пакетного тестирования LUIS после обучения. 

## <a name="a-dataset-of-utterances"></a>Набор данных с высказываниями

Передайте пакетный файл с высказываниями, который обычно называют *набором данных*, для пакетной проверки. Этот файл содержит данные в формате JSON, которые описывают не более 1000 высказываний **без повторов** и с метками. Для тестирования приложения вы можете применить до 10 наборов данных. Если вам нужно больше, сначала удалите набор данных и добавьте новый вместо него.

|**Правила**|
|--|
|*Высказывания не должны дублироваться.|
|Не более 1000 высказываний.|

*Дубликатами считаются только точные совпадения, а не совпадения после назначения маркеров. 

## <a name="entities-allowed-in-batch-tests"></a>Сущности, разрешенные в пакетных тестированиях

Все пользовательские сущности в модели отображаются в фильтре сущностей пакетного тестирования, даже если в данных пакетного файла нет соответствующих сущностей.

<a name="json-file-with-no-duplicates"></a>
<a name="example-batch-file"></a>

## <a name="batch-file-format"></a>Формат пакетного файла

Пакетный файл содержит высказывания. Каждое высказывание должно сопровождаться ожидаемым прогнозом намерения, а также всеми [сущностями машинного обучения](luis-concept-entity-types.md#types-of-entities), которые должны быть в нем обнаружены. 

## <a name="batch-syntax-template-for-intents-with-entities"></a>Шаблон синтаксиса пакета для намерений с сущностями

Чтобы запустить файл пакета, используйте следующий шаблон.

```JSON
[
  {
    "text": "example utterance goes here",
    "intent": "intent name goes here",
    "entities": 
    [
        {
            "entity": "entity name 1 goes here",
            "startPos": 14,
            "endPos": 23
        },
        {
            "entity": "entity name 2 goes here",
            "startPos": 14,
            "endPos": 23
        }
    ]
  }
]
```

Чтобы уведомить о начале и конце сущности, в файле пакета используются свойства **startPos** и **endPos**. Их значения отсчитываются, начиная с нуля, и не должны начинаться или заканчиваться пробелом. В этом и состоит основное отличие от журналов запросов, для которых используются свойства startIndex и endIndex. 

[!INCLUDE [Entity roles in batch testing - currently not supported](../../../includes/cognitive-services-luis-roles-not-supported-in-batch-testing.md)]

## <a name="batch-syntax-template-for-intents-without-entities"></a>Шаблон синтаксиса пакета для намерений без сущностей

Чтобы запустить файл пакета без сущностей, используйте следующий шаблон.

```JSON
[
  {
    "text": "example utterance goes here",
    "intent": "intent name goes here",
    "entities": []
  }
]
```

Если вы не хотите тестировать сущности, включите свойство `entities` и задайте в качестве значения пустой массив `[]`.


## <a name="common-errors-importing-a-batch"></a>Распространенные ошибки при импорте пакета

Ниже перечислены распространенные ошибки. 

> * Превышение ограничения в 1000 высказываний.
> * Объект JSON, содержащий высказывание, не имеет свойства entities. Свойство может быть пустым массивом.
> * Слова, которые были помечены в нескольких сущностях.
> * Метка сущности с пробелом в начале или в конце.

## <a name="batch-test-state"></a>Состояние пакетного тестирования

LUIS отслеживает данные о состоянии последнего тестирования для каждого набора данных. К этим данным относится размер набора данных (количество высказываний в пакете), дата последнего запуска и последний полученный результат (количество успешно спрогнозированных высказываний).

<a name="sections-of-the-results-chart"></a>

## <a name="batch-test-results"></a>Результаты пакетного тестирования

Результат пакетного тестирования демонстрируется в виде точечной диаграммы, которую называют матрицей ошибок. На этой диаграмме приводится распределение по 4 секторам результатов сравнения высказываний, содержащихся в пакетном файле, с намерениями и сущностями, прогнозируемыми текущей моделью. 

Точки данных в секторах **False Positive** (Ложный положительный результат) и **False Negative** (Ложный отрицательный результат) обозначают ошибки, которые нужно изучить дополнительно. Если все точки данных попадают в сектора **True Positive** (Истинный положительный результат) и **True Negative** (Истинный отрицательный результат), значит приложение идеально прогнозирует результаты по предложенному набору данных.

![Четыре сектора на диаграмме](./media/luis-concept-batch-test/chart-sections.png)

Эта диаграмма позволяет найти высказывания, которые LUIS неправильно прогнозирует при текущем состоянии обучения. Результаты отображаются в нескольких областях диаграммы. Выберите конкретную точку на диаграмме, чтобы просмотреть сведения об этом высказывании, или выберите имя области, чтобы просмотреть обобщенные результаты по этой области.

![Пакетное тестирование](./media/luis-concept-batch-test/batch-testing.png)

## <a name="errors-in-the-results"></a>Результаты с информацией об ошибках

Ошибками при пакетном тестировании считаются прогнозируемые намерения, которые не совпадают с данными в этом пакетном файле. Ошибки отображаются на диаграмме в двух красных секторах. 

Раздел ложных положительных результатов содержит сведения о высказываниях, которые ошибочно совпадают с намерением или сущностью. Раздел ложных отрицательных результатов содержит сведения о высказываниях, которые не соответствуют нужному намерению или сущности. 

## <a name="fixing-batch-errors"></a>Исправление ошибок, выявленных при пакетном тестировании

Если при пакетном тестировании будут обнаружены ошибки, вы можете добавить в намерение больше высказываний и (или) сопоставить дополнительные высказывания с сущностью, чтобы служба LUIS лучше различала намерения. Если вы уже добавили все нужные высказывания и присвоили все метки, но в прогнозировании при пакетном тестировании по-прежнему возникают ошибки, попробуйте добавить [список фраз](luis-concept-feature.md) с характерным для предметной области словарем, который поможет LUIS обучаться быстрее. 

## <a name="next-steps"></a>Дальнейшие действия

* Узнайте, как [выполнить пакетное тестирование](luis-how-to-batch-test.md)
