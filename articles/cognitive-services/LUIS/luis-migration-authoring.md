---
title: Миграция в ключ создания ресурсов Azure
titleSuffix: Azure Cognitive Services
description: В этой статье описывается, как перенести Language Understanding (LUIS) Создание проверки подлинности из учетной записи электронной почты в ресурс Azure.
services: cognitive-services
author: diberry
manager: nitinme
ms.custom: seodec18
ms.service: cognitive-services
ms.subservice: language-understanding
ms.topic: how-to
ms.date: 08/13/2020
ms.author: diberry
ms.openlocfilehash: 4c9dc04770e5fadd72c5460a4b44c05ffda47cb7
ms.sourcegitcommit: c293217e2d829b752771dab52b96529a5442a190
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/15/2020
ms.locfileid: "88245457"
---
# <a name="migrate-to-an-azure-resource-authoring-key"></a>Миграция в ключ создания ресурсов Azure

Language Understanding (LUIS) создание аутентификации изменено с учетной записи электронной почты на ресурс Azure. Хотя в настоящее время это не требуется, переключение на ресурс Azure будет применено в будущем.


## <a name="what-is-migration"></a>Что такое миграция?

Миграция — это процесс изменения проверки подлинности с учетной записи электронной почты на ресурс Azure. После миграции ваша учетная запись будет связана с подпиской Azure и ресурсом разработки Azure. *Все пользователи LUIS (владельцы или участники совместной работы), в конечном итоге, потребуют миграции.*

Миграция должна быть выполнена с портала LUIS. Например, при создании ключей разработки с помощью интерфейса командной строки LUIS необходимо завершить процесс миграции на портале LUIS. После миграции вы по-прежнему сможете соавторировать свои приложения, но они будут добавлены на уровне ресурсов Azure, а не на уровне приложения.

> [!Note]
> Перед миграцией соавторы называются _совместной работой_ на уровне приложения Luis. После миграции роль _участника_ Azure используется для тех же функций на уровне ресурсов Azure.

## <a name="note-before-you-migrate"></a>Примечание перед миграцией

* Вы должны переносить свой интерфейс разработки на **ноября, 2, 2020**. 
* Миграция является односторонним процессом. После миграции вы не сможете вернуться.
* Приложения будут автоматически перенесены вместе с вами, если вы являетесь владельцем приложения.
* Владелец не может выбрать подмножество приложений для миграции, и процесс будет необратимым.
* После миграции владельца приложения будут скрыты от стороны участника совместной работы.
* Владельцы получат запрос на отправку сообщений электронной почты в участников совместной работы, чтобы информировать их о миграции.
* Приложения не будут переноситься вместе с вами, если вы являетесь членом программы совместной работы.
* Владелец не может понять, что участники совместной работы перенесены.
* При миграции не выполняется автоматическое собираются участников совместной работы и их перемещение или добавление в ресурс создания Azure. Владелец приложения должен выполнить этот шаг после миграции. Для этого шага требуются [разрешения на доступ к ресурсу разработки Azure](https://docs.microsoft.com/azure/cognitive-services/luis/luis-how-to-collaborate).
* После назначения участников совместной работы с ресурсом Azure они должны перейти на доступ к приложениям. В противном случае у них нет доступа для создания приложений.
* Перенесенного пользователя нельзя добавить в качестве участника приложения.
* Если вы владеете ключами прогнозирования, назначенными приложениям, принадлежащим другому пользователю, миграция будет заблокирована как для владельца, так и для участников совместной работы. См. рекомендации далее в этой статье.

> [!Note]
> Если вам нужно создать ресурс среды выполнения прогнозирования, создайте [отдельный процесс](luis-how-to-azure-subscription.md#create-resources-in-the-azure-portal) .

## <a name="migration-prerequisites"></a>Предварительные требования для миграции

* Необходимо связать действующую подписку Azure. Попросите администратора клиента добавить вас в подписку или Зарегистрируйтесь, чтобы [получить бесплатную учетную часть](https://azure.microsoft.com/free/cognitive-services).
* Вам нужно создать ресурс Azure LUIS Authoring на портале LUIS или портал Azure. Создание ресурса-разработчика на портале LUIS является частью процесса миграции, который рассматривается в следующем разделе.
* Если вы являетесь членом совместной работы в приложениях, приложения не будут переноситься автоматически. Рекомендуется выполнять резервное копирование этих приложений, экспортируя их или с помощью [API экспорта](https://westus.dev.cognitive.microsoft.com/docs/services/5890b47c39e2bb17b84a55ff/operations/5890b47c39e2bb052c5b9c40). Вы можете импортировать приложение обратно в LUIS после миграции. В процессе импорта создается новое приложение с новым ИДЕНТИФИКАТОРом приложения, владельцем которого вы являетесь.
* Если вы являетесь владельцем приложения, вам не потребуется экспортировать приложения, так как они будут перенесены автоматически. Рекомендуется сохранить список совместной работы каждого приложения. Шаблон сообщения электронной почты, содержащий этот список, предоставляется в рамках процесса миграции.


|Портал|Цель|
|--|--|
|[Azure](https://azure.microsoft.com/free/cognitive-services)| Создание ресурсов для прогнозирования и разработки.<br> Назначение участников ресурсам.|
|[LUIS](https://www.luis.ai)| Переход на новые ресурсы для разработки.<br> Создайте новые ресурсы для разработки в потоке миграции.<br> Назначение и отмена назначения ресурсов для прогнозирования и разработки приложений на странице " **Управление**  >  **ресурсами Azure** ". <br> Перемещение приложений из одного ресурса для создания в другой.  |

> [!Note]
> Разработка приложения LUIS предоставляется бесплатно, как показано на уровне F0. Дополнительные сведения [о ценовых](luis-limits.md#key-limits)категориях.


## <a name="migration-steps"></a>Этапы миграции

1. На портале LUIS, с которым вы работаете, можно начать процесс миграции со значка **Azure** на верхней панели инструментов.

   > [!div class="mx-imgBorder"]
   > ![Значок миграции](./media/migrate-authoring-key/migration-button.png)

2. Всплывающее окно миграции позволяет продолжить миграцию или выполнить миграцию позже. Выберите **перенести сейчас**.

   > [!div class="mx-imgBorder"]
   > ![Первое всплывающее окно в процессе миграции, в котором выбран параметр "перенести сейчас"](./media/migrate-authoring-key/prompt-when-migrating-2.png)

3. Если любое из ваших приложений имеет участников совместной работы, вам будет предложено отправить им сообщение электронной почты, которое позволит им узнать о миграции. Этот параметр является необязательным.

   Для каждого совместного взаимодействия и приложения приложение электронной почты по умолчанию открывается с неформатированным электронным письмом. Вы можете изменить сообщение перед его отправкой. Шаблон сообщения электронной почты содержит точный идентификатор приложения и имя приложения.

   ```html
   Dear Sir/Madam,

   I will be migrating my LUIS account to Azure. Consequently, you will no longer have access to the following app:

   App Id: <app-ID-omitted>
   App name: Human Resources

   Thank you
   ```

   > [!Note]
   > После переноса учетной записи в Azure ваши приложения больше не будут доступны для участников совместной работы.

4. Если вы являетесь средством совместной работы в любом приложении, вам будет предложено экспортировать копию приложений, выбрав этот параметр в процессе миграции. Этот параметр является необязательным.

   Если выбран параметр, отображается следующая страница. Нажмите кнопки скачивания слева, чтобы экспортировать нужные приложения. Эти приложения можно импортировать обратно после миграции, так как они не будут автоматически перенесены вместе с вами.

   > [!div class="mx-imgBorder"]
   > ![Запрос на экспорт приложений.](./media/migrate-authoring-key/export-app-for-collabs-2.png)

5. Вы можете создать новый ресурс для создания LUIS или выполнить миграцию в существующий ресурс, если он уже создан в Azure. Выберите нужный параметр, нажав одну из следующих кнопок.

   > [!div class="mx-imgBorder"]
   > ![Кнопки для создания нового ресурса для создания и использования существующего ресурса разработки](./media/migrate-authoring-key/choose-existing-authoring-resource.png)

### <a name="create-new-authoring-resource-from-luis-to-migrate"></a>Создание нового ресурса для создания из LUIS для миграции

Если вы хотите создать новый ресурс создания, выберите **создать новый ресурс** для создания и укажите в следующем окне следующие сведения. Затем выберите **Готово**.

> [!div class="mx-imgBorder"]
> ![Окно для создания ресурса для разработки](./media/migrate-authoring-key/create-new-authoring-resource-2.png)

* **Имя клиента**. Клиент, с которым связана подписка Azure. По умолчанию задан клиент, который вы используете в данный момент. Вы можете переключить клиентов, выбрав самый правый аватар, который содержит инициалы.
* **Имя ресурса**: выбранное вами пользовательское имя. Он используется как часть URL-адреса для запросов конечной точки создания и прогнозирования.
* **Имя подписки**. Подписка, которая будет связана с ресурсом. Если у вас есть несколько подписок, принадлежащих клиенту, выберите нужную подписку из раскрывающегося списка.
* **Имя группы ресурсов Azure**: имя настраиваемой группы ресурсов, которое выбирается из раскрывающегося списка. Группы ресурсов позволяют группировать ресурсы Azure для осуществления доступа и управления.

Обратите внимание, что вы можете иметь 10 бесплатных ресурсов для разработки для каждого региона на подписку. Если в вашей подписке более 10 ресурсов для создания в одном регионе, вы не сможете создать новую.

При создании ресурса разработки отображается сообщение об успешном выполнении. Нажмите кнопку **Закрыть** , чтобы закрыть всплывающее окно.

  > [!div class="mx-imgBorder"]
  > ![Сообщение о том, что ресурс разработки был успешно создан](./media/migrate-authoring-key/migration-success-2.png)


### <a name="use-existing-authoring-resource-to-migrate"></a>Использовать существующий ресурс разработки для миграции

Если ваша подписка уже связана с LUIS ресурсом Azure или если вы создали ресурс из портал Azure и хотите перейти на него вместо создания нового, выберите **использовать существующий ресурс разработки**. Укажите следующие сведения в следующем окне, а затем нажмите кнопку **Готово**.

> [!div class="mx-imgBorder"]
>![Окно для изменения существующего ресурса разработки](./media/migrate-authoring-key/choose-existing-authoring-resource-2.png)

* **Имя клиента**. Клиент, с которым связана подписка Azure. По умолчанию задан клиент, который вы используете в данный момент.
* **Имя подписки**. Подписка, которая будет связана с ресурсом. Если у вас есть несколько подписок, принадлежащих клиенту, выберите нужную подписку из раскрывающегося списка.
* **Имя ресурса**— ресурс, на который требуется выполнить миграцию.

> [!Note]
> Если вы не видите свой ресурс разработки в раскрывающемся списке, убедитесь, что он создан в правильном расположении в соответствии с порталом LUIS, в котором вы вошли. Также убедитесь, что созданные ресурсы являются ресурсами для разработки, а не ресурсами прогноза.


Проверьте имя ресурса разработки и нажмите кнопку " **Миграция** ".

> [!div class="mx-imgBorder"]
> ![Окно для выбора ресурса для разработки, теперь доступна кнопка "миграция"](./media/migrate-authoring-key/choose-authoring-resource-and-migrate-2.png)

Отобразится сообщение об успешном создании пользователя. Нажмите кнопку **Закрыть** , чтобы закрыть всплывающее окно.

> [!div class="mx-imgBorder"]
> ![Сообщение о том, что ваш ресурс разработки успешно перенесен](./media/migrate-authoring-key/migration-success-2.png)

## <a name="using-apps-after-migration"></a>Использование приложений после миграции

После миграции все приложения LUIS, для которых вы являетесь владельцем, теперь будут назначены одному ресурсу LUIS Authoring.

В списке **Мои приложения** отображаются приложения, перенесенные в новый ресурс создания. Перед доступом к приложениям выберите ресурс подписки и LUIS, чтобы просмотреть приложения, которые вы можете создать.

 > [!div class="mx-imgBorder"]
 > ![Поля для подписки и ресурса для разработки](./media/create-app-in-portal-select-subscription-luis-resource.png)

Вам не нужно знать ключ ресурса для разработки, чтобы продолжить редактирование приложений на портале LUIS.

Если вы планируете изменять приложения программно, вам потребуются значения ключа разработки. Эти значения отображаются на странице **Управление**  >  **ресурсами Azure** на портале Luis. Они также доступны в портал Azure на странице **ключей** ресурса. Можно также создать дополнительные ресурсы для разработки и назначить их с одной страницы.

 > [!div class="mx-imgBorder"]
 > ![Страница для управления ресурсами разработки](./media/migrate-authoring-key/manage-authoring-resource-2.png)

## <a name="adding-contributors-to-authoring-resources"></a>Добавление участников к разработке ресурсов

[!INCLUDE [Manage contributors for the Azure authoring resource for language understanding](./includes/manage-contributors-authoring-resource.md)]

Узнайте [, как добавить участников](luis-how-to-collaborate.md) в свой ресурс разработки. Участники получат доступ ко всем приложениям в этом ресурсе.

Вы можете добавить участников в ресурс разработки из портал Azure на странице **управления доступом (IAM)** для этого ресурса. Дополнительные сведения см. в разделе [Добавление доступа к участнику](luis-migration-authoring-steps.md#after-the-migration-process-add-contributors-to-your-authoring-resource).

> [!Note]
> Если владелец приложения LUIS, перенесенный и добавлен участником совместной работы в ресурсе Azure, он по-прежнему будет иметь доступ к приложению, только если он не выполняет миграцию.

## <a name="luis-portal-migration-reminders"></a>Напоминания о миграции с портала LUIS

[Портал Luis](https://www.luis.ai) предоставляет процесс миграции.

Вам будет предложено выполнить миграцию, если выполняются оба следующих условия.
* У вас есть приложения в системе проверки подлинности по электронной почте для разработки.
* Вы являетесь владельцем приложения.

Еженедельно будет предложено перенести приложения. Это окно можно закрыть без миграции. Если вы хотите выполнить миграцию до следующего запланированного периода, можно начать процесс миграции со значка **Azure** на верхней панели инструментов портала Luis.

## <a name="prediction-resources-blocking-migration"></a>Ресурсы прогнозирования, блокирующие миграцию
Миграция негативно влияет на среду выполнения любого приложения. При миграции все участники совместной работы удаляются из приложений, и вы удаляете их в качестве участника совместной работы из других приложений. Этот процесс означает, что ключи, назначаемые совместной работой, также удаляются, что может нарушить работу приложения, если оно находится в рабочей среде. Это причина блокировки миграции до тех пор, пока вы вручную не удалите назначенные им участники совместной работы или ключи.

Миграция блокируется, если выполняется одно из следующих условий.

* Вы назначили ресурсы прогноза и среды выполнения в приложениях, которыми вы не владеете.
* У вас есть другие пользователи, которым назначены ресурсы прогноза и среды выполнения для приложений, которыми вы владеете.

### <a name="recommended-steps-if-youre-the-owner-of-the-app"></a>Рекомендуемые действия, если вы являетесь владельцем приложения
Если вы являетесь владельцем некоторых приложений и у вас есть участники совместной работы, которым для этих приложений назначены прогноз/время выполнения, при миграции появится сообщение об ошибке. В этой ошибке перечислены идентификаторы приложений, которым назначены ключи прогнозирования, принадлежащие другим пользователям.

Примите во внимание следующие рекомендации.
* Уведомлять участников совместной работы о миграции.
* Удалите все участники совместной работы из приложений, показанных в ошибке.
* Пройдет процесс миграции, который должен быть выполнен, если вы вручную удалите участников совместной работы.
* Назначьте участников совместной работы как участников нового ресурса для разработки. Участники совместной работы будут переносить и переназначить прогнозирующие ресурсы приложениям. Обратите внимание, что это приведет к временному прерыванию приложения, пока ресурсы прогнозирования не будут переназначены.

Существует еще одно возможное решение. Перед миграцией владельца участники совместной работы могут добавить владельцев приложений в качестве участников подписки Azure из портал Azure. Этот шаг предоставит владельцу доступ к ресурсу прогнозирования времени выполнения. Если владелец переносится с помощью новой подписки, которую она добавила в (которая будет найдена в новом клиенте), этот шаг не просто разблокирует процесс миграции как для участника совместной работы, так и для владельца приложения. Кроме того, это позволяет плавно перенести приложения, при этом ключ прогнозирования по-прежнему будет назначен им без нарушения работы приложений.


### <a name="recommended-steps-if-youre-a-collaborator-on-an-app"></a>Рекомендуемые действия, если вы являетесь членом совместной работы в приложении
При совместной работе над приложениями и назначении этих приложений в качестве прогноза или времени выполнения при миграции возникает ошибка. В этой ошибке перечислены идентификаторы приложений и пути к ключам, которые блокируют миграцию.

Примите во внимание следующие рекомендации.
* Экспорт приложений в качестве резервной копии. Это необязательный шаг в процессе миграции.
* Отменить назначение ресурсов прогноза на странице " **Управление**  >  **ресурсами Azure** ".
* Процесс миграции завершен.
* Импорт приложений обратно после миграции.
* Переназначьте прогнозные ключи приложениям на странице " **Управление**  >  **ресурсами Azure** ".

> [!Note]
> При импорте приложений после миграции они будут иметь разные идентификаторы приложений. Они также будут отличаться от тех, которые нападают в рабочую среду. Теперь вы будете владельцем этих приложений.

## <a name="troubleshooting-the-migration-process"></a>Устранение неполадок процесса миграции

При попытке выполнить миграцию, но не удается найти подписку Azure в раскрывающемся списке:
* Убедитесь, что у вас есть действующая подписка Azure, которая имеет право на создание Cognitive Services ресурсов. Перейдите к [портал Azure](https://ms.portal.azure.com) и проверьте состояние подписки. Если у вас ее нет, [Создайте бесплатную учетную запись Azure](https://azure.microsoft.com/free/cognitive-services/).
* Убедитесь, что вы находитесь в соответствующем клиенте, связанном с действительной подпиской. Вы можете переключать клиенты с аватара на панель инструментов, ![ где можно переключать клиенты.](./media/migrate-authoring-key/switch-user-tenant-2.png)

Если у вас есть существующий ресурс, но его невозможно найти при выборе параметра **использовать существующий ресурс создания ресурсов** :
* Вероятно, ресурс был создан в расположении, отличном от портала, в котором вы вошли. Проверьте [области разработки и порталы Luis](https://docs.microsoft.com/azure/cognitive-services/luis/luis-reference-regions#luis-authoring-regions).
* Вместо этого создайте новый ресурс на портале LUIS.

Если выбран параметр **создать новый ресурс** создания и миграция завершается сбоем с сообщением об ошибке "не удалось получить сведения о пользователе Azure, повторите попытку позже":
* Ваша подписка может иметь 10 или более ресурсов разработки для каждого региона на подписку. Если это так, вы не сможете создать новый ресурс для разработки.
* Выполните миграцию, выбрав параметр **использовать существующий ресурс создания** и выбрав один из существующих ресурсов в подписке.

Если вы видите следующую ошибку, ознакомьтесь с [рекомендуемыми действиями, если вы являетесь владельцем приложения](#recommended-steps-if-youre-the-owner-of-the-app).
![Ошибка, показывающая, что миграция не удалась для владельцев](./media/migrate-authoring-key/migration-failed-for-owner-2.png)

Если вы видите следующую ошибку, ознакомьтесь с [рекомендуемыми действиями, если вы являетесь членом совместной работы в приложении](#recommended-steps-if-youre-a-collaborator-on-an-app).
![Ошибка, показывающая, что произошел сбой миграции для участников совместной работы](./media/migrate-authoring-key/migration-failed-for-collab-2.png)


## <a name="next-steps"></a>Дальнейшие шаги

* Ознакомьтесь [с основными понятиями о создании и использовании ключей среды выполнения](luis-how-to-azure-subscription.md).
* Узнайте, как [назначать ключи](luis-how-to-azure-subscription.md) и [добавлять участников](luis-how-to-collaborate.md).
