---
title: Разработка и ключи среды выполнения — LUIS
titleSuffix: Azure Cognitive Services
description: LUIS использует два ключа — ключ разработки для создания модели и ключ среды выполнения для запроса конечной точки прогнозирования с пользовательским фразы продолжительностью.
services: cognitive-services
author: diberry
manager: nitinme
ms.custom: seodec18
ms.service: cognitive-services
ms.subservice: language-understanding
ms.topic: conceptual
ms.date: 09/27/2019
ms.author: diberry
ms.openlocfilehash: 70e58077fa40ce685324cd24b447886ec3411034
ms.sourcegitcommit: 6fe40d080bd1561286093b488609590ba355c261
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/01/2019
ms.locfileid: "71703184"
---
# <a name="authoring-and-runtime-keys"></a>Ключи разработки и среды выполнения


>[!NOTE]
>Прежде чем продолжить, выполните [миграцию](luis-migration-authoring.md) всех приложений, которые не используют ресурс создания Azure.

LUIS использует два типа ресурсов Azure, каждый из которых имеет ключи: 
 
* [Разработка](#programmatic-key) для создания целей, сущностей и меток фразы продолжительностью, обучения и публикации. Когда вы будете готовы опубликовать приложение LUIS, вам потребуется [ключ конечной точки прогнозирования для среды выполнения](luis-how-to-azure-subscription.md) , назначенной приложению.
* [Ключ конечной точки прогнозирования для среды выполнения](#prediction-endpoint-runtime-key). Клиентским приложениям, таким как робот чата, требуется доступ к **конечной точке прогнозирования запросов** среды выполнения с помощью этого ключа. 

|Ключ|Цель|@No__t службы для пробуждения — 0|@No__t службы для пробуждения — 0|
|--|--|--|--|
|[Ключ разработки](#programmatic-key)|Разработка, обучение, публикация, тестирование.|`LUIS.Authoring`|`Cognitive Services`|
|[Ключ среды выполнения прогнозирующих точек](#prediction-endpoint-runtime-key)| Среда выполнения прогнозирования запросов с пользователем utterance для определения целей и сущностей.|`LUIS`|`Cognitive Services`|

LUIS также предоставляет [начальный ключ](luis-how-to-azure-subscription.md#starter-key) с 1000 квоты на конечную точку прогнозирования транзакций в месяц. 

Хотя вам не нужно создавать оба ключа одновременно, это гораздо проще при выполнении.

Важно создавать приложения LUIS в [регионах](luis-reference-regions.md#publishing-regions) , где вы хотите публиковать и запрашивать.

<a name="programmatic-key" ></a>

## <a name="authoring-key"></a>Ключ разработки

Ключ разработки создается автоматически при создании учетной записи LUIS и предоставляется бесплатно. Когда вы начинаете с LUIS, у вас есть один начальный ключ во всех приложениях LUIS для каждого [региона](luis-reference-regions.md)разработки. Назначение ключа разработки заключается в предоставлении проверки подлинности для управления приложением LUIS или для тестирования запросов конечной точки прогнозирования. 

Создание ключей разработки в портал Azure позволяет управлять разрешениями для ресурсов разработки путем назначения пользователей [роли участника](#contributions-from-other-authors). Для добавления участников необходимо разрешение на уровне подписки Azure. 

Чтобы найти ключ разработки, войдите на [веб-сайт LUIS](luis-reference-regions.md#luis-website) и щелкните имя учетной записи на панели навигации справа вверху, чтобы открыть **Параметры учетной записи**.

![Ключ разработки](./media/luis-concept-keys/authoring-key.png)

Если вы хотите выполнить **запросы среды выполнения**, создайте ресурс Azure [Luis](https://azure.microsoft.com/pricing/details/cognitive-services/language-understanding-intelligent-services/). 

> [!CAUTION]
> Для удобства многие из примеров используют [начальный ключ](#starter-prediction-endpoint-runtime-key) , так как он предоставляет несколько свободных вызовов конечной точки прогнозирования в своей [квоте](luis-boundaries.md#key-limits).  

<a name="endpoint-key"></a>

## <a name="prediction-endpoint-runtime-key"></a>Ключ среды выполнения прогнозирующих точек 

Если требуются **запросы конечной точки среды выполнения**, создайте ресурс Language UNDERSTANDING (Luis), а затем назначьте его приложению Luis. 

[!INCLUDE [Azure runtime resource creation for Language Understanding and Cognitive Service resources](../../../includes/cognitive-services-luis-azure-resource-instructions.md)]

По завершении процесса создания ресурса [назначьте ключ](luis-how-to-azure-subscription.md) приложению. 

* Ключ времени выполнения (конечная точка прогнозирования запросов) обеспечивает квоту на попадание конечных точек на основе плана использования, указанного при создании ключа среды выполнения. Сведения о ценах см. в разделе [Цены на Cognitive Services](https://azure.microsoft.com/pricing/details/cognitive-services/language-understanding-intelligent-services/?v=17.23h).

* Ключ среды выполнения можно использовать для всех приложений LUIS или для конкретных приложений LUIS. 
* Не используйте ключ среды выполнения для создания приложений LUIS. 

### <a name="starter-prediction-endpoint-runtime-key"></a>Ключ среды выполнения конечной точки начального прогнозирования

Ключ конечной точки **начального** прогноза предоставляется бесплатно и включает в себя 1000 запросов к конечной точке прогнозирования. После использования этих запросов необходимо создать собственный ресурс конечной точки прогноза для Language Understanding.  

Это специальный ресурс, созданный для вас. Он не отображается в списке ресурсов Azure, так как он предназначен для использования в качестве временного начального ключа. 

<a name="use-endpoint-key-in-query"></a>

### <a name="use-runtime-key-in-query"></a>Использование ключа среды выполнения в запросе
Конечная точка среды выполнения LUIS принимает два стиля запроса: используется ключ среды выполнения прогнозирующего Endpoint, но в разных местах.

Конечная точка, используемая для доступа к среде выполнения, использует дочерний домен, уникальный для региона ресурса, обозначенный `{region}` в следующей таблице. 


#### <a name="v2-prediction-endpointtabv2"></a>[Конечная точка прогнозирования v2](#tab/V2)

|Команда|Пример URL-адреса и расположение ключа|
|--|--|
|[GET](https://westus.dev.cognitive.microsoft.com/docs/services/5819c76f40a6350ce09de1ac/operations/5819c77140a63516d81aee78)|`https://{region}.api.cognitive.microsoft.com/luis/v2.0/apps/df67dcdb-c37d-46af-88e1-8b97951ca1c2?runtime-key=your-endpoint-key-here&verbose=true&timezoneOffset=0&q=turn%20on%20the%20lights`|
|[POST](https://westus.dev.cognitive.microsoft.com/docs/services/5819c76f40a6350ce09de1ac/operations/5819c77140a63516d81aee79)| `https://{region}.api.cognitive.microsoft.com/luis/v2.0/apps/df67dcdb-c37d-46af-88e1-8b97951ca1c2`|

#### <a name="v3-prediction-endpointtabv3"></a>[V3 прогнозная конечная точка](#tab/V3)

|Команда|Пример URL-адреса и расположение ключа|
|--|--|
|[GET](https://westcentralus.dev.cognitive.microsoft.com/docs/services/luis-endpoint-api-v3-0-preview/operations/5cb0a91e54c9db63d589f433)|`https://{region}.api.cognitive.microsoft.com/luis/v3.0-preview/apps/df67dcdb-c37d-46af-88e1-8b97951ca1c2/slots/production/predict?runtime-key=your-endpoint-key-here&query=turn%20on%20the%20lights`|
|[POST](https://westcentralus.dev.cognitive.microsoft.com/docs/services/luis-endpoint-api-v3-0-preview/operations/5cb0a5830f741b27cd03a061)| `https://{region}.api.cognitive.microsoft.com/luis/v3.0-preview/apps/df67dcdb-c37d-46af-88e1-8b97951ca1c2/slots/production/predict`| 

Дополнительные сведения о [конечной точке прогнозирования v3](luis-migration-api-v3.md).

* * * 

**ПОЛУЧИТЬ**: Чтобы использовать квоту конечной точки LUIS, измените значение запроса конечной точки для `runtime-key` с ключа разработки (начального ключа) на новый ключ конечной точки. Если создать и назначать ключ, но не изменять значение запроса конечной точки для `runtime-key`, вы не будете использовать квоту ключа конечной точки.

**POST**: Изменение значения заголовка для `Ocp-Apim-Subscription-Key`<br>Если вы создаете ключ среды выполнения и назначаете ключ среды выполнения, но не изменяете значение запроса конечной точки для `Ocp-Apim-Subscription-Key`, вы не используете ключ среды выполнения.

Идентификатор приложения, используемый в предыдущих URL-адресах, `df67dcdb-c37d-46af-88e1-8b97951ca1c2`, является общедоступным приложением Интернета вещей, используемым для [интерактивной демонстрации](https://azure.microsoft.com/services/cognitive-services/language-understanding-intelligent-service/). 

## <a name="assignment-of-the-runtime-key"></a>Назначение ключа среды выполнения

Вы можете [назначить](luis-how-to-azure-subscription.md) ключ среды выполнения на [портале Luis](https://www.luis.ai) или через соответствующие API. 

## <a name="key-limits"></a>Ограничения ключа

Вы можете создать до 10 ключей создания для каждого региона на подписку. 

См. [раздел ограничения ключей](luis-boundaries.md#key-limits) и [регионы Azure](luis-reference-regions.md). 

Регионы публикации отличаются от регионов разработки. Убедитесь, что вы создали приложение в области разработки, соответствующей региону публикации, в котором должно располагаться клиентское приложение.

## <a name="key-limit-errors"></a>Ошибки ограничений ключей
При превышении квоты на количество транзакций в секунду (TPS) возникает ошибка HTTP 429. Если вы превысили квоту на транзакцию за месяц (TPS), вы получаете ошибку HTTP 403. 

## <a name="contributions-from-other-authors"></a>Вклады других авторов



Управление вкладами из участников совместной работы зависит от текущего состояния приложения.

**Для [создания переносимых ресурсов](luis-migration-authoring.md) приложения**: _участники_ управляются в портал Azure для ресурса разработки с помощью страницы **управления доступом (IAM)** . Узнайте, [как добавить пользователя](luis-how-to-collaborate.md), используя адрес электронной почты участника совместной работы и роль _участника_ . 

**Для приложений, которые еще не перенесены**: все _Участники совместной работы_ управляются на портале Luis на странице **совместной работы "Управление >** ".

### <a name="contributor-roles-vs-entity-roles"></a>Роли участника и роли сущности

[Роли сущности](luis-concept-roles.md) применяются к модели данных приложения Luis. Роли совместной работы и участников применяются к уровням доступа для разработки. 

## <a name="moving-or-changing-ownership"></a>Перемещение или изменение владельца

Приложение определяется ресурсами Azure, которое определяется подпиской владельца. 

Вы можете переместить приложение LUIS. Используйте следующие ресурсы документации в портал Azure или Azure CLI.

* [Перемещение приложения между ресурсами по разработке LUIS](https://westus.dev.cognitive.microsoft.com/docs/services/5890b47c39e2bb17b84a55ff/operations/apps-move-app-to-another-luis-authoring-azure-resource)
* [Перемещение ресурса в новую группу ресурсов или подписку](../../azure-resource-manager/resource-group-move-resources.md)
* [Переместить ресурс в пределах одной подписки или в рамках подписок](../../azure-resource-manager/move-limitations/app-service-move-limitations.md)
* [Перенос владения](../../billing/billing-subscription-transfer.md) подпиской 

## <a name="access-for-private-and-public-apps"></a>Доступ для частных и общедоступных приложений

Для **частного** приложения доступ к среде выполнения предоставляется владельцам и участникам. Для **общедоступного приложения доступ** к среде выполнения предоставляется всем, у кого есть собственный ресурс [службы](../cognitive-services-apis-create-account.md) "Поиск Azure" или "Среда выполнения [Luis](luis-how-to-azure-subscription.md#create-resources-in-the-azure-portal) ", а также идентификатор общедоступного приложения. 

В настоящее время каталог общедоступных приложений отсутствует.

### <a name="authoring-access"></a>Доступ для разработки
Доступ к приложению с портала [Luis](luis-reference-regions.md#luis-website) или [API-интерфейсов разработки](https://go.microsoft.com/fwlink/?linkid=2092087) управляется ресурсом разработки Azure. 

Владелец и все участники имеют доступ для создания приложения. 

|Доступ к разработке включает в себя:|Примечания|
|--|--|
|Добавление или удалений ключей конечных точек||
|Экспорт версии||
|Экспорт журналов конечных точек||
|Импорт версии||
|Предоставление к приложению общего доступа|Если приложение является общедоступным, запросить его может любой пользователь с ключом разработки или ключом конечной точки.|
|Изменение модели|
|Опубликовать|
|Проверка высказываний конечной точки для [активного обучения](luis-how-to-review-endpoint-utterances.md)|
|Обучить|

### <a name="prediction-endpoint-runtime-access"></a>Доступ к среде выполнения для конечной точки прогнозирования

Доступ к запросу конечной точки прогнозирования управляется параметром на странице **сведения о приложении** в разделе **Управление** . 

![Предоставление к приложению общего доступа](./media/luis-concept-security/set-application-as-public.png)

|[Частная конечная точка](#runtime-security-for-private-apps)|[Общедоступная конечная точка](#runtime-security-for-public-apps)|
|:--|:--|
|Доступно для владельца и участников|Доступно для владельца, участников и других пользователей, которым известен идентификатор приложения|

Вы можете контролировать, кто видит ключ среды выполнения LUIS, вызывая его в среде "сервер-сервер". Если вы используете LUIS из бота, соединение между ботом и LUIS уже защищено. При вызове конечной точки LUIS напрямую следует создать серверный API (такой как [функция](https://azure.microsoft.com/services/functions/) Azure) с контролируемым доступом (таким как [AAD](https://azure.microsoft.com/services/active-directory/)). При вызове API на стороне сервера и проверке подлинности и авторизации, передайте вызов в LUIS. Хотя эта стратегия не мешает атакам типа "злоумышленник в середине", она скрывает ключ и URL-адрес конечной точки от пользователей, позволяет контролировать доступ и позволяет добавлять журнал ответов на конечные точки (например, [Application Insights](https://azure.microsoft.com/services/application-insights/)).

#### <a name="runtime-security-for-private-apps"></a>Безопасность среды выполнения для частных приложений

Среда выполнения частного приложения доступна только для следующих приложений:

|Ключ и пользователь|Объяснение|
|--|--|
|Ключ разработки владельца| До 1000 обращений к конечной точке|
|Ключи для совместной работы и создания участников| До 1000 обращений к конечной точке|
|Любой ключ, назначенный LUIS автору или участнику совместной работы|В зависимости от уровня использования ключей|

#### <a name="runtime-security-for-public-apps"></a>Безопасность среды выполнения для общедоступных приложений

После этого _любой_ допустимый ключ разработки или ключ конечной точки LUIS может выполнять запросы к приложению до тех пор, пока он не израсходует всю квоту конечной точки.

Пользователь, не являющийся владельцем или участником, может получить доступ к среде выполнения общедоступного приложения только при наличии идентификатора приложения. У LUIS нет общедоступного _магазина_ или других вариантов поиска общедоступных приложений.  

Общедоступное приложение публикуется во всех регионах, чтобы пользователь с ключом ресурса LUIS для определенного региона смог получить доступ к приложению в том регионе, который связан с ключом ресурса.

## <a name="transfer-of-ownership"></a>Передача права владения

**Для [создания перенесенных приложений ресурсов](luis-migration-authoring.md)** : Как владелец ресурса можно добавить `contributor`.

**Для приложений, которые еще не перенесены**: Экспортируйте приложение как JSON-файл. Другой пользователь LUIS может импортировать приложение, тем самым преставя его в владельца. Новое приложение будет иметь другой идентификатор приложения.  

## <a name="securing-the-endpoint"></a>Защита конечной точки 

Вы можете контролировать, кто может просматривать ключ конечной точки среды выполнения LUIS PREDICTION, вызывая его в среде "сервер-сервер". Если вы используете LUIS из бота, соединение между ботом и LUIS уже защищено. При вызове конечной точки LUIS напрямую следует создать серверный API (такой как [функция](https://azure.microsoft.com/services/functions/) Azure) с контролируемым доступом (таким как [AAD](https://azure.microsoft.com/services/active-directory/)). После вызова серверного API и прохождения авторизации и проверки подлинности нужно передать вызов в LUIS. Хотя эта стратегия не предотвращает распространение атак с перехватом, она маскирует конечную точку от пользователей, позволяет отслеживать доступ и добавлять функцию ведения журнала ответов конечной точки (такую как [Application Insights](https://azure.microsoft.com/services/application-insights/)).  

## <a name="next-steps"></a>Следующие шаги

* Поймите принципы [управления версиями](luis-concept-version.md). 
* Узнайте [, как создавать ключи](luis-how-to-azure-subscription.md).
