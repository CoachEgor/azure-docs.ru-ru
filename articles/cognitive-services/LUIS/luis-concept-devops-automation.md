---
title: Тестирование для DevOps-LUIS
description: Как реализовать рабочие процессы CI/CD для DevOps для Language Understanding (LUIS).
ms.topic: conceptual
ms.date: 06/5/2020
ms.openlocfilehash: 87b922d176f3ef11f25e46c8e076c88d5f3854c3
ms.sourcegitcommit: 52d2f06ecec82977a1463d54a9000a68ff26b572
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/15/2020
ms.locfileid: "84783687"
---
# <a name="continuous-integration-and-continuous-delivery-workflows-for-luis-devops"></a>Рабочие процессы непрерывной интеграции и непрерывной поставки для LUIS DevOps

Разработчики программного обеспечения, разрабатывающих приложение Language Understanding (LUIS), могут применять DevOps рекомендации по управлению [версиями](luis-concept-devops-sourcecontrol.md), [автоматизированным сборкам](luis-concept-devops-automation.md), [тестированию](luis-concept-devops-testing.md)и [управлению выпусками](luis-concept-devops-automation.md#release-management). В этой статье описываются основные понятия реализации автоматизированных сборок для LUIS.

## <a name="build-automation-workflows-for-luis"></a>Создание рабочих процессов автоматизации для LUIS

![Рабочие процессы CI](./media/luis-concept-devops-automation/luis-automation.png)

В системе управления исходным кодом настройте автоматический конвейер сборки для запуска со следующими событиями:

1. **Рабочий процесс PR** активируется при возникновении [запроса на вытягивание](https://help.github.com/github/collaborating-with-issues-and-pull-requests/about-pull-requests) . Этот рабочий процесс проверяет содержимое запроса *перед* слиянием обновлений в главную ветвь.
1. **Рабочий процесс CI/CD** запускается при отправке обновлений в главную ветвь, например при объединении изменений из запроса на вытягивание. Этот рабочий процесс обеспечивает качество всех обновлений в главной ветви.

**Рабочий процесс CI/CD** объединяет два дополнительных процесса разработки:

* [Непрерывная интеграция](https://docs.microsoft.com/azure/devops/learn/what-is-continuous-integration) (CI) — это инженерный подход к частому фиксации кода в общем репозитории и выполнение автоматизированной сборки. Благодаря автоматическому подходу к [тестированию](luis-concept-devops-testing.md) непрерывная интеграция позволяет проверить, что для каждого обновления источник лудовн по-прежнему действителен и может быть импортирован в приложение Luis, но при этом он проходит группу тестов, проверяющих, что обученное приложение может распознать смысл и сущности, необходимые для вашего решения.

* [Непрерывная поставка](https://docs.microsoft.com/azure/devops/learn/what-is-continuous-delivery) (CD) использует концепцию непрерывной интеграции для автоматического развертывания приложения в среде, где можно выполнить более глубокое тестирование. С помощью CD вы узнаете, как можно быстрее устранить непредвиденные проблемы, возникающие при внесении изменений, а также узнать о пропусках в нашем тесте.

Цель непрерывной интеграции и непрерывной поставки заключается в том, чтобы убедиться в том, что "Master всегда поддерживается". Для приложения LUIS это означает, что мы можем, если нам нужно, взять любую версию из приложения LUIS главной ветви и поставлять ее в рабочую среду.

### <a name="tools-for-building-automation-workflows-for-luis"></a>Средства для создания рабочих процессов автоматизации для LUIS

Существуют различные технологии автоматизации сборки, доступные для создания рабочих процессов автоматизации сборки. Все они зависят от того, что вы можете создавать скрипты с помощью интерфейса командной строки (CLI) или вызовов RESTFUL, чтобы они могли выполняться на сервере сборки.

Используйте следующие средства для создания рабочих процессов автоматизации для LUIS:

* [Инструменты Luis Framework CLI](https://github.com/microsoft/botbuilder-tools/tree/master/packages/LUIS) позволяют работать с приложениями и версиями Luis, обучать, тестировать и публиковать их в службе Luis.

* [Azure CLI](https://docs.microsoft.com/cli/azure/?view=azure-cli-latest) , чтобы запросить подписки Azure, получить ключи создания и прогнозирования Luis, а затем создать [субъект-службу](https://docs.microsoft.com/cli/azure/ad/sp?view=azure-cli-latest) Azure, используемый для проверки подлинности с помощью автоматизации.

* [НЛУ. Средство DevOps](https://github.com/microsoft/NLU.DevOps) для [тестирования приложения Luis](luis-concept-devops-testing.md) и анализа результатов теста.

### <a name="the-pr-workflow"></a>Рабочий процесс PR

Как уже упоминалось, этот рабочий процесс настраивается для запуска, когда разработчик создает запрос на вытягивание, чтобы предложить изменения для слияния из ветви компонентов в главную ветвь. Его целью является проверка качества изменений в запросе перед их слиянием в главную ветвь.

Этот рабочий процесс должен:

* Создайте временное приложение LUIS, импортировав `.lu` источник в поле запроса на вытягивание.
* Обучить и публикуйте версию приложения LUIS.
* Выполните все [модульные тесты](luis-concept-devops-testing.md) .
* Передача рабочего процесса, если все тесты пройдены, в противном случае — сбой.
* Очистите и удалите временное приложение.

Если эта возможность поддерживается в SCM, настройте правила защиты ветвей таким образом, чтобы этот рабочий процесс успешно завершился до завершения запроса на вытягивание.

### <a name="the-master-branch-cicd-workflow"></a>Рабочий процесс CI/CD главной ветви

Настройте этот рабочий процесс для запуска после слияния обновлений в запросе к главной ветви. Его цель — обеспечить высокий уровень качества для главной ветви, проверив обновления. Если обновления соответствуют строке качества, этот рабочий процесс развертывает новую версию приложения LUIS в среде, где можно выполнить более глубокое тестирование.

Этот рабочий процесс должен:

* Создайте новую версию в основном приложении LUIS (приложение, которое вы сохраняете для главной ветви) с помощью обновленного исходного кода.

* Обучить и публикуйте версию приложения LUIS.

  > [!NOTE]
  > Как описано в разделе [выполнение тестов в рабочем процессе автоматической сборки](luis-concept-devops-testing.md#running-tests-in-an-automated-build-workflow) , необходимо опубликовать тестируемую версию приложения Luis, чтобы такие средства, как НЛУ. DevOps может получить к нему доступ. LUIS поддерживает только два именованных слота публикации: *промежуточное* и *рабочее* для приложения Luis, но вы также можете [публиковать версию напрямую](https://github.com/microsoft/botframework-cli/blob/master/packages/luis/README.md#bf-luisapplicationpublish) и выполнять [запросы по версии](https://docs.microsoft.com/azure/cognitive-services/luis/luis-migration-api-v3#changes-by-slot-name-and-version-name). Используйте прямую публикацию версий в рабочих процессах автоматизации, чтобы не ограничиваться использованием именованных слотов публикации.

* Выполните все [модульные тесты](luis-concept-devops-testing.md).

* При необходимости выполните [пакетные тесты](luis-concept-devops-testing.md#how-to-do-unit-testing-and-batch-testing) , чтобы оценить качество и точность версии приложения Luis и сравнить ее с некоторыми базовыми показателями.

* При успешном завершении тестов:
  * Пометка источника в репозитории.
  * Запустите задание непрерывной поставки (CD), чтобы развернуть версию приложения LUIS в средах для дальнейшего тестирования.

### <a name="continuous-delivery-cd"></a>Непрерывная поставка (CD)

Задание CD в рабочем процессе CI/CD выполняется по условию при успешном выполнении сборки и автоматизации модульных тестов. Его задание — автоматическое развертывание приложения LUIS в среде, где можно выполнить дополнительное тестирование.

Нет ни одного рекомендуемого решения о том, как лучше всего развертывать приложение LUIS, и необходимо реализовать процесс, подходящий для вашего проекта. Репозиторий [шаблонов Luis DevOps](https://github.com/Azure-Samples/LUIS-DevOps-Template) реализует простое решение, которое позволяет [опубликовать новую версию приложения Luis](https://docs.microsoft.com/azure/cognitive-services/luis/luis-how-to-publish-app) в слоте *рабочей* публикации. Это подходит для простой установки. Тем не менее, если необходимо поддерживать несколько различных рабочих сред одновременно, например для *разработки*, *промежуточного хранения* и *UAT*, то ограничение на два именованных слотов публикации на приложение станет недостаточным.

Ниже приведены другие варианты развертывания версии приложения.

* Оставьте версию приложения опубликованной в конечной точке прямой версии и реализуйте процесс для настройки подчиненных рабочих сред с конечной точкой прямой версии в соответствии с требованиями.
* Сохраняйте различные приложения LUIS для каждой рабочей среды и напишем шаги автоматизации для импорта в `.lu` новую версию в приложении Luis для целевой рабочей среды, для обучения и публикации.
* Экспортируйте протестированную версию приложения LUIS в [контейнер DOCKER Luis](https://docs.microsoft.com/azure/cognitive-services/luis/luis-container-howto?tabs=v3) и РАЗВЕРНИТЕ контейнер Luis в службе " [экземпляры контейнеров](https://docs.microsoft.com/azure/container-instances/)Azure".

## <a name="release-management"></a>Управление выпуском

Как правило, рекомендуется непрерывная доставка только в нерабочие среды, например в разработку и промежуточное хранение. Большинству команд требуется процесс проверки и утверждения вручную для развертывания в рабочей среде. В рабочем развертывании может потребоваться убедиться, что это происходит, когда основные пользователи команды разработчиков доступны для поддержки или в периоды низкой нагрузки.

## <a name="next-steps"></a>Дальнейшие действия

* Узнайте, как [реализовать DevOps для Luis с GitHub](luis-how-to-devops-with-github.md)
* Узнайте, как написать [Рабочий процесс для действий GitHub с помощью НЛУ. DevOps](https://github.com/Azure-Samples/LUIS-DevOps-Template/blob/master/docs/4-pipeline.md)
