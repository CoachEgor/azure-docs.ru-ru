---
title: Управление версиями и ветви разработки — LUIS
description: Сведения о поддержке приложения Language Understanding (LUIS) в системе управления версиями. Как применить обновления к приложению LUIS при работе в ветви разработки.
ms.topic: conceptual
ms.date: 05/28/2020
ms.openlocfilehash: 2d060fefbd32ecea1f91e6b062da7606699a63c4
ms.sourcegitcommit: 52d2f06ecec82977a1463d54a9000a68ff26b572
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/15/2020
ms.locfileid: "84783676"
---
# <a name="devops-practices-for-luis"></a>Рекомендации по DevOps для LUIS

Разработчики программного обеспечения, которые разрабатывают приложение Language Understanding (LUIS), могут применять DevOps рекомендации по управлению [версиями](luis-concept-devops-sourcecontrol.md), [автоматизированным сборкам](luis-concept-devops-automation.md), [тестированию](luis-concept-devops-testing.md)и [управлению выпусками](luis-concept-devops-automation.md#release-management) , следуя этим рекомендациям.

## <a name="source-control-and-branch-strategies-for-luis"></a>Управление версиями и стратегии ветвления для LUIS

Одним из ключевых факторов успешности DevOps зависит от [системы управления версиями](https://docs.microsoft.com/azure/devops/user-guide/source-control?view=azure-devops). Система управления версиями позволяет разработчикам совместно работать над кодом и отслеживанию изменений. Использование ветвей позволяет разработчикам переключаться между различными версиями базы кода и работать независимо от других членов группы. Когда разработчики создают [запрос на вытягивание](https://help.github.com/github/collaborating-with-issues-and-pull-requests/about-pull-requests) (PR) для предложения обновлений из одной ветви в другую или при слиянии изменений, они могут быть триггерами для [автоматизированных сборок](luis-concept-devops-automation.md) для создания и непрерывного тестирования кода.

Используя основные понятия и рекомендации, описанные в этом документе, можно разработать приложение LUIS при отслеживании изменений в системе управления версиями и следовать рекомендациям по проектированию программного обеспечения:

- **Система управления версиями**
  - Исходный код для приложения LUIS находится в удобном для человека формате.
  - Модель может быть построена из источника с повторяемым способом.
  - Исходный код может управляться репозиторием исходного кода.
  - Учетные данные и секреты, такие как ключи создания и подписки, никогда не хранятся в исходном коде.

- **Ветвление и объединение**
  - Разработчики могут работать с независимыми ветвями.
  - Разработчики могут параллельно работать в нескольких ветвях.
  - Можно интегрировать изменения в приложение LUIS из одной ветви в другую с помощью пересчета или слияния.
  - Разработчики могут объединить запрос на включение внесенных изменений в родительскую ветвь.

- **Управление версиями**
  - Каждый компонент крупного приложения должен иметь версию независимо друг от друга, позволяя разработчикам обнаруживать критические изменения или обновления только путем просмотра номера версии.

- **Проверка кода**
  - Изменения в запросе на вытягивание представляются как понятный для человека исходный код, который можно просмотреть перед принятием запроса на вытягивание.

## <a name="source-control"></a>Система управления версиями

Чтобы сохранить [Определение схемы приложения](https://docs.microsoft.com/azure/cognitive-services/luis/app-schema-definition) Luis в системе управления исходным кодом, используйте представление приложения в [формате лудовн ( `.lu` )](https://docs.microsoft.com/azure/bot-service/file-format/bot-builder-lu-file-format?view=azure-bot-service-4.0) . `.lu`формат является предпочтительным для `.json` форматирования, так как он удобен для чтения, что упрощает внесение и проверку изменений в вытягивание.

### <a name="save-a-luis-app-using-the-ludown-format"></a>Сохранение приложения LUIS в формате Лудовн

Чтобы сохранить приложение LUIS в `.lu` формате и поместить его в систему управления версиями, выполните следующие действия.

- ЛИБО [экспортируйте версию приложения](https://docs.microsoft.com/azure/cognitive-services/luis/luis-how-to-manage-versions#other-actions) `.lu` с [портала Luis](https://www.luis.ai/) , и добавьте ее в репозиторий системы управления версиями.

- ИЛИ используйте текстовый редактор, чтобы создать `.lu` файл для приложения Luis и добавить его в репозиторий системы управления версиями.

> [!TIP]
> Если вы работаете с экспортом JSON приложения LUIS, [его можно преобразовать в лудовн](https://github.com/microsoft/botframework-cli/tree/master/packages/luis#bf-luisconvert) с помощью [BotBuilder-Tools Luis CLI](https://github.com/microsoft/botbuilder-tools/tree/master/packages/LUIS). Используйте `--sort` параметр, чтобы обеспечить сортировку целей и фразы продолжительностью в алфавитном порядке.  
> Обратите внимание, что **. **Функция экспорта Lu, встроенная в портал Luis, уже Сортирует выходные данные.

### <a name="build-the-luis-app-from-source"></a>Создание приложения LUIS из источника

Для приложения *Luis для* [создания новой версии приложения Luis путем импорта `.lu` источника](https://docs.microsoft.com/azure/cognitive-services/luis/luis-how-to-manage-versions#import-version) , [обучения версии](https://docs.microsoft.com/azure/cognitive-services/luis/luis-how-to-train) и[ее публикации](https://docs.microsoft.com/azure/cognitive-services/luis/luis-how-to-publish-app). Это можно сделать на портале LUIS или в командной строке:

- Используйте портал LUIS для [импорта `.lu` версии](https://docs.microsoft.com/azure/cognitive-services/luis/luis-how-to-manage-versions#import-version) приложения из системы управления версиями, [обучения](https://docs.microsoft.com/azure/cognitive-services/luis/luis-how-to-train) и [публикации](https://docs.microsoft.com/azure/cognitive-services/luis/luis-how-to-publish-app) приложения.

- Используйте [интерфейс командной строки Bot Framework для Luis](https://github.com/microsoft/botbuilder-tools/tree/master/packages/LUIS) в командной строке или в рабочем процессе CI/CD для [импорта](https://github.com/microsoft/botframework-cli/blob/master/packages/luis/README.md#bf-luisversionimport) `.lu` версии приложения из системы управления версиями в приложение Luis, а также для [обучения](https://github.com/microsoft/botframework-cli/blob/master/packages/luis/README.md#bf-luistrainrun) и [публикации](https://github.com/microsoft/botframework-cli/blob/master/packages/luis/README.md#bf-luisapplicationpublish) приложения.

### <a name="files-to-maintain-under-source-control"></a>Файлы для поддержки в системе управления версиями

Следующие типы файлов для приложения LUIS должны поддерживаться в системе управления версиями:

- `.lu`файл для приложения LUIS

- [Файлы определения модульных тестов](luis-concept-devops-testing.md#writing-tests) (фразы продолжительностью и ожидаемые результаты)

- [Файлы пакетного теста](https://docs.microsoft.com/azure/cognitive-services/luis/luis-concept-batch-test#batch-file-format) (фразы продолжительностью и ожидаемые результаты), используемые для тестирования производительности

### <a name="credentialsand-keys-are-not-checked-in"></a>Учетные данные и ключи не возвращены

Не включайте ключи подписок или аналогичные конфиденциальные значения в файлы, которые вы верните в репозиторий, где они могут быть видны неавторизованному персоналу. Ключи и другие значения, которые следует запретить при возврате, включают:

- LUIS создание и прогнозирование ключей
- LUIS создания и прогнозирования конечных точек
- Ключи подписки Azure
- Маркеры доступа, например маркер для [субъекта-службы](https://docs.microsoft.com/cli/azure/ad/sp?view=azure-cli-latest) Azure, используемый для проверки подлинности с помощью автоматизации.

#### <a name="strategies-for-securely-managing-secrets"></a>Стратегии безопасного управления секретами

Ниже приведены стратегии безопасного управления секретами.

- Если вы используете управление версиями Git, вы можете хранить секреты времени выполнения в локальном файле и предотвращать возврат файла, добавляя шаблон для сопоставления имени файла с файлом [. gitignore.](https://git-scm.com/docs/gitignore)
- В рабочем процессе автоматизации можно безопасно хранить секреты в конфигурации параметров, предоставляемой этой технологией автоматизации. Например, если вы используете [действия GitHub](https://github.com/features/actions), вы можете безопасно хранить секреты в [секретах GitHub](https://help.github.com/en/actions/configuring-and-managing-workflows/creating-and-storing-encrypted-secrets).

## <a name="branching-and-merging"></a>Ветвление и объединение

Распределенные системы управления версиями, такие как Git, обеспечивают гибкость при публикации, совместном использовании, просмотре и переборе изменений кода с помощью ветвей разработки, совместно используемых другими пользователями. Принятие [стратегии ветвления Git](https://docs.microsoft.com/azure/devops/repos/git/git-branching-guidance) , подходящей для вашей команды.

Какая бы стратегия ветвления была принята, ключевым принципом всех из них является то, что члены группы могут работать над решением в *ветви компонентов* независимо от работы, которая выполняется в других ветвях.

Для поддержки независимой работы в ветвях с проектом LUIS:

- **Главная ветвь имеет собственное приложение LUIS.** Это приложение представляет текущее состояние вашего решения для вашего проекта, и его текущая активная версия всегда должна сопоставляться с `.lu` источником, который находится в главной ветви. Все обновления `.lu` источника для этого приложения следует проверить и протестировать, чтобы это приложение можно было развернуть в средах сборки, например в рабочей среде, в любое время. При `.lu` слиянии обновлений в Master из ветви компонентов следует создать новую версию в приложении Luis и [вычислить номер версии](#versioning).

- **Каждая ветвь компонента должна использовать собственный экземпляр приложения Luis**. Разработчики работают с этим приложением в ветви компонентов, не рискуя воздействия на разработчиков, работающих в других ветвях. Приложение "ветвь Dev" — это рабочая копия, которая должна быть удалена при удалении ветви компонентов.

![Ветвь компонентов Git](./media/luis-concept-devops-sourcecontrol/feature-branch.png)

### <a name="developers-can-work-from-independent-branches"></a>Разработчики могут работать из независимых ветвей

Разработчики могут работать над обновлениями приложения LUIS независимо от других ветвей, выполнив следующие действия.

1. Создание ветви компонентов из основной ветви (в зависимости от стратегии ветвления, обычно главной или разработки).

1. [Создайте новое приложение Luis на портале Luis](https://docs.microsoft.com/azure/cognitive-services/luis/luis-how-to-start-new-app) ("*приложение ветви dev*") только для поддержки работы в ветви компонентов.

   * Если `.lu` источник решения уже существует в ветви, так как он был сохранен после работы в другой ветви ранее в проекте, создайте приложение Luis Branch для разработки, импортировав `.lu` файл.

   * Если вы начинаете работу над новым проектом, вы еще не будете иметь `.lu` источник для главного приложения Luis в репозитории. Вы создадите `.lu` файл, экспортировав приложение филиала разработки с портала, когда завершите работу ветви компонентов, и отправьте его как часть запроса на вытягивание.

1. Работа с активной версией приложения филиала для реализации необходимых изменений. Рекомендуется работать только в одной версии приложения в филиале для работы с ветвью компонентов. Если в приложении для разработки филиала создается несколько версий, следует следить за тем, какая версия содержит изменения, которые необходимо вернуть при создании запроса на вытягивание.

1. Тестирование обновлений. Дополнительные сведения о тестировании приложения филиала см. в разделе [тестирование для Luis DevOps](luis-concept-devops-testing.md) .

1. Экспортируйте активную версию приложения ветви разработки, как `.lu` в [списке версий](https://docs.microsoft.com/azure/cognitive-services/luis/luis-how-to-manage-versions).

1. Проверьте обновления и пригласите одноранговые проверки обновлений. Если вы используете GitHub, то порождается [запрос на вытягивание](https://help.github.com/en/github/collaborating-with-issues-and-pull-requests/about-pull-requests).

1. После утверждения изменений объедините обновления в главную ветвь. На этом этапе вы создадите новую версию *главного* приложения Luis с помощью обновленной [версии](https://docs.microsoft.com/azure/cognitive-services/luis/luis-how-to-manage-versions) в базе данных `.lu` master. Сведения о настройке имени версии см. в разделе [Управление версиями](#versioning) .

1. При удалении ветви компонентов рекомендуется удалить приложение dev Branch LUIS, созданное для работы с ветвью компонентов.

### <a name="developers-can-work-in-multiple-branches-concurrently"></a>Разработчики могут одновременно работать в нескольких ветвях

Если следовать описанному выше шаблону в разделе " [разработчики" могут работать из независимых ветвей](#developers-can-work-from-independent-branches), то в каждой ветви компонентов будет использоваться уникальное Luis приложение. Один разработчик может работать с несколькими ветвями одновременно, при условии, что они переключились на правильное приложение LUIS филиала для ветви, над которой они сейчас работают.

Мы рекомендуем использовать одно и то же имя для ветви компонентов и для приложения dev Branch LUIS, созданного для работы с ветвью компонентов, чтобы уменьшить вероятность того, что вы случайно будете работать с неправильным приложением.

Как отмечалось выше, для простоты рекомендуется работать в одной версии в каждом приложении филиала разработки. Если вы используете несколько версий, следите за активацией правильной версии при переключении между приложениями филиалов разработки.

### <a name="multiple-developers-can-work-on-the-same-branch-concurrently"></a>Несколько разработчиков могут одновременно работать с одной ветвью

Одновременно можно поддерживать несколько разработчиков, одновременно работающих с одной и той же ветвью компонента:

- Разработчики извлекают одну и ту же ветвь компонентов, а также отправляют и извлекают изменения, отправленные самим и другими разработчиками, когда работа продолжается, как и в обычных условиях.

- Если следовать описанному выше шаблону в разделе " [разработчики" могут работать из независимых ветвей](#developers-can-work-from-independent-branches), то эта ветвь будет использовать уникальное приложение Luis для поддержки разработки. Приложение LUIS "dev Branch" будет создано первым участником группы разработчиков, который начинает работать в ветви компонентов.

- [Добавляйте членов команды в качестве участников](https://docs.microsoft.com/azure/cognitive-services/luis/luis-how-to-collaborate) в приложение Luis ветвей dev.

- После завершения работы с ветвью компонентов экспортируйте активную версию приложения LUIS Branch dev, как `.lu` в [списке версии](https://docs.microsoft.com/azure/cognitive-services/luis/luis-how-to-manage-versions), сохраните обновленный `.lu` файл в репозитории, а затем верните его и отметьте изменения.

### <a name="incorporating-changes-from-one-branch-to-another-with-rebase-or-merge"></a>Включение изменений из одной ветви в другую с переоснованием или слиянием

Некоторые другие разработчики в вашей группе, работающие в другой ветви, могли внести обновления в `.lu` источник и объединить их в главную ветвь после создания ветви компонентов. Вы можете внести свои изменения в рабочую версию, прежде чем продолжать вносить собственные изменения в своей ветви компонентов. Это можно сделать путем изменения [базы или слияния с главным](https://git-scm.com/book/en/v2/Git-Branching-Rebasing) способом, как и для любого другого ресурса кода. Так как приложение LUIS в формате Лудовн является читаемым, оно поддерживает слияние с помощью стандартных средств слияния.

Если вы перерабатываете приложение LUIS в ветви компонентов, следуйте этим советам:

- Перед обновлением или слиянием убедитесь, что локальная копия `.lu` источника для приложения имеет все последние изменения, примененные с помощью портала Luis. для этого сначала необходимо повторно экспортировать приложение с портала. Таким образом, можно гарантировать, что все изменения, внесенные на портале, но еще не экспортированные, не будут потеряны.

- Во время слияния используйте стандартные средства для устранения конфликтов слияния.

- Не забудьте после перестройки или завершения слияния, чтобы повторно импортировать приложение обратно на портал, чтобы вы работали с обновленным приложением, так как вы продолжаете применять собственные изменения.

### <a name="merge-prs"></a>Вытягивание слиянием

После утверждения запроса на вытягивание вы можете объединить изменения в главную ветвь. К источнику Лудовн для приложения LUIS не применяются специальные рекомендации. это средство удобно для чтения и поддерживает слияние с использованием стандартных средств слияния. Любые конфликты слияния могут разрешаться так же, как и с другими исходными файлами.

После слияния запроса на вытягивание рекомендуется выполнить очистку:

- Удаление ветви в репозитории

- Удалите приложение LUIS "dev Branch", созданное для работы с ветвью компонентов.

Так же, как и в случае с ресурсами кода приложения, следует писать модульные тесты для обновления приложений LUIS. Для тестирования необходимо использовать рабочие процессы непрерывной интеграции:

- Обновления в запросе на вытягивание перед слиянием (PR)
- Приложение LUIS главной ветви после утверждения запроса на вытягивание и изменения были объединены в главную базу.

Дополнительные сведения о тестировании для LUIS DevOps см. в разделе [тестирование для DevOps для Luis](luis-concept-devops-testing.md). Дополнительные сведения о реализации рабочих процессов см. в разделе [рабочие процессы автоматизации для Luis DevOps](luis-concept-devops-automation.md).

## <a name="code-reviews"></a>проверка кода;

Приложение LUIS в формате Лудовн является удобным для чтения, которое поддерживает обмен данными с изменениями, подходящими для проверки. Файлы модульных тестов также пишутся в формате Лудовн и легко можно просмотреть в запросе на вытягивание.

## <a name="versioning"></a>Управление версиями

Приложение состоит из нескольких компонентов, которые могут включать в себя программы-роботы, работающие в [службе Azure Bot](https://docs.microsoft.com/azure/bot-service/bot-service-overview-introduction?view=azure-bot-service-4.0), [QnA Maker](https://www.qnamaker.ai/), [службу распознавания речи Azure](https://docs.microsoft.com/azure/cognitive-services/speech-service/overview)и многое другое. Чтобы достичь цели слабо связанных приложений, используйте [систему управления версиями](https://docs.microsoft.com/azure/devops/learn/git/what-is-version-control) , чтобы управлять версиями каждого компонента приложения независимо, позволяя разработчикам обнаруживать критические изменения или обновления только путем просмотра номера версии. Вы можете использовать версию приложения LUIS независимо от других компонентов, если оно поддерживается в собственном репозитории.

К приложению LUIS для главной ветви должна быть применена схема управления версиями. При слиянии обновлений для `.lu` приложения Luis в базу данных Master вы импортируете обновленный источник в новую версию в приложении Luis для главной ветви.

Рекомендуется использовать числовую схему управления версиями для версии главного приложения LUIS, например:

`major.minor[.build[.revision]]`

Каждое обновление номера версии увеличивается на последнюю цифру.

Основную или дополнительную версию можно использовать для указания области изменений в функциях приложения LUIS:

* Основной номер версии: значительное изменение, например поддержка новой [цели](https://docs.microsoft.com/azure/cognitive-services/luis/luis-concept-intent) или [сущности](https://docs.microsoft.com/azure/cognitive-services/luis/luis-concept-entity-types) .
* Дополнительный номер версии: обратно совместимое незначительное изменение, например после существенных новых обучающих курсов
* Сборка: изменения функциональности не меняются, а только другая сборка.

Определив номер версии для последней редакции приложения Master LUIS, необходимо создать и протестировать новую версию приложения и опубликовать ее в конечной точке, где ее можно использовать в различных средах сборки, например в контроле качества или в рабочей среде. Настоятельно рекомендуется автоматизировать все эти действия в рабочем процессе непрерывной интеграции (CI).

Пример
- [Рабочие процессы автоматизации](luis-concept-devops-automation.md) . подробные сведения о реализации рабочего процесса CI для тестирования и выпуска приложения Luis.
- [Release Management](luis-concept-devops-automation.md#release-management) сведения о развертывании приложения Luis.

### <a name="versioning-the-feature-branch-luis-app"></a>Управление версиями приложения LUIS в ветви компонентов

При работе с приложением LUIS "dev Branch", созданным для поддержки работы в ветви компонентов, приложение будет экспортировано по завершении работы, а обновление будет включено в запрос на вытягивание `'lu` . Ветвь в репозитории и приложение LUIS "dev Branch" должны быть удалены после слияния запроса на включение внесенных изменений в базу Master. Так как это приложение предназначено только для поддержки работы в ветви компонентов, нет никакой конкретной схемы управления версиями, которую необходимо применить в этом приложении.

Когда изменения в запросе на вытягивание объединяются в главную базу, то есть следует применить управление версиями, чтобы все обновления в главной базе были установлены независимо.

## <a name="next-steps"></a>Дальнейшие действия

* Дополнительные сведения о [тестировании для Luis DevOps](luis-concept-devops-testing.md)
* Узнайте, как [реализовать DevOps для Luis с GitHub](luis-how-to-devops-with-github.md)
