---
title: Как использовать авторские и клавиши времени выполнения - LUIS
description: При первом использовании Language Understanding (LUIS) не нужно создавать ключ-автор. Когда вы собираетесь опубликовать приложение, а затем использовать конечную точку выполнения, вам нужно создать и назначить ключ времени выполнения к приложению.
services: cognitive-services
ms.topic: conceptual
ms.date: 04/06/2020
ms.openlocfilehash: ea2799e7b8bb18ad4a729a70ae1477cde9f97e95
ms.sourcegitcommit: 441db70765ff9042db87c60f4aa3c51df2afae2d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/06/2020
ms.locfileid: "80754338"
---
# <a name="create-luis-resources"></a>Создание ресурсов LUIS

Ресурсы для авторизации и времени выполнения обеспечивают аутентификацию вашего приложения LUIS и конечную точку прогнозирования.

<a name="create-luis-service"></a>
<a name="create-language-understanding-endpoint-key-in-the-azure-portal"></a>

При входе на портал LUIS вы можете продолжить работу:

* бесплатный [пробный ключ](#trial-key) - предоставление авторов и нескольких запросов конечных точек прогнозирования.
* авторский ресурс Azure [LUIS.](https://ms.portal.azure.com/#create/Microsoft.CognitiveServicesLUISAllInOne)

<a name="starter-key"></a>

## <a name="sign-in-to-luis-portal-and-begin-authoring"></a>Войти на портал LUIS и начать авторство

1. Вопием на [портале LUIS](https://www.luis.ai) и соглашайтесь с условиями использования.
1. Начните свое приложение LUIS, выбрав, какой тип ключа luis authoring you would хотел бы использовать: бесплатный пробный ключ или новый ключ авторства Azure LUIS.

    ![Выбор типа ресурса для разработки в службе "Распознавание речи"](./media/luis-how-to-azure-subscription/sign-in-create-resource.png)

1. Когда вы закончите процесс выбора ресурсов, [создайте новое приложение.](luis-how-to-start-new-app.md#create-new-app-in-luis)

## <a name="trial-key"></a>Пробный ключ

Пробный (стартер) ключ предоставляется для вас. Он используется в качестве ключа проверки подлинности для запроса времени выполнения конечных точек прогнозирования до 1000 запросов в месяц.

Он виден как на странице **настроек пользователя,** так и на страницах **ресурсов Управления-> Azure** на портале LUIS.

Когда вы будете готовы опубликовать свою конечную точку прогноза, [создайте](#create-luis-resources) и [назначьте](#assign-a-resource-to-an-app) ключи авторизации и прогнозирования времени выполнения, чтобы заменить функциональность стартового ключа.

<a name="create-resources-in-the-azure-portal"></a>


[!INCLUDE [Create LUIS resource](includes/create-luis-resource.md)]

## <a name="create-resources-in-azure-cli"></a>Создание ресурсов в Azure CLI

Используйте [Azure CLI](https://docs.microsoft.com/cli/azure/install-azure-cli?view=azure-cli-latest) для создания каждого ресурса по отдельности.

Ресурс `kind`:

* Разработки:`LUIS.Authoring`
* Прогноз:`LUIS`

1. Войти на ClI Azure:

    ```azurecli
    az login
    ```

    Это открывает браузер, чтобы вы могли выбрать правильную учетную запись и обеспечить аутентификацию.

1. Создайте **ресурс авторства LUIS,** названный `LUIS.Authoring` `my-luis-authoring-resource` в _существующей_ группе ресурсов, названной `my-resource-group` в `westus` честь региона.

    ```azurecli
    az cognitiveservices account create -n my-luis-authoring-resource -g my-resource-group --kind LUIS.Authoring --sku F0 -l westus --yes
    ```

1. Создайте **ресурс конечных точек прогнозирования LUIS,** `LUIS`названный `my-luis-prediction-resource` в _существующей_ группе ресурсов, названной `my-resource-group` в `westus` честь региона. Если вы хотите более высокую пропускную `F0` `S0`выливку, чем свободный уровень, измените на . Узнайте больше о [уровнях ценообразования и пропускной документации.](luis-boundaries.md#key-limits)

    ```azurecli
    az cognitiveservices account create -n my-luis-prediction-resource -g my-resource-group --kind LUIS --sku F0 -l westus --yes
    ```

    > [!Note]
    > Эти ключи не используются порталом LUIS до тех пор, пока они **не** будут назначены на портале LUIS на **ресурсах Manage -> Azure.**

## <a name="assign-an-authoring-resource-in-the-luis-portal-for-all-apps"></a>Назначить авторский ресурс на портале LUIS для всех приложений

Вы можете назначить авторский ресурс для одного приложения или для всех приложений в LUIS. Следующая процедура присваивает все приложения одному авторскому ресурсу.

1. Войти на [портал LUIS](https://www.luis.ai).
1. В верхней панели навигации, в крайнем правом, выберите учетную запись пользователя, а затем выберите **Настройки.**
1. На странице **настроек пользователей** выберите **ресурс автором добавления,** а затем выберите существующий ресурс авторизации. Щелкните **Сохранить**.

## <a name="assign-a-resource-to-an-app"></a>Назначить ресурс приложению

Вы можете назначить одному ресурсу, авторизации или прогнозированию конечную точку выполнения, приложению со следующей процедурой.

1. Вопийте на [портале LUIS,](https://www.luis.ai)затем выберите приложение из списка **Моих приложений.**
1. Перейдите на страницу **ресурсов Управления-> Azure.**

    ![Выберите ресурсы Управления-> Azure на портале LUIS, чтобы назначить ресурс приложению.](./media/luis-how-to-azure-subscription/manage-azure-resources-prediction.png)

1. Выберите вкладку ресурса «Прогноз» или «Авторинг», затем выберите **ресурс «Добавить»** или кнопку **«Добавить авторское ресурс».**
1. Выберите поля в форме, чтобы найти правильный ресурс, а затем выберите **Сохранить**.

### <a name="assign-runtime-resource-without-using-luis-portal"></a>Назначить ресурс времени выполнения без использования портала LUIS

Для целей автоматизации, таких как конвейер CI/CD, можно автоматизировать назначение ресурса времени выполнения LUIS в приложение LUIS. Для этого необходимо выполнить указанные ниже действия.

1. Запросите маркер Azure Resource Manager с этого [веб-сайта](https://resources.azure.com/api/token?plaintext=true). Срок действия этого маркера ограничен, поэтому его следует использовать сразу. По запросу возвращается маркер Azure Resource Manager.

    ![Запрашивание и получение маркера Azure Resource Manager](./media/luis-manage-keys/get-arm-token.png)

1. Используйте токен, чтобы запросить ресурсы времени выполнения LUIS по подписке, от [API-интерфейса Get LUIS azure,](https://westus.dev.cognitive.microsoft.com/docs/services/5890b47c39e2bb17b84a55ff/operations/5be313cec181ae720aa2b26c)к которому имеет доступ ваша учетная запись пользователя.

    Этот API POST принимает указанные ниже параметры.

    |Заголовок|Значение|
    |--|--|
    |`Authorization`|Значение заголовка `Authorization` — `Bearer {token}`. Обратите внимание, что перед значением маркера должны находиться слово `Bearer` и пробел.|
    |`Ocp-Apim-Subscription-Key`|Ваш ключ разработки.|

    Этот API возвращает массив объектов JSON ваших подписок LUIS, включая идентификатор подписки, группу ресурсов и имя ресурса, возвращаемое в виде имени учетной записи. Найдите в массиве один элемент, соответствующий ресурсу LUIS, который требуется назначить приложению LUIS.

1. Назначьте маркер ресурсу LUIS с помощью API [назначения учетных записей Azure LUIS приложению](https://westus.dev.cognitive.microsoft.com/docs/services/5890b47c39e2bb17b84a55ff/operations/5be32228e8473de116325515).

    Этот API POST принимает указанные ниже параметры.

    |Type|Параметр|Значение|
    |--|--|--|
    |Заголовок|`Authorization`|Значение заголовка `Authorization` — `Bearer {token}`. Обратите внимание, что перед значением маркера должны находиться слово `Bearer` и пробел.|
    |Заголовок|`Ocp-Apim-Subscription-Key`|Ваш ключ разработки.|
    |Заголовок|`Content-type`|`application/json`|
    |Строка запроса|`appid`|Идентификатор приложения LUIS.
    |Текст||{"AzureSubscriptionId":"ddda2925-af7f-4b05-9ba1-2155c5fe8a8e",<br>"ResourceGroup": "resourcegroup-2",<br>"AccountName": "luis-uswest-S0-2"}|

    При успешном выполнении этого API возвращается состояние "201 - created".

## <a name="unassign-resource"></a>Отменить присвоение ресурса

1. Вопийте на [портале LUIS,](https://www.luis.ai)затем выберите приложение из списка **Моих приложений.**
1. Перейдите на страницу **ресурсов Управления-> Azure.**
1. Выберите вкладку ресурса «Прогноз или авторизбь», а затем выберите кнопку **ресурса Unassign** для ресурса.

При отсвагивании ресурса он не удаляется из Azure. Он только потеряет связь из LUIS.

## <a name="reset-authoring-key"></a>Сброс ключа разработки

**Для [создания ресурсов мигрировали](luis-migration-authoring.md) приложения:** если ключ авторизации скомпрометирован, сбросить ключ на портале Azure на странице **ключей** для этого авторского ресурса.

**Для приложений, которые еще не мигрировали:** ключ сбросить все приложения на портале LUIS. Если вы авторите свои приложения через авторские AI, вам необходимо изменить значение Ocp-Apim-Subscription-Key на новый ключ.

## <a name="regenerate-azure-key"></a>Регенерировать ключ Azure

Регенерировать ключи Azure с портала Azure на странице **Ключей.**

## <a name="delete-account"></a>Удаление учетной записи

Дополнительные сведения о том, какие данные удаляются при удалении учетной записи см. статью [Data storage and removal](luis-concept-data-storage.md#accounts) (Хранение и удаление данных).

## <a name="change-pricing-tier"></a>Смена ценовой категории

1.  В [Azure](https://portal.azure.com) найдите подписку LUIS. Выберите подписку LUIS.
    ![Найдите подписку LUIS](./media/luis-usage-tiers/find.png)
1.  Выберите **Ценовая категория**, чтобы просмотреть доступные ценовые категории.
    ![Просмотрите ценовые категории](./media/luis-usage-tiers/subscription.png)
1.  Выберите ценовую категорию и нажмите кнопку **Выбрать**, чтобы сохранить внесенные изменения.
    ![Измените ценовую категорию LUIS](./media/luis-usage-tiers/plans.png)
1.  После изменения ценовой категории появится всплывающее окно с новой ценовой категорией.
    ![Проверьте ценовую категорию LUIS](./media/luis-usage-tiers/updated.png)
1. Не забудьте [назначить этот ключ конечной точки](#assign-a-resource-to-an-app) на странице **публикации** и использовать его во всех запросах конечной точки.

## <a name="viewing-azure-resource-metrics"></a>Просмотр метрик ресурсов Azure

### <a name="viewing-azure-resource-summary-usage"></a>Просмотр сводной использования ресурсов Azure
Вы можете просмотреть сведения об использовании службы LUIS в Azure. На странице **Обзор** отображаются последние сводные сведения, включая вызовы и ошибки. При отправке запроса конечной точки LUIS сведения об использовании на **странице обзора** отображаются в течение пяти минут.

![Просмотр сводки использования](./media/luis-usage-tiers/overview.png)

### <a name="customizing-azure-resource-usage-charts"></a>Настройка диаграмм использования ресурсов Azure
Метрики обеспечивают более подробное представление данных.

![Метрики по умолчанию](./media/luis-usage-tiers/metrics-default.png)

Для диаграмм метрик можно настроить тип метрики и период времени.

![Настраиваемые метрики](./media/luis-usage-tiers/metrics-custom.png)

### <a name="total-transactions-threshold-alert"></a>Оповещение о пороговом значении "Всего транзакций"
Если вы хотите знать, когда будет достигнуто определенное пороговое значение транзакций (например, 10 000), вы можете создать оповещение.

![Оповещения по умолчанию](./media/luis-usage-tiers/alert-default.png)

Добавьте оповещение для метрики **общее число вызовов** за определенный период времени. Добавьте адреса электронной почты всех пользователей, которые должны получать оповещение. Добавьте веб-привязки для всех систем, которые должны получать оповещения. При запуске оповещения также может выполняться приложение логики.

## <a name="next-steps"></a>Дальнейшие действия

* [Узнайте, как использовать версии](luis-how-to-manage-versions.md) для управления жизненным циклом приложения.
* Понять концепции, включая [авторство ресурса](luis-concept-keys.md#authoring-key) и [вкладчиков](luis-concept-keys.md#contributions-from-other-authors) на этом ресурсе.
* [Узнайте, как создать](luis-how-to-azure-subscription.md) авторские и временные ресурсы
* Миграция на новый [авторский ресурс](luis-migration-authoring.md)
