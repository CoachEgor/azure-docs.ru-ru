---
title: Рекомендации по использованию API Детектора аномалий
titleSuffix: Azure Cognitive Services
description: Узнайте о рекомендациях при обнаружении аномалий с помощью API-детектора аномалий.
services: cognitive-services
author: aahill
manager: nitinme
ms.service: cognitive-services
ms.subservice: anomaly-detector
ms.topic: conceptual
ms.date: 03/26/2019
ms.author: aahi
ms.openlocfilehash: 9407f2fc9375765efb6eb9688b3ebfeef24ba90a
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "67721618"
---
# <a name="best-practices-for-using-the-anomaly-detector-api"></a>Лучшие практики для использования API детектора аномалий

API детектора аномалий — это служба обнаружения аномалий без состояния. На точность и выполнение его результатов могут повлиять:

* Как готовятся данные о временных рядах.
* Параметры API детектора аномалий, которые были использованы.
* Количество точек данных в запросе API. 

Используйте эту статью, чтобы узнать о рекомендациях по использованию API, чтобы получить наилучшие результаты для ваших данных. 

## <a name="when-to-use-batch-entire-or-latest-last-point-anomaly-detection"></a>Когда использовать пакет (полный) или последний (последний) обнаружение точечной аномалии

Конечная точка обнаружения пакетов API Anomaly Detector API позволяет обнаруживать аномалии через все данные серий раз. В этом режиме обнаружения создается и применяется единая статистическая модель к каждой точке набора данных. Если в вашей временной серии приведены ниже характеристики, мы рекомендуем использовать обнаружение пакетов для предварительного просмотра данных в одном вызове API.

* Сезонные временные ряды, с редкими аномалиями.
* Плоские трендовые временные ряды, с редкими шипами/падениями. 

Мы не рекомендуем использовать обнаружение пакетной аномалии для мониторинга данных в режиме реального времени или использовать их в данных временных рядов, которые не имеют превышенных характеристик. 

* Обнаружение пакетов создает и применяет только одну модель, обнаружение каждой точки выполняется в контексте целой серии. Если данные временных рядов тренды вверх и вниз без сезонности, некоторые точки изменения (падения и шипы в данных) могут быть пропущены моделью. Аналогичным образом, некоторые точки изменения, которые менее значительны, чем те, которые более поздние в наборе данных, могут быть не засчитаны как достаточно значительные для включения в модель.

* Обнаружение пакетов происходит медленнее, чем обнаружение аномального состояния последней точки при мониторинге данных в режиме реального времени, из-за количества анализируемых точек.

Для мониторинга данных в режиме реального времени мы рекомендуем определить аномалию только вашей последней точки данных. Постоянно применяя новейшие точки обнаружения, потоковое мониторинг данных может быть сделано более эффективно и точно.

Приведенный ниже пример описывает влияние этих режимов обнаружения на производительность. На первом снимке показан результат непрерывного обнаружения состояния аномалии вдоль 28 ранее увиденных точек данных. Красные точки являются аномалиями.

![Изображение, показывающее обнаружение аномалий с использованием последней точки](../media/last.png)

Ниже приведен тот же набор данных с использованием обнаружения пакетной аномалии. Модель, построенная для операции, проигнорировала несколько аномалий, отмеченных прямоугольниками.

![Изображение, показывающее обнаружение аномалий с помощью метода пакетной партии](../media/entire.png)

## <a name="data-preparation"></a>Подготовка данных

API детектора аномалий принимает данные временных рядов, отформатированные в объект запроса JSON. Серия времени может быть любыми числовыми данными, записанными с течением времени в последовательном порядке. Вы можете отправить окна данных временных рядов в конечную точку API anomaly Detector, чтобы улучшить производительность API. Минимальное количество точек данных, которые вы можете отправить, составляет 12, а максимум 8640 пунктов. [Детализация](https://docs.microsoft.com/dotnet/api/microsoft.azure.cognitiveservices.anomalydetector.models.granularity?view=azure-dotnet-preview) определяется как скорость, по которым отбирается ваши данные. 

Точки данных, отправленные на API-детектор аномалий, должны иметь действительную координированную метку времени Universal Time (UTC) и численное значение. 

```json
{
    "granularity": "daily",
    "series": [
      {
        "timestamp": "2018-03-01T00:00:00Z",
        "value": 32858923
      },
      {
        "timestamp": "2018-03-02T00:00:00Z",
        "value": 29615278
      },
    ]
}
```

Если ваши данные взяты с нестандартным интервалом времени, `customInterval` вы можете указать их, добавив атрибут в свой запрос. Например, если ваша серия пробуется каждые 5 минут, вы можете добавить следующее в свой запрос JSON:

```json
{
    "granularity" : "minutely", 
    "customInterval" : 5
}
```

### <a name="missing-data-points"></a>Отсутствующие точки данных

Отсутствующие точки данных являются общими в равномерно распределенных наборах данных временных рядов, особенно с тонкой детализацией (небольшой интервал выборки. Например, данные, отобранные каждые несколько минут). Отсутствует менее 10% от ожидаемого количества точек в данных не должно иметь негативного влияния на результаты обнаружения. Рассмотрите возможность заполнения пробелов в данных на основе их характеристик, таких как замена точек данных из более раннего периода, линейная интерполяция или скользящая средняя.

### <a name="aggregate-distributed-data"></a>Агрегированные распределенные данные

API детектора аномалий лучше всего работает на равномерно распределенных временных рядах. Если ваши данные распределены случайным образом, их следует агрегировать на единицу времени, например, на одну минуту, почасовую или ежедневную.

## <a name="anomaly-detection-on-data-with-seasonal-patterns"></a>Обнаружение аномалий на данных с сезонными моделями

Если вы знаете, что данные временных рядов имеют сезонную закономерность (которая происходит через регулярные промежутки времени), вы можете повысить точность и время отклика API. 

Указать, `period` когда вы строите ваш запрос JSON может уменьшить задержку обнаружения аномалий до 50%. Это `period` целый ряд, который определяет примерно, сколько точек данных требуется временной серии для повторения шаблона. Например, временные ряды с одной точкой данных в день будет иметь `period` как `7`, и временные `period` `7*24`ряды с одной точкой в час (с той же еженедельной картины) будет иметь . Если вы не уверены в моделях данных, вам не нужно указывать этот параметр.

Для достижения наилучших `period`результатов, предоставьте 4 точки данных, плюс еще один. Например, почасовые данные с еженедельным шаблоном, как описано`7 * 24 * 4 + 1`выше, должны предоставить 673 точки данных в органе запроса ().

### <a name="sampling-data-for-real-time-monitoring"></a>Данные выборки для мониторинга в режиме реального времени

Если ваши потоковые данные отбираются с коротким интервалом (например, секунд или минут), отправка рекомендуемого количества точек данных может превысить допустимое максимальнодопустимое количество aPI anomaly Detector (8640 точек данных). Если данные показывают стабильную сезонную модель, рассмотрите возможность отправки образца данных временных рядов с большим интервалом времени, например, в часы. Выборка данных таким образом также может заметно улучшить время отклика API. 

## <a name="next-steps"></a>Дальнейшие действия

* [Что такое API детектора аномалий?](../overview.md)
* [Быстрый запуск: Обнаружение аномалий в данных временных рядов с помощью API Anomaly Detector REST](../quickstarts/detect-data-anomalies-csharp.md)
