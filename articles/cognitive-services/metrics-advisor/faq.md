---
title: Рекомендации по метрикам часто задаваемые вопросы
titleSuffix: Azure Cognitive Services
description: Часто задаваемые вопросы о службе советника по метрикам.
services: cognitive-services
author: mrbullwinkle
manager: nitinme
ms.service: cognitive-services
ms.subservice: metrics-advisor
ms.topic: conceptual
ms.date: 10/15/2020
ms.author: mbullwin
ms.openlocfilehash: 6b5292ca7e1220b60b1b2a2501b3150550da8db9
ms.sourcegitcommit: 33368ca1684106cb0e215e3280b828b54f7e73e8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/16/2020
ms.locfileid: "92131689"
---
# <a name="metrics-advisor-frequently-asked-questions"></a>Рекомендации по метрикам часто задаваемые вопросы

### <a name="what-is-the-cost-of-my-instance"></a>Какова стоимость своего экземпляра?

Сейчас в предварительной версии не стоит платить за использование вашего экземпляра.

### <a name="why-is-the-demo-website-readonly"></a>Почему демонстрационный веб-сайт предназначен только для чтения?

[Демонстрационный веб-сайт](https://anomaly-detector.azurewebsites.net/) доступен для общего доступа. Этот экземпляр доступен только для чтения, чтобы предотвратить случайную передачу каких-либо данных.

### <a name="why-cant-i-create-the-resource-the-pricing-tier-is-unavailable-and-it-says-you-have-already-created-1-s0-for-this-subscription"></a>Почему не удается создать ресурс? "Ценовая категория" недоступна и говорит "вы уже создали 1 S0 для этой подписки"?

:::image type="content" source="media/pricing.png" alt-text="Сообщение, если ресурс F0 уже существует":::

Во время общедоступной предварительной версии для каждого региона в подписке можно создать только один экземпляр советника по метрикам.

Если у вас уже есть экземпляр, созданный в том же регионе, использующий ту же подписку, можно попробовать другой регион или другую подписку, чтобы создать новый экземпляр. Можно также удалить существующий экземпляр, чтобы создать новый.

Если вы уже удалили существующий экземпляр, но по-прежнему видите ошибку, подождите около 20 минут после удаления ресурса перед созданием нового экземпляра.

## <a name="basic-concepts"></a>Основные понятия

### <a name="what-is-multi-dimensional-time-series-data"></a>Что такое многомерные данные временных рядов?

См. Описание [многомерной метрики](glossary.md#multi-dimensional-metric)  в глоссарии.

### <a name="how-much-data-is-needed-for-metrics-advisor-to-start-anomaly-detection"></a>Какой объем данных требуется помощнику по метрикам для запуска обнаружения аномалий?

Как минимум одна точка данных может активировать обнаружение аномалий. Однако это не приносит наилучшей точности. Служба будет считать окном предыдущих точек данных, используя значение, указанное в качестве правила "Заполнение" во время создания веб-канала данных.

Перед отметкой времени, которую необходимо определить, рекомендуется использовать некоторые данные.
В зависимости от степени детализации данных Рекомендуемая сумма данных варьируется, как показано ниже.

| Степень детализации данных | Рекомендуемый объем данных для обнаружения |
| ----------- | ------------------------------------- |
| Менее 5 минут | 4 дня данных |
| от 5 минут до 1 дня | 28 дней данных |
| Более 1 дня, до 31 дня | 4 года данных |
| Больше 31 дня | 48 лет данных |

### <a name="why-metrics-advisor-doesnt-detect-anomalies-from-historical-data"></a>Почему помощник по метрикам не обнаруживает аномалии из исторических данных?

Советник по метрикам предназначен для обнаружения данных потоковой передачи в реальном времени. Существует ограничение на максимальную длину исторических данных, которую будет просматривать служба и выполнить обнаружение аномалий. Это означает, что результаты обнаружения аномалий будут иметь только точки данных после определенной самой ранней метки времени. Самая ранняя отметка времени зависит от степени детализации данных.

В зависимости от степени детализации данных, длины исторических данных, для которых будут получены результаты обнаружения аномалий, приведены ниже.

| Степень детализации данных | Максимальная длина исторических данных для обнаружения аномалий |
| ----------- | ------------------------------------- |
| Менее 5 минут | Интегрированное время — 13 часов |
| от 5 минут до менее 1 часа | Время перехода на 4 дня  |
| от 1 часа до меньше 1 дня | Время адаптации — 14 дней  |
| 1 день | Время адаптации — 28 дней  |
| Больше 1 дня, меньше 31 день | Интегрированное время — 2 года  |
| Больше 31 дня | Время адаптации — 24 года   |

### <a name="more-concepts-and-technical-terms"></a>Дополнительные понятия и технические термины

См. также [Глоссарий](glossary.md) для получения дополнительных сведений.

###  <a name="how-do-i-write-a-valid-query-for-ingesting-my-data"></a>Разделы справки написать допустимый запрос для приема моих данных?  

Чтобы помощник по метрикам принимал данные, необходимо создать запрос, который будет возвращать измерения данных в одной метке времени. Помощник по метрикам запустит этот запрос несколько раз, чтобы получить данные из каждой метки времени. 

Обратите внимание, что запрос должен возвращать не более одной записи для каждой комбинации измерений по заданной метке времени. Все возвращаемые записи должны иметь одинаковую метку времени. Запрос не должен содержать повторяющихся записей.

Например, предположим, что вы создаете следующий запрос для ежедневной метрики: 
 
`select timestamp, city, category, revenue from sampledata where Timestamp >= @StartTime and Timestamp < dateadd(DAY, 1, @StartTime)`

Обязательно используйте правильную детализацию для временных рядов. Для почасовой метрики следует использовать: 

`select timestamp, city, category, revenue from sampledata where Timestamp >= @StartTime and Timestamp < dateadd(hour, 1, @StartTime)`

Обратите внимание, что эти запросы возвращают данные только в одной метке времени и содержат все комбинации измерений, которые будут использоваться помощником по метрикам. 

:::image type="content" source="media/query-result.png" alt-text="Сообщение, если ресурс F0 уже существует" lightbox="media/query-result.png":::


### <a name="how-do-i-detect-spikes--dips-as-anomalies"></a>Разделы справки обнаруживать пики & DIP как аномалии?

Если имеются предварительно определенные жесткие пороговые значения, можно вручную задать "жесткое пороговое значение" в [конфигурациях обнаружения аномалий](how-tos/configure-metrics.md#anomaly-detection-methods).
Если пороговые значения отсутствуют, можно использовать "интеллектуальное обнаружение", которое включено в AI. Дополнительные сведения см. в разделе [Настройка обнаружения конфигурации](how-tos/configure-metrics.md#tune-the-detecting-configuration) .

### <a name="how-do-i-detect-inconformity-with-regular-seasonal-patterns-as-anomalies"></a>Разделы справки обнаруживать несоответствия с обычными (сезонными) шаблонами как аномалии?

«Интеллектуальное обнаружение» может познакомиться с шаблоном данных, включая сезонные шаблоны. Затем он обнаруживает эти точки данных, которые не соответствуют обычным шаблонам как аномалии. Дополнительные сведения см. в разделе [Настройка обнаружения конфигурации](how-tos/configure-metrics.md#tune-the-detecting-configuration) .

### <a name="how-do-i-detect-flat-lines-as-anomalies"></a>Разделы справки обнаруживать неструктурированные строки как аномалии?

Если данные в обычном режиме нестабильны, и вы хотите получать оповещения о том, что оно слишком стабильно или даже становится плоской линией, то "Изменение порогового значения" можно настроить для обнаружения таких точек данных, когда изменение слишком мало.
Дополнительные сведения см. в разделе [конфигурации обнаружения аномалий](how-tos/configure-metrics.md#anomaly-detection-methods) .

## <a name="advanced-concepts"></a>Дополнительные сведения

### <a name="how-does-metric-advisor-build-an-incident-tree-for-multi-dimensional-metrics"></a>Как помощник по метрикам создает дерево инцидентов для многомерных метрик?

Метрику можно разделить на несколько временных рядов по измерениям. Например, метрика `Response latency` отслеживается для всех служб, принадлежащих команде. `Service`Категорию можно использовать в качестве измерения для дополнения метрики, поэтому мы получаем `Response latency` разбиение по `Service1` , `Service2` и т. д. Каждая служба может быть развернута на разных компьютерах в нескольких центрах обработки данных, поэтому эту метрику можно разделить по `Machine` и `Data center` .

|Служба| Центр обработки данных| Компьютер  | 
|----|------|----------------   |
| S1 |  DC1 |   M1 |
| S1 |  DC1 |   M2 |
| S1 |  DC2 |   M3 |
| S1 |  DC2 |   "M4" |
| S2 |  DC1 |   M1 |
| S2 |  DC1 |   M2 |
| S2 |  DC2 |   "M5" |
| S2 |  DC2 |   "M6" |
| ...|      |      |

Начиная с итога `Response latency` , можно детализировать метрику на `Service` , `Data center` и `Machine` . Однако, возможно, для владельцев служб лучше использовать путь `Service`  ->  `Data center`  ->  `Machine` , или, возможно, у инженеров инфраструктуры будет больше смысла использовать этот путь `Data Center`  ->  `Machine`  ->  `Service` . Все зависит от индивидуальных бизнес-требований пользователей. 

В помощнике по метрике пользователи могут указать любой путь для детализации или свертки с одного узла иерархической топологии. Точнее, иерархическая топология — это направленный ациклический граф, а не древовидная структура. Существует полная иерархическая топология, состоящая из всех возможных комбинаций измерений, например: 

:::image type="content" source="media/dimension-combinations-view.png" alt-text="Сообщение, если ресурс F0 уже существует" lightbox="media/dimension-combinations-view.png":::

Теоретически, если измерение имеет `Service` различные значения `Ls` , измерение имеет различные значения, `Data center` `Ldc` а измерение `Machine` имеет `Lm` различные значения, то `(Ls + 1) * (Ldc + 1) * (Lm + 1)` в иерархической топологии могут быть сочетания измерений. 

Но обычно не все сочетания измерений являются допустимыми, что может значительно снизить сложность. В настоящее время, если пользователи объединяют метрики, количество измерений не ограничивается. Если необходимо использовать функцию свертки, предоставляемую советником по метрикам, количество измерений не должно превышать 6. Тем не менее, количество временных рядов, развернутых по измерениям для метрик, ограничено до 10 000.

Инструмент **дерева инцидентов** на странице Диагностика показывает только те узлы, на которых обнаружена аномалия, а не вся топология. Это поможет вам сосредоточиться на текущем вопросе. Он также может не отображать все аномалии в пределах метрики, а вместо этого будет отображать основные аномалии на основе вклада. Таким образом мы можем быстро определить влияние, область и путь распределения аномальных данных. Что значительно сокращает количество аномалий, на которые необходимо сосредоточиться, и помогает пользователям понять и определить основные проблемы. 
 
Например, при возникновении аномалии `Service = S2 | Data Center = DC2 | Machine = M5` отклонение аномалии влияет на родительский узел, `Service= S2` который также обнаружил аномалию, но аномалия не влияет на весь центр обработки данных в `DC2` и все службы в `M5` . Дерево инцидентов будет построено, как показано на снимке экрана ниже, `Service = S2` и основная причина может быть проанализирована в двух путях, в которых они ведут `Service = S2 | Data Center = DC2 | Machine = M5` .

 :::image type="content" source="media/root-cause-paths.png" alt-text="пять пометок вершин с двумя разными путями, Соединенными краями с общим узлом, обозначенным как S2. Старшие аномалии фиксируются в службе = S2, и основная причина может быть проанализирована по двум путям, которые как ведущие к службе = S2 | Центр обработки данных = DC2 | Компьютер = M5" lightbox="media/root-cause-paths.png":::

## <a name="next-steps"></a>Next Steps
- [Общие сведения о Помощнике по метрикам](overview.md)
- [Попробуйте демонстрационный сайт](quickstarts/explore-demo.md)
- [Использование веб-портала](quickstarts/web-portal.md)