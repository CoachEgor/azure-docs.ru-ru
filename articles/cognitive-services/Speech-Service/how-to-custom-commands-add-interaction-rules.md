---
title: Как добавить подтверждение в пользовательскую команду
titleSuffix: Azure Cognitive Services
description: В этой статье вы узнаете, как реализовать подтверждения для команды в пользовательских командах.
services: cognitive-services
author: singhsaumya
manager: yetian
ms.service: cognitive-services
ms.subservice: speech-service
ms.topic: conceptual
ms.date: 06/18/2020
ms.author: sausin
ms.openlocfilehash: f37109cc2677ad5ef18c5677bda9308a78cebccf
ms.sourcegitcommit: cec9676ec235ff798d2a5cad6ee45f98a421837b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/02/2020
ms.locfileid: "85851309"
---
# <a name="add-interaction-rules"></a>Добавление правил взаимодействия

В этой статье вы узнаете о *правилах взаимодействия*. Эти дополнительные правила обработают более конкретные или сложные ситуации. Вы можете создавать собственные правила взаимодействия, но в этой статье вы используете правила взаимодействия для следующих целевых сценариев:

* Подтверждение команд
* Добавление одноэтапного исправления в команды

Дополнительные сведения о правилах взаимодействия см. в разделе " [ссылки](./custom-commands-references.md) ".

## <a name="prerequisites"></a>Предварительные условия

Необходимо завершить действия, описанные в следующих статьях:
> [!div class="checklist"]
> * [Создание приложения с использованием простых команд](./how-to-custom-commands-create-application-with-simple-commands.md)
> * [Добавление параметров в команды](./how-to-custom-commands-add-parameters-to-commands.md)

## <a name="add-confirmations-to-a-command"></a>Добавление подтверждений для команды

Чтобы добавить подтверждение, используйте команду **SetTemperature** . Чтобы получить подтверждение, создайте правила взаимодействия, выполнив следующие действия.

1. Выберите команду **SetTemperature** в левой области.
1. Добавьте правила взаимодействия, выбрав **Добавить** в средней области. Затем выберите команду **правила взаимодействия**  >  **проверить**.

    Это действие добавляет три правила взаимодействия. Это правило запрашивает у пользователя подтверждение даты и времени оповещения и ожидает подтверждения (да/нет) для следующей активации.

    1. Измените правило взаимодействия **команды Confirm** согласно следующей конфигурации:
        1. Переименуйте **имя** , чтобы **подтвердить температуру**.
        1. Добавить новое условие в качестве **обязательных параметров**  >  **температура**.
        1. Добавить новое действие как **тип**  >  **Отправить речевой ответ**  >  **. Вы действительно хотите задать температуру как {температура} градусов?**
        1. Оставьте значение по умолчанию для параметра **ожидается подтверждение от пользователя** в разделе **ожидания** .
      
         > [!div class="mx-imgBorder"]
         > ![Создать ответ требуемого параметра](media/custom-speech-commands/add-validation-set-temperature.png)
    

    1. Измените правило взаимодействия **успешно подтверждено** , чтобы обрабатывалось успешное подтверждение (пользователь сказал да).
      
          1. Измените **имя** на « **температура подтверждения**».
          1. Оставить уже существующее **Подтверждение условие прошло успешно** .
          1. Добавьте новое условие в качестве **типа**  >  **обязательные параметры**  >  **температура**.
          1. Оставьте значение по умолчанию для **состояния после выполнения** в качестве **правил**выполнения.

    1. Изменение правила взаимодействия с **отклонением подтверждения** для выполнения сценариев при отказе в подтверждении (пользователь сказал No).

          1. Измените **имя** на " **температура подтверждения отклонено**".
          1. Оставить уже существующее **подтверждение отказа** .
          1. Добавьте новое условие в качестве **типа**  >  **обязательные параметры**  >  **температура**.
          1. Добавьте новое действие как **тип**  >  **Отправить речевое реагирование**  >  **проблема. Какова температура?**
          1. Оставьте значение по умолчанию для **состояния после выполнения** , **Дождитесь ввода данных пользователем**.

> [!IMPORTANT]
> В этой статье вы использовали встроенную функцию подтверждения. Можно также вручную добавить правила взаимодействия по одному.
   

### <a name="try-out-the-changes"></a>Попробуйте внести изменения

Выберите **обучение**, дождитесь завершения обучения и выберите **тест**.

- **Входные данные**: установите температуру в 80 градусов.
- **Выходные данные**: ОК 80?
- **Входные данные**: нет.
- **Выходные данные**: нет проблем. Какова температура?
- **Входные данные**: 83 градусов.
- **Выходные данные**: ОК 83?
- **Входные данные**: Да.
- **Выходные данные**: ОК, установка температуры в 83 градусов.


## <a name="implement-corrections-in-a-command"></a>Реализация исправлений в команде

В этом разделе вы настроите одношаговое исправление, которое будет использоваться после того, как действие выполнения уже будет выполнено. Вы также видите пример того, как исправление включено по умолчанию, если команда еще не выполнена. Чтобы добавить исправление, если команда не завершена, добавьте новый параметр **алармтоне**.

Выберите команду **сеталарм** в левой области и добавьте новый параметр **алармтоне**.
        
- **Имя**  >  **Алармтоне**
- **Тип**  >  **Строка**
- Значение по умолчанию **Default Value**  >  **Чимес**
- **Конфигурация**  >  **Принять предопределенные входные значения из внутреннего каталога**
- **Предопределенные входные значения**  >  **Чимес**, **позвякивание**и **echo** как отдельные предопределенные входные данные


Затем обновите ответ для параметра **DateTime** , чтобы **присвоить сигналу будильника значение {алармтоне}. За какое время?**. Затем измените правило завершения следующим образом:

1. Выберите существующее правило завершения **конфирматионреспонсе**.
1. На правой панели наведите указатель мыши на существующее действие и выберите **изменить**.
1. Обновите речевой ответ на "ОК", задали **оповещение для {DateTime}. Сигнал будильника — {Алармтоне}.**

### <a name="try-out-the-changes"></a>Попробуйте внести изменения

Выберите **обучение**, дождитесь завершения обучения и выберите **тест**.
Испытайте следующие фразы продолжительностью:

- **Входные данные**: Установите оповещение.
- **Выходные данные**: готово к установке сигнала будильника как чимес. За какое время?
- **Входные данные**: установите будильник со значением позвякивание для 9 завтра.
- **Выходные данные**: ОК, оповещение установлено для 2020-05-30 09:00:00. Сигнал будильника — позвякивание.

> [!IMPORTANT]
> Сигнал будильника можно изменить без какой бы то ни было явной настройки в текущей команде, например, когда команда еще не была завершена. *По умолчанию исправление включено для всех параметров команды, независимо от числа включений, если команда еще не выполнена.*

### <a name="correction-when-command-is-completed"></a>Исправление после завершения команды

Платформа пользовательских команд также предоставляет возможность одноэтапного исправления даже после завершения выполнения команды. Эта функция не включена по умолчанию. Он должен быть явно настроен. Чтобы настроить одношаговое исправление, выполните следующие действия.

1. В команде **сеталарм** добавьте правило взаимодействия для **команды Type Update Previous** , чтобы обновить ранее установленный сигнал. Переименуйте **имя** правила взаимодействия по умолчанию, чтобы **обновить предыдущий сигнал**.
1. Оставьте условие по умолчанию, а **Предыдущая команда должна быть обновлена** , как есть.
1. Добавьте новое условие в качестве **типа**  >  **обязательный параметр**  >  **DateTime**.
1. Добавить новое действие как **тип**  >  **Отправить речевой ответ**  >  **простой редактор**  >  **, обновляющий время предыдущего оповещения до {DateTime}.**
1. Оставьте значение по умолчанию для **состояния после выполнения** , так как **команда выполнена**.

### <a name="try-out-the-changes"></a>Попробуйте внести изменения

Выберите **обучение**, дождитесь завершения обучения и выберите **тест**.

- **Входные данные**: Установите оповещение.
- **Выходные данные**: готово к установке сигнала будильника как чимес. За какое время?
- **Входные данные**: установите будильник со значением позвякивание для 9 завтра.
- **Выходные данные**: ОК, оповещение установлено для 2020-05-21 09:00:00. Сигнал будильника — позвякивание.
- **Входные данные**: нет, 8 AM.
- **Выходные данные**: обновление предыдущего времени оповещения до 2020-05-29 08:00.

> [!NOTE]
> В реальном приложении в разделе **действия** этого правила исправления также необходимо отправить обратно клиенту действие или вызвать конечную точку HTTP, чтобы обновить время оповещения в системе. Это действие должно отвечать исключительно за обновление времени оповещения, а не любого другого атрибута команды. В этом случае это будет сигнал будильника.

## <a name="next-steps"></a>Дальнейшие шаги

> [!div class="nextstepaction"]
> [Как добавить шаблоны создания языка для речевых ответов](./how-to-custom-commands-add-language-generation-templates.md)
