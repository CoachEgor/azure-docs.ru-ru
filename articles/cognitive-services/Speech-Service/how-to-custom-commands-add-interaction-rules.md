---
title: Как добавить подтверждение в пользовательскую команду
titleSuffix: Azure Cognitive Services
description: В этой статье вы узнаете, как реализовать подтверждения для команды в пользовательских командах.
services: cognitive-services
author: singhsaumya
manager: yetian
ms.service: cognitive-services
ms.subservice: speech-service
ms.topic: conceptual
ms.date: 06/18/2020
ms.author: sausin
ms.openlocfilehash: 5f66e29e4c1bc85981202251e0de8288f4baee4e
ms.sourcegitcommit: 4042aa8c67afd72823fc412f19c356f2ba0ab554
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/24/2020
ms.locfileid: "85307841"
---
# <a name="add-interaction-rules"></a>Добавление правил взаимодействия

В этой статье вы узнаете о **правилах взаимодействия**. Это дополнительные правила для решения более конкретных или сложных ситуаций. Хотя вы можете создавать собственные правила взаимодействия, в этой статье вы используете правила взаимодействия для следующих целевых сценариев:

* Подтверждение команд
* Добавление исправления одного шага в команды

Перейдите к разделу " [ссылки](./custom-commands-references.md) ", чтобы узнать больше о правилах взаимодействия.

## <a name="prerequisites"></a>Предварительные требования

Необходимо выполнить действия, описанные в следующих статьях:
> [!div class="checklist"]
> * [Как создать приложение с помощью простых команд](./how-to-custom-commands-create-application-with-simple-commands.md)
> * [Как добавить параметры в команды](./how-to-custom-commands-add-parameters-to-commands.md)

## <a name="add-confirmations-to-a-command"></a>Добавление подтверждений для команды

Чтобы добавить подтверждение, используйте команду **SetTemperature** . Для достижения подтверждения создайте правила взаимодействия, выполнив следующие действия.

1. В левой области выберите команду **SetTemperature** .
2. Добавьте правила взаимодействия, выбрав **Добавить** в средней области, а затем выбрав **Interaction rules**  >  **команду подтвердить**правила взаимодействия.

    Это приведет к добавлению трех правил взаимодействия. это правило попросит пользователя подтвердить дату и время оповещения и ожидает подтверждения (да/нет) для следующей активации.

    1. Измените правило взаимодействия **команды Confirm** согласно следующей конфигурации.
        1. Переименуйте **имя** в **`Confirm Temperature`** .
        1. Добавить новое условие как **обязательные параметры > температуру**
        1. Добавление нового действия в виде **типа > отправка речевого ответа > `Are you sure you want to set the temperature as {Temperature} degrees?` **
        1. Оставьте значение по умолчанию для параметра **ожидается подтверждение от пользователя** в разделе ожидания.
      
         > [!div class="mx-imgBorder"]
         > ![Создать ответ требуемого параметра](media/custom-speech-commands/add-validation-set-temperature.png)
    

    1. Измените правило взаимодействия **успешно подтверждено** , чтобы обрабатывалось успешное подтверждение (пользователь сказал да).
      
          1. Измените **имя** на **`Confirmation temperature succeeded`** .
          1. Оставить уже существующее **Подтверждение условие прошло успешно** .
          1. Добавление нового условия в качестве **типа > обязательные параметры > температура**
          1. Оставьте значение по умолчанию для **состояния после выполнения** в качестве **правил**выполнения.

    1. Изменение **подтверждения отклонено** (пользователь сказал нет) для выполнения сценариев в случае отказа в подтверждении.

          1. Измените **имя** на **`Confirmation temperature denied`** .
          1. Оставить уже существующее **подтверждение отказа** .
          1. Добавление нового условия в качестве **типа > обязательные параметры > температура**
          1. Добавление нового действия в виде **типа > отправка речевого ответа > `No problem. What temperature then?` **
          1. Оставьте значение по умолчанию для **состояния после выполнения** , **Дождитесь ввода данных пользователем**.

> [!IMPORTANT]
> В этой статье вы использовали встроенную функцию подтверждения. Кроме того, можно добиться того же результата, добавив правила взаимодействия по одному, вручную.
   

### <a name="try-out-the-changes"></a>Попробуйте внести изменения

Выберите **обучение**, дождитесь завершения обучения и выберите **тест**.

- Входные данные: установите температуру в 80 градусов.
- Выходные данные: ОК 80?
- Входные данные: нет
- Выходные данные: нет проблем. Какова температура?
- Входные данные: 83 градусов
- Выходные данные: ОК 83?
- Входные данные: Да
- Выходные данные: ОК, установка температуры в 83 градусов


## <a name="implementing-corrections-in-a-command"></a>Реализация исправлений в команде

В этом разделе вы настроите одношаговое исправление, которое будет использоваться после того, как действие выполнения уже будет выполнено. Вы также видите пример того, как исправление включено по умолчанию, если команда еще не выполнена. Чтобы добавить исправление, если команда не завершена, добавьте новый параметр **алармтоне**.

Выберите команду **сеталарм** в левой области и добавьте новый параметр **алармтоне**.
        
- **Безымян** > `AlarmTone`
- Строка > **типа**
- **Значение по умолчанию** > `Chimes`
- > **конфигурации** принимают предопределенные входные значения из внутреннего каталога
- **Предопределенные входные значения**  >  `Chimes` , `Jingle` и `Echo` . Каждый как отдельные предопределенные входные данные.


Затем измените ответ для параметра DateTime на `Ready to set alarm with tone as {AlarmTone}. For what time?` . Затем измените правило завершения следующим образом.

1. Выберите существующее правило завершения **конфирматионреспонсе**.
1. На правой панели наведите указатель мыши на существующее действие и нажмите кнопку **изменить** .
1. Обновить речевой ответ на`Ok, alarm set for {DateTime}. The alarm tone is {AlarmTone}.`

### <a name="try-out-the-changes"></a>Попробуйте внести изменения

Выберите **обучение**, подождите, пока завершится обучение, и выберите **тест**.
Испытайте следующие фразы продолжительностью:

- Входные данные: задать оповещение
- Выходные данные: готово к установке сигнала будильника как чимес. За какое время?
- Входные данные: установите будильник с тоном в виде позвякивание для 9 завтра
- Выходные данные: ОК, оповещение установлено для 2020-05-30 09:00:00. Сигнал будильника — позвякивание.

> [!IMPORTANT]
> Обратите внимание, что сигнал будильника можно изменить без какой бы то ни было явной настройки в текущей команде, т. е. когда команда еще не была выполнена. **По умолчанию исправление включено для всех параметров команды, независимо от номера, если команда еще не выполнена.**

### <a name="correction-when-command-is-completed"></a>Исправление после завершения команды

Платформа пользовательских команд также предоставляет возможность одноэтапного исправления даже после завершения выполнения команды. Но эта функция не включена по умолчанию и должна быть явно настроена. Чтобы настроить одношаговое исправление, выполните следующие действия.

1. В команде **сеталарм** добавьте правило взаимодействия с типом **обновить предыдущую команду** , чтобы обновить ранее установленный сигнал. Переименуйте **имя** правила взаимодействия по умолчанию, чтобы **обновить предыдущий сигнал**.
1. Оставьте условие по умолчанию, а **Предыдущая команда должна быть обновлена** , как есть.
1.  Добавьте новое условие в качестве **типа > обязательный параметр > DateTime**.
1. Добавьте новое действие как **тип > отправка речевого ответа > простого редактора > `Updating previous alarm time to {DateTime}.` **
1. Оставьте значение по умолчанию для состояния выполнения после **завершения команды**.

### <a name="try-out-the-changes"></a>Попробуйте внести изменения

Выберите **обучение**, дождитесь завершения обучения и выберите **тест**.

- Входные данные: задать оповещение
- Выходные данные: готово к установке сигнала будильника как чимес. Который час?
- Входные данные: установите будильник с тоном в виде позвякивание для 9 завтра
- Выходные данные: ОК, оповещение установлено для 2020-05-21 09:00:00. Сигнал будильника — позвякивание.
- Входные данные: нет, 8 AM
- Выходные данные: обновление предыдущего времени оповещения до 2020-05-29 08:00.

> [!NOTE]
> В реальном приложении в разделе действия этого правила исправления также необходимо отправить обратно клиенту действие или вызвать конечную точку HTTP, чтобы обновить время оповещения в системе. Это действие должно быть ответственным за только обновление времени оповещения, а не любого другого атрибута команды, в данном случае будильник.

## <a name="next-steps"></a>Следующие шаги

> [!div class="nextstepaction"]
> [Как добавить шаблоны создания языка для речевых ответов](./how-to-custom-commands-add-language-generation-templates.md)