---
title: Справочник по API перевода текстов версии 3.0
titleSuffix: Azure Cognitive Services
description: Справочная документация для API перевода текстов версии 3.0.
services: cognitive-services
author: swmachan
manager: nitinme
ms.service: cognitive-services
ms.subservice: translator-text
ms.topic: reference
ms.date: 03/29/2018
ms.author: swmachan
ms.openlocfilehash: cb5a3b8572cebfd6c0731a9e572e966fda280be6
ms.sourcegitcommit: a4b5d31b113f520fcd43624dd57be677d10fc1c0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/06/2019
ms.locfileid: "70772787"
---
# <a name="translator-text-api-v30"></a>API перевода текстов v3.0

## <a name="whats-new"></a>Новые возможности

API перевода текстов версии 3 предоставляет современный веб-API на основе JSON. Это улучшает удобство и производительность благодаря объединению существующих функций с меньшим количеством операций и предоставляет новые возможности.

 * Транслитерация для преобразования текста на одном языке из одного сценария в другой.
 * Преобразование на несколько языков в одном запросе.
 * Определение языка, перевод и транслитерация в одном запросе.
 * Словарь для поиска альтернативных переводов термина, для поиска обратных переводов и примеров, показывающих термины, используемые в контексте.
 * Более информативные результаты определения языка.

## <a name="base-urls"></a>Базовые URL-адреса

Microsoft Translator обслуживается несколькими центрами обработки данных. В настоящее время они находятся в 10 [географических регионах Azure](https://azure.microsoft.com/global-infrastructure/regions):

* **Северная и Южная Америка:** Восточная часть США, Юго-Центральный регион США, Западная Центральная часть US и Западная часть США 2 
* **Азиатско-Тихоокеанский регион:** Южная Корея, Восточная Япония, Юго-Восточная Азия и Восточная Австралия
* **Европа** Северная Европа и Западная Европа.

Запросы к Microsoft API перевода текстов в большинстве случаев обрабатываются ближайшим к месту отправки запроса центром обработки данных. В случае сбоя центра обработки данных запрос может маршрутизироваться за пределами службы "География Azure".

Чтобы принудительно обработать запрос в определенной географической службе Azure, измените глобальную конечную точку в запросе API на нужную региональную конечную точку:

|Описание|География Azure|Базовый URL-адрес|
|:--|:--|:--|
|Azure|Глобальный (не региональный)|   api.cognitive.microsofttranslator.com|
|Azure|США|   api-nam.cognitive.microsofttranslator.com|
|Azure|Европа|  api-eur.cognitive.microsofttranslator.com|
|Azure|Азиатско-Тихоокеанский регион|    api-apc.cognitive.microsofttranslator.com|


## <a name="authentication"></a>Проверка подлинности

Подпишитесь на API перевода текстов или [Cognitive Services несколько служб](https://azure.microsoft.com/pricing/details/cognitive-services/) в Microsoft Cognitive Services и используйте ключ подписки (доступный в портал Azure) для проверки подлинности. 

Существуют три заголовка, которые можно использовать для проверки подлинности подписки. Использование каждого из них описано в следующей таблице:

|Заголовки|Описание|
|:----|:----|
|Ocp-Apim-Subscription-Key|*Используйте подписку Cognitive Services, если вы передаете секретный ключ*.<br/>Значение — это секретный ключ Azure для вашей подписки на API перевода текстов.|
|Authorization|*Используйте подписку Cognitive Services, если вы передаете токен аутентификации.*<br/>Значением является токен носителя: `Bearer <token>`.|
|Ocp-Apim-Subscription-Region|*Используйте с подпиской Cognitive Services Multi-Service, если вы передаете секретный ключ с несколькими службами.*<br/>Значение является регионом подписки с несколькими службами. Это значение является необязательным, если не используется подписка с несколькими службами.|

###  <a name="secret-key"></a>Секретный ключ
Первый вариант — выполнить проверку подлинности с помощью заголовка `Ocp-Apim-Subscription-Key`. Просто добавьте заголовок `Ocp-Apim-Subscription-Key: <YOUR_SECRET_KEY>` в запрос.

### <a name="authorization-token"></a>Маркер авторизации
Альтернативным вариантом является изменение секретного ключа для маркера доступа. Этот маркер входит в состав каждого запроса как заголовок `Authorization`. Чтобы получить токен авторизации, сделайте запрос `POST` по следующему URL-адресу.

| Среда     | Служба проверки подлинности URL-адреса                                |
|-----------------|-----------------------------------------------------------|
| Azure           | `https://api.cognitive.microsoft.com/sts/v1.0/issueToken` |

Вот пример запросов для получения токена с секретным ключом.

```
// Pass secret key using header
curl --header 'Ocp-Apim-Subscription-Key: <your-key>' --data "" 'https://api.cognitive.microsoft.com/sts/v1.0/issueToken'

// Pass secret key using query string parameter
curl --data "" 'https://api.cognitive.microsoft.com/sts/v1.0/issueToken?Subscription-Key=<your-key>'
```

Успешный запрос возвращает закодированный токен доступа в виде обычного текста в тексте ответа. Допустимый токен передается в службу переводчика как маркер носителя авторизации.

```
Authorization: Bearer <Base64-access_token>
```

Токен аутентификации допустимый в течение 10 минут. Токен должен быть повторно использован при выполнении нескольких вызовов API переводов. Однако, если программа запрашивает API перевода в течение длительного периода времени, она должна запросить новый маркер доступа через равные промежутки времени (например, каждые 8 ​​минут).

### <a name="multi-service-subscription"></a>Подписка на несколько служб

Последний вариант проверки подлинности — использовать подписку на несколько служб для работы со службой. В этом случае вы сможете использовать единый секретный ключ для проверки подлинности запросов нескольких служб. 

При использовании секретного ключа с несколькими службами необходимо включить в запрос два заголовка проверки подлинности. Первый заголовок передает секретный ключ, а второй указывает регион, связанный с подпиской. 
* `Ocp-Apim-Subscription-Key`
* `Ocp-Apim-Subscription-Region`

Для подписки на API текстовых интерфейсов с несколькими службами требуется регион региона. Выбранный регион является единственным регионом, который можно использовать для перевода текста при использовании ключа подписки с несколькими службами, и должен быть тем же регионом, который вы выбрали при регистрации в подписке с несколькими службами с помощью портал Azure.

Доступные регионы: `australiaeast` `brazilsouth` ,,`centraluseuap` ,`eastus2`,,, ,,,`japanwest`, ,`japaneast`, `centralindia` `centralus` `canadacentral` `eastasia` `eastus` `francecentral` `koreacentral`, ,`northcentralus` ,`southcentralus`, ,`uksouth`,,,, и`westus2`. `westeurope` `westcentralus` `southeastasia` `northeurope` `westus` `southafricanorth`

Если секретный ключ передается в строке запроса с параметром `Subscription-Key`, необходимо указать регион с параметром запроса `Subscription-Region`.

При использовании токена носителя необходимо получить токен из конечной точки региона: `https://<your-region>.api.cognitive.microsoft.com/sts/v1.0/issueToken`.


## <a name="errors"></a>Ошибки

Стандартный ответ об ошибке — это объект JSON с парой имя и значение, названный `error`. Значение также является объектом JSON со следующими свойствами.

  * `code`. Определенный сервером код ошибки.

  * `message`. Строка, дающая представление об ошибке в понятном для человека формате.

Например, клиент с бесплатной пробной подпиской получит следующую ошибку после исчерпания бесплатной квоты.

```
{
  "error": {
    "code":403001,
    "message":"The operation is not allowed because the subscription has exceeded its free quota."
    }
}
```
Код ошибки представляет собой число из 6 знаков, первые 3 из которых являются кодом состояния HTTP, а оставшиеся 3 цифры определяют категорию ошибки. Коды распространенных ошибок:

| Код | Описание |
|:----|:-----|
| 400000| Недопустимые входные данные в запросе.|
| 400001| Недопустимый параметр "scope" (область).|
| 400002| Недопустимый параметр "category" (категория).|
| 400003| Спецификатор языка отсутствует или является недопустимым.|
| 400004| Спецификатор целевого сценария ("To script") отсутствует или является недопустимым.|
| 400005| Входной текст отсутствует или является недопустимым.|
| 400006| Недопустимая комбинация языка и сценария.|
| 400018| Спецификатор исходного сценария ("From script") отсутствует или является недопустимым.|
| 400019| Один из заданных языков не поддерживается.|
| 400020| Один из элементов в массиве входного текста недопустим.|
| 400021| Параметр версии API отсутствует или недопустим.|
| 400023| Один из заданной пары языков является недопустимым.|
| 400035| Исходный язык (поле "From") является недопустимым.|
| 400036| Целевой язык (поле "To") отсутствует или является недопустимым.|
| 400042| Один из указанных параметров (поле "Options") является недопустимым.|
| 400043| Идентификатор трассировки клиента (поле ClientTraceId или заголовок X-ClientTranceId) отсутствует или является недопустимым.|
| 400050| Входной текст является слишком длинным. Просмотр [ограничений запросов](../request-limits.md).|
| 400064| Параметр "translation" (перевод) отсутствует или недопустим.|
| 400070| Количество целевых сценариев (параметр "ToScript") не соответствует количеству целевых языков (параметр "To").|
| 400071| Значение не является допустимым для TextType.|
| 400072| В массиве входного текста слишком много элементов.|
| 400073| Недопустимый параметр сценария.|
| 400074| Текст запроса не соответствует формату JSON.|
| 400075| Сочетание категории и пары языков не является допустимым.|
| 400077| Превышен максимальный размер запроса. Просмотр [ограничений запросов](../request-limits.md).|
| 400079| Система, запрошенная для перевода между данными исходным и целевым языками, не существует.|
| 400080| Транслитерация не поддерживается для языка или скрипта.|
| 401000| Запрос не авторизован, так как учетные данные отсутствуют или являются недопустимыми.|
| 401015| "Указаны учетные данные для API распознавания речи. Этот запрос требует учетные данные для API текста. Используйте подписку на API перевода текстов".|
| 403000| Операция запрещена.|
| 403001| Операция запрещена, так как для подписки превышена бесплатная квота.|
| 405000| Метод запроса не поддерживается для запрошенного ресурса.|
| 408001| Запрошенная система перевода подготавливается. Повторите попытку через несколько минут.|
| 408002| Время ожидания запроса истекло в ожидании входящего потока. Клиент не создал запрос в течение времени, в течение которого сервер был готов к ожиданию. Клиент может повторить запрос без внесения изменений в любое другое время.|
| 415000| Заголовок Content-Type отсутствует или является недопустимым.|
| 429000, 429001, 429002| Сервер отклонил запрос, так как клиент превысил лимиты запросов.|
| 500000| Произошла непредвиденная ошибка. Если ошибка сохраняется, передайте отчет о ней, включив следующие данные: дата и время ошибки, идентификатор запроса из заголовка ответа X-RequestId и идентификатор клиента из заголовка запроса X-ClientTraceId.|
| 503000| Служба временно недоступна. Попробуйте еще раз. Если ошибка сохраняется, передайте отчет о ней, включив следующие данные: дата и время ошибки, идентификатор запроса из заголовка ответа X-RequestId и идентификатор клиента из заголовка запроса X-ClientTraceId.|

