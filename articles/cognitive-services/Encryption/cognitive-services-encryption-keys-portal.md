---
title: Используйте портал Azure для настройки ключей, управляемых клиентами
titleSuffix: Cognitive Services
description: Узнайте, как использовать портал Azure для настройки ключей, управляемых клиентами, с помощью Azure Key Vault. Управляемые клиентом ключи позволяют создавать, вращать, отключать и отменять элементы управления доступом.
services: cognitive-services
author: erindormier
ms.service: cognitive-services
ms.topic: include
ms.date: 03/11/2020
ms.author: egeaney
ms.openlocfilehash: 04a8a8d2520376931f2bb7727c1e751b83f6315f
ms.sourcegitcommit: b55d7c87dc645d8e5eb1e8f05f5afa38d7574846
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/16/2020
ms.locfileid: "81455263"
---
# <a name="configure-customer-managed-keys-with-azure-key-vault-by-using-the-azure-portal"></a>Налаживание ключей, управляемых клиентами, с помощью портала Azure Key Vault

Для хранения ключей, управляемых клиентом, необходимо использовать Azure Key Vault. Вы можете создать свои собственные ключи и хранить их в хранилище ключей, либо использовать AA-иносы Azure Key Vault для генерации ключей. Ресурс Когнитивных Служб и хранилище ключей должны находиться в одном регионе и в том же клиенте Azure Active Directory (Azure AD), но они могут быть в разных подписках. Для получения дополнительной информации о [What is Azure Key Vault?](https://docs.microsoft.com/azure/key-vault/key-vault-overview)Убежище ключей Azure см.

В этой статье показано, как настроить Хранилище ключей Azure с помощью ключей, управляемых клиентами, с помощью [портала Azure.](https://portal.azure.com/) Чтобы узнать, как создать хранилище ключей с помощью портала Azure, [см.](../../key-vault/secrets/quick-create-portal.md)

## <a name="configure-azure-key-vault"></a>Настройка Azure Key Vault

Использование ключей, управляемых клиентом, требует, чтобы два свойства были установлены на хранилище ключей, **Soft Delete** и Do **Not Purge.** Эти свойства не включены по умолчанию, но могут быть включены с помощью PowerShell или Azure CLI в новом или существующем хранилище ключей.

> [!IMPORTANT]
> Если у вас нет включены свойства **Soft Delete** и Do **Not Purge** и вы удалите ключ, вы не сможете восстановить данные на ресурсе Cognitive Service.

Чтобы узнать, как включить эти свойства в существующем хранилище ключей, см. разделы под названием **"Включение в мягкое удаление** и **включение защиты от очистки"** в одной из следующих статей:

- [Как использовать мягкое удаление с PowerShell](https://docs.microsoft.com/azure/key-vault/key-vault-soft-delete-powershell).
- [Как использовать мягкое удаление с CLI](https://docs.microsoft.com/azure/key-vault/key-vault-soft-delete-cli).

Только клавиши RSA размера 2048 поддерживаются шифрованием Azure Storage. Для получения дополнительной информации о ключах смотрите **ключи Убежища ключей** в [о клавишах, секретах и сертификатах Azure Key Vault.](https://docs.microsoft.com/azure/key-vault/about-keys-secrets-and-certificates#key-vault-keys)

## <a name="enable-customer-managed-keys"></a>Включить ключи, управляемые клиентом

Для включения ключей, управляемых клиентами, на портале Azure выполните следующие действия:

1. Перейдите на ресурс Cognitive Services.
1. На **лезвии настроек** для ресурса Cognitive Services нажмите **«Шифрование».** Выберите опцию **Управляемые ключи клиента,** как показано на следующей цифре.

    ![Скриншот, показывающий, как выбрать управляемые ключи клиента](../media/cognitive-services-encryption/selectcmk.png)

## <a name="specify-a-key"></a>Указать ключ

После включения ключей, управляемых клиентом, у вас будет возможность указать ключ для связи с ресурсом Cognitive Services.

### <a name="specify-a-key-as-a-uri"></a>Указание ключа в качестве URI

Чтобы указать ключ как URI, выполните следующие действия:

1. Чтобы найти ключ URI на портале Azure, перейдите к хранилищу ключа и выберите настройки **ключей.** Выберите нужный ключ, а затем нажмите на клавишу, чтобы просмотреть его версии. Выберите ключевую версию для просмотра настроек для этой версии.
1. Копируйте значение поля **идентификатора ключей,** которое обеспечивает URI.

    ![Скриншот, показывающий ключ свода URI](../media/cognitive-services-encryption/key-uri-portal.png)

1. В настройках **шифрования** для учетной записи хранилища выберите опцию **Uri ключа Enter.**
1. Вставьте URI, который вы скопировали в поле **Key URI.**

   ![Скриншот, показывающий, как ввести ключ URI](../media/cognitive-services-encryption/ssecmk2.png)

1. Укажите подписку, содержащую хранилище ключей.
1. Сохраните изменения.

### <a name="specify-a-key-from-a-key-vault"></a>Указание ключа из хранилища ключей

Чтобы указать ключ из хранилища ключей, сначала убедитесь, что у вас есть хранилище ключей, содержащее ключ. Чтобы указать ключ из хранилища ключей, выполните следующие действия:

1. Выберите параметр **Выбрать в Key Vault**.
1. Выберите хранилище ключей, содержащее ключ, который вы хотите использовать.
1. Выберите ключ из хранилища ключей.

   ![Скриншот, показывающий ключевой вариант, управляемый клиентами](../media/cognitive-services-encryption/ssecmk3.png)

1. Сохраните изменения.

## <a name="update-the-key-version"></a>Обновление ключевой версии

При создании новой версии ключа обновите ресурс Cognitive Services, чтобы использовать новую версию. Выполните следующие действия.

1. Перейдите на ресурс Cognitive Services и отобразите параметры **шифрования.**
1. Введите URI для новой ключевой версии. Кроме того, вы можете выбрать хранилище ключей и ключ снова для обновления версии.
1. Сохраните изменения.

## <a name="use-a-different-key"></a>Используйте другой ключ

Чтобы изменить ключ, используемый для шифрования, выполните следующие действия:

1. Перейдите на ресурс Cognitive Services и отобразите параметры **шифрования.**
1. Введите URI для нового ключа. Кроме того, вы можете выбрать хранилище ключей и выбрать новый ключ.
1. Сохраните изменения.

## <a name="disable-customer-managed-keys"></a>Отключить ключи, управляемые клиентом

При отключении ключей, управляемых клиентом, ваш ресурс Cognitive Services затем шифруется с помощью ключей, управляемых корпорацией Майкрософт. Чтобы отключить ключи, управляемые клиентом, выполните следующие действия:

1. Перейдите на ресурс Cognitive Services и отобразите параметры **шифрования.**
1. Отменить флажок рядом с настройкой **ключа Используйте свои собственные настройки.**

## <a name="next-steps"></a>Следующие шаги

* [Что такое Убежище ключей Azure?](https://docs.microsoft.com/azure/key-vault/key-vault-overview)
* [Когнитивные услуги Клиент-Управляемые ключевые формы запроса](https://aka.ms/cogsvc-cmk)
* [Службы face шифрования данных в состоянии покоя](../Face/face-encryption-of-data-at-rest.md)
* [Шифрование данных в состоянии покоя](../QnAMaker/qna-maker-encryption-of-data-at-rest.md)
* [Служба понимания языка шифрования данных в состоянии покоя](../LUIS/luis-encryption-of-data-at-rest.md)
* [Шифрование данных модератором содержимого в состоянии покоя](../Content-Moderator/content-moderator-encryption-of-data-at-rest.md)
* [Переводчик шифрования данных в состоянии покоя](../translator/translator-encryption-of-data-at-rest.md)
* [Ликвайзер шифрования данных в состоянии покоя](../personalizer/personalizer-encryption-of-data-at-rest.md)
