---
title: Использование вызовов API в модели Conversation Learner в Microsoft Cognitive Services | Документация Майкрософт
titleSuffix: Azure
description: Сведения об использовании вызовов API в модели Conversation Learner.
services: cognitive-services
author: nitinme
manager: nolachar
ms.service: cognitive-services
ms.subservice: conversation-learner
ms.topic: article
ms.date: 04/30/2018
ms.author: nitinme
ROBOTS: NOINDEX
ms.openlocfilehash: 261536932cc82a28ad4ee3ffc3575ea41fe9ec5b
ms.sourcegitcommit: ad9120a73d5072aac478f33b4dad47bf63aa1aaa
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/01/2019
ms.locfileid: "68703927"
---
# <a name="how-to-add-api-calls-to-a-conversation-learner-model"></a>Добавление вызовов API в модель Conversation Learner

В этом руководстве показано, как добавлять вызовы API в модель. Вызовы API — это функции, которые вы можете определить и сохранить в боте, чтобы приложение Conversation Learner могло их вызывать.

## <a name="video"></a>Видео

[![Предварительная версия учебника по вызовам API](https://aka.ms/cl_Tutorial_v3_APICalls_Preview)](https://aka.ms/cl_Tutorial_v3_APICalls)

## <a name="requirements"></a>Требования
Для работы с этим руководством требуется запущенный бот обучения tutorialAPICalls.ts.

    npm run tutorial-api-calls

## <a name="details"></a>Подробнее

- Вызовы API позволяют считывать и изменять информацию в сущностях.
- Вызовы API имеют доступ к объекту диспетчера памяти.
- Вызовы API могут принимать аргументы.

### <a name="open-the-demo"></a>Запуск демонстрационного примера

В веб-интерфейсе щелкните "Импорт учебников" и выберите модель Tutorial-14-APICalls.

### <a name="entities"></a>Сущности

Для этой модели определена одна сущность с именем `number`.

![](../media/tutorial12_entities.PNG)

### <a name="api-calls"></a>Вызовы API
Код для вызовов API задан в этом файле: `C:\<installedpath>\src\demos\tutorialAPICalls.ts`.

![](../media/tutorial12_apicalls.PNG)

- Обратный вызов `RandomGreeting` возвращает случайное приветствие, определенное в массиве `greeting`.
- Обратный вызов `Multiply` перемножает два числа, переданные вызвавшим его действием, и возвращает результат, который может быть отображен в пользовательском интерфейсе.
    - Обратите внимание, что первым аргументом является диспетчер памяти. 
    - Обратите внимание на то, что обратные вызовы API могут принимать несколько аргументов, в данном случае `num1string` и `num2string`.
- Обратный вызов `ClearEntities` очищает сущность number, чтобы пользователь мог ввести другое число. 
    - Здесь показано, как управлять сущностями с помощью вызовов API.

### <a name="actions"></a>Действия
Мы создали четыре действия. Три из них — это действия API без ожидания, а четвертое — действие Text, которое задает пользователю вопрос, похожий на те, которые использовались в других руководствах. Чтобы просмотреть, как было создано каждое действие, сделайте следующее.
1. На левой панели щелкните "Действия", а затем щелкните одно из четырех действий в сетке.
2. Обратите внимание на значения полей в появившейся форме.
3. Обратите внимание на кнопку `Refresh` рядом с полем API.
    - Если вы остановили бота и изменили API, пока страница пользовательского интерфейса была открыта, нажмите кнопку `Refresh`, чтобы получить последние изменения.

![](../media/tutorial12_actions.PNG)

#### <a name="clearentities-multiply-and-randomgreeting"></a>ClearEntities, Multiply и RandomGreeting
Все эти три действия являются типами API. Каждое из них вызывает функции обратного вызова API для выполнения определенных действий и при необходимости возвращает значение, которое будет предоставлено пользователю.

#### <a name="what-number-do-you-want-to-multiply-by-12"></a>What number do you want to multiply by 12? (Какое число вы хотите умножить на 12?)
Это "текстовое" действие, и оно просто задает вопрос пользователю. Хотя это действие на самом деле не взаимодействует с обратными вызовами API, оно предлагает пользователю дать числовой ответ, который будет записан в память сущности и может быть использован действием Multiply, которое использует один из обратных вызовов API.


### <a name="train-dialog"></a>Обучение диалогу

Давайте рассмотрим обучающий диалог подробнее.

1. На левой панели щелкните `Train Dialogs`, а затем нажмите кнопку `New Train Dialog`.
2. Введите hello (привет).
3. Нажмите кнопку `Score Actions`.
4. Выберите `RandomGreeting`. 
    - Выполнится вызов API, возвращающий произвольное приветствие.
    - Этот вызов не будет ожидать ответа пользователя.
5. Выберите `What number to do you want to multiply by 12?`
6. Введите число (любое число и только число).
    - Обратите внимание, что ваш номер был автоматически помечен как сущность `number`.
7. Нажмите кнопку `Score Actions`.
8. Выберите действие `Multiply`.
    - Запомните результат умножения на 12.
    - Обратите внимание на то, что память по-прежнему содержит значение, введенное для `number`.
9. Выберите действие `ClearEntities`.
    - Обратите внимание, что значение сущности `number` было удалено из памяти.
10. Нажмите кнопку `Save`.

Итак, вы узнали, как зарегистрировать обратные вызовы API, увидели типичные примеры их использования, научились определять аргументы и передавать в них значения и сущности.

## <a name="next-steps"></a>Следующие шаги

> [!div class="nextstepaction"]
> [Карты. Часть 1](./15-cards.md)
