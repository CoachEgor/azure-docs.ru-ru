---
title: Нереалные акустики проекта и интеграция Ввисе
titlesuffix: Azure Cognitive Services
description: В этом практическом порядке описывается интеграция нереальных и Ввисе подключаемых модулей в проект.
services: cognitive-services
author: NoelCross
manager: nitinme
ms.service: cognitive-services
ms.subservice: acoustics
ms.topic: conceptual
ms.date: 03/20/2019
ms.author: noelc
ROBOTS: NOINDEX
ms.openlocfilehash: 47f39e8dcd96ea3bdba564df348e9b89a6b036ba
ms.sourcegitcommit: 13a289ba57cfae728831e6d38b7f82dae165e59d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/09/2019
ms.locfileid: "68933163"
---
# <a name="project-acoustics-unreal-and-wwise-integration"></a>Нереалные акустики проекта и интеграция Ввисе
В этом практическом руководстве представлены подробные этапы интеграции пакета подключаемого модуля акустических характеристик проекта в существующий проект Ввисе Game. 

Требования к программному обеспечению:
* [Нереальная подсистема](https://www.unrealengine.com/) 4.20+
* [Аудиокинетик ввисе](https://www.audiokinetic.com/products/wwise/) 2018,1.\*
* [Подключаемый модуль ввисе для нереального](https://www.audiokinetic.com/library/?source=UE4&id=index.html)
  * Если вы используете прямую интеграцию с пакетом SDK для Ввисе, а не используете Ввисе нереалные подключаемые модули, ознакомьтесь со сведениями о нереальном подключаемом модуле в проектах и настройте вызовы API Ввисе.

Если вы хотите использовать акустические функции с звуковым механизмом, отличным от Ввисе, сделайте запрос на улучшение на [форуме](https://github.com/microsoft/ProjectAcoustics/issues)по акустическим материалам по проектам. Вы можете использовать нереалный подключаемый модуль, чтобы запросить данные о акустических характеристиках, а затем выполнить вызовы API к вашему подсистеме.

## <a name="download-project-acoustics"></a>Скачать акустические характеристики проекта
Если вы еще не сделали этого, скачайте [пакет "акустические характеристики проекта Нереал & ввисе подключаемого модуля](https://www.microsoft.com/download/details.aspx?id=58090)"). 

Мы включили в пакет подключаемый модуль "нереалный модуль" и подключаемый модуль Ввисе микшера. Нереалный подключаемый модуль обеспечивает интеграцию с редактором и средой выполнения. Во время игрового процессаа нереалный подключаемый модуль рассчитывает параметры, такие как перекрытия, для каждого кадра в каждом объекте игры. Эти параметры преобразуются в вызовы API Ввисе.

## <a name="review-integration-steps"></a>Ознакомьтесь с этапами интеграции.

Существуют следующие основные шаги по установке пакета и его развертыванию в игре.
1. Установка подключаемого модуля Ввисе микшера для акустических характеристик проекта
2. (Re) разверните Ввисе в игре. Этот шаг распространяет подключаемый модуль микшера в проект игры.
3. Добавление в игру нереального подключаемого модуля "Акустика проекта"
4. Расширение функциональных возможностей подключаемого модуля Unreal для Wwise
5. Сборка игры и проверка Python включена
6. Настройка проекта Ввисе для использования акустических характеристик проекта
7. Настройка звука в нереальном режиме

## <a name="1-install-the-project-acoustics-mixer-plugin"></a>1. Установка подключаемого модуля микшера для акустических характеристик проекта
* Откройте средство запуска Wwise, а затем на вкладке **Plugins** (Подключаемые модули) в разделе **Install New Plugins** (Установка новых подключаемых модулей) выберите **Add From Directory** (Добавить из каталога). 

    ![Снимок экрана: Установка подключаемого модуля в средстве запуска Ввисе](media/wwise-install-new-plugin.png)

* Выберите каталог `AcousticsWwisePlugin\ProjectAcoustics`, содержащийся в скачанном пакете. Он содержит пакет подключаемого модуля микшера Ввисе.

* Ввисе установит подключаемый модуль. Акустические характеристики проекта должны отобразиться в списке установленных подключаемых модулей в Ввисе.  
![Снимок экрана: список установленных подключаемых модулей Ввисе после установки акустических характеристик проекта](media/unreal-integration-post-mixer-plugin-install.png)

## <a name="2-redeploy-wwise-into-your-game"></a>2. (Re) развертывание Ввисе в игре
Повторно разверните Ввисе в игре, даже если вы уже интегрированы Ввисе. В результате будет выбран подключаемый модуль Ввисе для акустики проекта.

* **Подключаемый модуль подсистемы:** Если вы установили Ввисе в качестве подключаемого модуля игры в нереальном C++ проекте, пропустите этот шаг. Если он установлен в качестве подключаемого модуля подсистемы, например, если нереальный проект является только схемой, Ввисе развертывание с помощью нашего подключаемого модуля микшера является более сложным. Создайте фиктивный пустой C++ проект, закройте его, если откроется нереалй редактор, и выполните оставшуюся процедуру, чтобы развернуть ввисе в этом фиктивном проекте. Затем скопируйте развернутый подключаемый модуль Ввисе.
 
* В средстве запуска Wwise перейдите на вкладку **Unreal Engine**, а затем щелкните меню с тремя полосками рядом с разделом **Recent Unreal Engine Projects** (Последние проекты Unreal Engine) и выберите **Browse for project** (Поиск проекта). Откройте файл нереального проекта `.uproject` вашей игры.

    ![Снимок экрана: Нереал. Вкладка средства запуска Ввисе](media/wwise-unreal-tab.png)

* Затем щелкните **интегрировать ввисе в проект** или **изменить ввисе в проекте**. Этот шаг (Re) интегрирует двоичные файлы Ввисе в проект, теперь включая подключаемый модуль микшера для акустических характеристик проекта.

* **Подключаемый модуль подсистемы:** Если вы используете ввисе в качестве подключаемого модуля подсистемы и создали фиктивный проект, как описано выше, скопируйте папку развернутый ввисе `[DummyUProject]\Plugins\Wwise` : `[UESource]\Engine\Plugins\Wwise`и вставьте ее заново. `[DummyUProject]`— Это пустой недействительный C++ путь к проекту `[UESource]` , в котором установлены источники нереального модуля. После завершения копирования можно удалить фиктивный проект.

## <a name="3-add-the-project-acoustics-unreal-plugin-to-your-game"></a>3. Добавление в игру нереального подключаемого модуля "Акустика проекта"
 
* Скопируйте папку в пакет подключаемого модуля и создайте новую папку `[UProjectDir]\Plugins\ProjectAcoustics`, где `UProjectDir` `.uproject` — это папка проекта вашей игры, содержащая файл. `Unreal\ProjectAcoustics`
  * **Подключаемый модуль подсистемы**: Если вы используете Ввисе в качестве подключаемого модуля подсистемы, следует также использовать акустику проекта в качестве подключаемого модуля нереального ядра. Вместо указанного выше каталога назначения используйте: `[UESource]\Engine\Plugins\ProjectAcoustics`.

* Убедитесь, что `Wwise` папка находится рядом с `ProjectAcoustics` папкой. Он содержит подключаемый модуль Ввисе вместе с двоичными файлами для подключаемого модуля микшера, который вы (повторно) развернули на шаге 2 выше.

## <a name="4-extend-wwises-unreal-plugin-functionality"></a>4. Расширение функциональных возможностей подключаемого модуля Unreal для Wwise
* Нереалным подключаемым модулем проекта требуются дополнительные действия, предоставляемые API подключаемого модуля Ввисе нереального времени для [этих рекомендаций](https://www.audiokinetic.com/library/?source=UE4&id=using__initialsetup.html). Мы включили пакетный файл для автоматизации процедуры исправления. 
* В `Plugins\ProjectAcoustics\Resources` выполните файл `PatchWwise.bat`. В примере на рисунке ниже используется наш пример проекта Акаустиксгаме.

    ![Снимок экрана: выделенный скрипт в окне проводника Windows для исправления Ввисе](media/patch-wwise-script.png)

* Если пакет SDK DirectX не установлен, в зависимости от используемой версии Wwise, возможно, потребуется закомментировать строку, содержащую `DXSDK_DIR` в `AcousticsGame\Plugins\Wwise\Source\AkAudio\AkAudio.Build.cs`:

    ![Снимок экрана с редактором кода — комментирование строки DXSDK](media/directx-sdk-comment.png)

* Если компиляция выполняется с помощью Visual Studio 2019, чтобы обойти ошибку компоновки с помощью ввисе, вручную измените значение `VSVersion` по умолчанию `vc150`в `AcousticsGame\Plugins\Wwise\Source\AkAudio\AkAudio.Build.cs` на:

    ![Снимок экрана редактора кода, отображающего Всверсион, измененный на VC150](media/vsversion-comment.png)

## <a name="5-build-game-and-check-python-is-enabled"></a>5. Сборка игры и проверка Python включена

* Скомпилируйте игру и убедитесь, что она правильно построена. В противном случае перед продолжением внимательно проверьте предыдущие шаги. 
* Откройте проект в нереальном редакторе. 
* **Подключаемый модуль подсистемы:** При использовании подключаемого модуля Прожектакаустикс в качестве подсистемы также убедитесь, что он включен, в списке Встроенные подключаемые модули.
* Должен отобразиться новый режим, который указывает на интеграцию акустических характеристик проекта.

    ![Снимок экрана: режим "в режиме акустических данных" полон](media/acoustics-mode-full.png)

* Убедитесь, что у вас есть подключаемый модуль Python для нереального включения. Это необходимо для правильной работы интеграции редактора.

    ![Снимок экрана: Включение расширений Python в нереальном редакторе](media/ensure-python.png)

## <a name="6-wwise-project-setup"></a>6. Настройка проекта ввисе

Пример проекта Ввисе включается вместе с загружаемыми образцами. Мы рекомендуем рассмотреть эти инструкции вместе с этими инструкциями. Приведенные ниже снимки экрана берутся из этого проекта.

### <a name="bus-setup"></a>Настройка шины
* Нереалный подключаемый модуль проекта будет искать связанный подключаемый модуль микшера на шине с таким ***точным*** именем: `Project Acoustics Bus`. Создайте новую звуковую шину с таким именем. Подключаемый модуль микшера может работать в различных конфигурациях, но теперь предполагается, что он будет использоваться только для обработки передействий. Эта шина будет передавать смешанный перекомандный сигнал для всех источников, использующих акустические характеристики. Он может смешивать потоковую передачу в любую структуру смешения шины, пример показан ниже, взятый из нашего примера проекта Ввисе, включенного в образец загрузки.

    ![Снимок экрана: шины Ввисе, отображающие шину акустических характеристик проекта](media/acoustics-bus.png)

* Конфигурацию канала на шине необходимо задать одним из следующих способов: `1.0, 2.0, 4.0, 5.1 or 7.1`. Другие конфигурации не приведут к выходным данным на этой шине.

    ![Снимок экрана параметров конфигурации канала для шины "акустические характеристики проекта"](media/acoustics-bus-channel-config.png)

* Теперь перейдите в раздел сведения о шине для акустических характеристик проекта и убедитесь, что вы видите вкладку подключаемый модуль микшера.

    ![Снимок экрана Ввисе, показывающий, как включить вкладку подключаемого модуля микшера для шины "акустические характеристики проекта"](media/mixer-tab-enable.png)

* Затем перейдите на вкладку подключаемый модуль микшера и добавьте к шине подключаемый модуль микшера для акустических характеристик проекта.

    ![Снимок экрана шины Ввисе, показывающей, как добавить подключаемый модуль микшера для акустических элементов проекта](media/add-mixer-plugin.png)

### <a name="actor-mixer-hierarchy-setup"></a>Субъект — Настройка иерархии микшера
* По соображениям производительности, в ходе проекта акустические схемы DSP применяются ко всем источникам одновременно. Для этого подключаемый модуль должен использоваться в качестве подключаемого модуля микшера. Ввисе требует, чтобы плагины микшера находящегося на выходной шине, хотя выходная шина обычно переносит сухой выходной сигнал. Для акустических характеристик проекта требуется направить сигнал сухой через дополнительные шины, а сигнал о неведении — на `Project Acoustics Bus`. Следующий процесс поддерживает постепенное перемещение в этот поток сигналов.

* Предположим, у вас есть проект с иерархией на основе субъекта-микшера, содержащей примеру, оружие и другие на верхнем уровне. У каждого из них есть соответствующая выходная шина для своего сухой Mix. Допустим, вы хотите перенести примеру для использования акустических характеристик. Сначала создайте соответствующую вспомогательную шину, чтобы получить сухой субмикс, который является дочерним по отношению к выходной шине примеру. Например, мы использовали «сухой» префикс на рисунке ниже, чтобы упорядочить их, хотя точное имя не имеет значения. Все счетчики или эффекты, которые вы находились на шине примеру, по-прежнему будут работать, как и раньше.

    ![Снимок экрана с рекомендуемой настройкой Ввисе сухой Mix](media/wwise-dry-mix-setup.png)

* Затем измените структуру выходных данных шины для примеру Actor-микшера, как показано ниже, с заданной в качестве выходной шины и Dry_Footsteps, установленной пользователем AUX Bus.

    ![Снимок экрана с рекомендуемым параметром настройки шины микшера Ввисе Actor](media/actor-mixer-bus-settings.png)

* Теперь все примеру получают акустические характеристики и выводят их переглаголы на шину обработки акустических данных проекта. Сигнал сухой направляется через Dry_Footsteps и пространственно как обычно.

* Акустические характеристики проекта применяются только к звукам, имеющим трехмерное расположение в мире. В следующей [документации по ввисе](https://blog.audiokinetic.com/out-with-the-old-in-with-the-new-positioning-revamped-in-wwise-2018.1/)свойства позиционирования должны быть заданы так, как показано ниже. При необходимости параметр "объемная пространственность" может иметь значение "положение" или "положение + ориентация".

    ![Снимок экрана с рекомендуемыми параметрами позиционирования субъекта Ввисе](media/wwise-positioning.png)

* Настройка выходной шины на другую шину, в которую переводятся данные из вышестоящей **шины проекта** , не будет работать. Ввисе накладывает это требование на подключаемые модули микшера.

* Если вы хотите, чтобы дочерняя иерархия в иерархии примеру Actor-микшера не использовала акустические характеристики, вы всегда можете использовать для этого "переопределить родителя".

* Если вы используете или заменяющие пользователем функции отправки для переглагола в любом микшере субъекта в игре, отключите их на этом актере, чтобы избежать повторного применения переглагола.

### <a name="spatialization"></a>Пространственный индекс
По умолчанию подключаемый модуль микшера для акустических характеристик проекта применяет переглаголы свертки, при этом Ввисе выполняет пространственное панорамирование. При использовании акустических характеристик по проектам в этой конфигурации по умолчанию можно использовать любую настройку канала и метод пространственности для вашего сухой Mix, что позволяет смешивать и сопоставлять почти любые спатиализер с переглаголом акустических акустики проекта. К вашим вариантам относятся [амбисоникс бинаурал спатиализерс](https://www.audiokinetic.com/products/ambisonics-in-wwise/) и [Windows Sonic](https://docs.microsoft.com/windows/desktop/CoreAudio/spatial-sound).
 
Акустические характеристики проекта включают необязательный спатиализер, поддерживающий визуализацию на основе объектов с высоким разрешением ХРТФ и панорамирование. Установите флажок "выполнить пространственность" в параметрах подключаемого модуля микшера и выберите между ХРТФ или панорамирование и отключите определяемые пользователем добавочные отправки, настроенные выше на все сухие шины, чтобы избежать спатиализинг дважды, как с помощью подключаемого модуля микшера для обработки и настройки акустических характеристик проекта, так и Ввисе. Режим пространственности нельзя изменить в режиме реального времени, так как он требует повторного создания звукового банка. Необходимо перезапустить нереалию, а затем повторно создать саундбанкс перед нажатием клавиши Play, чтобы выбрать изменения конфигурации подключаемого модуля микшера, такие как флажок "выполнить пространственность".

![Снимок экрана параметров пространственного подключения подключаемого модуля микшера Ввисе](media/mixer-spatial-settings.png)

К сожалению, в настоящее время не поддерживаются другие подключаемые модули спатиализер на основе объектов, так как они реализованы как подключаемые модули микшера, и Ввисе сейчас не допускают несколько подключаемых модулей микшера, назначенных одному микшеру субъекта.  

## <a name="7-audio-setup-in-unreal"></a>7. Настройка звука в нереальном режиме
* Сначала необходимо внедрить уровень игры, чтобы создать ресурс для акустических характеристик, который будет помещен в `Content\Acoustics`. Ознакомьтесь с [руководством](unreal-baking.md) по нереальному внедрить и возобновите здесь. Некоторые уровни, предшествующие помогут, включены в образец пакета.
* Создание субъекта пространства акустических характеристик в сцене. Создавайте один из этих субъектов на уровне, так как он представляет акустические характеристики для всего уровня. 

    ![Снимок экрана: Нереальный редактор с созданием пространства для акустических характеристик](media/create-acoustics-space.png)

* Теперь назначьте ресурс помогут акустики данных в область данных акустических характеристик субъекта "акустическое пространство". Теперь у сцены есть акустические характеристики!

    ![Снимок экрана: Нереальный редактор с назначением ресурса акустических характеристик](media/acoustics-asset-assign.png)

* Теперь добавьте пустой субъект и выполните следующие действия.

    ![Снимок экрана: Нереальный редактор, демонстрирующий использование компонента акустических характеристик в пустом субъекте](media/acoustics-component-usage.png)

1. Добавьте в субъект звуковой компонент акустических характеристик. Этот компонент расширяет звуковой компонент Ввисе с помощью функций для акустических характеристик проекта.
2. Флажок воспроизвести при запуске установлен по умолчанию, который активирует связанное событие Ввисе при запуске уровня.
3. Чтобы распечатать отладочную информацию об источнике, используйте флажок Показывать параметры акустических параметров.  
    ![Снимок экрана: панель акустических эффектов нереального редактора в звуковом источнике с включенными значениями отладки](media/debug-values.png)
4. Назначение события Ввисе для обычного рабочего процесса Ввисе
5. Убедитесь, что параметр использовать пространственный звук отключен. В настоящее время, если вы используете акустические характеристики проекта для конкретного звукового компонента, вы не сможете одновременно использовать пространственный механизм Ввисе для акустических характеристик.

Все готово. Продвиньтесь вокруг сцены и изучите акустические эффекты!

## <a name="next-steps"></a>Следующие шаги
* Руководство по [проектированию](unreal-workflow.md) для акустических характеристик проекта в нереальном или ввисе
* [Узнайте, как сделать создает](unreal-baking.md) для сцен игр 
