---
title: Улучшение классификатора  — пользовательская служба визуального распознавания
titlesuffix: Azure Cognitive Services
description: Узнайте, как повысить качество классификатора.
services: cognitive-services
author: PatrickFarley
manager: nitinme
ms.service: cognitive-services
ms.subservice: custom-vision
ms.topic: conceptual
ms.date: 03/21/2019
ms.author: pafarley
ms.openlocfilehash: 35f83832b0ceb7507b39095e9cc974d82a480c69
ms.sourcegitcommit: 3102f886aa962842303c8753fe8fa5324a52834a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "60606938"
---
# <a name="how-to-improve-your-classifier"></a>Как улучшить классификатор

В этом руководстве вы узнаете, как повысить качество классификатора службы пользовательского визуального распознавания. Качество классификатора зависит от объема, качества и разнообразия предоставленных ему данных с метками и от того, насколько сбалансирован весь набор данных. Эффективный классификатор использует сбалансированный учебный набор данных, который представляет то, что будет передаваться в классификатор. Процесс создания такого классификатора является итеративным. Довольно часто для достижения ожидаемых результатов нужно выполнить несколько циклов обучения.

Ниже приведен общий шаблон, который поможет создать более точный классификатор.

1. Первый сеанс обучения
1. Добавьте дополнительные изображения и сбалансируйте данные. Повторите обучение.
1. Добавьте изображения с различным фоном, освещением, размером объекта, углом камеры и стилем. Повторите обучение.
1. Используйте новые изображения для тестирования прогноза.
1. Измените существующие обучающие данные в соответствии с результатами прогноза.

## <a name="prevent-overfitting"></a>Предотвращения лжевзаимосвязей

В некоторых случаях классификатор научится создавать прогнозы на основе произвольных характеристик, общих для изображений. Например, при создании классификатора яблок и цитрусовых, имея изображения яблок в руках, а цитрусовых на белых тарелках, классификатор может сосредоточиться на руках и белых тарелках вместо яблок и цитрусовых.

![Изображение неожиданной классификации](./media/getting-started-improving-your-classifier/unexpected.png)

Чтобы устранить эту проблему, следуйте приведенным рекомендациям по использованию более разнообразных изображений: с разным ракурсом, разным фоном, разными размерами объекта, в группах и другие варианты.

## <a name="data-quantity"></a>Количество данных

Число обучающих изображений является наиболее важным фактором. Мы рекомендуем использовать по меньшей мере 50 изображений на метку в качестве отправной точки. При меньшем числе изображений существует более высокий риск появления лжевзаимосвязей, и хотя показатели производительности могут указывать на хорошее качество модели, она может испытывать трудности при обработке реальных данных. 

## <a name="data-balance"></a>Сбалансированность данных

Важно также учесть относительный объем обучающих данных. Например, использование 500 изображений для одной метки и 50 — для другой приведет к созданию несбалансированного обучающего набора данных. В результате модель будет прогнозировать одну метку точнее, чем другую. Если оставить соотношение 1:2 между метками с наименьшим количеством изображений и метками с наибольшим количеством изображений, то скорее всего, вы увидите наилучший результат. Например, если наибольшим числом изображений для какой-либо метки является 500, то наименьшим числом изображений для другой метки должно быть не менее 250.

## <a name="data-variety"></a>Разнообразие данных

Предоставьте изображения, максимально похожие на конкретное содержимое, которое будет передаваться в классификатор при его использовании. В противном случае классификатор может научиться создавать прогнозы на основе произвольных характеристик, общих для изображений. Например, при создании классификатора яблок и цитрусовых, имея изображения яблок в руках, а цитрусовых на белых тарелках, классификатор может сосредоточиться на руках и белых тарелках вместо яблок и цитрусовых.

![Изображение неожиданной классификации](./media/getting-started-improving-your-classifier/unexpected.png)

Чтобы устранить эту проблему, используйте разнообразные изображения, чтобы классификатор научился правильно их обобщать. Некоторые из способов, с помощью которых можно сделать набор для обучения более разнообразным, приведены ниже.

* __Базовая информация.__ Предоставьте изображения объекта на разном фоне. Фотографии в естественном окружении лучше, чем фотографии на нейтральном фоне, так как они предоставляют больше информации для классификатора.

    ![Изображение примеров фонов](./media/getting-started-improving-your-classifier/background.png)

* __Освещение.__ Предоставьте изображения объекта с различным освещением (например, с использованием вспышки, высокой экспозиции и т. д.), особенно когда на изображениях, используемых для прогнозирования, разнообразное освещение. Полезно также использовать изображения с разнообразной насыщенностью, оттенком и яркостью.

    ![Изображение примеров освещения](./media/getting-started-improving-your-classifier/lighting.png)

* __Размер объекта.__ Предоставьте изображения, на которых объекты отличаются размером и количеством (например, фотографию гроздьев бананов и крупный план одного банана). Различные размеры объектов помогают классификатору делать общие выводы.

    ![Изображение примеров размеров](./media/getting-started-improving-your-classifier/size.png)

* __Угол обзора камеры.__ Предоставьте изображения объекта, снятые под разными углами зрения. Кроме того, если все фотографии должны быть сделаны с помощью стационарных камер (например, камер видеонаблюдения), обязательно назначьте постоянным объектам в кадре разные метки. Это позволит избежать формирования лжевзаимосвязей &mdash; то есть интерпретации несвязанных объектов (например, фонарных столбов) как ключевого признака.

    ![Изображение примеров объектов под разными углами](./media/getting-started-improving-your-classifier/angle.png)

* __Стиль__. Предоставьте изображения одного и того же класса, но в разных стилях (например, различные варианты одного фрукта). Тем не менее, если присутствуют изображения объектов совершенно разных стилей (например, Микки-Маус и реальная мышь), рекомендуется отметить их как отдельные классы, что позволит лучше представлять их различные признаки.

    ![Изображение примеров стилей](./media/getting-started-improving-your-classifier/style.png)

## <a name="negative-images"></a>Отрицательное образов

Возможно, на каком-то этапе вам потребуется добавить в проект _негативные примеры_, чтобы повысить точность классификатора. Негативным примером называется изображение, которое не соответствует ни одному из тегов. Отправляя такие изображения, примените к ним специальную метку **Negative** (Негативные).

> [!NOTE]
> Пользовательская служба визуального распознавания поддерживает автоматическое применение отрицательных примеров изображений. Например, когда вы компилируете классификатор для различения винограда и банана, то для фотографии ботинка он должен предоставить оценку 0 % по обеим категориям.
> 
> С другой стороны, в тех случаях, когда отрицательные изображения являются лишь вариацией изображений, используемых в обучении, вполне вероятно, что из-за большого сходства модель будет классифицировать отрицательные изображения как отмеченные классы. Например, если классификатору апельсина и грейпфрута предложить для сравнения изображение клементина, он может оценить его как апельсин, потому что многие черты клементина похожи на апельсины. Если отрицательные изображения имеют такую природу, мы рекомендуем создать один или несколько дополнительных тегов (например, **Другие**) и во время обучения пометить ими отрицательные изображения. Такие действия помогут модели лучше различать эти классы.

## <a name="use-prediction-images-for-further-training"></a>Использование прогнозных изображений для дальнейшего обучения

Когда вы используете или тестируете классификатор изображений, отправляя изображения в конечную точку прогнозирования, служба пользовательского визуального распознавания сохраняет их. Затем их можно использовать для улучшения модели.

1. Чтобы просмотреть отправленные в классификатор изображения, откройте [веб-страницу Пользовательской службы визуального распознавания](https://customvision.ai), перейдите к проекту и выберите вкладку __Predictions__ (Прогнозы). Представление по умолчанию содержит изображения из текущей итерации. Раскрывающееся меню __Iteration__ (Итерация) позволяет перейти к изображениям, переданным в предыдущих итерациях.

    ![Снимок экрана: вкладка "Predictions" (Прогнозы) с изображениями в представлении](./media/getting-started-improving-your-classifier/predictions.png)

2. Наведите указатель мыши на изображение, чтобы увидеть спрогнозированные классификатором теги. Изображения сортируются таким образом, что сверху указываются те из них, которые могут эффективнее улучшить классификатор. Чтобы использовать другой метод сортировки, выберите соответствующий параметр в разделе __Sort__ (Сортировка). 

    Чтобы добавить изображение в существующий обучающий набор данных, выберите изображение, укажите правильные теги и нажмите кнопку __Save and close__ (Сохранить и закрыть). Выбранное изображение будет удалено из списка __Predictions__ (Прогнозы) и добавлено в набор обучающих изображений. Теперь его можно просмотреть на вкладке __Training Images__ (Изображения для обучения).

    ![Изображение страницы для управления тегами](./media/getting-started-improving-your-classifier/tag.png)

3. Нажмите кнопку __Train__ (Обучение), чтобы переобучить классификатор.

## <a name="visually-inspect-predictions"></a>Визуальная проверка прогнозов

Чтобы просмотреть прогнозы изображений, перейдите на вкладку __Training Images__ (Обучающие изображения), выберите предыдущую итерацию обучения в раскрывающемся меню **Iteration** (Итерация) и установите флажок для одного или нескольких тегов в разделе **Tags** (Теги). Теперь представление должно отобразить красные рамки вокруг каждого изображения, для которого модели не удалось правильно спрогнозировать заданный тег.

![Изображение журнала итераций](./media/getting-started-improving-your-classifier/iteration.png)

В некоторых случаях визуальная проверка позволяет заметить в этих ошибках закономерность и исправить ее, добавив дополнительные обучающие данные или изменив существующие данные. Например, классификатор яблок и лаймов может неправильно отметить все зеленые яблоки и обозначить их как лаймы. Чтобы устранить эту проблему, следует добавить и применить обучающие данные с отмеченными тегом изображениями зеленых яблок.

## <a name="next-steps"></a>Дальнейшие действия

В этом руководстве вы изучили несколько методик, позволяющих повысить точность модели классификации изображений. Далее вы можете узнать, как программно тестировать изображения, отправляя их в API прогнозирования.

> [!div class="nextstepaction"]
> [Использование API-интерфейса прогнозирования](use-prediction-api.md)
