---
title: Руководство по Создание веб-страницы пользовательского поиска в службе "Пользовательский поиск Bing"
titleSuffix: Azure Cognitive Services
description: Узнайте, как настроить экземпляр Пользовательского поиска Bing и интегрировать его в веб-страницу.
services: cognitive-services
author: aahill
manager: nitinme
ms.service: cognitive-services
ms.subservice: bing-custom-search
ms.topic: tutorial
ms.date: 12/09/2019
ms.author: aahi
ms.openlocfilehash: 5a4d797fecca8e040a6e22bf59a5776b1ffff80f
ms.sourcegitcommit: 5ab4f7a81d04a58f235071240718dfae3f1b370b
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/10/2019
ms.locfileid: "74977205"
---
# <a name="tutorial-build-a-custom-search-web-page"></a>Руководство по Создание веб-страницы пользовательского поиска

Служба "Пользовательский поиск Bing" позволяет создавать специально адаптированные интерфейсы поиска по темам, которые действительно важны для вас. Например, если веб-сайт боевых искусств предоставляет функцию поиска, то вы можете указать домены, веб-сайты и веб-страницы, по которым Bing будет выполнять поиск. Пользователи увидят результаты поиска, адаптированные к интересующей их информации, вместо того, чтобы пролистывать страницы результатов поиска с несоответствующим содержимым. 

В этой руководстве описано, как настроить экземпляр пользовательского поиска и интегрировать его в новую веб-страницу.

Здесь рассматриваются такие задачи:

> [!div class="checklist"]
> - Создание экземпляра пользовательского поиска.
> - Добавление активных записей.
> - Добавление заблокированных записей.
> - Добавление закрепленных записей.
> - Интеграция экземпляра пользовательского поиска в веб-страницу

## <a name="prerequisites"></a>Предварительные требования

- Чтобы выполнить задания, описанные в этом руководстве, требуется ключ подписки для API пользовательского поиска Bing.  Для получения ключа см. статью [Пробная версия Cognitive Services](https://azure.microsoft.com/try/cognitive-services/?api=bing-custom-search).
- Если вы еще не установили Visual Studio 2017 или более поздней версии, можете скачать и использовать **бесплатный** [выпуск Visual Studio 2019 Community](https://www.visualstudio.com/downloads/).

## <a name="create-a-custom-search-instance"></a>Создание экземпляра пользовательского поиска

Чтобы создать экземпляр службы "Пользовательский поиск Bing", сделайте следующее:

1. Откройте браузер.  
  
2. Перейдите на [портал](https://customsearch.ai) службы пользовательского поиска.  
  
3. Войдите на портал с помощью учетной записи Майкрософт (MSA). Если у вас нет учетной записи MSA, щелкните **Создайте учетную запись Майкрософт**. Если вы впервые используете портал, появится запрос на разрешение доступа к данным. Щелкните **Да**.  
  
4. После входа нажмите кнопку **New custom search** (Создать службу пользовательского поиска). В окне **Create a new custom search instance** (Создание экземпляра пользовательского поиска) введите информативное имя, которое описывает тип содержимого, возвращаемого в результатах поиска. Это имя можно изменить в любое время.  
  
   ![Скриншот поля "Создание нового пользовательского поиска"](../media/newCustomSrch.png)  
  
5. Нажмите кнопку "ОК", укажите URL-адрес и следует ли включать вложенные страницы URL-адреса.  
  
   ![Снимок страницы определения URL-адреса](../media/newCustomSrch1-a.png)  


## <a name="add-active-entries"></a>Добавление активных записей

Чтобы включать результаты с конкретных сайтов или URL-адресов, добавьте их на вкладке **Активные**.

1.  На странице **Конфигурация**  перейдите на вкладку **Активные** и введите URL-адреса одного или нескольких сайтов, которые требуется включить в поиск.

    ![Снимок активной вкладки "Редактор определений"](../media/customSrchEditor.png)

2.  Чтобы проверить, возвращает ли экземпляр результаты, введите запрос в области предварительного просмотра в правой части экрана. Bing возвращает результаты только с общедоступных индексированных сайтов.

## <a name="add-blocked-entries"></a>Добавление заблокированных записей

Чтобы исключать результаты с конкретных сайтов или URL-адресов, добавьте их на вкладке **Заблокированные**.

1. На странице **Конфигурация** перейдите на вкладку **Заблокированные** и введите URL-адреса одного или нескольких сайтов, которые требуется исключать из поиска.

    ![Снимок экрана: заблокированная вкладка редактора определений](../media/blockedCustomSrch.png)


2. Чтобы проверить, не возвращает ли экземпляр результаты из заблокированных сайтов, введите запрос в области предварительного просмотра в правой части экрана. 

## <a name="add-pinned-entries"></a>Добавление закрепленных записей

Чтобы закрепить конкретную веб-страницу в верхней части результатов поиска, добавьте ее и термин запроса на вкладке **Закрепленные**. Вкладка **Закрепленные** содержит список пар веб-страницы и термина запроса, указывающие веб-страницу, которая отображается в качестве первого результата определенного запроса. Веб-страница закрепляется только в том случае, если строка запроса пользователя совпадает со строкой запроса ПИН-кода на основе условия соответствия ПИН-кода. В результатах поиска будут отображаться только индексированные веб-страницы. Дополнительные сведения см. в статье [Настройка режима пользовательского поиска](../define-your-custom-view.md#pin-slices-to-the-top-of-search-results).

1. На странице **Конфигурация** перейдите на вкладку **Закрепленные**, а затем введите термин запроса и веб-страницу, которая должна возвращаться как первый результат.  
  
2. По умолчанию строка запроса пользователя должна точно соответствовать вашему ПИН-коду строки запроса для Bing для возврата веб-страницы как лучшего результата. Чтобы изменить условие соответствия, отредактируйте ПИН-код (щелкните по значку карандаша), щелкните точное совпадение в столбце **Условие соответствия запросу** и выберите условие соответствия, подходящее под ваше приложение.  
  
    ![Снимок экрана прикрепленной вкладки редактора определений](../media/pinnedCustomSrch.png)
  
3. Чтобы проверить, возвращает ли экземпляр указанную веб-страницу как первый результат, введите запрос в области предварительного просмотра в правой части экрана.

## <a name="configure-hosted-ui"></a>Настройка размещенного пользовательского интерфейса

Служба "Пользовательский поиск" предоставляет размещенный пользовательский интерфейс, который обрабатывает ответ JSON экземпляра пользовательского поиска. Чтобы определить пользовательский интерфейс, сделайте следующее:

1. Перейдите на вкладку **Hosted UI** (Размещенный пользовательский интерфейс).  
  
2. Выберите макет.  
  
   ![Снимок экрана выбора шага макета размещенного пользовательского интерфейса](./media/custom-search-hosted-ui-select-layout.png)  
  
3. Выберите цветовую тему.  
  
   ![Снимок экрана выбора цветовой темы размещенного пользовательского интерфейса](./media/custom-search-hosted-ui-select-color-theme.png)  

   Если вам нужно точно настроить цветовую тему, чтобы лучше интегрироваться с веб-приложением, нажмите кнопку **Настройка темы**. Не все конфигурации цвета применяются ко всем темам макета. Чтобы изменить цвет, введите значение цвета RGB HEX (например, #366eb8) в соответствующем текстовом поле. Или нажмите кнопку цвета и оттенок, который вам подходит. При выборе цвета всегда думайте о специальных возможностях.
  
   ![Снимок экрана настройки цветовой темы размещенного пользовательского интерфейса](./media/custom-search-hosted-ui-customize-color-theme.png)  

  
4. Укажите дополнительные параметры конфигурации.  
  
   ![Снимок экрана: дополнительные параметры конфигурации на вкладке Hosted UI (размещенный пользовательский интерфейс)](./media/custom-search-hosted-ui-additional-configurations.png)  
  
   Чтобы получить дополнительные конфигурации, щелкните **Показать дополнительные конфигурации**. Это добавляет конфигурации, такие как *цель ссылки* в веб-параметры поиска, *Включить фильтры* в параметры изображений и видеофайлов, и *заполнитель текста в поле поиска* в параметры "Разное".

   ![Снимок экрана: продвинутые параметры конфигурации на вкладке Hosted UI (размещенный пользовательский интерфейс)](./media/custom-search-hosted-ui-advanced-configurations.png)  
  
5. Выберите ключи подписки из раскрывающихся списков. Или можно ввести ключ подписки вручную. Сведения о получении ключей см. в разделе [Пробная версия Cognitive Services](https://azure.microsoft.com/try/cognitive-services/?api=bing-custom-search-api).  
  
   ![Снимок экрана: дополнительные параметры конфигурации на вкладке Hosted UI (размещенный пользовательский интерфейс)](./media/custom-search-hosted-ui-subscription-key.png)

[!INCLUDE [publish or revert](../includes/publish-revert.md)]

<a name="consuminghostedui"></a>
## <a name="consuming-hosted-ui"></a>Использование размещенного пользовательского интерфейса

Размещенный пользовательский интерфейс можно использовать двумя способами.  

- Вариант 1. Интеграция предоставленного фрагмента кода JavaScript в приложение.
- Вариант 2. Использование предоставленной конечной точки HTML.

В оставшейся части этого руководства описан **вариант с использованием фрагмента кода JavaScript**.  

## <a name="set-up-your-visual-studio-solution"></a>Настройка решения Visual Studio

1. Откройте **Visual Studio** у себя на компьютере.  
  
2. В меню **Файл** выберите пункт **Создать**, а затем — **Проект**.  
  
3. В окне **Новый проект** выберите **Visual C# / Интернет / Веб-приложение ASP.NET Core**, введите имя проекта, а затем нажмите кнопку **ОК**.  
  
   ![Снимок экрана: окно "Новый проект"](./media/custom-search-new-project.png)  
  
4. В окне **Веб-приложение ASP.NET Core** выберите **Веб-приложение** и нажмите кнопку **ОК**.  
  
   ![Снимок экрана: окно "Новый проект"](./media/custom-search-new-webapp.png)  

## <a name="edit-indexcshtml"></a>Изменение файла Index.cshtml

1. В **обозревателе решений** разверните узел **Страницы** и дважды щелкните файл **Index.cshtml**, чтобы открыть его.  
  
   ![Снимок экрана: обозреватель решений с развернутым узлом "Страницы" и выбранным файлом Index.cshtml](./media/custom-search-visual-studio-webapp-solution-explorer-index.png)  
  
2. В файле Index.cshtml удалите все, начиная со строки 7.  
  
   ```razor
   @page
   @model IndexModel
   @{
      ViewData["Title"] = "Home page";
   }    
   ```  
  
3. Добавьте элемент разрыва строки и элемент div в качестве контейнера.  
  
   ```html
   @page
   @model IndexModel
   @{
      ViewData["Title"] = "Home page";
   }
   <br />
   <div id="customSearch"></div>
   ```  
  
4. На вкладке**Hosted UI** (Размещенный пользовательский интерфейс) прокрутите к разделу **Consuming the UI** (Использование пользовательского интерфейса). Нажмите кнопку *Endpoints* (Конечные точки) для доступа к фрагменту кода JavaScript. Можно также получить фрагмент кода, нажав кнопку **Production** (Производство), а затем вкладку **Hosted UI** (Размещенный пользовательский интерфейс).
  
   <!-- Get new screenshot after prod gets new bits
   ![Screenshot of the Hosted UI save button](./media/custom-search-hosted-ui-consuming-ui.png)  
   -->
  
5. Вставьте элемент скрипта в добавленный контейнер.  
  
   ``` html
   @page
   @model IndexModel
   @{
      ViewData["Title"] = "Home page";
   }
   <br />
   <div id="customSearch">
      <script type="text/javascript" 
          id="bcs_js_snippet"
          src="https://ui.customsearch.ai /api/ux/rendering-js?customConfig=<YOUR-CUSTOM-CONFIG-ID>&market=en-US&safeSearch=Moderate&version=latest&q=">
      </script>
   </div>
   ```  
  
6. В **обозревателе решений** щелкните правой кнопкой мыши папку **wwwroot** и нажмите кнопку **Просмотреть в браузере**.  
  
   ![Снимок экрана: кнопка "Просмотреть в браузере" в контекстном меню wwwroot обозревателя решений](./media/custom-search-webapp-view-in-browser.png)  

Новая веб-страница пользовательского поиска должна выглядеть следующим образом:

![Снимок экрана веб-страницы пользовательского поиска](./media/custom-search-webapp-browse-index.png)

При поиске возвращаются примерно такие результаты:

![Снимок экрана: результаты пользовательского поиска](./media/custom-search-webapp-results.png)

## <a name="next-steps"></a>Дополнительная информация

> [!div class="nextstepaction"]
> [Вызов конечной точки службы "Пользовательский поиск Bing" (C#)](../call-endpoint-csharp.md)
