---
title: Оценка влияния новой политики Azure
description: Изучите процесс, который необходимо выполнить при внедрении новой политики в среду Azure.
ms.date: 09/23/2019
ms.topic: conceptual
ms.openlocfilehash: 6c1a3ea764aedec7de5eab1f564176eaafead70b
ms.sourcegitcommit: 39da2d9675c3a2ac54ddc164da4568cf341ddecf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/12/2019
ms.locfileid: "73959829"
---
# <a name="evaluate-the-impact-of-a-new-azure-policy"></a>Оценка влияния новой политики Azure

Политика Azure — это мощный инструмент для управления ресурсами Azure в соответствии с бизнес-стандартами и обеспечения соответствия требованиям. Когда люди, процессы или конвейеры создают или обновляют ресурсы, политика Azure проверяет запрос. Когда воздействие определения политики — [append](./effects.md#deny) или [DeployIfNotExists](./effects.md#deployifnotexists), политика изменяет запрос или добавляет к нему. Когда воздействие определения политики — [Audit](./effects.md#audit) или [помощью параметров auditifnotexists](./effects.md#auditifnotexists), политика вызывает создание записи журнала действий. А когда воздействие определения политики [отклоняется](./effects.md#deny), политика останавливает создание или изменение запроса.

Эти результаты будут в точности совпадать, если известно, что политика определена правильно. Однако важно проверить, что новая политика работает так, как задумано, прежде чем разрешить ей изменять или блокировать работу. Проверка должна обеспечивать, чтобы только требуемые ресурсы были определены как несовместимые, а соответствующие ресурсы не были ошибочно включены (в результатах они называются _ложными_).

Для проверки нового определения политики рекомендуется выполнить следующие действия.

- Жестко Определите политику
- Аудит существующих ресурсов
- Аудит новых или обновленных запросов ресурсов
- Развертывание политики в ресурсах
- Непрерывный мониторинг

## <a name="tightly-define-your-policy"></a>Жестко Определите политику

Важно понимать, как бизнес-политика реализуется в качестве определения политики и связи ресурсов Azure с другими службами Azure. Этот шаг выполняется путем [определения требований](../tutorials/create-custom-policy-definition.md#identify-requirements) и [определения свойств ресурсов](../tutorials/create-custom-policy-definition.md#determine-resource-properties).
Но также важно увидеть, что вы выходите за пределы определения бизнес-политики. Состояние политики, например "все виртуальные машины должны..."? Как насчет других служб Azure, использующих виртуальные машины, например HDInsight или AKS? При определении политики необходимо учитывать, как эта политика влияет на ресурсы, используемые другими службами.

По этой причине определения политик должны быть определенным образом определены и зависят от ресурсов и свойств, которые необходимо проверить на соответствие как можно более строгим.

## <a name="audit-existing-resources"></a>Аудит существующих ресурсов

Прежде чем начать управление новыми или обновленными ресурсами с помощью нового определения политики, лучше понять, как она оценивает ограниченное подмножество существующих ресурсов, например тестовую группу ресурсов. Используйте [режим принудительного применения](./assignment-structure.md#enforcement-mode)
_отключено_ (донотенфорце) для назначения [политики, чтобы](./effects.md) предотвратить создание триггера или запись журнала действий.

Этот шаг дает возможность оценить результаты проверки соответствия для новой политики в существующих ресурсах без влияния на рабочий процесс. Убедитесь, что соответствующие ресурсы не помечены как несовместимые (_ложные положительные_) и что все ресурсы, которые предполагается не соответствовать требованиям, отмечены правильно.
Когда начальное подмножество ресурсов будет проверено ожидаемым образом, медленно разверните вычисление для всех существующих ресурсов.

Оценка существующих ресурсов таким образом также дает возможность исправлять несоответствующие ресурсы до полной реализации новой политики. Эту очистку можно выполнить вручную или с помощью [задачи исправления](../how-to/remediate-resources.md) , если воздействие определения политики — _DeployIfNotExists_.

## <a name="audit-new-or-updated-resources"></a>Аудит новых или обновленных ресурсов

После проверки того, что новое определение политики правильно сообщает о существующих ресурсах, следует рассмотреть влияние политики на создание или обновление ресурсов. Если определение политики поддерживает параметризацию параметров, используйте [Аудит](./effects.md#audit). Эта конфигурация позволяет отслеживать создание и обновление ресурсов, чтобы определить, активирует ли новое определение политики запись в журнале действий Azure для ресурса, который не соответствует требованиям, не влияя на существующие рабочие или запросы.

Рекомендуется как обновлять, так и создавать новые ресурсы, соответствующие определению политики, чтобы убедиться в том, что в случае ожидания активируется правильный результат _аудита_ . Lookout для запросов ресурсов, которые не должны затронутся новым определением политики, запускающим эффект _аудита_ .
Эти затронутые ресурсы являются еще одним примером _ложных срабатываний_ и должны быть исправлены в определении политики до полной реализации.

В случае изменения определения политики на этом этапе тестирования рекомендуется начать процесс проверки с аудитом существующих ресурсов. Изменение определения политики на _ложное срабатывание_ новых или обновленных ресурсов, вероятно, также повлияет на существующие ресурсы.

## <a name="deploy-your-policy-to-resources"></a>Развертывание политики в ресурсах

После завершения проверки нового определения политики с помощью существующих ресурсов и новых или обновленных запросов ресурсов начинается процесс реализации политики. Рекомендуется сначала создать назначение политики для нового определения политики в подмножестве всех ресурсов, например в группе ресурсов. После проверки первоначального развертывания расширьте область применения политики на более широкие и более широкие уровни, такие как подписки и группы управления. Это расширение достигается путем удаления назначения и создания нового в целевых областях до тех пор, пока оно не будет назначено всей области ресурсов, предназначенных для нового определения политики.

Если при разрешении обнаружены ресурсы, которые должны быть исключены из нового определения политики, их можно устранить одним из следующих способов.

- Измените определение политики, чтобы оно было более явным, чтобы снизить непреднамеренное воздействие.
- Изменение области назначения политики (путем удаления и создания нового назначения)
- Добавление группы ресурсов в список исключений для назначения политики

Все изменения в области (уровень или исключения) должны быть полностью проверены и взаимосвязаны с вашими организациями по обеспечению безопасности и соответствия требованиям, чтобы гарантировать отсутствие пробелов в покрытии.

## <a name="monitor-your-policy-and-compliance"></a>Мониторинг политики и соответствия требованиям

Реализация и назначение определения политики не является последним шагом. Непрерывно Контролируйте уровень [соответствия требованиям](../how-to/get-compliance-data.md) для нового определения политики и настраиваете соответствующие [Azure Monitor оповещения и уведомления](../../../azure-monitor/platform/alerts-overview.md) о том, когда обнаруживаются несоответствующие устройства. Также рекомендуется оценить определение политики и связанные назначения по расписанию, чтобы убедиться, что определение политики соответствует требованиям бизнес-политики и соответствия требованиям. Политики должны быть удалены, если они больше не нужны. Политикам также требуется обновлять время по мере развития базовых ресурсов Azure и добавлять новые свойства и возможности.

## <a name="next-steps"></a>Дополнительная информация

- Сведения о [структуре определения политики](./definition-structure.md).
- Сведения о [структуре назначений политик](./assignment-structure.md).
- Узнайте, как [программно создавать политики](../how-to/programmatically-create.md).
- Узнайте, как [получить данные о соответствии](../how-to/getting-compliance-data.md).
- Узнайте, как [исправлять несоответствующие ресурсы](../how-to/remediate-resources.md).
- Дополнительные сведения о группе управления см. в статье [Упорядочивание ресурсов с помощью групп управления Azure](../../management-groups/overview.md).