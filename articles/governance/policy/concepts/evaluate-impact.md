---
title: Оценка влияния новой политики Azure
description: Понимание процесса, за которой следует следовать при введении нового определения политики в среду Azure.
ms.date: 09/23/2019
ms.topic: conceptual
ms.openlocfilehash: 562fa2378356ddc1eac48b6ea5c160ebf655d525
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/27/2020
ms.locfileid: "74463525"
---
# <a name="evaluate-the-impact-of-a-new-azure-policy"></a>Оценка влияния новой политики Azure

Политика Azure — это мощный инструмент для управления ресурсами Azure в соответствии с бизнес-стандартами и удовлетворения потребностей в соответствии с требованиями. Когда пользователи, процессы или конвейеры создают или обновляют ресурсы, Azure Policy проверяет запрос. Когда эффект определения политики [является Приложением](./effects.md#deny) или [DeployIfNotExists,](./effects.md#deployifnotexists)политика изменяет запрос или добавляет к нему. Когда эффект определения политики — [аудит](./effects.md#audit) или [аудитIfNotExists,](./effects.md#auditifnotexists)политика создает запись журнала activity. А когда эффект определения политики [— Отрицание,](./effects.md#deny)политика останавливает создание или изменение запроса.

Эти результаты точно так же, как хотелось бы, когда вы знаете, что политика определяется правильно. Однако важно проверить новые работы политики, как предполагалось, прежде чем позволить ей изменять или блокировать работу. Проверка должна гарантировать, что только предполагаемые ресурсы считаются несовместимыми, а не соответствующие ресурсы неправильно включены (известные как _ложноположительный)_ в результаты.

Рекомендуемый подход к проверке нового определения политики заключается в следующих следующих шагах:

- Плотно определить вашу политику
- Аудит существующих ресурсов
- Аудит новых или обновленных запросов ресурсов
- Развертывание политики в ресурсах
- Непрерывный мониторинг

## <a name="tightly-define-your-policy"></a>Плотно определить вашу политику

Важно понимать, как бизнес-политика реализуется как определение политики и связь ресурсов Azure с другими службами Azure. Этот шаг достигается путем [определения требований](../tutorials/create-custom-policy-definition.md#identify-requirements) и [определения свойств ресурсов.](../tutorials/create-custom-policy-definition.md#determine-resource-properties)
Но также важно выйти за рамки узкого определения вашей бизнес-политики. В состоянии вашей политики, например, "Все виртуальные машины должны ..."? Как насчет других служб Azure, которые используют vMs, таких как HDInsight или AKS? При определении политики мы должны учитывать, как эта политика влияет на ресурсы, используемые другими службами.

По этой причине определения политики должны быть максимально четко определены и сфокусированы на ресурсах и свойствах, необходимых для оценки соответствия требованиям.

## <a name="audit-existing-resources"></a>Аудит существующих ресурсов

Прежде чем управлять новыми или обновленными ресурсами с новым определением политики, лучше всего посмотреть, как он оценивает ограниченное подмножество существующих ресурсов, таких как группа ресурсов тестирования. Используйте [режим](./assignment-structure.md#enforcement-mode)
_принудительного исполнения Отключенный_ (DoNotEnforce) в назначении политики, чтобы предотвратить [запуск записей](./effects.md) в журнале активности или действия.

Этот шаг дает возможность оценить результаты соответствия новой политики существующим ресурсам без влияния на рабочий поток. Убедитесь, что никакие совместимые ресурсы не помечаются как несовместимые _(ложноположительные)_ и что все ресурсы, которые вы ожидаете быть несовместимыми, помечены правильно.
После того, как исходное подмножество ресурсов проверяется, как ожидалось, медленно расширяйте оценку на все существующие ресурсы.

Оценка имеющихся ресурсов таким образом также дает возможность исправления ресурсов, не соответствующих требованиям, до полного осуществления новой политики. Эта очистка может быть выполнена вручную или с помощью [задачи восстановления,](../how-to/remediate-resources.md) если эффект определения политики _является DeployIfNotExists._

## <a name="audit-new-or-updated-resources"></a>Аудит новых или обновленных ресурсов

После проверки нового определения политики правильно ежеотчетно о существующих ресурсах пришло время взглянуть на влияние политики при создании или обновлении ресурсов. Если определение политики поддерживает параметры эффекта, используйте [Аудит](./effects.md#audit). Эта конфигурация позволяет отслеживать создание и обновление ресурсов, чтобы увидеть, если новое определение политики запускает запись в журнале деятельности Azure для ресурса, который не соответствует требованиям, не влияя на существующую работу или запросы.

Рекомендуется как обновлять, так и создавать новые ресурсы, которые соответствуют определению политики, чтобы увидеть, что эффект _аудита_ правильно срабатывает, когда ожидается. Будьте в поиске запросов ресурсов, на которые не должно влиять новое определение политики, вызываевое эффект _аудита._
Эти затронутые ресурсы являются еще одним примером _ложных срабатываний_ и должны быть зафиксированы в определении политики до полного осуществления.

В случае изменения определения политики на данном этапе тестирования рекомендуется начать процесс проверки с аудита существующих ресурсов. Изменение определения политики в отношении _ложного срабатывания_ новых или обновленных ресурсов, вероятно, также окажет воздействие на существующие ресурсы.

## <a name="deploy-your-policy-to-resources"></a>Развертывание политики в ресурсах

После завершения проверки нового определения политики как с существующими ресурсами, так и с новыми или обновленными запросами ресурсов, вы начинаете процесс реализации политики. Рекомендуется сначала создать назначение политики для нового определения политики для подмножества всех ресурсов, таких как группа ресурсов. После проверки первоначального развертывания расширьте сферу действия политики на более широкие и более широкие уровни, такие как подписки и группы управления. Это расширение достигается за счет удаления назначения и создания нового в целевых областях до тех пор, пока оно не будет выделено в полном объеме ресурсов, которые должны быть охвачены новым определением политики.

Во время развертывания, если находятся ресурсы, которые должны быть исключены из нового определения политики, рассмотреть их одним из следующих способов:

- Обновление определения политики, чтобы быть более четким, чтобы уменьшить непреднамеренное воздействие
- Изменение сферы назначения политики (путем удаления и создания нового назначения)
- Добавление группы ресурсов в список исключений для назначения политики

Любые изменения в области (уровня или исключения) должны быть полностью проверены и доведены до сведения организаций по обеспечению безопасности и соответствия требованиям, чтобы убедиться, что нет пробелов в охвате.

## <a name="monitor-your-policy-and-compliance"></a>Мониторинг политики и соответствия требованиям

Реализация и назначение определения политики не является последним шагом. Постоянно отслеживайте уровень [соответствия](../how-to/get-compliance-data.md) ресурсов новому определению политики и настраивайте соответствующие [оповещения и уведомления Azure Monitor](../../../azure-monitor/platform/alerts-overview.md) о том, когда идентифицируются устройства, не соответствующие требованиям. Также рекомендуется оценивать определение политики и связанные с ней назначения на плановой основе для проверки того, что определение политики отвечает потребностям бизнес-политики и соответствия требованиям. Политики должны быть удалены, если это больше не необходимо. Политики также нуждаются в обновлении время от времени по мере развития базовых ресурсов Azure и добавления новых свойств и возможностей.

## <a name="next-steps"></a>Дальнейшие действия

- Узнайте о [структуре определения политики](./definition-structure.md).
- Узнайте о [структуре назначения политики.](./assignment-structure.md)
- Понять, как [программно создавать политики.](../how-to/programmatically-create.md)
- Узнайте, как [получить данные о соответствии.](../how-to/get-compliance-data.md)
- Узнайте, как [исправления несовместимых ресурсов.](../how-to/remediate-resources.md)
- Просмотрите, что представляет собой группа управления с [организацией ресурсов с группами управления Azure.](../../management-groups/overview.md)