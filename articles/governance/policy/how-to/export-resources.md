---
title: Экспорт ресурсов политики Azure
description: Узнайте, как экспортировать ресурсы политики Azure в GitHub, такие как определения политик и назначения политик.
ms.date: 09/30/2020
ms.topic: how-to
ms.custom: devx-track-azurecli, devx-track-azurepowershell
ms.openlocfilehash: 17f0322390cd2cd89ba182a9e3c7c95843cc135e
ms.sourcegitcommit: ffa7a269177ea3c9dcefd1dea18ccb6a87c03b70
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/30/2020
ms.locfileid: "91604434"
---
# <a name="export-azure-policy-resources"></a>Экспорт ресурсов политики Azure

В этой статье содержатся сведения о том, как экспортировать существующие ресурсы политики Azure. Экспорт ресурсов полезен и рекомендуется для резервного копирования, но он также является важным шагом в вашем пути к управлению облаком и рассматривая вашу [политику как код](../concepts/policy-as-code.md). Ресурсы политики Azure можно экспортировать с помощью [портал Azure](#export-with-azure-portal), [Azure CLI](#export-with-azure-cli), [Azure PowerShell](#export-with-azure-powershell)и каждого из поддерживаемых пакетов SDK.

## <a name="export-with-azure-portal"></a>Экспорт с помощью портал Azure

Чтобы экспортировать определение политики из портал Azure, выполните следующие действия.

1. Запустите службу Политика Azure на портале Azure, щелкнув **Все службы**, а затем выполнив поиск и выбрав **Политика**.

1. Выберите **определения** в левой части страницы политика Azure.

1. Используйте кнопку **Экспорт определений** или щелкните многоточие в строке определения политики, а затем выберите **Экспорт определения**.

1. Нажмите кнопку **войти с помощью GitHub** . Если вы еще не прошли проверку подлинности с помощью GitHub, чтобы авторизовать политику Azure для экспорта ресурса, ознакомьтесь с требованиями к [действию GitHub](https://github.com/features/actions) в новом окне, которое открывается, и выберите **авторизовать азурегисубактионс** , чтобы продолжить процесс экспорта. После завершения новое окно автоматически закрывается.

1. На вкладке **основы** задайте следующие параметры, а затем выберите вкладку **политики** или нажмите кнопку **Далее: политики** в нижней части страницы.

   - **Фильтр репозитория**. Задайте для параметра " _Мои репозитории_ ", чтобы просмотреть только репозитории, которые вы владеете, или _все репозитории_ , чтобы увидеть все, кому предоставлен доступ к действию GitHub.
   - **Репозиторий**. Укажите репозиторий, в который вы хотите экспортировать ресурсы политики Azure.
   - **Ветвь**: задайте ветвь в репозитории. Использование ветви, отличной от используемой по умолчанию, — хороший способ проверки обновлений перед дальнейшим слиянием в исходный код.
   - **Каталог**: _папка корневого уровня_ для экспорта ресурсов политики Azure. Вложенные папки в этом каталоге создаются на основе экспортируемых ресурсов.

1. На вкладке **политики** задайте область поиска, нажав кнопку с многоточием и выбрав сочетание групп управления, подписок или групп ресурсов.
   
1. Используйте кнопку **добавить определения политики** , чтобы найти объекты для экспорта. В открывшемся окне выберите каждый объект для экспорта. Фильтрация выбора по полю поиска или типу. Выбрав все объекты для экспорта, нажмите кнопку **Добавить** в нижней части страницы.

1. Для каждого выбранного объекта выберите нужные параметры экспорта, такие как _Определение_ политики или определение _, а также назначение (-ы)_ . Затем выберите вкладку **Просмотр и экспорт** или нажмите кнопку **Далее: Проверка и экспорт** в нижней части страницы.

   > [!NOTE]
   > Если выбран параметр _Определение и назначения_ , то экспортируются только назначения политик в пределах области, заданной фильтром при добавлении определения политики.

1. На вкладке " **Проверка и экспорт** " Проверьте совпадение сведений и нажмите кнопку " **Экспорт** " в нижней части страницы.

1. Проверьте папку репозитория GitHub, ветвь и _корневой уровень_ , чтобы убедиться, что выбранные ресурсы экспортированы в систему управления версиями.

Ресурсы политики Azure экспортируются в следующую структуру в выбранном репозитории GitHub и в _папке корневого уровня_:

```text
|
|- <root level folder>/  ________________ # Root level folder set by Directory property
|  |- policies/  ________________________ # Subfolder for policy objects
|     |- <displayName>_<name>____________ # Subfolder based on policy displayName and name properties
|        |- policy.json _________________ # Policy definition
|        |- assign.<displayName>_<name>__ # Each assignment (if selected) based on displayName and name properties
|
```

## <a name="export-with-azure-cli"></a>Экспорт с помощью Azure CLI

Определения политик Azure, инициативы и назначения можно экспортировать в формате JSON с помощью [Azure CLI](/cli/azure/install-azure-cli). Каждая из этих команд использует параметр **Name** для указания объекта, для которого нужно получить JSON. Свойство **Name** часто представляет собой _идентификатор GUID_ , а не **DisplayName** объекта.

- Определение — [AZ определение политики-демонстрация](/cli/azure/policy/definition#az-policy-definition-show)
- Инициатива- [AZ установка политики-определение](/cli/azure/policy/set-definition#az-policy-set-definition-show)
- Назначение — [AZ Policy назначение политики](/cli/azure/policy/assignment#az-policy-assignment-show)

Ниже приведен пример получения JSON для определения политики с **именем** _виртуалмачинестораже_:

```azurecli-interactive
az policy definition show --name 'VirtualMachineStorage'
```

## <a name="export-with-azure-powershell"></a>Экспорт с помощью Azure PowerShell

Определения политик Azure, инициативы и назначения можно экспортировать в формате JSON с помощью [Azure PowerShell](/powershell/azure/). Каждый из этих командлетов использует параметр **Name** для указания объекта, для которого нужно получить JSON. Свойство **Name** часто представляет собой _идентификатор GUID_ , а не **DisplayName** объекта.

- Определение — [Get-азполицидефинитион](/powershell/module/az.resources/get-azpolicydefinition)
- Инициатива- [Get-азполицисетдефинитион](/powershell/module/az.resources/get-azpolicysetdefinition)
- Назначение — [Get-азполициассигнмент](/powershell/module/az.resources/get-azpolicyassignment)

Ниже приведен пример получения JSON для определения политики с **именем** _виртуалмачинестораже_:

```azurepowershell-interactive
Get-AzPolicyDefinition --Name 'VirtualMachineStorage'
```

## <a name="next-steps"></a>Дальнейшие действия

- Рассмотрите [примеры для службы "Политика Azure"](../samples/index.md).
- Изучите статью о [структуре определения Политики Azure](../concepts/definition-structure.md).
- Изучите [сведения о действии политик](../concepts/effects.md).
- Узнайте о [программном создании политик](programmatically-create.md).
- Узнайте, как [исправлять несоответствующие ресурсы](remediate-resources.md).
- Дополнительные сведения о группе управления см. в статье [Упорядочивание ресурсов с помощью групп управления Azure](../../management-groups/overview.md).
