---
title: Как защитить иерархию ресурсов — система управления Azure
description: Сведения о том, как защитить иерархию ресурсов с помощью параметров иерархии, в том числе с настройкой группы управления по умолчанию.
ms.date: 05/21/2020
ms.topic: conceptual
ms.openlocfilehash: 2f8d3d7ff85552fe18a49137450aefe91d0d02c9
ms.sourcegitcommit: f353fe5acd9698aa31631f38dd32790d889b4dbb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/29/2020
ms.locfileid: "87366778"
---
# <a name="how-to-protect-your-resource-hierarchy"></a>Как защитить иерархию ресурсов

В иерархию ресурсов входят сами ресурсы, группы ресурсов, подписки, группы управления и клиент. Параметры в корневой группе управления, такие как пользовательские роли Azure или назначения политик политики Azure, могут повлиять на каждый ресурс в иерархии ресурсов. Важную роль играет защита иерархии ресурсов от изменений, которые могут отрицательно повлиять на все ресурсы.

Теперь для групп управления предоставляются параметры иерархии, которые позволяют администратору клиента управлять этим поведением. В этой статье рассматриваются все доступные параметры иерархии и способы их настройки.

## <a name="rbac-permissions-for-hierarchy-settings"></a>Разрешения RBAC для параметров иерархии

Для настройки любого из параметров иерархии к корневой группе управления нужно применить следующие две операции RBAC:

- `Microsoft.Management/managementgroups/settings/write`
- `Microsoft.Management/managementgroups/settings/read`

Эти операции позволяют пользователю только считывать и обновлять параметры иерархии. Эти операции не предоставляют иного доступа к иерархии группы управления или к ресурсам в этой иерархии. Обе эти операции доступны в встроенном **администраторе параметров иерархии**ролей Azure.

## <a name="setting---default-management-group"></a>Настройка — группа управления по умолчанию

По умолчанию каждая новая подписка, добавляемая в клиент, назначается членом корневой группы управления. Если корневой группе управления назначены конструкции управления, например назначения политик или управления доступом на основе ролей, они сразу же применяются к новым подпискам. По этой причине многие организации не применяют такие конструкции к корневой группе управления, даже если их целесообразно к ней применить. Также иногда для новых подписок требуется больше ограничений, которые не должны применяться ко всем подпискам. Этот параметр поддерживает оба варианта использования.

Возможность самостоятельно определить группу управления, в которой по умолчанию размещаются новые подписки, позволяет применить к корневой группе управления любые конструкции, которые должны действовать для всей организации, а для новых подписок определить отдельную группу управления с более подходящими назначениями политик и управления доступом на основе ролей.

Чтобы настроить этот параметр, вызовите конечную точку REST API [Параметры иерархии](/rest/api/resources/hierarchysettings). Для этого вызова REST API применяются указанные ниже универсальный код ресурса (URI) и формат текста. Замените здесь заполнитель `{rootMgID}` идентификатором корневой группы управления, а `{defaultGroupID}` — идентификатором группы управления, которая должна стать группой управления по умолчанию.

- Универсальный код ресурса (URI) REST API

  ```http
  PUT https://management.azure.com/providers/Microsoft.Management/managementGroups/{rootMgID}/settings/default?api-version=2020-02-01
  ```

- Текст запроса

  ```json
  {
      "properties": {
          "defaultManagementGroup": "/providers/Microsoft.Management/managementGroups/{defaultGroupID}"
      }
  }
  ```

Чтобы снова сделать корневую группу управления группой управления по умолчанию, повторите вызов той же конечной точки, задав для параметра **defaultManagementGroup** значение `/providers/Microsoft.Management/managementGroups/{rootMgID}`.

## <a name="setting---require-authorization"></a>Настройка — обязательная авторизация

По умолчанию любой пользователь может создавать в клиенте новые группы управления. Администраторы клиента могут ограничить эти разрешения определенным кругом пользователей, чтобы поддерживать согласованность и единообразие в иерархии групп управления. Если этот параметр включен, для создания новых дочерних групп управления пользователю требуется операция `Microsoft.Management/managementGroups/write` в корневой группе управления.

Чтобы настроить этот параметр, вызовите конечную точку REST API [Параметры иерархии](/rest/api/resources/hierarchysettings). Для этого вызова REST API применяются указанные ниже универсальный код ресурса (URI) и формат текста. Этот параметр является _логическим_, поэтому укажите значение **true** либо **false**. Значение **true** включает этот метод защиты для иерархии групп управления.

- Универсальный код ресурса (URI) REST API

  ```http
  PUT https://management.azure.com/providers/Microsoft.Management/managementGroups/{rootMgID}/settings/default?api-version=2020-02-01
  ```

- Текст запроса

  ```json
  {
      "properties": {
          "requireAuthorizationForGroupCreation": true
      }
  }
  ```

Чтобы отключить этот параметр, используйте ту же конечную точку и задайте для параметра **requireAuthorizationForGroupCreation** значение **false**.

## <a name="next-steps"></a>Дальнейшие действия

Дополнительные сведения о группах управления:

- [Создание групп управления для организации ресурсов Azure](../create.md)
- [Изменение, удаление групп управления и управление ими](../manage.md)
