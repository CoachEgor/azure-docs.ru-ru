---
title: О репозитории и образы в реестре контейнеров Azure
description: Введение в основные понятия реестров контейнеров Azure, репозитории и образы контейнеров.
services: container-registry
author: dlepow
ms.service: container-registry
ms.topic: article
ms.date: 07/01/2019
ms.author: danlep
ms.openlocfilehash: a14f0a2a86c5e4922fcddf3c92d48c6dfb1497a3
ms.sourcegitcommit: 66237bcd9b08359a6cce8d671f846b0c93ee6a82
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/11/2019
ms.locfileid: "67800332"
---
# <a name="about-registries-repositories-and-images"></a>О реестрах, репозитории и изображений

В этой статье ключевые понятия реестры контейнеров, репозитории и образы контейнеров и связанные артефакты. 

## <a name="registry"></a>Реестр

*Реестр* контейнера — служба, которая хранит и распределяет образы контейнеров. Центр docker — реестр открытый контейнер, который поддерживает по с открытым кодом и служит в качестве общего каталога изображений. Реестр контейнеров Azure предоставляет пользователям с непосредственным управлением свои образы, с помощью встроенной проверки подлинности, [георепликации](container-registry-geo-replication.md) поддержка глобального распределения и надежности для недалеко от развертываний, [ Конфигурация виртуальной сети и брандмауэра](container-registry-vnet.md), [тег блокировки](container-registry-image-lock.md), и многие другие улучшенные функции. 

Помимо образов контейнеров Docker, реестр контейнеров Azure поддерживают связанные с [содержимого артефактов](container-registry-image-formats.md) включая форматы изображений инициативу Open контейнера (OCI).

## <a name="content-addressable-elements-of-an-artifact"></a>Элементы содержимого адресуемый артефакта

Адрес артефакта в реестр контейнеров Azure включает в себя следующие элементы. 

```
[loginUrl]/[namespace]/[artifact:][tag]
```

* **loginUrl** -полное имя узла реестра. Узел реестра в реестр контейнеров Azure находится в формате *myregistry*. azurecr.io (прописными буквами). При использовании Docker или других клиентских средствах по запросу или принудительная артефакты в реестр контейнеров Azure, необходимо указать loginUrl. 
* **пространство имен** - разделением косыми чертами логическое группирование связанных образов или артефактов — например, для рабочей группы или приложения
* **артефакт** -имя репозитория для конкретного изображения или артефакта
* **тег** -определенную версию изображения или сохранены в хранилище артефактов


Например полное имя образа в реестр контейнеров Azure может выглядеть:

```
myregistry.azurecr.io/marketing/campaign10-18/email-sender:v2
```

Дополнительные сведения об этих элементах см.

## <a name="repository-name"></a>Имя репозитория

Управление реестры контейнеров *репозиториев*, коллекции образов контейнеров или другие артефакты с тем же именем, но разные теги. Например, следующие три образа находятся в репозитории acr-helloworld.

```
acr-helloworld:latest
acr-helloworld:v1
acr-helloworld:v2
```

Имена репозиториев также могут включать [пространство имен](container-registry-best-practices.md#repository-namespaces). Пространства имен, чтобы разрешить для группирования образов с использованием имен прямой разделением косыми чертами репозитория, например:

```
marketing/campaign10-18/web:v2
marketing/campaign10-18/api:v3
marketing/campaign10-18/email-sender:v2
product-returns/web-submission:20180604
product-returns/legacy-integrator:20180715
```

## <a name="image"></a>Изображение

Образ контейнера или других артефактов в реестре связан один или несколько тегов, имеет один или несколько слоев и определяется в манифесте. Понимание того, как эти компоненты связаны друг с другом поможет вам эффективно управлять в реестр.

### <a name="tag"></a>Тег

*Тега* для изображения или других артефактов, определяет его версия. Одного артефакта в репозиторий можно назначить один или несколько тегов, а также может быть «неразмеченные». То есть можно удалить все теги из образа, пока данных изображения (его слоев) остаются в реестре.

Репозиторий (или репозиторий и пространство имен) вместе с тегом определяют имя образа. Образ можно отправлять и получать. Для этого в операции передачи или получения необходимо указать его имя.

Как пометить образы контейнеров руководствоваться ваших сценариев, разработка и развертывание их. Например теги стабильной рекомендуются для поддержании базовые образы и уникальный теги для развертывания образов. Дополнительные сведения см. в разделе [рекомендации для пометки и управление версиями образов контейнеров](container-registry-image-tag-version.md).

### <a name="layer"></a>Слой

Образы контейнеров состоят из одного или нескольких *слои*, каждое из которых соответствует строку в файл Dockerfile, который определяет изображение. Образы в реестре используют слои совместно, что позволяет увеличить эффективность хранилища. Например, несколько образов, которые находятся в разных репозиториях, могут совместно использовать базовый слой Alpine Linux, но только одна копия из этого слоя может хранится в реестре.

Совместное использование слоя также оптимизирует распределение слоев для узлов с несколькими образами, совместно использующих общие слои. Например, если образ уже находится в узле, который включает в себя уровень Alpine Linux в качестве основы, последующее притяжение другого образа, ссылающегося на один и тот же слой, не переносит его слой на узел. Вместо этого он ссылается на слой, который уже существует на узле.

Для обеспечения безопасной изоляции и защиты от потенциальных манипуляции слоя, слои не являются общими для реестров.

### <a name="manifest"></a>Manifest

Каждый образ контейнера или артефакта, отправленных в реестр контейнеров с связан *манифеста*. Манифест создается реестром во время отправки образа, уникально идентифицирует образ и указывает его слой. Вы можете вывести список манифестов для репозитория с помощью команды Azure CLI [acr репозитория az show манифесты][az-acr-repository-show-manifests]:

```azurecli
az acr repository show-manifests --name <acrName> --repository <repositoryName>
```

Например список манифесте формирует дайджест для репозитория «acr-helloworld»:

```console
$ az acr repository show-manifests --name myregistry --repository acr-helloworld
[
  {
    "digest": "sha256:0a2e01852872580b2c2fea9380ff8d7b637d3928783c55beb3f21a6e58d5d108",
    "tags": [
      "latest",
      "v3"
    ],
    "timestamp": "2018-07-12T15:52:00.2075864Z"
  },
  {
    "digest": "sha256:3168a21b98836dda7eb7a846b3d735286e09a32b0aa2401773da518e7eba3b57",
    "tags": [
      "v2"
    ],
    "timestamp": "2018-07-12T15:50:53.5372468Z"
  },
  {
    "digest": "sha256:7ca0e0ae50c95155dbb0e380f37d7471e98d2232ed9e31eece9f9fb9078f2728",
    "tags": [
      "v1"
    ],
    "timestamp": "2018-07-11T21:38:35.9170967Z"
  }
]
```

### <a name="manifest-digest"></a>Дайджест манифеста

Манифесты идентифицируются с помощью уникального хэша SHA-256 или *дайджеста манифеста*. Каждого изображения или артефакта--ли тегами или нет — определяется по его хэш-кода. Значение дайджеста уникально, даже если данные слоя образа идентичны данным другого образа. Данный механизм позволяет многократно отправлять образы с идентичными тегами в реестр. Например, можно многократно отправлять `myimage:latest` в реестр, при этом не получая сообщений об ошибке. Это происходит из за того, что каждый образ идентифицируется по уникальному дайджесту.

Чтобы извлечь образ из реестра, необходимо указать его дайджест в операции передачи. Некоторые системы можно настроить на извлечения с помощью дайджеста, так как он гарантирует, что будет извлечена запрашиваемая версия образа. Операция будет выполнена, даже если образы, которые были идентично помечены, впоследствии будут перенесены в реестр.

Например извлечь изображение из репозитория «acr-helloworld», манифеста хэш-кода:

```console
$ docker pull myregistry.azurecr.io/acr-helloworld@sha256:0a2e01852872580b2c2fea9380ff8d7b637d3928783c55beb3f21a6e58d5d108
```

> [!IMPORTANT]
> Если многократно отправлять измененные образы с идентичными тегами, можно создать потерянные образы, которые остались без тегов, но все еще потребляют пространство реестра. Образы без тегов не отображаются в Azure CLI или на портале Azure при просмотре списка или образов по тегу. Тем не менее их слои по-прежнему существуют и занимают место в реестре. Сведения об освобождении пространство, используемое без тегов изображений, см. в разделе [удалить образы контейнеров в реестре контейнеров Azure](container-registry-delete.md).


## <a name="next-steps"></a>Следующие шаги

Дополнительные сведения о [хранилище изображений](container-registry-storage.md) и [поддерживаемые форматы содержимого](container-registry-image-formats.md) в реестре контейнеров Azure.

<!-- LINKS - Internal -->
[az-acr-repository-show-manifests]: /cli/azure/acr/repository#az-acr-repository-show-manifests


