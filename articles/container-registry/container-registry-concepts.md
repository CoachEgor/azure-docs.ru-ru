---
title: Сведения о репозиториях и образах в реестре контейнеров Azure
description: Введение в ключевые понятия реестра контейнеров Azure, репозиториев и образов контейнеров.
services: container-registry
author: dlepow
ms.service: container-registry
ms.topic: article
ms.date: 09/10/2019
ms.author: danlep
ms.openlocfilehash: 9a3d4a7d9c3fd4a0465d4e780024559a71372d9d
ms.sourcegitcommit: 29880cf2e4ba9e441f7334c67c7e6a994df21cfe
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/26/2019
ms.locfileid: "71300205"
---
# <a name="about-registries-repositories-and-images"></a>Сведения о реестрах, репозиториях и образах

В этой статье приводятся основные понятия реестра контейнеров, репозиториев, образов контейнеров и связанных артефактов. 

## <a name="registry"></a>Реестр

*Реестр* контейнера — служба, которая хранит и распределяет образы контейнеров. DOCKER Hub — это общедоступный реестр контейнеров, который поддерживает сообщество с открытым исходным кодом и служит общим каталогом образов. Реестр контейнеров Azure предоставляет пользователям возможность прямого управления своими образами с помощью встроенной проверки подлинности, [георепликации](container-registry-geo-replication.md) , поддерживающей глобальное распределение и надежность для развертывания по сети, [виртуальной сети и брандмауэра. Конфигурация](container-registry-vnet.md), [Блокировка тегов](container-registry-image-lock.md)и многие другие расширенные функции. 

В дополнение к образам контейнеров DOCKER, реестр контейнеров Azure поддерживает связанные [артефакты содержимого](container-registry-image-formats.md) , включая форматы образов для инициативы Open Container (OCI).

## <a name="content-addressable-elements-of-an-artifact"></a>Сведения об адресных элементах артефакта

Адрес артефакта в реестре контейнеров Azure включает следующие элементы. 

```
[loginUrl]/[namespace]/[artifact:][tag]
```

* **логинурл** — полное имя узла реестра. Узел реестра в реестре контейнеров Azure имеет формат *myregistry*. azurecr.IO (все строчные буквы). При использовании DOCKER или других клиентских средств для извлечения артефактов в реестр контейнеров Azure необходимо указать Логинурл. 
* **пространство имен** — логическое группирование связанных изображений или артефактов, разделенных косой чертой, например для Рабочей группы или приложения
* **артефакт** — имя репозитория для конкретного образа или артефакта.
* **Tag** — конкретная версия образа или артефакта, хранящихся в репозитории


Например, полное имя образа в реестре контейнеров Azure может выглядеть следующим образом:

```
myregistry.azurecr.io/marketing/campaign10-18/email-sender:v2
```

Дополнительные сведения об этих элементах см. в следующих разделах.

## <a name="repository-name"></a>Имя репозитория

Реестры контейнеров управляют *репозиториями*, коллекциями образов контейнеров или другими артефактами с тем же именем, но разными тегами. Например, следующие три образа находятся в репозитории acr-helloworld.

```
acr-helloworld:latest
acr-helloworld:v1
acr-helloworld:v2
```

Имена репозиториев также могут включать [пространство имен](container-registry-best-practices.md#repository-namespaces). Пространства имен позволяют группировать изображения с помощью имен репозитория, разделенных косой чертой, например:

```
marketing/campaign10-18/web:v2
marketing/campaign10-18/api:v3
marketing/campaign10-18/email-sender:v2
product-returns/web-submission:20180604
product-returns/legacy-integrator:20180715
```

## <a name="image"></a>Image

Образ контейнера или другой артефакт в реестре связан с одним или несколькими тегами, имеет один или несколько слоев и определяется манифестом. Понимание того, как эти компоненты связаны друг с другом, может помочь эффективно управлять реестром.

### <a name="tag"></a>Тег

*Тег* для изображения или другого артефакта указывает его версию. Одному артефакту в репозитории может быть назначен один или несколько тегов, а также может быть "без тегов". То есть можно удалить все теги из изображения, в то время как данные изображения (его слои) остаются в реестре.

Репозиторий (или репозиторий и пространство имен) вместе с тегом определяют имя образа. Образ можно отправлять и получать. Для этого в операции передачи или получения необходимо указать его имя.

Создание тегов для образов контейнеров осуществляется с помощью сценариев для разработки или развертывания. Например, стабильными тегами рекомендуется поддерживать базовые образы и уникальные теги для развертывания образов. Дополнительные сведения см. в разделе [рекомендации по отстановке тегов и управление версиями для образов контейнеров](container-registry-image-tag-version.md).

### <a name="layer"></a>Слой

Образы контейнеров состоят из одного или нескольких *слоев*, каждый из которых соответствует строке в Dockerfile, определяющей изображение. Образы в реестре используют слои совместно, что позволяет увеличить эффективность хранилища. Например, несколько образов, которые находятся в разных репозиториях, могут совместно использовать базовый слой Alpine Linux, но только одна копия из этого слоя может хранится в реестре.

Совместное использование слоя также оптимизирует распределение слоев для узлов с несколькими образами, совместно использующих общие слои. Например, если образ уже находится в узле, который включает в себя уровень Alpine Linux в качестве основы, последующее притяжение другого образа, ссылающегося на один и тот же слой, не переносит его слой на узел. Вместо этого он ссылается на слой, который уже существует на узле.

Чтобы обеспечить безопасную изоляцию и защиту от потенциальных манипуляций с слоями, уровни не являются общими для реестров.

### <a name="manifest"></a>Манифест

Каждый образ контейнера или артефакт, отправленный в реестр контейнеров, связан с *манифестом*. Манифест создается реестром во время отправки образа, уникально идентифицирует образ и указывает его слой. Вы можете составить список манифестов для репозитория с помощью команды Azure CLI [AZ контроля учетных записей, отображающей манифесты][az-acr-repository-show-manifests]:

```azurecli
az acr repository show-manifests --name <acrName> --repository <repositoryName>
```

Например, перечислите манифесты для репозитория "запись контроля доступа".

```console
$ az acr repository show-manifests --name myregistry --repository acr-helloworld
[
  {
    "digest": "sha256:0a2e01852872580b2c2fea9380ff8d7b637d3928783c55beb3f21a6e58d5d108",
    "tags": [
      "latest",
      "v3"
    ],
    "timestamp": "2018-07-12T15:52:00.2075864Z"
  },
  {
    "digest": "sha256:3168a21b98836dda7eb7a846b3d735286e09a32b0aa2401773da518e7eba3b57",
    "tags": [
      "v2"
    ],
    "timestamp": "2018-07-12T15:50:53.5372468Z"
  },
  {
    "digest": "sha256:7ca0e0ae50c95155dbb0e380f37d7471e98d2232ed9e31eece9f9fb9078f2728",
    "tags": [
      "v1"
    ],
    "timestamp": "2018-07-11T21:38:35.9170967Z"
  }
]
```

### <a name="manifest-digest"></a>Дайджест манифеста

Манифесты идентифицируются с помощью уникального хэша SHA-256 или *дайджеста манифеста*. Каждое изображение или артефакт — указывает, определяется ли его дайджест-тегом или нет. Значение дайджеста уникально, даже если данные слоя образа идентичны данным другого образа. Данный механизм позволяет многократно отправлять образы с идентичными тегами в реестр. Например, можно многократно отправлять `myimage:latest` в реестр, при этом не получая сообщений об ошибке. Это происходит из за того, что каждый образ идентифицируется по уникальному дайджесту.

Чтобы извлечь образ из реестра, необходимо указать его дайджест в операции передачи. Некоторые системы можно настроить на извлечения с помощью дайджеста, так как он гарантирует, что будет извлечена запрашиваемая версия образа. Операция будет выполнена, даже если образы, которые были идентично помечены, впоследствии будут перенесены в реестр.

Например, можно извлечь изображение из репозитория "запись контроля доступа" с помощью дайджеста манифеста:

```console
$ docker pull myregistry.azurecr.io/acr-helloworld@sha256:0a2e01852872580b2c2fea9380ff8d7b637d3928783c55beb3f21a6e58d5d108
```

> [!IMPORTANT]
> Если многократно отправлять измененные образы с идентичными тегами, можно создать потерянные образы, которые остались без тегов, но все еще потребляют пространство реестра. Образы без тегов не отображаются в Azure CLI или на портале Azure при просмотре списка или образов по тегу. Тем не менее их слои по-прежнему существуют и занимают место в реестре. Удаление изображения без тегов освобождает место в реестре, когда манифест является единственным или последним, указывая на определенный слой. Сведения об освобождении пространства, используемого изображениями без тегов, см. [в статье Удаление образов контейнеров в реестре контейнеров Azure](container-registry-delete.md).

## <a name="next-steps"></a>Следующие шаги

Дополнительные сведения о [хранении образов](container-registry-storage.md) и [поддерживаемых форматах содержимого](container-registry-image-formats.md) в реестре контейнеров Azure.

<!-- LINKS - Internal -->
[az-acr-repository-show-manifests]: /cli/azure/acr/repository#az-acr-repository-show-manifests


