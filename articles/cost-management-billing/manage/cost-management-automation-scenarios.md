---
title: Сценарии автоматизации для выставления счетов и управления затратами в Azure | Документация Майкрософт
description: Узнайте, как соотносятся распространенные сценарии выставления счетов и управления затратами с разными API.
services: billing
documentationcenter: ''
author: bandersmsft
manager: dougeby
tags: billing
ms.service: cost-management-billing
ms.devlang: na
ms.topic: reference
ms.tgt_pltfrm: na
ms.workload: billing
ms.date: 10/01/2019
ms.author: banders
ms.openlocfilehash: c9de7d5f7661e4083d3a2f5b53368616d0e6655a
ms.sourcegitcommit: 3dc1a23a7570552f0d1cc2ffdfb915ea871e257c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/15/2020
ms.locfileid: "75992820"
---
# <a name="automation-scenarios-for-billing-and-cost-management"></a>Сценарии автоматизации для выставления счетов и управления затратами

В этой статье перечислены распространенные сценарии для выставления счетов и управления затратами Azure. Для сценариев указаны API, которые можно использовать. Под таблицей сопоставления сценариев с API можно найти сводку по этим API и функции, которые они предлагают.

## <a name="common-scenarios"></a>Стандартные сценарии

API-интерфейсы выставления счетов и управления затратами можно использовать в нескольких сценариях для решения вопросов, связанных с затратами и потреблением. Ниже приводится краткий обзор распространенных сценариев:

- **Выверка счетов**. Корпорация Майкрософт выработала мне правильную сумму?  Сколько мне нужно платить и как мне проверить эти вычисления?

- **Перекрестные платежи**. Теперь, когда я знаю, сколько взимается плата, кто в моей организации должен платить?

- **Оптимизация стоимости**: я могу узнать, сколько я платить. Могу ли я более эффективно использовать средства, которые тратятся на Azure?

- **Отслеживание затрат**. я хочу узнать, сколько времени я трат и использую Azure. Какие тенденции здесь можно заметить? Как можно это улучшить?

- **Расходы на Azure в течение месяца**: сколько времени занимает текущий месяц? Нужно ли скорректировать расходы и (или) потребление ресурсов Azure? В какой период месяца ресурсы Azure используются наиболее активно?

- **Оповещения**: как настроить потребление на основе ресурсов или на основе денежных оповещений?

## <a name="scenario-to-api-mapping"></a>Сопоставление сценариев с интерфейсами API

|         API        | Сверка счетов    | Взаимозачет    | Оптимизация затрат    | Отслеживание расходов.    | Затраты за полмесяца    | Оповещения    |
|:---------------------------:|:-------------------------:|:----------------:|:--------------------:|:----------------:|:------------------:|:---------:|
| Расходы                     |                           |                  |           X          |                  |                    |     X     |
| сведения о расходах на Marketplace;                |             X             |         X        |           X          |         X        |          X         |     X     |
| Прейскурант                 |             X             |         X        |           X          |         X        |          X         |           |
| рекомендации по резервированию; |                           |                  |           X          |                  |                    |           |
| Сведения о резервировании         |                           |                  |           X          |         X        |                    |           |
| Сводные данные о резервировании       |                           |                  |           X          |         X        |                    |           |
| сведения о потреблении;               |             X             |         X        |           X          |         X        |          X         |     X     |
| Расчетный период             |             X             |         X        |           X          |         X        |                    |           |
| Счета                    |             X             |         X        |           X          |         X        |                    |           |
| RateCard                    |             X             |                  |           X          |         X        |          X         |           |
| Неоплачиваемое потребление               |             X             |                  |           X          |                  |          X         |           |

> [!NOTE]
> Приведенная ниже таблица "Сопоставления сценариев и API" не включает API-интерфейсы потребления для организаций. Используйте общие API потребления для новых сценариев разработки, когда это возможно.

## <a name="api-summaries"></a>Сводные данные по API

### <a name="consumption"></a>Потребление
Клиенты Web Direct и Enterprise могут использовать все следующие API, кроме тех, где явно указано иначе:

-   [API бюджетов](https://docs.microsoft.com/rest/api/consumption/budgets) (*только для корпоративных клиентов*): Создайте бюджеты затрат или использования для ресурсов, групп ресурсов или единиц измерения выставления счетов. Когда вы создали бюджет, вы можете настроить оповещения, чтобы получать уведомления о превышении определенных пороговых значений. Можно также настроить действия, которые будут выполняться при достижении пороговых значений.

-   [API расходов Marketplace](https://docs.microsoft.com/rest/api/consumption/marketplaces): получите данные об оплате и использовании для всех ресурсов Azure Marketplace (предложения партнеров Azure). Эти сведения позволяют оценить совокупные расходы по всем ресурсам Marketplace или изучить показатели затрат и потребления для конкретных ресурсов.

-   [API прайс-листа](https://docs.microsoft.com/rest/api/consumption/pricesheet) (*только для корпоративных клиентов*): получение настраиваемых цен для всех измерительных приборов. Организации могут объединять эти данные с информацией о потреблении для собственных ресурсов и Marketplace, чтобы с их помощью рассчитывать затраты.

-   [API рекомендаций по резервированию](https://docs.microsoft.com/rest/api/consumption/reservationrecommendations): получите рекомендации по приобретению зарезервированных экземпляров виртуальных машин. Эти рекомендации помогают пользователям оценить ожидаемую экономию и объемы закупок. Дополнительные сведения см. в статье [API-интерфейсы для автоматизации резервирования Azure](../reservations/reservation-apis.md).

-   [API сведений о резервировании](https://docs.microsoft.com/rest/api/consumption/reservationsdetails): см. сведения о предварительно приобретенных РЕЗЕРВИРОВАНИЯХ виртуальных машин, например объем зарезервированного объема потребления и используемый объем. Эти данные можно отобразить с детализацией до конкретной виртуальной машины. Дополнительные сведения см. в статье [API-интерфейсы для автоматизации резервирования Azure](../reservations/reservation-apis.md).

-   [API сводок резервирования](https://docs.microsoft.com/rest/api/consumption/reservationssummaries): сведения о РЕЗЕРВИРОВАНИИ виртуальных машин, приобретенных вашей организацией, например объем зарезервированного объема потребления и объем, используемый в агрегате. Дополнительные сведения см. в статье [API-интерфейсы для автоматизации резервирования Azure](../reservations/reservation-apis.md).

-   [API сведений об использовании](https://docs.microsoft.com/rest/api/consumption/usagedetails): получите сведения об оплате и использовании для всех ресурсов Azure от корпорации Майкрософт. Эти данные предоставляются в форме записей с информацией о потреблении, которые в настоящее время создаются ежедневно для каждой средства измерения. На основе этих сведений можно оценить совокупные расходы по всем ресурсам или изучить показатели затрат и потребления для конкретных ресурсов.

-   [API RateCard](/previous-versions/azure/reference/mt219005(v=azure.100)): получите тарифные показатели, если вы являетесь клиентом Web Direct. Полученные данные в сочетании со сведениями о потреблении ресурсов позволят вручную вычислить ожидаемые расходы.

-   [API использования без оценок](/previous-versions/azure/reference/mt219003(v=azure.100)): получение сведений об использовании необработанных данных до того, как Azure выполняет какие-либо измерения и зарядки.

### <a name="billing"></a>Выставление счетов
-   [API периодов выставления счетов](https://docs.microsoft.com/rest/api/billing/enterprise/billing-enterprise-api-billing-periods): Определите расчетный период для анализа, а также идентификаторы счетов за этот период. Идентификаторы счетов можно использовать с API счетов.

-   [API выставления счетов](/rest/api/billing/2019-10-01-preview/invoices): получение URL-адреса скачивания для счета за расчетный период в формате PDF.

### <a name="enterprise-consumption"></a>Потребление организации
Следующие API предназначены только для клиентов Enterprise:

-   [Сводный API баланса](https://docs.microsoft.com/rest/api/billing/enterprise/billing-enterprise-api-balance-summary). ежемесячная сводка информации о балансах, новых покупках, платах за использование служб Azure Marketplace, корректировках и расходах. Эту информацию можно получить для текущего расчетного периода или за любой период в прошлом. Предприятия могут использовать эти данные для сравнения с суммарными расходами, вычисленными вручную. Этот API не предоставляет сведений по конкретным ресурсам или статистического представления затрат.

-   [API сведений об использовании](https://docs.microsoft.com/rest/api/billing/enterprise/billing-enterprise-api-usage-detail): получение сведений об использовании Azure (из предложений Майкрософт) за текущий месяц, определенный расчетный период или настраиваемый период даты. Предприятия могут использовать эти данные, чтобы вручную рассчитать счета на основе тарифа и потребления. Предприятия также могут использовать сведения о подразделениях и организациях для распределения затрат между ними. Из этих данных можно узнать о потреблении и затратах с учетом специфики ресурсов.

-   [API для оплаты магазина Marketplace](https://docs.microsoft.com/rest/api/billing/enterprise/billing-enterprise-api-marketplace-storecharge). сведения об использовании Azure (предложения партнеров) за текущий месяц, определенный расчетный период или настраиваемый период даты. Предприятия могут использовать эти данные, чтобы вручную рассчитать счета на основе тарифа и потребления. Предприятия также могут использовать сведения о подразделениях и организациях для распределения затрат между ними. С помощью этого API можно узнать о потреблении и затратах с учетом специфики ресурсов.

-   [API прайс-листа](https://docs.microsoft.com/rest/api/billing/enterprise/billing-enterprise-api-pricesheet): получите применимую ставку для каждого счетчика для данной регистрации и расчетного периода. Эти сведения о ценах в сочетании с данными о потреблении и использовании marketplace позволяют вручную рассчитать ожидаемые расходы.

-   [API периодов выставления счетов](https://docs.microsoft.com/rest/api/billing/enterprise/billing-enterprise-api-billing-periods): получение списка периодов выставления счетов. API также предоставляет свойство, которое указывает на маршрут API для четырех наборов данных корпоративного API, относящихся к расчетному периоду: BalanceSummary, UsageDetails, Marketplace и прайс-лист.

-   [API рекомендаций для зарезервированных экземпляров](https://docs.microsoft.com/rest/api/billing/enterprise/billing-enterprise-api-reserved-instance-recommendation): смотрите 7 дней, 30 дней или 60 дней использования виртуальной машины и получите рекомендации по приобретению одной и общей покупки. Использование этого API позволяет клиентам оценить ожидаемую экономию и рекомендуемые объемы закупок. Дополнительные сведения см. в статье [API-интерфейсы для автоматизации резервирования Azure](../reservations/reservation-apis.md).

## <a name="frequently-asked-questions"></a>Часто задаваемые вопросы

### <a name="whats-the-difference-between-the-enterprise-reporting-apis-and-the-consumption-apis-when-should-i-use-each"></a>Каковы отличия между API для корпоративной отчетности и API потребления? Когда их нужно использовать?
Эти API имеют аналогичный набор функций и могут ответить на тот же широкий набор вопросов в сфере выставления счетов и управления затратами. Но они ориентированы на разных пользователей:

- Эти API доступны для клиентов, подписавших Соглашение Enterprise с корпорацией Майкрософт, которое предоставляет им доступ к согласованным денежным обязательствам и индивидуальным ценам. API требуется использовать ключ, который можно получить через [Enterprise Portal](https://ea.azure.com). Описание этих API см. в статье [Обзор API-интерфейсов отчетов для корпоративных клиентов](enterprise-api.md).

- Эти API доступны для всех клиентов, за некоторыми исключениями. Дополнительные сведения см. в статье [Общие сведения об API потребления ресурсов Azure](consumption-api-overview.md) и в [справочник по API потребления](https://docs.microsoft.com/rest/api/consumption/). Предоставленные API являются рекомендуемым решением для последних сценариев разработки.

### <a name="whats-the-difference-between-the-usage-details-api-and-the-usage-api"></a>Какова разница между API сведений о потреблении и API использования?
Эти API обеспечивают совершенно разные данные:

- [API сведений об использовании](https://docs.microsoft.com/rest/api/consumption/usagedetails) предоставляет сведения об использовании и стоимости Azure для каждого экземпляра счетчика. Предоставленные данные уже переданы по системе измерения затрат Azure. Затраты уже применены наряду с другими возможными изменениями:

   - Изменения в учетной записи для использования предоплаченных денежных обязательств.
   - Изменения в учетной записи для зависимостей потребления, обнаруживаемых Azure.

- [API использования](/previous-versions/azure/reference/mt219003(v=azure.100)) предоставляет необработанные сведения по потреблению Azure, прежде чем они будут обработаны системой измерения затрат Azure. Эти данные могут не иметь корреляции с показателями затрат или потребления, которые видны после системы измерений затрат Azure.

### <a name="whats-the-difference-between-the-invoice-api-and-the-usage-details-api"></a>Каковы отличия между API счетов и API сведений о потреблении?
Эти API обеспечивают различное представление тех же данных.

- [API счетов](/rest/api/billing/2019-10-01-preview/invoices) предназначен только для клиентов Web Direct. Он предоставляет ежемесячный сводный счет на основе совокупных затрат для каждого типа показателя.

- [API сведений об использовании](https://docs.microsoft.com/rest/api/consumption/usagedetails) предоставляет подробное представление записей об использовании или затратах за каждый день. Его могут использовать как клиенты Enterprise, так и клиенты Web Direct.

### <a name="whats-the-difference-between-the-price-sheet-api-and-the-ratecard-api"></a>Каковы различия между API прейскурантов и API RateCard?
Эти API предоставляют похожие наборы данных, но имеют разные аудитории.

- [API прейскурантов](https://docs.microsoft.com/rest/api/consumption/pricesheet) предоставляет пользовательские цены, которые были согласованы для корпоративного клиента.

- [API RateCard](/previous-versions/azure/reference/mt219005(v=azure.100)) предоставляет общие цены, которые применяются к клиентам Web Direct.

## <a name="next-steps"></a>Дальнейшие действия

- Дополнительные сведения по использованию API Azure для получения аналитики о потреблении Azure программными средствами см. в [обзоре API потребления ресурсов Azure](consumption-api-overview.md) и [обзоре API выставления счетов Azure](usage-rate-card-overview.md).

- Чтобы сравнить счет и файл с подробными данными о ежедневном использовании, а также отчеты об управлении затратами на портале Azure, ознакомьтесь со статьей [Расшифровка счета за использование Microsoft Azure](../understand/review-individual-bill.md).

- Если у вас есть вопросы или вам нужна помощь, [создайте запрос в службу поддержки](https://go.microsoft.com/fwlink/?linkid=2083458).
