---
title: 'Пример визуального интерфейса #6: Классификация для прогнозирования задержек рейсов'
titleSuffix: Azure Machine Learning
description: В этой статье показано, как создать модель машинного обучения для прогнозирования задержек рейсов с помощью визуального интерфейса перетаскивания и пользовательского кода R.
services: machine-learning
ms.service: machine-learning
ms.subservice: core
ms.topic: conceptual
author: xiaoharper
ms.author: zhanxia
ms.reviewer: peterlu
ms.date: 07/02/2019
ms.openlocfilehash: 257f6034df7d1974f3964c4d07ca96d17c7fe509
ms.sourcegitcommit: 2ed6e731ffc614f1691f1578ed26a67de46ed9c2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/19/2019
ms.locfileid: "71131653"
---
# <a name="sample-6---classification-predict-flight-delays-using-r"></a>Пример 6. Классификация: Прогнозирование задержек рейсов с помощью языка R

В этом эксперименте используются исторические данные о перелете и погоде для прогнозирования того, что запланированный перелет пассажиров будет задержан более чем на 15 минут.

Эта проблема может подходить в качестве проблемы классификации, прогнозирования двух классов — отложенных или вовремя. Для создания классификатора эта модель использует большое количество примеров из исторических данных о перелетах.

Вот итоговый граф эксперимента для этого примера:

[![График эксперимента](media/how-to-ui-sample-classification-predict-flight-delay/experiment-graph.png)](media/how-to-ui-sample-classification-predict-credit-risk-cost-sensitive/graph.png#lightbox)

## <a name="prerequisites"></a>Предварительные требования

[!INCLUDE [aml-ui-prereq](../../../includes/aml-ui-prereq.md)]

4. Нажмите кнопку **Открыть** для примера 6 эксперимента:

    ![Открытие эксперимента](media/how-to-ui-sample-classification-predict-flight-delay/open-sample6.png)

## <a name="get-the-data"></a>Получение данных

В этом эксперименте используется набор **данных «задержки рейсов»** . Он входит в коллекцию данных Транстатс из США. Отдел транспортировки. Набор данных содержит сведения о задержке рейсов от апреля до октября 2013. Перед отправкой данных в визуальный интерфейс они были предварительно обработаны следующим образом:

* Отфильтрованы, чтобы включить 70 в континентальной частиные аэропорты в США.
* Для отмененных авиарейсов, помеченных как задержанные более чем на 15 минут.
* Отфильтрованные рейси.
* Выбрано 14 столбцов.

Для дополнения данных рейсов используется **набор данных погоды** . Данные о погоде содержат сведения о погоде на основе почасового покрытия от NOAA и представляют наблюдения на станциях погоды, охватывающие один и тот же период от апреля до октября 2013. Перед отправкой в визуальный интерфейс машинного обучения Azure он был предварительно обработан следующим образом:

* Идентификаторы станции погоды сопоставлены с соответствующими идентификаторами аэропорта.
* Удалены станции погоды, не связанные с 70, которые были загружены в аэропорту.
* Столбец дат был разбит на отдельные столбцы: Год, месяц и день.
* Выбрано 26 столбцов.

## <a name="pre-process-the-data"></a>Предварительная обработка данных

Прежде чем можно будет анализировать набор данных, обычно требуется предварительная обработка.

![процесс обработки и анализа данных](media/how-to-ui-sample-classification-predict-flight-delay/data-process.png)

### <a name="flight-data"></a>Данные рейсов

Столбцы **перевозчика**, **OriginAirportID**и **DestAirportID** сохраняются как целые числа. Однако они используют атрибуты категории, для преобразования их в категоризацию используется модуль **Редактирование метаданных** .

![изменение метаданных](media/how-to-ui-sample-classification-predict-flight-delay/edit-metadata.png)

Затем используйте модуль **Выбор столбцов** в наборе данных, чтобы исключить из столбцов набора данных возможные целевые утечки: **DepDelay**, **DepDel15**, **ArrDelay**, **отменено**, **год**. 

Чтобы соединить записи о перелетах с почасовыми записями погоды, используйте запланированное время отправления как один из ключей объединения. Чтобы выполнить соединение, столбец Ксрдептиме должен быть округлен вниз до ближайшего часа, что выполняется в модуле **выполнить сценарий R** . 

### <a name="weather-data"></a>Метеоданные

Столбцы, имеющие большую долю отсутствующих значений, исключаются с помощью модуля **столбцы проекта** . Эти столбцы включают все столбцы со строковыми значениями: **Валуефорвиндчарактер**, **ветбулбфаренхеит**, **ветбулбцелсиус**, **прессуретенденци**, **прессуречанже**, **SeaLevelPressure**и **StationPressure**.

Затем модуль **Clean Missing Data (очистка недостающих данных** ) применяется к оставшимся столбцам для удаления строк с отсутствующими данными.

Время наблюдения погоды округляется до ближайшего полного часа. Время запланированного рейса и время наблюдения погоды округляются в противоположных направлениях, чтобы гарантировать, что модель использует только Погода до времени рейса. 

Так как данные о погоде передаются в местное время, разница часовых поясов учитывается путем вычитания столбцов часовых поясов из запланированного времени отправления и времени наблюдения погоды. Эти операции выполняются с помощью модуля **выполнить сценарий R** .

### <a name="joining-datasets"></a>Соединение наборов данных

Записи о рейсах соединяются с данными о погоде в источнике рейса (**OriginAirportID**) с помощью модуля **объединения данных** .

 ![Присоединяйтесь к рейсу и погоду по источнику](media/how-to-ui-sample-classification-predict-flight-delay/join-origin.png)


Записи о рейсах соединяются с данными погоды с помощью назначения рейса (**DestAirportID**).

 ![Присоединяйтесь к рейсу и погоду по назначению](media/how-to-ui-sample-classification-predict-flight-delay/join-destination.png)

### <a name="preparing-training-and-test-samples"></a>Подготовка образцов для обучения и тестирования

Модуль **Split Data (разделение данных** ) разделяет данные на записи в апреле по сентябрьским материалам для обучения и в октябре для тестирования.

 ![Разделение обучающих и проверочных данных](media/how-to-ui-sample-classification-predict-flight-delay/split.png)

Столбцы "год", "месяц" и "часовой пояс" удаляются из набора данных для обучения с помощью модуля выбор столбцов.

## <a name="define-features"></a>Определение признаков

В машинном обучении функции — это отдельные измеримые свойства чего-то, о чем вы заинтересованы. Для поиска строгого набора функций требуется экспериментирование и знание предметной области. Некоторые свойства лучше подходят для прогнозирования цели, чем другие. Кроме того, некоторые функции могут иметь надежную корреляцию с другими функциями и не будут добавлять в модель новые сведения. Эти функции можно удалить.

Для построения модели можно использовать все доступные функции или выбрать подмножество функций.

## <a name="choose-and-apply-a-learning-algorithm"></a>Выбор и применение алгоритма обучения

Создайте модель с помощью модуля **логистической регрессии с двумя классами** и обучите набор данных для обучения. 

Результатом работы модуля **обучение модели** является обученная модель классификации, которую можно использовать для оценки новых образцов для создания прогнозов. Используйте проверочный набор для создания оценок из обученных моделей. Затем используйте модуль « **Анализ модели** » для анализа и сравнения качества моделей.

После запуска эксперимента можно просмотреть выходные данные модуля **Оценка модели** , щелкнув порт вывода и выбрав **визуализировать**. Выходные данные включают оцененные метки и вероятности для меток.

Наконец, чтобы проверить качество результатов, добавьте модуль « **Оценка модели** » на холст эксперимента и Соедините левый входной порт с выходными данными модуля оценки модели. Запустите эксперимент и просмотрите выходные данные модуля **Анализ модели** , щелкнув порт вывода и выбрав **визуализировать**.

## <a name="evaluate"></a>Оценка
Модель логистической регрессии имеет AUC из 0,631 в тестовом наборе.

 ![evaluate](media/how-to-ui-sample-classification-predict-flight-delay/evaluate.png)

## <a name="next-steps"></a>Следующие шаги

Изучите другие примеры, доступные для визуального интерфейса:

- [Пример 1. регрессия: Прогнозирование цены автомобиля](how-to-ui-sample-regression-predict-automobile-price-basic.md)
- [Пример 2. регрессия: Сравнение алгоритмов для прогнозирования цен автомобилей](how-to-ui-sample-regression-predict-automobile-price-compare-algorithms.md)
- [Пример 3. Классификация: Прогнозируемый кредитный риск](how-to-ui-sample-classification-predict-credit-risk-basic.md)
- [Пример 4. Классификация: Прогнозируемый кредитный риск (с учетом стоимости)](how-to-ui-sample-classification-predict-credit-risk-cost-sensitive.md)
- [Пример 5. Классификация: Прогнозирование обновлений](how-to-ui-sample-classification-predict-churn.md)
