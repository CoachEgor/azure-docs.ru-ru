---
title: Использование с Visual Studio Code
titleSuffix: Azure Machine Learning service
description: Узнайте, как установить Машинное обучение Azure для Visual Studio Code, и создайте простой эксперимент в Машинном обучении Azure.
services: machine-learning
ms.service: machine-learning
ms.subservice: core
ms.topic: conceptual
ms.author: shwinne
author: swinner95
ms.date: 12/04/2018
ms.custom: seodec18
ms.openlocfilehash: bbeb0dbbd5e9c919eda4b298dc5bee31965e9bac
ms.sourcegitcommit: 3102f886aa962842303c8753fe8fa5324a52834a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "60818748"
---
# <a name="get-started-with-azure-machine-learning-for-visual-studio-code"></a>Приступая к работе с Azure Machine Learning for Visual Studio Code

Из этой статьи вы узнаете, как использовать расширение **Azure Machine Learning for Visual Studio Code** для обучения и развертывания моделей машинного обучения и глубокого обучения с помощью Службы машинного обучения Azure в Visual Studio Code.

Служба машинного обучения Azure обеспечивает поддержку для проведения экспериментов, локально и на удаленных целевых объектов вычислений. Для каждого эксперимента вы можете отслеживать множество запусков, которые можно выполнять как угодно часто с целью итеративной проверки разных методик, гиперпараметров и т. п. Службу "Машинное обучение Azure" можно использовать для отслеживания пользовательских метрик и экспериментов, обеспечивая повторяемость и возможность проверки для задач обработки и анализа данных.

Также вы можете развернуть эти модели для тестирования и производственных задач.

## <a name="prerequisites"></a>Технические условия

+ Если у вас еще нет подписки Azure, создайте бесплатную учетную запись Azure, прежде чем начинать работу. Опробуйте [бесплатную или платную версию Службы машинного обучения Azure](https://aka.ms/AMLFree).

+ Необходимо установить Visual Studio Code. VS Code — это легковесный, но мощный редактор исходного кода, который работает на компьютере. В нем реализована поддержка Python и других языков.  [Сведения об установке VS Code](https://code.visualstudio.com/docs/setup/setup-overview).

+ [Установка Python версии 3.5 или более поздней](https://www.anaconda.com/download/).


## <a name="install-the-azure-machine-learning-for-vs-code-extension"></a>Установка расширения Azure Machine Learning for VS Code

При установке расширения **Azure Machine Learning for Visual Studio Code** автоматически устанавливаются два других расширения (при наличии доступа к Интернету). Это расширения [Azure Account](https://marketplace.visualstudio.com/items?itemName=ms-vscode.azure-account) и [Microsoft Python](https://marketplace.visualstudio.com/items?itemName=ms-python.python).

Для работы со службой "Машинное обучение Azure" нам нужно преобразовать VS Code в интегрированную среду разработки на языке Python. Для работы с [Python в Visual Studio Code](https://code.visualstudio.com/docs/languages/python) требуется расширение Microsoft Python, которое автоматически устанавливается вместе с расширением Azure Machine Learning for Visual Studio Code. Это расширение превращает VS Code в мощную интегрированную среду разработки, которая работает в любой операционной системе с различными интерпретаторами Python. Оно использует все возможности VS Code, предоставляя функции автозаполнения и IntelliSense, анализа кода, отладки и модульного тестирования, а также возможность легко переключаться между окружениями Python, включая виртуальные окружения и окружения conda. Пошаговые инструкции по редактированию, запуску и отладке кода Python см. в [руководстве по началу работы с Python](https://code.visualstudio.com/docs/python/python-tutorial).

**Чтобы установить расширение Azure Machine Learning for Visual Studio Code, сделайте следующее.**

1. Запустите VS Code.

1. В браузере перейдите по ссылке: [Расширение Azure Machine Learning for Visual Studio Code (предварительная версия)](https://aka.ms/vscodetoolsforai)

1. На этой странице нажмите **Install** (Установить). 

1. На вкладке расширений нажмите **Установить**.

1. Откроется вкладка Добро пожаловать в Visual STUDIO Code для расширения и Azure символ (выделена красным прямоугольником на рисунке ниже) добавляется к строке активности.

   ![Значок Azure на панели действий Visual Studio Code](./media/vscode-tools-for-ai/azure-activity-bar.png)

1. В диалоговом окне нажмите **Sign In** (Войти) и следуйте инструкциям во всплывающем окне, чтобы выполнить проверку подлинности в Azure. 
   
   Расширение Azure Account, которое было установлено вместе с расширением Azure Machine Learning for Visual Studio Code, поможет выполнить аутентификацию вашей учетной записи Azure. Список команд см. на странице [расширения Azure Account ](https://marketplace.visualstudio.com/items?itemName=ms-vscode.azure-account).

> [!Tip] 
> Ознакомьтесь с расширением [IntelliCode для VS Code (предварительная версия)](https://go.microsoft.com/fwlink/?linkid=2006060). IntelliCode предоставляет набор возможностей на основе искусственного интеллекта для функции IntelliSense в языке Python, например определение наиболее подходящих объектов для автозаполнения на основе текущего контекста кода.

## <a name="azure-ml-sdk-installation"></a>Установка пакета SDK для Azure ML

1. Убедитесь, что у вас установлен интерпретатор Python версии 3.5 или более поздней, который распознан VS Code. Если вы установили Python только сейчас, перезапустите VS Code и выберите интерпретатор Python, воспользовавшись инструкциями в руководстве https://code.visualstudio.com/docs/python/python-tutorial.

1. Во встроенном окне терминала укажите используемый интерпретатор Python или нажмите клавишу **ВВОД**, чтобы использовать интерпретатор Python по умолчанию.

   ![Выбор интерпретатора](./media/vscode-tools-for-ai/python.png)

1. В нижнем правом углу окна появится уведомление, указывающее, что пакет SDK для Azure ML устанавливается автоматически.    Закрытый локальной среды Python создается, имеет необходимые компоненты Visual Studio Code для работы со службой машинного обучения Azure.

   ![Установка пакета SDK Машинного обучения Azure для Python](./media/vscode-tools-for-ai/runtimedependencies.png)

## <a name="get-started-with-azure-machine-learning"></a>Начало работы со средством машинного обучения Azure

Прежде чем начать обучение и развертывание моделей машинного обучения с помощью VS Code, необходимо создать [рабочую область в облачной Службе машинного обучения Azure](concept-azure-machine-learning-architecture.md#workspace), которая будет содержать модели и ресурсы. Ознакомьтесь со сведениями о создании рабочей области и создайте в ней свой первый эксперимент.

1. Щелкните значок Azure на панели действий Visual Studio Code. Появится боковая панель "Машинное обучение Azure".

   [![Установка](./media/vscode-tools-for-ai/CreateaWorkspace.gif)](./media/vscode-tools-for-ai/CreateaWorkspace.gif#lightbox)


1. Щелкните правой кнопкой мыши подписку Azure и выберите **Create Workspace** (Создать рабочую область). Появится список. В примере, показанном на анимированном изображении, имя подписки — Free Trial, а рабочее пространство — TeamWorkspace. 

1. Выберите существующую группу ресурсов из списка или создайте новую с помощью мастера в палитре команд.

1. В поле введите уникальное и понятное имя новой рабочей области. На снимках экрана имя рабочей области — TeamWorkspace.

1. Нажмите клавишу ВВОД для создания рабочей области. Она появится в древовидном представлении под именем подписки.

1. Щелкните правой кнопкой мыши имя рабочей области и в контекстном меню выберите **Create Experiment** (Создать эксперимент).  Эксперименты используются для отслеживания выполняемых операций в службе "Машинное обучение Azure".

1. В поле введите имя эксперимента. На снимках экрана имя эксперимента — MNIST.
 
1. Нажмите клавишу ВВОД для создания эксперимента. Он отобразится в древовидной структуре под именем рабочей области.

1. В рабочей области щелкните правой кнопкой мыши эксперимент и выберите Set as Active Experiment (Установить в качестве активного эксперимента). **Активным** называется эксперимент, который вы сейчас используете. Папка, открытая в VS Code, будет связана с этим экспериментом в облаке. В этой папке должны находиться локальные скрипты Python.

   Теперь все выполняемые операции связаны с экспериментом, благодаря чему все ключевые метрики будут храниться в журнале эксперимента, а обученные модели будут автоматически отправляться в службу "Машинное обучение Azure" и храниться вместе с метриками и журналами эксперимента.

   [![Присоединение папки в VS Code](./media/vscode-tools-for-ai/CreateAnExperiment.gif)](./media/vscode-tools-for-ai/CreateAnExperiment.gif#lightbox)


## <a name="create-and-manage-compute-targets"></a>Создание целевых объектов вычислений и управление ими

Расширение Azure Machine Learning for VS Code позволяет подготовить данные, обучить модели и развернуть их как локально, так и на удаленных целевых объектах вычислений.

Это расширение поддерживает несколько удаленных целевых объектов вычислений для службы "Машинное обучение Azure". См. [полный список целевых объектов вычислений](how-to-set-up-training-targets.md), поддерживаемых службой "Машинное обучения Azure".

### <a name="create-compute-targets-for-azure-machine-learning-in-vs-code"></a>Создание целевых объектов вычислений для службы "Машинное обучение Azure" с помощью VS Code

**Чтобы создать целевой объект вычислений, выполните следующие действия:**

1. Щелкните значок Azure на панели действий Visual Studio Code. Появится боковая панель "Машинное обучение Azure".

2. В представлении в виде дерева разверните подписку Azure и рабочую область службы "Машинное обучение Azure". В примере, показанном на анимированном изображении, имя подписки — Free Trial, а рабочее пространство — TeamWorkspace. 

3. В узле рабочей области щелкните правой кнопкой мыши узел **Compute** (Вычисления) и выберите **Create Compute** (Создать вычислительный ресурс).

4. Выберите из списка тип целевого объекта вычислений. 

5. На панели "Палитра команд" выберите размер виртуальной машины.

6. На панели "Палитра команд" введите имя целевого объекта вычислений в поле. 

7. Настройте дополнительные свойства в файле конфигурации JSON, который откроется в новой вкладке. Можно указать свойства, такие как максимальное число узлов.

8. Завершив настройку целевого объекта вычислений, щелкните **Отправить** в правом нижнем углу.

Ниже приведен пример создания Вычислительной среды Машинного обучения Azure (AMLCompute): [![Создание Вычислительной среды AML в VS Code](./media/vscode-tools-for-ai/CreateARemoteCompute.gif)](./media/vscode-tools-for-ai/CreateARemoteCompute.gif#lightbox)

#### <a name="the-run-configuration-file"></a>Файл конфигурации запуска

Расширение для VS Code автоматически создает локальные целевые объекты вычислений и конфигурацию запуска для сред **local** и **docker** на локальном компьютере. Файлы конфигурации запуска можно найти в разделе целевой узел связанные вычислительные. 

## <a name="train-and-tune-models"></a>Обучение и тонкая настройка моделей

Работа со службой "Машинное обучение Azure для VS Code" (предварительная версия) позволяет выполнять быструю итерации кода, пошаговое выполнение и отладку, а также использовать любую систему управления версиями. 

**Чтобы запустить локальный эксперимент с помощью службы "Машинное обучение Azure", выполните следующие шаги:**

1. Щелкните значок Azure на панели действий Visual Studio Code. Появится боковая панель "Машинное обучение Azure".

1. В представлении в виде дерева разверните подписку Azure и рабочую область службы "Машинное обучение Azure". 

1. В узле рабочей области разверните узел **Вычисление** и щелкните правой кнопкой мыши **Run Config** (Выполнить конфигурацию) для вычислительного ресурса, который вы хотите использовать. 

1. Щелкните **Run Experiment** (Выполнить эксперимент).

1. Выберите в проводнике выполняемый сценарий. 

1. Щелкните **View Experiment Run** (Просмотр выполнения эксперимента), чтобы открыть встроенный портал службы "Машинное обучение Azure", где вы сможете отслеживать запуски и просматривать обученные модели.

Ниже приведен пример локального выполнения эксперимента. [![Локальное выполнение эксперимента](./media/vscode-tools-for-ai/RunExperimentLocally.gif)](./media/vscode-tools-for-ai/RunExperimentLocally.gif#lightbox)

### <a name="use-remote-computes-for-experiments-in-vs-code"></a>Использование удаленных вычислительных ресурсов для экспериментов в VS Code

Чтобы использовать для обучения удаленный целевой объект вычислений, создайте файл конфигурации запуска. Этот файл указывает службе "Машинное обучение Azure" не только место выполнения эксперимента, но и метод подготовки среды.

#### <a name="the-conda-dependencies-file"></a>Файл зависимостей conda

По умолчанию создается новая среда conda, которая управляет устанавливаемыми зависимостями. Однако сами зависимости и их версии следует включить в файл `aml_config/conda_dependencies.yml`. 

Ниже представлен фрагмент файла aml_config/conda_dependencies.yml, используемого по умолчанию. Например, вы можете указать "tensorflow=1.12.0", как показано ниже. Если вы не укажете версию зависимости, будет использоваться последняя версия.  
Вы можете добавить в файл конфигурации дополнительные зависимости.

```yaml
# The dependencies defined in this file will be automatically provisioned for runs with userManagedDependencies=False.

name: project_environment
dependencies:
  # The python interpreter version.

  # Currently Azure ML only supports 3.5.2 and later.

- python=3.6.2
- tensorflow=1.12.0

- pip:
    # Required packages for AzureML execution, history, and data preparation.

  - --index-url https://azuremlsdktestpypi.azureedge.net/sdk-release/Preview/E7501C02541B433786111FE8E140CAA1
  - --extra-index-url https://pypi.python.org/simple
  - azureml-defaults

```

**Чтобы запустить эксперимент на целевом объекте удаленных вычислений с помощью службы "Машинное обучение Azure", выполните следующие шаги:**

1. Щелкните значок Azure на панели действий Visual Studio Code. Появится боковая панель "Машинное обучение Azure".

1. В представлении в виде дерева разверните подписку Azure и рабочую область службы "Машинное обучение Azure". 

1. Щелкните правой кнопкой мыши в окне редактора ваш сценарий Python и выберите **AML: Run as Experiment in Azure** (AML: Выполнение эксперимента в Azure). 

1. На палитре команд выберите целевой объект вычислений. 

1. На палитре команд введите в поле имя конфигурации запуска. 

1. Внесите изменение в файл the conda_dependencies.yml, чтобы указать зависимости среды выполнения эксперимента, а затем щелкните в нижнем правом углу экрана кнопку **Отправить**. 

1. Щелкните **View Experiment Run** (Просмотр выполнения эксперимента), чтобы открыть встроенный портал службы "Машинное обучение Azure", где вы сможете отслеживать запуски и просматривать обученные модели.

Ниже приведен пример выполнения эксперимента на целевом объекте удаленных вычислений. [![Выполнение эксперимента в удаленной целевой среде](./media/vscode-tools-for-ai/runningOnARemoteTarget.gif)](./media/vscode-tools-for-ai/runningOnARemoteTarget.gif#lightbox)


## <a name="deploy-and-manage-models"></a>Развертывание моделей и управление ими
Служба "Машинное обучение Azure" позволяет развертывать модели машинного обучения и управлять ими в облаке и на пограничных устройствах. 

### <a name="register-your-model-to-azure-machine-learning-from-vs-code"></a>Регистрация модели в службе "Машинное обучение Azure" с помощью VS Code

После того как вы завершили обучение модели, ее можно зарегистрировать в рабочей области.
Зарегистрированные модели можно отслеживать и развертывать.

**Чтобы зарегистрировать модель, выполните следующие шаги:**

1. Щелкните значок Azure на панели действий Visual Studio Code. Появится боковая панель "Машинное обучение Azure".

1. В представлении в виде дерева разверните подписку Azure и рабочую область службы "Машинное обучение Azure".

1. В узле рабочей области щелкните правой кнопкой мыши **Models** (Модели) и выберите **Register Model** (Зарегистрировать модель).

1. На палитре команд введите в поле имя модели. 

1. Выберите в списке, нужно ли отправить **model file** (файл модели для одной модели) или **model folder** (папку модели для моделей с несколькими файлами, например Tensorflow). 

1. Выберите папку или файл.

1. Завершив настройку свойств модели, щелкните **Отправить** в правом нижнем углу. 

Пример регистрации вашей модели в AML. [![Регистрация модели в AML](./media/vscode-tools-for-ai/RegisteringAModel.gif)](./media/vscode-tools-for-ai/RegisteringAModel.gif#lightbox)


### <a name="deploy-your-service-from-vs-code"></a>Развертывание службы с помощью VS Code

С помощью VS Code веб-службу можно развернуть в следующих расположениях:
+ экземпляр контейнера Azure (ACI) — для тестирования;
+ служба Azure Kubernetes (AKS) — для производственных задач. 

Контейнеры ACI для тестирования не нужно создавать заранее, так как они создаются автоматически. Но кластеры AKS нужно обязательно настраивать заранее. 

См. дополнительные сведения [о развертывании в службе "Машинное обучение Azure"](how-to-deploy-and-where.md).

**Чтобы развернуть веб-службу, выполните следующие шаги:**

1. Щелкните значок Azure на панели действий Visual Studio Code. Появится боковая панель "Машинное обучение Azure".

1. В представлении дерева разверните подписку Azure и рабочую область службы "Машинное обучение Azure".

1. В узле рабочей области, разверните узел **Models** (Модели).

1. Щелкните правой кнопкой мыши модель, которую вы намерены развернуть, и выберите в контекстном меню команду **Deploy Service from Registered Model** (Развернуть службу из зарегистрированной модели).

1. На палитре команд из списка выберите целевой объект вычислений для развертывания службы. 

1. На палитре команд введите в поле имя для этой службы.  

1. На палитре команд нажмите клавишу ВВОД на клавиатуре, чтобы выбрать файл сценария.

1. На палитре команд нажмите клавишу ВВОД на клавиатуре, чтобы выбрать файл зависимости.

1. Завершив настройку свойств службы, щелкните **Отправить** в правом нижнем углу. В этом файле свойства службы можно указать локальный файл Docker или файл schema.json, который требуется использовать.

Теперь веб-служба развернута.

Приведем пример развертывания веб-службы. [![Развертывание веб-службы](./media/vscode-tools-for-ai/CreatingAnImage.gif)](./media/vscode-tools-for-ai/CreatingAnImage.gif#lightbox)

### <a name="use-keyboard-shortcuts"></a>Использование сочетаний клавиш

Как и для большинства функций VS Code, для службы "Машинное обучение Azure" в VS Code предусмотрены сочетания клавиш. Самое важное сочетание клавиш, которое нужно запомнить, — это CTRL+SHIFT+P для вызова палитры команд. Из палитры вы получаете доступ ко всем функциям VS Code, включая сочетания клавиш для самых распространенных операций.

[![Сочетания клавиш для расширения Azure Machine Learning for VS Code](./media/vscode-tools-for-ai/commands.gif)](./media/vscode-tools-for-ai/commands.gif#lightbox)

## <a name="next-steps"></a>Дальнейшие действия

Пошаговые инструкции по обучению с помощью Машинного обучения без VS Code вы найдете в разделе [Руководство по обучению модели классификации изображений с помощью Службы машинного обучения Azure](tutorial-train-models-with-aml.md).

Пошаговые инструкции по редактированию, запуску и отладке кода Python на локальном компьютере см. в [руководстве Hello World по языку Python](https://code.visualstudio.com/docs/python/python-tutorial).
