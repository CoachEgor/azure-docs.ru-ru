---
title: Создание и использование целевых объектов вычислений для обучения моделей
titleSuffix: Azure Machine Learning service
description: Настройте среды обучения (целевые объекты вычислений) для обучения моделей машинного обучения. Вы можете с легкостью переключаться между средами обучения. Начните обучение на локальном компьютере. Если вам потребуется увеличить масштаб, переключитесь на облачный целевой объект вычислений.
services: machine-learning
author: heatherbshapiro
ms.author: hshapiro
ms.reviewer: sgilley
ms.service: machine-learning
ms.subservice: core
ms.topic: conceptual
ms.date: 06/12/2019
ms.custom: seodec18
ms.openlocfilehash: 0b35ef5ca3aaa7ad4169f99e2830ebea76d2759e
ms.sourcegitcommit: 41ca82b5f95d2e07b0c7f9025b912daf0ab21909
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/13/2019
ms.locfileid: "67074948"
---
# <a name="set-up-compute-targets-for-model-training"></a>Настройка целевых объектов вычислений для обучения моделей 

С помощью Службы машинного обучения Azure вы можете обучать модель, используя разные вычислительные ресурсы или среды, которые вместе называются [__целевыми объектами вычислений__](concept-azure-machine-learning-architecture.md#compute-targets). Они могут быть локальными или облачными, например Вычислительная среда машинного обучения Azure, Azure HDInsight или удаленная виртуальная машина.  Можно также создать целевые объекты вычислений для развертывания моделей, как описано в статье [Развертывание моделей с помощью Службы машинного обучения Azure](how-to-deploy-and-where.md).

Можно создать и управлять ими с помощью Azure Machine Learning SDK, портал Azure, Azure CLI или Azure Machine Learning VS Code расширение целевого объекта вычислений. Если у вас есть целевые объекты вычислений, созданные другой службой (например, кластером HDInsight), вы можете подключить их к своей рабочей области Службы машинного обучения Azure.
 
В этой статье вы узнаете об использовании разных целевых объектов вычисления для обучения моделей.  Шаги для всех вычислительных целей выполняются в том же рабочем процессе.
1. __Создание__ целевого объекта вычислений, если такого еще нет.
2. __Присоединение__ целевого объекта вычислений в рабочую область.
3. __Настройка__ целевого объекта вычислений так, чтобы он содержал необходимые сценарии зависимости среды и пакет Python.


>[!NOTE]
> Код в этой статье протестирован с помощью пакета SDK для Машинного обучения Azure версии 1.0.39.

## <a name="compute-targets-for-training"></a>Целевые объекты вычислений для обучения

Служба машинного обучения Azure по-разному поддерживает разные целевые объекты вычислений. Жизненный цикл разработки обычной модели начинается с разработки и экспериментов с небольшим объемом данных. На этом этапе мы рекомендуем использовать локальную среду. Например, ваш локальный компьютер или облачную виртуальную машину. По мере перехода к обучению на больших наборах данных или распределенному обучению мы рекомендуем использовать Вычислительную среду Машинного обучения Azure, чтобы создать одно- или многоузловой кластер, который автоматически масштабируется при каждой отправке запроса на запуск. Можно также подключить собственный вычислительный ресурс, хотя не все сценарии могут поддерживаться. Подробнее об этом рассказывается ниже.

[!INCLUDE [aml-compute-target-train](../../../includes/aml-compute-target-train.md)]


> [!NOTE]
> Вычислительную среду Машинного обучения Azure можно создать как постоянный ресурс или создать динамически при запросе запуска. Созданные при запуске целевые объекты вычислений будут удалены после завершения обучающего запуска, поэтому объекты вычислений, созданные таким способом, невозможно использовать повторно.

## <a name="whats-a-run-configuration"></a>Что являет собой конфигурация запуска?

При обучении этот учебный сценарий обычно запускают на локальном компьютере, а затем запускают в другом целевом объекте вычислений. Служба машинного обучения Azure позволяет запускать сценарий для различных целевых объектов вычислений без необходимости изменения сценария. 

Вам нужно лишь определить среду для каждого целевого объекта вычислений с помощью **конфигурации запуска**.  Затем, если вы хотите запустить обучающий эксперимент на другом целевом объекте вычислений, укажите конфигурацию запуска для этого вычисления. 

Дополнительные сведения об [отправке экспериментов](#submit) см. в конце этой статьи.

### <a name="manage-environment-and-dependencies"></a>Управление средой и зависимостями

При создании конфигурации запуска необходимо выбрать способ управления средой и зависимостями на целевом объекте вычислений. 

#### <a name="system-managed-environment"></a>Среда, управляемая системой

Если необходимо, чтобы [Conda](https://conda.io/docs/) управляла средой Python и зависимостями сценария, используйте среду, управляемую системой. Наиболее распространенным по умолчанию вариантом считается среда, управляемая системой. Это полезно для удаленных целевых объектов вычислений, особенно когда невозможно настроить эту цель. 

Вам нужно лишь указать каждую зависимость пакета с помощью [класса CondaDependency](https://docs.microsoft.com/python/api/azureml-core/azureml.core.conda_dependencies.condadependencies?view=azure-ml-py). Затем Conda создаст файл с именем **conda_dependencies.yml** в каталоге рабочей области **aml_config** с помощью списка зависимостей пакета и настроит среду Python при отправке обучающего эксперимента. 

Первоначальная настройка новой среды может занять несколько минут в зависимости от размера необходимых зависимостей. Пока список пакетов остается неизменным, настройка происходит только один раз.
  
В следующем коде показан пример для среды, управляемой системой, которая требует scikit-learn.
    
[!code-python[](~/aml-sdk-samples/ignore/doc-qa/how-to-set-up-training-targets/runconfig.py?name=run_system_managed)]

#### <a name="user-managed-environment"></a>Среда, управляемая пользователем

В среде, управляемой пользователем, вы несете ответственность за настройку среды и установку каждого пакета, который необходим вашему обучающему сценарию на целевом объекте вычислений. Если ваша учебная среда уже настроена (например, на локальном компьютере), вы можете пропустить этот шаг настройки, задав `user_managed_dependencies` значение "True". Conda не будет проверять вашу среду или устанавливать что-либо за вас.

Следующий код представляет собой пример настройки запусков обучения для среды, управляемой пользователем.

[!code-python[](~/aml-sdk-samples/ignore/doc-qa/how-to-set-up-training-targets/runconfig.py?name=run_user_managed)]
  
## <a name="set-up-in-python"></a>В Python

Чтобы настроить эти целевые объекты вычислений, используйте следующие разделы.

* [Локальный компьютер](#local)
* [Вычислительная среда Машинного обучения Azure](#amlcompute)
* [Удаленные виртуальные машины](#vm)
* [Azure HDInsight](#hdinsight)


### <a id="local"></a>Локальный компьютер

1. **Создание и присоединение**. Нет необходимости создавать или присоединять целевой объект вычислений, чтобы использовать локальный компьютер в качестве среды обучения.  

1. **Настройка**.  При использовании локального компьютера в качестве целевого объекта вычислений обучающий код запускается в вашей [среде разработки](how-to-configure-environment.md).  Если эта среда уже содержит пакеты Python, необходимо использовать среду, управляемую пользователем.

 [!code-python[](~/aml-sdk-samples/ignore/doc-qa/how-to-set-up-training-targets/local.py?name=run_local)]

Теперь, после подключения вычислительной среды и настройки запуска, следующий шаг — [отправить запуск на выполнение обучения](#submit).

### <a id="amlcompute"></a>Вычислительная среда Машинного обучения Azure

Вычислительная среда Машинного обучения Azure — это управляемая вычислительная инфраструктура, которая позволяет пользователю легко создавать одно- и многоузловые вычислительные среды. Она создается в регионе вашей рабочей области и является ресурсом, который можно использовать совместно с другими пользователями в этой рабочей области. Вычислительная среда автоматически масштабируется при отправке задания, а также может быть размещена в виртуальной сети Azure. Она выполняется в контейнерной среде, упаковывая зависимости вашей модели в [контейнер Docker](https://www.docker.com/why-docker).

Вычислительную среду Машинного обучения Azure можно использовать для распространения процесса обучения в кластере вычислительных узлов на основе ЦП или GPU, размещенном в облаке. Дополнительные сведения о размерах виртуальных машин, которые содержат GPU, см. в статье [Размеры виртуальных машин, оптимизированных для GPU](https://docs.microsoft.com/azure/virtual-machines/linux/sizes-gpu).

Вычислительная среда Машинного обучения Azure имеет ограничения по умолчанию, такие как количество ядер, которые могут быть выделены. Дополнительные сведения см. в статье [Управление квотами для ресурсов Azure и их запрашивание](https://docs.microsoft.com/azure/machine-learning/service/how-to-manage-quotas).


Можно создать Вычислительную среду Машинного обучения Azure по запросу при запланированном запуске или создать ее в качестве постоянного ресурса.

#### <a name="run-based-creation"></a>Создание при запуске

Вы можете создать Вычислительную среду Машинного обучения Azure в качестве целевого объекта вычислений во время выполнения. Вычислительная среда создается автоматически для запуска. Эта среда автоматически удаляется после завершения выполнения запуска. 

> [!NOTE]
> Чтобы указать максимальное количество узлов для использования, обычно устанавливается `node_count` до числа узлов. Сейчас (04/04/2019) ошибку, которая препятствует работе. Чтобы обойти это ограничение, используйте `amlcompute._cluster_max_node_count` свойства конфигурации при запуске. Например, `run_config.amlcompute._cluster_max_node_count = 5`.

> [!IMPORTANT]
> Функция создания Вычислительной среды Машинного обучения Azure при запуске в настоящее время находится в предварительной версии. Не применяйте создание при запуске, если вы используете автоматическую настройку гиперпараметров или автоматическое машинное обучение. Чтобы использовать настройку гиперпараметров или автоматическое машинное обучение, создайте [постоянный целевой объект вычислений](#persistent) вместо этого.

1.  **Создание, присоединение и настройка**. Создание при запуске выполняет все необходимые шаги для создания, присоединения и настройки целевого объекта вычислений с конфигурацией запуска.  

  [!code-python[](~/aml-sdk-samples/ignore/doc-qa/how-to-set-up-training-targets/amlcompute.py?name=run_temp_compute)]


Теперь, после подключения вычислительной среды и настройки запуска, следующий шаг — [отправить запуск на выполнение обучения](#submit).

#### <a id="persistent"></a>Постоянная вычислительная среда

Постоянную Вычислительную среду машинного обучения Azure можно многократно использовать в заданиях. Ее можно использовать совместно с другими пользователями в рабочей области, и она сохраняется после выполнения заданий.

1. **Создание и присоединение**. Чтобы создать постоянный ресурс Вычислительной среды машинного обучения Azure в Python, необходимо указать свойства **vm_size** и **max_nodes**. Затем Машинное обучение Azure использует интеллектуальные значения по умолчанию для остальных свойств. Когда вычислительная среда не используется, она автоматически масштабируется до нуля узлов.   Выделенные виртуальные машины создаются для выполнения заданий по мере необходимости.
    
    * **vm_size**. Семейство виртуальных машин узлов, создаваемых Вычислительной средой Машинного обучения Azure.
    * **max_nodes**. Максимальное количество узлов для автомасштабирования при запуске задания в Вычислительной среде Машинного обучения Azure.
    
   [!code-python[](~/aml-sdk-samples/ignore/doc-qa/how-to-set-up-training-targets/amlcompute2.py?name=cpu_cluster)]

   При создании Вычислительной среды машинного обучения Azure вы можете также настроить несколько дополнительных свойств. Эти свойства позволяют создать постоянный кластер фиксированного размера, который может размещаться в существующей виртуальной сети Azure в вашей подписке.  Дополнительные сведения см. в разделе о [классе AmlCompute](https://docs.microsoft.com/python/api/azureml-core/azureml.core.compute.amlcompute.amlcompute?view=azure-ml-py
    ).
    
   Или вы можете создать и присоединить постоянный ресурс Вычислительной среды Машинного обучения [на портале Azure](#portal-create).

1. **Настройка**. Создайте конфигурацию запуска для постоянного целевого объекта вычислений.

   [!code-python[](~/aml-sdk-samples/ignore/doc-qa/how-to-set-up-training-targets/amlcompute2.py?name=run_amlcompute)]

Теперь, после подключения вычислительной среды и настройки запуска, следующий шаг — [отправить запуск на выполнение обучения](#submit).


### <a id="vm"></a>Удаленные виртуальные машины

Машинное обучение Azure также поддерживает использование собственных вычислительных ресурсов и подключение их к рабочей области. К такому типу ресурсов относится произвольная удаленная виртуальная машина, если она доступна из Службы машинного обучения Azure. Ресурсом может быть виртуальная машина Azure, удаленный или локальный сервер в вашей организации. В частности, указав IP-адрес и учетные данные (имя пользователя и пароль или ключ SSH), можно использовать любую доступную виртуальную машину для удаленного запуска.

Можно использовать системную среду Conda, существующую среду Python или контейнер Docker. Для выполнения контейнера Docker на виртуальной машине должен быть запущен модуль Docker. Эта функция особенно удобна в случаях, когда необходима более гибкая облачная среда разработки и проведения экспериментов, чем локальный компьютер.

Используйте Виртуальную машину для обработки и анализа данных в качестве виртуальной машины Azure. Эта виртуальная машина является предварительно настроенной обработкой и анализом данных и средой разработки искусственного интеллекта в Azure. Виртуальная машина предлагает выбор средств и платформ для разработки машинного обучения в течение всего жизненного цикла. Дополнительных сведения об использовании DSVM со Службой машинного обучения Azure см. в статье [Настройка среды разработки для Машинного обучения Azure](https://docs.microsoft.com/azure/machine-learning/service/how-to-configure-environment#dsvm).

1. **Создание**. Создайте DSVM перед ее использованием для обучения модели. Подробные сведения о создании этого ресурса см. в разделе [Подготовка виртуальной машины Linux (Ubuntu) для обработки и анализа данных](https://docs.microsoft.com/azure/machine-learning/data-science-virtual-machine/dsvm-ubuntu-intro).

    > [!WARNING]
    > Машинное обучение Azure поддерживает только виртуальные машины под управлением Ubuntu. Поэтому создаваемая виртуальная или существующая виртуальная машина, которую вы выбираете, должна работать под управлением Ubuntu.

1. **Присоединение**. Чтобы присоединить имеющуюся виртуальную машину как целевой объект вычислений, необходимо указать ее полное доменное имя, имя входа и пароль. В приведенном примере замените \<fqdn> на общедоступное полное доменное имя виртуальной машины или общедоступный IP-адрес. Замените \<username> и \<password> именем пользователя и паролем SSH для виртуальной машины.

   ```python
   from azureml.core.compute import RemoteCompute, ComputeTarget

   # Create the compute config 
   compute_target_name = "attach-dsvm"
   attach_config = RemoteCompute.attach_configuration(address = "<fqdn>",
                                                    ssh_port=22,
                                                    username='<username>',
                                                    password="<password>")

   # If you authenticate with SSH keys instead, use this code:
   #                                                  ssh_port=22,
   #                                                  username='<username>',
   #                                                  password=None,
   #                                                  private_key_file="<path-to-file>",
   #                                                  private_key_passphrase="<passphrase>")

   # Attach the compute
   compute = ComputeTarget.attach(ws, compute_target_name, attach_config)

   compute.wait_for_completion(show_output=True)
   ```

   Или вы можете присоединить DSVM к рабочей области, [используя портал Azure](#portal-reuse).

1. **Настройка**. Создайте конфигурацию запуска для целевого объекта вычислений DSVM. Для создания и настройки среды обучения на DSVM используются Docker и Conda.

   [!code-python[](~/aml-sdk-samples/ignore/doc-qa/how-to-set-up-training-targets/dsvm.py?name=run_dsvm)]


Теперь, после подключения вычислительной среды и настройки запуска, следующий шаг — [отправить запуск на выполнение обучения](#submit).

### <a id="hdinsight"></a>Azure HDInsight 

Azure HDInsight — это популярная платформа для анализа больших данных. Она предоставляет Apache Spark, который можно использовать для обучения модели.

1. **Создание**.  Прежде чем использовать кластер HDInsight для обучения модели, создайте его. Инструкции по созданию Spark в кластере HDInsight см. в статье [Краткое руководство. Создание кластера Apache Spark в HDInsight с помощью шаблона](https://docs.microsoft.com/azure/hdinsight/spark/apache-spark-jupyter-spark-sql). 

    При создании кластера необходимо указать имя пользователя SSH и пароль. Запишите эти значения — они вам потребуются при использовании HDInsight в качестве целевого объекта вычислений.
    
    После создания кластера подключите его, указав такое имя узла: \<имя кластера>-ssh.azurehdinsight.net, где \<имя кластера> — это имя, которое вы указали для кластера. 

1. **Присоединение**. Чтобы присоединить кластер HDInsight в качестве целевого объекта вычислений, необходимо указать имя узла, а также имя пользователя и пароль для кластера HDInsight. В следующем примере пакет SDK используется для присоединения кластера к рабочей области. В примере замените \<имя кластера> именем кластера. Замените \<username> и \<password> именем пользователя и паролем SSH для кластера.

   ```python
   from azureml.core.compute import ComputeTarget, HDInsightCompute
   from azureml.exceptions import ComputeTargetException

   try:
    # if you want to connect using SSH key instead of username/password you can provide parameters private_key_file and private_key_passphrase
    attach_config = HDInsightCompute.attach_configuration(address='<clustername>-ssh.azureinsight.net', 
                                                          ssh_port=22, 
                                                          username='<ssh-username>', 
                                                          password='<ssh-pwd>')
    hdi_compute = ComputeTarget.attach(workspace=ws, 
                                       name='myhdi', 
                                       attach_configuration=attach_config)

   except ComputeTargetException as e:
    print("Caught = {}".format(e.message))

   hdi_compute.wait_for_completion(show_output=True)
   ```

   Вы также можете присоединить кластер HDInsight к рабочей области, [используя портал Azure](#portal-reuse).

1. **Настройка**. Создайте конфигурацию запуска для целевого объекта вычислений HDI. 

   [!code-python[](~/aml-sdk-samples/ignore/doc-qa/how-to-set-up-training-targets/hdi.py?name=run_hdi)]


Теперь, после подключения вычислительной среды и настройки запуска, следующий шаг — [отправить запуск на выполнение обучения](#submit).


### <a id="azbatch"></a>Пакетная служба Azure 

Пакетная служба Azure используется для эффективного запуска приложений для крупномасштабных параллельных и высокопроизводительных вычислений (HPC) в облаке. AzureBatchStep можно использовать в конвейер машинного обучения Azure для отправки заданий в пуле пакетной службы Azure машин.

Чтобы присоединить пакетной службы Azure в качестве целевого объекта вычислений, необходимо с помощью пакета SDK Azure Machine Learning и укажите следующие сведения:

-   **Пакетная служба Azure имя вычислений**: Понятное имя, используемое для вычислительных ресурсов в рабочей области
-   **Имя учетной записи пакетной службы Azure**: Имя учетной записи пакетной службы Azure
-   **Группа ресурсов**. Группа ресурсов, которая содержит учетную запись пакетной службы Azure.

Следующий код демонстрирует присоединение пакетной службы Azure в качестве целевого объекта вычислений:

```python
from azureml.core.compute import ComputeTarget, BatchCompute
from azureml.exceptions import ComputeTargetException

batch_compute_name = 'mybatchcompute' # Name to associate with new compute in workspace

# Batch account details needed to attach as compute to workspace
batch_account_name = "<batch_account_name>" # Name of the Batch account
batch_resource_group = "<batch_resource_group>" # Name of the resource group which contains this account

try:
    # check if the compute is already attached
    batch_compute = BatchCompute(ws, batch_compute_name)
except ComputeTargetException:
    print('Attaching Batch compute...')
    provisioning_config = BatchCompute.attach_configuration(resource_group=batch_resource_group, account_name=batch_account_name)
    batch_compute = ComputeTarget.attach(ws, batch_compute_name, provisioning_config)
    batch_compute.wait_for_completion()
    print("Provisioning state:{}".format(batch_compute.provisioning_state))
    print("Provisioning errors:{}".format(batch_compute.provisioning_errors))

print("Using Batch compute:{}".format(batch_compute.cluster_resource_id))
```

## <a name="set-up-in-azure-portal"></a>Настройка на портале Azure

Вы можете получить доступ к целевым объектам вычислений, связанным с вашей рабочей областью, на портале Azure.  Вы можете использовать портал для таких целей.

* [Просмотр целевых объектов вычислений](#portal-view), которые присоединены к рабочей области.
* [Создание целевого объекта вычислений](#portal-create) в рабочей области.
* [Присоединение целевого объекта вычислений](#portal-reuse), созданного за пределами рабочей области

После того как целевой объект будет создан и присоединен к рабочему пространству, вы будете использовать его в конфигурации запуска с объектом `ComputeTarget`. 

```python
from azureml.core.compute import ComputeTarget
myvm = ComputeTarget(workspace=ws, name='my-vm-name')
```

### <a id="portal-view"></a>Просмотр целевых объектов вычислений


Чтобы просмотреть целевые объекты вычислений для своей рабочей области, сделайте следующее:

1. Перейдите на [портал Azure](https://portal.azure.com) и откройте свою рабочую область. 
1. В разделе __Приложения__ выберите __Вычисления__.

    ![Просмотр вкладки вычислений](./media/how-to-set-up-training-targets/azure-machine-learning-service-workspace.png)

### <a id="portal-create"></a>Создание целевого объекта вычислений

Выполните указанные выше шаги, чтобы просмотреть список целевых объектов вычислений. Затем выполните следующие действия, чтобы создать целевой объект вычислений. 

1. Щелкните значок плюса (+), чтобы добавить целевой объект вычислений.

    ![Добавление целевого объекта вычислений](./media/how-to-set-up-training-targets/add-compute-target.png) 

1. Введите имя для целевого объекта вычислений. 

1. Выберите **Вычислительная среда Машинного обучения** в качестве типа вычислительной среды для среды __обучения__. 

    >[!NOTE]
    >Вычислительная среда Машинного обучения Azure — это единственный ресурс управляемых вычислений, который вы можете создать на портале Azure.  После создания все вычислительные ресурсы можно присоединить.

1. Заполните форму. Введите значения для обязательных свойств, в частности, укажите **семейство виртуальных машин** и **максимальное количество узлов**, до которого можно развернуть вычислительный объект.  

    ![Заполнение формы](./media/how-to-set-up-training-targets/add-compute-form.png) 

1. Нажмите кнопку __Создать__.


1. Чтобы увидеть состояние операции создания, выберите целевой объект вычислений из списка.

    ![Выбор целевого объекта вычислений, чтобы просмотреть состояние операции создания](./media/how-to-set-up-training-targets/View_list.png)

1. Ниже приведены сведения о выбранном целевом объекте вычислений. 

    ![Просмотр сведений о целевом объекте вычислений](./media/how-to-set-up-training-targets/compute-target-details.png) 



### <a id="portal-reuse"></a>Присоединение целевых объектов вычислений

Чтобы использовать целевые объекты вычислений, созданные за пределами рабочей области Службы машинного обучения Azure, необходимо их присоединить. Присоединение целевого объекта вычислений сделает его доступным для рабочей области.

Выполните описанные ранее шаги, чтобы просмотреть список целевых объектов вычислений. Выполните следующие действия, чтобы присоединить целевой объект вычислений. 

1. Щелкните значок плюса (+), чтобы добавить целевой объект вычислений. 
1. Введите имя для целевого объекта вычислений. 
1. Выберите тип вычислительной среды, который нужно подключить для __обучения__.

    > [!IMPORTANT]
    > Не все типы вычислительных сред можно подключить с помощью портала Azure. Типы вычислительных сред, которые в настоящее время можно подключить для обучения:
    >
    > * Удаленная виртуальная машина.
    > * Azure Databricks (для использования в конвейерах машинного обучения).
    > * Azure Data Lake Analytics (для использования в конвейерах машинного обучения).
    > * Azure HDInsight

1. Заполните форму и укажите значения для обязательных свойств.

    > [!NOTE]
    > Корпорация Майкрософт рекомендует использовать ключи SSH, так как они безопаснее, чем пароли. Пароли подвержены атакам методом подбора. Ключи SSH задействуют криптографические подписи. Сведения о создании ключей SSH для использования на Виртуальных машинах Azure см. в следующих документах:
    >
    > * [Создание и использование ключей SSH в Linux или macOS](https://docs.microsoft.com/azure/virtual-machines/linux/mac-create-ssh-keys)
    > * [Создание и использование ключей SSH в Windows](https://docs.microsoft.com/azure/virtual-machines/linux/ssh-from-windows)

1. Выберите __Подключить__. 
1. Чтобы просмотреть состояние операции подключения, выберите целевой объект вычислений из списка.

## <a name="set-up-with-cli"></a>Настройка с помощью интерфейса командной строки

Чтобы получить доступ к целевым объектам вычислений, которые связаны с вашим рабочим пространством, используйте [расширение CLI](reference-azure-machine-learning-cli.md) для Службы машинного обучения Azure.  Вы можете использовать Azure CLI для таких целей.

* Создание управляемого целевого объекта вычислений.
* Обновление управляемого целевого объекта вычислений.
* Присоединение управляемого целевого объекта вычислений.

Дополнительные сведения см. в разделе [Управление ресурсами](reference-azure-machine-learning-cli.md#resource-management).

## <a name="set-up-with-vs-code"></a>Настройка с помощью VS Code

Можно получить доступ к, создание и управление целевые объекты вычисления, связанные с вашей рабочей области с помощью [расширение VS Code](how-to-vscode-tools.md#create-and-manage-compute-targets) для службы машинного обучения Azure.

## <a id="submit"></a>Отправка запуска на выполнение обучения

После создания конфигурации запуска, используйте ее для выполнения эксперимента.  Шаблон кода для отправки запуска на выполнение обучения одинаковый для всех типов целевых объектов вычислений.

1. Создание эксперимента для запуска
1. Выполните прогон.
1. Дождитесь завершения прогона.

> [!IMPORTANT]
> При отправке выполнения обучения, моментальный снимок в каталог, содержащий скрипты обучения создается и отправляется целевого объекта вычислений. Он также сохранится как часть эксперимента в рабочей области. Если изменить файлы и отправьте запуска еще раз, будет отправляться только измененные файлы.
>
> Чтобы заблокировать развертывание файлов, включаемого в моментальном снимке, создайте [.gitignore](https://git-scm.com/docs/gitignore) или `.amlignore` в каталоге и добавьте файлы к нему. `.amlignore` Файл использует тот же синтаксис и шаблоны как [.gitignore](https://git-scm.com/docs/gitignore) файла. Если существуют оба файла, `.amlignore` файл имеет приоритет.
> 
> Дополнительные сведения см. в разделе о [моментальных снимках](concept-azure-machine-learning-architecture.md#snapshots).

### <a name="create-an-experiment"></a>Создание эксперимента

Сначала создайте эксперимент в рабочей области.

[!code-python[](~/aml-sdk-samples/ignore/doc-qa/how-to-set-up-training-targets/local.py?name=experiment)]

### <a name="submit-the-experiment"></a>Отправка эксперимента

Отправка эксперимента с помощью объекта `ScriptRunConfig`.  Этот объект включает в себя следующее.

* **source_directory**: исходный каталог, который содержит сценарий обучения.
* **script**: определение сценария обучения.
* **run_config**: конфигурация запуска, которая, в свою очередь, определяет, где будет проходить обучение.

Например, чтобы использовать [локальную конфигурацию](#local) целевого объекта, выполните следующее.

[!code-python[](~/aml-sdk-samples/ignore/doc-qa/how-to-set-up-training-targets/local.py?name=local_submit)]

Переключите тот же эксперимент для запуска в другом целевом объекте вычислений, используя другую конфигурацию запуска, такую ​​как [amlcompute target](#amlcompute).

[!code-python[](~/aml-sdk-samples/ignore/doc-qa/how-to-set-up-training-targets/amlcompute2.py?name=amlcompute_submit)]

Также вы можете:

* отправить эксперимент с объектом `Estimator`, как показано в разделе [Обучение моделей машинного обучения с использованием средства оценки](how-to-train-ml-models.md);
* отправить эксперимент [с помощью расширения интерфейса командной строки](reference-azure-machine-learning-cli.md#experiments).
* Отправки эксперимента с помощью [расширение VS Code](how-to-vscode-tools.md#train-and-tune-models).

## <a name="github-tracking-and-integration"></a>Отслеживание GitHub и интеграции

При запуске обучения, выполните, где исходный каталог является локальный репозиторий Git, сведения о хранилище хранятся в журнале выполнения. Например текущих Идентификаторов фиксаций репозитория, регистрируется как часть журнала.

## <a name="notebook-examples"></a>Примеры записных книжек

Посмотрите примеры обучения различных целевых объектов вычислений в следующих записных книжках.
* [how-to-use-azureml/training](https://github.com/Azure/MachineLearningNotebooks/blob/master/how-to-use-azureml/training)
* [tutorials/img-classification-part1-training.ipynb](https://github.com/Azure/MachineLearningNotebooks/blob/master/tutorials/img-classification-part1-training.ipynb)

[!INCLUDE [aml-clone-in-azure-notebook](../../../includes/aml-clone-for-examples.md)]

## <a name="next-steps"></a>Дальнейшие действия

* [Учебник. по обучению модели классификации изображений с помощью Службы машинного обучения Azure](tutorial-train-models-with-aml.md). В нем используется управляемый целевой объект вычислений для обучения модели.
* Узнайте, как [эффективно настроить гиперпараметры](how-to-tune-hyperparameters.md) создавать более эффективные модели.
* После обучения модели узнайте о [способах и расположениях развертывания моделей](how-to-deploy-and-where.md).
* Обзор справочника по пакету SDK [класса RunConfiguration](https://docs.microsoft.com/python/api/azureml-core/azureml.core.runconfig.runconfiguration?view=azure-ml-py).
* [Securely run experiments and inferencing inside an Azure Virtual Network](how-to-enable-virtual-network.md) (Безопасное выполнение экспериментов и формирование выводов внутри виртуальной сети Azure)
