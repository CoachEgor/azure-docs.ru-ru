---
title: Меняйте ключи доступа учетной записи хранения
titleSuffix: Azure Machine Learning service
description: Узнайте, как менять ключи доступа учетной записи хранения Azure, используемые вашей рабочей области. Служба машинного обучения Azure использует учетную запись хранилища Azure для хранения данных и моделей. При повторном создании ключа доступа учетной записи хранения, необходимо обновить службы машинного обучения Azure, чтобы использовать новые ключи.
services: machine-learning
ms.service: machine-learning
ms.subservice: core
ms.topic: conceptual
ms.author: aashishb
author: aashishb
ms.reviewer: larryfr
ms.date: 05/17/2019
ms.openlocfilehash: 488a032e177897caf2897ba6335f4e7f64dc0e4d
ms.sourcegitcommit: 5bdd50e769a4d50ccb89e135cfd38b788ade594d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/03/2019
ms.locfileid: "67543831"
---
# <a name="regenerate-storage-account-access-keys"></a>Повторное создание ключей доступа учетной записи хранения

Узнайте, как менять ключи доступа для учетных записей хранения Azure, используемые службой машинного обучения Azure. Служба машинного обучения Azure можно использовать учетные записи хранения для хранения данных или обученные модели.

В целях безопасности необходимо менять ключи доступа для учетной записи хранения Azure. При повторном создании ключа доступа, машинного обучения Azure необходимо обновить для использования нового ключа. Машинное обучение Azure могут использовать учетную запись хранения для обоих хранилища модели, а также как хранилище данных.

## <a name="prerequisites"></a>Технические условия

* Рабочая область службы машинного обучения Azure. Дополнительные сведения см. в разделе [создать рабочую область](setup-create-workspace.md) статьи.

* [Машинном обучении Azure SDK](https://docs.microsoft.com/python/api/overview/azure/ml/install?view=azure-ml-py).

* [Расширение интерфейса командной строки Azure Machine Learning](reference-azure-machine-learning-cli.md).

<a id="whattoupdate"></a> 

## <a name="what-needs-to-be-updated"></a>Что необходимо обновить

Учетные записи хранения может использоваться в рабочей области службы машинного обучения Azure (хранения журналов, моделей, моментальные снимки и др.) и как хранилище данных. Процесс обновления рабочей области использовать одну команду интерфейса командной строки Azure и может выполняться после обновления ключа хранилища. Процесс обновления хранилища данных требует больше усилий и требует обнаружения, какие хранилища данных в настоящее время при использовании учетной записи хранения и затем заново их регистрации.

> [!IMPORTANT]
> Обновление рабочей области с помощью интерфейса командной строки Azure и хранилища данных с помощью Python, в то же время. Обновление только тот или иной недостаточно и может привести к ошибкам, пока не обновляются.

Чтобы найти учетные записи хранения, используемые вашего хранилища данных, используйте следующий код:

```python
import azureml.core
from azureml.core import Workspace, Datastore

ws = Workspace.from_config()

default_ds = ws.get_default_datastore()
print("Default datstore: " + default_ds.name + ", storage account name: " + default_ds.account_name + ", container name: " + ds.container_name)

datastores = ws.datastores
for name, ds in datastores.items():
    if ds.datastore_type == "AzureBlob" or ds.datastore_type == "AzureFile":
        print("datastore name: " + name + ", storage account name: " + ds.account_name + ", container name: " + ds.container_name)
```

Этот код выполняет поиск любого зарегистрированного хранилища данных, используйте службу хранилища Azure и содержит следующую информацию:

* Имя хранилища данных: Имя хранилища данных, использованной при регистрации учетной записи хранения.
* Имя учетной записи хранения: Имя учетной записи хранения Azure.
* Контейнер: Контейнер в учетной записи хранения, используемый этой регистрации.

Если запись существует, вы планируете повторное создание ключей доступа для учетной записи хранения, сохраните имя хранилища данных, имя учетной записи хранения и имя контейнера.

## <a name="update-the-access-key"></a>Обновите ключ доступа

Чтобы обновить службу машинного обучения Azure для использования нового ключа, выполните следующие действия:

> [!IMPORTANT]
> Выполните все действия, обновление и рабочей области с помощью интерфейса командной строки, а также хранилища данных с помощью Python. Обновление только тот или иной может привести к ошибкам, пока не обновляются.

1. Повторно создайте ключ. Сведения о повторном создании ключа доступа, см. в разделе [Управление учетной записью хранения](/azure/storage/common/storage-account-manage#access-keys) статьи. Сохраните новый ключ.

1. Чтобы обновить рабочую область, для использования нового ключа, сделайте следующее:

    1. Для входа в подписку Azure, которая содержит рабочую область с помощью следующей команды Azure CLI:

        ```azurecli-interactive
        az login
        ```

    1. Чтобы установить расширение машинного обучения Azure, используйте следующую команду:

        ```azurecli-interactive
        az extension add -n azure-cli-ml 
        ```

    1. Чтобы обновить рабочую область, для использования нового ключа, используйте следующую команду. Замените `myworkspace` имя рабочей области машинного обучения Azure и замените `myresourcegroup` с именем группы ресурсов Azure, которая содержит рабочую область.

        ```azurecli-interactive
        az ml workspace sync-keys -w myworkspace -g myresourcegroup
        ```

        Эта команда автоматически синхронизирует новые ключи учетной записи хранения Azure, использует рабочая область.

1. Чтобы повторно зарегистрировать хранилища данных, используйте учетную запись хранения, используйте значения из [что необходимо обновить](#whattoupdate) раздела и ключ из шага 1 со следующим кодом:

    ```python
    ds = Datastore.register_azure_blob_container(workspace=ws, 
                                              datastore_name='your datastore name', 
                                              container_name='your container name',
                                              account_name='your storage account name', 
                                              account_key='new storage account key',
                                              overwrite=True)
    ```

    Так как `overwrite=True` указано, этот код перезаписывает существующую регистрацию и обновляет его для использования нового ключа.

## <a name="next-steps"></a>Дальнейшие действия

Дополнительные сведения о регистрации хранилища данных, см. в разделе [ `Datastore` ](https://docs.microsoft.com/python/api/azureml-core/azureml.core.datastore(class)?view=azure-ml-py) класса ссылки.
