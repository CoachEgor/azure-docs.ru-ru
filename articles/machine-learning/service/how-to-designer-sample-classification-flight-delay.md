---
title: 'Конструктор: пример прогноза задержки рейса'
titleSuffix: Azure Machine Learning
description: Создание классификатора и использование пользовательского кода R для прогнозирования задержек рейсов с помощью конструктора Машинное обучение Azure.
services: machine-learning
ms.service: machine-learning
ms.subservice: core
ms.topic: conceptual
author: xiaoharper
ms.author: zhanxia
ms.reviewer: peterlu
ms.date: 11/04/2019
ms.openlocfilehash: 06d158fb228ea82e61e785407fc0c59d66c2de15
ms.sourcegitcommit: 8e31a82c6da2ee8dafa58ea58ca4a7dd3ceb6132
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/19/2019
ms.locfileid: "74196022"
---
# <a name="build-a-classifier--use-r-to-predict-flight-delays-with-azure-machine-learning-designer"></a>Создание классификатора & использование R для прогнозирования задержек рейсов с помощью конструктора Машинное обучение Azure

**Конструктор (Предварительная версия) — пример 6**

[!INCLUDE [applies-to-skus](../../../includes/aml-applies-to-enterprise-sku.md)]

Этот конвейер использует исторические и погодные данные для прогнозирования того, что запланированный перелет пассажиров будет задержан более чем на 15 минут. Эта проблема может быть вызвана проблемой классификации, предсказанием двух классов: отложенным или вовремя.

Вот итоговый граф конвейера для этого примера:

[![граф конвейера](media/how-to-ui-sample-classification-predict-flight-delay/pipeline-graph.png)](media/how-to-ui-sample-classification-predict-credit-risk-cost-sensitive/graph.png#lightbox)

## <a name="prerequisites"></a>предварительным требованиям

[!INCLUDE [aml-ui-prereq](../../../includes/aml-ui-prereq.md)]

4. Щелкните пример 6, чтобы открыть его.

## <a name="get-the-data"></a>Получение данных

В этом образце используется набор **данных «задержки рейсов»** . Он является частью сбора данных Транстатс из Департамента транспортировки США. Набор данных содержит сведения о задержке рейсов от апреля до октября 2013. Набор данных предварительно обработан следующим образом:

* Отфильтрованы, чтобы включить 70 в континентальной частиные аэропорты в США.
* Переметка отмененных авиарейсов была отложена более чем на 15 минут.
* Отфильтрованные рейси.
* Выбрано 14 столбцов.

Для дополнения данных рейсов используется **набор данных погоды** . Данные погоды содержат почасовые наблюдения погоды на основе земли из NOAA и представляют наблюдения на станциях погоды в аэропорту, охватывающие тот же период времени, что и набор данных рейсов. Она была предварительно обработана следующим образом:

* Идентификаторы станции погоды сопоставлены с соответствующими идентификаторами аэропорта.
* Удалены станции погоды, не связанные с 70, которые были загружены в аэропорту.
* Столбец дат был разбит на отдельные столбцы: год, месяц и день.
* Выбрано 26 столбцов.

## <a name="pre-process-the-data"></a>Предварительная обработка данных

Прежде чем можно будет анализировать набор данных, обычно требуется предварительная обработка.

![процесс обработки и анализа данных](media/how-to-ui-sample-classification-predict-flight-delay/data-process.png)

### <a name="flight-data"></a>Данные рейсов

Столбцы **перевозчика**, **OriginAirportID**и **DestAirportID** сохраняются как целые числа. Однако они используют атрибуты категории, для преобразования их в категоризацию используется модуль **Редактирование метаданных** .

![изменение метаданных](media/how-to-ui-sample-classification-predict-flight-delay/edit-metadata.png)

Затем используйте модуль **Выбор столбцов** в наборе данных, чтобы исключить из столбцов набора данных возможные целевые утечки: **DepDelay**, **DepDel15**, **ArrDelay**, **Canceled**, **year**. 

Чтобы соединить записи о перелетах с почасовыми записями погоды, используйте запланированное время отправления как один из ключей объединения. Чтобы выполнить соединение, столбец Ксрдептиме должен быть округлен вниз до ближайшего часа, что выполняется в модуле **выполнить сценарий R** . 

### <a name="weather-data"></a>Метеоданные

Столбцы, имеющие большую долю отсутствующих значений, исключаются с помощью модуля **столбцы проекта** . Эти столбцы включают все столбцы со строковыми значениями: **валуефорвиндчарактер**, **ветбулбфаренхеит**, **ветбулбцелсиус**, **прессуретенденци**, **прессуречанже**, **SeaLevelPressure**и **StationPressure** .

Затем модуль **Clean Missing Data (очистка недостающих данных** ) применяется к оставшимся столбцам для удаления строк с отсутствующими данными.

Время наблюдения погоды округляется до ближайшего полного часа. Время запланированного рейса и время наблюдения погоды округляются в противоположных направлениях, чтобы гарантировать, что модель использует только Погода до времени рейса. 

Так как данные о погоде передаются в местное время, разница часовых поясов учитывается путем вычитания столбцов часовых поясов из запланированного времени отправления и времени наблюдения погоды. Эти операции выполняются с помощью модуля **выполнить сценарий R** .

### <a name="joining-datasets"></a>Соединение наборов данных

Записи о рейсах соединяются с данными о погоде в источнике рейса (**OriginAirportID**) с помощью модуля **объединения данных** .

 ![Присоединяйтесь к рейсу и погоду по источнику](media/how-to-ui-sample-classification-predict-flight-delay/join-origin.png)


Записи о рейсах соединяются с данными погоды с помощью назначения рейса (**DestAirportID**).

 ![Присоединяйтесь к рейсу и погоду по назначению](media/how-to-ui-sample-classification-predict-flight-delay/join-destination.png)

### <a name="preparing-training-and-test-samples"></a>Подготовка образцов для обучения и тестирования

Модуль **Split Data (разделение данных** ) разделяет данные на записи в апреле по сентябрьским материалам для обучения и в октябре для тестирования.

 ![Разделение обучающих и проверочных данных](media/how-to-ui-sample-classification-predict-flight-delay/split.png)

Столбцы "год", "месяц" и "часовой пояс" удаляются из набора данных для обучения с помощью модуля выбор столбцов.

## <a name="define-features"></a>Определение признаков

В машинном обучении функции — это отдельные измеримые свойства чего-то, о чем вы заинтересованы. Для поиска строгого набора функций требуется экспериментирование и знание предметной области. Некоторые свойства лучше подходят для прогнозирования цели, чем другие. Кроме того, некоторые функции могут иметь надежную корреляцию с другими функциями и не будут добавлять в модель новые сведения. Эти функции можно удалить.

Для построения модели можно использовать все доступные функции или выбрать подмножество функций.

## <a name="choose-and-apply-a-learning-algorithm"></a>Выбор и применение алгоритма обучения

Создайте модель с помощью модуля **логистической регрессии с двумя классами** и обучите набор данных для обучения. 

Результатом работы модуля **обучение модели** является обученная модель классификации, которую можно использовать для оценки новых образцов для создания прогнозов. Используйте проверочный набор для создания оценок из обученных моделей. Затем используйте модуль « **Анализ модели** » для анализа и сравнения качества моделей.
конвейер после запуска конвейера можно просмотреть выходные данные модуля **Оценка модели** , щелкнув порт вывода и выбрав **визуализировать**. Выходные данные включают оцененные метки и вероятности для меток.

Наконец, чтобы проверить качество результатов, добавьте модуль « **Оценка модели** » на холст конвейера и Соедините левый входной порт с выходными данными модуля оценки модели. Запустите конвейер и просмотрите выходные данные модуля **Анализ модели** , щелкнув порт вывода и выбрав **визуализировать**.

## <a name="evaluate"></a>Evaluate
Модель логистической регрессии имеет AUC из 0,631 в тестовом наборе.

 ![evaluate](media/how-to-ui-sample-classification-predict-flight-delay/evaluate.png)

## <a name="next-steps"></a>Дополнительная информация

Изучите другие примеры, доступные для конструктора:

- [Пример 1. регрессия: прогнозирование цены автомобиля](how-to-designer-sample-regression-automobile-price-basic.md)
- [Пример 2. регрессия. алгоритмы сравнения для прогнозирования цен автомобилей](how-to-designer-sample-regression-automobile-price-compare-algorithms.md)
- [Пример 3. Классификация с выбором компонентов: прогноз дохода](how-to-designer-sample-classification-predict-income.md)
- [Пример 4. Классификация: прогнозируемый кредитный риск (с учетом стоимости)](how-to-designer-sample-classification-credit-risk-cost-sensitive.md)
- [Пример 5. Классификация: обработка прогнозов](how-to-designer-sample-classification-churn.md)
- [Пример 7. Классификация текста: набор данных Википедии SP 500](how-to-designer-sample-text-classification.md)