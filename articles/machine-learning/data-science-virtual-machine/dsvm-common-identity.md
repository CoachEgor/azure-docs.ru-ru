---
title: Настройка общей идентификации
titleSuffix: Azure Data Science Virtual Machine
description: Узнайте, как создавать общие учетные записи пользователей, которые можно использовать в нескольких Виртуальных машинах для обработки и анализа данных. Для аутентификации пользователей в Виртуальной машине для обработки и анализа данных можно использовать Azure Active Directory или локальную службу Active Directory.
keywords: deep learning, AI, data science tools, data science virtual machine, geospatial analytics, team data science process
services: machine-learning
ms.service: machine-learning
ms.subservice: data-science-vm
author: vijetajo
ms.author: vijetaj
ms.topic: conceptual
ms.date: 05/08/2018
ms.openlocfilehash: 44f1f7ae3b290e1dbf01877f3881e1d95a238446
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/27/2020
ms.locfileid: "70208141"
---
# <a name="set-up-a-common-identity-on-a-data-science-virtual-machine"></a>Настройка общей идентификации на виртуальной машине Data Science

На виртуальной машине Microsoft Azure (VM), включая виртуальную машину Data Science (DSVM), вы создаете локальные учетные записи пользователей при подготовке VM. С помощью их учетных данных пользователи проходят аутентификацию на данной виртуальной машине. Если у вас есть несколько VMs, к которым необходимо получить доступ пользователям, управление учетными данными может стать очень громоздким. Отличным решением является развертывание общих учетных записей пользователей и управления через поставщика идентификационных данных, основанного на стандартах. Благодаря этому подходу можно использовать единый набор учетных данных для доступа к нескольким ресурсам Azure, включая несколько DSVM.

Active Directory является популярным поставщиком идентификационных данных и поддерживается в Azure как облачным сервисом, так и в качестве предприимчивого каталога. Используя Azure Active Directory (Azure AD) или локальный каталога Active Directory, можно аутентифицировать пользователей на изолированной виртуальной машине для обработки и анализа данных или кластере DSVM, размещенном в масштабируемом наборе виртуальных машин Azure. Для этого следует присоединить экземпляры DSVM к домену Active Directory.

Если у вас уже есть Active Directory, вы можете использовать его в качестве общего поставщика идентификационных данных. Если у вас нет Active Directory, можно запустить управляемый экземпляр Active Directory в Azure через службы [активных каталогов Azure](https://docs.microsoft.com/azure/active-directory-domain-services/) (Azure AD DS).

Документация для [Azure AD](https://docs.microsoft.com/azure/active-directory/) содержит подробные [инструкции по управлению,](https://docs.microsoft.com/azure/active-directory/choose-hybrid-identity-solution)включая рекомендации по подключению Azure AD к вашему каталогу, если он у вас есть.

В этой статье описывается, как настроить полностью управляемый служба домена Active Directory в Azure с помощью Azure AD DS. Затем можно присоединиться к DSVM в управляемый домен Active Directory. Такой подход позволяет пользователям получить доступ к пулу DSVMs (и других ресурсов Azure) через общую учетную запись пользователя и учетные данные.

## <a name="set-up-a-fully-managed-active-directory-domain-on-azure"></a>Настройка полностью управляемого домена Active Directory в Azure

Azure AD DS упрощает управление вашими удостоверениями, предоставляя полностью управляемую службу в Azure. В данном домене Active Directory вы можете управлять пользователями и группами. Чтобы настроить в каталоге домена Active Directory и учетные записи пользователей, размещенные на базе Azure, выполните следующие действия:

1. Добавьте пользователя в Active Directory на портале Azure. 

   1. Войти на службу в [центр админ-аналитики Active Directory,](https://aad.portal.azure.com) используя учетную запись, которая является глобальным админом для каталога.
    
   1. Выберите **Azure Active Directory**, а затем щелкните **Пользователи и группы**.
    
   1. В **пользователях и группах**выберите **всех пользователей,** а затем выберите **нового пользователя.**
   
           The **User** pane opens:
      
      ![Область "Пользователь"](./media/add-user.png)
    
   1. Введите сведения о пользователе в соответствующих полях, например **Имя** и **Имя пользователя**. Частью имени пользователя, представляющей собой доменное имя, должно быть доменное имя по умолчанию, [domain name].onmicrosoft.com, или проверенное доменное имя, не являющееся федеративным, например [настроить доменное имя](../../active-directory/add-custom-domain.md) contoso.com.
    
   1. Скопируйте или иным способом запишите созданный пароль пользователя, чтобы после завершения этого процесса его можно было предоставить пользователю.
    
   1. При необходимости можно указать сведения, открыв колонку **Профиль**, **Группы** или **Роль каталога** для пользователя. 
    
   1. Под **пользователем,** выберите **Создать**.
    
   1. Безопасно распределите генерируемый пароль среди нового пользователя, чтобы он мог войти в систему.

1. Создайте экземпляр Azure AD DS. Следуйте инструкциям в [службах домена Active Directory Спомощьу С помощью портала Azure](https://docs.microsoft.com/azure/active-directory-domain-services/active-directory-ds-getting-started) (раздел "Создание экземпляра и настройка базовых настроек"). Очень важно обновить существующие пароли пользователей в Active Directory, чтобы синхронизировать их с паролями в Azure AD DS. Также важно добавить DNS в DD Azure AD, как описано в разделе «Заполните поля в окне основ портала Azure для создания экземпляра Azure AD DS» в этом разделе.

1. Создайте отдельную подсеть DSVM в виртуальной сети, созданную в разделе «Создание и настройка виртуальной сети» предыдущего шага.
1. Создайте один или несколько экземпляров DSVM в подсети DSVM.
1. Следуйте [инструкциям](https://docs.microsoft.com/azure/active-directory-domain-services/active-directory-ds-join-ubuntu-linux-vm ) по добавлению DSVM в Active Directory. 
1. Установите совместное использование файлов Azure, чтобы разместить каталог вашего дома или ноутбука, чтобы ваше рабочее пространство можно было установить на любую машину. (Если вам нужны жесткие разрешения на уровне файлов, вам понадобится сетевая файловая система (NFS), работая на одном или нескольких vMs.)

   1. [Создайте общий ресурс службы файлов Azure](../../storage/files/storage-how-to-create-file-share.md).
    
   2.  Установите эту долю на Linux DSVM. При выборе **раздела Connect** для раздела файлов Azure в учетной записи хранилища на портале Azure появляется команда для выполнения в оболочке Bash на Linux DSVM. Эта команда выглядит следующим образом:
   
   ```
   sudo mount -t cifs //[STORAGEACCT].file.core.windows.net/workspace [Your mount point] -o vers=3.0,username=[STORAGEACCT],password=[Access Key or SAS],dir_mode=0777,file_mode=0777,sec=ntlmssp
   ```
1. Например, предположим, что вы смонтировали долю файлов Azure в /данных/рабочей области. Теперь создайте каталоги для каждого из пользователей в акции: /data/workspace/user1, /data/workspace/user2 и так далее. Создайте каталог `notebooks` в рабочей области каждого пользователя. 
1. Создайте символьные ссылки для `notebooks` в `$HOME/userx/notebooks/remote`.   

Теперь у вас есть пользователи в экземпляре Active Directory, размещенные в Azure. Используя учетные данные Active Directory, пользователи могут войти в любой DSVM (SSH или JupyterHub), который присоединился к DS Azure AD. Так как рабочая область пользователя находится в общем ресурсе службы файлов Azure, у пользователей будет доступ к элементам Notebook и другим рабочим ресурсам с любой виртуальной машины для обработки и анализа данных при использовании JupyterHub.

Для автоматического масштабирования вы можете использовать масштабируемый набор виртуальных машин, чтобы создать пул виртуальных машин, которые все подключены к домену таким образом и к которым подключен общий диск. Пользователи могут войти в любую доступную машину в наборе виртуальной шкалы машин и получить доступ к общему диску, где сохраняются их ноутбуки. 

## <a name="next-steps"></a>Дальнейшие действия

* [Безопасное хранение учетных данных для доступа на виртуальной машине для обработки и анализа данных](dsvm-secure-access-keys.md)



