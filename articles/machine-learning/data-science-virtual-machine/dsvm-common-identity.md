---
title: Настройка общего удостоверения
titleSuffix: Azure Data Science Virtual Machine
description: Узнайте, как создавать общие учетные записи пользователей, которые можно использовать в нескольких Виртуальных машинах для обработки и анализа данных. Для аутентификации пользователей в Виртуальной машине для обработки и анализа данных можно использовать Azure Active Directory или локальную службу Active Directory.
keywords: deep learning, AI, data science tools, data science virtual machine, geospatial analytics, team data science process
services: machine-learning
ms.service: machine-learning
ms.subservice: data-science-vm
author: vijetajo
ms.author: vijetaj
ms.topic: conceptual
ms.date: 05/08/2018
ms.openlocfilehash: 5cd310dac28b999af3d21c46b108abdc6d5779b5
ms.sourcegitcommit: 532335f703ac7f6e1d2cc1b155c69fc258816ede
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/30/2019
ms.locfileid: "70192233"
---
# <a name="set-up-a-common-identity-on-the-data-science-virtual-machine"></a>Настройка общего удостоверения для виртуальной машины для обработки и анализа данных в Azure

На подготавливаемой виртуальной машине Azure, включая виртуальную машину для обработки и анализа данных (DSVM), создаются учетные записи локальных пользователей. С помощью их учетных данных пользователи проходят аутентификацию на данной виртуальной машине. Если у вас несколько виртуальных машин, к которым вам нужен доступ, при применении такого подхода управление учетными данными становится затруднительным. При использовании общих учетных записей пользователей и управлении с помощью поставщиков удостоверений на основе стандартов вы можете получать доступ к нескольким ресурсам в Azure, включая несколько виртуальных машин для обработки и анализа данных, используя один набор учетных данных. 

Active Directory — это популярный поставщик удостоверений, который поддерживается в Azure в качестве службы, а также в локальной среде. Используя Azure Active Directory (Azure AD) или локальный каталога Active Directory, можно аутентифицировать пользователей на изолированной виртуальной машине для обработки и анализа данных или кластере DSVM, размещенном в масштабируемом наборе виртуальных машин Azure. Для этого следует присоединить экземпляры DSVM к домену Active Directory. 

Если у вас уже настроена служба Active Directory для управления удостоверениями, ее можно использовать как общий поставщик удостоверений. При отсутствии Active Directory вы можете запустить управляемый экземпляр Active Directory в Azure с помощью [доменных служб Azure Active Directory](https://docs.microsoft.com/azure/active-directory-domain-services/) (Azure AD DS). 

В документации по [Azure AD](https://docs.microsoft.com/azure/active-directory/) содержатся подробные [инструкции по управлению](https://docs.microsoft.com/azure/active-directory/choose-hybrid-identity-solution), включая подключение Azure AD к локальному каталогу, если таковой имеется. 

В этой статье описывается настройка полностью управляемой доменной службы Active Directory в Azure с помощью Azure AD DS. Затем можно присоединить виртуальные машины для обработки и анализа данных к управляемому домену Active Directory, чтобы предоставить пользователям доступ к пулу DSVM (и другим ресурсам Azure) с помощью общей учетной записи и учетных данных. 

## <a name="set-up-a-fully-managed-active-directory-domain-on-azure"></a>Настройка полностью управляемого домена Active Directory в Azure

Azure AD DS упрощает управление вашими удостоверениями, предоставляя полностью управляемую службу в Azure. В данном домене Active Directory вы можете управлять пользователями и группами. Ниже приведены шаги для настройки размещенного в Azure домена Active Directory и учетных записей пользователей в вашем каталоге.

1. Добавьте пользователя в Active Directory на портале Azure. 

   1\. Войдите в [Центр администрирования Azure Active Directory](https://aad.portal.azure.com) с помощью учетной записи глобального администратора каталога.
    
   2\. Выберите **Azure Active Directory**, а затем щелкните **Пользователи и группы**.
    
   В. В колонке **Пользователи и группы** выберите **Все пользователи** и щелкните **Новый пользователь**.
   
      Откроется область **Пользователь**.
      
      ![Область "Пользователь"](./media/add-user.png)
    
   Г. Введите сведения о пользователе в соответствующих полях, например **Имя** и **Имя пользователя**. Частью имени пользователя, представляющей собой доменное имя, должно быть доменное имя по умолчанию, [domain name].onmicrosoft.com, или проверенное доменное имя, не являющееся федеративным, например [настроить доменное имя](../../active-directory/add-custom-domain.md) contoso.com.
    
   Д. Скопируйте или иным способом запишите созданный пароль пользователя, чтобы после завершения этого процесса его можно было предоставить пользователю.
    
   f. При необходимости можно указать сведения, открыв колонку **Профиль**, **Группы** или **Роль каталога** для пользователя. 
    
   ж. В разделе **Пользователь** выберите **Создать**.
    
   h. Безопасным способом передайте созданный пароль новому пользователю, чтобы он мог войти в систему.

1. Создайте экземпляр Azure AD DS. Следуйте инструкциям в статье [Включение доменных служб Azure Active Directory с помощью портала Azure](https://docs.microsoft.com/azure/active-directory-domain-services/active-directory-ds-getting-started) (задачи 1–5). Очень важно обновить существующие пароли пользователей в Active Directory, чтобы синхронизировать их с паролями в Azure AD DS. Также важно добавить DNS в Azure AD DS, как описано в задаче 4 указанной выше статьи. 

1. Создайте отдельную подсеть DSVM в виртуальной сети, созданной в задаче 2 предыдущего шага.
1. Создайте один или несколько экземпляров виртуальной машины для обработки и анализа данных в подсети DSVM. 
1. Выполните [инструкции](https://docs.microsoft.com/azure/active-directory-domain-services/active-directory-ds-join-ubuntu-linux-vm ) по добавлению виртуальной машины для обработки и анализа данных в Active Directory. 
1. Подключите общий ресурс службы файлов Azure, чтобы разместить свой домашний каталог или каталог Notebook для подключения рабочей области на любом компьютере. (Если вам необходимы ограниченные разрешения на уровне файла, вам потребуется система NFS на одной или нескольких виртуальных машинах.)

   1\. [Создайте общий ресурс службы файлов Azure](../../storage/files/storage-how-to-create-file-share.md).
    
   2\. Подключите его к Linux DSVM. Когда вы нажмете кнопку **Подключиться** для общего ресурса службы файлов Azure в вашей учетной записи хранения на портале Azure, отобразится команда для выполнения в оболочке Bash на виртуальной машине для обработки и анализа данных Linux. Эта команда выглядит следующим образом:
   
   ```
   sudo mount -t cifs //[STORAGEACCT].file.core.windows.net/workspace [Your mount point] -o vers=3.0,username=[STORAGEACCT],password=[Access Key or SAS],dir_mode=0777,file_mode=0777,sec=ntlmssp
   ```
1. Предположим, вы подключили общий ресурс службы файлов Azure к каталогу /data/workspace. Теперь создайте каталоги для всех пользователей в общем ресурсе: /data/workspace/user1, /data/workspace/user2 и т. д. Создайте каталог `notebooks` в рабочей области каждого пользователя. 
1. Создайте символьные ссылки для `notebooks` в `$HOME/userx/notebooks/remote`.   

Вы добавили пользователей в экземпляр Active Directory, размещенный в Azure. С помощью учетных данных Active Directory пользователи могут войти на любую виртуальную машину для обработки и анализа данных (используя SSH или JupyterHub), которая присоединена к Azure AD DS. Так как рабочая область пользователя находится в общем ресурсе службы файлов Azure, у пользователей будет доступ к элементам Notebook и другим рабочим ресурсам с любой виртуальной машины для обработки и анализа данных при использовании JupyterHub. 

Для автоматического масштабирования вы можете использовать масштабируемый набор виртуальных машин, чтобы создать пул виртуальных машин, которые все подключены к домену таким образом и к которым подключен общий диск. Теперь пользователи могут входить в систему любой доступной виртуальной машины в масштабируемом наборе и имеют доступ к общему диску, где сохранены их элементы Notebook. 

## <a name="next-steps"></a>Следующие шаги

* [Безопасное хранение учетных данных для доступа на виртуальной машине для обработки и анализа данных](dsvm-secure-access-keys.md)



