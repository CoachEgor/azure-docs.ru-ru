---
title: Общие сведения о изоляции и конфиденциальности виртуальной сети
titleSuffix: Azure Machine Learning
description: Используйте изолированную виртуальную сеть Azure с Машинное обучение Azure для защиты ресурсов рабочей области и вычислительных сред.
services: machine-learning
ms.service: machine-learning
ms.subservice: core
ms.reviewer: larryfr
ms.author: peterlu
author: peterclu
ms.date: 09/30/2020
ms.topic: conceptual
ms.custom: how-to, devx-track-python, references_regions, contperfq1
ms.openlocfilehash: d4690062dead8186022cc53ca47dbc7e17a9376f
ms.sourcegitcommit: d479ad7ae4b6c2c416049cb0e0221ce15470acf6
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/01/2020
ms.locfileid: "91631194"
---
# <a name="virtual-network-isolation-and-privacy-overview"></a>Общие сведения о изоляции и конфиденциальности виртуальной сети

Из этой статьи вы узнаете, как использовать виртуальные сети (виртуальных сетей) для защиты сетевого взаимодействия в Машинное обучение Azure. В этой статье используется пример сценария, демонстрирующий настройку полной виртуальной сети.

Эта статья является частью серии из пяти частей, которая поможет вам в обеспечении безопасности Машинное обучение Azure рабочего процесса. Мы настоятельно рекомендуем сначала ознакомиться с этой обзорной статьей, чтобы понять основные понятия. 

Ниже приведены другие статьи этой серии.

**1. Обзор виртуальной сети**  >  [2. Обеспечьте безопасность рабочей области](how-to-secure-workspace-vnet.md)  >  [3. Обеспечьте безопасность среды обучения](how-to-secure-training-vnet.md)  >  [4. Обеспечьте безопасность окружения](how-to-secure-inferencing-vnet.md)  >  [5. Включить функциональные возможности студии](how-to-enable-studio-virtual-network.md)

## <a name="prerequisites"></a>Предварительные требования

В этой статье предполагается, что вы знакомы со следующими разделами:
+ [Виртуальные сети Azure](https://docs.microsoft.com/azure/virtual-network/virtual-networks-overview)
+ [IP-сети](https://docs.microsoft.com/azure/virtual-network/virtual-network-ip-addresses-overview-arm)
+ [Приватный канал Azure](how-to-configure-private-link.md)
+ [Группы безопасности сети](../virtual-network/security-overview.md)
+ [Сетевые брандмауэры](../firewall/overview.md)

## <a name="example-scenario"></a>Пример сценария

В этом разделе вы узнаете, как настроить общий сетевой сценарий для защиты Машинное обучение Azure связи с частными IP-адресами.

В таблице ниже сравнивается, как службы обращаются к различным частям сети Машинное обучение Azure как с виртуальной сетью, так и без нее.

| Сценарий | Рабочая область | Связанные ресурсы | Среда вычислений для обучения | Вывод среды вычислений |
|-|-|-|-|-|-|
|**Нет виртуальной сети**| Общедоступный IP-адрес | Общедоступный IP-адрес | Общедоступный IP-адрес | Общедоступный IP-адрес |
|**Защита ресурсов в виртуальной сети**| Частный IP-адрес (частная конечная точка) | Общедоступный IP-адрес (конечная точка службы) <br> **ни** <br> Частный IP-адрес (частная конечная точка) | Частный IP-адрес | Частный IP-адрес  | 

* **Рабочая область** . Создайте закрытую конечную точку из виртуальной сети для подключения к частной ссылке в рабочей области. Частная конечная точка подключает рабочую область к виртуальной сети через несколько частных IP-адресов.
* **Связанные** ресурсы — используйте конечные точки службы или частные конечные точки для подключения к ресурсам рабочей области, таким как служба хранилища azure, Azure Key Vault и службы контейнеров Azure.
    * **Конечные точки службы** обеспечивают удостоверение виртуальной сети для службы Azure. После включения конечных точек службы в виртуальной сети можно добавить правило виртуальной сети для защиты ресурсов службы Azure в виртуальной сети. Конечные точки службы используют общедоступные IP-адреса.
    * **Частные конечные точки** — это сетевые интерфейсы, которые безопасно подключаются к службе с помощью частной связи Azure. Частная конечная точка использует частный IP-адрес из виртуальной сети, фактически передавая ее в виртуальную сеть.
* **Обучение вычислительного доступа** — целевые вычислительные цели, такие как машинное обучение Azure вычислительные экземпляры и машинное обучение Azure вычислительные кластеры безопасно с ЧАСТНЫМИ IP-адресами. 
* Получение доступа к **вычисленным** кластерам Azure Kubernetes Services (AKS) с ЧАСТНЫМИ IP-адресами.


В следующих пяти разделах показано, как защитить сетевой сценарий, описанный выше. Для защиты сети необходимо выполнить следующие действия.

1. Обеспечьте безопасность [**рабочей области и связанных ресурсов**](#secure-the-workspace-and-associated-resources).
1. Обеспечьте безопасность [**среды обучения**](#secure-the-training-environment).
1. Обеспечьте безопасность [**окружения**](#secure-the-inferencing-environment).
1. Дополнительно: [**Включение функциональных возможностей Studio**](#optional-enable-studio-functionality).
1. Настройка [ **параметров брандмауэра**](#configure-firewall-settings)

## <a name="secure-the-workspace-and-associated-resources"></a>Защита рабочей области и связанных ресурсов

Чтобы защитить рабочую область и связанные с ней ресурсы, выполните следующие действия. Эти действия позволяют службам взаимодействовать в виртуальной сети.

1. Создайте [рабочую область с поддержкой частной связи](how-to-secure-workspace-vnet.md#secure-the-workspace-with-private-endpoint) , чтобы обеспечить взаимодействие между виртуальной сетью и рабочей областью.
1. Добавьте Azure Key Vault в виртуальную сеть с [конечной точкой службы](../key-vault/general/overview-vnet-service-endpoints.md) или [частной конечной точкой](../key-vault/general/private-link-service.md). Задайте для параметра Key Vault значение ["разрешить доверенным службам Майкрософт обход этого брандмауэра"](how-to-secure-workspace-vnet.md#secure-azure-key-vault).
1. Добавление учетной записи хранения Azure в виртуальную сеть с [конечной точкой службы](how-to-secure-workspace-vnet.md#secure-azure-storage-accounts) или [частной конечной точкой](../storage/common/storage-private-endpoints.md)
1. [Настройте реестр контейнеров Azure для использования частной конечной точки](how-to-secure-workspace-vnet.md#enable-azure-container-registry-acr) и [включите делегирование подсети в службе "экземпляры контейнеров Azure](how-to-secure-inferencing-vnet.md#enable-azure-container-instances-aci)".

![Схема архитектуры, показывающая, как Рабочая область и связанные ресурсы взаимодействуют друг с другом через конечные точки службы или частные конечные точки в виртуальной сети.](./media/how-to-network-security-overview/secure-workspace-resources.png)

Подробные инструкции по выполнению этих действий см. в статье [защита машинное обучение Azure рабочей области](how-to-secure-workspace-vnet.md). 

### <a name="limitations"></a>Ограничения

Защита рабочей области и связанных с ней ресурсов в виртуальной сети имеет следующие ограничения.
- Использование рабочей области Машинное обучение Azure с частной ссылкой недоступна в регионах Azure для государственных организаций и Azure для Китая.
- Все ресурсы должны находиться за одной виртуальной сетью. Однако подсети в одной виртуальной сети разрешены.

## <a name="secure-the-training-environment"></a>Защита среды обучения

В этом разделе вы узнаете, как защитить среду обучения в Машинное обучение Azure. Вы также узнаете, как Машинное обучение Azure завершает задание обучения, чтобы понять, как сетевые конфигурации работают вместе.

Чтобы защитить среду обучения, выполните следующие действия.

1. Создайте Машинное обучение Azure [вычислительный экземпляр и кластер компьютеров в виртуальной сети](how-to-secure-training-vnet.md#compute-instance) для запуска задания обучения.
1. [Разрешите входящий трафик из пакетной службы Azure](how-to-secure-training-vnet.md#mlcports) , чтобы Пакетная служба могла отправлять задания в ресурсы вычислений. 

![Схема архитектуры, показывающая, как обеспечить безопасность управляемых вычислений и экземпляров](./media/how-to-network-security-overview/secure-training-environment.png)

Подробные инструкции по выполнению этих действий см. в разделе [Защита среды обучения](how-to-secure-training-vnet.md). 

### <a name="example-training-job-submission"></a>Пример отправки задания обучения 

В этом разделе вы узнаете, как Машинное обучение Azure безопасно взаимодействует между службами для отправки учебного задания. В этом примере показано, как все конфигурации работают вместе для безопасного обмена данными.

1. Клиент отправляет скрипты обучения и обучающие данные в учетные записи хранения, защищенные с помощью службы или частной конечной точки.

1. Клиент отправляет задание обучения в рабочую область Машинное обучение Azure через частную конечную точку.

1. Пакетная служба Azure получает задание из рабочей области и отправляет задание по обучению в среду вычислений через общедоступную подсистему балансировки нагрузки, подготовленную с помощью ресурсов вычислений. 

1. Ресурс вычислений получает задание и начинает обучение. Ресурсы вычислений обращаются к защищенным учетным записям хранения для скачивания обучающих файлов и передачи выходных данных. 

![Схема архитектуры, показывающая, как будет отправлено Машинное обучение Azureное задание обучения при использовании виртуальной сети](./media/how-to-network-security-overview/secure-training-job-submission.png)


### <a name="limitations"></a>Ограничения

- Вычислительные службы Azure и вычислительные кластеры Azure должны находиться в той же виртуальной сети, регионе и подписке, что и связанные с ней ресурсы. 

## <a name="secure-the-inferencing-environment"></a>Защита окружения

В этом разделе вы узнаете о параметрах, доступных для обеспечения безопасности окружения. Мы рекомендуем использовать кластеры Azure Kubernetes Services (AKS) для крупномасштабных и рабочих развертываний.

У вас есть два варианта кластеров AKS в виртуальной сети:

- Разверните или Подключите кластер AKS по умолчанию к виртуальной сети.
- Подключите частный кластер AKS к виртуальной сети.

**Кластеры AKS по умолчанию** имеют плоскость управления с общедоступными IP-адресами. Вы можете добавить кластер AKS по умолчанию в виртуальную сеть во время развертывания или подключить кластер после его создания.

**Частные кластеры AKS** имеют плоскость управления, доступ к которой возможен только через частные IP-адреса. Частные кластеры AKS должны быть присоединены после создания кластера.

Подробные инструкции по добавлению кластера по умолчанию и частных кластеров см. в разделе [обеспечение безопасности окружения](how-to-secure-inferencing-vnet.md). 

На следующей схеме сети показана защищенная рабочая область Машинное обучение Azure с частным кластером AKS, подключенным к виртуальной сети.

![Схема архитектуры, показывающая, как подключить частный кластер AKS к виртуальной сети. Плоскость управления AKS находится за пределами клиентской виртуальной сети](./media/how-to-network-security-overview/secure-inferencing-environment.png)

### <a name="limitations"></a>Ограничения
- Кластеры AKS должны принадлежать к той же виртуальной сети, что и Рабочая область, и связанные с ней ресурсы. 

## <a name="optional-enable-studio-functionality"></a>Необязательно: Включение функциональности Studio

[Защита рабочей области](#secure-the-workspace-and-associated-resources)  >  [Защита среды обучения](#secure-the-training-environment)  >  [Защита окружения](#secure-the-inferencing-environment)  >  **Включить функциональные возможности студии**  >  [Настройка параметров брандмауэра](#configure-firewall-settings)

Хотя Studio может получать доступ к данным в учетной записи хранения, настроенной с конечной точкой службы, некоторые функции по умолчанию отключены.

* Предварительный просмотр данных в студии.
* Визуализируйте данные в конструкторе.
* Отправьте Аутомл эксперимент.
* Запустите проект меток.

Сведения о включении полной функциональности при использовании конечной точки службы хранилища см. [в статье использование машинное обучение Azure Studio в виртуальной сети](how-to-enable-studio-virtual-network.md#access-data-using-the-studio). Studio поддерживает как конечные точки службы, так и частные конечные точки для учетных записей хранения.

### <a name="limitations"></a>Ограничения
- Studio не удается получить доступ к данным в учетных записях хранения, настроенных для использования частных конечных точек. Для полной функциональности необходимо использовать конечные точки службы для хранения и использовать управляемое удостоверение.

## <a name="configure-firewall-settings"></a>Настройка параметров брандмауэра

Настройте брандмауэр для управления доступом к ресурсам рабочей области Машинное обучение Azure и общедоступному Интернету. Хотя мы рекомендуем использовать брандмауэр Azure, вы можете воспользоваться другими продуктами брандмауэра для защиты сети. Если у вас есть вопросы о том, как разрешить обмен данными через брандмауэр, обратитесь к документации по используемому брандмауэру.

Дополнительные сведения о параметрах брандмауэра см. в статье [Использование рабочей области за брандмауэром](how-to-access-azureml-behind-firewall.md).

## <a name="next-steps"></a>Дальнейшие действия

Эта статья является частью серии виртуальных сетей из четырех частей. Ознакомьтесь с остальными статьями, чтобы узнать, как защитить виртуальную сеть.

* [Часть 2. Обзор виртуальной сети](how-to-secure-workspace-vnet.md)
* [Часть 3. Защита среды обучения](how-to-secure-training-vnet.md)
* [Часть 4. Защита окружения](how-to-secure-inferencing-vnet.md)
* [Часть 5. Включение функций Studio](how-to-enable-studio-virtual-network.md)
