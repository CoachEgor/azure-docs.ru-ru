---
title: Управление ресурсами & квотами
titleSuffix: Azure Machine Learning
description: Узнайте о квотах на ресурсах для машинного обучения Azure и о том, как запросить дополнительную квоту.
services: machine-learning
ms.service: machine-learning
ms.subservice: core
ms.topic: conceptual
ms.reviewer: jmartens
author: nishankgu
ms.author: nigup
ms.date: 03/05/2020
ms.openlocfilehash: 530647c3d32b62f0cac250795ccce580b182fa92
ms.sourcegitcommit: 441db70765ff9042db87c60f4aa3c51df2afae2d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/06/2020
ms.locfileid: "80756601"
---
# <a name="manage-and-request-quotas-for-azure-resources"></a>Управление квотами для ресурсов Azure и их запрашивание
[!INCLUDE [applies-to-skus](../../includes/aml-applies-to-basic-enterprise-sku.md)]

В этой статье приводится подробная информация о предварительно настроенных ограничениях на ресурсах Azure для вашей подписки. Также включены инструкции о том, как запрашивать улучшения квот для каждого типа ресурсов. Эти ограничения применяются во избежание перерасхода бюджета из-за мошенничества, а также для соблюдения ограничений по объемам ресурсов Azure.

Как и в других службах Azure, существуют ограничения на определенные ресурсы, связанные с машинным обучением Azure. Эти ограничения варьируются от ограничения на количество рабочих областей до ограничений на фактические базовые вычисления, которые используются для обучения модели или выводов/ скоринга. 

При проектировании и масштабировке ресурсов машинного обучения Azure для производственных нагрузок следует учитывать эти ограничения. Например, если кластер не достигает целевого числа узлов, возможно, вы достигли предела ядер машинного обучения Azure для подписки. Если ограничение или квоту требуется сделать выше значения ограничения по умолчанию, бесплатно отправьте запрос в службу поддержки клиентов. Из-за ограничений по объемам ресурсов Azure ограничения не могут быть увеличены выше значения максимального предела, как показано в таблицах ниже. Если столбца "Максимальное ограничение" нет, то ресурс не имеет настраиваемого ограничения.

## <a name="special-considerations"></a>Специальные рекомендации

+ Квота — это кредитный лимит, а не гарантия наличия ресурсов. Если вам нужны ресурсы в очень большом объеме, обратитесь в службу поддержки Azure.

+ Ваша квота распределяется во всех службах в подписках, включая Azure Machine Learning. Единственным исключением является Вычислительная среда Машинного обучения Azure, для которой применяется отдельная квота вычислительных ядер. При оценке потребности в емкости обязательно вычислите использование квоты во всех службах.

+ Ограничения по умолчанию варьируются в зависимости от типа категории предложений, таких как Бесплатная пробная версия, Pay-As-You-Go и vM-серии, такие как Dv2, F, G и так далее.

## <a name="default-resource-quotas"></a>Квоты ресурсов по умолчанию

Ниже представлена разбивка квот по различным типам ресурсов в подписке Azure.

> [!IMPORTANT]
> Границы могут измениться. Последнюю версию всегда можно найти в [документе](https://docs.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits/) по квотам на уровне службы для всех ресурсов Azure.

### <a name="virtual-machines"></a>Виртуальные машины
Для каждой подписки Azure существует ограничение на количество виртуальных машин, которые вы можете иметь в ваших службах или автономных. Это ограничение на уровне региона на общее количество ядер, а также на основе каждого семейства.

Виртуальные ядра машины имеют региональный общий лимит и региональный предел по размеру (Dv2, F и т.д.), оба из которых применяются отдельно. Например, рассмотрим подписку с ограничением до 30 ядер виртуальных машин с восточной части США, 30 ядер серии A и 30 ядер серии D. Для этой подписки допускается развертывание 30 виртуальных машин A1 или 30 виртуальных машин D1 или сочетания виртуальных машин обоих типов, при котором должно быть не более 30 ядер (например, 10 виртуальных машин A1 и 20 виртуальных машин D1).

[!INCLUDE [azure-subscription-limits-azure-resource-manager](../../includes/azure-subscription-limits-azure-resource-manager.md)]

Более подробный и актуальный список квот см. в [статье о квотах на уровне среды Azure](https://docs.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits).

### <a name="azure-machine-learning-compute"></a>Вычислительная среда Машинного обучения Azure;
В Вычислительной среде Машинного обучения Azure есть квота по умолчанию для количества ядер и уникальных ресурсов компьютера, разрешенных для каждого региона в подписке. Эта квота отделена от указанной выше ключевой квоты VM, а основные ограничения не распределяются между двумя типами ресурсов, так как AmlCompute является управляемой службой, которая развертывает ресурсы в размещенной модели.

Доступные ресурсы:
+ Выделенные ядра в регионе имеют лимит по умолчанию 24 - 300 в зависимости от типа предложения подписки с более высокими значениями по умолчанию для типов предложений EA и CSP.  Количество выделенных ядер на подписку может быть увеличено и отличается для каждой семьи VM. Некоторые специализированные семейства VM, такие как NCv2, NCv3 или ND серии начинаются с дефолта нулевых ядер. Обратитесь в службу поддержки Azure, увеличив запрос на квоту для обсуждения вариантов увеличения.

+ Низкоприоритетные ядра в регионе имеют предел по умолчанию 100 - 3000 в зависимости от типа предложения подписки с более высокими значениями по умолчанию для типов предложений EA и CSP. Количество низкоприоритетных ядер на подписку может быть увеличено и является одним значением для семейств VM. Чтобы обсудить варианты увеличения, обратитесь в службу поддержки Azure.

+ Кластеры в регионе имеют предел по умолчанию 200. Они распределяются между обучаемым кластером и экземпляром вычислений (который рассматривается как единый кластер узлов для целей квот). Свяжитесь со службой поддержки Azure, чтобы оставить запрос на повышение лимита.

+ Есть и другие строгие ограничения, которые не могут быть превышены после удара.

| **Ресурс** | **Максимальное ограничение** |
| --- | --- |
| Максимальное количество рабочих областей на группу ресурсов | 800 |
| Максимальное число узлов в одном ресурсе Вычислительной среды Машинного обучения Azure (AmlCompute) | 100 узлов |
| Максимальное количество процессов MPI в GPU на узел | 1–4 |
| Максимальное количество рабочих ролей GPU на узел | 1–4 |
| Максимальное время существования задания | 90 дней<sup>1</sup> |
| Максимальный срок службы на слабоприоритетном уде | 7 дней<sup>2</sup> |
| Максимальное количество серверов параметров на узел | 1 |

<sup>1</sup> Максимальное время существования означает время от начала запуска и до завершения. Завершенные запуски сохраняются в течение неограниченного времени. Данные для запусков, которые не были завершены в течение максимального времени существования, недоступны.
<sup>2</sup> Вакансии на низкоприоритетном уде могут быть упреждены в любое время, когда есть ограничение емкости. Мы рекомендуем вам внедрить контрольные точки в вашей работе.

### <a name="azure-machine-learning-pipelines"></a>Конвейеры Машинного обучение Azure
Для трубопроводов машинного обучения Azure существует ограничение квотна на количество этапов в конвейере и на количество графиков, основанных на проводах, опубликованных в регионе в подписке.
- Максимальное количество шагов, разрешенных в трубопроводе, составляет 30 000
- Максимальное количество суммы графиков на основе работает и капля тянет для блога запускается графики опубликованных трубопроводов на подписку в месяц составляет 100000

> [!NOTE]
> Если вам необходимо увеличить это ограничение, обратитесь в [службу поддержки Майкрософт](https://azure.microsoft.com/support/options/).

### <a name="container-instances"></a>Экземпляры контейнеров

Также существует ограничение на количество экземпляров контейнера, которые можно развертывать в определенный период времени (по часам) или по всей вашей подписке.

[!INCLUDE [container-instances-limits](../../includes/container-instances-limits.md)]

Более подробный и актуальный список квот см. в [статье о квотах на уровне среды Azure](https://docs.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits#container-instances-limits).

### <a name="storage"></a>Память
Существует ограничение на количество учетных записей хранения в регионе, а также в рамках данной подписки. Лимит по умолчанию составляет 250 и включает в себя как стандартные, так и премиум-аккаунты. Если требуется более 250 учетных записей хранилища в данном регионе, сделайте запрос через [поддержку Azure.](https://ms.portal.azure.com/#blade/Microsoft_Azure_Support/HelpAndSupportBlade/newsupportrequest/) Команда разработчиков службы хранилища Azure рассмотрит вашу аргументацию и может утвердить до 250 учетных записей хранения для заданного региона.


## <a name="workspace-level-quota"></a>Квота уровня рабочего пространства

Чтобы лучше управлять распределением ресурсов для Amlcompute между различными рабочими пространствами, мы ввели функцию, которая позволяет распределять квоты уровня подписки (по семейству VM) и настраивать их на уровне рабочей области. Поведение по умолчанию заключается в том, что все рабочие области имеют ту же квоту, что и квота уровня подписки для любого семейства VM. Однако по мере увеличения числа рабочих областей и начала совместного использования одних и тех же ресурсов рабочие нагрузки с различным приоритетом, пользователям требуется способ улучшить общий доступ к емкости и избежать проблем с ресурсами. Azure Machine Learning предоставляет решение с управляемым вычислительным предложением, позволяя пользователям устанавливать максимальную квоту для конкретного семейства VM на каждом рабочем пространстве. Это аналогично распределению емкости между рабочими пространствами, и пользователи могут также перераспределить, чтобы диск максимального использования. 

Чтобы установить квоты на уровне рабочей области, перейдите в любое рабочее пространство в подписке и нажмите на **квоты Usages и** в левом стеле. Затем выберите вкладку **Configure quotas** для просмотра квот, расширьте все семейство VM и установите ограничение квот на любое рабочее пространство, указанное в этом семействе VM. Помните, что нельзя установить отрицательное значение или значение, превышающее квоту уровня подписки. Кроме того, как вы заметили бы, по умолчанию всем рабочим областям присваивается вся квота подписки, чтобы обеспечить полное использование выделенной квоты.

[![Квота уровня рабочего пространства Azure Machine Learning](./media/how-to-manage-quotas/azure-machine-learning-workspace-quota.png)](./media/how-to-manage-quotas/azure-machine-learning-workspace-quota.png)


> [!NOTE]
> Это только функция корпоративного издания. Если в подписке есть рабочее пространство базового и корпоративного издания, вы можете использовать это только для установки квот на рабочих пространствах предприятия. В основных рабочих областях будет по-прежнему иметься квота уровня подписки, которая является поведением по умолчанию.
>
> Для установки квоты на уровне рабочей области необходимы разрешения уровня подписки. Это обеспечивается таким образом, чтобы отдельные владельцы рабочих мест не редотировали и не увеличивали свои квоты и не посягали на ресурсы, отведенные для другого рабочего пространства. Таким образом, админ подписки лучше всего подходит для распределения и распределения этих квот между рабочими областями.



## <a name="view-your-usage-and-quotas"></a>Просмотр сведений об использовании и квотах

На портале Azure можно легко просмотреть квоту для различных ресурсов, таких как виртуальные машины, хранилище и сеть.

1. На левой панели выберите **Все службы**, а затем в общей категории выберите **Подписки**.

1. Из списка подписок выберите ту, квоту которой нужно просмотреть.

   **Присутствует ограничение**, в частности при просмотре квоты Вычислительной среды Машинного обучения Azure. Как упоминалось выше, эта квота отличается от квоты вычислений в подписке.

1. На левой панели выберите **службу машинного обучения,** а затем выберите любое рабочее пространство из списка, показанного

1. В следующей колонке в разделе **Поддержка и устранение неполадок** выберите **Использование и квоты**, чтобы просмотреть текущие квоты и их использование.

1. Выберите подписку, для которой нужно просмотреть квоты. Не забудьте выполнить фильтрацию по нужному региону.

1. Теперь можно переключаться между представлением уровня подписки и представлением уровня рабочей области:
    + **Представление подписки:** Это позволяет просматривать использование основной квоты семейством VM, расширяя ее по рабочей области и расширяя ее фактическими именами кластеров. Это представление оптимально для быстрого входной детали использования ядра для конкретного семейства VM, чтобы увидеть разрыв по рабочим пространствам и далее базовыми кластерами для каждого из этих рабочих областей. Общая конвенция в этом представлении (использование/квота), где использование — это текущее число увеличенных ядер, а квота — это логическое максимальное количество ядер, к которым ресурс может масштабироваться. Для каждого **рабочего пространства**квотой будет квота уровня рабочей области (как это объясняется выше), которая обозначает максимальное количество ядер, которые можно масштабировать для конкретного семейства VM. Для **кластера** аналогичным образом, квота фактически представляет собой ядра, соответствующие максимальному количеству узлов, которые кластер может масштабировать сяоном, определяемым max_nodes свойством.

    + **Вид рабочего пространства:** Это позволяет просматривать использование основной квоты по рабочей области, расширяя ее семейством VM и расширяя ее фактическими именами кластеров. Это представление оптимально для быстрого входной детали использования ядра для конкретного рабочего пространства, чтобы увидеть распад семейств VM и далее базовыми кластерами для каждой из этих семейств.

## <a name="request-quota-increases"></a>Запрос на увеличение квоты

Если вы хотите повысить лимит или квоту выше лимита по умолчанию, [откройте запрос на поддержку клиентов](https://ms.portal.azure.com/#blade/Microsoft_Azure_Support/HelpAndSupportBlade/newsupportrequest/) в режиме онлайн бесплатно.

Ограничения не могут превышать значение максимального ограничения, показанное в таблицах. Если максимальное ограничение отсутствует, то ресурс не имеет настраиваемого ограничения. В [этой статье](https://docs.microsoft.com/azure/azure-resource-manager/resource-manager-quota-errors) более подробно рассматривается процесс увеличения квот.

При запросе увеличения квоты вам необходимо выбрать службу, для которой необходимо повысить квоту. Это могут быть квоты Службы машинного обучения Azure, службы "Экземпляры контейнера" или службы хранилища. Кроме того, для Azure Machine Learning Compute можно нажать на кнопку **«Квота запроса»** при просмотре квоты, следующей за приведенными выше шагами.

> [!NOTE]
> [Бесплатная пробная версия подписки](https://azure.microsoft.com/offers/ms-azr-0044p) не предусматривает возможность увеличения ограничения и квоты. При наличии [бесплатной пробной версии подписки](https://azure.microsoft.com/offers/ms-azr-0044p) ее можно обновить до подписки [с оплатой по мере использования](https://azure.microsoft.com/offers/ms-azr-0003p/). Дополнительные сведения см. в статье [Upgrade your Free Trial or Microsoft Imagine Azure subscription to Pay-As-You-Go](../billing/billing-upgrade-azure-subscription.md) (Обновление бесплатной пробной версии подписки или подписки Microsoft Imagine Azure до подписки с оплатой по мере использования) и [Вопросы и ответы о бесплатной учетной записи Azure](https://azure.microsoft.com/free/free-account-faq).
