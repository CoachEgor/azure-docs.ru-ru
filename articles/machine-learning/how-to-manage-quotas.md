---
title: Управление ресурсами & квоты
titleSuffix: Azure Machine Learning
description: Сведения о квотах на ресурсы для Машинное обучение Azure и о том, как запросить дополнительную квоту.
services: machine-learning
ms.service: machine-learning
ms.subservice: core
ms.topic: conceptual
ms.reviewer: jmartens
author: nishankgu
ms.author: nigup
ms.date: 03/05/2020
ms.openlocfilehash: 530647c3d32b62f0cac250795ccce580b182fa92
ms.sourcegitcommit: 849bb1729b89d075eed579aa36395bf4d29f3bd9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2020
ms.locfileid: "80756601"
---
# <a name="manage-and-request-quotas-for-azure-resources"></a>Управление квотами для ресурсов Azure и их запрашивание
[!INCLUDE [applies-to-skus](../../includes/aml-applies-to-basic-enterprise-sku.md)]

В этой статье содержатся сведения о предварительно настроенных ограничениях для ресурсов Azure для вашей подписки. Также включены инструкции по запросу улучшений квот для каждого типа ресурсов. Эти ограничения применяются во избежание перерасхода бюджета из-за мошенничества, а также для соблюдения ограничений по объемам ресурсов Azure.

Как и в случае с другими службами Azure, существуют ограничения на определенные ресурсы, связанные с Машинное обучение Azure. Эти ограничения находятся в диапазоне от ограничения количества рабочих областей до ограничений на фактическое базовое вычисление, которое используется для обучения модели или вывода или оценки. 

При проектировании и масштабировании ресурсов Машинное обучение Azure для рабочих нагрузок рекомендуется учитывать эти ограничения. Например, если кластер не достигает целевого количества узлов, возможно, достигнуто предельное число ядер Машинное обучение Azure вычислений для вашей подписки. Если ограничение или квоту требуется сделать выше значения ограничения по умолчанию, бесплатно отправьте запрос в службу поддержки клиентов. Из-за ограничений по объемам ресурсов Azure ограничения не могут быть увеличены выше значения максимального предела, как показано в таблицах ниже. Если столбца "Максимальное ограничение" нет, то ресурс не имеет настраиваемого ограничения.

## <a name="special-considerations"></a>Специальные рекомендации

+ Квота — это кредитный лимит, а не гарантия наличия ресурсов. Если вам нужны ресурсы в очень большом объеме, обратитесь в службу поддержки Azure.

+ Ваша квота является общей для всех служб в подписках, включая Машинное обучение Azure. Единственным исключением является Вычислительная среда Машинного обучения Azure, для которой применяется отдельная квота вычислительных ядер. При оценке потребности в емкости обязательно вычислите использование квоты во всех службах.

+ Ограничения по умолчанию зависят от типа категории предложения, например бесплатной пробной версии, оплаты по мере использования и серии виртуальных машин, например Dv2, F, G и т. д.

## <a name="default-resource-quotas"></a>Квоты ресурсов по умолчанию

Ниже представлена разбивка квот по различным типам ресурсов в подписке Azure.

> [!IMPORTANT]
> Границы могут измениться. Последнюю версию всегда можно найти в [документе](https://docs.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits/) по квотам на уровне службы для всех ресурсов Azure.

### <a name="virtual-machines"></a>Виртуальные машины
Для каждой подписки Azure существует ограничение на количество виртуальных машин, которые можно использовать в службах или автономных. Это ограничение на уровне региона на общее количество ядер, а также на основе каждого семейства.

Для ядер виртуальных машин предусмотрено Региональное ограничение "общий" и "Региональный" для ряда размеров (Dv2, F и т. д.), оба из которых применяются отдельно. Например, рассмотрим подписку с ограничением до 30 ядер виртуальных машин с восточной части США, 30 ядер серии A и 30 ядер серии D. Для этой подписки допускается развертывание 30 виртуальных машин A1 или 30 виртуальных машин D1 или сочетания виртуальных машин обоих типов, при котором должно быть не более 30 ядер (например, 10 виртуальных машин A1 и 20 виртуальных машин D1).

[!INCLUDE [azure-subscription-limits-azure-resource-manager](../../includes/azure-subscription-limits-azure-resource-manager.md)]

Более подробный и актуальный список квот см. в [статье о квотах на уровне среды Azure](https://docs.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits).

### <a name="azure-machine-learning-compute"></a>Вычислительная среда Машинного обучения Azure;
В Вычислительной среде Машинного обучения Azure есть квота по умолчанию для количества ядер и уникальных ресурсов компьютера, разрешенных для каждого региона в подписке. Эта квота отделена от квоты ядра ВМ выше, и ограничения ядра не являются общими для двух типов ресурсов, так как Амлкомпуте — это управляемая служба, которая развертывает ресурсы в модели с размещением от имени пользователя.

Доступные ресурсы:
+ Число выделенных ядер на регион по умолчанию равно 24-300 в зависимости от типа предложения подписки с более высоким значением по умолчанию для типов предложений EA и CSP.  Количество выделенных ядер на подписку можно увеличить и изменить для каждого семейства виртуальных машин. Некоторые специализированные семейства виртуальных машин, такие как NCv2, NCv3 или ND, начинаются с 0 ядер по умолчанию. Обратитесь в службу поддержки Azure, выполнив запрос на квоту, чтобы обсудить варианты увеличения.

+ Для ядер с низким приоритетом на регион по умолчанию установлено ограничение в 100-3000 в зависимости от типа предложения подписки с более высоким значением по умолчанию для типов предложений EA и CSP. Количество ядер с низким приоритетом на подписку можно увеличить, а одно значение — в разных семействах виртуальных машин. Чтобы обсудить варианты увеличения, обратитесь в службу поддержки Azure.

+ Количество кластеров на регион по умолчанию равно 200. Они являются общими для обучающего кластера и вычислительного экземпляра (который рассматривается как кластер с одним узлом в целях квоты). Свяжитесь со службой поддержки Azure, чтобы оставить запрос на повышение лимита.

+ Существуют и другие ограничения, которые нельзя превысить при попадании.

| **Ресурс** | **Максимальное ограничение** |
| --- | --- |
| Максимальное количество рабочих областей на группу ресурсов | 800 |
| Максимальное число узлов в одном ресурсе Вычислительной среды Машинного обучения Azure (AmlCompute) | 100 узлов |
| Максимальное количество процессов MPI в GPU на узел | 1–4 |
| Максимальное количество рабочих ролей GPU на узел | 1–4 |
| Максимальное время существования задания | 90 дней<sup>1</sup> |
| Максимальное время существования задания на узле с низким приоритетом | 7 дней<sup>2</sup> |
| Максимальное количество серверов параметров на узел | 1 |

<sup>1</sup> Максимальное время существования означает время от начала запуска и до завершения. Завершенные запуски сохраняются в течение неограниченного времени. Данные для запусков, которые не были завершены в течение максимального времени существования, недоступны.
<sup>2</sup> задания на узле с низким приоритетом могут быть вытеснены в любое время, когда имеется ограничение емкости. Мы рекомендуем реализовать контрольные точки в задании.

### <a name="azure-machine-learning-pipelines"></a>Конвейеры Машинного обучение Azure
Для Машинное обучение Azure конвейеров существует квота на количество шагов в конвейере и количество выполненных на основе расписания планов опубликованных конвейеров на регион в подписке.
- Максимально допустимое число шагов в конвейере — 30 000
- Максимальное число запусков на основе расписания и опросов больших двоичных объектов для блогов, запускаемых с помощью блога, для подписок на подписку в месяц — 100 000

> [!NOTE]
> Если вам необходимо увеличить это ограничение, обратитесь в [службу поддержки Майкрософт](https://azure.microsoft.com/support/options/).

### <a name="container-instances"></a>Экземпляры контейнеров

Также существует ограничение на количество экземпляров контейнера, которые можно развертывать в определенный период времени (по часам) или по всей вашей подписке.

[!INCLUDE [container-instances-limits](../../includes/container-instances-limits.md)]

Более подробный и актуальный список квот см. в [статье о квотах на уровне среды Azure](https://docs.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits#container-instances-limits).

### <a name="storage"></a>Память
Существует ограничение на количество учетных записей хранения в регионе, а также в рамках данной подписки. Ограничение по умолчанию — 250 и включает учетные записи хранения уровня "Стандартный" и "Премиум". Если вам требуется более 250 учетных записей хранения в определенном регионе, выполните запрос через [службу поддержки Azure](https://ms.portal.azure.com/#blade/Microsoft_Azure_Support/HelpAndSupportBlade/newsupportrequest/). Команда разработчиков службы хранилища Azure рассмотрит вашу аргументацию и может утвердить до 250 учетных записей хранения для заданного региона.


## <a name="workspace-level-quota"></a>Квота уровня рабочей области

Чтобы лучше управлять выделением ресурсов для Амлкомпуте между различными рабочими областями, мы предоставили функцию, которая позволяет распределять квоты уровня подписки (по семейству виртуальных машин) и настраивать их на уровне рабочей области. Поведение по умолчанию заключается в том, что все рабочие области имеют ту же квоту, что и квота уровня подписки для любого семейства виртуальных машин. Однако по мере увеличения количества рабочих областей, а рабочие нагрузки разного приоритета начинают совместно использовать одни и те же ресурсы, пользователям нужен способ улучшить общий объем ресурсов и избежать проблем с состязанием за ресурсы. Машинное обучение Azure предоставляет решение с управляемым предложением вычислений, позволяя пользователям устанавливать максимальную квоту для конкретного семейства виртуальных машин в каждой рабочей области. Это аналогично распределению емкости между рабочими областями, и пользователи могут выбрать также избыточное выделение для максимального использования. 

Чтобы задать квоты на уровне рабочей области, перейдите в любую рабочую область в подписке и щелкните **использование + квоты** на левой панели. Затем перейдите на вкладку **Настройка квот** , чтобы просмотреть квоты, развернуть все семейство виртуальных машин и задать квоту для любой рабочей области, указанной в списке семейство виртуальных машин. Помните, что нельзя задать отрицательное значение или значение выше квоты уровня подписки. Кроме того, как вы должны заметить, по умолчанию всем рабочим областям назначается вся квота подписки, чтобы обеспечить полное использование выделенной квоты.

[![Квота уровня рабочей области Машинное обучение Azure](./media/how-to-manage-quotas/azure-machine-learning-workspace-quota.png)](./media/how-to-manage-quotas/azure-machine-learning-workspace-quota.png)


> [!NOTE]
> Это только функция выпуска Enterprise Edition. Если в вашей подписке есть рабочая область "базовый" и "корпоративный выпуск", ее можно использовать для установки квот только для корпоративных рабочих областей. В основных рабочих областях будет по-прежнему существовать квота уровня подписки, которая является поведением по умолчанию.
>
> Для задания квоты на уровне рабочей области необходимы разрешения уровня подписки. Это гарантирует, что индивидуальные владельцы рабочей области не изменяют и не увеличивают квоты и не начинают подошли на ресурсы, настроенные для другой рабочей области. Таким образом, администратор подписки лучше всего подходит для выделения и распространения этих квот в рабочих областях.



## <a name="view-your-usage-and-quotas"></a>Просмотр сведений об использовании и квотах

На портале Azure можно легко просмотреть квоту для различных ресурсов, таких как виртуальные машины, хранилище и сеть.

1. На левой панели выберите **Все службы**, а затем в общей категории выберите **Подписки**.

1. Из списка подписок выберите ту, квоту которой нужно просмотреть.

   **Присутствует ограничение**, в частности при просмотре квоты Вычислительной среды Машинного обучения Azure. Как упоминалось выше, эта квота отличается от квоты вычислений в подписке.

1. В левой области выберите **машинное обучение служба** , а затем выберите любую рабочую область из отображаемого списка.

1. В следующей колонке в разделе **Поддержка и устранение неполадок** выберите **Использование и квоты**, чтобы просмотреть текущие квоты и их использование.

1. Выберите подписку, для которой нужно просмотреть квоты. Не забудьте выполнить фильтрацию по нужному региону.

1. Теперь можно переключаться между представлением уровня подписки и представлением уровня рабочей области:
    + **Представление подписки:** Это позволяет просматривать использование квоты ядра в семействе виртуальных машин, расширять их по рабочей области, а также разворачивать их по реальным именам кластеров. Это представление является оптимальным для быстрого получения сведений о базовом использовании для конкретного семейства виртуальных машин, чтобы увидеть разбивку по рабочим областям и дальнейшее распределение по основным кластерам для каждой из этих рабочих областей. В этом представлении общим соглашением является (использование или квота), где использование — это текущее количество масштабируемых ядер, а квота — это логическое максимальное число ядер, до которого может масштабироваться ресурс. Для каждой **рабочей области**квотой будет квота уровня рабочей области (как описано выше), которая обозначает максимальное количество ядер, которое можно масштабировать для конкретного семейства виртуальных машин. Для **кластера** квота фактически представляет собой ядра, соответствующие максимальному количеству узлов, которое кластер может масштабировать в соответствии со свойством max_nodes.

    + **Представление рабочей области:** Это позволяет просматривать использование квоты ядра по рабочей области, расширять их по семейству виртуальных машин и дополнительно развертывать их по реальным именам кластеров. Это представление является оптимальным для быстрого получения сведений об использовании ядра для конкретной рабочей области, чтобы увидеть разбивку по семействам виртуальных машин и дальнейшее распределение по базовым кластерам для каждого из этих семейств.

## <a name="request-quota-increases"></a>Запрос на увеличение квоты

Если вы хотите увеличить лимит или квоту выше предельного значения по умолчанию, отправьте [запрос в службу поддержки клиентов через Интернет](https://ms.portal.azure.com/#blade/Microsoft_Azure_Support/HelpAndSupportBlade/newsupportrequest/) бесплатно.

Ограничения не могут превышать значение максимального ограничения, показанное в таблицах. Если максимальное ограничение отсутствует, то ресурс не имеет настраиваемого ограничения. В [этой статье](https://docs.microsoft.com/azure/azure-resource-manager/resource-manager-quota-errors) более подробно рассматривается процесс увеличения квот.

При запросе увеличения квоты вам необходимо выбрать службу, для которой необходимо повысить квоту. Это могут быть квоты Службы машинного обучения Azure, службы "Экземпляры контейнера" или службы хранилища. Кроме Машинное обучение Azureных вычислений, можно нажать кнопку **запросить квоту** , чтобы просмотреть квоту, следуя приведенным выше инструкциям.

> [!NOTE]
> [Бесплатная пробная версия подписки](https://azure.microsoft.com/offers/ms-azr-0044p) не предусматривает возможность увеличения ограничения и квоты. При наличии [бесплатной пробной версии подписки](https://azure.microsoft.com/offers/ms-azr-0044p) ее можно обновить до подписки [с оплатой по мере использования](https://azure.microsoft.com/offers/ms-azr-0003p/). Дополнительные сведения см. в статье [Upgrade your Free Trial or Microsoft Imagine Azure subscription to Pay-As-You-Go](../billing/billing-upgrade-azure-subscription.md) (Обновление бесплатной пробной версии подписки или подписки Microsoft Imagine Azure до подписки с оплатой по мере использования) и [Вопросы и ответы о бесплатной учетной записи Azure](https://azure.microsoft.com/free/free-account-faq).
