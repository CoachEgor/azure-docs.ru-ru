---
title: Конструктор. Классификация рецензий на книгу (пример)
titleSuffix: Azure Machine Learning
description: Создайте многоклассовый классификатор логистической регрессии для прогнозирования категории компании с использованием набора данных Wikipedia SP 500 с помощью конструктора Машинного обучения Azure.
services: machine-learning
ms.service: machine-learning
ms.subservice: core
ms.topic: sample
author: xiaoharper
ms.author: zhanxia
ms.reviewer: peterlu
ms.date: 11/04/2019
ms.openlocfilehash: 4d22fd39eae5d5cf207d6d44819f0ce7ab2eceb5
ms.sourcegitcommit: 42517355cc32890b1686de996c7913c98634e348
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/02/2020
ms.locfileid: "76963247"
---
# <a name="build-a-classifier-to-predict-company-category-using-azure-machine-learning-designer"></a>Создание классификатора для прогнозирования категории компании с помощью конструктора Машинного обучения Azure

**Конструктор (предварительная версия) — пример 7**

[!INCLUDE [applies-to-skus](../../includes/aml-applies-to-enterprise-sku.md)]

В этом примере показано, как использовать модули текстовой аналитики для создания конвейера классификации текста в конструкторе Машинного обучения Azure (предварительная версия).

Цель классификации текста — назначить определенную часть текста одному или нескольким предопределенным классам или категориям. Этот текст может быть документом, новостной статьей, поисковым запросом, электронной почтой, твитом, запросами в службу поддержки, отзывом пользователя, рецензией на продукт и пр. Приложения классификации текста выполняют категоризацию газетных статей и новостей по разделам, упорядочение веб-страниц в иерархические категории, фильтрацию нежелательной почты, анализ тональности, прогнозирование намерений пользователя на основе поисковых запросов, маршрутизацию запросов в службу поддержки и анализ отзывов клиентов. 

Этот конвейер обучает **многоклассовый классификатор логистической регрессии** для прогнозирования категории компании с использованием **набора данных Wikipedia SP 500, полученного из Википедии**.  

Базовые этапы обучения модели машинного обучения на основе текстовых данных:

1. Получение данных

1. Предварительная обработка текстовых данных

1. Проектирование признаков

   Преобразуйте текстовый признак в числовой с помощью модуля извлечения признаков с функциями хэширования признаков и извлечения N-граммных признаков из текстовых данных.

1. Обучение модели

1. Оценка набора данных

1. Анализ модели

Вот финальная версия графа конвейера для работы. Мы расскажем о целесообразности использования каждого модуля, чтобы вы могли принимать соответствующие решения самостоятельно.

[![Граф конвейера](./media/how-to-designer-sample-text-classification/nlp-modules-overall.png)](./media/how-to-designer-sample-text-classification/nlp-modules-overall.png#lightbox)

## <a name="data"></a>Данные

В этом конвейере используется набор данных **Wikipedia SP 500**. Этот набор данных получен из Википедии (https://www.wikipedia.org/) на основе статей о каждой компании, включенной в фондовый список S&P 500. Перед отправкой в конструктор Машинного обучения Azure набор данных был обработан следующим образом:

- Был извлечен текст по каждой конкретной компании
- Удалено форматирование Википедии
- Удалены символы, не являющиеся буквами или цифрами
- Весь текст преобразован в нижний регистр
- Были добавлены известные категории компаний

Обратите внимание, что удалось найти статьи не обо всех компаниях, поэтому число записей меньше, чем 500.

## <a name="pre-process-the-text-data"></a>Предварительная обработка текстовых данных

Для подготовки текстовых данных используется модуль **предварительной обработки текста** для определения и маркировки предложений, а также выполнения других операций. Все поддерживаемые варианты описаны в руководстве по использованию [**модуля предварительной обработки текста**](algorithm-module-reference/preprocess-text.md). После предварительной обработки данных используется модуль **разделения данных**. Он разделяет входные данные в случайном порядке, чтобы исходные данные были поровну разделены между обучающим и тестовым наборами данных.

## <a name="feature-engineering"></a>Проектирование признаков
В этом примере используются два метода проектирования признаков.

### <a name="feature-hashing"></a>Хэширование признаков
Для преобразования обычного текста статей в целые числа и использования целочисленных значений в качестве входных признаков в модель использовался модуль [**хэширования признаков**](algorithm-module-reference/feature-hashing.md). 

Модуль **хэширования признаков** можно использовать для преобразования текстовых документов переменной длины в векторы числовых признаков одинаковой длины, используя 32-разрядный метод хэширования murmurhash версии 3, предоставляемый библиотекой Wabbit Vowpal. Цель использования хэширования признаков — уменьшение размерности. Кроме того, хэширование признаков ускоряет поиск весовых коэффициентов признаков во время классификации, так как при этом используется сравнение хэш-значений, а не строк.

В этом примере конвейера мы устанавливаем число битов хэширования равным 14, а число N-грамм равным 2. Эти параметры определяют то, что хэш-таблица может содержать 2 ^ 14 записей, где каждый хэш-признак представляет один или несколько N-граммных признаков со значением, представляющим частоту вхождений этой N-граммы в экземпляре текста. Для многих задач хэш-таблицы такого размера будет более чем достаточно, но в некоторых случаях для предотвращения конфликтов может потребоваться дополнительное пространство. Оцените производительность решения машинного обучения, используя разное число битов. 

### <a name="extract-n-gram-feature-from-text"></a>Извлечение N-граммных признаков из текста

N-грамма — это непрерывная последовательность из N терминов в заданной последовательности текста. N-грамма с размером 1 называется униграммой, N-грамма с размером 2 — биграмой, а N-грамма с размером 3 — триграммой. В названиях N-грамм большего размера N заменяется числом последовательных элементов.

Мы использовали модуль [**извлечения N-граммного признака из текста**](algorithm-module-reference/extract-n-gram-features-from-text.md) как альтернативное решение проектирования признаков. Этот модуль сначала извлекает набор N-грамм, а также подсчитывается число документов, в которых каждая N-грамма отображается в тексте (DF). В этом примере для вычисления значений признаков используется метрика TF-IDF. Затем выполняется преобразование неструктурированных текстовых данных в векторы числовых признаков одинаковой длины, где каждая функция представляет TF-IDF N-граммы в экземпляре текста.

После преобразования текстовых данных в векторы числовых признаков для удаления текстовых данных из набора данных используется модуль **выбора столбца**. 

## <a name="train-the-model"></a>Обучение модели

Выбор алгоритма часто зависит от требований сценария пользователя. Так как задача этого конвейера — спрогнозировать категорию компании, оптимальным вариантом является использование многоклассовой модели классификатора. Учитывая, что признаков много и они разреженные, используется модель **многоклассовой логистической регрессии** для этого конвейера.

## <a name="test-evaluate-and-compare"></a>Проверка, анализ и сравнение

 Для повышения объективности при анализе модели разделите набор данных таким образом, чтобы для обучения и тестирования модели использовались разные наборы данных.

После обучения модели будет использоваться модули **оценки модели** и **анализа модели** для создания прогнозируемых результатов и анализа моделей. Но прежде чем использовать модуль **оценки модели**, необходимо выполнить проектирование признаков так, как это было сделано при обучении. 

При использовании модуля **хэширования признаков** можно легко выполнить проектирование признаков во время оценки в рамках потока обучения. Для непосредственной обработки входных текстовых данных используйте модуль **хэширования признаков**.

При использовании модуля **извлечения N-граммного признака из текста** мы подключим **выходной словарь результатов** из обучающего потока данных к **входному словарю**, а также настроим для **словаря** режим **только для чтения**.
[![Граф оценки N-граммы](./media/how-to-designer-sample-text-classification/n-gram.png)](./media/how-to-designer-sample-text-classification/n-gram.png)

После завершения этапа проектирования модуль **оценки модели** можно использовать для создания прогнозов для тестового набора данных с помощью обученной модели. Чтобы проверить результат, выберите порт вывода модуля **оценки модели** и включите **визуализацию**.

Затем мы передадим оценки в модуль **анализа модели** для создания метрик оценки. Модуль **анализа модели** имеет два входных порта, поэтому можно выполнить анализ и сравнение оцененных наборов данных, созданных с использование разных методов. В этом примере сравнивается производительность результата, созданного с помощью метода хэширования признаков и метода на основе N-грамм.
Чтобы проверить результат, выберите порт вывода модуля **анализа модели** и включите **визуализацию**.

## <a name="clean-up-resources"></a>Очистка ресурсов

[!INCLUDE [aml-ui-cleanup](../../includes/aml-ui-cleanup.md)]

## <a name="next-steps"></a>Дальнейшие действия

Изучите другие примеры, доступные для использования с конструктором:
- [Пример 1. Регрессия: прогнозирование цен на автомобили](how-to-designer-sample-regression-automobile-price-basic.md)
- [Пример 2. Регрессия: сравнение алгоритмов для прогнозирования цен на автомобили](how-to-designer-sample-regression-automobile-price-compare-algorithms.md)
- [Пример 3. Классификация с выбором признаков: прогнозирование дохода](how-to-designer-sample-classification-predict-income.md)
- [Пример 4. Классификация: прогнозирование кредитного риска (с учетом затрат)](how-to-designer-sample-classification-credit-risk-cost-sensitive.md)
- [Пример 5. Классификация: прогнозирование оттока клиентов](how-to-designer-sample-classification-churn.md)
- [Пример 6. Классификация: прогнозирование задержки рейсов](how-to-designer-sample-classification-flight-delay.md)
