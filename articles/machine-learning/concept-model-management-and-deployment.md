---
title: 'MLOps: управление моделью ML'
titleSuffix: Azure Machine Learning
description: 'Узнайте больше об управлении моделью с помощью Azure Machine Learning (MLOps). Развертывайте, управляйте и отслеживайте свои модели, чтобы постоянно улучшать их. '
services: machine-learning
ms.service: machine-learning
ms.subservice: core
ms.topic: conceptual
ms.reviewer: jmartens
author: jpe316
ms.author: jordane
ms.date: 03/17/2020
ms.custom: seodec18
ms.openlocfilehash: 7857d11c625911cd1b49dfcf0e0d612fc6a3871e
ms.sourcegitcommit: 7e04a51363de29322de08d2c5024d97506937a60
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81314306"
---
# <a name="mlops-model-management-deployment-and-monitoring-with-azure-machine-learning"></a>MLOps: Управление моделью, развертывание и мониторинг с помощью машинного обучения Azure

В этой статье узнайте, как использовать машинное обучение Azure для управления жизненным циклом моделей. Azure Machine Learning использует подход для машинного обучения (MLOpS). MLOps улучшает качество и согласованность решений для машинного обучения. 

## <a name="what-is-mlops"></a>Что собой представляет MLOps?

Операции машинного обучения (MLOps) основаны на принципах и методах [DevOps,](https://azure.microsoft.com/overview/what-is-devops/) которые повышают эффективность рабочих процессов. Например, непрерывная интеграция, доставка и развертывание. MLOps применяет эти принципы к процессу машинного обучения, с целью:

* Быстрые эксперименты и разработка моделей
* Более быстрое развертывание моделей в производство
* Контроль качества

Azure Machine Learning предоставляет следующие возможности MLOps:

- **Создавайте воспроизводимые провода ML.** Конвейеры машинного обучения позволяют определить повторяющиеся и многоразовые шаги для процессов подготовки данных, обучения и оценки.
- **Создание многоразовых программных сред** для обучения и развертывания моделей.
- **Регистрация, упаковка и развертывание моделей из любого места.** Можно также отслеживать связанные метаданные, необходимые для использования модели.
- **Захват данных управления для сквозного жизненного цикла ML.** Зарегистрированная информация может включать в себя, кто публикует модели, почему были внесены изменения, и когда модели были развернуты или использованы в производстве.
- **Уведомляйте и оповещайте о событиях жизненного цикла ML.** Например, завершение эксперимента, регистрация моделей, развертывание модели и обнаружение дрейфа данных.
- **Мониторинг ML-приложений для операционных и связанных с ML вопросов.** Сравните входные данные моделей между обучением и выводом, изучите метрики, связанные с конкретными моделями, и предоставьте мониторинг и оповещения о вашей инфраструктуре ML.
- **Автоматизировать сквозной жизненный цикл ML с помощью Azure Machine Learning и Azure Pipelines.** Использование конвейеров позволяет часто обновлять модели, тестировать новые модели и непрерывно внедрять новые модели ML наряду с другими приложениями и службами.

## <a name="create-reproducible-ml-pipelines"></a>Создание воспроизводимых проводов ML

Используйте провода ML из Azure Machine Learning, чтобы сшить все этапы, связанные с процессом обучения модели.

Конвейер ML может содержать шаги от подготовки данных к извлечению функций до настройки гиперпарамтоля до оценки модели. Для получения дополнительной [информации см.](concept-ml-pipelines.md)

Если вы используете [конструктор](concept-designer.md) для создания проводов ML, вы можете в любое время нажать **"..."** в правом верхнем правом верхнем правом направлении страницы конструктора, а затем выбрать **клон.** Клонирование конвейера позволяет итерировать конструкцию конвейера, не теряя старых версий.  

## <a name="create-reusable-software-environments"></a>Создание многоразовых программных сред

Среды машинного обучения Azure позволяют отслеживать и воспроизводить программные зависимости ваших проектов по мере их развития. Среды позволяют гарантировать, что сборки воспроизводимы без ручных конфигураций программного обеспечения.

Среды описывают зависимости пипсов и Conda для ваших проектов и могут использоваться как для обучения, так и для развертывания моделей. Для получения дополнительной [информации](concept-environments.md)см.

## <a name="register-package-and-deploy-models-from-anywhere"></a>Регистрация, упаковка и развертывание моделей из любой точки мира

### <a name="register-and-track-ml-models"></a>Регистрация и отслеживание моделей ML

Регистрация модели позволяет хранить и изменять модели в облаке Azure в рабочей области. Модель реестра позволяет легко организовывать и отслеживать ваши обученные модели.

> [!TIP]
> Зарегистрированная модель является логическим контейнером для одного или нескольких файлов, вкоторыеруюных в вашу модель. Например, если у вас есть модель, которая хранится в нескольких файлах, вы можете зарегистрировать их в качестве единой модели в рабочем пространстве Azure Machine Learning. После регистрации можно загрузить или развернуть зарегистрированную модель и получить все файлы, которые были зарегистрированы.

Зарегистрированные модели идентифицируются по имени и версии. При регистрации модели с уже существующим именем реестр увеличивает номер версии. Дополнительные метки метаданных могут быть предоставлены во время регистрации. Эти теги затем используются при поиске модели. Azure Machine Learning поддерживает любую модель, которую можно загрузить с помощью Python 3.5.2 или выше.

> [!TIP]
> Вы также можете зарегистрировать модели, обученные за пределами машинного обучения Azure.

Нельзя удалить зарегистрированную модель, которая используется в активном развертывании.
Дополнительные сведения см. в разделе "Регистрация модели" статьи [Развертывание моделей с помощью Службы машинного обучения Azure](how-to-deploy-and-where.md#registermodel).

### <a name="profile-models"></a>Модели профиля

Машинное обучение Azure поможет вам понять требования к процессору и памяти службы, которые будут созданы при развертывании модели. Профилирование тестирует службу, которая запускает модель, и возвращает информацию, такую как использование процессора, использование памяти и задержка ответа. Он также предоставляет рекомендации по процессору и памяти на основе использования ресурсов.
Для получения дополнительной информации смотрите раздел профилирования [моделей Deploy.](how-to-deploy-and-where.md#profilemodel)

### <a name="package-and-debug-models"></a>Модели упаковки и отладки

Перед развертыванием модели в производство она упаковывается в изображение Docker. В большинстве случаев создание изображения происходит автоматически в фоновом режиме во время развертывания. Можно вручную указать изображение.

При вознике проблемы с развертыванием можно развернуть в локальной среде разработки для устранения неполадок и отладки.

Для получения дополнительной информации [см. модели развертывания](how-to-deploy-and-where.md#registermodel) и [развертывания для устранения неполадок.](how-to-troubleshoot-deployment.md)

### <a name="convert-and-optimize-models"></a>Преобразование и оптимизация моделей

Преобразование модели в [Open Neural Network Exchange](https://onnx.ai) (ONNX) может повысить производительность. В среднем, переход на ONNX может дать 2x увеличение производительности.

Для получения дополнительной информации о ONNX с Azure машинного обучения, [см.](concept-onnx.md)

### <a name="use-models"></a>Использование моделей

Обученные модели машинного обучения развертываются в виде веб-сервисов в облаке или локально. Можно также развертывать модели на устройствах Azure IoT Edge. Для выводов развертываемых используются cPU, GPU или полевые программируемые стробы (FPGA). Вы также можете использовать модели от Power BI.

При использовании модели в качестве веб-сервиса или устройства IoT Edge вы предоставляете следующие элементы:

* Модель (ы), которые используются для оценки данных, представленных в службу/устройство.
* Скрипт входа. Этот скрипт принимает запросы, использует модель (ы) для оценки данных и возврата ответа.
* Среда машинного обучения Azure, описывающая зависимости пипсов и Conda, требуемые моделью (ы) и скриптом входа.
* Любые дополнительные ресурсы, такие как текст, данные и т.д., которые требуются модели (ы) и скрипта входа.

Вы также предоставляете конфигурацию платформы целевого развертывания. Например, тип семейства VM, доступная память и количество ядер при развертывании в службе Azure Kubernetes.

При создании изображения также добавляются компоненты, требуемые для машинного обучения Azure. Например, ресурсы, необходимые для запуска веб-службы и взаимодействия с IoT Edge.

#### <a name="batch-scoring"></a>Пакетная оценка
Пакетный скоринг поддерживается через провода ML. Для получения дополнительной информации смотрите [прогнозы пакета на больших данных](how-to-use-parallel-run-step.md).

#### <a name="real-time-web-services"></a>Веб-сервисы в режиме реального времени

Вы можете использовать свои модели в **веб-сервисах** со следующими вычислительными целями:

* Экземпляр контейнера Azure
* Служба Azure Kubernetes
* Локальная среда разработки

Чтобы развернуть модель в виде веб-службы, необходимо предоставить следующие элементы:

* Модель или ансамбль моделей.
* Зависимости, необходимые для использования модели. Например, скрипт, который принимает запросы и вызывает модель, conda зависимостей и т.д.
* Конфигурация развертывания, описывающая, как и где развертывать модель.

Для получения дополнительной информации [см.](how-to-deploy-and-where.md)

#### <a name="controlled-rollout"></a>Контролируемое развертывание

При развертывании в службе Azure Kubernetes можно использовать контролируемое развертывание для включения следующих сценариев:

* Создание нескольких версий конечной точки для развертывания
* Выполните A/B-тестирование путем перехивания трафика в различные версии конечной точки.
* Переключение между конечными версиями путем обновления процента трафика в конфигурации конечных точек.

Для получения дополнительной [информации см.](how-to-deploy-azure-kubernetes-service.md#deploy-models-to-aks-using-controlled-rollout-preview)

#### <a name="iot-edge-devices"></a>Устройства IoT Edge

Модели с устройствами IoT можно использовать через **модули Azure IoT Edge.** Модули IoT Edge развертываются на аппаратном устройстве, что позволяет делать выводы или забивать модели на устройстве.

Для получения дополнительной информации [см.](how-to-deploy-and-where.md)

### <a name="analytics"></a>Analytics

Microsoft Power BI поддерживает использование моделей машинного обучения для анализа данных. Для получения дополнительной информации см. [интеграцию машинного обучения Azure в Power BI (предварительный просмотр).](https://docs.microsoft.com/power-bi/service-machine-learning-integration)

## <a name="capture-the-governance-data-required-for-capturing-the-end-to-end-ml-lifecycle"></a>Захват данных управления, необходимых для захвата сквозного жизненного цикла ML

Azure ML дает возможность отслеживать сквозной аудит всех ваших активов ML с помощью метаданных.

- Azure ML [интегрируется с Git](how-to-set-up-training-targets.md#gitintegration) для отслеживания информации о том, из какого репозитория/ветки/ коммитветь ваш код пришел.
- [Наборы данных Azure ML](how-to-create-register-datasets.md) помогают отслеживать, профили и данные версий.
- [Интерпретация](how-to-machine-learning-interpretability.md) позволяет объяснить свои модели, соответствовать требованиям нормативных требований и понять, как модели приходят к результату для данного ввода.
- История Azure ML Run хранит моментальный снимок кода, данных и вычислений, используемых для обучения модели.
- Реестр моделей Azure ML отображает все метаданные, связанные с моделью (который эксперимент обучал ее, где она развертывается, если ее развертывания являются здоровыми).
- [Интеграция с Azure Event Grid](concept-event-grid-integration.md) позволяет действовать в зависимости от событий в жизненном цикле ML. Например, регистрация моделей, развертывание, дрейф данных и обучающие (запуск) события.

> [!TIP]
> В то время как некоторая информация о моделях и наборах данных автоматически фиксируется, вы можете добавить дополнительную информацию с помощью __тегов.__ При поиске зарегистрированных моделей и наборов данных в рабочей области можно использовать теги в качестве фильтра.
>
> Связывание набора данных с зарегистрированной моделью является необязательным шагом. Для получения информации о ссылках на набор данных [Model](https://docs.microsoft.com/python/api/azureml-core/azureml.core.model(class)?view=azure-ml-py) при регистрации модели см.


## <a name="notify-automate-and-alert-on-events-in-the-ml-lifecycle"></a>Уведомляйте, автоматизизируете и оповещения о событиях в жизненном цикле ML
Azure ML публикует ключевые события для Azure EventGrid, которые могут быть использованы для уведомления и автоматизации событий в жизненном цикле ML. Для получения дополнительной информации, пожалуйста, смотрите [этот документ](how-to-use-event-grid.md).


## <a name="monitor-for-operational--ml-issues"></a>Мониторинг операционных & вопросов ML

Мониторинг позволяет понять, какие данные отправляются в модель, и прогнозы, которые они возвращаются.

Эта информация поможет вам понять, как используется ваша модель. Собранные входные данные также могут быть полезны для подготовки будущих версий модели.

Дополнительные сведения см. в статье [Сбор данных для моделей в рабочей среде](how-to-enable-data-collection.md).

## <a name="retrain-your-model-on-new-data"></a>Переподготовка модели на новых данных

Часто, по мере получения новой информации, необходимо проверить модель, обновить ее или даже переобучить ее с нуля. Иногда получение новых данных является ожидаемой частью домена. В других случаях, как это обсуждалось в [Detect data drift (предварительный просмотр) на наборах данных,](how-to-monitor-datasets.md)производительность модели может ухудшиться перед лицом таких вещей, как изменения в определенном датчике, естественные изменения данных, такие как сезонные эффекты, или функции, меняющиеся по отношению к другим функциям. 

Существует нет универсального ответа на вопрос: "Как я могу знать, если я должен переквалифицироваться?" но инструменты azure ML и мониторинга, которые обсуждались ранее, являются хорошими отправными точками для автоматизации. После того как вы решили переквалифицироваться, вы должны: 

- Предварительное обработка данных с помощью повторяемого автоматизированного процесса
- Обучить новую модель
- Сравните результаты вашей новой модели с выходами вашей старой модели
- Используйте предопределенные критерии, чтобы выбрать, следует ли заменить старую модель 

Тема вышеуказанных шагов заключается в том, что переподготовка должна быть автоматизирована, а не специально. [Конвейеры машинного обучения Azure](concept-ml-pipelines.md) являются хорошим ответом для создания рабочих процессов, связанных с подготовкой данных, обучением, проверкой и развертыванием. Прочитайте [модели Retrain с дизайнером машинного обучения Azure (предварительный просмотр),](how-to-retrain-designer.md) чтобы увидеть, как конвейеры и конструктор Машинного обучения Azure вписываются в сценарий переподготовки. 

## <a name="automate-the-ml-lifecycle"></a>Автоматизация жизненного цикла ML 

Для создания непрерывного процесса интеграции, который обучает модели, можно использовать GitHub и Azure Pipelines. В типичном сценарии, когда специалист по обработке данных проверяет изменение репо Git для проекта, конвейер Azure запустит обучаемый запуск. Затем результаты запуска можно проверить, чтобы увидеть характеристики производительности обученной модели. Можно также создать конвейер, развертывая модель в виде веб-службы.

[Расширение машинного обучения Azure](https://marketplace.visualstudio.com/items?itemName=ms-air-aiagility.vss-services-azureml) упрощает работу с конвейерами Azure. Он предоставляет следующие усовершенствования для трубопроводов Azure:

* Позволяет проводить выбор рабочей области при определении соединения службы.
* Позволяет запускать конвейеры выпуска обученными моделями, созданными в обучаемом конвейере.

Для получения дополнительной информации об использовании трубопроводов Azure с помощью машинного обучения Azure см.

* [Непрерывная интеграция и развертывание моделей ML с Azure Pipelines](/azure/devops/pipelines/targets/azure-machine-learning) 
* Репозиторий [Машинного обучения Azure.](https://aka.ms/mlops)
* Репозиторий [Azure Machine Learning MLOpsPython.](https://github.com/Microsoft/MLOpspython)

Можно также использовать фабрику данных Azure для создания конвейера приема данных, который готовит данные для использования с обучением. Для получения дополнительной [Data ingestion pipeline](how-to-cicd-data-ingestion.md)информации см.

## <a name="next-steps"></a>Следующие шаги

Узнайте больше, прочитав и исследуя следующие ресурсы:

+ [Как & где развертывать модели](how-to-deploy-and-where.md) с помощью машинного обучения Azure

+ [Учебник: Развертывание модели классификации изображений в ACI](tutorial-deploy-models-with-aml.md).

+ [Сквозные примеры MLOps репо](https://github.com/microsoft/MLOps)

+ [CI/CD моделей ML с Azure Pipelines](/azure/devops/pipelines/targets/azure-machine-learning)

+ Создание клиентов, [потребляемых в развернутой модели](how-to-consume-web-service.md)

+ [Машинное обучение с поддержкой масштабирования](/azure/architecture/data-guide/big-data/machine-learning-at-scale)

+ [Архитектуры АИ Azure AI & рекомендации по респ](https://github.com/microsoft/AI)
