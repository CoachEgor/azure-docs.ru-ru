---
title: Развертывание веб-службы
titleSuffix: ML Studio (classic) - Azure
description: Как преобразовать обучающий эксперимент в прогнозный, подготовить его к развертыванию, а затем развернуть как веб-службу Машинное обучение Azure Studio (классическая модель).
services: machine-learning
ms.service: machine-learning
ms.subservice: studio
ms.topic: conceptual
author: xiaoharper
ms.author: amlstudiodocs
ms.custom: previous-ms.author=yahajiza, previous-author=YasinMSFT
ms.date: 01/06/2017
ms.openlocfilehash: 1b9a836491e989b676663d13b8eebb994c5145d8
ms.sourcegitcommit: f4f626d6e92174086c530ed9bf3ccbe058639081
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/25/2019
ms.locfileid: "75454786"
---
# <a name="deploy-an-azure-machine-learning-studio-classic-web-service"></a>Развертывание веб-службы Машинное обучение Azure Studio (классическая модель)

Машинное обучение Azure Studio (классическая модель) позволяет создавать и тестировать решение прогнозной аналитики. Затем эти решение можно развернуть как веб-службу.

Веб-службы Машинное обучение Studio (классическая модель) предоставляют интерфейс между приложением и моделью оценки рабочего процесса Машинное обучение Studio (классической модели). Внешнее приложение может взаимодействовать с моделью оценки рабочего процесса Машинное обучение Studio (классической) в режиме реального времени. Вызов веб-службы Машинное обучение Studio (классическая модель) возвращает результаты прогноза внешнему приложению. Чтобы вызвать веб-службу, передайте ключ API, созданный при развертывании этой службы. Веб-служба Машинное обучение Studio (классическая) основана на самой популярной архитектуре проектов веб-программирования.

Машинное обучение Azure Studio (классическая модель) имеет два типа веб-служб:

* Служба "запрос — ответ" (RR): низкая задержка, Высокомасштабируемая служба, которая оценивает единственную запись данных.
* Служба пакетного выполнения (BES) — асинхронная служба, которая оценивает пакет записей данных.

Входные данные для службы BES похожи на входные данные, используемые в службе RRS. Основная разница заключается в том, что служба BES считывает блок записей из различных источников, таких как хранилище BLOB-объектов Azure, Хранилище таблиц в Azure, база данных SQL Azure, HDInsight (запросы Hive) и HTTP.

Процесс развертывания модели можно обобщить до трех этапов:

* **[Создание обучающего эксперимента]** . в Studio (классическая модель) можно обучить и протестировать модели прогнозной аналитики с помощью предоставленных обучающих данных, используя большой набор встроенных алгоритмов машинного обучения.
* **[Преобразование обучающего эксперимента в прогнозный]** Когда модель обучена с помощью существующих данных и готова для оценки новых данных, вы подготавливаете и оптимизируете свой эксперимент для прогнозов.
* **Развертывание** эксперимента как **[Новая веб-служба]** или **[Классическая веб-служба]** . При развертывании прогнозного эксперимента как веб-службы Azure пользователи могут отправлять данные в модель и получать ее прогнозы.

## <a name="create-a-training-experiment"></a>Создание обучающего эксперимента

Для обучения модели прогнозной аналитики используется Машинное обучение Azure Studio (классическая модель), чтобы создать обучающий эксперимент, где вы включаете различные модули для загрузки обучающих данных, Подготовьте данные по мере необходимости, примените алгоритмы машинного обучения и оцените результаты. Вы можете выполнять итерации эксперимента и испытывать разные алгоритмы машинного обучения, чтобы сравнить и оценить результаты.

Процесс создания обучающих экспериментов и управления ими рассматривается более подробно в других материалах. Дополнительные сведения вы найдете в следующих статьях:

* [Создание простого эксперимента в Машинное обучение Azure Studio (классическая модель)](create-experiment.md)
* [Разработка прогнозного решения с помощью Машинное обучение Azure Studio (классическая модель)](tutorial-part1-credit-risk.md)
* [Импорт обучающих данных в Машинное обучение Azure Studio (классическая модель)](import-data.md)
* [Управление итерациями экспериментов в Машинное обучение Azure Studio (классическая модель)](manage-experiment-iterations.md)

## <a name="convert-the-training-experiment-to-a-predictive-experiment"></a>Преобразование обучающего эксперимента в прогностический эксперимент

После обучения модели вы можете преобразовать обучающий эксперимент в прогнозный, чтобы оценить новые данные.

После преобразования в прогностический эксперимент ваша модель обучения готова к развертыванию в качестве оценивающей веб-службы. Пользователи веб-службы будут отправлять в модель входные данные, а модель будет возвращать им результаты прогнозов. При преобразовании эксперимента в прогнозный следует учитывать, как пользователи будут использовать эту модель.

Чтобы преобразовать обучающий эксперимент в прогнозный, в нижней части холста эксперимента нажмите кнопку **Run** (Выполнить), а затем щелкните **Set Up Web Service** (Настроить веб-службу) и выберите **Predictive Web Service** (Прогностическая веб-служба).

![Преобразование в эксперимент по оценке](./media/publish-a-machine-learning-web-service/figure-1.png)

Дополнительные сведения о том, как выполнить это преобразование, см. [в статье Подготовка модели к развертыванию в машинное обучение Azure Studio (классическая модель)](convert-training-experiment-to-scoring-experiment.md).

Ниже описано, как развернуть прогнозный эксперимент в качестве новой веб-службы. Кроме того, эксперимент можно развернуть как классическую веб-службу.

## <a name="deploy-it-as-a-new-web-service"></a>Развертывание эксперимента в качестве новой веб-службы

Теперь, когда прогнозный эксперимент подготовлен, его можно развернуть в качестве новой веб-службы Azure (на основе Azure Resource Manager). С помощью веб-службы пользователи могут отправлять данные модели, которая, в свою очередь, будет возвращать свои прогнозы.

Чтобы развернуть прогнозный эксперимент, в нижней части области эксперимента щелкните **Run** (Выполнить). После завершения эксперимента щелкните **Deploy Web Service** (Развернуть веб-службу) и выберите **Deploy Web Service [новую]** .  Откроется страница развертывание портала веб-службы Машинное обучение Studio (классическая модель).

> [!NOTE] 
> Для развертывания новой веб-службы у вас должен быть достаточный уровень разрешений в подписке, в которую выполняется развертывание веб-службы. Дополнительные сведения см. в статье [Управление веб-службой с помощью портала веб-служб машинного обучения Azure](manage-new-webservice.md). 

### <a name="web-service-portal-deploy-experiment-page"></a>Страница развертывания эксперимента на портале веб-служб

На странице "Deploy Experiment" (Развертывание эксперимента) введите имя веб-службы.
Выберите ценовой план. Если у вас уже имеется ценовой план, то можно выбрать его. В противном случае необходимо создать ценовой план для службы.

1. В раскрывающемся списке **Price Plan** (Ценовой план) выберите существующий план или щелкните **Select new plan** (Выбрать новый план).
2. В поле **Имя плана**введите имя для идентификации плана в счете.
3. Выберите один из вариантов **Monthly Plan Tier**(Уровень ежемесячного плана). По умолчанию указаны уровни плана для вашего региона по умолчанию, и веб-служба развертывается именно в этом регионе.

Щелкните **Deploy** (Развернуть). Откроется страница **быстрого запуска** веб-службы.

На странице быстрого запуска веб-службы доступны рекомендации по выполнению распространенных задач после создания веб-службы. С нее можно быстро перейти на страницу тестирования или использования.

<!-- ![Deploy the web service](./media/publish-a-machine-learning-web-service/figure-2.png)-->

### <a name="test-your-new-web-service"></a>Тестирование новой веб-службы

Чтобы протестировать новую веб-службу, в разделе общих задач щелкните **Test web service** (Тестировать веб-службу). На странице тестирования веб-службу можно проверить двумя способами: как службу RRS (запрос-ответ) или как службу BES (пакетное выполнение).

На странице тестирования RRS отображаются входные и выходные данные, а также все глобальные параметры, которые были определены для эксперимента. Чтобы протестировать веб-службу, вручную введите необходимые значения для входных данных или предоставьте тестовые значения в файле данных с разделителями-запятыми (CSV).

Для тестирования с помощью службы RRS в режиме представления списка введите необходимые значения для входных данных и щелкните **Test Request-Response**(Тестировать "запрос-ответ"). Результаты прогноза отобразятся в выходном столбце справа.

![Введите соответствующие значения для тестирования веб-службы](./media/publish-a-machine-learning-web-service/figure-5-test-request-response.png)

Для тестирования службы BES щелкните **Batch**(Пакетная служба). На странице тестирования "Batch" (Пакетная служба) в разделе входных данных нажмите кнопку "Browse" (Обзор) и выберите CSV-файл, содержащий необходимые примеры значений. Если у вас нет CSV-файла и вы создали прогнозный эксперимент с помощью Машинное обучение Studio (классическая модель), вы можете скачать набор данных для прогнозного эксперимента и использовать его.

Чтобы скачать набор данных, откройте Машинное обучение Studio (классическая модель). Откройте прогнозный эксперимент и щелкните правой кнопкой мыши входные данные своего эксперимента. В контекстном меню выберите **dataset** (набор данных), а затем выберите **Download** (Скачать).

![Скачивание набора данных из холста (классической) студии](./media/publish-a-machine-learning-web-service/figure-7-mls-download.png)

Нажмите **Проверить**. Состояние задания пакетного выполнения отобразится справа в разделе **Test Batch Jobs**(Тестирование пакетных заданий).

![Тестирование задания пакетного выполнения с помощью портала веб-служб](./media/publish-a-machine-learning-web-service/figure-6-test-batch-execution.png)

<!--![Test the web service](./media/publish-a-machine-learning-web-service/figure-3.png)-->

На странице **конфигурации** можно изменить описание или заголовок, обновить ключ учетной записи хранения, а также включить образцы данных для веб-службы.

![Настройка веб-службы](./media/publish-a-machine-learning-web-service/figure-8-arm-configure.png)

### <a name="access-your-new-web-service"></a>Доступ к новой веб-службе

После развертывания веб-службы из Машинное обучение Studio (классической) можно отправлять данные в службу и получать ответы программным способом.

Страница **Consume** (Использование) предоставляет всю информацию, необходимую для доступа к веб-службе. Например, предоставляемый ключ API обеспечивает авторизованный доступ к службе.

Дополнительные сведения о доступе к веб-службе Машинное обучение Studio (классическая модель) см. в статье Использование [веб-службы машинное обучение Azure Studio (классическая модель)](consume-web-services.md).

### <a name="manage-your-new-web-service"></a>Управление новой веб-службой

Вы можете управлять новыми веб-службами с помощью портала веб-служб Машинное обучение Studio (классическая модель). На [главной странице портала](https://services.azureml.net/) щелкните **Web Services** (Веб-службы). На странице веб-служб можно удалить службу или скопировать ее. Для наблюдения за конкретной службой выберите службу и щелкните **Dashboard**(Панель мониторинга). Для наблюдения за выполнением пакетных заданий, связанных с веб-службой, щелкните **Batch Request Log**(Журнал пакетных запросов).

### <a id="multi-region"></a> Развертывание новой веб-службы в нескольких регионах

Вы можете легко развернуть новую веб-службу в нескольких регионах. При этом не требуется иметь несколько подписок или рабочих областей.

Цены зависят от региона, поэтому план выставления счетов необходимо определить для каждого региона, в котором будет выполняться развертывание веб-службы.

#### <a name="create-a-plan-in-another-region"></a>Создание плана в другом регионе

1. Войдите на страницу [веб-служб Машинного обучения Microsoft Azure](https://services.azureml.net/).
2. Щелкните пункт меню **Plans** (Планы).
3. На странице Plans overview (Обзор планов) нажмите кнопку **New**(Создать).
4. В раскрывающемся списке **Subscription** (Подписка) выберите подписку, в которой будет располагаться новый план.
5. В раскрывающемся списке **Region** (Регион) выберите регион для нового плана. Параметры плана для выбранного региона отобразятся в разделе **Plan Options** (Параметры плана) этой страницы.
6. В раскрывающемся списке **Resource Group** (Группа ресурсов) выберите для плана группу ресурсов. Дополнительные сведения о группах ресурсов см. в статье [Общие сведения об Azure Resource Manager](../../azure-resource-manager/management/overview.md).
7. В поле **Plan Name** (Имя плана) введите имя плана.
8. В разделе **Plan Options**(Параметры плана) выберите уровень выставления счетов для нового плана.
9. Нажмите кнопку **Создать**.

#### <a name="deploy-the-web-service-to-another-region"></a>Развертывание веб-службы в другом регионе

1. На странице веб-служб Машинного обучения Microsoft Azure щелкните **Веб-службы**  в меню.
2. Выберите веб-службу, которую требуется развернуть в новом регионе.
3. Нажмите кнопку **Копировать**.
4. В поле **Web Service Name**(Имя веб-службы) введите новое имя веб-службы.
5. В поле **Web service description**(Описание веб-службы) введите описание веб-службы.
6. В раскрывающемся списке **Subscription** (Подписка) выберите подписку, в которой будет располагаться новая веб-служба.
7. В раскрывающемся списке **Resource Group** (Группа ресурсов) выберите для веб-службы группу ресурсов. Дополнительные сведения о группах ресурсов см. в статье [Общие сведения об Azure Resource Manager](../../azure-resource-manager/management/overview.md).
8. В раскрывающемся списке **Region** (Регион) выберите регион, в котором требуется развернуть веб-службу.
9. В раскрывающемся списке **Storage account** (Учетная запись хранения) выберите учетную запись, в которой будет храниться веб-служба.
10. В раскрывающемся списке **Price Plan** (Ценовой план) выберите план в регионе, который вы выбрали в действии 8.
11. Нажмите кнопку **Копировать**.

## <a name="deploy-it-as-a-classic-web-service"></a>Развертывание эксперимента в виде классической веб-службы

Теперь, когда прогностический эксперимент был необходимым образом подготовлен, его можно развернуть в качестве классической веб-службы Azure. С помощью веб-службы пользователи могут отправлять данные модели, которая, в свою очередь, будет возвращать свои прогнозы.

Чтобы развернуть прогностический эксперимент, нажмите **Run** (Выполнить) в нижней части холста эксперимента, а затем выберите **Deploy Web Service** (Развернуть веб-службу). Веб-служба будет настроена, затем отобразится ее панель мониторинга.

![Развертывание веб-службы из студии (классическая модель)](./media/publish-a-machine-learning-web-service/figure-2.png)

### <a name="test-your-classic-web-service"></a>Тестирование классической веб-службы

Веб-службу можно проверить на портале веб-служб Машинное обучение Studio (классическая модель) или в Машинное обучение Studio (классическая модель).

Чтобы протестировать веб-службу "запрос-ответ", щелкните ссылку **Test** (Проверить) на панели мониторинга веб-службы. Появится диалоговое окно, предлагающее ввести входные данные для службы. Это столбцы, ожидаемые экспериментом по оценке. Введите набор данных и нажмите кнопку **ОК**. Результаты, созданные веб-службой, отображаются внизу панели мониторинга.

Щелкните ссылку Просмотр **теста** , чтобы проверить службу на портале веб-служб машинное обучение Azure Studio (классическая модель), как показано выше в разделе Создание веб-службы.

Чтобы протестировать службу пакетного выполнения, щелкните ссылку **Test** (Проверить). На странице тестирования "Batch" (Пакетная служба) в разделе входных данных нажмите кнопку "Browse" (Обзор) и выберите CSV-файл, содержащий необходимые примеры значений. Если у вас нет CSV-файла и вы создали прогнозный эксперимент с помощью Машинное обучение Studio (классическая модель), вы можете скачать набор данных для прогнозного эксперимента и использовать его.

![Тестирование веб-службы](./media/publish-a-machine-learning-web-service/figure-3.png)

На странице **Configuration** (Настройка) можно изменить отображаемое имя службы и добавить ее описание. Имя и описание отображаются на [портале Azure](https://portal.azure.com/), на котором осуществляется управление веб-службами.

Вы можете предоставить описание входных данных, выходных данных и параметров веб-службы, введя строковые данные для каждого столбца в разделах **INPUT SCHEMA** (Схема входных данных), **OUTPUT SCHEMA** (Схема выходных данных) и **Web Service Parameter** (Параметр веб-службы). Эти описания используются в документации по примерам кода для веб-службы.

Включив ведение журнала, вы сможете диагностировать сбои, которые происходят при обращении к веб-службе. Дополнительные сведения см. в статье [Включение ведения журнала для веб-служб машинное обучение Studio (классическая модель)](web-services-logging.md).

![Включение ведения журнала на портале веб-служб](./media/publish-a-machine-learning-web-service/figure-4.png)

Кроме того, на портале веб-службы машинного обучения Azure можно настроить конечные точки веб-службы. См. раздел о развертывании новой веб-службы выше. В этом случае будут доступны другие возможности: можно добавить или изменить описание службы, активировать ведение журнала и включить пример данных для тестирования.

### <a name="access-your-classic-web-service"></a>Доступ к классической веб-службе

После развертывания веб-службы из Машинное обучение Azure Studio (классической) можно отправлять данные в службу и получать ответы программным способом.

Панель мониторинга предоставляет всю информацию, необходимую для доступа к веб-службе. Например, предоставляемый ключ API обеспечивает авторизованный доступ к службе, а страницы справки по API помогут вам приступить к созданию кода.

Дополнительные сведения о доступе к веб-службе Машинное обучение Studio (классическая модель) см. в статье Использование [веб-службы машинное обучение Azure Studio (классическая модель)](consume-web-services.md).

### <a name="manage-your-classic-web-service"></a>Управление классической веб-службой

Веб-службу можно отслеживать разными способами. Ее можно обновить или удалить. Кроме того, для классической веб-службы можно добавить другие конечные точки (в дополнение к созданной при развертывании).

Дополнительные сведения см. в статьях [Управление рабочей областью машинное обучение Azure Studio (классическая модель)](manage-workspace.md) и [Управление веб-службой с помощью портала веб-служб машинное обучение Azure Studio (классическая модель)](manage-new-webservice.md).

## <a name="update-the-web-service"></a>Обновление веб-службы
Вы можете внести изменения в веб-службу, например обновить модель дополнительными обучающими данными, и развернуть ее снова, перезаписав исходную веб-службу.

Чтобы обновить веб-службу, откройте исходный прогностический эксперимент, использованный для развертывания веб-службы, и создайте редактируемую копию, нажав **СОХРАНИТЬ КАК**. Внесите изменения и нажмите **Развернуть веб-службу**.

Так как этот эксперимент уже был развернут, отобразится запрос на перезапись (для классической веб-службы) или обновление (для новой веб-службы) существующей службы. Если нажать **Да** или **Обновить**, существующая веб-служба будет остановлена и вместо нее будет развернут новый прогнозный эксперимент.

> [!NOTE]
> Если вы внесли изменения в конфигурацию исходной веб-службы, например, введя новое отображаемое имя или описание, необходимо будет снова ввести эти значения.

Один из вариантов обновления веб-службы — переобучить модель программно. Дополнительные сведения см. в статье [программное переобучение моделей машинное обучение Studio (классическая модель)](/azure/machine-learning/studio/retrain-machine-learning-model).

## <a name="next-steps"></a>Дальнейшие действия

* Дополнительные технические сведения о том, как работает развертывание, см. в статье [как машинное обучение Studio (классическая модель) подвигается от эксперимента к рабочей веб-службе](model-progression-experiment-to-web-service.md).

* Дополнительные сведения о готовности модели к развертыванию см. в статье [Подготовка модели к развертыванию в машинное обучение Azure Studio (классическая модель)](convert-training-experiment-to-scoring-experiment.md).

* Существует несколько способов использования REST API и доступа к веб-службе. Узнайте, [как использовать веб-службу машинное обучение Azure Studio (классическая модель)](consume-web-services.md).

<!-- internal links -->
[Создание обучающего эксперимента]: #create-a-training-experiment
[Преобразование обучающего эксперимента в прогнозный]: #convert-the-training-experiment-to-a-predictive-experiment
[Новая веб-служба]: #deploy-it-as-a-new-web-service
[Классическая веб-служба]: #deploy-it-as-a-classic-web-service
[новую]: #deploy-it-as-a-new-web-service
[classic]: #deploy-the-predictive-experiment-as-a-classic-web-service
[Access]: #access-the-Web-service
[Manage]: #manage-the-Web-service-in-the-azure-management-portal
[Update]: #update-the-Web-service
