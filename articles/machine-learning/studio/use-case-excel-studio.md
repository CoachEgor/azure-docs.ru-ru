---
title: Мигрирующая аналитика от Excel
titleSuffix: ML Studio (classic) - Azure
description: Сравнение линейных моделей регрессии в Excel и в Студии машинного обучения Azure (классический)
services: machine-learning
ms.service: machine-learning
ms.subservice: studio
ms.topic: conceptual
author: likebupt
ms.author: keli19
ms.custom: previous-author=heatherbshapiro, previous-ms.author=hshapiro
ms.date: 03/20/2017
ms.openlocfilehash: 85bae9bfc10460b51935c6eb1e14e3a3dd816a8c
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "79217798"
---
# <a name="migrate-analytics-from-excel-to-azure-machine-learning-studio-classic"></a>Миграция аналитики из Excel в студию машинного обучения Azure (классический)

[!INCLUDE [Notebook deprecation notice](../../../includes/aml-studio-notebook-notice.md)]

> *Кейт Барони (Kate Baroni)* и *Бен Боутман (Ben Boatman)* являются архитекторами корпоративных решений в Центре передового опыта Data Insights от Microsoft. В этой статье они описывают свой опыт переноса существующего набора анализа регрессии в облачное решение с помощью Azure Machine Learning Studio (классический).

## <a name="goal"></a>Цель

У нашего проекта было две цели: 

1. Используйте прогностический анализ для повышения точности ежемесячных прогнозов доходов нашей организации 
2. Используйте Программу машинного обучения Azure (классическая) для подтверждения, оптимизации, увеличения скорости и масштаба наших результатов. 

Как и множество других компаний, наша организация прогнозирует свой ежемесячный доход. Нашей небольшой команде бизнес-аналитиков было поручено использовать Программу машинного обучения Azure (классическая) для поддержки процесса и повышения точности прогнозов. Несколько месяцев группа занималась сбором данных из нескольких источников и статистическим анализом атрибутов данных, который позволил определить ключевые атрибуты, относящиеся к прогнозированию продаж услуг. Дальнейшие действия состояли в создании прототипов моделей статистической регрессии для данных в Excel. Спустя несколько недель мы получили модель регрессии для Excel, которая превзошла возможности современных процессов отраслевого и финансового прогнозирования. Это стало базовым результатом прогноза. 

Затем мы сделали следующий шаг к перемещению нашей прогностической аналитики к Studio (классический), чтобы узнать, как Studio (классический) может улучшить прогностические производительность.

## <a name="achieving-predictive-performance-parity"></a>Достижение соответствия производительности прогнозирования
Нашим главным приоритетом было достижение паритета между Studio (классические) и модели регрессии Excel. Учитывая те же данные и тот же раскол для обучения и тестирования данных, мы хотели достичь прогностического паритета производительности между Excel и Studio (классический). Сначала нам не удалось выполнить эту задачу. Модель Excel превзошла студийную (классическую) модель. Сбой произошел из-за непонимания настройки базового инструмента в Studio (классический). После синхронизации с командой продуктов Studio (классический) мы получили лучшее понимание базовых параметров, необходимых для наших наборов данных, и достигли паритета между двумя моделями. 

### <a name="create-regression-model-in-excel"></a>Создание регрессионной модели в Excel
Наш метод регрессии в Excel использует стандартную модель линейной регрессии, доступную в пакете анализа Excel. 

Мы вычислили *среднюю абсолютную погрешность в процентах* и использовали это значение в качестве меры производительности модели. Создание рабочей модели с использованием Excel заняло 3 месяца. Мы принесли большую часть обучения в studio (классический) эксперимент, который в конечном итоге было полезно в понимании требований.

### <a name="create-comparable-experiment-in-studio-classic"></a>Создание сопоставимого эксперимента в Studio (классический)
Мы последовали этим шагам, чтобы создать наш эксперимент в Studio (классический): 

1. Загружено набор данных в виде файла csv в Studio (классический) (очень маленький файл)
2. Создание эксперимента и использование модуля [Select Columns in Dataset][select-columns] (Выбор столбцов в наборе данных) для выбора тех же признаков данных, что используются в Excel. 
3. Использование модуля [Split Data][split] (Разделение данных) в режиме *относительного выражения*, чтобы разделить данные на точно такие же наборы данных для обучения, как в Excel. 
4. Проведение эксперимента с модулем [Линейная регрессия][linear-regression] (только с параметрами по умолчанию), документирование и сравнение результатов с результатами модели регрессии Excel.

### <a name="review-initial-results"></a>Просмотр изначальных результатов
Поначалу модель Excel явно превзошла модель Studio (классическая): 

|  | Excel | Студия (классическая) |
| --- |:---:|:---:|
| Производительность | | |
| <ul style="list-style-type: none;"><li>Скорректированный коэффициент детерминации R-квадрат</li></ul> |0,96 |Недоступно |
| <ul style="list-style-type: none;"><li>Коэффициент <br />определения</li></ul> |Недоступно |0,78<br />(низкая точность) |
| Средняя абсолютная погрешность |9 500 000 долл. США |19 400 000 долл. США |
| Средняя абсолютная погрешность (в %) |6,03 % |12,2 % |

Когда мы объяснили принцип выполнения процесса и показали полученные результаты разработчикам и специалистам по обработке и анализу данных из группы разработки машинного обучения, они нам тут же дали несколько полезных советов. 

* При использовании [линейного модуля регрессии][linear-regression] в Studio (классический) предусмотрены два метода:
  * метод градиентного спуска в режиме онлайн — может подойти для крупномасштабных проблем;
  * метод наименьших квадратов — наиболее распространенный метод линейной регрессии. Это самый оптимальный выбор для небольших наборов данных.
* Для повышения производительности следует рассмотреть возможность изменения параметра «Вес регуляризации L2». Его значение по умолчанию — 0,001. Чтобы повысить производительность, для небольшого набора данных мы установили значение 0,005. 

### <a name="mystery-solved"></a>Решение найдено!
Когда мы применили рекомендации, мы достигли той же базовой производительности в Studio (классический), как с Excel: 

|  | Excel | Студия (классическая) (Первоначальная) | Студия (классический) ж / Наименьшие квадраты |
| --- |:---:|:---:|:---:|
| Значение с подписью |Фактические значения (числовые) |—||— |—||— |
| Ученик |Excel -> "Анализ данных" -> "Регрессия" |Линейная регрессия |Линейная регрессия |
| Параметры ученика |Недоступно |Умолчания; |Метод наименьших квадратов<br />L2 = 0,005 |
| Набор данных |26 строк, 3 признака, 1 метка. Все значения числовые. |—||— |—||— |
| Разделение: обучение |Обучение Excel выполнено по первым 18 строкам, тестирование — по последним 8 строкам. |—||— |—||— |
| Разделение: тестирование |Формула регрессии Excel применяется к последним 8 строкам. |—||— |—||— |
| **Производительность** | | | |
| Скорректированный коэффициент детерминации R-квадрат |0,96 |Недоступно | |
| Коэффициент детерминации |Недоступно |0,78 |0,952049 |
| Средняя абсолютная погрешность |9 500 000 долл. США |19 400 000 долл. США |9 500 000 долл. США |
| Средняя абсолютная погрешность (в %) |<span style="background-color: 00FF00;"> 6,03 %</span> |12,2 % |<span style="background-color: 00FF00;"> 6,03 %</span> |

Кроме того, мы получили хорошие результаты сравнения коэффициентов Excel и веса признаков в обученной модели Azure:

|  | Коэффициенты Excel | Весовые коэффициенты компонентов Azure |
| --- |:---:|:---:|
| Отрезок/смещение |19470209,88 |19328500 |
| Признак А |0,832653063 |0,834156 |
| Признак Б |11071967,08 |11007300 |
| Признак В |25383318,09 |25140800 |

## <a name="next-steps"></a>Next Steps
Мы хотели использовать веб-службу машинного обучения в Excel. Наши бизнес-аналитики полагаются на Excel, и нам нужно было найти способ вызвать веб-службу машинного обучения из строки данных Excel, чтобы она вернула спрогнозированное значение в Excel. 

Мы также хотели оптимизировать нашу модель, используя варианты и алгоритмы, доступные в Studio (классический).

### <a name="integration-with-excel"></a>Интеграция с Excel
Наше решение должно было привести в действие модель регрессии машинного обучения за счет создания веб-службы из обученной модели. Мы создали веб-службу за несколько минут и смогли вызвать ее прямо из Excel, чтобы получить спрогнозированное значение дохода. 

В разделе *Web Services Dashboard* (Панель мониторинга веб-служб) содержится книга Excel, которую можно скачать. Эта книга предварительно отформатирована с помощью API веб-службы, и в нее внедрена информация о схемах. Чтобы скачать книгу, щелкните *Download Excel Workbook* (Скачать книгу Excel). Она откроется, и ее можно будет сохранить на локальном компьютере. 

![Скачать рабочую книгу Excel с панели мониторинга web-сервисов](./media/linear-regression-in-azure/machine-learning-linear-regression-in-azure-1.png)

Пока книга открыта, скопируйте предопределенные параметры в синий раздел «Параметры», показанный ниже. После ввода параметров Excel вызовет веб-службу машинного обучения, а в зеленом разделе "Спрогнозированные значения" отобразятся спрогнозированные оцененные метки. Книга продолжит создавать спрогнозированные значения параметров для всех элементов строк, введенных в разделе «Параметры», на основе обученной модели. Дополнительные сведения об использовании этой функции см. в статье [Использование веб-службы Машинного обучения Azure в Excel](consuming-from-excel.md). 

![Шаблон Excel рабочая книга подключения к развернутой веб-службы](./media/linear-regression-in-azure/machine-learning-linear-regression-in-azure-2.png)

### <a name="optimization-and-further-experiments"></a>Оптимизация и дальнейшие эксперименты
Определив необходимую модель Excel, мы приступили к оптимизации модели линейной регрессии машинного обучения. Мы использовали модуль [Filter-Based Feature Selection][filter-based-feature-selection] (Выбор признаков на основе фильтра), чтобы усовершенствовать выбор исходных элементов данных, и это помогло нам добиться повышения производительности — коэффициент средней абсолютной погрешности достиг отметки 4,6 %. Для будущих проектов мы будем использовать эту функцию, которая может сэкономить нам недели в итерации через атрибуты данных, чтобы найти правильный набор функций для использования для моделирования. 

Далее мы планируем включить в эксперимент дополнительные алгоритмы, такие как [байесовский][bayesian-linear-regression] алгоритм или [увеличивающиеся деревья принятия решений][boosted-decision-tree-regression], для сравнения производительности. 

Если вы хотите поэкспериментировать с регрессией, попробуйте использовать пример набора данных регрессии энергетического КПД. Он отлично подходит для этого и содержит множество числовых атрибутов. Набор данных предоставляется в рамках наборов выборочных данных в Studio (классический). Вы можете использовать множество модулей обучения для прогнозирования отопительной нагрузки или нагрузки по охлаждению. В таблице ниже сравнена производительность различных регрессионных моделей обучения и набора данных энергетического КПД для прогнозирования целевой переменной нагрузки по охлаждению: 

| Модель | Средняя абсолютная погрешность | Среднеквадратическая погрешность | Относительная абсолютная погрешность | Относительная среднеквадратическая погрешность | Коэффициент детерминации |
| --- | --- | --- | --- | --- | --- |
| Увеличивающееся дерево принятия решений |0,930113 |1,4239 |0,106647 |0,021662 |0,978338 |
| Линейная регрессия (метод градиентного спуска) |2,035693 |2,98006 |0,233414 |0,094881 |0,905119 |
| Регрессия нейронной сети |1,548195 |2,114617 |0,177517 |0,047774 |0,952226 |
| Линейная регрессия (метод наименьших квадратов) |1,428273 |1,984461 |0,163767 |0,042074 |0,957926 |

## <a name="key-takeaways"></a>Общие выводы
Мы многому научились, запустив рекгрессию Excel и студийные (классические) эксперименты параллельно. Создание базовой модели в Excel и сравнение ее с моделями с использованием [машинного обучения linear Regression][linear-regression] помогли нам узнать Studio (классический), и мы обнаружили возможности для улучшения выбора данных и производительности модели. 

Мы также поняли, что в будущем для более быстрого получения результатов по проектам прогнозирования целесообразно использовать модуль [Filter-Based Feature Selection][filter-based-feature-selection] (Выбор признаков на основе фильтра). Применяя выбор функций к данным, вы можете создать улучшенную модель в Studio (классическая) с лучшей общей производительностью. 

Возможность переноса прогностического аналитического прогнозирования из Studio (классического) в Excel системно позволяет значительно увеличить способность успешно предоставлять результаты широкой бизнес-аудитории. 

## <a name="resources"></a>Ресурсы
Ниже перечислены некоторые ресурсы, которые помогут вам в работе с регрессией. 

* Регрессия в Excel. Если вы никогда не пробовали регрессии в Excel, этот учебник делает его легким:[https://www.excel-easy.com/examples/regression.html](https://www.excel-easy.com/examples/regression.html)
* Сравнение регрессии и прогнозирования. Тайлер Чессман написал в блоге статью, объясняющую, как сделать прогнозирование временных рядов в Excel, который содержит хорошее описание новичка линейной регрессии. [https://www.itprotoday.com/sql-server/understanding-time-series-forecasting-concepts](https://www.itprotoday.com/sql-server/understanding-time-series-forecasting-concepts) 
* Линейная регрессия по методу наименьших квадратов. Недостатки, проблемы и ошибки. Введение в регрессию и ее обсуждение см. по ссылке [https://www.clockbackward.com/2009/06/18/ordinary-least-squares-linear-regression-flaws-problems-and-pitfalls/ ](https://www.clockbackward.com/2009/06/18/ordinary-least-squares-linear-regression-flaws-problems-and-pitfalls/).

<!-- Module References -->
[bayesian-linear-regression]: https://msdn.microsoft.com/library/azure/ee12de50-2b34-4145-aec0-23e0485da308/
[boosted-decision-tree-regression]: https://msdn.microsoft.com/library/azure/0207d252-6c41-4c77-84c3-73bdf1ac5960/
[filter-based-feature-selection]: https://msdn.microsoft.com/library/azure/918b356b-045c-412b-aa12-94a1d2dad90f/
[linear-regression]: https://msdn.microsoft.com/library/azure/31960a6f-789b-4cf7-88d6-2e1152c0bd1a/
[select-columns]: https://msdn.microsoft.com/library/azure/1ec722fa-b623-4e26-a44e-a50c6d726223/
[split]: https://msdn.microsoft.com/library/azure/70530644-c97a-4ab6-85f7-88bf30a8be5f/

