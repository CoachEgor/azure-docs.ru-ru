---
title: Использование веб-службы в Excel
titleSuffix: ML Studio (classic) - Azure
description: Студия машинного обучения Azure (классическая) позволяет легко вызывать веб-сервисы непосредственно из Excel без необходимости написания какого-либо кода.
services: machine-learning
ms.service: machine-learning
ms.subservice: studio
ms.topic: conceptual
author: likebupt
ms.author: keli19
ms.custom: seodec18
ms.date: 02/01/2018
ms.openlocfilehash: 333ed411ab818cff77a7cba6c7de4f42c36f5b6b
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "79218212"
---
# <a name="consuming-an-azure-machine-learning-studio-classic-web-service-from-excel"></a>Потребление студии машинного обучения Azure (классическая) веб-служба от Excel

[!INCLUDE [Notebook deprecation notice](../../../includes/aml-studio-notebook-notice.md)]

Студия машинного обучения Azure (классическая) позволяет легко вызывать веб-сервисы непосредственно из Excel без необходимости написания какого-либо кода.

При использовании Excel 2013 (или более поздней версии) или Excel Online рекомендуется также использовать [надстройку Excel](excel-add-in-for-web-services.md).



## <a name="steps"></a>Шаги
Опубликуйте веб-службу. [Учебник 3: Развертывание модели кредитного риска](tutorial-part3-credit-risk-deploy.md) объясняет, как это сделать. В настоящее время функция книги Excel поддерживается только для служб обработки запросов и ответов с один выходом (то есть с одной меткой оценки). 

После создания веб-службы щелкните раздел **ВЕБ-СЛУЖБЫ** в левой части студии, а затем выберите веб-службу, которую нужно использовать в Excel.

**Классическая веб-служба**

1. На вкладке **Панель мониторинга** веб-службы есть строка для службы обработки **Запрос — ответ**. Если бы в этой службе был один выход, в строке отобразилась бы ссылка **Загрузить книгу Excel** .

    ![Скачать справочник Excel с помощью портала веб-сервиса Studio (классический)](./media/consuming-from-excel/excellink.png)
2. Щелкните **Download Excel Workbook**(Скачать книгу Excel).

**Новая веб-служба**

1. На портале веб-служб Машинного обучения Azure выберите **Consume**(Использование).
2. На странице "Consume" (Использование) в разделе **Web service consumption options** (Параметры использования веб-службы) щелкните значок Excel.

**Использование книги**

1. Откройте книгу.
2. Отобразится предупреждение системы безопасности. Нажмите кнопку **Разрешить изменение**.

    ![Включить редактирование для удаления предупреждения о безопасности защищенного представления](./media/consuming-from-excel/enableeditting.png)
3. Отобразится предупреждение системы безопасности. Нажмите кнопку **Включить содержимое** , чтобы запустить макросы в электронной таблице.

    ![Включить содержимое для отклонения макросов предупреждения безопасности](./media/consuming-from-excel/enablecontent.png)
4. После включения макросов будет создана таблица. Синие столбцы представляют собой входные данные, или **ПАРАМЕТРЫ**, для веб-службы RRS. Обратите внимание на выходные данные службы RRS ( **ПРОГНОЗИРУЕМЫЕ ЗНАЧЕНИЯ** ), отмеченные зеленым цветом. После заполнения всех столбцов для указанной строки книга автоматически вызывает API оценки и отображает результаты оценки.

    ![Таблица для входов параметров и полученных прогнозируемых значений](./media/consuming-from-excel/sampletable.png)
5. Чтобы оценить несколько строк, заполните вторую строку данными, и вы получите прогнозируемые значения. Можно даже вставить несколько строк одновременно.

Для лучшей визуализации данных к прогнозируемым значениям можно применять все функции Excel (графики, Power Map, условное форматирование и пр.).

## <a name="sharing-your-workbook"></a>Предоставление общего доступа к книге
Для выполнения макросов в электронную таблицу должен входить ключ API. Это означает, что общий доступ к книге нужно предоставлять только тем организациям и людям, которым вы доверяете.

## <a name="automatic-updates"></a>Автоматическое обновление
Служба RRS вызывается в двух следующих случаях:

1. когда впервые встречается строка, содержащая значения во всех столбцах **ПАРАМЕТРЫ**
2. в любое время при изменении значения в любом столбце **Параметры** в строке, содержащей значения во всех столбцах **Параметры**.