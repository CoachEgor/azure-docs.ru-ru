---
title: Использование веб-службы в Excel
titleSuffix: Azure Machine Learning Studio
description: Студия машинного обучения Azure упрощает вызов веб-службы оценки непосредственно из Excel, избавляя от необходимости написания какого-либо кода.
services: machine-learning
ms.service: machine-learning
ms.subservice: studio
ms.topic: conceptual
author: xiaoharper
ms.author: amlstudiodocs
ms.custom: seodec18
ms.date: 02/01/2018
ms.openlocfilehash: ef1d8f1a72c5936ff661636c4c51acf439a0a5ea
ms.sourcegitcommit: d4dfbc34a1f03488e1b7bc5e711a11b72c717ada
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/13/2019
ms.locfileid: "60773796"
---
# <a name="consuming-an-azure-machine-learning-studio-web-service-from-excel"></a>Использование веб-службы Студии машинного обучения Azure в Excel

 Студия машинного обучения Azure упрощает вызов веб-службы оценки непосредственно из Excel, избавляя от необходимости написания какого-либо кода.

При использовании Excel 2013 (или более поздней версии) или Excel Online рекомендуется также использовать [надстройку Excel](excel-add-in-for-web-services.md).



## <a name="steps"></a>Действия
Опубликуйте веб-службу. В статье [Руководство 3. Развертывание модели кредитных рисков в Студии машинного обучения Azure](tutorial-part3-credit-risk-deploy.md) объясняется, как это сделать. В настоящее время функция книги Excel поддерживается только для служб обработки запросов и ответов с один выходом (то есть с одной меткой оценки). 

После создания веб-службы щелкните раздел **ВЕБ-СЛУЖБЫ** в левой части студии, а затем выберите веб-службу, которую нужно использовать в Excel.

**Классическая веб-служба**

1. На вкладке **Панель мониторинга** веб-службы есть строка для службы обработки **Запрос — ответ**. Если бы в этой службе был один выход, в строке отобразилась бы ссылка **Загрузить книгу Excel** .

    ![Скачайте книгу Excel с помощью портала веб-служба студии](./media/consuming-from-excel/excellink.png)
2. Щелкните **Download Excel Workbook**(Скачать книгу Excel).

**Новая веб-служба**

1. На портале веб-служб Машинного обучения Azure выберите **Consume**(Использование).
2. На странице "Consume" (Использование) в разделе **Web service consumption options** (Параметры использования веб-службы) щелкните значок Excel.

**Использование книги**

1. Откройте книгу.
2. Отобразится предупреждение системы безопасности. Нажмите кнопку **Разрешить изменение**.

    ![Разрешить изменение устранить это предупреждение безопасности защищенный просмотр](./media/consuming-from-excel/enableeditting.png)
3. Отобразится предупреждение системы безопасности. Нажмите кнопку **Включить содержимое** , чтобы запустить макросы в электронной таблице.

    ![Включить содержимое закрыть предупреждение системы безопасности, отключение макросы](./media/consuming-from-excel/enablecontent.png)
4. После включения макросов будет создана таблица. Синие столбцы представляют собой входные данные, или **ПАРАМЕТРЫ**, для веб-службы RRS. Обратите внимание на выходные данные службы RRS ( **ПРОГНОЗИРУЕМЫЕ ЗНАЧЕНИЯ** ), отмеченные зеленым цветом. После заполнения всех столбцов для указанной строки книга автоматически вызывает API оценки и отображает результаты оценки.

    ![Таблица для входными данными параметров, в результате чего прогнозируемые значения](./media/consuming-from-excel/sampletable.png)
5. Чтобы оценить несколько строк, заполните вторую строку данными, и вы получите прогнозируемые значения. Можно даже вставить несколько строк одновременно.

Для лучшей визуализации данных к прогнозируемым значениям можно применять все функции Excel (графики, Power Map, условное форматирование и пр.).

## <a name="sharing-your-workbook"></a>Предоставление общего доступа к книге
Для выполнения макросов в электронную таблицу должен входить ключ API. Это означает, что общий доступ к книге нужно предоставлять только тем организациям и людям, которым вы доверяете.

## <a name="automatic-updates"></a>Автоматическое обновление
Служба RRS вызывается в двух следующих случаях:

1. когда впервые встречается строка, содержащая значения во всех столбцах **ПАРАМЕТРЫ**
2. в любое время при изменении значения в любом столбце **Параметры** в строке, содержащей значения во всех столбцах **Параметры**.