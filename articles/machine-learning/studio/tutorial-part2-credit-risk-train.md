---
title: Руководство 2. Обучение моделей кредитных рисков
titleSuffix: ML Studio (classic) - Azure
description: Подробный учебник по созданию решения прогнозной аналитики для оценки кредитных рисков в Студии машинного обучения Azure (классической). Это руководство представляет собой вторую часть серии, состоящей из трех частей. В нем объясняется, как обучать и оценивать модели.
keywords: кредитный риск, решение прогнозной аналитики, оценка рисков
author: sdgilley
ms.author: sgilley
services: machine-learning
ms.service: machine-learning
ms.subservice: studio
ms.topic: tutorial
ms.date: 02/11/2019
ms.openlocfilehash: 9aeaed6565e69409bc55a71985296b2393226ba4
ms.sourcegitcommit: f4f626d6e92174086c530ed9bf3ccbe058639081
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/25/2019
ms.locfileid: "75427488"
---
# <a name="tutorial-2-train-credit-risk-models---azure-machine-learning-studio-classic"></a>Руководство 2. Обучение моделей кредитных рисков в Студии машинного обучения Azure (классическая версия)

В этом руководстве подробно описывается процесс разработки решения прогнозной аналитики. Мы создадим в Студии машинного обучения (классической) простую модель,  а затем развернем ее в качестве веб-службы машинного обучения Azure.  Развернутая модель позволяет создавать прогнозы на основе новых данных. Это руководство представляет собой **вторую часть серии, состоящей из трех частей**.

Предположим, требуется спрогнозировать кредитный риск претендентов на кредит на основе сведений, которые они предоставляют в заявке на кредит.  

Оценка кредитных рисков — это сложная задача. Мы немного упростим ее для этого руководства. На примере этой задачи вы создадите решение прогнозной аналитики с помощью Студии машинного обучения Microsoft Azure (классической). Для этого вы используете Студию машинного обучения Azure (классическую) и веб-службу машинного обучения.  

В этом руководстве из трех частей описание начинается с общедоступных данных по кредитным рискам.  Затем необходимо разработать и обучить модель прогнозирования.  и, наконец, развернете модель в качестве веб-службы.

В [первой части учебника](tutorial-part1-credit-risk.md) вы создали рабочую область Студии машинного обучения (классической), отправили в нее данные и создали эксперимент.

Эта часть руководства состоит из таких этапов:
 
> [!div class="checklist"]
> * обучение нескольких моделей;
> * Оценка и анализ моделей


В [третьей части руководства](tutorial-part3-credit-risk-deploy.md) будет необходимо развернуть модель в качестве веб-службы.

## <a name="prerequisites"></a>предварительные требования

Выполните действия, описанные в [первой части этого руководства](tutorial-part1-credit-risk.md).

## <a name="train"></a>Обучение нескольких моделей

Одно из преимуществ использования Студии машинного обучения Azure (классической) для создания моделей машинного обучения заключается в том, что вы можете проверить несколько типов моделей и сравнить их результаты в рамках одного эксперимента. Этот тип экспериментов помогает найти наилучшее решение проблемы.

В эксперименте, разрабатываемом в этом руководстве, вы создадите два разных типа моделей и сравните результаты их оценки, чтобы решить, какой алгоритм использовать в финальном эксперименте.  

Существует множество моделей, которые можно выбрать. Чтобы просмотреть доступные модели, разверните узел **Машинное обучение** в палитре модулей, а затем **Initialize Model** (Инициализация модели) и узлы под ним. Для этого эксперимента необходимо выбрать модули [Two-Class Support Vector Machine][two-class-support-vector-machine] (Двухклассовый метод опорных векторов) и [Two-Class Boosted Decision Tree][two-class-boosted-decision-tree] (Двухклассовое расширяемое дерево принятия решений).

> [!TIP]
> Чтобы решить, какой алгоритм машинного обучения лучше всего подойдет для решения конкретной задачи, изучите статью [Выбор алгоритмов для Машинное обучение Azure Studio (классическая модель)](algorithm-choice.md).
> 
> 

В этот эксперимент мы добавим модули [Two-Class Boosted Decision Tree][two-class-boosted-decision-tree] (Двухклассовое расширяемое дерево принятия решений) и [Two-Class Support Vector Machine][two-class-support-vector-machine] (Двухклассовый метод опорных векторов).

### <a name="two-class-boosted-decision-tree"></a>Двухклассовое увеличивающееся дерево принятия решений;

Сначала настройте модель увеличивающегося дерева принятия решений.

1. Найдите модуль [Two-Class Boosted Decision Tree][two-class-boosted-decision-tree] (Двухклассовое расширяемое дерево принятия решений) на палитре модулей и перетащите его на холст.

1. Найдите модуль [Train Model][train-model] (Обучение модели), перетащите его на холст, а затем подключите вывод модуля [Two-Class Boosted Decision][two-class-boosted-decision-tree] Tree (Двухклассовое расширяемое дерево принятия решений) к левому порту ввода модуля [Train Model][train-model] (Обучение модели).
   
   Модуль [Two-Class Boosted Decision Tree][two-class-boosted-decision-tree] (Двухклассовое расширяемое дерево принятия решений) инициализирует универсальную модель, а модуль [Train Model][train-model] (Обучение модели) использует обучающие данные для обучения модели. 

1. Соедините левый выход левого модуля [Execute R Script][execute-r-script] (Выполнение сценария R) с правым портом ввода модуля [Train Model][train-model] (Обучение модели). Напомним, что в этом руководстве вы [использовали для обучения данные, поступающие от левой стороны](#train) модуля "Split Data" (Разделение данных).
   
   > [!TIP]
   > Для этого эксперимента вам не нужны два входа и один выход модуля [Execute R Script][execute-r-script] (Выполнение сценария R), поэтому их можно оставить неподключенными. 
   > 
   > 

Теперь эта часть эксперимента выглядит следующим образом.  

![Обучение модели](./media/tutorial-part2-credit-risk-train/experiment-with-train-model.png)

Теперь необходимо сообщить модулю [Train Model][train-model] (Обучение модели), что модель должна прогнозировать значения кредитного риска (поле "Credit Risk" (Кредитный риск)).

1. Выберите модуль [Train Model][train-model] (Обучение модели). В области **Properties** (Свойства) щелкните **Launch column selector** (Запустить средство выбора столбцов).

1. В диалоговом окне **Select a single column** (Выберите один столбец) введите в разделе **Available Columns** (Доступные столбцы) в поле поиска значение "Credit Risk", выберите внизу столбец Credit Risk (Кредитный риск) и нажмите кнопку со стрелкой вправо ( **>** ), чтобы переместить столбец "Credit Risk" (Кредитный риск) в раздел **Selected Columns** (Выбранные столбцы). 

    ![Выбор столбца "Credit Risk" (Кредитный риск) для модуля "Train Model" (Обучение модели)](./media/tutorial-part2-credit-risk-train/train-model-select-column.png)

1. Нажмите кнопку с флажком **ОК**.

### <a name="two-class-support-vector-machine"></a>Двухклассовая машина опорных векторов

Теперь настроим модель SVM.  

Сначала немного информации о SVM. "Повышенные" деревья принятия решения хорошо работают с атрибутами любого типа. Однако поскольку модуль SVM создает линейный классификатор, генерируемая им модель имеет наименьшую ошибку при проверке среди всех атрибутов одного масштаба. Чтобы свести все числовые признаки к одному масштабу, используйте преобразование Tanh (с помощью модуля [Normalize Data][normalize-data] (Нормализация данных)). Этот алгоритм преобразует все числа в значения, лежащие в интервале [0,1]. Модуль SVM преобразовывает строковые признаки в категориальные, а затем в двоичные признаки 0/1, поэтому вручную их преобразовывать не нужно. Кроме того, вам не нужно преобразовывать столбец кредитного риска (столбец 21) — он числовой, но мы обучаем модель прогнозировать именно его значение, поэтому его не нужно трогать.  

Чтобы настроить модель SVM, выполните следующие действия:

1. Найдите модуль [Two-Class Support Vector Machine][two-class-support-vector-machine] (Двухклассовый метод опорных векторов) на палитре модулей и перетащите его на холст.

1. Щелкните правой кнопкой мыши модуль [Train Model][train-model] (Обучение модели), выберите **Копировать**, а затем щелкните холст правой кнопкой мыши и выберите **Вставить**. Обратите внимание, что копия модуля [Train Model][train-model] (Обучение модели) имеет тот же набор выбранных столбцов, что и оригинал.

1. Соедините вывод модуля [Two-Class Support Vector Machine][two-class-support-vector-machine] (Двухклассовый метод опорных векторов) с левым портом ввода второго модуля [Train Model][train-model] (Обучение модели).

1. Найдите модуль [Normalize Data][normalize-data] (Нормализация данных) и перетащите его на холст.

1. Соедините ввод этого модуля с левым портом вывода левого модуля [Execute R Script][execute-r-script] (Выполнение сценария R). Обратите внимание, что порт вывода любого модуля может быть подключен к нескольким модулям.

1. Соедините левый порт вывода модуля [Normalize Data][normalize-data] (Нормализация данных) с правым портом ввода второго модуля [Train Model][train-model] (Обучение модели).

Теперь эта часть эксперимента должна выглядеть следующим образом.  

![Обучение второй модели](./media/tutorial-part2-credit-risk-train/svm-model-added.png)

Теперь настройте модуль [Normalize Data][normalize-data] (Нормализация данных).

1. Щелкните модуль [Normalize Data][normalize-data] (Нормализация данных), чтобы выбрать его. На панели **Properties** (Свойства) выберите для параметра **Transformation method** (Метод преобразования) значение **Tanh**.

1. Щелкните **Запустить средство выбора столбцов** (Launch column selector), укажите для параметра **Begin With** (Начало с) значение No columns (Без столбцов). В первом раскрывающемся списке выберите пункт **Включение**, во втором — **column type** (тип столбца), а в третьем — **Числовой**. Это указывает, что будут преобразованы все числовые столбцы (и только числовые).

1. Щелкните знак плюса (+) в правой части этой строки. Это позволит создать строку с раскрывающимися списками. Выберите в первом раскрывающемся списке значение **Exclude** (Исключить), во втором раскрывающемся списке выберите **column names** (Имена столбцов), затем введите текст "Credit risk" в текстовом поле. Так мы сообщим модулю, что столбец Credit Risk (Кредитный риск) нужно игнорировать. В противном случае этот столбец будет преобразован, так как является числовым.

1. Нажмите кнопку с флажком **ОК**.  

    ![Выбор столбцов для модуля "Normalize Data" (Нормализация данных)](./media/tutorial-part2-credit-risk-train/normalize-data-select-column.png)


Теперь модуль [Normalize Data][normalize-data] (Нормализация данных) настроен для выполнения преобразования "Tanh" для всех числовых столбцов, за исключением столбца "Credit Risk" (Кредитный риск).  

## <a name="score-and-evaluate-the-models"></a>Оценка и анализ моделей

Вы будете использовать для оценки обученных моделей данные тестирования, которые были отделены модулем [Split Data][split] (Разделение данных). Затем можно сравнить результаты двух моделей, чтобы определить, какая из них создает лучший результат.  

### <a name="add-the-score-model-modules"></a>Добавление модулей "Score Model" (Оценка модели)

1. Найдите модуль [Score Model][score-model] (Оценка модели) и перетащите его на холст.

1. Подключите модуль [Train Model][train-model] (Обучение модели), который подключен к модулю [Two-Class Boosted Decision Tree][two-class-boosted-decision-tree] (Двухклассовое расширяемое дерево принятия решений), к левому порту ввода нового модуля [Score Model][score-model] (Оценка модели).

1. Соедините правый модуль [Execute R Script][execute-r-script] (Выполнение сценария R), который возвращает данные для тестирования, с правым портом ввода модуля [Score Model][score-model] (Оценка модели).

    ![Модуль "Score Model" (Оценка модели) подключен](./media/tutorial-part2-credit-risk-train/score-model-connected.png)

   
   Теперь модуль [Score Model][score-model] (Оценка модели) может получить сведения о кредите из тестовых данных, обработать их с помощью модели и сравнить созданные моделью прогнозы с фактическими данными столбца кредитного риска из тестовых данных.

1. Скопируйте и вставьте модуль [Score Model][score-model] (Оценка модели), чтобы создать вторую копию.

1. Соедините вывод модели SVM (т. е. порт вывода модуля [Train Model][train-model] (Обучение модели), подключенного к модулю [Two-Class Support Vector Machine][two-class-support-vector-machine] (Двухклассовый метод опорных векторов)) с портом ввода второго модуля [Score Model][score-model] (Оценка модели).

1. Для модели SVM необходимо выполнить то же преобразование тестовых данных, что и для обучающих данных. Поэтому скопируйте и вставьте модуль [Normalize Data][normalize-data] (Нормализация данных), чтобы создать второй его экземпляр, и подключите его к выводу правого модуля [Execute R Script][execute-r-script] (Выполнение сценария R).

1. Соедините левый вывод второго модуля [Normalize Data][normalize-data] (Нормализация данных) с правым портом ввода второго модуля [Score Model][score-model] (Оценка модели).

    ![Оба модуля "Score Model" (Оценка модели) подключены](./media/tutorial-part2-credit-risk-train/both-score-models-added.png)


### <a name="add-the-evaluate-model-module"></a>Добавление модуля "Evaluate Model" (Анализ модели)

Чтобы проанализировать и сравнить два результата оценки, используйте модуль [Evaluate Model][evaluate-model] (Оценка модели).  

1. Найдите модуль [Evaluate Model][evaluate-model] (Оценка модели) и перетащите его на холст.

1. Подключите порт вывода модуля [Score Model][score-model] (Оценка модели), связанного с модулем расширяемого дерева принятия решений, к левому порту ввода модуля [Evaluate Model][evaluate-model] (Оценка модели).

1. Соедините второй модуль [Score Model][score-model] (Оценка модели) с левым портом ввода.  

    ![Модуль "Evaluate Model" (Анализ модели) подключен](./media/tutorial-part2-credit-risk-train/evaluate-model-added.png)


### <a name="run-the-experiment-and-check-the-results"></a>Запуск эксперимента и проверка результатов

Нажмите кнопку **ЗАПУСТИТЬ** внизу холста, чтобы запустить эксперимент. Это может занять несколько минут. В каждом модуле будет отображаться вращающийся индикатор, показывающий, что модуль выполняется. Когда модуль завершит работу, появится зеленый флажок. Если эта галочка появилась во всех модулях, значит эксперимент завершил выполнение.

Теперь наш эксперимент должен выглядеть следующим образом:  

![Сравнение обеих моделей](./media/tutorial-part2-credit-risk-train/final-experiment.png)


Чтобы проверить результаты, щелкните правой кнопкой мыши порт вывода модуля [Evaluate Model][evaluate-model] (Оценка модели) и выберите **Visualize** (Визуализировать).  

Модуль [Evaluate Model][evaluate-model] (Оценка модели) создает пару кривых и метрики, которые позволяют сравнить результаты двух оцениваемых моделей. Результаты можно видеть в виде кривых ROC (рабочих характеристик приемника), кривых точности/полноты или кривых точности прогноза. Дополнительные отображаемые данные включают матрицу несоответствий, накопительные значения для области под кривой (AUC) и другие метрики. Вы можете изменить пороговое значение, перемещая ползунок влево или вправо, чтобы посмотреть, как это влияет на набор метрик.  

В правой части графика щелкните **Scored dataset** (Оцененный набор данных) или **Scored dataset to compare** (Оцененный набор данных для сравнения), чтобы выделить соответствующую кривую и отобразить внизу соответствующие метрики. В условных обозначениях для кривых "Scored dataset" (Оцененный набор данных) соответствует левому порту ввода модуля [Evaluate Model][evaluate-model] (Оценка модели). В нашем случае это модель расширяемого дерева принятия решений. "Оцененный набор данных для сравнения" соответствует правому входному порту — в нашем случае это модель SVM. Щелкните одну из этих меток, чтобы выделить кривую и отобразить внизу метрики для соответствующей модели, как показано на рисунке ниже.  

![Кривые ROC для моделей](./media/tutorial-part2-credit-risk-train/roc-curves.png)

Изучив эти значения, можно определить, какая модель обеспечивает более точные результаты. Можно вернуться назад и повторить эксперимент, изменяя значения параметров в моделях. 

Наука и искусство интерпретации результатов и настройки производительности моделей выходят за рамки этого руководства. Для получения дополнительной информации ознакомьтесь со следующими статьями.
- [Как оценить эффективность модели в Студии машинного обучения Azure (классическая версия)](evaluate-model-performance.md)
- [Выбор параметров для оптимизации алгоритмов в Студии машинного обучения Azure (классическая версия)](algorithm-parameters-optimize.md)
- [Интерпретация результатов модели в Студии машинного обучения Azure (классическая версия)](interpret-model-results.md)

> [!TIP]
> При каждом выполнении эксперимента запись об этой итерации сохраняется в журнале выполнения. Эти итерации можно просмотреть и вернуться к любой из них, нажав кнопку **ПРОСМОТР ЖУРНАЛА ВЫПОЛНЕНИЯ** под холстом. Можно также щелкнуть **Prior Run** (Предыдущее выполнение) на панели **Свойства**, чтобы открыть результаты предыдущей попытки сравнения.
> 
> Можно сделать копию любой итерации эксперимента, нажав кнопку **SAVE AS** (Сохранить как) под холстом. 
> Чтобы отслеживать, какие данные вы сравнивали на каждом этапе выполнения эксперимента, используйте свойства эксперимента **Сводка** и **Описание**.
> 
> Дополнительные сведения см. в статье [Управление итерациями экспериментов в Студии машинного обучения Azure (классическая модель)](manage-experiment-iterations.md).  
> 
> 

## <a name="clean-up-resources"></a>Очистка ресурсов

[!INCLUDE [machine-learning-studio-clean-up](../../../includes/machine-learning-studio-clean-up.md)]

## <a name="next-steps"></a>Дальнейшие действия

В рамках этого руководства вы выполнили такие задачи: 
 
> [!div class="checklist"]
> * Создание эксперимента
> * обучение нескольких моделей;
> * Оценка и анализ моделей

Теперь вы готовы развернуть модели для этих данных.

> [!div class="nextstepaction"]
> [Руководство. Часть 3. Классификация цветков ириса: развертывание модели](tutorial-part3-credit-risk-deploy.md)


<!-- Module References -->
[execute-r-script]: https://msdn.microsoft.com/library/azure/30806023-392b-42e0-94d6-6b775a6e0fd5/
[edit-metadata]: https://msdn.microsoft.com/library/azure/370b6676-c11c-486f-bf73-35349f842a66/
[split]: https://msdn.microsoft.com/library/azure/70530644-c97a-4ab6-85f7-88bf30a8be5f/
[evaluate-model]: https://msdn.microsoft.com/library/azure/927d65ac-3b50-4694-9903-20f6c1672089/
[execute-r-script]: https://msdn.microsoft.com/library/azure/30806023-392b-42e0-94d6-6b775a6e0fd5/
[normalize-data]: https://msdn.microsoft.com/library/azure/986df333-6748-4b85-923d-871df70d6aaf/
[score-model]: https://msdn.microsoft.com/library/azure/401b4f92-e724-4d5a-be81-d5b0ff9bdb33/
[train-model]: https://msdn.microsoft.com/library/azure/5cc7053e-aa30-450d-96c0-dae4be720977/
[two-class-boosted-decision-tree]: https://msdn.microsoft.com/library/azure/e3c522f8-53d9-4829-8ea4-5c6a6b75330c/
[two-class-support-vector-machine]: https://msdn.microsoft.com/library/azure/12d8479b-74b4-4e67-b8de-d32867380e20/
[split]: https://msdn.microsoft.com/library/azure/70530644-c97a-4ab6-85f7-88bf30a8be5f/