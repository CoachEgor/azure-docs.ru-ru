---
title: Включение Машинное обучение Azure Studio в виртуальной сети
titleSuffix: Azure Machine Learning
description: Используйте Машинное обучение Azure Studio для доступа к данным, хранящимся в виртуальной сети.
services: machine-learning
ms.service: machine-learning
ms.subservice: core
ms.topic: how-to
ms.reviewer: larryfr
ms.author: aashishb
author: aashishb
ms.date: 10/21/2020
ms.custom: contperfq4, tracking-python
ms.openlocfilehash: a5206ed55dfe2632c7f6604c4f3d8e3199e23b99
ms.sourcegitcommit: 400f473e8aa6301539179d4b320ffbe7dfae42fe
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/28/2020
ms.locfileid: "92792027"
---
# <a name="use-azure-machine-learning-studio-in-an-azure-virtual-network"></a>Использование Машинное обучение Azure Studio в виртуальной сети Azure

Из этой статьи вы узнаете, как использовать Машинное обучение Azure Studio в виртуальной сети. Вы узнаете, как выполнять следующие задачи:

> [!div class="checklist"]
> - Доступ к студии из ресурса в виртуальной сети.
> - Настройте частные конечные точки для учетных записей хранения.
> - Предоставьте Studio доступ к данным, хранящимся в виртуальной сети.
> - Узнайте, как в Studio влияет безопасность хранилища.

Эта статья содержит пять статей, посвященных обеспечению безопасности Машинное обучение Azure рабочего процесса. Мы настоятельно рекомендуем прочесть первую [часть: обзор виртуальной сети](how-to-network-security-overview.md) , чтобы понять общую архитектуру. 

См. Другие статьи в этой серии:

[1. Обзор виртуальной сети](how-to-network-security-overview.md)  >  [2. Обеспечьте безопасность рабочей области](how-to-secure-workspace-vnet.md)  >  [3. Обеспечьте безопасность среды обучения](how-to-secure-training-vnet.md)  >  [4. Обеспечьте безопасность окружения](how-to-secure-inferencing-vnet.md)  >  **5. Включить функциональные возможности студии**


> [!IMPORTANT]
> Если Рабочая область находится в __независимых облаке__ (например, Azure для государственных организаций или Azure для Китая), интегрированные записные книжки _не_ поддерживают использование хранилища в виртуальной сети. Вместо этого можно использовать записные книжки Jupyter из вычислительного экземпляра. Дополнительные сведения см. в разделе [доступ к данным в записной книжке для вычислительных экземпляров](how-to-secure-training-vnet.md#access-data-in-a-compute-instance-notebook) .


## <a name="prerequisites"></a>Предварительные требования

+ Ознакомьтесь с [обзором сетевой безопасности](how-to-network-security-overview.md) , чтобы ознакомиться с общими сценариями виртуальной сети и общей архитектурой виртуальной сети.

+ Уже имеющаяся виртуальная сеть и подсеть для использования.

+ Существующая [машинное обучение Azure Рабочая область с включенной закрытой ссылкой](how-to-secure-workspace-vnet.md#secure-the-workspace-with-private-endpoint).

+ Существующая [учетная запись хранения Azure добавила свою виртуальную сеть](how-to-secure-workspace-vnet.md#secure-azure-storage-accounts-with-service-endpoints).

## <a name="access-the-studio-from-a-resource-inside-the-vnet"></a>Доступ к студии из ресурса в виртуальной сети

При доступе к студии из ресурса внутри виртуальной сети (например, вычислительного экземпляра или виртуальной машины) необходимо разрешить исходящий трафик из виртуальной сети в студии. 

Например, если вы используете группы безопасности сети (NSG) для ограничения исходящего трафика, добавьте правило в назначение __тега службы__ для __азурефронтдур. интерфейс__ .

## <a name="access-data-using-the-studio"></a>Доступ к данным с помощью студии

После добавления учетной записи хранения Azure в виртуальную сеть с [конечной точкой службы](how-to-secure-workspace-vnet.md#secure-azure-storage-accounts-with-service-endpoints) или [частной конечной точкой](how-to-secure-workspace-vnet.md#secure-azure-storage-accounts-with-private-endpoints)необходимо настроить учетную запись хранения для использования [управляемого удостоверения](../active-directory/managed-identities-azure-resources/overview.md) , чтобы предоставить Studio доступ к данным.

Если не включить управляемое удостоверение, появится сообщение об ошибке, `Error: Unable to profile this dataset. This might be because your data is stored behind a virtual network or your data does not support profile.` Кроме того, будут отключены следующие операции:

* Предварительный просмотр данных в студии.
* Визуализируйте данные в конструкторе.
* Отправьте Аутомл эксперимент.
* Запустите проект меток.

В виртуальной сети Studio поддерживает чтение данных из следующих типов:

* Большой двоичный объект Azure
* Хранилище Azure Data Lake Storage 1-го поколения
* Azure Data Lake Storage 2-го поколения
* База данных SQL Azure

### <a name="grant-workspace-managed-identity-__reader__-access-to-storage-private-link"></a>Предоставить защищенной ссылке на хранилище управляемый __идентификатор рабочей области доступ к__ частному каналу хранилища

Этот шаг необходим только в том случае, если вы добавили учетную запись хранения Azure в виртуальную сеть с [закрытой конечной точкой](how-to-secure-workspace-vnet.md#secure-azure-storage-accounts-with-private-endpoints). Дополнительные сведения см. в разделе Встроенная роль [читателя](../role-based-access-control/built-in-roles.md#reader) .

### <a name="configure-datastores-to-use-workspace-managed-identity"></a>Настройка хранилищ данных для использования управляемого удостоверения рабочей области

Машинное обучение Azure использует [хранилища](concept-data.md#datastores) данных для подключения к учетным записям хранения. Чтобы настроить хранилища данных для использования управляемого удостоверения, выполните следующие действия. 

1. В студии выберите __хранилища данных__ .

1. Чтобы создать новое хранилище данных, выберите __+ создать хранилище данных__ .

    Чтобы обновить существующее хранилище данных, выберите хранилище данных и щелкните __обновить учетные данные__ .

1. В параметрах хранилища данных выберите __Да__ ,  __чтобы разрешить машинное обучение Azure службе доступ к хранилищу с помощью удостоверения, управляемого рабочей областью__ .


Эти действия позволяют добавить управляемое рабочей областью удостоверение как __читателя__ в службу хранилища с помощью управления доступом на основе ресурсов Azure (Azure RBAC). Доступ для __чтения__ позволяет рабочей области получить параметры брандмауэра и убедиться, что данные не покидают виртуальную сеть.

> [!NOTE]
> Для вступления этих изменений в силу может потребоваться до 10 минут.

## <a name="technical-notes-for-managed-identity"></a>Технические примечания по управляемому удостоверению

Использование управляемого удостоверения для доступа к службам хранилища влияет на некоторые аспекты безопасности. Эти соображения уникальны для типа учетной записи хранения, к которой осуществляется доступ. В этом разделе описаны изменения для каждого типа учетной записи хранения.

### <a name="azure-blob-storage"></a>Хранилище BLOB-объектов Azure

Для __хранилища BLOB-объектов Azure__ удостоверение, управляемое рабочей областью, также добавляется как [модуль чтения данных большого двоичного объекта](../role-based-access-control/built-in-roles.md#storage-blob-data-reader) , чтобы он мог считывать данные из хранилища больших двоичных объектов.

### <a name="azure-data-lake-storage-gen2-access-control"></a>Azure Data Lake Storage 2-го поколения контроля доступа

Для управления доступом к данным в виртуальной сети можно использовать как Azure RBAC, так и списки управления доступом (ACL) в стиле POSIX.

Чтобы использовать Azure RBAC, добавьте удостоверение, управляемое рабочей областью, в роль [модуля чтения BLOB-объектов](../role-based-access-control/built-in-roles.md#storage-blob-data-reader) . Дополнительные сведения см. в статье [Управление доступом на основе ролей в Azure](../storage/blobs/data-lake-storage-access-control-model.md#role-based-access-control).

Чтобы использовать списки управления доступом, идентификатору, управляемому рабочей областью, можно назначить доступ, как и любой другой принцип безопасности. Дополнительные сведения см. [в разделе списки управления доступом для файлов и каталогов](../storage/blobs/data-lake-storage-access-control.md#access-control-lists-on-files-and-directories).

### <a name="azure-data-lake-storage-gen1-access-control"></a>Azure Data Lake Storage 1-го поколения контроля доступа

Azure Data Lake Storage 1-го поколения поддерживает только списки управления доступом в стиле POSIX. Можно назначить доступ удостоверений, управляемых рабочей областью, к ресурсам, как и любой другой принцип безопасности. Дополнительные сведения см. [в разделе Контроль доступа в Azure Data Lake Storage 1-го поколения](../data-lake-store/data-lake-store-access-control.md).

### <a name="azure-sql-database-contained-user"></a>Автономный пользователь базы данных SQL Azure

Чтобы получить доступ к данным, хранящимся в базе данных SQL Azure с помощью управляемого удостоверения, необходимо создать автономного пользователя SQL, сопоставляемого с управляемым удостоверением. Дополнительные сведения о создании пользователя из внешнего поставщика см. в статье [Создание автономных пользователей, сопоставленных с удостоверениями Azure AD](../azure-sql/database/authentication-aad-configure.md#create-contained-users-mapped-to-azure-ad-identities).

После создания автономного пользователя SQL предоставьте ему разрешения с помощью [команды T-SQL GRANT](https://docs.microsoft.com/sql/t-sql/statements/grant-object-permissions-transact-sql).

### <a name="azure-machine-learning-designer-default-datastore"></a>Хранилище данных конструктора Машинное обучение Azure по умолчанию

Конструктор использует учетную запись хранения, подключенную к рабочей области, для хранения выходных данных по умолчанию. Однако можно указать, что он будет хранить выходные данные в любом хранилище данных, к которому у вас есть доступ. Если в вашей среде используются виртуальные сети, эти элементы управления можно использовать для обеспечения безопасности и доступности данных.

Чтобы задать новое хранилище по умолчанию для конвейера, выполните следующие действия.

1. В черновике конвейера щелкните **значок шестеренки параметров** рядом с заголовком конвейера.
1. Выберите **хранилище данных выбор по умолчанию** .
1. Укажите новое хранилище данных.

Можно также переопределить хранилище данных по умолчанию для каждого модуля. Это позволяет управлять местом хранения для каждого отдельного модуля.

1. Выберите модуль, выходные данные которого необходимо указать.
1. Разверните раздел **Параметры вывода** .
1. Выберите **параметр переопределить параметры вывода по умолчанию** .
1. Выберите **задать параметры вывода** .
1. Укажите новое хранилище данных.

## <a name="next-steps"></a>Дальнейшие действия

Эта статья является необязательной частью серии виртуальных сетей из четырех частей. Ознакомьтесь с остальными статьями, чтобы узнать, как защитить виртуальную сеть.

* [Часть 1. Обзор виртуальной сети](how-to-network-security-overview.md)
* [Часть 2. Защита ресурсов рабочей области](how-to-secure-workspace-vnet.md)
* [Часть 3. Защита среды обучения](how-to-secure-training-vnet.md)
* [Часть 4. Защита окружения](how-to-secure-inferencing-vnet.md)
