---
title: 'Выполнить Python Сценарий: Модуль Ссылка'
titleSuffix: Azure Machine Learning
description: Узнайте, как использовать модуль «Execute Python Script» в Azure Machine Learning для запуска кода Python.
services: machine-learning
ms.service: machine-learning
ms.subservice: core
ms.topic: reference
author: likebupt
ms.author: keli19
ms.date: 03/10/2020
ms.openlocfilehash: 79dc1b188e91028a98f43dc24972228f2d2101be
ms.sourcegitcommit: acb82fc770128234f2e9222939826e3ade3a2a28
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/21/2020
ms.locfileid: "81684731"
---
# <a name="execute-python-script-module"></a>Выполнить модуль Python Script

В этой статье описывается модуль в дизайнере машинного обучения Azure (предварительный просмотр).

Используйте этот модуль для запуска кода Python. Для получения дополнительной информации об архитектуре и принципах проектирования Python [см.](https://docs.microsoft.com/azure/machine-learning/machine-learning-execute-python-scripts)

С Python можно выполнять задачи, которые в настоящее время не поддерживаются существующими модулями, такими как:

+ Визуализация данных с использованием`matplotlib`
+ Использование библиотек Python для перечисления наборов данных и моделей в рабочем пространстве
+ Чтение, загрузка и манипулирование данными из источников, не поддерживаемых модулем [данных импорта](./import-data.md)
+ Запустите свой собственный код глубокого обучения 


Azure Machine Learning использует распределение Python Anaconda, которое включает в себя множество общих утилит для обработки данных. Мы будем обновлять версию Anaconda автоматически. Текущая версия:
 -  Анаконда 4,5 "дистрибутив для Python 3.6 

Предварительно установленные пакеты:
-    аддалев1.2.2
-    приложениеinsights - 0.11.9
-    аттрс 19.3.0
-    лазурно-общий » 1.1.25
-    лазурное ядро 1.3.0
-    лазурно-графрбака з 0.61.1
-    лазурно-идентификационная зона 1.3.0
-    лазурно-мgmt-авторизация - 0.60,0
-    лазурно-мgmt-контейнерация 2.8.0
-    лазурно-мgmt-ключ-кевет -2.2.0
-    лазурно-мgmt-ресурс - 8,0,1
-    лазурно-мgmt-хранилище - 8,0,0
-    лазурно-хранение-blob ' 1.5.0
-    лазурно-хранение-общие » 1,4,2
-    лазурный ядер - 1,1,5,5
-    лазурь-датапреп-родной 14.1.0
-    лазурь-датапреп 1.3.5
-    лазурит-по умолчанию 1.1.5.1
-    лазурь-дизайнер-классик-модули - 0,0.118
-    лазурьно-дизайнер-ядро - 0,0,31
-    лазурь-дизайнер-внутренний й 0.0.18
-    лазурь-модель-управление-sdk-1.0.1b6.post1
-    лазурный трубопровод-ядро 1.1.5
-    лазурмл-телеметрия 1.1.5.3
-    backports.tempfile -1.0
-    backports.weakref '1.0.post1
-    бото3 '1.12.29
-    ботокора 1.15.29
-    Кэш-инструменты 4.0.0
-    сертификатno 2019.11.28
-    cffi 1.12.3
-    шардет3.0.4
-    щелкните »7.1.1
-    cloudpickle 1.3.0
-    конфипарсера 3.7.4
-    contextlib2 '0.6.0.post1
-    криптография No2.8
-    велорегистратора 0.10.0
-    укроп 0.3.1.1.1
-    дистро1.4,0
-    докер -4.2.0
-    docutils -0.15.2
-    dotnetcore2''2.1.13
-    колба 1.0.3
-    предохранитель 3.0.1
-    gensim 3.8.1
-    google-апи-ядро 1.16.0
-    google-аутз 1.12.0
-    Google-облако-ядро 1.3.0
-    Google-облако-хранилище 1.26.0
-    Google-воспламеняемый-медиа » 0.5.0
-    googleapis-общий-протос1.51.0
-    гуникорн 19.9.0
-    idna'2.9
-    несбалансированное обучение - 0,4,3
-    изодате 0.6.0
-    егоопасный »1.1.0
-    jeepney -0.4.3
-    jinja2'2.11.1
-    jmespath -0.9.5
-    joblib - 0.14.0
-    json-logging-py-0.2
-    jsonpickle 1.3
-    jsonschema -3.0.1
-    кивисолюлюлер 1.1.0
-    liac-arff '2.4.0
-    лайтгбмз 2.2.3
-    разметка 1.1.1.1
-    матплотиб 3.1.3
-    больше-itertools - 6,0,0
-    мсал-расширения - 0,1,3
-    мсале 1.1.0
-    мреста 0.6.11
-    srestazure -0.6.3
-    ndg-httpsclient - 0,5,1
-    nimbusml 1.6.1
-    numpy 1.18.2
-    оутлибе 3.1.0
-    панды 0,25,3
-    pathspec -0.7.0
-    пипса 20.0.2
-    portalocker -1.6.0
-    протобуф 3.11.3
-    pyarrow -0.16.0
-    pyasn1-модули - 0,2,8
-    pyasn1'0.4.8
-    pycparser -2.20
-    pycryptodomex 3.7.3
-    pyjwt 1.7.1
-    pyopenssl -19.1.0
-    pyparsing 2.4.6
-    pyrsistent -0.16.0
-    питон-датаутила 2.8.1
-    pytz-2019.3
-    запросы-oauthlib -1.3.0
-    запросы 2.23.0
-    рсач 4.0
-    ruamel.yaml -0.15.89
-    s3transfer '0.3.3
-    scikit-узнать » 0.22.2
-    scipy 1.4.1
-    тайное хранение 3.1.2
-    setuptools -46.1.1.post20200323
-    6 й1.14.0
-    смарт-открытой »1.10.0
-    urllib3'1.25.8
-    websocket-клиент - 0.57,0
-    werkzeug -0.16.1
-    колесо 0.34.2

 Чтобы установить другие пакеты, не вустановленные список, например *scikit-misc,* добавьте следующий код в свой скрипт: 

 ```python
import os
os.system(f"pip install scikit-misc")
```

## <a name="upload-files"></a>Отправка файлов
**Сценарий выполнения Python** поддерживает загрузку файлов с помощью [Azure Machine Learning Python SDK.](https://docs.microsoft.com/python/api/azureml-core/azureml.core.run%28class%29?view=azure-ml-py#upload-file-name--path-or-stream-)

Ниже приводится следующий пример, как загрузить файл изображения в модуль **Execute Python Script:**

```Python

# The script MUST contain a function named azureml_main
# which is the entry point for this module.

# imports up here can be used to
import pandas as pd

# The entry point function must have two input arguments:
#   Param<dataframe1>: a pandas.DataFrame
#   Param<dataframe2>: a pandas.DataFrame
def azureml_main(dataframe1 = None, dataframe2 = None):

    # Execution logic goes here
    print(f'Input pandas.DataFrame #1: {dataframe1}')

    from matplotlib import pyplot as plt
    plt.plot([1, 2, 3, 4])
    plt.ylabel('some numbers')
    img_file = "line.png"
    plt.savefig(img_file)

    from azureml.core import Run
    run = Run.get_context(allow_offline=True)
    run.upload_file(f"graphics/{img_file}", img_file)

    # Return value must be of a sequence of pandas.DataFrame
    # E.g.
    #   -  Single return value: return dataframe1,
    #   -  Two return values: return dataframe1, dataframe2
    return dataframe1,
}
```

После завершения выполнения конвейера можно просмотреть изображение в правой панели модуля

> [!div class="mx-imgBorder"]
> ![Загружено-изображение](media/module/upload-image-in-python-script.png)

## <a name="how-to-configure-execute-python-script"></a>Как настроить сценарий выполнения Python

Модуль **Execute Python Script** содержит образец кода Python, который можно использовать в качестве отправной точки. Для настройки модуля **«Execute Python Script»** в текстовом поле **скрипта Python** предоставляется набор входных данных и код Python.

1. Добавьте модуль **«Выполняйся python Script»** в конвейер.

2. Добавляйте и подключайте в **Dataset1** любые наборы данных от дизайнера, которые вы хотите использовать для ввода данных. Ссылка на этот набор данных в скрипте Python как **DataFrame1.**

    Использование набора данных является необязательным, если вы хотите генерировать данные с помощью Python, или использовать код Python для импорта данных непосредственно в модуль.

    Этот модуль поддерживает добавление второго набора данных на **Dataset2.** Ссылка на второй набор данных в скрипте Python как DataFrame2.

    Наборы данных, хранящиеся в Azure Machine Learning, автоматически преобразуются в **данные pandas.frames** при загрузке с помощью этого модуля.

    ![Выполнить карту ввода Python](media/module/python-module.png)

4. Чтобы включить новые пакеты или код Python, добавьте файл с молнией, содержащий эти пользовательские ресурсы, в **пакете Script.** Ввод **в пакет Скрипта** должен быть застегнутным на молнию файлом, загруженным в рабочее пространство в виде набора данных типа файла. Вы можете загрузить набор данных на страницу активов **наборов данных,** а также перетащить и выбросить модуль набора данных из списка **наборов данных** в левом дереве модуля на странице авторства конструктора. 

    Любой файл, содержащийся в загруженном архиве на молнии, может быть использован во время выполнения конвейера. Если архив включает в себя структуру каталога, структура сохраняется, но необходимо приготовить каталог, называемый **src** к пути.

5. В текстовом окне **скрипта Python** введите или вставьте действительный скрипт Python.

    > [!NOTE]
    > Пожалуйста, будьте очень осторожны при написании скрипта и убедитесь, что нет ошибки синтаксиса, например, с помощью необъявленного объекта или неимпортированного модуля. Также обратите особое внимание на список предустановленных модулей. Чтобы импортировать модули, которые не перечислены, установите соответствующие пакеты в скрипте, такие как
    >  ``` Python
    > import os
    > os.system(f"pip install scikit-misc")
    > ```
    
    Текстовое окно **скрипта Python** предварительно заполнено некоторыми инструкциями в комментариях и примером кода для доступа к данным и вывода. Вы должны отодвить или заменить этот код. Обязательно следуйте конвенциям Python о отступах и корпусе.

    + Скрипт должен содержать `azureml_main` функцию, названную в качестве точки входа для этого модуля.
    + Функция точки входа должна иметь два `Param<dataframe1>` аргумента входа: и `Param<dataframe2>`, даже если эти аргументы не используются в вашем скрипте.
    + Файлов, подключенных к третьему порту ввода, распаковываются и хранятся в каталоге, `.\Script Bundle`который также добавляется в Python. `sys.path` 

    Поэтому, если ваш `mymodule.py`почтовый файл `import mymodule`содержит, импортировать его с помощью.

    + Два набора данных могут быть возвращены конструктору, `pandas.DataFrame`что должно быть последовательностью типа. Можно создать другие выходы в коде Python и записать их непосредственно в хранилище Azure.

6. Отправить конвейер или выбрать модуль и нажмите **Кнопка Run, выбранного** для запуска только скрипта Python.

    Все данные и код загружаются в виртуальную машину и запускаются с использованием указанной среды Python.

## <a name="results"></a>Результаты

Результаты любых вычислений, выполняемых встроенным кодом Python, должны предоставляться в виде панд. DataFrame, который автоматически преобразуется в формат набора данных Azure Machine Learning, чтобы можно было использовать результаты с другими модулями в конвейере.

Модуль возвращает два набора данных:  
  
+ **Набор данных результатов 1**, определяемый первыми возвращенными пандами в скрипте Python

+ **Набор данных результат 2**, определяемый вторым возвращенным пандами в скрипте Python


## <a name="next-steps"></a>Следующие шаги

Ознакомьтесь с [набором модулей, доступных](module-reference.md) для машинного обучения Azure. 