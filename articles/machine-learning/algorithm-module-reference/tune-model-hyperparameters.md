---
title: Настройка гиперпараметров модели
titleSuffix: Azure Machine Learning
description: Узнайте, как использовать модуль настройки параметров модели в Машинное обучение Azure для выполнения очистки параметров в модели для определения оптимальных параметров параметров.
services: machine-learning
ms.service: machine-learning
ms.subservice: core
ms.topic: reference
author: likebupt
ms.author: keli19
ms.date: 10/16/2019
ms.openlocfilehash: 3db20110571203588ac15f4f64a2ae0a6ab6ef27
ms.sourcegitcommit: f4f626d6e92174086c530ed9bf3ccbe058639081
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/25/2019
ms.locfileid: "75428412"
---
# <a name="tune-model-hyperparameters"></a>Настройка гиперпараметров модели

В этой статье описывается, как использовать модуль настройки модели "Параметры" в конструкторе Машинное обучение Azure (Предварительная версия). Цель состоит в том, чтобы определить оптимальные параметры для модели машинного обучения. Модуль создает и тестирует несколько моделей, используя различные сочетания параметров. Он сравнивает метрики по всем моделям, чтобы получить сочетания параметров. 

*Параметры* термов и *параметров* могут быть запутанными. *Параметры* модели задаются на панели «Свойства». По сути, этот модуль выполняет настройку *параметров* для параметров указанного параметра. Он изучает оптимальный набор _параметров_, которые могут различаться для каждого конкретного дерева принятия решений, набора данных или метода регрессии. Процесс поиска оптимальной конфигурации иногда называется *настройкой*. 

Модуль поддерживает следующий метод для поиска оптимальных параметров модели: *встроенные обучение и настройка.* В этом методе вы настраиваете набор параметров для использования. Затем вы разрешите модулю выполнять итерацию по нескольким сочетаниям. Модуль измеряет точность до тех пор, пока не найдет "наилучшую" модель. При работе с большинством модулей для обучения можно выбрать параметры, которые следует изменить в ходе обучающего процесса, которые должны оставаться исправленными.

В зависимости от того, как долго должен выполняться процесс настройки, может быть решено полностью протестировать все сочетания. Можно также сократить процесс, установив сетку комбинаций параметров и проверив случайное подмножество сетки параметров.

Этот метод создает обученную модель, которую можно сохранить для повторного использования.  

> [!TIP] 
> Можно выполнить связанную задачу. Прежде чем начать настройку, примените выбор компонентов, чтобы определить столбцы или переменные с наибольшим значением сведений.

## <a name="how-to-configure-tune-model-hyperparameters"></a>Настройка параметров настройки модели  

Изучение оптимальных параметров для модели машинного обучения требует значительного использования конвейеров.

### <a name="train-a-model-by-using-a-parameter-sweep"></a>Обучение модели с помощью очистки параметров  

В этом разделе описывается выполнение базовой очистки параметров, которая обучает модель с помощью модуля настройки модели.

1.  Добавьте модуль Настройка параметров модели в конвейер в конструктор.

2.  Соедините обученную модель с крайним левым входом. 

3. Задайте для параметра **режим создания инструктора** значение **диапазон параметров**. Используйте **Построитель диапазонов** , чтобы указать диапазон значений для использования в параметре очистки параметров.  

    Почти все модули классификации и регрессии поддерживают встроенную вычистку параметров. Для тех, кто не поддерживает настройку диапазона параметров, можно проверить только доступные значения параметров.

    Можно вручную задать значение для одного или нескольких параметров, а затем вычистить остальные параметры. Это может сэкономить некоторое время.

4.  Добавьте набор данных, который необходимо использовать для обучения, и соедините его с средним входом параметров настройки модели.  

    При необходимости, если имеется набор данных с тегами, его можно подключить к крайнему правому порту ввода (**необязательный проверочный набор данных**). Это позволяет измерять точность во время обучения и настройки.

5.  На панели **Свойства** окна Настройка параметров модели выберите значение для **параметра режим очистки параметров**. Этот параметр определяет способ выбора параметров.

    - **Вся сетка**: при выборе этого параметра модуль выполняет циклическую выборку по сетке, предопределенную системой, чтобы попробовать различные сочетания и определить лучший. Этот параметр полезен, если неизвестно, какие параметры лучше всего подходят, и хотите попробовать все возможные сочетания значений.

    - **Случайная очистка**. при выборе этого параметра модуль будет случайным образом выбирать значения параметров через определенный системой диапазон. Необходимо указать максимальное число запусков, которое должен выполнить модуль. Этот параметр полезен, если необходимо повысить производительность модели, используя выбранные метрики, но по-прежнему сэкономить вычислительные ресурсы.    

6.  В **столбце Метка**откройте Селектор столбцов, чтобы выбрать один столбец меток.

7.  Выберите число запусков:

    1. **Максимальное число запусков при случайном повороте**: при выборе случайного значения можно указать, сколько раз должна быть обработана модель, с помощью случайного сочетания значений параметров.

    2. **Максимальное число запусков в случайной сетке**: этот параметр также управляет количеством итераций при случайной выборки значений параметров, но значения не создаются случайным образом из указанного диапазона. Вместо этого модуль создает матрицу всех возможных сочетаний значений параметров. Затем он принимает случайную выборку по матрице. Этот метод более эффективен и менее подвержен использованию региональной избыточной выборки или недовыборки.

8.  Для **ранжирования**выберите одну метрику, которая будет использоваться для ранжирования моделей.

    При выполнении очистки параметра модуль вычисляет все применимые метрики для типа модели и возвращает их в отчете **результаты очистки** . Модуль использует отдельные метрики для моделей регрессии и классификации.

    Однако выбранная метрика определяет, как будут ранжированы модели. Только верхняя модель, упорядоченная по выбранной метрике, выводится в качестве обученной модели для использования в качестве оценки.

9.  Для параметра **случайное начальное значение**введите число, которое будет использоваться для запуска очистки параметров. 

10. Запустили конвейер.

## <a name="results-of-hyperparameter-tuning"></a>Результаты настройки параметров

По завершении обучения:

+ Чтобы просмотреть набор метрик точности для лучшей модели, щелкните правой кнопкой мыши модуль, выберите **результаты очистки**, а затем щелкните **визуализировать**.

    Выходные данные включают все метрики точности, применяемые к типу модели, но метрика, выбранная для ранжирования, определяет, какая модель считается наилучшей.

+ Чтобы использовать модель для оценки в других конвейерах без повторения процесса настройки, щелкните правой кнопкой мыши выходные данные модели и выберите команду **Сохранить как обученную модель**. 


## <a name="technical-notes"></a>Технические примечания

В этом разделе содержатся сведения о реализации и советы.

### <a name="how-a-parameter-sweep-works"></a>Как работает очистка параметров

При настройке очистки параметров необходимо определить область поиска. Поиск может использовать конечное число параметров, выбранных случайным образом. Или это может быть исчерпывающим поиском по определенному пространству параметров.

+ **Случайная очистка**. Этот параметр обучает модель с помощью заданного количества итераций. 

  Вы указываете диапазон значений для итерации, и модуль использует случайное выбранное подмножество этих значений. Значения выбираются с заменой, что означает, что числа, ранее выбранные случайным образом, не удаляются из пула доступных номеров. Так что вероятность выбора любого значения остается одинаковой во всех проходах.  

+ **Вся сетка**: параметр для использования всей сетки означает, что каждое сочетание проверяется. Этот параметр является наиболее подробным, но он требует больше времени. 

### <a name="controlling-the-length-and-complexity-of-training"></a>Контроль длины и сложности обучения

Перебор множества сочетаний параметров может занимать много времени, поэтому модуль предоставляет несколько способов ограничения процесса:

+ Ограничьте количество итераций, используемых для тестирования модели.
+ Ограничьте пространство параметров.
+ Ограничьте количество итераций и пространство параметров.

Рекомендуется использовать конвейер с параметрами, чтобы определить наиболее эффективный метод обучения по определенному набору данных и модели.

### <a name="choosing-an-evaluation-metric"></a>Выбор показателя оценки

По завершении тестирования модель представляет отчет, который содержит точность для каждой модели, чтобы можно было просматривать результаты метрик:

- Для всех моделей двоичной классификации используется однородный набор метрик.
- Точность используется для всех моделей многоклассовой классификации.
- Для моделей регрессии используется другой набор метрик. 

Однако во время обучения необходимо выбрать *одну* метрику для использования в ранжировании моделей, созданных в процессе настройки. В зависимости от бизнес-задачи и стоимости ложных срабатываний и ложных отрицательных результатов может оказаться, что оптимальная метрика отличается.

#### <a name="metrics-used-for-binary-classification"></a>Метрики, используемые для двоичной классификации

-   **Точность** — это отношение истинных результатов к общему количеству вариантов.  

-   **Точность** — это отношение истинных результатов к положительным результатам.  

-   **Отзыв** — это часть всех правильных результатов по всем результатам.  

-   **F-Score** — это мера, которая распределяет точность и отзыв.  

-   **AUC** — это значение, представляющее область под кривой, когда ложные срабатывания на оси x и истинные положительные результаты отображаются на оси y.  

-   **Средняя степень потери журнала** — это разница между двумя распределениями вероятностей: значением true и значением в модели.  

#### <a name="metrics-used-for-regression"></a>Метрики, используемые для регрессии

-   Среднее значение " **абсолютная ошибка** " усредняет все ошибки в модели, где *Ошибка* означает расстояние прогнозируемого значения от истинного значения. Это часто сокращается как *Mae*.  

-   **Корень средней квадратной ошибки** измеряет среднее значение квадратов ошибок, а затем принимает корень этого значения. Это часто сокращается как *Корень среднеквадратичной погрешности*.  

-   **Относительная абсолютная ошибка** представляет ошибку в процентах от истинного значения.  

-   **Относительное квадратичное сообщение об** ошибке нормализует общую квадратную ошибку путем деления на общую квадратную ошибку прогнозируемых значений.  

-   **Коэффициент определения** — это одно число, указывающее, насколько хорошо данные помещаются в модель. Значение 1 означает, что модель точно соответствует данным. Нулевое значение означает, что данные являются случайными или иным образом не могут соответствовать модели. Часто это называется *r<sup>2</sup>* , *r<sup>2</sup>* или *r-Square*.  

### <a name="modules-that-dont-support-a-parameter-sweep"></a>Модули, не поддерживающие очистка параметров

Почти все средства обучения в Машинное обучение Azure поддерживают перекрестную проверку с помощью встроенной очистки параметров, которая позволяет выбирать параметры конвейера. Если разработчик не поддерживает задание диапазона значений, вы по-прежнему можете использовать его при перекрестной проверке. В этом случае для очистки выбирается диапазон допустимых значений. 


## <a name="next-steps"></a>Дальнейшие действия

См. [набор модулей, доступных](module-reference.md) для машинное обучение Azure. 

