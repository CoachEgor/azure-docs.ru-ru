---
title: 'Перекрестная проверка модели: ссылка на модуль'
titleSuffix: Azure Machine Learning service
description: Узнайте, как использовать модуль перекрестной проверки модели в службе Машинное обучение Azure для перекрестной проверки оценок параметров для моделей классификации или регрессии путем секционирования данных.
services: machine-learning
ms.service: machine-learning
ms.subservice: core
ms.topic: reference
author: likebupt
ms.author: keli19
ms.date: 10/10/2019
ms.openlocfilehash: a5eea61ee8284010531e80e17bf1110ab470d04c
ms.sourcegitcommit: c22327552d62f88aeaa321189f9b9a631525027c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/04/2019
ms.locfileid: "73512851"
---
# <a name="cross-validate-model"></a>Перекрестная проверка модели

В этой статье описывается использование модуля **Перекрестная проверка модели** в конструкторе машинное обучение Azure (Предварительная версия). *Перекрестная проверка* является важной методикой, часто используемой в машинном обучении для оценки вариативности набора данных и надежности любой модели, обученной с помощью этих данных.  

Модуль **Перекрестная проверка модели** принимает в качестве входных данных элемент DataSet с меткой, а также модель обученной классификации или регрессии. Он делит набор данных на некоторое количество подмножеств (*сверток*), создает модель на каждом из сверток, а затем возвращает набор статистики точности для каждого сгиба. Сравнивая статистику точности для всех сверток, можно интерпретировать качество набора данных и понять, является ли модель уязвимой для вариаций в данных.  

Перекрестная проверка также возвращает прогнозируемые результаты и вероятности для набора данных, что позволяет оценить надежность прогнозов.  

### <a name="how-cross-validation-works"></a>Принцип работы перекрестной проверки

1. Перекрестная проверка случайным образом разделяет обучающие данные на несколько секций, называемых также *сложениями*. 

    + По умолчанию алгоритм имеет значение 10 сверток, если набор данных не был разбит ранее. 
    + Чтобы разделить набор данных на другое число сверток, можно использовать модуль [Partition и Sample](partition-and-sample.md) , а также указать, сколько сверток следует использовать.  

2.  Модуль устанавливает данные в сторону 1, чтобы использовать их для проверки (иногда это называется *контрольным сгибом*), и использует оставшиеся свертки для обучения модели. 

    Например, если вы создадите пять сверток, модуль создаст пять моделей во время перекрестной проверки, каждая модель обучена в 4/5 данных и проверила на оставшиеся 1/5.  

3.  Во время тестирования модели для каждого из сверток вычисляется несколько статистических данных о точности. Используемая статистика зависит от типа модели, которую вы оцениваете. Для вычисления моделей классификации и моделей регрессии используются различные статистические данные.  

4.  По завершении процесса сборки и оценки для всех сверток **модель перекрестной проверки** создает набор метрик производительности и оценки результатов для всех данных. Вы должны просмотреть эти метрики, чтобы узнать, имеет ли один сгиб большую или низкую точность. 

### <a name="advantages-of-cross-validation"></a>Преимущества перекрестной проверки

Другой и распространенный способ оценки модели — разделение данных на обучающий и проверочный наборы с помощью [разбиения данных](split-data.md), а затем проверка модели на обучающие данные. Однако перекрестная проверка предлагает некоторые преимущества:  

-   Перекрестная проверка использует больше тестовых данных.

     Перекрестная проверка измеряет производительность модели с указанными параметрами в более крупном пространстве данных. То есть перекрестная проверка использует весь обучающий набор данных как для обучения, так и для оценки, а не для какой-либо части. В отличие от этого, при проверке модели с помощью данных, созданных из случайного разбиения, обычно модель вычисляется только на 30% или меньше доступных данных.  

     Тем не менее, так как перекрестная проверка и проверка модели выполняется несколько раз над большим набором данных, это значительно больше вычислительных ресурсов и занимает гораздо больше времени, чем проверка случайного разбиения.  

-   Перекрестная проверка оценивает набор данных, а также модель.

     Перекрестная проверка не просто измеряет точность модели, но также дает представление о том, как репрезентативно представлять набор данных и насколько важна модель для вариаций в данных.  

## <a name="how-to-use-cross-validate-model"></a>Использование перекрестной проверки модели

Выполнение перекрестной проверки может занять много времени, если набор данных имеет большой размер.  Таким образом, можно использовать **перекрестную проверку модели** на начальном этапе создания и тестирования модели, чтобы оценить значение параметров модели (если время вычисления — приемлемой), а затем обучить и оценить модель с помощью установленные параметры с [моделью обучения](train-model.md) и [анализом модулей модели](evaluate-model.md) .

В этом сценарии вы как обучать, так и тестировать модель с помощью **перекрестной проверки модели**.

1. Добавьте модуль **Перекрестная проверка модели** в конвейер. Его можно найти в Машинное обучение Azure конструкторе в категории **Оценка модели & оценки** . 

2. Соедините выходные данные любой модели **классификации** или **регрессии** . 

    Например, если вы используете на основе **двух классовых автоматов** для классификации, настройте модель с нужными параметрами, а затем перетащите соединитель из порта обученной **модели** классификатора в соответствующий порт **перекрестной проверки. Модель**. 

    > [!TIP] 
    > Модель не должна быть обучена, поскольку **модель перекрестной проверки** автоматически обучает модель как часть оценки.  
3.  В параметре порт **набора данных** для **модели перекрестной проверки**Подключите набор обучающих данных с метками.  

4.  На панели **Свойства** **перекрестной проверки модели**щелкните **запустить селектор столбцов** и выберите один столбец, содержащий метку класса, или прогнозируемое значение. 

5. Задайте значение для параметра **случайного начального значения** , если требуется возможность повторить результаты перекрестной проверки между последовательными выполнениями для одних и тех же данных.  

6.  Запустили конвейер.

7. Описание отчетов см. в разделе [результатов](#results) .

    Чтобы получить копию модели для повторного использования, щелкните правой кнопкой мыши выходные данные модуля, содержащего алгоритм (например, 2-я упрощенный **компьютер**), и выберите команду **Сохранить как обученную модель**.

## <a name="results"></a>Результаты

После завершения всех итераций **Перекрестная проверка модели** создает оценки для всего набора данных, а также метрики производительности, которые можно использовать для оценки качества модели.

### <a name="scored-results"></a>Оцененные результаты

Первый выход модуля предоставляет исходные данные для каждой строки, а также некоторые прогнозируемые значения и связанные с ними вероятности. 

Чтобы просмотреть эти результаты, в конвейере щелкните модуль **Перекрестная проверка модели** правой кнопкой мыши, выберите пункт оцененные **результаты**и щелкните **визуализировать**.

| Имя нового столбца      | Description (Описание)                              |
| -------------------- | ---------------------------------------- |
| Оцененные метки        | Этот столбец добавляется в конец набора данных и содержит прогнозируемое значение для каждой строки. |
| Оцененные вероятности | Этот столбец добавляется в конец набора данных и указывает предполагаемую вероятность значения в вычисляемых **метках**. |
| Номер сгиба          | Указывает индекс, отсчитываемый от нуля, для каждой строки данных, присвоенный во время перекрестной проверки. |

 ### <a name="evaluation-results"></a>Результаты оценки

Второй отчет сгруппирован по сгибам. Помните, что во время выполнения **модель перекрестной проверки** случайным образом разделяет обучающие данные на *n* (по умолчанию 10). В каждом проходе по набору данных **модель перекрестной проверки** использует один сгиб в качестве проверочного набора данных и использует оставшиеся сгибы *n-1* для обучения модели. Каждая из *n* моделей тестируется на основе данных во всех остальных сверток.

В этом отчете свертывание перечисляются по значению индекса в возрастающем порядке.  Чтобы упорядочить данные в любом другом столбце, можно сохранить результаты в виде набора данных.

Чтобы просмотреть эти результаты, в конвейере щелкните модуль **Перекрестная проверка модели** правой кнопкой мыши, выберите **результаты оценки по сгибу**и нажмите кнопку **визуализировать**.


|Имя столбца| Description (Описание)|
|----|----|
|Номер сгиба| Идентификатор для каждого из сверток. Если было создано 5 сверток, будет иметь 5 подмножеств данных с номерами от 0 до 4.
|Число примеров в виде сгиба|Число строк, назначенных каждому из сверток. Они должны быть примерно одинаковыми. |


Кроме того, для каждого из сверток включаются следующие метрики в зависимости от типа модели, которую вы оцениваете. 

+ **Модели классификации**: точность, отзыв, F-Оценка, AUC, точность  

+ **Модели регрессии**: среднее значение абсолютной ошибки, корневое среднее значение ошибки, относительная абсолютная ошибка, относительная квадратная ошибка и коэффициент определения


## <a name="technical-notes"></a>Технические примечания  

+ Рекомендуется нормализовать наборы данных перед их использованием для перекрестной проверки. 

+ Поскольку **Перекрестная проверка модели** проводит обучение и проверку модели несколько раз, она гораздо более требовательна к вычислительным операциям и занимает больше времени, чем при проверке модели с помощью набора данных с произвольным разделением. 

+ При использовании кросс-проверки для измерения точности модели нет необходимости разбивать набор данных на обучающие и проверочные наборы. 


## <a name="next-steps"></a>Дальнейшие действия

См. [набор модулей, доступных](module-reference.md) машинное обучение Azure службе. 

