---
title: Извлечение функций N-грамм из справочника по текстовым модулям
titleSuffix: Azure Machine Learning
description: Узнайте, как использовать модуль извлечения N-грамм в Машинное обучение Azure для создание признаков текстовых данных.
services: machine-learning
ms.service: machine-learning
ms.subservice: core
ms.topic: reference
author: xiaoharper
ms.author: zhanxia
ms.date: 09/01/2019
ms.openlocfilehash: 4f64ac9b276c71a037f96766b38a2574b89441c8
ms.sourcegitcommit: a9b1f7d5111cb07e3462973eb607ff1e512bc407
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/22/2020
ms.locfileid: "76312232"
---
# <a name="extract-n-gram-features-from-text-module-reference"></a>Извлечение функций N-грамм из справочника по текстовым модулям

В этой статье описывается модуль в конструкторе Машинное обучение Azure. Используйте функции извлечь N-граммы из текстового модуля, чтобы *Создание признаков* неструктурированные текстовые данные. 

## <a name="configuration-of-the-extract-n-gram-features-from-text-module"></a>Настройка функций извлечения N-грамм из текстового модуля

Модуль поддерживает следующие сценарии для использования словаря n-грамм:

* [Создать новый словарь n-грамм](#create-a-new-n-gram-dictionary) из столбца с произвольным текстом.

* [Используйте существующий набор текстовых функций](#use-an-existing-n-gram-dictionary) , чтобы создание признаков столбец с произвольным текстом.

* [Оценка или Публикация модели](#score-or-publish-a-model-that-uses-n-grams) , которая использует n-граммы.

### <a name="create-a-new-n-gram-dictionary"></a>Создать новый словарь n-грамм

1.  Добавьте функции извлечения N-грамм из текстового модуля в конвейер и подключите набор данных, содержащий текст, который требуется обработать.

1.  Используйте **текстовый столбец** , чтобы выбрать столбец строкового типа, содержащий текст, который требуется извлечь. Поскольку результаты являются подробными, можно обрабатывать только один столбец за раз.

1. Задайте для параметра **режим словаря** значение **создать** , чтобы указать, что вы создаете новый список функций n-грамм. 

1. Задайте **Размер n-грамм** , чтобы указать *максимальный* размер n-грамм для извлечения и хранения. 

    Например, если ввести 3, униграмм, биграмм и триграммов будут созданы.

1. **Функция взвешивания** задает способ построения вектора возможностей документа и способ извлечения словаря из документов.

    * **Вес двоичных файлов**. присваивает извлеченным n-граммам двоичное значение присутствия. Значение для каждого n-фактора равно 1, если он существует в документе, и 0 в противном случае.

    * **Tf Weight**: назначается значение частоты терминов (TF) для извлеченных n-датаграмм. Значение каждой n-граммы равно частоте возникновения в документе.

    * **Вес IDF**: назначает оценку инверсии документа (IDF) извлеченным n-граммам. Значение для каждого n-граммы — это журнал размера совокупности, деленный на частоту возникновения в целой совокупности.
    
      `IDF = log of corpus_size / document_frequency`
 
    *  **TF-IDF Weight**: задает оценку частоты и инверсии документа (TF/IDF) для извлеченных n-датаграмм. Значение каждого n-грамма — это его оценка TF, умноженная на оценку IDF.

1. Задайте **минимальное** количество букв, которое может использоваться в *одном слове* в n-граммах.

1. Используйте **максимальную длину слова** , чтобы задать максимальное число букв, которое может использоваться в *одном слове* в n-граммах.

    По умолчанию разрешено не более 25 символов на слово или маркер.

1. Используйте для установки минимального числа вхождений, необходимых для включения n-грамм в словарь n-грамм, **минимально заданный документом n-граммой Абсолютная частота** . 

    Например, если используется значение по умолчанию 5, то все n-граммы должны отображаться как минимум пять раз в совокупности, чтобы быть включены в словарь n-грамм. 

1.  Установите **Максимальное соотношение документа n-граммы** к максимальному значению количества строк, содержащих определенные n-граммы, над числом строк в общем совокупности.

    Например, отношение 1 указывает, что, даже если в каждой строке есть определенные n-граммы, к словарю n-грамм можно добавить n-граммы. Как правило, слово, возникающее в каждой строке, будет рассматриваться как пропускаемое слово и будет удалено. Чтобы отфильтровать зависимые от домена пропускаемые слова, попробуйте уменьшить это соотношение.

    > [!IMPORTANT]
    > Интенсивность вхождений отдельных слов является неоднородной. Он отличается от документа к документу. Например, при анализе комментариев клиента о конкретном продукте название продукта может быть очень высокой и близко к пропускаемому слову, но быть важным термином в других контекстах.

1. Выберите параметр **нормализовать векторы компонентов n-грамм** для нормализации векторов компонентов. Если этот параметр включен, каждый вектор функций n-грамм делится на нормы L2.

1. Запустили конвейер.

### <a name="use-an-existing-n-gram-dictionary"></a>Использовать существующий словарь n-грамм

1.  Добавьте функции извлечения N-грамм из текстового модуля в конвейер и соедините набор данных, содержащий текст, который необходимо обработать, в порт **набора данных** .

1.  Используйте **текстовый столбец** , чтобы выбрать текстовый столбец, содержащий текст, который необходимо создание признаков. По умолчанию модуль выбирает все столбцы типа **String**. Для получения наилучших результатов обработайте один столбец за раз.

1. Добавьте сохраненный набор данных, содержащий ранее созданный словарь n-грамм, и подключите его к **входному порту словаря** . Кроме того, можно подключить выходные данные **результирующего словаря** вышестоящего экземпляра функции извлечения N-грамм из текстового модуля.

1. В поле **режим словаря**выберите параметр обновить **только для чтения** из раскрывающегося списка.

   Параметр **ReadOnly** представляет входной совокупности для входного словаря. Вместо вычисления частоты терминов из нового текстового набора данных (на левом входе) веса n-грамм из входного словаря применяются как есть.

   > [!TIP]
   > Используйте этот параметр, если вы создаете классификатор текста.

1.  Дополнительные сведения о других параметрах см. в описании свойств в [предыдущем разделе](#create-a-new-n-gram-dictionary).

1.  Запустили конвейер.

### <a name="score-or-publish-a-model-that-uses-n-grams"></a>Оценка или Публикация модели, использующей n-граммные

1.  Скопируйте **функции извлечь N-граммы из текстового** модуля из обучающего потока данных в поток данных оценки.

1.  Подсоедините выходные данные **результирующего словаря** из обучающего потока **данных к входному словарю** в потоке показателей.

1.  В рабочем процессе оценки измените параметр извлечь N-граммы из текстового модуля и установите для параметра **режим словаря** значение **только для чтения**. Оставьте все остальное.

1.  Чтобы опубликовать конвейер, сохраните **результирующий словарь** в качестве набора данных.

1.  Подключите сохраненный набор данных к элементу извлечь N-граммные функции из текстового модуля на диаграмме оценки.

## <a name="results"></a>Результаты

Функция извлечения функций N-грамм из текстового модуля создает два типа выходных данных: 

* **Результирующий набор данных**. эти выходные данные представляют собой сводку проанализированного текста вместе с извлеченными n-граммами. Столбцы, которые не были выбраны в параметре **текстовый столбец** , передаются в выходные данные. Для каждого столбца анализируемого текста модуль создает следующие столбцы:

  * **Матрица вхождений n-грамм**: модуль создает столбец для каждого n-фактора, найденного в общем совокупности, и добавляет оценку в каждом столбце для указания веса n-грамм для этой строки. 

* **Результирующий словарь**: в словаре содержится фактический словарь n-грамм, а также оценки частоты, созданные в ходе анализа. Набор данных можно сохранить для повторного использования с другим набором входных параметров или для последующего обновления. Можно также повторно использовать словарь для моделирования и оценки.

### <a name="result-vocabulary"></a>Результирующий словарь

В словаре содержится словарь n-грамм с показателями частоты, формируемыми в ходе анализа. Показатели DF и IDF создаются независимо от других параметров.

+ **ID**: идентификатор, формируемый для каждого уникального n-грамма.
+ **NGram**: n-граммы. Пробелы или другие разделители слов заменяются символом подчеркивания.
+ **DF**: Оценка частоты для n-грамм в исходном совокупности.
+ **IDF**: обратный показатель частоты документа для n-грамм в исходном совокупности.

Этот набор данных можно обновить вручную, но могут возникнуть ошибки. Пример.

* Если модуль находит дублирующиеся строки с одним и тем же ключом во входном словаре, возникает ошибка. Убедитесь, что ни одна из двух строк в словаре не содержит одно и то же слово.
* Входная схема наборов данных словаря должна точно совпадать, включая имена столбцов и типы столбцов. 
* Столбцы **ID** и **DF** должны иметь целочисленный тип. 
* Столбец **IDF** должен иметь тип float.

> [!Note]
> Не подключайте выходные данные непосредственно к модулю обучение модели. Прежде чем поступать в модель обучения, необходимо удалить столбцы с произвольным текстом. В противном случае столбцы с произвольным текстом будут рассматриваться как функции категории категорий.

## <a name="next-steps"></a>Дальнейшие действия

См. [набор модулей, доступных](module-reference.md) для машинное обучение Azure.
