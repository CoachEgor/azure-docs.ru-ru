---
title: 'Извлечь N-граммы: Справочник по модулям'
titleSuffix: Azure Machine Learning service
description: Узнайте, как использовать модуль извлечения N-грамм в Машинное обучение Azure службе для создание признаков текстовых данных.
services: machine-learning
ms.service: machine-learning
ms.subservice: core
ms.topic: reference
author: xiaoharper
ms.author: zhanxia
ms.date: 09/01/2019
ms.openlocfilehash: 450c205f92fc65cad4e552aef3a1f28157d25ab6
ms.sourcegitcommit: d470d4e295bf29a4acf7836ece2f10dabe8e6db2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/02/2019
ms.locfileid: "70210875"
---
# <a name="extract-n-gram-features-from-text"></a>Извлечение функций N-грамм из текста

В этой статье описывается модуль визуального интерфейса (Предварительная версия) для службы Машинное обучение Azure.

Используйте **функции извлечь N-граммы из текстового** модуля, чтобы *Создание признаков* неструктурированные текстовые данные.

Этот модуль поддерживает следующие сценарии использования словаря n-грамм:

* [Создать новый словарь n-грамм](#create-a-new-n-gram-dictionary) из столбца с произвольным текстом.

* [Используйте существующий набор текстовых функций](#use-an-existing-n-gram-dictionary) , чтобы создание признаков столбец с произвольным текстом.

* [Оценка или Публикация модели](#score-or-publish-a-model-that-uses-n-grams) , которая использует n-граммы.

## <a name="configure-extract-n-gram-features-from-text"></a>Настройка извлечения функций N-грамм из текста

### <a name="create-a-new-n-gram-dictionary"></a>Создать новый словарь n-грамм

1.  Добавьте **функции извлечения N-грамм из текстового** модуля в эксперимент и подключите набор данных, содержащий текст, который требуется обработать.

1.  Используйте **текстовый столбец** , чтобы выбрать столбец типа **строка** , содержащий текст, который требуется извлечь. Поскольку результаты являются подробными, можно обрабатывать только один столбец за раз.

1. Задайте для параметра **режим словаря** значение **создать** , чтобы указать, что вы создаете новый список функций n-грамм. 

1. Задайте **Размер n-грамм** , чтобы указать *максимальный* размер n-грамм для извлечения и хранения. 

    Например, если ввести 3, униграмм, биграмм и триграммов будут созданы.

1. **Функция взвешивания** задает способ построения вектора возможностей документа и способ извлечения словаря из документов.

    * **Вес двоичных файлов**: Присваивает извлеченным n-граммам двоичное значение присутствия. Значение для каждого n-грамма равно 1, если оно существует в данном документе, и 0 в противном случае.

    * " **Tf Weight**": Назначает оценку частоты терминов (**tf**) извлеченным n-граммам. Значение каждой n-граммы равно частоте возникновения в данном документе.

    * **Вес IDF**: Назначает обратный показатель частоты документа (**IDF**) извлеченным n-граммам. Значение для каждого n-граммы — это журнал размера совокупности, деленный на частоту возникновения в целой совокупности. `IDF = log of corpus_size / document_frequency`
 
    *  **TF — IDF вес**: Назначает в извлеченных n-граммах термин Frequency/инверсный показатель частоты документа (**TF/IDF**). Значение каждого n-грамма — это его оценка TF, умноженная на оценку IDF.

1. Задайте **минимальное** количество букв, которое может использоваться в *одном слове* в n-граммах.

1. Используйте **максимальную длину слова** , чтобы задать максимальное число букв, которое может использоваться в *одном слове* в n-граммах.

    По умолчанию разрешено не более 25 символов на слово или маркер.

1. Чтобы задать минимальное количество вхождений, необходимых для включения n-грамм в словарь n-грамм, используйте абсолютную частоту в **документе n-грамм**. 

    Например, если используется значение по умолчанию 5, то все n-граммы должны отображаться как минимум пять раз в совокупности, чтобы быть включены в словарь n-грамм. 

1.  Установите **Максимальное соотношение документа n-граммы** к максимальному значению количества строк, содержащих определенные n-граммы, над числом строк в общем совокупности.

    Например, отношение 1 указывает, что, даже если в каждой строке есть определенные n-граммы, к словарю n-грамм можно добавить n-граммы. Как правило, слово, возникающее в каждой строке, будет рассматриваться как пропускаемое слово и будет удалено. Чтобы отфильтровать зависимые от домена пропускаемые слова, попробуйте уменьшить это соотношение.

    > [!IMPORTANT]
    > Частота вхождений отдельных слов неоднородна, но отличается от документа к документу. Например, при анализе комментариев клиента о конкретном продукте название продукта может быть очень высокой и близко к пропускаемому слову, но быть важным термином в других контекстах.

1. Выберите параметр **нормализовать векторы компонентов n-грамм** для нормализации векторов компонентов. Если этот параметр включен, каждый вектор функций n-грамм делится на нормы L2.

1. Запустите эксперимент.

### <a name="use-an-existing-n-gram-dictionary"></a>Использовать существующий словарь n-грамм

1.  Добавьте **функции извлечь N-граммы из текстового** модуля в эксперимент и подключите набор данных, содержащий текст, который необходимо обработать, в порт **набора данных** .

1.  Используйте **текстовый столбец** , чтобы выбрать текстовый столбец, содержащий текст, который необходимо создание признаков. По умолчанию модуль выбирает все столбцы типа String. Для получения наилучших результатов обработайте один столбец за раз.

1. Добавьте сохраненный набор данных, содержащий ранее созданный словарь n-грамм, и подключите его к **входному порту словаря** . Кроме того, можно подключить выходные данные **результирующего словаря** вышестоящего экземпляра **функции извлечения N-грамм из текстового** модуля.

1. В поле **режим словаря**выберите следующий параметр обновления из раскрывающегося списка:

   * **Только для чтения**: Представляет входной совокупности для входного словаря. Вместо вычисления частоты терминов из нового текстового набора данных (на левом входе) веса n-грамм из входного словаря применяются как есть.

    > [!TIP]
    > Используйте этот параметр при оценке классификатора текста.

1.  Дополнительные сведения о других параметрах см. в описании свойств в [предыдущем разделе](#create-a-new-n-gram-dictionary).

1.  Запустите эксперимент.

### <a name="score-or-publish-a-model-that-uses-n-grams"></a>Оценка или Публикация модели, использующей n-граммные

1.  Скопируйте **функции извлечь N-граммы из текстового** модуля из обучающего потока данных в поток данных оценки.

1.  Подключите выходные данные **результирующего словаря** из обучающего потока данных к **входному словарю** в потоке оценки.

1.  В рабочем процессе оценки измените « **Извлечение функций N-грамм» из текстового** модуля и внесите эти изменения, если все остальное не так:

    - Установите для параметра **режим словаря** значение **только для чтения**.

1.  Чтобы опубликовать эксперимент, сохраните результирующий **словарь** в виде набора данных.

1.  Затем подключите сохраненный набор данных к **компоненту извлечь N-граммные функции из текстового** модуля на диаграмме оценки.

## <a name="results"></a>Результаты

**Функция извлечения функций N-грамм из текстового** модуля создает два типа выходов: 

* **Набор данных результатов**: Сводка проанализированного текста в сочетании с извлеченными n-граммами. Столбцы, которые не были выбраны в параметре **текстовый столбец** , передаются в выходные данные. Для каждого столбца анализируемого текста модуль создает следующие столбцы:

  * **Матрица вхождений n-грамм**: Модуль создает столбец для каждого n-фактора, найденного в общем совокупности, и добавляет оценку в каждом столбце, чтобы указать вес n-грамм для этой строки. 

* **Результирующий словарь**: В словаре содержится фактический словарь n-грамм, а также оценки частоты, формируемые в ходе анализа. Набор данных можно сохранить для повторного использования с другим набором входных параметров или для последующего обновления. Можно также повторно использовать словарь для моделирования и оценки.

### <a name="result-vocabulary"></a>Результирующий словарь

В словаре содержится словарь n-грамм с показателями частоты, формируемыми в ходе анализа. Оценки **DF** и **IDF** создаются независимо от других параметров.

+ **ID:** Идентификатор, формируемый для каждой уникальной n-грамм.
+ **NGram**: N-граммы. Пробелы или другие разделители слов заменяются символом подчеркивания.
+ **DF**: Термин частоты оценки для n-грамм в исходном совокупности.
+ **IDF**: Обратный показатель частоты документа для n-грамм в исходном совокупности.

Этот набор данных можно обновить вручную. Однако могут возникнуть ошибки. Пример:

* Если модуль находит дублирующиеся строки с одним и тем же ключом во входном словаре, возникает ошибка. Убедитесь, что ни одна из двух строк в словаре не содержит одно и то же слово.
* Входная схема наборов данных словаря должна точно совпадать, включая имена столбцов и типы столбцов. 
* Столбец **ID** и показатель **DF** должны иметь целочисленный тип. 
* Столбец **IDF** должен иметь тип float.

> [!Note]
> Не подключайте выходные данные непосредственно к модулю **обучение модели** . Столбцы с произвольным текстом должны быть удалены перед началом **обучения модели**, в противном случае столбцы с произвольным текстом будут рассматриваться как функции категории категорий.

## <a name="next-steps"></a>Следующие шаги

См. [набор модулей, доступных](module-reference.md) машинное обучение Azure службе. 
