---
title: Группирование данных в ячейки
titleSuffix: Azure Machine Learning
description: Узнайте, как использовать модуль группирования данных в ячейки для группирования чисел и изменения распределения непрерывных данных.
services: machine-learning
ms.service: machine-learning
ms.subservice: core
ms.topic: reference
author: likebupt
ms.author: keli19
ms.date: 05/19/2020
ms.openlocfilehash: b33aa3d2ab22fc986100d6141dd03d5547ef1862
ms.sourcegitcommit: 1f25aa993c38b37472cf8a0359bc6f0bf97b6784
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/26/2020
ms.locfileid: "83853736"
---
# <a name="group-data-into-bins"></a>Группирование данных в ячейки

В этой статье описывается, как использовать модуль [Группирование данных в ячейки](group-data-into-bins.md)в конструкторе Машинного обучения Azure (предварительная версия) для группирования чисел или изменения распределения непрерывных данных.

Модуль [Группирование данных в ячейки](group-data-into-bins.md) поддерживает несколько вариантов группирования данных. Вы можете настроить, каким образом задаются границы ячеек и как по ним распределяются значения. Например, администратор может сделать следующее:  

+ вручную ввести ряд значений, которые будут использоваться в качестве границ ячеек;  
+ присвоить значения ячейкам с помощью *квантилей* или процентилей;  
+ принудительно установить равномерное распределение значений по ячейкам.  

### <a name="more-about-binning-and-grouping"></a>Дополнительные сведения о квантовании и группировании

*Квантование* (*группирование*) данных является важным инструментом подготовки числовых данных для машинного обучения и полезно в следующих сценариях:

+ В столбце непрерывных чисел слишком много уникальных значений для эффективного моделирования, поэтому вы автоматически или вручную назначаете значения группам, чтобы создать меньший набор дискретных диапазонов.

+ Замените столбец чисел значениями по категориям, представляющими определенные диапазоны.

    Например, можно сгруппировать значения в столбце возраста в настраиваемые диапазоны, например 1–15, 16–22, 23–30 и т. д., для анализа демографического состава пользователей.

+ Набор данных включает несколько значений, которые значительно выходят за пределы ожидаемого диапазона, и эти значения оказывают слишком сильное влияние на обучаемую модель. Чтобы компенсировать его, можно преобразовать данные в равномерное распределение с помощью метода квантилей.

    При использовании этого метода модуль [Группирование данных в ячейки](group-data-into-bins.md) определяет оптимальные расположения и ширину ячеек, чтобы в каждую ячейку попало приблизительное равное количество выборок. Затем, в зависимости от выбранного метода нормализации, значения в ячейках преобразуются в процентили или сопоставляются с номером ячейки.

### <a name="examples-of-binning"></a>Примеры группирования

На следующей схеме показано распределение числовых значений до и после группирования с помощью метода **квантилей**. Обратите внимание, что по сравнению с необработанными данными в левой части данные были сгруппированы и преобразованы в нормальное распределение с единичной дисперсией.  

Пример приведен в результате выполнения этого конвейера: https://ml.azure.com/visualinterface/authoring/Normal/87270db9-4651-448e-bd28-8ef7428084dc?wsid=%2Fsubscriptions%2Fe9b2ec51-5c94-4fa8-809a-dc1e695e4896%2Fresourcegroups%2Fmodule-ws-rg%2Fworkspaces%2Fmodule-prerelease-119&flight=cm&tid=72f988bf-86f1-41af-91ab-2d7cd011db47&smtendpoint=https%3A%2F%2Fsmt-test1.azureml-test.net.

Так как существует много способов группирования данных и все из них можно настраивать, мы рекомендуем поэкспериментировать с различными методами и значениями. 

## <a name="how-to-configure-group-data-into-bins"></a>Как настроить модуль "Группирование данных в ячейки"

1. Добавьте модуль **Группирование данных в ячейки** в конвейер Конструктора (предварительная версия). Этот модуль можно найти в категории **Преобразование данных**.

2. Соедините набор данных, содержащий числовые данные, с ячейкой.  Квантование можно применять только к столбцам, содержащим числовые данные. 

    Если набор данных содержит столбцы с нечисловыми данными, используйте модуль [Выбор столбцов в наборе данных](select-columns-in-dataset.md), чтобы выбрать подмножество столбцов для работы.

3. Укажите режим группирования. Режим группирования определяет другие параметры, поэтому сначала установите флажок **Binning mode** (Режим группирования). Поддерживаются следующие типы группирования:

    **Quantiles** (Квантили). В рамках метода квантилей значения распределяются по ячейкам на основе процентильных рангов. Этот метод также называется группированием с равной высотой.

    **Equal Width** (Метод равных интервалов). При использовании этого варианта необходимо указать общее число ячеек. Значения в столбце данных будут размещены в ячейках таким образом, что каждая ячейка будет иметь одинаковый интервал между значениями начала и окончания. В результате в некоторых ячейках может оказаться больше элементов, если значения плотнее распределены в районе определенной точки.

    **Custom Edges** (Настраиваемые границы). Для каждой ячейки можно задать начальное значение. Значение границы всегда является нижней границей ячейки.  Например, предположим, что нужно сгруппировать значения в две ячейки: одну со значениями больше 0, а вторую — со значениями, которые меньше или равны 0. В этом случае в поле **Comma-separated list of bin edges** (Разделенный запятыми список границ ячеек) нужно ввести значение "0". Выходные данные модуля будут иметь значения 1 и 2, что указывает индекс ячейки для каждого значения строки. Обратите внимание, что значения в списке нужно указывать в возрастающем порядке, например "1, 3, 5, 7".

4. **Количество ячеек.** Если вы используете метод **квантилей** или **равных интервалов**, используйте этот параметр, чтобы указать число ячеек или *квантилей*, которые вы хотите создать.

5. Для параметра **Columns to bin** (Столбцы для сегментирования) с помощью селектора выберите столбцы, значения в которых нужно группировать. Столбцы должны содержать данные числового типа.

    Для всех подходящих столбцов из тех, что вы выберете, применяется одинаковое правило группирования. Таким образом, если вам нужно группировать данные в столбцах разными способами, используйте отдельный экземпляр модуля [Группирование данных в ячейки](group-data-into-bins.md) для каждого набора столбцов.

    > [!WARNING]
    > Если выбрать столбец недопустимого типа, возникнет ошибка во время выполнения. Модуль возвращает ошибку, как только он обнаруживает столбец недопустимого типа. Если появляется сообщение об ошибке, проверьте все выбранные столбцы. В ошибке не приводится список недопустимых столбцов.

6. В параметре **Output mode** (Режим вывода) укажите, как следует выводить квантованные значения.

      + **Append** (Добавление). Создается новый столбец с разделенными на группы значениями и добавляется во входную таблицу.

      + **Inplace** (Замещение). Исходные значения в наборе данных заменяются новыми.

      + **ResultOnly** (Только результат). Возвращаются только столбцы с результирующими данными.

7. При выборе режима группирования **Quantiles** (Квантили) используйте параметр **Quantile normalization** (Нормализация квантилей), чтобы задать, каким образом будут нормализованы значения перед сортировкой по квантилям. Обратите внимание, что нормализация значений преобразует значения, но не влияет на конечное количество ячеек.

    Поддерживаются следующие типы нормализации:

    + **Percent** (Проценты). Значения будут нормализованы в диапазоне [0,100].

    + **PQuantile** (Параллельные квантили). Значения будут нормализованы в диапазоне [0,1].

    + **QuantileIndex** (Индекс квантилей).  Значения будут нормализованы в диапазоне [1,количество ячеек].

8. Если вы выбрали вариант **Custom Edges** (Настраиваемые границы), введите разделенный запятыми список чисел, которые будут использоваться в качестве *границ ячеек*, в текстовое поле **Comma-separated list of bin edges** (Разделенный запятыми список границ ячейки).  Значения указывают точку, которая делит ячейки, поэтому если ввести одно значение границы ячейки, будут созданы две ячейки. Если ввести два значения границы ячейки, будут созданы три ячейки и т. д.

    Значения должны быть отсортированы в порядке создания ячеек от меньшего к большему.

10. **Tag columns as categorical** (Столбцы отмечаются как категориальные). Выберите этот параметр, чтобы указать, что квантованные столбцы должны обрабатываться как категориальные переменные.

11. Отправьте конвейер.

### <a name="results"></a>Результаты

Модуль [Группирование данных в ячейки](group-data-into-bins.md) возвращает набор данных, в котором все элементы сгруппированы в соответствии с выбранным режимом. 

Модуль также возвращает **преобразование группирования** — функцию, которую можно передать в модуль [Применение преобразования](apply-transformation.md) для группирования новых выборок данных с использованием того же режима и параметров.  

> [!TIP]
> Учтите, что при применении группирования к данным для обучения необходимо использовать один и тот же метод группирования для данных, используемых для тестирования и прогнозирования. В частности, метод группирования, расположение ячеек и значения ширины ячеек должны быть одинаковыми. 
> 
> Чтобы преобразование данных всегда выполнялось с помощью одного и того же метода группирования, рекомендуется сохранять полезные преобразования, а затем применять их к другим наборам данных, используя модуль [Применение преобразования](apply-transformation.md).

## <a name="next-steps"></a>Дальнейшие действия

Ознакомьтесь с [набором доступных модулей](module-reference.md) в службе Машинного обучения Azure. 
