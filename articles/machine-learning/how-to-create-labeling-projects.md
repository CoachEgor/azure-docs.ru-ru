---
title: Создание проекта маркировки данных
titleSuffix: Azure Machine Learning
description: Узнайте, как создавать и запускать проекты маркировки, которые присваивают теги данным для машинного обучения.  Эти средства включают в себя маркировку с помощью машинного обучения (или маркировку с участием человека, помогающего выполнить задачу).
author: sdgilley
ms.author: sgilley
ms.service: machine-learning
ms.topic: tutorial
ms.date: 03/01/2020
ms.openlocfilehash: f6723992ac3335e6abdd78f2008130dfe136f7df
ms.sourcegitcommit: 2d7910337e66bbf4bd8ad47390c625f13551510b
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/08/2020
ms.locfileid: "80873894"
---
# <a name="create-a-data-labeling-project-and-export-labels"></a>Создание проекта маркировки данных и экспорт меток 

[!INCLUDE [aml-applies-to-basic-enterprise-sku](../../includes/aml-applies-to-basic-enterprise-sku.md)]

Добавление меток к данным большого объема часто становится большой проблемой в проектах машинного обучения. Для проектов машинного обучения с компонентом компьютерного зрения, таких как классификация изображений или обнаружение объектов, обычно требуются метки для тысяч изображений.
 
[Машинное обучение Azure](https://ml.azure.com/) — это централизованное расположение для создания, администрирования и мониторинга проектов маркировки (предварительная версия). С помощью решения можно координировать данные, метки и работу команды, что позволит эффективно управлять задачами добавления меток. Машинное обучение поддерживает такие задачи: классификация изображений (с несколькими метками или классами) и идентификация объектов с использованием ограничивающих прямоугольников.

Машинное обучение отслеживает ход выполнения задач добавления меток и поддерживает очереди незавершенных задач. Для присвоения меток маркировщикам не нужна учетная запись Azure. Выполнив вход с учетной записью Майкрософт или через [Azure Active Directory](https://docs.microsoft.com/azure/active-directory/active-directory-whatis), они смогут добавить любое количество меток, которое удастся обнаружить за отведенное время.

Вы можете запускать и останавливать проект, добавлять и удалять маркировщиков и команды, а также отслеживать ход выполнения маркировки. Вы можете экспортировать помеченные данные в формате COCO или набора данных Машинного обучения Azure.

> [!Important]
> Сейчас поддерживаются только проекты маркировки идентификации объектов и классификации изображений. Кроме того, образы данных должны быть доступными в хранилище BLOB-объектов Azure. (Если у вас нет хранилища данных, вы можете отправлять образы при создании проекта.)

В этой статье вы узнаете, как выполнять следующие задачи.

> [!div class="checklist"]
> * Создание проекта
> * Указание данных и структуры проекта.
> * управление командами и людьми, которые работают над проектом;
> * Запуск и мониторинг проекта.
> * Экспорт меток.


## <a name="prerequisites"></a>Предварительные требования


* Данные, которые вы хотите пометить, размещенные в локальных файлах или в хранилище BLOB-объектов Azure.
* Набор меток, которые вы хотите применить.
* Инструкции по добавлению меток.
* Подписка Azure. Если у вас еще нет подписки Azure, [создайте бесплатную учетную запись](https://aka.ms/AMLFree), прежде чем начинать работу.
* Рабочая область машинного обучения. См. сведения о [создании рабочей области машинного обучения Azure](how-to-manage-workspace.md).

## <a name="create-a-labeling-project"></a>Создание проекта маркировки

Проекты добавления меток администрируются в Машинном обучении Azure. Страница **Labeling projects** (Проекты добавления меток) позволяет управлять проектами и пользователями. Каждому проекту назначается одна или несколько команд, а в команду назначаются один или несколько пользователей.

Если данные уже размещены в хранилище BLOB-объектов Azure, перед созданием проекта добавления меток сделайте данные доступными в виде хранилища данных. Пример использования хранилища данных см. в руководстве по [ созданию проекта маркировки классификации изображений](tutorial-labeling.md).

Чтобы создать проект, щелкните **Добавить проект**. Присвойте проекту подходящее имя и выберите **тип задачи добавления меток**.

![Мастер создания проекта маркировки](./media/how-to-create-labeling-projects/labeling-creation-wizard.png)


* Выберите тип **Image Classification Multi-class** (Классификация изображений со множеством классов), если в проекте вам нужно применить к каждому изображению *один класс* из определенного набора.
* Выберите тип **Image Classification Multi-label** (Классификация изображений со множеством меток), если в проекте вам нужно применить к каждому изображению *одну или несколько* меток из определенного набора классов. Например, фотографии собаки можно одновременно присвоить метки *dog* (собака) и *daytime* (день).
* Выберите тип **Object Identification (Bounding Box)** (Идентификация объекта (ограничивающий прямоугольник)), если в проекте вам нужно присвоить класс и ограничивающий прямоугольник каждому объекту на изображениях.

Щелкните **Далее**, когда будете готовы продолжать работу.

## <a name="specify-the-data-to-label"></a>Укажите данные для присвоения меток

Если вы уже создали набор данных, который содержит нужные данные, его можно выбрать из раскрывающегося списка **Select an existing dataset** (Выбрать существующий набор данных). Либо щелкните **Создать набор данных**, чтобы выбрать существующее хранилище Azure или отправить локальные файлы.


### <a name="create-a-dataset-from-an-azure-datastore"></a>Создание набора данных из хранилища данных Azure

Во многих случаях достаточно просто отправить локальные файлы. Но [Обозреватель службы хранилища Azure](https://azure.microsoft.com/features/storage-explorer/) предоставляет более быстрый и надежный способ для перемещения большого объема данных. Мы рекомендуем по умолчанию использовать Обозреватель службы хранилища для перемещения файлов.

Чтобы создать набор данных на основе данных, которые вы уже сохранили в хранилище BLOB-объектов Azure, сделайте следующее:

1. Щелкните **Создать набор данных** > **From datastore (Из хранилища данных)** .
1. Введите **имя** для набора данных.
1. Выберите значение **Файл** для параметра **Тип набора данных**.  
1. Выберите хранилище данных.
1. Если данные находятся во вложенной папке в хранилище BLOB-объектов, щелкните **Обзор** и выберите нужный путь.
    * Вы также можете добавить символы "/**" в конце пути, чтобы включить все файлы во вложенных папках выбранного пути.
    * Добавьте символы "* */* .*", чтобы включить все данные в текущем контейнере и вложенных папках.
1. Введите описание набора данных.
1. Выберите **Далее**.
1. Подтвердите введенные данные. Щелкните **Назад**, чтобы изменить параметры или **Создать**, чтобы создать новый набор данных.

> [!NOTE]
> Выбранные вами данные загружаются в проект.  После создания проекта при добавлении дополнительных данных в хранилище они в проекте не появятся.  

### <a name="create-a-dataset-from-uploaded-data"></a>Создание набора данных из отправленных данных

Чтобы отправить данные напрямую, сделайте следующее:

1. Щелкните **Создать набор данных** > **From local files (Из локальных файлов)** .
1. Введите **имя** для набора данных.
1. Выберите значение "Файл"для параметра **Тип набора данных**.
1. *Необязательно*. Щелкните **Дополнительные параметры**, чтобы настроить хранилище данных, контейнер и путь к данным.
1. Щелкните **Обзор**, чтобы выбрать локальные файлы для отправки.
1. Введите описание набора данных.
1. Выберите **Далее**.
1. Подтвердите введенные данные. Щелкните **Назад**, чтобы изменить параметры или **Создать**, чтобы создать новый набор данных.

Данные отправляются в хранилище больших двоичных объектов по умолчанию ("workspaceblobstore") в рабочей области Машинного обучения.

## <a name="specify-label-classes"></a>Указание классов меток

На странице **Label classes** (Классы меток) укажите набор классов для категоризации данных. Уделите этому особое внимание, ведь точность и скорость работы маркировщиков зависят от их способности правильно и выбрать класс. Например, вместо полных наименований видов и родов растений или животных используйте кодовые или сокращенные наименования.

Каждую метку указывайте на отдельной строке. Нажмите кнопку **+** , чтобы добавить новую строку. Если число меток больше 3-4, но меньше 10, можно добавить к именам префиксы ("1:", "2:"), чтобы маркировщики могли ускорить работу с помощью числовых клавиш.

## <a name="describe-the-labeling-task"></a>Описание задачи маркировки

Важно четко объяснить задачу добавления меток. Страница **Labeling instructions** (Инструкции по маркировке) позволяет указать ссылку на внешний сайт с информацией о добавлении меток или предоставить инструкции в поле ввода на странице. Инструкции должны описывать конкретные задачи понятным для целевой аудитории образом. Обдумайте следующие вопросы:

* Какие метки увидят пользователи и как сделать выбор между метками? Есть ли справочный текст, которым можно пользоваться?
* Что делать, если ни одна метка не подходит?
* Что делать, если подходят несколько меток?
* Какой уровень достоверности следует применять к метке? Нужно ли указывать лучший из предполагаемых вариантов, если нет уверенности?
* Что делать с частично перекрытыми объектами?
* Что делать, если объект обрезается краем изображения?
* Что делать, если после отправки метки оказывается, что допущена ошибка?

При использовании ограничивающих прямоугольников появляются дополнительные вопросы:

* Как для этой задачи задается ограничивающий прямоугольник? Должен ли он размещаться полностью внутри объекта или полностью снаружи? Нужно ли обрезать его как можно точнее или допустим некоторый зазор?
* Какой уровень точности и согласованности ожидается при определении ограничивающих прямоугольников?
* Как пометить объект, частично показанный на изображении? 
* Как пометить объект, частично перекрытый другим объектом?

>[!NOTE]
> Не забудьте указать, что маркировщик может выбрать первые 9 меток с помощью цифровых клавиш 1–9.

## <a name="use-ml-assisted-labeling"></a>Использование маркировки с помощью машинного обучения

[!INCLUDE [applies-to-skus](../../includes/aml-applies-to-enterprise-sku.md)]

На странице **ML assisted labeling** (Маркировка с использованием машинного обучения) можно активировать автоматические модели машинного обучения, чтобы ускорить выполнение задачи маркировки. В начале проекта маркировки изображения перемешиваются в случайном порядке, чтобы уменьшить потенциальное смещение. Однако в обученной модели будут отражены все смещения, имеющиеся в наборе данных. Например, если 80 % изображений относятся к одному классу, то к этому классу будет принадлежать приблизительно 80 % данных, используемых для обучения модели. Такое обучение не включает в себя активное обучение.

Эта функция доступна для задач классификации изображений (с несколькими классами или метками).  

Выберите *Enable ML assisted labeling* (Включить маркировку с помощью машинного обучения) и укажите GPU, чтобы включить полуавтоматическую маркировку, которая состоит из двух этапов:
* Кластеризация
* Предварительная маркировка

Точное количество изображений с метками, необходимых для начала полуавтоматической маркировки, не фиксировано.  Оно может существенно отличаться в разных проектах. В некоторых проектах задачи предварительной маркировки или кластеризации могут иногда появляться после того, как вручную будет помечено 300 изображений. При маркировке с использованием машинного обучения применяется методика под названием *Передача обучения*, которая использует предварительно обученную модель для ускорения процесса обучения на начальном этапе. Если классы набора данных похожи на те, которые используются в предварительно обученной модели, то предварительные метки могут быть доступны уже после маркировки вручную всего нескольких сотен изображений. Если набор данных значительно отличается от данных, используемых для предварительного обучения модели, это может занять гораздо больше времени.

Поскольку итоговые метки по-прежнему зависят от входных данных, предоставленных маркировщиком, эта технология иногда называется маркировкой *с участием человека*.

### <a name="clustering"></a>Кластеризация

После отправки определенного числа меток модель машинного обучения начинает группировать похожие изображения.  Такие похожие изображения отображаются для маркировщика на одном экране, что ускоряет добавление тегов вручную. Кластеризация особенно удобна, когда маркировщик просматривает сетку из 4, 6 или 9 изображений. 

После обучения модели машинного обучения по данным, помеченным вручную, модель усекается до последнего полностью связанного слоя. Затем непомеченные изображения пропускаются через усеченную модель в рамках процесса, который обычно называется "встраиванием" или "добавлением признаков". При этом каждое изображение внедряется в многомерное пространство, определенное этим слоем модели. Изображения, являющиеся в этом пространстве ближайшими соседями, используются для задач кластеризации. 

### <a name="prelabeling"></a>Предварительная маркировка

После отправки дополнительных меток изображений для прогнозирования тегов изображений используется модель классификации.  Теперь для маркировщика отображаются страницы, где каждое изображение уже содержит предполагаемые метки.  Следующая задача — просмотреть эти метки и исправить все неверно маркированные изображения перед отправкой страницы.  

После обучения модели машинного обучения по данным, помеченным вручную, модель оценивается на тестовом наборе изображений, помеченных вручную, для определения ее точности при различных пороговых значениях достоверности. Этот процесс оценки используется для определения порога достоверности, выше которого модель достаточно точна для отображения предварительных меток. Затем модель оценивается по немаркированным данным. Изображения с достоверностью прогноза выше порогового значения используется для предварительной маркировки.

> [!NOTE]
> Маркировка с помощью машинного обучения доступна **только** в рабочих областях выпуска Enterprise.

## <a name="initialize-the-labeling-project"></a>Инициализация проекта маркировки

После инициализации проекта добавления меток вы не сможете изменить некоторые его аспекты. Например, нельзя изменить тип задачи или набор данных. Но вы *можете* изменять метки и URL-адрес с описанием задачи. Внимательно проверьте параметры перед созданием проекта. После отправки проекта вернитесь на стартовую страницу **Метки данных**, где для этого проекта отображается состояние **Инициализация**. Эта страница не обновляется автоматически. Поэтому подождите немного и вручную обновите страницу. Состояние проекта должно измениться на **Создано**.

## <a name="manage-teams-and-people"></a>Управление командами и отдельными пользователями

По умолчанию для каждого нового проекта добавления меток создается новая команда, в которую включается создатель проекта. Но команды можно произвольно перераспределять между проектами. Для любого проекта можно назначить больше одной команды. Чтобы создать команду, выберите **Добавить команду** на странице **Команды**. 

Управление пользователями осуществляется на странице **Маркировщики**. При добавлении и удалении пользователи идентифицируются по адресу электронной почты. Каждый маркировщик будет проходить проверку подлинности с учетной записью Майкрософт или Azure Active Directory, если эта служба используется.  

Добавив пользователя, его можно назначить в одну или несколько команд. Перейдите на страницу **Команды**, выберите группу, а затем выберите **Назначить пользователей** или **Удалить пользователей**.

Чтобы отправить группе сообщение электронной почты, щелчком по группе откройте ее страницу **Team details** (Сведения о команде). На этой странице щелкните **Email team** (Отправить команде сообщение электронной почты), чтобы открыть черновик сообщения электронной почты с адресами всех участников команды.

## <a name="run-and-monitor-the-project"></a>Запуск и мониторинг проекта.

После инициализации проекта в Azure начнется его выполнение. Щелкнув проект на главной странице **Метки данных**, вы попадете на страницу **Сведения о проекте**. На вкладке **Панель мониторинга** отображается ход выполнения задачи добавления меток.

На вкладке **Данные** можно просмотреть набор данных и помеченные данные. Если данные помечены неправильно, выберите их и щелкните **Отклонить**, чтобы удалить метки и поместить эти данные обратно в очередь данных без меток.

На вкладке **Команда** можно назначить команды этому проекту или отменить их назначение.

Чтобы приостановить или перезапустить проект, используйте кнопку **Приостановка**/**Запуск**. Данные можно помечать только в выполняемом проекте.

Вы можете напрямую пометить данные на странице **Project details** (Сведения о проекте), выбрав действие **Label data** (Пометить данные).

## <a name="add-new-label-class-to-a-project"></a>Добавление нового класса меток в проект

В процессе создания меток вы можете обнаружить, что для классификации образов необходимы дополнительные метки.  Например, чтобы указать непонятные изображения, может потребоваться добавить метку "Неизвестное" или "Прочее".

Чтобы добавить одну или несколько меток в проект, выполните следующие действия.

1. Выберите проект на главной странице **Метки данных**.
1. В верхней части страницы выберите **Пауза**, чтобы остановить действие меток.
1. Выберите вкладку **Сведения**.
1. В меню слева выберите пункт **Label classes** (Классы меток).
1. В верхней части списка выберите **+ Add Labels** (+ Добавление метки) ![Добавить метку](media/how-to-create-labeling-projects/add-label.png).
1. Добавьте новую метку в форме и выберите способ продолжения.  Поскольку вы изменили доступные метки для изображения, вы выбираете, как обрабатывать уже помеченные данные.
    * Начать заново, удалив всех существующих меток.  Выберите этот параметр, если необходимо начать добавление меток сначала с полным набором меток. 
    * Начать заново, сохраняя все существующие метки.  Выберите этот параметр, чтобы пометить все данные как не помеченные, но оставьте существующие метки в качестве тега по умолчанию для изображений, которые были помечены ранее.
    * Продолжайте, сохраняя все существующие метки. Выберите этот параметр, чтобы сохранить все данные уже помеченными как есть, и начните использовать новую метку для данных, которые еще не помечены.
1. При необходимости измените страницу инструкции для новых меток.
1. После добавления всех новых меток выберите **Пуск** в верхней части страницы, чтобы перезапустить проект.  

## <a name="export-the-labels"></a>Экспорт меток.

Вы можете в любое время экспортировать данные меток для эксперимента машинного обучения. Метки изображений можно экспортировать в [формате COCO](http://cocodataset.org/#format-data) или в виде набора данных Машинного обучения Azure. Используйте для этого кнопку **Экспорт** на странице **Сведения о проекте** для проекта добавления меток.

Файл COCO создается в хранилище больших двоичных объектов по умолчанию для рабочей области Машинного обучения Azure в папке *export/coco*. Вы можете обращаться к экспортированному набору данных Машинного обучения Azure через раздел **Наборы данных** в Машинном обучении. На странице сведений о наборе данных есть пример кода для доступа к меткам из Python.

![Экспортированный набор данных](./media/how-to-create-labeling-projects/exported-dataset.png)

## <a name="next-steps"></a>Дальнейшие действия

* [Руководство. Создание проекта маркировки классификации изображений](tutorial-labeling.md)
* Маркировка изображений для [классификации изображений или обнаружения объектов](how-to-label-images.md).
* Ознакомьтесь с дополнительными сведениями о [Машинном обучении Azure и Студии машинного обучения (классической)](compare-azure-ml-to-studio-classic.md).
