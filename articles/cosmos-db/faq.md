---
title: Часто задаваемые вопросы о различных интерфейсах API в Azure Cosmos DB
description: Ответы на часто задаваемые вопросы о базе данных Azure Cosmos DB — глобально распределенной многомодельной службе базы данных. Сведения о емкости, уровнях производительности и масштабировании.
author: SnehaGunda
ms.service: cosmos-db
ms.topic: conceptual
ms.date: 09/01/2019
ms.author: sngun
ms.custom: seodec18
ms.openlocfilehash: 25b669493e1ee32df4a8c6fc33bdb1b21b08c70f
ms.sourcegitcommit: 849bb1729b89d075eed579aa36395bf4d29f3bd9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2020
ms.locfileid: "81683333"
---
# <a name="frequently-asked-questions-about-different-apis-in-azure-cosmos-db"></a>Часто задаваемые вопросы о различных API в службе Azure Cosmos DB

### <a name="what-are-the-typical-use-cases-for-azure-cosmos-db"></a>Для чего используется Azure Cosmos DB?

Azure Cosmos DB — это хороший выбор для новых веб-приложений, мобильных устройств, игр и приложений IoT, для которых важны автоматическое масштабирование, прогнозируемая производительность, малое (порядка нескольких миллисекунд) время отклика и возможность выполнения запросов к данным без определения схем. Azure Cosmos DB предоставляет возможности для быстрой разработки и поддерживает непрерывную итерацию моделей данных приложения. [Распространенным примером использования Azure Cosmos DB](use-cases.md) являются приложения, которые управляют содержимым и данными пользователей.

### <a name="how-does-azure-cosmos-db-offer-predictable-performance"></a>Как Azure Cosmos DB обеспечивает прогнозируемую производительность?

[Единица запроса](request-units.md) — это мера пропускной способности в Azure Cosmos DB. Пропускная способность 1RU соответствует пропускной способности получения документа размером 1 КБ. Все операции в Azure Cosmos DB, включая чтение, запись, а также выполнение SQL-запросов и хранимых процедур, характеризуются детерминированным значением единиц запроса. Это значение основывается на пропускной способности, необходимой для выполнения определенной операции. Вместо того, чтобы разбираться с показателями загрузки ЦП, числом операций ввода-вывода и объемом потребляемой памяти, а также думать о том, как эти ресурсы влияют на пропускную способность приложения, можно просто рассматривать единицу запроса как меру производительности.

Вы можете настроить каждый контейнер Azure Cosmos с подготовленной пропускной способностью с точки зрения пропускной способности в секунду. Для приложений любого масштаба можно измерять производительность отдельных запросов, чтобы оценивать соответствующие значения единиц запросов и подготавливать контейнеры для обработки общего числа единиц запросов для всех запросов. Можно также масштабировать пропускную способность контейнера в зависимости от потребностей приложения. Для получения дополнительных сведений о единицах запросов и помощи по определению потребностей в контейнере попробуйте [Калькулятор пропускной способности](https://www.documentdb.com/capacityplanner).

### <a name="how-does-azure-cosmos-db-support-various-data-models-such-as-keyvalue-columnar-document-and-graph"></a>Как Azure Cosmos DB поддерживает различные модели данных, например пары "ключ-значение", столбцы, документы и графы?

Такие модели данных, как пары "ключ-значение", столбцы, документы и графы изначально поддерживаются благодаря структуре ARS (атомы, записи и последовательности), на базе которой создана база данных Azure Cosmos DB. Атомы, записи и последовательности можно легко сопоставить и спроецировать для различных моделей данных. API-интерфейсы для подмножества моделей доступны прямо сейчас (SQL, MongoDB, таблицы и Gremlin). Другие API для дополнительных моделей данных будут доступны в будущем.

В Azure Cosmos DB подсистема индексирования, независимая от схемы, которая может автоматически индексировать все принимаемые данные, не требуя схему или дополнительные индексы от разработчика. Подсистема использует набор структур логических индексов (зеркальное отображение, столбцы, дерево), отделяющий структуру хранилища и индексов и отправляет запросы к подсистемам обработки запросов. Cosmos DB также может поддерживать набор сетевых протоколов и API-интерфейсы расширяемым образом и эффективно преобразовывать их в основную модель данных (1) и структуры логических индексов (2). Благодаря этому только в этой базе данных реализована поддержка нескольких моделей данных.

### <a name="can-i-use-multiple-apis-to-access-my-data"></a>Можно ли использовать несколько API для доступа к моим данным?

Azure Cosmos DB — это глобально распределенная многомодельная служба базы данных Майкрософт. Если многомодельное означает Azure Cosmos DB поддерживает несколько интерфейсов API и несколько моделей данных, различные интерфейсы API используют разные форматы данных для хранения и протокола проводного подключения. Например, SQL использует JSON, MongoDB использует BSON, в таблице используется модель EDM, Cassandra использует CQL, Gremlin использует формат JSON. В результате мы рекомендуем использовать один API для доступа к данным в указанной учетной записи.

Каждый API работает независимо, за исключением Gremlin и API SQL, которые являются взаимодействующими.

### <a name="is-azure-cosmos-db-hipaa-compliant"></a>Соответствует ли Azure Cosmos DB HIPAA?

Да, соответствует. HIPAA устанавливает требования к использованию, раскрытию и защите идентифицирующей личной медицинской информации. Дополнительные сведения см. в [центре управления безопасностью Майкрософт](https://www.microsoft.com/en-us/TrustCenter/Compliance/HIPAA).

### <a name="what-are-the-storage-limits-of-azure-cosmos-db"></a>Каковы ограничения на использование хранилища в Azure Cosmos DB?

Общий объем данных, которые контейнер может хранить в Azure Cosmos DB, не ограничен.

### <a name="what-are-the-throughput-limits-of-azure-cosmos-db"></a>Каковы ограничения пропускной способности Azure Cosmos DB?

Общий объем пропускной способности, поддерживаемой контейнером в Azure Cosmos DB, не ограничен. Задача — более-менее равномерное распределение рабочей нагрузки между достаточно большим числом ключей секций.

### <a name="are-direct-and-gateway-connectivity-modes-encrypted"></a>Поддерживается ли шифрование в режимах прямого подключения и подключения через шлюз?

Да, шифрование полностью поддерживается в обоих режимах.

### <a name="how-much-does-azure-cosmos-db-cost"></a>Сколько стоит Azure Cosmos DB?

Дополнительные сведения см. на странице [цен на Azure Cosmos DB](https://azure.microsoft.com/pricing/details/cosmos-db/). Плата за использование Azure Cosmos DB определяется числом подготовленных контейнеров, временем, в течение которого они были в сети, а также подготовленной пропускной способностью для каждого контейнера.

### <a name="is-a-free-account-available"></a>Предусмотрена ли бесплатная учетная запись?

Да, можно зарегистрироваться для получения учетной записи с временным ограничением бесплатно и без каких-либо обязательств. Для этого ознакомьтесь со статьей [Бесплатная пробная версия Azure Cosmos DB](https://azure.microsoft.com/try/cosmosdb/) или [Вопросы и ответы об Azure Cosmos DB](#try-cosmos-db).

Если вы ранее не работали с Azure, можете зарегистрироваться, чтобы получить [бесплатную учетную запись Azure](https://azure.microsoft.com/free/) на 30 дней, а также деньги на счет, которые можно потратить на ознакомление с любыми службами Azure. Если у вас уже есть подписка на Visual Studio, вам доступны [бесплатные кредиты Azure](https://azure.microsoft.com/pricing/member-offers/msdn-benefits-details/), которые также можно потратить на любые службы Azure.

Вы также можете использовать [эмулятор Azure Cosmos DB](local-emulator.md), чтобы локально разработать и протестировать приложение без создания подписки Azure и каких-либо затрат. Если приложение в эмуляторе Azure Cosmos DB работает правильно, вы можете использовать учетную запись Azure Cosmos DB в облаке.

### <a name="how-can-i-get-additional-help-with-azure-cosmos-db"></a>Как я могу получить помощь по работе с Azure Cosmos DB?

Технические вопросы можно разместить на одном из форумов вопросов и ответов ниже:

* [Форум MSDN](https://social.msdn.microsoft.com/Forums/en-US/home?forum=azurecosmosdb)
* [Stack overflow](https://stackoverflow.com/questions/tagged/azure-cosmosdb). Stack Overflow лучше всего подходит, чтобы задать вопросы о программировании. Ваш вопрос должен быть [по теме](https://stackoverflow.com/help/on-topic) и [максимально точным и подробным, чтобы на него можно было ответить по существу](https://stackoverflow.com/help/how-to-ask).

Чтобы запросить новые функции, создайте запрос на форуме [UserVoice](https://feedback.azure.com/forums/263030-azure-cosmos-db).

Чтобы устранить проблему, связанную с учетной записью, отправьте [запрос в службу поддержки](https://ms.portal.azure.com/#blade/Microsoft_Azure_Support/HelpAndSupportBlade/newsupportrequest) на портале Azure.

## <a name="try-azure-cosmos-db-subscriptions"></a><a id="try-cosmos-db"></a>Пробная версия подписок Azure Cosmos DB

Теперь вы можете пользоваться пробной версией Azure Cosmos DB в течение ограниченного времени. Никаких подписок. Совершенно бесплатно. Без каких-либо обязательств. Чтобы зарегистрироваться для использования подписки "пробная Azure Cosmos DB", перейдите на [Azure Cosmos DB пробную](https://azure.microsoft.com/try/cosmosdb/) версию и воспользуйтесь любыми личными учетная запись Майкрософт (MSA). Эта подписка не зависит от [бесплатной пробной версии Azure](https://azure.microsoft.com/free/) и может использоваться параллельно с ней или другой платной подпиской Azure.

Пробная версия подписки Azure Cosmos DB отображается на портале Azure рядом с другими подписками, связанными с идентификатором пользователя.

К подпискам пробной версии подписки Azure Cosmos DB применяются следующие условия:

* Доступ к учетной записи может предоставляться личным учетным записям Майкрософт (MSA). Избегайте использования учетных записей Active Directory (AAD) или учетных записей, принадлежащих корпоративным клиентам AAD, они могут иметь ограничения на место, которое может препятствовать предоставлению доступа.
* Один [подготовленный контейнер пропускной способности](./set-throughput.md#set-throughput-on-a-container) для каждой подписки для SQL, API Gremlin и учетных записей таблиц.
* До трех [подготовленных коллекций с пропускной способностью](./set-throughput.md#set-throughput-on-a-container) на подписку для учетных записей MongoDB.
* Одна [подготовленная пропускная способность базы данных](./set-throughput.md#set-throughput-on-a-database) на подписку. Подготовленные к пропускной способности базы данных могут содержать любое количество контейнеров внутри.
* Хранилище емкостью 10 ГБ.
* Глобальная репликация доступна в следующих [регионах Azure](https://azure.microsoft.com/regions/): центральная часть США, Северная Европа и Юго-Восточная Азия.
* Максимальная пропускная способность, равное 5 кбит/с, при подготовке на уровне контейнера.
* Максимальная пропускная способность 20 кбит/с при подготовке на уровне базы данных.
* Срок действия подписок истекает через 30 дней, и его можно продлить до 31 дня.
* В пробной версии подписки Azure Cosmos DB невозможно создавать запросы в службу поддержки. Однако подписчикам с имеющимися планами поддержки она предоставляется.

## <a name="set-up-azure-cosmos-db"></a>Настройка Azure Cosmos DB

### <a name="how-do-i-sign-up-for-azure-cosmos-db"></a>Как зарегистрироваться в Azure Cosmos DB?

Служба Azure Cosmos DB доступна на портале Azure. Во-первых, вам нужно зарегистрироваться для получения подписки Azure. После регистрации вы можете добавить учетную запись Azure Cosmos DB в подписку Azure.

### <a name="what-is-a-master-key"></a>Что такое главный ключ?

Главный ключ — это токен безопасности для доступа ко всем ресурсам учетной записи. Пользователи с этим ключом имеют доступ на чтение и запись для всех ресурсов в пределах учетной записи базы данных. Будьте осторожны при распространении главных ключей. Первичный и вторичный главные ключи можно найти в колонке **Ключи** на [портале Azure][azure-portal]. Дополнительные сведения о ключах см. в разделе [Просмотр, копирование и повторное создание ключей доступа](manage-with-cli.md#list-account-keys).

### <a name="what-are-the-regions-that-preferredlocations-can-be-set-to"></a>Какие регионы можно указать в списке PreferredLocations?

Значение PreferredLocations можно присвоить любому региону Azure, в котором доступна служба Cosmos DB. Список доступных регионов см. в разделе [регионы Azure](https://azure.microsoft.com/regions/).

### <a name="is-there-anything-i-should-be-aware-of-when-distributing-data-across-the-world-via-the-azure-datacenters"></a>Что необходимо учитывать при распределении данных по всему миру через центры обработки данных Azure?

Служба Azure Cosmos DB доступна во всех регионах Azure, как указано на странице со списком [регионов Azure](https://azure.microsoft.com/regions/). Будучи основной службой, Azure Cosmos DB доступна в каждом новом центре обработки данных.

Указывая регион, помните, что служба Azure Cosmos DB учитывает ограничения, связанные с использованием независимых облаков и облаков для государственных организаций. То есть, создав учетную запись в [регионе с независимым облаком](https://azure.microsoft.com/global-infrastructure/), вы не сможете выполнять репликацию из этого [региона](https://azure.microsoft.com/global-infrastructure/). Кроме того, вы не сможете включить репликацию в других регионах с независимым облаком из внешней учетной записи.

### <a name="is-it-possible-to-switch-from-container-level-throughput-provisioning-to-database-level-throughput-provisioning-or-vice-versa"></a>Можно ли перейти с подготовки пропускной способности на уровне контейнера на подготовку пропускной способности на уровне базы данных или наоборот?

Подготовка пропускной способности на уровне контейнера и на уровне базы данных — это разные предложения, для переключения между которыми требуется выполнить перенос данных из источника в целевое расположение. Это означает, что необходимо создать новую базу данных или новый контейнер, а затем перенести данные с помощью [библиотеки неполного выполнителя](bulk-executor-overview.md) или [фабрики данных Azure](../data-factory/connector-azure-cosmos-db.md).

### <a name="does-azure-cosmosdb-support-time-series-analysis"></a>Поддерживает ли Azure Cosmos DB аналитику временных рядов?

Да, Azure Cosmos DB поддерживает аналитику временных рядов. Ниже приведен пример для [шаблона временных рядов](https://github.com/Azure/azure-cosmosdb-dotnet/tree/master/samples/Patterns). В этом примере показано, как использовать канал изменений, чтобы создавать агрегированные представления данных временных рядов. Вы также можете использовать Spark Streaming или другой обработчик данных потоковой передачи.

## <a name="what-are-the-azure-cosmos-db-service-quotas-and-throughput-limits"></a>Каковы квоты и ограничения пропускной способности службы Azure Cosmos DB

Дополнительные сведения см. в статьях [квоты службы](concepts-limits.md) Azure Cosmos DB и [ограничения по каждому контейнеру и базе данных](set-throughput.md#comparison-of-models) .

## <a name="sql-api"></a>API SQL

### <a name="how-do-i-start-developing-against-the-sql-api"></a>Как начать разработку с использованием API SQL?

Во-первых, вам нужно зарегистрироваться для получения подписки Azure. После этого вы сможете добавить контейнер API SQL в свою подписку Azure. Инструкции по добавлению учетной записи Azure Cosmos DB см. в статье [Создание учетной записи базы данных Azure Cosmos](create-sql-api-dotnet.md#create-account).

[Пакеты SDK](sql-api-sdk-dotnet.md) доступны для .NET, Python, Node.js, JavaScript и Java. Разработчики также могут использовать [API-интерфейсы RESTful HTTP](/rest/api/cosmos-db/) для взаимодействия с ресурсами Azure Cosmos DB на разных платформах и с использованием разных языков.

### <a name="can-i-access-some-ready-made-samples-to-get-a-head-start"></a>Доступны ли готовые примеры, которые можно использовать в качестве отправной точки?

Примеры для пакетов SDK [.NET](sql-api-dotnet-samples.md), [Java](https://github.com/Azure/azure-documentdb-java), [Node.js](sql-api-nodejs-samples.md) и [Python](sql-api-python-samples.md) для API SQL доступны на GitHub.

### <a name="does-the-sql-api-database-support-schema-free-data"></a>Поддерживает ли база данных API SQL данные без схем?

Да, API SQL позволяет приложениям хранить произвольные документы JSON без указаний и определений схемы. Данные немедленно становятся доступными для запроса с помощью интерфейса запросов SQL Azure Cosmos DB.

### <a name="does-the-sql-api-support-acid-transactions"></a>Поддерживает ли API SQL транзакции ACID?

Да, API SQL поддерживает транзакции между документами, выраженные в виде хранимых процедур и триггеров JavaScript. Транзакции объединяются в одну секцию в каждом контейнере. Они выполняются с помощью семантики ACID только полностью и изолированно от другого параллельно выполняемого кода и пользовательских запросов. Если в результате выполнения на стороне сервера кода JavaScript приложения возникает исключение, то выполняется откат всей транзакции. 

### <a name="what-is-a-container"></a>Что представляет собой контейнер?

Контейнер представляет собой группу документов и связанную с ними логику в виде приложения JavaScript. Контейнер — это тарифицируемая сущность. Ее [стоимость](performance-levels.md) определяется используемыми объемом хранилища и пропускной способностью. Контейнеры могут охватывать одну или несколько секций либо серверов. Кроме того, они поддерживают масштабирование практически до неограниченных объемов хранилища или пропускной способности.

* Для API SQL контейнер сопоставляется с контейнером.
* Для Cosmos DB API для учетных записей MongoDB контейнер сопоставляется с коллекцией.
* Для учетных записей API Cassandra и Table контейнер сопоставляется с таблицей.
* Для учетных записей API Gremlin контейнер сопоставляется с графом.

Контейнеры также являются основанием для выставления счетов за использование Azure Cosmos DB. Счета за использование контейнера выставляются ежечасно на основе подготовленной пропускной способности и используемого объема хранилища. Ознакомьтесь с дополнительными сведениями о [ценах на Azure Cosmos DB](https://azure.microsoft.com/pricing/details/cosmos-db/).

### <a name="how-do-i-create-a-database"></a>Как создать базу данных?

Базы данных можно создавать с помощью [портал Azure](https://portal.azure.com), как описано в разделе [Добавление контейнера](create-sql-api-java.md#add-a-container), одного из [Azure Cosmos DB пакетов SDK](sql-api-sdk-dotnet.md)или [интерфейсов API](/rest/api/cosmos-db/).

### <a name="how-do-i-set-up-users-and-permissions"></a>Как устанавливать настройки для пользователей и разрешений?

Создавать пользователей и разрешения можно с помощью [интерфейсов REST API](/rest/api/cosmos-db/) или одного из [пакетов SDK для API Cosmos DB](sql-api-sdk-dotnet.md).

### <a name="does-the-sql-api-support-sql"></a>Поддерживает ли API SQL язык SQL-запросов?

Язык SQL-запросов, поддерживаемый учетными записями API SQL, представляет собой расширенное подмножество функций для запросов, поддерживаемых SQL Server. Язык SQL-запросов Azure Cosmos DB включает разные иерархические и реляционные операторы, а также возможность расширяемости при использовании определяемых пользователем функций (UDF) на основе JavaScript. Грамматика JSON позволяет моделировать документы JSON в виде деревьев с помеченными узлами, которые используются как технологиями автоматического индексирования Azure Cosmos DB, так и запросами на диалекте языка SQL Azure Cosmos DB. Дополнительные сведения об использовании грамматики SQL см. в статье [Запросы SQL для Azure Cosmos DB][query].

### <a name="does-the-sql-api-support-sql-aggregation-functions"></a>Поддерживает ли API SQL статистические функции SQL?

API SQL поддерживает агрегирование с низкой задержкой для любого масштаба с помощью статистических функций `COUNT`, `MIN`, `MAX`, `AVG` и `SUM` через грамматику SQL. Дополнительные сведения см. в разделе [Статистические функции](sql-query-aggregates.md).

### <a name="how-does-the-sql-api-provide-concurrency"></a>Каким образом API SQL обеспечивает параллелизм?

API SQL поддерживает оптимистическое параллельное управление (OCC) через теги сущностей HTTP или ETag. У каждого ресурса API SQL есть тег ETag, значение которого определяется на сервере при каждом обновлении документа. Заголовок и текущее значение ETag добавляются во все сообщения ответа. Чтобы сервер мог определить, нужно ли обновлять ресурс, можно использовать теги ETag с заголовком If-Match. Значением If-Match является значение ETag, используемое для проверки. Если это значение ETag совпадает со значением ETag сервера, ресурс будет обновлен. Если тег ETag больше не актуален, сервер отклоняет операцию с кодом ответа "HTTP 412: ошибка в предусловии". После этого клиенту нужно повторно извлечь ресурс, чтобы получить его текущее значение ETag. Кроме того, теги ETag можно использовать с заголовком If-None-Match, чтобы определить, требуется ли повторное извлечение ресурса.

Чтобы применить оптимистичный параллелизм в .NET, используйте класс [AccessCondition](https://msdn.microsoft.com/library/azure/microsoft.azure.documents.client.accesscondition.aspx) . Пример для .NET см. в разделе [Program.CS](https://github.com/Azure/azure-documentdb-dotnet/blob/master/samples/code-samples/DocumentManagement/Program.cs) в примере примера documentManagement на сайте GitHub.

### <a name="how-do-i-perform-transactions-in-the-sql-api"></a>Как выполнять транзакции в API SQL?

API SQL поддерживает транзакции LINQ через хранимые процедуры и триггеры JavaScript. Все операции с базой данных в скрипте выполняются в режиме изоляции моментального снимка. Если это контейнер с одной секцией, выполнение ограничивается контейнером. Если контейнер секционирован, выполнение ограничивается документами с тем же значением ключа секции в контейнере. Моментальный снимок версий документов (ETag) выполняется в начале транзакции и фиксируется только в случае успешного выполнения скрипта. Если JavaScript выдает ошибку, выполняется откат транзакции. Дополнительные сведения см. в статье [Программирование Azure Cosmos DB на стороне сервера: хранимые процедуры, триггеры баз данных и определяемые пользователем функции](stored-procedures-triggers-udfs.md).

### <a name="how-can-i-bulk-insert-documents-into-cosmos-db"></a>Как выполнять массовую вставку документов в Cosmos DB?

Массовую вставку документов в Azure Cosmos DB можно выполнить одним из следующих способов:

* С помощью библиотеки BulkExecutor, как описано в статьях [Использование библиотеки BulkExecutor .NET для выполнения массовых операций в Azure Cosmos DB](bulk-executor-dot-net.md) и [Выполнение массовых операций с данными Azure Cosmos DB с помощью библиотеки BulkExecutor Java](bulk-executor-java.md).
* С помощью инструмента миграции данных, как описано в статье [Как импортировать данные в Azure Cosmos DB для API DocumentDB](import-data.md).
* С помощью хранимых процедур, как описано в статье [Программирование Azure Cosmos DB на стороне сервера: хранимые процедуры, триггеры баз данных и определяемые пользователем функции](stored-procedures-triggers-udfs.md).

### <a name="does-the-sql-api-support-resource-link-caching"></a>Поддерживает ли API SQL кэширование ссылок на ресурсы?

Да, так как Azure Cosmos DB — это служба RESTful, ссылки на ресурсы являются неизменяемыми и могут кэшироваться. Клиенты API SQL могут указывать заголовок "If-None-Match" для операций чтения с любым документом или контейнером, имеющим такие ресурсы, а затем обновлять их локальные копии после изменения версии сервера.

### <a name="is-a-local-instance-of-sql-api-available"></a>Доступен ли локальный экземпляр API SQL?

Да. [Эмулятор Azure Cosmos DB](local-emulator.md) обеспечивает высокоточную эмуляцию службы Cosmos DB. В эмуляторе реализованы те же функции, что и в службе Azure Cosmos DB, включая поддержку создания документов JSON и обращение к ним, подготовку и масштабирование коллекций, а также выполнение хранимых процедур и триггеров. С помощью эмулятора Azure Cosmos DB можно разрабатывать и тестировать приложения. Чтобы развертывать эти приложения в глобальной среде Azure, достаточно изменить один параметр конфигурации для конечной точки подключения к Azure Cosmos DB.

### <a name="why-are-long-floating-point-values-in-a-document-rounded-when-viewed-from-data-explorer-in-the-portal"></a>Почему длинные значения с плавающей запятой округляются в документе при просмотре с помощью обозревателя данных на портале?

Это ограничение JavaScript. JavaScript использует числа в формате с плавающей запятой двойной точности, как указано в стандарте IEEE 754, и может безопасно хранить числа между-(2<sup>53</sup> -1) и 2<sup>53</sup>-1 (т. е. 9007199254740991).

### <a name="where-are-permissions-allowed-in-the-object-hierarchy"></a>Где в иерархии объектов допускаются разрешения?

Создание разрешений с помощью ResourceTokens разрешено на уровне контейнера и его потомков (например, документов и вложений). Это означает, что возможность создать разрешение в базе данных или на уровне учетной записи сейчас не поддерживается.

## <a name="azure-cosmos-dbs-api-for-mongodb"></a>API Azure Cosmos DB для MongoDB

### <a name="what-is-the-azure-cosmos-dbs-api-for-mongodb"></a>Что такое API Azure Cosmos DB для MongoDB?

API Azure Cosmos DB для MongoDB — это уровень совместимости протоколов, позволяющий приложениям легко и прозрачно взаимодействовать с собственным ядром СУБД Azure Cosmos, используя существующие, поддерживаемые сообществом пакеты SDK и драйверы для MongoDB. Теперь разработчики могут использовать существующие MongoDB цепочек инструментов и навыки для создания приложений, использующих преимущества Azure Cosmos DB. Разработчики получают преимущества от уникальных возможностей Azure Cosmos DB, включая глобальное распространение с репликацией с несколькими хозяевами, автоматическую индексацию, Обслуживание резервного копирования, финансовые резервные соглашения об уровне обслуживания и т. д.

### <a name="how-do-i-connect-to-my-database"></a>Как подключиться к базе данных?

Чтобы быстро подключиться к базе данных Cosmos через API Azure Cosmos DB для MongoDB, откройте [портал Azure](https://portal.azure.com). Войдите в свою учетную запись и выберите в меню навигации слева **Быстрый запуск**. Быстрый запуск — это лучший способ получить фрагменты кода для подключения к базе данных.

В Azure Cosmos DB строгие требования к безопасности и стандарты. Для учетных записей Azure Cosmos DB требуется проверка подлинности и безопасная связь через TLS, поэтому используйте TLSv 1.2.

Дополнительные сведения см. в разделе [Подключение к базе данных Cosmos с помощью API Azure Cosmos DB для MongoDB](connect-mongodb-account.md).

### <a name="are-there-additional-error-codes-that-i-need-to-deal-with-while-using-azure-cosmos-dbs-api-for-mongodb"></a>Существуют ли дополнительные коды ошибок, которые возникают при использовании API Azure Cosmos DB для MongoDB?

Кроме распространенных кодов ошибок MongoDB, в API Azure Cosmos DB для MongoDB есть собственные коды ошибок.

| Ошибка               | Код  | Описание  | Решение  |
|---------------------|-------|--------------|-----------|
| TooManyRequests     | 16500 | Общее число потребляемых единиц запросов больше, чем количество подготовленных единиц запросов для контейнера и было отрегулировано. | Рекомендуем масштабировать пропускную способность, назначенную контейнеру или набору контейнеров на портале Azure, или выполнить повторную попытку. |
| ExceededMemoryLimit | 16501 | Так как в этой службе несколько клиентов, операция превысила выделенную память для клиента. | Уменьшите область операции, применив более строгие критерии запроса, или обратитесь в службу поддержки на [портале Azure](https://portal.azure.com/?#blade/Microsoft_Azure_Support/HelpAndSupportBlade). <br><br><em> &nbsp; &nbsp;Пример: &nbsp;DB. IsCollection (' Users '). Aggregate ([ &nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{$match: {Name: "Энди"}}, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{$sort: {Age:-1}}<br>&nbsp;&nbsp;&nbsp;&nbsp;])</em>) |

### <a name="is-the-simba-driver-for-mongodb-supported-for-use-with-azure-cosmos-dbs-api-for-mongodb"></a>Можно ли использовать драйвер Simba для MongoDB с API Azure Cosmos DB для MongoDB?

Да, можно использовать драйвер ODBC для Mongo Simba с API Azure Cosmos DB для MongoDB

## <a name="table-api"></a><a id="table"></a>API таблиц

### <a name="how-can-i-use-the-table-api-offering"></a>Как использовать предложение API таблиц?

API таблиц Microsoft Azure Cosmos DB доступен на [портале Azure][azure-portal]. Во-первых, вам нужно зарегистрироваться для получения подписки Azure. После этого вы сможете добавить учетную запись API таблиц Azure Cosmos DB в подписку Azure, а затем добавить таблицы в свою учетную запись.

Поддерживаемые языки и связанные способы быстрого начала работы можно найти в статье [Знакомство со службой Azure Cosmos DB. API таблицы](table-introduction.md).

### <a name="do-i-need-a-new-sdk-to-use-the-table-api"></a>Нужен ли новый пакет SDK, чтобы использовать API таблиц?

Нет, имеющиеся пакеты SDK службы хранилища должны по-прежнему работать. Однако мы рекомендуем всегда получать последние версии пакетов SDK для обеспечения оптимальной поддержки и (в большинстве случаев) высокой производительности. Список доступных языков см. на странице [введения в API таблиц базы данных Azure Cosmos DB](table-introduction.md).

### <a name="where-is-table-api-not-identical-with-azure-table-storage-behavior"></a>Чем API таблиц отличается от хранилища таблиц Azure?

Пользователям хранилища таблиц Azure, которые хотят создавать таблицы с помощью API таблиц базы данных Azure Cosmos DB, следует учесть следующие различия в поведении:

* API таблиц базы данных Azure Cosmos DB использует модель зарезервированной емкости, чтобы обеспечить гарантированную производительность. Это означает, что пользователь платит за емкость, как только создается таблица, даже если ресурс не используется. При использовании хранилища таблиц Azure вы платите только за используемую емкость. Это объясняет, почему Соглашение об уровне обслуживания предусматривает 10 мс задержки для операций чтения и 15 мс задержки для операций записи на уровне 99-го процентиля для API таблиц и 10 секунд задержки для Хранилища таблиц Azure. Следовательно, при работе с API таблиц оплачиваются даже пустые таблицы без каких-либо запросов, чтобы обеспечить возможность обработки любых запросов на уровне SLA, заявленного Azure Cosmos DB.
* Результаты запроса, возвращаемые API таблиц, не сортируются в порядке ключей ключа раздела или строки, как это было в хранилище таблиц Azure.
* Ключи строк могут содержать не более 255 байт.
* Пакеты могут содержать не более 2 МБ.
* В настоящий момент CORS не поддерживается.
* Имена таблиц в хранилище таблиц Azure не учитывают регистр, но находятся в Azure Cosmos DB API таблиц
* Некоторые внутренние форматы кодирования информации Azure Cosmos DB, например двоичные поля, в настоящее время не так эффективны, как хотелось бы. Поэтому на размер данных могут накладываться неожиданные ограничения. Например, сейчас невозможно использовать полную 1-мегабайтную сущность таблицы для хранения двоичных данных, так как кодировка увеличивает размер данных.
* Имя свойства сущности "ID" в настоящее время не поддерживается
* Значение TakeCount для TableQuery не ограничено 1000.

С точки зрения API REST существует ряд конечных точек и параметров запросов, которые не поддерживаются API таблиц базы данных Azure Cosmos DB.

| Методы REST | Конечная точка или параметр запроса REST | URL-адреса документов | Объяснение |
| ------------| ------------- | ---------- | ----------- |
| GET, PUT | /?restype=service@comp=properties| [Set Table Service Properties](https://docs.microsoft.com/rest/api/storageservices/set-table-service-properties) (Настройка свойств службы таблиц) и [Get Table Service Properties](https://docs.microsoft.com/rest/api/storageservices/get-table-service-properties) (Получение свойств службы таблиц) | Эта конечная точка используется для настройки правил CORS, конфигурации аналитики хранилища и настроек ведения журналов. В настоящее время CORS не поддерживается, а аналитика и ведение журналов обрабатываются в базе данных Azure Cosmos и в таблицах хранения Azure по-разному. |
| OPTIONS | /\<Таблица-Resource-Name> | [Preflight Table Request](https://docs.microsoft.com/rest/api/storageservices/preflight-table-request) (Предварительные запросы таблиц) | Этот метод является частью CORS и сейчас не поддерживается в Azure Cosmos DB. |
| GET | /?restype=service@comp=stats | [Get Table Service Stats](https://docs.microsoft.com/rest/api/storageservices/get-table-service-stats) (Получение статистики службы таблиц) | Предоставляет сведения о том, как быстро данные копируются между первичными и вторичными базами данных. Этот метод не требуется в Cosmos DB, так как репликация является частью операций записи. |
| GET, PUT | /mytable?comp=acl | [Get Table ACL](https://docs.microsoft.com/rest/api/storageservices/get-table-acl) (Получение ACL таблиц) и [Set Table ACL](https://docs.microsoft.com/rest/api/storageservices/set-table-acl) (Настройка ACL таблиц) | Этот метод получает и устанавливает хранимые политики доступа, используемые для управления подписями коллективного доступа (SAS). Несмотря на то что SAS поддерживается, они настраиваются и управляются по-разному. |

Кроме того, API таблиц Azure Cosmos DB поддерживает только формат JSON, но не ATOM.

Хотя Azure Cosmos DB поддерживает подписанный URL-адрес (SAS), это решение не поддерживает определенные политики, в частности связанные с такими операциями управления, как право создавать таблицы.

Сейчас Azure Cosmos DB не поддерживает некоторые классы и методы, предусмотренные для пакета SDK для .NET.

| Class | Неподдерживаемый метод |
|-------|-------- |
| CloudTableClient | \*ServiceProperties* |
|                  | \*ServiceStats* |
| CloudTable | SetPermissions* |
|            | GetPermissions* |
| TableServiceContext | * (не рекомендуется использовать этот класс) |
| TableServiceEntity | " " |
| TableServiceExtensions | " " |
| TableServiceQuery | " " |

### <a name="how-do-i-provide-feedback-about-the-sdk-or-bugs"></a>Как отправить отзыв о пакете SDK или сообщить об ошибках?

Свой отзыв можно опубликовать на следующих ресурсах:

* [UserVoice](https://feedback.azure.com/forums/263030-azure-cosmos-db)
* [Форум MSDN](https://social.msdn.microsoft.com/Forums/en-US/home?forum=azurecosmosdb)
* [Stack overflow](https://stackoverflow.com/questions/tagged/azure-cosmosdb). Stack Overflow лучше всего подходит, чтобы задать вопросы о программировании. Ваш вопрос должен быть [по теме](https://stackoverflow.com/help/on-topic) и [максимально точным и подробным, чтобы на него можно было ответить по существу](https://stackoverflow.com/help/how-to-ask).

### <a name="what-is-the-connection-string-that-i-need-to-use-to-connect-to-the-table-api"></a>Какую строку подключения необходимо использовать, чтобы подключиться к API таблиц?

Используйте следующую строку подключения:

```
DefaultEndpointsProtocol=https;AccountName=<AccountNamefromCosmos DB;AccountKey=<FromKeysPaneofCosmosDB>;TableEndpoint=https://<AccountName>.table.cosmosdb.azure.com
```

Вы можете получить строку подключения на странице строки подключения на портале Azure.

### <a name="how-do-i-override-the-config-settings-for-the-request-options-in-the-net-sdk-for-the-table-api"></a>Как переопределить параметры конфигурации для параметров запроса в пакете SDK для .NET для API таблиц?

Некоторые параметры обрабатываются методом CreateCloudTableClient, а другие — с помощью app.config в разделе appSettings в клиентском приложении. Сведения о параметрах конфигурации см. в описании [возможностей Azure Cosmos DB](tutorial-develop-table-dotnet.md).

### <a name="are-there-any-changes-for-customers-who-are-using-the-existing-azure-table-storage-sdks"></a>Изменилось ли что-либо для клиентов, использующих существующий пакет SDK для хранилища таблиц Azure?

Отсутствует. Для существующих или новых клиентов, использующих имеющиеся пакеты SDK для хранилища таблиц Azure, никаких изменений не предусмотрено.

### <a name="how-do-i-view-table-data-thats-stored-in-azure-cosmos-db-for-use-with-the-table-api"></a>Как просмотреть данные таблицы, хранящиеся в Azure Cosmos DB, для использования с API таблицы?

Чтобы просмотреть данные, используйте портал Azure. Вы также можете использовать код API таблиц или описанные ниже средства.

### <a name="which-tools-work-with-the-table-api"></a>Какие средства можно использовать для работы с API таблиц?

Вы можете использовать [обозреватель хранилищ Azure](https://docs.microsoft.com/azure/vs-azure-tools-storage-manage-with-storage-explorer).

Средства, которые принимают строку подключения в указанном ранее формате, могут поддерживать API таблиц. Вы можете ознакомиться со списком средств для таблицы в статье [Клиентские инструменты службы хранилища Azure](../storage/common/storage-explorers.md).

### <a name="is-the-concurrency-on-operations-controlled"></a>Контролируется ли параллелизм операций?

Да, оптимистическая блокировка операций обеспечивается за счет использования механизма ETag.

### <a name="is-the-odata-query-model-supported-for-entities"></a>Поддерживается ли для сущностей модель запросов OData?

Да, API таблиц поддерживает запросы OData и LINQ.

### <a name="can-i-connect-to-azure-table-storage-and-azure-cosmos-db-table-api-side-by-side-in-the-same-application"></a>Возможно ли параллельное подключение к хранилищу таблиц Azure и API таблиц Azure Cosmos DB в одном и том же приложении?

Да, подключение возможно, если вы создадите два отдельных экземпляра CloudTableClient, каждый из которых указывает на свой собственный URI в строке подключения.

### <a name="how-do-i-migrate-an-existing-azure-table-storage-application-to-this-offering"></a>Как переместить имеющееся приложение хранилища таблиц Azure в предложение?

[AzCopy](https://docs.microsoft.com/azure/storage/common/storage-use-azcopy) и [средство миграции данных DB Cosmos Azure](import-data.md) поддерживаются.

### <a name="how-is-expansion-of-the-storage-size-done-for-this-service-if-for-example-i-start-with-n-gb-of-data-and-my-data-will-grow-to-1-tb-over-time"></a>Как выполняется расширение объема хранилища для этой службы, если исходный объем данных (например, *n* ГБ) со временем увеличится до 1 ТБ?

Azure Cosmos DB предоставляет неограниченный объем хранилища за счет горизонтального масштабирования. Увеличение объема хранилища осуществляется службой по мере необходимости.

### <a name="how-do-i-monitor-the-table-api-offering"></a>Как выполняется мониторинг API таблиц?

Отслеживать запросы и использование хранилища можно с помощью панели **метрик** API таблиц.

### <a name="how-do-i-calculate-the-throughput-i-require"></a>Как рассчитать необходимую пропускную способность?

Вы можете использовать калькулятор емкости, чтобы рассчитать пропускную способность таблиц, необходимую для выполнения операций. Дополнительные сведения см. на странице [оценки единиц запросов и хранилища данных](https://www.documentdb.com/capacityplanner). Как правило сущность можно показать как JSON-файл, задав значения для операций.

### <a name="can-i-use-the-table-api-sdk-locally-with-the-emulator"></a>Можно ли использовать пакет SDK API таблиц локально с эмулятором?

На данный момент нет.

### <a name="can-my-existing-application-work-with-the-table-api"></a>Совместимо ли мое имеющееся приложение с API таблиц?

Да, поддерживается такой же API.

### <a name="do-i-need-to-migrate-my-existing-azure-table-storage-applications-to-the-sdk-if-i-dont-want-to-use-the-table-api-features"></a>Нужно ли переводить имеющиеся приложения для хранилища таблиц Azure на пакет SDK, если я не планирую использовать возможности API таблиц?

Нет, вы можете создавать и использовать существующие ресурсы хранилища таблиц Azure, не прерывая работу. Но если вы не работаете с API таблиц, вы не сможете воспользоваться преимуществами автоматической индексации, дополнительных способов обеспечения согласованности и глобального распределения.

### <a name="how-do-i-add-replication-of-the-data-in-the-table-api-across-more-than-one-region-of-azure"></a>Как добавить репликацию данных в API таблиц для нескольких регионов Azure?

Можно использовать [глобальные параметры репликации](tutorial-global-distribution-sql-api.md#portal) Azure Cosmos DB портала, чтобы добавить регионы, которые подходят для вашего приложения. Чтобы разработать глобально распределенное приложение, вы также должны добавить приложение, присвоив ключу PreferredLocation значение локального региона. Так вы сможете обеспечить низкую задержку операций чтения.

### <a name="how-do-i-change-the-primary-write-region-for-the-account-in-the-table-api"></a>Как изменить основной регион записи для учетной записи в API таблиц?

Чтобы добавить регион, а затем выполнить отработку отказа в нужный регион, вы можете использовать панель портала глобальной репликации службы Azure Cosmos DB. Инструкции см. в статье [Разработка с использованием Azure Cosmos DB учетных записей в нескольких регионах](high-availability.md).

### <a name="how-do-i-configure-my-preferred-read-regions-for-low-latency-when-i-distribute-my-data"></a>Как настроить предпочитаемые регионы для чтения, чтобы обеспечить низкую задержку при распределении данных?

Чтобы облегчить чтение из локального расположения, используйте ключ PreferredLocation в файле app.config. Если присвоено значение LocationMode, API таблиц вызывает ошибку для существующих приложений. Удалите этот код, так как API таблиц извлекает эти сведения из файла app.config. 

### <a name="how-should-i-think-about-consistency-levels-in-the-table-api"></a>Как принять решение о выборе уровня согласованности в API таблиц?

В Azure Cosmos DB реализованы продуманные компромиссные сочетания показателей согласованности, доступности и задержки. Azure Cosmos DB предлагает разработчикам пять уровней согласованности для API таблиц. Следовательно, вы можете выбрать требуемую модель обеспечения согласованности на уровне таблицы, а также обеспечить поддержку отдельных запросов при обращении к данным. Подключаемый клиент может выбирать уровень согласованности. Вы можете изменить уровень с помощью аргумента consistencyLevel для CreateCloudTableClient.

API таблиц предусматривает операции чтения с низкой задержкой, возможностью чтения ваших собственных записей и ограниченной согласованностью по умолчанию. Дополнительные сведения см. в статье [Настраиваемые уровни согласованности данных в DocumentDB](consistency-levels.md).

По умолчанию хранилище таблиц Azure обеспечивает строгую согласованность в пределах региона и итоговую согласованность в дополнительных расположениях.

### <a name="does-azure-cosmos-db-table-api-offer-more-consistency-levels-than-azure-table-storage"></a>Обеспечивает ли API таблиц DB Cosmos Azure дополнительные уровни согласованности по сравнению с хранилищем таблиц Azure?

Да, см. дополнительные сведения о распределенном характере Azure Cosmos DB в описании [уровней согласованности](consistency-levels.md). Так как уровни согласованности подкреплены гарантийными обязательствами, вы можете больше не беспокоиться об этом.

### <a name="when-global-distribution-is-enabled-how-long-does-it-take-to-replicate-the-data"></a>Сколько времени занимает репликация данных, когда включено глобальное распределение?

Azure Cosmos DB надежно фиксирует данные в локальном регионе, отправляя их в другие регионы за миллисекунды. Такая репликация зависит только от времени кругового пути центра обработки данных. См. дополнительные сведения о [возможностях глобально распределенной службы базы данных Azure Cosmos DB](distribute-data-globally.md).

### <a name="can-the-read-request-consistency-level-be-changed"></a>Можно ли изменить уровень согласованности запросов на чтение?

В Azure Cosmos DB можно указать уровень согласованности на уровне контейнера (в таблице). Пакет SDK для .NET также позволяет указать этот уровень, изменив значение ключа TableConsistencyLevel в файле app.config. Можно выбрать строгую согласованность, согласованность с ограниченным устареванием, согласованность на уровне сеанса, согласованность префиксов или итоговую согласованность. См. дополнительные сведения о [настраиваемых уровнях согласованности данных в Azure Cosmos DB](consistency-levels.md). Основная идея состоит в том, что уровень согласованности для запросов не может быть выше уровня согласованности для таблицы. Например, вы не можете выбрать для таблицы итоговую согласованность, а для запросов — строгую согласованность.

### <a name="how-does-the-table-api-handle-failover-if-a-region-goes-down"></a>Как API таблиц выполняет отработку отказа, если регион становится недоступен?

API таблиц использует глобально распределенную платформу службы Azure Cosmos DB. Чтобы обеспечить нормальную работу приложения при простое центра обработки данных, вам нужно использовать несколько регионов для учетной записи на портале Azure Cosmos DB. См. дополнительные сведения о [разработке с использованием учетных записей Azure Cosmos DB с поддержкой нескольких регионов](high-availability.md). Вы можете задать приоритет регионов. Дополнительные сведения см. в статье [Автоматическая отработка отказа между регионами для обеспечения непрерывности бизнес-процессов в DocumentDB](high-availability.md).

Вы можете не только добавить любое нужное число регионов для учетной записи, но и управлять тем, в какой регион будет выполняться отработка отказа, настроив приоритет для этой процедуры. Чтобы использовать базу данных, вам также нужно предоставить приложение. В это время ваши клиенты смогут работать без простоя. В отличие от других, [последняя версия клиентского пакета SDK для .NET](table-sdk-dotnet.md) автоматически обнаруживает регион. То есть он может определять регион, который стал недоступен, и автоматически выполнять отработку отказа в другой регион.

### <a name="is-the-table-api-enabled-for-backups"></a>Предусмотрена ли в API таблиц поддержка резервных копий?

Да, API таблиц использует платформу службы Azure Cosmos DB для резервного копирования. Резервные копии создаются автоматически. См. дополнительные сведения об [оперативном резервном копировании и восстановлении с помощью Azure Cosmos DB](online-backup-and-restore.md).

### <a name="does-the-table-api-index-all-attributes-of-an-entity-by-default"></a>Индексирует ли API таблиц все атрибуты сущности по умолчанию?

Да, по умолчанию индексируются все атрибуты сущности. Дополнительные сведения см. в разделе [Azure Cosmos DB: политики индексирования](index-policy.md).

### <a name="does-this-mean-i-dont-have-to-create-more-than-one-index-to-satisfy-the-queries"></a>Значит ли это, что мне не нужно создавать несколько индексов для запросов?

Да, API таблиц Azure Cosmos DB обеспечивает автоматическое индексирование всех атрибутов без определения схемы. Таким образом, разработчик может сосредоточиться на приложении, не беспокоясь о создании индексов и управлении ими. Дополнительные сведения см. в разделе [Azure Cosmos DB: политики индексирования](index-policy.md).

### <a name="can-i-change-the-indexing-policy"></a>Можно ли изменить политику индексирования?

Да, вы можете изменить политику индексирования, предоставив определение индекса. Вам нужно правильно закодировать эти параметры, а также экранировать их.

Для пакетов SDK, не предназначенных для .NET, политику индексирования можно установить ​​только на портале в **обозревателе данных**. Перейдите к таблице, которую нужно изменить, выберите **Scale & Settings** (Параметры и масштабирование) -> "Политика индексации", внесите необходимые изменения и нажмите **Сохранить**.

Из пакета SDK для .NET ее можно передать в файле app.config:

```JSON
{
  "indexingMode": "consistent",
  "automatic": true,
  "includedPaths": [
    {
      "path": "/somepath",
      "indexes": [
        {
          "kind": "Range",
          "dataType": "Number",
          "precision": -1
        },
        {
          "kind": "Range",
          "dataType": "String",
          "precision": -1
        }
      ]
    }
  ],
  "excludedPaths":
[
 {
      "path": "/anotherpath"
 }
]
}
```

### <a name="azure-cosmos-db-as-a-platform-seems-to-have-lot-of-capabilities-such-as-sorting-aggregates-hierarchy-and-other-functionality-will-you-be-adding-these-capabilities-to-the-table-api"></a>Azure Cosmos DB как платформа предоставляет разные возможности, включая сортировку, выполнение статистических вычислений, иерархию и пр. Будут ли эти возможности добавлены в API таблиц?

В API таблиц поддерживаются те же функции обработки запросов, что и в хранилище таблиц Azure. Кроме того, эта база данных поддерживает сортировку, выполнение статистических вычислений, геопространственные запросы, иерархию и множество встроенных функций. Дополнительные сведения см. в статье [Запросы SQL для Azure Cosmos DB](how-to-sql-query.md).

### <a name="when-should-i-change-tablethroughput-for-the-table-api"></a>Когда необходимо изменять значение TableThroughput для API таблиц?

Значение TableThroughput следует изменять в следующих случаях:

* При извлечении, преобразовании и загрузке данных или при передаче большого объема данных за короткий промежуток времени.
* Чтобы получить более высокую пропускную способность для контейнера или набора контейнеров в серверной части. Например, вы видите, что используемая пропускная способность превышает подготовленную и выполняется регулирование. Дополнительные сведения см. в статье [Настройка пропускной способности для контейнеров Azure Cosmos](set-throughput.md).

### <a name="can-i-scale-up-or-scale-down-the-throughput-of-my-table-api-table"></a>Возможно ли масштабирование пропускной способности таблицы API таблиц?

Да, для этого вы можете использовать панель масштабирования портала Azure Cosmos DB. См. дополнительные сведения о [настройке пропускной способности](set-throughput.md).

### <a name="is-a-default-tablethroughput-set-for-newly-provisioned-tables"></a>Определяется ли пропускная способность таблицы по умолчанию для новых подготовленных таблиц?

Да, если не переопределить пропускную способность таблицы с помощью файла app.config и не использовать предварительно созданный контейнер в Azure Cosmos DB, служба создаст таблицу с предопределенной пропускной способностью (400).

### <a name="is-there-any-change-of-pricing-for-existing-customers-of-the-azure-table-storage-service"></a>Изменились ли какие-либо цены для клиентов хранилища службы таблиц Azure?

Отсутствует. Цены для существующих клиентов хранилища таблиц Azure не изменились.

### <a name="how-is-the-price-calculated-for-the-table-api"></a>Как рассчитывается стоимость для API таблиц?

Это зависит от заданного значения TableThroughput.

### <a name="how-do-i-handle-any-rate-limiting-on-the-tables-in-table-api-offering"></a>Как обрабатывать ограничение скорости для таблиц в предложении API таблиц?

Если скорость запроса превышает емкость подготовленной пропускной способности для базового контейнера или набора контейнеров, вы получите сообщение об ошибке, а пакет SDK повторит вызов на основе политики повтора.

### <a name="why-do-i-need-to-choose-a-throughput-apart-from-partitionkey-and-rowkey-to-take-advantage-of-the-table-api-offering-of-azure-cosmos-db"></a>Зачем при использовании предложения API таблиц Azure Cosmos DB кроме значений PartitionKey и RowKey нужно выбирать еще и пропускную способность?

Azure Cosmos DB определяет для вашего контейнера пропускную способность по умолчанию, если вы не укажете другое значение в файле app.config или на портале.

Azure Cosmos DB предоставляет гарантии производительности и задержки с верхними границами для операций. Это возможно, если обработчик может применить управление операциями клиента. Настраивая значение TableThroughput, вы гарантированно получаете требуемые показатели пропускной способности и задержки, так как платформа резервирует эту емкость и обеспечивает бесперебойное выполнение операций.

Изменяя спецификации, вы можете гибко управлять пропускной способностью в соответствии со своими потребностями, обеспечивая поддержку сезонности приложений и позволяя минимизировать затраты.

### <a name="azure-table-storage-has-been-inexpensive-for-me-because-i-pay-only-to-store-the-data-and-i-rarely-query-the-azure-cosmos-db-table-api-offering-seems-to-be-charging-me-even-though-i-havent-performed-a-single-transaction-or-stored-anything-can-you-explain"></a>Хранилище таблиц Azure обходится мне недорого, так как я плачу только за хранение данных и редко выполняю запросы. Предложение API таблиц Azure Cosmos DB взимает с меня оплату, несмотря на то, что я не выполняю транзакции и ничего не храню. Можете объяснить, почему это происходит?

Azure Cosmos DB — это глобально распределенная система на основе соглашений об уровне обслуживания, которая гарантирует высокую доступность, низкую задержку и высокую пропускную способность. В отличие от других систем, в Azure Cosmos DB гарантируется зарезервированная пропускная способность. Azure Cosmos DB предоставляет такие запрашиваемые клиентами дополнительные возможности, как вторичные индексы и глобальное распространение.

### <a name="i-never-get-a-quota-full-notification-indicating-that-a-partition-is-full-when-i-ingest-data-into-azure-table-storage-with-the-table-api-i-do-get-this-message-is-this-offering-limiting-me-and-forcing-me-to-change-my-existing-application"></a>При приеме данных в хранилище таблиц Azure мне не приходили уведомления о достижении квоты, информирующие о заполнении секции. А при работе с API таблиц мне пришло такое сообщение. Значит ли это, что предложение связано с определенными ограничениями, и поэтому мне необходимо изменить приложение?

Azure Cosmos DB — это система на основе соглашений об уровне обслуживания, которая предоставляет неограниченные возможности масштабирования, а также гарантирует согласованность, низкую задержку, высокую пропускную способность и доступность. Объем данных и индекс должны быть управляемыми и масштабируемыми, чтобы получить гарантированную производительность уровня "Премиум". Ограничение в 10 ГБ для числа сущностей и элементов на ключ секции требуется для повышения скорости поиска и производительности запросов. Кроме того, для обеспечения достаточной масштабируемости приложения для службы хранилища Azure мы рекомендуем *не* создавать секцию с высокой нагрузкой, чтобы хранить в ней все сведения и выполнять запрос этих данных.

### <a name="so-partitionkey-and-rowkey-are-still-required-with-the-table-api"></a>То есть свойства PartitionKey и RowKey все еще требуются при использовании API таблиц?

Да. Так как контактные зоны API таблиц и пакета SDK для хранилища таблиц Azure аналогичны, ключ секции обеспечивает отличный способ распределения данных. Ключ строки является уникальным в пределах такой секции. Его присутствие обязательно, а значение может быть нулевым, как в пакете SDK уровня "Стандартный". Размер значения RowKey составляет 255 байт, а значения PartitionKey — 1 КБ.

### <a name="what-are-the-error-messages-for-the-table-api"></a>Какими будут сообщения об ошибках в API таблиц?

Хранилище таблиц Azure и API таблиц Azure Cosmos DB Table используют одни и те же пакеты SDK, поэтому большинство ошибок будут одинаковыми.

### <a name="why-do-i-get-throttled-when-i-try-to-create-lot-of-tables-one-after-another-in-the-table-api"></a>Почему при попытке последовательного создания большого числа таблиц в API таблицы выполняется регулирование?

Azure Cosmos DB — это система на основе соглашений об уровне обслуживания, которая гарантирует согласованность, низкую задержку, высокую пропускную способность и доступность. Так как это подготовленная система, она способна резервировать ресурсы, чтобы гарантировать выполнение этих требований. Эта система определяет создание таблиц в быстром режиме и выполняет регулирование. Мы рекомендуем создавать не более пяти таблиц в минуту. Помните, что API таблиц — это подготовленная система. Оплата начисляется с момента подготовки.

## <a name="gremlin-api"></a>API Gremlin

### <a name="for-cnet-development-should-i-use-the-microsoftazuregraphs-package-or-gremlinnet"></a>Можно ли использовать для разработки на C# или .NET пакет Microsoft.Azure.Graphs или Gremlin.NET?

В качестве основных соединителей для службы API Gremlin для Azure Cosmos DB использует драйверы с открытым кодом. Следовательно, рекомендуется использовать [драйверы, поддерживаемые Apache Tinkerpop](https://tinkerpop.apache.org/).

### <a name="how-are-rus-charged-when-running-queries-on-a-graph-database"></a>Как оплачиваются единицы запроса (ЕЗ) при выполнении запросов к базе данных графа?

Все объекты графа (вершины и ребра) описаны в документации JSON, относящейся к серверной части. Так как запрос к Gremlin может одновременно модифицировать несколько объектов графа, стоимость будет зависеть от количества объектов (ребер), обработанных в ходе этого запроса. Точно таким же образом Azure Cosmos DB взаимодействует со всеми API. Дополнительные сведения см. [в разделе единицы запроса в Azure Cosmos DB](request-units.md).

Плата за ЕЗ формируется на основе обрабатываемого, но не результирующего набора данных. Например, если нужно получить одну вершину, но при этом будет затронуто более одного другого объекта, оплата будет учитывать все объекты графа, используемые при вычислении этой вершины.

### <a name="whats-the-maximum-scale-that-a-graph-database-can-have-in-azure-cosmos-db-gremlin-api"></a>Каков максимальный масштаб, который может иметь база данных Graph в Azure Cosmos DB API Gremlin?

Azure Cosmos DB выполняет [горизонтальное секционирование](partition-data.md), чтобы автоматически увеличивать объем хранилища и пропускную способность в соответствии с требованиями. Максимальная пропускная способность и емкость хранилища рабочей нагрузки определяются числом секций, связанных с заданным контейнером. Однако контейнер API Gremlin имеет специальный набор руководств, обеспечивающих правильную работу в масштабе. Дополнительные сведения о секционировании данных и рекомендации см. в статье о [секционировании и масштабировании в Azure Cosmos DB](partition-data.md).

### <a name="how-can-i-protect-against-injection-attacks-using-gremlin-drivers"></a>Как можно защитится от атак путем внедрения кода с помощью драйверов Gremlin?

Большинство драйверов машинного кода Apache Tinkerpop Gremlin позволяют указать словарь параметров для выполнения запроса. См. пример с использованием [Gremlin.Net](https://tinkerpop.apache.org/docs/3.2.7/reference/#gremlin-DotNet) и [Gremlin-Javascript](https://github.com/Azure-Samples/azure-cosmos-db-graph-nodejs-getting-started/blob/master/app.js).

### <a name="why-am-i-getting-the-gremlin-query-compilation-error-unable-to-find-any-method-error"></a>Почему я получаю сообщение "ошибка компиляции запроса Gremlin: не удается найти какой бы то ни было метод"?

API Gremlin для Azure Cosmos DB реализует ряд функций, определенных в Gremlin. Информацию о поддерживаемых шагах и другие дополнительные сведения см. в статье о [поддержке Gremlin](gremlin-support.md).

Лучшее решение — использовать вместо требуемых (основных) функций Gremlin соответствующие функции, которые поддерживаются в Azure Cosmos DB.

### <a name="why-am-i-getting-the-websocketexception-the-server-returned-status-code-200-when-status-code-101-was-expected-error"></a>Почему я получаю "Вебсоккетексцептион: сервер вернул код состояния" 200 ", когда ожидался код состояния" 101 "?

Чаще всего эта ошибка возникает при использовании неправильной конечной точки. Конечная точка, которая возвращает эту ошибку, имеет следующий адрес:

`https:// YOUR_DATABASE_ACCOUNT.documents.azure.com:443/`

Это конечная точка документов для базы данных графа.  Следует использовать правильную конечную точку Gremlin со следующим адресом:

`https://YOUR_DATABASE_ACCOUNT.gremlin.cosmosdb.azure.com:443/`

### <a name="why-am-i-getting-the-requestrateistoolarge-error"></a>Почему я получаю сообщение об ошибке «Рекуестратеистуларже»?

Эта ошибка означает, что выделенного количества единиц запросов (ЕЗ) в секунду недостаточно для обслуживания запроса. Такая ошибка обычно возникает, когда вы выполняете запрос для получения всех вершин:

```
// Query example:
g.V()
```

Такой запрос попытается получить все вершины графа. Следовательно, стоимость такого запроса будет включать как минимум стоимость ЕЗ, требуемых для получения всех вершин. Чтобы такой запрос был выполнен, нужно указать требуемое количество ЕЗ/с.

### <a name="why-do-my-gremlin-driver-connections-get-dropped-eventually"></a>Почему не удается установить подключение драйвера Gremlin?

Подключение Gremlin устанавливается по протоколу WebSocket. Хотя подключение по WebSocket не имеет определенного срока жизни, API Gremlin для Azure Cosmos DB разрывает неактивные подключения через 30 минут ожидания.

### <a name="why-cant-i-use-fluent-api-calls-in-the-native-gremlin-drivers"></a>Почему я не могу использовать вызовы API Fluent в собственных драйверах Gremlin?

Вызовы текучих API пока не поддерживаются API Gremlin для Azure Cosmos DB. Для таких вызовов требуется функция внутреннего форматирования (поддержка байт-кода), которая сейчас недоступна в API Gremlin для Azure Cosmos DB. По этой же причине сейчас не поддерживается и последняя версия драйвера Gremlin-JavaScript.

### <a name="how-can-i-evaluate-the-efficiency-of-my-gremlin-queries"></a>Как можно оценить эффективность запросов Gremlin?

Чтобы получить предварительный план выполнения запроса, можно использовать **ExecutionProfile()** в конце запроса Gremlin, как показано в примере ниже:

**Пример запроса**

```
g.V('mary').out('knows').executionProfile()
```

**Пример выходных данных**

```json
[
  {
    "gremlin": "g.V('mary').out('knows').executionProfile()",
    "totalTime": 8,
    "metrics": [
      {
        "name": "GetVertices",
        "time": 3,
        "annotations": {
          "percentTime": 37.5
        },
        "counts": {
          "resultCount": 1
        }
      },
      {
        "name": "GetEdges",
        "time": 5,
        "annotations": {
          "percentTime": 62.5
        },
        "counts": {
          "resultCount": 0
        },
        "storeOps": [
          {
            "count": 0,
            "size": 0,
            "time": 0.6
          }
        ]
      },
      {
        "name": "GetNeighborVertices",
        "time": 0,
        "annotations": {
          "percentTime": 0
        },
        "counts": {
          "resultCount": 0
        }
      },
      {
        "name": "ProjectOperator",
        "time": 0,
        "annotations": {
          "percentTime": 0
        },
        "counts": {
          "resultCount": 0
        }
      }
    ]
  }
]
```

Выходные данные указанного выше профиля показывают, сколько времени затрачено на получение объектов вершин, пограничных объектов и размера рабочего набора данных. На основе этих значений и формируется стоимость запросов Azure Cosmos DB.

[azure-portal]: https://portal.azure.com
[query]: sql-api-sql-query.md
