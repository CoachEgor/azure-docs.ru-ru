---
title: Секционирование и горизонтальное масштабирование в Azure Cosmos DB
description: Узнайте, как работает секционирование в Azure Cosmos DB, как настроить секционирование и ключи секций, а также как выбрать правильный ключ секции для приложения.
author: markjbrown
ms.author: mjbrown
ms.service: cosmos-db
ms.topic: conceptual
ms.date: 08/01/2019
ms.openlocfilehash: cbd171e10cc1a8b27de98d9d4d779f345ac5a3ed
ms.sourcegitcommit: 8074f482fcd1f61442b3b8101f153adb52cf35c9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/22/2019
ms.locfileid: "72754910"
---
# <a name="partitioning-and-horizontal-scaling-in-azure-cosmos-db"></a>Секционирование и горизонтальное масштабирование в Azure Cosmos DB

В этой статье объясняются физические и логические секции в Azure Cosmos DB. Здесь также обсуждаются рекомендации по масштабированию и секционированию. 

## <a name="logical-partitions"></a>Логические секции

Логическая Секция состоит из набора элементов, имеющих один и тот же ключ секции. Например, в контейнере, в котором все элементы содержат свойство `City`, можно использовать `City` в качестве ключа секции для контейнера. Группы элементов, имеющие определенные значения для `City`, такие как `London`, `Paris` и `NYC`, образуют разные логические разделы. Не нужно беспокоиться об удалении секции при удалении базовых данных.

В Azure Cosmos DB контейнер — это фундаментальная единица масштабируемости. Данные, добавляемые в контейнер и пропускную способность, которые вы настроили в контейнере, автоматически (горизонтально) секционированы по набору логических секций. Данные и пропускная способность секционированы на основе ключа секции, указанного для контейнера Azure Cosmos. Дополнительные сведения см. в статье [Создание контейнера Azure Cosmos](how-to-create-container.md).

Логическая Секция также определяет область транзакций базы данных. Элементы в логической секции можно обновить с помощью [транзакции с изоляцией моментальных снимков](database-transactions-optimistic-concurrency.md). При добавлении новых элементов в контейнер новые логические секции прозрачно создаются системой.

## <a name="physical-partitions"></a>Физические секции

Контейнер Azure Cosmos масштабируется путем распределения данных и пропускной способности по большому числу логических секций. На внутреннем уровне одна или несколько логических секций сопоставлены с физической секцией, состоящей из набора реплик, которые также называются [*набором реплик*](global-dist-under-the-hood.md). На каждом наборе реплик размещен экземпляр ядра СУБД Azure Cosmos. Набор реплик делает данные, хранящиеся в физическом разделе, устойчивой, высокой доступностью и целостными. Физический раздел поддерживает максимальный объем хранилища и единиц запросов (RUs). Каждая реплика, составляющая физическую секцию, наследует квоту хранилища секции. Все реплики физической секции совокупно поддерживают пропускную способность, выделенную для физической секции. 

На следующем рисунке показано, как логические секции сопоставляются с физическими, которые распределяются глобально:

![Изображение, демонстрирующее Azure Cosmos DB секционирования](./media/partition-data/logical-partitions.png)

Пропускная способность, подготовленная для контейнера, распределяется равномерно между физическими секциями. Структура ключа секции, которая равномерно распределяет запросы пропускной способности, может создавать "горячий" секции. Использование критических секций может привести к ограничению скорости и неэффективному использованию подготовленной пропускной способности и более высоких затрат.

В отличие от логических, физические секции являются внутренней реализацией системы. Нельзя управлять размером, размещением или количеством физических секций, а также управлять сопоставлением между логическими и физическими секциями. Однако можно управлять числом логических секций и распределением данных, рабочей нагрузки и пропускной способности, [выбрав правильный ключ логической секции](partitioning-overview.md#choose-partitionkey).

## <a name="next-steps"></a>Дальнейшие действия

* Узнайте [, как выбрать ключ секции](partitioning-overview.md#choose-partitionkey).
* Дополнительные сведения о подготовленной пропускной способности в базе данных Azure Cosmos DB см. в [этой статье](request-units.md).
* Дополнительные сведения о глобальном распределении в базе данных Azure Cosmos DB см. в [этой статье](distribute-data-globally.md).
* Подробнее о [подготовке пропускной способности для контейнера Azure Cosmos](how-to-provision-container-throughput.md).
* Подробнее о [подготовке пропускной способности для базы данных Azure Cosmos](how-to-provision-database-throughput.md).
