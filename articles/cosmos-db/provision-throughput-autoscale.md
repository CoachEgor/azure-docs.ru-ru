---
title: Создание контейнеров и баз данных Azure Cosmos в режиме автомасштабирования.
description: Узнайте о преимуществах, вариантах использования и подготовке баз данных и контейнеров Azure Cosmos в режиме автомасштабирования.
author: kirillg
ms.author: kirillg
ms.service: cosmos-db
ms.topic: conceptual
ms.date: 04/28/2020
ms.openlocfilehash: 49fea2cc9a48d5afc794d6932208b61252bea424
ms.sourcegitcommit: 849bb1729b89d075eed579aa36395bf4d29f3bd9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2020
ms.locfileid: "82196495"
---
# <a name="create-azure-cosmos-containers-and-databases-in-autoscale-mode"></a>Создание контейнеров и баз данных Azure Cosmos в режиме автомасштабирования

Azure Cosmos DB позволяет подготавливать пропускную способность для контейнеров в ручном или режиме автомасштабирования. В этой статье описываются преимущества и варианты использования режима автомасштабирования.

> [!NOTE]
> [Автомасштабирование можно включить только для новых баз данных и контейнеров](#create-db-container-autoscale) . Он недоступен для существующих контейнеров и баз данных.

Кроме ручной подготовки пропускной способности, теперь можно настроить контейнеры Cosmos для Azure в режиме автомасштабирования. Контейнеры и базы данных, настроенные в режиме автомасштабирования, **автоматически и мгновенно масштабируют подготовленную пропускную способность в зависимости от потребностей вашего приложения, не влияя на доступность, задержку, пропускную способность или производительность рабочей нагрузки.**

При настройке контейнеров и баз данных в режиме автомасштабирования необходимо указать максимальную пропускную способность `Tmax` , которую не следует превысить. Контейнеры могут масштабировать пропускную способность `0.1*Tmax < T < Tmax`, чтобы. Другими словами, контейнеры и базы данных мгновенно масштабируются в зависимости от потребностей рабочей нагрузки, начиная с 10% от максимального значения максимальной пропускной способности, настроенного до заданного максимального значения пропускной способности. После настройки автомасштабирования можно изменить значение параметра Максимальная пропускная`Tmax`способность () для базы данных или контейнера в любой момент времени. При использовании параметра автомасштабирования Минимальная пропускная способность (400 единиц запросов/с) для контейнера или базы данных больше не применяется.

Для указанной максимальной пропускной способности контейнера или базы данных система допускает работу в пределах рассчитанного предела хранилища. Если превышено ограничение хранилища, максимальная пропускная способность автоматически корректируется до более высокого значения. При использовании пропускной способности уровня базы данных с режимом автомасштабирования количество контейнеров, допустимых в базе данных `0.001*TMax`, вычисляется следующим образом:. Например, если подготавливается ЕДИНИЦа автомасштабирования 20 000, то база данных может иметь 20 контейнеров.

## <a name="benefits-of-autoscale-mode"></a><a id="autoscale-benefits"></a>Преимущества режима автомасштабирования

Контейнеры Azure Cosmos, настроенные в режиме автомасштабирования, имеют следующие преимущества.

* **Простой:** Контейнеры в режиме автомасштабирования удаляют сложность управления подготовленной пропускной способностью (RUs) и емкостью вручную для различных контейнеров.

* **Масштабируемая:** Контейнеры в режиме автомасштабирования эффективно масштабируют подготовленную пропускную способность по мере необходимости. Не существует сбоев клиентских подключений, приложений, и они не влияют на существующие соглашения об уровне обслуживания.

* Экономичность **:** При использовании контейнеров, настроенных в режиме автомасштабирования, вы платите только за те ресурсы, которые нужны вашей рабочей нагрузке для каждого часа.

* **Высокий уровень доступности:** Контейнеры в режиме автомасштабирования используют ту же глобально распределенную, отказоустойчивую, высокодоступную серверную часть, обеспечивающую устойчивость данных и высокий уровень доступности.

## <a name="use-cases-of-autoscale-mode"></a><a id="autoscale-usecases"></a>Варианты использования режима автомасштабирования

Варианты использования для контейнеров Azure Cosmos, настроенных в режиме автомасштабирования, включают:

* **Рабочие нагрузки переменных:** Если вы используете незанятое приложение с пиковым потреблением в 1 час на несколько часов каждый день или несколько раз в год. К примерам относятся приложения для отделов кадров, бюджетирования и оперативной отчетности. В таких случаях можно использовать контейнеры, настроенные в режиме автомасштабирования, и вам больше не нужно вручную подготавливать пиковую или среднюю емкость.

* **Непредсказуемые рабочие нагрузки:** При работе с рабочими нагрузками, в которых используется база данных в течение дня, а также пиковые нагрузки действий, которые трудно прогнозировать. Пример включает сайт трафика, который видит всплеск активности при изменении прогноза погоды. Контейнеры, настроенные в режиме автомасштабирования, позволяют настроить емкость в соответствии с потребностями пиковой нагрузки приложения и возможного увеличения масштаба при превышении предельного напряжения.

* **Новые приложения:** Если вы развертываете новое приложение и не знаете, какой объем подготовленной пропускной способности (т. е. Сколько нужно), необходимо. С помощью контейнеров, настроенных в режиме автомасштабирования, можно автоматически масштабироваться по требованиям к емкости и требованиям приложения.

* **Редко используемые приложения:** Если у вас есть приложение, которое используется только в течение нескольких часов в день или неделю или месяц, например на небольшое приложение, веб-сайт или блог.

* **Базы данных для разработки и тестирования:** Если разработчики используют контейнеры в рабочее время, но они не нужны в ночей или выходных. Если контейнеры настроены в режиме автомасштабирования, они масштабируются до минимума, если они не используются.

* **Запланированные рабочие нагрузки и запросы:** Если у вас есть несколько запланированных запросов, операций или запросов в одном контейнере, и если имеются периоды бездействия, в которых вы хотите запускать с низкой пропускной способностью, вы можете сделать это легко. При отправке запланированного запроса или запроса в контейнер, настроенный в режиме автомасштабирования, он автоматически масштабируется по мере необходимости и выполняет операцию.

Решения для предыдущих проблем не только требовали огромного количества времени в реализации, но и представляют сложность в настройке или коде, и для их устранения часто требуется вмешательство вручную. Режим автомасштабирования позволяет использовать приведенные выше сценарии, поэтому больше не нужно беспокоиться об этих проблемах.

## <a name="comparison--containers-configured-in-manual-mode-vs-autoscale-mode"></a>Сравнение — контейнеры, настроенные в режиме ручной и автомасштабирования

|  | Контейнеры, настроенные в ручном режиме  | Контейнеры, настроенные в режиме автомасштабирования |
|---------|---------|---------|
| **Подготовленная пропускная способность** | Подготовка вручную. | Автоматическое и мгновенное масштабирование на основе шаблонов использования рабочих нагрузок. |
| **Ограничение скорости запросов и операций (429)**  | Может произойти, если потребление превышает подготовленную емкость. | Не произойдет, если Потребляемая пропускная способность находится в пределах максимальной пропускной способности, выбранной в режиме автомасштабирования.   |
| **Планирование ресурсов** |  Необходимо выполнить начальное планирование ресурсов и обеспечить необходимую пропускную способность. |    Вам не нужно беспокоиться о планировании ресурсов. Система автоматически предпринимает меры по планированию ресурсов и управлению емкостью. |
| **Цены** | Количество единиц запросов в час, подготовленных вручную:. | Для учетных записей с одним регионом записи вы платите за пропускную способность, используемую на почасовой основе, используя Автомасштабирование единиц запросов в час. <br/><br/>Для учетных записей с несколькими регионами записи дополнительная плата за Автомасштабирование не взимается. Вы платите за пропускную способность, используемую в каждый час, используя один и тот же тариф с несколькими хозяевами запросов в час. |
| **Лучше всего подходит для типов рабочих нагрузок** |  Прогнозируемые и стабильные рабочие нагрузки|   Непредсказуемые и переменные рабочие нагрузки  |

## <a name="create-a-database-or-a-container-with-autoscale-mode"></a><a id="create-db-container-autoscale"></a>Создание базы данных или контейнера с режимом автомасштабирования

Вы можете настроить Автомасштабирование для новых баз данных или контейнеров при их создании с помощью портал Azure. Выполните следующие действия, чтобы создать новую базу данных или контейнер, включить Автомасштабирование и указать максимальную пропускную способность (единиц запросов в секунду).

1. Войдите в [портал Azure](https://portal.azure.com) или [Обозреватель Azure Cosmos DB.](https://cosmos.azure.com/)

1. Перейдите к учетной записи Azure Cosmos DB и откройте вкладку **Обозреватель данных** .

1. Выберите **создать контейнер.** Введите имя базы данных, контейнера и ключа секции. В разделе **пропускная способность**выберите параметр **Автомасштабирование** и укажите максимальную пропускную способность (единиц запросов/с), которую база данных или контейнер не может превысить при использовании параметра автомасштабирования.

   ![Создание контейнера и настройка пропускной способности автомасштабирования](./media/provision-throughput-autoscale/create-container-autoscale-mode.png)

1. Щелкните **ОК**.

Вы можете создать базу данных с общей пропускной способностью с помощью режима автомасштабирования, выбрав параметр **предоставить необходимую пропускную способность базы данных** .

## <a name="throughput-and-storage-limits-for-autoscale"></a><a id="autoscale-limits"></a>Ограничения пропускной способности и хранилища для автомасштабирования

В следующей таблице показаны максимальные ограничения по всему хранилищу и размерам хранилища для различных параметров в режиме автомасштабирования:

|Ограничение максимальной пропускной способности  |Максимальный предел хранилища  |
|---------|---------|
|4000 единиц запросов в секунду  |   50 ГБ    |
|20 000 единиц запросов в секунду  |  200 ГБ  |
|100 000 единиц запросов в секунду    |  1 TБ   |
|500 000 единиц запросов в секунду    |  5 ТБ  |

## <a name="next-steps"></a>Дальнейшие действия

* Ознакомьтесь с [часто задаваемыми вопросами об автомасштабировании](autoscale-faq.md).
* Дополнительные сведения о [логических секциях](partition-data.md).
* Подробнее о [подготовке пропускной способности для контейнера Azure Cosmos](how-to-provision-container-throughput.md).
* Подробнее о [подготовке пропускной способности для базы данных Azure Cosmos](how-to-provision-database-throughput.md).
