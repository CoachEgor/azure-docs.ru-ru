---
title: Часто задаваемые вопросы на API Azure Cosmos DB для Cassandra.
description: Получите ответы на часто задаваемые вопросы о API API Azure Cosmos DB для Cassandra.
author: TheovanKraay
ms.service: cosmos-db
ms.topic: conceptual
ms.date: 04/09/2020
ms.author: thvankra
ms.openlocfilehash: 416f0c5f995a101298e84c81317c7d39fb5d43f8
ms.sourcegitcommit: acb82fc770128234f2e9222939826e3ade3a2a28
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/21/2020
ms.locfileid: "81727389"
---
# <a name="frequently-asked-questions-about-the-azure-cosmos-db-api-for-cassandra"></a>Часто задаваемые вопросы о API API Azure Cosmos DB для Cassandra

## <a name="what-are-some-key-differences-between-apache-cassandra-and-cassandra-api"></a>Каковы некоторые ключевые различия между Apache Cassandra и Cassandra API?

- Apache Cassandra рекомендует ограничение в 100 МБ по размеру ключа перегородки. Cassandra API позволяет до 10 ГБ на раздел.
- Apache Cassandra позволяет отключить прочные коммиты - т.е. пропустить запись в журнал коммитов и перейти непосредственно к Memtable (ы). Это может привести к потере данных, если узла спустить до того, как Memtables будет смыт в SStables на диске. Cosmos DB всегда выполняет длительные коммиты, поэтому у вас никогда не будет потери данных.
- Apache Cassandra может увидеть снижение производительности, если рабочая нагрузка включает в себя много заменяет и / или удаляет. Причиной этого является надгробия, которые считываемые рабочие нагрузки необходимо пропустить, чтобы получить последние данные. Cassandra API не будет видеть снижение производительности чтения, когда рабочая нагрузка имеет много заменяет и / или удаляет.
- Во время сценариев высокой замены рабочей нагрузки уплотнение должно быть запущено для слияния SSTables на диске (слияние необходимо, потому что записи Apache Cassandra являются только придатками, таким образом, несколько обновлений хранятся как отдельные записи SSTable, которые необходимо периодически объединять). Это также может привести к снижению производительности чтения во время уплотнения. Этого не происходит в API Cassandra, поскольку он не реализует уплотнение.
- Установка коэффициента репликации 1 возможна с помощью Apache Cassandra. Однако это приводит к низкой доступности, если единственный узла с данными выходит из системы. Это не проблема с Azure Cosmos DB Cassandra API, потому что всегда есть коэффициент репликации 4 (кворум 3).
- Добавление/удаление узлов в Apache Cassandra требует большого ручного вмешательства, но также и высокого процессора на новом узло, в то время как существующие узлы перемещают некоторые из своих диапазонов маркеров в новый узло. Это то же самое при выводе из эксплуатации существующего узла. Тем не менее, масштабирование осуществляется без проблем под капотом в Azure Cosmos DB Cassandra API, без каких-либо проблем, наблюдаемых в сервисе/приложении.
- Нет необходимости устанавливать num_tokens на каждом уде в кластере, как в Apache Cassandra. Зоны узлов и токенов полностью управляются Cosmos DB.
- Azure Cosmos DB Cassandra API полностью управляется, поэтому вам не требуются команды узла, такие как ремонт, вывод из эксплуатации и т.д., которые используются в Apache Cassandra.

## <a name="other-frequently-asked-questions"></a>Другие часто задаваемые вопросы

### <a name="what-is-the-protocol-version-supported-by-azure-cosmos-db-cassandra-api-is-there-a-plan-to-support-other-protocols"></a>Какова версия протокола, поддерживаемая Azure Cosmos DB Cassandra API? Планируется ли поддержка других протоколов?

Azure Cosmos DB Cassandra API поддерживает версию 3.x. Это совместимость с C'L основана на общедоступном [репозитории Apache Cassandra GitHub.](https://github.com/apache/cassandra/blob/trunk/doc/cql3/CQL.textile) Если у вас есть отзыв, связанный с реализацией поддержки других протоколов, свяжитесь с нами через форму обратной связи на форуме [UserVoice](https://feedback.azure.com/forums/263030-azure-cosmos-db) или отправьте сообщение по адресу [askcosmosdbcassandra@microsoft.com](mailto:askcosmosdbcassandra@microsoft.com).

### <a name="why-is-choosing-a-throughput-for-a-table-a-requirement"></a>Зачем необходимо выбирать пропускную способность для таблицы?

Azure Cosmos DB устанавливает пропускную способность по умолчанию для вашего контейнера на основе того, где вы создаете таблицу (на портале или CQL).
Azure Cosmos DB предоставляет гарантии производительности и задержки с верхними границами для операций. Это возможно, если обработчик может применить управление операциями клиента. Настраивая значение пропускной способности, вы гарантированно получаете требуемые показатели пропускной способности и задержки, так как платформа резервирует эту емкость и обеспечивает бесперебойное выполнение операций.
Вы можете [упруго менять пропускную способность,](manage-scale-cassandra.md) чтобы извлечь выгоду из сезонности приложения и сэкономить затраты.

Концепция пропускной способности подробно описана в статье [Единицы запросов в базе данных Azure Cosmos DB](request-units.md). Пропускная способность для таблицы равномерно распределяется между базовыми физическими секциями.

### <a name="what-is-the-default-rus-of-table-when-created-through-cql-what-if-i-need-to-change-it"></a>Что представляет собой показатель "единицы запросов в секунду" по умолчанию при создании таблицы с помощью CQL? Что делать, если требуется ее изменить?

Azure Cosmos DB использует единицы запросов в секунду (ЕЗ) в качестве валюты для обеспечения пропускной способности. Таблицы, созданные с помощью CQL, содержат 400 ЕЗ. Количество ЕЗ можно изменить на портале.

CQL

```shell
CREATE TABLE keyspaceName.tablename (user_id int PRIMARY KEY, lastname text) WITH cosmosdb_provisioned_throughput=1200
```

.NET

```csharp
int provisionedThroughput = 400;
var simpleStatement = new SimpleStatement($"CREATE TABLE {keyspaceName}.{tableName} (user_id int PRIMARY KEY, lastname text)");
var outgoingPayload = new Dictionary<string, byte[]>();
outgoingPayload["cosmosdb_provisioned_throughput"] = Encoding.UTF8.GetBytes(provisionedThroughput.ToString());
simpleStatement.SetOutgoingPayload(outgoingPayload);
```

### <a name="what-happens-when-throughput-is-used-up"></a>Что происходит, когда достигается предел пропускной способности?

Azure Cosmos DB предоставляет гарантии производительности и задержки с верхними границами для операций. Это возможно, если обработчик может применить управление операциями клиента. Это возможно благодаря настройке значения пропускной способности, что гарантирует получение требуемых показателей пропускной способности и задержки, так как платформа резервирует эту емкость и обеспечивает бесперебойное выполнение операций.
При превышения значения емкости вы получаете сообщение об ошибке перегрузки, информирующее о том, что емкость превышена.
0x1001 перегрузка: не удается обработать запрос из-за "высокой частоты запросов". На этом этапе очень важно увидеть, какие операции и тома вызывают эту проблему. Метрики на портале помогут вам понять, что потребляемая емкость подымается выше подготовленной. Затем нужно обеспечить, чтобы емкость во всех базовых секциях потреблялась практически одинаково. Если очевидно, что большая часть пропускной способности используется в одной секции, необходимо снизить рабочую нагрузку.

Доступны метрики, показывающие использование пропускной способности за несколько часов, дней и за неделю в секциях или в совокупности. Дополнительные сведения см. в статье [Мониторинг и отладка с помощью метрик в Azure Cosmos DB](use-metrics.md).

Сведения о журналах диагностики приведены в статье [Журнал ведения диагностики Azure Cosmos DB](logging.md).

### <a name="does-the-primary-key-map-to-the-partition-key-concept-of-azure-cosmos-db"></a>Вписывается ли первичный ключ в концепцию ключа секции в Azure Cosmos DB?

Да. Ключ секции используется для размещения сущности в надлежащем расположении. В Azure Cosmos DB он используется для поиска правильного логического раздела, хранящегося в физическом разделе. Концепция секционирования подробно описана в статье [Секционирование и масштабирование в Azure Cosmos DB](partition-data.md). Из этого следует, что размер логического раздела сейчас не должен превышать ограничение в 10 ГБ.

### <a name="what-happens-when-i-get-a-quota-full-notification-indicating-that-a-partition-is-full"></a>Что происходит при получении уведомления о достижении квоты, информирующего о заполнении секции?

Azure Cosmos DB — это система на основе соглашений об уровне обслуживания, которая предоставляет неограниченные возможности масштабирования, а также гарантирует согласованность, низкую задержку, высокую пропускную способность и доступность. Это неограниченное хранилище основано на горизонтальном масштабировании данных, в котором секционирование используется как ключевая концепция. Концепция секционирования подробно описана в статье [Секционирование и масштабирование в Azure Cosmos DB](partition-data.md).

Необходимо придерживаться ограничения в 10 ГБ на число сущностей или количество элементов на логической секции. Кроме того, для обеспечения достаточной масштабируемости приложения мы рекомендуем *не* создавать секцию с высокой нагрузкой, чтобы хранить в ней все сведения и выполнять запрос этих данных. Эта ошибка может возникнуть только при дисбалансе в распределении данных, то есть у вас в одном ключе секции находится большой объем данных (более 10&nbsp;ГБ). Вы можете найти распределение данных, используя портал хранилища. Чтобы устранить эту ошибку, необходимо повторно создать таблицу и выбрать управляемый первичный ключ (ключ секции), благодаря чему можно эффективнее распределить данные.

### <a name="is-it-possible-to-use-cassandra-api-as-key-value-store-with-millions-or-billions-of-individual-partition-keys"></a>Можно ли использовать API Cassandra в качестве хранилища пар "ключ — значение" с миллионами или миллиардами отдельных ключей секций?

За счет масштабирования хранилища в Azure Cosmos DB можно хранить неограниченный объем данных. Это не зависит от пропускной способности. Да. Вы всегда можете использовать API Cassandra для хранения и извлечения пар "ключ — значение", указав правильный первичный ключ или ключ секции. Эти отдельные ключи получают собственную логическую секцию и без проблем располагаются поверх физической секции.

### <a name="is-it-possible-to-create-more-than-one-table-with-apache-cassandra-api-of-azure-cosmos-db"></a>Возможно ли создать несколько таблиц с помощью API Apache Cassandra для Azure Cosmos DB?

Да, с помощью API Apache Cassandra можно создать несколько таблиц. Каждая из этих таблиц считается единицей измерения для пропускной способности и хранилища.

### <a name="is-it-possible-to-create-more-than-one-table-in-succession"></a>Можно ли последовательно создать несколько таблиц?

Azure Cosmos DB — это система, управляемая ресурсами, как для операций с данными, так и для действий уровня управления. Контейнеры, такие как коллекции и таблицы, — это сущности среды выполнения, подготовленные для определенной пропускной способности. Быстрое создание этих контейнеров не предусмотрено и регулируется. Если вы используете тесты, которые немедленно удаляют или создают таблицы, попробуйте их исключить.

### <a name="what-is-maximum-number-of-tables-that-can-be-created"></a>Какое максимальное число таблиц можно создать?

Там нет физического ограничения на количество таблиц, [askcosmosdbcassandra@microsoft.com](mailto:askcosmosdbcassandra@microsoft.com) отправить по электронной почте, если у вас есть большое количество таблиц (где общий устойчивый размер идет более 10 ТБ данных), которые должны быть созданы из обычных 10s или 100s.

### <a name="what-is-the-maximum--of-keyspace-that-we-can-create"></a>Какое максимальное число ключевых пространств можно создать?

Там нет физического ограничения на количество ключевых пространств, как они метаданных контейнеров, отправить по электронной почте, [askcosmosdbcassandra@microsoft.com](mailto:askcosmosdbcassandra@microsoft.com) если у вас есть большое количество ключевых пространств по некоторым причинам.

### <a name="is-it-possible-to-bring-in-lot-of-data-after-starting-from-normal-table"></a>Можно ли добавить большое количество данных после начала работы с обычной таблицей?

Да, если предположить равномерно распределенные разделы, емкость хранилища автоматически управляется и увеличивается по мере нажатия большего количества данных. Поэтому вы можете, среди прочего, уверенно импортировать нужный объем данных без подготовки узлов и управления ими. Однако, если вы ожидаете много немедленного роста данных, имеет смысл непосредственно [обеспечить ожидаемую пропускную силу,](set-throughput.md) а не начинать ниже и увеличивать ее немедленно.

### <a name="is-it-possible-to-supply-yaml-file-settings-to-configure-apache-casssandra-api-of-azure-cosmos-db-behavior"></a>Возможно ли предоставить параметры файла yaml для настройки API Apache Cassandra, чтобы изменить поведение Azure Cosmos DB?

API Apache Cassandra для Azure Cosmos DB — это служба платформы. Она предоставляет совместимость на уровне протокола для выполнения операций, а также упрощает управление, мониторинг и конфигурацию. Разработчику и пользователю не нужно беспокоиться о доступности, отметках полного удаления, кэше ключей, кэше строк, фильтрах Блума и множестве других настроек. API Apache Cassandra для Azure Cosmos DB ориентирован на обеспечение требуемой производительности операций чтения и записи без увеличения затрат на конфигурацию и управление.

### <a name="will-apache-cassandra-api-for-azure-cosmos-db-support-node-additioncluster-statusnode-status-commands"></a>Будет ли API Apache Cassandra для Azure Cosmos DB поддерживать команды добавления узла, состояния кластера и состояния узла?

API Apache Cassandra — это платформа, обеспечивающая простое планирование производительности и отвечающая требованиям к эластичности, требуемой для достижения высокой пропускной способности и хранения. С помощью Azure Cosmos DB можно обеспечить требуемую пропускную способность. Затем можно увеличивать и уменьшать масштаб множество раз в течение дня, не беспокоясь о добавлении узлов, их удалении и управлении ими. Это означает, что использовать узел и средство управления кластером не нужно.

### <a name="what-happens-with-respect-to-various-config-settings-for-keyspace-creation-like-simplenetwork"></a>Что происходит с различными настройками конфигурации (например, простая сеть) для создания пространств ключей?

Azure Cosmos DB обеспечивает готовое глобальное распределение для обеспечения высокой доступности и низкой задержки. Настройки реплики (как и многого другого) не требуется. Все записи всегда прочно кворум совершенных в любом регионе, где вы пишете, обеспечивая при этом гарантии производительности.

### <a name="what-happens-with-respect-to-various-settings-for-table-metadata-like-bloom-filter-caching-read-repair-change-gc_grace-compression-memtable_flush_period-and-more"></a>Что происходит с различными настройками метаданных таблицы, такими как фильтры Блума, кэширование, изменение разрешения конфликтов при чтении, gc_grace, сжатие memtable_flush_period и другими?

Azure Cosmos DB обеспечивает высокую производительность операций чтения и записи и пропускную способность без необходимости настраивать какие-либо параметры конфигурации и риска их случайного изменения.

### <a name="is-time-to-live-ttl-supported-for-cassandra-tables"></a>Поддерживается ли срок жизни (TTL) для таблиц Cassandra?

Да, TTL поддерживается.

### <a name="is-it-possible-to-monitor-node-status-replica-status-gc-and-os-parameters-earlier-with-various-tools-what-needs-to-be-monitored-now"></a>Возможно ли контролировать состояние узла, состояние реплики, сборку мусора и параметры ОС ранее с помощью различных средств? Что нужно отслеживать сейчас?

Служба платформы Azure Cosmos DB помогает повысить производительность и не беспокоиться об управлении инфраструктурой и ее мониторинге. Следует позаботиться о пропускной способности, которая доступна в метриках портала, если выполняется регулировка и увеличивается или уменьшается пропускная способность.
Отслеживайте [соглашения об уровне обслуживания](monitor-accounts.md).
Используйте [метрики](use-metrics.md) и [журналы диагностики](logging.md).

### <a name="which-client-sdks-can-work-with-apache-cassandra-api-of-azure-cosmos-db"></a>Какие клиентские пакеты SDK можно использовать для работы с Apache Cassandra API для Azure Cosmos DB?

Драйверы клиентов Apache Cassandra SDK, которые используют C'Lv3, использовались для клиентских программ. Если у вас есть другие драйверы, которые вы [askcosmosdbcassandra@microsoft.com](mailto:askcosmosdbcassandra@microsoft.com)используете, или если у вас возникли проблемы, отправьте почту.

### <a name="is-composite-partition-key-supported"></a>Поддерживается ли составной ключ секции?

Да, можно использовать обычный синтаксис для создания составного ключа секции.

### <a name="can-i-use-sstableloader-for-data-loading"></a>Могу ли я использовать sstableloader для загрузки данных?

Нет, sstableloader не поддерживается.

### <a name="can-an-on-premises-apache-cassandra-cluster-be-paired-with-azure-cosmos-dbs-cassandra-api"></a>Можно ли в паре с api PiPI Cassandra компании Apache Cassandra в паре с API Cassandra компании Azure Cosmos DB?

На данный момент Azure Cosmos DB оптимизирована для работы с облачной средой без дополнительных расходов на операции. Если вам требуется сопряжение, отправьте почту [askcosmosdbcassandra@microsoft.com](mailto:askcosmosdbcassandra@microsoft.com) с описанием вашего сценария. Мы работаем над предложением, чтобы помочь сгруппировать на месте / различных облако Кассандра кластера Cosomos DB в Кассандра API.

### <a name="does-cassandra-api-provide-full-backups"></a>Предоставляет ли API Cassandra полные резервные копии?

Azure Cosmos DB предоставляет две бесплатные полные резервные копии, которые создаются каждые четыре часа во всех API. Благодаря этому вам не нужно настраивать расписание резервного копирования и выполнять другие действия.
Если вы хотите изменить удержание и [askcosmosdbcassandra@microsoft.com](mailto:askcosmosdbcassandra@microsoft.com) частоту, отправьте электронное письмо или поднимите дело поддержки. Сведения о возможности резервного копирования см. в статье [Автоматическая оперативная архивация и восстановление с помощью Azure Cosmos DB](../synapse-analytics/sql-data-warehouse/backup-and-restore.md).

### <a name="how-does-the-cassandra-api-account-handle-failover-if-a-region-goes-down"></a>Как в учетной записи Cassandra API выполняется отработка отказа, если регион становится недоступен?

Cassandra API для Azure Cosmos DB использует глобально распределенную платформу Azure Cosmos DB. Чтобы обеспечить нормальную работу приложения при простое центра обработки данных, вам нужно использовать несколько регионов для учетной записи на портале Azure Cosmos DB. См. дополнительные сведения о [разработке с использованием учетных записей Azure Cosmos DB с поддержкой нескольких регионов](high-availability.md). Вы можете задать приоритет регионов. Дополнительные сведения см. в статье [Автоматическая отработка отказа между регионами для обеспечения непрерывности бизнес-процессов в DocumentDB](high-availability.md).

Вы можете не только добавить любое нужное число регионов для учетной записи, но и управлять тем, в какой регион будет выполняться отработка отказа, настроив приоритет для этой процедуры. Чтобы использовать базу данных, вам также нужно предоставить приложение. В это время ваши клиенты смогут работать без простоя.

### <a name="does-the-apache-cassandra-api-index-all-attributes-of-an-entity-by-default"></a>Индексирует ли Apache Cassandra API все атрибуты сущности по умолчанию?

Нет. Cassandra API поддерживает [вторичные индексы,](cassandra-secondary-index.md)которые ведут себя очень похоже на Apache Cassandra. Он не индексировать каждый атрибут по умолчанию.  


### <a name="can-i-use-the-new-cassandra-api-sdk-locally-with-the-emulator"></a>Можно ли использовать пакет SDK для Cassandra API локально с эмулятором?

Да, это поддерживается. Вы можете найти подробную информацию о том, как включить это [здесь](local-emulator.md#cassandra-api)


### <a name="how-can-i-migrate-data-from-their-apache-cassandra-clusters-to-cosmos-db"></a>Как перенести данные из кластеров Apache Cassandra в Космос DB?

Вы можете прочитать о вариантах миграции [здесь](cassandra-import-data.md).


### <a name="feature-x-of-regular-cassandra-api-isnt-working-as-today-where-can-the-feedback-be-provided"></a>Функция x обычного API Cassandra не работает. Где можно оставить отзыв?

Оставьте отзыв с помощью формы обратной связи на форуме [UserVoice](https://feedback.azure.com/forums/263030-azure-cosmos-db).

[azure-portal]: https://portal.azure.com
[query]: sql-api-sql-query.md

## <a name="next-steps"></a>Следующие шаги

- Начало работы с [упругой масштабированием учетной записи Azure Cosmos DB Cassandra API.](manage-scale-cassandra.md)
