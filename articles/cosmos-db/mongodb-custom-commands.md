---
title: MongoDB расширение команды для управления данными, хранящимися в Azure Cosmos DB API для MongoDB
description: В этой статье описывается, как использовать MongoDB расширение команды для управления данными, хранящимися в Azure Cosmos DB API для MongoDB.
author: SnehaGunda
ms.service: cosmos-db
ms.topic: conceptual
ms.date: 03/26/2019
ms.author: sngun
ms.openlocfilehash: aef77f121f20d867c8ec5e764d8c9639c961713d
ms.sourcegitcommit: 3102f886aa962842303c8753fe8fa5324a52834a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "60446590"
---
# <a name="use-mongodb-extension-commands-to-manage-data-stored-in-azure-cosmos-dbs-api-for-mongodb"></a>Используйте MongoDB расширение команды для управления данными, хранящимися в Azure Cosmos DB API для MongoDB 

Azure Cosmos DB — это глобально распределенная многомодельная служба базы данных Майкрософт. Можно взаимодействовать с API Azure Cosmos DB для MongoDB, с помощью любого открытого исходного кода [драйверы клиента MongoDB](https://docs.mongodb.org/ecosystem/drivers). API Azure Cosmos DB для MongoDB поддерживает существующие драйверы клиента благодаря [протокол коммутации MongoDB](https://docs.mongodb.org/manual/reference/mongodb-wire-protocol).

С помощью API Azure Cosmos DB для MongoDB, вы можете воспользоваться преимуществами Cosmos DB, такие как Глобальное распределение, автоматическое Сегментирование, высокий уровень доступности, гарантии относительно задержки, automatic, шифрование при хранении резервных копий, и многие более, а, сохраняя инвестиций в приложение MongoDB.

## <a name="mongodb-protocol-support"></a>Поддержка протокола MongoDB

По умолчанию, API Azure Cosmos DB для MongoDB совместим с MongoDB server версии 3.2, Дополнительные сведения см. в разделе [поддерживается возможностей и синтаксиса](mongodb-feature-support.md). Функции и операторы запросов, добавленные в MongoDB версии 3.4 в настоящее время доступны в предварительной версии в Azure Cosmos DB API для MongoDB. Следующие команды расширения поддержки определенных функциональных возможностей Azure Cosmos DB, при выполнении операций CRUD в данные, хранящиеся в Azure Cosmos DB API для MongoDB:

* [Создание базы данных](#create-database)
* [Обновление базы данных](#update-database)
* [Получение базы данных](#get-database)
* [Создание коллекции](#create-collection)
* [Обновление коллекции](#update-collection)
* [Получение коллекции](#get-collection)

## <a id="create-database"></a> Создание базы данных

Расширение команды создания базы данных создает новую базу данных MongoDB. Имя базы данных используется в контексте базы данных, по которой выполняется команда. Формат команды CreateDatabase выглядит следующим образом:

```
{
  customAction: "CreateDatabase",
  offerThroughput: <Throughput that you want to provision on the database>
}
```

В следующей таблице описаны параметры в рамках команды:

|**Поле**|**Тип** |**Описание** |
|---------|---------|---------|
| Настраиваемое действие   |  строка  |   Имя пользовательские команды, он должен быть «CreateDatabase».      |
| offerThroughput | int  | Подготовленной пропускной способности, для базы данных. Это необязательный параметр. |

### <a name="output"></a>Выходные данные

Возвращает ответ пользовательской команды по умолчанию. См. в разделе [по умолчанию выходные данные](#default-output) пользовательские команды для параметров в выходных данных.

### <a name="examples"></a>Примеры

**Создание базы данных**

Чтобы создать базу данных с именем «test», используйте следующую команду:

```shell
use test
db.runCommand({customAction: "CreateDatabase"});
```

**Создание базы данных с пропускной способностью**

Создание базы данных с именем «test» и подготовленной пропускной способности использования 1000 единиц запроса, используйте следующую команду:

```shell
use test
db.runCommand({customAction: "CreateDatabase", offerThroughput: 1000 });
```

## <a id="update-database"></a> Обновление базы данных

Команда обновления базы данных расширения обновляет свойства, связанные с указанной базы данных. В настоящее время можно обновить только свойство «offerThroughput».

```
{
  customAction: "UpdateDatabase",
  offerThroughput: <New throughput that you want to provision on the database> 
}
```

В следующей таблице описаны параметры в рамках команды:

|**Поле**|**Тип** |**Описание** |
|---------|---------|---------|
| Настраиваемое действие    |    строка     |   Имя пользовательской команды. Должно быть «UpdateDatabase».      |
|  offerThroughput   |  int       |     Новый подготовленную пропускную способность, вам необходимо задать в базе данных.    |

### <a name="output"></a>Выходные данные

Возвращает ответ пользовательской команды по умолчанию. См. в разделе [по умолчанию выходные данные](#default-output) пользовательские команды для параметров в выходных данных.

### <a name="examples"></a>Примеры

**Обновление подготовленной пропускной способности, связанный с базой данных**

Чтобы обновить подготовленной пропускной способности базы данных с именем «test» до 1200 ЕЗ, используйте следующую команду:

```shell
use test
db.runCommand({customAction: "UpdateDatabase", offerThroughput: 1200 });
```

## <a id="get-database"></a> Получение базы данных

Команда get database расширения возвращает объект базы данных. Имя базы данных используется в контексте базы данных, по которой выполняется команда.

```
{
  customAction: "GetDatabase"
}
```

В следующей таблице описаны параметры в рамках команды:


|**Поле**|**Тип** |**Описание** |
|---------|---------|---------|
|  Настраиваемое действие   |   строка      |   Имя пользовательской команды. Должен быть «GetDatabase»|
        
### <a name="output"></a>Выходные данные

Если команда выполняется успешно, ответ содержит документ со следующими полями:

|**Поле**|**Тип** |**Описание** |
|---------|---------|---------|
|  `ok`   |   `int`     |   Состояние ответа. 1 == успех. 0 == сбоя.      |
| `database`    |    `string`        |   Имя базы данных.      |
|   `provisionedThroughput`  |    `int`      |    Подготовленной пропускной способности, установленного в базе данных. Это параметр необязательно ответа.     |

Если команда завершается ошибкой, возвращается ответ пользовательской команды по умолчанию. См. в разделе [по умолчанию выходные данные](#default-output) пользовательские команды для параметров в выходных данных.

### <a name="examples"></a>Примеры

**Получите базу данных**

Чтобы получить объект базы данных для базы данных с именем «test», используйте следующую команду:

```shell
use test
db.runCommand({customAction: "GetDatabase"});
```

## <a id="create-collection"></a> Создание коллекции

Расширение команды создания коллекции создает новую коллекцию MongoDB. Имя базы данных используется в контексте базы данных, по которой выполняется команда. Формат команды CreateCollection выглядит следующим образом:

```
{
  customAction: "CreateCollection",
  collection: <Collection Name>,
  offerThroughput: <Throughput that you want to provision on the collection>,
  shardKey: <Shard key path>  
}
```

В следующей таблице описаны параметры в рамках команды:

|**Поле**|**Тип** |**Описание** |
|---------|---------|---------|
| Настраиваемое действие    | строка | Имя пользовательской команды. Должен быть «CreateDatabase»     |
| collection      | строка | Имя коллекции                                   |
| offerThroughput | int    | Подготовленной пропускной способности, чтобы задать в базе данных. Это необязательный параметр |
| shardKey        | строка | Путь к ключу сегментов для создания сегментированной коллекции. Это необязательный параметр |

### <a name="output"></a>Выходные данные

Возвращает ответ пользовательской команды по умолчанию. См. в разделе [по умолчанию выходные данные](#default-output) пользовательские команды для параметров в выходных данных.

### <a name="examples"></a>Примеры

**Создание коллекции unsharded**

Создание коллекции unsharded с именем «testCollection» и подготовленной пропускной способности использования 1000 единиц запроса, используйте следующую команду: 

```shell
use test
db.runCommand({customAction: "CreateCollection", collection: "testCollection", offerThroughput: 1000});
``` 

**Создание сегментированной коллекции**

Чтобы создать сегментированную коллекцию с именем «testCollection» и подготовленной пропускной способности использования 1000 единиц запроса, используйте следующую команду:

```shell
use test
db.runCommand({customAction: "CreateCollection", collection: "testCollection", offerThroughput: 1000, shardKey: "a.b" });
```

## <a id="update-collection"></a> Обновление коллекции

Команды расширения коллекции обновление обновляет свойства, связанные с указанной коллекции.

```
{
  customAction: "UpdateCollection",
  collection: <Name of the collection that you want to update>,
  offerThroughput: <New throughput that you want to provision on the collection> 
}
```

В следующей таблице описаны параметры в рамках команды:

|**Поле**|**Тип** |**Описание** |
|---------|---------|---------|
|  Настраиваемое действие   |   строка      |   Имя пользовательской команды. Должно быть «UpdateCollection».      |
|  collection   |   строка      |   Имя коллекции.       |
| offerThroughput   |int|   Подготовленной пропускной способности до задан в коллекции.|

## <a name="output"></a>Выходные данные

Возвращает ответ пользовательской команды по умолчанию. См. в разделе [по умолчанию выходные данные](#default-output) пользовательские команды для параметров в выходных данных.

### <a name="examples"></a>Примеры

**Обновление подготовленной пропускной способности, связанную с коллекцией**

Чтобы обновить подготовленной пропускной способности в коллекцию с именем «testCollection» до 1200 ЕЗ, используйте следующую команду:

```shell
use test
db.runCommand({customAction: "UpdateCollection", collection: "testCollection", offerThroughput: 1200 });
```

## <a id="get-collection"></a> Получение коллекции

Команда пользовательские коллекции get возвращает объект коллекции.

```
{
  customAction: "GetCollection",
  collection: <Name of the collection>
}
```

В следующей таблице описаны параметры в рамках команды:


|**Поле**|**Тип** |**Описание** |
|---------|---------|---------|
| Настраиваемое действие    |   строка      |   Имя пользовательской команды. Должно быть «GetCollection».      |
| collection    |    строка     |    Имя коллекции.     |

### <a name="output"></a>Выходные данные

Если команда выполняется успешно, ответ содержит документ со следующими полями


|**Поле**|**Тип** |**Описание** |
|---------|---------|---------|
|  `ok`   |    `int`     |   Состояние ответа. 1 == успех. 0 == сбоя.      |
| `database`    |    `string`     |   Имя базы данных.      |
| `collection`    |    `string`     |    Имя коллекции.     |
|  `shardKeyDefinition`   |   `document`      |  Документ спецификации индекса, используемый в качестве ключа сегмента. Это параметр необязательно ответа.       |
|  `provisionedThroughput`   |   `int`      |    Подготовленной пропускной способности до задан в коллекции. Это параметр необязательно ответа.     |

Если команда завершается ошибкой, возвращается ответ пользовательской команды по умолчанию. См. в разделе [по умолчанию выходные данные](#default-output) пользовательские команды для параметров в выходных данных.

### <a name="examples"></a>Примеры

**Получение коллекции**

Чтобы получить объект коллекции для коллекции с именем «testCollection», используйте следующую команду:

```shell
use test
db.runCommand({customAction: "GetCollection", collection: "testCollection"});
```

## <a id="default-output"></a> По умолчанию выходные данные пользовательской команды

Если не указано, ответ содержит документ со следующими полями:

|**Поле**|**Тип** |**Описание** |
|---------|---------|---------|
|  `ok`   |    `int`     |   Состояние ответа. 1 == успех. 0 == сбоя.      |
| `code`    |   `int`      |   Возвращается, только если команда завершилась ошибкой (т. е. ОК == 0). Содержит код ошибки MongoDB. Это параметр необязательно ответа.      |
|  `errMsg`   |  `string`      |    Возвращается, только если команда завершилась ошибкой (т. е. ОК == 0). Содержит понятное сообщение об ошибке. Это параметр необязательно ответа.      |

## <a name="next-steps"></a>Дальнейшие действия

Затем вы сможете узнать следующие основные понятия Azure Cosmos DB: 

* [Индексирование в Azure Cosmos DB](../cosmos-db/index-policy.md)
* [Автоматическое завершение срока действия данных в Azure Cosmos DB с использованием срока жизни](../cosmos-db/time-to-live.md)