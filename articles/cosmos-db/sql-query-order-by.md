---
title: Положение ORDER BY в Azure Cosmos DB
description: Узнайте о пункте S'L ORDER BY BY для Azure Cosmos DB. Используйте s'L в качестве языка запросов Azure Cosmos DB JSON.
author: timsander1
ms.service: cosmos-db
ms.topic: conceptual
ms.date: 04/17/2020
ms.author: tisande
ms.openlocfilehash: 70702ee4a77e8b3c46de4354f3394bca4080d837
ms.sourcegitcommit: d791f8f3261f7019220dd4c2dbd3e9b5a5f0ceaf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/18/2020
ms.locfileid: "81641397"
---
# <a name="order-by-clause-in-azure-cosmos-db"></a>Положение ORDER BY в Azure Cosmos DB

В `ORDER BY` дополнительном положении оговаривается порядок сортировки результатов, возвращенных запросом.

## <a name="syntax"></a>Синтаксис
  
```sql  
ORDER BY <sort_specification>  
<sort_specification> ::= <sort_expression> [, <sort_expression>]  
<sort_expression> ::= {<scalar_expression> [ASC | DESC]} [ ,...n ]  
```  

## <a name="arguments"></a>Аргументы
  
- `<sort_specification>`  
  
   Указывает свойство или выражение, по которому производится сортировка результирующего набора запроса. Столбец сортировки может быть указан как псевдоним имени или свойства.  
  
   Можно указать несколько свойств. Названия свойств должны быть уникальными. Последовательность свойств сортировки в предложении `ORDER BY` определяет организацию отсортированного набора результатов. То есть результирующий набор сортируется по первому свойству, а затем упорядоченный список сортируется по второму свойству и т. д.  
  
   Имена свойств, указанные `ORDER BY` в оговорке, должны соответствовать либо свойству в избранном `FROM` списке, либо свойству, определенному в коллекции, указанному в оговорке, без каких-либо двусмысленностей.  
  
- `<sort_expression>`  
  
   Определяет одно или несколько свойств или выражений, на которых можно сортировать набор результатов запроса.  
  
- `<scalar_expression>`  
  
   Дополнительные сведения см. в разделе [Скалярные выражения](sql-query-scalar-expressions.md).  
  
- `ASC | DESC`  
  
   Указывает порядок сортировки значений в указанном столбце — по возрастанию или по убыванию. `ASC`сортов от самого низкого значения до самого высокого значения. `DESC`сортов от самого высокого значения до самого низкого значения. `ASC`является порядком сортировки по умолчанию. Значения NULL рассматриваются как минимально возможные значения.  
  
## <a name="remarks"></a>Примечания  
  
   Положение `ORDER BY` требует, чтобы политика индексирования включала индекс для сортированных полей. Время выполнения запроса Azure Cosmos DB поддерживает сортировку по имени свойства, а не вычисляемые свойства. Azure Cosmos DB `ORDER BY` поддерживает несколько свойств. Для выполнения запроса с несколькими свойствами ORDER BY следует определить [составной индекс](index-policy.md#composite-indexes) на сортированных полях.

> [!Note]
> Если отсортированные свойства могут быть неопределенными для некоторых документов и вы хотите получить их в запросе ORDER BY, необходимо явно включить этот путь в индекс. Политика индексирования по умолчанию не позволяет получить документы, в которых свойство сортировки не определено. [Просмотрите примеры запросов по документам с некоторыми недостающим полями.](#documents-with-missing-fields)

## <a name="examples"></a>Примеры

Например, вот запрос, который получает семьи в порядке возрастания имени города-резидента:

```sql
    SELECT f.id, f.address.city
    FROM Families f
    ORDER BY f.address.city
```

Результаты:

```json
    [
      {
        "id": "WakefieldFamily",
        "city": "NY"
      },
      {
        "id": "AndersenFamily",
        "city": "Seattle"
      }
    ]
```

Следующий запрос получает `id`семейство s в порядке даты создания элемента. Пункт `creationDate` — это число, представляющее *время эпохи*или прошедшее время с 1 января 1970 года за считанные секунды.

```sql
    SELECT f.id, f.creationDate
    FROM Families f
    ORDER BY f.creationDate DESC
```

Результаты:

```json
    [
      {
        "id": "WakefieldFamily",
        "creationDate": 1431620462
      },
      {
        "id": "AndersenFamily",
        "creationDate": 1431620472
      }
    ]
```

Кроме того, вы можете заказать по нескольким свойствам. Запрос, который заказывает по нескольким свойствам, требует [составного индекса.](index-policy.md#composite-indexes) Обратите внимание на следующий запрос:

```sql
    SELECT f.id, f.creationDate
    FROM Families f
    ORDER BY f.address.city ASC, f.creationDate DESC
```

Этот запрос получает семью `id` в порядке возрастания названия города. Если несколько элементов имеют одно и то `creationDate` же название города, запрос будет заказываться в порядке убывания.

## <a name="documents-with-missing-fields"></a>Документы с недостающим полями

Запросы, `ORDER BY` которые запускаются в отношении контейнеров с политикой индексирования по умолчанию, не возвращают документы, в которых свойство сортировки не определено. Если вы хотите включить документы, в которых свойство сортировки не определено, следует прямо включить это свойство в политику индексации.

Например, вот контейнер с политикой индексирования, который явно не включает `"/*"`в себя какие-либо пути, кроме:

```json
{
    "indexingMode": "consistent",
    "automatic": true,
    "includedPaths": [
        {
            "path": "/*"
        }
    ],
    "excludedPaths": []
}
```

При запуске запроса, `lastName` содержащегося в оговорке, `Order By` результаты будут включать только документы, в которых `lastName` определено свойство. Мы не определили явный включенный путь для `lastName` такого `lastName` неотображимых документов без неотображимых в результатах запроса.

Вот запрос, который сортируется `lastName` по двум документам, `lastName` один из которых не имеет определенного:

```sql
    SELECT f.id, f.lastName
    FROM Families f
    ORDER BY f.lastName
```

Результаты включают только документ, `lastName`который имеет определенный:

```json
    [
        {
            "id": "AndersenFamily",
            "lastName": "Andersen"
        }
    ]
```

Если мы обновим политику индексирования контейнера, `lastName`чтобы явно включить путь для, мы включим документы с неопределенным свойством сортировки в результаты запроса. Необходимо четко определить путь, ведущий к этому масштабированному значению (а не за его пределами). В политике `?` индексирования следует использовать символ в определении пути, чтобы `lastName` убедиться, что вы явно проиндексируете свойство и не будет никаких дополнительных вложенных путей за его пределами. Если `Order By` в запросе используется [составной индекс,](index-policy.md#composite-indexes)результаты всегда будут включать документы с неопределенным свойством сортировки в результатах запроса.

Вот политика индексирования выборки, которая позволяет иметь `lastName` документы с неопределенным отображаются в результатах запроса:

```json
{
    "indexingMode": "consistent",
    "automatic": true,
    "includedPaths": [
        {
            "path": "/lastName/?"
        },
        {
            "path": "/*"
        }
    ],
    "excludedPaths": []
}
```

При повторном запуске одного и того `lastName` же запроса в результатах запроса сначала отображаются документы, которые отсутствуют:

```sql
    SELECT f.id, f.lastName
    FROM Families f
    ORDER BY f.lastName
```

Результаты:

```json
[
    {
        "id": "WakefieldFamily"
    },
    {
        "id": "AndersenFamily",
        "lastName": "Andersen"
    }
]
```

При изменении заказа `DESC`на сортировку документы, которые отсутствуют, `lastName` отображаются последними в результатах запроса:

```sql
    SELECT f.id, f.lastName
    FROM Families f
    ORDER BY f.lastName DESC
```

Результаты:

```json
[
    {
        "id": "AndersenFamily",
        "lastName": "Andersen"
    },
    {
        "id": "WakefieldFamily"
    }
]
```

## <a name="next-steps"></a>Дальнейшие действия

- [Начало работы](sql-query-getting-started.md)
- [Indexing policy in Azure Cosmos DB](index-policy.md) (Политики индексации в Azure Cosmos DB)
- [Оговорка OFFSET LIMIT](sql-query-offset-limit.md)
