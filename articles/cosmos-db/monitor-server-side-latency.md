---
title: Как контролировать задержку сервера для операций в Azure Cosmos DB
description: Узнайте, как контролировать задержку сервера для операций в учетной записи Azure Cosmos DB или контейнере. Владельцы учетной записи Azure Cosmos DB могут понять проблемы задержки сервера с учетными записями Azure Cosmos.
ms.service: cosmos-db
ms.topic: conceptual
author: kanshiG
ms.author: govindk
ms.date: 04/07/2020
ms.openlocfilehash: 0f1e6d07afb3b7b4d26081bc9e34ac257b280d0f
ms.sourcegitcommit: fb23286d4769442631079c7ed5da1ed14afdd5fc
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/10/2020
ms.locfileid: "81113925"
---
# <a name="how-to-monitor-the-server-side-latency-for-operations-in-an-azure-cosmos-db-container-or-account"></a>Как контролировать задержку сервера для операций в контейнере или учетной записи Azure Cosmos DB

Azure Monitor для Azure Cosmos DB предоставляет представление метрик для мониторинга учетной записи и создания панелей мониторинга. Метрики Azure Cosmos DB собираются по умолчанию, эта функция не требует от вас включения или настройки чего-либо явно. Для просмотра задержки операции в сторону сервера используется метрика задержки на стороне сервера. Azure Cosmos DB обеспечивает SLA менее 10 мс для операций чтения/записи точек при непосредственном подключении. Для операций по чтению и записи точки SLA рассчитываются как подробно описанные в [документе SLA.](https://azure.microsoft.com/support/legal/sla/cosmos-db/v1_3/)

Если вы видите необычайно большую задержку для точечных операций, таких как:

* Операция «Получить или установить» ключом раздела и идентификатором в прямом режиме
* Операция чтения или записи или
* Запрос

Вы можете посмотреть диагностический журнал, чтобы увидеть размер возвращенных данных. Если вы видите устойчивую высокую задержку для операций запроса, можно найти диагностический журнал для размера возвращенных данных, [пропускной результат или RU/s,](cosmosdb-monitor-resource-logs.md#diagnostic-queries) или количества таких операций в данный период. Таким образом, можно отладить проблемы задержки на стороне сервера.

## <a name="view-the-server-side-latency-metric"></a>Просмотр метрики задержки сервера

1. Войдите на [портал Azure](https://portal.azure.com/).

1. Выберите **монитор** из левой панели навигации и выберите **метрики.**

   ![Панель метрик в Azure Monitor](./media/monitor-server-side-latency/monitor-metrics-blade.png)

1. Из панели **метрик** > **Выберите ресурс** > выбрать требуемую **подписку**и **группу ресурсов.** Для **типа ресурса**выберите **dB-учетные записи Azure Cosmos,** выберите одну из существующих учетных записей Azure Cosmos и выберите **Apply.**
   
   ![Выберите учетную запись Azure Cosmos DB для просмотра метрик](./media/monitor-server-side-latency/select-cosmos-db-account.png)

1. Далее выберите метрику **задержки сервера** из списка доступных метрик. Чтобы узнать подробно обо всех доступных метриках в этом списке, [см.](monitor-cosmos-db-reference.md) В этом примере давайте выберем в качестве значения агрегации значение **Server Side Latency** и **Avg.** В дополнение к этим деталям, вы также можете выбрать **диапазон времени** и **детализацию времени** метрик. На макс, вы можете просмотреть метрики за последние 30 дней.  После нанесения фильтра на основе фильтра отображается диаграмма. За выбранный период можно увидеть задержку на стороне сервера в минуту.  

   ![Выберите метрику задержки сервера на портале Azure](./media/monitor-server-side-latency/server-side-latency-metric.png)

## <a name="filters-for-server-side-latency"></a>Фильтры для задержки на стороне сервера

Вы также можете фильтровать метрики и получать диаграммы отображаются на определенном **CollectionName**, **ConnectionMode**, **DatabaseName**, **OperationType**, **регион**, и **PublicAPIType**. 

Чтобы отфильтровать метрики, выберите **Фильтр и** выберите требуемое свойство, такое как **PublicAPIType,** и выберите значение **sql.** Добавьте еще один фильтр для **OperationType**. Затем на графике отображается задержка на стороне сервера для различных операций в выбранный период. Операции, выполняемые с помощью процедуры Stored, не регистрируются, поэтому они не доступны в метрике OperationType.

Метрики **задержки серверной стороны** для каждой операции отображаются, как показано на следующем изображении:

![Фильтры для метрик задержки сервера](./media/monitor-server-side-latency/server-side-latency-filters.png)

Вы также можете сгруппировать метрики с помощью опции **расщепления Apply.**  

## <a name="next-steps"></a>Дальнейшие действия

* Мониторинг данных Azure Cosmos DB с помощью [диагностических настроек](cosmosdb-monitor-resource-logs.md) в Azure.
* [Аудит операций самолета управления Azure Cosmos DB](audit-control-plane-logs.md)