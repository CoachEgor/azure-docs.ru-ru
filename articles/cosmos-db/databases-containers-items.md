---
title: Работа с базами данных, контейнерами и элементами в Azure Cosmos DB
description: В этой статье описывается создание и использование баз данных, контейнеров и элементов в Azure Cosmos DB.
author: markjbrown
ms.author: mjbrown
ms.service: cosmos-db
ms.topic: conceptual
ms.date: 04/24/2020
ms.reviewer: sngun
ms.openlocfilehash: e1718ac9a7b7fcaab096595ea7341fcc90c2ddd6
ms.sourcegitcommit: e71da24cc108efc2c194007f976f74dd596ab013
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/29/2020
ms.locfileid: "87422340"
---
# <a name="work-with-databases-containers-and-items-in-azure-cosmos-db"></a>Работа с базами данных, контейнерами и элементами в Azure Cosmos DB

После создания [учетной записи Azure Cosmos DB](account-overview.md) в подписке Azure можно управлять данными в учетной записи, создавая базы данных, контейнеры и элементы. В этой статье описывается каждая из этих сущностей. 

На следующем рисунке показана иерархия различных сущностей в учетной записи Azure Cosmos DB.

:::image type="content" source="./media/databases-containers-items/cosmos-entities.png" alt-text="Сущности учетной записи Azure Cosmos" border="false":::

## <a name="azure-cosmos-databases"></a>базы данных Azure Cosmos.

В своей учетной записи можно создать одну или несколько баз данных Azure Cosmos. База данных аналогична пространству имен. База данных — это единица управления для набора контейнеров Azure Cosmos. В следующей таблице показано, как база данных Azure Cosmos соотносится с разными сущностями определенных API:

| Сущность Azure Cosmos DB | API SQL | API Cassandra | API Azure Cosmos DB для MongoDB | API Gremlin | API таблиц |
| --- | --- | --- | --- | --- | --- |
|База данных Azure Cosmos | База данных | Пространство ключей | База данных | База данных | Н/Д |

> [!NOTE]
> При использовании учетных записей API таблиц при создании первой таблицы база данных по умолчанию автоматически создается в учетной записи Azure Cosmos.

### <a name="operations-on-an-azure-cosmos-database"></a>Операции с базой данных Azure Cosmos

Вы можете взаимодействовать с базой данных Azure Cosmos с помощью API-интерфейсов Azure Cosmos, как описано в следующей таблице.

| Операция | Azure CLI | API SQL | API Cassandra | API Azure Cosmos DB для MongoDB | API Gremlin | API таблиц |
| --- | --- | --- | --- | --- | --- | --- |
|Перечисление всех баз данных| Да | Да | Да (база данных соответствует пространству имен) | Да | Н/Д | Н/Д |
|Чтение базы данных| Да | Да | Да (база данных соответствует пространству имен) | Да | Н/Д | Н/Д |
|Создание базы данных| Да | Да | Да (база данных соответствует пространству имен) | Да | Н/Д | Н/Д |
|Обновление базы данных| Да | Да | Да (база данных соответствует пространству имен) | Да | Н/Д | Н/Д |


## <a name="azure-cosmos-containers"></a>Контейнеры Azure Cosmos

Контейнер Cosmos для Azure — это единица масштабируемости для подготовленной пропускной способности и хранилища. Контейнер горизонтально секционируется и затем реплицируются между несколькими регионами. Добавленные в контейнер элементы и подготовленная для него пропускная способность автоматически распределяются в пределах набора логических секций на основе ключа секции. Дополнительные сведения о секционировании и ключах секций см. в разделе [данные секции](partition-data.md). 

При создании контейнера Azure Cosmos вы настраиваете пропускную способность в одном из следующих режимов:

* **Выделенный режим пропускной способности**. пропускная способность, подготовленная в контейнере, зарезервирована для этого контейнера и поддерживается соглашением об уровне обслуживания. Дополнительные сведения см. в статье [как подготавливать пропускную способность в контейнере Azure Cosmos](how-to-provision-container-throughput.md).

* **Общий режим подготовленной пропускной способности**. Эти контейнеры совместно используют подготовленную пропускную способность с другими контейнерами в той же базе данных (за исключением контейнеров, настроенных с выделенной подготовленной пропускной способностью). Иными словами, подготовленная пропускная способность для базы данных является общей для всех контейнеров "Общая пропускная способность". Дополнительные сведения см. в статье [как подготавливать пропускную способность в базе данных Azure Cosmos](how-to-provision-database-throughput.md).

> [!NOTE]
> Общую и выделенную пропускную способность можно настроить только при создании базы данных и контейнера. Чтобы переключиться из режима выделенной пропускной способности в режим общей пропускной способности (и наоборот) после создания контейнера, необходимо создать контейнер и перенести данные в новый контейнер. Данные можно перенести с помощью функции веб-канала изменения Azure Cosmos DB.

Контейнер Azure Cosmos может гибко масштабироваться независимо от того, создаются ли контейнеры с помощью выделенных или общих режимов подготовленной пропускной способности.

Контейнер Azure Cosmos — это контейнер элементов, не зависящий от схем. Элементы в контейнере могут иметь произвольные схемы. Например, элемент, представляющий человека и элемент, представляющий автомобиль, может быть помещен в один и тот *же контейнер*. По умолчанию все элементы, добавляемые в контейнер, автоматически индексируются без необходимости явного управления индексами или схемой. Поведение индексирования можно настроить, настроив [политику индексирования](index-overview.md) для контейнера. 

Вы можете задать срок жизни [(TTL)](time-to-live.md) для выбранных элементов в контейнере Azure Cosmos или для всего контейнера, чтобы корректно удалить эти элементы из системы. Azure Cosmos DB автоматически удаляет элементы по истечении срока их действия. Также гарантируется, что запрос, выполняемый в контейнере, не возвращает элементы с истекшим сроком действия в фиксированной границе. Дополнительные сведения см. в статье [Настройка TTL для контейнера](how-to-time-to-live.md).

[Веб-канал изменений](change-feed.md) можно использовать для подписки на журнал операций, который управляется для каждого логического раздела контейнера. Веб-канал изменений предоставляет журнал всех обновлений, выполненных в контейнере, вместе с образами элементов до и после. Дополнительные сведения см. в разделе [Построение реактивных приложений с помощью веб-канала изменений](serverless-computing-database.md). Длительность хранения для веб-канала изменений также можно настроить с помощью политики веб-канала изменений в контейнере.

Вы можете зарегистрировать [хранимые процедуры, триггеры, определяемые пользователем функции (UDF)](stored-procedures-triggers-udfs.md)и [процедуры слияния](how-to-manage-conflicts.md) для контейнера Azure Cosmos.

Можно указать [ограничение уникального ключа](unique-keys.md) в контейнере Azure Cosmos. Создавая политику уникальных ключей, вы гарантируете уникальность одного или нескольких значений ключа логической секции. Если контейнер создается с помощью политики уникального ключа, можно создать новые или обновленные элементы со значениями, которые дублируют значения, указанные ограничением уникального ключа. См. дополнительные сведения об [ограничениях уникальных ключей](unique-keys.md).

Контейнер Cosmos для Azure специализируется на сущностях, относящихся к API, как показано в следующей таблице.

| Сущность Azure Cosmos DB | API SQL | API Cassandra | API Azure Cosmos DB для MongoDB | API Gremlin | API таблиц |
| --- | --- | --- | --- | --- | --- |
|Контейнер Azure Cosmos | Контейнер | Таблица | Коллекция | График | Таблица |

> [!NOTE]
> При создании контейнеров следите за тем, чтобы не создать два контейнера с одинаковыми именами, но в разных регистрах. Причина в том, что некоторые компоненты платформы Azure не учитывают регистр. Это может привести к путанице или конфликтам в данных телеметрии и действиях с контейнерами с такими именами.

### <a name="properties-of-an-azure-cosmos-container"></a>Свойства контейнера Azure Cosmos

Контейнер Cosmos для Azure имеет набор системных свойств. В зависимости от используемого API некоторые свойства могут быть не предоставлены напрямую. В следующей таблице приводится описание списка системных свойств.

| Свойство, определяемое системой | Формируемый системой или настраиваемый пользователем | Цель | API SQL | API Cassandra | API Azure Cosmos DB для MongoDB | API Gremlin | API таблиц |
| --- | --- | --- | --- | --- | --- | --- | --- |
|\_избежать | Создано системой | Уникальный идентификатор контейнера. | Да | Нет | Нет | Нет | Нет |
|\_тегом | Создано системой | Тег сущности, используемый для управления оптимистической блокировкой. | Да | Нет | Нет | Нет | Нет |
|\_лицензии | Создано системой | Метка времени последнего обновления контейнера. | Да | Нет | Нет | Нет | Нет |
|\_самообслуживания | Создано системой | Адресуемый URI контейнера. | Да | Нет | Нет | Нет | Нет |
|идентификатор | Настраиваемый пользователем | Определяемое пользователем уникальное имя контейнера. | да | да | да | да | да |
|indexingPolicy | Настраиваемый пользователем | Предоставляет возможность изменения пути индекса, типа индекса и режима индекса. | Да | Нет | Нет | Нет | Да |
|timeToLive | Настраиваемый пользователем | Предоставляет возможность автоматического удаления элементов из контейнера по истечении заданного периода времени. Дополнительные сведения см. [в разделе время жизни](time-to-live.md). | Да | Нет | Нет | Нет | Да |
|changeFeedPolicy | Настраиваемый пользователем | Используется для считывания изменений, внесенных в элементы в контейнере. Дополнительные сведения см. в разделе [веб-канал изменений](change-feed.md). | Да | Нет | Нет | Нет | Да |
|uniqueKeyPolicy | Настраиваемый пользователем | Используется для обеспечения уникальности одного или нескольких значений в логической секции. Дополнительные сведения см. в разделе [ограничения уникального ключа](unique-keys.md). | Да | Нет | Нет | Нет | Да |

### <a name="operations-on-an-azure-cosmos-container"></a>Операции с контейнером Azure Cosmos

Контейнер Azure Cosmos поддерживает следующие операции при использовании любого из API-интерфейсов Azure Cosmos.

| Операция | Azure CLI | API SQL | API Cassandra | API Azure Cosmos DB для MongoDB | API Gremlin | API таблиц |
| --- | --- | --- | --- | --- | --- | --- |
| Перечисление контейнеров в базе данных | да | да | да | Да | Н/Д | Н/Д |
| Считывание контейнера | да | да | да | Да | Н/Д | Н/Д |
| Создает контейнер. | да | да | да | Да | Н/Д | Н/Д |
| Обновление контейнера | да | да | да | Да | Н/Д | Н/Д |
| Удаление контейнера | да | да | да | Да | Н/Д | Н/Д |

## <a name="azure-cosmos-items"></a>Элементы Azure Cosmos

В зависимости от используемого API элемент Azure Cosmos может представлять документ в коллекции, строку в таблице или узел (ребро) в графе. В следующей таблице показано сопоставление сущностей, относящихся к API, с элементом Cosmos Azure.

| Сущность Azure Cosmos DB | API SQL | API Cassandra | API Azure Cosmos DB для MongoDB | API Gremlin | API таблиц |
| --- | --- | --- | --- | --- | --- |
|Элемент Azure Cosmos | Элемент | Строка | Документ | Узел или ребро | Элемент |

### <a name="properties-of-an-item"></a>Свойства элемента

Каждый элемент Cosmos в Azure имеет следующие определяемые системой свойства. В зависимости от используемого API некоторые из них могут быть не предоставлены напрямую.

| Свойство, определяемое системой | Формируемый системой или настраиваемый пользователем| Цель | API SQL | API Cassandra | API Azure Cosmos DB для MongoDB | API Gremlin | API таблиц |
| --- | --- | --- | --- | --- | --- | --- | --- |
|\_избежать | Создано системой | Уникальный идентификатор элемента | Да | Нет | Нет | Нет | Нет |
|\_тегом | Создано системой | Тег сущности, используемый для управления оптимистической блокировкой. | Да | Нет | Нет | Нет | Нет |
|\_лицензии | Создано системой | Метка времени последнего обновления элемента | Да | Нет | Нет | Нет | Нет |
|\_самообслуживания | Создано системой | Адресуемый URI элемента. | Да | Нет | Нет | Нет | Нет |
|идентификатор | Можно использовать | Определяемое пользователем уникальное имя в логической секции. | да | да | да | да | да |
|Определяемые пользователем свойства | Определяемые пользователем маршруты | Определяемые пользователем свойства, представленные в собственном представлении API (включая JSON, BSON и CQL) | да | да | да | да | да |

> [!NOTE]
> Уникальность свойства применяется `id` только в пределах каждой логической секции. Несколько документов могут иметь одно и то же `id` свойство с разными значениями ключа секции.

### <a name="operations-on-items"></a>Операции с элементами

Элементы Azure Cosmos поддерживают следующие операции. Для выполнения операций можно использовать любой из интерфейсов API Azure Cosmos.

| Операция | Azure CLI | API SQL | API Cassandra | API Azure Cosmos DB для MongoDB | API Gremlin | API таблиц |
| --- | --- | --- | --- | --- | --- | --- |
| Вставка, замена, удаление, обновление или вставка, чтение | Нет | Да | да | да | да | Да |

## <a name="next-steps"></a>Дальнейшие действия

Дополнительные сведения об этих задачах и концепциях:

* [Подготовка пропускной способности для базы данных Azure Cosmos](how-to-provision-database-throughput.md)
* [Подготовка пропускной способности для контейнера Azure Cosmos](how-to-provision-container-throughput.md)
* [Работа с логическими секциями](partition-data.md)
* [Настройка TTL для контейнера Azure Cosmos](how-to-time-to-live.md)
* [Создание реактивных приложений с помощью веб-канала изменений](change-feed.md)
* [Настройка ограничения уникального ключа в контейнере Azure Cosmos](unique-keys.md)
