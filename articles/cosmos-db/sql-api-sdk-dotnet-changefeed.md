---
title: API, пакет SDK и ресурсы обработчика канала изменений в .NET для Azure Cosmos DB
description: Сведения об API и пакете SDK для обработчика канала изменений, включая даты выхода, даты прекращения, а также изменения, внесенные в каждую версию пакета SDK для обработчика канала изменений в .NET.
author: ealsur
ms.service: cosmos-db
ms.subservice: cosmosdb-sql
ms.devlang: dotnet
ms.topic: reference
ms.date: 01/30/2019
ms.author: maquaran
ms.openlocfilehash: 56ec4d867abd5f2767c64b0800eeb017c0fb9923
ms.sourcegitcommit: 36c50860e75d86f0d0e2be9e3213ffa9a06f4150
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/16/2019
ms.locfileid: "65793005"
---
# <a name="net-change-feed-processor-sdk-download-and-release-notes"></a>Пакет SDK обработчика канала изменений: заметки о скачивании и выпуске
> [!div class="op_single_selector"]
> * [.NET](sql-api-sdk-dotnet.md)
> * [Веб-канал изменений в .NET](sql-api-sdk-dotnet-changefeed.md)
> * [.NET Core](sql-api-sdk-dotnet-core.md)
> * [Node.js](sql-api-sdk-node.md)
> * [Async Java](sql-api-sdk-async-java.md)
> * [Java](sql-api-sdk-java.md)
> * [Python](sql-api-sdk-python.md)
> * [REST](https://docs.microsoft.com/rest/api/cosmos-db/)
> * [Поставщик ресурсов REST](https://docs.microsoft.com/rest/api/cosmos-db-resource-provider/)
> * [SQL](sql-api-query-reference.md)
> * [BulkExecutor — .NET](sql-api-sdk-bulk-executor-dot-net.md)
> * [BulkExecutor — Java](sql-api-sdk-bulk-executor-java.md)

|   |   |
|---|---|
|**Скачивание пакета SDK**|[NuGet](https://www.nuget.org/packages/Microsoft.Azure.DocumentDB.ChangeFeedProcessor/)|
|**Документация по API**|[Справочная документация по изменению API библиотеки обработчика веб-каналов](/dotnet/api/microsoft.azure.documents.changefeedprocessor?view=azure-dotnet)|
|**Начало работы**|[Начало работы с пакетом SDK для обработчика канала изменений в .NET](change-feed.md)|
|**Текущая поддерживаемая платформа**| [Microsoft .NET Framework 4.5](https://www.microsoft.com/download/details.aspx?id=30653)</br> [Microsoft .NET Core](https://www.microsoft.com/net/download/core) |

## <a name="release-notes"></a>Заметки о выпуске

### <a name="v2-builds"></a>Сборки версии 2

### <a name="a-name227227"></a><a name="2.2.7"/>2.2.7
* Улучшенная Балансировка стратегии для сценария при получении всех аренд принимает больше, чем интервал истечения срока действия аренды, например из-за проблемы с сетью:
  * В этом сценарии загрузки балансировки алгоритм, используемый для ошибочно рассмотрите возможность аренды, так как истек срок действия, вызывая аренду кражи active владельцев. Это может запустить ненужные повторной балансировки массу аренды.
  * Эта проблема исправлена в этом выпуске путем исключения повторных попыток на конфликт при получении аренды с истекшим сроком, которых владелец не изменилось выделение и posponing истек срок действия аренды для следующей итерации балансировки.

### <a name="a-name226226"></a><a name="2.2.6"/>2.2.6
* Улучшена обработка исключений Observer.
* Добавлены сведения об ошибках Observer:
  * Если операции с Observer прерываются из-за исключения, вызванного ProcessChangesAsync, CloseAsync получит параметр reason с заданным значением ChangeFeedObserverCloseReason.ObserverError.
  * Добавлены трассировки для выявления ошибок в пользовательском коде в Observer.

### <a name="a-name225225"></a><a name="2.2.5"/>2.2.5
* Добавлена поддержка обработки разбиения коллекций, использующих пропускную способность общей базы данных.
  * В этом выпуске устранена такая проблема: во время разбиения коллекций с использованием пропускной способности общей базы данных происходило перераспределение разделов с созданием только одного диапазона ключей дочернего элемента (а не двух). В таких ситуациях обработчик канала изменений может зависнуть, удаляя аренду для старого диапазона ключей раздела и не создавая новые аренды. В этом выпуске эта проблема исправлена.

### <a name="a-name224224"></a><a name="2.2.4"/>2.2.4
* Добавлено новое свойство ChangeFeedProcessorOptions.StartContinuation для включения поддержки при запуске канала изменений из маркера продолжения запроса. Используется, только если возвращается пустая коллекция аренды или для аренды не настроен параметр ContinuationToken. Для аренды в коллекции аренды с настроенным и используемым параметром ContinuationToken свойство ChangeFeedProcessorOptions.StartContinuation игнорируется.

### <a name="a-name223223"></a><a name="2.2.3"/>2.2.3
* Добавлена поддержка пользовательского хранилища для хранения маркеров продолжения для секций.
  * Например, хранилище пользовательской аренды может быть коллекцией аренд Azure Cosmos DB, секционированной любым способом.
  * Хранилища пользовательских аренд могут использовать новый общедоступный интерфейс ILeaseStoreManager и свойство ChangeFeedProcessorBuilder.WithLeaseStoreManager(ILeaseStoreManager) точки расширяемости.
  * Для интерфейса ILeaseManager выполнен рефакторинг в нескольких интерфейсах роли.
* Незначительное критическое изменение: удалено свойство точки расширяемости ChangeFeedProcessorBuilder.WithLeaseManager(ILeaseManager). Вместо этого используйте свойство ChangeFeedProcessorBuilder.WithLeaseStoreManager(ILeaseStoreManager).

### <a name="a-name222222"></a><a name="2.2.2"/>2.2.2
* Этот выпуск устраняет проблему, которая происходит во время обработки разбиения в отслеживаемой коллекции и использования секционированной коллекции аренд. При обработке аренды для разбиения секций, аренда, соответствующая этой секции, не будет удалена. В этом выпуске эта проблема исправлена.

### <a name="a-name221221"></a><a name="2.2.1"/>2.2.1
* Исправлено вычисление оценки для учетных записей с несколькими источниками и нового формата токена сеанса.

### <a name="a-name220220"></a><a name="2.2.0"/>2.2.0
* Добавлена поддержка для секционированных коллекций аренд. Ключ секции должен быть определен как /id.
* Небольшое критическое изменение: методы интерфейса IChangeFeedDocumentClient и класса ChangeFeedDocumentClient были изменены для включения параметров RequestOptions и CancellationToken. IChangeFeedDocumentClient представляет собой точку расширяемости с дополнительными возможностями, которая позволяет создавать собственную реализацию клиента документов, которая будет использоваться с обработчиком канала изменений, например декорировать клиент документов и перехватывать все вызовы к нему для дополнительной трассировки, обработки ошибок и т. д. После этого обновления в код, который реализует IChangeFeedDocumentClient, необходимо будет включить новые параметры.
* Незначительные улучшения системы диагностики.

### <a name="a-name210210"></a><a name="2.1.0"/>2.1.0
* Добавлен новый API, Task&lt;IReadOnlyList&lt;RemainingPartitionWork&gt;&gt; IRemainingWorkEstimator.GetEstimatedRemainingWorkPerPartitionAsync(). Его можно использовать для получения оценки работ для каждого раздела.
* Поддерживает Microsoft.Azure.DocumentDB SDK 2.0. Требуется Microsoft.Azure.DocumentDB 2.0 или более поздней версии.

### <a name="a-name206206"></a><a name="2.0.6"/>2.0.6
* Добавлено общедоступное свойство ChangeEventHost.HostName для совместимости с версией 1.

### <a name="a-name205205"></a><a name="2.0.5"/>2.0.5
* Исправлено состояние гонки, которое возникло во время разделения секций. Состояние гонки может привести к получению аренды и немедленной потере права на нее при разделении секций, а также привести к состязанию. Проблема с состоянием гонки исправлена в этом выпуске.

### <a name="a-name204204"></a><a name="2.0.4"/>2.0.4
* Пакет SDK общей доступности.

### <a name="a-name203-prerelease203-prerelease"></a><a name="2.0.3-prerelease"/>2.0.3-prerelease
* Исправлены следующие ошибки:
  * При разделении секции может дублироваться обработка документов, созданных до разделения.
  * API GetEstimatedRemainingWork возвратил 0 при отсутствии аренды в коллекции.

* Приведенные ниже исключения сделаны общедоступными. Расширения, реализующие IPartitionProcessor, могут выдавать эти исключения.
  * Microsoft.Azure.Documents.ChangeFeedProcessor.Exceptions.LeaseLostException. 
  * Microsoft.Azure.Documents.ChangeFeedProcessor.Exceptions.PartitionException. 
  * Microsoft.Azure.Documents.ChangeFeedProcessor.Exceptions.PartitionNotFoundException.
  * Microsoft.Azure.Documents.ChangeFeedProcessor.Exceptions.PartitionSplitException. 

### <a name="a-name202-prerelease202-prerelease"></a><a name="2.0.2-prerelease"/>Предварительный выпуск 2.0.2:
* Незначительные изменения в API:
  * Удаление ChangeFeedProcessorOptions.IsAutoCheckpointEnabled как устаревшего.

### <a name="a-name201-prerelease201-prerelease"></a><a name="2.0.1-prerelease"/>2.0.1-prerelease
* Улучшения стабильности:
  * Улучшение обработки при инициализации хранилища аренды. Если хранилище аренды пустое, инициализировать его может только один экземпляр обработчика. Остальные будут находиться в состоянии ожидания.
  * Более стабильное и эффективное обновление и освобождение аренды. Обновление и освобождение аренды одной секции не зависит от обновления других. В версии 1 процедура последовательно выполнялась для всех секций.
* Новый API версии 2:
  * Шаблон построителя для повышения гибкости при создании процессора: класс ChangeFeedProcessorBuilder.
    * Может принимать любое сочетание параметров.
    * Может принимать экземпляр DocumentClient для мониторинга и (или) коллекции аренды (недоступно в версии 1).
  * IChangeFeedObserver.ProcessChangesAsync теперь принимает CancellationToken.
  * IRemainingWorkEstimator — средство оценки оставшихся трудозатрат можно использовать отдельно от процессора.
  * Новые точки расширяемости:
    * IPartitionLoadBalancingStrategy — для пользовательской балансировки нагрузки в секциях между экземплярами процессора.
    * ILease, ILeaseManager — для пользовательского управления арендой.
    * IPartitionProcessor — для пользовательского обработки изменений в секции.
* Для ведения журнала используется библиотека [LibLog](https://github.com/damianh/LibLog).
* Полная обратная совместимость с API версии 1.
* Новая база кода.
* Совместимость с [пакетом SDK .NET для SQL](sql-api-sdk-dotnet.md) версии 1.21.1 и выше.

### <a name="v1-builds"></a>Сборки версии 1

### <a name="a-name133133"></a><a name="1.3.3"/>1.3.3
* В журнал записываются дополнительные сведения.
* Исправлена утечка DocumentClient при неоднократном вызове оценки работы в режиме ожидания.

### <a name="a-name132132"></a><a name="1.3.2"/>1.3.2
* Исправления в оценке работы в режиме ожидания.

### <a name="a-name131131"></a><a name="1.3.1"/>1.3.1
* Улучшение стабильности.
  * Исправлена обработка проблема отмененных задач, которая может привести к остановленной наблюдателей, в некоторых секциях.
* Поддержка использования контрольных точек вручную.
* Совместимость с [пакетом SDK .NET для SQL](sql-api-sdk-dotnet.md) версии 1.21 и выше.

### <a name="a-name120120"></a><a name="1.2.0"/>1.2.0
* Добавляет поддержку .NET Standard 2.0. Теперь пакет поддерживает моникеры платформ `netstandard2.0` и `net451`.
* Совместимость с [пакетом SDK для .NET для SQL](sql-api-sdk-dotnet.md) версии 1.17.0 и более поздних версий.
* Совместимость с [пакетом SDK для .NET Core для SQL](sql-api-sdk-dotnet-core.md) версии 1.5.1 и более поздних версий.

### <a name="a-name111111"></a><a name="1.1.1"/>1.1.1
* Устраняет проблему при расчете оставшейся работы, если канал изменений был пуст или никакие действия не ожидались.
* Совместимость с [пакетом SDK для .NET для SQL](sql-api-sdk-dotnet.md) версии 1.13.2 и более поздних версий.

### <a name="a-name110110"></a><a name="1.1.0"/>1.1.0
* Добавлен метод для оценки оставшейся работы для обработки в веб-канале изменений.
* Совместимость с [пакетом SDK для .NET для SQL](sql-api-sdk-dotnet.md) версии 1.13.2 и более поздних версий.

### <a name="a-name100100"></a><a name="1.0.0"/>1.0.0
* Пакет SDK общей доступности.
* Совместимость с [пакетом SDK для .NET для SQL](sql-api-sdk-dotnet.md) версии 1.14.1 и более ранних версий.


## <a name="release--retirement-dates"></a>Даты выпуска и выбытия
Корпорация Майкрософт отправит уведомление минимум за **12 месяцев** до вывода пакета SDK из эксплуатации, чтобы обеспечить более плавный переход на новую или поддерживаемую версию.

Новые функции, возможности и оптимизации добавляются только в текущую версию пакета SDK, поэтому рекомендуется как можно раньше обновлять пакет SDK до последней версии. 

Любые запросы к Cosmos DB с помощью выведенного из эксплуатации пакета SDK будут отклонены службой.

<br/>

| Version | Дата выпуска | Дата вывода |
| --- | --- | --- |
| [2.2.7](#2.2.7) |14 мая 2019 г. |--- |
| [2.2.6](#2.2.6) |29 января 2019 г. |--- |
| [2.2.5](#2.2.5) |13 декабря 2018 г. |--- |
| [2.2.4](#2.2.4) |29 ноября 2018 г. |--- |
| [2.2.3](#2.2.3) |19 ноября 2018 г. |--- |
| [2.2.2](#2.2.2) |31 октября 2018 г. |--- |
| [2.2.1](#2.2.1) |24 октября 2018 г. |--- |
| [1.3.3](#1.3.3) |8 мая 2018 г. |--- |
| [1.3.2](#1.3.2) |18 апреля 2018 г. |--- |
| [1.3.1](#1.3.1) |13 марта 2018 г. |--- |
| [1.2.0](#1.2.0) |31 октября 2017 г. |--- |
| [1.1.1](#1.1.1) |29 августа 2017 г. |--- |
| [1.1.0](#1.1.0) |13 августа 2017 г. |--- |
| [1.0.0](#1.0.0) |7 июля 2017 г. |--- |


## <a name="faq"></a>Часто задаваемые вопросы
[!INCLUDE [cosmos-db-sdk-faq](../../includes/cosmos-db-sdk-faq.md)]

## <a name="see-also"></a>См. также
Дополнительные сведения о Cosmos DB см. на странице службы [Microsoft Azure Cosmos DB](https://azure.microsoft.com/services/cosmos-db/). 

