---
title: Обновление Mongo версии API Azure Cosmos DB для учетной записи MongoDB
description: Как быстро обновить версию MongoDB Wired-Protocol для API существующей Azure Cosmos DB для учетных записей MongoDB
author: LuisBosquez
ms.service: cosmos-db
ms.subservice: cosmosdb-mongo
ms.topic: guide
ms.date: 09/22/2020
ms.author: lbosq
ms.openlocfilehash: 795b7641ac22373b02ab23126055c080af5e851d
ms.sourcegitcommit: 53acd9895a4a395efa6d7cd41d7f78e392b9cfbe
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/22/2020
ms.locfileid: "90937451"
---
# <a name="upgrade-the-mongodb-wire-protocol-version-of-your-azure-cosmos-dbs-api-for-mongodb-account"></a>Обновление версии протокола MongoDB Wired для учетной записи API Azure Cosmos DB для MongoDB

В этой статье описывается, как обновить версию протокола проводной сети API Azure Cosmos DB для учетной записи MongoDB. После обновления версии протокола проводной сети вы можете использовать новейшие функции API Azure Cosmos DB для MongoDB. Процесс обновления не прерывает доступность вашей учетной записи и не потребляет единиц запросов в секунду или уменьшает емкость базы данных в любой момент. Этот процесс не затрагивает существующие данные или индексы.

>[!Note]
> В данный момент только квалифицированные учетные записи, использующие версию 3,2 сервера, могут быть обновлены до версии 3,6. Если в вашей учетной записи не отображается вариант обновления, отправьте запрос [в службу поддержки](https://portal.azure.com/?#blade/Microsoft_Azure_Support/HelpAndSupportBlade).

## <a name="upgrading-from-version-32-to-36"></a>Обновление с версии 3,2 до 3,6

### <a name="benefits-of-upgrading-to-version-36"></a>Преимущества обновления до версии 3.6

Ниже перечислены новые возможности, реализованные в версии 3,6.
- Повышение производительности и стабильности
- Поддержка новых команд базы данных
- Поддержка конвейера агрегирования по умолчанию и новых этапов агрегирования
- Поддержка потоков изменений
- Поддержка составных индексов
- Поддержка перекрестных секций для следующих операций: обновление, удаление, подсчет и сортировка
- Улучшена производительность для следующих агрегатных операций: $count, $skip, $limit и $group
- Теперь поддерживается индексирование с использованием подстановочных знаков

### <a name="changes-from-version-32"></a>Изменения с версии 3,2

- **Рекуестратеисларженые ошибки удалены**. Запросы от клиентского приложения больше не будут возвращать ошибки 16500. Вместо этого запросы будут возобновлены до завершения или истечения времени ожидания.
- За время ожидания запроса устанавливается значение 60 секунд.
- Для коллекций MongoDB, созданных в новой версии протокола проводной сети, `_id` свойство будет индексироваться только по умолчанию.

### <a name="action-required"></a>Необходимые действия

Для обновления до версии 3,6 суффикс конечной точки учетной записи базы данных будет обновлен в следующем формате:

```
<your_database_account_name>.mongo.cosmos.azure.com
```

Необходимо заменить существующую конечную точку в приложениях и драйверах, которые подключаются к этой учетной записи базы данных. **Только подключения, использующие новую конечную точку, будут иметь доступ к функциям в MongoDB версии 3,6**. Предыдущая конечная точка должна иметь суффикс `.documents.azure.com` .

>[!Note]
> Эта конечная точка может иметь небольшие отличия, если ваша учетная запись была создана в независимых, правительственном или в облаке Azure с ограниченным доступом.

### <a name="how-to-upgrade"></a>Обновление

1. Сначала перейдите к портал Azure и перейдите к колонке Azure Cosmos DB API для учетной записи MongoDB. Убедитесь, что используется версия сервера `3.2` . 

    :::image type="content" source="./media/mongodb-version-upgrade/1.png" alt-text="Общие сведения о портал Azure с учетной записью MongoDB" border="false":::

2. В параметрах слева выберите `Features` колонку. Будут отображены функции уровня учетной записи, доступные для вашей учетной записи базы данных.

    :::image type="content" source="./media/mongodb-version-upgrade/2.png" alt-text="Обзор портал Azure с MongoDB учетной записью с выделенным колонкой "функции"" border="false":::

3. Щелкните `Upgrade to Mongo server version 3.6` строку. Если этот параметр не отображается, ваша учетная запись может быть недоступна для этого обновления. Если это так, отправьте запрос [в службу поддержки](https://portal.azure.com/?#blade/Microsoft_Azure_Support/HelpAndSupportBlade) .

    :::image type="content" source="./media/mongodb-version-upgrade/3.png" alt-text="Колонка "функции" с параметрами." border="false":::

4. Ознакомьтесь со сведениями об этом конкретном обновлении. Обратите внимание, что обновление будет выполнено только до тех пор, пока приложения не будут использовать обновленную конечную точку, как видно в этом разделе. Щелкните `Enable` , как только вы будете готовы начать процесс.

    :::image type="content" source="./media/mongodb-version-upgrade/4.png" alt-text="Расширенное руководство по обновлению." border="false":::

5. После запуска процесса в меню отобразится `Features` состояние обновления. Состояние будет отправлено с `Pending` на в `In Progress` `Upgraded` . Этот процесс не влияет на существующие функции или операции учетной записи базы данных.

    :::image type="content" source="./media/mongodb-version-upgrade/5.png" alt-text="Состояние обновления после инициации." border="false":::

6. После завершения обновления состояние будет отображаться как `Upgraded` . Щелкните его, чтобы узнать больше о дальнейших действиях и действиях, которые необходимо выполнить для завершения процесса. Если при обработке запроса возникла ошибка, [обратитесь в службу поддержки](https://azure.microsoft.com/en-us/support/create-ticket/) .

    :::image type="content" source="./media/mongodb-version-upgrade/6.png" alt-text="Состояние обновленной учетной записи." border="false":::

7. **Чтобы начать использовать обновленную версию учетной записи базы данных**, вернитесь в `Overview` колонку и скопируйте новую строку подключения для использования в приложении. Приложения начнут использовать обновленную версию сразу после подключения к новой конечной точке. Существующие подключения не будут прерываться и их можно будет обновить. Для обеспечения единообразия работы все приложения должны использовать новую конечную точку.

    :::image type="content" source="./media/mongodb-version-upgrade/7.png" alt-text="Новая колонка обзора." border="false":::

## <a name="next-steps"></a>Дальнейшие действия

- Сведения о поддерживаемых и неподдерживаемых [функциях MongoDB версии 3,6](mongodb-feature-support-36.md).
- Дополнительные сведения см. в статье о [функциях в версии Mongo 3.6](https://devblogs.microsoft.com/cosmosdb/azure-cosmos-dbs-api-for-mongodb-now-supports-server-version-3-6/).
