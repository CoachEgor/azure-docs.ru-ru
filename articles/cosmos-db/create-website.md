---
title: Развертывание веб-приложения с помощью шаблона в Azure Cosmos DB
description: В этом руководстве показано, как выполнять развертывание учетной записи Azure Cosmos DB, веб-приложений службы приложений Azure и примера веб-приложения с использованием шаблона Azure Resource Manager.
author: SnehaGunda
ms.service: cosmos-db
ms.topic: conceptual
ms.date: 05/28/2019
ms.author: sngun
ms.openlocfilehash: feab221c24034fe29df420b4f9eb6d84e06a90b5
ms.sourcegitcommit: f52ce6052c795035763dbba6de0b50ec17d7cd1d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/24/2020
ms.locfileid: "76719342"
---
# <a name="deploy-azure-cosmos-db-and-azure-app-service-web-apps-using-an-azure-resource-manager-template"></a>Развертывание Azure Cosmos DB и веб-приложений службы приложений Azure с помощью шаблона Azure Resource Manager
В этом руководстве показано, как использовать шаблон Azure Resource Manager для развертывания и интеграции [Microsoft Azure Cosmos DB](https://azure.microsoft.com/services/cosmos-db/), веб-приложения [службы приложений Azure](https://go.microsoft.com/fwlink/?LinkId=529714), а также примера веб-приложения.

С помощью шаблонов Azure Resource Manager можно легко автоматизировать развертывание и настройку ресурсов Azure.  В этом руководстве показано, как развернуть веб-приложение и автоматически задать сведения о подключении учетной записи Azure Cosmos DB.

После изучения этого учебника вы сможете ответить на следующие вопросы.  

* Как можно использовать шаблон Azure Resource Manager для развертывания и интеграции учетной записи Azure Cosmos DB и веб-приложения в службе приложений Azure?
* Как можно использовать шаблон Azure Resource Manager для развертывания и интеграции учетной записи Azure Cosmos DB, веб-приложения в веб-приложениях службы приложений и приложения веб-развертывания?

<a id="Prerequisites"></a>

## <a name="prerequisites"></a>Технические условия
> [!TIP]
> Хотя это руководство не требует наличия опыта работы с шаблонами Azure Resource Manager или JSON, если возникнет необходимость изменить ссылки шаблонов или варианты развертывания, потребуются знания в каждой из этих областей.
> 
> 

Для выполнения инструкций этого руководства нужна подписка Azure. Azure — это платформа на основе подписок.  Дополнительные сведения о получении подписки см. на страницах [Как приобрести Azure](https://azure.microsoft.com/pricing/purchase-options/), [Предложения для участников](https://azure.microsoft.com/pricing/member-offers/) или [Создайте бесплатную учетную запись Azure уже сегодня](https://azure.microsoft.com/pricing/free-trial/).

## <a id="CreateDB"></a>Шаг 1. Загрузка файлов шаблонов
Сначала мы загрузим файлы шаблонов, которые требуются в этом руководстве.

1. Скачайте шаблон [примера создания учетной записи Azure Cosmos DB, веб-приложений и развертывания демонстрационного приложения](https://portalcontent.blob.core.windows.net/samples/DocDBWebsiteTodo.json) в локальную папку (например, C:\Azure Cosmos DBTemplates). В этом примере развертываются учетная запись Azure Cosmos DB, веб-приложение службы приложений и веб-приложение.  Также веб-приложение автоматически настраивается для подключения к учетной записи Azure Cosmos DB.
2. Скачайте шаблон [примера создания учетной записи Azure Cosmos DB и веб-приложений](https://portalcontent.blob.core.windows.net/samples/DocDBWebSite.json) в локальную папку (например, C:\Azure Cosmos DBTemplates). При помощи этого шаблона развертываются учетная запись Azure Cosmos DB, веб-приложение службы приложений, а также изменяются параметры приложения сайта. Это упрощает доступ к сведениям о подключении Azure Cosmos DB. Но в шаблон не входит веб-приложение.  

<a id="Build"></a>

## <a name="step-2-deploy-the-azure-cosmos-db-account-app-service-web-app-and-demo-application-sample"></a>Шаг 2. Пример развертывания учетной записи Azure Cosmos DB, веб-приложения службы приложений и демонстрационного приложения
Теперь давайте развернем первый шаблон.

> [!TIP]
> Шаблон не проверяет, являются ли имя веб-приложения и имя учетной записи Azure Cosmos DB, введенные в следующем шаблоне, действительными и доступными.  Перед началом развертывания настоятельно рекомендуется проверить доступность имен, которые планируется использовать.
> 
> 

1. Выполните вход на [портал Azure](https://portal.azure.com), нажмите кнопку "Создать" и найдите пункт "Развертывание шаблона".
    ![Снимок экрана пользовательского интерфейса развертывания шаблона](./media/create-website/TemplateDeployment1.png)
2. Выберите элемент Шаблоны развертывания и щелкните **создать** ![снимок экрана пользовательского интерфейса развертывания шаблона](./media/create-website/TemplateDeployment2.png)
3. Нажмите кнопку **Изменить шаблон**, вставьте содержимое файла шаблона DocDBWebsiteTodo.json и нажмите кнопку **Сохранить**.
   ![Снимок экрана пользовательского интерфейса развертывания шаблона](./media/create-website/TemplateDeployment3.png)
4. Нажмите кнопку **Изменить параметры**, укажите значения для всех обязательных параметров и нажмите кнопку **ОК**.  Он принимает перечисленные ниже параметры.
   
   1. Имя сайта: указывает имя веб-приложения службы приложений и используется для создания URL-адреса, используемого для доступа к приложению (например, если указать "mydemodocdbwebapp"), URL-адрес, по которому вы обращаетесь к этому приложению, — `mydemodocdbwebapp.azurewebsites.net`).
   2. HOSTINGPLANNAME: задает имя создаваемого плана размещения службы приложений.
   3. LOCATION: задает расположение Azure, в котором будут создаваться ресурсы Azure Cosmos DB и веб-приложения.
   4. DATABASEACCOUNTNAME: задает имя создаваемой учетной записи Azure Cosmos DB.   
      
      ![Снимок экрана пользовательского интерфейса развертывания шаблона](./media/create-website/TemplateDeployment4.png)
5. Выберите существующую группу ресурсов или укажите имя и расположение для создания новой группы ресурсов.

    ![Снимок экрана пользовательского интерфейса развертывания шаблона](./media/create-website/TemplateDeployment5.png)
6. Выберите **Просмотр условий**, **Покупки** и нажмите кнопку **Создать**, чтобы начать развертывание.  Выберите **Закрепить на панели мониторинга** , чтобы развертывание отображалось на домашней странице портала Azure.
   ![Снимок экрана пользовательского интерфейса развертывания шаблона](./media/create-website/TemplateDeployment6.png)
7. По завершении развертывания откроется область группы ресурсов.
   ![Снимок экрана области группы ресурсов](./media/create-website/TemplateDeployment7.png)  
8. Чтобы использовать приложение, перейдите по URL-адресу веб-приложения (в приведенном выше примере URL-адрес будет иметь вид http://mydemodocdbwebapp.azurewebsites.net) ).  Вы увидите следующее веб-приложение.
   
   ![Пример приложения Todo](./media/create-website/image2.png)
9. Теперь создайте несколько задач в веб-приложении и вернитесь в область группы ресурсов на портале Azure. Выберите ресурс учетной записи Azure Cosmos DB в списке ресурсов и нажмите кнопку **Обозреватель данных**.
10. Запустите запрос по умолчанию (SELECT * FROM c) и просмотрите результаты.  Обратите внимание, что запрос вернул JSON-представление элементов списка задач, которые были созданы на шаге 7 выше.  Поэкспериментируйте с запросами. Например, попробуйте выполнить запрос SELECT * FROM c WHERE c.isComplete = true, чтобы получить все элементы списка задач, которые были отмечены как завершенные.
11. Не стесняйтесь исследовать портал экспериментов Azure Cosmos DB или вносить изменения в пример приложения Todo.  Когда вы закончите, давайте развернем еще один шаблон.

<a id="Build"></a> 

## <a name="step-3-deploy-the-document-account-and-web-app-sample"></a>Шаг 3: пример развертывания учетной записи Document и веб-приложения
Теперь давайте развернем второй шаблон.  Этот шаблон наглядно показывает, как внедрить данные о подключении Azure Cosmos DB, например конечную точку учетной записи и главный ключ, в веб-приложение в качестве параметров приложения или в виде пользовательской строки подключения. Например, возможно, у вас имеется собственное веб-приложение, которое нужно развернуть с помощью учетной записи Azure Cosmos DB, причем сведения о подключении должны заполняться автоматически во время развертывания.

> [!TIP]
> Шаблон не проверяет, являются ли имя веб-приложения и имя учетной записи Azure Cosmos DB: а) действующими и б) доступными.  Перед началом развертывания настоятельно рекомендуется проверить доступность имен, которые планируется использовать.
> 
> 

1. На [портале Azure](https://portal.azure.com)нажмите кнопку "Создать" и найдите пункт "Развертывание шаблона".
    ![Снимок экрана пользовательского интерфейса развертывания шаблона](./media/create-website/TemplateDeployment1.png)
2. Выберите элемент Шаблоны развертывания и щелкните **создать** ![снимок экрана пользовательского интерфейса развертывания шаблона](./media/create-website/TemplateDeployment2.png)
3. Нажмите кнопку **Изменить шаблон**, вставьте содержимое файла шаблона DocDBWebSite.json и нажмите кнопку **Сохранить**.
   ![Снимок экрана пользовательского интерфейса развертывания шаблона](./media/create-website/TemplateDeployment3.png)
4. Нажмите кнопку **Изменить параметры**, укажите значения для всех обязательных параметров и нажмите кнопку **ОК**.  Он принимает перечисленные ниже параметры.
   
   1. SITENAME: задает имя веб-приложения службы приложений и используется для создания URL-адреса, который будет применяться для доступа к веб-приложению (например, если указать "mydemodocdbwebapp", то URL-адрес для доступа к веб-приложению будет иметь вид mydemodocdbwebapp.azurewebsites.net).
   2. HOSTINGPLANNAME: задает имя создаваемого плана размещения службы приложений.
   3. LOCATION: задает расположение Azure, в котором будут создаваться ресурсы Azure Cosmos DB и веб-приложения.
   4. DATABASEACCOUNTNAME: задает имя создаваемой учетной записи Azure Cosmos DB.   
      
      ![Снимок экрана пользовательского интерфейса развертывания шаблона](./media/create-website/TemplateDeployment4.png)
5. Выберите существующую группу ресурсов или укажите имя и расположение для создания новой группы ресурсов.

    ![Снимок экрана пользовательского интерфейса развертывания шаблона](./media/create-website/TemplateDeployment5.png)
6. Выберите **Просмотр условий**, **Покупки** и нажмите кнопку **Создать**, чтобы начать развертывание.  Выберите **Закрепить на панели мониторинга** , чтобы развертывание отображалось на домашней странице портала Azure.
   ![Снимок экрана пользовательского интерфейса развертывания шаблона](./media/create-website/TemplateDeployment6.png)
7. По завершении развертывания откроется область группы ресурсов.
   ![Снимок экрана области группы ресурсов](./media/create-website/TemplateDeployment7.png)  
8. Щелкните ресурс веб-приложения в списке ресурсов, а затем щелкните **Параметры приложения** ![снимке экрана группы ресурсов](./media/create-website/TemplateDeployment9.png)  
9. Обратите внимание на параметры приложения для конечной точки и всех главных ключей Azure Cosmos DB.

    ![Снимок экрана с параметрами приложения](./media/create-website/TemplateDeployment10.png)  
10. Вы можете продолжить знакомство с порталом Azure либо воспользоваться одним из [примеров](https://go.microsoft.com/fwlink/?LinkID=402386) Azure Cosmos DB для создания собственного приложения Azure Cosmos DB.

<a name="NextSteps"></a>

## <a name="next-steps"></a>Дальнейшие действия
Поздравляем! Мы выполнили развертывание Azure Cosmos DB, веб-приложения службы приложений и примера веб-приложения с использованием шаблонов Azure Resource Manager.

* Дополнительные сведения о базе данных Azure Cosmos DB см. [здесь](https://azure.microsoft.com/services/cosmos-db/).
* Дополнительные сведения о веб-приложениях службы приложений Azure см. [здесь](https://go.microsoft.com/fwlink/?LinkId=325362).
* Дополнительные сведения о шаблонах Azure Resource Manager см. [здесь](https://msdn.microsoft.com/library/azure/dn790549.aspx).

## <a name="whats-changed"></a>Что изменилось
* Руководство по переходу от веб-сайтов к службе приложений см. в статье [Служба приложений Azure и существующие службы Azure](https://go.microsoft.com/fwlink/?LinkId=529714).

> [!NOTE]
> Чтобы приступить к работе со службой приложений Azure до создания учетной записи Azure, перейдите к разделу [Пробное использование службы приложений](https://go.microsoft.com/fwlink/?LinkId=523751), где вы можете быстро создать кратковременное веб-приложение начального уровня в службе приложений. Никаких кредитных карт и обязательств
> 
> 

