---
title: Безопасность баз данных в Azure Cosmos DB
description: Узнайте, как Azure Cosmos DB обеспечивает защиту базы данных и данных.
author: markjbrown
ms.service: cosmos-db
ms.topic: conceptual
ms.date: 03/10/2020
ms.author: mjbrown
ms.openlocfilehash: 30991f17970eefe1a140cdd70e1f6b305160349c
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "79537335"
---
# <a name="security-in-azure-cosmos-db---overview"></a>Безопасность в Azure Cosmos DB. Обзор

В этой статье представлены рекомендации по обеспечению безопасности, а также основные возможности, предлагаемые Azure Cosmos DB для предотвращения и обнаружения нарушений в работе баз данных и реагирования на эти нарушения.

## <a name="whats-new-in-azure-cosmos-db-security"></a>Что нового в безопасности Azure Cosmos DB

Шифрование неактивных данных теперь доступно для документов и резервных копий, хранящихся в Azure Cosmos DB во всех регионах Azure. Шифрование неактивных данных применяется в этих регионах автоматически как для новых, так и для существующих клиентов. Настраивать ничего не нужно. Уровень задержки, пропускной способности, доступности и функциональности сохраняется, но при этом вы получаете преимущество более высокой защищенности данных.

## <a name="how-do-i-secure-my-database"></a>Как обезопасить свою базу данных

Ответственность за безопасность данных лежит как на клиенте, так и на поставщике базы данных. В зависимости от выбранного поставщика базы данных доля ответственности клиента может меняться. Если выбрать локальное решение, то клиент должен предоставить все — от защиты конечной точки до физической безопасности оборудования, а это непростая задача. Если выбрать поставщик облачной базы данных PaaS, например Azure Cosmos DB, то обязанности клиента значительно сокращаются. На следующем рисунке, взятом из технического документа корпорации Майкрософт [Shared Responsibilities for Cloud Computing](https://aka.ms/sharedresponsibility) (Разделяемые обязанности в облачных вычислениях), показано, как с применением поставщика PaaS, такого как Azure Cosmos DB, сокращается ответственность клиента.

![Ответственность клиента и поставщика базы данных](./media/database-security/nosql-database-security-responsibilities.png)

На предыдущей схеме видны высокоуровневые компоненты безопасности в облаке, но о каких элементах необходимо позаботиться конкретно для решения вашей базы данных? И как сравнить решения между собой?

Мы рекомендуем сравнить системы баз данных с помощью следующего контрольного списка требований:

- Параметры безопасности сети и брандмауэра
- Аутентификация пользователей и детальные пользовательские элементы управления
- Возможность глобальной репликации данных в случае регионального сбоя
- Возможность сбоя из одного центра обработки данных в другой
- Репликация локальных данных в рамках центра обработки данных
- Автоматическая архивация данных
- Восстановление удаленных данных из архива
- Защита и изолирование конфиденциальных данных
- Мониторинг атак
- Реагирование на атаки
- Возможность защитить данные в пределах геозоны в соответствии с ограничениями, установленными для управления данными
- Физическая защита серверов в защищенных центрах обработки данных
- Сертификаты

И хотя это может показаться очевидным, но последние [крупномасштабные нарушения в работе баз данных](https://thehackernews.com/2017/01/mongodb-database-security.html) напоминают нам о простых, но критических важных требованиях, которые необходимо выполнять:

- Патчированные серверы, которые обновляются
- Шифрование HTTPS по умолчанию или SSL-шифрование
- Административные учетные записи с надежными паролями

## <a name="how-does-azure-cosmos-db-secure-my-database"></a>Как Azure Cosmos DB защищает мою базу данных

Давайте еще раз рассмотрим приведенный выше список. Сколько из этих требований к безопасности выполняется Azure Cosmos DB? Абсолютно все.

Рассмотрим каждое из них подробнее.

|Требование к безопасности|Подход к обеспечению безопасности Azure Cosmos DB|
|---|---|
|Безопасность сети|Использование брандмауэра для IP-адресов — первый уровень защиты базы данных. Для поддержки входящего трафика брандмауэра база данных Azure Cosmos DB использует политики контроля доступа на основе IP-адресов. Элементы управления доступом на основе IP аналогичны правилам брандмауэра, используемым традиционными системами баз данных, но расширяются таким образом, чтобы учетная запись базы данных Azure Cosmos была доступна только из утвержденного набора машин или облачных служб. Подробнее читайте в статье [поддержки брандмауэра Azure Cosmos DB.](firewall-support.md)<br><br>Azure Cosmos DB позволяет включить определенный IP-адрес (168.61.48.0), диапазон IP-адресов (168.61.48.0/8), а также сочетания IP-адресов и диапазонов. <br><br>Все запросы, полученные от компьютеров, IP-адреса которых не входят в этот список разрешенных, блокируются Azure Cosmos DB. Затем запросы из утвержденных компьютеров и облачных служб должны пройти процесс аутентификации, чтобы получить право на контроль доступа к ресурсам.<br><br> Вы можете использовать [виртуальные сетевые теги для](../virtual-network/service-tags-overview.md) обеспечения сетевой изоляции и защиты ресурсов Azure Cosmos DB от общего Интернета. При создании правил безопасности используйте теги служб вместо конкретных IP-адресов. Указывая имя тега службы (например, AzureCosmosDB) в соответствующем поле источника или назначения правила, можно разрешить или отклонить трафик для соответствующей службы.|
|Авторизация|Azure Cosmos DB использует для авторизации код проверки подлинности сообщения на основе хэша (HMAC). <br><br>Каждый запрос хэшируется с помощью секретного ключа учетной записи, а затем хэш в кодировке Base-64 отправляется с каждым вызовом в Azure Cosmos DB. Чтобы проверить запрос, служба Azure Cosmos DB использует соответствующий секретный ключ и свойства для создания хэша, а затем сравнивает это значение со значением в запросе. Если эти два значения совпадают, то операция авторизуется и запрос обрабатывается. В противном случае происходит ошибка авторизации и запрос отклоняется.<br><br>Для обеспечения детального управления доступом к ресурсу, например документу, можно использовать [главный ключ](secure-access-to-data.md#master-keys) или [маркер ресурса](secure-access-to-data.md#resource-tokens).<br><br>Дополнительные сведения см. в статье о [защите доступа к ресурсам Azure Cosmos DB](secure-access-to-data.md).|
|Пользователи и разрешения|С помощью главного ключа для учетной записи можно создавать в базе данных ресурсы пользователей и разрешений. Маркер ресурса связан с разрешением в базе данных и определяет, имеет ли пользователь доступ (на чтение и запись, только на чтение или без доступа) к ресурсу приложения в базе данных. К ресурсам приложения относятся контейнеры, документы, вложения, хранимые процедуры, триггеры и определяемые пользователем функции (UDF). Затем маркер ресурса используется во время аутентификации, чтобы предоставить или запретить доступ к ресурсу.<br><br>Дополнительные сведения см. в статье о [защите доступа к ресурсам Azure Cosmos DB](secure-access-to-data.md).|
|Интеграция с Active Directory (RBAC)| Вы также можете предоставить или ограничить доступ к учетной записи Космос, базе данных, контейнеру и предложениям (пропускной) с помощью управления доступом (IAM) на портале Azure. IAM обеспечивает управление доступом на основе ролей и интегрируется с Active Directory. Вы можете использовать встроенные роли или пользовательские роли для отдельных лиц и групп. Для получения дополнительной информации смотрите статью [об интеграции Active Directory.](role-based-access-control.md)|
|Глобальная репликация|Azure Cosmos DB предлагает готовое к использованию глобальное распространение, что позволяет реплицировать данные в любой из центров обработки данных Azure по всему миру одним щелчком. Глобальная репликация позволяет осуществлять глобальное масштабирование, обеспечивая низкую задержку при обращении к данным по всему миру.<br><br>В контексте безопасности глобальная репликация обеспечивает защиту данных от региональных сбоев.<br><br>Дополнительные сведения см. в статье [DocumentDB — глобально распределенная служба базы данных в Azure](distribute-data-globally.md).|
|Отработка отказа между регионами|Если вы реплицировали данные в нескольких центрах обработки данных, то Azure Cosmos DB автоматически переключит операции на другой центр, как только будет утрачена связь с региональным центром обработки данных. Вы можете создать список расположенных по приоритетам регионов отработки отказа, используя регионы, в которых реплицируются ваши данные. <br><br>Дополнительные сведения см. в статье об [отработке отказа между регионами в Azure Cosmos DB](high-availability.md).|
|Локальная репликация|Даже в пределах одного центра обработки данных Azure Cosmos DB автоматически реплицирует данные для обеспечения высокой доступности, предоставляя выбор [уровней согласованности](consistency-levels.md). Эта репликация гарантирует 99,99% [доступности SLA](https://azure.microsoft.com/support/legal/sla/cosmos-db) для всех учетных записей одного региона и всех многорайонных учетных записей с расслабленной согласованностью, и 99,999% доступности чтения на всех многорайонных учетных записях баз данных.|
|Автоматическая оперативная архивация|Базы данных Azure Cosmos регулярно резервируются и хранятся в георезервноом хранилище. <br><br>Дополнительные сведения см. в статье [Автоматическая оперативная архивация и восстановление с помощью Azure Cosmos DB](../synapse-analytics/sql-data-warehouse/backup-and-restore.md).|
|Восстановление удаленных данных|Автоматическая оперативная архивация может использоваться для восстановления данных, которые были случайно удалены. Это можно сделать максимум через 30 дней после события. <br><br>Узнайте больше в [автоматическом онлайн резервном копировании и восстановлении с Azure Cosmos DB](../synapse-analytics/sql-data-warehouse/backup-and-restore.md)|
|Защита и изолирование конфиденциальных данных|Ко всем данным, перечисленным в разделе "Новые возможности", теперь применяется шифрование неактивных данных.<br><br>Личные и другие конфиденциальные данные можно изолировать в определенном контейнере, а доступ для чтения и записи или только для чтения можно ограничить определенным списком пользователей.|
|Мониторинг атак|Используя [журналы аудиторских регистраций и активности,](logging.md)вы можете отслеживать свою учетную запись для нормальной и ненормальной активности. Вы можете просматривать, какие операции выполнялись с ресурсами, кто инициировал эти операции, время их выполнения, состояние операций и многое другое, как показано на снимке экрана после этой таблицы.|
|Реагирование на атаки|Когда вы обращаетесь в службу поддержки Azure и сообщаете о возможной атаке, запускается 5-этапная процедура реагирования на инцидент. Целью этой 5-этапной процедуры является как можно быстрее восстановить нормальную защиту и функционирование службы. Выполняется обнаружение проблемы и расследование инцидента.<br><br>Дополнительные сведения см. в статье [Microsoft Azure Security Response in the Cloud](https://aka.ms/securityresponsepaper) (Реагирование на нарушения безопасности в облаке Microsoft Azure).|
|Установка геозон|Azure Cosmos DB обеспечивает управление данными для отдельных регионов (например, Германия, Китай или US Gov).|
|Защищенное оборудование|Данные в Azure Cosmos DB хранятся на твердотельных накопителях SSD в защищенных центрах обработки данных Azure.<br><br>Дополнительные сведения о глобальных центрах обработки данных корпорации Майкрософт см. на [этой странице](https://www.microsoft.com/en-us/cloud-platform/global-datacenters).|
|Шифрование HTTPS, SSL и TLS|Все соединения с Azure Cosmos DB поддерживают HTTPS. Azure Cosmos DB также поддерживает TLS 1.2.<br>Можно обеспечить минимальный сервер версии TLS. Для этого, пожалуйста, свяжитесь с [azurecosmosdbtls@service.microsoft.com](mailto:azurecosmosdbtls@service.microsoft.com).|
|Шифрование при хранении|Все данные, хранимые в Azure Cosmos DB, хранятся в зашифрованном виде. Дополнительные сведения см. в статье [Шифрование неактивных данных базы данных в Azure Cosmos DB](./database-encryption-at-rest.md).|
|Установка исправлений на серверы|Являясь управляемой базой данных, Azure Cosmos DB избавляет от необходимости управлять серверами и устанавливать на них исправления. Это делается автоматически.|
|Административные учетные записи с надежными паролями|Пожалуй, даже не нужно упоминать об этом требовании, но, в отличие от некоторых наших конкурентов, в Azure Cosmos DB не может быть учетной записи администратора без пароля.<br><br> Для обеспечения безопасности в службу по умолчанию интегрированы функции SSL и аутентификации на основе секрета HMAC.|
|Сертификаты безопасности и защиты данных| Для самого современного списка сертификатов смотрите общий [сайт соответствия Azure,](https://www.microsoft.com/en-us/trustcenter/compliance/complianceofferings) а также последний [документ о соответствии Azure](https://gallery.technet.microsoft.com/Overview-of-Azure-c1be3942) со всеми сертификатами (поиск в Космосе). Для более целенаправленного читать проверить 25 апреля 2018 пост "Azure #CosmosDB: Безопасный, частный, совместимый, который включает в себя SOCS 1/2 Тип 2, HITRUST, PCI DSS Уровень 1, ISO 27001, HIPAA, FedRAMP High, и многие другие.

На следующем снимке экрана показано, как можно выполнять мониторинг учетной записи с помощью журналов аудита и действий: ![журналы действий для Azure Cosmos DB](./media/database-security/nosql-database-security-application-logging.png)

## <a name="next-steps"></a>Дальнейшие действия

Для получения дополнительной информации о ключевых клавишах и токенах ресурсов [см.](secure-access-to-data.md)

Для получения дополнительной информации [Azure Cosmos DB diagnostic logging](logging.md)о регистрации аудита см.

Для получения дополнительной информации о сертификатах Майкрософт можно получить в [Центре доверия Azure.](https://azure.microsoft.com/support/trust-center/)