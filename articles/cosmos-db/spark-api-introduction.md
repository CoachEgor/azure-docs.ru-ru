---
title: Введение во встроенную операционную аналитику в Azure Cosmos DB с использованием Apache Spark
description: Узнайте, как с помощью встроенной поддержки Apache Spark в Azure Cosmos DB выполнять задачи операционной аналитики и искусственного интеллекта.
ms.service: cosmos-db
ms.topic: overview
ms.date: 05/23/2019
author: rimman
ms.author: rimman
ms.openlocfilehash: 245df0632765c4000bdf5da3e428187d2b068866
ms.sourcegitcommit: 9dc7517db9c5817a3acd52d789547f2e3efff848
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/23/2019
ms.locfileid: "68402085"
---
# <a name="built-in-operational-analytics-in-azure-cosmos-db-with-apache-spark-preview"></a>Встроенная операционная аналитика в Azure Cosmos DB с использованием Apache Spark (предварительная версия) 

Встроенная поддержка Apache Spark в Azure Cosmos DB позволяет запускать из Apache Spark аналитику данных, которые хранятся в учетной записи Azure Cosmos. Azure Cosmos DB предоставляет собственную поддержку для заданий Apache Spark, что позволяет выполнять их непосредственно в глобально распределенных базах данных Cosmos. Благодаря таким возможностям разработчики, инженеры данных и специалисты по анализу данных могут использовать Azure Cosmos DB как гибкую, масштабируемую и высокопроизводительную платформу данных для рабочих нагрузок **OLTP и OLAP/HTAP**. 

Компонент Spark compute автоматически доступен во всех регионах Azure, связанных с вашей учетной записью Azure Cosmos. Задания Spark используют возможности Azure Cosmos DB по работе с несколькими источниками и могут записывать локальные реплики в каждом регионе или запрашивать их. 

> [!NOTE]
> Встроенная поддержка Apache Spark в Azure Cosmos DB в настоящее время находится на этапе ограниченной предварительной версии. Чтобы зарегистрироваться для использования предварительной версии, откройте страницу [регистрации для предварительной версии](https://portal.azure.com/?feature.customportal=false#create/Microsoft.DocumentDB). 

Поддержка Apache Spark в Azure Cosmos DB предоставляет следующие преимущества.

* Вы обеспечите анализ для географически распределенных пользователей и данных за минимальное время.

* Вы сможете упростить архитектуру решения и снизить [совокупную стоимость владения](total-cost-ownership.md). Для системы потребуется минимальное число компонентов для обработки данных, и вы сможете избежать лишнего перемещения данных между ними.

* Создает границу в системе для охвата всех управляемых данных, что упрощает обеспечение [безопасности](secure-access-to-data.md), соблюдение [соответствия](compliance.md) и выполнение аудита.

* Предоставляет конечным пользователям систему аналитики с постоянной доступностью или [высоким уровнем доступности](high-availability.md) с соблюдением строгих соглашений об уровне обслуживания.

![Визуализация поддержки Apache Spark в Azure Cosmos DB](./media/spark-api-introduction/spark-api-visualization.png)
 
С помощью поддержки Apache Spark в Azure Cosmos DB вы можете создавать и развертывать решения с такими технологиями, как искусственный интеллект и модели глубокого обучения, прогнозная аналитика, рекомендации, Интернет вещей, Customer 360, обнаружение мошенничества, анализ тональности текста и анализ сведений о посещении сайта. Все эти решения напрямую работают с данными в Azure Cosmos DB.

Вы можете настроить пакетные и потоковые задания ETL для Azure Cosmos DB, не выходя за рамки службы базы данных и не добавляя дополнительные службы вычислений. Вы можете гибко масштабировать вычислительную среду, если требуется выполнить задание ETL, а затем уменьшать масштаб после его завершения.

Поддержка Apache Spark в Azure Cosmos DB обеспечивает собственную поддержку машинного обучения в средах выполнения Apache Spark. Сюда входят Spark MLLib, Машинное обучение Майкрософт для Spark, Машинное обучение Azure и Cognitive Services. Благодаря такому набору функций специалисты по обработке и анализу данных могут за короткие сроки и с низкими затратами создавать и вводить в эксплуатацию модели машинного обучения непосредственно в Azure Cosmos DB.


## <a name="key-benefits"></a>Основные преимущества

### <a name="globally-distributed-low-latency-operational-analytics-and-ai"></a>Глобально распределенная система операционной аналитики и искусственного интеллекта с низкой задержкой

Применив Apache Spark к глобально распределенной базе данных Azure Cosmos, вы сможете быстро получать аналитические сведения по всему миру. Azure Cosmos DB обеспечивает **глобально распределенную операционную аналитику с низкой задержкой** и эластичным масштабированием, реализуя три основных методики:

* База данных Azure Cosmos глобально распределена, а значит все данные принимаются локально по месту нахождения поставщика данных (например, пользователей приложения). Запросы обслуживаются в ближайших локальных репликах как для поставщиков, так и для потребителей данных, независимо от их расположения. 

* Все аналитические запросы выполняются непосредственно по индексированным данным в разделах данных, без их излишнего перемещения. 

* Поскольку решение Spark размещено совместно с Azure Cosmos DB, снижается количество промежуточных преобразований и перемещений данных, что повышает производительность и масштабируемость системы.

### <a name="unified-serverless-experience-for-apache-spark"></a>Унифицированное бессерверное взаимодействие для Apache Spark

Многомодельная база данных Azure Cosmos DB расширяет поддержку интерфейсов API OSS, предоставляя **унифицированное бессерверное взаимодействие для Apache Spark** с поддержкой моделей данных для пар "ключ-значение", документов, графов и семейств столбцов. Поддерживаются разные модели данных с использованием API-интерфейсов MongoDB, Cassandra, Gremlin, Etcd и SQL, каждый из которых обрабатывает один набор базовых данных. 

Благодаря поддержке в Azure Cosmos DB доступна собственная поддержка приложений на языках Scala, Python и Java, а также несколько тесно интегрированных библиотек для SQL. Эти библиотеки поддерживают работу с SQL ([Spark SQL](https://spark.apache.org/sql/)), машинным обучением (Spark [MLlib](https://spark.apache.org/mllib/)), потоковой обработкой ([Структурированная потоковая передача Spark](https://spark.apache.org/streaming/)) и графами (Spark [GraphFrames]( https://docs.databricks.com/spark/latest/graph-analysis/graphframes/user-guide-python.html)). Эти инструменты облегчают применение Apache Spark для разных вариантов использования. Вам не придется отвлекаться на управление Spark или кластерами Spark. Вы можете использовать хорошо знакомые API-интерфейсы Apache Spark и **записные книжки Jupyter** для аналитики, а также API SQL или любой другой API OSS NoSQL (например, Cassandra) для одновременной транзакционной обработки одного набора базовых данных.

### <a name="no-schema-or-index-management"></a>Отсутствие необходимости управлять схемами или индексами

В отличие от традиционных аналитических баз данных, Azure Cosmos DB освобождает специалистов по обработке и анализу данных от управления громоздкими схемами и индексами. Ядро СУБД в Azure Cosmos DB не требует явных операций со схемами и (или) индексами, а также может автоматически индексировать все принимаемые данные и быстро обрабатывать запросы Apache Spark. 

### <a name="consistency-choices"></a>Варианты согласованности

Так как задания Apache Spark выполняются в разделах данных в базе данных Azure Cosmos, для запросов могут соблюдаться [пять четко определенных вариантов согласованности](consistency-levels.md). Эти модели согласованности обеспечивают гибкость при выборе строгости согласованности и позволяют получить оптимальную точность алгоритмов машинного обучения без повышения задержки и ухудшения уровня доступности. 

### <a name="comprehensive-slas"></a>Полный спектр соглашений об уровне обслуживания

На задания Apache Spark распространяются те же гарантии, что и на Azure Cosmos DB, с применением лучших в отрасли комплексных [соглашений об уровне обслуживания](https://azure.microsoft.com/support/legal/sla/documentdb/v1_1/) (с уровнем доступности 99,999) без дополнительных расходов на управление отдельными кластерами Apache Spark. Эти соглашения об уровне обслуживания предусматривают высокую пропускную способность, задержку на уровне 99-го процентиля, согласованность и высокий уровень доступности. 

### <a name="mixed-workloads"></a>Смешанные рабочие нагрузки

Интеграция Apache Spark с Azure Cosmos DB устраняет пропасть между транзакционными и аналитическими операциями, которая долго оставалась одной из самых проблемных точек для клиентов при создании облачных приложений в глобальном масштабе. 

## <a name="scenarios-for-azure-cosmos-db-spark-support"></a>Сценарии для поддержки Spark Azure Cosmos DB

### <a name="retail-and-consumer-goods"></a>Розничная торговля и потребительские товары

Вы можете использовать поддержку Spark в Azure Cosmos DB для предоставления рекомендаций и предложений в режиме реального времени. Вы можете помочь клиентам в обнаружении элементов, которые понадобятся им для персонализации и рекомендаций по продуктам в режиме реального времени.

* Вы можете использовать встроенную поддержку машинного обучения, предоставляемую средой выполнения Apache Spark, для создания рекомендаций по каталогам продуктов в режиме реального времени.

* Вы можете собирать данные посещаемости сайтов, данные о приобретениях и данные пользователей, чтобы предоставить целевые рекомендации, позволяющие увеличить значение времени существования.

* Используя функцию глобального распределения Azure Cosmos DB, можно мгновенно анализировать большие объемы данных о продуктах, которые распределяются по регионам.

* Вы можете быстро получить полезные сведения о географически распределенных пользователях и данных. Вы можете повысить коэффициент преобразования продвижения, предоставив нужное объявление нужному пользователю в нужное время.

* Вы можете использовать встроенную функцию потоковой передачи Spark для обогащения актуальных данных, объединив их со статическими данными пользователей. Таким образом, вы можете предоставлять более персонализированные и целевые объявления в режиме реального времени с учетом действий клиентов.

На следующем рисунке показано, как поддержка Azure Cosmos DB Spark используется для оптимизации цен и рекламных предложений:

![Поддержка Spark Azure Cosmos DB для оптимизации цен и рекламных предложений](./media/spark-api-introduction/optimize-pricing-and-promotions.png)


На следующем рисунке показано, как поддержка Azure Cosmos DB Spark используется в подсистеме рекомендаций в режиме реального времени:

![Поддержка Spark Azure Cosmos DB в подсистеме рекомендаций в режиме реального времени](./media/spark-api-introduction/real-time-recommendation-engine.png)

### <a name="manufacturing-and-iot"></a>Производство и Интернет вещей

Встроенная платформа аналитики Azure Cosmos DB позволяет в реальном времени анализировать данные Интернета вещей с миллионов устройств в глобальном масштабе. Вы можете создавать современные инновации, такие как прогнозирование погодных условий, прогнозный анализ и оптимизация энергопотребления.

* Используя Azure Cosmos DB, вы можете анализировать данные, такие как метрики активов в реальном времени и погодные факторы, а затем применять аналитику интеллектуальной сети для оптимизации производительности подключенных устройств в разных расположениях. Аналитика интеллектуальной сети является ключом к контролю за эксплуатационными расходами, повышению надежности сетки и предоставлению персонализированных служб энергоснабжения для пользователей.

На следующем рисунке показано, как поддержка Spark в Azure Cosmos DB используется для считывания метрик с устройств Интернета вещей и применения интеллектуальной аналитики сетей:

![Поддержка Spark Azure Cosmos DB для считывания метрик с устройств Интернета вещей](./media/spark-api-introduction/read-metrics-from-iot-devices.png)


### <a name="predictive-maintenance"></a>Прогнозное обслуживание

* Обслуживание таких ресурсов, как компрессоры, которые используются в небольших бурильных установках для глубоководных платформ, является сложной задачей. Эти ресурсы расположены по всему миру и создают петабайты данных. С помощью Azure Cosmos DB вы можете создать сквозной конвейер прогнозирования данных, который использует потоковую передачу Spark для обработки больших объемов данных телеметрии датчиков, хранения частей ресурсов и данных сопоставления датчиков.

* Вы можете создавать и развертывать модели машинного обучения для прогнозирования сбоев ресурсов до того, как они произойдут, и для выполнения заданий на техническое обслуживание до возникновения сбоя.

На следующем рисунке показано, как поддержка Spark в Azure Cosmos DB используется для создания системы прогнозного обслуживания:

![Поддержка Spark Azure Cosmos DB для построения системы прогнозного обслуживания](./media/spark-api-introduction/predictive-maintenance-system.png)

На следующем рисунке показано, как поддержка Spark в Azure Cosmos DB используется для создания системы диагностики транспортных средств в режиме реального времени:

![Поддержка Spark Azure Cosmos DB для создания системы диагностики транспортных средств в режиме реального времени](./media/spark-api-introduction/real-time-vehicle-diagnostic-system.png)

### <a name="gaming"></a>Игры

* Благодаря встроенной поддержке Spark Azure Cosmos DB позволяет легко создавать, масштабировать и развертывать расширенные модели аналитики и машинного обучения за считанные минуты, чтобы максимально расширить возможности игрового процесса.

* Вы можете анализировать данные об игроках, покупках и поведении, чтобы создавать соответствующие персонализированные предложения для достижения высоких показателей преобразования.

* С помощью машинного обучения Spark можно анализировать данные телеметрии игр и получать сведения о них. Вы можете диагностировать и предотвращать медленную загрузку и внутриигровые проблемы.

На следующем рисунке показано, как поддержка Spark Azure Cosmos DB используется в игровой аналитике:

![Поддержка Spark Azure Cosmos DB в аналитике игры](./media/spark-api-introduction/gaming-analytics.png)

## <a name="built-in-jupyter-notebooks-support"></a>Встроенная поддержка записных книжек Jupyter

Azure Cosmos DB поддерживает встроенные записные книжки Jupyter для всех интерфейсов API, например Cassandra, MongoDB, SQL, Gremlin и таблицы. Записные книжки Jupyter выполняются в учетных записях Azure Cosmos, расширяя возможности разработчиков. Встроенная поддержка записных книжек для всех API-интерфейсов Azure Cosmos DB и моделей данных позволяет выполнять запросы интерактивно. Вы также можете выполнять модели машинного обучения и анализировать данные, хранимые в базах данных Azure Cosmos. С помощью записных книжек Jupyter можно анализировать сохраненные данные, создавать и обучать модели машинного обучения, а также выполнять объединение данных на портале Azure, как показано на следующем рисунке:

![Поддержка записных книжек Jupyter в Azure Cosmos DB](./media/spark-api-introduction/jupyter-notebooks-portal.png)

## <a name="next-steps"></a>Дополнительная информация

* Чтобы узнать о преимуществах Azure Cosmos DB, изучите [эту обзорную статью](introduction.md).
* [API Azure Cosmos DB для MongoDB](mongodb-introduction.md)
* [Знакомство с API Cassandra для Azure Cosmos DB](cassandra-introduction.md)
* [Знакомство с Azure Cosmos DB: API Gremlin](graph-introduction.md)
* [Знакомство с Azure Cosmos DB. API таблиц](table-introduction.md)




