---
title: Оптимизация затрат на операции чтения и записи в Azure Cosmos DB
description: В этой статье описано, как сократить расходы на Azure Cosmos DB, связанные с выполнением операций чтения и записи данных.
author: rimman
ms.service: cosmos-db
ms.topic: conceptual
ms.date: 05/21/2019
ms.author: rimman
ms.openlocfilehash: 13ce5ee8b0e2a5d9cc84ea1a408ebba152b46050
ms.sourcegitcommit: e9a46b4d22113655181a3e219d16397367e8492d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/21/2019
ms.locfileid: "65967407"
---
# <a name="optimize-reads-and-writes-cost-in-azure-cosmos-db"></a>Оптимизация затрат на выполнения операций чтения и записи в Azure Cosmos DB

В этой статье описывается, как вычисляется стоимость чтения и записи данных в Azure Cosmos DB. К операциям чтения элементов относятся все операции get, а к операциям записи — insert, replace, delete и upsert.  

## <a name="cost-of-reads-and-writes"></a>Стоимость операций чтения и записи

Azure Cosmos DB гарантирует прогнозируемую производительность по параметрам пропускной способности и задержек, используя модель подготовленной пропускной способности. Подготовленная пропускная способность выражается в [единицах запросов](request-units.md) в секунду. Единицы запроса (ЕЗ) представляют собой логическую абстракцию определенного набора вычислительных ресурсов, в том числе ЦП, памяти и устройств ввода-вывода, необходимых для выполнения запроса. Подготовленная пропускная способность резервирует определенное количество ЕЗ для вашего контейнера или базы данных, что позволяет гарантировать предсказуемые значения пропускной способности и задержки. Подготовленная пропускная способность позволяет Azure Cosmos DB обеспечить стабильную и предсказуемую производительность, гарантировать низкую задержку и высокий уровень доступности в любом масштабе. Единицы запроса выполняют роль нормализованной "валюты", которая упрощает принятие решений о выделении ресурсов приложению. 

Вам не нужно беспокоиться о распределении ЕЗ между операциями чтения и записи. Модель унифицированной валюты позволяет эффективно использовать одну и ту же пропускную способность для операций чтения и записи. В следующей таблице показана стоимость операций чтения и записи в ЕЗ/с для элементов размером 1 КБ и 100 КБ.

|**Размер элемента**  |**Стоимость одной операции чтения** |**Стоимость одной операции записи**|
|---------|---------|---------|
|1 КБ |1 ЕЗ |5 ЕЗ |
|100 КБ |10 ЕЗ |50 ЕЗ |

На чтение элемента размером 1 КБ затрачивается 1 ЕЗ. На запись элемента размером 1 КБ затрачивается 5 ЕЗ. Такая стоимость чтения и записи применяется при стандартной [согласованности](consistency-levels.md) на уровне сеанса.  На стоимость, выраженную в ЕЗ, влияют следующие факторы: размер элементов, число свойств, согласованность данных, индексированные свойства, индексирование и шаблоны запроса.

## <a name="normalized-cost-for-1-million-reads-and-writes"></a>Нормализованная стоимость для 1 млн операций чтения и записи

Подготовленная производительность 1000 ЕЗ/с эквивалентна 3,6 млн ЕЗ/ч, и ее стоимость составит 0,08 долл. США в час (в регионах США и Европы). Это означает, что с такой подготовленной пропускной способностью вы сможете каждый час выполнять 3,6 млн операций чтения или 0,72 млн (`3.6 million RU / 5`) операций записи для блоков размером 1 КБ. Приводя эти расчеты к миллионам операций чтения и записи, стоимость можно выразить как 0,022 долл. США за 1 млн операций чтения (0,08 долл. США/3,6 млн) и 0,111 долл. США за 1 миллион операций записи (0,08 долл. США/0,72 млн).

## <a name="number-of-regions-and-the-request-units-cost"></a>Количество регионов и стоимость единиц запросов

Затраты на операции записи остаются постоянными независимо от числа регионов, связанных с учетной записью Azure Cosmos. Это означает, что запись блока размером 1 КБ всегда стоит ровно пять ЕЗ, независимо от количества регионов, которые связаны с учетной записью. Затраты ресурсов на репликацию, прием и обработку трафика репликации в каждом регионе, невозможно вычислить простым способом. Дополнительные сведения об оптимизации расходов при работе в нескольких регионах см. в [этой статье](optimize-cost-regions.md).

## <a name="optimize-the-cost-of-writes-and-reads"></a>Оптимизация стоимости операций чтения и записи

При выполнении операций записи следует подготовить достаточную пропускную способность для планируемого числа операций записи в секунду. Вы можете увеличить подготовленную пропускную способность перед выполнением операций записи, используя пакет SDK, портал или интерфейс командной строки, а затем восстановить прежний уровень пропускной способности после завершения операций. Пропускная способность на период записи вычисляется как минимальная пропускная способность для имеющегося объема данных плюс пропускная способность на рабочую нагрузку вставки, если в это время не выполняются другие рабочие нагрузки. 

Если одновременно сохраняются другие рабочие нагрузки, например для запросов, чтения, обновления или удаления, следует учесть в расчетах дополнительные ЕЗ для выполнения таких операций. Если операции записи ограничены по скорости, настройте подходящую политику повторов и отсрочек с помощью пакетов SDK для Azure Cosmos DB. Например, можно увеличивать нагрузку до тех пор, пока часть запросов не начнет отбрасываться из-за ограничений по скорости. Когда сработает ограничение по скорости, в клиентском приложении следует применить отсрочку для тех запросов, по которым срабатывает ограничение, на установленный в ограничении интервал. Прежде, чем продолжать операции записи, выждите минимально допустимый промежуток времени между повторными попытками. Поддержка политики повтора включена в пакеты SDK для SQL .NET, Java, Node.js и Python, а также во все поддерживаемые версии пакетов SDK для .NET Core. 

Также вы можете применить в Azure Cosmos DB массовую вставку данных или копирование из любого поддерживаемого в Azure Cosmos DB источника данных с помощью [Фабрики данных Azure](../data-factory/connector-azure-cosmos-db.md). Фабрика данных Azure поддерживает интеграцию с библиотекой массовых операций для Azure Cosmos DB, что обеспечивает оптимальную производительность при операциях записи.

## <a name="next-steps"></a>Дальнейшие действия

Теперь вы можете перейти к подробным сведениям об оптимизации затрат в Azure Cosmos DB, которые представлены в следующих статьях.

* Дополнительные сведения [об оптимизации для разработки и тестирования](optimize-dev-test.md).
* Дополнительные сведения о [расшифровке счета Azure Cosmos DB](understand-your-bill.md)
* Дополнительные сведения об [оптимизации расходов на пропускную способность](optimize-cost-throughput.md)
* Дополнительные сведения [об оптимизации расходов на хранилище](optimize-cost-storage.md).
* Дополнительные сведения [об оптимизации расходов на запросы](optimize-cost-queries.md).
* Дополнительные сведения об [оптимизации затрат на учетные записи Azure Cosmos с поддержкой нескольких регионов](optimize-cost-regions.md).
