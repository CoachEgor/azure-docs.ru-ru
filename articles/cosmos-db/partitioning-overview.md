---
title: Секционирование в базе данных Azure Cosmos DB
description: Общие сведения о секционировании в Azure Cosmos DB.
ms.author: rimman
author: rimman
ms.service: cosmos-db
ms.topic: conceptual
ms.date: 08/01/2019
ms.openlocfilehash: e80e548ceae2149fe7061da42c71ee8b61f00a72
ms.sourcegitcommit: a52f17307cc36640426dac20b92136a163c799d0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/01/2019
ms.locfileid: "68717554"
---
# <a name="partitioning-in-azure-cosmos-db"></a>Секционирование в базе данных Azure Cosmos DB

Azure Cosmos DB использует секционирование для масштабирования отдельных контейнеров в базе данных в соответствии с потребностями производительности приложения. При секционировании элементы в контейнере делятся на отдельные подмножества, называемые *логическими секциями*. Логические секции формируются на основе значения *ключа секции* , связанного с каждым элементом в контейнере. Все элементы в логической секции имеют одинаковое значение ключа секции.

Например, контейнер содержит элементы. Каждый элемент имеет уникальное значение для `UserID` свойства. Если `UserID` используется в качестве ключа секции для элементов в контейнере и имеется 1 000 уникальных `UserID` значения, то для контейнера создаются 1 000 логических секции.

В дополнение к ключу секции, определяющему логическую секцию элемента, каждый элемент в контейнере имеет *идентификатор элемента* (уникальный в пределах логической секции). Сочетание ключа секции и идентификатора элемента создает *индекс*элемента, который однозначно определяет элемент.

[Выбор ключа секции](partitioning-overview.md#choose-partitionkey) — это важное решение, которое повлияет на производительность приложения.

## <a name="managing-logical-partitions"></a>Управление логическими секциями

Azure Cosmos DB прозрачно и автоматически управляет размещением логических секций в физических секциях для эффективного удовлетворения требований к масштабируемости и производительности контейнера. По мере увеличения требований к пропускной способности и хранению приложения Azure Cosmos DB перемещает логические секции, чтобы автоматически распределять нагрузку между большим количеством серверов. 

Azure Cosmos DB использует секционирование на основе хэша для распределения логических секций по физическим секциям. Azure Cosmos DB хэширует значение ключа секции элемента. Хэшированный результат определяет физическую секцию. Затем Azure Cosmos DB выделяет пространство ключей для хэшей ключей секций равномерно по физическим секциям.

Запросы, обращающиеся к данным в пределах одной логической секции, являются более экономичными, чем запросы, обращающиеся к нескольким секциям. Транзакции (в хранимых процедурах или триггерах) допускаются только для элементов в одном логическом разделе.

Дополнительные сведения о том, как Azure Cosmos DB управляет секциями, см. в разделе [логические разделы](partition-data.md). (Нет необходимости понимать внутренние сведения для сборки или запуска приложений, но это можно добавить для читателя.)

## <a id="choose-partitionkey"></a>Выбор ключа секции

Ниже приведено хорошее руководство по выбору ключа секции:

* У одной логической секции есть верхний предел в 10 ГБ хранилища.  

* У контейнеров Cosmos Azure Минимальная пропускная способность 400 единиц запросов в секунду (штук/с). Когда в базе данных подготавливается пропускная способность, минимальное количество записей на контейнер — 100 единиц запросов в секунду. Запросы к одному и тому же ключу секции не могут превышать пропускную способность, выделенную для секции. Если количество запросов превышает установленную пропускную способность, запросы имеют ограниченный размер. Поэтому важно выбрать ключ секции, который не создает "горячие точки" в приложении.

* Выберите ключ секции с широким диапазоном значений и доступом к шаблонам, равномерно распределенным по логическим секциям. Это помогает распределять данные и действия в контейнере по набору логических секций, чтобы ресурсы для хранения и пропускной способности могли распределяться по логическим секциям.

* Выберите ключ секции, который равномерно распределяет рабочую нагрузку по всем секциям и равномерно по времени. Выбор ключа секции должен сбалансировать потребность в эффективных запросах секционирования и транзакциях относительно цели распределения элементов по нескольким секциям для достижения масштабируемости.

* Кандидаты на ключи секций могут содержать свойства, часто отображаемые в виде фильтра в запросах. Запросы можно эффективно перенаправлять путем включения ключа секции в предикат фильтра.

## <a name="next-steps"></a>Следующие шаги

* Дополнительные сведения о [секционировании и горизонтальном масштабировании в Azure Cosmos DB](partition-data.md).
* Дополнительные сведения о подготовленной пропускной способности в базе данных Azure Cosmos DB см. в [этой статье](request-units.md).
* Дополнительные сведения о глобальном распределении в базе данных Azure Cosmos DB см. в [этой статье](distribute-data-globally.md).
