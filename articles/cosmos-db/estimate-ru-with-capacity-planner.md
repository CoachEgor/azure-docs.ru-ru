---
title: Оценка затрат с помощью планировщика мощностей Azure Cosmos DB
description: Планировщик емкости Azure Cosmos DB позволяет оценить требуемую пропускную способность (RU/s) и стоимость рабочей нагрузки. В этой статье описывается, как использовать новую версию планировщика емкости для оценки требуемой пропускной способности и затрат.
author: deborahc
ms.service: cosmos-db
ms.topic: conceptual
ms.date: 07/30/2019
ms.author: dech
ms.openlocfilehash: f10ace47f774e31b586f7736f5fb8e5dfea0c948
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/27/2020
ms.locfileid: "68707634"
---
# <a name="estimate-rus-using-the-azure-cosmos-db-capacity-planner"></a>Оцените RU/s с помощью планировщика емкости Azure Cosmos DB

Настройка баз данных и контейнеров Azure Cosmos с нужным объемом прокладки, или [единиц запроса (RU/s),](request-units.md)для рабочей нагрузки необходима для оптимизации затрат и производительности. В этой статье описывается, как использовать [планировщик емкости](https://cosmos.azure.com/capacitycalculator/) Azure Cosmos DB для получения оценки требуемых RU/s и стоимости вашей рабочей нагрузки. 

## <a name="how-to-estimate-throughput-and-cost-with-azure-cosmos-db-capacity-planner"></a>Как оценить пропускную способность и стоимость с планировщиком мощностей Azure Cosmos DB

Планировщик емкости может использоваться в двух режимах.

|**Режим**  |**Описание**  |
|---------|---------|
|Basic|Обеспечивает быструю, высокоуровневую ru/s и смету затрат. Этот режим предполагает настройки DB по умолчанию Azure Cosmos для политики индексирования, согласованности и других параметров. <br/><br/>Используйте базовый режим для быстрой и высокоуровневой оценки при оценке потенциальной рабочей нагрузки для выполнения на Azure Cosmos DB.|
|Дополнительно|Обеспечивает более подробную оценку RU/s и затрат с возможностью настройки дополнительных настроек - политики индексации, уровня согласованности и других параметров, влияющих на стоимость и пропускную способность. <br/><br/>Используйте расширенный режим, когда вы оцениваете RU/s для нового проекта или хотите получить более подробную оценку. |


## <a name="estimate-provisioned-throughput-and-cost-using-basic-mode"></a>Оценить прокладку и стоимость с использованием базового режима
Чтобы получить быструю оценку рабочей нагрузки с помощью базового режима, перейдите к [планировщику емкости.](https://cosmos.azure.com/capacitycalculator/) Введите следующие параметры в зависимости от рабочей нагрузки: 

|**Входные данные**  |**Описание**  |
|---------|---------|
|Количество регионов|Служба Azure Cosmos DB доступна во всех регионах Azure. Выберите количество областей, необходимых для рабочей нагрузки. Вы можете связать любое количество регионов с вашей учетной записью «Космос». Более подробную информацию можно узнать из [глобального дистрибутива](distribute-data-globally.md) в DB Azure Cosmos.|
|Выполнение операций записи в нескольких регионах|Если вы включите [многорегиональные записи,](distribute-data-globally.md#key-benefits-of-global-distribution)приложение может читать и писать в любой регион Azure. Если вы отменяете многорегионковую запись, приложение может записывать данные в один регион. <br/><br/> Включить многорегиональные записи, если вы ожидаете иметь активную рабочую нагрузку, которая требует низкой задержки записи в разных регионах. Например, рабочая нагрузка IOT, которая записывает данные в базу данных в больших объемах в разных регионах. <br/><br/> Multi-регион пишет гарантии 99,999% чтения и записи доступности. Многорегиональные записи требуют большей пропускной выхажера по сравнению с отдельными регионами записи. Чтобы узнать больше, [посмотрите, как RUs отличаются для одной и многозаписной статьи регионов.](optimize-cost-regions.md)|
|Общее количество хранимых данных (в регионе)|Общие расчетные данные, хранящиеся в ГБ в одном регионе.|
|Размер элемента|Предполагаемый размер элемента данных (например, документа), от 1 КБ до 2 МБ. |
|Чтения/сек в регионе|Количество ожидаемых считываемых в секунду. |
|Записывает/сек в регионе|Количество записей, ожидаемых в секунду. |

После заполнения необходимых деталей выберите **Calculate**. Вкладка **Оценки затрат** показывает общую стоимость хранения и прокладку. Вы можете расширить ссылку **Показать Подробности** в этой вкладке, чтобы получить разбивку пропускной записи, необходимой для чтения и записи запросов. Каждый раз, когда вы изменяете значение любого поля, **выберите Рассчитать,** чтобы пересчитать сметную стоимость. 

![Базовый режим планировщика емкости](./media/estimate-ru-with-capacity-planner/basic-mode.png)

## <a name="estimate-provisioned-throughput-and-cost-using-advanced-mode"></a>Оценить просеченную пропускную плату и стоимость с помощью расширенного режима

Расширенный режим позволяет предоставить больше настроек, влияющих на оценку RU/s. Чтобы использовать эту опцию, перейдите к [планировщику емкости](https://cosmos.azure.com/capacitycalculator/) и войдите в инструмент с учетной записью, которая используется для Azure. Опция вступления доступна в правом углу. 

После вхождения в систему можно увидеть дополнительные поля по сравнению с полями в базовом режиме. Введите дополнительные параметры в зависимости от рабочей нагрузки. 

|**Входные данные**  |**Описание**  |
|---------|---------|
|API|Azure Cosmos DB — это многомодельная и мульти-API-сервис. Для новых рабочих нагрузок выберите API Для S'L (Core). |
|Количество регионов|Служба Azure Cosmos DB доступна во всех регионах Azure. Выберите количество областей, необходимых для рабочей нагрузки. Вы можете связать любое количество регионов с вашей учетной записью «Космос». Более подробную информацию можно узнать из [глобального дистрибутива](distribute-data-globally.md) в DB Azure Cosmos.|
|Выполнение операций записи в нескольких регионах|Если вы включите [многорегиональные записи,](distribute-data-globally.md#key-benefits-of-global-distribution)приложение может читать и писать в любой регион Azure. Если вы отменяете многорегионковую запись, приложение может записывать данные в один регион. <br/><br/> Включить многорегиональные записи, если вы ожидаете иметь активную рабочую нагрузку, которая требует низкой задержки записи в разных регионах. Например, рабочая нагрузка IOT, которая записывает данные в базу данных в больших объемах в разных регионах. <br/><br/> Multi-регион пишет гарантии 99,999% чтения и записи доступности. Многорегиональные записи требуют большей пропускной выхажера по сравнению с отдельными регионами записи. Чтобы узнать больше, [посмотрите, как RUs отличаются для одной и многозаписной статьи регионов.](optimize-cost-regions.md)|
|По умолчанию последовательность|Azure Cosmos DB поддерживает 5 уровней согласованности, что позволяет разработчикам сбалансировать компромисс между согласованностью, доступностью и задержкой. Чтобы узнать больше, смотрите статью [уровней согласованности.](consistency-levels.md) <br/><br/> По умолчанию Azure Cosmos DB использует согласованность сеанса, которая гарантирует возможность чтения собственных записей в сеансе. <br/><br/> Выбор сильной или ограниченной черствости потребует двойного увеличения требуемого RU/s для чтения, по сравнению с сеансом, последовательной префикса и возможной согласованности. Сильная согласованность с многорайонными пишет не поддерживается и автоматически по умолчанию для одного региона пишет с сильной последовательности. |
|Политика индексации|По умолчанию Azure Cosmos DB [индексирует все свойства](index-policy.md) во всех элементах для гибких и эффективных запросов (карты к политике **автоматической** индексации). <br/><br/> Если вы **off**выберете, ни одно из свойств не индексируется. Это приводит к самой низкой платы RU для записей. Выберите **от** политики, если вы ожидаете только делать [точки читает](https://docs.microsoft.com/dotnet/api/microsoft.azure.cosmos.container.readitemasync?view=azure-dotnet) (ключевое значение поиска) и / или пишет, и никаких запросов. <br/><br/> Пользовательская политика индексирования позволяет включать или исключать определенные свойства из индекса для более низкой пропускной записи и хранения. Чтобы узнать больше, смотрите статьи о [политике индексирования](index-overview.md) и [выборке политик и политик индексирования.](how-to-manage-indexing-policy.md#indexing-policy-examples)|
|Общее количество хранимых данных (в регионе)|Общие расчетные данные, хранящиеся в ГБ в одном регионе.|
|Режим рабочей нагрузки|Выберите **Steady,** если объем рабочей нагрузки является постоянным. <br/><br/> Выберите **variable,** если объем рабочей нагрузки изменяется с течением времени.  Например, в течение определенного дня или месяца. <br/><br/> При выборе варианта переменной рабочей нагрузки доступны следующие параметры:<ul><li>Процент времени на пике: Процент времени в месяц, когда рабочая нагрузка требует пиковой (самой высокой) пропускной выхаже. <br/><br/> Например, если у вас есть рабочая нагрузка, которая имеет высокую активность в течение 9 утра - 6 вечера будний рабочий день в рабочее время, то процент времени на пике: 45 часов в пик / 730 часов / месяц - 6%.<br/><br/></li><li>Чтения/сек в регионе на пике - Количество считываемых, ожидаемых в секунду на пике.</li><li>Пишет/сек в регионе на пике - Количество записок ожидается в секунду на пике.</li><li>Чтения / сек в регионе от пика - Количество считывает ожидается в секунду во время от пика.</li><li>Пишет/сек в регионе от пика - Количество записок ожидается в секунду во время от пика.</li></ul>С пиковыми и внепиковыми интервалами, вы можете оптимизировать свои расходы [за счет программного масштабирования вашей прокладки](set-throughput.md#update-throughput-on-a-database-or-a-container) и вниз соответственно.|
|Размер элемента|Размер элемента данных (например, документа), от 1 КБ до 2 МБ. <br/><br/>Вы также можете **загрузить образец (JSON)** документ для более точной оценки.<br/><br/>Если рабочая нагрузка имеет несколько типов элементов (с разным содержанием JSON) в одном контейнере, вы можете загрузить несколько документов JSON и получить оценку. Используйте кнопку **Добавить новый элемент,** чтобы добавить несколько образцов документов JSON.|

Вы также можете использовать кнопку **«Сохранить оценку»** для загрузки файла CSV, содержащего текущую оценку. 

![Расширенный режим планировщика емкости](./media/estimate-ru-with-capacity-planner/advanced-mode.png)

Цены, указанные в планировщике мощностей Azure Cosmos DB, представляют оценки, основанные на государственных тарифах на пропускную способность и хранение. Все цены отображаются в долларах США. Для просмотра всех тарифов по регионам обратитесь на [страницу ценообразования Azure Cosmos DB.](https://azure.microsoft.com/pricing/details/cosmos-db/)  

## <a name="estimating-throughput-for-queries"></a>Оценка пропускной высохла для запросов

Калькулятор емкости Azure Cosmos предполагает считывание точек (прочитанное одного элемента, например документа, по ключевому значению идентификатора и раздела) и записывает для рабочей нагрузки. Чтобы оценить пропускную емкость, необходимую для запросов, запустите запрос на репрезентативном наборе данных в контейнере Cosmos и [получите заряд RU.](find-request-unit-charge.md) Умножьте плату RU на количество запросов, которые, как предполагается, будут запускаться в секунду, чтобы получить требуемый объем RU/s. 

Например, если ваша рабочая нагрузка требует запроса, ``SELECT * FROM c WHERE c.id = 'Alice'`` который работает 100 раз в секунду, а плата RU запроса составляет 10 rUs, вам потребуется 100 запросов / сек 10 RU / запрос 1000 RU/s в общей сложности для обслуживания этих запросов. Добавьте эти RU/s в RU/s, необходимые для любых считываний или записей, происходящих в вашей рабочей нагрузке.

## <a name="next-steps"></a>Дальнейшие действия

* Узнайте больше о [ценовой модели Azure Cosmos DB.](how-pricing-works.md)
* Создайте новую [учетную запись Космос, базу данных и контейнер.](create-cosmosdb-resources-portal.md)
* Узнайте, как [оптимизировать стоимость прокладки.](optimize-cost-throughput.md)
* Узнайте, как [оптимизировать затраты с зарезервированной емкостью.](cosmos-db-reserved-capacity.md)

