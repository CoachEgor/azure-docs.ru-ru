---
title: Управление ресурсами Azure Cosmos DB с помощью Обозревателя службы хранилища Azure
description: Узнайте, как подключиться к Azure Cosmos DB и управлять своими ресурсами с помощью Обозревателя службы хранилища Azure.
author: deborahc
ms.service: cosmos-db
ms.topic: how-to
ms.date: 08/24/2020
ms.author: dech
ms.custom: seodec18, has-adal-ref
ms.openlocfilehash: d1948ae186662c7f60f4d49c19a4d48b424a38f7
ms.sourcegitcommit: 8a7b82de18d8cba5c2cec078bc921da783a4710e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/28/2020
ms.locfileid: "89047485"
---
# <a name="work-with-data-using-azure-storage-explorer"></a>Работа с данными с помощью Обозревателя службы хранилища Azure

В Обозревателе службы хранилища Azure можно управлять объектами Azure Cosmos DB и работать с данными, хранимыми процедурами и триггерами, а также другими объектами Azure, такими как хранилища BLOB-объектов и очереди. Теперь это средство можно использовать для управления всеми объектами Azure в одном месте. Сейчас обозреватель службы хранилища Azure поддерживает учетные записи Cosmos, настроенные для SQL, MongoDB, Graph и API таблиц.


## <a name="prerequisites"></a>Предварительные требования

Учетная запись Cosmos с API SQL или API Azure Cosmos DB для MongoDB. Если у вас нет учетной записи, вы можете создать ее на портале Azure, как описано в разделе [Azure Cosmos DB. Создание веб-приложения API SQL с использованием языка .NET и портала Azure](create-sql-api-dotnet.md).

## <a name="installation"></a>Установка

Скачать новейшие версии обозревателя службы хранилища Azure можно отсюда: [обозреватель хранилищ Azure](https://azure.microsoft.com/features/storage-explorer/), теперь мы поддерживаем версии для Windows, MAC и Linux.

## <a name="connect-to-an-azure-subscription"></a>Подключение к подписке Azure

1. После установки **Обозреватель службы хранилища Azure**выберите значок **подключаемого модуля** слева, как показано на следующем рисунке:

   :::image type="content" source="./media/storage-explorer/plug-in-icon.png" alt-text="Выберите значок подключаемого модуля для подключения":::

2. Выберите **Add an Azure Account** (Добавить учетную запись Azure), а затем щелкните **Войти**.

   :::image type="content" source="./media/storage-explorer/connect-to-azure-subscription.png" alt-text="Подключение к требуемой подписке Azure":::

2. В диалоговом окне **входа в Azure** выберите **Вход**и введите учетные данные Azure.

    :::image type="content" source="./media/storage-explorer/sign-in.png" alt-text="Вход в подписку Azure":::

3. Выберите подписку в списке и нажмите кнопку **Применить**.

    :::image type="content" source="./media/storage-explorer/apply-subscription.png" alt-text="Выберите идентификатор подписки из списка для фильтрации":::

    На панели Обозревателя будут показаны учетные записи в выбранной подписке.

    :::image type="content" source="./media/storage-explorer/account-list.png" alt-text="Выберите учетную запись Azure Cosmos DB из списка доступных":::

    Вы успешно подключились к **учетной записи Cosmos DB** в подписке Azure.

## <a name="connect-to-azure-cosmos-db-by-using-a-connection-string"></a>Подключение к Azure Cosmos DB с использованием строки подключения

Другой способ подключения к Azure Cosmos DB — с помощью строки подключения. Для подключения с помощью строки подключения выполните следующие действия.

1. Найдите элемент **Local and Attached** (Локальные и присоединенные) в дереве слева, щелкните правой кнопкой мыши **Учетные записи Cosmos DB** и выберите **Connect to Cosmos DB** (Подключиться к Cosmos DB).

    :::image type="content" source="./media/storage-explorer/connect-to-db-by-connection-string.png" alt-text="Подключение к Azure Cosmos DB с использованием строки подключения":::

2. Сейчас поддерживаются только API SQL и API службы таблиц. Выберите API, вставьте **строку подключения**, **метку входной учетной записи**, нажмите кнопку **Далее** , чтобы просмотреть сводку, а затем выберите **Подключиться** к Azure Cosmos DB учетной записи. Сведения о получении основной строки подключения см. в разделе [Получение строки подключения](manage-with-powershell.md#list-keys).

    :::image type="content" source="./media/storage-explorer/connection-string.png" alt-text="Введите строку подключения":::

## <a name="connect-to-azure-cosmos-db-by-using-local-emulator"></a>Подключение к Azure Cosmos DB с помощью локального эмулятора

Выполните следующие действия, чтобы подключиться к Azure Cosmos DB с помощью эмулятора. Эта возможность сейчас доступна только для учетной записи SQL.

1. Установите и запустите эмулятор. Инструкции по установке эмулятора см. в статье об [эмуляторе Cosmos DB](https://docs.microsoft.com/azure/cosmos-db/local-emulator)

2. Найдите элемент **Local and Attached** (Локальные и присоединенные) в дереве слева, щелкните правой кнопкой мыши **Учетные записи Cosmos DB** и выберите **Connect to Cosmos DB Emulator** (Подключиться к эмулятору Cosmos DB).

    :::image type="content" source="./media/storage-explorer/emulator-entry.png" alt-text="Подключение к Azure Cosmos DB из эмулятора":::

3. Сейчас поддерживается только API SQL. Вставьте **строку подключения**, **метку входной учетной записи**, нажмите кнопку **Далее** , чтобы проверить сводку, а затем выберите **Подключиться** к Azure Cosmos DB учетной записи. Сведения о получении основной строки подключения см. в разделе [Получение строки подключения](manage-with-powershell.md#list-keys).

    :::image type="content" source="./media/storage-explorer/emulator-dialog.png" alt-text="Подключение к Cosmos DB из диалогового окна эмулятора":::


## <a name="azure-cosmos-db-resource-management"></a>Управление ресурсами Azure Cosmos DB

Для управления учетной записью Azure Cosmos DB вы можете выполнять следующие операции:
* Открытие учетной записи на портале Azure
* Добавление ресурса в список быстрого доступа
* Поиск и обновление ресурсов
* Создание и удаление баз данных
* Создание и удаление коллекций
* Создание, изменение, удаление и фильтрации документов
* Управление хранимыми процедурами, триггерами и определяемыми пользователем функциями

### <a name="quick-access-tasks"></a>Задачи для быстрого доступа

Щелкнув подписку на панели Обозревателя правой кнопкой мыши, вы сможете выполнить множество быстрых действий:

* Щелкнув правой кнопкой мыши учетную запись Azure Cosmos DB или базу данных и выбрав **Открыть на портале**, вы сможете управлять этим ресурсом в браузере на портале Azure.

  :::image type="content" source="./media/storage-explorer/open-in-portal.png" alt-text="Открытие ресурса на портале":::

* Вы также можете добавить на панель **быстрого доступа** учетную запись Azure Cosmos DB, базу данных или коллекцию.
* С помощью функции **Найти здесь** вы сможете выполнять поиск по ключевым словам по выбранному пути.

    :::image type="content" source="./media/storage-explorer/search-from-here.png" alt-text="Найти здесь":::

### <a name="database-and-collection-management"></a>Управление базами данных и коллекциями

#### <a name="create-a-database"></a>Создание базы данных

- Щелкните правой кнопкой мыши учетную запись Azure Cosmos DB, выберите **Создать базу данных**, введите имя базы данных и нажмите клавишу **ВВОД**.

  :::image type="content" source="./media/storage-explorer/create-database.png" alt-text="Создание базы данных в учетной записи Azure Cosmos":::

#### <a name="delete-a-database"></a>удаление базы данных.

- Щелкните правой кнопкой мыши базу данных, выберите **Удалить базу данных**и во всплывающем окне выберите **Да** . После удаления узла базы данных учетная запись Azure Cosmos DB будет обновлена автоматически.

  :::image type="content" source="./media/storage-explorer/delete-database1.png" alt-text="Удаление первой базы данных":::

  :::image type="content" source="./media/storage-explorer/delete-database2.png" alt-text="Удаление второй базы данных":::

#### <a name="create-a-collection"></a>Создание коллекции

1. Щелкните правой кнопкой мыши базу данных, выберите пункт **создать коллекцию**, а затем укажите следующие сведения, такие как **идентификатор коллекции**, **емкость хранилища**и т. д. Нажмите кнопку **ОК** для завершения.

   :::image type="content" source="./media/storage-explorer/create-collection.png" alt-text="Создать первую коллекцию в базе данных":::

   :::image type="content" source="./media/storage-explorer/create-collection2.png" alt-text="Создать вторую коллекцию в базе данных":::

2. Выберите **без ограничений** , чтобы иметь возможность указать ключ секции, а затем нажмите кнопку **ОК** для завершения.

    Если при создании коллекции использовался ключ секции, то после создания коллекции изменить значение этого ключа невозможно.

    :::image type="content" source="./media/storage-explorer/partitionkey.png" alt-text="Настройка ключа секции":::

#### <a name="delete-a-collection"></a>Удаление коллекции

- Щелкните правой кнопкой мыши коллекцию, выберите **удалить коллекцию**, а затем во всплывающем окне выберите **Да** .

    После удаления узла коллекции база данных будет обновлена автоматически.

    :::image type="content" source="./media/storage-explorer/delete-collection.png" alt-text="Удаление одной из коллекций":::

### <a name="document-management"></a>Управление документами

#### <a name="create-and-modify-documents"></a>Создание и изменение документов

- Чтобы создать новый документ **, откройте документ** в левом окне, выберите **создать документ**, измените содержимое на правой панели, а затем выберите **сохранить**. Можно также обновить существующий документ, а затем нажать кнопку **сохранить**. Чтобы отменить изменения, нажмите кнопку **Отменить**.

  :::image type="content" source="./media/storage-explorer/document.png" alt-text="Создание нового документа":::

#### <a name="delete-a-document"></a>Удаление документа

- Нажмите кнопку **Удалить**, чтобы удалить выбранный документ.

#### <a name="query-for-documents"></a>Запросы для документов

- Измените фильтр документов, введя SQL- [запрос](how-to-sql-query.md) , а затем нажмите кнопку **Применить**.

  :::image type="content" source="./media/storage-explorer/document-filter.png" alt-text="Запрос конкретных документов":::

### <a name="graph-management"></a>Управление графом

#### <a name="create-and-modify-vertex"></a>Создание и изменение вершины

1. Чтобы создать новую вершину, откройте **диаграмму** в левом окне, выберите **создать вершину**, измените содержимое и нажмите кнопку **ОК**.
2. Чтобы изменить существующую вершину, щелкните значок пера в правой области.

   :::image type="content" source="./media/storage-explorer/vertex.png" alt-text="Изменение вершины графа":::

#### <a name="delete-a-graph"></a>Удаление графа

- Чтобы удалить вершину, щелкните значок "Корзина" рядом с именем вершины.

#### <a name="filter-for-graph"></a>Фильтр графа

- Измените фильтр графа, введя [запрос Gremlin](gremlin-support.md) , а затем нажмите кнопку **Применить фильтр**.

   :::image type="content" source="./media/storage-explorer/graph-filter.png" alt-text="Выполнение запроса Graph":::

### <a name="table-management"></a>Управление таблицами

#### <a name="create-and-modify-table"></a>Создание и изменение таблицы

1. Чтобы создать новую таблицу, откройте **сущность** в левом окне, выберите **Добавить**, измените содержимое в диалоговом окне **Добавление сущности** , добавить свойство, нажав кнопку **Добавить свойство**, а затем выберите **Вставить**.
2. Чтобы изменить таблицу, выберите **изменить**, измените содержимое, а затем щелкните **Обновить**.

   :::image type="content" source="./media/storage-explorer/table.png" alt-text="Создание и изменение таблицы":::

#### <a name="import-and-export-table"></a>Импорт и экспорт таблицы

1. Чтобы выполнить импорт, нажмите кнопку **Импорт** и выберите существующую таблицу.
2. Чтобы выполнить экспорт, нажмите кнопку **Экспорт** и выберите назначение.

   :::image type="content" source="./media/storage-explorer/table-import-export.png" alt-text="Импорт или экспорт таблицы":::

#### <a name="delete-entities"></a>Удаление сущностей

- Выберите сущности и нажмите кнопку **Удалить**.

  :::image type="content" source="./media/storage-explorer/table-delete.png" alt-text="Удаление таблицы":::

#### <a name="query-table"></a>Запрос к таблице

- Нажмите кнопку **запроса** , условие входного запроса, а затем нажмите кнопку **выполнить запрос** . Закройте панель запросов, нажав кнопку **Закрыть запрос**.

  :::image type="content" source="./media/storage-explorer/table-query.png" alt-text="Запрос данных из таблицы":::

### <a name="manage-stored-procedures-triggers-and-udfs"></a>Управление хранимыми процедурами, триггерами и определяемыми пользователем функциями

* Чтобы создать хранимую процедуру, в левом дереве щелкните правой кнопкой мыши **хранимая процедура**, выберите команду **создать хранимую процедуру**, введите имя в поле слева, введите скрипты хранимой процедуры в правом окне, а затем выберите **создать**.
* Можно также изменить существующие хранимые процедуры, дважды щелкнув, установив обновление, а затем выбрав **Обновить** для сохранения, или выберите **отменить** , чтобы отменить изменения.

  :::image type="content" source="./media/storage-explorer/stored-procedure.png" alt-text="Создание хранимых процедур и управление ими":::

* Операции для **триггеров** и **определяемых пользователем функций** похожи на **хранимые процедуры**.

## <a name="troubleshooting"></a>Устранение неполадок

[Azure DB Cosmos в Обозревателе службы хранилища Azure](https://docs.microsoft.com/azure/cosmos-db/storage-explorer) является изолированным приложением, которое позволяет подключиться к учетным записям Azure Cosmos DB, размещенным в Azure и национальных облаках, из Windows, macOS или Linux. Оно позволяет управлять сущностями Azure Cosmos DB, работать с данными, обновлять хранимые процедуры и триггеры, а также работать с такими сущностями Azure, как большие двоичные объекты и очереди Azure.

Это решения для распространенных проблем, возникающих с Azure Cosmos DB в Обозревателе службы хранилища.

### <a name="sign-in-issues"></a>Проблемы входа

Прежде чем продолжать, попытайтесь перезапустить приложение: возможно, это поможет решить проблему.

#### <a name="self-signed-certificate-in-certificate-chain"></a>Самозаверяющий сертификат в цепочке сертификатов

Существует несколько причин, по которым вы можете видеть эту ошибку. Двумя основными являются:

+ Вы находитесь за *прозрачным прокси-сервером*. Это означает, что кто-то (например, ИТ-отдел) перехватывает трафик HTTPS, расшифровывает его, а затем шифрует с помощью самозаверяющего сертификата.

+ Вы используете программное обеспечение, например антивирусное по, которое внедряет самозаверяющий сертификат TLS/SSL в получаемые сообщения HTTPS.

Когда Обозреватель службы хранилища встречает один из этих самозаверяющихся сертификатов, он не может знать, было ли незаконно изменено сообщение HTTPS, которое он получает. Однако если у вас есть копия самозаверяющего сертификата, то в Обозревателе службы хранилища вы можете настроить доверие к нему. Если нет уверенности в том, кто вставляет сертификат, можно попробовать найти источник самостоятельно, сделав следующее:

1. Установка OpenSSL
     - [Windows](https://slproweb.com/products/Win32OpenSSL.html) (подойдет любая из облегченных версий).
     - MAC и Linux: этот компонент должен быть включен в операционную систему.
2. Запустите OpenSSL
    - Windows: перейдите в каталог установки, затем **/bin/** и дважды щелкните файл **openssl.exe**.
    - MAC и Linux: выполните **openssl** из терминала.
3. Выполните команду `s_client -showcerts -connect microsoft.com:443`.
4. Найдите самозаверяющие сертификаты. Если вы не знаете, какие из сертификатов являются самозаверяющими, то найдите сертификаты, в которых субъект ("s:") и издатель ("i:") совпадают.
5.  Найдя самозаверяющие сертификаты, скопируйте и вставьте все содержимое от **---BEGIN CERTIFICATE---** до **---END CERTIFICATE---** включительно в новый CER-файл для каждого из них.
6.  Откройте обозреватель службы хранилища и перейдите к разделу **изменение**  >  **SSL-сертификатов**  >  **Импорт сертификатов**. Используя средство выбора файлов, найдите, выберите и откройте созданные CER-файлы.

Если вам не удалось найти самозаверяющие сертификаты, используя приведенные выше действия, то для дополнительных сведений свяжитесь с нами.

#### <a name="unable-to-retrieve-subscriptions"></a>Не удается получить подписки

Если после успешного входа вам не удается получить подписки:

- Убедитесь, что учетная запись имеет доступ к подпискам, выполнив вход в [портал Azure](https://portal.azure.com/)
- Убедитесь, что вы выполнили вход в правильную среду ([Azure](https://portal.azure.com/), [Azure для Китая](https://portal.azure.cn/), [Azure для Германии](https://portal.microsoftazure.de/), [Azure для US Gov организаций](https://portal.azure.us/), пользовательскую среду или Azure Stack).
- При подключении через прокси-сервер убедитесь, что прокси-сервер Обозревателя службы хранилища настроен правильно.
- Попробуйте удалить и снова добавить учетную запись.
- Попробуйте удалить следующие файлы из домашнего каталога (например, C:\Users\ContosoUser), а затем снова добавить учетную запись:
  - adalcache-файл;
  - devaccounts-файл;
  - extaccounts-файл.
- При выполнении входа проверьте наличие сообщений об ошибках в консоли средств разработчика (F12).

:::image type="content" source="./media/storage-explorer/console.png" alt-text="Проверьте наличие ошибок в консоли средств разработчика.":::

#### <a name="unable-to-see-the-authentication-page"></a>Не отображается страница аутентификации

Если страница аутентификации не отображается:

- В зависимости от скорости подключения загрузка страницы входа может занять некоторое время. Подождите по крайней мере одну минуту, прежде чем закрывать диалоговое окно аутентификации.
- При подключении через прокси-сервер убедитесь, что прокси-сервер Обозревателя службы хранилища настроен правильно.
- Вызовите консоль разработчика, нажав клавишу F12. Просмотрите ответы от консоли разработчика: возможно, вам удастся понять, почему страница аутентификации не работает.

#### <a name="cannot-remove-account"></a>Невозможно удалить учетную запись

Если не удается удалить учетную запись или при щелчке ссылки повторной аутентификации ничего не происходит:

- Попробуйте удалить следующие файлы из домашнего каталога, а затем снова добавить учетную запись:
  - adalcache-файл;
  - devaccounts-файл;
  - extaccounts-файл.
- Если вы хотите удалить подключенные ресурсы хранилища SAS, удалите:
  - папку %AppData%/StorageExplorer в Windows;
  - /Users/<ваше_имя>/Library/Applicaiton SUpport/StorageExplorer в Mac;
  - ~/.config/StorageExplorer в Linux.
  - При удалении этих файлов **необходимо будет повторно ввести все учетные данные** .


### <a name="httphttps-proxy-issue"></a>Неполадки с прокси-сервером HTTP/HTTPS

При настройке прокси-сервера HTTP/HTTPS в ASE невозможно отобразить узлы Azure Cosmos DB в левом дереве узлов. Пока в качестве временного решения можно использовать обозреватель данных Azure Cosmos DB на портале Azure.

### <a name="development-node-under-local-and-attached-node-issue"></a>Неполадки с узлом "Development" (Разработка) в узле "Local and Attached" (Локальные и присоединенные)

После выбора узла "Разработка" в узле "локальный и присоединенный" в левом дереве нет ответа.  Такое поведение ожидаемо. Локальный эмулятор Azure Cosmos DB будет поддерживаться в следующем выпуске.

:::image type="content" source="./media/storage-explorer/development.png" alt-text="Узел разработки":::

### <a name="attaching-azure-cosmos-db-account-in-local-and-attached-node-error"></a>Ошибка при подключении учетной записи Azure Cosmos DB в узле "Local and Attached" (Локальные и присоединенные)

Если после присоединения учетной записи Azure Cosmos DB в узле "Local and Attached" (Локальные и присоединенные) отображается приведенная ниже ошибка, проверьте, используется ли правильная строка подключения.

:::image type="content" source="./media/storage-explorer/attached-error.png" alt-text="Ошибка при подключении Azure Cosmos DB в узле "Local and Attached" (Локальные и присоединенные)":::

### <a name="expand-azure-cosmos-db-node-error"></a>Ошибка развертывания узла Azure Cosmos DB

При попытке развернуть узлы дерева слева вы можете увидеть ошибку.

:::image type="content" source="./media/storage-explorer/expand-error.png" alt-text="Ошибка развертывания узла Azure Cosmos DB":::

Попробуйте использовать рекомендации, приведенные ниже.

- Проверьте, находится ли учетная запись Azure Cosmos DB в состоянии подготовки, и после успешного создания учетной записи повторите попытку.
- Если учетная запись находится в узле "Быстрый доступ" или "Local and Attached" (Локальные и присоединенные), проверьте, не была ли она удалена. Если да, то необходимо удалить узел вручную.

## <a name="next-steps"></a>Дальнейшие действия

* Чтобы узнать, как использовать Azure Cosmos DB в Обозревателе службы хранилища Azure, просмотрите это видео: [Использование Azure Cosmos DB в Обозревателе службы хранилища Azure](https://www.youtube.com/watch?v=iNIbg1DLgWo&feature=youtu.be).
* Дополнительные сведения об Обозревателе службы хранилища и подключении дополнительных служб см. в статье о [начале работы с Обозревателем службы хранилища](https://docs.microsoft.com/azure/vs-azure-tools-storage-manage-with-storage-explorer).
