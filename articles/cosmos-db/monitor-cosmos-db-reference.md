---
title: Ссылка на данные мониторинга мониторинга Azure Cosmos DB Документы Майкрософт
description: Ссылка на журнал и метрики для мониторинга данных из Azure Cosmos DB.
author: bwren
services: azure-monitor
ms.service: azure-monitor
ms.topic: reference
ms.date: 11/11/2019
ms.author: bwren
ms.custom: subject-monitoring
ms.subservice: logs
ms.openlocfilehash: d243224192b5761af45d387690f5fb41b84481e6
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "77588728"
---
# <a name="azure-cosmos-db-monitoring-data-reference"></a>Справочник по данным мониторинга Azure Cosmos DB
В этой статье приведены сведения о данных журнала и метрик, собранные для анализа производительности и доступности Azure Cosmos DB. Подробную информацию о сборе и анализе данных мониторинга для Azure Cosmos DB можно просмотреть в [мониторинге.](monitor-cosmos-db.md)


## <a name="resource-logs"></a>Журналы ресурсов
В следующей таблице перечислены свойства журналов ресурсов Azure Cosmos DB при их сборе в журналах Azure Monitor или Azure Storage. В журналах Azure Monitor они собираются в таблице **AzureDiagnostics** со значением **Ресурспровайдера** *от MICROSOFT. ДОКУМЕНТДБ*. 

| Поле или свойство службы хранилища Azure | Свойство журналов Azure Monitor | Описание |
| --- | --- | --- |
| **Время** | **TimeGenerated** | Дата и время (UTC) выполнения операции. |
| **resourceId** | **Ресурсов** | Учетная запись Azure Cosmos DB, для которой включены журналы.|
| **Категории** | **Категория** | Для журналов Azure Cosmos DB, **DataPlaneRequests**, **MongoRequests**, **queryRuntimeStatistics**, **PartitionKeyStatistics**, **PartitionKeyRUConsumption**, **ControlPlaneRequests** являются доступными типами журналов. |
| **эксплуатацияИмя** | **ОперацияИмя** | Имя операции. В качестве значения можно использовать любую из следующих операций: Create, Update, Read, ReadFeed, Delete, Replace, Execute, SqlQuery, Query, JSQuery, Head, HeadFeed или Upsert.   |
| **Вариантов размещения** | Недоступно | Содержимое этого поля описано в строках, приведенных ниже. |
| **Activityid** | **activityId_g** | Уникальный идентификатор GUID регистрируемой операции. |
| **Useragent** | **userAgent_s** | Строка, которая указывает агент пользователя клиента, выполняющий запрос. Формат: {имя_агента_пользователя} / {версия}.|
| **запросResourceType** | **requestResourceType_s** | Тип доступного ресурса. В качестве значения можно использовать любой из следующих типов ресурсов: Database, Container, Document, Attachment, User, Permission, StoredProcedure, Trigger, UserDefinedFunction или Offer. |
| **statusCode** | **statusCode_s** | Состояние ответа операции. |
| **requestResourceId** | **ResourceId** | Идентификатор ресурса, который относится к запросу. В зависимости от выполняемой операции значение может указывать на databaseRid, collectionRid или documentRid.|
| **clientIpAddress** | **clientIpAddress_s** | IP-адрес клиента. |
| **requestCharge** | **requestCharge_s** | Количество ЕЗ, которые используются при операции. |
| **collectionRid** | **collectionId_s** | Уникальный идентификатор коллекции.|
| **Длительность** | **duration_s** | Продолжительность операции, в миллисекундах. |
| **requestLength** | **requestLength_s** | Длина запроса в байтах. |
| **responseLength** | **responseLength_s** | Длина ответа в байтах.|
| **resourceTokenUserRid** | **resourceTokenUserRid_s** | Это свойство должно быть заполнено, если [маркеры ресурсов](https://docs.microsoft.com/azure/cosmos-db/secure-access-to-data#resource-tokens) используются для проверки подлинности. Значение указывает на идентификатор ресурса пользователя. |

Для списка всех категорий журналов Azure Monitor и ссылок на связанные [схемы](../azure-monitor/platform/diagnostic-logs-schema.md)см. 

## <a name="metrics"></a>Метрики
В следующих таблицах приведены метрики платформы, собранные для Azure CosmOS DB. Все метрики хранятся в **стандартных метриках namespace Cosmos DB.**

Для списка всех показателей поддержки Azure Monitor (включая [Azure Monitor supported metrics](../azure-monitor/platform/metrics-supported.md)CosmosDB) см. 

#### <a name="request-metrics"></a>Метрики запросов
            
|Метрика (Имя метрического дисплея)|Единица (тип агрегации) |Описание|Измерения| Степени детализации времени| Сопоставление метрик прежних версий | Использование |
|---|---|---|---| ---| ---| ---|
| Всего запросов (всего запросов) | Граф (Граф) | Количество выполненных запросов| DatabaseName, CollectionName, Region, StatusCode| All | TotalRequests, HTTP 2xx, HTTP 3xx, HTTP 400, HTTP 401, внутренняя ошибка сервера, служба недоступна, отрегулированные запросы, среднее число запросов в секунду | Используется для мониторинга запросов на код статуса, контейнер в минуту детализации. Чтобы получить среднее число запросов в секунду, используйте агрегат Count в минуту и разделите на 60. |
| MetadataRequests (Запросы метаданных) |Граф (Граф) | Количество запросов метаданных. Azure Cosmos DB поддерживает контейнер метаданных системы для каждой учетной записи, что позволяет перечислять коллекции, базы данных и т.д., а также их конфигурации, бесплатно. | DatabaseName, CollectionName, Region, StatusCode| All| |Позволяет отслеживать регулирование из-за запросов метаданных.|
| MongoRequests (Запросы монго) | Граф (Граф) | Количество выполненных запросов Mongo | DatabaseName, CollectionName, Region, CommandName, ErrorCode| All |Частота запросов на запрос Mongo, частота запросов на обновление Mongo, частота запросов на удаление Mongo, частота запросов на вставку Mongo, частота запросов на количество Mongo| Позволяет отслеживать ошибки запроса Mongo, использование каждого типа команды. |

#### <a name="request-unit-metrics"></a>Метрики единиц запроса

|Метрика (Имя метрического дисплея)|Единица (тип агрегации)|Описание|Измерения| Степени детализации времени| Сопоставление метрик прежних версий | Использование |
|---|---|---|---| ---| ---| ---|
| MongoRequestCharge (Плата за запрос Монго) | Граф (всего) |Использованные единицы запросов Mongo| DatabaseName, CollectionName, Region, CommandName, ErrorCode| All |Расходы запросов на запрос Mongo, расходы запросов на обновление Mongo, расходы запросов на удаление Mongo, расходы запросов на вставку Mongo, расходы запросов на количество Mongo| Позволяет отслеживать единицы запросов ресурсов Mongo в минуту.|
| TotalRequestUnits (Общие единицы запроса)| Граф (всего) | Использованные единицы запросов| DatabaseName, CollectionName, Region, StatusCode |All| TotalRequestUnits| Позволяет отслеживать использование общего количества единиц запросов со степенью детализации до минуты. Чтобы получить среднее число единиц запросов, потребленных в секунду, используйте общий объем агрегата в минуту и разделите на 60.|
| ProvisionedThroughput (Обеспеченная пропускная часть)| Граф (максимум) |Предусмотренная пропускная способность при детализации контейнера| База данныхИмя, КонтейнерНоеимя| 5M| | Используется для мониторинга просаченной пропускной прокладки на контейнер.|

#### <a name="storage-metrics"></a>Метрики хранения

|Метрика (Имя метрического дисплея)|Единица (тип агрегации)|Описание|Измерения| Степени детализации времени| Сопоставление метрик прежних версий | Использование |
|---|---|---|---| ---| ---| ---|
| Доступноехранилище (доступное хранилище) |Байты (всего) | Общее доступное хранилище, зарегистрированное при 5-минутной детализации в регионе| DatabaseName, CollectionName, Region| 5M| Доступная служба хранилища| Позволяет отслеживать доступную емкость хранилища (применимо только для фиксированных коллекций хранилища). Минимальная степень детализации должна составлять 5 минут.| 
| Использование данных (использование данных) |Байты (всего) |Общий объем использования данных, зарегистрированный на уровне 5 минут детализации в регионе| DatabaseName, CollectionName, Region| 5M |Размер данных | Используется для мониторинга общего использования данных в контейнере и регионе, минимальная детализация должна составить 5 минут.|
| Использование индекса (использование индекса) | Байты (всего) |Общее использование индекса, зарегистрированное на уровне 5 минут детализации в регионе| DatabaseName, CollectionName, Region| 5M| Размер индексов| Используется для мониторинга общего использования данных в контейнере и регионе, минимальная детализация должна составить 5 минут. |
| Документквотная квота (Квота документов) | Байты (всего) | Общая квота хранения, зарегистрированная на уровне 5 минут детализации в регионе.| DatabaseName, CollectionName, Region| 5M |Емкость хранилища| Используется для мониторинга общей квоты в контейнере и регионе, минимальная детализация должна составить 5 минут.|
| Счет документов (количество документов) | Граф (всего) |Общее количество документов, зарегистрированное на уровне 5 минут детализации в регионе| DatabaseName, CollectionName, Region| 5M |Число документов|Используется для мониторинга количества документов в контейнере и регионе, минимальная детализация должна составить 5 минут.|

#### <a name="latency-metrics"></a>Метрики задержки

|Метрика (Имя метрического дисплея)|Единица (тип агрегации)|Описание|Измерения| Степени детализации времени| Использование |
|---|---|---|---| ---| ---|
| РепликацияЛатенция (Задержка репликации)| МиллиSeconds (минимальный, максимальный, средний) | Задержка репликации P99 между исходными и целевыми регионами для геореплицируемой учетной записи| SourceRegion, TargetRegion| All | Позволяет отслеживать задержку репликации P99 между любыми двумя регионами для геореплицируемой учетной записи. |
| Задержка серверной стороны| МиллиSeconds (средний) | Время, заработаве сервером на обработку запроса. | CollectionName, ConnectionMode, DatabaseName, OperationType, PublicAPIType, регион | All | Используется для мониторинга задержки запроса на dB-сервере Azure Cosmos. |



#### <a name="availability-metrics"></a>Метрики доступности

|Метрика (Имя метрического дисплея) |Единица (тип агрегации)|Описание| Степени детализации времени| Сопоставление метрик прежних версий | Использование |
|---|---|---|---| ---| ---|
| Доступность обслуживания (доступность обслуживания)| Процент (минимальный, максимальный) | Доступность запросов учетной записи со степенью детализации до одного часа| 1 ч | Доступность службы | Представляет процент от общего числа пройденых запросов. Запрос считается не удавшимся из-за ошибки системы, если код состояния — 410, 500 или 503. Позволяет отслеживать доступность учетной записи со степенью детализации до одного часа. |


#### <a name="cassandra-api-metrics"></a>Метрики по API Cassandra

|Метрика (Имя метрического дисплея)|Единица (тип агрегации)|Описание|Измерения| Степени детализации времени| Использование |
|---|---|---|---| ---| ---|
| CassandraRequests (Кассандра Запросы) | Граф (Граф) | Количество сделанных запросов API Cassandra| DatabaseName, CollectionName, ErrorCode, Region, OperationType, ResourceType| All| Позволяет отслеживать запросы Cassandra со степенью детализации до минуты. Чтобы получить среднее число запросов в секунду, используйте агрегат Count в минуту и разделите на 60.|
| CassandraRequestcharges (Кассандрой Запрос сборов) | Граф (Сум, Мин, Макс, Авг) | Единицы запросов, потребленные запросами API Cassandra| DatabaseName, CollectionName, Region, OperationType, ResourceType| All| Позволяет отслеживать единицы запросов, используемые в минуту учетной записью API Cassandra.|
| КассандраСвязьЗакрытие (Закрытие подключения Cassandra) |Граф (Граф) |Число закрытых подключений Cassandra| ClosureReason, Region| All | Позволяет отслеживать возможность подключения между клиентами и API Cassandra для Azure Cosmos DB.|

## <a name="see-also"></a>См. также

- Ознакомиться с описанием мониторинга Azure Cosmos DB можно [просмотреть в Azure Cosmos DB.](monitor-cosmos-db.md)
- Подробную информацию о мониторинге ресурсов Azure можно просмотреть [в ресурсах Azure с помощью Azure Monitor.](../azure-monitor/insights/monitor-azure-resource.md)
