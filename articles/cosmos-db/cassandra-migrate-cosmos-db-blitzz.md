---
title: Перенести данные из Cassandra в Azure Cosmos DB Cassandra API с помощью Blitzz
description: Узнайте, как перенести данные из базы данных Apache Cassandra в Azure Cosmos DB Cassandra API с помощью Blitzz.
author: SnehaGunda
ms.service: cosmos-db
ms.topic: conceptual
ms.date: 08/21/2019
ms.author: sngun
ms.reviewer: sngun
ms.openlocfilehash: 746232a85e326f08d44cf2dbe0a4ae718c7cc312
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/27/2020
ms.locfileid: "69984372"
---
# <a name="migrate-data-from-cassandra-to-azure-cosmos-db-cassandra-api-account-using-blitzz"></a>Перенос данных из Cassandra в учетную запись Azure Cosmos DB Cassandra API с помощью Blitzz

Cassandra API в Azure Cosmos DB стал отличным выбором для корпоративных рабочих нагрузок, работающих на Apache Cassandra по целому ряду причин, таких как: 

* **Отсутствие накладных расходов на управление и мониторинг:** Это устраняет накладные расходы на управление и мониторинг множества параметров через ОС, JVM, и yaml файлов и их взаимодействия.

* **Значительная экономия средств:** Вы можете сэкономить затраты с помощью Azure Cosmos DB, который включает стоимость VM, пропускную способность и любые применимые лицензии. Кроме того, вам не нужно управлять центрами обработки данных, серверами, хранением SSD, сетей и расходами на электроэнергию. 

* **Возможность использования существующего кода и инструментов:** Azure Cosmos DB обеспечивает совместимость уровня протокола провода с существующими SDK Cassandra и инструментами. Благодаря этой совместимости можно использовать имеющуюся базу кода с API Cassandra для Azure Cosmos DB, внеся простые изменения.

Существуют различные способы переноса рабочих нагрузок баз данных с одной платформы на другую. [Blitzz](https://www.blitzz.io) — это инструмент, который предлагает безопасный и надежный способ выполнения нулевой простоя миграции из различных баз данных в Azure Cosmos DB. В этой статье описаны шаги, необходимые для переноса данных из базы данных Apache Cassandra в Azure Cosmos DB Cassandra API с помощью Blitzz.

## <a name="benefits-using-blitzz-for-migration"></a>Преимущества использования Blitzz для миграции

Решение Blitzz по миграции следует шаг за шагом подходом к миграции сложных рабочих нагрузок. Ниже приведены некоторые из ключевых аспектов плана миграции с нулевым простоем Blitzz:

* Он предлагает автоматическую миграцию бизнес-логики (таблицы, индексы, представления) из базы данных Apache Cassandra в Azure Cosmos DB. Вам не нужно создавать схемы вручную.

* Blitzz предлагает репликацию больших объемов и параллельных баз данных. Это позволяет как исходным, так и целевым платформам синхронизироваться во время миграции с помощью метода, называемого Change-Data-Capture (CDC). Используя CDC, Blitzz непрерывно вытягивает поток изменений из исходной базы данных (Apache Cassandra) и применяет его к базе данных назначения (Azure Cosmos DB).

* Это отказоустойчивый и гарантирует точно один раз доставки данных даже во время аппаратного или программного сбоя в системе.

* Он защищает данные во время транзита, используя различные методологии безопасности, такие как SSL, шифрование.

## <a name="steps-to-migrate-data"></a>Шаги для переноса данных

В этом разделе описаны шаги, необходимые для настройки Blitzz и перенос данных из базы данных Apache Cassandra в Azure Cosmos DB.

1. С компьютера, где вы планируете установить репликант Blitzz, добавьте сертификат безопасности. Этот сертификат требуется репликантом Blitzz для установления SSL-соединения с указанной учетной записью Azure Cosmos DB. Сертификат можно добавить следующими шагами:

   ```bash
   wget https://cacert.omniroot.com/bc2025.crt
   mv bc2025.crt bc2025.cer
   keytool -keystore $JAVA_HOME/lib/security/cacerts -importcert -alias bc2025ca -file bc2025.cer
   ```

1. Вы можете получить установку Blitzz и двоичные файлы либо, запрашивая демо на [сайте Blitzz](https://www.blitzz.io). Кроме того, вы также можете отправить [по электронной почте](mailto:success@blitzz.io) в команду.

   ![Blitzz репликант инструмент скачать](./media/cassandra-migrate-cosmos-db-blitzz/blitzz-replicant-download.png)

   ![Файлы репликантов Blitzz](./media/cassandra-migrate-cosmos-db-blitzz/replicant-files.png)

1. С терминала CLI навязате конфигурацию исходной базы данных. Откройте файл **`vi conf/conn/cassandra.yml`** конфигурации с помощью команды и добавьте запятый список IP-адресов узлов Cassandra, номер порта, имя пользователя, пароль и любые другие необходимые детали. Ниже приводится пример содержимого файла конфигурации:

   ```bash
   type: CASSANDRA
  
   host: 172.17.0.2
   port: 9042

   username: 'cassandra'
   password: 'cassandra'

   max-connections: 30

   ```

   ![Открытый редактор связи Кассандра](./media/cassandra-migrate-cosmos-db-blitzz/open-connection-editor-cassandra.png)

   ![Конфигурация соединения Кассандра](./media/cassandra-migrate-cosmos-db-blitzz/cassandra-connection-configuration.png)

   После заполнения деталей конфигурации сохраните и закройте файл.

1. Дополнительно можно настроить файл фильтра исходной базы данных. Файл фильтра определяет, какие схемы или таблицы для миграции. Откройте файл **`vi filter/cassandra_filter.yml`** конфигурации с помощью команды и введите следующие сведения о конфигурации:

   ```bash

   allow:
   -    schema: “io_blitzz”
   Types: [TABLE]
   ```

   После заполнения данных фильтра базы данных сохраните и закройте файл.

1. Далее вы наберете конфигурацию базы данных назначения. Прежде чем определить конфигурацию, [создайте учетную запись Azure Cosmos DB Cassandra API,](create-cassandra-dotnet.md#create-a-database-account) а затем создайте keyspace и таблицу для хранения мигрированных данных. Поскольку вы мигрируете из Apache Cassandra в API Cassandra в Azure Cosmos DB, вы можете использовать тот же ключ раздела, который использовался с Apache Cassandra.

1. Перед миграцией данных увеличьте пропускную емкость контейнера до суммы, необходимой для быстрого переноса приложения. Например, можно увеличить пропускную проликторную пропускную выгоду до 100000 rUs. Масштабирование пропускной системы перед началом миграции поможет вам перенести данные за меньшее время.

   ![Масштабируйте контейнер Azure Cosmos во всем](./media/cassandra-migrate-cosmos-db-blitzz/scale-throughput.png)

   Уменьшение пропускной вылимы после завершения миграции. На основе объема хранимых данных и RUs, необходимых для каждой операции, можно оценить пропускную силу, необходимую после миграции данных. Чтобы узнать больше о том, как оценить требуемые RUs, [Estimate RU/s using the Azure Cosmos DB capacity planner](estimate-ru-with-capacity-planner.md) см. [Provision throughput on containers and databases](set-throughput.md)

1. Получите **контактную точку, порт, имя пользователя**и **основной пароль** вашей учетной записи Azure Cosmos из панели **строки соединения.** Эти значения будут использоваться в файле конфигурации.

1. С терминала CLI навязате конфигурацию базы данных назначения. Откройте файл **`vi conf/conn/cosmosdb.yml`** конфигурации с помощью команды и добавьте разделенный на запятую список хост URI, номер порта, имя пользователя, пароль и другие необходимые параметры. В следующем примере показано содержимое файла конфигурации:

   ```bash
   type: COSMOSDB

   host: '<Azure Cosmos account’s Contact point>'
   port: 10350

   username: 'blitzzdemo'
   password: '<Your Azure Cosmos account’s primary password>'

   max-connections: 30
   ```

1. Затем мигрируйте данные с помощью Blitzz. Вы можете запустить репликант Blizz в **полном** или **моментальном** режиме:

   * **Полный режим** - В этом режиме репликант продолжает работать после миграции и слушает любые изменения в системе Apache Cassandra. Если он обнаруживает какие-либо изменения, они реплицируются на целевой учетной записи Azure Cosmos в режиме реального времени.

   * **Режим «Моментальный снимок»** — В этом режиме можно выполнять миграцию схем и одноразовую репликацию данных. Репликация в реальном времени не поддерживается этой опцией.

   Используя вышеуказанные два режима, миграция может выполняться с нулевым временем простоя. 

1. Чтобы перенести данные, из терминала репликанта Blitzz CLI, запустите следующую команду:

   ```bash
   ./bin/replicant full conf/conn/cassandra.yaml conf/conn/cosmosdb.yaml --filter filter/cassandra_filter.yaml --replace-existing
   ```

   Репликантный uI показывает прогресс репликации. После выполнения миграции схемы и операции моментального снимка прогресс показывает 100%. После завершения миграции можно проверить данные в целевой базе данных Azure Cosmos.

   ![Выход миграции данных Cassandra](./media/cassandra-migrate-cosmos-db-blitzz/cassandra-data-migration-output.png)


1. Поскольку вы использовали полный режим миграции, вы можете выполнять такие операции, как вставка, обновление или удаление данных в исходной базе данных Apache Cassandra. Позже утвердите, что они реплицируются в режиме реального времени в целевой базе данных Azure Cosmos. После миграции убедитесь, что уменьшите пропускную емкость, настроенную для контейнера Azure Cosmos.

1. Вы можете остановить репликант в любой точке и перезапустить его с **--резюме переключателя.** Репликация возобновляется с той точки, что она остановилась без ущерба для согласованности данных. Следующая команда показывает, как использовать переключатель резюме.

   ```bash
   ./bin/replicant full conf/conn/cassandra.yaml conf/conn/cosmosdb.yaml --filter filter/cassandra_filter.yaml --replace-existing --resume
   ```

Чтобы узнать больше о миграции данных в [Blitzz replicant demo](https://www.youtube.com/watch?v=fsUhF9LUZmM)пункт назначения, миграции в реальном времени, см.

## <a name="next-steps"></a>Дальнейшие действия

* [Обеспечение необходимой пропускной способности для контейнеров и баз данных](set-throughput.md) 
* [Раздел ключевых передовых практик](partitioning-overview.md#choose-partitionkey)
* [Оцените RU/s с использованием статей планировщика емкости Azure Cosmos DB](estimate-ru-with-capacity-planner.md)