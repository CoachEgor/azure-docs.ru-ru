---
title: Как восстановить данные Azure Cosmos DB из резервной копии
description: В этой статье описывается, как восстановить данные Azure Cosmos DB из резервной копии, как обращаться в службу поддержки Azure, чтобы восстановить данные, и какие шаги предпринять после восстановления данных.
author: kanshiG
ms.service: cosmos-db
ms.topic: how-to
ms.date: 08/24/2020
ms.author: govindk
ms.reviewer: sngun
ms.openlocfilehash: 9956ca0ca9c0957557e7ee74883a75c074ff22f8
ms.sourcegitcommit: c5021f2095e25750eb34fd0b866adf5d81d56c3a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/25/2020
ms.locfileid: "88797978"
---
# <a name="restore-data-from-a-backup-in-azure-cosmos-db"></a>Восстановление данных из резервной копии в Azure Cosmos DB

Если вы случайно удалили базу данных или контейнер, вы можете отправить запрос в [службу поддержки](https://portal.azure.com/?#blade/Microsoft_Azure_Support/HelpAndSupportBlade) или [обратиться в службу поддержки Azure](https://azure.microsoft.com/support/options/) для восстановления данных из автоматической оперативной архивации. Поддержка Azure доступна только для выбранных планов, таких как **стандартные**, **разработчики**и планы выше. Для плана **Базовый** поддержка Azure не предоставляется. Дополнительные сведения о различных планах поддержки см. на странице [Планы поддержки Azure](https://azure.microsoft.com/support/plans/).

Чтобы восстановить определенный моментальный снимок архива, службе Azure Cosmos DB требуется, чтобы данные были доступны в течение цикла архивации для данного снимка.

## <a name="request-a-restore"></a>Запрос на восстановление

Прежде чем запрашивать восстановление, нужно подготовить следующие сведения:

* Идентификатор подписки.

* В зависимости от того, каким способом были случайно удалены или изменены ваши данные, может понадобиться подготовить дополнительные сведения. Рекомендуем заранее приготовить информацию, чтобы свести к минимуму время на ее передачу, особенно в тех случаях, когда проблему нужно устранить как можно быстрее.

* Если учетная запись Azure Cosmos DB удалена полностью, необходимо указать имя удаленной учетной записи. Если вы создаете другую учетную запись с тем же именем, что и у удаленной, сообщите об этом в службу поддержки, так как это поможет определить правильную учетную запись для выбора. Рекомендуется использовать разные билеты в службу поддержки для каждой удаленной учетной записи, так как это снизит путаницу в состоянии восстановления.

* Если удалена одна или больше баз данных, необходимо указать учетную запись Azure Cosmos и имена баз данных Azure Cosmos, а также сообщить, существует ли новая база данных с тем же именем.

* Если удален один или больше контейнеров, следует указать имя учетной записи Azure Cosmos, имена баз данных и контейнеров. Сообщите также, существует ли контейнер с тем же именем.

* Если вы случайно удалили или повредили данные, обратитесь в [службу поддержки Azure](https://azure.microsoft.com/support/options/) в течение 8 часов, чтобы группа Azure Cosmos DB могла помочь вам восстановить данные из резервных копий. **Перед созданием запроса на поддержку для восстановления данных необходимо [увеличить срок хранения резервной копии](online-backup-and-restore.md) для вашей учетной записи, не менее семи дней. Лучше увеличить срок хранения в течение 8 часов этого события.** Таким образом, Группа поддержки Azure Cosmos DB будет иметь достаточно времени для восстановления вашей учетной записи.

В дополнение к имени учетной записи Azure Cosmos, именам баз данных, именам контейнеров следует указать момент времени, в который можно восстановить данные. Важно действовать с максимальной точностью, чтобы помочь нам определить самые лучшие резервные копии, доступные на этот момент. **Важно также указать время в формате UTC.**

На снимке экрана ниже показано, как создать запрос в службу поддержки для контейнера (коллекции, графа, таблицы) на восстановление данных с помощью портала Azure. Предоставьте дополнительные сведения, например тип данных, цель восстановления и время удаления данных, чтобы помочь нам назначить приоритет для запроса.

:::image type="content" source="./media/how-to-backup-and-restore/backup-support-request-portal.png" alt-text="Создание запроса на резервное копирование в службу поддержки с помощью портала Azure":::

## <a name="post-restore-actions"></a>Действия после восстановления

После восстановления данных вы получите уведомление с указанием имени новой учетной записи (обычно в формате `<original-name>-restored1`) и времени ее восстановления. У восстановленной учетной записи будет такая же подготовленная пропускная способность и политики индексирования, она будет находиться в том же регионе, что и исходная учетная запись. Пользователь, который является администратором подписки или соадминистратором, может просмотреть восстановленную учетную запись.

После восстановления данных следует просмотреть и проверить и данные в восстановленной учетной записи и убедиться, что она содержит ожидаемую версию. Если все правильно, необходимо перенести данные обратно в исходную учетную запись с помощью [канала изменений Azure Cosmos DB](change-feed.md) или службы [Фабрика данных Azure](../data-factory/connector-azure-cosmos-db.md).

Рекомендуем удалить контейнер или базу данных сразу после переноса данных. Если восстановленные базы данных или контейнеры не будут удалены, то затраты на единицы запросов, хранение и исходящий трафик увеличатся.

## <a name="next-steps"></a>Дальнейшие действия

Перенос данных в исходную учетную запись описан в следующих статьях:

* [Запрос на восстановление можно отправить с портала Azure](https://portal.azure.com/?#blade/Microsoft_Azure_Support/HelpAndSupportBlade), обратившись в службу поддержки Azure.
* Перемещение данных в Azure Cosmos DB с помощью [канала изменений Cosmos DB](change-feed.md).

* Перемещение данных в Azure Cosmos DB с помощью [Фабрики данных Azure](../data-factory/connector-azure-cosmos-db.md).
