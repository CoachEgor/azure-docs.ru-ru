---
title: Упругое масштабирование с Помощью API Cassandra в Azure Cosmos DB
description: Узнайте о возможностях масштабирования учетной записи Azure Cosmos DB Cassandra API и их преимуществах/недостатках
author: TheovanKraay
ms.service: cosmos-db
ms.topic: conceptual
ms.date: 01/13/2020
ms.author: thvankra
ms.openlocfilehash: 10d81de48c0d8f56c7c3fd26e3fd82a8c3df84c6
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "79474685"
---
# <a name="elastically-scale-an-azure-cosmos-db-cassandra-api-account"></a>Эластично масштабируйте учетную запись Azure Cosmos DB Cassandra API

Существует множество вариантов изучения эластичной природы API Azure Cosmos DB для Cassandra. Чтобы понять, как эффективно масштабироваться в Azure Cosmos DB, важно понять, как предоставить нужное количество единиц запроса (RU/s) для учета требований к производительности в вашей системе. Чтобы узнать больше об единицах запроса, смотрите статью [единиц запроса.](request-units.md) 

Для API Cassandra можно получить плату группы запросов для отдельных запросов с помощью [SDK .NET и Java.](https://docs.microsoft.com/azure/cosmos-db/find-request-unit-charge#cassandra-api) Это полезно для определения количества RU/s, которое необходимо предоставить в службе.

![Операции с базой данных потребляют единицы запроса](./media/request-units/request-units.png)

## <a name="handling-rate-limiting-429-errors"></a>Ограничение скорости обработки (429 ошибок)

Azure Cosmos DB вернет ошибки с ограниченной скоростью (429), если клиенты потребляют больше ресурсов (RU/s), чем сумма, которую вы приготовители. API Cassandra в Azure Cosmos DB преобразует эти исключения в ошибки перегрузки в собственном протоколе Cassandra. 

Если ваша система не чувствительна к задержкам, может быть достаточно справиться с ограничением пропускной скорости с помощью повторов. Ознакомьтесь с [примером кода Java,](https://github.com/Azure-Samples/azure-cosmos-cassandra-java-retry-sample) как эффективно обрабатывать ограничение скорости, используя [расширение Azure Cosmos DB](https://github.com/Azure/azure-cosmos-cassandra-extensions) для [политики повторной попытки Cassandra](https://docs.datastax.com/en/developer/java-driver/4.4/manual/core/retries/) в Java. Вы также можете использовать [расширение Spark](https://mvnrepository.com/artifact/com.microsoft.azure.cosmosdb/azure-cosmos-cassandra-spark-helper) для обработки ограничения скорости.

## <a name="manage-scaling"></a>Управление масштабированием

Если вам нужно свести к минимуму задержку, в API Cassandra API есть спектр опций для управления масштабом и подготовки пропускной устойчивости (RUs):

* [Вручную с помощью портала Azure](#use-azure-portal)
* [Программно используя функции плоскости управления](#use-control-plane)
* [Программно используя команды СЗЛ с определенным SDK](#use-cql-queries)
* [Динамически с помощью автопилота](#use-autopilot)

В следующих разделах разъясняются преимущества и недостатки каждого подхода. Затем можно определиться с наилучшей стратегией, чтобы сбалансировать потребности в масштабировании вашей системы, общие затраты и эффективность для вашего решения.

## <a name="use-the-azure-portal"></a><a id="use-azure-portal"></a>Воспользуйтесь порталом Azure

Масштабировать ресурсы в учетной записи Azure Cosmos DB Cassandra API можно с помощью портала Azure. Чтобы узнать больше, смотрите статью о [прокладке пропускной информации на контейнерах и базах данных](set-throughput.md). В этой статье объясняется относительные преимущества настройки пропускной связи на уровне [базы данных](set-throughput.md#set-throughput-on-a-database) или [контейнеров](set-throughput.md#set-throughput-on-a-container) на портале Azure. Термины "база данных" и "контейнер", упомянутые в этих статьях, относятся к "ключевому пространству" и "таблице" соответственно для API Кассандра.

Преимущество этого метода заключается в том, что он является простым способом управления пропускной способностью в базе данных. Однако недостатком является то, что во многих случаях ваш подход к масштабированию может потребовать, чтобы определенные уровни автоматизации были как экономически эффективными, так и высокопроизводительными. В следующих разделах разъясняется соответствующие сценарии и методы.

## <a name="use-the-control-plane"></a><a id="use-control-plane"></a>Используйте плоскость управления

API-изапига Azure Cosmos DB для Cassandra обеспечивает возможность программной регулировки пропускной способности с помощью наших различных функций управления самолетом. Ознакомиться с статьями [«Менеджер ресурсов Azure»,](manage-cassandra-with-resource-manager.md) [Powershell](powershell-samples-cassandra.md)и [Azure CLI](cli-samples-cassandra.md) можно ознакомиться с рекомендациями и примерами.

Преимущество этого метода заключается в том, что можно автоматизировать масштабирование ресурсов вверх или вниз на основе таймера для учета пиковой активности или периодов низкой активности. Взгляните на наш пример [здесь](https://github.com/Azure-Samples/azure-cosmos-throughput-scheduler) о том, как сделать это с помощью функций Azure и Powershell.

Недостатком такого подхода может быть то, что вы не можете реагировать на непредсказуемые потребности в изменении шкалы в режиме реального времени. Вместо этого может потребоваться использовать контекст приложения в вашей системе, на уровне клиента/SDK или с помощью [Autopilot.](provision-throughput-autopilot.md)

## <a name="use-cql-queries-with-a-specific-sdk"></a><a id="use-cql-queries"></a>Используйте запросы СЗЛ с определенным SDK

Вы можете динамически масштабировать систему с помощью кода, исключив [команды C'L ALTER](cassandra-support.md#keyspace-and-table-options) для данной базы данных или контейнера.

Преимущество этого подхода заключается в том, что он позволяет динамически и настраиваемым потребностям реагировать на масштабы. При таком подходе вы все еще можете использовать стандартные сборы и тарифы RU/s. Если потребности вашей системы в масштабе в основном предсказуемы (около 70% или более), использование SDK с C'L может быть более экономичным методом автоматического масштабирования, чем использование автопилота. Недостатком такого подхода является то, что реализовать повторы может быть довольно сложно, в то время как ограничение ставок может привести к увеличению задержки.

## <a name="use-autopilot"></a><a id="use-autopilot"></a>Использование автопилота

В дополнение к ручному или программному способу подготовки пропускной схемы, вы также можете настроить контейнеры космоса Azure в режиме автопилота. Режим автопилота будет автоматически и мгновенно масштабироваться до ваших потребностей потребления в пределах указанных диапазонов RU без ущерба для SLAs. Чтобы узнать больше, смотрите [контейнеры и базы данных Azure Cosmos в статье о режиме автопилота.](provision-throughput-autopilot.md)

Преимущество этого подхода заключается в том, что это самый простой способ управления потребностями масштабирования в вашей системе. Он гарантирует не применять ограничение скорости **в пределах настроенных диапазонов RU.** Недостатком является то, что, если потребности в масштабировании в вашей системе предсказуемы, Автопилот может быть менее экономичный способ обработки ваших потребностей масштабирования, чем использование заказной плоскости управления или подходов уровня SDK, упомянутых выше.

## <a name="next-steps"></a>Дальнейшие действия

- Начатые с [создания учетной записи, базы данных ИПа Cassandra API и таблицы](create-cassandra-api-account-java.md) с помощью приложения Java
