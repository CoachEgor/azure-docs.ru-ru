---
title: Квоты служб Azure Cosmos DB
description: Azure Cosmos DB квоты службы и ограничения по умолчанию для различных типов ресурсов.
author: abhijitpai
ms.author: abpai
ms.service: cosmos-db
ms.topic: conceptual
ms.date: 04/03/2020
ms.openlocfilehash: 6dcda58652abe51d360748222263f30f337a2251
ms.sourcegitcommit: 849bb1729b89d075eed579aa36395bf4d29f3bd9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2020
ms.locfileid: "82182741"
---
# <a name="azure-cosmos-db-service-quotas"></a>Квоты служб Azure Cosmos DB

В этой статье представлен обзор квот по умолчанию, предлагаемых для разных ресурсов в Azure Cosmos DB.

## <a name="storage-and-throughput"></a>Хранение и пропускная способность

После создания учетной записи Azure Cosmos в подписке можно управлять данными в учетной записи, [создавая базы данных, контейнеры и элементы](databases-containers-items.md). Вы можете подготавливать пропускную способность на уровне контейнера или базы данных с точки зрения [единиц запросов (единиц запроса в секунду или](request-units.md)с адресом RUs). В следующей таблице перечислены ограничения для хранения и пропускной способности на контейнер или базу данных.

| Ресурс | Ограничение по умолчанию |
| --- | --- |
| Максимальное число записей на контейнер ([выделенный режим подготовки пропускной способности](databases-containers-items.md#azure-cosmos-containers)) | 1 000 000 по умолчанию. Вы можете увеличить его, выполнив [запрос в службу поддержки Azure](https://docs.microsoft.com/azure/azure-portal/supportability/how-to-create-azure-support-request) . |
| Максимальное число получателей в базе данных ([подготовленный режим с общей пропускной способностью](databases-containers-items.md#azure-cosmos-containers)) | 1 000 000 по умолчанию. Вы можете увеличить его, выполнив [запрос в службу поддержки Azure](https://docs.microsoft.com/azure/azure-portal/supportability/how-to-create-azure-support-request) . |
| Максимальное число получателей/с (логический) ключа секции | 10 000 |
| Максимальный объем хранилища для всех элементов на (логический) ключ секции| 20 ГБ |
| Максимальное число уникальных (логических) ключей разделов | Неограниченно |
| Максимальный объем хранилища на контейнер | Неограниченно |
| Максимальный объем хранилища на базу данных | Неограниченно |
| Максимальный размер вложения на учетную запись (функция прикрепления амортизируется) | 2 ГБ |
| Минимально необходимое число получателей в 1 ГБ | 10 единиц запросов в секунду |

> [!NOTE]
> Дополнительные сведения о рекомендациях по управлению рабочими нагрузками с ключами секций, требующим более высоких ограничений для хранилища или пропускной способности, см. в разделе [создание искусственного ключа секции](synthetic-partition-keys.md).
>

Контейнер Cosmos (или база данных с общей пропускной способностью) должен иметь минимальную пропускную способность 400 RUs. По мере роста контейнера минимальная поддерживаемая пропускная способность также зависит от следующих факторов.

* Минимальная пропускная способность, которую можно задать для контейнера, зависит от максимальной пропускной способности, которая когда-либо находилась в контейнере. Например, если пропускная способность увеличилась до 10000 RUs, то самая низкая возможная пропускная способность будет 1000 RUs.
* Минимальная пропускная способность в базе данных с общей пропускной способностью также зависит от общего числа контейнеров, созданных в базе данных с общей пропускной способностью, измеряемой в 100 в секунду на контейнер. Например, если вы создали пять контейнеров в общей пропускной способности, то пропускная способность должна быть не ниже 500 RUs.

Текущая и Минимальная пропускная способность контейнера или базы данных можно получить из портал Azure или пакетов SDK. Дополнительные сведения см. в статье о [подготовке пропускной способности для контейнеров и баз данных](set-throughput.md). 

> [!NOTE]
> В некоторых случаях вы можете снизить пропускную способность до 10%. Используйте API для получения точного минимального значения в секунду на контейнер.
>

В сводке ниже приведены минимальные максимальные подготовленные ограничения в ЕДИНИЦах. 

| Ресурс | Ограничение по умолчанию |
| --- | --- |
| Минимальное число записей на контейнер ([выделенный режим подготовки пропускной способности](databases-containers-items.md#azure-cosmos-containers)) | 400 |
| Минимальное число получателей на базу данных ([подготовленный режим с общей пропускной способностью](databases-containers-items.md#azure-cosmos-containers)) | 400 |
| Минимальное число получателей на контейнер в базе данных с общей пропускной способностью | 100 |

Cosmos DB поддерживает Эластичное масштабирование пропускной способности (RUs) на контейнер или базу данных с помощью пакетов SDK или портала. Каждый контейнер может масштабироваться синхронно и сразу в пределах диапазона шкалы от 10 до 100 раз (между минимальным и максимальным значениями). Если запрошенное значение пропускной способности выходит за пределы диапазона, масштабирование выполняется асинхронно. Асинхронное масштабирование может занять несколько минут, в зависимости от запрошенной пропускной способности и размера хранилища данных в контейнере.  

## <a name="control-plane-operations"></a>Операции плоскости управления

Вы можете [подготавливать учетную запись Azure Cosmos и управлять ею](how-to-manage-database-account.md) с помощью шаблонов портал Azure, Azure PowerShell, Azure CLI и Azure Resource Manager. В следующей таблице перечислены ограничения на подписку, учетную запись и количество операций.

| Ресурс | Ограничение по умолчанию |
| --- | --- |
| Максимальное число учетных записей базы данных на подписку | 50 по умолчанию. Вы можете увеличить его, выполнив [запрос в службу поддержки Azure](https://docs.microsoft.com/azure/azure-portal/supportability/how-to-create-azure-support-request) .|
| Максимальное число региональных отработки отказа | по умолчанию 1/час. Вы можете увеличить его, выполнив [запрос в службу поддержки Azure](https://docs.microsoft.com/azure/azure-portal/supportability/how-to-create-azure-support-request) .|

> [!NOTE]
> Региональные отработки отказа применяются только к учетным записям записи в одном регионе. Учетные записи для записи в нескольких регионах не зависят от ограничений на изменение региона записи.

Cosmos DB автоматически создает резервные копии данных через регулярные промежутки времени. Дополнительные сведения об интервалах хранения резервных копий и Windows см. [в разделе оперативное резервное копирование и восстановление данных по запросу в Azure Cosmos DB](online-backup-and-restore.md).

## <a name="per-account-limits"></a>Ограничения для каждой учетной записи

| Ресурс | Ограничение по умолчанию |
| --- | --- |
| Максимальное число баз данных | Неограниченно |
| Максимальное количество контейнеров на базу данных с общей пропускной способностью |25 |
| Максимальное количество контейнеров на базу данных или учетную запись с выделенной пропускной способностью  |без ограничений |
| Максимальное число регионов | Без ограничений (все регионы Azure) |

## <a name="per-container-limits"></a>Ограничения для каждого контейнера

В зависимости от используемого API контейнер Azure Cosmos может представлять коллекцию, таблицу или граф. Контейнеры поддерживают конфигурации для [ограничений уникального ключа](unique-keys.md), [хранимых процедур, триггеров и пользовательских](stored-procedures-triggers-udfs.md)функций, а [политики индексирования](how-to-manage-indexing-policy.md). В следующей таблице перечислены ограничения, характерные для конфигураций в контейнере. 

| Ресурс | Ограничение по умолчанию |
| --- | --- |
| Максимальная длина имени базы данных или контейнера | 255 |
| Максимальное число хранимых процедур на контейнер | 100<sup>*</sup>|
| Максимальное число пользовательских функций на контейнер | размером<sup>*</sup>|
| Максимальное число путей в политике индексирования| 100<sup>*</sup>|
| Максимальное число уникальных ключей на контейнер|штук<sup>*</sup>|
| Максимальное число путей на ограничение уникального ключа|глубин<sup>*</sup>|

<sup>*</sup>Вы можете увеличить любое из этих ограничений для каждого контейнера, обратившись в службу поддержки Azure.

## <a name="per-item-limits"></a>Ограничения для каждого элемента

В зависимости от используемого API элемент Cosmos в Azure может представлять документ в коллекции, строку в таблице или узел или границу в графе. В следующей таблице показаны ограничения на каждый элемент в Cosmos DB. 

| Ресурс | Ограничение по умолчанию |
| --- | --- |
| Максимальный размер элемента | 2 МБ (UTF-8, представление JSON) |
| Максимальная длина значения ключа секции | 2048 байт |
| Максимальная длина значения идентификатора | 1023 байт |
| Максимальное число свойств на элемент | Нет практического ограничения |
| Максимальная глубина вложения | Нет практического ограничения |
| Максимальная длина имени свойства | Нет практического ограничения |
| Максимальная длина значения свойства | Нет практического ограничения |
| Максимальная длина значения свойства строки | Нет практического ограничения |
| Максимальная длина значения числового свойства | IEEE754 с двойной точностью 64-разр. |

Никаких ограничений на полезные данные элемента, такие как число свойств и глубина вложенности, не существует, за исключением ограничений длины для ключа секции и значений идентификатора, а также общего ограничения размера, равного 2 МБ. Может потребоваться настроить политику индексирования для контейнеров с большими или сложными структурами элементов, чтобы снизить потребление единиц запросов. Примеры и шаблоны для управления большими элементами см. [в разделе моделирование элементов в Cosmos DB](how-to-model-partition-example.md) .

## <a name="per-request-limits"></a>Ограничения по запросу

Azure Cosmos DB поддерживает [операции CRUD и запросов](https://docs.microsoft.com/rest/api/cosmos-db/) к ресурсам, таким как контейнеры, элементы и базы данных. Он также поддерживает [транзакционные пакетные запросы](https://docs.microsoft.com/dotnet/api/microsoft.azure.cosmos.transactionalbatch) к нескольким элементам с одним и тем же ключом секции в контейнере.

| Ресурс | Ограничение по умолчанию |
| --- | --- |
| Максимальное время выполнения для одной операции (например, выполнение хранимой процедуры или получение одной страницы запроса)| 5 секунд |
| Максимальный размер запроса (например, хранимая процедура, CRUD)| 2 МБ |
| Максимальный размер отклика (например, запрос с разбивкой на страницы) | 4 МБ |
| Максимальное количество операций в транзакционном пакете | 100 |

Когда операция вроде запроса достигает предельного времени выполнения или размера ответа, она возвращает клиенту страницу результатов и маркер продолжения для возобновления выполнения. Не существует практического ограничения на длительность выполнения одного запроса на страницах или продолжениях.

Cosmos DB использует HMAC для авторизации. Можно использовать либо главный ключ, либо [маркеры ресурсов](secure-access-to-data.md) для точного контроля доступа к ресурсам, таким как контейнеры, ключи разделов или элементы. В следующей таблице перечислены ограничения для маркеров авторизации в Cosmos DB.

| Ресурс | Ограничение по умолчанию |
| --- | --- |
| Максимальное время окончания срока действия основного маркера | 15 мин.  |
| Минимальное время окончания срока действия маркера ресурса | 10 мин  |
| Максимальное время окончания срока действия маркера ресурса | по умолчанию используется 24 h. Вы можете увеличить его, выполнив [запрос в службу поддержки Azure](https://docs.microsoft.com/azure/azure-portal/supportability/how-to-create-azure-support-request) .|
| Максимальная асимметрия часов для авторизации токена| 15 мин. |

Cosmos DB поддерживает выполнение триггеров во время записи. Служба поддерживает максимум один предварительный триггер и один после триггера на операцию записи. 

## <a name="autoscale-mode-limits"></a>Ограничения режима автомасштабирования

Пропускная способность и ограничения хранилища в режиме автомасштабирования см. в статье [Автомасштабирование](provision-throughput-autoscale.md#autoscale-limits) .

## <a name="sql-query-limits"></a>Ограничения запросов SQL

Cosmos DB поддерживает запросы элементов с помощью [SQL](how-to-sql-query.md). В следующей таблице описаны ограничения в инструкциях запроса, например, с точки зрения количества предложений или длины запроса.

| Ресурс | Ограничение по умолчанию |
| --- | --- |
| Максимальная длина SQL запроса| 256 КБ |
| Максимальное число соединений на запрос| 5.0<sup>*</sup>|
| Максимальное число пользовательских функций на запрос| штук<sup>*</sup>|
| Максимальное число точек на многоугольник| 4096 |
| Максимальное число включаемых путей на контейнер| 500 |
| Максимальное число исключаемых путей на контейнер| 500 |
| Максимальное число свойств в составном индексе| 8 |

<sup>*</sup>Вы можете увеличить эти ограничения запросов SQL, обратившись в службу поддержки Azure.

## <a name="mongodb-api-specific-limits"></a>Ограничения для API MongoDB

Cosmos DB поддерживает протокол проводной сети MongoDB для приложений, написанных для MongoDB. Поддерживаемые команды и версии протокола можно найти в [поддерживаемых функциях и синтаксисе MongoDB](mongodb-feature-support.md).

В следующей таблице перечислены ограничения, относящиеся к поддержке функций MongoDB. Другие ограничения службы, упомянутые для API SQL (Core), также применяются и к API MongoDB.

| Ресурс | Ограничение по умолчанию |
| --- | --- |
| Максимальный размер памяти для запроса MongoDB (это ограничение доступно только для версии сервера 3,2) | 40 МБ |
| Максимальное время выполнения для операций MongoDB| 30 с |
| Время ожидания простаивающих подключений для закрытия соединения на стороне сервера * | 30 минут |

\*Рекомендуется, чтобы клиентские приложения установили время ожидания простоя подключения в параметрах драйвера равным 2-3 минут, так как [время ожидания по умолчанию для подсистемы балансировки нагрузки Azure составляет 4 минуты](../load-balancer/load-balancer-tcp-idle-timeout.md#tcp-idle-timeout).  Это гарантирует, что неактивные подключения не будут закрыты промежуточной подсистемой балансировки нагрузки между клиентским компьютером и Azure Cosmos DB.

## <a name="try-cosmos-db-free-limits"></a>Попробуйте Cosmos DB ограничения свободного места

В следующей таблице перечислены ограничения для [Azure Cosmos DB](https://azure.microsoft.com/try/cosmosdb/) пробной версии.

| Ресурс | Ограничение по умолчанию |
| --- | --- |
| Длительность пробной версии | 30 дней (можно продлить любое количество раз) |
| Максимальное число контейнеров на подписку (SQL, Gremlin, API таблиц) | 1 |
| Максимальное число контейнеров на подписку (API MongoDB) | 3 |
| Максимальная пропускная способность на контейнер | 5000 |
| Максимальная пропускная способность для базы данных с общей пропускной способностью | 20 000 |
| Максимальный общий объем хранилища на учетную запись | 10 ГБ |

Пробная Cosmos DB поддерживает глобальное распределение только в центральной части США, Северной Европе и Юго-Восточной Азии. Невозможно создать билеты на службу поддержки Azure для учетных записей пробной Azure Cosmos DB. Однако поддержка предоставляется для подписчиков с существующими планами поддержки.

## <a name="free-tier-account-limits"></a>Ограничения учетной записи уровня Free
В следующей таблице перечислены ограничения для [учетных записей уровня Azure Cosmos DB Free.](optimize-dev-test.md#azure-cosmos-db-free-tier)

| Ресурс | Ограничение по умолчанию |
| --- | --- |
| Число учетных записей бесплатных уровней на подписку Azure | 1 |
| Длительность скидки на уровне Free | Время существования учетной записи. Необходимо явное согласие на создание учетной записи. |
| Максимальное количество единиц запросов в секунду | 400 ЕЗ/с |
| Максимальный объем хранилища для бесплатной | 5 ГБ |
| Максимальное число баз данных с общей пропускной способностью | 5 |
| Максимальное число контейнеров в базе данных с общей пропускной способностью | 25 <br>В учетных записях бесплатных уровней минимальный единица запросов в секунду для базы данных с общей пропускной способностью (до 25 контейнеров) составляет 400 единиц запросов в секунду. |

  Помимо указанных выше, [ограничения на учетные записи](#per-account-limits) также применяются к учетным записям бесплатных уровней.

## <a name="next-steps"></a>Следующие шаги

Ознакомьтесь с дополнительными сведениями о базовом [распределении](distribute-data-globally.md) и [секционировании](partitioning-overview.md) и [подготовленной пропускной способности](request-units.md)Cosmos DB.

Приступая к работе с Azure Cosmos DB, ознакомьтесь с одним из наших кратких руководств:

* [Azure Cosmos DB. Создание веб-приложения API SQL с использованием языка .NET и портала Azure](create-sql-api-dotnet.md)
* [Начало работы с API Azure Cosmos DB для MongoDB](create-mongodb-nodejs.md)
* [Краткое руководство. Создание приложения Cassandra с помощью .NET и Azure Cosmos DB](create-cassandra-dotnet.md)
* [Начало работы с API Gremlin в Azure Cosmos DB](create-graph-dotnet.md)
* [Краткое руководство. Создание приложения API таблицы с помощью .NET и Azure Cosmos DB](create-table-dotnet.md)

> [!div class="nextstepaction"]
> [Бесплатная пробная версия Azure Cosmos DB](https://azure.microsoft.com/try/cosmosdb/)
