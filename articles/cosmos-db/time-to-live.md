---
title: Завершение срока действия данных в Azure Cosmos DB с помощью срока жизни
description: Функция TTL в Microsoft Azure Cosmos DB позволяет автоматически удалять документы из системы по прошествии определенного периода времени.
author: rimman
ms.service: cosmos-db
ms.topic: conceptual
ms.date: 07/26/2019
ms.author: rimman
ms.reviewer: sngun
ms.openlocfilehash: c3e1c4f56c641bf5bfa189836a4bcdf99672a3c1
ms.sourcegitcommit: fe6b91c5f287078e4b4c7356e0fa597e78361abe
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/29/2019
ms.locfileid: "68597484"
---
# <a name="time-to-live-ttl-in-azure-cosmos-db"></a>Срок жизни (TTL) в Azure Cosmos DB 

При использовании **срока жизни** или TTL Azure Cosmos DB предоставляет возможность автоматического удаления элементов из контейнера по истечении определенного периода времени. По умолчанию можно задать срок жизни на уровне контейнера и переопределить значения по элементу. После установки срока жизни на уровне контейнера или элемента Azure Cosmos DB будет автоматически удалять эти элементы по прошествии периода времени с момента их последнего изменения. Значение срока жизни настраивается в секундах. При настройке срока жизни система автоматически удаляет просроченные элементы на основе значения TTL, не требуя операции удаления, явно выданной клиентским приложением.

Удаление элементов с истекшим сроком действия — это фоновая задача, использующая [единицы запроса](request-units.md)слева, которые являются единицами запросов, которые не использовались запросами пользователей. Истечение срока действия может быть отложено, если контейнер находится под интенсивной нагрузкой и для задач обслуживания не осталось единиц запроса.

## <a name="time-to-live-for-containers-and-items"></a>Срок жизни для контейнеров и элементов

Значение срока жизни задается в секундах и интерпретируется как Дельта с момента последнего изменения элемента. Вы можете установить срок жизни для контейнера или элемента в контейнере:

1. **Срок жизни контейнера** (устанавливается с использованием значения `DefaultTimeToLive`):

   - Если свойство отсутствует (или имеет значение NULL), срок действия элементов не истекает автоматически.

   - Если параметр указан и для него задано значение «-1», то оно равно бесконечности, а срок действия элементов по умолчанию истекает.

   - Если параметр указан и в качестве значения задано некоторое число *n* , то срок действия элементов истекает через *"n"* секунд после их последнего изменения времени.

2. **Срок жизни элемента** (устанавливается с использованием значения `ttl`):

   - Это свойство применимо, только если значение `DefaultTimeToLive` присутствует и оно не имеет значения NULL для родительского контейнера.

   - Если свойство присутствует, оно переопределяет значение `DefaultTimeToLive` родительского контейнера.

## <a name="time-to-live-configurations"></a>Настройки срока жизни

* Если для параметра TTL задано значение *"n"* , то срок действия элементов в этом контейнере истекает через *n* секунд.  Если в контейнере есть элементы, для которых имеется собственное время жизни, установите значение-1 (указывает, что срок действия не истекает) или если некоторые элементы переопределили время в реальном времени с другим числом, срок действия этих элементов истекает в соответствии с настроенным значением TTL. 

* Если для контейнера не задан срок жизни, срок жизни элемента в этом контейнере не будет действовать. 

* Если срок жизни контейнера имеет значение -1, элемент в этом контейнере, срок жизни которого равен n, будет действителен в течение n секунд, а срок действия оставшихся элементов не истечет. 

Удаление элементов на основе срока жизни бесплатное. Дополнительная плата не взимается (то есть дополнительные единицы запросов не потребляются), когда элемент удаляется в результате истечения срока жизни.

## <a name="examples"></a>Примеры

В этом разделе показаны некоторые примеры с разной временем жизни значений, назначенных контейнеру и элементам:

### <a name="example-1"></a>Пример 1

Для параметра TTL в контейнере задано значение null (DefaultTimeToLive = null)

|TTL для элемента| Результат|
|---|---|
|TTL = null|    TTL отключен. Срок действия элемента не истекает (по умолчанию).|
|TTL =-1   |TTL отключен. Срок действия элемента никогда не истечет.|
|TTL = 2000 |TTL отключен. Срок действия элемента никогда не истечет.|


### <a name="example-2"></a>Пример 2

Значение срока жизни в контейнере равно-1 (DefaultTimeToLive =-1)

|TTL для элемента| Результат|
|---|---|
|TTL = null |Срок жизни включен. Срок действия элемента не истекает (по умолчанию).|
|TTL =-1   |Срок жизни включен. Срок действия элемента никогда не истечет.|
|TTL = 2000 |Срок жизни включен. Срок действия элемента истекает через 2000 секунд.|


### <a name="example-3"></a>Пример 3

Для параметра TTL в контейнере задано значение 1000 (DefaultTimeToLive = 1000).

|TTL для элемента| Результат|
|---|---|
|TTL = null|    Срок жизни включен. Срок действия элемента истекает через 1000 секунд (по умолчанию).|
|TTL =-1   |Срок жизни включен. Срок действия элемента никогда не истечет.|
|TTL = 2000 |Срок жизни включен. Срок действия элемента истекает через 2000 секунд.|

## <a name="next-steps"></a>Следующие шаги

Узнайте, как настроить срок жизни в следующих статьях:

* [Как настроить срок жизни в Azure Cosmos DB](how-to-time-to-live.md)
