---
title: Завершение срока действия данных в Azure Cosmos DB с помощью срока жизни
description: Функция TTL в Microsoft Azure Cosmos DB позволяет автоматически удалять документы из системы по прошествии определенного периода времени.
author: markjbrown
ms.author: mjbrown
ms.service: cosmos-db
ms.topic: conceptual
ms.date: 07/26/2019
ms.reviewer: sngun
ms.openlocfilehash: 5407c38f33d167ff5114cd55878e3470e7248d71
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/27/2020
ms.locfileid: "77188723"
---
# <a name="time-to-live-ttl-in-azure-cosmos-db"></a>Срок жизни в Azure Cosmos DB 

Благодаря **времени, чтобы жить** или TTL, Azure Cosmos DB предоставляет возможность автоматически удалять элементы из контейнера после определенного периода времени. По умолчанию можно задать срок жизни на уровне контейнера и переопределить значения по элементу. После установки срока жизни на уровне контейнера или элемента Azure Cosmos DB будет автоматически удалять эти элементы по прошествии периода времени с момента их последнего изменения. Значение срока жизни настраивается в секундах. При настройке TTL система автоматически удаляет просроченные элементы на основе значения TTL, без необходимости операции удаления, которая явно выдается клиентским приложением.

Удаление просроченных элементов — это фоновая задача, которая потребляет оставшиеся [единицы запроса,](request-units.md)то есть единицы запросов, которые не были использованы пользовательскими запросами. Даже после истечения срока действия TTL, если контейнер перегружен запросами и если нет достаточного количества RU, удаление данных задерживается. Данные удаляются после того, как имеется достаточно ещр. Хотя удаление данных задерживается, данные не возвращаются никакими запросами (любым API) после истечения срока действия TTL.

## <a name="time-to-live-for-containers-and-items"></a>Срок жизни для контейнеров и элементов

Время для живого значения устанавливается в секундах, и оно интерпретируется как дельта с момента последнего изменения элемента. Вы можете установить срок жизни для контейнера или элемента в контейнере:

1. **Срок жизни контейнера** (устанавливается с использованием значения `DefaultTimeToLive`):

   - Если свойство отсутствует (или имеет значение NULL), срок действия элементов не истекает автоматически.

   - Если настоящее и значение установлено на "-1", оно равно бесконечности, и элементы не истекают по умолчанию.

   - Если настоящее и значение установлено на какое-то число *"n"* - элементы истекают *"n"* секунд после их последнего измененного времени.

2. **Срок жизни элемента** (устанавливается с использованием значения `ttl`):

   - Это свойство применимо, только если значение `DefaultTimeToLive` присутствует и оно не имеет значения NULL для родительского контейнера.

   - Если свойство присутствует, оно переопределяет значение `DefaultTimeToLive` родительского контейнера.

## <a name="time-to-live-configurations"></a>Настройки срока жизни

* Если TTL настроен *на "n"* на контейнере, то срок действия элементов в этом контейнере истекает через *n* секунды.  Если в одном контейнере есть элементы, у которых есть собственное время для жизни, установленные на -1 (указывая на то, что они не истекают) или если некоторые элементы переопределили время для проживания с другим числом, эти элементы истекают на основе их собственного настроенного значения TTL. 

* Если для контейнера не задан срок жизни, срок жизни элемента в этом контейнере не будет действовать. 

* Если срок жизни контейнера имеет значение -1, элемент в этом контейнере, срок жизни которого равен n, будет действителен в течение n секунд, а срок действия оставшихся элементов не истечет.

## <a name="examples"></a>Примеры

В этом разделе показаны некоторые примеры с разным временем для живых значений, присвоенных контейнеру и элементам:

### <a name="example-1"></a>Пример 1

TTL на контейнере установлен на нулевую (DefaultTimeToLive и null)

|TTL по предмету| Результат|
|---|---|
|ttl и null|    TTL отключен. Срок действия элемента никогда не истечет (по умолчанию).|
|ttl -1   |TTL отключен. Срок действия элемента никогда не истечет.|
|ttl 2000 |TTL отключен. Срок действия элемента никогда не истечет.|


### <a name="example-2"></a>Пример 2

TTL на контейнере установлен до -1 (DefaultTimeToLive -1)

|TTL по предмету| Результат|
|---|---|
|ttl и null |TTL включен. Срок действия элемента никогда не истечет (по умолчанию).|
|ttl -1   |TTL включен. Срок действия элемента никогда не истечет.|
|ttl 2000 |TTL включен. Срок действия элемента истекает через 2000 секунд.|


### <a name="example-3"></a>Пример 3

TTL на контейнере установлен до 1000 (DefaultTimeToLive - 1000)

|TTL по предмету| Результат|
|---|---|
|ttl и null|    TTL включен. Срок действия элемента истекает через 1000 секунд (по умолчанию).|
|ttl -1   |TTL включен. Срок действия элемента никогда не истечет.|
|ttl 2000 |TTL включен. Срок действия элемента истекает через 2000 секунд.|

## <a name="next-steps"></a>Дальнейшие действия

Узнайте, как настроить Время жить в следующих статьях:

* [Как настроить срок жизни в Azure Cosmos DB](how-to-time-to-live.md)
