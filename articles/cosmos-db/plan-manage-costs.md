---
title: Планирование и управление затратами для Azure Cosmos DB
description: Узнайте, как планировать и управлять затратами на Azure Cosmos DB с помощью анализа затрат в портал Azure.
author: SnehaGunda
ms.author: sngun
ms.custom: subject-cost-optimization
ms.service: cosmos-db
ms.topic: conceptual
ms.date: 08/19/2020
ms.openlocfilehash: 7f0a8fcb841399eb910f5f043cc75ddad037ee30
ms.sourcegitcommit: d661149f8db075800242bef070ea30f82448981e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/19/2020
ms.locfileid: "88606870"
---
# <a name="plan-and-manage-costs-for-azure-cosmos-db"></a>Планирование и управление затратами для Azure Cosmos DB

В этой статье описывается планирование и управление затратами для Azure Cosmos DB.

- Оценка того, что будет стоить перед созданием ресурсов
- Изучите оценочные затраты по мере начала использования ресурсов.
- Использование функций управления затратами для задания бюджетов и отслеживания затрат
- Ознакомьтесь с прогнозными затратами и выявление тенденций расходов, чтобы выявить области, в которых может потребоваться работать

Изучите, что затраты на Azure Cosmos DB являются частью ежемесячных затрат в счете Azure. Если вы используете другие службы Azure, вам будет выставлен счет за все службы и ресурсы Azure, используемые в вашей подписке Azure, в том числе на сторонние службы. В этой статье описывается планирование и управление затратами для Azure Cosmos DB. После ознакомления с управлением затратами на Azure Cosmos DB можно применить аналогичные методы для управления затратами для всех служб Azure, используемых в вашей подписке.

## <a name="prerequisites"></a>Предварительные требования

Анализ стоимости поддерживает различные типы учетных записей Azure. Полный список поддерживаемых типов учетных записей см. в статье [Understand Cost Management data](../cost-management-billing/costs/understand-cost-mgt-data.md) (Интерпретация данных службы "Управление затратами"). Чтобы просмотреть данные о затратах, нужен как минимум доступ на чтение для учетной записи Azure. Дополнительные сведения о назначении доступа к данным службы "Управление затратами" Azure см. в [этой статье](../cost-management-billing/costs/assign-access-acm-data.md).

## <a name="provisioned-throughput-or-serverless"></a>Подготовленная пропускная способность или бессерверная

Azure Cosmos DB поддерживает два типа режимов емкости: [подготовленная пропускная способность](set-throughput.md) и [бессерверные](serverless.md). Способ оплаты за использование Azure Cosmos DB зависит от множества этих двух режимов, поэтому важно выбрать тот, который лучше всего подходит для вашей рабочей нагрузки. Инструкции и рекомендации по выбору см. в статье [Выбор между подготовленной пропускной способностью и бессерверной](throughput-serverless.md) статьей.

## <a name="estimating-provisioned-throughput-costs-with-capacity-calculator"></a>Оценка подготовленных затрат пропускной способности с помощью калькулятора емкости

Если вы планируете использовать Azure Cosmos DB в режиме подготовленной пропускной способности, используйте [Калькулятор емкости Azure Cosmos DB](https://cosmos.azure.com/capacitycalculator/) , чтобы оценить затраты перед созданием ресурсов в учетной записи Azure Cosmos. Калькулятор емкости используется для оценки необходимой пропускной способности и стоимости рабочей нагрузки. Настройка баз данных и контейнеров Azure Cosmos с правильным объемом подготовленной пропускной способности или [единиц запроса (единицы запросов в секунду)](request-units.md)для вашей рабочей нагрузки очень важно для оптимизации затрат и производительности. Необходимо ввести такие сведения, как тип API, число регионов, размер элемента, количество запросов на чтение и запись в секунду, общий объем сохраненных данных для получения оценки затрат. Дополнительные сведения о калькуляторе емкости см. в статье об [оценке](estimate-ru-with-capacity-planner.md) .

На следующем снимке экрана показана пропускная способность и оценка затрат с помощью калькулятора емкости:

:::image type="content" source="./media/plan-manage-costs/capacity-calculator-cost-estimate.png" alt-text="Оценка затрат в калькуляторе Azure Cosmos DBной емкости":::

## <a name="estimating-serverless-costs"></a>Оценка бессерверных затрат

Если вы планируете использовать Azure Cosmos DB в бессерверном режиме, необходимо оценить количество [единиц запросов](request-units.md) и ГБ хранилища, которые можно использовать ежемесячно. Вы можете оценить требуемый объем единиц запросов, оценивая количество операций с базой данных, которые выдаются в течение месяца, и умножьте их на соответствующие затраты на ЕДИНИЦу. В следующей таблице перечислены приблизительные выплаты за ЕДИНИЦу для распространенных операций с базой данных.

| Операция | Расчетные затраты | Примечания |
| --- | --- | --- |
| Создание элемента | 5 ЕЗ | Средняя стоимость для элемента с 1 КБ и меньше 5 свойств для индекса |
| Обновление элемента | 10 ЕЗ | Средняя стоимость для элемента с 1 КБ и меньше 5 свойств для индекса |
| Чтение отдельного элемента по его ИДЕНТИФИКАТОРу и ключу раздела (точка-чтение) | 1 ЕЗ | Средняя стоимость для элемента с 1 КБ |
| Удаление элемента | 5 ЕЗ | |
| Выполнение запроса | 10 ЕЗ | Средняя стоимость запроса, которая использует все преимущества [индексирования](index-overview.md) и возвращает 100 результатов или меньше |

> [!IMPORTANT] 
> Обратите внимание на примечания из приведенной выше таблицы. Чтобы получить более точную оценку фактических затрат на операции, можно использовать [эмулятор Azure Cosmos](local-emulator.md) и [оценить стоимость операций в единицах](find-request-unit-charge.md). Хотя эмулятор Cosmos для Azure не поддерживает бессерверные операции, он сообщает о стандартной ЕДИНИЦе оплаты для операций с базой данных и может использоваться для этой оценки.

После вычисления общего числа единиц запросов и ГБ хранилища, которые, скорее всего, будут использоваться в течение месяца, следующая формула вернет оценку стоимости: **([число единиц запросов]/1 000 000 * $0,25) + ([ГБ хранилища] * $0,25)**.

> [!NOTE]
> Стоимость, показанная в предыдущем примере, используется только в демонстрационных целях. Последние сведения о ценах см. на [странице с ценами](https://azure.microsoft.com/pricing/details/cosmos-db/) .

## <a name="review-estimated-costs-from-the-azure-portal"></a>Ознакомьтесь с оценочными затратами портал Azure

Когда вы начинаете использовать Azure Cosmos DB ресурсы из портал Azure, можно увидеть оценочные затраты. Чтобы ознакомиться с оценкой затрат, выполните следующие действия.

1. Войдите в портал Azure и перейдите к своей учетной записи Azure Cosmos.
1. Перейдите к разделу **Обзор** .
1. Проверьте диаграмму **затрат** внизу. На этой диаграмме показана оценка текущих затрат за настраиваемый период времени:
1. Создание нового контейнера, например контейнера графа.
1. Введите пропускную способность, необходимую для рабочей нагрузки, например 400 единиц запросов в секунду. После ввода значения пропускной способности можно увидеть оценку цены, как показано на следующем снимке экрана:

   :::image type="content" source="./media/plan-manage-costs/cost-estimate-portal.png" alt-text="Оценка затрат в портал Azure":::

## <a name="use-budgets-and-cost-alerts"></a>Использование оповещений о бюджете и затратах

Вы можете создать [бюджеты](../cost-management/tutorial-acm-create-budgets.md), чтобы управлять затратами и создавать оповещения, которые автоматически уведомляют заинтересованные лица о нетипичных и чрезмерных затратах. Оповещения основываются на расходах по сравнению с пороговыми значениями бюджета и затрат. Бюджеты и оповещения создаются для подписок Azure и групп ресурсов, поэтому они полезны в рамках общей стратегии мониторинга затрат. Однако они могут иметь ограниченную функциональность для управления отдельными затратами на службы Azure, например стоимостью Azure Cosmos DB, так как они предназначены для мониторинга затрат на более высоком уровне.

Если у вашей подписки Azure есть предельная сумма расходов, Azure не позволит вам тратить деньги на сумму кредита. При создании и использовании ресурсов Azure используются ваши кредиты. При достижении лимита кредита развернутые ресурсы отключаются в оставшейся части этого расчетного периода. Вы не можете изменить лимит кредита, но можете удалить его. Дополнительные сведения об ограничениях расходов см. в статье [предельная сумма расходов в Azure](../billing/billing-spending-limit.md).

## <a name="monitor-costs"></a>Мониторинг затрат

При использовании ресурсов с Azure Cosmos DB взимается плата. Затраты на единицы использования ресурсов зависят от временных интервалов (секунды, минуты, часы и дни) или использования единиц запросов. После начала использования Azure Cosmos DB затраты изменяются, и их можно увидеть на панели [анализ затрат](../cost-management/quick-acm-cost-analysis.md) в портал Azure.

При использовании анализа затрат можно просматривать Azure Cosmos DBные затраты в диаграммах и таблицах для различных временных интервалов. Некоторые примеры относятся к дню, текущему, предыдущему месяцу и году. Вы также можете просматривать затраты по бюджету и прогнозируемым затратам. Переключение на более длительные представления с течением времени может помочь определить тенденции расходов и узнать, где могла произойти чрезмерное расходование. Если вы создали бюджеты, вы также сможете легко увидеть, где они превышаются. Просмотр Azure Cosmos DB затрат в анализе затрат:

1. Войдите на [портал Azure](https://portal.azure.com).

1. Откройте окно **Управление затратами + выставление счетов** , выберите в меню пункт **Управление затратами** , а затем выберите **анализ затрат**. Затем можно изменить область для конкретной подписки из раскрывающегося списка **область** .

1. По умолчанию стоимость всех служб показана на первой кольцевой диаграмме. Выберите область диаграммы с меткой "Azure Cosmos DB".

1. Чтобы уменьшить затраты на одну службу, например Azure Cosmos DB, щелкните **Добавить фильтр** , а затем выберите **имя службы**. Затем выберите **Azure Cosmos DB** из списка. Ниже приведен пример, показывающий затраты только на Azure Cosmos DB:
 
   :::image type="content" source="./media/plan-manage-costs/cost-analysis-pane.png" alt-text="Мониторинг затрат с помощью панели анализ затрат":::

В предыдущем примере отображаются текущие затраты на Azure Cosmos DB для месяца февраля. Диаграммы также содержат Azure Cosmos DB затраты по расположению и группе ресурсов.

## <a name="next-steps"></a>Дальнейшие действия

Дополнительные сведения о том, как работают цены в Azure Cosmos DB, см. в следующих статьях:

* [Модели ценообразования в Azure Cosmos DB](how-pricing-works.md)
* [Optimize provisioned throughput cost in Azure Cosmos DB](optimize-cost-throughput.md) (Оптимизация стоимости подготовленной пропускной способности в Azure Cosmos DB)
* [Optimize query cost in Azure Cosmos DB](optimize-cost-queries.md) (Оптимизация затрат на отправку запросов в Azure Cosmos DB)
* [Оптимизация затрат на хранение в Azure Cosmos DB](optimize-cost-storage.md)
