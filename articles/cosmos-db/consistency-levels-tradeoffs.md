---
title: Достижение компромисса между доступностью и быстродействием для разных уровней согласованности в Azure Cosmos DB
description: Достижение компромисса между доступностью и быстродействием для разных уровней согласованности в Azure Cosmos DB.
author: rimman
ms.service: cosmos-db
ms.topic: conceptual
ms.date: 05/21/2019
ms.author: rimman
ms.reviewer: sngun
ms.openlocfilehash: 09777a9980e4576a5d00123516e33696e845dcac
ms.sourcegitcommit: d4dfbc34a1f03488e1b7bc5e711a11b72c717ada
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/13/2019
ms.locfileid: "65990220"
---
# <a name="consistency-availability-and-performance-tradeoffs"></a>Компромиссы согласованности, доступности и производительности 

Распределенные базы данных, которые полагаются на репликацию для обеспечения высокого уровня доступности, низкой задержки или того и другого, должны быть компромиссными. Это компромиссы между согласованностью чтения и доступностью, задержкой и пропускной способностью.

В Azure Cosmos DB согласованность данных рассматривается как плавный спектр возможных вариантов. Этот подход включает дополнительные возможности помимо двух крайностей в виде строгой и итоговой согласованности. Вы можете выбрать из пяти четко определенных моделей спектра согласованности. Это такие модели (приведены в порядке от сильных к слабым):

- *Строгая*
- *Ограниченное устаревание*
- *Согласованность сеанса*
- *Постоянный префикс*
- *Итоговая*

Каждая модель обеспечивает доступность и производительность компромиссы и поддерживаемый комплексные соглашения об уровне обслуживания.

## <a name="consistency-levels-and-latency"></a>Уровни согласованности и время задержки

Задержка чтения для всех уровней согласованности гарантированно никогда не превышает 10 миллисекунд для 99-го процентиля, что оговаривается Соглашением об уровне обслуживания. Среднее время задержки чтения (50-й процентиль) обычно не превышает 2 миллисекунды. Учетные записи Azure Cosmos, охватывающие несколько регионов и настраиваемые со строгой согласованностью, являются исключением из этой гарантии.

Задержка записи для всех уровней согласованности всегда гарантированно не более 10 миллисекунд на уровне 99-го процентиля. Соглашение об уровне обслуживания хранит задержку записи. Среднее время задержки записи (50-й процентиль) обычно не превышает 5 миллисекунд.

Для учетных записей Azure Cosmos, настроен со строгой согласованностью с более чем одного региона задержка записи гарантированно будет меньше, чем два раза больше времени приема-передачи (RTT) между любыми двумя выбирается самый дальний регионами, а также 10 миллисекунд на уровне 99-го процентиля.

Точная задержка RTT определяется расстоянием, которое преодолевает сигнал, двигаясь со скоростью света, и топологией сети Azure. Для сетей Azure не предусмотрены Соглашения об уровне обслуживания, определяющие задержки для RTT между любыми двумя регионами Azure. Задержки репликации учетной записи Azure Cosmos отображаются на портале Azure. Портал Azure (перейдите к колонке "метрики") можно использовать для отслеживания задержки репликации между различными регионами, которые связаны с учетной записью Azure Cosmos.

## <a name="consistency-levels-and-throughput"></a>Уровни согласованности и пропускная способность

- Для одинакового количества единиц запроса уровни согласованности "Сеансовая", "Постоянный префикс" и "Нестрогая" обеспечивают пропускную способность для операций чтения примерно в два раза выше, чем у уровней согласованности "Строгая" и "Ограниченное устаревание".

- Для этого типа операций записи (вставка, замена, обновление или вставка, удаление и т. д.) пропускная способность одинаковая для всех уровней согласованности.

## <a id="rto"></a>Уровни согласованности и устойчивость данных

В среде глобально распределенной базы данных существует прямая связь между уровнем согласованности и устойчивостью данных при наличии простоя в регионе. При разработке плана обеспечения непрерывности бизнес-процессов нужно понимать, какое максимальное время до полного восстановления приложения после аварийного события допустимо. Время, необходимое для приложения, чтобы полностью восстановить называется **целевое время восстановления** (**RTO**). Необходимо также понимать, потерю какого максимального периода последних обновлений данных приложение может допустить при восстановлении после аварийного события. Период обновления, которые могут позволить себе потерять называется **целевая точка восстановления** (**RPO**).

Приведенная ниже таблица описывает связь между согласованности модели и надежности данных, при наличии широкого сбой региона. Важно отметить, что в распределенной системе, даже со строгой согласованностью, он не может быть распределенную базу данных с RPO и RTO нулевой из-за Теорема CAP. Дополнительные сведения о том, почему, см. в разделе [уровни согласованности в Azure Cosmos DB](consistency-levels.md).

|**Регионы**|**Режим репликации**|**Уровень согласованности**|**RPO**|**RTO**|
|---------|---------|---------|---------|---------|
|1|Подход с одним или несколькими источниками|Любой уровень согласованности|< 240 минут|< 1 неделя|
|>1|Single Master|Сеанс, постоянный префикс, случайный|< 15 минут|< 15 минут|
|>1|Single Master|Ограниченное устаревание|*K* & *T*|< 15 минут|
|>1|Single Master|Уровень согласованности Strong (сильная)|0|< 15 минут|
|>1|Подход с несколькими источниками|Сеанс, постоянный префикс, случайный|< 15 минут|0|
|>1|Подход с несколькими источниками|Ограниченное устаревание|*K* & *T*|0|

*K* = число *«K»* версиях элемент (т. е. обновления).

*T* = интервал времени *«T»* с момента последнего обновления.

## <a name="next-steps"></a>Дальнейшие действия

Узнайте о глобальном распределении и общих компромиссах согласованности в распределенных системах: Ознакомьтесь со следующими статьями:

- [Consistency Tradeoffs in Modern Distributed Database Systems Design](https://www.computer.org/csdl/magazine/co/2012/02/mco2012020037/13rRUxjyX7k) (Достижение компромиссов согласованности в современных распределенных базах данных)
- [Высокая доступность](high-availability.md)
- [Соглашение об уровне обслуживания для Azure Cosmos DB](https://azure.microsoft.com/support/legal/sla/cosmos-db/v1_2/)
