---
title: Часто задаваемые вопросы о пропускной способности в Azure Cosmos DB режиме автопилота
description: Часто задаваемые вопросы о режиме автопилота для Azure Cosmos DB баз данных и контейнеров
author: deborahc
ms.author: dech
ms.service: cosmos-db
ms.topic: conceptual
ms.date: 12/16/2019
ms.openlocfilehash: d2ad585cabefb9ea78b88e748e422c745c11d03f
ms.sourcegitcommit: f4f626d6e92174086c530ed9bf3ccbe058639081
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/25/2019
ms.locfileid: "75483314"
---
# <a name="frequently-asked-questions-about-provisioned-throughput-in-azure-cosmos-db-autopilot-mode-preview"></a>Часто задаваемые вопросы о подготовленной пропускной способности в Azure Cosmos DB режиме автопилота (Предварительная версия)
В режиме автоматического экспериментального развертывания Azure Cosmos DB будет автоматически управлять и масштабировать единицу запросов в контейнере или базе данных на основе их использования. В этой статье содержатся ответы на часто задаваемые вопросы о режиме автопилота. 

## <a name="frequently-asked-questions"></a>Часто задаваемые вопросы

### <a name="is-autopilot-mode-supported-for-all-apis"></a>Поддерживается ли режим автопилотного режима для всех API?
Да, режим автопилота поддерживается для всех API: Core (SQL), Gremlin, Table, Cassandra и API для MongoDB.

### <a name="is-autopilot-mode-supported-for-multi-master-accounts"></a>Поддерживается ли режим автопилотного режима для учетных записей с несколькими хозяевами?
Да, режим автопилота поддерживается для учетных записей с несколькими хозяевами. В каждом регионе, который добавляется в учетную запись Cosmos, доступны максимальные единицы запросов в секунду. 

### <a name="what-is-the-pricing-for-autopilot"></a>Каковы цены на автопилот?
Дополнительные сведения см. на [странице цен](https://azure.microsoft.com/pricing/details/cosmos-db/) на Azure Cosmos DB. 

### <a name="how-do-i-enable-autopilot-for-my-containers-or-databases"></a>Разделы справки включить Автопилот для контейнеров или баз данных?
Режим автопилота можно включить для новых контейнеров и баз данных, созданных с помощью портал Azure. 

### <a name="is-there-cli-or-sdk-support-to-create-containers-or-databases-with-autopilot-mode"></a>Поддерживается ли интерфейс командной строки или пакет SDK для создания контейнеров или баз данных в режиме автопилота?
В настоящее время в предварительной версии можно создавать только ресурсы с режимом автопилота из портал Azure. Поддержка интерфейса командной строки и пакета SDK пока недоступна.

### <a name="can-i-enable-autopilot-on-an-existing-container-or-a-database"></a>Можно ли включить функцию автопилота в существующем контейнере или базе данных?
В настоящее время автопилот можно включить в новых контейнерах и базах данных при их создании. Поддержка включения режима автопилота в существующих контейнерах и базах данных пока недоступна. Вы можете перенести существующие контейнеры в новый контейнер с помощью [фабрики данных Azure](../data-factory/connector-azure-cosmos-db.md) или [веб-канала изменений](change-feed.md). 

### <a name="can-i-turn-off-autopilot-mode-on-a-container-or-database"></a>Можно ли отключить режим автопилота в контейнере или базе данных?
Да, вы можете отключить автопилот, перейдя к параметру "вручную" для подготовленной пропускной способности. В предварительной версии после переключения из режима автопилота в режим "вручную" вы не сможете снова включить Автопилот для того же ресурса. 

### <a name="is-autopilot-mode-supported-for-shared-throughput-databases"></a>Поддерживается ли режим автопилотного режима для баз данных с общей пропускной способностью?
Да, режим автопилота поддерживается для баз данных с общей пропускной способностью. Чтобы включить эту функцию, выберите режим автопилота и параметр **подготовить пропускную способность** при создании базы данных. 

### <a name="what-is-the-number-of-allowed-collections-per-shared-throughput-database-when-autopilot-is-enabled"></a>Каково число разрешенных коллекций на базу данных с общей пропускной способностью при включенном автопилоте?
Для баз данных с общим пропускной способностью с включенным режимом автопилота количество разрешенных коллекций: MIN (25, Max единиц запросов в секунду для базы данных/1000). Например, если максимальная пропускная способность базы данных составляет 20 000 единиц запросов в секунду, то база данных может иметь минимум (25, 20 000 единиц запросов в секунду/1000) = 20 коллекций. 


### <a name="what-is-the-storage-limit-associated-with-each-max-rus-option"></a>Какова предельная длина хранилища, связанная с каждым параметром max RU/s?  
Максимальный размер хранилища в ГБ для каждого максимального единиц запросов в секунду: Max единиц запросов в секунду или контейнера/100. Например, если максимальное количество единиц запросов в секунду — 20 000 единиц запросов в секунду, ресурс может поддерживать 200 ГБ хранилища. В статье [ограничения для автопилота](provision-throughput-autopilot.md#autopilot-limits) приведены доступные максимальные значения единиц запросов в секунду и хранилища. 

### <a name="what-happens-if-i-exceed-the-storage-limit-associated-with-my-max-throughput"></a>Что произойдет, если превышен предельный объем хранилища, связанный с максимальной пропускной способностью?
Если превышено ограничение объема хранилища, связанное с максимальной пропускной способностью базы данных или контейнера, Azure Cosmos DB автоматически увеличит максимальную пропускную способность до следующего уровня, поддерживающего этот уровень хранения. Например, предположим, что база данных или контейнер подготовлены с помощью параметра максимальной пропускной способности 4000 единиц запросов в секунду с ограничением в 50 ГБ. Если размер хранилища ресурса увеличится до 100 ГБ, максимальная единица запросов в секунду в базе данных или контейнере будет автоматически увеличена до 20 000 единиц запросов в секунду, что может поддерживать до 200 ГБ. 

### <a name="how-quickly-will-autopilot-scale-up-and-down-based-on-spikes-in-traffic"></a>Как быстро будет осуществляться автоматическое увеличение и уменьшение масштаба в зависимости от пиков трафика?
Автопилот будет мгновенно увеличивать или уменьшать масштаб единиц запросов/с в пределах минимального и максимального диапазона единиц запросов в секунду на основе входящего трафика. Выставление счетов выполняется через 1-часовой уровень детализации, где за определенный час взимается плата за наибольший единиц запросов в секунду. 

### <a name="can-i-specify-a-custom-max-throughput-rus-value-for-autopilot-mode"></a>Можно ли указать настраиваемое значение максимальной пропускной способности (единиц запросов в секунду) для режима автопилота?
В настоящее время в предварительной версии можно выбрать один из [четырех вариантов](provision-throughput-autopilot.md#autopilot-limits) максимальной пропускной способности (единиц запросов в секунду).

### <a name="can-i-increase-the-max-rus-move-to-a-higher-tier-on-the-database-or-container"></a>Можно ли увеличить максимальное число единиц запросов в секунду (переместить на более высокий уровень) в базе данных или контейнере? 
Да. В параметре **масштабировать & параметры** для контейнера или параметра масштаб для базы данных можно выбрать более высокий **Коэффициент** единиц запросов в секунду для автопилота. Это асинхронная операция масштабирования, которая может занять некоторое время (обычно 4-6 часов в зависимости от выбранного количества единиц запросов в секунду), так как служба предоставляет больше ресурсов для поддержки более высоких масштабов. 

### <a name="can-i-reduce-the-max-rus-move-to-a-lower-tier-on-the-database-or-container"></a>Можно ли сократить максимальное число единиц запросов в секунду (переместить на более низкий уровень) в базе данных или контейнере?
Да. Пока текущее хранилище базы данных или контейнера меньше [предельного размера хранилища](#what-is-the-storage-limit-associated-with-each-max-rus-option) , связанного с максимальным уровнем единиц запросов в секунду, до которого нужно масштабироваться, можно уменьшить число единиц запросов в секунду на этом уровне. Например, если в качестве максимального числа единиц запросов в секунду выбрано 20 000 единиц запросов в секунду, можно уменьшить число единиц запросов в секунду до 4000 единиц запросов в секунду, если объем хранилища не превышает 50 ГБ (предельный размер хранилища, связанный с 4000 единиц запросов в секунду).

### <a name="what-is-the-mapping-between-the-max-rus-and-physical-partitions"></a>Что такое сопоставление между максимальной единицей запросов/с и физическими секциями?
При первом выборе параметра max единиц запросов в секунду Azure Cosmos DB будет подготавливаться: Max единиц запросов в секунду/10 000 единиц запросов/с = # для физических секций. Каждый [физический раздел](partition-data.md#physical-partitions) может поддерживать до 10 000 единиц запросов в секунду и 50 ГБ памяти. По мере роста размера хранилища Azure Cosmos DB автоматически разделит секции, чтобы добавить дополнительные физические секции для увеличения объема хранилища, или увеличить максимальный уровень единиц запросов в секунду, если размер хранилища [превышает соответствующее ограничение](#what-is-the-storage-limit-associated-with-each-max-rus-option). 

Максимальное количество единиц запросов в секунду для базы данных или контейнера распределяется равномерно по всем физическим секциям. Таким образом, Общая пропускная способность для одной физической секции может масштабироваться на: Max единиц запросов в секунду или контейнер/число физических секций. 

### <a name="what-happens-if-incoming-requests-exceed-the-max-rus-of-the-database-or-container"></a>Что произойдет, если входящие запросы превышают максимальную ЕДИНИЦу запросов в секунду для базы данных или контейнера?
Если общий объем занятых единиц запросов в секунду превышает максимальную ЕДИНИЦу запросов в секунду для контейнера или базы данных, запросы, превышающие максимальное количество единиц запросов в секунду, будут регулироваться и возвращать код состояния 429. Запросы, которые приводят к более 100% нормализованной загрузке, также будут регулироваться. Нормализованное использование определяется как максимальное значение использования единиц запросов/s во всех физических секциях. Например, предположим, что максимальная пропускная способность составляет 20 000 единиц запросов в секунду и имеется два физических раздела, P_1 и P_2, каждый из которых поддерживает масштабирование до 10 000 единиц запросов в секунду. В течение этой секунды, если P_1 использовал 6000 RUs и P_2 8000, то нормализованная Загрузка равна MAX (6000 единиц запроса/10 000 RU, 8000 единиц запросов/10 000 RU) = 0,8.

> [!NOTE]
> Azure Cosmos DB клиентские пакеты SDK и средства импорта данных (фабрика данных Azure, Библиотека массовых исполнителей) автоматически перезапускаются в 429s, поэтому иногда 429s хорошо. Длительное большое число 429s может означать, что необходимо увеличить максимальное количество единиц запросов в секунду, или проверить стратегию секционирования для [горячей секции](#is-it-still-possible-to-see-429s-throttlingrate-limiting-when-autopilot-is-enabled).

### <a name="is-it-still-possible-to-see-429s-throttlingrate-limiting-when-autopilot-is-enabled"></a>Можно ли по-прежнему видеть 429s (ограничение регулирования или частоту) при включении автопилота? 
Да. 429s можно увидеть в двух сценариях. Во-первых, если общий объем занятых единиц запросов в секунду превышает максимальное количество единиц запросов в секунду для контейнера или базы данных, служба будет регулировать запросы соответствующим образом. 

Во-вторых, если имеется горячая секция, т. е. значение ключа логической секции с непропорционально большим количеством запросов по сравнению с другими значениями ключей секций, то возможно, что базовая физическая Секция превысит его бюджет на ЕДИНИЦу. Рекомендуется [выбирать хороший ключ секции](partitioning-overview.md#choose-partitionkey) , который приводит к равномерному распределению хранилища и пропускной способности. 

Например, при выборе параметра максимальной пропускной способности 20 000 единиц запросов в секунду и наличии 200 ГБ хранилища с четырьмя физическими секциями можно автоматически масштабировать каждую физическую секцию до 5000 единиц запросов в секунду. Если для определенного ключа логической секции была создана горячая секция, вы увидите 429s, когда базовая физическая секция, в которой он находится, превышает 5000 единиц запросов в секунду, т. е. превышает 100% нормализованное использование.

## <a name="next-steps"></a>Дальнейшие действия

* Узнайте, как [Включить автопилот в контейнере или базе данных Azure Cosmos](provision-throughput-autopilot.md#create-a-database-or-a-container-with-autopilot-mode).
* Узнайте о [преимуществах автопилота](provision-throughput-autopilot.md#benefits-of-autopilot-mode).
* Дополнительные сведения о [логических и физических секциях](partition-data.md).
