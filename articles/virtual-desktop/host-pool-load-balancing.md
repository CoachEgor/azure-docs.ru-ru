---
title: Балансировка нагрузки пула узлов виртуальных рабочих столов Windows — Azure
description: Методы балансировки нагрузки пула узлов для среды виртуальных рабочих столов Windows.
services: virtual-desktop
author: Heidilohr
ms.service: virtual-desktop
ms.topic: conceptual
ms.date: 03/21/2019
ms.author: helohr
manager: lizross
ms.openlocfilehash: 15d50033a1316601dd8c36bd5748c659f4397d66
ms.sourcegitcommit: 50ef5c2798da04cf746181fbfa3253fca366feaa
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/30/2020
ms.locfileid: "82612050"
---
# <a name="host-pool-load-balancing-methods"></a>Методы балансировки нагрузки пула узлов

>[!IMPORTANT]
>Это содержимое относится к обновлению пружины 2020 с Azure Resource Manager объектов виртуальных рабочих столов Windows. Если вы используете виртуальный рабочий стол Windows в выпуске 2019 без Azure Resource Manager объектов, см. [эту статью](./virtual-desktop-fall-2019/host-pool-load-balancing-2019.md).
>
> Обновление 2020 виртуального рабочего стола Windows в настоящее время находится в общедоступной предварительной версии. Эта предварительная версия предоставляется без соглашения об уровне обслуживания, и мы не рекомендуем использовать ее для рабочих нагрузок. Некоторые функции могут не поддерживаться или их возможности могут быть ограничены. 
> Дополнительные сведения см. в статье [Дополнительные условия использования предварительных выпусков Microsoft Azure](https://azure.microsoft.com/support/legal/preview-supplemental-terms/).

Виртуальный рабочий стол Windows поддерживает два метода балансировки нагрузки. Каждый метод определяет, на каком узле сеансов будет размещаться сеанс пользователя при подключении к ресурсу в пуле узлов.

В виртуальном рабочем столе Windows доступны следующие методы балансировки нагрузки:

- Балансировка нагрузки по горизонтали позволяет равномерно распределять пользовательские сеансы между узлами сеансов в пуле узлов.
- Балансировка нагрузки с глубиной в первую очередь позволяет перегрузить узел сеансов с пользовательскими сеансами в пуле узлов. По достижении порогового значения ограничения сеанса подсистема балансировки нагрузки направляет новые подключения пользователей к следующему узлу сеанса в пуле узлов, пока не достигнет предела и т. д.

Каждый пул узлов может настраивать только один тип балансировки нагрузки. Однако оба метода балансировки нагрузки имеют следующие характеристики, независимо от того, в каком пуле узлов они находятся.

- Если у пользователя уже есть сеанс в пуле узлов и выполняется его повторное подключение к этому сеансу, подсистема балансировки нагрузки будет успешно перенаправлять их на узел сеансов с помощью существующего сеанса. Это поведение применяется, даже если свойство Алловневконнектионс узла сеанса имеет значение false.
- Если у пользователя еще нет сеанса в пуле узлов, подсистема балансировки нагрузки не будет рассматривать узлы сеансов, свойство Алловневконнектионс которых имеет значение false во время балансировки нагрузки.

## <a name="breadth-first-load-balancing-method"></a>Метод балансировки нагрузки по ширине

Метод балансировки нагрузки с балансом по ширине позволяет распределять пользовательские соединения для оптимизации этого сценария. Этот метод идеально подходит для организаций, которые хотят обеспечить оптимальную работу пользователей, подключающихся к среде виртуального рабочего стола в составе пула.

Сначала метод «по ширине» сначала запрашивает узлы сеансов, разрешающие новые соединения. Затем метод выбирает узел сеанса с наименьшим числом сеансов. Если существует связь, метод выбирает в запросе первый узел сеанса.

## <a name="depth-first-load-balancing-method"></a>Метод балансировки нагрузки с глубиной до первого

Метод балансировки нагрузки с глубиной в первый раз позволяет одновременно загружает один узел сеанса, чтобы оптимизировать его для этого сценария. Этот метод идеально подходит для организаций с учетом затрат, которым требуется более детальный контроль над количеством виртуальных машин, выделенных для пула узлов.

Сначала метод Depth выполняет запрос к узлам сеансов, которые разрешают новые соединения и не проводили превышение максимального числа сеансов. Затем метод выбирает узел сеанса с наибольшим числом сеансов. Если имеется связь, метод выбирает в запросе первый узел сеанса.