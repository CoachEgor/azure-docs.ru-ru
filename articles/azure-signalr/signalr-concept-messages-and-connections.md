---
title: Сообщения и подключения в службе Azure SignalR
description: Обзор основных понятий, касающихся сообщений и подключений в службе Azure SignalR.
author: sffamily
ms.service: signalr
ms.topic: conceptual
ms.date: 03/01/2019
ms.author: zhshang
ms.openlocfilehash: 5f6428231a3639738e8fb52e7dc3f2f2a3d2a26e
ms.sourcegitcommit: f4f626d6e92174086c530ed9bf3ccbe058639081
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/25/2019
ms.locfileid: "75392812"
---
# <a name="messages-and-connections-in-azure-signalr-service"></a>Сообщения и подключения в службе Azure SignalR

Модель выставления счетов службы Azure SignalR основана на количестве подключений и сообщений. В этой статье объясняется, как сообщения и подключения определяются и учитываются при выставлении счетов.


## <a name="message-formats"></a>Форматы сообщений 

Служба Azure SignalR поддерживает те же форматы, что и ASP.NET Core SignalR: [JSON](https://www.json.org/) и [MessagePack](/aspnet/core/signalr/messagepackhubprotocol).

## <a name="message-size"></a>Размер сообщения

В службе Azure SignalR нет ограничений на размер сообщений.

Большие сообщения разбиваются на меньшие размером не более 2 КБ и передаются в виде отдельных сообщений. Разбиение и соединение сообщений обрабатываются с помощью пакетов SDK. При этом усилия со стороны разработчиков не требуются.

Большие сообщения снижают производительность обмена сообщениями. Используйте сообщения меньшего размера всегда, когда это возможно, и выполняйте тестирование, чтобы выбрать оптимальный размер сообщения для каждого сценария использования.

## <a name="how-messages-are-counted-for-billing"></a>Подсчет сообщений для выставления счетов

При выставлении счетов учитываются только исходящие сообщения службы Azure SignalR. Сообщения проверки связи, которыми обмениваются клиенты и серверы, в расчет не берутся.

Сообщения размером более 2 КБ считаются как несколько сообщений по 2 КБ. Диаграмма числа сообщений на портале Azure обновляется при поступлении каждых 100 сообщений на концентратор.

Например, у вас есть три клиента и один сервер приложений. Один клиент отправляет одно сообщение размером 4 КБ, чтобы сервер передал данные всем клиентам. Количество сообщений равно восьми: одно сообщение от службы к серверу приложений и три сообщения от службы к клиентам. Каждое сообщение считается как два сообщения по 2 КБ.

## <a name="how-connections-are-counted"></a>Подсчет подключений

Существуют подключения к серверу и клиентские подключения со службой Azure SignalR. По умолчанию каждый сервер приложений запускается с пятью начальными подключениями на каждый концентратор, и каждый клиент имеет одно клиентское соединение.

Число подключений, отображаемое на портале Azure, включает в себя как серверные, так и клиентские подключения.

Например, у вас есть два сервера приложений и вы определили пять концентраторов в коде. Число подключений к серверу будет 50:2 сервера приложений * 5 концентраторов * 5 подключений на концентратор.

Служба SignalR для ASP.NET подсчитывает подключения к серверу по-другому. Она добавляет один стандартный концентратор к уже определенным вами концентраторам. По умолчанию каждому серверу приложений требуется пять первых серверных подключений. Начальное число подключений для концентратора по умолчанию остается согласованным с другими центрами.

В течение времени существования сервера приложений Служба и сервер приложений сохраняют состояние подключения синхронизации и выполняют настройку подключений к серверу для повышения производительности и стабильности служб. Так что вы можете увидеть, что количество подключений к серверу изменяется с момента времени.

## <a name="how-inboundoutbound-traffic-is-counted"></a>Подсчет входящего и исходящего трафика

Различия между входящим и исходящим трафиком зависят от перспективы службы Azure SignalR. Трафик вычисляется в байтах.

## <a name="related-resources"></a>Связанные ресурсы

- [Метрики, поддерживаемые Azure Monitor](/azure/azure-monitor/platform/metrics-supported#microsoftsignalrservicesignalr )
- [Конфигурация SignalR для ASP.NET Core](/aspnet/core/signalr/configuration)
- [JSON](https://www.json.org/)
- [MessagePack](/aspnet/core/signalr/messagepackhubprotocol)
