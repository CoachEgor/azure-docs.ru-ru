---
title: Сообщения и подключения в службе Azure SignalR
description: Обзор основных понятий, касающихся сообщений и подключений в службе Azure SignalR.
author: sffamily
ms.service: signalr
ms.topic: conceptual
ms.date: 03/01/2019
ms.author: zhshang
ms.openlocfilehash: e82ce8f5c97aed7e2cb832d8e808ff84691f7c9e
ms.sourcegitcommit: 3102f886aa962842303c8753fe8fa5324a52834a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "61401208"
---
# <a name="messages-and-connections-in-azure-signalr-service"></a>Сообщения и подключения в службе Azure SignalR

Модель выставления счетов службы Azure SignalR основана на количестве подключений и сообщений. В этой статье объясняется, как сообщения и подключения определяются и учитываются при выставлении счетов.


## <a name="message-formats"></a>Форматы сообщений 

Служба Azure SignalR поддерживает те же форматы, что и служба SignalR для ASP.NET Core: [JSON](https://www.json.org/) и [MessagePack](/aspnet/core/signalr/messagepackhubprotocol).

## <a name="message-size"></a>Размер сообщения

В службе Azure SignalR нет ограничений на размер сообщений.

Большие сообщения разбиваются на меньшие размером не более 2 КБ и передаются в виде отдельных сообщений. Разбиение и соединение сообщений обрабатываются с помощью пакетов SDK. При этом усилия со стороны разработчиков не требуются.

Большие сообщения снижают производительность обмена сообщениями. Используйте сообщения меньшего размера всегда, когда это возможно, и выполняйте тестирование, чтобы выбрать оптимальный размер сообщения для каждого сценария использования.

## <a name="how-messages-are-counted-for-billing"></a>Подсчет сообщений для выставления счетов

При выставлении счетов учитываются только исходящие сообщения службы Azure SignalR. Сообщения проверки связи, которыми обмениваются клиенты и серверы, в расчет не берутся.

Сообщения размером более 2 КБ считаются как несколько сообщений по 2 КБ. Диаграмма числа сообщений на портале Azure обновляется при поступлении каждых 100 сообщений на концентратор.

Например, у вас есть три клиента и один сервер приложений. Один клиент отправляет одно сообщение размером 4 КБ, чтобы сервер передал данные всем клиентам. Количество сообщений равно восьми: одно сообщение от службы к серверу приложений и три сообщения от службы к клиентам. Каждое сообщение считается как два сообщения по 2 КБ.

На портале Azure для количества сообщений будет отображаться значение 0, пока их не накопится больше 100.

## <a name="how-connections-are-counted"></a>Подсчет подключений

Существуют серверные и клиентские подключения. По умолчанию каждый сервер приложений имеет пять подключений для каждого концентратора при использовании службы Azure SignalR. Каждый клиент имеет одно клиентское подключение к службе Azure SignalR.

Число подключений, отображаемое на портале Azure, включает в себя как серверные, так и клиентские подключения.

Например, у вас есть два сервера приложений и вы определили пять концентраторов в коде. Количество подключений к серверу равно 50: 2 сервера приложений * 5 концентраторов * 5 подключений на концентратор.

Служба SignalR для ASP.NET подсчитывает подключения к серверу по-другому. Она добавляет один стандартный концентратор к уже определенным вами концентраторам. По умолчанию каждому серверу приложений требуется еще пять подключений к серверу. Число подключений для стандартного концентратора остается согласованным с другими концентраторами.

## <a name="how-inboundoutbound-traffic-is-counted"></a>Подсчет входящего и исходящего трафика

Различия между входящим и исходящим трафиком зависят от перспективы службы Azure SignalR. Трафик вычисляется в байтах. Как и число сообщений, трафик также имеет частоту выборки. Диаграмма входящего и исходящего трафика на портале Azure обновляется при добавлении каждых 100 КБ на концентратор.

## <a name="related-resources"></a>Связанные ресурсы

- [Метрики, поддерживаемые Azure Monitor](/azure/azure-monitor/platform/metrics-supported#microsoftsignalrservicesignalr )
- [Конфигурация SignalR для ASP.NET Core](/aspnet/core/signalr/configuration)
- [JSON](https://www.json.org/)
- [MessagePack](/aspnet/core/signalr/messagepackhubprotocol)