---
title: Сведения о ключах Azure Key Vault — Azure Key Vault
description: В этой статье приведены общие сведения об интерфейсе Azure Key Vault REST и подробные сведения о ключах.
services: key-vault
author: msmbaldwin
manager: rkarlin
tags: azure-resource-manager
ms.service: key-vault
ms.subservice: keys
ms.topic: overview
ms.date: 09/04/2019
ms.author: mbaldwin
ms.openlocfilehash: b9803726bf3a54eb31d3c2ebaddce11fb96472be
ms.sourcegitcommit: fdaad48994bdb9e35cdd445c31b4bac0dd006294
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/26/2020
ms.locfileid: "85413729"
---
# <a name="about-azure-key-vault-keys"></a>О ключах Azure Key Vault

Azure Key Vault поддерживает несколько типов ключей и алгоритмов и позволяет использовать аппаратные модули безопасности (HSM) для важных ключей.

Ключи шифрования в Key Vault представлены объектами веб-ключей JSON (JWK). Спецификации JSON и JOSE:

-   [Веб-ключ JSON (JWK)](https://tools.ietf.org/html/draft-ietf-jose-json-web-key)  
-   [Веб-шифрование JSON (JWE)](http://tools.ietf.org/html/draft-ietf-jose-json-web-encryption)  
-   [Веб-алгоритмы JSON (JWA)](http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms)  
-   [Веб-подпись JSON (JWS)](https://tools.ietf.org/html/draft-ietf-jose-json-web-signature) 

Базовые спецификации JWK и JWA также расширены, чтобы включать типы ключей, уникальные для реализации Key Vault. Например, импорт ключей с использованием упаковки конкретного поставщика HSM, обеспечивающей безопасную транспортировку ключей, что позволяет использовать их только в HSM Key Vault. 

Azure Key Vault поддерживает ключи, защищенные программным обеспечением и модулем HSM.

- **Ключи, защищенные программным обеспечением.** Ключ, который обрабатывается в Key Vault программным образом и шифруется при хранении с использованием системного ключа, сохраненного в HSM. Клиенты могут импортировать имеющийся ключ RSA или EC (эллиптическая кривая) либо запросить создание ключа в Key Vault.
- **Ключи, защищенные модулем HSM.** Ключи, которые обрабатываются непосредственно в HSM. Такие ключи защищены одной из систем безопасности HSM Key Vault (в каждом регионе есть системы безопасности для обеспечения изоляции). Клиенты могут импортировать ключи RSA или EC, защищенные программным обеспечением либо экспортированные с совместимого устройства HSM. Клиенты могут также запросить создание ключа в Key Vault. Этот тип ключа добавляет атрибут key_hsm к JWK, позволяющий получить материал ключа HSM.

Дополнительные сведения о географических ограничениях см. в [центре управления безопасностью Microsoft Azure](https://azure.microsoft.com/support/trust-center/privacy/).  

## <a name="cryptographic-protection"></a>Криптографическая защита

Key Vault поддерживает только ключи RSA и EC. 

-   **EC**. Ключ эллиптической кривой, защищенный программным обеспечением.
-   **EC-HSM**. Аппаратный ключ эллиптической кривой.
-   **RSA**. Ключ RSA, защищенный программным обеспечением.
-   **RSA-HSM**. Аппаратный ключ RSA.

Key Vault поддерживает ключи RSA таких размеров: 2048, 3072 и 4096. Кроме того, поддерживаются типы ключей EC P-256, P-384, P-521, и P-256K (SECP256K1).

Криптографические модули, используемые Key Vault, будь то HSM или программные модули, соответствуют стандартам FIPS. Для выполнения в режиме FIPS не требуется каких-либо дополнительных действий. Все ключи, которые **создаются** или **импортируются** с защитой HSM, обрабатываются в HSM, соответствующих требованиям FIPS 140-2 уровня 2 или более высокого. Все ключи, которые **создаются** или **импортируются** с программной защитой, обрабатываются в криптографических модулях, соответствующих требованиям FIPS 140-2 уровня 1.

###  <a name="ec-algorithms"></a>Алгоритмы EC
 Ниже приведены идентификаторы алгоритмов, которые поддерживаются ключами EC и EC-HSM в Key Vault. 

#### <a name="curve-types"></a>Типы кривых

-   **P-256** — кривая NIST P-256, определенная в документе [DSS FIPS PUB 186-4](https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.186-4.pdf).
-   **P-256_K** — кривая SEC SECP256K1, определенная в стандарте [SEC 2: Recommended Elliptic Curve Domain Parameters](https://www.secg.org/sec2-v2.pdf) (Рекомендуемые параметры домена для эллиптических кривых).
-   **P-384** — кривая NIST P-384, определенная в документе [DSS FIPS PUB 186-4](https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.186-4.pdf).
-   **P-521** — кривая NIST P-521, определенная в документе [DSS FIPS PUB 186-4](https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.186-4.pdf).

#### <a name="signverify"></a>SIGN/VERIFY

-   **ES256** — ECDSA для хэшей SHA-256 и ключей, созданных на основе кривой P-256. Этот алгоритм описан в документации по [RFC7518](https://tools.ietf.org/html/rfc7518).
-   **ES256K** — ECDSA для хэшей SHA-256 и ключей, созданных на основе кривой P-256K. Этот алгоритм находится на этапе ожидания стандартизации.
-   **ES384** — ECDSA для хэшей SHA-384 и ключей, созданных на основе кривой P-384. Этот алгоритм описан в документации по [RFC7518](https://tools.ietf.org/html/rfc7518).
-   **ES512** — ECDSA для хэшей SHA-512 и ключей, созданных на основе кривой P-521. Этот алгоритм описан в документации по [RFC7518](https://tools.ietf.org/html/rfc7518).

###  <a name="rsa-algorithms"></a>Алгоритмы RSA  
 Ниже приведены идентификаторы алгоритмов, которые поддерживаются ключами RSA и RSA-HSM в Key Vault.  

#### <a name="wrapkeyunwrapkey-encryptdecrypt"></a>WRAPKEY/UNWRAPKEY, ENCRYPT/DECRYPT

-   **RSA1_5** — это шифрование ключа RSAES-PKCS1-V1_5 [RFC3447].  
-   **RSA-OAEP** — алгоритм RSAES, использующий оптимальное асимметричное шифрование с дополнением (OAEP) [RFC3447], с параметрами по умолчанию, указанными в RFC 3447 в разделе A.2.1. В этих параметрах по умолчанию используется хэш-функция SHA-1 и функция генерации маски MGF1 с помощью SHA-1.  

#### <a name="signverify"></a>SIGN/VERIFY

-   **PS256** — RSASSA-PSS с помощью SHA-256 и MGF1 с SHA-256, как описано в [RFC7518](https://tools.ietf.org/html/rfc7518).
-   **PS384** — RSASSA-PSS с помощью SHA-384 и MGF1 с SHA-384, как описано в [RFC7518](https://tools.ietf.org/html/rfc7518).
-   **PS512** — RSASSA-PSS с помощью SHA-512 и MGF1 с SHA-512, как описано в [RFC7518](https://tools.ietf.org/html/rfc7518).
-   **RS256** — RSASSA-PKCS-v1_5, использующий SHA-256. Предоставленное приложением значение хэш-кода должно быть вычислено с помощью SHA-256 и иметь длину в 32 байта.  
-   **RS384** — RSASSA-PKCS-v1_5, использующий SHA-384. Предоставленное приложением значение хэш-кода должно быть вычислено с помощью SHA-384 и иметь длину в 48 байтов.  
-   **RS512** — RSASSA-PKCS-v1_5, использующий SHA-512. Предоставленное приложением значение хэш-кода должно быть вычислено с помощью SHA-512 и иметь длину в 64 байта.  
-   **RSNULL** — специализированный вариант использования для реализации определенных сценариев TLS (см. [RFC2437]).  

##  <a name="key-operations"></a>Операции с ключами

Key Vault поддерживает следующие операции с объектами ключей:  

-   **Создание**. Позволяет клиентам создавать ключи в Key Vault. Значение ключа создается в Key Vault и хранится в нем. Оно не выдается клиенту. В Key Vault можно создать асимметричные ключи.  
-   **Import**: Позволяет клиентам импортировать имеющиеся ключи в Key Vault. В Key Vault можно импортировать асимметричные ключи с помощью нескольких различных способов упаковки внутри конструкции JWK. 
-   **Обновление**. Позволяет клиентам с достаточными разрешениями изменять метаданные (атрибуты ключей), связанные с ключами, сохраненными ранее в Key Vault.  
-   **Удалить**. Позволяет клиентам с достаточными разрешениями удалять ключи из Key Vault.  
-   **Вывод списка**. Позволяет клиентам выводить полный список ключей в определенном хранилище ключей.  
-   **Вывод списка версий**. Позволяет клиентам выводить список всех версий указанного ключа в определенном хранилище ключей.  
-   **Получение**. Позволяет клиентам извлекать открытые части указанного ключа из Key Vault.  
-   **Архивация**. Экспорт ключей в защищенной форме.  
-   **Восстановление**. Импорт ранее заархивированного ключа.  

Дополнительные сведения о работе с ключами см. в [справочнике по работе с Azure Key Vault с помощью REST API](/rest/api/keyvault).  

После создания ключа в Key Vault с его использованием можно выполнять следующие криптографические операции:  

-   **Подпись и проверка**. Строго говоря, эта операция подписи и проверки хэша, так как Key Vault не поддерживает хэширование содержимого для создания подписи. Приложения должны хэшировать данные для подписи локально, а затем запрашивать подпись хэша в Key Vault. Проверка подписанных хэшей поддерживается в качестве удобного механизма для приложений, у которых нет доступа к материалам открытого ключа. Для оптимизации производительности приложений операции VERIFY нужно выполнять локально.  
-   **Шифрование и упаковка ключа**. Ключ, сохраненный в Key Vault, можно использовать для защиты другого ключа, как правило, симметричного ключа шифрования содержимого (CEK). Если ключ в Azure Key Vault асимметричен, используется шифрование ключа. Например RSA-OAEP, а операции WRAPKEY/UNWRAPKEY эквивалентны операциям ENCRYPT/DECRYPT. Если ключ в Azure Key Vault симметричен, применяется упаковка ключа. Например, AES-KW. Операция WRAPKEY поддерживается в качестве удобного механизма для приложений, у которых нет доступа к материалам открытого ключа. Для оптимизации производительности приложений рекомендуется выполнять операции WRAPKEY локально.  
-   **Шифрование и расшифровка**. Ключ, хранимый в Key Vault, можно использовать для шифрования или расшифровки одного блока данных, размер которого определяется типом ключа и выбранным алгоритмом шифрования. Операция шифрования предоставляется в качестве удобного механизма для приложений, у которых нет доступа к материалам открытого ключа. Для оптимизации производительности приложений операции ENCRYPT нужно выполнять локально.  

Хотя операции WRAPKEY и UNWRAPKEY с использованием асимметричных ключей могут показаться излишними (так как они эквивалентны операции ENCRYPT и DECRYPT), важно использовать различные операции. Это обеспечивает разделение семантики и авторизации этих операций, а также целостность в случаях, когда служба поддерживает другие типы ключей.  

Azure Key Vault не поддерживает операции EXPORT. Как только ключ подготовлен в системе, нельзя извлечь его или изменить его материал. Однако пользователям Key Vault ключ может потребоваться для других вариантов использования, например при его удалении. В этом случае они могут использовать операции BACKUP и RESTORE для экспорта или импорта ключей в защищенной форме. Ключи, созданные в ходе операции BACKUP, не могут использоваться за пределами Key Vault. Кроме того, в различных экземплярах Key Vault также можно использовать операцию IMPORT.  

Пользователи могут ограничивать любую из криптографических операций, поддерживаемых Key Vault, для каждого ключа с помощью свойства key_ops объекта JWK.  

Дополнительные сведения об объектах JWK см. в статье о [веб-ключе JSON (JWK)](https://tools.ietf.org/html/draft-ietf-jose-json-web-key-41).  

## <a name="key-attributes"></a>Атрибуты ключей

В дополнение к материалу ключа можно указать следующие атрибуты. В запросе JSON ключевое слово атрибутов и кавычки "{' '}" необходимы, даже если атрибуты не указаны.  

- *enabled*. Необязательный атрибут с логическим значением, по умолчанию — **true**. Указывает, является ли ключ активным и подходит ли для операций шифрования. Атрибут *enabled* используется в сочетании с *nbf* и *exp*. При возникновении операции между *nbf* и *exp* она будет разрешена, только если для *enabled* установлено значение **true**. Операции вне окна *nbf* / *exp* автоматически запрещаются, за исключением определенных типов операции в разделе [определенных условий](#date-time-controlled-operations).
- *nbf*. Необязательный атрибут со значением в формате IntDate, значение по умолчанию — now. Атрибут *nbf* (не ранее) определяет время, до которого ключ не должен использоваться для криптографических операций, за исключением определенных типов операций в разделе [определенных условий.](#date-time-controlled-operations) Обработка атрибута *nbf* требует, чтобы текущая дата и время наступали позже или соответствовали дате и времени, перечисленным в атрибуте *nbf*. Key Vault может предоставить кратковременную отсрочку, обычно не более чем несколько минут, чтобы учесть разницу в показаниях часов. Нужно указать число, содержащее значение IntDate.  
- *exp*. Необязательный атрибут со значением в формате IntDate, значение по умолчанию — forever. Атрибут *exp* (время окончания срока действия) определяет время, до которого или после которого ключ не должен использоваться для криптографических операций, за исключением определенных типов операций в разделе [определенных условий](#date-time-controlled-operations). Обработка атрибута *exp* требует, чтобы текущая дата и время наступали раньше или соответствовали дате и времени, перечисленным в атрибуте *exp*. Key Vault может предоставить кратковременную отсрочку, обычно не более чем несколько минут, чтобы учесть разницу в показаниях часов. Нужно указать число, содержащее значение IntDate.  

Есть дополнительные атрибуты только для чтения, которые включены в любой ответ, содержащий атрибуты ключей:  

- *Создано*. Необязательное значение в формате IntDate. Атрибут *created* указывает, когда была создана эта версия ключа. Это значение равно NULL для ключей, созданных перед добавлением данного атрибута. Нужно указать число, содержащее значение IntDate.  
- *Обновлено*. Необязательное значение в формате IntDate. Атрибут *updated* указывает, когда была обновлена эта версия ключа. Это значение равно NULL для ключей, которые в последний раз обновлялись перед добавлением данного атрибута. Нужно указать число, содержащее значение IntDate.  

См. сведения об IntDate и других типах данных в руководстве о [ключах, секретах и сертификатах: [Типы данных](../general/about-keys-secrets-certificates.md#data-types).

### <a name="date-time-controlled-operations"></a>Операции, зависящие от даты и времени

Пока еще не проверенные ключи и ключи с истекшим сроком действия за пределами окна *nbf* / *exp* будут использоваться для операций **расшифровки**, **развертывания** и **проверки** (не будут возвращать код 403, запрещено). Основной причиной использования ключа в состоянии "еще не проверено" является возможность проверить ключ перед использованием в рабочей среде. Основная причина использования ключа в состоянии "истекший срок действия" — возможность выполнения операций восстановления в данных, которые были созданы, когда ключ был допустим. Кроме того, можно отключить доступ к ключу с помощью политик Key Vault или изменения значения атрибута ключа *enabled* на **false**.

Дополнительные сведения о типах данных см. в [этом разделе](../general/about-keys-secrets-certificates.md#data-types).

Дополнительные сведения о других возможных атрибутах см. в разделе о [веб-ключе JSON (JWK)](https://tools.ietf.org/html/draft-ietf-jose-json-web-key-41).

## <a name="key-tags"></a>Теги ключей

В форме тегов можно указать дополнительные метаданные для конкретного приложения. Key Vault поддерживает до 15 тегов, каждый из которых может иметь имя и значение длиной 256 знаков.  

>[!Note]
>Теги могут быть прочитаны вызывающим объектом, если он имеет разрешения *list* или *get* на такие типы объектов: ключи, секреты или сертификаты.

##  <a name="key-access-control"></a>Контроль доступа к ключам

Контроль доступа к ключам, управляемым Key Vault, предоставляется на уровне хранилища ключей, которое выступает в роли контейнера ключей. Существует политика управления доступом к ключам, отличная от политики управления доступом к секретам в том же Key Vault. Пользователи могут создать одно или несколько хранилищ для хранения ключей и должны поддерживать соответствующую сценарию сегментацию и управление ключами. Контроль доступа к ключам не зависит от контроля доступа к секретам.  

Следующие разрешения могут быть предоставлены на каждого пользователя или субъект-службу в записи управления доступом к ключам в хранилище. Эти разрешения точно отражают операции, разрешенные для объекта ключа.  Предоставление доступа к субъекту-службе в хранилище ключей является разовой операцией и остается одинаковой для всех подписок Azure. Ее можно использовать для развертывания требуемого количества сертификатов. 

- Разрешения для операций управления ключами
  - *get*. Чтение открытой части ключа и его атрибутов.
  - *list*: Вывод списка ключей или версий ключа, хранимых в хранилище ключей.
  - *update*: Обновление атрибутов ключа.
  - *create*: Создание новых ключей.
  - *import*. Импорт ключа в хранилище ключей.
  - *delete*: Удаление объекта ключа.
  - *recover*. Восстановление удаленного ключа.
  - *backup*. Архивация ключа в хранилище ключей.
  - *restore*. Восстановление заархивированного ключа в хранилище ключей.

- Разрешения для криптографических операций
  - *decrypt*. Использование ключа для снятия защиты с последовательности байтов.
  - *encrypt*. Использование ключа для защиты произвольной последовательности байтов.
  - *unwrapKey*. Использование ключа для снятия защиты с упакованных симметричных ключей.
  - *wrapKey*. Использование ключа для защиты симметричного ключа.
  - *verify*. Использование ключа для проверки хэш-кодов.  
  - *sign*. Использование ключа для подписи хэш-кодов.
    
- Разрешения для привилегированных операций
  - *purge*. Очистка удаленного ключа (удаление без возможности восстановления).

Дополнительные сведения о работе с ключами см. в статье [Azure Key Vault REST API reference](/rest/api/keyvault) (Справочник по REST API для Azure Key Vault). Сведения об установке разрешений см. в статьях [Vaults — Create Or Update](/rest/api/keyvault/vaults/createorupdate) (Хранилища. Создание или обновление) и [Vaults — Update Access Policy](/rest/api/keyvault/vaults/updateaccesspolicy) (Хранилища. Обновление политики доступа). 

## <a name="next-steps"></a>Дальнейшие действия

- [Сведения о Key Vault](../general/overview.md)
- [Сведения о ключах, секретах и сертификатах](../general/about-keys-secrets-certificates.md)
- [О секретах](../secrets/about-secrets.md)
- [Сведения о сертификатах](../certificates/about-certificates.md)
- [Аутентификация, запросы и ответы](../general/authentication-requests-and-responses.md)
- [Руководство разработчика Azure Key Vault](../general/developers-guide.md)
