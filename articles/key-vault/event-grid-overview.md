---
title: Мониторинг Key Vault с помощью службы "Сетка событий Azure"
description: Использование службы "Сетка событий Azure" для подписки на Key Vault события
services: media-services
author: msmbaldwin
manager: rkarlin
ms.service: key-vault
ms.topic: article
ms.date: 10/25/2019
ms.author: mbaldwin
ms.openlocfilehash: 1fa554e03188c4d8d6227a6d2c0a560c3080b0fe
ms.sourcegitcommit: d47a30e54c5c9e65255f7ef3f7194a07931c27df
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/29/2019
ms.locfileid: "73033502"
---
# <a name="monitoring-key-vault-with-azure-event-grid-preview"></a>Мониторинг Key Vault с помощью службы "Сетка событий Azure" (Предварительная версия)

Интеграция Key Vault с сеткой событий сейчас доступна в предварительной версии. Это позволяет пользователям получать уведомления при изменении состояния секрета, хранящегося в хранилище ключей. Изменение состояния определяется как секрет, срок действия которого скоро истечет (в течение 30 дней с истечением срока действия), истек срок действия секрета или секрет, для которого доступна новая версия. Поддерживаются уведомления для всех трех типов секретов (ключ, сертификат и секрет).

Приложения могут реагировать на эти события с помощью современных бессерверных архитектур, не требуя сложного кода или дорогостоящих и неэффективных служб опроса. События передаются через службу " [Сетка событий Azure](https://azure.microsoft.com/services/event-grid/) " в обработчики событий, такие как [функции Azure](https://azure.microsoft.com/services/functions/), [Azure Logic Apps](https://azure.microsoft.com/services/logic-apps/)или даже на собственный веб-перехватчик, и вы платите только за то, что используете. Дополнительные сведения о ценах см. на странице [с ценами на службу"Сетка событий Azure"](https://azure.microsoft.com/pricing/details/event-grid/).

## <a name="key-vault-events-and-schemas"></a>Key Vault событий и схем

Сетка событий использует [подписки на события](../event-grid/concepts.md#event-subscriptions) для маршрутизации сообщений о событиях подписчикам. Key Vault события содержат всю информацию, необходимую для реагирования на изменения в данных. Можно задать событие Key Vault, так как свойство eventType начинается с "Microsoft. KeyVault".

Дополнительные сведения см. в описании [схемы событий Key Vault](../event-grid/event-schema-key-vault.md).

> [!NOTE]
> События активируются только для версий секретов (все три типа), созданных после установки подписки.
>
> Для существующих секретов необходимо создать новые версии.

## <a name="practices-for-consuming-events"></a>Рекомендации по потреблению событий

Приложения, обрабатывающие события Key Vault, должны следовать следующим рекомендациям:

* Несколько подписок можно настроить для маршрутизации событий в тот же обработчик событий. Важно не полагаться на события из определенного источника, но проверить раздел сообщения, чтобы убедиться, что он поступает из ожидаемого хранилища ключей.
* Подобным образом убедитесь, что вы готовы к обработке этого типа событий (eventType), а также не следует предполагать, что все получаемые события будут иметь ожидаемый тип.
* Игнорируйте поля, которые вам непонятны.  Такой подход поможет обеспечить устойчивость к новым функциям, которые могут быть добавлены в будущем.
* С помощью префикса и суффикса subject события можно ограничить до конкретного.

## <a name="next-steps"></a>Дальнейшие действия

- [Обзор Azure Key Vault](key-vault-overview.md)
- [Общие сведения о службе "Сетка событий Azure"](../event-grid/overview.md)
- [Как перенаправлять Key Vault события в модуль Runbook службы автоматизации (Предварительная версия)](event-grid-tutorial.md).
- [Схема событий службы "Сетка событий Azure" для Azure Key Vault (Предварительная версия)](../event-grid/event-schema-key-vault.md)
- [Обзор службы автоматизации Azure](../automation/index.yml)
