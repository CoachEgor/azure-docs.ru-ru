---
title: Руководство по мониторингу Key Vault с помощью службы "Сетка событий Azure"
description: Руководство по использованию службы "Сетка событий Azure" для подписки на события Key Vault
services: media-services
author: msmbaldwin
manager: rkarlin
ms.service: key-vault
ms.topic: tutorial
ms.date: 11/12/2019
ms.author: mbaldwin
ms.openlocfilehash: 5771af365b763d2152eea4ef4f662e08769b378c
ms.sourcegitcommit: 2d3740e2670ff193f3e031c1e22dcd9e072d3ad9
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/16/2019
ms.locfileid: "74133342"
---
# <a name="tutorial-monitoring-key-vault-with-azure-event-grid-preview"></a>Руководство по мониторингу Key Vault с помощью службы "Сетка событий Azure" (предварительная версия)

Интеграция Key Vault со службой "Сетка событий Azure" сейчас доступна в предварительной версии. Это позволяет пользователям получать уведомления при изменении состояния секрета, хранящегося в хранилище ключей. Изменение состояния определяется как секрет, срок действия которого скоро истечет (с истечением срока действия в 30 дней), истек, или секрет, для которого доступна новая версия. Поддерживаются уведомления для всех трех типов секретов (ключ, сертификат и секрет).

Приложения могут реагировать на эти события с помощью современной бессерверной архитектуры и без необходимости написания сложного кода или использования дорогостоящих и неэффективных служб опроса. События отправляются через службу [Сетка событий Azure](https://azure.microsoft.com/services/event-grid/) обработчикам событий, таким как [Функции Azure](https://azure.microsoft.com/services/functions/), [Azure Logic Apps](https://azure.microsoft.com/services/logic-apps/), или даже в веб-перехватчик. При этом вы оплачиваете только то, что используете. Дополнительные сведения о ценах см. на странице [с ценами на службу"Сетка событий Azure"](https://azure.microsoft.com/pricing/details/event-grid/).

## <a name="key-vault-events-and-schemas"></a>События и схемы Key Vault

Сетка событий использует [подписки на события](../event-grid/concepts.md#event-subscriptions) для маршрутизации сообщений о событиях подписчикам. События Key Vault содержат все сведения, необходимые для реагирования на изменения в данных. Вы можете определить событие Key Vault, поскольку свойство eventType начинается с "Microsoft.KeyVault".

Дополнительные сведения см. на странице [схема событий Key Vault](../event-grid/event-schema-key-vault.md).

> [!NOTE]
> События активируются только для версий секретов (все три типа), созданных после установки подписки.
>
> Для существующих секретов необходимо создать новые версии.

## <a name="practices-for-consuming-events"></a>Рекомендации по потреблению событий

Приложения, которые обрабатывают события Key Vault, должны следовать нескольким рекомендациям:

* Несколько подписок можно настроить для маршрутизации событий в тот же обработчик событий. Важно не полагаться на события из определенного источника, а проверить раздел сообщения, чтобы убедиться, что они поступают из ожидаемого хранилища ключей.
* Подобным образом убедитесь, что вы готовы к обработке этого типа событий (eventType), а также не следует предполагать, что все получаемые события будут иметь ожидаемый тип.
* Игнорируйте поля, которые вам непонятны.  Такой подход поможет обеспечить устойчивость к новым функциям, которые могут быть добавлены в будущем.
* С помощью префикса и суффикса subject события можно ограничить до конкретного.

## <a name="next-steps"></a>Дополнительная информация

- [Общие сведения об Azure Key Vault](key-vault-overview.md)
- [Обзор службы "Сетка событий Azure"](../event-grid/overview.md)
- Практическое руководство: [Получение уведомлений хранилища ключей и реагирование на них с помощью Сетки событий Azure (предварительная версия)](event-grid-tutorial.md).
- Практическое руководство: [Получение сообщения электронной почты при изменении секрета в хранилище ключей](event-grid-logicapps.md)
- [Схема событий службы "Сетка событий Azure" для Azure Key Vault (предварительная версия)](../event-grid/event-schema-key-vault.md)
- [Обзор службы автоматизации Azure](../automation/index.yml)
