---
title: Безопасность Убежища ключей Azure (ru) Документы Майкрософт
description: Управление правами доступа для Azure Key Vault, ключей и секретов. Описание модели проверки подлинности и авторизации для Key Vault и обеспечения защиты вашего хранилища ключей.
services: key-vault
author: msmbaldwin
manager: rkarlin
tags: azure-resource-manager
ms.service: key-vault
ms.subservice: general
ms.topic: conceptual
ms.date: 04/18/2019
ms.author: mbaldwin
Customer intent: As a key vault administrator, I want to learn the options available to secure my vaults
ms.openlocfilehash: dbe13b2d1291f212af7da9d1176bc3d90997978b
ms.sourcegitcommit: b80aafd2c71d7366838811e92bd234ddbab507b6
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/16/2020
ms.locfileid: "81428970"
---
# <a name="azure-key-vault-security"></a>Безопасность Azure Key Vault

Вам необходимо защитить ключи шифрования и секреты, такие как сертификаты, строки подключения и пароли в облаке, чтобы вы использовали Azure Key Vault. Поскольку вы храните конфиденциальные и критически важные для бизнеса данные, необходимо принять меры для обеспечения максимальной безопасности хранилищ и данных, хранящихся в них. В этой статье будут рассмотрены некоторые концепции, которые следует учитывать при проектировании безопасности Azure Key Vault.

## <a name="identity-and-access-management"></a>Управление удостоверениями и доступом

При создании хранилища ключей в подписке Azure оно автоматически связывается с арендатором Azure AD этой подписки. Любой, кто пытается управлять или извлекать содержимое из хранилища, должен быть проверен Azure AD.

- Аутентификация позволяет идентифицировать вызывающую сторону.
- Авторизация определяет, какие операции может выполнять абонент. Авторизация в Key Vault использует сочетание [политик управления доступом на основе ролей](../../role-based-access-control/overview.md) (RBAC) и политик доступа к ключу Azure Vault.

### <a name="access-model-overview"></a>Общие сведения о модели доступа

Доступ к хранилищам осуществляется через два интерфейса или плоскости. Эти самолеты являются плоскость управления и плоскости данных.

- Плоскость *управления* — это место, где вы управляете самим Key Vault, и это интерфейс, используемый для создания и удаления хранилищ. Вы также можете прочитать свойства хранилища ключей и управлять политиками доступа.
- *Плоскость данных* позволяет работать с данными, хранящимися в хранилище ключей. Вы можете добавлять, удалять и изменять ключи, секреты и сертификаты.

Чтобы получить доступ к хранилищу ключей в самолете, все абоненты (пользователи или приложения) должны быть проверены и авторизованы. Для аутентификации в обеих плоскостях используется Azure Active Directory (Azure AD). Для авторизации в плоскости управления используется управление доступом на основе ролей (RBAC), а в плоскости данных — политика доступа к Key Vault.

Модель единого механизма для аутентификации в обеих плоскостях имеет некоторые преимущества:

- организации могут централизованно управлять доступом ко всем принадлежащим им хранилищам ключей;
- когда пользователь покидает организацию, он мгновенно теряет доступ ко всем этим хранилищам ключей;
- Организации могут настроить аутентификацию с помощью опций в Azure AD, например, для включения многофакторной аутентификации для дополнительной безопасности

### <a name="managing-administrative-access-to-key-vault"></a>Управление административным доступом к Key Vault

При создании хранилища ключей в группе ресурсов вы управляете доступом с помощью Azure AD. Можно предоставить пользователям или группе возможность управлять хранилищами ключей в группе ресурсов. Вы можете предоставить доступ на определенном уровне сферы, назначив соответствующие роли RBAC. Чтобы предоставить пользователю доступ к управлению хранилищами ключей, ему необходимо назначить предопределенную роль `key vault Contributor` в определенной области. Роли RBAC можно назначить следующие области:

- **Подписка**: Роль RBAC, назначенная на уровне подписки, применяется ко всем группам ресурсов и ресурсам в рамках этой подписки.
- **Группа ресурсов**: Роль RBAC, назначенная на уровне группы ресурсов, применяется ко всем ресурсам этой группы ресурсов.
- **Конкретный ресурс**: К этому ресурсу применяется роль RBAC, назначенная для определенного ресурса. В этом случае ресурс является определенным хранилищем ключей.

Есть несколько заданных по умолчанию ролей. Если заданные роли не соответствуют вашим потребностям, вы можете определить собственные. Для получения дополнительной [RBAC: Built-in roles](../../role-based-access-control/built-in-roles.md)информации см.

> [!IMPORTANT]
> Если у пользователя есть разрешения `Contributor` в плоскости управления хранилища ключей, он может предоставить себе доступ к плоскости данных, настроив политику доступа к хранилищу ключей. Следует очень внимательно контролировать, у кого есть доступ `Contributor` к вашим хранилищам ключей в рамках роли. Убедитесь, что только авторизованные лица могут получать доступ к хранилищам ключей, ключам, секретам и сертификатам, а также управлять ими.

<a id="data-plane-access-control"></a>
### <a name="controlling-access-to-key-vault-data"></a>Контроль доступа к данным Key Vault

Политики доступа Key Vault предоставляют разрешения отдельно на ключи, секреты или сертификат. Можно предоставить пользователю доступ только к ключам, но не к секретам. Разрешения на доступ к ключам, секретам и сертификатам управляются на уровне хранилища.

> [!IMPORTANT]
> Политика доступа к Key Vault не поддерживает детализированные разрешения на уровне объектов, таких как определенный ключ, секрет или сертификат. Если пользователю предоставлено разрешение на создание и удаление ключей, он может выполнять эти операции со всеми ключами в этом хранилище ключей.

Чтобы задать политики доступа для хранилища ключей, можно использовать [портал Azure](https://portal.azure.com/), [Azure CLI](/cli/azure/install-azure-cli?view=azure-cli-latest), [Azure PowerShell](/powershell/azureps-cmdlets-docs) или [REST API управления Key Vault](/rest/api/keyvault/).

Можно ограничить доступ к плоскости данных с помощью [виртуальных конечных точек сетевого обслуживания для Azure Key Vault](overview-vnet-service-endpoints.md)). Вы можете настроить [брандмауэры и правила виртуальной сети](network-security.md) в качестве дополнительного уровня безопасности.

## <a name="network-access"></a>Доступ к сети

Можно уменьшить экспозицию хранилищ, указав, какие IP-адреса имеют к ним доступ. Конечные точки служб для виртуальной сети для Azure Key Vault позволяют ограничить доступ к определенной виртуальной сети. Также эти конечные точки позволяют ограничить доступ определенным набором диапазонов адресов IPv4 (протокол IP версии 4). Для любого пользователя при попытке подключения к хранилищу ключей из любых других расположений доступ будет отклонен.

После вступления в силу правил брандмауэра пользователи могут читать данные из Key Vault только тогда, когда их запросы поступают из разрешенных виртуальных сетей или диапазонов адресов IPv4. Это относится и к получению доступа к Key Vault с портала Azure. Пользователь сможет перейти в хранилище ключей с портала Azure, но не сможет получить список ключей, секретов и сертификатов, если клиентский компьютер не включен в список разрешенных. Это также влияет на выбор хранилища ключей другими службами Azure. Пользователи смогут просматривать список хранилищ ключей, но не список ключей, если правила брандмауэра запрещают доступ их клиентским компьютерам.

Для получения дополнительной информации о сетевом адресе Azure Key Vault просмотрите [конечные точки виртуального сетевого обслуживания для Azure Key Vault](overview-vnet-service-endpoints.md))

## <a name="monitoring"></a>Наблюдение

Регистрация ключей Vault сохраняет информацию о действиях, выполняемых в хранилище. Ключевые журналы Vault:

- Все проверенные запросы REST API, включая неудавшийся запрос
  - Операции на самом хранилище ключей. Эти операции включают создание, удаление, настройку политик доступа и обновление атрибутов хранилища ключей, таких как теги.
  - операции с ключами и секретами в хранилище ключей, в том числе:
    - создание, изменение или удаление ключей или секретов;
    - подписывание, проверка, шифрование, расшифровка, упаковка и распаковка ключей, получение секретов и вывод списка ключей и секретов (и их версий);
- непроверенные запросы, которые приводят к появлению ответа 401 (например, запросы без токена носителя, с недействительным токеном, а также запросы неправильного формата или просроченные запросы).

Информация о регистрации может быть доступна в течение 10 минут после операции хранилища ключей. Управление журналами в учетной записи хранилища - дело вас до вас.

- Используйте стандартные методы контроля доступа, предоставляемые Azure, для защиты журналов путем ограничения доступа к ним.
- Удаляйте журналы, которые больше не нужно хранить в учетной записи хранения.

Рекомендации по безопасному управлению учетными записями хранения просматривайте [руководство по безопасности хранилища Azure](../../storage/blobs/security-recommendations.md)

## <a name="next-steps"></a>Next Steps

- [Виртуальные конечные точки сетевого обслуживания для Azure Key Vault](overview-vnet-service-endpoints.md))
- [RBAC: встроенные роли](../../role-based-access-control/built-in-roles.md)
- [виртуальные конечные точки сетевого обслуживания для Azure Key Vault](overview-vnet-service-endpoints.md))
