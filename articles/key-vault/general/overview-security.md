---
title: Безопасность Azure Key Vault | Документация Майкрософт
description: Управление правами доступа для Azure Key Vault, ключей и секретов. Описание модели проверки подлинности и авторизации для Key Vault и обеспечения защиты вашего хранилища ключей.
services: key-vault
author: msmbaldwin
manager: rkarlin
tags: azure-resource-manager
ms.service: key-vault
ms.subservice: general
ms.topic: conceptual
ms.date: 04/18/2019
ms.author: mbaldwin
Customer intent: As a key vault administrator, I want to learn the options available to secure my vaults
ms.openlocfilehash: cd8557a33971be9fd0913bfdf84397d344901581
ms.sourcegitcommit: 0b80a5802343ea769a91f91a8cdbdf1b67a932d3
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/25/2020
ms.locfileid: "83834384"
---
# <a name="azure-key-vault-security"></a>Безопасность Azure Key Vault

Вам необходимо защитить ключи шифрования и секреты, например, сертификаты, строки подключения и пароли в облаке, чтобы использовать Azure Key Vault. Так как вы храните конфиденциальные и критически важные для бизнеса данные, необходимо повысить безопасность ваших хранилищ и хранимых в них данных. В этой статье рассматриваются некоторые принципы, которые вам следует рассмотреть при проектировании безопасности Azure Key Vault.

## <a name="identity-and-access-management"></a>Управление удостоверениями и доступом

При создании хранилища ключей в подписке Azure оно автоматически связывается с арендатором Azure AD этой подписки. Любой пользователь, пытающийся управлять содержимым в хранилище или извлекать его из хранилища, должен пройти аутентификацию в Azure AD.

- Аутентификация позволяет идентифицировать вызывающую сторону.
- Авторизация определяет, какие операции может выполнять вызывающая сторона. Авторизация в Key Vault использует сочетание [управления доступом на основе ролей (RBAC)](../../role-based-access-control/overview.md) и политик доступа Azure Key Vault.

### <a name="access-model-overview"></a>Общие сведения о модели доступа

Доступ к хранилищам осуществляется через два интерфейса или плоскости. Это плоскость управления и плоскость данных.

- *Плоскость управления* — это место, где вы управляете Key Vault, а также интерфейс, используемый для создания и удаления хранилищ. Вы также можете читать свойства хранилища ключей и управлять политиками доступа.
- *Плоскость данных* позволяет работать с хранимыми данными в хранилище ключей. Вы можете добавлять, удалять и изменять ключи, секреты и сертификаты.

Все вызывающие стороны (пользователи или приложения) должны пройти аутентификацию и авторизацию, чтобы получить доступ к хранилищу ключей в любой плоскости. Для аутентификации в обеих плоскостях используется Azure Active Directory (Azure AD). Для авторизации в плоскости управления используется управление доступом на основе ролей (RBAC), а в плоскости данных — политика доступа к Key Vault.

Модель единого механизма для аутентификации в обеих плоскостях имеет некоторые преимущества:

- организации могут централизованно управлять доступом ко всем принадлежащим им хранилищам ключей;
- когда пользователь покидает организацию, он мгновенно теряет доступ ко всем этим хранилищам ключей;
- организации могут настроить аутентификацию с помощью параметров в Azure AD (например, включение многофакторной проверки подлинности для повышения безопасности).

### <a name="managing-administrative-access-to-key-vault"></a>Управление административным доступом к Key Vault

При создании хранилища ключей в группе ресурсов вы управляете доступом посредством Azure AD. Можно предоставить пользователям или группе возможность управлять хранилищами ключей в группе ресурсов. Вы можете предоставить доступ на определенном уровне области, назначив соответствующие роли RBAC. Чтобы предоставить пользователю доступ к управлению хранилищами ключей, ему необходимо назначить предопределенную роль `key vault Contributor` в определенной области. Роли RBAC можно назначить следующие области:

- **Подписка**: Роль RBAC, назначенная на уровне подписки, применяется ко всем группам ресурсов и ресурсам в этой подписке.
- **Группа ресурсов.** Роль RBAC, назначенная на уровне группы ресурсов, применяется ко всем ресурсам в этой группе ресурсов.
- **Определенный ресурс.** Роль RBAC, назначенная для конкретного ресурса, применяется только к этому ресурсу. В этом случае ресурс является определенным хранилищем ключей.

Есть несколько заданных по умолчанию ролей. Если заданные роли не соответствуют вашим потребностям, вы можете определить собственные. Дополнительные сведения см. в статье [Встроенные роли для управления доступом на основе ролей в Azure](../../role-based-access-control/built-in-roles.md).

> [!IMPORTANT]
> Если у пользователя есть разрешения `Contributor` в плоскости управления хранилища ключей, он может предоставить себе доступ к плоскости данных, настроив политику доступа к хранилищу ключей. Следует очень внимательно контролировать, у кого есть доступ `Contributor` к вашим хранилищам ключей в рамках роли. Убедитесь, что только авторизованные лица могут получать доступ к хранилищам ключей, ключам, секретам и сертификатам, а также управлять ими.

<a id="data-plane-access-control"></a>
### <a name="controlling-access-to-key-vault-data"></a>Управление доступом к данным Key Vault

Политики доступа Key Vault предоставляют разрешения отдельно для ключей, секретов или сертификата. Можно предоставить пользователю доступ только к ключам, но не к секретам. Разрешения к ключам, секретам и сертификатам управляются на уровне хранилища.

> [!IMPORTANT]
> Политика доступа к Key Vault не поддерживает детализированные разрешения на уровне объектов, таких как определенный ключ, секрет или сертификат. Если пользователю предоставлено разрешение на создание и удаление ключей, он может выполнять эти операции со всеми ключами в этом хранилище ключей.

Чтобы задать политики доступа для хранилища ключей, можно использовать [портал Azure](https://portal.azure.com/), [Azure CLI](/cli/azure/install-azure-cli?view=azure-cli-latest), [Azure PowerShell](/powershell/azureps-cmdlets-docs) или [REST API управления Key Vault](/rest/api/keyvault/).

Вы можете ограничить доступ к плоскости данных с помощью [конечных точек службы виртуальной сети для Azure Key Vault](overview-vnet-service-endpoints.md). Вы можете настроить [брандмауэры и правила виртуальной сети](network-security.md) в качестве дополнительного уровня безопасности.

## <a name="network-access"></a>Доступ к сети

Вы можете снизить уязвимость хранилищ, указав IP-адреса, к которым они имеют доступ. Конечные точки служб для виртуальной сети для Azure Key Vault позволяют ограничить доступ к определенной виртуальной сети. Также эти конечные точки позволяют ограничить доступ определенным набором диапазонов адресов IPv4 (протокол IP версии 4). Для любого пользователя при попытке подключения к хранилищу ключей из любых других расположений доступ будет отклонен.

После того как правила брандмауэра вступают в действие, пользователи могут считывать данные только из Key Vault, если их запросы исходят из разрешенных виртуальных сетей или диапазонов IPv4-адресов. Это относится и к получению доступа к Key Vault с портала Azure. Пользователь сможет перейти в хранилище ключей с портала Azure, но не сможет получить список ключей, секретов и сертификатов, если клиентский компьютер не включен в список разрешенных. Это также влияет на выбор хранилища ключей другими службами Azure. Пользователи смогут просматривать список хранилищ ключей, но не список ключей, если правила брандмауэра запрещают доступ их клиентским компьютерам.

Дополнительные сведения о сетевом адресе Azure Key Vault см. в статье [Конечные точки службы для виртуальной сети для Azure Key Vault](overview-vnet-service-endpoints.md).

## <a name="monitoring"></a>Наблюдение

Ведение журнала Key Vault сохраняет сведения о действиях, выполняемых в вашем хранилище. Журналы Key Vault:

- Все запросы REST API, прошедшие проверку подлинности, включая запросы, завершившиеся сбоем.
  - Операции с самим хранилищем ключей. Эти операции включают в себя создание, удаление, настройку политик доступа и обновление атрибутов хранилища ключей, например тегов.
  - операции с ключами и секретами в хранилище ключей, в том числе:
    - создание, изменение или удаление ключей или секретов;
    - подписывание, проверка, шифрование, расшифровка, упаковка и распаковка ключей, получение секретов и вывод списка ключей и секретов (и их версий);
- непроверенные запросы, которые приводят к появлению ответа 401 (например, запросы без токена носителя, с недействительным токеном, а также запросы неправильного формата или просроченные запросы).

К данным журнала можно получить доступ в течение 10 минут после операции с хранилищем ключей. Вы можете управлять журналами в учетной записи хранения.

- Используйте стандартные методы контроля доступа, предоставляемые Azure, для защиты журналов путем ограничения доступа к ним.
- Удаляйте журналы, которые больше не нужно хранить в учетной записи хранения.

Рекомендации по безопасному управлению учетными записями хранения см. в статье [Руководство по безопасности службы хранилища Azure](../../storage/blobs/security-recommendations.md)

## <a name="next-steps"></a>Next Steps

- [Конечные точки службы для виртуальной сети для Azure Key Vault](overview-vnet-service-endpoints.md)
- [Сведения о встроенных ролях встроенные роли](../../role-based-access-control/built-in-roles.md).
- [Конечные точки службы для виртуальной сети для Azure Key Vault](overview-vnet-service-endpoints.md)
