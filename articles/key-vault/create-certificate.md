---
title: Способы создания сертификатов
description: Способы создания сертификата в Key Vault.
services: key-vault
author: msmbaldwin
manager: barbkess
tags: azure-resource-manager
ms.service: key-vault
ms.topic: conceptual
ms.date: 01/07/2019
ms.author: mbaldwin
ms.openlocfilehash: 63768b83baafe00348a28c5c9c99e5f16619ac99
ms.sourcegitcommit: c8a102b9f76f355556b03b62f3c79dc5e3bae305
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/06/2019
ms.locfileid: "68815925"
---
# <a name="certificate-creation-methods"></a>Способы создания сертификатов

 Сертификат Key Vault (KV) можно создать или импортировать в хранилище ключей. При создании сертификата KV в хранилище ключей создается закрытый ключ, который никогда не будет доступен для владельца сертификата. Существуют следующие способы создания сертификата в Key Vault.  

-   **Создание самозаверяющего сертификата.** При использовании этого способа создается пара открытого и закрытого ключей. Она будет связана с сертификатом. Сертификат будет подписан собственным ключом.  

-    **Создание сертификата вручную.** При использовании этого способа создается пара открытого и закрытого ключей и запрос на подпись сертификата X.509. Запрос на подпись может быть подписан центром регистрации или сертификации. Для завершения создания сертификата в Key Vault подписанный сертификат x509 может быть объединен с ожидающей парой ключей. Несмотря на то что для этого метода необходимо выполнить дополнительные шаги, он более безопасен, так как созданный закрытый ключ доступен только для Key Vault. Это описано на приведенной ниже схеме.  

![Создание сертификата с помощью собственного центра сертификации](media/certificate-authority-1.png)  

Следующие описания соответствуют действиям, обозначенным зеленым цветом на предыдущей схеме.

1. На приведенной выше схеме приложение создает сертификат, который начинает создание ключа в хранилище ключей.
2. Key Vault возвращает приложению запрос на подпись сертификата (CSR).
3. Приложение передает CSR выбранному центру сертификации (ЦС).
4. Выбранный ЦС отвечает на сертификат X509.
5. Приложение завершает создание сертификата путем слияния сертификата X509 из ЦС.

-   **Создание сертификата с помощью известного поставщика издателя.** При использовании этого метода необходимо выполнить разовую задачу создания объекта издателя. После создания объекта издателя в хранилище ключей можно ссылаться на его имя в политике сертификата KV. При запросе на создание такого сертификата KV создается пара ключей в хранилище и устанавливается связь со службой поставщика издателя, используя сведения в объекте издателя, на которые имеются ссылки для получения сертификата x509. Чтобы завершить создание сертификата KV, сертификат х509 будет извлечен из службы поставщика и объединен с парою ключей.  

![Создание сертификата с помощью партнерского центра сертификации Key Vault](media/certificate-authority-2.png)  

Следующие описания соответствуют действиям, обозначенным зеленым цветом на предыдущей схеме.

1. На приведенной выше схеме приложение создает сертификат, который начинает создание ключа в хранилище ключей.
2. Key Vault отправляет запрос на SSL-сертификат в ЦС.
3. Приложение выполняет опрос (в процессе "цикл — ожидание") для Key Vault для завершения создания сертификата. После того как Key Vault получит ответ от ЦС с сертификатом x509, создание сертификата будет завершено.
4. В ответ на запрос Key Vault на SSL-сертификат ЦС отправляет SSL-сертификат X509.
5. Создание сертификата завершается слиянием сертификата X509 из ЦС.

## <a name="asynchronous-process"></a>Асинхронный процесс
Создание сертификата KV представляет собой асинхронный процесс. Эта операция возвращает код состояния HTTP 202 (Принято) и создает запрос на сертификат KV. Состояние запроса можно отслеживать путем опроса ожидающего объекта, созданного этой операцией. Полный URI ожидающего объекта возвращается в заголовке LOCATION.  

Когда запрос на создание сертификата KV завершается, статус ожидающего объекта изменится с "Выполняется" на "Готово" и будет создана новая версия сертификата KV. Она станет текущей версией.  

## <a name="first-creation"></a>Первое создание
 При создании сертификата KV в первый раз также создается адресуемый ключ и секрет с тем же именем, что и сертификат. Если имя уже используется, операция завершится ошибкой с кодом состояния HTTP 409 (конфликт).
Адресуемый ключ и секрет получают свои атрибуты из атрибутов сертификата KV. Адресуемый ключ и секрет, созданные таким образом, отмечены как управляемые ключи и секреты. Их временем существования управляет Key Vault. Управляемые ключи и секреты доступны только для чтения. Примечание. Если сертификат KV отключен или истек срок его действия, соответствующий ключ и секрет станут непригодными к использованию.  

 Если сертификат KV создается впервые, необходимо наличие политики.  Политику можно задать с помощью последовательных операций создания, чтобы заменить ресурс политики. Если политика не указана, для создания следующей версии сертификата KV используется ресурс политики службы. Обратите внимание, что в ходе выполнения запроса на создание следующей версии текущий сертификат KV и соответствующий адресуемый ключ и секрет остаются неизменными.  

## <a name="self-issued-certificate"></a>Самостоятельно выдаваемый сертификат
 Чтобы создать самостоятельно выдаваемый сертификат, в политике сертификата в качестве имени издателя укажите Self, как показано в следующем фрагменте политики сертификата.  

```  
"issuer": {  
       "name": "Self"  
    }  

```  

 Если имя издателя не указано, будет установлено значение Unknown. Если издатель неизвестен, владельцу сертификата придется вручную получать сертификат x509 от выбранного издателя, а затем объединять его с ожидающим объектом сертификата хранилища ключей, чтобы завершить создание сертификата.

```  
"issuer": {  
       "name": "Unknown"  
    }  

```  

## <a name="partnered-ca-providers"></a>Поставщики партнерского центра сертификации
Создание сертификата может быть выполнено вручную или с помощью издателя Self. Key Vault также сотрудничает с определенными поставщиками издателей, чтобы упростить создание сертификатов. У этих партнеров-поставщиков издателей можно заказать для хранилища ключей следующие сертификаты.  

|Поставщик|Тип сертификата|  
|--------------|----------------------|  
|DigiCert|Key Vault предоставляет OV или EV SSL-сертификаты в DigiCert|
|GlobalSign|Key Vault предоставляет OV или EV SSL-сертификаты в GlobalSign|

 Издатель сертификата — это сущность, представленная в Azure Key Vault (KV) как ресурс CertificateIssuer. Она используется для предоставления сведений об источнике сертификата KV, имени издателя, поставщика, учетных данных и других административных сведений.

Обратите внимание, что при размещении заказа поставщику издателя он может учесть или переопределить расширения сертификата x509 и срок действия сертификата на основе типа.  

 Авторизация: требуется разрешение на создание сертификатов.

## <a name="see-also"></a>См. также
 - [About keys, secrets, and certificates](about-keys-secrets-and-certificates.md) (Сведения о ключах, секретах и сертификатах)
 - [Мониторинг и администрирование процесса создания сертификатов](create-certificate-scenarios.md)
