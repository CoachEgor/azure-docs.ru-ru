---
title: Якорные отношения и поиск путей
description: Узнайте о концептуальной модели якорных отношений. Научитесь соединять якоря в пространстве и использовать соседний API для выполнения сценария поиска путей.
author: ramonarguelles
manager: vriveras
services: azure-spatial-anchors
ms.author: rgarcia
ms.date: 02/24/2019
ms.topic: conceptual
ms.service: azure-spatial-anchors
ms.openlocfilehash: f2fd8f4b7d03be8822c3ec12e2be589054942ce3
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/27/2020
ms.locfileid: "74270600"
---
# <a name="anchor-relationships-and-way-finding-in-azure-spatial-anchors"></a>Якорные отношения и поиск путей в пространственных якорях Azure

Используя якорные отношения, можно создавать подключенные якоря в пространстве, а затем задавать такие вопросы:

* Есть ли якоря поблизости?
* Как далеко они находятся?

## <a name="examples"></a>Примеры

В таких случаях можно использовать подключенные якоря:

* Работник должен выполнить задачу, которая включает в себя посещение различных местах в промышленной фабрике. Завод имеет пространственные якоря в каждом месте. HoloLens или мобильное приложение помогает направлять работника из одного места в другое. Приложение сначала запрашивает близлежащие пространственные якоря, а затем направляет работника к следующему местоположению. Приложение визуально показывает общее направление и расстояние до следующего местоположения.

* Музей создает пространственные якоря на публичных показах. Вместе эти якоря образуют часовую экскурсию по основным публичным экспозициям музея. На всеобщее обозрение посетители могут открыть приложение смешанной реальности музея на своем мобильном устройстве. Затем они указывают свою камеру телефона вокруг пространства, чтобы увидеть общее направление и расстояние до других публичных показов на экскурсию. По мере того, как пользователь идет к публичному отображению, приложение обновляет общее направление и расстояние, чтобы помочь пользователю.

## <a name="set-up-way-finding"></a>Настройка поиска путей

Приложение, которое использует направление и расстояние между якорями, чтобы обеспечить руководство, использует *поиск путей.* Поиск путей отличается от пошаговых навигации. В пошаговых навигации пользователи ориентируются по стенам, через двери и между этажами. С помощью поиска путей пользователь получает подсказки об общем направлении назначения. Но вывод или знание пространства также помогает пользователю перемещаться по структуре к месту назначения.

Чтобы создать опыт поиска путей, сначала подготовьте место для работы и разработайте приложение, с которым пользователи будут взаимодействовать. Вот концептуальные шаги:

1. **Планируйте пространство**: Решите, какие места в пространстве будут частью поиска путей. В наших сценариях руководитель фабрики или координатор тура музея могут решить, какие места включить в опыт поиска путей.
2. **Подключение якорей**: Посетите выбранные места для создания пространственных якорей. Это можно сделать в админ-режиме приложения для конечных пользователей или в другом приложении. Вы будете соединять или связать каждый якорь с другими. Служба поддерживает эти отношения.
3. **Запустите опыт конечного пользователя:** Пользователи запускают приложение, чтобы найти якорь, который может быть в любом из выбранных мест. Общий дизайн должен определить места, где пользователи могут ввести опыт.
4. **Найти близлежащие якоря**: После того, как пользователь находит якорь, приложение может запросить близлежащие якоря. Эта процедура возвращает позу между устройством и этими якорями.
5. **Руководство пользователя**: Приложение может использовать позу для каждого из этих якорей, чтобы дать рекомендации об общем направлении пользователя и расстояние. Например, в ленте камеры в приложении может отображаться значок и стрелка для представления каждого потенциального пункта назначения, как показано на следующем изображении.
6. **Уточните руководство:** По мере того, как пользователь ходит, приложение может периодически вычислять новую позу между устройством и якорем назначения. Приложение продолжает совершенствовать подсказки руководства, которые помогают пользователю прибыть в пункт назначения.

    ![Пример того, как приложение может отображать рекомендации по поиску путей](./media/meeting-spot.png)

## <a name="connect-anchors"></a>Подключение якорей

Чтобы создать опыт поиска путей, сначала необходимо разместить якоря в выбранных местах. В этом разделе мы предположим, что админ приложения уже закончил эту работу.

### <a name="connect-anchors-in-a-single-session"></a>Подключение якорей в одном сеансе

Для подключения якорей:

1. Прогулка до первого места и создать якорь С помощью CloudSpatialAnchorSession.
2. Прогулка до второго места. Базовая платформа MR/AR отслеживает движение.
3. Создайте anchor B, используя тот же CloudSpatialAnchorSession. Якоря A и B теперь подключены. Служба пространственных якорей поддерживает эту связь.
4. Продолжить процедуру для остальных якорей.

### <a name="connect-anchors-in-multiple-sessions"></a>Подключение якорей в нескольких сеансах

Вы можете подключить пространственные якоря в течение нескольких сеансов. Используя этот метод, вы можете создать и подключить некоторые якоря одновременно, а затем позже создать и подключить больше якорей.

Для подключения якорей в течение нескольких сеансов:

1. Приложение создает некоторые якоря в одном CloudSpatialAnchorSession.
2. В другое время приложение находит один из этих якорей (например, якорь A) с помощью нового CloudSpatialAnchorSession.
3. Прогулка на новое место. Базовая платформа смешанной реальности или дополненной реальности отслеживает движение.
4. Создайте Anchor C, используя тот же CloudSpatialAnchorSession. Якоря A, B и C теперь подключены. Служба пространственных якорей поддерживает эту связь.

Вы можете продолжить эту процедуру для более якорей и больше сессий с течением времени.

### <a name="verify-anchor-connections"></a>Проверка якорных соединений

Приложение может проверить, что два якоря подключены, выпустив запрос для близлежащих якорей. Когда результат запроса содержит целевой якорь, якорь проверяется. Если якоря не подключены, приложение может попытаться подключить их снова.

Вот несколько причин, почему якоря могут не подключиться:

* Базовая платформа смешанной реальности или дополненной реальности потеряла отслеживание в процессе подключения якорей.
* Из-за сетевой ошибки при общении со службой пространственных якорей якорное соединение не могло быть упорным.

### <a name="find-sample-code"></a>Поиск примера кода

Чтобы найти пример кода, который показывает, как подключить якоря и делать близлежащие запросы, смотрите [пример приложений Spatial Anchors.](https://github.com/Azure/azure-spatial-anchors-samples)
