---
title: Хранение блочных BLOB-объектов на устройствах — Azure IoT Edge | Документация Майкрософт
description: Разверните модуль хранилища BLOB-объектов Azure на вашем устройстве IoT Edge для хранения данных на границе.
author: kgremban
manager: philmea
ms.author: kgremban
ms.reviewer: arduppal
ms.date: 03/07/2019
ms.topic: conceptual
ms.service: iot-edge
services: iot-edge
ms.custom: seodec18
ms.openlocfilehash: 3a0df408e70ed61355ffba319f6261f90d8e4348
ms.sourcegitcommit: 3102f886aa962842303c8753fe8fa5324a52834a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "60595592"
---
# <a name="store-data-at-the-edge-with-azure-blob-storage-on-iot-edge-preview"></a>Хранение данных на границе с помощью хранилища BLOB-объектов Azure в IoT Edge (предварительная версия)

Хранилище BLOB-объектов Azure в IoT Edge предоставляет решение по хранению [блочных BLOB-объектов](https://docs.microsoft.com/rest/api/storageservices/understanding-block-blobs--append-blobs--and-page-blobs#about-block-blobs) на пограничных устройствах. Модуль хранилища BLOB-объектов на устройстве IoT Edge ведет себя как служба BLOB-объектов Azure, но блочные BLOB-объекты хранятся локально на вашем устройстве IoT Edge. Вы можете получить доступ к BLOB-объектам с помощью тех же методов SDK службы хранилища Azure или вызовов API к блочным BLOB-объектам, к которым вы уже привыкли. 

Этот модуль поставляется с **распределение по уровням автоматически** и **срока действия автоматически** функции.

> [!NOTE]
> В настоящее время распределение по уровням автоматически и автоматически срока доступны только в Linux AMD64 и Linux ARM32.

**Распределение по уровням автоматически** можно настроить функциональные возможности, которая позволяет автоматически загружать данные из вашего локального хранилища в Azure с поддержкой подключения периодически internet. Также вы можете:
- Включить ON/OFF функция распределения по уровням
- Выберите порядок, в котором данные будут скопированы в Azure, например NewestFirst или OldestFirst
- Укажите учетную запись хранения Azure, к которому требуется, чтобы загружены данные.
- Укажите контейнеров, которые вы хотите отправить в Azure. Этот модуль позволяет указать исходные и целевые имена контейнеров.
- Полное распределение по уровням для BLOB-объектов (с помощью `Put Blob` операции) и блокировки уровня распределение по уровням (с помощью `Put Block` и `Put Block List` операций).

Этот модуль использует блок уровня распределение по уровням, если большой двоичный объект состоит из блоков. Ниже приведены некоторые из распространенных сценариев.
- Приложение обновляет некоторые блоки, ранее загруженного BLOB-объекта, этот модуль будет загружать только обновленные блоков и не весь большой двоичный объект.
- Модуль является отправка больших двоичных объектов и подключение к Интернету исчезает, когда подключение снова снова станет что передает только оставшихся блоков и не весь большой двоичный объект.

Если непредвиденное завершение процесса (например, сбой электропитания) происходит во время передачи большого двоичного объекта, все блоки, которые выполнялись для передачи, будет отправлен еще раз, после возвращения модуля.

**Срок действия автоматически** является настраиваемые функции, где этот модуль автоматически удаляет большие двоичные объекты из локального хранилища по истечении срока жизни (TTL). Измеряется в минутах. Также вы можете:
- Включить ON/OFF функция auto-истечение срока действия
- Укажите значение срока ЖИЗНИ в минутах

Сценарии, где данные, такие как видео, изображения, процент данных, данных больницы или любые данные, которые необходимо сохранить локально, более поздней версии, может быть обработан локально или передаваться в облако — это хорошие примеры использования модуля.

В этой статье приведены инструкции по развертыванию хранилища BLOB-объектов Azure в контейнере IoT Edge, в котором работает служба BLOB-объектов на вашем устройстве IoT Edge. 

>[!NOTE]
>Хранилище BLOB-объектов в IoT Edge находится в [общедоступной предварительной версии](https://azure.microsoft.com/support/legal/preview-supplemental-terms/). 

Посмотреть видео по Краткое введение
> [!VIDEO https://www.youtube.com/embed/wkprcfVidyM]

## <a name="prerequisites"></a>Технические условия

Устройство Azure IoT Edge.

* В качестве устройства Azure IoT Edge можно использовать компьютер, на котором ведется разработка, или виртуальную машину. Для этого выполните действия, описанные в кратком руководстве для устройств [Linux](quickstart-linux.md) или [Windows](quickstart.md).
* Хранилище BLOB-объектов в модуле IoT Edge поддерживает следующие конфигурации устройств:

   | Операционная система | Архитектура |
   | ---------------- | ------------ |
   | Ubuntu Server 16.04 | AMD64 |
   | Ubuntu Server 18.04 | AMD64 |
   | Windows 10 IoT Core (обновление за октябрь) | AMD64 |
   | Windows 10 IoT Enterprise (обновление за октябрь) | AMD64 |
   | Windows Server 2019 | AMD64 |
   | Raspbian Stretch | ARM32 |

Облачные ресурсы.

* [Центр Интернета вещей](../iot-hub/iot-hub-create-through-portal.md) цен. категории "Стандартный" в Azure. 


## <a name="deploy-blob-storage-to-your-device"></a>Развертывание хранилища BLOB-объектов на устройстве

Существует несколько способов развертывания модулей на устройстве IoT Edge, и все они подходят для хранилища BLOB-объектов на модулях IoT Edge. Два простейших метода — это портал Azure или шаблоны Visual Studio Code. 

### <a name="azure-portal"></a>Портал Azure

Azure Marketplace предоставляет модули IoT Edge, развертываемые непосредственно на устройствах IoT Edge, включая хранилище BLOB-объектов Azure в IoT Edge. Выполните следующие действия для развертывания модуля с помощью портала Azure.

1. На [портале Azure](https://portal.azure.com) выполните поиск по запросу "Хранилище BLOB-объектов Azure в IoT Edge". Затем **выберите** результат поиска в Marketplace.

   ![Создание модуля в результате поиска в Marketplace](./media/how-to-store-data-blob/marketplace-module.png)

2. Выберите устройство IoT Edge, чтобы получить этот модуль. На странице **Целевые устройства для модуля IoT Edge** укажите следующие сведения:

   1. Выберите **подписку**, которая содержит используемый Центр Интернета вещей.

   2. Выберите нужный **Центр Интернета вещей**.

   3. Если вам известно **имя устройства IoT Edge**, введите его в текстовое поле. Кроме того, вы можете щелкнуть **Найти устройство**, чтобы выбрать его из списка устройств IoT Edge в Центре Интернета вещей. 
   
   4. Нажмите кнопку **Создать**.

   После выбора модуля IoT Edge из Azure Marketplace и устройства IoT Edge для получения модуля откроется мастер, который состоит из трех шагов. Он поможет точно определить, как будет развернут модуль.

3. На шаге **добавления модулей** мастера настройки модулей обратите внимание, что модуль **AzureBlobStorageonIoTEdge** уже указан в разделе **Модули развертывания**. 

2. Из списка модулей развертывания выберите модуль хранилища BLOB-объектов, чтобы просмотреть сведения о нем. 

   ![Выбор имени модуля для просмотра сведений о нем](./media/how-to-store-data-blob/open-module-details.png)

3. На странице **Пользовательские модули IoT Edge** обновите хранилище BLOB-объектов Azure в модуле IoT Edge, выполнив следующие действия:

   1. Замените заглавную букву **имени** модуля буквой нижнего регистра. При необходимости переименуйте модуль или используйте `azureblobstorageoniotedge`. 

      >[!IMPORTANT]
      >Azure IoT Edge учитывает регистр при вызове модулей, а название пакета SDK службы хранилища по умолчанию преобразовывается в нижний регистр. Чтобы подключения к хранилищу BLOB-объектов Azure в модуле IoT Edge не прерывались, следует задать имя модуля с использованием знаков нижнего регистра. 

   2. Контейнеру необходимы привязки портов со значениями **параметров создания контейнера** по умолчанию. На устройство также следует добавить сведения об учетной записи хранения и информацию о привязке для каталога хранения. Замените имеющийся на портале JSON-файл указанным ниже:
    
      ```json
      {
          "Env":[
              "LOCAL_STORAGE_ACCOUNT_NAME=<your storage account name>",
              "LOCAL_STORAGE_ACCOUNT_KEY=<your storage account key>"
          ],
          "HostConfig":{
              "Binds":[
                  "<storage directory bind>"
              ],
              "PortBindings":{
                  "11002/tcp":[{"HostPort":"11002"}]
              }
          }
      }
      ```   
   3. Обновите в скопированном JSON-файле следующие сведения: 

      * Замените `<your storage account name>` запоминаемым именем. Имена учетных записей должны содержать от 3 до 24 знаков — строчных букв и цифр.
      * Замените `<your storage account key>` на 64-байтовый ключ Base64. Вы можете создать ключ с помощью таких средств, как [GeneratePlus](https://generate.plus/en/base64?gp_base64_base[length]=64). Вы будете использовать эти учетные данные для доступа к хранилищу BLOB-объектов из других модулей.
      * Замените `<storage directory bind>` в зависимости от операционной системы контейнера. Укажите имя [тома](https://docs.docker.com/storage/volumes/) или абсолютный путь к каталогу на устройстве IoT Edge, где модуль BLOB-объектов должен хранить данные. Привязка каталога хранения сопоставляет указанное расположение на устройстве с определением расположения в модуле. 

         * Контейнеры Linux: **\<путь к хранилищу>:/blobroot**. Например, /srv/containerdata:/blobroot. Или my-volume:/blobroot. 
         * Контейнеры Windows: **\<путь к хранилищу>:C:/BlobRoot**. Например, C:/ContainerData:C:/BlobRoot. Или my-volume:C:/blobroot.
   
      > [!IMPORTANT]
      > Не изменяйте вторую половину значения привязки каталога хранения, которая указывает на определенное расположение в модуле. Привязка каталога хранения всегда должна заканчиваться на **:/blobroot** — для контейнеров Linux и **:C:/BlobRoot** — для контейнеров Windows.

      ![Изменение значений для параметров создания контейнера модуля на портале](./media/how-to-store-data-blob/edit-module.png)

   4. Задайте [распределение по уровням автоматически и срок действия автоматически](#configure-auto-tiering-and-auto-expiration-via-azure-portal) в требуемых свойствах. Список [распределение по уровням автоматически](#auto-tiering-properties) и [срока действия автоматически](#auto-expiration-properties) свойства и их возможные значения. 

   5. Щелкните **Сохранить**. 

4. Выберите **Далее**, чтобы перейти к следующему шагу мастера.
5. На шаге мастера **Укажите маршруты** выберите **Далее**.
6. В мастере на шаге **Проверка развертывания** выберите **Отправить**.
7. Сразу после отправки развертывания можно вернуться на страницу **IoT Edge** Центра Интернета вещей. Выберите устройство IoT Edge, на которое отправили развертывание, чтобы открыть сведения о нем. 
8. В сведениях об устройстве убедитесь, что для модуля службы хранилища BLOB-объектов настроены параметры **Указано в развертывании** и **Данные, полученные от устройства**. Запуск модуля на устройстве может занять несколько секунд. Затем информация о нем передается в Центр Интернета вещей. Обновите страницу, чтобы увидеть обновленное состояние. 

### <a name="visual-studio-code-templates"></a>Шаблоны Visual Studio Code

Azure IoT Edge предоставляет шаблоны в Visual Studio Code для разработки решений для границы. Для выполнения этих действий необходимо, чтобы на компьютере была установлена служба [Visual Studio Code](https://code.visualstudio.com/), настроенная со [средствами Azure IoT](https://marketplace.visualstudio.com/items?itemName=vsciot-vscode.azure-iot-tools).

Выполните следующие действия для создания нового решения IoT Edge с модулем хранилища BLOB-объектов и настройки манифеста развертывания. 

1. Выберите **Представление** > **Палитра команд**. 

2. В палитре команд введите и выполните команду **Azure IoT Edge: New IoT Edge Solution** (Azure IoT Edge: создать решение IoT Edge). Следуйте инструкциям на экране в палитре команд для создания решения.

   | Поле | Value |
   | ----- | ----- |
   | Выбор папки | Выберите расположение на компьютере разработчика для VS Code, чтобы создать файлы решения. |
   | Введите название решения. | Введите описательное имя решения или примите имя по умолчанию **EdgeSolution**. |
   | Выбор шаблона модуля | Выберите **Existing Module (Enter full image URL)** (Имеющийся модуль (введите полный URL-адрес образа)). |
   | Указание имени модуля | Введите имя модуля, используя знаки нижнего регистра, например **azureblobstorage**.<br><br>В модуле IoT Edge очень важно использовать знаки нижнего регистра для имени хранилища BLOB-объектов Azure. IoT Edge учитывает регистр при ссылке на модули, а название пакета SDK службы хранилища по умолчанию преобразовывается в нижний регистр. |
   | Указание образа Docker для модуля | Укажите универсальный код ресурса (URI) образа: **mcr.microsoft.com/azure-blob-storage:latest**. |

   VS Code принимает предоставленные сведения, создает решение IoT Edge, а затем загружает его в новом окне. Шаблон решения создает шаблон манифеста развертывания, который содержит образ модуля хранилища BLOB-объектов, но вам нужно настроить параметры создания модуля. 

3. Откройте **deployment.template.json** в рабочей области нового решения и найдите раздел **modules**. Внесите следующие изменения конфигурации.

   1. Удалите модуль **tempSensor**, так как он не требуется для этого развертывания. 

   2. Скопируйте и вставьте следующий код в поле **createOptions** модуля хранилища BLOB-объектов: 

      ```json
      "Env": [
        "LOCAL_STORAGE_ACCOUNT_NAME=$STORAGE_ACCOUNT_NAME","LOCAL_STORAGE_ACCOUNT_KEY=$STORAGE_ACCOUNT_KEY"
      ],
      "HostConfig":{
        "Binds": ["<storage directory bind>"],
        "PortBindings":{
          "11002/tcp": [{"HostPort":"11002"}]
        }
      }
      ```

      ![Изменение значений для параметров создания модуля в VS Code](./media/how-to-store-data-blob/create-options.png)

4. В файле JSON с параметрами создания обновите `<storage directory bind>` в зависимости от операционной системы контейнера. Укажите имя [тома](https://docs.docker.com/storage/volumes/) или абсолютный путь к каталогу на устройстве IoT Edge, где модуль BLOB-объектов должен хранить данные. Привязка каталога хранения сопоставляет указанное расположение на устройстве с определением расположения в модуле.  

   * Контейнеры Linux: **\<путь к хранилищу>:/blobroot**. Например, /srv/containerdata:/blobroot. Или my-volume:/blobroot.
   * Контейнеры Windows: **\<путь к хранилищу>:C:/BlobRoot**. Например, C:/ContainerData:C:/BlobRoot. Или my-volume:C:/blobroot.
   
   > [!IMPORTANT]
   > Не изменяйте вторую половину значения привязки каталога хранения, которая указывает на определенное расположение в модуле. Привязка каталога хранения всегда должна заканчиваться на **:/blobroot** — для контейнеров Linux и **:C:/BlobRoot** — для контейнеров Windows.

5. Настройка [распределение по уровням автоматически и срок действия автоматически](#configure-auto-tiering-and-auto-expiration-via-vscode). Список [распределение по уровням автоматически](#auto-tiering-properties) и [срока действия автоматически](#auto-expiration-properties) свойства

6. Сохраните файл **deployment.template.json**.

7. Откройте **ENV**-файл в рабочей области решения. 

8. В ENV-файле заданы параметры для получения учетных данных реестра контейнеров. Он не требуется для образа хранилища BLOB-объектов, так как находится в открытом доступе. Вместо этого укажите в файле две новые переменные среды: 

   ```env
   STORAGE_ACCOUNT_NAME=
   STORAGE_ACCOUNT_KEY=
   ```

9. Укажите значение `STORAGE_ACCOUNT_NAME`. Имена учетных записей должны содержать от 3 до 24 знаков (строчные буквы и цифры). Укажите 64-байтовый ключ Base64 в качестве значения `STORAGE_ACCOUNT_KEY`. Вы можете создать ключ с помощью таких средств, как [GeneratePlus](https://generate.plus/en/base64?gp_base64_base[length]=64). Вы будете использовать эти учетные данные для доступа к хранилищу BLOB-объектов из других модулей. 

   Не добавляйте пробелы или кавычки вокруг указанных значений. 

10. Сохраните файл **.env**. 

11. Щелкните правой кнопкой мыши **deployment.template.json** и выберите **Создать манифест развертывания IoT Edge**. 

12. Visual Studio Code принимает данные из deployment.template.json и .env и использует их для создания файла манифеста развертывания. Манифест развертывания создается в новой папке **config** в рабочей области решения. Получив этот файл, выполните действия, описанные в разделе [Развертывание модулей Azure IoT Edge из Visual Studio Code](how-to-deploy-modules-vscode.md) или [Развертывание модулей IoT Edge Azure с помощью Azure CLI 2.0](how-to-deploy-modules-cli.md).

## <a name="auto-tiering-and-auto-expiration-properties-and-configuration"></a>Распределение по уровням автоматически срок действия автоматического свойства и конфигурации

Позволяет устанавливать свойства auto-истечение срока действия и распределение по уровням автоматически с помощью требуемых свойств. Их можно задать во время развертывания или изменить позднее, изменив двойник модуля без необходимости повторного развертывания. Мы рекомендуем использовать проверки «Двойник модуля» `reported configuration` и `configurationValidation` чтобы убедиться в том, правильно передаются значения.

### <a name="auto-tiering-properties"></a>Распределение по уровням автоматически свойства 
Этот параметр называется `tieringSettings`

| Поле | Возможные значения | Объяснение |
| ----- | ----- | ---- |
| tieringOn | true, false | По умолчанию ему присваивается `false`, если вы хотите включить его на задайте для него значение `true`|
| backlogPolicy | NewestFirst, OldestFirst | Позволяет выбрать порядок, в котором данные будут скопированы в Azure. По умолчанию ему присваивается `OldestFirst`. Порядок определяется время последнего изменения большого двоичного объекта |
| remoteStorageConnectionString |  | `"DefaultEndpointsProtocol=https;AccountName=<your Azure Storage Account Name>;AccountKey=<your Azure Storage Account Key>;EndpointSuffix=<your end point suffix>"` строки подключения, которая позволяет указать учетную запись хранения Azure, к которому требуется, чтобы данные отправки. Укажите `Azure Storage Account Name`, `Azure Storage Account Key`, `End point suffix`. Добавьте соответствующие EndpointSuffix Azure где данные будут загружены, она меняется для глобальной платформы Azure, Azure для государственных организаций и Microsoft Azure Stack. |
| tieredContainers | `"<source container name1>": {"target": "<target container name>"}`,<br><br> `"<source container name1>": {"target": "%h-%d-%m-%c"}`, <br><br> `"<source container name1>": {"target": "%d-%c"}` | Позволяет указать имена контейнеров, который вы хотите отправить в Azure. Этот модуль позволяет указать исходные и целевые имена контейнеров. Если не указать имя целевого контейнера, он будет автоматически назначить имя контейнера как `<IoTHubName>-<IotEdgeDeviceName>-<ModuleName>-<ContainerName>`. Можно создать шаблон строки для имени целевого контейнера, а также извлечение возможных значений столбца. <br>* %h "->" имя центра Интернета вещей (3 – 50 символов). <br>* %d "->" идентификатор (от 1 до 129 символов) устройства Интернета вещей. <br>* %m "->" имя модуля (от 1 до 64 символов). <br>* %c "->" имя исходного контейнера (от 3 до 63 символов). <br><br>Максимальный размер имени контейнера — 63 символа, при автоматически назначении имя целевого контейнера, если размер контейнера больше, чем 63 символов, которые он удалит каждый раздел (IoTHubName, IotEdgeDeviceName, имя модуля, ContainerName) до 15 символов. |

### <a name="auto-expiration-properties"></a>Свойства Auto-истечение срока действия
Этот параметр называется `ttlSettings`

| Поле | Возможные значения | Объяснение |
| ----- | ----- | ---- |
| ttlOn | true, false | По умолчанию ему присваивается `false`, если вы хотите включить его на задайте для него значение `true`|
| timeToLiveInMinutes | `<minutes>` | Укажите значение срока ЖИЗНИ в минутах. Модуль будет автоматически удалять больших двоичных объектов из локального хранилища после истечения срока действия |

### <a name="configure-auto-tiering-and-auto-expiration-via-azure-portal"></a>Настроить распределение по уровням автоматически и срок действия автоматически с помощью портала Azure

Задайте требуемые свойства, чтобы включить распределение по уровням автоматически, и автоматическое истечение срока действия, вы можете задать эти значения:

- **Во время первоначального развертывания**: Скопируйте код JSON в **требуемые свойства двойника модуля набор** поле. Настроить в соответствующее значение каждого свойства, сохраните его и продолжить развертывание.

   ```json
   {
     "properties.desired": {
       "ttlSettings": {
         "ttlOn": <true, false>, 
         "timeToLiveInMinutes": <timeToLiveInMinutes> 
       },
       "tieringSettings": {
         "tieringOn": <true, false>,
         "backlogPolicy": "<NewestFirst, OldestFirst>",
         "remoteStorageConnectionString": "DefaultEndpointsProtocol=https;AccountName=<your Azure Storage Account Name>;AccountKey=<your Azure Storage Account Key>;EndpointSuffix=<your end point suffix>",
         "tieredContainers": {
           "<source container name1>": {
             "target": "<target container name1>"
           }
         }
       }
     }
   }

   ```

  ![Задайте свойства распределение по уровням автоматически и срок действия автоматически](./media/how-to-store-data-blob/iotedge_custom_module.png)

- **После развертывания модуля с помощью функции «Двойник модуля Identity»**: Перейти к «Двойник модуля Identity» этого модуля, скопируйте код JSON в разделе свойств требуемого, настроить каждое свойство в соответствующее значение и сохранить. В формате Json «Двойник модуля Identity» убедитесь, что при каждом добавлении или обновлении любого требуемого свойства, `reported configuration` раздел отражает изменения и `configurationValidation` разделе сообщает об успешном выполнении для каждого свойства.

   ```json 
    "ttlSettings": {
        "ttlOn": <true, false>, 
        "timeToLiveInMinutes": <timeToLiveInMinutes> 
    },
    "tieringSettings": {
        "tieringOn": <true, false>,
        "backlogPolicy": "<NewestFirst, OldestFirst>",
        "remoteStorageConnectionString": "DefaultEndpointsProtocol=https;AccountName=<your Azure Storage Account Name>;AccountKey=<your Azure Storage Account Key>;EndpointSuffix=<your end point suffix>",
        "tieredContainers": {
            "<source container name1>": {
                "target": "<target container name1>"
            }
        }
    }

   ```

![срок жизни module_identity_twin распределения по уровням +](./media/how-to-store-data-blob/module_identity_twin.png) 

### <a name="configure-auto-tiering-and-auto-expiration-via-vscode"></a>Настроить распределение по уровням автоматически и срок действия автоматически с помощью VSCode

- **Во время первоначального развертывания**: Добавить ниже JSON в вашей deployment.template.json для определения требуемых свойств для этого модуля. Настроить каждое свойство в соответствующее значение и сохраните его.

   ```json
   "<your azureblobstorageoniotedge module name>":{
     "properties.desired": {
       "ttlSettings": {
         "ttlOn": <true, false>, 
         "timeToLiveInMinutes": <timeToLiveInMinutes> 
       },
       "tieringSettings": {
         "tieringOn": <true, false>,
         "backlogPolicy": "<NewestFirst, OldestFirst>",
         "remoteStorageConnectionString": "DefaultEndpointsProtocol=https;AccountName=<your Azure Storage Account Name>;AccountKey=<your Azure Storage Account Key>;EndpointSuffix=<your end point suffix>",
         "tieredContainers": {
           "<source container name1>": {
             "target": "<target container name1>"
           }
         }
       }
     }
   }

   ```

Вот пример требуемых свойств для этого модуля: ![задать нужные свойства для azureblobstorageoniotedge - VS Code](./media/how-to-store-data-blob/tiering_ttl.png)

- **После развертывания модуля с помощью «Двойник модуля»**: [Изменить Двойник модуля](https://github.com/Microsoft/vscode-azure-iot-toolkit/wiki/Edit-Module-Twin) этого модуля, скопируйте код JSON в разделе свойств требуемого, настроить каждое свойство с соответствующим значением и сохранения. В формате Json «Двойник модуля» убедитесь, что при каждом добавлении или обновлении любого требуемого свойства, `reported configuration` раздел отражает изменения и `configurationValidation` разделе сообщает об успешном выполнении для каждого свойства.

   ```json 
    "ttlSettings": {
        "ttlOn": <true, false>, 
        "timeToLiveInMinutes": <timeToLiveInMinutes> 
    },
    "tieringSettings": {
        "tieringOn": <true, false>,
        "backlogPolicy": "<NewestFirst, OldestFirst>",
        "remoteStorageConnectionString": "DefaultEndpointsProtocol=https;AccountName=<your Azure Storage Account Name>;AccountKey=<your Azure Storage Account Key>;EndpointSuffix=<your end point suffix>",
        "tieredContainers": {
            "<source container name1>": {
                "target": "<target container name1>"
            }
        }
    }

   ```
## <a name="logs"></a>Журналы

Следуйте указаниям, [настроить свои журналы docker для модулей Edge Интернета вещей](production-checklist.md#set-up-logs-and-diagnostics)

## <a name="connect-to-your-blob-storage-module"></a>Подключение к модулю хранилища BLOB-объектов

Вы можете использовать имя учетной записи и ключ учетной записи, настроенные для вашего модуля, для доступа к хранилищу BLOB-объектов на устройстве IoT Edge. 

Укажите устройство IoT Edge в качестве конечной точки большого двоичного объекта для любых запросов к хранилищу. Вы можете [создать строку подключения для явной конечной точки хранилища](../storage/common/storage-configure-connection-string.md#create-a-connection-string-for-an-explicit-storage-endpoint) с помощью сведений об устройстве IoT Edge и имени учетной записи. 

1. Для модулей, которые развертываются на одном устройстве edge, где выполняется «BLOB-объектов хранилища в Edge Интернета вещей Azure», конечная точка BLOB-объектов —: `http://<module name>:11002/<account name>`. 
2. Для модулей, которые развертываются на разных пограничные устройства, чем устройство edge, где выполняется «BLOB-объектов хранилища в Edge Интернета вещей Azure», то в зависимости от настройки конечной точки BLOB-объектов является: `http://<device IP >:11002/<account name>` или `http://<IoT Edge device hostname>:11002/<account name>` или `http://<FQDN>:11002/<account name>`

## <a name="deploy-multiple-instances"></a>Развертывание нескольких экземпляров

Если вы хотите развернуть несколько экземпляров из хранилища BLOB-объектов Azure в IoT Edge, необходимо указать путь хранения и измените HostPort, который связывает модуль. Модули службы хранилища BLOB-объектов всегда предоставляют порт 11002 в контейнере, но вы можете объявить, к какому порту он привязан в узле. 

Измените параметры создания модуля, чтобы изменить значение HostPort:

```json
\"PortBindings\": {\"11002/tcp\": [{\"HostPort\":\"<port number>\"}]}
```

При подключении к дополнительным модулям хранилища BLOB-объектов измените конечную точку, чтобы она указывала на обновленный порт узла. 

## <a name="try-it-out"></a>Попробуйте в деле

### <a name="azure-blob-storage-quickstart-samples"></a>Примеры быстрого запуска хранилища BLOB-объектов Azure
Документация по хранилищу BLOB-объектов Azure содержит краткие руководства с примерами кода на нескольких языках. Вы можете запустить эти примеры, чтобы протестировать хранилище BLOB-объектов Azure в IoT Edge путем изменения конечной точки большого двоичного объекта для указания на модуль хранилища BLOB-объектов. Выполните действия, чтобы [подключиться к вашему модулю хранилища BLOB-объектов](#connect-to-your-blob-storage-module)

В следующих кратких руководствах используются языки, которые также поддерживаются в IoT Edge, поэтому их можно развернуть как модули IoT Edge наряду с модулями хранилища BLOB-объектов:

* [.NET](../storage/blobs/storage-quickstart-blobs-dotnet.md)
* [Java](../storage/blobs/storage-quickstart-blobs-java.md)
* [Python](../storage/blobs/storage-quickstart-blobs-python.md)
* [Node.js](../storage/blobs/storage-quickstart-blobs-nodejs.md) 

### <a name="azure-storage-explorer"></a>Обозреватель хранилища Azure
Можно также попытаться «Обозреватель службы хранилища Azure» для подключения к учетной записи локального хранилища. Она работает с [обозреватель службы хранилища Azure версии 1.5.0](https://github.com/Microsoft/AzureStorageExplorer/releases/tag/v1.5.0).

> [!NOTE]
> Выполняя следующие действия, например добавления подключения к учетной записи локального хранилища или создание контейнеров в учетной записи локального хранилища, могут возникнуть ошибки. Пропустите это сообщение и обновления. 

1. Скачайте и установите обозреватель службы хранилища Azure
2. Подключение к службе хранилища Azure с помощью строки подключения
3. Укажите строку подключения: `DefaultEndpointsProtocol=http;BlobEndpoint=http://<host device name>:11002/<your local account name>;AccountName=<your local account name>;AccountKey=<your local account key>;`
4. Выполните действия по подключению.
5. Создание контейнера в учетной записи локального хранилища
6. Начните отправлять файлы как блочные BLOB-объекты.
   > [!NOTE]
   > Снимите флажок, чтобы передать его как страничных BLOB-объектов. Этот модуль не поддерживает страничных BLOB-объектов. Вы получите это prompt при отправке файлов, таких как ISO-файл, .vhd, .vhdx или всех больших файлов.

7. Вы можете подключиться учетных записей хранения Azure, где вы отправляете данные. Он предоставляет единое представление для учетной записи хранения Azure и локальной учетной записи хранения

## <a name="supported-storage-operations"></a>Поддерживаемые операции в хранилище

Модули службы хранилища больших двоичных объектов в IoT Edge используйте те же пакеты SDK хранилища Azure и согласованы с версии 2017-04-17 API службы хранилища Azure для конечных точек большой двоичный объект блока. Более поздние версии зависят от потребностей клиентов.

Не все операции в хранилище BLOB-объектов Azure поддерживаются в хранилище BLOB-объектов Azure в IoT Edge. В следующем разделе перечислены поддерживаемые и неподдерживаемые операции.

### <a name="account"></a>Учетная запись.

Поддерживается: 
* Перечисление контейнеров

Не поддерживается: 
* Получение и задание свойств службы BLOB-объектов
* Предварительный запрос к BLOB-объектам
* Получение статистики службы BLOB-объектов
* Получение данных об учетной записи

### <a name="containers"></a>Контейнеры

Поддерживается: 
* Создание и удаление контейнера
* Получение свойств и метаданных контейнера
* Список BLOB-объектов
* Получение и задание списка управления доступом для контейнера
* Определение метаданных контейнера

Не поддерживается:
* Аренда контейнера

### <a name="blobs"></a>BLOB-объекты

Поддерживается: 
* Помещение, получение и удаление BLOB-объекта
* Получение и задание свойств BLOB-объекта
* Получение и задание метаданных BLOB-объекта

Не поддерживается: 
* Аренда BLOB-объекта
* Создание моментального снимка BLOB-объекта
* Копирование и прерывание копирования BLOB-объекта
* Отмена удаления BLOB-объекта
* Установка уровня BLOB-объекта

### <a name="block-blobs"></a>Блочные BLOB-объекты

Поддерживается: 
* Вставка блока
* Вставка и получение списка блоков

Не поддерживается:
* Вставка блока по URL-адресу

## <a name="feedback"></a>Отзыв:
Ваши отзывы очень важно для нас, чтобы сделать этот модуль и его компонентах, полезными и простой в использовании. Отправьте свой отзыв и дайте нам знать, как мы можем улучшить.

Вы сможете связаться с нами по адресу absiotfeedback@microsoft.com 

## <a name="next-steps"></a>Дальнейшие действия

Дополнительные сведения о [хранилище BLOB-объектов Azure](../storage/blobs/storage-blobs-introduction.md)

