---
title: Менеджер по безопасности Azure IoT Edge - Azure IoT Edge
description: Управляет состоянием безопасности устройства IoT Edge и целостностью служб безопасности.
services: iot-edge
keywords: безопасность, безопасный элемент, анклава, TEE, IoT Edge
author: eustacea
manager: philmea
ms.author: eustacea
ms.date: 08/30/2019
ms.topic: conceptual
ms.service: iot-edge
ms.openlocfilehash: d5cfa16196a8815b711fd5277a80f6eb67d3a388
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/27/2020
ms.locfileid: "76548702"
---
# <a name="azure-iot-edge-security-manager"></a>Диспетчер безопасности Azure IoT Edge

Диспетчер безопасности Azure IoT Edge — это хорошо ограниченное ядро обеспечения ​​безопасности для защиты устройства IoT Edge и всех его компонентов путем абстрагирования защищенного кремниевого оборудования. Менеджер безопасности является координационным центром для укрепления безопасности и предоставляет точку интеграции технологий производителям оригинального оборудования (OEM).

![Диспетчер безопасности Azure IoT Edge](media/edge-security-manager/iot-edge-security-manager.png)

Диспетчер безопасности IoT Edge предназначен для защиты целостности устройства IoT Edge и всех встроенных программных операций. Менеджер безопасности переходит от доверительного управления с базового аппаратного корня аппаратного обеспечения доверия (при наличии) на загрузку времени выполнения IoT Edge и мониторинг текущих операций.  По сути, диспетчер безопасности IoT Edge — это программное обеспечение, работающее вместе с безопасным оборудованием с микросхемами (где это доступно) и позволяющее обеспечить максимально возможные гарантии безопасности.  

В задачи диспетчера безопасности IoT Edge входят (это не исчерпывающий список):

* Безопасная и измеренная начальная загрузка устройства Azure IoT Edge.
* Подготовка удостоверения устройства и передача доверия, где это применимо.
* Размещение и защита компонентов облачных служб для устройства, например службы подготовки устройств.
* Безопасная подготовка модулей IoT Edge с уникальными идентификаторами.
* Хранение корня доверия оборудования с помощью нотариальных служб.
* Мониторинг целостности операций IoT Edge во время выполнения.

Диспетчер безопасности IoT Edge состоит из трех компонентов:

* управляющая программа безопасности IoT Edge;
* уровень абстракции платформы аппаратного модуля безопасности (HSM);
* необязательный, но очень рекомендуемый корень доверия кремниевого оборудования или HSM.

## <a name="the-iot-edge-security-daemon"></a>Управляющая программа безопасности IoT Edge

Daemon безопасности IoT Edge отвечает за логические операции менеджера безопасности IoT Edge. Он представляет собой значительную часть надежной вычислительной базы устройства IoT Edge.

### <a name="design-principles"></a>Принципы проектирования

Управляющая программа безопасности IoT Edge придерживается двух основных принципов: максимальное увеличение операционной целостности, минимизация раздувания и обновления.

#### <a name="maximize-operational-integrity"></a>Максимальное увеличение операционной целостности

Daemon безопасности IoT Edge работает с максимальной целостностью в рамках оборонных возможностей любого данного корня оборудования доверия. При правильной интеграции корень доверия оборудования проверяет и отслеживает управляющую программу безопасности в статическом состоянии и во время выполнения, чтобы противостоять незаконному изменению.

Физический доступ всегда является угрозой для устройств Интернета вещей. Корень доверия оборудования играет важную роль в защите целостности управляющей программы безопасности IoT Edge.  Аппаратный корень доверия бывают двух разновидностей:

* безопасные элементы для защиты конфиденциальной информации, такой как секреты и криптографические ключи;
* безопасные внутренние зоны для защиты секретов, например ключей, и уязвимых рабочих нагрузок, таких как выставление счетов и ценообразование.

Существуют два типа сред выполнения для использования аппаратного корня доверия:

* Стандартная или богатая среда выполнения (REE), которая опирается на использование безопасных элементов для защиты конфиденциальной информации.
* Доверенная среда исполнения (TEE), которая опирается на использование технологии безопасного анклава для защиты конфиденциальной информации и обеспечивает защиту для выполнения программного обеспечения.

Для устройств, использующих безопасные анклавы в качестве аппаратного корня доверия, чувствительная логика в daemon безопасности IoT Edge должна находиться внутри анклава.  Нечувствительные части daemon безопасности могут находиться за пределами TEE.  В любом случае, производители оригинального дизайна (ODM) и производители оригинального оборудования (OEM) должны расширить доверие от своих HSM для измерения и защиты целостности IoT Edge безопасности daemon при загрузке и времени выполнения.

#### <a name="minimize-bloat-and-churn"></a>Минимизация раздувания и обновления

Другой основной принцип управляющей программы безопасности IoT Edge заключается в минимизации обновлений.  Для высшего уровня доверия управляющая программа безопасности IoT Edge может тесно соединяться с корнем доверия оборудования устройства и работать как собственный код.  Это обычное дело для этих типов реализации для обновления программного обеспечения Daemon через аппаратный корень безопасных путей обновления доверия (в отличие от ОС при условии обновления механизмов), которые могут быть сложными в некоторых сценариях.  В то время как обновление безопасности рекомендуется для устройств IoT, чрезмерные требования к обновлению или большие полезные нагрузки обновления могут расширить поверхность угрозы во многих отношениях.  К примерам относятся пропуски обновлений, чтобы увеличить операционную доступность, или корень доверия устройства, слишком ограниченный, чтобы обрабатывать объемные полезные данные обновления.  Таким образом, дизайн daemon безопасности IoT Edge является кратким, чтобы сохранить след и доверенную вычислительную базу небольшой и свести к минимуму требования к обновлению.

### <a name="architecture-of-iot-edge-security-daemon"></a>Архитектура управляющей программы безопасности IoT Edge

![Управляющая программа безопасности Azure IoT Edge](media/edge-security-manager/iot-edge-security-daemon.png)

Daemon безопасности IoT Edge использует любые доступные аппаратные корни технологии доверия для закаливания безопасности.  Он также позволяет работать в сплит-мире между стандартной/богатой средой выполнения (REE) и надежной средой выполнения (TEE), когда аппаратные технологии предлагают доверенные среды выполнения. Специфические интерфейсы позволяют основным компонентам IoT Edge гарантировать целостность устройства IoT Edge и его работы.

#### <a name="cloud-interface"></a>Облачный интерфейс

Облачный интерфейс позволяет daemon безопасности IoT Edge получить доступ к облачным службам, таким как облачные комплименты для безопасности устройств, такие как обновление безопасности.  Например, в настоящее время интерфейс безопасности IoT Edge использует этот интерфейс для доступа к [службе обеспечения устройств](https://docs.microsoft.com/azure/iot-dps/) Azure IoT Hub для управления жизненным циклом работы устройств.  

#### <a name="management-api"></a>API управления

Daemon безопасности IoT Edge предлагает API управления, который вызывается агентом IoT Edge при создании/запуске/остановке/удалении модуля IoT Edge. Безопасность daemon хранит "регистрации" для всех активных модулей. Эти регистрации сопоставляют идентификатор модуля с некоторыми его свойствами. Например, эти свойства модуля включают идентификатор процесса (pid) процесса, работая в контейнере, и хэш содержимого контейнера докера.

Эти свойства используются API рабочей нагрузки (описано ниже) для проверки того, что абонент уполномочен для действия.

API управления является привилегированным API, который можно вызвать только у агента IoT Edge.  Так как загрузок IoT Edge security daemon и запускает агент IoT Edge, он проверяет, что агент IoT Edge не был подделан, то он может создать неявную регистрацию агента IoT Edge. Тот же процесс проверки, который использует API рабочей нагрузки, также ограничивает доступ к API управления только агенту IoT Edge.

#### <a name="container-api"></a>API контейнера

КонтейнерНый API взаимодействует с контейнерной системой, используемой для управления модулем, такими как Moby или Docker.

#### <a name="workload-api"></a>API рабочей нагрузки

API рабочей нагрузки доступен для всех модулей. Он предоставляет удостоверение личности, либо в качестве hSM корни подписали маркер или X509 сертификат, и соответствующий пакет доверия к модулю. Пакет доверия содержит сертификаты ЦС для всех других серверов, которым должны доверять модули.

Для защиты этого API в мошенном элементе безопасности IoT Edge используется процесс подтверждения. Когда модуль вызывает этот API, daemon безопасности пытается найти регистрацию для удостоверения личности. В случае обнаружения она использует свойства регистрации для измерения модуля. Если результат процесса измерения соответствует регистрации, создается новое удостоверение личности. Соответствующие сертификаты ЦС (пакет доверия) возвращаются в модуль.  Модуль использует этот сертификат для подключения к Центру Интернета вещей, другим модулям или запуска сервера. Когда подписанный токен или сертификат близится к истечению срока действия, модуль обязан запросить новый сертификат.

### <a name="integration-and-maintenance"></a>Интеграция и обслуживание

Корпорация Майкрософт поддерживает основную базу кода для управляющей программы безопасности [IoT Edge на GitHub](https://github.com/Azure/iotedge/tree/master/edgelet).

#### <a name="installation-and-updates"></a>Установка и обновления

Установкой и обновлением управляющей программы безопасности IoT Edge управляет система управления пакетами операционной системы. Устройства IoT Edge с корнем доверия оборудования должны обеспечить дополнительное улучшение целостности управляющей программы, управляя жизненным циклом устройства с помощью систем управления загрузкой и обновлением. Производители устройств должны изучить эти возможности на основе их соответствующих возможностей устройства.

#### <a name="versioning"></a>Управление версиями

Среда выполнения IoT Edge отслеживает и сообщает версию управляющей программы безопасности IoT Edge. Версия сообщается как атрибут *среда выполнения.платформа.версия* передаваемого свойства модуля агента IoT Edge.

### <a name="hardware-security-module-platform-abstraction-layer-hsm-pal"></a>Уровень абстракции платформы аппаратного модуля безопасности (HSM)

Уровень абстракции платформы HSM абстрагирует все корни доверия оборудования, чтобы избавить разработчика или пользователя IoT Edge от сложностей.  Она включает в себя сочетание интерфейса программирования приложений (API) и трансдоменных процедур связи, например, связь между стандартной средой выполнения и безопасным анклавом.  Фактическая реализация уровня абстракции платформы HSM зависит от конкретного используемого защищенного оборудования. Его существование позволяет использовать практически любое безопасное оборудование с микросхемами.

## <a name="secure-silicon-root-of-trust-hardware"></a>Корень доверия надежного кремниевого оборудования

Надежное кремниевое оборудование необходимо для закрепления доверия внутри аппаратного устройства IoT Edge.  Существует большое количество надежного кремниевого оборудования, включая доверенный платформенный модуль (TPM), встроенные защищенные элементы (eSM), ARM Trustzone, Intel SGX, а также настраиваемые технологии надежного кремниевого оборудования.  Использование безопасного кремниевого корня доверия к устройствам рекомендуется с учетом угроз, связанных с физической доступностью устройств IoT.

## <a name="iot-edge-security-manager-integration-and-maintenance"></a>Интеграция и обслуживание диспетчера безопасности IoT Edge

Цель диспетчера безопасности IoT Edge — определить и изолировать компоненты, которые повышают безопасность и обеспечивают целостность платформы Azure IoT Edge. Третьи стороны, например изготовители, должны применять пользовательские функции безопасности, доступные для оборудования их устройств.  Изучите следующий раздел со ссылками, демонстрирующими усиление защиты диспетчера безопасности Интернета вещей Azure с помощью доверенного платформенного модуля (TPM) на платформах Linux и Windows. В этих примерах используется программное обеспечение или виртуальные модули TPM, но они непосредственно применяются к дискретным устройствам TPM.  

## <a name="next-steps"></a>Дальнейшие действия

Просмотрите блог, посвященный [обеспечению безопасности интеллектуальной границы](https://azure.microsoft.com/blog/securing-the-intelligent-edge/).

Перейдите к созданию и подготовке устройства IoT Edge с помощью [виртуального доверенного платформенного модуля на виртуальной машине Linux](how-to-auto-provision-simulated-device-linux.md).

Перейдите к созданию и подготовке устройства IoT Edge с помощью [имитированного доверенного платформенного модуля в Windows](how-to-auto-provision-simulated-device-windows.md).
