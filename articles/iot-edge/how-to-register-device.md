---
title: Регистрация нового устройства Azure IoT Edge | Документация Майкрософт
description: Регистрация нового устройства IoT Edge и получение строки подключения с помощью расширения Интернета вещей для Azure CLI
author: kgremban
manager: philmea
ms.author: kgremban
ms.date: 01/08/2020
ms.topic: conceptual
ms.reviewer: menchi
ms.service: iot-edge
ms.custom: devx-track-azurecli
services: iot-edge
ms.openlocfilehash: 85a5e2f6b28b9332e5ad3a38cdad3fb02bb3da87
ms.sourcegitcommit: 3792cf7efc12e357f0e3b65638ea7673651db6e1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/29/2020
ms.locfileid: "91450150"
---
# <a name="register-an-azure-iot-edge-device"></a>Регистрация устройства Azure IoT Edge

Чтобы использовать устройства Интернета вещей в Azure IoT Edge, их необходимо зарегистрировать в Центре Интернета вещей. После регистрации устройства можно получить строку подключения, чтобы настроить устройство для рабочих нагрузок IoT Edge.

Зарегистрировать устройство можно с помощью одного из следующих средств:

* [Зарегистрируйте устройство на портале Azure](#register-in-the-azure-portal), если вы предпочитаете графический пользовательский интерфейс для создания, просмотра ресурсов Azure и управления ими.
* [Зарегистрируйте устройство с помощью Visual Studio Code](#register-with-visual-studio-code), если вы предпочитаете управлять ресурсами Azure IoT в том же месте, где вы разрабатываете решения Интернета вещей.
* [Зарегистрируйте устройство с помощью Azure CLI](#register-with-the-azure-cli), если вы предпочитаете использовать средства командной строки для управления ресурсами Azure или планируете автоматизировать задачи.

## <a name="register-in-the-azure-portal"></a>Регистрация на портале Azure

Все задачи по регистрации можно выполнять на портале Azure.

### <a name="prerequisites-for-the-azure-portal"></a>Необходимые условия для использования портала Azure

[Центр Интернета вещей](../iot-hub/iot-hub-create-through-portal.md) (бесплатно или уровня "Стандартный") в подписке Azure.

### <a name="create-an-iot-edge-device-in-the-azure-portal"></a>Создание устройства IoT Edge на портале Azure

В центре Интернета вещей на портале Azure устройства IoT Edge создаются и администрируются независимо от других устройств Интернета вещей, не поддерживающих IoT Edge.

1. Войдите на [портал Azure](https://portal.azure.com) и перейдите к своему Центру Интернета вещей.
2. В меню слева выберите **IoT Edge**.
3. Выберите **Добавить устройство IoT Edge**.
4. Укажите описательный идентификатор устройства. Для автоматического создания ключей проверки подлинности и подключения нового устройства к центру используйте параметры по умолчанию.
5. Щелкните **Сохранить**.

### <a name="view-iot-edge-devices-in-the-azure-portal"></a>Просмотр устройств IoT Edge на портале Azure

Все устройства IoT Edge, подключенные к Центру Интернета вещей, перечислены на странице **IoT Edge**.

![Просмотр списка всех устройств IoT Edge в центре Интернета вещей](./media/how-to-register-device/portal-view-devices.png)

### <a name="retrieve-the-connection-string-in-the-azure-portal"></a>Получение строки подключения на портале Azure

Когда все будет готово к настройке устройства, вам понадобится строка подключения, которая связывает физическое устройство с его идентификатором в Центре Интернета вещей.

1. На странице **IoT Edge** на портале выберите идентификатор устройства в списке устройств IoT Edge.
2. Скопируйте значение в поле **Основная строка подключения** или **Дополнительная строка подключения**.

## <a name="register-with-visual-studio-code"></a>Регистрация с помощью Visual Studio Code

VS Code позволяет выполнять большинство операций разными способами. В этой статье мы используем Explorer, но шаги можно выполнить и с помощью палитры команд.

### <a name="prerequisites-for-visual-studio-code"></a>Необходимые условия для использования Visual Studio Code

* [Центр Интернета вещей](../iot-hub/iot-hub-create-through-portal.md) в подписке Azure.
* [Visual Studio Code](https://code.visualstudio.com/)
* [Средства Azure IoT](https://marketplace.visualstudio.com/items?itemName=vsciot-vscode.azure-iot-tools) для Visual Studio Code.

### <a name="sign-in-to-access-your-iot-hub"></a>Вход в систему для получения доступа к Центру Интернета вещей

Для выполнения действий с Центром Интернета вещей можно использовать расширения Интернета вещей Azure для Visual Studio Code. Для этого войдите в учетную запись Azure и выберите свой Центр Интернета вещей.

1. Откройте в Visual Studio Code представление **Explorer**.
1. В нижней части Explorer разверните раздел **Центр Интернета вещей**.

   ![Развернутый раздел "Azure IoT Hub Devices" (Устройства Центра Интернета вещей Azure)](./media/how-to-register-device/azure-iot-hub-devices.png)

1. Щелкните значок **...** в заголовке раздела **Центр Интернета вещей**. Если значок многоточия не отображается, щелкните заголовок или наведите на него курсор.
1. Щелкните **Выбрать Центр Интернета вещей**.
1. Если вы еще не вошли в учетную запись Azure, сделайте это сейчас, следуя инструкциям.
1. Выберите подписку Azure.
1. Выберите нужный Центр Интернета вещей.

### <a name="create-an-iot-edge-device-with-visual-studio-code"></a>Создание устройства IoT Edge с помощью Visual Studio Code

1. В обозревателе VS Code разверните раздел **Устройства Центра Интернета вещей Azure**.
1. Щелкните значок **...** в заголовке раздела **Устройства Центра Интернета вещей Azure**. Если значок многоточия не отображается, щелкните заголовок или наведите на него курсор.
1. Выберите **Создать устройство IoT Edge**.
1. В открывшемся текстовом поле введите идентификатор для нового устройства.

На экране выходных данных отобразится результат выполнения команды. Здесь содержатся сведения об устройстве, в том числе введенный вами идентификатор **deviceId** и строка подключения **connectionString**, которая понадобится для подключения физического устройства к Центру Интернета вещей.

На экране выходных данных отобразится результат выполнения команды. Здесь содержатся сведения об устройстве, в том числе введенный вами идентификатор **deviceId** и строка подключения **connectionString**, которая понадобится для подключения физического устройства к Центру Интернета вещей.

### <a name="view-iot-edge-devices-with-visual-studio-code"></a>Просмотр устройств IoT Edge с помощью Visual Studio Code

Все устройства, подключенные к Центру Интернета вещей, перечислены в разделе **Центр Интернета вещей** в обозревателе Visual Studio Code. Устройства IoT Edge легко отличить от остальных, так как они обозначаются другим значком и их можно открыть для отображения модулей **$edgeAgent** и **$edgeHub**, развернутых на каждом из устройств IoT Edge.

![Просмотр списка всех устройств IoT Edge в центре Интернета вещей](./media/how-to-register-device/view-devices.png)

### <a name="retrieve-the-connection-string-with-visual-studio-code"></a>Получение строки подключения с помощью Visual Studio Code

Когда все будет готово к настройке устройства, вам понадобится строка подключения, которая связывает физическое устройство с его идентификатором в Центре Интернета вещей.

1. Щелкните правой кнопкой мыши идентификатор устройства в разделе **Центр Интернета вещей**.
1. Выберите действие **Копировать строку подключения для устройства**.

   Строка подключения будет помещена в буфер обмена.

Также вы можете выбрать пункт **Получить информацию об устройства** в контекстном меню, чтобы просмотреть в окне выходных данных сведения об этом устройстве, в том числе строку подключения.

## <a name="register-with-the-azure-cli"></a>Регистрация с помощью Azure CLI

[Azure CLI](/cli/azure) — это кроссплатформенная программа командной строки с открытым кодом для управления ресурсами Azure (например, IoT Edge). Она позволяет управлять ресурсами Центра Интернета вещей Azure, экземплярами службы подготовки устройств и связанными концентраторами без дополнительной настройки. Расширение Интернета вещей расширяет функции Azure CLI (например, функция управления устройствами) и добавляет возможности IoT Edge.

### <a name="prerequisites-for-the-azure-cli"></a>Необходимые условия для использования Azure CLI

* [Центр Интернета вещей](../iot-hub/iot-hub-create-using-cli.md) в подписке Azure.
* [Интерфейс командной строки Azure](/cli/azure/install-azure-cli) в вашей среде. Вам понадобится как минимум Azure CLI версии 2.0.70 или более поздней. Для проверки используйте `az --version`. Эта версия поддерживает команды расширения az и представляет собой платформу команд Knack.
* [Расширение Интернета вещей для Azure CLI](https://github.com/Azure/azure-iot-cli-extension).

### <a name="create-an-iot-edge-device-with-the-azure-cli"></a>Создание устройства IoT Edge с помощью Azure CLI

Для создания нового удостоверения устройства в центре Интернета вещей используйте команду [az iot hub device-identity create](/cli/azure/ext/azure-iot/iot/hub/device-identity#ext-azure-iot-az-iot-hub-device-identity-create). Пример:

   ```azurecli
   az iot hub device-identity create --device-id [device id] --hub-name [hub name] --edge-enabled
   ```

Эта команда принимает три параметра:

* **device-id**: содержит описательное имя устройства, уникальное в пределах Центра Интернета вещей;
* **hub-name**: содержит имя Центра Интернета вещей;
* **edge-enabled**: указывает, что устройство предназначено для использования с IoT Edge.

   ![Выходные данные команды az iot hub device-identity](./media/how-to-register-device/Create-edge-device.png)

### <a name="view-iot-edge-devices-with-the-azure-cli"></a>Просмотр устройств IoT Edge в Azure CLI

Для просмотра всех устройств в центре Интернета вещей используйте команду [az iot hub device-identity list](/cli/azure/ext/azure-iot/iot/hub/device-identity#ext-azure-iot-az-iot-hub-device-identity-list). Пример:

   ```azurecli
   az iot hub device-identity list --hub-name [hub name]
   ```

Для всех устройств, зарегистрированных в качестве устройства IoT Edge, свойство **capabilities.iotEdge** будет иметь значение **true**.

### <a name="retrieve-the-connection-string-with-the-azure-cli"></a>Получение строки подключения с помощью Azure CLI

Когда все будет готово к настройке устройства, вам понадобится строка подключения, которая связывает физическое устройство с его идентификатором в Центре Интернета вещей. Чтобы вернуть строку подключения для одного устройства, воспользуйтесь командой [AZ IOT концентратора подключение — строка-идентификация](/cli/azure/ext/azure-iot/iot/hub/device-identity/connection-string#ext_azure_iot_az_iot_hub_device_identity_connection_string_show) .

   ```azurecli
   az iot hub device-identity connection-string show --device-id [device id] --hub-name [hub name]
   ```

В параметре `device-id` учитывается регистр. Копируйте строку подключения без кавычек.

## <a name="next-steps"></a>Дальнейшие действия

Теперь, когда удостоверение устройства зарегистрировано в центре Интернета вещей, можно приступить к установке среды выполнения IoT Edge на устройства. Установите среду выполнения в соответствии с операционной системой устройства:

* [Установка Azure IoT Edge в Windows](how-to-install-iot-edge-windows.md)
* [Установка среды выполнения Azure IoT Edge в Linux](how-to-install-iot-edge-linux.md)
