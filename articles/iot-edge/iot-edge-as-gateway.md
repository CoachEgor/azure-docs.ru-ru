---
title: Шлюзы для подчиненных устройств — Azure IoT Edge | Документация Майкрософт
description: Используйте Azure IoT Edge для создания прозрачного и непрозрачного устройства-шлюза или устройства-шлюза прокси-сервера, который отправляет данные из нескольких подчиненных устройств в облако или обрабатывает их локально.
author: kgremban
manager: philmea
ms.author: kgremban
ms.date: 02/25/2019
ms.topic: conceptual
ms.service: iot-edge
services: iot-edge
ms.openlocfilehash: ec8b6cf61f9fb92f888642d1de7d4d1b9b7ac3df
ms.sourcegitcommit: 12d902e78d6617f7e78c062bd9d47564b5ff2208
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/24/2019
ms.locfileid: "74456644"
---
# <a name="how-an-iot-edge-device-can-be-used-as-a-gateway"></a>Использование устройства IoT Edge в качестве шлюза

Gateways in IoT Edge solutions provide device connectivity and edge analytics to IoT devices that otherwise wouldn't have those capabilities. Azure IoT Edge может использоваться для удовлетворения всех потребностей шлюза Интернета вещей независимо от того, связаны ли они с подключением, удостоверением или пограничной аналитикой. Шаблоны шлюза в этой статье относятся только к характеристикам подключения к нисходящему устройству и идентификации устройства, а не как данные устройства обрабатываются на шлюзе.

## <a name="patterns"></a>Шаблоны

Есть три шаблона для использования устройства IoT Edge в качестве шлюза: прозрачный, преобразование протоколов и преобразование удостоверения.
* **Прозрачный**. Устройства, которые теоретически могут подключиться к Центру Интернета вещей, могут вместо этого подключиться к шлюзу устройства. Подчиненные устройства имеют собственные удостоверения Центра Интернета вещей и используют любые протоколы MQTT, AMQP или HTTP. Шлюз просто передает связь между устройствами и концентратором Центра Интернета вещей. The devices are unaware that they are communicating with the cloud via a gateway, and a user interacting with the devices in IoT Hub is unaware of the intermediate gateway device. Таким образом шлюз является прозрачным. Дополнительные сведения о том, как использовать устройство IoT Edge в качестве прозрачного шлюза, см. в статье [Configure an IoT Edge device to act as a transparent gateway](how-to-create-transparent-gateway.md) (Настройка устройства IoT Edge, выступающего в роли прозрачного шлюза).
* **Преобразование протокола** (или модели непрозрачного шлюза). Устройства, не поддерживающие MQTT, AMQP или HTTP, могут от своего имени отправлять данные в Центр Интернета вещей через устройство шлюза. The gateway understands the protocol used by the downstream devices, and is the only device that has an identity in IoT Hub. Вся информация выглядит так, будто она поступает с одного устройства, шлюза. Подчиненные устройства должны внедрять дополнительные идентификационные сведения в свои сообщения, если облачные приложения хотят выполнять анализ данных для каждого устройства. Кроме того, примитивы Центра Интернета вещей, такие как двойники и методы, доступны только для устройства шлюза, а не для подчиненных устройств.
* **Преобразование удостоверения** — устройства, которые не могут подключиться к Центру интернета вещей, вместо этого могут подключаться к устройству шлюза. Шлюз предоставляет преобразование удостоверения Центра Интернета вещей и протокола от имени подчиненных устройств. У шлюза достаточно возможностей, чтобы понять протокол, используемый подчиненными устройствами, предоставить им удостоверение и преобразовать примитивы Центра Интернета вещей. Подчиненные устройства отображаются в Центре Интернета вещей как устройства первого уровня с двойниками и методами. Пользователь может взаимодействовать с устройствами в Центре Интернета вещей и ничего не знать о промежуточном устройстве шлюза.

![Схема — шаблоны прозрачного шлюза, непрозрачного шлюза и шлюза преобразования удостоверений](./media/iot-edge-as-gateway/edge-as-gateway.png)

## <a name="use-cases"></a>Примеры использования
Все шаблоны шлюза предоставляют следующие преимущества:
* **Analytics at the edge** – Use AI services locally to process data coming from downstream devices without sending full-fidelity telemetry to the cloud. Находите данные и реагируйте на запросы локально, а также отправляйте подмножество данных в Центр Интернета вещей. 
* **Изоляция подчиненного устройства.** Устройство шлюза может обеспечить всем подчиненным устройствам безопасность в Интернете. Оно может находиться между сетью OT без возможности подключения и IT-сетью, которая обеспечивает доступ к сети. 
* **Мультиплексирование подключения**. Все устройства, подключающиеся к Центру Интернета вещей через шлюз IoT Edge, будут использовать одно и то же базовое подключение.
* **Сглаживание трафика** — Устройство IoT Edge автоматически будет выполнять экспоненциальную задержку, если Центр Интернета вещей регулирует трафик, при этом сообщения сохраняются локально. Это преимущество сделает ваше решение устойчивым к пикам трафика.
* **Offline support** - The gateway device stores messages and twin updates that cannot be delivered to IoT Hub.

Шлюз, который выполняет преобразование протокола, также может выполнять пограничную аналитику, изоляцию устройства, сглаживание трафика и автономную поддержку имеющихся устройств и новых устройств с ограниченными ресурсами. Многие имеющиеся устройства производят данные, которые могут предоставить бизнес-аналитику, однако они не были разработаны с учетом возможности подключения к облаку. Opaque gateways allow this data to be unlocked and used in an IoT solution.

Шлюз, который преобразует удостоверение, предоставляет преимущества преобразования протокола и дополнительно позволяет полностью управлять подчиненными устройствами из облака. Все устройства решения Интернета вещей отображаются в Центре Интернета вещей независимо от используемого протокола.

## <a name="cheat-sheet"></a>Шпаргалка
Ниже приведена краткая памятка, в которой сравниваются примитивы Центра Интернета вещей при использовании прозрачного и непрозрачного шлюза (протокола) и шлюза прокси-сервера.

| &nbsp; | Прозрачный шлюз | Преобразование протоколов | Преобразование удостоверения |
|--------|-------------|--------|--------|
| Удостоверения, хранящиеся в реестре удостоверений Центра Интернета вещей | Удостоверения всех подключенных устройств | Только удостоверение устройства шлюза | Удостоверения всех подключенных устройств |
| "Двойник" устройства | У каждого подключенного устройства есть свой собственный двойник устройства | Только у шлюза есть двойники устройства и модуля | У каждого подключенного устройства есть свой собственный двойник устройства |
| Прямые методы и сообщения, передающиеся из облака на устройства | Данные могут передаваться из облака на каждое подключенное устройство по отдельности | Данные могут передаваться из облака только в шлюз | Данные могут передаваться из облака на каждое подключенное устройство по отдельности |
| [Квоты и регулирование в Центре Интернета вещей](../iot-hub/iot-hub-devguide-quotas-throttling.md) | Применяется к каждому устройству | Применяется к устройству шлюза | Применяется к каждому устройству |

При использовании модели непрозрачного шлюза (преобразование протоколов) все устройства, подключающиеся через шлюз, совместно используют одну очередь из облака на устройство, которая может содержать не более 50 сообщений. Из этого следует, что шаблон непрозрачного шлюза должен использоваться только в том случае, если через шлюз каждого поля подключается небольшое число устройств и их трафик из облака на устройство низкий.

## <a name="next-steps"></a>Дальнейшие действия

Learn how to set up a transparent gateway: 

* [Настройка устройства IoT Edge в качестве прозрачного шлюза](how-to-create-transparent-gateway.md).
* [Аутентификация подчиненного устройства в Центре Интернета вещей](how-to-authenticate-downstream-device.md)
* [Connect a downstream device to an Azure IoT Edge gateway](how-to-connect-downstream-device.md) (Подключение подчиненного устройства к шлюзу Azure IoT Edge)