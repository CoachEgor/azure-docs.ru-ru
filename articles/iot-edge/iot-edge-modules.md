---
title: Информация о том, как модули запускают приложения логики на ваших устройствах. Azure IoT Edge | Документация Майкрософт
description: Модули Azure IoT Edge — это контейнерные единицы приложений логики, которые можно развертывать и которыми можно управлять удаленно, чтобы запускать приложения бизнес-логики на устройствах IoT Edge
author: kgremban
manager: philmea
ms.author: v-yiso
origin.date: 03/21/2019
ms.date: 04/08/2019
ms.topic: conceptual
ms.service: iot-edge
services: iot-edge
ms.custom: seodec18
ms.openlocfilehash: d1e2e35dafd90c16e9d0dbf38afb1e981653d1fe
ms.sourcegitcommit: 3102f886aa962842303c8753fe8fa5324a52834a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "60445049"
---
# <a name="understand-azure-iot-edge-modules"></a>Общие сведения о модулях IoT Edge Azure

Azure IoT Edge позволяет развертывать *модули* бизнес-логики на пограничных устройствах и управлять этими модулями. Модуль Azure IoT Edge представляет собой наименьшую единицу вычислительных ресурсов, которыми управляет IoT Edge. Эти модули могут содержать службы Azure (например, Azure Stream Analytics) или пользовательский код для конкретного решения. Чтобы понять, как модули разработанных, развертывания и обслуживания, полезно думать о четырех концептуальной элементов модуля:

* **Образ модуля** — это пакет с программным обеспечением для модуля.
* **Экземпляр модуля** — это единица вычислительных ресурсов, выполняющая образ модуля на устройстве IoT Edge. Экземпляр модуля запускается средой выполнения IoT Edge.
* **Идентификатор модуля** — это сведения о модуле (включая учетные данные безопасности), которые хранятся в Центре Интернета вещей и относятся к конкретному экземпляру модуля.
* **Двойник модуля** — это документ JSON, хранящийся в Центре Интернета вещей, который содержит данные о состоянии экземпляра модуля, в том числе метаданные, конфигурации и условия. 

## <a name="module-images-and-instances"></a>Образы и экземпляры модулей

Образы модулей IoT Edge содержат приложения, в которых используются функции управления, безопасности и обмена данными среды выполнения IoT Edge. Вы можете создавать собственные образы модулей или экспортировать их из поддерживаемых служб Azure, таких как Azure Stream Analytics.
Образы существуют в облаке, и вы можете обновлять их, изменять и развертывать в разных решениях. Например, существует отдельный модуль, который прогнозирует мощность производственной линии с применением технологий машинного обучения, и другой модуль, который использует компьютерное зрение для управления дроном. 

Каждый раз, когда среда выполнения IoT Edge запускает развернутый на устройстве образ модуля, она создает новый экземпляр этого модуля. Два устройства в разных частях света могут использовать тот же образ модуля. Тем не менее каждое устройство будет иметь свой собственный экземпляр модуля при запуске модуля на устройстве. 

![Диаграмма. Образы модулей в облаке — экземпляры модулей на устройствах](./media/iot-edge-modules/image_instance.png)

На практике образы модулей существуют как образы контейнеров в хранилище данных, а экземпляры модулей реализованы как контейнеры на устройствах. 

<!--
As use cases for Azure IoT Edge grow, new types of module images and instances will be created. For example, resource constrained devices cannot run containers so may require module images that exist as dynamic link libraries and instances that are executables. 
-->

## <a name="module-identities"></a>Идентификаторы модулей

Когда в среде выполнения IoT Edge создается новый экземпляр модуля, он сопоставляется с определенным идентификатором модуля. Идентификатор модуля хранится в Центре Интернета вещей и работает как область адресации и безопасности для всех локальных и облачных взаимодействий с конкретным экземпляром модуля.
Имя идентификатора составляется из идентификатора устройства, на котором запущен этот экземпляр, и имени модуля, указанного в вашем решении. Например, когда вы вызываете модуль `insight`, в котором используется Azure Stream Analytics, и развертываете его на устройстве `Hannover01`, среда выполнения IoT Edge создает для него идентификатор модуля с именем `/devices/Hannover01/modules/insight`.

Иногда нужно развернуть один образ модуля несколько раз на одном устройстве. В таком случае для экземпляров будут использоваться разные имена.

![Диаграмма. Идентификаторы модулей уникальны в рамках каждого устройства и на всех устройствах](./media/iot-edge-modules/identity.png)

## <a name="module-twins"></a>Двойники модулей

С каждым экземпляром модуля сопоставлен определенный двойник модуля, который применяется для настройки экземпляра. Экземпляр и двойник связаны друг с другом через идентификатор модуля. 

Двойник модуля представляет собой документ JSON, в котором собраны сведения о модуле и параметры его конфигурации. Эта концепция работает так же, как и [двойник устройства](../iot-hub/iot-hub-devguide-device-twins.md) в Центре Интернета вещей. Структура двойника модуля идентична структуре двойника устройства. Для взаимодействия с двойниками обоих типов используются одни и те же API-интерфейсы. Единственное различие между ними — идентификатор, который применяется для создания экземпляра клиентского пакета SDK. 

```csharp
// Create a ModuleClient object. This ModuleClient will act on behalf of a 
// module since it is created with a module’s connection string instead 
// of a device connection string. 
ModuleClient client = new ModuleClient.CreateFromEnvironmentAsync(settings); 
await client.OpenAsync(); 
 
// Get the module twin 
Twin twin = await client.GetTwinAsync(); 
```

## <a name="offline-capabilities"></a>Возможности автономной работы

Azure IoT Edge поддерживает автономные операции с устройствами IoT Edge. Эти возможности сейчас ограничены. Дополнительные возможности автономной работы сейчас представлены в общедоступной предварительной версии. Дополнительные сведения см. в разделе [Сведения о расширенных возможностях автономной работы устройств, модулей и дочерних устройств IoT Edge](offline-capabilities.md).

Модули IoT Edge могут находиться вне сети в течение продолжительного времени при соблюдении следующих требований: 

* **Не истек срок жизни (TTL) сообщения**. По умолчанию срок жизни сообщения составляет два часа, но его можно увеличить или уменьшить в разделе "Конфигурация хранения и пересылки" параметров центра IoT Edge. 
* **В автономном состоянии модулям не требуется повторно проходить проверку подлинности в центре IoT Edge**. Модули могут проходить проверку подлинности только в центрах IoT Edge, имеющих активное соединение с центром Интернета вещей. Модулям нужно повторить проверку подлинности при перезапуске по любой причине. Модули по-прежнему могут отправлять сообщения центру IoT Edge после истечения срока действия токена SAS. При возобновлении подключения центр IoT Edge запрашивает у модуля новый токен и проверяет его на соответствие с центром Интернета вещей. В случае успешной проверки центр IoT Edge пересылает сохраненные сообщения модуля — даже сообщения, отправленные после истечения срока действия токена модуля. 
* **При возобновлении подключения модуль, отправивший сообщения в автономном режиме, продолжает работать**. При восстановлении подключения к Центру Интернета вещей центр IoT Edge должен проверить новый токен модуля (если срок действия предыдущего истек), прежде чем пересылать сообщения этого модуля. Если модуль не может предоставить новый токен, центр IoT Edge не обрабатывает хранимые сообщения этого модуля. 
* **Центр IoT Edge располагает местом на диске для хранения сообщений**. По умолчанию сообщения хранятся в файловой системе контейнера центра IoT Edge. В конфигурации есть параметр, позволяющий задать для хранения сообщений подключенный том. В любом случае для хранения сообщений с отложенной доставкой в Центр Интернета вещей требуется наличие доступного пространства.  


## <a name="next-steps"></a>Дальнейшие действия
 - [Сведения о требованиях и средствах разработки модулей IoT Edge](module-development.md)
 - [Общие сведения о среде выполнения Azure IoT Edge и ее архитектуре](iot-edge-runtime.md)

<!-- Images -->
[1]: ./media/iot-edge-modules/image_instance.png
[2]: ./media/iot-edge-modules/identity.png

<!-- Links -->
[lnk-device-identity]: ../iot-hub/iot-hub-devguide-identity-registry.md
[lnk-device-twin]: ../iot-hub/iot-hub-devguide-device-twins.md
[lnk-runtime]: iot-edge-runtime.md
[lnk-mod-dev]: module-development.md
