---
title: Свойства близнецов агента и концентраторного модуля - Azure IoT Edge
description: Обзор определенных свойств и их значений для двойников модулей EdgeAgent и EdgeHub
author: kgremban
manager: philmea
ms.author: kgremban
ms.date: 06/17/2019
ms.topic: conceptual
ms.service: iot-edge
services: iot-edge
ms.openlocfilehash: f2d6603c264c9da3f2700f460a8c61b24681fac6
ms.sourcegitcommit: 980c3d827cc0f25b94b1eb93fd3d9041f3593036
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/02/2020
ms.locfileid: "80546191"
---
# <a name="properties-of-the-iot-edge-agent-and-iot-edge-hub-module-twins"></a>Свойства двойников модулей агента IoT Edge и центра IoT Edge

Агент IoT Edge и центр IoT Edge — это два модуля, которые составляют среду выполнения IoT Edge. Для получения дополнительной информации об обязанностях каждого модуля времени выполнения [см.](iot-edge-runtime.md)

В этой статье представлены требуемые и отображаемые в отчете свойства двойников модулей для среды выполнения. Для получения дополнительной информации о том, как развертывать модули на устройствах IoT Edge, [смотрите, как развертывать модули и устанавливать маршруты в IoT Edge.](module-composition.md)

Модуль ный близнец включает в себя:

* **Пожеланные свойства**. Бэкэнд решения может устанавливать желаемые свойства, и модуль может читать их. Модуль также может получать уведомления об изменениях в желаемых свойствах. Для синхронизации конфигурации или условий модуля используются желаемые свойства наряду с заявленными свойствами.

* **Сообщенные свойства**. Модуль может устанавливать зарегистрированные свойства, а бэкэнд решения может считывать и задавывать их. Сообщенные свойства используются наряду с желаемыми свойствами для синхронизации конфигурации или условий модуля.

## <a name="edgeagent-desired-properties"></a>Требуемые свойства EdgeAgent

Двойник модуля для агента IoT Edge называется `$edgeAgent`. Он координирует взаимодействие между агентом IoT Edge, выполняющимся на устройстве, и Центром Интернета вещей. Требуемые свойства задаются при применении манифеста развертывания на конкретном устройстве в ходе развертывания на одно устройство или несколько.

| Свойство | Описание | Обязательно |
| -------- | ----------- | -------- |
| schemaVersion | Должно быть "1.0". | Да |
| runtime.type | Должно быть "docker". | Да |
| runtime.settings.minDockerVersion | Задайте минимальную версию Docker, которая требуется для этого манифеста развертывания. | Да |
| runtime.settings.loggingOptions | Переведенные в строку JSON, содержащую параметры ведения журнала для контейнера агента IoT Edge. [Параметры ведения журнала Docker](https://docs.docker.com/engine/admin/logging/overview/) | нет |
| runtime.settings.registryCredentials<br>.{registryId}.username | Имя пользователя для реестра контейнеров. Для Реестра контейнеров Azure именем пользователя обычно является имя реестра.<br><br> Учетные данные реестра необходимы для любых изображений частного модуля. | нет |
| runtime.settings.registryCredentials<br>.{registryId}.password | Пароль для реестра контейнеров. | нет |
| runtime.settings.registryCredentials<br>.{registryId}.address | Адрес для реестра контейнеров. Для Реестра контейнеров Azure адрес обычно имеет вид *{имя реестра}.azurecr.io*. | нет |  
| systemModules.edgeAgent.type | Должно быть "docker". | Да |
| systemModules.edgeAgent.settings.image | Универсальный код ресурса (URI) образа агента IoT Edge. В настоящее время агент IoT Edge не может обновляться. | Да |
| systemModules.edgeAgent.settings<br>.createOptions | Переведенные в строку JSON, содержащую параметры для создания контейнера агента IoT Edge. [Параметры создания Docker](https://docs.docker.com/engine/api/v1.32/#operation/ContainerCreate) | нет |
| systemModules.edgeAgent.configuration.id | Идентификатор развертывания, которое развернуло этот модуль. | Центр Интернета вещей задает свойство при применении этого манифеста с помощью развертывания. Не является частью манифеста развертывания. |
| systemModules.edgeHub.type | Должно быть "docker". | Да |
| systemModules.edgeHub.status | Должно быть "running". | Да |
| systemModules.edgeHub.restartPolicy | Должно быть "always". | Да |
| systemModules.edgeHub.settings.image | Универсальный код ресурса (URI) образа центра IoT Edge. | Да |
| systemModules.edgeHub.settings<br>.createOptions | Переведенные в строку JSON, содержащую параметры для создания контейнера центра IoT Edge. [Параметры создания Docker](https://docs.docker.com/engine/api/v1.32/#operation/ContainerCreate) | нет |
| systemModules.edgeHub.configuration.id | Идентификатор развертывания, которое развернуло этот модуль. | Центр Интернета вещей задает свойство при применении этого манифеста с помощью развертывания. Не является частью манифеста развертывания. |
| modules.{ИД_модуля}.version | Определяемая пользователем строка, представляющая версию этого модуля. | Да |
| modules.{ИД_модуля}.type | Должно быть "docker". | Да |
| modules.{Ид_модуля}.status | {"running" \| "stopped"} | Да |
| modules.{ИД_модуля}.restartPolicy | "никогда" \| "на провал", \| "на \| нездоровый" "всегда" | Да |
| Модули. «moduleId».ImagePullPolicy | "на-создать" \| "никогда"" | нет |
| Модули. «moduleId».env | Список переменных среды для передачи в модуль. Принимает формат`"<name>": {"value": "<value>"}` | нет |
| modules.{ИД_модуля}.settings.image | Универсальный код ресурса (URI) для образа модуля. | Да |
| modules.{ИД_модуля}.settings.createOptions | Переведенные в строку JSON, содержащую параметры для создания контейнера модуля. [Параметры создания Docker](https://docs.docker.com/engine/api/v1.32/#operation/ContainerCreate) | нет |
| modules.{ИД_модуля}.configuration.id | Идентификатор развертывания, которое развернуло этот модуль. | Центр Интернета вещей задает свойство при применении этого манифеста с помощью развертывания. Не является частью манифеста развертывания. |

## <a name="edgeagent-reported-properties"></a>Отображаемые в отчете свойства EdgeAgent

Сообщаемые свойства агента IoT Edge включают в себя три основных элемента информации:

1. состояние применения последних требуемых свойств;
2. состояние модулей, запущенных на устройстве, зарегистрированное агентом IoT Edge;
3. копия требуемых свойств, выполняемых в данное время на устройстве.

Копия желаемых свойств текущих полезно рассказать, применяло ли устройство последнее развертывание или все еще работает предыдущий манифест развертывания.

> [!NOTE]
> Сообщаемые свойства агента IoT Edge полезны, так как к ним можно выполнять запросы с помощью [языка запросов Центра Интернета вещей](../iot-hub/iot-hub-devguide-query-language.md), чтобы узнать состояние развертывания в масштабе. Дополнительные сведения об использовании свойств агента IoT Edge, чтобы узнать состояние развертывания, см. в статье [Общие сведения об автоматических развертываниях IoT Edge для отдельных устройств или в требуемом масштабе](module-deployment-monitoring.md).

Следующая таблица не включает сведения, которые копируются из требуемых свойств.

| Свойство | Описание |
| -------- | ----------- |
| lastDesiredVersion | Это целое число относится к последней версии требуемых свойств, обрабатываемых агентом IoT Edge. |
| lastDesiredStatus.code | Этот код состояния относится к последним желаемым свойствам, видимым агентом IoT Edge. Допустимые значения: `200` — успех, `400` — недопустимая конфигурация,`412` — недопустимая версия схемы, `417` — нужные свойства пусты, `500` — сбой. |
| lastDesiredStatus.description | Текстовое описание состояния. |
| deviceHealth | Имеет значение `healthy`, если состояние среды выполнения всех модулей имеет значение `running` или `stopped`, в противном случае — `unhealthy`. |
| configurationHealth.{ИД_развертывания}.health | Имеет значение `healthy`, если состояние среды выполнения всех модулей, установленное развертыванием {ИД_развертывания}, имеет значение `running` или `stopped`, в противном случае — `unhealthy`. |
| runtime.platform.OS | Сообщает ОС, выполняющуюся на устройстве. |
| runtime.platform.architecture | Сообщает архитектуру ЦП на устройстве. |
| systemModules.edgeAgent.runtimeStatus | Состояние агента IoT Edge: {"running" \| "unhealthy"} |
| systemModules.edgeAgent.statusDescription | Текстовое описание сообщаемого состояния агента IoT Edge. |
| systemModules.edgeHub.runtimeStatus | Состояние центра IoT Edge: { "running" \| "stopped" \| "failed" \| "backoff" \| "unhealthy" } |
| systemModules.edgeHub.statusDescription | Текстовое описание состояния центра IoT Edge, если он неработоспособен. |
| systemModules.edgeHub.exitCode | Код выхода, сообщенный контейнером концентратора IoT Edge при выходе контейнера |
| systemModules.edgeHub.startTimeUtc | Время последнего запуска центра IoT Edge. |
| systemModules.edgeHub.lastExitTimeUtc | Время последнего выхода центра IoT Edge. |
| systemModules.edgeHub.lastRestartTimeUtc | Время последнего перезапуска центра IoT Edge. |
| systemModules.edgeHub.restartCount | Количество раз, когда этот модуль был перезагружен в рамках политики перезапуска. |
| modules.{ИД_модуля}.runtimeStatus | Состояние модуля: { "running" \| "stopped" \| "failed" \| "backoff" \| "unhealthy" } |
| modules.{ИД_модуля}.statusDescription | Текстовое описание состояния модуля, если он неработоспособен. |
| modules.{ИД_модуля}.exitCode | Код выхода, сообщенный контейнером модуля, если контейнер выходит |
| modules.{ИД_модуля}.startTimeUtc | Время последнего запуска модуля. |
| modules.{ИД_модуля}.lastExitTimeUtc | Время последнего завершения работы модуля. |
| modules.{ИД_модуля}.lastRestartTimeUtc | Время последнего перезапуска модуля. |
| modules.{ИД_модуля}.restartCount | Количество раз, когда этот модуль был перезагружен в рамках политики перезапуска. |

## <a name="edgehub-desired-properties"></a>Требуемые свойства EdgeHub

Двойник модуля центра IoT Edge называется `$edgeHub`. Он координирует взаимодействие между центром IoT Edge, выполняющимся на устройстве, и Центром Интернета вещей. Требуемые свойства задаются при применении манифеста развертывания на конкретном устройстве в ходе развертывания на одно устройство или несколько.

| Свойство | Описание | Требуется в манифесте развертывания |
| -------- | ----------- | -------- |
| schemaVersion | Должно быть "1.0". | Да |
| routes.{имя_маршрута} | Строка, представляющая маршрут центра IoT Edge. Для получения дополнительной информации [см.](module-composition.md#declare-routes) | Элемент `routes` может присутствовать, но быть пустым. |
| storeAndForwardConfiguration.timeToLiveSecs | Время в секундах, что Концентратор IoT Edge сохраняет сообщения при отключении от конечных точек, будь то Концентратор IoT или локальный модуль. Значение может быть любым положительным сечку. | Да |

## <a name="edgehub-reported-properties"></a>Отображаемые в отчете свойства EdgeHub

| Свойство | Описание |
| -------- | ----------- |
| lastDesiredVersion | Это целое число относится к последней версии требуемых свойств, обрабатываемых центром IoT Edge. |
| lastDesiredStatus.code | Код состояния, относящийся к последним желаемым свойствам, видимым концентратором IoT Edge. Допустимые значения: `200` — успех, `400` — недопустимая конфигурация, `500` — сбой. |
| lastDesiredStatus.description | Текстовое описание статуса. |
| clients.{идентификатор устройства или модуля}.status | Состояние подключения этого устройства или модуля. Возможные значения {"connected" \| "disconnected"}. В отключенном состоянии могут находиться только удостоверения модуля. Подчиненные устройства, подключающиеся к центру IoT Edge, отображаются только при подключении. |
| clients.{идентификатор устройства или модуля}.lastConnectTime | Последний раз устройство или модуль подключались. |
| clients.{идентификатор устройства или модуля}.lastDisconnectTime | Последний раз устройство или модуль отключались. |

## <a name="next-steps"></a>Дальнейшие действия

Сведения о том, как использовать эти свойства для создания манифестов развертывания, см. в статье [Сведения об использовании, настройке и повторном использовании модулей Azure IoT Edge (предварительная версия)](module-composition.md).
