---
title: Обновления версии Azure IoT Edge на устройствах | Документация Майкрософт
description: Сведения об обновлении устройства IoT Edge для запуска последних версий управляющей программы безопасности и среды выполнения IoT Edge
keywords: ''
author: kgremban
manager: philmea
ms.author: kgremban
ms.date: 06/27/2019
ms.topic: conceptual
ms.service: iot-edge
services: iot-edge
ms.custom: seodec18
ms.openlocfilehash: 0c461da44d3d9075d66a68fe8994a4e970288fca
ms.sourcegitcommit: 5bdd50e769a4d50ccb89e135cfd38b788ade594d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/03/2019
ms.locfileid: "67543751"
---
# <a name="update-the-iot-edge-security-daemon-and-runtime"></a>Обновление управляющей программы безопасности и среды выполнения IoT Edge

Как службе IoT Edge выпускает новые версии, нужно будет обновить устройствах IoT Edge для новейших функций и усовершенствований безопасности. В этой статье представлены сведения об обновлении устройств IoT Edge при наличии новой версии. 

Если вы хотите перейти на новую версию, вам необходимо обновить два компонента устройства IoT Edge. Первый компонент — управляющая программа безопасности, которая выполняется на устройстве и запускает модули среды выполнения при запуске устройства. В настоящее время обновить управляющую программу безопасности можно только на самом устройстве. Второй компонент — это среда выполнения, состоящая из модулей центра и агента IoT Edge. В зависимости от структуры развертывания среду выполнения можно обновить как на устройстве, так и удаленно. 

Последнюю версию Azure IoT Edge можно найти [на сайте GitHub](https://github.com/Azure/azure-iotedge/releases).

>[!IMPORTANT]
>Если вы используете Azure IoT Edge на устройстве Windows, не обновляйте его до версии 1.0.5, если к устройству применимо одно из следующих условий. 
>* Вы не обновили устройство до сборки Windows 17763. IoT Edge версии 1.0.5 не поддерживает сборки Windows ранее 17763.
>* Вы запускаете модули Java или Node.js на устройстве Windows. Пропустите версию 1.0.5, даже если вы обновили устройство Windows до последней сборки. 
>
>Дополнительные сведения об IoT Edge версии 1.0.5 см. в [заметках о выпуске 1.0.5](https://github.com/Azure/azure-iotedge/releases/tag/1.0.5). Дополнительные сведения о том, как предотвратить обновление до последней версии средства разработки, см. в разделе [Блог разработчиков Интернета вещей](https://devblogs.microsoft.com/iotdev/).


## <a name="update-the-security-daemon"></a>Обновление управляющей программы безопасности

Управляющая программа безопасности IoT Edge — это собственный компонент, который необходимо обновить с помощью диспетчера пакетов на устройстве IoT Edge. 

Проверьте версию управляющей программы безопасности, запущенной на вашем устройстве, с помощью команды `iotedge version`. 

### <a name="linux-devices"></a>Устройства Linux

На устройствах Linux x64 используйте apt-get или руководителю соответствующий пакет для обновления управляющей программы безопасности. 

```bash
apt-get update
apt-get install libiothsm iotedge
```

На устройствах Linux ARM32, следуйте инструкциям в [выполнения установки Azure IoT Edge в Linux (ARM32v7/armhf)](how-to-install-iot-edge-linux-arm.md) для установки последней версии управляющей программы безопасности. 

### <a name="windows-devices"></a>Устройства Windows

На устройствах Windows используйте сценарий PowerShell для обновления управляющей программы безопасности. Сценарий автоматически извлекает последнюю версию управляющей программы безопасности. 

```powershell
. {Invoke-WebRequest -useb aka.ms/iotedge-win} | Invoke-Expression; Update-IoTEdge -ContainerOs <Windows or Linux>
```

Выполнив команду Update-IoTEdge удаляет управляющую программу безопасности с устройства, а также два образа контейнеров среды выполнения. Файл config.yaml хранится на устройстве, а также данные из обработчика контейнеров Кита (Если вы используете контейнеры Windows). Сохранение означает сведения конфигурации, что у вас нет предоставить строку подключения и сведения о службе подготовки устройств для вашего устройства повторно во время процесса обновления. 

Если вы хотите установить определенную версию управляющую программу безопасности, загрузите нужный файл Microsoft-Azure-IoTEdge.cab из [IoT Edge освобождает](https://github.com/Azure/azure-iotedge/releases). Затем используйте параметр `-OfflineInstallationPath`, чтобы указать местоположение файла. Дополнительные сведения см. в статье [Автономная установка](how-to-install-iot-edge-windows.md#offline-installation).

## <a name="update-the-runtime-containers"></a>Обновление контейнеров среды выполнения

Способ, необходимо обновить агент IoT Edge и контейнеры концентратора IoT Edge зависит от того, использование последовательного тегов (например, 1.0) или конкретные теги (например, 1.0.7) в развертывании. 

Проверьте версию модулей агента и центра IoT Edge, используемую в настоящее время на вашем устройстве, с помощью команды `iotedge logs edgeAgent` или `iotedge logs edgeHub`. 

  ![Поиск версии контейнера в журналах](./media/how-to-update-iot-edge/container-version.png)

### <a name="understand-iot-edge-tags"></a>Сведения о тегах IoT Edge

Образы агента и центра IoT Edge отмечены тегами версии IoT Edge, с которой они связаны. Существует два способа использования тегов с образами среды выполнения: 

* **Последовательные теги**: используются только первые два значения номера версии для получения последнего образа, соответствующего этим цифрам. Например, 1.0 обновляется всякий раз, когда появляется новый выпуск, указывающий на последнюю версию 1.0.x. Если среда выполнения контейнера на устройстве IoT Edge снова извлекает образ, модули среды выполнения обновляются до последней версии. Такой подход рекомендуется использовать для разработки. Для развертываний с портала Azure по умолчанию установлены последовательные теги. 
* **Конкретные теги**: используются все три значения номера версии для явной установки версии образа. Например 1.0.7 не изменится после первого выпуска. Вы можете объявить новый номер версии в манифесте развертывания, когда будете готовы к обновлению. Такой подход рекомендуется использовать для производственных целей.

### <a name="update-a-rolling-tag-image"></a>Обновление образа последовательного тега

Если вы используете последовательные теги в своем развертывании (например, mcr.microsoft.com/azureiotedge-hub:**1.0**), вам необходимо принудительно запустить среду выполнения контейнера на устройстве, чтобы извлечь последнюю версию образа. 

Удалите локальную версию образа с устройства IoT Edge. На компьютерах Windows удаление управляющей программы безопасности приводит к удалению образов среды выполнения, поэтому не нужно снова выполнять этот шаг. 

```bash
docker rmi mcr.microsoft.com/azureiotedge-hub:1.0
docker rmi mcr.microsoft.com/azureiotedge-agent:1.0
```

Для удаления образов может потребоваться использовать флаг force `-f`. 

Служба IoT Edge извлечет последние версии образов среды выполнения и автоматически запустит их на вашем устройстве. 

### <a name="update-a-specific-tag-image"></a>Обновление образа конкретного тега

При использовании определенными тегами в развертывании (например, mcr.microsoft.com/azureiotedge-hub:**1.0.7**) затем необходимо выполнить всего обновите тег в манифесте развертывания и применения изменений к устройству. 

На портале Azure образы развертывания среды выполнения объявляются в разделе **Настройка дополнительных параметров среды выполнения Edge**. 

![Настройка параметров среды выполнения дополнительных edge](./media/how-to-update-iot-edge/configure-runtime.png)

В манифесте развертывания JSON обновите образы модулей в разделе **systemModules**. 

```json
"systemModules": {
  "edgeAgent": {
    "type": "docker",
    "settings": {
      "image": "mcr.microsoft.com/azureiotedge-agent:1.0.7",
      "createOptions": ""
    }
  },
  "edgeHub": {
    "type": "docker",
    "status": "running",
    "restartPolicy": "always",
    "settings": {
      "image": "mcr.microsoft.com/azureiotedge-hub:1.0.7",
      "createOptions": "{\"HostConfig\":{\"PortBindings\":{\"5671/tcp\":[{\"HostPort\":\"5671\"}], \"8883/tcp\":[{\"HostPort\":\"8883\"}],\"443/tcp\":[{\"HostPort\":\"443\"}]}}}"
    }
  }
},
```

## <a name="update-to-a-release-candidate-version"></a>Обновление до версии-кандидата

Azure IoT Edge регулярно выпускает новые версии службы IoT Edge. Перед каждой стабильный выпуск имеется один или несколько выпуска версии-кандидат (RC). Версии-КАНДИДАТА версии всех компонентов, запланированных для выпуска, но по-прежнему будет через тестирование и проверка процессов, необходимых для стабильный выпуск. Если вы хотите заранее проверить новую функцию, можно установить версию-КАНДИДАТ и отправить отзыв через GitHub. 

Релиз-кандидатах соответствуют тому же соглашению нумерации выпусков, но имеют **-rc** плюс в конце последовательным номером. Вы увидите релиз-кандидатов в тот же список [Edge Интернета вещей Azure освобождает](https://github.com/Azure/azure-iotedge/releases) как стабильные версии. Например, найти **1.0.7-rc1** и **1.0.7-rc2**, два выпуска кандидатов, которые ранее **1.0.7**. Также можно увидеть, что версии-КАНДИДАТА версии будут отмечены **предварительной версии** метки. 

В виде предварительных версий, релиз-кандидатах не включаются в качестве последней версии, целевой объект регулярного установщики. Вместо этого вам нужно вручную выбрать ресурсы для версию-КАНДИДАТ, который требуется проверить. В зависимости от операционной системы устройства IoT Edge следуйте приведенным ниже для обновления до определенной версии Edge Интернета вещей:

* [Linux X64](how-to-install-iot-edge-linux.md#install-a-specific-version)
* [Linux ARM32](how-to-install-iot-edge-linux-arm.md#install-a-specific-version)
* [Windows](how-to-install-iot-edge-windows.md#offline-installation)

## <a name="next-steps"></a>Дальнейшие действия

Ознакомьтесь с последними выпусками Azure IoT Edge [на сайте GitHub](https://github.com/Azure/azure-iotedge/releases).

Будьте в курсе последних обновлений и объявлений, просматривая блог, посвященный [Интернету вещей](https://azure.microsoft.com/blog/topics/internet-of-things/). 