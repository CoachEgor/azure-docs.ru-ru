---
title: Обновления версии Azure IoT Edge на устройствах | Документация Майкрософт
description: Сведения об обновлении устройства IoT Edge для запуска последних версий управляющей программы безопасности и среды выполнения IoT Edge
keywords: ''
author: kgremban
manager: philmea
ms.author: kgremban
ms.date: 11/19/2019
ms.topic: conceptual
ms.service: iot-edge
services: iot-edge
ms.openlocfilehash: f31dec1d654124f9071c01c0e5d033db4b65a1d3
ms.sourcegitcommit: 38b11501526a7997cfe1c7980d57e772b1f3169b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/22/2020
ms.locfileid: "76509671"
---
# <a name="update-the-iot-edge-security-daemon-and-runtime"></a>Обновление управляющей программы безопасности и среды выполнения IoT Edge

По мере выпуска службой IoT Edge новых версий необходимо обновить устройства IoT Edge, чтобы получить новейшие функции и улучшения безопасности. В этой статье представлены сведения об обновлении устройств IoT Edge при наличии новой версии.

Если вы хотите перейти на новую версию, вам необходимо обновить два компонента устройства IoT Edge. Первый компонент — управляющая программа безопасности, которая выполняется на устройстве и запускает модули среды выполнения при запуске устройства. В настоящее время обновить управляющую программу безопасности можно только на самом устройстве. Второй компонент — это среда выполнения, состоящая из модулей центра и агента IoT Edge. В зависимости от структуры развертывания среду выполнения можно обновить как на устройстве, так и удаленно.

Последнюю версию Azure IoT Edge можно найти [на сайте GitHub](https://github.com/Azure/azure-iotedge/releases).

## <a name="update-the-security-daemon"></a>Обновление управляющей программы безопасности

Управляющая программа безопасности IoT Edge — это собственный компонент, который необходимо обновить с помощью диспетчера пакетов на устройстве IoT Edge.

Проверьте версию управляющей программы безопасности, запущенной на вашем устройстве, с помощью команды `iotedge version`.

### <a name="linux-devices"></a>Устройства Linux

На устройствах Linux x64 используйте apt-get или соответствующий диспетчер пакетов, чтобы обновить управляющую программу безопасности.

```bash
apt-get update
apt-get install libiothsm iotedge
```

На устройствах Linux ARM32 выполните действия, описанные в статье [Установка среды выполнения Azure IOT EDGE в Linux (ARM32v7/армхф)](how-to-install-iot-edge-linux-arm.md) , чтобы установить последнюю версию управляющей программы безопасности.

### <a name="windows-devices"></a>Устройства Windows

На устройствах Windows используйте сценарий PowerShell для обновления управляющей программы безопасности. Сценарий автоматически извлекает последнюю версию управляющей программы безопасности.

```powershell
. {Invoke-WebRequest -useb aka.ms/iotedge-win} | Invoke-Expression; Update-IoTEdge -ContainerOs <Windows or Linux>
```

Выполнение команды Update-IoTEdge удаляет и обновляет управляющую программу безопасности с устройства, а также два образа контейнеров среды выполнения. Файл config. YAML хранится на устройстве, а также данные из подсистемы контейнеров значок Кита (если вы используете контейнеры Windows). Хранение сведений о конфигурации означает, что в процессе обновления не требуется повторно указывать строку подключения или сведения о службе подготовки устройств для устройства.

Если вы хотите установить определенную версию управляющей программы безопасности, скачайте соответствующий файл Микрософт-Азуре-иотедже. cab из [IOT Edge выпусков](https://github.com/Azure/azure-iotedge/releases). Затем используйте параметр `-OfflineInstallationPath`, чтобы указать местоположение файла. Дополнительные сведения см. в статье [Автономная установка](how-to-install-iot-edge-windows.md#offline-installation).

## <a name="update-the-runtime-containers"></a>Обновление контейнеров среды выполнения

Способ обновления IoT Edgeного агента и контейнера центра IoT Edge зависит от того, используются ли в развертывании чередующиеся Теги (например, 1,0) или определенные теги (например, 1.0.7).

Проверьте версию модулей агента и центра IoT Edge, используемую в настоящее время на вашем устройстве, с помощью команды `iotedge logs edgeAgent` или `iotedge logs edgeHub`.

  ![Поиск версии контейнера в журналах](./media/how-to-update-iot-edge/container-version.png)

### <a name="understand-iot-edge-tags"></a>Сведения о тегах IoT Edge

Образы агента и центра IoT Edge отмечены тегами версии IoT Edge, с которой они связаны. Существует два способа использования тегов с образами среды выполнения:

* **Последовательные теги**: используются только первые два значения номера версии для получения последнего образа, соответствующего этим цифрам. Например, 1.0 обновляется всякий раз, когда появляется новый выпуск, указывающий на последнюю версию 1.0.x. Если среда выполнения контейнера на устройстве IoT Edge снова извлекает образ, модули среды выполнения обновляются до последней версии. Такой подход рекомендуется использовать для разработки. Для развертываний с портала Azure по умолчанию установлены последовательные теги.

* **Конкретные теги**: используются все три значения номера версии для явной установки версии образа. Например, 1.0.7 не изменится после первоначального выпуска. Вы можете объявить новый номер версии в манифесте развертывания, когда будете готовы к обновлению. Такой подход рекомендуется использовать для производственных целей.

### <a name="update-a-rolling-tag-image"></a>Обновление образа последовательного тега

Если вы используете последовательные теги в своем развертывании (например, mcr.microsoft.com/azureiotedge-hub:**1.0**), вам необходимо принудительно запустить среду выполнения контейнера на устройстве, чтобы извлечь последнюю версию образа.

Удалите локальную версию образа с устройства IoT Edge. На компьютерах Windows удаление управляющей программы безопасности приводит к удалению образов среды выполнения, поэтому не нужно снова выполнять этот шаг.

```bash
docker rmi mcr.microsoft.com/azureiotedge-hub:1.0
docker rmi mcr.microsoft.com/azureiotedge-agent:1.0
```

Для удаления образов может потребоваться использовать флаг force `-f`.

Служба IoT Edge извлечет последние версии образов среды выполнения и автоматически запустит их на вашем устройстве.

### <a name="update-a-specific-tag-image"></a>Обновление образа конкретного тега

Если в развертывании используются определенные теги (например, mcr.microsoft.com/azureiotedge-hub:**1.0.8**), то все, что нужно сделать, — это обновить тег в манифесте развертывания и применить изменения к устройству.

1. В центре Интернета вещей в портал Azure выберите свое устройство IoT Edge и щелкните **задать модули**.

1. В разделе **модули IOT Edge** выберите **Параметры среды выполнения**.

   ![Настройка параметров среды выполнения](./media/how-to-update-iot-edge/configure-runtime.png)

1. В **параметрах среды выполнения**обновите значение **образа** для **концентратора ребра** , указав требуемую версию. Не выбирайте " **сохранить** " еще раз.

   ![Обновить версию образа концентратора ребра](./media/how-to-update-iot-edge/runtime-settings-edgehub.png)

1. Сверните параметры **концентратора ребра** или прокрутите вниз и обновите значение **образа** для **агента ребра** с той же требуемой версией.

   ![Обновление версии агента концентратора ребра](./media/how-to-update-iot-edge/runtime-settings-edgeagent.png)

1. Щелкните **Сохранить**.

1. Выберите **Проверка + создать**, проверьте развертывание и щелкните **создать**.

## <a name="update-to-a-release-candidate-version"></a>Обновление до версии-кандидата

Azure IoT Edge регулярно выпускает новые версии службы IoT Edge. Перед каждым стабильным выпуском есть одна или несколько версий версии-кандидата (RC). Версии RC включают все запланированные компоненты для выпуска, но все еще проверяют процессы тестирования и проверки, необходимые для стабильного выпуска. Если вы хотите протестировать новую функцию на раннем этапе, можно установить версию-кандидат и отправить отзыв через GitHub.

Версии-кандидаты соответствуют тем же правилам нумерации выпусков, но имеют значение **— RC** плюс добавочный номер, добавленный к концу. Кандидаты выпуска можно просмотреть в том же списке [Azure IOT Edge выпусках](https://github.com/Azure/azure-iotedge/releases) , что и стабильные версии. Например, найдите **1.0.7-RC1** и **1.0.7-RC2**, два кандидата выпуска, которые были выпущены до **1.0.7**. Также можно увидеть, что версии RC помечены метками **предварительной версии** .

В качестве предварительных версий версии-кандидата не входят в качестве последней версии, предназначенной для обычных установщиков. Вместо этого необходимо вручную ориентироваться на ресурсы для версии RC, которую требуется протестировать. В зависимости от операционной системы устройства IoT Edge используйте следующие разделы для обновления IoT Edge до определенной версии.

* [Linux](how-to-install-iot-edge-linux.md#install-a-specific-runtime-version)
* [Windows](how-to-install-iot-edge-windows.md#offline-installation)

## <a name="next-steps"></a>Дальнейшие действия

Ознакомьтесь с последними выпусками Azure IoT Edge [на сайте GitHub](https://github.com/Azure/azure-iotedge/releases).

Будьте в курсе последних обновлений и объявлений, просматривая блог, посвященный [Интернету вещей](https://azure.microsoft.com/blog/topics/internet-of-things/).
