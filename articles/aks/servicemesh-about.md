---
title: О сервисных сетках
description: Получите обзор сетки обслуживания, их архитектуры и возможностей, а также критерии, которые следует учитывать при выборе одного для развертывания.
author: paulbouwer
ms.topic: article
ms.date: 10/09/2019
ms.author: pabouwer
ms.openlocfilehash: eca49a3fac1ea0398ebe1d05bde20fbca3c81232
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "77594317"
---
# <a name="about-service-meshes"></a>О сервисных сетках

Сетка службы предоставляет такие возможности, как управление трафиком, устойчивость, политика, безопасность, сильная идентификация и наблюдательнысть ваших рабочих нагрузок. Ваше приложение отделяется от этих оперативных возможностей, и сетка службы перемещает их из слоя приложения и вплоть до слоя инфраструктуры.

## <a name="scenarios"></a>Сценарии

Вот некоторые из сценариев, которые могут быть включены для рабочих нагрузок при использовании сетки службы:

- **Шифрование всего трафика в кластере** - Включить взаимные TLS между указанными службами в кластере. Это может быть расширено до входа и выход на периметр сети. Обеспечивает безопасную по умолчанию опцию без изменений, необходимых для кода приложения и инфраструктуры.

- **Канарские и поэтапные развертывания** - Укажите условия для направления подмножества трафика в набор новых служб в кластере. При успешном испытании выпуска канарейки удалите условную горизм и постепенно увеличиваем% всего трафика на новый сервис. В конце концов весь трафик будет направлен на новую службу.

- **Управление трафиком и манипуляции** - Создайте политику на службе, которая будет оценивать ограничивать весь трафик версией службы определенного происхождения. Или политика, которая применяет стратегию повторная попытка к классам сбоев между указанными службами. Зеркало живого трафика для новых версий служб во время миграции или для отладки проблем. Впрыскивает неисправности между службами в тестовой среде для проверки устойчивости.

- **Наблюдение** - Получите представление о том, как ваши службы связаны трафиком, который течет между ними. Получение метрик, журналов и следов для всего трафика в кластере и входа/выхода. Добавьте в приложения возможности распределенного отслеживания.

## <a name="architecture"></a>Architecture

Сервисная сетка обычно состоит из плоскости управления и плоскости данных.

Самолет **управления** имеет ряд компонентов, поддерживающих управление сервисной сеткой. Это, как правило, включает интерфейс управления, который может быть uI или API. Также обычно будут компоненты, управляющие определениями правил и политики, определяющими, как сетка служб должна реализовывать определенные возможности. Существуют также компоненты, которые управляют аспектами безопасности, такими как сильная идентичность и сертификаты для mTLS. Сервисные сетки также, как правило, имеют компонент метрик или обметитель, который собирает и агрегирует метрики и телеметрию из рабочих нагрузок.

Плоскость **данных** обычно состоит из прокси, который прозрачно вводится в качестве колдовечного нагрузок. Этот прокси настроен для управления всем сетевым трафиком в стручках, содержащим рабочую нагрузку. Это позволяет настроить прокси для обеспечения безопасности трафика через mTLS, динамически маршрутного трафика, применения политик к трафику и сбора метрик и информации о отслеживании. 

![Типичная архитектура сервисной сетки](media/servicemesh/typical-architecture.png)

## <a name="capabilities"></a>Возможности

Каждая из сетк служб имеет естественную подгонку и фокусируется на поддержке конкретных сценариев, но обычно вы обнаружите, что большинство из них реализует ряд, если не все, следующих возможностей.

### <a name="traffic-management"></a>Управление движением 

- **Протокол** - слой 7 (http, grpc)
- **Динамическая реуктора -** условная, взвешивание, зеркальное отражение
- **Устойчивость** – тайм-ауты, повторы, выключатели
- **Политика** - контроль доступа, ограничения ставок, квоты
- **Тестирование** - инъекция неисправности

### <a name="security"></a>Безопасность

- **Шифрование** - mTLS, управление сертификатами, внешний CA
- **Сильная идентичность** - SPIFFE или аналогичный
- **Аут -** аутентификация, авторизация

### <a name="observability"></a>Наблюдение

- **Metrics** - золотые метрики, прометей, графана
- **Отслеживание** - следы между рабочими нагрузками
- **Трафик** - кластер, вход/выход

### <a name="mesh"></a>Сетка

- **Поддерживаемый Compute** - Kubernetes, виртуальные машины
- **Мультикластер** - шлюзы, федерация

## <a name="selection-criteria"></a>Критерии отбора

Прежде чем выбрать сервисную сетку, убедитесь, что вы понимаете ваши требования и причины установки сервисной сетки. Попробуйте задать следующие вопросы.

- **Достаточно ли контроллера Ingress для моих нужд?** - Иногда наличие такой возможности, как a/b тестирование или разделение трафика на входе, достаточно для поддержки требуемого сценария. Не добавляйте сложности в среду без каких-либо перевернутых.

- **Могут ли мои рабочие нагрузки и окружающая среда переносить дополнительные накладные расходы?** - Все дополнительные компоненты, необходимые для поддержки сервисной сетки, требуют дополнительных ресурсов, таких как cpu и память. Кроме того, все прокси и связанные с ними проверки политики добавляют задержку в трафик. Если у вас есть рабочие нагрузки, которые очень чувствительны к задержке или не могут предоставить дополнительные ресурсы для покрытия компонентов сетки службы, затем пересмотрите.

- **Является ли это дополнительным дополнением излишне?** - Если причина установки сервисной сетки заключается в том, чтобы получить возможность, которая не обязательно имеет решающее значение для бизнес-групп или оперативных групп, то подумайте, стоит ли дополнительная сложность установки, обслуживания и конфигурации.

- **Можно ли это принять в поэтапном подходе?** - Некоторые из сервисных сетей, которые предоставляют много возможностей, могут быть приняты в более поэтапном подходе. Установите только компоненты, необходимые для обеспечения вашего успеха. После того как вы более уверенно и дополнительные возможности необходимы, а затем изучить эти. Не поддавайтесь желанию установить *все* с самого начала.

Если после тщательного рассмотрения, вы решите, что вам нужна сетка службы, чтобы обеспечить необходимые возможности, то ваше следующее решение, *какая сетка службы?*

Рассмотрим следующие области и какие из них наиболее соответствуют вашим требованиям. Это поможет вам наилучшим образом подходят для вашей среды и рабочих нагрузок. Раздел [«Следующие шаги»](#next-steps) поможет вам более подробно рассказать о конкретных сетках обслуживания и о том, как они отображают карты в этих областях.

- **Техническое** - управление трафиком, политика, безопасность, наблюдаемость

- **Бизнес** - коммерческая поддержка, фонд (CNCF), лицензия OSS, управление

- **Операционные** - установка/обновление, требования к ресурсам, требования к производительности, интеграции (метрики, телеметрия, панели мониторинга, инструменты, SMI), смешанные рабочие нагрузки (пулы узлов Linux и Windows), вычисления (Kubernetes, виртуальные машины), мультикластер

- **Безопасность** - auth, удостоверение личности, управление сертификатом и ротация, pluggable внешний CA


## <a name="next-steps"></a>Дальнейшие действия

В следующей документации содержится дополнительная информация о сетках обслуживания, которые вы можете опробовать на сервисе Azure Kubernetes Service (AKS):

> [!div class="nextstepaction"]
> [Узнайте больше о Istio ...][istio-about]

> [!div class="nextstepaction"]
> [Узнайте больше о Linkerd ...][linkerd-about]

> [!div class="nextstepaction"]
> [Узнайте больше о Консул ...][consul-about]

Вы также можете изучить интерфейс службы сетки (SMI), стандартный интерфейс для сервисных сеток на Kubernetes:

- [Интерфейс сетки обслуживания (SMI)][smi]


<!-- LINKS - external -->
[smi]: https://smi-spec.io/

<!-- LINKS - internal -->
[istio-about]: ./servicemesh-istio-about.md
[linkerd-about]: ./servicemesh-linkerd-about.md
[consul-about]: ./servicemesh-consul-about.md