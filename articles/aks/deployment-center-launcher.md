---
title: Использование центра развертывания в службе приложений Azure
description: Центр развертывания в Azure DevOps упрощает настройку надежного конвейера Azure DevOps для вашего приложения
ms.author: puagarw
ms.manager: douge
ms.prod: devops
ms.technology: devops-cicd
ms.topic: tutorial
ms.date: 07/12/2019
author: pulkitaggarwl
monikerRange: vsts
ms.openlocfilehash: 8d1e467906b74c97c8b4f4e5c14af0814dd098f7
ms.sourcegitcommit: 470041c681719df2d4ee9b81c9be6104befffcea
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/12/2019
ms.locfileid: "67861518"
---
# <a name="deployment-center-launcher"></a>Средство запуска для центра развертывания

Центр развертывания в Azure DevOps упрощает настройку надежного конвейера DevOps для вашего приложения По умолчанию конвейер DevOps настроен для развертывания обновлений приложения в кластере Kubernetes. Вы можете расширить настроенный по умолчанию конвейер DevOps и добавить более широкие возможности DevOps: подтверждение перед развертыванием, настройку дополнительных ресурсов Azure, запуск сценариев, обновление приложения или даже запуск дополнительных проверочных тестов.

Изучив данный учебник, вы научитесь:

> [!div class="checklist"]
> * Настройка конвейера DevOps для развертывания обновлений вашего приложения в кластере K8S
> * Просмотр конвейера CI
> * Просмотр конвейера CD
> * Очистка ресурсов

## <a name="prerequisites"></a>Предварительные требования

* Подписка Azure. Вы можете получить бесплатную подписку с помощью [Visual Studio Dev Essentials](https://visualstudio.microsoft.com/dev-essentials/)

* Кластер службы Azure Kubernetes (AKS)

## <a name="create-aks-cluster"></a>Создание кластера AKS

1. Войдите в [портал Azure](https://portal.azure.com/)

1. Нажмите кнопку меню [Cloud Shell](https://docs.microsoft.com/azure/cloud-shell/overview) в правом верхнем углу окна портала Azure.

1. Чтобы создать кластер AKS, выполните следующие команды.

    ```cmd
    # The below command creates Resource Group in the south india location

    az group create --name azooaks --location southindia

    # The below command creates a cluster named azookubectl with one node. 

    az aks create --resource-group azooaks --name azookubectl --node-count 1 --enable-addons monitoring --generate-ssh-keys
    ```

## <a name="deploy-application-updates-to-k8s-cluster"></a>Развертывание обновлений приложений в кластере K8s

1. Перейдите к созданной выше группе ресурсов.

1. Выберите кластер AKS и щелкните **Центр развертывания (предварительная версия)** в разделе параметров колонки слева. Нажмите кнопку **Начало работы**.

   ![Параметры](media/deployment-center-launcher/settings.png)

1. Выберите расположение кода и нажмите кнопку **Далее**. В настоящее время поддерживаются репозитории **[Azure Repos](https://docs.microsoft.com/azure/devops/repos/index?view=azure-devops)** и **GitHub**. Вы можете выполнить приведенные ниже действия в зависимости от выбранного репозитория.

    Azure Repos — это набор средств управления версиями, которые можно использовать для управления кодом. Независимо от того, является ли проект вашего программного обеспечения большим или малым, рекомендуется как можно скорее использовать контроль версий.

    - **Azure Repos**. Выберите репозиторий из существующего проекта и организации.

        ![Azure Repos](media/deployment-center-launcher/azure-repos.gif)

    - **GitHub**. Авторизуйтесь и выберите репозиторий для учетной записи GitHub.

        ![GitHub](media/deployment-center-launcher/github.gif)


1. Мы собираемся анализировать репозиторий и обнаружить Dockerfile. Если вы хотите обновить его, можно изменить определенный номер порта.

    ![Параметры приложения](media/deployment-center-launcher/application-settings.png)

    Если репозиторий не содержит Dockerfile, система отобразит сообщение для фиксации. 

    ![Dockerfile](media/deployment-center-launcher/dockerfile.png)

1. Выберите или создайте существующий реестр контейнеров и нажмите кнопку **Готово**. Конвейер будет создан автоматически и встанет в очередь сборки в [Azure Pipelines](https://docs.microsoft.com/azure/devops/pipelines/index?view=azure-devops).

    Azure Pipelines — это облачная служба, которую можно использовать для автоматической сборки и тестирования проекта кода, а также предоставления доступа другим пользователям. Azure Pipelines сочетает непрерывную интеграцию (CI) и непрерывную доставку (CD) для постоянного и согласованного тестирования, а также создания кода и погрузки их в любой целевой объект.

    ![Реестр контейнеров](media/deployment-center-launcher/container-registry.png)

1. Щелкните по ссылке, чтобы просмотреть текущий конвейер.

1. После завершения установки вы увидите журналы успешной установки, как показано на рисунке.

    ![Журналы](media/deployment-center-launcher/logs.png)

## <a name="examine-the-ci-pipeline"></a>Просмотр конвейера CI

Центр развертывания настраивает конвейер CI/CD организации Azure DevOps автоматически. Конвейер можно исследовать и настраивать. 

1. Перейдите на панель мониторинга центра развертывания.  

1. Щелкните на номер сборки из списка успешных журналов, чтобы просмотреть конвейер сборки для проекта. 

1. Нажмите кнопку с многоточием (...) в правом верхнем углу. В меню отображается несколько опций, таких как постановка в очередь новой сборки, сохранение сборки и редактирование конвейера сборки. Выберите **Изменить конвейер**. 

1. На этой панели можно изучить различные задачи для конвейера сборки. Сборка выполняет различные задачи, такие как сбор источников из репозитория Git, создание образа, отправка образа в реестр контейнеров и публикация выходных данных, используемых для развертываний.

1. Выберите имя конвейера сборки в верхней части соответствующей области.

1. Замените имя конвейера сборки более понятным для себя, выберите **Save & queue** (Сохранить и поместить в очередь) и нажмите кнопку **Сохранить**.

1. Под именем конвейера сборки щелкните **Журнал**. В этой области отображается журнал аудита недавних изменений сборки. Azure DevOps отслеживает все изменения, внесенные в конвейер сборки, и позволяет сравнивать версии.

1. Выберите **Триггеры**. При необходимости ветви можно включать в процесс CI или исключать из него.

1. Выберите **Период удержания**. Вы можете указать политику сохранения или удаления нескольких сборок в зависимости от вашего сценария.

## <a name="examine-the-cd-pipeline"></a>Просмотр конвейера CD

Центр развертывания создает и настраивает автоматически необходимые действия из организации Azure DevOps в вашей подписке Azure. Эти действия включают настройку подключения к службе Azure для проверки подлинности подписки Azure с помощью Azure DevOps. Также автоматически создается конвейер выпуска, обеспечивающий непрерывное развертывание в Azure.

1. Выберите **Конвейеры**, а затем выберите **Выпуски**.

1. Чтобы изменить конвейер выпуска, нажмите кнопку **Правка**.

1. Выберите **Удалить** из **Артефакты**. Конвейер сборки, который вы изучали на предыдущих этапах, создает выходные данные для артефакта. 

1. Выберите переключатель **Непрерывное развертывание** справа от значка **Удалить**. В этом конвейере выпуска есть включенный триггер CD, который запускает развертывание каждый раз, когда доступен новый артефакт сборки. Опционально, вы можете отключить триггер, чтобы потребовать ручного выполнения установки.

1. Чтобы просмотреть все задачи для конвейера, щелкните **Задачи**. В выпуске задается среда, настраивается imagePullSecrets, устанавливаются средства Helm и развертываются диаграммы Helm в кластере K8s.

1. Чтобы просмотреть журнал выпусков, щелкните на **View releases** (Просмотр выпусков). 

1. Чтобы просмотреть сводку, щелкните **Release** (Выпуск). Щелкните на любой этап, чтобы просмотреть несколько меню, таких как сводка по выпуску, связанные рабочие элементы и тесты. 

1. Щелкните **Фиксации**. В этом представлении отображаются фиксации кода, связанные с этим развертыванием. Сравните выпуски, чтобы просмотреть различия между развертываниями.

1. Выберите **Журналы**. Журналы содержат полезные сведения о развертывании. Их можно просматривать во время и после развертывания.

## <a name="clean-up-resources"></a>Очистка ресурсов

Вы можете удалить связанные ресурсы, которые вы создали, когда они больше не нужны. Для этого воспользуйтесь функционалом удаления на панели мониторинга DevOps Projects.

## <a name="next-steps"></a>Дополнительная информация

Вы можете по желанию изменить эти конвейеры сборки и выпуска в соответствии с потребностями вашей команды. Вы также можете использовать этот шаблон CI/CD в качестве шаблона для других конвейеров. Из этого руководства вы узнали, как выполнить следующие задачи:

> [!div class="checklist"]
> * Настройка конвейера DevOps для развертывания обновлений вашего приложения в кластере K8S
> * Просмотр конвейера CI
> * Просмотр конвейера CD
> * Очистка ресурсов
