---
title: Основные понятия доступа и идентификации в Службе Azure Kubernetes (AKS)
description: Узнайте о доступе и идентификации в Службе Azure Kubernetes (AKS), включая интеграцию Azure Active Directory, управление доступом на основе ролей (RBAC) Kubernetes, роли и привязки.
services: container-service
ms.topic: conceptual
ms.date: 02/28/2019
ms.openlocfilehash: e4945535417f7d8d33308121267ba97e1f835e13
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "79259608"
---
# <a name="access-and-identity-options-for-azure-kubernetes-service-aks"></a>Возможности контроля доступа и идентификации в Службе Azure Kubernetes (AKS)

Существуют различные способы аутентификации доступа к кластерам Kubernetes и их защиты. Используя управление доступом на основе ролей (RBAC), вы можете предоставить пользователям или группам доступ только к ресурсам, которые им необходимы. С помощью Службы Kubernetes Azure (AKS) можно дополнительно улучшить структуру безопасности и разрешений, используя Azure Active Directory. Эти подходы помогают защитить рабочие нагрузки приложений и данные клиентов.

В этой статье рассматриваются основные понятия, которые помогут настроить аутентификацию и назначить разрешения в AKS:

- [учетные записи службы Kubernetes (AKS)](#kubernetes-service-accounts);
- [Интеграция активных каталогов Azure](#azure-active-directory-integration)
- [управление доступом на основе ролей (RBAC)](#role-based-access-controls-rbac);
- [Элементы Role и ClusterRole](#roles-and-clusterroles)
- [элементы RoleBinding и ClusterRoleBinding](#rolebindings-and-clusterrolebindings).

## <a name="kubernetes-service-accounts"></a>Учетные записи службы Kubernetes

Одним из основных типов пользователя в Kubernetes является *учетная запись службы*. Учетная запись службы существует в API Kubernetes. Этот же API используется для управлению ею. Учетные данные для учетных записей службы хранятся в виде секретов Kubernetes, что позволяет использовать их авторизованным элементам pod для взаимодействия с сервером API. Большинство запросов к API содержат маркер аутентификации для учетной записи службы или обычной учетной записи пользователя.

Обычные учетные записи пользователя обеспечивают более традиционный доступ администраторов или разработчиков, а не только служб и процессов. Kubernetes сама по себе не предоставляет решение для управления идентификацией, в котором хранятся обычные учетные записи пользователей и пароли. Подобные внешние решения по управлению удостоверениями могут интегрироваться в Kubernetes. Для кластеров AKS таким интегрированным решением по управлению удостоверениями является Azure Active Directory.

Дополнительные сведения о возможностях идентификации в Kubernetes см. в разделе об [аутентификации Kubernetes][kubernetes-authentication].

## <a name="azure-active-directory-integration"></a>Интеграция Azure Active Directory

Безопасность кластеров AKS можно повысить благодаря интеграции Azure Active Directory (AD). Azure AD — это мультитенантный облачный каталог и служба управления удостоверениями, созданные после десятилетий разработки корпоративных решений по управлению удостоверениями. В этом решении объединены базовые службы каталогов, функции управления доступом к приложениям и защита идентификации. С помощью Azure AD можно интегрировать локальные удостоверения в кластеры AKS, чтобы обеспечить централизованную защиту учетных записей и управление ими.

![Интеграция Azure Active Directory с кластерами AKS](media/concepts-identity/aad-integration.png)

При использовании кластеров Azure AKS, интегрированных с Azure AD, можно предоставить пользователям или группам доступ к ресурсам Kubernetes, размещенным в определенном пространстве имен или кластере. Для получения контекста конфигурации `kubectl` пользователь может выполнить команду [az aks get-credentials][az-aks-get-credentials]. Когда после этого пользователь будет взаимодействовать с кластером AKS с помощью `kubectl`, ему будет предложено войти с учетными данными Azure AD. Такой подход обеспечивает единый источник для управления учетными записями пользователя и хранения паролей. Пользователь имеет доступ только к ресурсам, определенным администратором кластера.

Для аутентификации Azure AD в кластерах AKS используется OpenID Connect — уровень идентификации, созданный на основе протокола OAuth 2.0. Протокол OAuth 2.0 определяет механизмы получения и использования маркеров доступа для обращения к защищенным ресурсам. OpenID Connect реализует функции аутентификации в качестве расширения процесса авторизации OAuth 2.0. Дополнительные сведения об OpenID Connect см. в [документации по OpenID Connect][openid-connect]. Для проверки маркеров аутентификации, полученных из Azure AD с помощью OpenID Connect, кластеры AKS используют аутентификацию маркеров с помощью веб-перехватчика Kubernetes. Дополнительные сведения см. в [документации по аутентификации маркеров с помощью веб-перехватчика][webhook-token-docs].

## <a name="role-based-access-controls-rbac"></a>Управление доступом на основе ролей (RBAC)

Чтобы обеспечить детализированную фильтрацию действий, которые могут выполнять пользователи, Kubernetes применяет управление доступом на основе ролей (RBAC). Этот механизм управления позволяет назначить пользователям или группам пользователей разрешение на выполнение каких-либо действий. Это может быть создание или изменение ресурсов, просмотр журналов выполнения рабочих нагрузок приложений и т. п. Эти разрешения могут охватывать отдельное пространство имен или весь кластер AKS. Благодаря управлению доступом на основе ролей Kubernetes можно создать *роли*, чтобы определить разрешения, и затем назначить эти роли пользователям с помощью *привязок ролей*.

Дополнительные сведения см. в статье об [Использовании авторизации RBAC][kubernetes-rbac].

### <a name="azure-role-based-access-controls-rbac"></a>Управление доступом на основе ролей (RBAC) Azure
Еще одним механизмом для управления доступом к ресурсам является управление доступом на основе ролей Azure. Управление доступом на основе ролей Kubernetes предназначено для работы с ресурсами в кластере AKS, а управление доступом на основе ролей Azure — для работы с ресурсами в подписке Azure. С помощью управления доступом на основе ролей Azure можно создать *определение роли*, описывающее предоставляемые разрешения. Затем пользователю или группе назначается это определение роли для какой-либо *области*. Это может быть отдельный ресурс, группа ресурсов или подписка.

Дополнительные сведения см. в статье [Что такое управление доступом на основе ролей (RBAC)?][azure-rbac]

## <a name="roles-and-clusterroles"></a>Элементы Role и ClusterRole

Прежде чем назначить пользователям разрешения с помощью управления доступом на основе ролей Kubernetes, необходимо определить эти разрешения как элемент *Role*. Роли Kubernetes *предоставляют* разрешения. Понятие *запрещения* разрешения отсутствует.

Роли используются для предоставления разрешений в пространстве имен. Если вам нужно предоставить разрешения для доступа во всем кластере или для доступа к кластерным ресурсам за пределами данного пространства имен, вместо этого можно использовать элементы *ClusterRole*.

Элемент ClusterRole действует аналогичным образом, предоставляя разрешения для ресурсов, но его можно применить к ресурсам в пределах всего кластера, не в определенном пространстве имен.

## <a name="rolebindings-and-clusterrolebindings"></a>Элементы RoleBinding и ClusterRoleBinding

После определения ролей, предоставляющих разрешения для ресурсов, можно назначить эти разрешения RBAC Kubernetes с помощью элемента *RoleBinding*. Если кластер AKS интегрирован с Azure Active Directory, привязки определяют способ предоставления пользователям Azure AD разрешений для выполнения действий в кластере.

Привязки роли используются для назначения ролей для определенного пространства имен. Такой подход позволяет логически разделить отдельный кластер AKS, предоставив пользователям доступ только к ресурсам приложений в назначенных им пространствах имен. Если вам нужно привязать роли для доступа во всем кластере или для доступа к кластерным ресурсам за пределами данного пространства имен, вместо этого можно использовать элементы *ClusterRoleBinding*.

Элемент ClusterRoleBinding действует аналогичным образом, привязывая роли к пользователям, но его можно применить к ресурсам в пределах всего кластера, а не в определенном пространстве имен. Такой подход позволяет предоставить администраторам или инженерам службы поддержки доступ ко всем ресурсам в кластере AKS.

## <a name="next-steps"></a>Дальнейшие действия

Чтобы приступить к работе с Azure AD и управлению доступом на основе ролей Kubernetes, ознакомьтесь с разделом [Интеграция Azure Active Directory со службой Azure Kubernetes][aks-aad].

Для связанных с [Best practices for authentication and authorization in AKS][operator-best-practices-identity]этим рекомендаций см.

Дополнительные сведения о ключевых концепциях Kubernetes и AKS вы получите в следующих статьях:

- [Кластеры и рабочие нагрузки Kubernetes и AKS][aks-concepts-clusters-workloads]
- [Безопасность Kubernetes и AKS][aks-concepts-security]
- [Виртуальные сети Kubernetes и AKS][aks-concepts-network]
- [Хранилище Kubernetes и AKS][aks-concepts-storage]
- [Масштабирование Kubernetes и AKS][aks-concepts-scale]

<!-- LINKS - External -->
[kubernetes-authentication]: https://kubernetes.io/docs/reference/access-authn-authz/authentication
[webhook-token-docs]: https://kubernetes.io/docs/reference/access-authn-authz/authentication/#webhook-token-authentication
[kubernetes-rbac]: https://kubernetes.io/docs/reference/access-authn-authz/rbac/

<!-- LINKS - Internal -->
[openid-connect]: ../active-directory/develop/v2-protocols-oidc.md
[az-aks-get-credentials]: /cli/azure/aks#az-aks-get-credentials
[azure-rbac]: ../role-based-access-control/overview.md
[aks-aad]: azure-ad-integration-cli.md
[aks-concepts-clusters-workloads]: concepts-clusters-workloads.md
[aks-concepts-security]: concepts-security.md
[aks-concepts-scale]: concepts-scale.md
[aks-concepts-storage]: concepts-storage.md
[aks-concepts-network]: concepts-network.md
[operator-best-practices-identity]: operator-best-practices-identity.md
