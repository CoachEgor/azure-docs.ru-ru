---
title: 'Сбой запроса цифрового двойников для Azure с состоянием: 403 (запрещено)'
description: 'Причины и способы устранения ошибки запроса на обслуживание. Состояние: 403 (запрещено) "в Azure Digital двойников.'
ms.service: digital-twins
author: baanders
ms.author: baanders
ms.topic: troubleshooting
ms.date: 7/20/2020
ms.openlocfilehash: bc4fbbc265bef00be27c890c3f090a49591dc415
ms.sourcegitcommit: 6e1124fc25c3ddb3053b482b0ed33900f46464b3
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/15/2020
ms.locfileid: "90562746"
---
# <a name="service-request-failed-status-403-forbidden"></a>Сбой запроса на обслуживание. Состояние: 403 (запрещено)

В этой статье описываются причины и способы устранения ошибки 403 от запросов на обслуживание к Azure Digital двойников. 

## <a name="symptoms"></a>Симптомы

Эта ошибка может возникать во многих типах запросов на обслуживание, требующих проверки подлинности. Таким результатом является сбой запроса API, возвращающего состояние ошибки `403 (Forbidden)` .

## <a name="causes"></a>Причины

### <a name="cause-1"></a>Причина #1

Чаще всего эта ошибка означает, что разрешения на управление доступом на основе ролей (RBAC) для службы настроены неправильно. Во многих действиях для экземпляра Digital двойников Azure требуется роль *владельца Azure Digital двойников (Предварительная версия)* **на экземпляре, которым вы пытаетесь управлять**. 

### <a name="cause-2"></a>Причина #2

Если вы используете клиентское приложение для обмена данными с цифровым двойников Azure, эта ошибка может возникать из-за того, что для регистрации приложения [Azure Active Directory (Azure AD)](../active-directory/fundamentals/active-directory-whatis.md) не настроены разрешения для службы Digital двойников Azure.

Для регистрации приложения требуются разрешения на доступ, настроенные для API цифровых двойников Azure. Затем, когда клиентское приложение пройдет проверку подлинности для регистрации приложения, ему будут предоставлены разрешения, настроенные для регистрации приложения.

## <a name="solutions"></a>Решения

### <a name="solution-1"></a>#1 решения

Первое решение заключается в том, чтобы убедиться, что у пользователя Azure есть роль _**владельца Azure Digital двойников (Предварительная версия)**_ на экземпляре, которым вы пытаетесь управлять. Если у вас нет этой роли, настройте ее.

Обратите внимание, что эта роль отличается от...
* роль *владельца* для всей подписки Azure. *Владелец Azure Digital двойников (Предварительная версия)* — это роль в Azure Digital двойников. она ограничивается этим отдельным экземпляром Azure Digital двойников.
* роль *владельца* в Azure Digital двойников. Это две отдельные роли управления цифровыми двойников Azure, а *владелец Azure Digital двойников (Предварительная версия)* — это роль, которую следует использовать для управления во время предварительной версии.

#### <a name="check-current-setup"></a>Проверка текущей установки

[!INCLUDE [digital-twins-setup-verify-role-assignment.md](../../includes/digital-twins-setup-verify-role-assignment.md)]

#### <a name="fix-issues"></a>Устранение проблем 

Если эта роль не назначена, то кто-то с ролью владельца в вашей **подписке Azure** должен выполнить следующую команду, чтобы предоставить пользователю Azure роль *владельца цифрового двойников Azure (Предварительная версия)* в **экземпляре Azure Digital двойников**. 

Если вы являетесь владельцем подписки, вы можете выполнить эту команду самостоятельно. Если это не так, обратитесь к владельцу, чтобы выполнить эту команду от вашего имени.

```azurecli
az dt role-assignment create --dt-name <your-Azure-Digital-Twins-instance> --assignee "<your-Azure-AD-email>" --role "Azure Digital Twins Owner (Preview)"
```

Дополнительные сведения об этом требовании роли и процессе назначения см. в разделе [ *Настройка разрешений доступа пользователя* статьи](how-to-set-up-instance-CLI.md#set-up-user-access-permissions) *инструкции. Настройка экземпляра и проверки подлинности (CLI или портал)*.

Если у вас уже есть такое назначение роли и по-прежнему возникает проблема 403, перейдите к следующему решению.

### <a name="solution-2"></a>#2 решения

Второе решение — убедиться, что регистрация приложения Azure AD имеет разрешения, настроенные для службы Digital двойников. Если она не настроена, настройте их.

#### <a name="check-current-setup"></a>Проверка текущей установки

[!INCLUDE [digital-twins-setup-verify-app-registration-1.md](../../includes/digital-twins-setup-verify-app-registration-1.md)]

Сначала убедитесь, что параметры разрешений Azure Digital двойников были правильно установлены для регистрации. Для этого в строке меню выберите *Манифест* , чтобы просмотреть код манифеста регистрации приложения. Прокрутите окно кода вниз и найдите эти поля в разделе `requiredResourceAccess` . Значения должны соответствовать приведенным на снимке экрана ниже:

[!INCLUDE [digital-twins-setup-verify-app-registration-2.md](../../includes/digital-twins-setup-verify-app-registration-2.md)]

#### <a name="fix-issues"></a>Устранение проблем

Если какой-либо из них отличается от описанного выше, следуйте инструкциям в разделе Настройка регистрации приложения [статьи *Настройка разрешений доступа для клиентских приложений* раздела](how-to-set-up-instance-cli.md#set-up-access-permissions-for-client-applications) *инструкции. Настройка экземпляра и проверки подлинности (CLI или портал)*.

## <a name="next-steps"></a>Дальнейшие действия

Ознакомьтесь с шагами по настройке создания и аутентификации нового экземпляра Digital двойников в Azure.
* [*Пошаговое руководство. Настройка экземпляра и проверки подлинности (CLI)*](how-to-set-up-instance-cli.md)

Дополнительные сведения о безопасности и разрешениях для Azure Digital двойников:
* [*Основные понятия: безопасность решений для цифровых двойников Azure*](concepts-security.md)