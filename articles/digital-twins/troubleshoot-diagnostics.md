---
title: Настройка диагностики
titleSuffix: Azure Digital Twins
description: См. раздел Включение ведения журнала с помощью параметров диагностики.
author: baanders
ms.author: baanders
ms.date: 7/28/2020
ms.topic: troubleshooting
ms.service: digital-twins
ms.openlocfilehash: 5091edbf9138cb8ff03df193dcbeed692aaf13e3
ms.sourcegitcommit: cd0a1ae644b95dbd3aac4be295eb4ef811be9aaa
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/19/2020
ms.locfileid: "88612407"
---
# <a name="troubleshooting-azure-digital-twins-diagnostics-logging"></a>Устранение неполадок в Azure Digital двойников: ведение журнала диагностики

Azure Digital двойников собирает [метрики](troubleshoot-metrics.md) для экземпляра службы, которые предоставляют сведения о состоянии ресурсов. Эти метрики можно использовать для оценки общей работоспособности службы цифровых двойников Azure и подключенных к ней ресурсов. Эти статистические данные позволяют увидеть, что происходит с цифровым двойников Azure и помогает выполнять анализ основных причин проблем без необходимости обращения в службу поддержки Azure.

В этой статье показано, как включить **ведение журнала диагностики** для данных метрик из вашего экземпляра Azure Digital двойников. Эти журналы можно использовать для устранения неполадок, связанных со службами, и настройки параметров диагностики для отправки метрик Digital двойников в разные места назначения. Дополнительные сведения об этих параметрах см. в статье [*Создание параметров диагностики для отправки журналов платформы и метрик в разные места назначения*](../azure-monitor/platform/diagnostic-settings.md).

## <a name="turn-on-diagnostic-settings-with-the-azure-portal"></a>Включение параметров диагностики с помощью портал Azure

Вот как включить параметры диагностики для своего экземпляра Azure Digital двойников:

1. Войдите в [портал Azure](https://portal.azure.com) и перейдите к своему экземпляру Azure Digital двойников. Его можно найти, введя его имя на панели поиска портала. 

2. Выберите **параметры диагностики** в меню и **добавьте параметр диагностики**.

    :::image type="content" source="media/troubleshoot-diagnostics/diagnostic-settings.png" alt-text="Снимок экрана со страницей параметров диагностики и кнопкой Добавить":::

3. На следующей странице введите следующие значения:
     * **Имя параметра диагностики**: задайте имя для параметров диагностики.
     * **Сведения о категории**: выберите операции, которые требуется отслеживать, и установите флажки, чтобы включить диагностику для этих операций. Ниже перечислены операции, для которых доступны параметры диагностики:
        - дигиталтвинсоператион
        - евентраутесоператион
        - моделсоператион
        - Queryoperation класса DataService
        - AllMetrics
        
        Дополнительные сведения об этих параметрах см. в разделе [*сведения о категории*](#category-details) ниже.
     * **Сведения о назначении**: выберите, куда вы хотите отправить журналы. Можно выбрать любое сочетание трех параметров:
        - Отправка в Log Analytics
        - "Архивировать в учетной записи хранения";
        - "Передать в концентратор событий";

        Возможно, вам будет предложено ввести дополнительные сведения, если они необходимы для выбора назначения.  
    
4. Сохраните новые настройки. 

    :::image type="content" source="media/troubleshoot-diagnostics/diagnostic-settings-details.png" alt-text="Снимок экрана со страницей параметров диагностики и кнопкой Добавить":::

Новые параметры вступят в силу в течение 10 минут. После этого журналы отобразятся на настроенном целевом объекте на странице **параметры диагностики** для вашего экземпляра. 

## <a name="category-details"></a>Сведения о категории

Ниже приведены дополнительные сведения о категориях журналов, которые можно выбрать в разделе **сведения о категории** при настройке параметров диагностики.

| Категория журнала | Описание |
| --- | --- |
| адтмоделсоператион | Регистрировать все вызовы API, относящиеся к моделям |
| адткуерйоператион | Регистрировать все вызовы API, относящиеся к запросам |
| адтевентраутесоператион | Регистрация всех вызовов API, относящихся к маршрутам событий, а также выхода событий из Azure Digital двойников в службу конечной точки, например "Сетка событий", "концентраторы событий" и "служебная шина" |
| адтдигиталтвинсоператион | Регистрация всех вызовов API, относящихся к Azure Digital двойников |

Каждая категория журнала состоит из операций записи, чтения, удаления и действия.  Эти данные сопоставляются с REST API вызовами следующим образом:

| Тип события | REST API операции |
| --- | --- |
| запись | РАЗМЕЩЕНИЕ и исправление |
| Чтение | GET |
| DELETE | DELETE |
| Действие | POST |

Ниже приведен полный список операций и соответствующих [вызовов Azure Digital двойников REST API](https://docs.microsoft.com/rest/api/azure-digitaltwins/) , зарегистрированных в каждой категории. 

>[!NOTE]
> Каждая категория журнала содержит несколько операций или вызовов REST API. В приведенной ниже таблице каждая категория журналов сопоставляется со всеми операциями и REST API находящиеся под ней вызовы до тех пор, пока не появится следующая категория журнала. 

| Категория журнала | Операция | REST APIные вызовы и другие события |
| --- | --- | --- |
| адтмоделсоператион | Microsoft. Дигиталтвинс/Models/Write | API обновления моделей цифровых двойника |
|  | Microsoft. Дигиталтвинс/Models/Read | Цифровые двойника модели Get по идентификаторам API-интерфейсам ID и List |
|  | Microsoft. Дигиталтвинс/Models/Delete | API удаления моделей Digital двойника |
|  | Microsoft. Дигиталтвинс/Models/Action | Добавление API цифровых двойника моделей |
| адткуерйоператион | Microsoft. Дигиталтвинс/запрос/действие | API двойников запросов |
| адтевентраутесоператион | Microsoft. Дигиталтвинс/евентраутес/запись | API добавления маршрутов событий |
|  | Microsoft. Дигиталтвинс/евентраутес/Read | Маршруты событий получают интерфейсы API идентификаторов и списков |
|  | Microsoft. Дигиталтвинс/евентраутес/Delete | API удаления маршрутов событий |
|  | Microsoft. Дигиталтвинс/евентраутес/действие | Сбой при попытке публикации событий в службе конечной точки (не вызове API) |
| адтдигиталтвинсоператион | Microsoft. Дигиталтвинс/дигиталтвинс/запись | Цифровой двойников Добавление, Добавление связи, обновление, обновление компонента |
|  | Microsoft. Дигиталтвинс/дигиталтвинс/Read | Digital двойников получает по идентификатору, получение компонента, получение отношения по идентификатору, список входящих отношений, список отношений |
|  | Microsoft. Дигиталтвинс/дигиталтвинс/Delete | Цифровые двойников удаление, удаление связи |
|  | Microsoft. Дигиталтвинс/дигиталтвинс/действие | Отправка данных телеметрии компонента Digital двойников, отправка данных телеметрии |

## <a name="next-steps"></a>Дальнейшие действия

* Дополнительные сведения о настройке диагностики см. в статье [*Получение и использование данных журнала из ресурсов Azure*](../azure-monitor/platform/platform-logs-overview.md).
* Сведения о метриках цифровых двойников Azure см. в разделе [*Устранение неполадок: Просмотр метрик с помощью Azure Monitor*](troubleshoot-metrics.md).
* Сведения о том, как включить оповещения для метрик, см. в разделе [*Устранение неполадок: Настройка оповещений*](troubleshoot-alerts.md).
