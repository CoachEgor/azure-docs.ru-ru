---
title: Изучение примера сценария
titleSuffix: Azure Digital Twins
description: Используйте пример ADT Explorer для визуализации и изучения предварительно построенного сценария.
author: baanders
ms.author: baanders
ms.date: 8/12/2020
ms.topic: quickstart
ms.service: digital-twins
ms.openlocfilehash: bbb1378419c68db07be5ca14ca6834810f2fc9f5
ms.sourcegitcommit: 420c30c760caf5742ba2e71f18cfd7649d1ead8a
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/28/2020
ms.locfileid: "89055470"
---
# <a name="explore-a-sample-azure-digital-twins-scenario-using-adt-explorer"></a>Изучите пример сценария Azure Digital Twins с помощью ADT Explorer

С помощью Azure Digital Twins можно создавать модели реальных сред и взаимодействовать с ними. Для этого нужно смоделировать отдельные элементы как **цифровые двойников**, а затем подключить их к **графу** набора знаний, который может отвечать на события в реальном времени и запрашивать информацию.

В этом кратком руководстве вы изучите предварительно созданную диаграмму Azure Digital Twins с помощью примера приложения, которое называется [**Azure Digital Twins (ADT) Explorer**](https://docs.microsoft.com/samples/azure-samples/digital-twins-explorer/digital-twins-explorer/). ADT Explorer позволяет отправлять сценарии, просматривать визуальные представления двойников и графа, а также выполнять другие действия по управлению с помощью визуального браузерного интерфейса.

Краткое руководство содержит следующие основные шаги.

1. Настройка экземпляра Azure Digital Twins и ADT Explorer
1. Отправка предварительно построенных моделей и данных графа для создания примера сценария
1. Изучение созданного графа сценария
1. Внесение изменений в граф

Пример графа, с которым вы будете работать, представляет собой здание с двумя этажами и двумя комнатами. Граф будет выглядеть так:

:::image type="content" source="media/quickstart-adt-explorer/graph-view-full.png" alt-text="Представление графа, состоящее из четырех циклических узлов, соединенных стрелками. Окружность с меткой Этаж1 соединена стрелкой с меткой содержит и окружностью с меткой Комната1; окружность с меткой Этаж0 соединена стрелкой с меткой содержит и окружностью с меткой Комната0. Этаж1 и Этаж0 не подключены.":::

## <a name="prerequisites"></a>Предварительные требования

Для работы с этим кратким руководством вам требуется подписка Azure. Если у вас его еще нет, **[создайте его бесплатно](https://azure.microsoft.com/free/?WT.mc_id=A261C142F)** прямо сейчас.

Перед началом работы с кратким руководством вам потребуется загрузить два примера:
* Пример приложения **ADT Explorer**. Этот пример содержит основное приложение, которое используется в кратком руководстве для загрузки и изучения сценария Azure Digital Twins. Чтобы получить приложение, перейдите по этой ссылке: [Azure Digital Twins (ADT) Explorer](https://docs.microsoft.com/samples/azure-samples/digital-twins-explorer/digital-twins-explorer/). Нажмите кнопку *Download ZIP* (Загрузить ZIP-файл), чтобы загрузить файл *ZIP* этого примера кода на свой компьютер с именем _**ADT_Explorer.zip**_.
* **Пример сценария Azure Digital Twins**. Содержит предварительно созданный граф Azure Digital Twins, который будет загружен в ADT Explorer для работы с ним. Чтобы получить сценарий, перейдите по этой ссылке: [Azure Digital Twins samples](https://docs.microsoft.com/samples/azure-samples/digital-twins-samples/digital-twins-samples). Нажмите кнопку *Download ZIP* (Загрузить ZIP-файл), чтобы загрузить файл *ZIP* этого примера кода на свой компьютер с именем _**Azure_Digital_Twins_samples.zip**_.

## <a name="set-up-azure-digital-twins-and-adt-explorer"></a>Настройка Azure Digital Twins и ADT Explorer

Первым шагом в работе с Azure Digital Twins является настройка **экземпляра Azure Digital Twins**. После создания экземпляра службы вы сможете заполнять ее с примерами данных позже в кратком руководстве.

Вы также настроите разрешения для запуска ADT Explorer на компьютере и получите доступ к экземпляру Azure Digital Twins. После этого пример приложения можно использовать для изучения экземпляра и его данных.

### <a name="set-up-azure-digital-twins-instance"></a>Настройка экземпляра Azure Digital Twins

Самый простой способ настроить экземпляр и необходимую проверку подлинности — запустить пример сценария автоматического развертывания. Следуйте инструкциям в [*Практическое руководство. Настройка экземпляра и проверки подлинности (с использованием скрипта)* ](how-to-set-up-instance-scripted.md). В этих инструкциях также указано, как проверить, успешно ли завершен каждый шаг и готов ли новый экземпляр к работе.

В этом кратком руководстве потребуются следующие значения, заданные при настройке экземпляра. Если вам нужно снова собрать эти значения, воспользуйтесь приведенными ниже ссылками в соответствующих разделах статьи о настройке, чтобы найти их на [портале Azure](https://portal.azure.com).
* **_Имя узла_** экземпляра Azure Digital Twins ([как найти на портале](how-to-set-up-instance-portal.md#verify-success-and-collect-important-values)).
* **_Идентификатор приложения (клиента)_** для регистрации приложения в Azure AD ([как найти на портале](how-to-set-up-instance-portal.md#collect-important-values)).
* **_Идентификатор каталога (арендатора)_** для регистрации приложения в Azure AD ([как найти на портале](how-to-set-up-instance-portal.md#collect-important-values)).

### <a name="set-adt-explorer-permissions"></a>Настройка разрешений ADT Explorer

Затем подготовьте созданный вами экземпляр Azure Digital Twins для работы с ADT Explorer, который является локально размещенным веб-приложением. Перейдите на страницу [Регистрация приложения](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/RegisteredApps) на портале Azure и выберите имя своей регистрации приложения в списке.

В меню регистрации выберите *Аутентификация* и нажмите кнопку *Добавить платформу*.

:::image type="content" source="media/quickstart-adt-explorer/authentication-pre.png" alt-text="Страница портала Azure в сведениях о проверке подлинности для регистрации приложения. Кнопка Добавить платформу выделена" lightbox="media/quickstart-adt-explorer/authentication-pre.png":::

Далее, на странице *Настройка платформы* выберите *Интернет*.
Заполните сведения о конфигурации следующим образом:
* **URI перенаправления**: Добавление URI перенаправления *http://localhost:3000* .
* **Неявное разрешение**: Установите флажок *Маркеры доступа*.

:::row:::
    :::column:::
        :::image type="content" source="media/quickstart-adt-explorer/authentication-configure-web.png" alt-text="Страница Настройка платформы, на которой выделены сведения, описанные на экране выше":::
    :::column-end:::
    :::column:::
    :::column-end:::
:::row-end:::

Нажмите кнопку *Настроить*, чтобы завершить процесс.

Теперь у вас есть интернет-конфигурация, настроенная для использования в ADT Explorer. Это должно отобразиться на вкладке "Аутентификация" на портале Azure.

:::image type="content" source="media/quickstart-adt-explorer/authentication-post.png" alt-text="Страница портала Azure в сведениях о проверке подлинности для регистрации приложения. Выделенный раздел Интернет платформы с URI перенаправления http://localhost:3000 и включенные маркеры доступа в разделе Неявное предоставление разрешения":::

### <a name="run-and-configure-adt-explorer"></a>Запуск и настройка ADT Explorer

Затем запустите приложение ADT Explorer и настройте его для своего экземпляра Azure Digital Twins.

Перейдите к папке с загруженным файлом _**ADT_Explorer.zip**_ и распакуйте его. Откройте командную строку в папке *ADT_explorer/client/src*.

Запустите `npm install`, чтобы загрузить все необходимые зависимости.

Затем запустите приложение, выполнив `npm run start`.

Через несколько секунд откроется окно браузера, и приложение отобразится в этом окне.

:::image type="content" source="media/quickstart-adt-explorer/explorer-blank.png" alt-text="Окно браузера, в котором отображается приложение, запущенное на localhost:3000. Приложение называется ADT Explorer и содержит поля для обозревателя запросов, представления модели, представления графа и обозревателя свойств. Данных на экране пока нет." lightbox="media/quickstart-adt-explorer/explorer-blank.png":::

Нажмите кнопку *Войти* в верхней части окна, чтобы настроить ADT Explorer для работы с настроенным экземпляром. 

:::image type="content" source="media/quickstart-adt-explorer/sign-in.png" alt-text="ADT Explorer с выделенным значком Войти в верхней части окна. На значке изображен простой силуэт человека, перекрытый силуэтом ключа." lightbox="media/quickstart-adt-explorer/sign-in.png":::

Введите важные сведения, собранные ранее в разделе [Предварительные требования](#prerequisites).
* Идентификатор приложения (клиента)
* Идентификатор каталога (клиента)
* URL-адрес ADT в формате *https://{имя узла экземпляра}*

>[!NOTE]
> Вы можете в любое время повторно посетить страницу и изменить эту информацию, выбрав тот же значок, чтобы снова открыть поле входа. Он сохранит переданные значения.

Если вы видите всплывающее окно *Запрос разрешений* от корпорации Майкрософт, предоставьте согласие для этого приложения и нажмите кнопку "Принять", чтобы продолжить.

## <a name="add-the-sample-data"></a>Добавление образца данных

Затем импортируйте пример сценария и графа в ADT Explorer.

Пример сценария находится в загруженном файле _**Azure_Digital_Twins_samples.zip**_, поэтому следует перейти к архиву и извлечь из него папку.

### <a name="models"></a>Модели

Первым шагом в работе с Azure Digital Twins является определение словаря для вашей среды. Это делается путем создания пользовательских [**моделей**](concepts-models.md), описывающих типы сущностей, существующих в среде. 

Каждая модель написана на языке, похожем на формат JSON-LD, который называется **Digital Twin Definition Language (DTDL)** и описывает один тип сущности в терминах его *свойств*, *телеметрии*, *связей* и *компонентов*. Позже эти модели будут использоваться в качестве основы для цифровых двойников, представляющих определенные экземпляры этих типов.

Как правило, при создании модели вам предстоит выполнить три шага:
1. написать определение модели (в кратком руководстве, уже сделано в составе примера решения);
2. проверить правильность синтаксиса (в кратком руководстве, уже выполнено как часть примера решения);
3. отправить его в свой экземпляр Azure Digital Twins.
 
В этом кратком руководстве файлы модели уже были написаны, проверены и включены в загруженное решение. В этом разделе вы загрузили две предварительно написанные модели в свой экземпляр, чтобы определить эти компоненты в среде разработки:
* Этаж
* Комната

#### <a name="upload-models"></a>Отправка моделей

В окне *ПРЕДСТАВЛЕНИЕ МОДЕЛИ* щелкните значок *Отправить модель*.

:::image type="content" source="media/quickstart-adt-explorer/upload-model.png" alt-text="Подсвеченный значок в середине окна Представление модели. В нем отображается стрелка, указывающая на облако." lightbox="media/quickstart-adt-explorer/upload-model.png":::
 
1. В появившемся поле выбора файла перейдите к папке *Azure_Digital_Twins_samples/AdtSampleApp/SampleClientApp/models* в загруженном репозитории.
2. Выберите *Room.json* и *Floor.json*, а затем нажмите кнопку ОК. (Вы можете передать другие модели, если хотите, но они не будут использоваться в этом кратком руководстве).
3. После всплывающего диалогового окна появится запрос на вход в учетную запись Azure.

>[!NOTE]
>Если вы видите следующее сообщение об ошибке: :::image type="content" source="media/quickstart-adt-explorer/error-models-popup.png" alt-text="Всплывающее окно ошибки чтения "Ошибка: Ошибка выборки моделей: ClientAuthError: Ошибка открытия всплывающего окна. Это может произойти, если используется IE или если всплывающие окна заблокированы в браузере." и кнопка "Закрыть" в нижней части" border="false"::: 
> Попробуйте отключить блокирование всплывающих окон или используйте другой браузер.

ADT Explorer теперь будет отправлять эти файлы модели в ваш экземпляр Azure Digital Twins. Они должны отображаться в окне *ПРЕДСТАВЛЕНИЕ МОДЕЛИ*, в котором отображаются понятные имена и полные идентификаторы моделей. Вы можете щелкнуть пузырь сведений *ПРЕДСТАВЛЕНИЕ МОДЕЛИ*, чтобы увидеть код DTDL.

:::row:::
    :::column:::
        :::image type="content" source="media/quickstart-adt-explorer/model-info.png" alt-text="Окно Представление модели с двумя определениями модели, которые перечислены внутри, Floor (dtmi:example:Floor;1) и Room (dtmi:example:Room;1). Значок Представление модели с буквой i в окружности, выделен для каждой модели." lightbox="media/quickstart-adt-explorer/model-info.png":::
    :::column-end:::
    :::column:::
    :::column-end:::
    :::column:::
    :::column-end:::
:::row-end:::

### <a name="twins-and-the-twin-graph"></a>Цифровые двойники и граф двойников

Теперь, когда несколько моделей отправлено в ваш экземпляр Azure Digital Twins, можно добавить [**цифровые двойники**](concepts-twins-graph.md) согласно определениям моделей. 

Цифровые двойники представляют собой реальные сущности в вашей бизнес-среде: такие вещи, как датчики на ферме, световые индикаторы в автомобиле или — в этом кратком руководстве — комнаты в здании. Можно создать много двойников для модели любого типа (например, несколько комнат, которые используют модель *Room*) и соединять их с помощью связей с **графом двойников**, представляющим полную среду.

В этом разделе вы будете отправлять предварительно созданные двойники, подключенные к предварительно созданному графу. Граф содержит два этажа и две комнаты, соединенные по такой схеме:
* *Floor0*
    - содержит *Room0*
* *Floor1*
    - содержит *Room1*

#### <a name="import-the-graph"></a>Импорт графа

В окне *Представление графа* щелкните значок *Импорт графа*.

:::image type="content" source="media/quickstart-adt-explorer/import-graph.png" alt-text="В окне Представление графа выделен значок. В нем отображается стрелка, указывающая на облако." lightbox="media/quickstart-adt-explorer/import-graph.png":::

В поле селектора файла перейдите в папку *Azure_Digital_Twins_samples/AdtSampleApp/SampleClientApp* и выберите файл таблицы _**buildingScenario.xlsx**_. Этот файл содержит описание примера графа. Нажмите кнопку ОК.

Через несколько секунд ADT Explorer откроет представление *Импорт*, в котором отображается предварительный просмотр загружаемого графа.

Чтобы подтвердить отправку графа, щелкните значок *Сохранить* в правом верхнем углу *ПРЕДСТАВЛЕНИЕ ГРАФА*:

:::row:::
    :::column:::
        :::image type="content" source="media/quickstart-adt-explorer/graph-preview-save.png" alt-text="Выделенный значок Сохранить на панели предварительного просмотра графа" lightbox="media/quickstart-adt-explorer/graph-preview-save.png":::
    :::column-end:::
    :::column:::
    :::column-end:::
:::row-end:::

ADT Explorer теперь будет использовать переданный файл для создания запрашиваемых двойников и связей между ними. Откроется диалоговое окно, показывающее, что процесс завершен. Нажмите *Закрыть*.

:::row:::
    :::column:::
        :::image type="content" source="media/quickstart-adt-explorer/import-success.png" alt-text="Диалоговое окно, указывающее на успешное завершение импорта графа. В нем написано: Импорт успешно завершен. Импортировано 49 двойников. Импортировано 50 связей." lightbox="media/quickstart-adt-explorer/import-success.png":::
    :::column-end:::
    :::column:::
    :::column-end:::
    :::column:::
    :::column-end:::
:::row-end:::

Теперь граф отправлен в ADT Explorer. Чтобы увидеть граф, нажмите кнопку *Выполнить запрос* в окне *ОБОЗРЕВАТЕЛЬ ГРАФА* в верхней части окна ADT Explorer. 

:::image type="content" source="media/quickstart-adt-explorer/run-query.png" alt-text="Выделенная кнопка "Выполнить запрос" рядом с верхней частью окна" lightbox="media/quickstart-adt-explorer/run-query.png":::

Будет выполнен запрос по умолчанию для выбора и отображения всех цифровых двойников. ADT Explorer извлечет все двойники и связи из службы и создаст граф, определенный в окне *ПРЕДСТАВЛЕНИЕ ГРАФА*.

## <a name="explore-the-graph"></a>Просмотр графа

Теперь можно увидеть отправленный граф образца сценария:

:::image type="content" source="media/quickstart-adt-explorer/graph-view-full.png" alt-text="Окно "Представление графа", содержащее граф двойника. Окружность с меткой "floor1" соединена стрелкой с меткой "contains" и окружностью с меткой "room1"; окружность с меткой "floor0" соединена стрелкой с меткой "contains" и окружностью с меткой "room0".":::

Окружности (узлы графа) представляют цифровых двойников, а линии представляют связи. Вы увидите, что двойник *Floor0* содержит *Room0*, а двойник *Floor1* содержит *Room1*.

Если вы используете мышь, можно щелкнуть и перетащить части графа, чтобы переместить их.

### <a name="view-twin-properties"></a>Просмотр свойств двойника 

Вы можете выбрать двойника, чтобы просмотреть список его свойств и их значений в окне *ОБОЗРЕВАТЕЛЬ СВОЙСТВ*. 

Ниже приведены свойства двойника *Room0*.

:::row:::
    :::column:::
        :::image type="content" source="media/quickstart-adt-explorer/properties-room0.png" alt-text="Выделенное окно "Обозреватель свойств", в котором отображаются свойства для Room0, включая (среди прочего) поле $dtId "Room0", поле температуры со значением 70 и поле влажности со значением 30." lightbox="media/quickstart-adt-explorer/properties-room0.png":::
    :::column-end:::
    :::column:::
    :::column-end:::
:::row-end:::

Обратите внимание, что *Room0* имеет температуру **70**.

Ниже приведены свойства *Room1*.

:::row:::
    :::column:::
        :::image type="content" source="media/quickstart-adt-explorer/properties-room1.png" alt-text="Выделенное окно "Обозреватель свойств", в котором отображаются свойства для Room1, включая (среди прочего) поле $dtId "Room1", поле температуры со значением 80 и поле влажности со значением 60." lightbox="media/quickstart-adt-explorer/properties-room1.png":::
    :::column-end:::
    :::column:::
    :::column-end:::
:::row-end:::

Обратите внимание, что *Room1* имеет температуру **80**.

### <a name="query-the-graph"></a>Запрос графа

Главной особенностью Azure Digital Twins является возможность просто и эффективно [запрашивать](concepts-query-language.md) граф двойников, чтобы получать ответы о вашей среде. 

Одним из способов вызова двойников в графе являются их *свойства*. Запросы на основе свойств помогут получать ответы на множество вопросов, например о наличии в вашей среде выбросов, которые требуют внимания.

В этом разделе будет выполнен запрос, отвечающий на следующий вопрос: _**Какие двойники имеют температуру выше 75?**_

Чтобы увидеть ответ, выполните следующий запрос в окне *ОБОЗРЕВАТЕЛЬ ЗАПРОСОВ*:

```SQL
SELECT * FROM DigitalTwins T WHERE T.Temperature > 75
```

Припомните, что в свойствах двойника раньше для *Room0* была температура **70**, а для *Room1* была температура **80**. Поэтому в результатах отображается только _**Room1**_.
    
:::image type="content" source="media/quickstart-adt-explorer/result-query-property-before.png" alt-text="Результаты запроса по свойству, показывающие только Room1" lightbox="media/quickstart-adt-explorer/result-query-property-before.png":::

>[!TIP]
> Другие операторы сравнения ( *<* , *>* , *=* или *! =* ) также поддерживаются в приведенном выше запросе. Вы можете попытаться подключить эти или другие значения, или другие свойства двойника в запрос, чтобы увидеть ответы на свои вопросы.

## <a name="edit-data-in-the-graph"></a>Изменение данных в графе

Для изменения свойств двойников, представленных в графе, можно использовать ADT Explorer. В этом разделе мы будем **_увеличивать температуру_ Room0 до 76**.

Для этого выберите *Room0*, открыв список свойств этого двойника в окне *ОБОЗРЕВАТЕЛЬ СВОЙСТВ*.

Свойства в этом списке доступны для редактирования. Выберите значение температуры **70**, чтобы активировать ввод нового значения. Введите **76** и щелкните значок *Сохранить*, чтобы обновить температуру до значения **76**.

:::row:::
    :::column:::
        :::image type="content" source="media/quickstart-adt-explorer/new-properties-room0.png" alt-text="Окно "Обозреватель свойств", в котором отображаются свойства для Room0. Значение температуры — это редактируемое поле, в котором отображается число 76, а значок "Сохранить" выделен." lightbox="media/quickstart-adt-explorer/new-properties-room0.png":::
    :::column-end:::
    :::column:::
    :::column-end:::
:::row-end:::

После успешного сохранения вы увидите окно *Сведения об исправлении*, в котором отображается код исправления, который использовался в фоновом режиме с [API-интерфейсами](how-to-use-apis-sdks.md) Azure Digital Twins для внесения обновления. Нажмите *Закрыть*.

### <a name="query-to-see-the-result"></a>Запрос для просмотра результата

Чтобы убедиться, что граф успешно зарегистрировал обновление в *Room0*, заблаговременно перезапустите запрос, чтобы **получить всех двойников в окружении с температурой выше 75**:

```SQL
SELECT * FROM DigitalTwins T WHERE T.Temperature > 75
```

Теперь, когда температура *Room0* изменилась с **70** на **76**, в результатах должны отобразиться оба двойника.

:::image type="content" source="media/quickstart-adt-explorer/result-query-property-after.png" alt-text="Результаты запроса свойства, в которых отображаются как Room0, так и Room1" lightbox="media/quickstart-adt-explorer/result-query-property-after.png":::

## <a name="review-and-contextualize-learnings"></a>Просмотр и контекстуализация учебных моделей

В этом кратком руководстве вы создали экземпляр Azure Digital Twins, подключили его к ADT Explorer, и заполнили его примером сценария. 

Затем вы изучили граф
1. Используя запрос для ответа на вопрос о сценарии.
2. Изменяя свойства в цифровом двойнике.
    * Снова запустите запрос, чтобы увидеть, как изменился ответ в результате обновления.

Цель этого упражнения — продемонстрировать, как можно использовать граф Azure Digital Twins, чтобы ответить на вопросы о среде, даже если среда продолжит изменяться. 

Хотя в этом кратком руководстве вы обновили температуру вручную, в Azure Digital Twins можно подключать цифровые двойники к реальным устройствам Интернета вещей, чтобы обновления происходили автоматически на основе данных телеметрии. Это позволяет создать динамический граф, который всегда отражает реальное состояние среды и использовать запросы для получения сведений о том, что происходит в вашей среде также в режиме реального времени.

## <a name="clean-up-resources"></a>Очистка ресурсов

Чтобы окончательно завершить пример в этом кратком руководстве, сначала завершите работу консольного приложения. Это приведет к прерыванию подключения к приложению ADT Explorer в браузере, и вы больше не сможете просматривать динамические данные в браузере. Теперь можно закрыть вкладку браузера.

Если вы планируете продолжить работу с учебниками по Azure Digital Twins, то экземпляр, используемый в этом кратком руководстве, можно использовать повторно для этих статей, и удалять его не нужно.
 
[!INCLUDE [digital-twins-cleanup-basic.md](../../includes/digital-twins-cleanup-basic.md)]

Наконец, удалите папки примеров проекта, загруженные на локальный компьютер (_**ADT_Explorer.zip**_ и _**Azure_Digital_Twins_samples.zip**_).

## <a name="next-steps"></a>Дальнейшие шаги 

Далее перейдите к учебникам по Azure Digital Twins, чтобы создать собственный сценарий и средства взаимодействия Azure Digital Twins.

> [!div class="nextstepaction"]
> [*Руководство. Написание кода для клиентского приложения*](tutorial-code.md)
