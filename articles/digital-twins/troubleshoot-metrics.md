---
title: Просмотр метрик с помощью Azure Monitor
titleSuffix: Azure Digital Twins
description: См. статью как просмотреть метрики цифровых двойников Azure в Azure Monitor.
author: baanders
ms.author: baanders
ms.date: 8/4/2020
ms.topic: troubleshooting
ms.service: digital-twins
ms.openlocfilehash: dafea083e68b2afe6b6bcf45b4cff8779f817049
ms.sourcegitcommit: 62717591c3ab871365a783b7221851758f4ec9a4
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/22/2020
ms.locfileid: "88749017"
---
# <a name="troubleshooting-azure-digital-twins-metrics"></a>Устранение неполадок в Azure Digital двойников: метрики

Метрики, описанные в этой статье, позволяют получить сведения о состоянии ресурсов Azure Digital двойников в подписке Azure. Метрики Azure Digital двойников помогают оценить общую работоспособность службы цифровых двойников Azure и подключенных к ней ресурсов. Эти статистические данные позволяют увидеть, что происходит с цифровым двойников Azure и помогает выполнять анализ основных причин проблем без необходимости обращения в службу поддержки Azure.

Метрики включены по умолчанию. Метрики цифровых двойников Azure можно просмотреть на [портал Azure](https://portal.azure.com).

## <a name="how-to-view-azure-digital-twins-metrics"></a>Как просмотреть метрики цифровых двойников Azure

1. Создайте экземпляр Digital двойников для Azure. Инструкции по настройке экземпляра Digital двойников для Azure см. в разделе [*как настроить экземпляр и проверку подлинности*](how-to-set-up-instance-scripted.md).

2. Найдите свой экземпляр Azure Digital двойников в [портал Azure](https:/portal.azure.com) (для него можно открыть страницу, введя его имя в строке поиска портала). 

    В меню экземпляра выберите **метрики**.
   
    :::image type="content" source="media/troubleshoot-metrics/azure-digital-twins-metrics.png" alt-text="Снимок экрана со страницей "метрики" для Azure Digital двойников":::

    На этой странице отображаются метрики для вашего экземпляра Azure Digital двойников. Вы также можете создать настраиваемые представления метрик, выбрав из списка нужные сведения.
    
3. Вы можете отправить данные метрик в конечную точку концентраторов событий или учетную запись хранения Azure, выбрав **параметры диагностики** в меню, а затем **добавив параметр диагностики**.

    :::image type="content" source="media/troubleshoot-diagnostics/diagnostic-settings.png" alt-text="Снимок экрана со страницей параметров диагностики и кнопкой "Добавить"":::

    Дополнительные сведения об этом процессе см. в разделе [*Устранение неполадок: Настройка диагностики*](troubleshoot-diagnostics.md).

4. Вы можете настроить оповещения для данных метрик, выбрав в меню пункт **оповещения** , а затем — **новое правило генерации оповещений**.
    :::image type="content" source="media/troubleshoot-alerts/alerts-pre.png" alt-text="Снимок экрана, показывающий страницу предупреждений и добавляемую кнопку":::

    Дополнительные сведения об этом процессе см. в разделе [*Устранение неполадок: Настройка диагностики*](troubleshoot-diagnostics.md).

## <a name="azure-digital-twins-metrics-and-how-to-use-them"></a>Метрики цифровых двойников Azure и способы их использования

Azure Digital двойников предоставляет несколько метрик, которые позволяют получить общие сведения о работоспособности экземпляра и связанных с ним ресурсах. Можно также объединить сведения из нескольких метрик, чтобы закрасить более крупную картину состояния экземпляра. 

В следующих таблицах описываются метрики каждого экземпляра Azure Digital двойников и сведения о том, как каждая метрика связана с общим состоянием вашего экземпляра.

#### <a name="api-request-metrics"></a>Метрики запросов API

Метрики, относящиеся к запросам API:

| Метрика | Отображаемое имя метрики | Единицы | Тип агрегирования| Описание | Измерения |
| --- | --- | --- | --- | --- | --- |
| апирекуестс | Запросы API (Предварительная версия) | Count | Итог | Число запросов API, выполненных для операций чтения, записи, удаления и запроса цифровых двойников. |  Идентификаци <br>Операцию <br>См <br>Код состояния, <br>Класс кода состояния, <br>Текст состояния |
| апирекуестсфаилурерате | Частота сбоев запросов API (Предварительная версия) | Процент | Среднее | Процент запросов API, получаемых службой для экземпляра, который предоставляет код ответа внутренней ошибки (500) для операций чтения, записи, удаления и выполнения запросов Digital двойников. | Идентификаци <br>Операцию <br>См <br>Код состояния, <br>Класс кода состояния, <br>Текст состояния
| апирекуестслатенци | Задержка запросов API (Предварительная версия) | Миллисекунды | Среднее | Время ответа для запросов API. Это относится к времени получения запроса службой Azure Digital двойников до тех пор, пока служба не отправит результат успешного или неуспешного выполнения для цифровых двойников операций чтения, записи, удаления и запроса. | Идентификаци <br>Операцию <br>Протокол |

#### <a name="billing-metrics"></a>Метрики выставления счетов

Метрики, относящиеся к выставлению счетов:

>[!NOTE]
> На этапе предварительной версии **выставление счетов имеет нулевую стоимость**. Хотя эти метрики по-прежнему отображаются в списке выбора, они не применяются во время предварительной версии и остаются равными нулю до тех пор, пока служба не будет перемещена в режим предварительной версии.

| Метрика | Отображаемое имя метрики | Единицы | Тип агрегирования| Описание | Измерения |
| --- | --- | --- | --- | --- | --- |
| биллингапиоператионс | Операции API выставления счетов (Предварительная версия) | Count | Итог | Метрика выставления счетов за количество всех запросов API, выполненных в службе Digital двойников. | Идентификатор счетчика |
| биллингмессажеспроцессед | Обработанные сообщения о выставлении счетов (Предварительная версия) | Count | Итог | Метрика выставления счетов за количество сообщений, отправленных из Azure Digital двойников во внешние конечные точки. | Идентификатор счетчика |
| биллингкуерюнитс | Единицы запросов выставления счетов (Предварительная версия) | Count | Итог | Количество единиц запросов, вычисленное внутренне измерение использования ресурсов службы, которое используется для выполнения запросов. Также доступен вспомогательный API для измерения единиц запросов: [Куеричаржехелпер Class](https://docs.microsoft.com/dotnet/api/azure.digitaltwins.core.querychargehelper?view=azure-dotnet-preview) | Идентификатор счетчика |

#### <a name="ingress-metrics"></a>Метрики входящих данных

Метрики, относящиеся к входным данным:

| Метрика | Отображаемое имя метрики | Единицы | Тип агрегирования| Описание | Измерения |
| --- | --- | --- | --- | --- | --- |
| ингрессевентс | События входящих данных (Предварительная версия) | Count | Итог | Число входящих событий телеметрии в Azure Digital двойников. | Результат |
| ингрессевентсфаилурерате | Частота сбоев входящих событий (Предварительная версия) | Процент | Среднее | Процент входящих событий телеметрии, для которых служба возвращает код ответа внутренней ошибки (500). | Результат |
| ингрессевентслатенци | Задержка событий входящих данных (Предварительная версия) | Миллисекунды | Среднее | Время, когда происходит событие, когда оно будет готово к егрессед в Azure Digital двойников. в этом случае служба отправляет результат успешного выполнения или сбоя. | Результат |

#### <a name="routing-metrics"></a>Метрики маршрутизации

Метрики, относящиеся к маршрутизации:

| Метрика | Отображаемое имя метрики | Единицы | Тип агрегирования| Описание | Измерения |
| --- | --- | --- | --- | --- | --- |
| мессажесраутед | Сообщения, направляемые (Предварительная версия) | Count | Итог | Количество сообщений, направляемых в службу Azure конечной точки, например концентратор событий, служебную шину или службу "Сетка событий". | Тип конечной точки, <br>Результат |
| раутингфаилурерате | Частота сбоев маршрутизации (Предварительная версия) | Процент | Среднее | Процент событий, которые приводят к ошибке при их маршрутизации из Azure Digital двойников в службу Azure Endpoint Service, например концентратор событий, служебную шину или службу "Сетка событий". | Тип конечной точки, <br>Результат |
| раутинглатенци | Задержка маршрутизации (Предварительная версия) | Миллисекунды | Среднее | Время, прошедшее с момента отправки события из Azure Digital двойников в, когда оно отправляется в конечную службу Azure, например концентратор событий, служебную шину или службу "Сетка событий". | Тип конечной точки, <br>Результат |

## <a name="dimensions"></a>Измерения

Измерения помогают определить дополнительные сведения о метриках. Некоторые метрики маршрутизации предоставляют сведения для каждой конечной точки. В таблице ниже перечислены возможные значения для этих измерений.

| Измерение | Значения |
| --- | --- |
| Аутентификация | OAuth |
| Операция (для запросов API) | Microsoft. Дигиталтвинс/дигиталтвинс/DELETE, <br>Microsoft. Дигиталтвинс/дигиталтвинс/Write, <br>Microsoft. Дигиталтвинс/дигиталтвинс/Read, <br>Microsoft. Дигиталтвинс/евентраутес/Read, <br>Microsoft. Дигиталтвинс/евентраутес/Write, <br>Microsoft. Дигиталтвинс/евентраутес/DELETE, <br>Microsoft. Дигиталтвинс/Models/Read, <br>Microsoft. Дигиталтвинс/Models/Write, <br>Microsoft. Дигиталтвинс/Models/DELETE, <br>Microsoft. Дигиталтвинс/запрос/действие |
| Тип конечной точки | Сетка событий, <br>Концентратор событий, <br>Служебная шина |
| Протокол | HTTPS |
| Результат | Загрузоч <br>Сбой |
| Код состояния | 200, 404, 500 и т. д. |
| Класс кода состояния | 2xx, 4xx, 5xx и т. д. |
| Текст состояния | Внутренняя ошибка сервера, не найдена и т. д. |

## <a name="next-steps"></a>Дальнейшие действия

Дополнительные сведения об управлении записанными метриками для цифрового двойников Azure см. в разделе [*Устранение неполадок: Настройка диагностики*](troubleshoot-diagnostics.md).