---
title: Маршрутизация событий и сообщений в Azure Digital двойников | Документация Майкрософт
description: Общие сведения о маршрутизации событий и сообщений в конечные точки службы с помощью Digital Twins
ms.author: alinast
author: alinamstanciu
manager: bertvanhoof
ms.service: digital-twins
services: digital-twins
ms.topic: conceptual
ms.date: 01/03/2020
ms.openlocfilehash: 65b760eaf28d907fab3654ed92f960be7556b0d6
ms.sourcegitcommit: 12a26f6682bfd1e264268b5d866547358728cd9a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/10/2020
ms.locfileid: "75862362"
---
# <a name="routing-iot-events-and-messages"></a>Маршрутизация событий Интернета вещей и сообщений

"Интернет вещей" решения часто Объединяйте несколько мощных служб, включающих хранилище, аналитику и многое другое. В этой статье описывается, как подключить приложения Azure Digital Twins к службе аналитики Azure, ИИ и службам хранилища, чтобы предоставить им более глубокие сведения и функции.

## <a name="route-types"></a>Типы маршрутов  

Azure Digital двойников предлагает два способа подключения событий Интернета вещей к другим службам Azure или бизнес-приложениям.

* **Маршрутизация событий Azure Digital Twins**. Объект геопространственного графа, который изменяет полученные данные телеметрии, или определяемая пользователем функция, которая создает уведомление на основе предварительно определенных условий, может создать события Azure Digital Twins. Пользователи могут отправлять эти события в [Центры событий Azure](https://azure.microsoft.com/services/event-hubs/), [разделы служебной шины Azure](https://azure.microsoft.com/services/service-bus/) или [Сетку событий Azure](https://azure.microsoft.com/services/event-grid/) для дальнейшей обработки.

* **Маршрутизация данных телеметрии устройства**: кроме маршрутизации событий, Digital Twins также может направлять необработанные сообщения телеметрии устройства в Центры событий для последующего анализа. Такие типы сообщений не обрабатываются в Azure Digital Twins. Они просто перенаправляются в концентратор событий.

Для отправки событий или пересылки сообщений пользователи могут указать одну или несколько исходящих конечных точек. События и сообщения будут отправляться в конечные точки в соответствии с этими предопределенными настройками маршрутизации. Другими словами, пользователи могут указать определенную конечную точку для получения событий операций графа и другую для получения событий телеметрии устройства и т. д.

[Маршрутизация ![событий Azure Digital двойников](media/concepts/digital-twins-events-routing.png)](media/concepts/digital-twins-events-routing.png#lightbox)

При маршрутизации в Центры событий сохраняется порядок отправки сообщений телеметрии. Таким образом, они достигают конечной точки в той же последовательности, в которой они были первоначально получены. 

Сетка событий и служебная шина не гарантируют, что конечные точки получат события в порядке их возникновения. Однако в схеме события есть метка времени, с помощью которой можно узнать порядок поступления событий в конечную точку.

## <a name="route-implementation"></a>Реализация маршрутизации

Служба Digital Twins в настоящее время поддерживает следующие типы **EndpointTypes**:

* **EventHub** — конечная точка строки подключения Центров событий.
* **ServiceBus** — конечная точка строки подключения служебной шины.
* **EventGrid** — конечная точка строки подключения Сетки событий.

Digital Twins в настоящее время поддерживает следующие типы **EventTypes**, которые будут отправлены в выбранную конечную точку:

* **DeviceMessages** — сообщения телеметрии, отправленные с устройств пользователей и перенаправленные системой.
* **TopologyOperation** — это операция изменения графа или его метаданных. Например, добавление или удаление такой сущности, как пространство.
* **SpaceChange** — изменение в вычисленном значении пространства как результат сообщения о телеметрии устройства.
* **SensorChange** — изменение в вычисленном значении датчика как результат сообщения телеметрии устройства.
* **UdfCustom** — настраиваемое уведомление из определяемой пользователем функции.

> [!IMPORTANT]  
> Не все типы **EndpointTypes** поддерживают все типы **EventTypes**.
> Ознакомьтесь со следующей таблицей для **евенттипес** , которые допускаются для каждого **EndpointType**.

|             | DeviceMessages | TopologyOperation | SpaceChange | SensorChange | UdfCustom |
| ----------- | -------------- | ----------------- | ----------- | ------------ | --------- |
| концентратор событий.|     X          |         X         |     X       |      X       |   X       |
| Служебная шина|              |         X         |     X       |      X       |   X       |
| Сетка событий|               |         X         |     X       |      X       |   X       |

>[!NOTE]  
>Дополнительные сведения о создании конечных точек и примеры схемы событий, исходящих [и конечных точек](how-to-egress-endpoints.md)см. в этой статье.

## <a name="next-steps"></a>Дальнейшие действия

- Дополнительные сведения об ограничениях на предварительную версию Azure Digital двойников см. в статье [ограничения общедоступной предварительной версии служб](concepts-service-limits.md).

- Чтобы испытать пример цифрового двойников для Azure, ознакомьтесь с [кратким руководством по поиску доступных помещений](quickstart-view-occupancy-dotnet.md).