---
title: События и сообщения для реаутирования - Azure Digital Twins Документы Майкрософт
description: Общие сведения о маршрутизации событий и сообщений в конечные точки службы с помощью Digital Twins
ms.author: alinast
author: alinamstanciu
manager: bertvanhoof
ms.service: digital-twins
services: digital-twins
ms.topic: conceptual
ms.date: 01/03/2020
ms.openlocfilehash: 65b760eaf28d907fab3654ed92f960be7556b0d6
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/27/2020
ms.locfileid: "75862362"
---
# <a name="routing-iot-events-and-messages"></a>Расшатывание событий и сообщений IoT

Решения Internet of Things часто объединяют несколько мощных сервисов, включающие хранение, аналитику и многое другое. В этой статье описывается, как подключить приложения Azure Digital Twins к службе аналитики Azure, ИИ и службам хранилища, чтобы предоставить им более глубокие сведения и функции.

## <a name="route-types"></a>Типы маршрутов  

Azure Digital Twins предлагает два способа подключения событий IoT с другими службами Azure или бизнес-приложениями:

* **Маршрутизация событий Azure Digital Twins**. Объект геопространственного графа, который изменяет полученные данные телеметрии, или определяемая пользователем функция, которая создает уведомление на основе предварительно определенных условий, может создать события Azure Digital Twins. Пользователи могут отправлять эти события в [Центры событий Azure](https://azure.microsoft.com/services/event-hubs/), [разделы служебной шины Azure](https://azure.microsoft.com/services/service-bus/) или [Сетку событий Azure](https://azure.microsoft.com/services/event-grid/) для дальнейшей обработки.

* **Маршрутизация данных телеметрии устройства**: кроме маршрутизации событий, Digital Twins также может направлять необработанные сообщения телеметрии устройства в Центры событий для последующего анализа. Такие типы сообщений не обрабатываются в Azure Digital Twins. Они просто перенаправляются в концентратор событий.

Для отправки событий или пересылки сообщений пользователи могут указать одну или несколько исходящих конечных точек. События и сообщения будут отправляться в конечные точки в соответствии с этими предопределенными настройками маршрутизации. Другими словами, пользователи могут указать определенную конечную точку для получения событий операций графа и другую для получения событий телеметрии устройства и т. д.

[![Маршрутизация событий Azure Digital Twins](media/concepts/digital-twins-events-routing.png)](media/concepts/digital-twins-events-routing.png#lightbox)

При маршрутизации в Центры событий сохраняется порядок отправки сообщений телеметрии. Таким образом, они достигают конечной точки в той же последовательности, в которой они были первоначально получены. 

Сетка событий и служебная шина не гарантируют, что конечные точки получат события в порядке их возникновения. Однако в схеме события есть метка времени, с помощью которой можно узнать порядок поступления событий в конечную точку.

## <a name="route-implementation"></a>Реализация маршрутизации

Служба Digital Twins в настоящее время поддерживает следующие типы **EndpointTypes**:

* **EventHub** — конечная точка строки подключения Центров событий.
* **ServiceBus** является конечная точка соединения Service Bus.
* **EventGrid** — это конечная точка строки строки соединения Event Grid.

Digital Twins в настоящее время поддерживает следующие типы **EventTypes**, которые будут отправлены в выбранную конечную точку:

* **DeviceMessages** представляют собой телеметрические сообщения, отправляемые с устройств пользователей и перенаправляемые системой.
* **TopologyOperation** — это операция изменения графа или его метаданных. Например, добавление или удаление такой сущности, как пространство.
* **SpaceChange** — изменение в вычисленном значении пространства как результат сообщения о телеметрии устройства.
* **SensorChange** — изменение в вычисленном значении датчика как результат сообщения телеметрии устройства.
* **UdfCustom** — настраиваемое уведомление из определяемой пользователем функции.

> [!IMPORTANT]  
> Не все типы **EndpointTypes** поддерживают все типы **EventTypes**.
> Просмотрите следующую таблицу для **EventTypes,** которые разрешены для каждого **EndpointType.**

|             | DeviceMessages | TopologyOperation | SpaceChange | SensorChange | UdfCustom |
| ----------- | -------------- | ----------------- | ----------- | ------------ | --------- |
| концентратор событий.|     X          |         X         |     X       |      X       |   X       |
| Служебная шина|              |         X         |     X       |      X       |   X       |
| Сетка событий|               |         X         |     X       |      X       |   X       |

>[!NOTE]  
>Для получения дополнительной информации о том, как создать конечные точки и примеры схемы событий, прочитайте [Egress и конечные точки](how-to-egress-endpoints.md).

## <a name="next-steps"></a>Дальнейшие действия

- Чтобы узнать о лимитах предварительного просмотра Azure Digital Twins, прочитайте [ограничения службы предварительного просмотра.](concepts-service-limits.md)

- Чтобы опробовать образец Azure Digital Twins, прочитайте [быстрый старт, чтобы найти доступные номера.](quickstart-view-occupancy-dotnet.md)