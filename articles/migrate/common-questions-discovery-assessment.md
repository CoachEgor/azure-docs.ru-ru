---
title: 'Распространенные вопросы: обнаружение, оценка и анализ зависимостей в службе "миграция Azure"'
description: Получите ответы на часто задаваемые вопросы об обнаружении, оценке и анализе зависимостей в службе "миграция Azure".
ms.topic: conceptual
ms.date: 12/29/2019
ms.openlocfilehash: 0132563072ed04a52e4937da7a8df69196f1a91f
ms.sourcegitcommit: 38b11501526a7997cfe1c7980d57e772b1f3169b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/22/2020
ms.locfileid: "76513292"
---
# <a name="common-questions-about-discovery-assessment-and-dependency-analysis"></a>Распространенные вопросы об обнаружении, оценке и анализе зависимостей

В этой статье содержатся ответы на часто задаваемые вопросы об обнаружении, оценке и анализе зависимостей в службе "миграция Azure". При наличии дальнейших запросов после прочтения этой статьи опубликуйте их на [форуме по миграции Azure](https://aka.ms/AzureMigrateForum). Если у вас есть другие вопросы, ознакомьтесь со следующими статьями:

- [Общие вопросы](resources-faq.md) о службе "миграция Azure".
- [Вопросы](common-questions-appliance.md) об устройстве миграции Azure.


## <a name="how-many-vms-can-i-discover-with-an-appliance"></a>Сколько виртуальных машин можно обнаружить с помощью устройства?

Вы можете обнаружить до 10 000 виртуальных машин VMware, до 5 000 виртуальных машин Hyper-V и до 250 серверов с одним устройством. Если в локальной среде имеется больше компьютеров, ознакомьтесь с разрешениями по масштабированию [Hyper-V](scale-hyper-v-assessment.md), [VMware](scale-vmware-assessment.md) и [физической](scale-physical-assessment.md) оценки.



## <a name="vm-size-changed-can-i-run-an-assessment-again"></a>Размер виртуальной машины изменен. Можно ли выполнить оценку еще раз?

Устройство "миграция Azure" непрерывно собирает сведения о локальной среде. Но оценка — это моментальный снимок локальных виртуальных машин на момент времени. При изменении параметров на виртуальной машине, которую необходимо оценить, используйте параметр пересчитать, чтобы обновить оценку с учетом последних изменений.

### <a name="how-do-i-discover-vms-in-a-multitenant-environment"></a>Разделы справки обнаруживать виртуальные машины в многоклиентской среде?

- Если среда VMware используется совместно несколькими клиентами и вы не хотите обнаруживать виртуальные машины одного клиента в подписке другого клиента, создайте vCenter Server учетные данные, которые могут обращаться только к виртуальным машинам, которые нужно обнаружить. Затем используйте эти учетные данные при запуске обнаружения в устройстве "миграция Azure".
- Для Hyper-V при обнаружении используются учетные данные узла Hyper-V. Если виртуальные машины используют один и тот же узел Hyper-V, в настоящее время невозможно разделить обнаружение.  


### <a name="do-i-need-vcenter-server-for-vmware-vm-discovery"></a>Требуется vCenter Server для обнаружения виртуальных машин VMWare?

Да, служба "миграция Azure" требует vCenter Server для выполнения обнаружения в среде VMware. Обнаружение узлов ESXi, не управляемых с помощью vCenter Server, не поддерживается.


## <a name="whats-the-difference-sizing-options"></a>В чем отличие параметров изменения размера?

При изменении размера в локальной среде служба "миграция Azure" не учитывает данные о производительности виртуальной машины для оценки. Он оценивает размеры виртуальных машин на основе локальной конфигурации. Изменение размера на основе производительности зависит от данных об использовании.

- Например, если локальная виртуальная машина содержит 4 ядра и 8 ГБ памяти при загрузке ЦП в 50% и использовании памяти 50%, произойдет следующее:
    - При изменении размера в локальной среде будет рекомендован номер SKU виртуальной машины Azure с 4 ядрами и 8 ГБ памяти.
    - При изменении размера на основе производительности будет рекомендован номер SKU виртуальной машины с 2 ядрами и 4 ГБ памяти, поскольку считается процент использования.

- Точно так же размер диска зависит от двух свойств оценки: критериев изменения размера и типа хранилища.
    - Если критерии изменения размера основаны на производительности и тип хранения — "автоматически", при определении типа целевого диска ("Стандартный" или "Премиум") служба "миграция Azure" учитывает значения операций ввода-вывода и пропускной способности диска.
    - Если критерии изменения размера основаны на производительности, а тип хранилища — Premium, Azure Migrate рекомендует номер SKU диска уровня "Премиум" в зависимости от размера локального диска. Одна и та же логика применяется к размерам диска, если их размер — в локальной среде, а тип хранения — Standard или Premium.

## <a name="does-performance-historyutilization-impact-sizing"></a>Влияет ли размер журнала производительности и степени использования?

Эти свойства применимы только при выборе размера на основе производительности.

- Служба "миграция Azure" собирает журнал производительности локальных компьютеров и использует их для рекомендуемого размера виртуальной машины и типа диска в Azure.
- Устройство постоянно выполняет профилирование локальной среды для сбора данных об использовании в режиме реального времени каждые 20 секунд.
- Устройство выполняет сведение всех 20-секундных выборок и создает одну точку данных каждые 15 минут.
- Чтобы создать точку данных, устройство выбирает пиковое значение из всех 20-секундных выборок.
- Устройство отправляет эту точку данных в Azure.

При создании оценки в Azure в зависимости от значения длительности производительности и производительности, служба "миграция Azure" вычисляет значение эффективного использования и использует его для изменения размера.

- Например, если задать длительность производительности равным одному дню, а значение процентиля — 95 процентиль, то служба "миграция Azure" сортирует 15-минутные точки выборки, отправленные сборщиком за последний день в возрастающем порядке, и выбирает значение 95 процентиль процентиль в качестве действующего загружен.
- Использование значения 95 процентиль процентиль гарантирует, что выбросы не учитываются. При использовании 99-м процентиль можно включать выбросы. Если вы хотите выбрать пиковое использование для периода без каких бы то ни было выбросов, выберите 99-м процентиль.

## <a name="what-is-dependency-visualization"></a>Что такое визуализация зависимостей?

Используйте визуализацию зависимостей для оценки групп виртуальных машин для миграции с большей достоверностью. Визуализация зависимостей перекрестно проверяет зависимости компьютера перед выполнением оценки. Это помогает убедиться, что ничего не осталось, и, таким образом, помогает избежать непредвиденных сбоев при миграции в Azure. Служба "Миграция Azure" использует решение "Сопоставление служб" в Azure Monitor для визуализации зависимостей. Дополнительные [сведения](concepts-dependency-visualization.md).

> [!NOTE]
> Визуализация зависимостей недоступна в Azure для государственных организаций.

## <a name="do-i-pay-for-dependency-visualization"></a>Взимается ли плата за визуализацию зависимостей?
Нет. [Дополнительные сведения](https://azure.microsoft.com/pricing/details/azure-migrate/) о ценах на службу "Миграция Azure".

## <a name="what-do-i-install-for-dependency-visualization"></a>Что следует установить для визуализации зависимостей?

Чтобы использовать визуализацию зависимостей, необходимо скачать и установить агенты на каждом локальном компьютере, который нужно оценить.

На каждом компьютере необходимо установить следующие агенты:
- [Microsoft Monitoring Agent (MMA)](https://docs.microsoft.com/azure/log-analytics/log-analytics-agent-windows).
- [Агент зависимостей](../azure-monitor/platform/agents-overview.md#dependency-agent).
- Если у вас есть компьютеры без подключения к Интернету, необходимо скачать и установить шлюз Log Analytics.

Эти агенты не нужны, если не используется Визуализация зависимостей.

## <a name="can-i-use-an-existing-workspace"></a>Можно ли использовать имеющуюся рабочую область?

Да, можно подключить существующую рабочую область к проекту миграции и использовать ее для визуализации зависимостей. [Узнайте больше](concepts-dependency-visualization.md#how-does-it-work).

## <a name="can-i-export-the-dependency-visualization-report"></a>Можно ли экспортировать отчет о визуализации зависимостей?

Нет, не удается экспортировать визуализацию зависимостей. Однако служба "миграция Azure" использует Сопоставление служб, и для получения зависимостей в формате JSON можно использовать [REST API сопоставление служб](https://docs.microsoft.com/rest/api/servicemap/machines/listconnections) .

## <a name="can-i-automate--mmadependency-agent-installation"></a>Можно ли автоматизировать установку агента MMA/зависимостей?

Используйте этот [скрипт для установки агента зависимостей](../azure-monitor/insights/vminsights-enable-hybrid-cloud.md#installation-script-examples). Выполните эти [инструкции, чтобы установить MMA](https://docs.microsoft.com/azure/azure-monitor/platform/log-analytics-agent#install-and-configure-agent) с помощью командной строки или службы автоматизации. Для MMA используйте [этот скрипт](https://gallery.technet.microsoft.com/scriptcenter/Install-OMS-Agent-with-2c9c99ab).

Кроме сценариев, для развертывания агентов можно также использовать средства развертывания, такие как Microsoft Endpoint Configuration Manager и [Intigua](https://www.intigua.com/getting-started-intigua-for-azure-migration) .


## <a name="what-operating-systems-does-mma-support"></a>Какие операционные системы поддерживает MMA?

- Просмотрите список [операционных систем Windows, ПОДДЕРЖИВАЕМЫХ MMA](https://docs.microsoft.com/azure/log-analytics/log-analytics-concept-hybrid#supported-windows-operating-systems).
- Просмотрите список [операционных систем Linux, ПОДДЕРЖИВАЕМЫХ MMA](https://docs.microsoft.com/azure/log-analytics/log-analytics-concept-hybrid#supported-linux-operating-systems).

## <a name="can-i-visualize-dependencies-for-more-than-an-hour"></a>Можно ли визуализировать зависимости более часа?
Нет. Можно визуализировать зависимости до часа. Вы можете вернуться к определенной дате в журнале, как и до конца месяца, но максимальная продолжительность визуализации — это час. Например, можно использовать длительность времени в сопоставлении зависимостей для просмотра зависимостей за вчерашний период, но можно просмотреть зависимости только в течение одного часового периода. Однако можно использовать журналы Azure Monitor для [запроса данных зависимости](https://docs.microsoft.com/azure/migrate/how-to-create-group-machine-dependencies) в течение более длительного времени.

## <a name="can-visualize-dependencies-for-groups-of-more-than-10-vms"></a>Может визуализировать зависимости для групп с более чем 10 виртуальными машинами?
Можно [визуализировать зависимости](https://docs.microsoft.com/azure/migrate/how-to-create-group-dependencies) для групп, содержащих до 10 виртуальных машин. Если у вас есть группа с более чем 10 виртуальными машинами, рекомендуется разбить группу на группы меньшего размера, а затем визуализировать зависимости.




## <a name="next-steps"></a>Дальнейшие действия
Ознакомьтесь с [обзором службы "миграция Azure](migrate-services-overview.md)".
