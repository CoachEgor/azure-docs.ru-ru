---
title: Устранение неполадок при развертывании и обнаружении устройств с помощью Azure migrate
description: Получите справку по развертыванию устройства "миграция Azure" и обнаружению компьютеров.
author: musa-57
ms.manager: abhemraj
ms.author: hamusa
ms.topic: troubleshooting
ms.date: 01/02/2020
ms.openlocfilehash: 3e25f55d82ba146f9076e38faf1e399c5228d947
ms.sourcegitcommit: 72c2da0def8aa7ebe0691612a89bb70cd0c5a436
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/10/2020
ms.locfileid: "79080397"
---
# <a name="troubleshoot-the-azure-migrate-appliance-and-discovery"></a>Устранение неполадок с устройством и обнаружением службы "миграция Azure"

Эта статья поможет вам устранить неполадки при развертывании устройства " [Миграция Azure](migrate-services-overview.md) " и использовании устройства для обнаружения локальных компьютеров.


## <a name="whats-supported"></a>Поддерживаемые функции

[Ознакомьтесь](migrate-appliance.md) с требованиями к поддержке устройства.


## <a name="invalid-ovf-manifest-entry"></a>"Недопустимая запись манифеста OVF"

Если появится сообщение об ошибке "указанный файл манифеста недопустим: Недопустимая запись манифеста OVF", выполните следующие действия.

1. Проверьте, правильно ли загружен файл OVA устройства для миграции Azure, проверив его хэш-значение. [Дополнительные сведения](https://docs.microsoft.com/azure/migrate/tutorial-assessment-vmware) Если хэш-значение не совпадает, скачайте файл OVA еще раз и повторите попытку развертывания.
2. Если развертывание по-прежнему завершается сбоем и вы используете VMware vSphere клиент для развертывания файла OVF, попробуйте развернуть его с помощью веб-клиента vSphere. Если развертывание по-прежнему завершается сбоем, попробуйте использовать другой веб-браузер.
3. Если вы используете веб-клиент vSphere и пытаетесь развернуть его на vCenter Server 6,5 или 6,7, попробуйте развернуть OVA непосредственно на узле ESXi:
   - Подключитесь к узлу ESXi напрямую (вместо vCenter Server) с помощью веб-клиента (HTTPS://<*IP-адрес узла*>/УИ).
   - В окне **Инвентаризация** **домашней** > выберите **файл** > **развернуть шаблон OVF**. Перейдите к OVA и завершите развертывание.
4. Если развертывание по-прежнему не удается, обратитесь в поддержку службы "Миграция Azure".

## <a name="cant-connect-to-the-internet"></a>Не удается подключиться к Интернету

Это может произойти, если компьютер устройства находится за прокси-сервером.

- Убедитесь, что вы предоставляете учетные данные для авторизации, если они требуются прокси-серверу.
- Если вы используете прокси-сервер брандмауэра на основе URL-адресов для управления исходящими подключениями, добавьте [эти URL-адреса](migrate-appliance.md#url-access) в список разрешений.
- Если вы используете перехватчик прокси-сервера для подключения к Интернету, импортируйте сертификат прокси-сервера на виртуальную машину устройства, выполнив [следующие действия](https://docs.microsoft.com/azure/migrate/concepts-collector).

##  <a name="datetime-synchronization-error"></a>Ошибка синхронизации даты и времени

Ошибка синхронизации даты и времени (802) означает, что часы сервера могут быть не синхронизированы с текущим временем более чем за пять минут. Измените время на виртуальной машине сборщика в соответствии с текущим временем:

1. Откройте командную строку с правами администратора на этой виртуальной машине.
2. Чтобы проверить часовой пояс, выполните команду **w32tm/ТЗ**.
3. Чтобы синхронизировать время, выполните команду **w32tm/resync**.


## <a name="unabletoconnecttoserver"></a>UnableToConnectToServer

При возникновении этой ошибки подключения может быть невозможно подключиться к vCenter Server *ServerName*. com: 9443. Сведения об ошибке указывают на то, что конечная точка не прослушивается на https://*ServerName*. com: 9443/SDK, которые могут принимать сообщение.

- Проверьте, используете ли вы последнюю версию устройства. Если вы не используете, обновите устройство до [последней версии](https://docs.microsoft.com/azure/migrate/concepts-collector).
- Если проблема по-прежнему возникает в последней версии, возможно, устройство не сможет разрешить указанное vCenter Server имя, или указанный порт может быть неверным. По умолчанию, если порт не указан, сборщик попытается подключиться к порту номер 443.

    1. Выполните команду ping *ServerName*. com с устройства.
    2. В случае сбоя шага 1 Попробуйте подключиться к серверу vCenter с помощью IP-адреса.
    3. Найдите правильный номер порта для подключения к vCenter Server.
    4. Убедитесь, что vCenter Server работает.


## <a name="error-6005260039-appliance-might-not-be-registered"></a>Ошибка 60052/60039: возможно, устройство не зарегистрировано

- Ошибка 60052, "устройство может быть не зарегистрировано в проекте" миграция Azure ", происходит, если учетная запись Azure, используемая для регистрации устройства, имеет недостаточные разрешения.
    - Убедитесь, что учетная запись пользователя Azure, используемая для регистрации устройства, имеет по крайней мере разрешения участника на подписку.
    - Дополнительные [сведения](https://docs.microsoft.com/azure/migrate/migrate-appliance#appliance---vmware) о необходимых ролях и разрешениях Azure.
- Ошибка 60039, "устройство может быть не зарегистрировано в проекте" миграция Azure ", может произойти, если регистрация завершается неудачей, поскольку не удается найти проект" миграция Azure ", используемый для регистрации устройства.
    - В портал Azure и проверьте, существует ли проект в группе ресурсов.
    - Если проект не существует, создайте новый проект "миграция Azure" в группе ресурсов и снова зарегистрируйте устройство. [Узнайте, как](https://docs.microsoft.com/azure/migrate/how-to-add-tool-first-time#create-a-project-and-add-a-tool) создать новый проект.

## <a name="error-6003060031-key-vault-management-operation-failed"></a>Ошибка 60030/60031: сбой операции управления Key Vault

При возникновении ошибки 60030 или 60031 "не удалось выполнить операцию управления Azure Key Vault" выполните следующие действия.
- Убедитесь, что учетная запись пользователя Azure, используемая для регистрации устройства, имеет по крайней мере разрешения участника на подписку.
- Убедитесь, что учетная запись имеет доступ к хранилищу ключей, указанному в сообщении об ошибке, и повторите операцию.
- Если проблема будет повторяться, обратитесь в службу поддержки Майкрософт.
- Дополнительные [сведения](https://docs.microsoft.com/azure/migrate/migrate-appliance#appliance---vmware) о необходимых ролях и разрешениях Azure.

## <a name="error-60028-discovery-couldnt-be-initiated"></a>Ошибка 60028: не удалось инициировать обнаружение

Ошибка 60028: "не удалось инициировать обнаружение из-за ошибки. Сбой операции для указанного списка узлов или кластеров. указывает на то, что не удалось запустить обнаружение на узлах, перечисленных в сообщении об ошибке из-за проблемы при доступе или извлечении сведений о виртуальной машине. Остальные узлы успешно добавлены.

- Снова добавьте узлы, перечисленные в ошибке, с помощью параметра **Добавить узел** .
- При возникновении ошибки проверки ознакомьтесь с руководством по исправлению, чтобы исправить ошибки, а затем повторите попытку **сохранить и запустить обнаружение** .

## <a name="error-60025-azure-ad-operation-failed"></a>Ошибка 60025: сбой операции Azure AD 
Ошибка 60025: "сбой операции Azure AD. Произошла ошибка при создании или обновлении приложения Azure AD "", если учетная запись пользователя Azure, используемая для запуска обнаружения, отличается от учетной записи, используемой для регистрации устройства. Выполните одно из следующих действий.

- Убедитесь, что учетная запись пользователя, инициирующая обнаружение, совпадает с той, которая использовалась для регистрации устройства.
- Предоставьте Azure Active Directory разрешения на доступ к учетной записи пользователя, для которой происходит сбой операции обнаружения.
- Удалите группу ресурсов, созданную ранее для проекта службы "миграция Azure". Создайте другую группу ресурсов для повторного запуска.
- Дополнительные [сведения](https://docs.microsoft.com/azure/migrate/migrate-appliance#appliance---vmware) о Azure Active Directory разрешениях приложения.


## <a name="error-50004-cant-connect-to-host-or-cluster"></a>Ошибка 50004: не удается подключиться к узлу или кластеру

Ошибка 50004: "не удается подключиться к узлу или кластеру, так как не удается разрешить имя сервера. Код ошибки WinRM: 0x803381B9 "может возникать, если службе Azure DNS для устройства не удается разрешить указанный кластер или имя узла.

- Если вы видите эту ошибку в кластере, полное доменное имя кластера.
- Эта ошибка может также возникать для узлов в кластере. Это означает, что устройство может подключаться к кластеру, но кластер возвращает имена узлов, которые не являются полными доменными именами. Чтобы устранить эту ошибку, обновите файл hosts на устройстве, добавив сопоставление IP-адреса и имени узла:
    1. Откройте Блокнот с правами администратора.
    2. Откройте файл C:\Windows\System32\Drivers\etc\hosts.
    3. Добавьте IP-адрес и имя узла в строку. Повторите эти действия для каждого узла или кластера, где отображается эта ошибка.
    4. Сохраните и закройте файл hosts.
    5. Проверьте, может ли устройство подключаться к узлам с помощью приложения управления устройством. Через 30 минут вы увидите последние сведения об этих узлах в портал Azure.

## <a name="discovered-vms-not-in-portal"></a>Обнаруженные виртуальные машины, отсутствующие на портале

Если состояние обнаружения — "выполняется обнаружение", но на портале еще не отображаются виртуальные машины, подождите несколько минут:
- Виртуальная машина VMware занимает около 15 минут.
- Для каждого добавленного узла для обнаружения виртуальных машин Hyper-V потребуется около двух минут.

Если вы ждете, что состояние не изменится, выберите **Обновить** на вкладке **серверы** . Должно отобразиться количество обнаруженных серверов в службе "миграция Azure": Оценка серверов и миграция Azure: миграция сервера.

Если это не сработает и вы обнаружите серверы VMware, выполните следующие действия.

- Убедитесь, что у указанной учетной записи vCenter правильно настроены разрешения с доступом по крайней мере к одной виртуальной машине.
- Служба "миграция Azure" не может обнаружить виртуальные машины VMware, если учетной записи vCenter предоставлен доступ на уровне папки виртуальной машины vCenter. Дополнительные [сведения](tutorial-assess-vmware.md#set-the-scope-of-discovery) об области обнаружения.

## <a name="vm-data-not-in-portal"></a>Данные виртуальной машины не на портале

Если обнаруженные виртуальные машины не отображаются на портале или если данные виртуальной машины устарели, подождите несколько минут. Изменения в обнаруженных данных конфигурации виртуальной машины отображаются на портале до 30 минут. Для отображения изменений в данных приложения может потребоваться несколько часов. Если после этого времени нет данных, попробуйте обновить, как показано ниже.

1. В разделе **серверы** > **оценки Azure миграция сервера**выберите **Обзор**.
2. В разделе **Управление**выберите **работоспособность агентов**.
3. Выберите **Обновить агент**.
4. Дождитесь завершения операции обновления. Теперь вы должны увидеть актуальные сведения.

## <a name="deleted-vms-appear-in-portal"></a>Удаленные виртуальные машины отображаются на портале

Если вы удалите виртуальные машины и они по-прежнему отображаются на портале, подождите 30 минут. Если они по-прежнему отображаются, обновите, как описано выше.

## <a name="common-app-discovery-errors"></a>Общие ошибки обнаружения приложений

Служба "миграция Azure" поддерживает обнаружение приложений, ролей и функций с помощью службы "миграция Azure": Оценка серверов. В настоящее время Обнаружение приложений поддерживается только для VMware. Дополнительные [сведения](how-to-discover-applications.md) о требованиях и действиях по настройке обнаружения приложений.

Типичные ошибки обнаружения приложений приведены в таблице. 

**Ошибка** | **Причина** | **Действие**
--- | --- | --- | ---
10000: "не удалось обнаружить приложения, установленные на сервере". | Это может произойти, если операционная система компьютера не является ОС Windows или Linux. | Используйте только обнаружение приложений для Windows и Linux.
10001: "не удалось получить приложения, на которых установлен сервер". | Внутренняя ошибка-некоторые отсутствующие файлы в устройстве. | Обратитесь в службу технической поддержки Майкрософт.
10002: "не удалось получить приложения, на которых установлен сервер". | Возможно, агент обнаружения на устройстве работает неправильно. | Если проблема не будет устранена в течение 24 часов, обратитесь в службу поддержки.
10003 "не удалось получить приложения, на которых установлен сервер". | Возможно, агент обнаружения на устройстве работает неправильно. | Если проблема не будет устранена в течение 24 часов, обратитесь в службу поддержки.
10004: "не удается обнаружить установленные приложения для < > компьютерах под управлением Windows или Linux". |  Учетные данные для доступа < Windows и Linux > Компьютеры не были предоставлены в устройстве.| Добавьте учетные данные для устройства, которое имеет доступ к < компьютеров > Windows и Linux.
10005: "не удается получить доступ к локальному серверу". | Возможно, учетные данные доступа неверны. | Обновите учетные данные устройства. Убедитесь, что вы можете получить доступ к соответствующему компьютеру. 
10006: "не удается получить доступ к локальному серверу". | Это может произойти, если операционная система компьютера не является ОС Windows или Linux.|  Используйте только обнаружение приложений для Windows и Linux.
10007: "не удалось обработать полученные метаданные" | Произошла внутренняя ошибка при попытке десериализовать JSON | Свяжитесь служба поддержки Майкрософт для решения
9000/9001/9002: "не удалось обнаружить приложения, установленные на сервере". | Возможно, средства VMware не установлены или повреждены. | Установите или переустановите инструменты VMware на соответствующем компьютере и проверьте, работает ли он.
9003: не удалось обнаружить приложения, установленные на сервере "". | Это может произойти, если операционная система компьютера не является ОС Windows или Linux. | Используйте только обнаружение приложений для Windows и Linux.
9004: "не удалось обнаружить приложения, установленные на сервере". | Это может произойти, если виртуальная машина выключена. | Для обнаружения убедитесь, что виртуальная машина включена.
9005: "не удалось обнаружить приложения, установленные на виртуальной машине. | Это может произойти, если операционная система компьютера не является ОС Windows или Linux. | Используйте только обнаружение приложений для Windows и Linux.
9006/9007: "не удалось получить приложения, на которых установлен сервер". | Возможно, агент обнаружения на устройстве работает неправильно. | Если проблема не будет устранена в течение 24 часов, обратитесь в службу поддержки.
9008: "не удалось получить приложения, на которых установлен сервер". | Возможно, это внутренняя ошибка.  | TF проблема не разрешается в течение 24 часов, обратитесь в службу поддержки.
9009: "не удалось получить приложения, на которых установлен сервер". | Может произойти, если параметры контроля учетных записей Windows (UAC) на сервере являются более узкими и не позволяют обнаруживать установленные приложения. | Выполните поиск параметров "контроль учетных записей пользователей" на сервере и настройте параметр UAC на сервере на один из двух нижних уровней.
9010: "не удалось получить приложения, на которых установлен сервер". | Возможно, это внутренняя ошибка.  | TF проблема не разрешается в течение 24 часов, обратитесь в службу поддержки.
9011: "файл для скачивания с гостевого компьютера не найден на гостевой виртуальной машине" | Эта ошибка может возникнуть из-за внутренней ошибки. | Эта проблема должна автоматически разрешаться за 24 часа. Если проблема сохраняется, обратитесь в служба поддержки Майкрософт.
9012: "содержимое файла результатов пусто". | Эта ошибка может возникнуть из-за внутренней ошибки. | Эта проблема должна автоматически разрешаться за 24 часа. Если проблема сохраняется, обратитесь в служба поддержки Майкрософт.
9013: "новый временный профиль создается для каждого входа на виртуальную машину VMware". | Для каждого входа в виртуальную машину создается новый временный профиль. | Убедитесь, что имя пользователя, указанное в учетных данных гостевой виртуальной машины, имеет формат UPN.
9015: "не удается подключиться к виртуальным машинам VMware из-за недостаточных привилегий в vCenter" | Роль "гостевые операции" не включена в учетной записи пользователя vCenter | Убедитесь, что роль "гостевые операции" включена для учетной записи пользователя vCenter.
9016: "не удалось подключиться к виртуальным машинам VMware, так как агент гостевых операций не имеет данных" | Средства VMware установлены неправильно или устарели. | Убедитесь, что средства VMware установлены правильно и не устарели.
9017: "файл с обнаруженными метаданными не найден на виртуальной машине". | Эта ошибка может возникнуть из-за внутренней ошибки. | Обратитесь в служба поддержки Майкрософт для решения проблемы.
9018: "PowerShell не установлен на гостевых виртуальных машинах". | PowerShell недоступен на гостевой виртуальной машине. | Установите PowerShell на гостевой виртуальной машине.
9019: "не удается обнаружить из-за сбоев операций гостевой виртуальной машины" | Сбой гостевой операции VMware на виртуальной машине. | Убедитесь, что учетные данные виртуальной машины действительны, а имя пользователя, указанное в учетных данных гостевой виртуальной машины, имеет формат UPN.
9020: "отказано в разрешении на создание файла". | Роль, связанная с пользователем или групповой политикой, разрешает пользователю создавать файл в папке | Убедитесь, что указанный гостевой пользователь имеет разрешение на создание файла в папке. Имя папки см. в разделе **уведомления** в оценке сервера.
9021: "разрешение на создание файла запрещено в папке Temp System Path." | Версия средства VMware на виртуальной машине не поддерживается | Обновите версию средства VMware, приведенную выше 10.2.0.
9022: "получение доступа к объектам WMI запрещено". | Роль, связанная с пользователем или групповой политикой, разрешает пользователю доступ к объекту WMI. | Обратитесь в служба поддержки Майкрософт.
9023: "значение переменной среды SystemRoot пусто". | Неизвестно | Обратитесь в служба поддержки Майкрософт.
9024: "значение переменной среды TEMP пусто". | Неизвестно | Обратитесь в служба поддержки Майкрософт.
9025: "PowerShell поврежден на гостевых виртуальных машинах". | Неизвестно | Переустановите PowerShell на гостевой ВИРТУАЛЬНОЙ машине и проверьте, можно ли запустить PowerShell на гостевой виртуальной машине.
8084: "не удалось обнаружить приложения из-за ошибки VMware: <Exception from VMware>" | Устройство для переноса Azure использует API VMware для обнаружения приложений. Эта проблема может возникать, если vCenter Server возникло исключение при попытке обнаружить приложения. Сообщение об ошибке из VMware отображается в сообщении, отображаемом на портале. | Найдите сообщение в [документации по VMware](https://pubs.vmware.com/vsphere-51/topic/com.vmware.wssdk.apiref.doc/index-faults.html)и выполните действия по исправлению. Если вы не можете исправить это, обратитесь в службу поддержки Майкрософт.



## <a name="next-steps"></a>Дальнейшие действия
Настройте устройство для [VMware](how-to-set-up-appliance-vmware.md), [Hyper-V](how-to-set-up-appliance-hyper-v.md)или [физических серверов](how-to-set-up-appliance-physical.md).
