---
title: Поддержка миграции VMware в службе "миграция Azure"
description: Сведения о поддержке миграции виртуальных машин VMware в Azure Migration.
ms.topic: conceptual
ms.date: 04/15/2020
ms.openlocfilehash: eee16b244ae4f9d517bdd42a0b7f37b1494ac480
ms.sourcegitcommit: 849bb1729b89d075eed579aa36395bf4d29f3bd9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2020
ms.locfileid: "81538143"
---
# <a name="support-matrix-for-vmware-migration"></a>Матрица поддержки для миграции VMware

В этой статье приведены общие сведения о параметрах и ограничениях для переноса виртуальных машин VMware с помощью службы миграции [Azure: миграция сервера](migrate-services-overview.md#azure-migrate-server-migration-tool) . Если вы ищете информацию о том, как оценить виртуальные машины VMware для миграции в Azure, ознакомьтесь с [матрицей поддержки оценки](migrate-support-matrix-vmware.md).


## <a name="migration-options"></a>Варианты переноса

Перенести виртуальные машины VMware можно несколькими способами.

- Миграция без агента: миграция виртуальных машин не требует установки каких-либо компонентов. Вы развертываете [устройство "миграция Azure](migrate-appliance.md) " для миграции без агента.
- С миграцией на основе агента: Установите на виртуальной машине агент для репликации. Для миграции на основе агентов необходимо развернуть [устройство репликации](migrate-replication-appliance.md).

Ознакомьтесь с [этой статьей](server-migrate-overview.md) , чтобы выяснить, какой метод вы хотите использовать.

## <a name="migration-limitations"></a>Ограничения миграции

- Для репликации можно выбрать до 10 виртуальных машин. Если вы хотите перенести другие компьютеры, выполните репликацию в группы из 10.
- При миграции VMware без агента вы можете запустить до 100 репликаций одновременно.

## <a name="agentless-vmware-servers"></a>Серверы VMware без агента

**VMware** | **Сведения**
--- | ---
**VMware vCenter Server** | Версии 5,5, 6,0, 6,5 или 6,7.
**VMware vSphere узла ESXI** | Версии 5,5, 6,0, 6,5 или 6,7.
**vCenter Server разрешения** | Миграция без агента использует [устройство](migrate-appliance.md)миграции. Устройству требуются следующие разрешения:<br/><br/> - **Хранилище данных. Обзор**: Разрешить обзор файлов журнала виртуальной машины для устранения неполадок при создании и удалении моментальных снимков.<br/><br/> - **Хранилище данных. ловлевелфилеоператионс**: разрешить операции чтения, записи, удаления и переименования в браузере хранилища данных для устранения неполадок при создании и удалении моментальных снимков.<br/><br/> - **VirtualMachine. Configuration. дискчанжетраккинг**. позволяет включить или отключить отслеживание изменений дисков виртуальных машин, чтобы запрашивать измененные блоки данных между моментальными снимками.<br/><br/> - **VirtualMachine. Configuration. дисклеасе**. Разрешите операции аренды диска для виртуальной машины, чтобы прочитать диск с помощью VMware vSphere пакета средств разработки виртуальных дисков (вддк).<br/><br/> - **VirtualMachine. подготовка. алловдискакцесс**. (специально для vSphere 6,0 и более поздних версий) позволяет открыть диск на виртуальной машине для произвольного доступа на чтение с диска, использующего вддк.<br/><br/> - **VirtualMachine. подготовка. алловреадонлидискакцесс**. разрешение на открытие диска на виртуальной машине для чтения диска с помощью вддк.<br/><br/> - **VirtualMachine. подготовка. алловдискрандомакцесс**. разрешение на открытие диска на виртуальной машине для чтения диска с помощью вддк.<br/><br/> - **VirtualMachine. подготовка. алловвиртуалмачинедовнлоад**. разрешает операции чтения для файлов, связанных с виртуальной машиной, для скачивания журналов и устранения неполадок в случае сбоя.<br/><br/> -* * VirtualMachine. Снапшотманажемент. * * *: разрешение на создание моментальных снимков виртуальных машин и управление ими для репликации.<br/><br/> - **Виртуальная машина. взаимодействие. выключение**: разрешить выключение виртуальной машины во время миграции в Azure.



## <a name="agentless-vmware-vms"></a>Виртуальные машины VMware без агента

**Поддержка** | **Сведения**
--- | ---
**Поддерживаемые операционные системы** | Операционные системы [Windows](https://support.microsoft.com/help/2721672/microsoft-server-software-support-for-microsoft-azure-virtual-machines) и [Linux](https://docs.microsoft.com/azure/virtual-machines/linux/endorsed-distros) , поддерживаемые Azure, можно перенести с помощью миграции без агента.
**Необходимые изменения для Azure** | Для некоторых виртуальных машин могут потребоваться изменения, позволяющие им работать в Azure. Служба "миграция Azure" автоматически вносит эти изменения в следующие операционные системы:<br/> -Red Hat Enterprise Linux 6.5 +, 7.0 +<br/> -CentOS 6.5 +, 7.0 +</br> -SUSE Linux Enterprise Server 12 SP1 +<br/> -Ubuntu 14.04 LTS, 16.04 LTS, 18.04 LTS<br/> -Debian 7, 8<br/><br/> Для других операционных систем необходимо внести корректировки вручную перед миграцией. В соответствующих статьях содержатся инструкции о том, как это сделать.
**Загрузка Linux** | Если/boot находится в выделенной секции, он должен находиться на диске ОС, а не распределяться по нескольким дискам.<br/> Если/boot является частью корневого раздела (/), то раздел "/" должен находиться на диске ОС и не охватывать другие диски.
**Загрузка UEFI** | Виртуальные машины с загрузкой UEFI не поддерживаются для миграции.
**Размер диска** | 2 ТБ диска ОС; 8 ТБ для дисков данных.
**Ограничения дискового пространства** |  До 60 дисков на виртуальную машину.
**Зашифрованные диски и тома** | Виртуальные машины с зашифрованными дисками или томами не поддерживаются для миграции.
**Кластер общих дисков** | Не поддерживается.
**Независимые диски** | Не поддерживается.
**RDM/транзитные диски** | Если у виртуальных машин есть RDM или транзитные диски, эти диски не будут реплицированы в Azure.
**NFS** | Тома NFS, подключенные к виртуальным машинам как тома, не реплицируются.
**цели iSCSI** | Виртуальные машины с целями iSCSI не поддерживаются для миграции без агента.
**Многопутевой ввод-вывод** | Не поддерживается.
**Хранилище vMotion** | Не поддерживается. Репликация не будет работать, если виртуальная машина использует операцию Storage vMotion.
**Объединенные сетевые карты** | Не поддерживается.
**Протокол** | Не поддерживается.
**Целевой диск** | Виртуальные машины можно перенести только на управляемые диски (стандартный HDD, SSD уровня "Премиум") в Azure.
**Одновременная репликация** | 100 виртуальных машин на vCenter Server. Если у вас больше, перенесите их в пакетах 100.


## <a name="agentless-azure-migrate-appliance"></a>Устройство без агента — служба "миграция Azure" 

Миграция без агента использует [устройство "миграция Azure](migrate-appliance.md)". Вы можете развернуть устройство как виртуальную машину VMWare с помощью шаблона OVA, импортированного в vCenter Server или с помощью [скрипта PowerShell](deploy-appliance-script.md).

- Сведения о [требованиях к устройству](migrate-appliance.md#appliance---vmware) для VMware.
- Узнайте о URL-адресах, которые требуются устройству в [общедоступных](migrate-appliance.md#public-cloud-urls) и [правительственных](migrate-appliance.md#government-cloud-urls) облаках.
- В Azure для государственных организаций необходимо развернуть устройство с помощью скрипта.

## <a name="agentless-ports"></a>Порты без агента

**Устройство** | **Соединен**
--- | ---
прибор. | Исходящие подключения через порт 443 для передачи реплицируемых данных в Azure, а также для взаимодействия со службами Службы "миграция Azure", координирующими репликацию и миграцию.
Сервер vCenter | Входящие подключения через порт 443, чтобы разрешить устройству управлять репликацией — создание моментальных снимков, копирование данных, освобождение моментальных снимков
узел vSphere/EXSI | Входящий трафик через TCP-порт 902, чтобы устройство реплицирует данные из моментальных снимков.


## <a name="agent-based-vmware-servers"></a>Серверы VMware на основе агентов
В этой таблице приведены сводные сведения о поддержке и ограничениях для серверов виртуализации VMware.

**Требования к VMware** | **Сведения**
--- | ---
**VMware vCenter Server** | Версии 5,5, 6,0, 6,5 или 6,7.
**VMware vSphere узла ESXI** | Версии 5,5, 6,0, 6,5 или 6,7.
**vCenter Server разрешения** | Учетная запись только для чтения для vCenter Server.

## <a name="agent-based-vmware-vms"></a>Виртуальные машины VMware на основе агентов

В таблице представлена сводная информация о поддержке виртуальных машин VMware, которые требуется перенести с помощью миграции на основе агентов.

**Поддержка** | **Сведения**
--- | ---
**Рабочая нагрузка компьютера** | Служба "миграция Azure" поддерживает миграцию любой рабочей нагрузки (например, Active Directory, SQL Server и т. д.), выполняющейся на поддерживаемом компьютере.
**Операционные системы** | Для получения последних сведений ознакомьтесь с [поддержкой операционной системы](../site-recovery/vmware-physical-azure-support-matrix.md#replicated-machines) для Site Recovery. Служба "миграция Azure" обеспечивает идентичную поддержку операционной системы виртуальных машин.
**Файловая система Linux или гостевое хранилище** | Для получения последних сведений ознакомьтесь с [поддержкой файловой системы Linux](../site-recovery/vmware-physical-azure-support-matrix.md#linux-file-systemsguest-storage) для Site Recovery. Служба "миграция Azure" имеет идентичную поддержку файловой системы Linux.
**Сеть и хранилище** | Для получения последних сведений ознакомьтесь с требованиями к [сети](../site-recovery/vmware-physical-azure-support-matrix.md#network) и [хранилищу](../site-recovery/vmware-physical-azure-support-matrix.md#storage) для Site Recovery. Служба "миграция Azure" предоставляет идентичные требования к сети или хранилищу.
**Требования Azure** | Для получения последних сведений ознакомьтесь с требованиями к сети, [хранилищу](../site-recovery/vmware-physical-azure-support-matrix.md#azure-storage)и [вычислениям](../site-recovery/vmware-physical-azure-support-matrix.md#azure-compute) [Azure](../site-recovery/vmware-physical-azure-support-matrix.md#azure-vm-network-after-failover)для Site Recovery. Служба "миграция Azure" имеет одинаковые требования к миграции VMware.
**Служба Mobility Service** | Агент службы Mobility Service должен быть установлен на каждой виртуальной машине, которую необходимо перенести.
**Загрузка UEFI** | Перенесенная виртуальная машина в Azure будет автоматически преобразована в загрузочную виртуальную машину BIOS.<br/><br/> На диске ОС должно быть до четырех разделов, а тома должны быть отформатированы с помощью NTFS.
**Целевой диск** | Виртуальные машины можно перенести только на управляемые диски (стандартный HDD, SSD уровня "Премиум") в Azure.
**Размер диска** | 2 ТБ диска ОС; 8 ТБ для дисков данных.
**Ограничения дискового пространства** |  До 63 дисков на виртуальную машину.
**Зашифрованные диски и тома** | Виртуальные машины с зашифрованными дисками или томами не поддерживаются для миграции.
**Кластер общих дисков** | Не поддерживается.
**Независимые диски** | Поддерживается.
**Транзитные диски** | Поддерживается.
**NFS** | Тома NFS, подключенные к виртуальным машинам как тома, не реплицируются.
**цели iSCSI** | Виртуальные машины с целями iSCSI не поддерживаются для миграции без агента.
**Многопутевой ввод-вывод** | Не поддерживается.
**Хранилище vMotion** | Поддерживается
**Объединенные сетевые карты** | Не поддерживается.
**Протокол** | Не поддерживается.




## <a name="agent-based-replication-appliance"></a>Устройство репликации на основе агентов 

При настройке устройства репликации с помощью шаблона OVA, предоставленного в центре миграции Azure, устройство работает под управлением Windows Server 2016 и соответствует требованиям поддержки. Если вручную настроить устройство репликации на физическом сервере, убедитесь, что оно соответствует требованиям.

- Узнайте о [требованиях к устройству репликации](migrate-replication-appliance.md#appliance-requirements) для VMware.
- На устройстве должна быть установлена MySQL. Сведения о [вариантах установки](migrate-replication-appliance.md#mysql-installation).
- Сведения о URL-адресах, к которым устройство репликации должно иметь доступ в [общедоступных](migrate-replication-appliance.md#url-access) и [правительственных](migrate-replication-appliance.md#azure-government-url-access) облаках.
- Проверьте [порты](migrate-replication-appliance.md#port-access) , к которым требуется доступ устройству репликации.

## <a name="agent-based-ports"></a>Порты на основе агентов

**Устройство** | **Соединен**
--- | ---
Виртуальные машины | Служба Mobility Service, работающая на виртуальных машинах, обменивается данными с локальным устройством репликации (сервером конфигурации) через порт HTTPS 443 Inbound для управления репликацией.<br/><br/> Виртуальные машины отправляют данные репликации на сервер обработки (запущенный на компьютере сервера конфигурации) через HTTPS-порт 9443 для входящих подключений. Этот порт можно изменить.
Устройство репликации | Устройство репликации управляет репликацией с помощью Azure через порт HTTPS 443 Outbound.
Сервер обработки | Сервер обработки получает данные репликации, оптимизирует и шифрует их и отправляет в службу хранилища Azure по исходящему порту 443.<br/> По умолчанию сервер обработки запускается на устройстве репликации.

## <a name="azure-vm-requirements"></a>Требования для виртуальных машин Azure

Все локальные виртуальные машины, реплицируемые в Azure, должны соответствовать требованиям к виртуальным машинам Azure, приведенным в этой таблице. Если Site Recovery выполняет проверку предварительных требований для репликации, проверка завершится ошибкой, если некоторые требования не будут выполнены.

**Компонент** | **Requirements** | **Сведения**
--- | --- | ---
Операционная система на виртуальной машине | Проверяет поддерживаемые операционные системы виртуальных машин VMware для миграции.<br/> Можно выполнить миграцию любой рабочей нагрузки, работающей в поддерживаемой операционной системе. | Если не поддерживается, проверка завершается ошибкой.
Архитектура операционной системы на виртуальной машине | 64-разрядная | Если не поддерживается, проверка завершается ошибкой.
Размер диска операционной системы | До 2048 ГБ | Если не поддерживается, проверка завершается ошибкой.
Число дисков операционной системы | 1 | Если не поддерживается, проверка завершается ошибкой.
Число дисков с данными | 64 ГБ и меньше | Если не поддерживается, проверка завершается ошибкой.
Размер диска данных | До 4095 ГБ | Если не поддерживается, проверка завершается ошибкой.
Сетевые адаптеры | Поддерживаются несколько адаптеров. |
Общий виртуальный жесткий диск | Не поддерживается. | Если не поддерживается, проверка завершается ошибкой.
Диск FC | Не поддерживается. | Если не поддерживается, проверка завершается ошибкой.
BitLocker | Не поддерживается. | Прежде чем включать репликацию для компьютера, необходимо отключить BitLocker.
имя виртуальной машины; | От 1 до 63 символов.<br/> при этом допустимы только буквы, цифры и дефисы<br/><br/> Имя компьютера должно начинаться и заканчиваться буквой или цифрой. |  Обновите значение в свойствах компьютера в службе Site Recovery.
Подключение после миграции — Windows | Чтобы подключиться к виртуальным машинам Azure под Windows после миграции, выполните следующие действия.<br/> — Перед миграцией разрешает RDP на локальной виртуальной машине. Убедитесь в том, что правила для протоколов TCP и UDP для **общедоступного** профиля добавлены, а протокол RDP разрешен в разделе **Брандмауэр Windows** > **Разрешенные программы** для всех профилей.<br/> Для доступа к VPN типа "сеть — сеть" Включите RDP и разрешите RDP в **брандмауэре** -> Windows**Разрешенные приложения и компоненты** для **доменов и частных** сетей. Кроме того, убедитесь, что для политики SAN операционной системы задано значение **OnlineAll**. [Подробнее](prepare-for-migration.md). |
Подключение после миграции — Linux | Чтобы подключиться к виртуальным машинам Azure после миграции с помощью SSH, сделайте следующее:<br/> Перед миграцией на локальном компьютере убедитесь, что служба Secure Shell настроена на запуск, а правила брандмауэра разрешают SSH-подключение.<br/> После отработки отказа на виртуальной машине Azure разрешите входящие подключения к порту SSH для правил группы безопасности сети на виртуальной машине, на которую выполнен переход, и для подсети Azure, к которой он подключен. Кроме того, добавьте общедоступный IP-адрес для виртуальной машины. |  


## <a name="next-steps"></a>Дальнейшие шаги

[Выберите](server-migrate-overview.md) вариант миграции VMware.
