---
title: Оценка готовности физических серверов к миграции в Azure с помощью средства оценки серверов службы "Миграция Azure"
description: В этой статье описывается, как оценивать локальные физические серверы на готовность к миграции в Azure с помощью средства оценки серверов службы "Миграция Azure".
ms.topic: tutorial
ms.date: 04/15/2020
ms.openlocfilehash: 21ffc425ff7d04bbb1bc0c3a550133ae5374b1e9
ms.sourcegitcommit: e69bb334ea7e81d49530ebd6c2d3a3a8fa9775c9
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/27/2020
ms.locfileid: "88950108"
---
# <a name="assess-physical-servers-with-azure-migrateserver-assessment"></a>Оценка готовности физических серверов с помощью средства оценки серверов Миграции Azure

В этой статье показано, как оценивать локальные физические серверы с помощью средства оценки серверов Миграции Azure.

Служба [Миграция Azure](migrate-services-overview.md) объединяет в себе инструменты, которые используются для поиска, оценки и переноса приложений, инфраструктуры и рабочих нагрузок в Microsoft Azure. Она включает в себя инструменты Миграции Azure и предложения независимых поставщиков программного обеспечения.

Это руководство является вторым в серии, в которой показано, как оценивать и переносить физические серверы в Azure. В этом руководстве описано следующее:
> [!div class="checklist"]
> * Настройка проекта службы "Миграция Azure".
> * Настройка устройства службы "Миграция Azure", работающего локально, для оценки физических серверов.
> * Запуск непрерывного обнаружения локальных физических серверов. Устройство отправляет данные конфигурации и производительности для обнаруженных серверов в Azure.
> * Обнаруженные серверы группируются, после чего проводится оценка группы серверов.
> * Просмотр оценки.

> [!NOTE]
> В руководствах показан простейший путь развертывания сценария, использование которого позволяет быстро настроить проверку концепции. В руководствах по возможности используются параметры по умолчанию и показаны не все возможные параметры и пути. Для получения подробных инструкций ознакомьтесь со статьями с инструкциями.

Если у вас еще нет подписки Azure, [создайте бесплатную учетную запись](https://azure.microsoft.com/pricing/free-trial/), прежде чем начинать работу.


## <a name="prerequisites"></a>Предварительные требования

- [Завершите](tutorial-prepare-physical.md) работу с первым руководством в этой серии. Если этого не сделать, инструкции в этом руководстве не будут работать.
- В первом руководстве вы должны были выполнить следующие действия.
    - [Настройка разрешений Azure](tutorial-prepare-physical.md) для службы "Миграция Azure".
    - [Подготовка физических серверов](tutorial-prepare-physical.md#prepare-for-physical-server-assessment) к оценке. Необходимо проверить требования к устройству. Необходимо также настроить учетную запись для обнаружения физических серверов. Требуемые порты должны быть доступны, а также необходимо знать URL-адреса, которые нужны для доступа к Azure.




## <a name="set-up-an-azure-migrate-project"></a>Настройка проекта службы "Миграция Azure"

Настройте новый проект службы "Миграция Azure" следующим образом.

1. На портал Azure выберите **Все службы** и найдите службу **Миграция Azure**.
2. В разделе **Службы** выберите **Миграция Azure**.
3. В разделе **Обзор** в области **Обнаружение, оценка и перенос серверов** щелкните **Оценка и миграция серверов**.

    ![Обнаружение и оценка серверов](./media/tutorial-assess-physical/assess-migrate.png)

4. В разделе **Приступая к работе** щелкните **Добавить инструменты**.
5. В разделе **Проект миграции** выберите подписку Azure и создайте группу ресурсов, если у вас ее нет.  
6. В разделе **Сведения о проекте** укажите имя проекта и регион для создания проекта. Просмотрите список поддерживаемых регионов для [общедоступного](migrate-support-matrix.md#supported-geographies-public-cloud) облака и облака для [государственных организаций](migrate-support-matrix.md#supported-geographies-azure-government).

    - Географический регион проекта используется только для хранения обнаруженных метаданных локальных серверов.
    - При выполнении миграции можно выбрать любой целевой регион.

    ![Создание проекта службы "Миграция Azure"](./media/tutorial-assess-physical/migrate-project.png)


7. Щелкните **Далее**.
8. В области **Выберите инструмент оценки** выберите **Azure Migrate: Server Assessment (Миграция Azure: оценка сервера)**  > **Далее**.

    ![Создание проекта службы "Миграция Azure"](./media/tutorial-assess-physical/assessment-tool.png)

9. В области **Выберите инструмент миграции** выберите **Пропустить добавление инструмента миграции** > **Далее**.
10. В области **Review + add tools** (Проверка и добавление инструментов) проверьте параметры и щелкните **Add tools** (Добавить инструменты).
11. Развертывание проекта службы "Миграция Azure" может занять несколько минут. После этого откроется страница проекта. Если проект не отображается, доступ к нему можно получить в разделе **Серверы** на панели мониторинга службы "Миграция Azure".


## <a name="set-up-the-azure-migrate-appliance"></a>Настройка устройства службы "Миграция Azure"

Миграция Azure Средство оценки серверов запускает упрощенное устройство.

- Это устройство выполняет обнаружение физических серверов и инициирует отправку метаданных и данных производительности в средство "Оценка серверов" службы "Миграция Azure".
- Чтобы настроить устройство, сделайте следующее.
    - Скачайте ZIP-файл со скриптом установщика службы "Миграция Azure" с портала Azure.
    - Извлеките содержимое ZIP-файла. Откройте консоль PowerShell с правами администратора.
    - Выполните скрипт PowerShell, чтобы запустить веб-приложение устройства.
    - Настройте устройство в первый раз и зарегистрируйте его в проекте службы "Миграция Azure".
- Для одного проекта службы "Миграция Azure" можно настроить несколько устройств. На всех устройствах можно обнаруживать любое количество физических серверов. На одном устройстве можно обнаруживать не более 1000 серверов.

### <a name="generate-the-azure-migrate-project-key"></a>Создание ключа проекта службы "Миграция Azure"

1. Последовательно выберите разделы **Цели миграции** > **Серверы** > **Azure Migrate: оценка серверов** и щелкните **Обнаружить**.
2. В разделе **Обнаружение компьютеров** > **Ваши компьютеры виртуализированы?** выберите **Физическое или другое (AWS, GCP, Xen и т. д.)** .
3. В разделе **1. Создание ключа проекта Миграции Azure** укажите имя модуля службы "Миграция Azure", которое вы настроите для обнаружения физических или виртуальных серверов. Это имя должно состоять из букв и цифр (не более 14 символов).
1. Щелкните **Создать ключ**, чтобы начать создание необходимых ресурсов Azure. Не закрывайте страницу "Обнаружение компьютеров" во время создания ресурсов.
1. После успешного создания ресурсов Azure будет создан **ключ проекта службы "Миграция Azure"** .
1. Скопируйте этот ключ, так как он понадобится вам для завершения регистрации модуля во время его настройки.

### <a name="download-the-installer-script"></a>Скачивание скрипта установщика

В разделе **2: Скачайте модуль "Миграция Azure"** щелкните действие **Скачать**.

   ![Выделенные фрагменты области "Обнаружение компьютеров"](./media/tutorial-assess-physical/servers-discover.png)


   ![Выделенный фрагмент области создания ключа](./media/tutorial-assess-physical/generate-key-physical.png)


### <a name="verify-security"></a>Проверка безопасности

Прежде чем развертывать сжатый ZIP-файл, убедитесь, что он не поврежден.

1. На компьютере, на который был скачан файл, откройте командное окно с правами администратора.
2. Выполните следующую команду, чтобы создать хэш ZIP-файла.
    - ```C:\>CertUtil -HashFile <file_location> [Hashing Algorithm]```
    - Пример использования для общедоступного облака: ```C:\>CertUtil -HashFile C:\Users\administrator\Desktop\AzureMigrateInstaller-Server-Public.zip SHA256 ```.
    - Пример использования для облака для государственных организаций: ```  C:\>CertUtil -HashFile C:\Users\administrator\Desktop\AzureMigrateInstaller-Server-USGov.zip SHA256 ```.
3.  Проверьте последние версии и хэш-значения устройств:
    - Для общедоступного облака:

        **Сценарий** | **Загрузка*** | **Значение хэша**
        --- | --- | ---
        Физическое (85 МБ) | [Последняя версия](https://go.microsoft.com/fwlink/?linkid=2140334) | 6de88e229c2b4836d16ce03fdfac93b5c27274945577bd8a359d598cf3777b24

    - Для Azure для государственных организаций:

        **Сценарий** | **Загрузка*** | **Значение хэша**
        --- | --- | ---
        Физическое (85 МБ) | [Последняя версия](https://go.microsoft.com/fwlink/?linkid=2140338) | 5a4715a9d10e81a5f38192b7d1c6ac0919ae3998afbf2e933c99bafae6bef80e

### <a name="run-the-azure-migrate-installer-script"></a>Запуск скрипта установщика службы "Миграция Azure"

Скрипт установщика выполняет следующие операции.

- Устанавливает агенты и веб-приложения для обнаружения и оценки физических серверов.
- Устанавливает роли Windows, включая службу активации Windows, IIS и интегрированную среду разработку PowerShell.
- Скачивает и устанавливает доступный для записи модуль IIS. [Подробнее](https://www.microsoft.com/download/details.aspx?id=7435).
- Обновляет раздел реестра (HKLM), используя постоянные значения параметров для службы "Миграция Azure".
- Создает следующие файлы по указанному пути.
    - **Файлы конфигурации**: %Programdata%\Microsoft Azure\Config
    - **Файлы журнала**: %Programdata%\Microsoft Azure\Logs

Выполните скрипт следующим образом:

1. Извлеките ZIP-файл в папку на сервере, на котором будет размещен модуль.  Убедитесь, что скрипт не выполняется на виртуальной машине в существующем устройстве Миграции Azure.
2. Запустите PowerShell на указанном сервере с повышенными правами (права администратора).
3. Измените каталог PowerShell на папку, в которую было извлечено содержимое скачанного ZIP-файла.
4. Запустите скрипт с именем **AzureMigrateInstaller.ps1**, выполнив следующую команду:

    - Для общедоступного облака: 
    
        ``` PS C:\Users\administrator\Desktop\AzureMigrateInstaller-Server-Public> .\AzureMigrateInstaller.ps1 ```
    - Для Azure для государственных организаций: 
    
        ``` PS C:\Users\Administrators\Desktop\AzureMigrateInstaller-Server-USGov>.\AzureMigrateInstaller.ps1 ```

    После успешного завершения скрипт запустит веб-приложение устройства.

Журналы скриптов для устранения неполадок см. здесь: C:\ProgramData\Microsoft Azure\Logs\AzureMigrateScenarioInstaller_<em>Timestamp</em>.log.

### <a name="verify-appliance-access-to-azure"></a>Проверка доступа устройства к Azure

Убедитесь, что устройство может подключиться к URL-адресам Azure для [общедоступного](migrate-appliance.md#public-cloud-urls) облака и облака для [государственных организаций](migrate-appliance.md#government-cloud-urls).


### <a name="configure-the-appliance"></a>Настройка устройства

Настройте устройство в первый раз.

1. Откройте браузер на любом компьютере, который может подключиться к устройству, и откройте URL-адрес веб-приложения устройства: **https://*имя или IP-адрес устройства*: 44368**.

   Кроме того, вы можете открыть приложение с рабочего стола, щелкнув ярлык приложения.
2. Примите **условия лицензии** и прочитайте информацию от сторонних производителей.
1. В веб-приложении выберите **Настройка необходимых компонентов** и выполните приведенные ниже действия.
    - **Возможность подключения**: Приложение проверит наличие доступа к Интернету у сервера. Если на сервере используется прокси-сервер:
        - Щелкните **Настройка прокси-сервера** и укажите адрес прокси-сервера (в формате http://ProxyIPAddress или http://ProxyFQDN) ) и порт прослушивания.
        - Укажите учетные данные, если для прокси-сервера требуется аутентификация.
        - Поддерживается только прокси-сервер HTTP.
        - Если вы добавили сведения о прокси-сервере или отключили его и (или) проверку подлинности, щелкните **Сохранить**, чтобы снова запустить проверку подключения.
    - **Синхронизация времени**: время проверяется. Для правильной работы обнаружения серверов время на устройстве должно быть синхронизировано со временем в Интернете.
    - **Установка обновлений**: Средство "Оценка сервера" службы "Миграция Azure" проверяет, установлены ли в модуле последние обновления. После завершения проверки вы можете щелкнуть пункт **View appliance services** (Просмотр служб модуля), чтобы просмотреть состояние и версии компонентов, используемых модулем.

### <a name="register-the-appliance-with-azure-migrate"></a>Регистрация устройства с помощью службы "Миграция Azure"

1. Вставьте **ключ проекта службы "Миграция Azure"** , скопированный с портала. Если у вас нет ключа, последовательно выберите **Server Assessment > Discover > Manage existing appliances** (Оценка сервера > Обнаружение > Управление имеющимися модулями), выберите имя модуля, указанное вами во время создания ключа, и скопируйте соответствующий ключ.
1. Щелкните **Войти**. На новой вкладке браузера откроется окно входа в Azure. Если этот параметр не отображается, убедитесь, что в браузере отключена блокировка всплывающих окон.
1. В новой вкладке выполните вход, используя имя пользователя и пароль Azure.
   
   Вход с помощью PIN-кода не поддерживается.
3. После входа вернитесь к веб-приложению. 
4. Если учетная запись пользователя Azure, используемая для ведения журнала, имеет необходимые [разрешения](tutorial-prepare-physical.md) на ресурсы Azure, созданные во время создания ключа, будет инициирована регистрация модуля.
1. После регистрации модуля вы можете просмотреть сведения о регистрации, щелкнув **Просмотреть подробности**.


## <a name="start-continuous-discovery"></a>Запуск непрерывного обнаружения

Далее подключитесь с устройства к физическим серверам, которые требуется обнаружить, и запустите процесс обнаружения.

1. В разделе **Шаг 1. Указание учетных данных для обнаружения физических или виртуальных серверов Windows и Linux** щелкните действие **Добавить учетные данные**, затем укажите понятное имя для этих учетных данных, значения **Имя пользователя** и **Пароль** для доступа к серверу Windows или Linux. Щелкните **Save**(Сохранить).
1. Если вы хотите добавить несколько учетных данных одновременно, щелкните **Добавить еще**, чтобы сохранить и добавить дополнительные учетные данные. Для обнаружения физических серверов можно ввести несколько учетных данных.
1. В разделе **Шаг 2. Указание сведений о физическом или виртуальном сервере** щелкните **Добавить источник обнаружения**, чтобы указать значение **IP-адрес или полное доменное имя** сервера и понятное имя учетных данных для подключения к серверу.
1. За один раз можно выбрать пункт **Add single item** (Добавить один элемент) или **Add multiple items** (Добавить несколько элементов). Здесь также есть параметр **Импорт CSV** для предоставления сведений о сервере.

    ![Выбранные элементы для добавления источника обнаружения](./media/tutorial-assess-physical/add-discovery-source-physical.png)

    - Если вы выберете пункт **Add single item** (Добавить один элемент), вы сможете выбрать тип операционной системы, указать понятное имя для учетных данных и ввести **IP-адрес или полное доменное имя** для нужного сервера, а затем щелкнуть **Сохранить**.
    - Если вы выберете пункт **Add multiple items** (Добавить несколько элементов), вы сможете добавить несколько записей одновременно, указав в текстовом поле **IP-адрес или полное доменное имя** с понятным именем для учетных данных. Щелкните **Проверить**, чтобы проверить добавленные записи, а затем нажмите кнопку **Сохранить**.
    - Если вы выберете пункт **Импорт CSV** _(он выбран по умолчанию)_ , вы сможете скачать CSV-файл шаблона и указать в нем **IP-адрес или полное доменное имя сервера** и понятное имя для учетных данных. Затем импортируйте файл в виртуальный модуль, нажмите кнопку **Проверить** для проверки записей в файле и щелкните **Сохранить**.

1. При нажатии кнопки "Сохранить" модуль попытается проверить подключение к добавленным серверам и отобразит **состояние проверки** в таблице для каждого из них.
    - Если проверка сервера завершилась неудачно, просмотрите ошибку, щелкнув пункт **Проверка не пройдена** в столбце "Состояние" таблицы. Устраните проблему и выполните проверку еще раз.
    - Чтобы удалить сервер, щелкните **Удалить**.
1. Вы можете **повторно проверить** подключение к серверам в любое время до начала обнаружения.
1. Щелкните **Начать обнаружение**, чтобы запустить обнаружение успешно проверенных серверов. После успешного запуска обнаружения вы можете проверить состояние обнаружения для каждого сервера в таблице.


Запустится обнаружение. Чтобы метаданные обнаруженного сервера отобразились на портале Azure, потребуется около 2 минут на каждый сервер.

### <a name="verify-servers-in-the-portal"></a>Проверка серверов на портале

После обнаружения можно проверить, отображаются ли серверы на портале Azure.

1. Откройте панель мониторинга службы "Миграция Azure".
2. На странице **Azure Migrate — Servers** > **Azure Migrate: Server Assessment** (Миграция Azure — серверы > Миграция Azure: оценка сервера) щелкните значок, отображающий количество **обнаруженных серверов**.

## <a name="set-up-an-assessment"></a>Настройка оценки

Существует два типа оценки, которые можно создать с помощью средства "Оценка серверов" службы "Миграция Azure".

**Оценка** | **Сведения** | **Data**
--- | --- | ---
**На основе производительности** | Оценки на основе собранных данных производительности | **Рекомендуемый размер виртуальной машины**: на основе данных об использовании ЦП и памяти.<br/><br/> **Рекомендуемый тип диска (управляемый диск цен. категории "Стандартный" или "Премиум")** : на основе операций ввода-вывода в секунду и пропускной способности локальных дисков.
**Как в локальной среде** | Оценки на основе определения размера в локальной среде. | **Рекомендуемый размер виртуальной машины**: на основе размера локального сервера.<br/><br> **Рекомендуемый тип диска**: на основе параметра типа хранилища, выбранного для оценки.


### <a name="run-an-assessment"></a>Запуск оценки

Запустите оценку следующим образом:

1. Просмотрите [рекомендации](best-practices-assessment.md) для создания оценок.
2. На вкладке **Серверы** на плитке **Azure Migrate: Server Assessment** (Миграция Azure: оценка сервера) щелкните **Оценка**.

    ![Оценка](./media/tutorial-assess-physical/assess.png)

2. В разделе **Оценка серверов** укажите имя для оценки.
3. Щелкните **Просмотреть все**, чтобы просмотреть свойства оценки.

    ![Свойства оценки](./media/tutorial-assess-physical/view-all.png)

3. В разделе **Создание или выбор группы** выберите **Создать** и укажите имя группы. В группе объединяются один или несколько серверов для оценки.
4. В разделе **Добавление компьютеров в группу** выберите серверы, которые необходимо добавить в группу.
5. Щелкните **Создать оценку**, чтобы создать группу и запустить оценку.

    ![Создание оценки](./media/tutorial-assess-physical/assessment-create.png)

6. После создания оценки просмотрите ее, выбрав **Серверы** > **Azure Migrate: Server Assessment** >  (Миграция Azure: оценка сервера) **Оценки**.
7. Щелкните **Экспорт оценки**, чтобы скачать оценку в виде файла Excel.



## <a name="review-an-assessment"></a>Проверка оценки

В результатах оценки описывается:

- **готовность к работе в Azure**: подходят ли серверы для миграции в Azure;
- **примерную ежемесячную стоимость**: оценочная месячная стоимость вычислений и хранения для работы серверов в Azure;
- **примерную стоимость хранилища в месяц**: расчетную стоимость хранилища дисков после миграции.

### <a name="view-an-assessment"></a>Просмотр оценки

1. В разделе **Цели миграции** >  **Серверы** щелкните **Оценки** в области **Azure Migrate: Server Assessment** (Миграция Azure: оценка сервера).
2. В разделе **Оценки** щелкните оценку, чтобы открыть сведения о ней.

    ![Сводка оценки](./media/tutorial-assess-physical/assessment-summary.png)

### <a name="review-azure-readiness"></a>Проверка готовности к работе в Azure

1. В разделе **Готовность к работе в Azure** проверьте, готовы ли серверы к миграции в Azure.
2. Проверьте состояние.
    - **Готово к работе в Azure**: служба "Миграция Azure" рекомендует размер и стоимость виртуальных машин в оценке.
    - **Готово при выполнении условий**: отображает проблемы и предлагаемые способы исправления.
    - **Не готово для Azure**: отображает проблемы и предлагаемые способы исправления.
    - **Уровень готовности неизвестен**: используется, когда служба "Миграция Azure" не может оценить готовность из-за проблем с доступностью данных.

2. Щелкните состояние **Готовность к работе в Azure**. Вы можете просмотреть сведения о готовности сервера и сведения о самом сервере, в том числе параметры вычислительной среды, хранилища и сети.



### <a name="review-cost-details"></a>Просмотр сведений о затратах

В этом представлении отображается оценочная стоимость вычислений и хранения для запуска виртуальных машин в Azure.

1. Просмотрите ежемесячные затраты на вычисления и хранение. Затраты суммируются для всех серверов в оцениваемой группе.

    - Оценки стоимости основаны на рекомендациях по размеру компьютера, его дисков и свойств.
    - Показана расчетная месячная стоимость вычислений и хранения.
    - Приводится оценка затрат на выполнение локальных серверов в виде виртуальных машин IaaS. Средство "Оценка серверов" службы "Миграция Azure" не учитывает затраты на PaaS или SaaS.

2. Вы можете просмотреть примерную стоимость хранилища в месяц. В этом представлении показаны совокупные затраты на хранение для оцениваемой группы, распределенные по дискам хранения разных типов.
3. Вы можете воспользоваться детализацией для просмотра сведений об определенных серверах.


### <a name="review-confidence-rating"></a>Просмотр рейтинга достоверности

При запуске оценок на основе производительности для них назначается оценка достоверности.

![Оценка достоверности](./media/tutorial-assess-physical/confidence-rating.png)

- Можно получить оценку от 1 звезды (самая низкая) до 5 звезд (самая высокая).
- Оценка достоверности помогает определить надежность рекомендаций по выбору размера, предоставленных оценкой.
- Оценка достоверности назначается на основе доступности точек данных, необходимых для вычисления оценки.

Ниже приведены оценки достоверности.

**Доступность точки данных** | **Оценка достоверности**
--- | ---
0–20 % | 1 звезда
21–40 % | 2 звезды
41–60 % | 3 звезды
61–80 % | 4 звезды
81–100 % | 5 звезд

Дополнительные сведения о рекомендациях для оценки достоверности см. [здесь](best-practices-assessment.md#best-practices-for-confidence-ratings).


## <a name="next-steps"></a>Дальнейшие действия

Изучив это руководство, вы:

> [!div class="checklist"]
> * Настроили устройство службы "Миграция Azure".
> * Создали и проверили оценку.

Перейдите к третьему руководству из этой серии, чтобы узнать, как перенести физические серверы в Azure с помощью службы "Миграция Azure": Миграции Azure.

> [!div class="nextstepaction"]
> [Перенос физических серверов](./tutorial-migrate-physical-virtual-machines.md)
