---
title: Анализ зависимостей в Azure — Оценка сервера
description: Описывает, как использовать анализ зависимостей для оценки с помощью функции "Миграция серверов в Azure".
ms.topic: conceptual
ms.date: 04/15/2020
ms.openlocfilehash: f0b956620895ae2264b53916015d440f5e586eb2
ms.sourcegitcommit: 849bb1729b89d075eed579aa36395bf4d29f3bd9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2020
ms.locfileid: "82024767"
---
# <a name="dependency-analysis"></a>Анализ зависимостей

В этой статье описывается анализ зависимостей в службе "миграция Azure": Оценка сервера.

## <a name="overview"></a>Обзор

Анализ зависимостей помогает определить зависимости между локальными компьютерами, которые вы хотите оценить и перенести в Azure. 

- В службе "миграция Azure": Оценка серверов. вы собираете компьютеры в группу, а затем оцениваете группу. Анализ зависимостей позволяет более точно группировать компьютеры с высокой достоверностью для оценки.
- Анализ зависимостей позволяет определять компьютеры, которые необходимо перенести вместе. Можно определить, используются ли компьютеры, или же они могут быть списаны вместо миграции.
- Анализ зависимостей позволяет убедиться, что ничего не осталось, и избежать неожиданных сбоев во время миграции.
- Анализ особенно полезен, если вы не уверены, являются ли компьютеры частью развертывания приложения, которое требуется перенести в Azure.
- [Ознакомьтесь](common-questions-discovery-assessment.md#what-is-dependency-visualization) с общими вопросами об анализе зависимостей.

Существует два варианта развертывания анализа зависимостей.

- **На основе агентов**: анализ зависимостей на основе агента требует установки агентов на каждом локальном компьютере, который необходимо проанализировать.
- Без **агента**. с помощью безагентного анализа вам не нужно устанавливать агенты на компьютерах, которые требуется перекрестно проверить. Сейчас этот параметр находится на этапе предварительной версии и доступен только для виртуальных машин VMware.

> [!NOTE]
> Анализ зависимостей на основе агента недоступен в Azure для государственных организаций. Можно использовать анализ зависимостей без агента.

## <a name="agentless-analysis"></a>Анализ без агента

Анализ зависимостей без агента работает путем записи данных о подключении TCP с компьютеров, для которых он включен. На компьютерах, которые требуется проанализировать, не установлены агенты.

### <a name="collected-data"></a>Собранные данные

После запуска обнаружения зависимостей устройство опрашивает данные с компьютеров каждые пять минут для сбора данных. Эти данные собираются с гостевых виртуальных машин через vCenter Server с помощью API-интерфейсов vSphere. Собранные данные обрабатываются на устройстве Azure Migrate, чтобы вывести сведения об удостоверениях и отправлять их в службу "миграция Azure" каждые шесть часов.

Опрос собирает эти данные с компьютеров: 
- Имя процессов, имеющих активные соединения.
- Имя приложения, выполняющего процессы, имеющие активные соединения.
- Порт назначения для активных подключений.

## <a name="agent-based-analysis"></a>Анализ на основе агентов

Для анализа на основе агентов Серверная Оценка использует [решение сопоставление служб](../azure-monitor/insights/service-map.md) в Azure Monitor для включения визуализации и анализа зависимостей. [Агент Microsoft Monitoring Agent/log Analytics](../azure-monitor/platform/agents-overview.md#log-analytics-agent) и [Агент зависимостей](../azure-monitor/platform/agents-overview.md#dependency-agent)должны быть установлены на каждом компьютере, который необходимо проанализировать.

### <a name="collected-data"></a>Собранные данные

Для анализа на основе агентов собираются следующие данные:

- Имя сервера исходного компьютера, процесс, имя приложения.
- Имя сервера конечного компьютера, процесс, имя приложения и порт.
- Количество соединений, задержка и сведения о передачи данных собираются и доступны для запросов Log Analytics. 


## <a name="compare-agentless-and-agent-based"></a>Сравнение без агента и на основе агентов

Различия между визуализацией без агента и визуализацией на основе агентов приведены в таблице.

**Требование** | **Безагентное** | **На основе агентов**
--- | --- | ---
Поддержка | Сейчас этот параметр находится на этапе предварительной версии и доступен только для виртуальных машин VMware. [Ознакомьтесь](migrate-support-matrix-vmware.md#agentless-dependency-analysis-requirements) с поддерживаемыми операционными системами. | В общем доступе (GA).
Агент | Нет необходимости устанавливать агенты на компьютерах, которые требуется перекрестно проверить. | Агенты, которые будут установлены на каждом локальном компьютере, который необходимо проанализировать: [Microsoft Monitoring Agent (MMA)](https://docs.microsoft.com/azure/log-analytics/log-analytics-agent-windows)и [Агент зависимостей](https://docs.microsoft.com/azure/azure-monitor/platform/agents-overview#dependency-agent). 
Log Analytics | Не требуется. | Служба "миграция Azure" использует решение [сопоставление служб](https://docs.microsoft.com/azure/operations-management-suite/operations-management-suite-service-map) в [журналах Azure Monitor](https://docs.microsoft.com/azure/log-analytics/log-analytics-overview) для анализа зависимостей. 
Принцип работы | Захватывает данные подключения TCP на компьютерах, включенных для визуализации зависимостей. После обнаружения он собирает данные через пять минут. | Сопоставление служб агенты, установленные на компьютере, собирают данные о TCP-процессах и входящих и исходящих подключениях для каждого процесса.
Данные | Имя сервера исходного компьютера, процесс, имя приложения.<br/><br/> Имя сервера конечного компьютера, процесс, имя приложения и порт. | Имя сервера исходного компьютера, процесс, имя приложения.<br/><br/> Имя сервера конечного компьютера, процесс, имя приложения и порт.<br/><br/> Количество соединений, задержка и сведения о передачи данных собираются и доступны для запросов Log Analytics. 
Визуализация: | Карту зависимостей отдельного сервера можно просмотреть в течение одного часа до 30 дней. | Схема зависимостей одного сервера.<br/><br/> Карту можно просматривать только в течение часа.<br/><br/> Схема зависимостей группы серверов.<br/><br/> Добавление и удаление серверов в группе из представления карт.
Экспорт данных | Сейчас невозможно скачать в табличном формате. | Данные можно запрашивать с помощью Log Analytics.



## <a name="next-steps"></a>Дальнейшие шаги
- Ознакомьтесь с требованиями к настройке анализа на основе агентов для [виртуальных машин VMware](migrate-support-matrix-vmware.md#agent-based-dependency-analysis-requirements), [физических серверов](migrate-support-matrix-physical.md#agent-based-dependency-analysis-requirements)и [виртуальных машин Hyper-V](migrate-support-matrix-hyper-v.md#agent-based-dependency-analysis-requirements).
- [Ознакомьтесь](migrate-support-matrix-vmware.md#agentless-dependency-analysis-requirements) с требованиями к безагентному анализу виртуальных машин VMware.
- [Настройка](how-to-create-group-machine-dependencies.md) визуализации зависимостей на основе агента
- [Испытайте](how-to-create-group-machine-dependencies-agentless.md) визуализацию зависимостей без агента для виртуальных машин VMware.
- Ознакомьтесь с [общими вопросами](common-questions-discovery-assessment.md#what-is-dependency-visualization) о визуализации зависимостей.


