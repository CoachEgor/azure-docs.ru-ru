---
title: Установите возможности для обнаружения VMware VM с помощью Azure Migrate
description: Описывает, как установить область обнаружения для оценки VMware VM и миграции с помощью Azure Migrate.
ms.topic: how-to
ms.date: 03/23/2020
ms.openlocfilehash: 29b3077ead168cef2790468d6ac62d1c59c24c11
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "80337640"
---
# <a name="set-discovery-scope-for-vmware-vms"></a>Установите область обнаружения для VMware VMs

В этой статье описывается, как ограничить область обнаружения для VMware VMs, обнаруженных [прибором Azure Migrate.](migrate-appliance-architecture.md)

Прибор Azure Migrate обнаруживает на месте VMware VMs при: 

- Используйте инструмент [оценки Azure Migrate:Server для](migrate-services-overview.md#azure-migrate-server-assessment-tool) оценки VM VMw для миграции в Azure.
- Используйте инструмент [Azure Migrate:Server Migration](migrate-services-overview.md#azure-migrate-server-migration-tool) для [бесагентной миграции](server-migrate-overview.md) VM VMw в Azure.

## <a name="set-discovery-scope"></a>Установка области обнаружения


После настройки прибора Azure Migrate для оценки или миграции VMware прибор начинает открывать VMs и отправлять метаданные VM в Azure. Перед подключением прибора к vCenter Server для обнаружения можно установить область обнаружения, чтобы ограничить обнаружение центрами обработки данных vCenter Server, кластерами, папкой кластеров, хостов, папкой хостов или отдельными VMs.

Чтобы настроить область, вы назначаете разрешения в учетной записи, которую использует Azure Migrate для доступа к серверу vCenter.

## <a name="create-a-vcenter-user-account"></a>Создание учетной записи vCenter

Если вы еще не создали учетную запись пользователя vCenter, которую использует прибор Azure Migrate для обнаружения, оценки и миграции VMware VMs, сделайте это первым.

1.    Войдите в веб-клиент vSphere с правами администратора vCenter Server.
2.    Выберите**пользователей и групп SSO** **администрации** > и нажмите на вкладку **пользователей.**
3.    Щелкните значок **Новый пользователь**.
4.    Заполните новую информацию о пользователе > **OK**.

Разрешения учетной записи зависят от того, что вы развертываете.

**Функция** | **Разрешения учетной записи**
--- | ---
[Оценка](tutorial-assess-vmware.md)| Учетная запись нуждается в доступе только для чтения.
[Обнаружение приложений, ролей и функций](how-to-discover-applications.md) | Учетная запись нуждается в доступе только для чтения, с привилегиями, включенными для виртуальных машин > гостевых операций.
[Анализ зависимостей (без агентов)](how-to-create-group-machine-dependencies-agentless.md) | Учетная запись нуждается в доступе только для чтения, с привилегиями, включенными для виртуальных машин > гостевых операций.
[Мигрировать (без агента)](tutorial-migrate-vmware.md) | Вам нужна роль, которая присваивается нужные разрешения.<br/><br/> Чтобы создать роль, войдите в vSphere Web Client в качестве администратора vCenter Server. Выберите экземпляр vCenter Server > **Создать роль.** Укажите имя роли, <em>например, Azure_Migrate</em>и присвоите [требуемые разрешения](migrate-support-matrix-vmware-migration.md#agentless-vmware-servers) роли.


## <a name="assign-permissions-on-vcenter-objects"></a>Назначение разрешений для объектов vCenter

Разрешения на объекты инвентаризации можно назначать одним из двух методов:

- Назначайте роль с требуемыми разрешениями учетной записи, которую вы используете, для всех родительских объектов, которые размещают VMs, которые вы хотите обнаружить/перенести.
- Кроме того, можно назначить роль и учетную запись пользователя на уровне центра обработки данных и распространить их на объекты ребенка. Затем предоставите учетную запись роль **«Нет доступа»** для каждого объекта, который вы не хотите обнаружить/перенести. Мы не рекомендуем такой подход, так как он громоздкий, и можем предоставить элементы управления доступом, потому что каждому новому объекту дочернего элемента автоматически предоставляется доступ, унаследованный от родителя.

Чтобы назначить роль учетной записи, которую вы используете для всех соответствующих объектов, сделайте следующее:

- **Для оценки**: Для оценки VM, примените роль **только для чтения** к учетной записи пользователя vCenter для всех родительских объектов, худающих ВМ, которые вы хотите открыть. Родительские объекты включали: хост, папку узлов, кластер и папку кластеров в иерархии, вплоть до центра обработки данных. Распространение этих разрешений на объекты для детей в иерархии.

    ![Назначение разрешений](./media/tutorial-assess-vmware/assign-perms.png)

- **Для бесагентной миграции:** Для бесагентной миграции примените определенную пользователем роль с [требуемыми разрешениями](migrate-support-matrix-vmware-migration.md#agentless-vmware-servers) к учетной записи пользователя для всех родительских объектов, худивающих VMs, которые вы хотите обнаружить. Вы можете назвать роль <em>Azure_Migrate</em>.

### <a name="scope-support"></a>Поддержка области

В настоящее время инструмент оценки сервера не может обнаружить VMs, если учетная запись vCenter имеет доступ, предоставленный на уровне папок vCenter VM. Поддерживаются складки узлов и кластеров.

Если вы хотите передать свое открытие папкам VM, заполните следующую процедуру, чтобы убедиться, что учетная запись vCenter имеет доступ только для чтения, назначенный на уровне VM.

1. Назначайте разрешения только на чтение на всех вм в папках VM, которые вы хотите получить для обнаружения.
2. Грант только для чтения доступ ко всем родительским объектам, которые размещает VMs.
    - Все родительские объекты (хост, папка узлов, кластер, папка кластеров) в иерархии включены в центр обработки данных.
    - Вам не нужно распространять разрешения на все дочерние объекты.
3. Используйте учетные данные для обнаружения, выбрав центр данных в качестве **области сбора данных**. Настройка управления доступом на основе ролей гарантирует, что соответствующая учетная запись пользователя vCenter имеет доступ только к vMs-интерфейса, специфичному для арендаторов.


## <a name="next-steps"></a>Дальнейшие действия

[Настройка прибора](how-to-set-up-appliance-vmware.md) и [начать непрерывное открытие.](how-to-set-up-appliance-vmware.md#start-continuous-discovery-by-providing-vcenter-server-and-vm-credential)
