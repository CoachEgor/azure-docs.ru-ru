---
title: Оценка виртуальных машин VMware с помощью средства оценки серверов Миграции Azure
description: В этой статье описывается, как оценить готовность локальных виртуальных машин VMware к миграции в Azure с помощью средства оценки серверов в службе "Миграция Azure".
ms.topic: tutorial
ms.date: 06/03/2020
ms.custom: mvc
ms.openlocfilehash: 87eac5979176fe9a71db15961e4c5f822b56568e
ms.sourcegitcommit: 79508e58c1f5c58554378497150ffd757d183f30
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/03/2020
ms.locfileid: "84331888"
---
# <a name="assess-vmware-vms-with-server-assessment"></a>Оценка виртуальных машин VMware с помощью решения оценки серверов

В этой статье описывается, как оценить локальные виртуальные машины VMware с помощью [средства оценки серверов в службе "Миграция Azure"](migrate-services-overview.md#azure-migrate-server-assessment-tool).


Это руководство является вторым в серии, в которой показано, как оценивать и переносить виртуальные машины VMware в Azure. В этом руководстве описано следующее:
> [!div class="checklist"]
> * Настройка проекта службы "Миграция Azure".
> * Настройка устройства службы "Миграция Azure", работающего локально, для оценки виртуальных машин.
> * Запуск непрерывного обнаружения локальных виртуальных машин. Устройство отправляет данные конфигурации и производительности для обнаруженных виртуальных машин в Azure.
> * Группирование обнаруженных виртуальных машин и оценка группы виртуальных машин.
> * Просмотр оценки.

> [!NOTE]
> В руководствах показан простейший путь развертывания сценария, использование которого позволяет быстро настроить проверку концепции. В руководствах по возможности используются параметры по умолчанию и показаны не все возможные параметры и пути. Для получения подробных инструкций ознакомьтесь с практическими руководствами.

Если у вас еще нет подписки Azure, [создайте бесплатную учетную запись](https://azure.microsoft.com/pricing/free-trial/), прежде чем начинать работу.

## <a name="prerequisites"></a>Предварительные требования

- [Выполните действия из первого руководства](tutorial-prepare-vmware.md) этой серии. Если этого не сделать, инструкции в этом руководстве не будут работать.
- В первом руководстве вы должны были выполнить следующие действия.
    - [Подготовить Azure](tutorial-prepare-vmware.md#prepare-azure) для работы со службой "Миграция Azure".
    - [Подготовить VMware к оценке](tutorial-prepare-vmware.md#prepare-for-vmware-vm-assessment). Этот процесс включает проверку параметров VMware и настройку учетной записи, которую может использовать служба "Миграция Azure" для доступа к vCenter Server.
    - [Проверить](tutorial-prepare-vmware.md#verify-appliance-settings-for-assessment) наличие всего необходимого для развертывания модуля "Миграция Azure" для оценки VMware.

## <a name="set-up-an-azure-migrate-project"></a>Настройка проекта службы "Миграция Azure"

Настройте новый проект службы "Миграция Azure" следующим образом.

1. На портал Azure выберите **Все службы** и найдите службу **Миграция Azure**.
1. В разделе **Службы** выберите **Миграция Azure**.
1. В разделе **Обзор** в области **Обнаружение, оценка и миграция серверов** выберите **Оценка и миграция серверов**.

   ![Кнопка оценки и миграции серверов](./media/tutorial-assess-vmware/assess-migrate.png)

1. В разделе **Начало работы** щелкните **Добавить инструменты**.
1. В разделе **Проект миграции** выберите подписку Azure и создайте группу ресурсов, если у вас ее нет.     
1. В разделе **Сведения о проекте** укажите имя проекта и регион для создания проекта. Просмотрите список поддерживаемых регионов для [общедоступного](migrate-support-matrix.md#supported-geographies-public-cloud) облака и облака для [государственных организаций](migrate-support-matrix.md#supported-geographies-azure-government).

   ![Поля для имени и региона проекта](./media/tutorial-assess-vmware/migrate-project.png)

1. Выберите **Далее**.
1. В области **Выберите инструмент оценки** выберите **Azure Migrate: Server Assessment (Миграция Azure: оценка сервера)**  > **Далее**.

   ![Выбор средства оценки серверов](./media/tutorial-assess-vmware/assessment-tool.png)

1. В области **Выберите инструмент миграции** выберите **Пропустить добавление инструмента миграции** > **Далее**.
1. В разделе **Проверка и добавление инструментов** проверьте параметры и щелкните **Добавить инструменты**.
1. Развертывание проекта службы "Миграция Azure" может занять несколько минут. После этого откроется страница проекта. Если проект не отображается, доступ к нему можно получить в разделе **Серверы** на панели мониторинга службы "Миграция Azure".

## <a name="set-up-the-azure-migrate-appliance"></a>Настройка устройства службы "Миграция Azure"

Средство оценки серверов службы "Миграция Azure" использует упрощенный модуль Миграции Azure. Этот модуль выполняет обнаружение виртуальных машин и отправляет метаданные, а также данные производительности в службу "Миграция Azure". Настроить устройство можно несколькими способами.

- Настройка на виртуальной машине VMware с помощью скачанного шаблона OVA. Это метод, используемый в этом руководстве.
- Настройка на виртуальной машине VMware или физическом компьютере с помощью скрипта установщика PowerShell. [Этот метод](deploy-appliance-script.md) следует использовать, если не удается настроить виртуальную машину с помощью шаблона OVA или если вы используете Azure для государственных организаций.

После создания модуля убедитесь, что он может подключиться к средству оценки серверов службы "Миграция Azure", выполните его первоначальную настройку и зарегистрируйте в проекте службы "Миграция Azure".


### <a name="download-the-ova-template"></a>Скачивание шаблона OVA

1. Последовательно выберите разделы **Цели миграции** > **Серверы** > **Azure Migrate: оценка серверов** и щелкните **Обнаружить**.
1. В разделе **Обнаружение компьютеров** > **Ваши компьютеры виртуализированы?** щелкните **Да, с использованием VMware vSphere Hypervisor**.
1. Щелкните **Скачать**, чтобы получить OVA-файл шаблона.

   ![Выбор параметров для скачивания OVA-файла](./media/tutorial-assess-vmware/download-ova.png)

### <a name="verify-security"></a>Проверка безопасности

Прежде чем развертывать OVA-файл, убедитесь, что он не поврежден.

1. На компьютере, на который был скачан файл, откройте командное окно с правами администратора.
2. Выполните следующую команду, чтобы создать хэш OVA-файла.
  
   ```C:\>CertUtil -HashFile <file_location> [Hashing Algorithm]```
   
   Пример использования: ```C:\>CertUtil -HashFile C:\AzureMigrate\AzureMigrate.ova SHA256```

3. Проверьте последние версии и хэш-значения устройств:

    - Для общедоступного облака Azure:
    
        **Алгоритм** | **Загрузить** | **SHA256**
        --- | --- | ---
        VMware (10,9 ГБ) | [Последняя версия](https://aka.ms/migrate/appliance/vmware) | cacbdaef927fe5477fa4e1f494fcb7203cbd6b6ce7402b79f234bc0fe69663dd

    - Для Azure для государственных организаций:
    
        **Алгоритм** | **Загрузить** | **SHA256**
        --- | --- | ---
        VMware (63,1 ГБ) | [Последняя версия](https://go.microsoft.com/fwlink/?linkid=2120300&clcid=0x409 ) | 3d5822038646b81f458d89d706832c0a2c0e827bfa9b0a55cc478eaf2757a4de


### <a name="create-the-appliance-vm"></a>Создание виртуальной машины устройства

Импортируйте скачанный файл и создайте виртуальную машину.

1. В консоли клиента vSphere выберите **File** (Файл) > **Deploy OVF Template** (Развернуть шаблон OVF).

   ![Команда меню для развертывания шаблона OVF](./media/tutorial-assess-vmware/deploy-ovf.png)

1. В мастере развертывания шаблона OVF выберите **Source** (Источник) и укажите расположение OVA-файла.
1. В полях **Name** (Имя) и **Location** (Расположение) укажите понятное имя для виртуальной машины. Выберите объект инвентаризации, в котором будет размещена эта виртуальная машина.
1. В поле **Host/Cluster** (Узел или кластер) укажите узел или кластер, в котором будет работать виртуальная машина.
1. В поле **Storage** (Хранилище) укажите место хранения данных виртуальной машины.
1. В поле **Disk Format** (Формат диска) укажите тип и размер диска.
1. В поле **Network Mapping** (Сетевое сопоставление) укажите сеть, к которой будет подключена виртуальная машина. Этой сети требуется подключение к Интернету для отправки метаданных в средство оценки серверов службы "Миграция Azure".
1. Проверьте и подтвердите параметры и нажмите кнопку **Finish** (Готово).

## <a name="verify-appliance-access-to-azure"></a>Проверка доступа устройства к Azure

Убедитесь, что виртуальная машина устройства может подключиться к URL-адресам Azure для [общедоступного](migrate-appliance.md#public-cloud-urls) облака и облака для [государственных организаций](migrate-appliance.md#government-cloud-urls).

### <a name="configure-the-appliance"></a>Настройка устройства

Настройте устройство в первый раз.

> [!NOTE]
> Если вы настраиваете модуль с помощью [сценария PowerShell](deploy-appliance-script.md), а не загруженного шаблона OVA, первые два этапа этой процедуры выполнять не нужно.

1. В консоли клиента vSphere щелкните правой кнопкой мыши виртуальную машину и выберите **Open Console** (Открыть консоль).
1. Укажите язык, часовой пояс и пароль для устройства.
1. Откройте браузер на любом компьютере, который может подключиться к виртуальной машине, и откройте URL-адрес веб-приложения устройства: **https://*имя устройства или IP-адрес*: 44368**.

   Кроме того, вы можете открыть приложение с рабочего стола устройства, щелкнув ярлык приложения.
1. В веб-приложении выберите **Настройка необходимых компонентов** и выполните приведенные ниже действия.
   - **Лицензия**: Примите условия лицензии и прочитайте информацию от сторонних производителей.
   - **Возможность подключения**: приложение проверит наличие доступа к Интернету у виртуальной машины. Если виртуальная машина использует прокси, выполните приведенные ниже действия.
     - Щелкните **Proxy settings** (Параметры прокси-сервера) и укажите адрес и порт прослушивания прокси-сервера в формате http://ProxyIPAddress или http://ProxyFQDN.
     - Укажите учетные данные, если для прокси-сервера требуется аутентификация.
     - Поддерживается только прокси-сервер HTTP.
   - **Синхронизация времени**: Время на устройстве должно быть синхронизировано со временем в Интернете, чтобы обнаружение виртуальных машин работало правильно.
   - **Установка обновлений**: Устройство обеспечивает установку последних обновлений.
   - **Установка VDDK**. Устройство проверяет, установлено ли VMware vSphere Virtual Disk Development Kit (VDDK). Если он не установлен, скачайте VDDK 6.7 из VMware и извлеките скачанное содержимое ZIP-файла в указанное расположение на устройстве.

     Средство миграции серверов службы "Миграция Azure" использует VDDK для репликации компьютеров во время миграции на Azure.       

### <a name="register-the-appliance-with-azure-migrate"></a>Регистрация устройства с помощью службы "Миграция Azure"

1. Выберите **Вход**. Если этот параметр не отображается, убедитесь, что в браузере отключена блокировка всплывающих окон.
1. В новой вкладке выполните вход, используя имя пользователя и пароль Azure.
   
   Вход с помощью PIN-кода не поддерживается.
1. Войдя, вернитесь к веб-приложению.
1. Выберите подписку, в которой был создан проект службы "Миграция Azure", а затем выберите проект.
1. Укажите имя для устройства. Это имя должно содержать буквы и цифры (не более 14 символов).
1. Выберите **Зарегистрировать**.


## <a name="start-continuous-discovery"></a>Запуск непрерывного обнаружения

Устройство должно подключиться к vCenter Server для обнаружения конфигурации и данных о производительности виртуальных машин.

### <a name="specify-vcenter-server-details"></a>Укажите сведения о vCenter Server
1. В разделе **Выбор сведений о vCenter Server** укажите полное доменное имя или IP-адрес экземпляра vCenter Server. Вы можете оставить порт по умолчанию или указать пользовательский порт, на котором vCenter Server ожидает передачу данных.
2. В полях **Имя пользователя** и **Пароль** укажите данные учетной записи vCenter Server, которые устройство будет использовать для обнаружения виртуальных машин в экземпляре vCenter Server. 

    - У вас должна быть учетная запись, настроенная с необходимыми разрешениями согласно инструкциям в [предыдущем руководстве](tutorial-prepare-vmware.md#set-up-an-account-for-assessment).
    - Чтобы включить в область обнаружения только определенные объекты VMware (центры обработки данных vCenter Server, кластеры, папку кластеров, узлы, папку узлов или отдельные виртуальные машины), ознакомьтесь с [этой статьей](set-discovery-scope.md), в которой приведены инструкции по применению ограничений для используемой службой "Миграция Azure" учетной записи.

3. Щелкните **Проверить подключение** и убедитесь, что устройство может подключаться к vCenter Server.
4. В разделе **Обнаружение приложений и зависимостей на виртуальных машинах** при необходимости щелкните элемент **Добавить учетные данные** и укажите операционную систему, к которой относятся учетные данные, а также имя пользователя и пароль для этих учетных данных. Нажмите кнопку **Добавить**.

    - При необходимости можете добавить учетные данные, если вы создали учетную запись, которая будет использоваться для [функции обнаружения приложений](how-to-discover-applications.md) или [функции анализа зависимостей без агента](how-to-create-group-machine-dependencies-agentless.md).
    - Если вы не используете эти функции, этот параметр можно пропустить.
    - Проверьте учетные данные, необходимые для [обнаружения приложений](migrate-support-matrix-vmware.md#application-discovery), а также для [анализа без агента](migrate-support-matrix-vmware.md#agentless-dependency-analysis-requirements).

5. **Сохраните конфигурацию и начните обнаружение** виртуальных машин.

Обнаружение выполняется следующим образом:
- Чтобы метаданные обнаруженных виртуальных машин отобразились на портале, потребуется около 15 минут.
- Обнаружение установленных приложений, ролей и компонентов занимает некоторое время, которое зависит от числа обнаруженных виртуальных машин. Для отображения приложений на 500 виртуальных машинах на портале службы "Миграция Azure" потребуется примерно один час.

### <a name="verify-vms-in-the-portal"></a>Проверка виртуальных машин на портале

После обнаружения вы можете убедиться, что виртуальные машины отображаются на портале Azure.

1. Откройте панель мониторинга службы "Миграция Azure".
1. На странице **Azure Migrate — Servers** > **Azure Migrate: оценка серверов** щелкните значок, отображающий число **обнаруженных серверов**.

## <a name="set-up-an-assessment"></a>Настройка оценки

Вы можете создать два типа оценки с помощью средства оценки серверов службы "Миграция Azure".

**Оценка** | **Сведения** | **Data**
--- | --- | ---
**На основе производительности** | Оценки на основе собранных данных производительности | **Рекомендуемый размер виртуальной машины**: на основе данных об использовании ЦП и памяти.<br/><br/> **Рекомендуемый тип диска (управляемый диск цен. категории "Стандартный" или "Премиум")** : на основе операций ввода-вывода в секунду и пропускной способности локальных дисков.
**Как в локальной среде** | Оценки на основе определения размера в локальной среде | **Рекомендуемый размер виртуальной машины**: на основе размера локальной виртуальной машины.<br/><br> **Рекомендуемый тип диска**: на основе типа хранилища, выбранного для оценки.

## <a name="run-an-assessment"></a>Запуск оценки

Запустите оценку следующим образом:

1. Просмотрите [рекомендации](best-practices-assessment.md) для создания оценок.
1. На вкладке **Серверы** на плитке **Миграция Azure: оценка серверов** щелкните **Оценка**.

   ![Расположение кнопки оценки](./media/tutorial-assess-vmware/assess.png)

1. В разделе **Оценка серверов** укажите имя для оценки.
1. Щелкните **Просмотреть все**, чтобы проверить свойства оценки.

   ![Свойства оценки](./media/tutorial-assess-vmware/view-all.png)

1. В разделе **Создание или выбор группы** выберите **Создать** и укажите имя группы. Группа собирает одну или несколько виртуальных машин для оценки.
1. В разделе **Добавление компьютеров в группу** выберите виртуальные машины, которые необходимо добавить в группу.
1. Щелкните **Создать оценку**, чтобы создать группу и запустить оценку.

   ![Оценка серверов](./media/tutorial-assess-vmware/assessment-create.png)

1. После создания оценки просмотрите ее, выбрав **Серверы** > **Azure Migrate: Server Assessment** >  (Миграция Azure: оценка сервера) **Оценки**.
1. Щелкните **Экспорт оценки**, чтобы скачать оценку в виде файла Excel.

## <a name="review-an-assessment"></a>Проверка оценки

В результатах оценки описывается:

- **готовность к работе в Azure**: подходят ли виртуальные машины для миграции в Azure;
- **примерную ежемесячную стоимость**: оценочную месячная стоимость вычислений и хранения для работы виртуальных машин в Azure;
- **примерную стоимость хранилища в месяц**: расчетную стоимость хранилища дисков после миграции.

Чтобы просмотреть оценку, сделайте следующее.

1. В разделе **Цели миграции** > **Серверы** щелкните **Оценки** в области **Миграция Azure: Server Assessment** (Миграция Azure: оценка сервера).
1. В разделе **Оценки** щелкните оценку, чтобы открыть сведения о ней.

   ![Сводка оценки](./media/tutorial-assess-vmware/assessment-summary.png)

### <a name="review-azure-readiness"></a>Проверка готовности к работе в Azure

1. В разделе **Готовность к работе в Azure** проверьте, готовы ли виртуальные машины к миграции в Azure.
1. Проверьте состояние виртуальной машины:
    - **Готово к работе в Azure**: используется, когда служба "Миграция Azure" рекомендует размер и стоимость виртуальных машин в оценке.
    - **Готово при выполнении условий**: отображает проблемы и предлагаемые способы исправления.
    - **Не готово для Azure**: отображает проблемы и предлагаемые способы исправления.
    - **Уровень готовности неизвестен**: используется, когда служба "Миграция Azure" не может оценить готовность из-за проблем с доступностью данных.

1. Щелкните состояние **Готовность к работе в Azure**. Вы можете просмотреть сведения о готовности виртуальной машины. Также здесь можно развернуть подробные сведения о виртуальной машине, включая параметры вычислений, хранилища и сети.

### <a name="review-cost-details"></a>Просмотр сведений о затратах

В сводке по оценке отображается оценочная стоимость вычислений и хранения для запущенных виртуальных машин в Azure. Затраты объединяются для всех виртуальных машин в оцениваемой группе. Вы можете развернуть подробные сведения об определенных виртуальных машинах.

> [!NOTE]
> Оценки стоимости основываются на рекомендациях по размеру и параметрам компьютера и его дисков. Оценки учитывают выполнение локальных виртуальных машин в качестве виртуальных машин IaaS. Средство "Оценка серверов" службы "Миграция Azure" не учитывает затраты на PaaS или SaaS.

Совокупные затраты на хранение для оцениваемой группы предусматривают использование разных типов дисков хранения. 

### <a name="review-confidence-rating"></a>Просмотр рейтинга достоверности

Средство оценки серверов Миграции Azure присваивает параметрам производительности оценку достоверности в диапазоне от одной звезды (самый низкий уровень) до пяти звезд (самый высокий уровень).

![Оценка достоверности](./media/tutorial-assess-vmware/confidence-rating.png)

Оценка достоверности помогает определить надежность предоставленных рекомендаций по выбору размера. Эта оценка основывается на доступности точек данных, необходимых для вычисления оценки.

**Доступность точки данных** | **Оценка достоверности**
--- | ---
0–20 % | 1 звезда
21–40 % | 2 звезды
41–60 % | 3 звезды
61–80 % | 4 звезды
81–100 % | 5 звезд

См. сведения о [рекомендациях для оценки достоверности](best-practices-assessment.md#best-practices-for-confidence-ratings).

## <a name="next-steps"></a>Дальнейшие действия

В этом руководстве описано, как настроить устройство службы "Миграция Azure", а также создать и проверить оценку.

Чтобы узнать, как перенести виртуальные машины VMware в Azure с помощью средства миграции серверов службы "Миграция Azure", перейдите к третьему руководству этой серии.

> [!div class="nextstepaction"]
> [Migrate VMware VMs to Azure (agentless)](./tutorial-migrate-vmware.md) (Перенос виртуальных машин VMware (без агента))
