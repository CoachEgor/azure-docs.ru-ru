---
title: Архитектура устройства Azure служба "Миграция" | Документация Майкрософт
description: Общие сведения для этого модуля "Миграция Azure"
author: rayne-wiselman
ms.service: azure-migrate
ms.topic: conceptual
ms.date: 07/04/2019
ms.author: raynew
ms.openlocfilehash: c2c9ca3082aa9c2067a63f8d6304e8a229dac14a
ms.sourcegitcommit: 47ce9ac1eb1561810b8e4242c45127f7b4a4aa1a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/11/2019
ms.locfileid: "67811457"
---
# <a name="azure-migrate-appliance"></a>Устройство Azure служба "Миграция"

В этой статье описывается модуль "Миграция Azure". При развертывании устройства, при использовании средства оценки миграции Azure и миграции для обнаружения, оценки и миграции приложений, инфраструктуры и рабочих нагрузок в Microsoft Azure. 

[Служба "Миграция Azure"](migrate-services-overview.md) предоставляют центральный концентратор для отслеживания, обнаружения, оценки и миграции локальных приложений и рабочих нагрузок, а также закрытого и открытого облака виртуальных машин в Azure. Концентратор средства "Миграция Azure" для оценки и миграции, а также сторонних независимых Независимым производителям предложений.



## <a name="appliance-overview"></a>Общие сведения об устройстве

Ниже приведены "Миграция Azure" типов устройств и использования.

**Развернуто как** | **Область использования** | **Сведения**
--- | --- |  ---
Виртуальная машина VMware | Оценка виртуальной Машины VMware с помощью инструмента оценки миграции Azure.<br/><br/> Миграцию без агента виртуальной Машины VMware с помощью средства миграции сервера миграции Azure | Скачайте ova-файла шаблона и импортируйте к vCenter Server, чтобы создать модуль виртуальной Машины.
Виртуальная машина Hyper-V | Оценка виртуальной Машины Hyper-V с помощью инструмента оценки миграции Azure. | Скачайте ZIP-виртуальный жесткий ДИСК и импортируйте Hyper-V, чтобы создать модуль виртуальной Машины.

## <a name="appliance-access"></a>Устройство доступа

После настройки устройства, вы сможете удаленно подключаться устройства виртуальной Машины через TCP-порт 3389. Можно также удаленного доступа к веб-приложение управления для устройства, на порте 44368 с URL-адрес: ``` https://<appliance-ip-or-name>:44368 ```.

## <a name="appliance-license"></a>Лицензия устройства
Устройство поставляется с лицензией Windows Server 2016 evaluation, который действителен в течение 180 дней. Если период оценки приближается срок действия, рекомендуется загрузить и развернуть новое устройство или активировать лицензию операционную систему устройства виртуальной Машины.

## <a name="appliance-agents"></a>Агенты устройства
Устройство имеет эти агенты, установленные.

**Агент** | **Сведения**
--- | ---
Агент обнаружения | Собирает данные конфигурации из локальных виртуальных машин.
Агент оценки | Профили в локальной среде для сбора данных производительности виртуальной Машины.
Адаптеры для миграции | Координирует репликацию виртуальной Машины и координирует обмен данными между виртуальными машинами и Azure.
Перенос шлюза | Отправляет реплицированных данных виртуальной Машины в Azure.


## <a name="appliance-deployment-requirements"></a>Требования при развертывании устройства

- [Просмотрите](migrate-support-matrix-vmware.md#assessment-appliance-requirements) требования к развертыванию для устройства VMware и устройства требуется доступ к URL-адреса.
- [Просмотрите](migrate-support-matrix-hyper-v.md#assessment-appliance-requirements) требования к развертыванию на устройство Hyper-V и устройства требуется доступ к URL-адреса.


## <a name="collected-performance-data-vmware"></a>Производительность сбора данных — VMware

Вот данных производительности виртуальной Машины VMware, модуль собирает и отправляет в Azure.

**Данные** | **Счетчик** | **Влияние на оценку**
--- | --- | ---
загрузка ЦП; | cpu.usage.average | Рекомендуется использовать размер и стоимость виртуальной Машины
Использование памяти | mem.usage.average | Рекомендуется использовать размер и стоимость виртуальной Машины
Ошибка чтения диска пропускная способность (МБ в секунду) | virtualDisk.read.average | Расчет размера диска, затраты на хранение, размер виртуальной Машины
Производительность записи на диск (в МБ в секунду) | virtualDisk.write.average | Расчет размера диска, затраты на хранение, размер виртуальной Машины
Ошибка чтения диска операций в секунду | virtualDisk.numberReadAveraged.average | Расчет размера диска, затраты на хранение, размер виртуальной Машины
Записи операций в секунду на диск | virtualDisk.numberWriteAveraged.average  | Расчет размера диска, затраты на хранение, размер виртуальной Машины
Сетевой Адаптер, чтение пропускная способность (МБ в секунду) | net.received.average | Вычисления для размера виртуальной Машины
Пропускная способность сетевого Адаптера при записи (в МБ в секунду) | net.transmitted.average  |Вычисления для размера виртуальной Машины


## <a name="collected-metadata-vmware"></a>Собранные метаданные — VMware

Ниже приведен полный список метаданные виртуальной Машины VMware, которые устройство собирает и отправляет в Azure.

**Данные** | **Счетчик**
--- | --- 
**Сведения о компьютере** | 
Идентификатор виртуальной машины | vm.Config.InstanceUuid 
имя виртуальной машины; | vm.Config.Name
Идентификатор vCenter Server | VMwareClient.Instance.Uuid
Описание виртуальной машины | vm.Summary.Config.Annotation
Имя продукта лицензии | vm.Client.ServiceContent.About.LicenseProductName
Тип операционной системы | Виртуальная машина. SummaryConfig.GuestFullName
Тип загрузки | vm.Config.Firmware
Число ядер | vm.Config.Hardware.NumCPU
Память (МБ) | vm.Config.Hardware.MemoryMB
Количество дисков | Виртуальная машина. Config.Hardware.Device.ToList(). FindAll(x => is VirtualDisk).count
Список размеров диска | Виртуальная машина. Config.Hardware.Device.ToList(). FindAll (x = > является VirtualDisk)
Список сетевых адаптеров | Виртуальная машина. Config.Hardware.Device.ToList(). FindAll(x => is VirtualEthernet).count
загрузка ЦП; | cpu.usage.average
Использование памяти |mem.usage.average
**В сведения о диске** | 
Значение ключа диска | disk.Key
Номер Dikunit | disk.UnitNumber
Значение ключа контроллера диска | disk.ControllerKey.Value
Подготовленных гигабайт | virtualDisk.DeviceInfo.Summary
Имя диска | Значение, созданное с помощью диска. UnitNumber, диск. Ключ, диск. ControllerKey.VAlue
Число операций чтения за секунду. | virtualDisk.numberReadAveraged.average
Число операций записи за секунду. | virtualDisk.numberWriteAveraged.average
Скорость чтения (в МБ в секунду) | virtualDisk.read.average
Записи пропускная способность (МБ в секунду) | virtualDisk.write.average
**Параметрами сетевой КАРТЫ** | 
Имя сетевого адаптера | nic.Key
MAC-адрес. | ((VirtualEthernetCard)nic).MacAddress
IPv4-адресов | vm.Guest.Net
IPv6-адреса | vm.Guest.Net
Скорость чтения (в МБ в секунду) | net.received.average
Записи пропускная способность (МБ в секунду) | net.transmitted.average
**Подробности о пути инвентаризации** | 
ИМЯ | container.GetType().Name
Тип дочернего объекта | container.ChildType
Справочные сведения | container.MoRef
Сведения о родительском объекте | Container.Parent
Сведения о папке каждой виртуальной Машины | ((Folder)container).ChildEntity.Type
Сведения о центре обработки данных на виртуальную Машину | ((Datacenter)container).VmFolder
Сведения о центре обработки данных на узле папку | ((Datacenter)container).HostFolder
Сведения о кластере для каждого узла | (Контейнер (ClusterComputeResource)). Узел
Сведения об узле, на каждой виртуальной Машине | (Контейнер (HostSystem)). ВИРТУАЛЬНОЙ МАШИНЫ



## <a name="collected-performance-data-hyper-v"></a>Производительности, собранных данных Hyper-V

Вот данных производительности виртуальной Машины VMware, модуль собирает и отправляет в Azure.

**Класс счетчика производительности** | **Счетчик** | **Влияние на оценку**
--- | --- | ---
Виртуальный процессор низкоуровневой оболочки Hyper-V | % Времени работы гостя | Рекомендуется использовать размер и стоимость виртуальной Машины
Hyper-V с динамической памяти виртуальной Машины | Текущий давление (%)<br/> Отображается гостевой физической памяти (МБ) | Рекомендуется использовать размер и стоимость виртуальной Машины
Hyper-V виртуальное устройство хранения | Чтение байт/сек | Расчет размера диска, затраты на хранение, размер виртуальной Машины
Hyper-V виртуальное устройство хранения | Запись байт/сек | Расчет размера диска, затраты на хранение, размер виртуальной Машины
Виртуальный сетевой адаптер Hyper-V | Получено байт/сек | Вычисления для размера виртуальной Машины
Виртуальный сетевой адаптер Hyper-V | Байт отправлено/сек | Вычисления для размера виртуальной Машины

- Использование ЦП – это сумма всех использования, для всех виртуальных процессоров, подключенный к виртуальной Машине.
- Использование памяти (текущее давление * видимым физическую память гостевой) / 100.
- Значения использования диска и сети собираются из указанных счетчиков производительности Hyper-V.

## <a name="collected-metadata-hyper-v"></a>Собранные метаданные Hyper-V

Ниже приведен полный список виртуальных Машин Hyper-V метаданные, которые устройство собирает и отправляет в Azure.

**Данные** | **Класс WMI** | **Свойство класса WMI**
--- | --- | ---
**Сведения о компьютере** | 
Серийный номер BIOS _ Msvm_BIOSElement | BIOSSerialNumber
Тип виртуальной Машины (Gen 1 или 2) | Msvm_VirtualSystemSettingData | VirtualSystemSubType
Отображаемое имя виртуальной Машины | Msvm_VirtualSystemSettingData | elementName
Версия виртуальной Машины | Msvm_ProcessorSettingData | VirtualQuantity
Память (байт) | Msvm_MemorySettingData | VirtualQuantity
Максимальный объем памяти, используемой виртуальной Машины | Msvm_MemorySettingData | Ограничение
Включена динамическая память | Msvm_MemorySettingData | DynamicMemoryEnabled
Операционная система имя или версию или полное доменное имя | Msvm_KvpExchangeComponent | Имя GuestIntrinsciExchangeItems данные
Состояние питания виртуальной Машины | Msvm_ComputerSystem | EnabledState
**В сведения о диске** | 
Идентификатор диска | Msvm_VirtualHardDiskSettingData | VirtualDiskId
Тип виртуального жесткого диска | Msvm_VirtualHardDiskSettingData | Type
Размер виртуального жесткого диска | Msvm_VirtualHardDiskSettingData | MaxInternalSize
Родительский виртуальный жесткий диск | Msvm_VirtualHardDiskSettingData | Свойство ParentPath
**Параметрами сетевой КАРТЫ** | 
IP-адреса (синтетические сетевые карты) | Msvm_GuestNetworkAdapterConfiguration | IPAddresses
DHCP включен (синтетические сетевые карты) | Msvm_GuestNetworkAdapterConfiguration | DHCPEnabled
Идентификатор сетевого Адаптера (синтетические сетевые карты) | Msvm_SyntheticEthernetPortSettingData | InstanceID
Сетевой КАРТЫ MAC-адрес (синтетические сетевые карты) | Msvm_SyntheticEthernetPortSettingData | Адрес
Идентификатор сетевого Адаптера (устаревших NIC) | MsvmEmulatedEthernetPortSetting данных | InstanceID
Идентификатор сетевого Адаптера MAC (устаревших NIC) | MsvmEmulatedEthernetPortSetting данных | Адрес




## <a name="discovery-and-collection-process"></a>Процесс обнаружения и коллекции

Устройство взаимодействует с серверы vCenter Server и Hyper-V узлов и кластеров следующим образом.


1. **Запуск обнаружения**:
    - При запуске обнаружения на устройстве Hyper-V, он взаимодействует с узлами Hyper-V в порты WinRM 5985 (HTTP) и 5986 (HTTPS).
    - При запуске обнаружения на устройстве VMware, он взаимодействует с сервером vCenter через TCP-порт 443 по умолчанию. Если сервер vCenter ожидает передачи данных через другой порт, его можно настроить в веб-приложение устройства.
2. **Собирать сведения о метаданных и производительности**:
    - Устройство использует сеанс модели Common Information (CIM) сбор данных виртуальных Машин Hyper-V на узле Hyper-V на портах 5985 и 5986.
    - Устройство взаимодействует с портом 443 по умолчанию сбор данных виртуальных Машин VMware vCenter Server.
3. **Отправлять данные**: Устройство отправляет собранные данные оценки сервера миграции Azure и миграция сервера миграции Azure через SSL-порт 443.
    - Для данных о производительности модуль собирает данные об использовании в режиме реального времени.
        - Данные производительности собираются каждые 20 секунд для VMware и каждые 30 секунд для Hyper-V, для каждой метрики производительности.
        - Собранные данные сводятся для создания одну точку данных в течение десяти минут.
        - Пиковое использование значение выбирается из всех 20/30 второй точки данных и отправляются в Azure, для расчета оценки.
        - На основании значение процентиля, указанные в свойствах оценки (50/90 и 95/99), 10 минутный они сортируются по возрастанию, и соответствующие процентиль используется для вычисления оценки
    - Для миграции сервера модуль начинает сбор данных на виртуальной Машине и реплицирует ее в Azure.
4. **Оценка и миграция**: Теперь вы можете создать оценки из метаданных, собранных устройством с помощью оценки сервера миграции Azure. Кроме того можно также запустить, переносите виртуальные машины VMware с помощью миграции сервера миграции Azure для управления репликацией без агента виртуальной Машины.


![Архитектура](./media/migrate-appliance/architecture.png)


## <a name="appliance-upgrades"></a>Обновление устройства

Модуль обновляется по мере обновления агентов "Миграция Azure", выполняющуюся на устройстве.

- Это происходит автоматически, так как автоматическое обновление включено на устройстве по умолчанию.
- Можно изменить этот параметр по умолчанию, чтобы вручную обновить агенты.
- Чтобы отключить автоматическое обновление, задайте раздел реестра устройства автоматическое обновление, в HKLM\SOFTWAREMicrosoft\Azure.

### <a name="set-agent-updates-to-manual"></a>SET-обновления агента вручную

Обновление вручную, убедитесь, что обновить все агенты на устройстве, в то же время, с помощью **обновление** кнопка для каждого агента, устаревшие на устройстве. Изменение параметров можно переключиться обратно на автоматические обновления в любое время.

## <a name="next-steps"></a>Следующие шаги

[Узнайте, как](tutorial-assess-vmware.md#set-up-the-appliance-vm) для настройки устройства для VMware.
[Узнайте, как](tutorial-assess-hyper-v.md#set-up-the-appliance-vm) для настройки устройства для Hyper-V.

