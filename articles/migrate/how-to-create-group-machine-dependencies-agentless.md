---
title: Настройка анализа зависимостей без агента в службе "миграция Azure — Оценка сервера"
description: Настройка анализа зависимостей без агента в службе "миграция Azure" для оценки серверов.
ms.topic: how-to
ms.date: 6/08/2020
ms.openlocfilehash: dc2ea0656198927cc8ae58533d296a2bedc37c13
ms.sourcegitcommit: 877491bd46921c11dd478bd25fc718ceee2dcc08
ms.contentlocale: ru-RU
ms.lasthandoff: 07/02/2020
ms.locfileid: "84771382"
---
# <a name="analyze-machine-dependencies-agentless"></a>Анализ зависимостей компьютера (без агентов)

В этой статье описывается, как настроить анализ зависимостей без агента в службе "миграция Azure": Оценка сервера. [Анализ зависимостей](concepts-dependency-visualization.md) помогает определить и понять зависимости между компьютерами для оценки и миграции в Azure.


> [!IMPORTANT]
> Визуализация зависимостей без агента сейчас доступна в предварительной версии для виртуальных машин VMware, обнаруженных с помощью средства "миграция Azure": Серверная оценка.
> Возможности могут быть ограничены или неполными.
> Эта предварительная версия охватывается службой поддержки клиентов и может использоваться для рабочих нагрузок.
> Дополнительные сведения см. в статье [Дополнительные условия использования предварительных выпусков Microsoft Azure](https://azure.microsoft.com/support/legal/preview-supplemental-terms/).

## <a name="current-limitations"></a>Текущие ограничения

- В представлении "анализ зависимостей" в настоящее время невозможно добавить или удалить сервер из группы.
- Схема зависимостей для группы серверов в настоящее время недоступна.
- Невозможно скачать данные зависимостей в табличном формате.

## <a name="before-you-start"></a>Перед началом работы

- [Ознакомьтесь](migrate-support-matrix-vmware.md#dependency-analysis-requirements-agentless) с поддерживаемыми операционными системами и необходимыми разрешениями.
- Не забудьте выполнить следующие действия.
    - У вас есть проект службы "миграция Azure". Если это не так, [Создайте](how-to-add-tool-first-time.md) его сейчас.
    - Убедитесь, что в проект [добавлен](how-to-assess.md) инструмент Azure Migrate: Server для оценки.
    - Настройте [устройство миграции Azure](migrate-appliance.md) для обнаружения локальных компьютеров. [Настройте устройство](how-to-set-up-appliance-vmware.md) для виртуальных машин VMware. Устройство обнаруживает локальные компьютеры и отправляет метаданные и данные производительности в службу "миграция Azure": Оценка сервера.
- Убедитесь, что средства VMware (более поздние версии, чем 10,2) установлены на каждой виртуальной машине, которую необходимо проанализировать.


## <a name="create-a-user-account-for-discovery"></a>Создание учетной записи пользователя для обнаружения

Настройте учетную запись пользователя, чтобы оценка сервера могла получить доступ к виртуальной машине для обнаружения зависимостей. [Сведения](migrate-support-matrix-vmware.md#dependency-analysis-requirements-agentless) о требованиях к учетной записи для виртуальных машин Windows и Linux.


## <a name="add-the-user-account-to-the-appliance"></a>Добавление учетной записи пользователя в устройство

Добавьте учетную запись пользователя в устройство.

1. Откройте приложение управления устройством. 
2. Перейдите на панель **Укажите сведения о vCenter** .
3. В окне **обнаружение приложения и зависимостей на виртуальных машинах**нажмите кнопку **Добавить учетные данные** .
3. Выберите **операционную систему**, укажите понятное имя учетной записи и **User name** / **пароль** пользователя.
6. Нажмите кнопку **Сохранить**.
7. Нажмите кнопку **сохранить и начать обнаружение**.

    ![Добавление учетной записи пользователя виртуальной машины](./media/how-to-create-group-machine-dependencies-agentless/add-vm-credential.png)

## <a name="start-dependency-discovery"></a>Запустить обнаружение зависимостей

Выберите компьютеры, на которых необходимо включить обнаружение зависимостей.

1. В **службе "миграция Azure": Оценка сервера**щелкните **обнаруженные серверы**.
2. Щелкните значок **анализ зависимостей** .
3. Нажмите кнопку **Добавить серверы**.
4. На странице **Добавление серверов** выберите устройство, которое будет обнаруживать соответствующие компьютеры.
5. В списке компьютер выберите компьютеры.
6. Нажмите кнопку **Добавить серверы**.

    ![Запустить обнаружение зависимостей](./media/how-to-create-group-machine-dependencies-agentless/start-dependency-discovery.png)

Можно визуализировать зависимости около шести часов после запуска обнаружения зависимостей.

## <a name="visualize-dependencies"></a>Визуализация зависимостей

1. В **службе "миграция Azure": Оценка сервера**щелкните **обнаруженные серверы**.
2. Найдите компьютер, который вы хотите просмотреть.
3. В столбце **зависимости** щелкните **Просмотр зависимостей** .
4. Измените период времени, для которого необходимо просмотреть карту, с помощью раскрывающегося списка **Длительность времени** .
5. Разверните группу **клиентов** , чтобы получить список компьютеров с зависимостью от выбранной машины.
6. Разверните группу **портов** , чтобы получить список компьютеров, имеющих зависимость от выбранного компьютера.
7. Чтобы перейти к представлению карт зависимых компьютеров, щелкните имя компьютера > **загрузить карту сервера** .

    ![Развертывание группы портов сервера и загрузка схемы сервера](./media/how-to-create-group-machine-dependencies-agentless/load-server-map.png)

    ![Развернуть группу клиентов ](./media/how-to-create-group-machine-dependencies-agentless/expand-client-group.png)

8. Разверните выбранный компьютер, чтобы просмотреть сведения об уровне процесса для каждой зависимости.

    ![Развертывание сервера для отображения процессов](./media/how-to-create-group-machine-dependencies-agentless/expand-server-processes.png)

> [!NOTE]
> Сведения о процессе для зависимости не всегда доступны. Если он недоступен, зависимость отображается с процессом, помеченным как "Неизвестный процесс".

## <a name="export-dependency-data"></a>Экспорт данных зависимостей

1. В **службе "миграция Azure": Оценка сервера**щелкните **обнаруженные серверы**.
2. Щелкните значок **анализ зависимостей** .
3. Нажмите кнопку **Экспорт зависимостей приложений**.
4. На странице **Экспорт зависимостей приложения** выберите устройство, которое будет обнаруживать соответствующие компьютеры.
5. Выберите время начала и время окончания. Обратите внимание, что данные можно загрузить только за последние 30 дней.
6. Щелкните **Экспорт зависимостей**.

Данные зависимостей экспортируются и загружаются в формате CSV. Скачанный файл содержит данные зависимостей на всех компьютерах, включенных для анализа зависимостей. 

![Экспорт зависимостей](./media/how-to-create-group-machine-dependencies-agentless/export.png)

### <a name="dependency-information"></a>Сведения о зависимостях

Каждая строка в экспортированном CSV-файле соответствует зависимости, наблюдаемой в заданном интервале времени. 

В следующей таблице перечислены поля в экспортированном CSV-файле. Обратите внимание, что поля имя сервера, приложение и процесс заполнены только для серверов, для которых включен анализ зависимостей без агента.

**Имя поля** | **Сведения**
--- | --- 
тимеслот | Тимеслот, в течение которого была наблюдаться зависимость. <br/> Данные зависимостей захватываются в течение 6-часового слота.
Имя исходного сервера | Имя исходного компьютера 
Исходное приложение | Имя приложения на исходном компьютере 
Процесс-источник | Имя процесса на исходном компьютере 
Имя целевого сервера | Имя конечного компьютера
Конечный IP-адрес | IP-адрес конечного компьютера
Конечное приложение | Имя приложения на целевом компьютере
Процесс назначения | Имя процесса на целевом компьютере 
Конечный порт | Номер порта на целевом компьютере


## <a name="stop-dependency-discovery"></a>Отключить обнаружение зависимостей

Выберите компьютеры, на которых требуется отключить обнаружение зависимостей.

1. В **службе "миграция Azure": Оценка сервера**щелкните **обнаруженные серверы**.
2. Щелкните значок **анализ зависимостей** .
3. Нажмите кнопку **удалить серверы**.
3. На странице **Удаление серверов** выберите **устройство** , которое обнаруживает виртуальные машины, на которых вы хотите отключить обнаружение зависимостей.
4. В списке компьютер выберите компьютеры.
5. Нажмите кнопку **удалить серверы**.


## <a name="next-steps"></a>Дальнейшие шаги

[Сгруппируйте компьютеры](how-to-create-a-group.md) для оценки.
