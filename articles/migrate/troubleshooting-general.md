---
title: Устранение неполадок в службе "Миграция Azure" | Документация Майкрософт
description: Содержит общие сведения об известных проблемах в службе "миграция Azure", а также советы по устранению распространенных ошибок.
author: rayne-wiselman
ms.service: azure-migrate
ms.topic: conceptual
ms.date: 08/06/2019
ms.author: raynew
ms.openlocfilehash: fa1e7fcf89ccc06e429831191ba5dfce3cf33797
ms.sourcegitcommit: 3073581d81253558f89ef560ffdf71db7e0b592b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/06/2019
ms.locfileid: "68828313"
---
# <a name="troubleshoot-azure-migrate"></a>Устранение неполадок в службе "Миграция Azure"

Служба " [Миграция Azure](migrate-services-overview.md) " предоставляет центр средств для оценки и миграции, а также предложения независимых поставщиков программного обеспечения (ISV) сторонних разработчиков. Эта статья поможет вам устранить ошибки при использовании службы "миграция Azure", оценки сервера "миграция Azure" и миграции сервера миграция Azure.

## <a name="azure-migrate-project-issues"></a>Проблемы с проектом службы "миграция Azure"

### <a name="i-cant-find-my-existing-azure-migrate-project"></a>Не удается найти существующий проект службы "миграция Azure".

Существует [две версии](https://docs.microsoft.com/azure/migrate/migrate-services-overview#azure-migrate-versions) службы "миграция Azure". В зависимости от версии, в которой был создан проект, используйте один из следующих методов.

* Если вы ищете проект, созданный с помощью предыдущей версии (старого интерфейса) службы "миграция Azure", выполните следующие действия, чтобы найти проект:

    1. Перейдите в [портал Azure](https://portal.azure.com)и выполните поиск по запросу " **Миграция Azure**".
    2. На панели мониторинга "миграция Azure" вы увидите баннер, в котором упоминается доступ к старым проектам. Этот баннер отображается только в том случае, если вы создали проект со старым интерфейсом. Выберите баннер.

       ![Доступ к существующим проектам](./media/troubleshooting-general/access-existing-projects.png)

    3. Теперь вы увидите список существующих проектов, созданных с помощью предыдущей версии службы "миграция Azure".

* Если вы ищете проект, созданный с помощью текущей версии (новый интерфейс), выполните следующие действия, чтобы найти проект:

    1. Перейдите в [портал Azure](https://portal.azure.com)и выполните поиск по запросу " **Миграция Azure**".
    2. На панели мониторинга миграция Azure перейдите на страницу **серверы** в области слева и щелкните **изменить** в правом верхнем углу.

       ![Переключение на существующий проект службы "миграция Azure"](./media/troubleshooting-general/switch-project.png)

    3. Выберите подходящую подписку и проект "миграция Azure".

### <a name="how-do-i-create-a-second-azure-migrate-project"></a>Разделы справки создать второй проект службы "миграция Azure"?

Чтобы создать проект службы "миграция Azure", выполните следующие действия.

1. Перейдите в [портал Azure](https://portal.azure.com)и выполните поиск по запросу " **Миграция Azure**".
2. На панели мониторинга миграция Azure перейдите на страницу **серверы** в области слева и щелкните **изменить** в правом верхнем углу.

   ![Изменение проекта службы "миграция Azure"](./media/troubleshooting-general/switch-project.png)

3. Чтобы создать новый проект, выберите **щелкните здесь**.

   ![Создание второго проекта службы "миграция Azure"](./media/troubleshooting-general/create-new-project.png)

### <a name="which-azure-geographies-does-azure-migrate-support"></a>Какие географические диаграммы Azure поддерживают миграцию Azure?

См. списки для [VMware](https://docs.microsoft.com/azure/migrate/migrate-support-matrix-vmware#azure-migrate-projects) и [Hyper-V](https://docs.microsoft.com/azure/migrate/migrate-support-matrix-hyper-v#azure-migrate-projects).

### <a name="how-do-i-delete-azure-migrate-projects-and-associated-log-analytics-workspaces"></a>Разделы справки удалить проекты службы "миграция Azure" и связанные рабочие области Log Analytics?

При удалении проекта службы "миграция Azure" проект миграции *и* метаданные об обнаруженных компьютерах удаляются. Однако если вы присоединяете рабочую область Log Analytics к средству оценки серверов, Log Analytics Рабочая область не удаляется автоматически. (Одна и та же Рабочая область Log Analytics может использоваться для нескольких вариантов использования.) Если вы хотите также удалить рабочую область Log Analytics, необходимо сделать это вручную:

1. Перейдите к рабочей области Log Analytics, связанной с проектом.
     * Если вы еще не удалили проект миграции, ссылку на рабочую область можно найти на странице Обзор оценки сервера в разделе Основные компоненты.

       ![Рабочая область LA](./media/troubleshooting-general/loganalytics-workspace.png)

     * Если вы уже удалили проект миграции, выберите **группы ресурсов** в левой области портал Azure. Перейдите к группе ресурсов, в которой создана Рабочая область, и перейдите к ней.
2. Следуйте инструкциям в статье [Удаление рабочей области Azure log Analytics с портал Azure](https://docs.microsoft.com/azure/azure-monitor/platform/delete-workspace).

### <a name="migration-project-creation-failed-with-a-requests-must-contain-user-identity-headers-error"></a>Сбой создания проекта миграции с ошибкой "запросы должны содержать заголовки удостоверения пользователя".

Эта проблема может возникать у пользователей, которые не имеют доступа к клиенту Azure Active Directory (Azure AD) Организации. Когда пользователь впервые добавляется в клиент Azure AD, он получает приглашение на присоединение к клиенту по электронной почте. Пользователи должны принять приглашение, чтобы успешно добавить его в клиент. Если сообщение электронной почты не отображается, обратитесь к пользователю, у которого уже есть доступ к клиенту, и попросите его повторно отправить приглашение, выполнив действия, указанные в разделе [Повторная отправка приглашений гостевым пользователям](https://docs.microsoft.com/azure/active-directory/b2b/add-users-administrator#resend-invitations-to-guest-users).

После получения приглашения по электронной почте необходимо открыть сообщение электронной почты и выбрать ссылку, чтобы принять приглашение. Затем необходимо выйти из портал Azure и снова войти в систему. (Обновление браузера не будет работать.) После этого можно приступить к созданию проекта миграции.

## <a name="appliance-issues"></a>Проблемы с устройством

### <a name="deployment-of-an-azure-migrate-appliance-for-vmware-failed-with-a-the-provided-manifest-file-is-invalid-invalid-ovf-manifest-entry-error"></a>Сбой развертывания устройства миграции Azure для VMware с "предоставленный файл манифеста недопустим: Недопустимая запись манифеста OVF "".

1. Проверьте, правильно ли загружен файл OVA устройства для миграции Azure, проверив его хэш-значение. Инструкции см. [в статье Подготовка виртуальных машин VMware для оценки и миграции в Azure](https://docs.microsoft.com/azure/migrate/tutorial-assessment-vmware). Если хэш-значение не совпадает, скачайте файл OVA еще раз и повторите попытку развертывания.
2. Если развертывание по-прежнему завершается сбоем и вы используете VMware vSphere клиент для развертывания файла OVF, попробуйте развернуть его с помощью веб-клиента vSphere. Если развертывание по-прежнему завершается сбоем, попробуйте использовать другой веб-браузер.
3. Если вы используете веб-клиент vSphere и пытаетесь развернуть его на vCenter Server 6,5 или 6,7, попробуйте развернуть OVA непосредственно на узле ESXi, выполнив следующие действия.
   - Подключитесь непосредственно к узлу ESXi (вместо vCenter Server) с помощью веб-клиента (HTTPS://<*IP-адрес узла*>/УИ).
   - Перейдите на **домашнюю** > **инвентаризацию**.
   - Выберите **файл** > **развернуть шаблон OVF**. Перейдите к OVA и завершите развертывание.
4. Если развертывание по-прежнему завершается сбоем, обратитесь в службу поддержки миграции Azure.

### <a name="the-appliance-cant-connect-to-the-internet"></a>Устройство не может подключиться к Интернету.

Такое поведение может возникать, если используемая машина находится за прокси-сервером. Убедитесь, что вы предоставляете учетные данные для авторизации, если они требуются прокси-серверу.
Если вы используете прокси-сервер брандмауэра на основе URL-адресов для управления исходящими подключениями, обязательно добавьте эти необходимые URL-адреса в список разрешений:

- [Оценка серверов для VMware](https://docs.microsoft.com/azure/migrate/migrate-support-matrix-vmware#assessment-url-access-requirements)
- [Оценка сервера для Hyper-V](https://docs.microsoft.com/azure/migrate/migrate-support-matrix-hyper-v#assessment-appliance-url-access)
- [Миграция сервера для VMware (без агента)](https://docs.microsoft.com/azure/migrate/migrate-support-matrix-vmware#agentless-migration-url-access-requirements)
- [Миграция сервера VMware (на основе агента)](https://docs.microsoft.com/azure/migrate/migrate-support-matrix-vmware#replication-appliance-url-access)
- [Миграция сервера для Hyper-V](https://docs.microsoft.com/azure/migrate/migrate-support-matrix-hyper-v#migration-hyper-v-host-url-access)

Если вы используете перехват прокси-сервера для подключения к Интернету, необходимо импортировать сертификат прокси-сервера на виртуальную машину устройства. Сертификат прокси-сервера можно импортировать, выполнив действия, описанные в разделе " [Миграция устройств Azure](https://docs.microsoft.com/azure/migrate/concepts-collector)".

### <a name="error-802-date-and-time-synchronization-error"></a>Ошибка 802. Ошибка синхронизации даты и времени.

Возможно, часы сервера не синхронизированы с текущим временем более чем за пять минут. Измените время на виртуальной машине сборщика с соответствии с текущим временем, как показано ниже.

1. Откройте командную строку с правами администратора на этой виртуальной машине.
2. Чтобы проверить часовой пояс, выполните команду **w32tm/ТЗ**.
3. Чтобы синхронизировать время, выполните команду **w32tm/resync**.


###  <a name="connection-failed-error-unabletoconnecttoserver"></a>Сбой подключения. Ошибка: UnableToConnectToServer.

Возможно, вам не удастся подключиться к vCenter Server *ServerName*. com: 9443. Сведения об ошибке указывают на то, что конечная точка не прослушивается на https://*ServerName*. com: 9443/SDK, которая может принять сообщение.

В этом случае проверьте, используете ли вы последнюю версию модуля сборщика. Если вы не используете, обновите устройство до [последней версии](https://docs.microsoft.com/azure/migrate/concepts-collector).

Если проблема по-прежнему возникает в последней версии, возможно, компьютеру сборщика не удается разрешить указанное vCenter Server имя, или указанный порт может быть неверным. По умолчанию, если порт не указан, сборщик попытается подключиться к порту номер 443.

1. Выполните команду ping *ServerName*. com с компьютера сборщика.
2. В случае сбоя шага 1 Попробуйте подключиться к серверу vCenter с помощью IP-адреса.
3. Определите правильный номер порта для подключения к серверу vCenter Server.
4. Убедитесь, что сервер vCenter Server работает.


### <a name="the-appliance-might-not-be-registered-successfully-to-the-azure-migrate-project-error-id-60052"></a>Возможно, устройство не будет успешно зарегистрировано в проекте службы "миграция Azure" (Идентификатор ошибки: 60052).

Эта ошибка возникает, если учетная запись Azure, используемая для регистрации устройства, имеет недостаточные разрешения. Убедитесь, что учетная запись пользователя Azure, используемая для регистрации устройства, имеет по крайней мере разрешения участника на подписку. Дополнительные [сведения](https://docs.microsoft.com/azure/migrate/migrate-appliance#appliance-deployment-requirements) о необходимых ролях и разрешениях Azure.

### <a name="the-appliance-might-not-be-registered-successfully-to-the-azure-migrate-project-error-id-60039"></a>Возможно, устройство не будет успешно зарегистрировано в проекте службы "миграция Azure" (Идентификатор ошибки: 60039).

Проект "миграция Azure", выбранный для регистрации устройства, может не быть найден. В этом случае регистрация завершается ошибкой. Перейдите к портал Azure и проверьте, существует ли проект в группе ресурсов. Если проект не существует, создайте новый проект "миграция Azure" в группе ресурсов и снова зарегистрируйте устройство. [Узнайте больше](https://docs.microsoft.com/azure/migrate/how-to-add-tool-first-time#create-a-project-and-add-a-tool) о создании нового проекта службы "миграция Azure".

### <a name="an-azure-key-vault-management-operation-failed-error-id-60030-60031"></a>Не удалось выполнить операцию управления Azure Key Vault (Идентификатор ошибки: 60030, 60031).

Убедитесь, что учетная запись пользователя Azure, используемая для регистрации устройства, имеет по крайней мере разрешения участника на подписку. Кроме того, убедитесь, что учетная запись имеет доступ к хранилищу ключей, указанному в сообщении об ошибке, и повторите операцию. Если проблема будет повторяться, обратитесь в службу поддержки Майкрософт. Дополнительные [сведения](https://docs.microsoft.com/azure/migrate/migrate-appliance#appliance-deployment-requirements) о необходимых ролях и разрешениях Azure.

### <a name="discovery-couldnt-be-initiated-because-of-an-error-the-operation-failed-for-the-specified-list-of-hosts-or-clusters-error-id-60028"></a>Не удалось инициировать обнаружение из-за ошибки. Не удалось выполнить операцию для указанного списка узлов или кластеров (Идентификатор ошибки: 60028).

Не удалось запустить обнаружение на узлах, перечисленных в сообщении об ошибке из-за проблемы с доступом или получением сведений о виртуальной машине. Остальные узлы успешно добавлены. Снова добавьте узлы, перечисленные в ошибке, с помощью параметра **Добавить узел** . При возникновении ошибки проверки ознакомьтесь с руководством по исправлению, чтобы исправить ошибки, а затем повторите попытку **сохранить и запустить обнаружение** .

### <a name="an-azure-ad-operation-failed-the-error-occurred-while-creating-or-updating-the-azure-ad-application-error-id-60025"></a>Сбой операции Azure AD. Произошла ошибка при создании или обновлении приложения Azure AD (Идентификатор ошибки: 60025).

Эта ошибка возникает, когда учетная запись Azure, используемая для запуска обнаружения, отличается от учетной записи, используемой для регистрации устройства. Выполните одно из следующих действий:
1. Убедитесь, что учетная запись пользователя, инициирующая обнаружение, совпадает с той, которая использовалась для регистрации устройства.
1. Предоставьте разрешения на доступ к приложению AAD для другой учетной записи пользователя, для которой не выполняется операция обнаружения.
1. Удалите группу ресурсов, созданную ранее для проекта "миграция Azure", и создайте другую группу ресурсов для повторного запуска.

Дополнительные [сведения](https://docs.microsoft.com/azure/migrate/migrate-appliance#appliance-deployment-requirements) о разрешениях для приложений AAD.

## <a name="discovery-issues"></a>Проблемы с обнаружением

### <a name="i-started-discovery-but-dont-see-the-discovered-vms-on-the-azure-portal-the-server-assessment-and-server-migration-tiles-show-a-status-of-discovery-in-progress"></a>Я начал обнаружение, но не вижу обнаруженные виртуальные машины на портал Azure. Плитки « **Оценка сервера** » и « **Миграция сервера** » показывают состояние «Обнаружение выполняется».
После запуска обнаружения с устройства подождите некоторое время, чтобы обнаруженные компьютеры отображались на портал Azure. Для обнаружения VMware требуется около 15 минут и около 2 минут на каждый добавленный узел для обнаружения Hyper-V. Если вы продолжаете видеть "выполняется обнаружение" даже после этих периодов ожидания, выберите **Обновить** на вкладке **серверы** . Должно отобразиться количество обнаруженных серверов на плитках "Оценка сервера" и "миграция сервера".


### <a name="im-using-an-appliance-that-continuously-discovers-my-on-premises-environment-but-the-vms-that-are-deleted-in-my-on-premises-environment-are-still-shown-in-the-portal"></a>Я использую устройство, которое постоянно обнаруживает мою локальную среду, но виртуальные машины, удаленные в моей локальной среде, по-прежнему отображаются на портале.

Данные обнаружения, собранные устройством, будут отражены на портале до 30 минут. Если вы не видите актуальную информацию даже через 30 минут, обновите данные, выполнив следующие действия.

1. Последовательно выберите **серверы** > **Azure миграция сервера Оценка**и щелкните **Обзор**.
2. В разделе **Управление**выберите **работоспособность агентов**
3. Выберите **Обновить агент**. Этот параметр отображается под списком агентов.
4. Дождитесь завершения операции обновления. Теперь вы должны увидеть актуальные сведения о виртуальных машинах.

### <a name="i-dont-see-the-latest-information-on-the-on-premise-vms-on-the-portal"></a>На портале не отображаются последние сведения о локальных виртуальных машинах.

Данные обнаружения, собранные устройством, будут отражены на портале до 30 минут. Если вы не видите актуальную информацию даже через 30 минут, обновите данные, выполнив следующие действия.

1. Последовательно выберите **серверы** > **Azure миграция сервера Оценка**и щелкните **Обзор**.
2. В разделе **Управление**выберите **работоспособность агентов**
3. Выберите **Обновить агент**. Этот параметр отображается под списком агентов.
4. Дождитесь завершения операции обновления. Теперь вы должны увидеть актуальные сведения о виртуальных машинах.

### <a name="cant-connect-to-a-host-or-cluster-because-the-server-name-cant-be-resolved-winrm-error-code-0x803381b9-error-id-50004"></a>Не удается подключиться к узлу или кластеру, так как не удается разрешить имя сервера. Код ошибки WinRM: 0x803381B9 (Идентификатор ошибки: 50004).
Эта ошибка возникает, если службе Azure DNS для устройства не удается разрешить указанный кластер или имя узла. Если вы видите эту ошибку в кластере, попробуйте указать полное доменное имя кластера.

Эта ошибка может также возникать для узлов в кластере. В этом случае устройство может подключаться к кластеру, но кластер возвращает имена узлов, которые не являются полными доменными именами.

Чтобы устранить эту ошибку, обновите файл hosts на устройстве, добавив сопоставление IP-адреса и имени узла:
1. Откройте Блокнот с правами администратора. Затем откройте файл C:\Windows\System32\Drivers\etc\hosts.
2. Добавьте IP-адрес и имя узла в строку. Повторите эти действия для каждого узла или кластера, где отображается эта ошибка.
3. Сохраните и закройте файл hosts.
4. Вы можете проверить, может ли устройство подключаться к узлам с помощью приложения управления устройством. Через 30 минут вы сможете просмотреть последние сведения об этих узлах на портал Azure.


## <a name="assessment-issues"></a>Ошибки оценки

### <a name="azure-readiness-issues"></a>Проблемы готовности к работе в Azure

Проблемы | Исправление
--- | ---
Неподдерживаемый тип загрузки | Azure не поддерживает виртуальные машины с типом загрузки EFI. Перед выполнением миграции рекомендуется преобразовать тип загрузки в BIOS. <br/><br/>Миграцию таких виртуальных машин можно выполнить с помощью миграции сервера Azure Migration. Во время миграции тип загрузки виртуальной машины будет преобразован в BIOS.
Условно поддерживаемая ОС Windows | Операционная система прошла дату окончания поддержки, и для [поддержки в Azure](https://aka.ms/WSosstatement)требуется специальное соглашение о поддержке (CSA). Рекомендуется обновить операционную систему перед миграцией в Azure.
Неподдерживаемая ОС Windows | Azure поддерживает только [Выбранные версии ОС Windows](https://aka.ms/WSosstatement). Рассмотрите возможность обновления операционной системы компьютера перед миграцией в Azure.
Условно поддерживаемая ОС Linux | Azure подтверждает только [Выбранные версии ОС Linux](../virtual-machines/linux/endorsed-distros.md). Рассмотрите возможность обновления операционной системы компьютера перед миграцией в Azure.
Неподдерживаемая ОС Linux | Компьютер может запускаться в Azure, но Azure не поддерживает ОС. Перед миграцией в Azure рассмотрите возможность обновления операционной системы до рекомендованной [версии Linux](../virtual-machines/linux/endorsed-distros.md) .
Неизвестная операционная система | Операционная система виртуальной машины была указана в vCenter Server как "другая". Это поведение блокирует миграцию Azure для проверки готовности виртуальной машины к работе в Azure. Перед переносом компьютера убедитесь, что операционная система компьютера [поддерживается](https://aka.ms/azureoslist) Azure.
Неподдерживаемая разрядность ОС | Виртуальные машины с 32-разрядной ОС могут загружаться в Azure, но перед миграцией в Azure мы рекомендуем обновить ОС виртуальной машины до версии 64-bit.
Требуется подписка Microsoft Visual Studio | Компьютер работает под управлением клиентской ОС Windows, которая поддерживается только в рамках подписки Visual Studio.
Виртуальная машина не найдена для требуемой производительности хранилища | Производительность хранилища (операций ввода-вывода в секунду и пропускная способность), необходимая для компьютера, превышает поддержку виртуальной машины Azure. Снизьте требования к хранилищу для компьютера перед выполнением миграции.
Виртуальная машина не найдена для требуемой производительности сети | Производительность сети (скорость входящего и исходящего трафика), необходимая для компьютера, превышает возможности поддерживаемых виртуальных машин Azure. Уменьшите требования к сети для компьютера.
Виртуальная машина не найдена для указанного расположения | Используйте другое целевое расположение, прежде чем выполнять миграцию.
Один или несколько неподходящих дисков | Один или несколько дисков, подключенных к виртуальной машине, не соответствуют требованиям Azure. Миграция Azure Оценка серверов в настоящее время не поддерживает SSD (цен. категория "Ультра") дисков и оценивает диски на основе ограничений для дисков на управляемых дисках уровня "Премиум" (32 ТБ).  Для каждого диска, подключенного к виртуальной машине, убедитесь, что размер диска составляет < 64 ТБ (поддерживается SSD (цен. категория "Ультра") дисками). в противном случае сократите размер диска перед миграцией в Azure или используйте несколько дисков в Azure и [объедините их](https://docs.microsoft.com/azure/virtual-machines/windows/premium-storage-performance#disk-striping) , чтобы получить более высокие ограничения хранилища. Убедитесь, что производительность (операций ввода-вывода и пропускная способность), необходимая для каждого диска, поддерживается [дисками виртуальной машины под управлением](https://docs.microsoft.com/azure/azure-subscription-service-limits#storage-limits)Azure.
Один или несколько неподходящих сетевых адаптеров. | Удалите неиспользуемые сетевые адаптеры с компьютера перед миграцией.
Число дисков превышает ограничение | Удалите неиспользуемые диски с компьютера перед миграцией.
Размер диска превышает ограничение | Миграция Azure Оценка сервера сейчас не поддерживает SSD (цен. категория "Ультра") диски и оценивает диски на основе ограничений по лимиту дисков уровня "Премиум" (32 ТБ). Однако Azure поддерживает диски размером до 64 ТБ (поддерживается SSD (цен. категория "Ультра") дисков). Сократите диски до уровня 64 ТБ перед миграцией или используйте несколько дисков в Azure и разработайте [их вместе](https://docs.microsoft.com/azure/virtual-machines/windows/premium-storage-performance#disk-striping) , чтобы получить более высокие ограничения хранилища.
Диск недоступен в указанном расположении | Убедитесь, что диск доступен в целевом расположении, прежде чем выполнять миграцию.
Недоступен диск для обеспечения указанной избыточности | Диск должен использовать тип избыточности хранилища, указанный в параметрах оценки (по умолчанию — LRS).
Не удалось определить пригодность диска из-за внутренней ошибки | Попробуйте создать новую оценку для группы.
Виртуальная машина с требуемым числом ядер и объемом памяти не найдена | Azure не удалось найти подходящий тип виртуальной машины. Уменьшите объем памяти и число ядер на локальном компьютере, прежде чем выполнять миграцию.
Не удалось определить пригодность виртуальной машины из-за внутренней ошибки | Попробуйте создать новую оценку для группы.
Не удалось определить пригодность для одного или нескольких дисков из-за внутренней ошибки | Попробуйте создать новую оценку для группы.
Не удалось определить пригодность для одного или нескольких сетевых адаптеров из-за внутренней ошибки | Попробуйте создать новую оценку для группы.

### <a name="i-cant-specify-enterprise-agreement-ea-as-an-azure-offer-in-the-assessment-properties"></a>Не удается указать Соглашение Enterprise (EA) в качестве предложения Azure в свойствах оценки.
В настоящее время Оценка сервера "миграция Azure" не поддерживает цены на основе Соглашение Enterprise (EA). Чтобы обойти это ограничение, используйте предложение Azure с **оплатой по мере** использования и используйте свойство **Скидка** , чтобы указать любую настраиваемую скидку. См. подробнее о [настройке оценки](https://aka.ms/migrate/selfhelp/eapricing).

### <a name="why-does-server-assessment-mark-my-linux-vms-conditionally-ready"></a>Почему средство оценки серверов помечает мои виртуальные машины Linux как условно готовые?
Существует известная разница в оценке сервера, которая не позволяет определить дополнительный номер версии ОС Linux, установленной на локальных виртуальных машинах (например, для RHEL 6,10, в настоящее время Оценка сервера обнаруживает только RHEL 6 в качестве версии ОС). Так как Azure поддерживает только определенные версии Linux, виртуальные машины Linux в настоящее время отмечены как условно готовые к оценке серверов. Вы можете определить, будет ли операционная система Linux, работающая на локальной виртуальной машине, одобрена в Azure, просмотрев [документацию по поддержке Linux в Azure.](https://aka.ms/migrate/selfhost/azureendorseddistros) Убедившись в подтвержденном распространении, можно проигнорировать это предупреждение.

### <a name="why-does-the-vm-sku-recommended-by-server-assessment-have-more-cores-and-more-memory-than-whats-allocated-on-premises"></a>Почему SKU виртуальной машины, рекомендуемый для оценки серверов, имеет больше ядер и больше памяти, чем распределено в локальной среде?
Рекомендация средства оценки серверов в отношении номера SKU виртуальной машины зависит от свойств оценки. В оценке сервера можно создать два типа оценки. На *основе производительности* и *в локальной среде*. Для оценки на основе производительности в ходе оценки серверов учитываются данные об использовании локальных виртуальных машин (ЦП, памяти, диска и использования сети), чтобы определить правильный номер SKU целевой виртуальной машины для локальных виртуальных машин. Кроме того, при изменении размера на основе производительности для определения эффективного использования учитывается эффективный фактор. Для локального изменения размера данные о производительности не учитываются, и рекомендуется использовать целевой номер SKU в зависимости от того, что размещается в локальной среде.

Например, предположим, что имеется локальная виртуальная машина с 4 ядрами и 8 ГБ памяти с 50% использования ЦП и 50% использования памяти, а в ходе оценки указывается отличный фактор 1,3. Если критерий изменения размера для оценки — **локально**, рекомендуется использовать номер SKU виртуальной машины Azure с 4 ядрами и 8 ГБ памяти.

Однако предположим, что критерии изменения размера основаны на производительности. В зависимости от эффективности использования ЦП и памяти (50% от 4 ядер * 1,3 = 2,6 ядер и 50% от 8 ГБ памяти * 1,3 = 5,3 ГБ памяти) рекомендуется использовать самый дешевый номер SKU виртуальных машин из четырех ядер (ближайшее поддерживаемое число ядер) и 8 ГБ памяти (ближайший поддерживаемый объем памяти). См. подробнее об [определении размера средством оценки серверов](https://docs.microsoft.com/azure/migrate/concepts-assessment-calculation#sizing).

### <a name="why-is-the-disk-sku-recommended-by-server-assessment-bigger-than-whats-allocated-on-premises"></a>Почему размер SKU диска, рекомендуемый при оценке сервера, превышает объем выделенной локальной среды?
Размер диска в оценке сервера зависит от двух свойств оценки: критериев изменения размера и типа хранилища. Если критерии изменения размера основаны на **производительности** и для типа хранилища задано значение **автоматически**, то значения операций ввода-вывода и пропускной способности диска будут считаться конечным типом диска (HDD (цен. Категория "Стандартный"), SSD (цен. Категория "Стандартный") или диски уровня "Премиум"). Рекомендуется использовать номер SKU диска из типа диска, и в этой рекомендации учитываются требования к размеру локального диска. Если критерии изменения размера основаны на **производительности**, а тип хранилища — **Premium**, рекомендуется использовать номер SKU диска уровня "Премиум" в Azure на основе требований к операциям ввода-вывода, пропускной способности и размеру локального диска. Та же логика используется для создания размера диска, если критерий изменения размера — **локально** , а тип хранилища — **HDD (цен. Категория "Стандартный")** , **SSD (цен. Категория "Стандартный")** или **Premium**.

Например, если у вас есть локальный диск с 32 ГБ памяти, но агрегированные операции чтения и записи для диска имеют 800 операций ввода-вывода, то при оценке сервера будет рекомендован тип диска уровня "Премиум" (из-за более высоких требований к операциям ввода-вывода), а затем рекомендуемый номер SKU диска, который может поддерживать требуемые операции ввода-вывода и размер. Наиболее подходящий вариант в этом примере будет P15 (256 ГБ и 1100 операций ввода-вывода). Несмотря на то, что размер, необходимый для локального диска, составляет 32 ГБ, при оценке сервера рекомендуется использовать диск большего размера из-за высокого требования к операции ввода-вывода в секунду для локального диска.

### <a name="why-does-my-assessment-report-indicate-percentageofcoresutilizedmissing-or-percentageofmemoryutilizedmissing-for-some-vms"></a>Почему в отчете об оценке указывается "Перцентажеофкоресутилизедмиссинг" или "Перцентажеофмеморютилизедмиссинг" для некоторых виртуальных машин?
Эти проблемы возникают, когда устройству миграции Azure не удается выполнить репликацию данных о производительности для локальных виртуальных машин. Такое поведение может произойти, если во время создания оценки виртуальные машины отключены (последний день/одна неделя/месяц). Устройство не может выполнять собранные данные о производительности для виртуальной машины, если она выключена. Если отсутствуют только счетчики памяти и вы пытаетесь оценить виртуальные машины Hyper-V, проверьте, включена ли динамическая память на этих виртуальных машинах. Есть известная ситуация, при которой устройству "миграция Azure" не удается получить данные об использовании памяти для виртуальных машин, для которых не включена динамическая память. Эта проблема затрагивает только виртуальные машины Hyper-V, а не виртуальные машины VMware. Если какой-либо из счетчиков производительности отсутствует, Оценка сервера Azure для миграции переключается на выделенные ядра и память и рекомендует соответствующий размер виртуальной машины.

### <a name="is-the-os-license-cost-of-the-vm-included-in-the-compute-cost-estimated-by-server-assessment"></a>Стоимость лицензии ОС виртуальной машины, включенной в стоимость вычислений, оцененная оценкой сервера?
Оценка серверов в настоящее время учитывает стоимость лицензий ОС только для компьютеров под управлением Windows. Затраты на лицензии ОС для компьютеров Linux в настоящее время не рассматриваются.

### <a name="what-impact-do-performance-history-and-percentile-utilization-have-on-the-size-recommendations"></a>Какое влияние на журнал производительности и использование процентилей имеют рекомендации по размеру?
Эти свойства применяются только к размерам на основе производительности. Средство оценки серверов непрерывно ведет журнал производительности локальных компьютеров. Эти данные используются для предоставления рекомендаций по выбору номера SKU виртуальной машины и диска в Azure. Эти данные производительности собираются с помощью оценки сервера следующим образом.
- Устройство "миграция Azure" непрерывно проводит локальную среду для сбора данных об использовании в режиме реального времени каждые 20 секунд для виртуальных машин VMware и каждые 30 секунд для виртуальных машин Hyper-V.
- Для создания одной точки данных каждые 10 минут устройство выполняет сведение в 20-секундных и 30-секундных примерах. Чтобы создать одну точку данных, устройство выбирает пиковое значение из 20-секундных и 30-секундных выборок, а затем отправляет их в Azure.
- Когда средство выполняет оценку с учетом периода оценки производительности и значения процентиля журнала производительности, определяется репрезентативный показатель использования. Например, если журнал производительности составляет одну неделю, а использование процентиля — 95 процентиль, то служба "миграция Azure" сортирует все 10-минутные точки выборки за последнюю неделю в возрастающем порядке, а затем выбирает 95 процентиль процентиль в качестве репрезентативного значения.
Значение 95 процентиль процентиль гарантирует игнорирование любых выбросов, которые могут быть добавлены при выборе 99-м процентиль. Если вы хотите выбрать пиковое использование для периода и не хотите пропускать выбросы, следует выбрать 99-м процентиль для использования процентиля.

## <a name="dependency-visualization-issues"></a>Неполадки с визуализацией зависимостей

### <a name="i-cant-find-the-dependency-visualization-functionality-for-azure-government-projects"></a>Не удается найти функцию визуализации зависимостей для проектов Azure для государственных организаций.

Служба "миграция Azure" зависит от Сопоставление служб функции визуализации зависимостей. Так как Сопоставление служб в настоящее время недоступна в Azure для государственных организаций, эта функция недоступна в Azure для государственных организаций.

### <a name="i-installed-the-microsoft-monitoring-agent-mma-and-the-dependency-agent-on-my-on-premises-vms-but-the-dependencies-are-now-showing-up-in-the-azure-migrate-portal"></a>На локальные виртуальные машины установлены Microsoft Monitoring Agent (MMA) и агент зависимостей, однако зависимости не отображаются на портале службы "Миграция Azure".

После установки агентов служба "миграция Azure" обычно занимает 15-30 минут, чтобы отобразить зависимости на портале. Если вы ожидали более 30 минут, убедитесь, что MMA может взаимодействовать с рабочей областью OMS, выполнив следующие действия.

Для виртуальной машины Windows:
1. Перейдите в панель управления и запустите Microsoft Monitoring Agent.
2. На вкладке **Azure log Analytics (OMS)** в диалоговом окне **Свойства Microsoft Monitoring Agent** убедитесь, что **состояние** рабочей области — зеленый.
3. Если состояние не зеленое, попробуйте удалить рабочую область и снова добавить ее в MMA.

      ![Диалоговое окно «Свойства MMA»](./media/troubleshooting-general/mma-status.png)

Для виртуальной машины Linux убедитесь, что команды установки для MMA и агента зависимостей были успешной.

### <a name="what-operating-systems-does-mma-support"></a>Какие операционные системы поддерживает MMA?

 [Ниже приведен список операционных систем Windows, ПОДДЕРЖИВАЕМЫХ MMA](https://docs.microsoft.com/azure/log-analytics/log-analytics-concept-hybrid#supported-windows-operating-systems).
[Ниже приведен список операционных систем Linux, ПОДДЕРЖИВАЕМЫХ MMA](https://docs.microsoft.com/azure/log-analytics/log-analytics-concept-hybrid#supported-linux-operating-systems).

### <a name="what-operating-systems-does-the-dependency-agent-support"></a>Какие операционные системы поддерживает агент зависимостей?

[Ниже приведен список операционных систем Windows, поддерживаемых агентом зависимостей](https://docs.microsoft.com/azure/monitoring/monitoring-service-map-configure#supported-windows-operating-systems). А [Вот список операционных систем Linux, поддерживаемых агентом зависимостей](https://docs.microsoft.com/azure/monitoring/monitoring-service-map-configure#supported-linux-operating-systems).

### <a name="i-cant-visualize-dependencies-in-azure-migrate-for-more-than-a-one-hour-duration"></a>Не удается визуализировать зависимости в Azure в течение длительного времени.
В службе "миграция Azure" можно визуализировать зависимости в течение одного часа. Хотя служба "миграция Azure" позволяет вернуться к определенной дате в прошлом месяце, максимальная продолжительность, для которой можно визуализировать зависимости, составляет один час.

Например, можно использовать функцию длительности времени в сопоставлении зависимостей для просмотра зависимостей за вчерашний период, но их можно просмотреть в течение одного часа. Однако можно использовать журналы Azure Monitor для [запроса данных зависимости](https://docs.microsoft.com/azure/migrate/how-to-create-group-machine-dependencies) в течение более длительного времени.

### <a name="i-cant-visualize-dependencies-for-groups-that-have-more-than-10-vms"></a>Я не могу визуализировать зависимости для групп, имеющих более 10 виртуальных машин.
Вы можете [визуализировать зависимости для групп](https://docs.microsoft.com/azure/migrate/how-to-create-group-dependencies) , имеющих до 10 виртуальных машин. Если у вас есть группа с более чем 10 виртуальными машинами, рекомендуется разбить группу на группы меньшего размера и визуализировать зависимости.

### <a name="i-installed-agents-and-used-the-dependency-visualization-to-create-groups-now-post-failover-the-machines-show-install-agent-action-instead-of-view-dependencies"></a>Мной были установлены агенты и созданы группы с помощью визуализации зависимостей. Теперь после отработки отказа на компьютерах отображаются действия "установить агент" вместо "Просмотр зависимостей".
* После плановой или незапланированной отработки отказа локальные компьютеры отключаются и аналогичные компьютеры загружаются в Azure. Эти компьютеры получают другие MAC-адреса. Они могут получить другой IP-адрес в зависимости от того, выбран ли пользователь для удержания локального IP-адреса.

  Если MAC и IP-адреса различаются, служба "миграция Azure" не связывает локальные компьютеры с данными зависимостей Сопоставление служб. Вместо этого он запрашивает у пользователя установку агентов вместо просмотра зависимостей.
* После тестовой отработки отказа локальные компьютеры остаются включенными, как и ожидалось. Аналогичные компьютеры запрашиваются в Azure, получают другой MAC-адрес и могут получать разные IP адреса. Если пользователь не блокирует исходящий трафик, Azure Monitor журнал с этих компьютеров, служба "миграция Azure" не связывает локальные компьютеры с данными зависимостей Сопоставление служб и запрашивает у пользователей установку агентов вместо просмотра зависимостей.

## <a name="collect-azure-portal-logs"></a>Получение журналов портал Azure

**Разделы справки собирайте журналы сетевого трафика портал Azure?**

1. Откройте браузер, перейдите [на портал](https://portal.azure.com)и выполните вход.
2. Нажмите клавишу F12, чтобы запустить Средства для разработчиков. При необходимости снимите флажок **Очистить записи в** параметрах навигации.
3. Перейдите на вкладку **сеть** и запустите запись сетевого трафика.
   - В Chrome установите флажок **Preserve log** (Сохранить журнал). Запись должна начаться автоматически. Красный кружок означает, что трафик перехватывается. Если красный круг не отображается, выберите черный круг для начала.
   - В Microsoft ребр и Internet Explorer запись должна запускаться автоматически. Если это не так, нажмите зеленую кнопку воспроизведения.
4. Попробуйте воспроизвести ошибку.
5. Если при записи возникла ошибка, остановите запись и сохраните копию записанных действий.
   - В Chrome щелкните правой кнопкой мыши и выберите **Сохранить как HAR с содержимым**. Это действие сжимает и экспортирует журналы как HAR-файл.
   - В Microsoft ребр или Internet Explorer выберите параметр **экспортировать захваченный трафик** . Это действие сжимает и экспортирует журнал.
6. Перейдите на вкладку **консоль** , чтобы проверить наличие предупреждений или ошибок. Чтобы сохранить журнал консоли, сделайте следующее.
   - В Chrome щелкните правой кнопкой мыши в любом месте в журнале консоли. Выберите **Сохранить как**, экспорт и заархивировать журнал.
   - В Microsoft ребр или Internet Explorer щелкните ошибки правой кнопкой мыши и выберите команду **Копировать все**.
7. Закройте средства для разработчиков.
