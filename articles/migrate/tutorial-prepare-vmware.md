---
title: Подготовка виртуальных машин VMware для оценки и миграции в Azure с помощью службы "Миграция Azure" | Документация Майкрософт
description: Описание подготовки для оценки и миграции локальных виртуальных машин VMware в Azure с помощью службы "Миграция Azure".
author: rayne-wiselman
ms.service: azure-migrate
ms.topic: tutorial
ms.date: 07/11/2019
ms.author: raynew
ms.custom: mvc
ms.openlocfilehash: 5bd4926494e13c1dd0cfb6283292ade967471238
ms.sourcegitcommit: dcf3e03ef228fcbdaf0c83ae1ec2ba996a4b1892
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/23/2019
ms.locfileid: "70013433"
---
# <a name="prepare-vmware-vms-for-assessment-and-migration-to-azure"></a>Подготовка виртуальных машин VMware к оценке и миграции в Azure

Из этой статьи можно узнать, как выполнить подготовку для оценки и миграции локальных виртуальных машин VMware в Azure с помощью службы [Миграция Azure](migrate-services-overview.md).

Служба [Миграция Azure](migrate-overview.md) объединяет в себе инструменты, которые используются для поиска, оценки и переноса приложений, инфраструктуры и рабочих нагрузок в Microsoft Azure. Она включает в себя инструменты Миграции Azure и предложения независимых поставщиков программного обеспечения. 


Данное руководство является первым в серии, в которой показано, как оценивать и переносить виртуальные машины VMware. Из этого руководства вы узнаете, как выполнять следующие задачи:

> [!div class="checklist"]
> * Подготовьте Azure. Настройка разрешений для своей учетной записи Azure и ресурсов для работы с Миграцией Azure.
> * Подготовка локальных серверов и виртуальных машин VMware для оценки виртуальных машин.
> * Подготовка локальных серверов и виртуальных машин VMware для миграции виртуальных машин.

> [!NOTE]
> В руководствах показан простейший путь развертывания сценария, использование которого позволяет быстро настроить проверку концепции. В руководствах по возможности используются параметры по умолчанию и показаны не все возможные параметры и пути. Для получения подробных инструкций ознакомьтесь со статьей о выполнении оценки и миграции VMware.

Если у вас еще нет подписки Azure, [создайте бесплатную учетную запись Azure](https://azure.microsoft.com/pricing/free-trial/), прежде чем начинать работу.


## <a name="prepare-azure"></a>Подготовка Azure

Вам потребуются следующие разрешения Azure.

- В учетной записи Azure необходимы разрешения на создание проекта миграции Azure для оценки и миграции. 
- Для оценки и решения для миграции виртуальных машин VMware без агента, Миграция Azure запускает облегченное устройство, которое обнаруживает виртуальные машины и отправляет метаданные виртуальной машины и данные о производительности обратно в службу Миграции Azure. В Azure необходимы разрешения, чтобы зарегистрировать устройство Миграции Azure.
- Чтобы выполнить миграцию виртуальных машин VMware с помощью средства "Миграция сервера" службы "Миграция Azure", эта служба создает хранилище ключей в группе ресурсов, которые используются для управления ключами доступа учетной записи хранилища репликации в подписке. Чтобы создать хранилище, вам потребуются разрешения на назначение ролей в группе ресурсов, в которой находится проект Миграции Azure. 


### <a name="assign-permissions-to-create-project"></a>Назначение разрешений для создания проекта

1. На портале Azure откройте подписку, а затем выберите **Управление доступом (IAM)** .
2. В разделе **Проверить доступ** найдите соответствующую учетную запись и щелкните ее, чтобы просмотреть разрешения.
3. Вы должны обладать разрешениями уровня **Участник** или **Владелец**.
    - Если вы создали бесплатную учетную запись Azure, вы являетесь владельцем подписки.
    - Если вы не являетесь владельцем подписки, назначьте эту роль совместно с владельцем.

### <a name="assign-permissions-to-register-the-appliance"></a>Назначение разрешений для регистрации устройства

Если вы развертываете устройство службы "Миграция Azure" для оценки или запуска миграции виртуальных машин без агентов, вам необходимо ее зарегистрировать.

- Во время регистрации устройства служба "Миграция Azure" создает два приложения Azure Active Directory (Azure AD), которые однозначно идентифицируют устройство.
    - Первое приложение взаимодействует с конечными точками службы "Миграция Azure".
    - Второе приложение обращается к хранилищу ключей Azure, созданному во время регистрации, для хранения информации приложения Azure AD и параметров конфигурации устройства.
- Вы можете назначить разрешения для Миграции Azure для создания этих приложений Azure AD одним из следующих способов:
    - Администратор клиента и глобальный администратор могут предоставлять разрешения пользователям в клиенте для создания и регистрации приложений Azure AD.
    - Администратор клиента и глобальный администратор могут назначить роль разработчика приложений (которая уже имеет нужные разрешения).

Стоит отметить, что:

- Приложения не имеют других разрешений на доступ к подписке, помимо описанных выше.
- Эти разрешения требуются только для регистрации нового устройства. После настройки устройства разрешения можно удалить. 


#### <a name="grant-account-permissions"></a>Предоставление разрешений учетной записи

Администратор клиента и глобальный администратор могут предоставить разрешения, выполнив следующие действия:

1. В Azure AD глобальному администратору или администратору клиента нужно перейти в раздел **Azure Active Directory** > **Пользователи** > **Параметры пользователей**.
2. Затем для параметра **Регистрация приложений** нужно выбрать вариант **Да**.

    ![Разрешения Azure AD](./media/tutorial-prepare-vmware/aad.png)

> [!NOTE]
> Это значение по умолчанию, которое разрешает выполнять регистрацию. [Узнайте больше](https://docs.microsoft.com/azure/active-directory/develop/active-directory-how-applications-are-added#who-has-permission-to-add-applications-to-my-azure-ad-instance).



#### <a name="assign-application-developer-role"></a>Назначение роли разработчика приложения 

Администратор клиента и глобальный администратор могут назначить учетной записи роль разработчика приложений. [Узнайте больше](https://docs.microsoft.com/azure/active-directory/fundamentals/active-directory-users-assign-role-azure-portal).

## <a name="assign-role-assignment-permissions"></a>Назначение разрешений для назначенных ролей

Назначьте разрешения на назначение ролей в группе ресурсов, в которой находится проект Миграции Azure.

1. В группе ресурсов на портале Azure выберите **Управление доступом (IAM)** .
2. В разделе **Проверить доступ** найдите соответствующую учетную запись и щелкните ее, чтобы просмотреть разрешения.

    - Для запуска оценки сервера достаточно разрешений **Участника**.
    - Для запуска миграции без агента у вас должны быть права доступа **Владелец** (или **Участник** и **Администратор доступа пользователя**).

3. Если у вас нет необходимых разрешений, запросите их у владельца группы ресурсов. 



## <a name="prepare-for-vmware-vm-assessment"></a>Подготовка оценки виртуальных машин VMware

Чтобы подготовиться к оценке виртуальной машины VMware, необходимо проверить параметры хоста и виртуальной машины VMware, а также параметры развертывания устройства.

### <a name="verify-vmware-settings"></a>Проверка параметров VMware

1. [Проверьте](migrate-support-matrix-vmware.md#assessment-vcenter-server-requirements) соответствие требованиям сервера VMware для оценки виртуальных машин.
2. [Убедитесь](migrate-support-matrix-vmware.md#assessment-port-requirements), то на серверах vCenter Server открыты необходимые порты.


### <a name="set-up-an-account-for-assessment"></a>Настройка учетной записи для оценки

Службе "миграция Azure" требуется доступ к vCenter Server для обнаружения виртуальных машин для оценки и миграции без агентов. Учетная запись только для чтения для vCenter Server нужна только для оценки.

При использовании firewall.proxy на основе URL-адреса, разрешите доступ к требуемым [URL-адресам Azure](migrate-support-matrix-vmware.md#assessment-url-access-requirements).

Убедитесь, что прокси-сервер разрешает любые записи CNAME, полученные при поиске URL-адресов.


### <a name="verify-appliance-settings-for-assessment"></a>Проверка настроек устройства для оценки

Перед настройкой устройства Миграции Azure и началом оценки из следующего руководства вам следует подготовиться к развертыванию устройства.

1. Выполните [Проверку](migrate-support-matrix-vmware.md#assessment-appliance-requirements) требований для настройки устройства службы "Миграция Azure" в VMware.
2. [Просмотрите](migrate-support-matrix-vmware.md#assessment-url-access-requirements) URL-адреса Azure, к которым устройству потребуется доступ.
3. Просмотрите данные, собранные устройством во время обнаружения и оценки.
4. [Обратите внимание](migrate-support-matrix-vmware.md#assessment-port-requirements) на требования доступа к порту для устройства.
5. Развертывание устройства Миграции Azure в качестве виртуальной машины VMware осуществляется с использованием файла OVA. На сервере vCenter Server убедитесь, что у вашей учетной записи есть разрешения на создание виртуальной машины с использованием файла OVA.


## <a name="prepare-for-agentless-vmware-migration"></a>Подготовка к миграции VMware без агента

Ознакомьтесь с требованиями к миграции виртуальных машин VMware без агента.

1. [Просмотрите](migrate-support-matrix-vmware.md#agentless-migration-vmware-server-requirements) требования к серверу VMware для миграции без агентов.
2. Настройте учетную запись для доступа к vCenter Server с [необходимыми разрешениями](migrate-support-matrix-vmware.md#agentless-migration-vcenter-server-permissions) для миграции без агентов.
3. [Обратите внимание](migrate-support-matrix-vmware.md#agentless-migration-vmware-vm-requirements) на требования к виртуальным машинам VMware, которые вы хотите перенести в Azure с помощью миграции без агента.
4. [Просмотрите](migrate-support-matrix-vmware.md#agentless-migration-appliance-requirements) требования к устройству для миграции без агентов.
5. Обратите внимание на требования к [у](migrate-support-matrix-vmware.md#agentless-migration-url-access-requirements) и [Доступу к порту](migrate-support-matrix-vmware.md#agentless-migration-port-requirements) без агента.


## <a name="prepare-for-agent-based-vmware-migration"></a>Подготовка к миграции VMware на основе агента

Ознакомьтесь с требованиями к миграции виртуальных машин VMware на основе агента.

1. [Просмотрите](migrate-support-matrix-vmware.md#agent-based-migration-vmware-server-requirements) требования к серверу VMware для миграции без агентов. 
2. Настройте учетную запись для доступа к vCenter Server с [необходимыми разрешениями](migrate-support-matrix-vmware.md#agent-based-migration-vcenter-server-permissions) для миграции без агентов.
3. [Обратите внимание](migrate-support-matrix-vmware.md#agent-based-migration-vmware-vm-requirements) на требования к виртуальным машинам VMware, которые вы хотите перенести в Azure с помощью миграции на основе агентов, включая установку Mobility Service на каждую виртуальную машину, которую вы хотите перенести.
4. Обратите внимание на [Доступ к URL-адресам](migrate-support-matrix-vmware.md#agent-based-migration-url-access-requirements).
5. Ознакомьтесь с [требованиями доступа к порту](migrate-support-matrix-vmware.md#agent-based-migration-port-requirements) для Mobility Service, работающей на каждой виртуальной машине, а также для сервера конфигурации Миграции Azure.

## <a name="next-steps"></a>Дополнительная информация

Изучив это руководство, вы:
 
> [!div class="checklist"] 
> * Настройка разрешений Azure
> * Подготовка VMware к оценке и миграции


Перейдите ко второму руководству по настройке проекта миграции Azure и оцените виртуальные машины VMware для миграции на Azure.

> [!div class="nextstepaction"] 
> [Migrate VMware VMs to Azure (agentless)](./tutorial-assess-vmware.md) (Миграция виртуальных машин VMware в Azure (без агента)) 

