---
title: Эталонные архитектуры защиты Azure от атак DDoS
description: Ознакомьтесь с эталонными архитектурами защиты Azure от атак DDoS.
services: ddos-protection
documentationcenter: na
author: yitoh
ms.service: ddos-protection
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 09/08/2020
ms.author: yitoh
ms.openlocfilehash: 3371b9cc0848e387c0150ca9aa7e7a971cecba1a
ms.sourcegitcommit: 693df7d78dfd5393a28bf1508e3e7487e2132293
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/28/2020
ms.locfileid: "92905610"
---
# <a name="ddos-protection-reference-architectures"></a>Эталонные архитектуры защиты от атак DDoS

Стандарт защиты от атак DDoS предназначен [для служб, развернутых в виртуальной сети](/azure/virtual-network/virtual-network-for-azure-services). Для остальных служб применяется "Защита от атак DDoS" уровня "Базовый". Следующие эталонные архитектуры упорядочены по сценариям. Образцы архитектуры сгруппированы.

## <a name="virtual-machine-windowslinux-workloads"></a>Рабочие нагрузки виртуальной машины (Windows и Linux)

### <a name="application-running-on-load-balanced-vms"></a>Приложение, запущенное на виртуальных машинах с балансировкой нагрузки

На этой схеме эталонной архитектуры представлены проверенные способы запуска нескольких виртуальных машин Windows в масштабируемом наборе за подсистемой балансировки нагрузки для повышения доступности и масштабируемости. Эта архитектура может использоваться для любой рабочей нагрузки без учета состояния, например для веб-сервера.

![Схема эталонной архитектуры для приложений, запущенных на виртуальных машинах с балансировкой нагрузки](./media/ddos-best-practices/image-9.png)

В этой архитектуре рабочая нагрузка распределяется между несколькими экземплярами виртуальных машин. Здесь приведен один общедоступный IP-адрес, а интернет-трафик распределяется между виртуальными машинами через подсистему балансировки нагрузки. "Защита от атак DDoS" уровня "Стандартный" включена в виртуальной сети подсистемы балансировки нагрузки Azure (Интернет) с общедоступным IP-адресом.

Подсистема балансировки нагрузки распределяет входящие запросы из Интернета между экземплярами виртуальных машин. Масштабируемые наборы виртуальных машин позволяют масштабировать определенное число виртуальных машин вручную или автоматически на основе предопределенных правил. Это важно, если ресурс находится под атакой DDoS. Дополнительные сведения об этой эталонной архитектуре см. [в этой статье](/azure/architecture/reference-architectures/virtual-machines-windows/multi-vm).

### <a name="application-running-on-windows-n-tier"></a>N-уровневые приложения, выполняющиеся на компьютере Windows

Существует много способов реализовать n-уровневую архитектуру. На следующей схеме показано стандартное трехуровневое веб-приложение. Эта архитектура создана на основе архитектуры из статьи [N-уровневое приложение с SQL Server](/azure/architecture/reference-architectures/virtual-machines-windows/multi-vm). На веб- и бизнес-уровнях используются виртуальные машины с балансировкой нагрузки.

![Схема эталонной архитектуры для N-уровневых приложений, выполняющихся на компьютере Windows](./media/ddos-best-practices/image-10.png)

В этой архитектуре "Защита от атак DDoS" уровня "Стандартный" включена в виртуальной сети. Все общедоступные IP-адреса в виртуальной сети получают защиту от атак DDoS уровня 3 или 4. Для защиты от атак уровня 7 разверните шлюз приложений в WAF SKU. Дополнительные сведения об этой эталонной архитектуре см. [в этой статье](/azure/architecture/reference-architectures/virtual-machines-windows/n-tier).

> [!NOTE]
> Сценарии, в которых одна виртуальная машина работает за общедоступным IP-адресом, не поддерживаются.

### <a name="paas-web-application"></a>Веб-приложение PaaS

Эталонная архитектура демонстрирует запуск приложения службы приложений Azure в одном регионе. Архитектура демонстрирует набор проверенных методов для создания веб-приложения, в котором используются [служба приложений Azure](https://azure.microsoft.com/documentation/services/app-service/) и служба [База данных SQL Azure](https://azure.microsoft.com/documentation/services/sql-database/).
Резервный регион настроен для сценариев отработки отказа.

![Схема эталонной архитектуры для веб-приложения PaaS](./media/ddos-best-practices/image-11.png)

Диспетчер трафика Azure направляет входящие запросы к шлюзу приложений в одном из регионов. При обычной работе он направляет запросы в шлюз приложений в активном регионе. Если этот регион становится недоступным, диспетчер трафика выполняет отработку отказа в шлюз приложений в резервном регионе.

Весь интернет-трафик, предназначенный для веб-приложения, перенаправляется на [общедоступный IP-адрес шлюза приложений](/azure/application-gateway/application-gateway-web-app-overview) через диспетчер трафика. В этом случае сама служба приложения (веб-приложения) не является общедоступной — она защищена шлюзом приложений. 

Для защиты от атак уровня 7 (HTTP, HTTPS, WebSocket) мы рекомендуем настроить шлюз приложений WAF SKU (режим предотвращения). Кроме того, веб-приложения настроены для [принятия только трафика с IP-адресов шлюза приложений](https://azure.microsoft.com/blog/ip-and-domain-restrictions-for-windows-azure-web-sites/).

Дополнительные сведения об этой эталонной архитектуре см. [в этой статье](/azure/architecture/reference-architectures/app-service-web-app/multi-region).

## <a name="mitigation-for-non-web-paas-services"></a>Устранение рисков для служб PaaS

### <a name="hdinsight-on-azure"></a>HDInsight в Azure

Эта эталонная архитектура демонстрирует настройку службы "Защита от атак DDoS" уровня "Стандартный" для [кластера HDInsight Azure](/azure/hdinsight/). Убедитесь, что кластер HDInsight связан с виртуальной сетью, и "Защита от атак DDoS" включена в этой виртуальной сети.

![Панели "HDInsight" и "Дополнительные параметры" с параметрами виртуальной сети](./media/ddos-best-practices/image-12.png)

![Выбор значения для включения защиты от атак DDoS](./media/ddos-best-practices/image-13.png)

В этой архитектуре трафик, предназначенный для кластера HDInsight, перенаправляется из Интернета на общедоступный IP-адрес, связанный с подсистемой балансировки нагрузки шлюза HDInsight. Затем подсистема балансировки нагрузки шлюза отправляет трафик на головные или рабочие узлы напрямую. Так как "Защита от атак DDoS" уровня "Стандартный" включена в виртуальной сети HDInsight, то все общедоступные IP-адреса в виртуальной сети получают защиту от атак DDoS уровня 3 или 4. Эта эталонная архитектура может объединяться с эталонными архитектурами N-уровневого приложения в нескольких регионах.

Дополнительные сведения об этой эталонной архитектуре см. в статье [Расширение возможностей HDInsight с помощью виртуальной сети Azure](/azure/hdinsight/hdinsight-extend-hadoop-virtual-network?toc=%2fazure%2fvirtual-network%2ftoc.json).


> [!NOTE]
> Среда Службы приложений Azure для PowerApps и управление API в виртуальной сети с общедоступным IP-адресом не поддерживаются на уровне системы.

## <a name="next-steps"></a>Дальнейшие действия

- Узнайте, как [создать план защиты от атак DDoS](manage-ddos-protection.md).