---
title: Разработка безопасных приложений в Microsoft Azure
description: В этой статье рассматриваются рекомендации по рассмотрению на этапе разработки вашего проекта веб-приложений.
author: TerryLanfear
manager: barbkess
ms.author: terrylan
ms.date: 06/11/2019
ms.topic: article
ms.service: security
ms.subservice: security-develop
services: azure
ms.assetid: 521180dc-2cc9-43f1-ae87-2701de7ca6b8
ms.devlang: na
ms.tgt_pltfrm: na
ms.workload: na
ms.openlocfilehash: c9e3cfa689f2e528f4d20e796017ae9d91c29fe2
ms.sourcegitcommit: b55d7c87dc645d8e5eb1e8f05f5afa38d7574846
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/16/2020
ms.locfileid: "81461724"
---
# <a name="design-secure-applications-on-azure"></a>Разработка безопасных приложений на Azure
В этой статье мы представляем действия и элементы управления безопасности, чтобы учитывать при проектировании приложений для облака. Рассматриваются учебные ресурсы наряду с вопросами безопасности и концепциями, которые необходимо учитывать на этапах разработки требований и этапов проектирования [жизненного цикла разработки microsoft Security Development (SDL).](https://msdn.microsoft.com/library/windows/desktop/84aed186-1d75-4366-8e61-8d258746bopq.aspx) Цель состоит в том, чтобы помочь определить действия и службы Azure, которые можно использовать для разработки более безопасного приложения.

Следующие фазы SDL описаны в этой статье:

- Обучение
- Требования
- Конструирование

## <a name="training"></a>Обучение
Прежде чем приступить к разработке облачного приложения, потребуется время, чтобы понять безопасность и конфиденциальность в Azure. Снимав этот шаг, можно уменьшить количество и серьезность уязвимостей в приложении. Вы будете более подготовлены к адекватному реагированию на постоянно меняющийся ландшафт угроз.

Воспользуйтесь следующими ресурсами на этапе обучения, чтобы ознакомиться с службами Azure, доступными для разработчиков, и с рекомендациями по безопасности в Azure:

  - [Руководство разработчика по Azure](https://azure.microsoft.com/campaigns/developer-guide/) показывает, как начать работу с Azure. В руководстве показано, какие службы можно использовать для запуска приложений, хранения данных, включения интеллектуальных данных, создания приложений IoT и более эффективного и безопасного развертывания решений.

  - [Начинающее руководство для разработчиков Azure](../../guides/developer/azure-developer-guide.md) предоставляет важную информацию для разработчиков, которые хотят начать использовать платформу Azure для своих потребностей в разработке.

  - [SDKs и инструменты](https://docs.microsoft.com/azure/index?pivot=sdkstools) описывают инструменты, доступные на Azure.

  - [Службы Azure DevOps](https://docs.microsoft.com/azure/devops/) предоставляют инструменты совместной работы в области разработки. Инструменты включают высокопроизводительные конвейеры, бесплатные репозитории Git, настраиваемые доски Kanban и обширное автоматизированное и облачное тестирование нагрузки.
    [Ресурсный центр DevOps](https://docs.microsoft.com/azure/devops/learn/) объединяет наши ресурсы для изучения практик DevOps, управления версиями Git, гибких методов, того, как мы работаем с DevOps в корпорации Майкрософт, и как вы можете оценить свою собственную прогрессию DevOps.

  - [Топ 5 элементов безопасности, которые следует учитывать перед началом производства,](https://docs.microsoft.com/learn/modules/top-5-security-items-to-consider/index?WT.mc_id=Learn-Blog-tajanca) показывает, как защитить веб-приложения в Azure и защитить приложения от наиболее распространенных и опасных атак веб-приложений.

  - [Secure DevOps Kit for Azure](https://azsk.azurewebsites.net/index.html) — это набор скриптов, инструментов, расширений и автоматизации, который удовлетворяет комплексные потребности групп разработчиков подписок Azure и безопасности ресурсов групп DevOps, которые используют обширную автоматизацию. Безопасный набор DevOps для Azure может показать вам, как плавно интегрировать безопасность в ваши рабочие процессы DevOps. Комплект адреса таких инструментов, как тесты проверки безопасности (SVTs), которые могут помочь разработчикам написать безопасный код и проверить безопасную конфигурацию своих облачных приложений на этапах кодирования и ранней разработки.

  - [Рекомендации по безопасности для решений Azure](https://azure.microsoft.com/resources/security-best-practices-for-azure-solutions) предоставляют набор рекомендаций по безопасности для разработки, развертывания и управления облачными решениями с помощью Azure.

## <a name="requirements"></a>Требования
Этап определения требований является важным шагом в определении того, что ваше приложение и что он будет делать, когда он будет выпущен. Этап требований также является временем для размышлений о средствах управления безопасностью, которые вы будете встраивать в ваше приложение. На этом этапе вы также начинаете шаги, которые вы будете делать по всему SDL, чтобы гарантировать, что вы отпустите и развернуть безопасное приложение.

### <a name="consider-security-and-privacy-issues"></a>Рассмотрим вопросы безопасности и конфиденциальности
Этот этап является лучшим временем для рассмотрения основополагающих вопросов безопасности и конфиденциальности. Определение приемлемых уровней безопасности и конфиденциальности в начале проекта помогает команде:

- Понимание рисков, связанных с проблемами безопасности.
- Выявление и устранение ошибок безопасности во время разработки.
- Применять установленные уровни безопасности и конфиденциальности на протяжении всего проекта.

При написании требований к приложению обязательно рассмотрите элементы безопасности, которые могут помочь сохранить ваше приложение и данные в безопасности.

### <a name="ask-security-questions"></a>Задавайте вопросы безопасности
Задавайте вопросы безопасности, такие как:

  - Содержит ли мое приложение конфиденциальные данные?

  - Собирает ли мое приложение или хранит данные, требующие от меня соблюдения отраслевых стандартов и программ соответствия требованиям, таких как Федеральный совет по [экспертизе финансовых учреждений (FFIEC)](../blueprints/ffiec-analytics-overview.md) или [Стандарты безопасности данных платежной карты (PCI DSS)?](../blueprints/pcidss-analytics-overview.md)

  - Собирает ли мое приложение или содержит конфиденциальные личные или клиентские данные, которые могут быть использованы как самостоятельно, так и с другой информацией для идентификации, контакта или поиска одного человека?

  - Собирает ли мое приложение или содержит данные, которые могут быть использованы для доступа к медицинской, образовательной, финансовой или трудовой информации человека? Определение чувствительности данных на этапе требований поможет вам классифицировать данные и определить метод защиты данных, который вы будете использовать для приложения.

  - Где и как хранятся мои данные? Подумайте, как вы будете контролировать службы хранения данных, которые приложение использует для любых неожиданных изменений (например, замедленного времени отклика). Сможете ли вы повлиять на журналирование, чтобы собрать более подробные данные и подробно проанализировать проблему?

  - Будет ли мое приложение доступно для общественности (в Интернете) или только внутри страны? Если приложение доступно для общественности, как защитить данные, которые могут быть собраны, от неправильного использования? Если ваше приложение доступно только внутри страны, подумайте, кто в вашей организации должен иметь доступ к приложению и как долго они должны иметь доступ.

  - Понимаете ли вы свою модель идентификации до начала разработки приложения? Как вы определите, что пользователи, кто они говорят, что они и что пользователь уполномочен делать?

  - Выполняет ли мое приложение чувствительные или важные задачи (такие как перевод денег, открытие дверей или доставка лекарств)?
    Подумайте, как вы проверите, что пользователь, выполняющий конфиденциальную задачу, уполномочен выполнять задачу, и как вы будете проверять подлинность того, кто он является тем, кем он является. Авторизация (Аутх) — это акт предоставления подлинного разрешения на безопасность. Аутентификация (AuthN) является актом оспаривания стороны для законных учетных данных.

  - Выполняет ли мое приложение какие-либо рискованные действия в программном обеспечении, например, разрешают пользователям загружать или загружать файлы или другие данные? Если приложение выполняет рискованные действия, подумайте, как ваше приложение защитит пользователей от обработки вредоносных файлов или данных.

### <a name="review-owasp-top-10"></a>Обзор OWASP Топ 10
Рассмотрите [<span class="underline">oWASP Top 10 рисков безопасности приложений.</span>](https://www.owasp.org/index.php/Category:OWASP_Top_Ten_Project)
Топ-10 OWASP рассматривает критические риски безопасности для веб-приложений.
Осведомленность об этих рисках безопасности может помочь вам принять решения, связанные с требованиями, и свести к минимуму эти риски в приложении.

Важно думать о средствах безопасности для предотвращения нарушений.
Тем не менее, вы также хотите [предположить, что нарушение](https://docs.microsoft.com/azure/devops/learn/devops-at-microsoft/security-in-devops) произойдет. Предполагая, что нарушение помогает ответить на некоторые важные вопросы о безопасности заранее, поэтому они не должны быть даны ответы в чрезвычайной ситуации:

  - Как обнаружить атаку?

  - Что я буду делать, если есть атака или нарушение?

  - Как я могу оправиться от атаки, как утечка данных или фальсификации?

## <a name="design"></a>Конструирование

Этап проектирования имеет решающее значение для установления наилучшей практики для проектирования и функциональных спецификаций. Он также имеет решающее значение для выполнения анализа рисков, который помогает смягчить проблемы безопасности и конфиденциальности во всем проекте.

При установлении требований безопасности и использовании безопасных концепций проектирования можно избежать или свести к минимуму возможности для изъяна безопасности. Недостаток безопасности — это недостаток в разработке приложения, который может позволить пользователю выполнять вредоносные или неожиданные действия после выпуска приложения.

На этапе проектирования также подумайте о том, как можно применить безопасность в слоях; одного уровня защиты не обязательно достаточно. Что произойдет, если злоумышленник проходит через брандмауэр веб-приложений (WAF)? Вы хотите, чтобы другой контроль безопасности на месте, чтобы защититься от этого нападения.

Имея это в виду, мы обсуждаем следующие концепции безопасного проектирования и элементы управления безопасностью, которые следует учитывать при разработке безопасных приложений:

- Используйте защищенную библиотеку кодирования и программную платформу.
- Сканирование уязвимых компонентов.
- Используйте моделирование угроз при проектировании приложений.
- Уменьшите поверхность атаки.
- Принять политику идентификации в качестве основного периметра безопасности.
- Требуется повторная аутентификация для важных транзакций.
- Используйте решение управления ключами для защиты ключей, учетных данных и других секретов.
- Защита конфиденциальных данных.
- Осуществление мер по обеспечению безопасности на сбоев.
- Воспользуйтесь преимуществами обработки ошибок и исключений.
- Используйте журнал и оповещение.

### <a name="use-a-secure-coding-library-and-a-software-framework"></a>Используйте защищенную библиотеку кодирования и программную платформу

Для разработки используйте защищенную библиотеку кодирования и программную платформу, которая встраивает безопасность. Разработчики могут использовать существующие проверенные функции (шифрование, санитарию ввода, кодирование выходных данных, ключи или строки соединения, а также все остальное, что будет считаться контролем безопасности) вместо разработки элементов управления безопасностью с нуля. Это помогает защититься от недостатков проектирования и реализации, связанных с безопасностью.

Убедитесь, что вы используете последнюю версию платформы и все функции безопасности, которые доступны в рамках. Корпорация Майкрософт предлагает полный [набор инструментов разработки](https://azure.microsoft.com/product-categories/developer-tools/) для всех разработчиков, работающих на любой платформе или языке, для предоставления облачных приложений. Вы можете код с языком по вашему выбору, выбрав из различных [SDKs](https://azure.microsoft.com/downloads/).
Вы можете воспользоваться преимуществами полнофункциональных интегрированных сред разработки (IDE) и редакторов, которые имеют расширенные возможности отладки и встроенную поддержку Azure.

Корпорация Майкрософт предлагает различные [языки, платформы и инструменты,](https://docs.microsoft.com/azure/index?pivot=sdkstools&panel=sdkstools-all) которые можно использовать для разработки приложений на Azure. Примером может быть [Azure для разработчиков .NET и .NET Core.](https://docs.microsoft.com/dotnet/azure/) Для каждого языка и платформы, которые мы предлагаем, вы найдете quickstarts, учебники и API ссылки, чтобы помочь вам начать работу быстро.

Azure предлагает различные услуги, которые можно использовать для размещения веб-сайтов и веб-приложений. Эти сервисы позволяют вам развиваться на любимом языке, будь то .NET, .NET Core, Java, Ruby, Node.js, PHP или Python.
[Веб-приложения Службы приложений azure App (Web](../../app-service/overview.md) Apps) — одна из таких служб.

Веб-приложения добавляют в приложение силу Microsoft Azure. Она включает в себя безопасность, балансировку нагрузки, автоматическое управление и автоматизированное управление. Вы также можете воспользоваться возможностями DevOps в Web-приложениях, такими как управление пакетами, средами для постановки, пользовательскими доменами, сертификатами SSL/TLS и непрерывным развертыванием из Azure DevOps, GitHub, Docker Hub и других источников.

Azure предлагает другие услуги, которые можно использовать для размещения веб-сайтов и веб-приложений. В большинстве случаев оптимальным вариантом являются веб-приложения. Для архитектуры микросервисов рассмотрим [архитектуру службы Azure.](https://azure.microsoft.com/documentation/services/service-fabric)
См. дополнительные сведения о дополнительном контроле над [виртуальными машинами Azure, на которых выполняется код](https://azure.microsoft.com/documentation/services/virtual-machines/).
Для получения дополнительной информации о [том,](/azure/architecture/guide/technology-choices/compute-decision-tree)как выбрать между этими службами Azure, см.

### <a name="apply-updates-to-components"></a>Применить обновления к компонентам

Чтобы предотвратить уязвимости, необходимо постоянно инвентарить как компоненты со стороны клиента, так и сервера (например, фреймворки и библиотеки), а также их зависимости для обновления. Новые уязвимости и обновленные версии программного обеспечения выпускаются непрерывно. Убедитесь, что у вас есть постоянный план мониторинга, сортировки и применения обновлений или изменений конфигурации в библиотеках и компонентах, которые вы используете.

Смотрите страницу [Open Web Application Security Project (OWASP)](https://www.owasp.org/index.php/Main_Page) по [использованию компонентов с известными уязвимостями](https://www.owasp.org/index.php/Top_10-2017_A9-Using_Components_with_Known_Vulnerabilities) для предложений инструментов. Вы также можете подписаться на оповещения по электронной почте об уязвимостях безопасности, связанных с использоватьми компонентов.

### <a name="use-threat-modeling-during-application-design"></a>Использование моделирование угроз во время разработки приложения

Моделирование угроз — это процесс выявления потенциальных угроз безопасности для вашего бизнеса и приложения, а затем обеспечение надлежащего смягчения последствий. SDL указывает, что группы должны участвовать в моделировании угроз на этапе проектирования, когда решение потенциальных проблем является относительно простым и экономически эффективным. Использование моделирования угроз на этапе проектирования может значительно снизить общую стоимость разработки.

Чтобы облегчить процесс моделирования угроз, мы разработали [инструмент моделирования угроз SDL](threat-modeling-tool.md) с учетом экспертов, не связанных с безопасностью. Этот инструмент упрощает моделирование угроз для всех разработчиков, предоставляя четкие рекомендации о том, как создавать и анализировать модели угроз.

Моделирование дизайна приложения и перечисление угроз STRIDE-Spoofing, Tampering, Repudiation, Disclosure, Denial of Service и Elevation of Privilege – во всех границах доверия оказалось эффективным способом вылавливания ошибок проектирования на ранних стадиях. [STRIDE](https://docs.google.com/viewer?a=v&pid=sites&srcid=ZGVmYXVsdGRvbWFpbnxzZWN1cmVwcm9ncmFtbWluZ3xneDo0MTY1MmM0ZDI0ZjQ4ZDMy) В следующей таблице перечислены угрозы STRIDE и приведены некоторые примеры смягчения последствий, в которых используются функции, предоставляемые Azure. Эти способы могут помочь не во всех ситуациях.

| Threat | Свойство безопасности | Потенциальное смягчение последствий платформы Azure |
| ---------------------- | --------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| Спуфинг               | Аутентификация        | [Требуются подключения HTTPS.](https://docs.microsoft.com/aspnet/core/security/enforcing-ssl?view=aspnetcore-2.1&tabs=visual-studio) |
| Подделка              | Целостность             | Проверка сертификатов SSL/TLS. Приложения, используюющие SSL/TLS, должны полностью проверять сертификаты X.509 объектов, к которым они подключаются. Используйте сертификаты Azure Key Vault для [управления сертификатами x509.](../../key-vault/about-keys-secrets-and-certificates.md#key-vault-certificates) |
| Отказ            | Неподдельность       | Включите [мониторинг и диагностику](https://docs.microsoft.com/azure/architecture/best-practices/monitoring) в Azure.|
| Раскрытие информации | Конфиденциальность       | Шифрование конфиденциальных данных [в состоянии покоя](../fundamentals/encryption-atrest.md) и [в пути.](../fundamentals/data-encryption-best-practices.md#protect-data-in-transit) |
| Отказ в обслуживании      | Доступность          | Мониторинг показателей производительности для потенциальных условий отказа в обслуживании. Примените фильтры подключения. [Защита от DDoS Azure](../../virtual-network/ddos-protection-overview.md#next-steps)в сочетании с передовыми рекомендациями по разработке приложений обеспечивает защиту от DDoS-атак.|
| Повышение привилегий | Авторизация         | Используйте Управление <span class="underline"> </span> [привилегированным](../../active-directory/privileged-identity-management/pim-configure.md)удостоверением личности Azure Active Directory.|

### <a name="reduce-your-attack-surface"></a>Уменьшите поверхность атаки

Поверхность атаки — это общая сумма того, где могут возникнуть потенциальные уязвимости. В этой статье мы сосредоточимся на поверхности атаки приложения.
Основное внимание уделяется защите приложения от атак. Простой и быстрый способ свести к минимуму поверхность атаки — удалить неиспользованные ресурсы и код из приложения. Чем меньше приложение, тем меньше поверхность атаки. Например, удалите:

- Код для функций, которые вы еще не выпустили.
- Отладка кода поддержки.
- Сетевые интерфейсы и протоколы, которые не используются или были универслены.
- Виртуальные машины и другие ресурсы, которые вы не используете.

Регулярная очистка ресурсов и удаление неиспользованного кода являются отличными способами, чтобы гарантировать, что у злоумышленников меньше возможностей для атаки.

Более подробный и углубленный способ уменьшить поверхность атаки — это завершение анализа поверхности атаки. Анализ поверхности атаки поможет сопоставить части системы, которые необходимо просмотреть и протестировать на наличие уязвимостей в системе безопасности.

Цель анализа поверхности атаки состоит в том, чтобы понять области риска в приложении, чтобы разработчики и специалисты по безопасности знали, какие части приложения открыты для атак. Затем можно найти способы свести к минимуму этот потенциал, отслеживать, когда и как изменяется поверхность атаки, и что это означает с точки зрения риска.

Анализ поверхности атаки помогает определить:

- Функции и части системы необходимо проверить и проверить на наличие уязвимостей в системе безопасности.
- Области с высоким риском кода, требующие защиты глубокой защиты (части системы, которые необходимо защищать).
- При изменении поверхности атаки и необходимости обновления оценки угрозы.

Сокращение возможностей для злоумышленников использовать потенциальнослабое место или уязвимость требует тщательного анализа общей поверхности атаки приложения. Она также включает в себя отключение или ограничение доступа к системным службам, применение принципа наименьших привилегий и использование многоуровневой защиты, где это возможно.

Мы обсуждаем [проведение обзора поверхности атаки](secure-develop.md#conduct-attack-surface-review) на этапе проверки SDL.

> [!NOTE]
> **В чем разница между моделированием угроз и анализом поверхности атаки?**
Моделирование угроз — это процесс выявления потенциальных угроз безопасности для вашего приложения и обеспечения надлежащего смягчения угроз. Анализ поверхности атаки определяет области кода высокого риска, которые открыты для атаки. Она включает в себя поиск способов защиты областей повышенного риска вашего приложения и рассмотрение и тестирование этих областей кода перед развертыванием приложения.

### <a name="adopt-a-policy-of-identity-as-the-primary-security-perimeter"></a>Применение политики удостоверения в качестве основного периметра безопасности

При проектировании облачных приложений важно расширить фокус периметра безопасности с сетевого подхода на подход, ориентированный на идентификацию. Исторически основным периметром безопасности в помещениях была сеть организации. Большинство локтевых конструкций безопасности используют сеть в качестве основного стержня безопасности. Для облачных приложений лучше рассматривать идентификацию в качестве основного периметра безопасности.

Что вы можете сделать для разработки ориентированного на личность подхода к разработке веб-приложений:

- Обеспечить многофакторную аутентификацию пользователей.
- Используйте надежные платформы аутентификации и авторизации.
- Примените принцип наименьшей привилегии.
- Реализация точно в срок доступа.

#### <a name="enforce-multi-factor-authentication-for-users"></a>Обеспечение многофакторной аутентификации пользователей

Используйте двухфакторную аутентификацию. Двухфакторная аутентификация является текущим стандартом проверки подлинности и авторизации, поскольку она позволяет избежать недостатков безопасности, которые присущи типам имен пользователей и паролей проверки подлинности. Доступ к интерфейсам управления Azure (портал Azure/удаленный PowerShell) и к службам, ориентированным на клиента, должен быть разработан и настроен для использования [многофакторной аутентификации Azure.](../../active-directory/authentication/concept-mfa-howitworks.md)

#### <a name="use-strong-authentication-and-authorization-platforms"></a>Используйте сильные платформы проверки подлинности и авторизации

Используйте предоставляемые платформой механизмы аутентификации и авторизации вместо пользовательского кода. Это связано с тем, что разработка пользовательского кода проверки подлинности может быть подвержена ошибкам. Коммерческий код (например, от корпорации Майкрософт) часто тщательно проверяется на предмет безопасности. [Azure Active Directory (Azure AD)](../../active-directory/fundamentals/active-directory-whatis.md) — это решение для идентификации и управления доступом в Azure. Эти инструменты и службы Azure AD помогают в безопасной разработке:

- [Платформа идентификации Azure AD (Azure AD для разработчиков)](../../active-directory/develop/about-microsoft-identity-platform.md) — это служба облачных идентификаций, которую разработчики используют для создания приложений, которые надежно региструется в пользователях. Azure AD помогает разработчикам, которые строят одноместные приложения(LOB) и разработчикам, которые хотят разрабатывать мультитенантные приложения. Помимо базового ввоза, приложения, созданные с помощью Azure AD, могут вызывать AI-аДУ Майкрософт и пользовательские AI, построенные на платформе Azure AD. Платформа идентификации Azure AD поддерживает стандартные для отраслей протоколы, такие как OAuth 2.0 и OpenID Connect.

- [Azure Active Directory B2C (Azure AD B2C)](../../active-directory-b2c/index.yml) — это служба управления идентификационными данными, используемая для настройки и контроля за тем, как клиенты регистрируются, регистрируются и управляют своими профилями при использовании приложений. Это включает в себя приложения, которые разрабатываются для iOS, Android и .NET, среди других. Azure AD B2C позволяет выполнять эти действия, защищая идентификаторы клиентов.

#### <a name="apply-the-principle-of-least-privilege"></a>Применить принцип наименьших привилегий

Концепция [наименьших привилегий](https://en.wikipedia.org/wiki/Principle_of_least_privilege) означает предоставление пользователям точного уровня доступа и контроля, необходимого им для работы, и не более того.

Нужны ли разработчику программного обеспечения права на админ-домена? Нужен ли административному помощнику доступ к административному контролю на своем персональном компьютере? Оценка доступа к программному обеспечению ничем не отличается. Если вы используете элементаруемый [элемент управления доступом (RBAC),](../../role-based-access-control/overview.md) чтобы предоставить пользователям различные способности и авторитет в вашем приложении, вы не дали бы всем доступ ко всему. Ограничивая доступ к тому, что требуется для каждой роли, вы ограничиваете риск возникновения проблемы безопасности.

Убедитесь, что приложение обеспечивает [наименьшие привилегии](https://docs.microsoft.com/windows-server/identity/ad-ds/plan/security-best-practices/implementing-least-privilege-administrative-models#in-applications) на протяжении всего шаблонов доступа.

> [!NOTE]
>  Правила наименьших привилегий должны применяться к программному обеспечению и к людям, создающих программное обеспечение. Разработчики программного обеспечения могут быть огромным риском для ИТ-безопасности, если они получают слишком большой доступ. Последствия могут быть серьезными, если разработчик имеет злой умысел или получает слишком большой доступ. Мы рекомендуем применять правила наименьших привилегий к разработчикам на протяжении всего жизненного цикла разработки.

#### <a name="implement-just-in-time-access"></a>Реализация точно в срок доступа

Реализация *точно в срок* (JIT) доступ к дальнейшему снижению времени экспозиции привилегий. Используйте [Azure AD Privileged Identity Management](../../active-directory/users-groups-roles/directory-admin-roles-secure.md#stage-3-build-visibility-and-take-full-control-of-admin-activity) для:

- Предоставь пользователям разрешения, необходимые только JIT.
- назначать роли на короткий период с автоматическим отзывом привилегий.

### <a name="require-re-authentication-for-important-transactions"></a>Требуется повторная аутентификация для важных транзакций

[Кросс-сайт запрос подделки](https://docs.microsoft.com/aspnet/core/security/anti-request-forgery?view=aspnetcore-2.1) (также известный как *XSRF* или *CSRF*) является атака на веб-приложений, в которых вредоносное веб-приложение влияет на взаимодействие между браузером клиента и веб-приложение, которое доверяет этому браузеру. Кросс-сайт запрос подделки атак возможны, потому что веб-браузеры отправить некоторые типы маркеров аутентификации автоматически с каждым запросом на веб-сайт.
Эта форма эксплуатации также известна как *атака одним щелчком мыши* или езда *сеанса,* потому что атака использует ранее проверенную сессию пользователя.

Лучший способ защититься от такого рода атак — спросить у пользователя что-то, что только пользователь может предоставить перед каждой важной транзакцией, например, о покупке, деактивации учетной записи или изменении пароля. Вы можете попросить пользователя повторно ввести свой пароль, заполнить captcha или отправить секретный маркер, который будет иметь только пользователь. Наиболее распространенным подходом является секретный токен.

### <a name="use-a-key-management-solution-to-secure-keys-credentials-and-other-secrets"></a>Используйте решение управления ключами для защиты ключей, учетных данных и других секретов

Потеря ключей и учетных данных является распространенной проблемой. Хуже потери ключей и учетных данных может быть только получение к ним несанкционированного доступа. Злоумышленники могут воспользоваться автоматизированными и ручными методами, чтобы найти ключи и секреты, которые хранятся в репозиториях кода, таких как GitHub. Не помещайте ключи и секреты в эти хранилища публичного кода или на любой другой сервер.

Всегда помещайте ключи, сертификаты, секреты и строки соединения в решение для управления ключами. Можно использовать централизованное решение, в котором ключи и секреты хранятся в модулях аппаратной безопасности (HSMs). Azure предоставляет HSM в облаке с [Azure Key Vault.](../../key-vault/general/overview.md)

Key Vault — это *секретный магазин:* это централизованный облачный сервис для хранения секретов приложений. Key Vault сохраняет ваши конфиденциальные данные в безопасности, сохраняя секреты приложения в одном, центральном месте и обеспечивая безопасный доступ, контроль разрешений и регистрацию доступа.

Секреты хранятся в *отдельных хранилищах.* Каждое хранилище имеет свою собственную конфигурацию и политики безопасности для управления доступом. Вы получаете данные через REST API или через клиентский SDK, который доступен для большинства языков программирования.

> [!IMPORTANT]
> Azure Key Vault предназначен для хранения секретов конфигурации для серверных приложений. Он не предназначен для хранения данных, принадлежащих пользователям приложений. Это отражается в его характеристиках производительности, API и модели стоимости.
>
> Данные пользователей должны храниться в другом месте, например, в экземпляре базы данных Azure S'L, где имеется прозрачное шифрование данных (TDE) или в учетной записи хранения данных, использующей шифрование службы хранения данных Azure. Секреты, используемые вашим приложением для доступа к этим хранилищам данных, могут храниться в Хранилище ключей Azure.

### <a name="protect-sensitive-data"></a>Защита конфиденциальных данных

Защита данных является неотъемлемой частью вашей стратегии безопасности.
Классификация данных и определение потребностей в защите данных помогают вам разрабатывать приложение с учетом безопасности данных. Классификация (классификация) сохраненных данных по чувствительности и бизнес-воздействию помогает разработчикам определить риски, связанные с данными.

Клеймите все применимые данные как конфиденциальные при проектировании форматов данных. Убедитесь, что приложение рассматривает применимые данные как конфиденциальные. Эти методы могут помочь вам защитить ваши конфиденциальные данные:

- Используйте шифрование.
- Избегайте секретов жесткого кодирования, таких как ключи и пароли.
- Убедитесь в том, что контроль доступа и аудит на месте.

#### <a name="use-encryption"></a>Использование шифрования

Защита данных должна быть неотъемлемой частью вашей стратегии безопасности.
Если ваши данные хранятся в базе данных или если они перемещались между местами, используйте шифрование [данных в состоянии покоя](../fundamentals/encryption-atrest.md) (в то время как в базе данных) и шифрование [данных в пути](../fundamentals/data-encryption-best-practices.md#protect-data-in-transit) (по пути к пользователю и от пользователя, базы данных, API или конечной точки обслуживания). Мы рекомендуем всегда использовать протоколы SSL/TLS для обмена данными. Убедитесь, что вы используете последнюю версию TLS для шифрования (в настоящее время это версия 1.2).

#### <a name="avoid-hard-coding"></a>Избегайте жесткого кодирования

Некоторые вещи никогда не должны быть жестко закодированы в вашем программном обеспечении. Некоторые примеры: имена хостеров или IP-адреса, URL-адреса, адреса электронной почты, имена пользователей, пароли, ключи учетной записи хранилища и другие криптографические ключи. Рассмотрите возможность выполнения требований, связанных с тем, что может или не может быть жестко закодировано в коде, в том числе в разделах комментариев вашего кода.

При покладывании комментариев в код убедитесь, что вы не сохраните никакой конфиденциальной информации. Это включает в себя ваш адрес электронной почты, пароли, строки соединения, информацию о вашем приложении, которая будет известна только кому-то в вашей организации, и все остальное, что может дать злоумышленнику преимущество в атаке на ваше приложение или организацию.

В принципе, предположим, что все в вашем проекте развития будет общественности, когда он развернут. Избегайте включения конфиденциальных данных любого рода в проект.

Ранее мы обсуждали [Azure Key Vault](../../key-vault/general/overview.md). Вы можете использовать Key Vault для хранения секретов, таких как ключи и пароли, а не для жесткого кодирования. При использовании Key Vault в сочетании с управляемыми идентификаторами для ресурсов Azure ваше веб-приложение Azure может легко и безопасно получить доступ к значениям секретной конфигурации без хранения каких-либо секретов в элементе управления исходным кодом или конфигурации. Чтобы узнать больше, смотрите [Управление секретами в приложениях сервера с Azure Key Vault](https://docs.microsoft.com/learn/modules/manage-secrets-with-azure-key-vault/).

### <a name="implement-fail-safe-measures"></a>Осуществление мер по обеспечению безопасности отказов

Приложение должно быть в состоянии обрабатывать [ошибки,](https://docs.microsoft.com/dotnet/standard/exceptions/) которые происходят во время выполнения в последовательной манере. Приложение должно уловить все ошибки и либо выполнить неудачу, либо закрыться.

Вы также должны убедиться, что ошибки регистрируются с достаточным пользовательским контекстом для выявления подозрительных или вредоносных действий. Входы должны быть сохранены в течение достаточного времени, чтобы позволить задержки судебно-медицинской экспертизы. Входы должны быть в формате, который может быть легко потребляется решением управления журналом. Убедитесь, что срабатывают оповещения об ошибках, связанных с безопасностью. Недостаточная вырубка и мониторинг позволяют злоумышленникам в дальнейшем атаковать системы и сохранять стойкость.

### <a name="take-advantage-of-error-and-exception-handling"></a>Воспользуйтесь преимуществами обработки ошибок и исключений

Реализация правильной обработки ошибок и [исключений](https://docs.microsoft.com/dotnet/standard/exceptions/best-practices-for-exceptions) является важной частью оборонительного кодирования. Обработка ошибок и исключений имеет решающее значение для обеспечения надежности и безопасности системы. Ошибки при обработке ошибок могут привести к различным видам уязвимостей в системе безопасности, таким как утечка информации злоумышленникам и помощь злоумышленникам в понимании вашей платформы и дизайна.

Убедитесь в следующем:

- Вы обрабатываете исключения централизованным образом, чтобы избежать дублирования [блоков try/catch](https://docs.microsoft.com/dotnet/standard/exceptions/how-to-use-the-try-catch-block-to-catch-exceptions) в коде.

- Все неожиданные поведения обрабатываются внутри приложения.

- Сообщения, отображаемые пользователям, не пропускают критически важные данные, но предоставляют достаточно информации для объяснения проблемы.

- Исключения регистрируются и что они предоставляют достаточно информации для судебно-медицинской экспертизы или групп реагирования на инциденты для расследования.

[Azure Logic Apps](../../logic-apps/logic-apps-overview.md) предоставляет первоклассный опыт [обработки ошибок и исключений,](../../logic-apps/logic-apps-exception-handling.md) вызванных зависимыми системами. Логические приложения можно использовать для создания рабочих процессов для автоматизации задач и процессов, которые объединяют приложения, данные, системы и службы между предприятиями и организациями.

### <a name="use-logging-and-alerting"></a>Используйте журнал и оповещение

[Зарегистрируйте](https://docs.microsoft.com/aspnet/core/fundamentals/logging/?view=aspnetcore-2.1) свои проблемы безопасности для расследований безопасности и вызвать оповещения о проблемах, чтобы убедиться, что люди знают о проблемах своевременно. Включите аудит и ведение журнала во всех компонентах. Журналы аудита должны захватывать контекст пользователя и идентифицировать все важные события.

Убедитесь, что вы не регистрируете никаких конфиденциальных данных, которые пользователь отправляет на ваш сайт. К конфиденциальным данным относятся:

- Учетные данные пользователя
- Номера социального страхования или другая идентифицирующая информация
- номера кредитных карт и другие финансовые сведения;
- сведения о работоспособности;
- Частные ключи или другие данные, которые могут быть использованы для расшифровки зашифрованной информации
- сведения о системе или приложении, которые можно использовать для более эффективных атак на приложение.

Убедитесь, что приложение отслеживает события управления пользователями, такие как успешные и неудавемые логины пользователей, сброс пароля, изменения пароля, блокировка учетной записи и регистрация пользователей. Регистрация для этих событий помогает обнаруживать и реагировать на потенциально подозрительное поведение. Он также позволяет собирать данные об операциях, например, кто получает доступ к приложению.

## <a name="next-steps"></a>Следующие шаги
В следующих статьях мы рекомендуем элементы управления безопасностью и действия, которые помогут вам разрабатывать и развертывать безопасные приложения.

- [Разработка безопасных приложений](secure-develop.md)
- [Развертывание безопасных приложений](secure-deploy.md)
