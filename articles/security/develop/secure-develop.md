---
title: Разработка безопасных приложений в Microsoft Azure
description: В этой статье рассматриваются рекомендации, которые следует учитывать на этапах реализации и проверки проекта веб-приложений.
author: TerryLanfear
manager: barbkess
ms.author: terrylan
ms.date: 06/12/2019
ms.topic: article
ms.service: security
ms.subservice: security-develop
services: azure
ms.assetid: 521180dc-2cc9-43f1-ae87-2701de7ca6b8
ms.devlang: na
ms.tgt_pltfrm: na
ms.workload: na
ms.openlocfilehash: 9d98660230e0ab9f4edcd9a7af8a3797106dd17a
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "78255662"
---
# <a name="develop-secure-applications-on-azure"></a>Разработка защищенных приложений в Azure
В этой статье мы представляем действия и элементы управления безопасности, чтобы учитывать при разработке приложений для облака. Рассматриваются вопросы безопасности и концепции, которые необходимо учитывать на этапах реализации и проверки [жизненного цикла разработки microsoft Security Development (SDL).](https://msdn.microsoft.com/library/windows/desktop/84aed186-1d75-4366-8e61-8d258746bopq.aspx) Цель состоит в том, чтобы помочь определить действия и службы Azure, которые можно использовать для разработки более безопасного приложения.

Следующие фазы SDL описаны в этой статье:

- Реализация
- Проверка

## <a name="implementation"></a>Реализация
Основное внимание на этапе реализации уделяется разработке наилучшей практики ранней профилактики и выявлению и устранению проблем безопасности из кода.
Предположим, что ваше приложение будет использоваться таким образом, что вы не намеревались его использовать. Это поможет вам защититься от случайного или преднамеренного неправомерного использования вашего приложения.

### <a name="perform-code-reviews"></a>Выполнение отзывов кода

Перед регистрацией кода проведите [проверку кода,](https://docs.microsoft.com/azure/devops/learn/devops-at-microsoft/code-reviews-not-primarily-finding-bugs) чтобы повысить общее качество кода и снизить риск создания ошибок. Для управления процессом проверки кода можно использовать [Visual Studio.](https://docs.microsoft.com/azure/devops/repos/tfvc/get-code-reviewed-vs?view=vsts)

### <a name="perform-static-code-analysis"></a>Выполнение статического анализа кода

[Статический анализ кода](https://www.owasp.org/index.php/Static_Code_Analysis) (также известный как *анализ исходного кода),* как правило, выполняется как часть обзора кода. Статический анализ кода обычно относится к запуску статических инструментов анализа кода для поиска потенциальных уязвимостей в незапущенном коде с помощью таких методов, как [проверка загрязнений](https://en.wikipedia.org/wiki/Taint_checking) и [анализ потока данных.](https://en.wikipedia.org/wiki/Data-flow_analysis)

Azure Marketplace предлагает [инструменты для разработчиков,](https://azuremarketplace.microsoft.com/marketplace/apps/category/developer-tools?page=1&search=code%20review) которые выполняют статический анализ кода и помогают с обзорами кода.

### <a name="validate-and-sanitize-every-input-for-your-application"></a>Проверка и дезинфекция всех входных данных для вашего приложения

Относитесь ко всем входным данным как к недоверию для защиты приложения от наиболее распространенных уязвимостей веб-приложений. Ненадежные данные являются средством для инъекционных атак. Вход для приложения включает параметры URL-адреса, ввод данных от пользователя, данные из базы данных или из API, а также все, что передается в том, что пользователь потенциально может манипулировать. Приложение должно [проверить,](https://www.owasp.org/index.php/OWASP_Proactive_Controls_2016#4:_Validate_All_Inputs) что данные синтаксически и семантически действительны, прежде чем приложение использует данные в любом случае (в том числе отображение его обратно к пользователю).

Проверка ввода на ранних стадиях потока данных, чтобы убедиться, что только правильно сформированные данные попадают в рабочий процесс. Не нужно, чтобы в базе данных сохранявшиеся несколько данных или вызываемые сбои в компоненте ниже по течению.

Черный список и белый список являются двумя общими подходами к выполнению проверки синтаксиса ввода:

  - Черный список пытается проверить, что данный пользовательский вход не содержит "известный как вредоносный" контент.

  - Белый список пытается проверить, соответствует ли данный вход пользователя набору "известных хороших" входов. Белый список на основе символов — это форма белого списка, в которой приложение проверяет, что пользовательский ввод содержит только «известные хорошие» символы или что вход соответствует известному формату.
    Например, это может включать проверку того, что имя пользователя содержит только буквенно-цифровые символы или что оно содержит ровно два числа.

Белый листинг является предпочтительным подходом для создания безопасного программного обеспечения.
Черный список подвержен ошибкам, потому что невозможно придумать полный список потенциально плохих входных веществ.

Делайте эту работу на сервере, а не на стороне клиента (или на сервере и на стороне клиента).

### <a name="verify-your-applications-outputs"></a>Проверка результатов вашего приложения

Любой вывод, который вы представляете либо визуально, либо в документе, всегда должен быть закодирован и избежан. [Избегая](https://www.owasp.org/index.php/Injection_Theory#Escaping_.28aka_Output_Encoding.29), также известный как *кодирование вывода*, используется, чтобы помочь гарантировать, что ненадежные данные не является средством для инъекций атаки. Избежание, в сочетании с проверкой данных, обеспечивает многоуровневую защиту для повышения безопасности системы в целом.

Бегство гарантирует, что все отображается как *выход.* Избежание также позволяет переводчику знать, что данные не предназначены для выполнения, и это предотвращает атаки от работы. Это еще один распространенный метод атаки называется *кросс-сайт скриптов* (XSS).

Если вы используете веб-рамки от третьей стороны, вы можете проверить ваши варианты для вывода кодирования на веб-сайтах с помощью [oWASP XSS предотвращения шпаргалка.](https://github.com/OWASP/CheatSheetSeries/blob/master/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.md)

### <a name="use-parameterized-queries-when-you-contact-the-database"></a>Использование параметризированных запросов при обращении к базе данных

Никогда не создавайте в коде вневешку запроса базы данных "на лету" и отправляйте его непосредственно в базу данных. Вредоносный код, вставленный в приложение, потенциально может привести к краже, уничтожению или изменению базы данных. Ваше приложение также может быть использовано для выполнения вредоносных команд операционной системы в операционной системе, в ней размещается база данных.

Вместо этого используйте параметризированные запросы или сохраненные процедуры. При использовании параметризированных запросов можно безопасно вызвать процедуру из кода и передать ее строке, не беспокоясь о том, что она будет рассматриваться как часть оператора запроса.

### <a name="remove-standard-server-headers"></a>Удалить стандартные заголовки серверов

Заголовки, такие как Server, X-Powered-By и X-AspNet-Version, раскрывают информацию о сервере и базовых технологиях. Мы рекомендуем вам подавить эти заголовки, чтобы избежать снятия отпечатков пальцев приложения.
Смотрите [удаление стандартных заголовков серверов на веб-сайтах Azure.](https://azure.microsoft.com/blog/removing-standard-server-headers-on-windows-azure-web-sites/)

### <a name="segregate-your-production-data"></a>Сегрегируйте производственные данные

Ваши производственные данные, или "реальные" данные, не должны использоваться для разработки, тестирования или любых других целей, чем предполагалось предприятием. Набор данных в маске[(анонимизированный)](https://en.wikipedia.org/wiki/Data_anonymization)должен использоваться для всех разработок и тестирования.

Это означает, что меньшелюдей имеют доступ к реальным данным, что уменьшает вашу поверхность атаки. Это также означает, что меньше сотрудников видят персональные данные, что исключает потенциальное нарушение конфиденциальности.

### <a name="implement-a-strong-password-policy"></a>Внедрение сильной политики паролей

Чтобы защититься от грубую силу и словарное угадывание, необходимо реализовать строгую политику паролей, чтобы гарантировать, что пользователи создают сложный пароль (например, 12 символов минимальной длины и требующих алфавитных и специальных символов).

Для создания и принудительного исполнения политик и обеспечения соблюдения политики паролей можно использовать платформу идентификационных данных. Azure AD B2C помогает вам с управлением паролями, предоставляя [встроенные политики,](../../active-directory-b2c/tutorial-create-user-flows.md#create-a-password-reset-user-flow) [сброс паролей самообслуживания](../../active-directory-b2c/user-flow-self-service-password-reset.md)и многое другое.

Чтобы защититься от атак на учетные записи по умолчанию, убедитесь, что все ключи и пароли заменяются и что они генерируются или заменяются после установки ресурсов.

Если приложение должно автоматически генерировать пароли, убедитесь, что генерируемые пароли являются случайными и что они имеют высокую энтропию.

### <a name="validate-file-uploads"></a>Проверка загрузки файлов

Если ваше приложение позволяет [загрузить файл,](https://www.owasp.org/index.php/Unrestricted_File_Upload)рассмотрите меры предосторожности, которые вы можете принять для этой рискованной деятельности. Первым шагом во многих атаках является получение вредоносного кода в систему, которая находится под атакой. Использование загрузки файлов помогает злоумышленнику достичь этого. OWASP предлагает решения для проверки файла, чтобы убедиться, что файл, который вы загружаете, является безопасным.

Защита от вредоносного ПО помогает выявлять и удалять вирусы, программы-шпионы и другие вредоносные программы. Вы можете установить [Microsoft Antimalware](../fundamentals/antimalware.md) или решение защиты конечных точек партнера Майкрософт[(Trend Micro,](https://www.trendmicro.com/azure/) [Broadcom,](https://www.broadcom.com/products) [McAfee,](https://www.mcafee.com/us/products.aspx) [Windows Defender](https://docs.microsoft.com/windows/security/threat-protection/windows-defender-antivirus/windows-defender-antivirus-in-windows-10)и [Endpoint Protection).](https://docs.microsoft.com/configmgr/protect/deploy-use/endpoint-protection)

[Microsoft Antimalware](../fundamentals/antimalware.md) включает в себя такие функции, как защита в режиме реального времени, плановое сканирование, исправление вредоносных программ, обновления подписей, обновления движка, отчеты о образцах и сбор событий исключений. Для упрощения развертывания и использования встроенных обнаружений (оповещений и инцидентов) антивредоносное ПО Майкрософт и партнерские решения можно интегрировать с [центром безопасности Azure](../../security-center/security-center-partner-integration.md).

### <a name="dont-cache-sensitive-content"></a>Не кэшировать конфиденциальное содержимое

Не кэшировать конфиденциальное содержимое в браузере. Браузеры могут хранить информацию для кэширования и истории. Кэшированные файлы хранятся в папке, как временные папки Интернет-файлов, в случае Internet Explorer. Когда эти страницы упоминаются снова, браузер отображает страницы из своего кэша. Если конфиденциальная информация (адрес, данные кредитной карты, номер социального страхования, имя пользователя) отображается пользователю, эта информация может храниться в кэше браузера и быть извлеченной, изучая кэш браузера или просто нажав кнопку **"Назад"** браузера.

## <a name="verification"></a>Проверка
Этап проверки включает в себя всеобъемлющие усилия по обеспечению того, чтобы код соответствовал принципам безопасности и конфиденциальности, которые были установлены на предыдущих этапах.

### <a name="find-and-fix-vulnerabilities-in-your-application-dependencies"></a>Поиск и исправление уязвимостей в зависимостях приложений

Вы сканируете приложение и его зависимые библиотеки для идентификации любых известных уязвимых компонентов. Продукты, доступные для выполнения этого сканирования включают [OWASP Проверка зависимости](https://www.owasp.org/index.php/OWASP_Dependency_Check),[Сник](https://snyk.io/), и [Черная утка](https://www.blackducksoftware.com/).

Сканирование уязвимостей на основе [Tinfoil Security](https://www.tinfoilsecurity.com/) доступно для web-приложений службы приложений Azure. [Сканирование Tinfoil Security через App Service](https://azure.microsoft.com/blog/web-vulnerability-scanning-for-azure-app-service-powered-by-tinfoil-security/) предлагает разработчикам и администраторам быстрые, интегрированные и экономичные средства обнаружения и устранения уязвимостей до того, как злоумышленник сможет воспользоваться ими.

> [!NOTE]
> Вы также можете [интегрировать Tinfoil Security с Azure AD.](../../active-directory/saas-apps/tinfoil-security-tutorial.md) Интеграция Tinfoil Security с Azure AD предоставляет вам следующие преимущества:
>  - В Azure AD вы можете управлять доступом к безопасности Tinfoil.
>  - Ваши пользователи могут автоматически войти в Tinfoil Security (один очный знак) с помощью своих учетных записей Azure AD.
>  - Управлять учетными записями можно в одном центральном месте, портале Azure.

### <a name="test-your-application-in-an-operating-state"></a>Проверьте приложение в рабочем состоянии

Динамическое тестирование безопасности приложений (DAST) — это процесс тестирования приложения в рабочем состоянии для поиска уязвимостей безопасности. Инструменты DAST анализируют программы во время их выполнения, чтобы найти уязвимости безопасности, такие как порочание памяти, небезопасная конфигурация сервера, кросс-сайт скриптов, проблемы с привилегиями пользователей, инъекции S'L и другие критические проблемы безопасности.

DAST отличается от статического тестирования безопасности приложений (SAST). Инструменты SAST анализируют исходный код или компилированные версии кода, когда код не исполняется, чтобы найти недостатки безопасности.

Выполните DAST, предпочтительно с помощью специалиста по безопасности [(тестера проникновения](../fundamentals/pen-testing.md) или оценщика уязвимости). Если специалист по безопасности недоступен, вы можете выполнить DAST самостоятельно с помощью веб-сканера и некоторого обучения. Подключите сканер DAST на ранней стадии, чтобы убедиться, что вы не введете очевидные проблемы безопасности в свой код. Список сканеров уязвимостей веб-приложений можно осмотреть на сайте [OWASP.](https://www.owasp.org/index.php/Category:Vulnerability_Scanning_Tools)

### <a name="perform-fuzz-testing"></a>Выполните тестирование пуха

При [тестировании пуха](https://cloudblogs.microsoft.com/microsoftsecure/2007/09/20/fuzz-testing-at-microsoft-and-the-triage-process/)вы вызываете сбой программы, намеренно вводя в приложение недополученные или случайные данные. Сбой программы помогает выявить потенциальные проблемы безопасности до выпуска приложения.

[Обнаружение рисков безопасности](https://docs.microsoft.com/security-risk-detection/) — это уникальная служба тестирования пуха корпорации Майкрософт для поиска критически важных ошибок в программном обеспечении.

### <a name="conduct-attack-surface-review"></a>Проведение обзора поверхности атаки

Проверка поверхности атаки после завершения кода помогает обеспечить рассмотрение любых изменений в приложении или системе. Это помогает гарантировать, что любые новые векторы атак, созданные в результате изменений, включая модели угроз, были рассмотрены и смягчены.

Можно создать изображение поверхности атаки, сканируя приложение. Корпорация Майкрософт предлагает инструмент анализа поверхности атаки под названием [Attack Surface Analyzer.](https://www.microsoft.com/download/details.aspx?id=24487) Вы можете выбрать один из многих коммерческих динамических инструментов и сканирования уязвимости инструментов или услуг, в том числе [OWASP Зед атаки прокси проекта](https://www.owasp.org/index.php/OWASP_Zed_Attack_Proxy_Project), [Arachni](http://arachni-scanner.com/), [Skipfish](https://code.google.com/p/skipfish/), и [w3af](http://w3af.sourceforge.net/). Эти инструменты сканирования сканируют ваше приложение и наносят на карту части приложения, доступные через Интернет. Вы также можете искать в Azure Marketplace аналогичные [инструменты разработчика.](https://azuremarketplace.microsoft.com/marketplace/apps/category/developer-tools?page=1)

### <a name="perform-security-penetration-testing"></a>Выполните тестирование на проникновение в систему безопасности

Обеспечение безопасности приложения так же важно, как и тестирование любой другой функциональности. Сделайте [тестирование на проникновение](../fundamentals/pen-testing.md) стандартной частью процесса сборки и развертывания. Расписание регулярных тестов безопасности и сканирование уязвимостей на развернутых приложениях и мониторинг открытых портов, конечных точек и атак.

### <a name="run-security-verification-tests"></a>Выполнить тесты проверки безопасности

[Безопасный комплект DevOps для Azure](https://azsk.azurewebsites.net/index.html) (AzSK) содержит SVT для нескольких служб платформы Azure. Вы периодически запускаете эти SVT, чтобы убедиться, что подписка Azure и различные ресурсы, составляющие ваше приложение, находятся в безопасном состоянии. Вы также можете автоматизировать эти тесты, используя функцию расширения непрерывной интеграции/непрерывного развертывания (CI/CD) AzSK, которая делает SVTs доступными в качестве расширения Visual Studio.

## <a name="next-steps"></a>Дальнейшие действия
В следующих статьях мы рекомендуем элементы управления безопасностью и действия, которые помогут вам разработать и развернуть безопасные приложения.

- [Разработка безопасных приложений](secure-design.md)
- [Развертывание безопасных приложений](secure-deploy.md)
