---
title: Microsoft Azure вопросы о документации по анализу кода безопасности
description: Эта статья содержит ответы на часто задаваемые вопросы о расширении анализа кода безопасности
author: vharindra
manager: sukhans
ms.author: terrylan
ms.date: 07/31/2019
ms.topic: article
ms.service: security
services: azure
ms.assetid: 521180dc-2cc9-43f1-ae87-2701de7ca6b8
ms.devlang: na
ms.tgt_pltfrm: na
ms.workload: na
ms.openlocfilehash: 8038b7bd60ac771c798a1a8645022b0bf9e142a9
ms.sourcegitcommit: 13a289ba57cfae728831e6d38b7f82dae165e59d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/09/2019
ms.locfileid: "68934844"
---
# <a name="frequently-asked-questions"></a>Часто задаваемые вопросы
Есть вопросы? Дополнительные сведения см. в часто задаваемых вопросах.

## <a name="general-faqs"></a>Общие вопросы и ответы

### <a name="can-i-install-the-extension-on-my-tfs-not-azure-devops-server"></a>Можно ли установить расширение на сервере TFS (не Azure DevOps)? 

Нет, расширение недоступно для скачивания и установки для TFS.

### <a name="do-i-have-to-run-microsoft-security-code-analysis-with-my-build"></a>Нужно ли запускать анализ кода безопасности Майкрософт со своей сборкой? 

Да и нет. В зависимости от типа средства анализа исходный код может быть единственным требуемым, а также может потребоваться вывод сборки. Например, так как средство проверки учетных данных анализирует файлы в структуре папок репозитория кода, можно запустить средство проверки учетных данных и опубликовать журналы анализа безопасности задачи сборки в автономной сборке для получения результатов.
Для других средств, которые анализируют артефакты сборки POST, например Бинским, сначала потребуется сборка.

### <a name="can-i-break-my-build-when-results-are-found"></a>Можно ли разбивать сборку при обнаружении результатов? 
Да, можно ввести разрыв сборки, когда любое средство сообщает о возникшей ошибке в файле журнала. Просто добавьте задачу построения после анализа и установите флажок для любого инструмента, для которого требуется прервать сборку. Можно выбрать прервать сборку, когда любое средство сообщит об ошибках, или предупреждениях и ошибках в пользовательском интерфейсе задачи, выполняемой после анализа.

### <a name="how-are-the-command-line-arguments-different-in-azure-devops-than-they-are-in-the-standalone-desktop-tools"></a>Чем отличаются аргументы командной строки в Azure DevOps, чем они находятся в средствах изолированного рабочего стола? 

В большинстве случаев задачи сборки Azure DevOps являются прямыми оболочками вокруг аргументов командной строки средств безопасности. Все, что обычно передается средству из командной строки с рабочего стола, можно передать в входные аргументы задачи сборки.
Ниже приведен список заметных отличий.
 - Средство будет выполняться из исходной папки агента $ (Build. SourcesDirectory) или% BUILD_SOURCESDIRECTORY%. Пример К:\ажент\_work\1\s 
 - Пути в аргументах могут относиться к корневому каталогу исходного каталога, указанному выше или абсолютно, путем запуска локального агента с известными расположениями развертывания локальных ресурсов или с помощью переменных сборки Azure DevOps.
 - Средства автоматически предоставляют путь к выходному файлу или папке, если указан путь к выходному файлу, он будет удален и заменен на путь к известному расположению журналов на агенте сборки.
 - Некоторые дополнительные параметры командной строки будут исключены и удалены в некоторых средствах, таких как добавление или удаление параметров, чтобы убедиться, что графический интерфейс не запускается.

### <a name="can-i-run-a-build-task-for-example-credential-scanner-across-multiple-repositories-in-an-azure-devops-build"></a>Можно ли запустить задачу сборки (например, средство проверки учетных данных) в нескольких репозиториях в сборке Azure DevOps? 

Нет, в настоящее время запуск безопасных средств разработки для нескольких репозиториев в одном конвейере не поддерживается.

###  <a name="the-output-file-i-specified-is-not-being-created--i-cant-find-the-output-file-i-specified"></a>Указанный выходной файл не создается, или не удается найти указанный выходной файл 

В настоящее время задачи сборки проводят очистку введенных пользователем данных и обновляют расположение выходного файла, созданного в общем расположении на агенте сборки. Дополнительные сведения об этом расположении см. на следующих вопросах.

### <a name="where-are-the-output-files-generated-by-the-tools-saved"></a>Где сохраняются выходные файлы, созданные инструментами? 

Задачи сборки автоматически добавляют выходные пути в следующее известное расположение на агенте сборки $ (Agent. BuildDirectory)\_сдт\логс. Благодаря стандартизации в этом расположении мы можем гарантировать, что другие группы, создающие журналы анализа кода или использующие их, будут иметь доступ к.

### <a name="can-i-queue-a-build-to-run-these-tasks-on-a-hosted-build-agent"></a>Можно ли поместить сборку в очередь для выполнения этих задач на размещенном агенте сборки? 

Да, все задачи и инструменты в расширении могут выполняться на размещенном агенте сборки.

>[!NOTE]
> Задача сборки защиты от вредоносных программ требует наличия агента сборки с включенным защитником Windows, что справедливо для агентов сборки "Hosted VS2017" или более поздней версии. (Он не будет выполняться в устаревшем или VS2015ом агенте.) Подписи не могут быть обновлены на этих агентах, но подпись всегда должна быть относительно актуальной, менее 3 часов назад.
>

### <a name="can-i-run-these-build-tasks-as-part-of-a-release-pipeline-as-opposed-to-a-build-pipeline"></a>Можно ли выполнять эти задачи сборки в рамках конвейера выпуска (в отличие от конвейера сборки)? 
В большинстве случаев да. Однако задачи, которые публикуют артефакты, не поддерживаются Azure DevOps в конвейерах выпуска: "Единственной категорией задач, которые не должны работать с выпуском, являются те, которые публикуют артефакты. Это связано с тем, что сейчас у нас нет поддержки публикации артефактов в выпуске.
Это предотвращает успешное выполнение задачи "Публикация журналов анализа безопасности" из конвейера выпуска. он завершится ошибкой с описательным сообщением об ошибке.

### <a name="from-where-do-the-build-tasks-download-the-tools"></a>Откуда задачи сборки загружают средства? 
Задачи сборки a) Скачайте пакеты NuGet для средств из следующего [веб-канала Управление пакетами Azure DevOps](https://securitytools.pkgs.visualstudio.com/_packaging/SecureDevelopmentTools/nuget/v3/index.json) или с помощью диспетчера пакетов узлов, который необходимо предварительно установить на агенте сборки (например, NPM Install tslint).

### <a name="what-effect-will-installing-the-extension-have-on-my-azure-devops-organization"></a>Какие действия будут устанавливать расширение в моей организации Azure DevOps? 

После установки задачи сборки безопасности, предоставляемые расширением, станут доступными для использования всеми пользователями в Организации. При создании или изменении конвейера Azure эти задачи будут доступны для добавления из списка коллекции задач сборки. В противном случае установка расширения в Организации Azure DevOps не повлияет на работу. Он не изменяет ни учетную запись, ни параметры проекта или конвейеры.

### <a name="will-installing-the-extension-modify-my-existing-azure-pipelines"></a>Будет ли установка расширения изменить существующую Azure Pipelines? 

Нет. Установка расширения сделает задачи сборки безопасности доступными для добавления в Azure Pipelines. Пользователям по-прежнему требуется добавлять или обновлять определения сборок для интеграции средств в процесс сборки.

## <a name="task-specific-faqs"></a>Вопросы и ответы по конкретным задачам

В этом разделе перечислены вопросы и ответы, относящиеся к задачам сборки.

### <a name="credential-scanner-faqs"></a>Вопросы и ответы по сканерам

#### <a name="what-are-common-suppressions-scenarios-and-examples"></a>Что такое распространенные сценарии подавления и примеры? 
Ниже приведены два наиболее распространенных сценария подавления.
##### <a name="suppress-all-occurrences-of-a-given-secret-within-the-specified-path"></a>Подавляет все вхождения заданного секрета в указанный путь 
Требуется хэш-ключ секрета из выходного файла средства проверки учетных данных, как показано в примере ниже.
   
        {
            "tool": "Credential Scanner",
            "suppressions": [
            {
                "hash": "CLgYxl2FcQE8XZgha9/UbKLTkJkUh3Vakkxh2CAdhtY=",
                "_justification": "Secret used by MSDN sample, it is fake."
            }
          ]
        }

>[!WARNING]
> Хэш-ключ создается частью соответствующего значения или содержимого файла. Любая редакция исходного кода может изменить ключ хэша и отключить правило подавления. 

##### <a name="to-suppress-all-secrets-in-a-specified-file-or-to-suppress-the-secrets-file-itself"></a>Отключение всех секретов в указанном файле (или отключение самого файла секретов) 
Выражением файла может быть имя файла или любая постфиксная часть полного пути к файлу или имени. Подстановочные знаки не поддерживаются. 

**Пример** 

Файл для подавления: [InputPath] \Срк\жс\либ\ангулар.ЖС 

Допустимые правила подавления: 
- [InputPath] \Срк\жс\либ\ангулар.ЖС--подавляет файл по указанному пути
- \срк\жс\либ\ангулар.жс
- \жс\либ\ангулар.жс
- \либ\ангулар.жс
- угловой. js — отключение любого файла с тем же именем

        {
            "tool": "Credential Scanner",
            "suppressions": [
            {
                "file": "\\files\\AdditonalSearcher.xml", 
                "_justification": "Additional CredScan searcher specific to my team"
            },
            {
                "file": "\\files\\unittest.pfx", 
                "_justification": "Legitimate UT certificate file with private key"
            }
          ]
        }      

>[!WARNING] 
> Все будущие секреты, добавленные в файл, также будут подавляться автоматически. 

#### <a name="what-are-recommended-secrets-management-guidelines"></a>Каковы рекомендуемые рекомендации по управлению секретами? 
При своевременном обнаружении жестко закодированных секретов и снижении рисков полезно использовать их еще лучше, если бы одна из них не могла полностью предотвратить возврат секретов. В этом отношении Корпорация Майкрософт выпустила анализатор кода Кредскан в составе [расширения Microsoft DevLabs](https://marketplace.visualstudio.com/items?itemName=VSIDEDevOpsMSFT.ContinuousDeliveryToolsforVisualStudio) для Visual Studio. В предварительной версии она предоставляет разработчикам встроенный интерфейс для обнаружения потенциальных секретов в своем коде, давая им возможность исправить эти проблемы в режиме реального времени. Дополнительные сведения см. в [этом](https://devblogs.microsoft.com/visualstudio/managing-secrets-securely-in-the-cloud/) блоге по безопасному управлению секретами в облаке. Ниже приведены некоторые дополнительные ресурсы, помогающие безопасно управлять секретами и получать доступ к конфиденциальным сведениям из приложений. 
 - [Хранилище ключей Azure](../../key-vault/index.yml)
 - [Azure Active Directory](../../sql-database/sql-database-aad-authentication.md)
 - [Управляемое удостоверение службы Azure AD](https://azure.microsoft.com/blog/keep-credentials-out-of-code-introducing-azure-ad-managed-service-identity/)
 - [Управляемое удостоверение службы (MSI) для ресурсов Azure](../../active-directory/managed-identities-azure-resources/overview.md)
 - [Управляемое удостоверение службы Azure](../../app-service/overview-managed-identity.md)
 - [Библиотека AppAuthentication](../../key-vault/service-to-service-authentication.md)

#### <a name="can-i-write-my-own-custom-searchers"></a>Можно ли написать собственные пользовательские поисковые заноски?

Сканер учетных данных использует набор поисков содержимого, обычно определяемый в файле **буилдсеарчерс. XML** . Файл содержит массив сериализованных объектов XML, представляющих объект Контентсеарчер. Эта программа распространяется с помощью проверенного набора поисков, но он также позволяет реализовать собственные пользовательские средства поиска. 

Поиск содержимого определяется следующим образом: 

- **Имя** — описательное имя поиска, которое будет использоваться в выходном файле средства проверки учетных данных. Рекомендуется использовать соглашение об именовании символов в Camel для имен поисков. 
- **RuleId** — стабильный непрозрачный идентификатор поиска. 
    - Средства поиска учетных данных по умолчанию назначаются с помощью Рулеидс, таких как CSCAN0010, CSCAN0020, CSCAN0030 и т. д. Последняя цифра зарезервирована для возможного слияния групп регулярных выражений поиска или деления.
    - RuleId для настроенных поисков должны иметь собственное пространство имен в формате: КСКАН-{Namespace} 0010, КСКАН-{пространство_имен} 0020, КСКАН-{Namespace} 0030 и т. д.
    - Полное имя службы поиска — это сочетание RuleId и имени для поиска. Пример CSCAN0010. Кэйсторефилес, CSCAN0020. Base64EncodedCertificate и т. д.
- **Ресаурцематчпаттерн** — регулярное выражение расширений файлов для проверки у поиска
- **Контентсеарчпаттернс** — массив строк, содержащий операторы Regex для сопоставления. Если шаблоны поиска не определены, будут возвращены все файлы, соответствующие шаблону совпадения ресурсов.
- **Контентсеарчфилтерс** — массив строк, содержащий операторы Regex для фильтрации ложных положительных результатов поиска.
- **Матчдетаилс** — это описательное сообщение и (или) инструкции по устранению, которые добавляются для каждого соответствия поиска.
- **Рекомендация** — предоставляет содержимое поля вариантов для сопоставления с помощью быстрого формата отчета.
- **Серьезность** — целое число, отражающее серьезность проблемы (самое высокое = 1).
![Настройка средства проверки учетных данных](./media/security-tools/6-credscan-customsearchers.png)

### <a name="roslyn-analyzers-faqs"></a>Вопросы и ответы по Roslyn Analyzer

#### <a name="what-are-the-most-common-errors-when-using-the-roslyn-analyzers-task"></a>Каковы наиболее распространенные ошибки при использовании задачи «анализаторы Roslyn»?

**Ошибка. Проект был восстановлен с помощью Microsoft. NETCore. app версии x. x. x, но с текущими параметрами вместо него будет использоваться версия y. y. y. Чтобы устранить эту проблему, убедитесь, что для восстановления используются те же параметры и для последующих операций, таких как сборка или публикация. Обычно эта проблема может возникать, если свойство Рунтимеидентифиер задано во время сборки или публикации, но не во время восстановления:**

Анализаторы Roslyn выполняются как часть компиляции, поэтому исходное дерево на компьютере сборки должно находиться в состоянии, которое можно построить. Шаг (возможно, "DotNet. exe Publish") между основной сборкой и анализаторами Roslyn может поместить исходное дерево в невозможное для сборки состояние. Возможно, дублирование шага, который выполняет восстановление NuGet, непосредственно перед шагом Roslyn Analyzers, переместит дерево исходного кода в состояние построения.

**"CSC. exe" завершил работу с кодом ошибки 1 — экземпляр анализатора AAAA не может быть создан из К:\бббб.длл: Не удалось загрузить файл или сборку "Microsoft. CodeAnalysis, Version = X. X. X. X, Culture = Neutral, PublicKeyToken = 31bf3856ad364e35" или одну из его зависимостей. Системе не удается найти указанный файл.**

Убедитесь, что компилятор поддерживает анализаторы Roslyn. "CSC. exe/Version" должен сообщить как минимум v 2.6. x. В некоторых случаях отдельные файлы CSPROJ могут переопределять установку Visual Studio на компьютере сборки, ссылаясь на пакет из Microsoft.Net. compilers. При непреднамеренном использовании конкретной версии компилятора удалите ссылки на Microsoft.Net. compilers. В противном случае убедитесь, что указанный пакет также имеет по крайней мере v 2.6. x. Попытайтесь получить журнал ошибок, который можно найти в параметре/еррорлог: из командной строки CSC. exe (находится в журнале задачи сборки Roslyn). Он может выглядеть примерно так:/еррорлог: ф:\тс-сервицес-123\_work\456\s\Some\Project\Code\Code.csproj.Sarif

**C# Компилятор не является достаточно последним (он должен быть > = 2,6)**

Последние версии C# компилятора выпускают здесь: https://www.nuget.org/packages/Microsoft.Net.Compilers. Чтобы получить установленную версию, вы используете команду `C:\>csc.exe /version` запустить из командной строки. Убедитесь, что у вас нет ссылки на пакет NuGet Microsoft.Net. compilers, который < v 2.6.

**Не найдены журналы MSBuild/Всбуилд**

Из-за того, как задача работает, этой задаче необходимо запросить Azure DevOps для журнала MSBuild из задачи сборки MSBuild. Если эта задача выполняется сразу после задачи сборки MSBuild, журнал еще не будет доступен; Разместите другие задачи сборки, включая задачи сборки Секдевтулс, такие как Бинским, проверка наличия вредоносных программ и другие), между задачей сборки MSBuild и задачей сборки Roslyn Analyzers. 

## <a name="next-steps"></a>Следующие шаги

Если вам нужна дополнительная помощь, то поддержка анализа кода безопасности Microsoft доступна с понедельника по пятницу с 9:00 AM 5:00 по тихоокеанскому времени

  - Подключение. чтобы приступить к работе, обратитесь к менеджерам по техническим учетным записям. 
  >[!NOTE] 
  >Если у вас еще нет платной связи с корпорацией Майкрософт или у вас есть предложение поддержки, которое не позволяет покупать службы из каталога Phoenix, дополнительные сведения см. на [домашней странице службы поддержки](https://www.microsoft.com/enterprise/services/support) .

  - Поддержка. Электронная почта наша группа в [поддержке анализа кода безопасности Майкрософт](mailto:mscahelp@microsoft.com?Subject=Microsoft%20Security%20Code%20Analysis%20Support%20Request)