---
title: Шифрование неактивных данных в Microsoft Azure | Документация Майкрософт
description: В этой статье описывается шифрование неактивных данных в Microsoft Azure, общие возможности и рекомендации.
services: security
documentationcenter: na
author: msmbaldwin
manager: barbkess
editor: TomSh
ms.assetid: 9dcb190e-e534-4787-bf82-8ce73bf47dba
ms.service: security
ms.subservice: security-fundamentals
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 04/07/2020
ms.author: mbaldwin
ms.openlocfilehash: dd54c8f7e8a3784672f5364efc6f6b51186f911d
ms.sourcegitcommit: 3543d3b4f6c6f496d22ea5f97d8cd2700ac9a481
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/20/2020
ms.locfileid: "86529290"
---
# <a name="azure-data-encryption-at-rest"></a>Шифрование неактивных данных в Azure

Microsoft Azure включает средства для защиты данных в соответствии с потребностями Организации в обеспечении безопасности и соответствия требованиям. В этой статье основное внимание уделяется следующим вопросам:

- защита неактивных данных в Microsoft Azure;
- описание различных компонентов, обеспечивающих защиту данных;
- анализ преимуществ и недостатков основных подходов к защите управления.

Шифрование неактивных данных — общее требование безопасности. В Azure организации могут зашифровать неактивные данные без пользовательских решений для управления ключами, которые создают дополнительный риск и затраты. Организации могут предоставить Azure полный контроль над шифрованием неактивных данных. Кроме того, им доступны различные параметры точного управления шифрованием или ключами шифрования.

## <a name="what-is-encryption-at-rest"></a>Что такое шифрование неактивных данных?

Шифрование неактивных данных — это кодирование (шифрование) данных при хранении. Схемы шифрования неактивных данных в Azure используют симметричное шифрование для быстрого шифрования и расшифровки больших объемов данных на основе простой концептуальной модели:

- Симметричный ключ шифрования используется для шифрования данных во время их записи в хранилище.
- Этот же ключ используется для расшифровки данных при подготовке к использованию в памяти.
- Данные могут быть секционированы, а для каждой секции могут использоваться разные ключи.
- Ключи должны храниться в безопасном месте с применением доступа на основе удостоверений и политик аудита. Ключи шифрования данных часто шифруются с помощью ключа шифрования ключа в Azure Key Vault для дальнейшего ограничения доступа.

На практике основные сценарии управления и регулирования, а также гарантии масштабирования и доступности требуют дополнительных конструкций. Ниже приведены основные понятия и компоненты шифрования неактивных данных в Microsoft Azure.

## <a name="the-purpose-of-encryption-at-rest"></a>Цель шифрования неактивных данных

Шифрование при хранении обеспечивает защиту хранимых данных (неактивные данные). Атаки, направленные на такие данные, включают попытки получить физический доступ к оборудованию, на котором хранятся данные, с последующей компрометацией этих данных. При такой атаке жесткий диск сервера может быть необработан в ходе обслуживания, что позволяет злоумышленнику удалить жесткий диск. Позже злоумышленник может поместить жесткий диск в компьютер, находящийся под его контролем, чтобы попытаться получить доступ к данным.

Шифрование неактивных данных предназначено для предотвращения доступа злоумышленника к незашифрованным данным за счет шифрования данных на диске. Если злоумышленник получит жесткий диск с зашифрованными данными, но не ключи шифрования, злоумышленнику придется взломать шифр для получения доступа к данным. Такая атака намного сложнее и требует больше ресурсов, чем доступ к незашифрованным данным на жестком диске. По этой причине мы настоятельно рекомендуем использовать шифрование неактивных данных, которое имеет приоритетное значение для многих организаций.

Шифрование неактивных данных также может потребоваться в Организации, необходимой для управления данными и обеспечения соответствия требованиям. В отраслевых и государственных нормативах, например HIPAA, PCI и FedRAMP, описываются меры по обеспечению безопасности на основе требований к шифрованию и защите данных. Шифрование при хранении является обязательной мерой, необходимой для соблюдения некоторых из этих нормативов. Дополнительные сведения о подходе корпорации Майкрософт к проверке FIPS 140-2 см. в статье [Федеральный стандарт обработки информации (FIPS) 140-2](https://docs.microsoft.com/microsoft-365/compliance/offering-fips-140-2). 

Шифрование неактивных данных не только позволяет выполнить нормативные требования и требования соответствия, но и предоставляет расширенную защиту для платформы. Microsoft Azure предоставляет соответствующую стандартам платформу для служб, приложений и данных. Также предоставляется поддержка на уровне оборудования для физической защиты, управления доступом к данным и аудита. Однако важно предоставить дополнительные "перекрывающиеся" меры безопасности в случае сбоя одного из других мер безопасности, и шифрование неактивных данных обеспечивает такую меру безопасности.

Корпорация Майкрософт намерена обеспечить шифрование неактивных для всех облачных служб, а также предоставить клиентам возможность управлять ключами шифрования и журналами их использования. Кроме того, корпорация Майкрософт активно работает над тем, чтобы такое шифрование применялось по умолчанию для всех неактивных данных пользователей.

## <a name="azure-encryption-at-rest-components"></a>Компоненты шифрования неактивных данных в Azure

Как было описано выше, цель шифрования неактивных данных — выполнить шифрование данных, хранящихся на диске, с помощью секретного ключа шифрования. Для достижения этой цели необходимы безопасное создание ключей, хранилище, управление доступом и ключами шифрования. Хотя некоторые моменты могут отличаться, реализацию шифрования неактивных данных можно описать с помощью понятий, проиллюстрированных на соответствующей схеме.

![Компоненты](./media/encryption-atrest/azure-security-encryption-atrest-fig1.png)

### <a name="azure-key-vault"></a>Azure Key Vault

Место хранения ключей шифрования и управление доступом к этим ключам имеет принципиально важное значение в отношении модели шифрования неактивных данных. Ключи должны быть надежно защищены. При этом определенные службы должны иметь к ним доступны, и они должны быть доступны для управления определенными пользователями. Для служб Azure рекомендуемым решением хранилища ключей является хранилище Azure Key Vault, предоставляющее общие возможности управления в службах. Для хранения ключей и управления ими используются хранилища ключей, доступ к которым можно предоставить пользователям или службам. Azure Key Vault поддерживает создание пользователем ключей или импорт пользовательских ключей для использования в сценариях ключей шифрования, управляемых пользователем.

### <a name="azure-active-directory"></a>Azure Active Directory

Учетным записям Azure Active Directory можно предоставить разрешения на использование ключей, хранящихся в Azure Key Vault, управление ими или доступ к ним в целях шифрования неактивных данных и расшифровки.

### <a name="key-hierarchy"></a>Иерархия ключей

При реализации шифрования неактивных данных используется несколько ключей шифрования. Хранение ключа шифрования в Azure Key Vault обеспечивает безопасный доступ к ключам и централизованное управление ключами. Однако локальный доступ к ключам шифрования служб более эффективен для шифрования и расшифровки, чем взаимодействие с Key Vault для каждой операции с данными, что обеспечивает более надежное шифрование и лучшую производительность. Ограничение использования ключа шифрования снижает риск его компрометации, а также затраты на повторное шифрование при необходимости замены ключа. Модели шифрования Azure в моделях неактивных данных используют иерархию ключей, состоящие из следующих типов ключей, чтобы удовлетворить все эти потребности.

- **Ключ шифрования данных (DEK)**  — симметричный ключ AES256 для шифрования раздела или блока данных.  Один ресурс может включать много секций и много ключей шифрования данных. Шифрование каждого блока данных другим ключом создает дополнительные сложности для выполнения атак в отношении зашифрованных данных. Доступ к DEK требуется поставщику ресурсов или экземпляру приложения, выполняющему шифрование или расшифровку определенного блока. Когда DEK заменяется новым ключом, повторного шифрования этим ключом требуют только данные в его связанном блоке.
- Ключ **шифрования ключа (KEK)** — ключ шифрования, используемый для шифрования ключей шифрования данных. Использование ключа шифрования ключа, который никогда не покидает Key Vault, позволяет шифровать и контролировать ключи шифрования данных. Сущность, у которой есть доступ к KEK, может быть отличной от сущности, требующей DEK. Сущность выступает в качестве брокера при доступе к DEK, чтобы ограничить доступ каждого DEK для определенной секции. Так как KEK требуется для расшифровки ключей DEK, его можно фактически рассматривать как единую точку, с помощью которой можно удалить ключи DEK (непосредственно удалив KEK).

Ключи шифрования данных, зашифрованные с помощью ключей шифрования ключей, хранятся отдельно, и только сущность с доступом к ключу шифрования ключей может расшифровывать эти ключи шифрования данных. Поддерживаются различные модели хранилища ключей. Мы рассмотрим каждую модель более подробно в разделе ниже.

## <a name="data-encryption-models"></a>Модели шифрования данных

Знакомство с различными моделями шифрования, их преимуществами и недостатками необходимо для понимания реализации шифрования неактивных данных в Azure различными поставщиками ресурсов. Эти определения являются общими для всех поставщиков ресурсов в Azure для обеспечения общей среды и таксономии.

Существует три сценария для шифрования на стороне сервера:

- Шифрование на стороне сервера с помощью управляемых службой ключей
  - поставщики ресурсов Azure выполняют операции шифрования и расшифровки;
  - ключами управляет Майкрософт;
  - все возможности облака.

- Шифрование на стороне сервера с помощью управляемых пользователем ключей в Azure Key Vault:
  - поставщики ресурсов Azure выполняют операции шифрования и расшифровки;
  - пользователь управляет ключами через Azure Key Vault;
  - все возможности облака.

- Шифрование на стороне сервера с использованием администрируемых пользователем ключей на управляемом пользователем оборудовании:
  - поставщики ресурсов Azure выполняют операции шифрования и расшифровки;
  - пользователь администрирует ключи на управляемом оборудовании;
  - все возможности облака.

Для шифрования на стороне клиента учтите следующее:

- расшифрованные данные недоступны службам Azure;
- управление ключами и их хранение доступно в локальной среде или других безопасных хранилищах. Ключи недоступны для служб Azure
- возможности облака ограничены.

Поддерживаемые модели шифрования в Azure делятся на две основные группы: "шифрование клиента" и "шифрование на стороне сервера", как упоминалось ранее. Независимо от используемой модели шифрования неактивных данных службы Azure всегда рекомендуют использовать безопасный канал транспорта, например TLS или HTTPS. Таким образом, шифрование на транспортном уровне должно определяться транспортным протоколом и не должно быть основным фактором при определении используемой модели шифрования неактивных данных.

### <a name="client-encryption-model"></a>Модель шифрования клиентом

Модель шифрования клиентом — это шифрование, выполняемое службой или вызывающим приложением за пределами поставщика ресурсов или Azure. Это шифрование можно выполнить с помощью приложения службы в Azure или приложения, работающего в центре обработки данных пользователя. В любом случае при использовании этой модели шифрования поставщик ресурсов Azure принимает зашифрованный большой двоичный объект данных без возможности расшифровки этих данных каким-либо образом, а также без доступа к ключам шифрования. В этой модели ключами управляют вызывающие приложение или служба. Этот процесс является непрозрачным для службы Azure.

!["Клиент";](./media/encryption-atrest/azure-security-encryption-atrest-fig2.png)

### <a name="server-side-encryption-model"></a>Модель шифрования на стороне сервера

Модели шифрования на стороне сервера относятся к шифрованию, выполняемому службой Azure. В этой модели поставщик ресурсов выполняет операции шифрования и расшифровки. Например, служба хранилища Azure может получать данные посредством простых текстовых операций, а затем выполнять внутренние шифрование и расшифровку. Поставщик ресурсов может использовать ключи шифрования, управляемые Майкрософт или пользователем, в зависимости от конфигурации.

![Сервер](./media/encryption-atrest/azure-security-encryption-atrest-fig3.png)

### <a name="server-side-encryption-key-management-models"></a>Модели управления ключами шифрования на стороне сервера

Каждая из моделей шифрования неактивных данных на стороне сервера подразумевает отличные характеристики управления ключами, в частности то, где и как создаются и хранятся ключи шифрования, а также модели доступа и процедуры смены ключей.

#### <a name="server-side-encryption-using-service-managed-keys"></a>Шифрование на стороне сервера с помощью управляемых службой ключей

Для многих пользователей существенным требованием является гарантия шифрования неактивных данных. Шифрование на стороне сервера с помощью управляемых службой ключей позволяет реализовать эту модель, давая пользователям возможность помечать конкретный ресурс (учетную запись хранения, базу данных SQL и т. д.) для шифрования и передает все аспекты управления ключами, например выдачу, смену и резервное копирование ключей, корпорации Майкрософт. Большинство служб Azure, которые обычно поддерживают шифрование неактивных данных, поддерживают эту модель передачи задач управления ключами шифрования в Azure. Поставщик ресурсов Azure создает ключи и помещает их в надежное хранилище, извлекая их при необходимости. Это означает, что служба имеет полный доступ к ключам и полностью контролирует жизненный цикл учетных данных.

![Управляемые](./media/encryption-atrest/azure-security-encryption-atrest-fig4.png)

Таким образом, шифрование на стороне сервера с помощью управляемых службой ключей быстро выполняет шифрование неактивных данных с низкими издержками для пользователя. Откройте целевую подписку и поставщика ресурсов на портале Azure и установите флажок, указывающий, что данные требуется зашифровать. В некоторых диспетчерах ресурсов шифрование на стороне сервера с помощью управляемых службой ключей включено по умолчанию.

Шифрование на стороне сервера с помощью ключей, управляемых Майкрософт, подразумевает, что служба имеет полный доступ к хранению ключей и управлению ими. Хотя некоторые пользователи хотят управлять ключами, так как они считают, что они получат больше безопасности, при оценке такой модели следует учитывать затраты и риски, связанные с использованием пользовательского хранилища ключей. Во многих случаях организация может решить, что нехватка ресурсов или риски, связанные с локальным решением, превышают риски облачного управления ключами шифрования неактивных данных.  Однако эта модель может оказаться недостаточной для организаций, имеющих требования для управления созданием или жизненным циклом ключей шифрования, а также для того, чтобы различные сотрудники управляли ключами шифрования службы, чем Управление службой (то есть разделение управления ключами из общей модели управления для службы).

##### <a name="key-access"></a>Доступ к ключам

При использовании шифрования на стороне сервера с ключами, управляемыми службой, созданием и хранением ключей, а также доступом к ним службами управляет служба. Как правило, основные поставщики ресурсов Azure хранят ключи шифрования данных в хранилище рядом с данными для быстрого доступа, в то время как ключи шифрования ключей хранятся в защищенном внутреннем хранилище.

**Преимущества**

- Простая настройка.
- Корпорация Майкрософт управляет сменой, резервным копированием и избыточностью ключей.
- Пользователь не несет затраты, связанные с реализацией, и для него нет риска использования пользовательской схемы управления ключами.

**Недостатки**

- Пользователь не управляет ключами шифрования (спецификацией, жизненным циклом, отзывом ключей и т. д.).
- Отсутствует возможность отделить управление ключами от общей модели управления для службы.

#### <a name="server-side-encryption-using-customer-managed-keys-in-azure-key-vault"></a>Шифрование на стороне сервера с помощью управляемых пользователем ключей в Azure Key Vault:

Для сценариев, в которых требуется шифровать неактивные данные и управлять ключами шифрования, можно использовать шифрование на стороне сервера с помощью управляемых пользователем ключей в хранилище ключей. Некоторые службы могут хранить корневой ключ шифрования ключей в Azure Key Vault и хранить зашифрованный ключ шифрования данных во внутреннем расположении рядом с данными. В таком сценарии пользователи могут переносить свои собственные ключи (BYOK) в хранилище ключей или создать ключи и использовать их для шифрования нужных ресурсов. Пока поставщик ресурсов выполняет операции шифрования и расшифровки, он использует настроенный ключ шифрования ключа в качестве корневого ключа для всех операций шифрования.

Потери ключей шифрования ключа означают потери данных. По этой причине ключи не должны удаляться. Необходимо создавать резервные копии ключей при создании или вращении. [Обратимое удаление](https://docs.microsoft.com/azure/key-vault/key-vault-ovw-soft-delete) должно быть включено в любом хранилище, в котором хранятся ключи шифрования ключей. Вместо удаления ключа задайте для параметра Enabled значение false или задайте дату окончания срока действия.

##### <a name="key-access"></a>Доступ к ключам

В модели шифрования на стороне сервера с хранением в Azure Key Vault ключей, управляемых пользователем, служба при необходимости получает доступ к ключам для шифрования и расшифровки. Ключи для шифрования неактивных данных становятся доступными для службы благодаря политике управления доступом. Эта политика предоставляет службе доступ на основе удостоверения для получения ключа. Службу Azure, запущенную от имени связанной подписки, можно настроить с помощью удостоверения в рамках этой подписки. Служба может выполнять проверку подлинности Azure Active Directory и получать токен проверки подлинности, идентифицируя себя как службу, которая действует от имени подписки. Затем этот токен может быть предоставлен хранилищу ключей для получения ключа, доступ к которому был получен.

Для операций с использованием ключей шифрования удостоверению службы можно предоставить доступ к любой из следующих операций: расшифровка, шифрование, упаковка, распаковка, проверка, подписывание, получение, перечисление, обновление, создание, импорт, удаление, резервное копирование и восстановление.

Чтобы получить ключ для шифрования или расшифровки неактивных данных, удостоверение службы, запущенное экземпляром службы диспетчера ресурсов, должно иметь ключ распаковки (чтобы получить ключ для расшифровки) и ключ упаковки (чтобы вставить ключ в хранилище ключей при создании нового ключа).

>[!NOTE]
>Дополнительные сведения об авторизации в хранилище ключей см. в статье [Защита хранилища ключей](../../key-vault/general/secure-your-key-vault.md).

**Преимущества**

- Полный контроль над используемыми ключами — управление ключами шифрования осуществляется в Key Vault клиента под управлением клиента.
- Возможность шифрования нескольких служб с помощью главного ключа.
- Возможность отделить управление ключами от общей модели управления для службы.
- Возможность определить службу и расположение ключа в нескольких регионах.

**Недостатки**

- Пользователь полностью отвечает за управление доступом к ключам.
- Пользователь полностью отвечает за управление жизненным циклом ключей.
- Дополнительные издержки в процессе установки и конфигурации.

#### <a name="server-side-encryption-using-customer-managed-keys-in-customer-controlled-hardware"></a>Шифрование на стороне сервера с помощью управляемых клиентом ключей в оборудовании, управляемом клиентом

Некоторые службы Azure допускают использование модели управления с размещением собственного ключа (HYOK). Этот режим управления полезен в сценариях, когда необходимо зашифровать неактивных данные и управлять ключами в собственном репозитории за пределами системы управления Майкрософт. В этой модели службе необходимо получить ключ с внешнего сайта. Что в результате оказывает влияние на производительность и гарантии доступности, а конфигурация усложняется. Кроме того, так как служба имеет доступ к ключу шифрования данных во время операции шифрования и расшифровки, общие гарантии безопасности этой модели аналогичны модели, в которой ключами управляют пользователи в Azure Key Vault.  В результате эта модель не подходит для большинства организаций, если они не имеют конкретных требований к управлению ключами. Из-за этих ограничений большинство служб Azure не поддерживают шифрование на стороне сервера с помощью управляемых сервером ключей на оборудовании под контролем пользователя.

##### <a name="key-access"></a>Доступ к ключам

При использовании шифрования на стороне сервера с помощью управляемых службой ключей в оборудовании под контролем пользователя ключи хранятся в системе, настроенной пользователем. Службы Azure, которые поддерживают эту модель, предоставляют средства для создания безопасного подключения к хранилищу ключей, предоставленному пользователем.

**Преимущества**

- Полный контроль над корневым ключом. Ключи шифрования управляются в хранилище пользователя.
- Возможность шифрования нескольких служб с помощью главного ключа.
- Возможность отделить управление ключами от общей модели управления для службы.
- Возможность определить службу и расположение ключа в нескольких регионах.

**Недостатки**

- Полная ответственность за хранение ключей, безопасность, производительность и доступность.
- Полная ответственность за управление доступом к ключам.
- Полная ответственность за управление жизненным циклом ключей.
- Значительные расходы на установку, настройку и текущее обслуживание.
- Повышенная зависимость от доступности сети между центрами обработки данных Azure и центром обработки данных пользователя.

## <a name="encryption-at-rest-in-microsoft-cloud-services"></a>Шифрование неактивных данных в облачных службах Майкрософт

Облачные службы Майкрософт используются во всех трех облачных моделях: IaaS, PaaS, SaaS. Ниже приведены примеры их размещения в каждой модели.

- Программные службы ("программное обеспечение как сервер" (SaaS)) имеют приложение, предоставляемое облачной службой, например Office 365.
- Службы платформы, через которые пользователи используют облако в своих приложениях, в частности для доступа к функциям служебной шины, хранения и аналитики.
- Службы инфраструктуры (инфраструктура как услуга (IaaS)), в которых пользователь развертывает операционные системы и приложения, размещенные в облаке, и в которых может использовать другие облачные службы.

### <a name="encryption-at-rest-for-saas-customers"></a>Шифрование неактивных данных пользователей SaaS

Для пользователей программного обеспечения как услуги (SaaS) шифрование неактивных данных обычно включено или доступно в каждой службе. В Office 365 реализовано несколько механизмов проверки выполнения или включения шифрования неактивных данных. Чтобы получить сведения о службах Office 365, ознакомьтесь с концепциями [шифрования данных в Office 365](https://docs.microsoft.com/office365/securitycompliance/encryption).

### <a name="encryption-at-rest-for-paas-customers"></a>Шифрование неактивных данных пользователей PaaS

Данные клиента "платформа как услуга" (PaaS) обычно находятся в службе хранилища, например в хранилище BLOB-объектов, но также могут кэшироваться или храниться в среде выполнения приложений, например в виртуальной машине. Чтобы просмотреть доступные варианты шифрования неактивных данных, ознакомьтесь с таблицей ниже для используемых хранилищ и платформ приложений.

### <a name="encryption-at-rest-for-iaas-customers"></a>Шифрование неактивных данных пользователей IaaS

Пользователи, использующие инфраструктуру как услугу (IaaS), могут использовать ряд служб и приложений. Службы IaaS могут включить шифрование неактивных данных на своих размещенных в Azure виртуальных машинах и виртуальных жестких дисках с помощью шифрования дисков Azure.

#### <a name="encrypted-storage"></a>Зашифрованное хранилище

Аналогично решениям PaaS, решения IaaS могут использовать другие службы Azure, которые хранят данные в зашифрованном виде. В таких случаях можно включить поддержку шифрования неактивных данных для каждой используемой службы Azure. В таблице ниже перечислены основные хранилища, службы и платформы приложений, а также поддерживаемые модели шифрования неактивных данных. 

#### <a name="encrypted-compute"></a>Зашифрованные вычисления

Все управляемые диски, моментальные снимки и образы шифруются с помощью Шифрование службы хранилища с помощью ключа, управляемого службой. Более полное шифрование неактивных решений гарантирует, что данные никогда не сохраняются в незашифрованном виде. При обработке данных на виртуальной машине данные могут быть сохранены в файле подкачки Windows или в файле подкачки Linux, аварийном дампе или журнале приложений. Чтобы убедиться, что эти данные шифруются при хранении, приложения IaaS могут использовать службу "Шифрование дисков Azure" на виртуальной машине Azure IaaS (Windows или Linux) и виртуальном диске.

#### <a name="custom-encryption-at-rest"></a>Пользовательское шифрование неактивных данных

Рекомендуется, чтобы приложения IaaS использовали шифрование дисков Azure и параметры шифрования неактивных данных, предоставляемые любой используемой службой Azure. В некоторых случаях, например при нестандартных требованиях к шифрованию или при использовании хранилища, отличного от Azure, разработчику приложения IaaS может потребоваться реализовать шифрование неактивных данных самостоятельно. Разработчики решений IaaS могут обеспечивать лучшую интеграцию с управлением Azure и удовлетворять ожидания пользователей за счет использования определенных компонентов Azure. В частности разработчикам следует использовать службу Azure Key Vault, чтобы обеспечить безопасное хранение ключей, а также предоставить своим пользователям согласованные параметры управления ключами большинства служб платформы Azure. Кроме того, пользовательские решения должны использовать удостоверения служб, управляемых Azure, чтобы предоставить учетным записям служб доступ к ключам шифрования. Сведения для разработчиков об Azure Key Vault и удостоверениях управляемых служб см. в соответствующих пакетах SDK.

## <a name="azure-resource-providers-encryption-model-support"></a>Поддержка модели шифрования поставщиками ресурсов Azure

Каждая служба Microsoft Azure поддерживает одну или несколько моделей шифрования неактивных данных. Тем не менее для некоторых служб одна или несколько моделей шифрования могут быть неприменимы. Для служб, которые поддерживают управляемые клиентами сценарии использования ключей, они могут поддерживать только несколько типов ключей, которые поддерживает хранилище Azure Key Vault для ключей шифрования ключей. Кроме того, службы могут добавлять поддержку этих сценариев и типов ключей в разное время. В этом разделе описывается поддержка шифрования неактивных данных на момент написания этой статьи для основных служб хранения данных Azure.

### <a name="azure-disk-encryption"></a>Шифрование дисков Azure

Любой пользователь, который использует функции инфраструктуры как услуги (IaaS) Azure, может включить шифрование неактивных данных на виртуальных машинах IaaS и дисках с помощью шифрования дисков Azure. Дополнительные сведения о шифровании дисков Azure см. в [документации по шифрованию дисков Azure](../azure-security-disk-encryption-overview.md).

#### <a name="azure-storage"></a>Хранилище Azure

Все службы хранилища Azure (хранилище BLOB-объектов, хранилище очередей, хранилище таблиц и файлы Azure) поддерживают шифрование неактивных данных на стороне сервера; Некоторые службы дополнительно поддерживают управляемые клиентом ключи и шифрование на стороне клиента. 

- На стороне сервера: все службы хранилища Azure используют шифрование на стороне сервера по умолчанию с использованием управляемых службой ключей, которые являются прозрачными для приложения. Дополнительные сведения см. в статье [Шифрование службы хранилища Azure для неактивных данных (предварительная версия)](../../storage/common/storage-service-encryption.md). Хранилище BLOB-объектов Azure и служба файлов Azure также поддерживают 2048-битные управляемые клиентом ключи RSA в Azure Key Vault. Дополнительные сведения см. в статье [Шифрование службы хранилища с помощью управляемых клиентом ключей в Azure Key Vault](../../storage/common/storage-encryption-keys-portal.md).
- На стороне клиента: большие двоичные объекты, таблицы и очереди Azure поддерживают шифрование на стороне клиента. При использовании шифрования на стороне клиента данные шифруются и передаются в виде зашифрованного большого двоичного объекта. Управление ключами осуществляется пользователем. Дополнительные сведения см. в статье [Шифрование на стороне клиента для службы хранилища Microsoft Azure](../../storage/common/storage-client-side-encryption.md).

#### <a name="azure-sql-database"></a>База данных SQL Azure

В настоящее время База данных SQL Azure поддерживает шифрование неактивных данных в сценариях шифрования на стороне клиента и на стороне управляемых служб Майкрософт.

Поддержка шифрования на стороне сервера в настоящее время предоставляется с помощью функции SQL, которая называется прозрачным шифрованием данных. Как только пользователь базы данных SQL Azure активирует прозрачное шифрование данных, эта функция будет автоматически создавать ключи и управлять ими. Шифрование неактивных данных можно включить на уровне базы данных и на уровне сервера. Начиная с июня 2017 г. [прозрачное шифрование данных (TDE)](https://msdn.microsoft.com/library/bb934049.aspx) включается по умолчанию для всех новых баз данных. База данных SQL Azure поддерживает управляемые клиентом 2048-битные ключи RSA в Azure Key Vault. Дополнительные сведения см. в статье [Прозрачное шифрование данных с поддержкой использования собственных ключей для Базы данных SQL Azure и хранилища данных SQL Azure](https://docs.microsoft.com/sql/relational-databases/security/encryption/transparent-data-encryption-byok-azure-sql?view=azuresqldb-current).

Шифрование на стороне клиента Базы данных SQL Azure поддерживается с помощью функции [Always Encrypted](https://msdn.microsoft.com/library/mt163865.aspx). Always Encrypted использует ключ, который создается и хранится клиентом. пользователь может хранить главный ключ в хранилище сертификатов Windows, Azure Key Vault или аппаратном модуле безопасности (HSM), размещенном локально. С помощью SQL Server Management Studio пользователи SQL выбирают, какой ключ следует использовать для шифрования столбца.

#### <a name="encryption-model-and-key-management-table"></a>Модель шифрования и таблица управления ключами

| Продукт, функция или услуга | На стороне сервера с помощью управляемого службой ключа   | На стороне сервера с помощью управляемого клиентом ключа | На стороне клиента с использованием ключа, управляемого клиентом  |
|----------------------------------|--------------------|-----------------------------------------|--------------------|
| **ИИ и Машинное обучение**      |                    |                    |                    |
| Когнитивный поиск Azure           | Да                | Да                | -                  |
| Azure Cognitive Services         | Да                | Да                | -                  |
| Машинное обучение Azure           | Да                | Да                | -                  |
| Студия машинного обучения Azure    | Да                | 2048-разрядный RSA (предварительная версия) | -               |
| Content Moderator                | Да                | Да                | -                  |
| Распознавание лиц                             | Да                | Да                | -                  |
| Распознавание речи           | Да                | Да                | -                  |
| Персонализатор                     | Да                | Да                | -                  |
| QnA Maker                        | Да                | Да                | -                  |
| Службы "Речь"                  | Да                | Да                | -                  |
| Перевод текстов                  | Да                | Да                | -                  |
| Power BI                         | Да                | 2048-разрядный RSA (предварительная версия) | -                  |
| **Аналитика**                    |                    |                    |                    |
| Azure Stream Analytics           | Да                | Недоступно\*            | -                  |
| Центры событий                       | Да                | Да, все длины RSA. | -                  |
| Функции                        | Да                | Да, все длины RSA. | -                  |
| Службы Azure Analysis Services          | Да                | -                  | -                  |
| Каталог данных Azure               | Да                | -                  | -                  |
| Azure HDInsight                  | Да                | Все                | -                  |
| Azure Monitor Application Insights | Да                | Да                | -                  |
| Azure Monitor Log Analytics      | Да                | Да                | -                  |
| Azure Data Explorer              | Да                | Да                | -                  |
| Фабрика данных Azure               | Да                | Да                | -                  |
| Хранилище озера данных Azure            | Да                | Да, 2048-разрядный RSA  | -                  |
| **Контейнеры**                   |                    |                    |                    |
| Служба Azure Kubernetes         | Да                | Да                | -                  |
| Экземпляры контейнеров              | Да                | Да                | -                  |
| Реестр контейнеров               | Да                | Да                | -                  |
| **Compute**                      |                    |                    |                    |
| Виртуальные машины                 | Да                | Да, 2048-разрядный RSA  | -                  |
| Масштабируемый набор виртуальных машин        | Да                | Да, 2048-разрядный RSA  | -                  |
| SAP HANA                         | Да                | Да, 2048-разрядный RSA  | -                  |
| Служба приложений                      | Да                | Да\*\*            | -                  |
| Служба автоматизации                       | Да                | Да\*\*            | -                  |
| Функции Azure                  | Да                | Да\*\*            | -                  |
| Портал Azure                     | Да                | Да\*\*            | -                  |
| Logic Apps                       | Да                | Да                | -                  |
| Управляемые приложения Azure       | Да                | Да\*\*            | -                  |
| Служебная шина                      | Да                | Да                | -                  |
| Site Recovery                    | Да                | Да                | -                  |
| **Базы данных**                    |                    |                    |                    |
| SQL Server на виртуальных машинах   | Да                | Да, 2048-разрядный RSA  | Да                |
| База данных SQL Azure               | Да                | Да, 2048-разрядный RSA  | Да                |
| База данных SQL Azure для MariaDB   | Да                | -                  | -                  |
| База данных SQL Azure для MySQL     | Да                | Да                | -                  |
| База данных SQL Azure для PostgreSQL | Да               | Да                | -                  |
| Azure Synapse Analytics          | Да                | Да, 2048-разрядный RSA  | -                  |
| SQL Server Stretch Database      | Да                | Да, 2048-разрядный RSA  | Да                |
| Хранилище таблиц                    | Да                | Да                | Да                |
| Azure Cosmos DB                  | Да                | Да                | -                  |
| Azure Databricks                 | Да                | Да                | -                  |
| Azure Database Migration Service | Да                | Недоступно\*              | -                  |
| **DevOps**                       |                    |                    |                    |
| Azure DevOps Services            | Да                | -                  | Да                |
| Azure Repos                      | Да                | -                  | Да                |
| **Удостоверение**                     |                    |                    |                    |
| Azure Active Directory           | Да                | -                  | -                  |
| Доменные службы Azure Active Directory | Да          | Да, 2048-разрядный RSA  | -                  |
| **Интеграция**                  |                    |                    |                    |
| Служебная шина                      | Да                | Да                | Да                |
| Сетка событий Azure                       | Да                | -                  | -                  |
| Управление API                   | Да                | -                  | -                  |
| **Службы Интернета вещей**                 |                    |                    |                    |
| Центр Интернета вещей                          | Да                | Да                | Да                |
| Подготовка устройств к добавлению в центр Интернета вещей      | Да                | Да                | -                  |
| **Управление**    |                    |                    |                    |
| Azure Site Recovery              | Да                | -                  | -                  |
| Служба "Миграция Azure"                    | Да                | Да                | -                  |
| **Носитель**                        |                    |                    |                    |
| Службы мультимедиа                   | Да                | -                  | Да                |
| **Безопасность**                     |                    |                    |                    |
| Центр безопасности Azure для Интернета вещей    | Да                | Да                | -                  |
| Azure Sentinel                   | Да                | Да                | -                  |
| **Память**                      |                    |                    |                    |
| хранилище BLOB-объектов;                     | Да                | Да, 2048-разрядный RSA  | Да                |
| Хранилище BLOB-объектов класса Premium             | Да                | Да, 2048-разрядный RSA  | Да                |
| Хранилище дисков                     | Да                | Да                | -                  |
| Ultra Хранилище дисков               | Да                | Да                | -                  |
| Управляемый Хранилище дисков             | Да                | Да                | -                  |
| Файлы Azure                     | Да                | Да, 2048-разрядный RSA  | -                  |
| Хранилище файлов класса Premium             | Да                | Да, 2048-разрядный RSA  | -                  |
| Синхронизация файлов Azure                        | Да                | Да, 2048-разрядный RSA  | -                  |
| Хранилище очередей                    | Да                | Да                | Да                |
| Avere vFXT                       | Да                | -                  | -                  |
| Кэш Redis для Azure            | Да                | Недоступно\*              | -                  |
| Azure NetApp Files               | Да                | Да                | -                  |
| Архивное хранилище                  | Да                | Да, 2048-разрядный RSA  | -                  |
| StorSimple                       | Да                | Да, 2048-разрядный RSA  | Да                |
| Azure Backup                     | Да                | Да                | Да                |
| Data Box                         | Да                | -                  | Да                |
| Data Box Edge                    | Да                | Да                | -                  |

\*Эта служба не сохраняет данные. Временные кэши, если они есть, шифруются с помощью ключа Microsoft.

\*\*Эта служба поддерживает хранение данных в собственной Key Vault, учетной записи хранения или другой сохраненной службе данных, которая уже поддерживает шифрование на стороне сервера с помощью ключа, управляемого клиентом.

## <a name="conclusion"></a>Заключение

Защита данных пользователя, хранимых в службах Azure, представляет особую важность для Майкрософт. Все службы, размещенные в Azure, обязуются предоставлять параметры шифрования неактивных данных. Службы Azure поддерживают ключи, управляемые службой, ключи, управляемые клиентом, или шифрование на стороне клиента. Службы Azure широко расширяют возможности шифрования при недоступности, а новые варианты запланированы на предварительную версию и общую доступность в ближайшие месяцы.
