---
title: Общие сведения о защите базы данных Azure | Документы Майкрософт
description: В этой статье приведено краткое описание основных функций безопасности базы данных Azure.
services: security
documentationcenter: na
author: UnifyCloud
manager: barbkess
editor: TomSh
ms.assetid: ''
ms.service: security
ms.subservice: security-fundamentals
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 10/30/2018
ms.author: TomSh
ms.openlocfilehash: e5ed60ea59dc8cf19b8f9ca7e96777dbc6980171
ms.sourcegitcommit: beb34addde46583b6d30c2872478872552af30a1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/22/2019
ms.locfileid: "69906060"
---
# <a name="azure-database-security-overview"></a>Общие сведения о защите базы данных Azure

При управлении базами данных безопасность имеет первостепенное значение и всегда была приоритетной задачей для Базы данных SQL Azure. База данных SQL Azure поддерживает безопасность подключения с помощью шифрования соединения и правил брандмауэра. Она поддерживает аутентификацию по имени пользователя и паролю, а также аутентификацию Azure Active Directory (Azure AD), в которой используются удостоверения, управляемые Azure Active Directory. Проверка подлинности использует управление доступом на основе ролей.

База данных SQL Azure выполняет шифрование и дешифровку базы данных, связанных резервных копий и неактивных файлов журналов транзакций в реальном времени без необходимости изменения приложения.

Корпорация Майкрософт предоставляет дополнительные возможности для шифрования корпоративных данных:

-   Шифрование на уровне ячейки можно использовать для шифрования определенных столбцов или даже ячеек данных с помощью разных ключей шифрования.
-   Если требуется аппаратный модуль безопасности или централизованное управление иерархией ключей шифрования, используйте Azure Key Vault с сервером SQL Server на виртуальной машине Azure.
-   Функция Always Encrypted (сейчас доступна предварительная версия) делает шифрование прозрачным для приложений. Always Encrypted позволяет клиентам шифровать конфиденциальные данные в клиентских приложениях, не раскрывая ключи шифрования в базе данных SQL.

Аудит базы данных SQL Azure позволяет организациям записывать события аудита для отслеживания событий входа в службу хранилища. Кроме того, благодаря интеграции аудита Базы данных SQL с Microsoft Power BI обеспечиваются упрощенное создание подробных отчетов и проведение детализированного анализа.

Вы можете обеспечить надежную защиту баз данных SQL Azure, чтобы удовлетворить большинству нормативных требований и требований безопасности, включая стандарты HIPAA, ISO 27001/27002 и PCI DSS (уровень 1). Текущий список сертификатов соответствия требованиям безопасности доступен на [сайте Центра управления безопасностью Microsoft Azure](https://azure.microsoft.com/support/trust-center/services/).

В этой статье рассматриваются основные принципы защиты баз данных SQL Microsoft Azure для структурированных, табличных и реляционных данных. В частности, эта статья содержит инструкции по началу работы с ресурсами для защиты данных, контроля доступа и упреждающего мониторинга.

## <a name="protection-of-data"></a>Защита данных

База данных SQL помогает защитить данные, обеспечивая шифрование:

- передаваемых данных с помощью [протокола TLS](https://support.microsoft.com/kb/3135244);
- неактивных данных с помощью [прозрачного шифрования данных](https://go.microsoft.com/fwlink/?LinkId=526242);
- используемых данных с помощью функции [Always Encrypted](https://msdn.microsoft.com/library/mt163865.aspx).

Другие способы шифрования данных включают следующее:

-   [Шифрование на уровне ячейки](https://msdn.microsoft.com/library/ms179331.aspx) для шифрования определенных столбцов или даже ячеек данных с использованием разных ключей шифрования.
-   [Azure Key Vault с сервером SQL Server на виртуальной машине Azure](https://blogs.technet.com/b/kv/archive/2015/01/12/using-the-key-vault-for-sql-server-encryption.aspx), если требуется аппаратный модуль безопасности или централизованное управление иерархией ключей шифрования.

### <a name="encryption-in-motion"></a>Шифрование при передаче

Распространенной проблемой для всех клиентских и серверных приложений является необходимость конфиденциальности при передаче данных в общедоступных и частных сетях. Если данные, передаваемые по сети, не зашифрованы, эти данные могут быть перехвачены и украдены неавторизованными пользователями. При работе со службами базы данных убедитесь, что данные, передаваемые между сервером и клиентом базы данных, шифруются. Также убедитесь, что выполняется шифрование данных, передаваемых между серверами базы данных, взаимодействующими друг с другом и с приложениями среднего уровня.

Одна из проблем при администрировании сети заключается в обеспечении безопасности данных, которые передаются между приложениями по ненадежной сети. Для аутентификации серверов и клиентов и шифрования сообщений между клиентом и сервером, прошедшими аутентификацию, можно использовать протокол [TLS/SSL](/windows-server/security/tls/transport-layer-security-protocol).

В процессе аутентификации клиент TLS/SSL отправляет сообщение на сервер TLS/SSL. В ответ сервер передает информацию, которую ему необходимо проверить для выполнения аутентификации. Клиент и сервер выполняют дополнительный обмен сеансовыми ключами, и диалог проверки подлинности завершается. После завершения аутентификации между клиентом и сервером можно установить обмен данными по защищенному протоколу SSL с использованием симметричных ключей шифрования, которые формируются во время аутентификации.

Во время каждого сеанса передачи данных в базу данных SQL Azure и из нее все подключения к базе данных должны быть зашифрованы (TLS/SSL). База данных SQL использует протокол TLS/SSL для аутентификации серверов и клиентов, а затем использует его для шифрования сообщений между сторонами, прошедшими аутентификацию. 

В строке подключения приложения необходимо добавить параметры для шифрования подключения и указать не доверять сертификату сервера. (Это будет сделано автоматически при копировании строки подключения с портала Azure.) В противном случае при установлении подключения не будет проверяться подлинность сервера и оно будет подвержено атакам "злоумышленник в середине". Например, для драйвера ADO.NET это параметры строки подключения `Encrypt=True` и `TrustServerCertificate=False`.

### <a name="encryption-at-rest"></a>Шифрование при хранении

Можно принять ряд мер предосторожности, чтобы защитить базу данных. Например, можно спроектировать безопасную систему, использовать шифрование конфиденциальных ресурсов и установить брандмауэр перед серверами базы данных. Однако в случае похищения физического носителя (например, дисков или лент с резервными копиями) злоумышленник может просто восстановить или подключить базу данных и просмотреть данные.

Одним из решений является шифрование конфиденциальных данных в базе данных и защита ключей, которые используются для шифрования, с помощью сертификата. Это решение не позволит никому использовать данные без ключей, но такой тип защиты следует планировать заранее.

Для устранения этой проблемы SQL Server и база данных SQL поддерживают [прозрачное шифрование данных](/sql/relational-databases/security/encryption/transparent-data-encryption-azure-sql?view=azuresqldb-current&viewFallbackFrom=sql-server-2017). При прозрачном шифровании данных шифруются файлы данных SQL Server и базы данных SQL. Это так называемое шифрование неактивных данных.

Прозрачное шифрование данных обеспечивает защиту от вредоносных действий. Выполняется шифрование и расшифровка базы данных, связанных резервных копий и неактивных файлов журналов транзакций в реальном времени без необходимости изменения приложения.  

При использовании прозрачного шифрования данных хранилище всей базы данных шифруется с помощью симметричного ключа, который называется ключом шифрования базы данных. В базе данных SQL ключ шифрования базы данных защищается встроенным сертификатом сервера. Каждый сервер Базы данных SQL обладает уникальным встроенным сертификатом.

Если база данных находится в отношении GeoDR, она защищается различными ключами на разных серверах. Если две базы данных подключены к одному и тому же серверу, то они совместно используют один встроенный сертификат. Корпорация Майкрософт автоматически изменяет эти сертификаты не реже, чем раз в 90 дней. 

Дополнительные сведения см. в статье [Прозрачное шифрование данных (TDE)](/sql/relational-databases/security/encryption/transparent-data-encryption-tde).

### <a name="encryption-in-use-client"></a>Шифрование при использовании (клиент)

Большинство утечек данных происходят из-за кражи критически важных данных, таких как номера кредитных карт или персональные данные. Базы данных могут содержать ценные конфиденциальные данные. Они могут содержать персональные данные клиентов (например, персональные коды), конфиденциальную информацию о конкурентах и сведения, представляющие интеллектуальную собственность. Потеря или кража данных, особенно данных клиентов, могут привести к ущербу для бренда, утрате преимущества перед конкурентами, серьезным штрафам и даже судебным искам.

![Функция Always Encrypted показана в виде ключа и замка](./media/database-security-overview/azure-database-fig1.png)

[Always Encrypted](https://msdn.microsoft.com/library/mt163865.aspx) — это функция, предназначенная для защиты конфиденциальных данных, хранящихся в базах данных SQL Azure или базах данных SQL Server. Always Encrypted позволяет клиентам шифровать конфиденциальные данные в приложениях, не раскрывая ключи шифрования в ядре СУБД (база данных SQL или SQL Server).

Always Encrypted разделяет пользователей на владельцев данных (которые могут просматривать данные) и управляющих данными (у которых не должно быть доступа к данным). Благодаря этому администраторы локальных баз данных, операторы облачных баз данных и другие пользователи с высоким уровнем привилегий, не прошедшие аутентификацию, не имеют доступа к зашифрованным данным.

Кроме того, функция Always Encrypted делает шифрование прозрачным для приложений. На клиентском компьютере установлен драйвер с поддержкой Always Encrypted. Это позволяет приложению автоматически шифровать и расшифровывать конфиденциальные данные в клиентском приложении. Драйвер шифрует данные в конфиденциальных столбцах перед их передачей в ядро СУБД. Драйвер автоматически переписывает запросы, чтобы сохранить семантику приложения. Аналогичным образом драйвер прозрачно расшифровывает данные, которые хранятся в зашифрованных столбцах базы данных в результатах запроса.

## <a name="access-control"></a>Контроль доступа

Чтобы обеспечить безопасность, база данных SQL управляет доступом с помощью:

- правил брандмауэра, которые ограничивают подключения по IP-адресу;
- механизмов аутентификации, требующих подтверждения подлинности пользователей;
- механизмов авторизации, позволяющих предоставить пользователям доступ только к определенным действиям и данным.

### <a name="database-access"></a>Доступ к базе данных

Защита данных начинается с контроля доступа к данным. Центр обработки данных, на котором размещены данные, управляет физическим доступом. Можно настроить брандмауэр для управления безопасностью на уровне сети. Вы также можете управлять доступом, настроив имена входа для проверки подлинности и задав разрешения для ролей сервера и базы данных.

#### <a name="firewall-and-firewall-rules"></a>Брандмауэр и правила брандмауэра

[База данных SQL Azure](https://azure.microsoft.com/services/sql-database/) предоставляет службу реляционных баз данных для Azure и других веб-приложений. Чтобы защитить ваши данные, брандмауэр запрещает любой доступ к серверу базы данных, пока вы не укажете компьютеры, у которых есть разрешение на доступ. Брандмауэр предоставляет доступ к базам данным на основе исходного IP-адреса каждого запроса. Дополнительные сведения см. в статье [Обзор правил брандмауэра Базы данных SQL Azure](/azure/sql-database/sql-database-firewall-configure).

Служба "База данных SQL Azure" доступна только на TCP-порте 1433. Для получения доступа к базе данных Azure со своего компьютера убедитесь, что брандмауэр клиентского компьютера пропускает исходящие подключения по протоколу TCP через порт 1433. Заблокируйте входящие подключения по протоколу TCP через порт 1433, если они не требуются для других приложений.

#### <a name="authentication"></a>Проверка подлинности

В процессе аутентификации предлагается подтвердить личность пользователя при подключении к базе данных. База данных SQL поддерживает два типа аутентификации:

-   **Проверка подлинности SQL Server**. При создании логического экземпляра SQL создается единая учетная запись, которая называется учетной записью подписчика базы данных SQL. Эта учетная запись используется для подключения [с использованием аутентификации SQL Server](/azure/sql-database/sql-database-security-overview) (с помощью имени пользователя и пароля). Эта учетная запись является администратором для экземпляра логического сервера, а также для всех пользовательских баз данных, присоединенных к этому экземпляру. Разрешения учетной записи подписчика невозможно ограничить. Может существовать только одна такая учетная запись.
-   **Аутентификация Azure Active Directory.** [Аутентификация Azure AD](/azure/sql-database/sql-database-aad-authentication) — это механизм подключения к службам "База данных SQL Azure" и "Хранилище данных SQL Azure" с помощью удостоверений в Azure AD. Этот механизм позволяет централизованно управлять удостоверениями пользователей базы данных.

![Аутентификация Azure AD в базе данных SQL](./media/database-security-overview/azure-database-fig2.png)

 К преимуществам аутентификации Azure AD относятся:
  - наличие альтернативного варианта проверки подлинности SQL Server;
  - предотвращение распространения удостоверений пользователей на серверах базы данных и возможность смены паролей в одном месте;
  - возможность управлять разрешениями базы данных с помощью внешних групп (Azure AD);
  - возможность исключить хранение паролей с помощью встроенной проверки подлинности Windows и других видов аутентификации, поддерживаемых Azure Active Directory.

#### <a name="authorization"></a>Authorization

[Авторизация](/azure/sql-database/sql-database-manage-logins) относится к действиям, доступным пользователю в базе данных SQL Azure. Они определяются [членством в ролях](https://msdn.microsoft.com/library/ms189121) и [разрешениями уровня объекта](https://msdn.microsoft.com/library/ms191291.aspx) базы данных, назначенными учетной записи пользователя. Проверка подлинности — это процесс определения того, к каким защищаемым ресурсам участник может получить доступ и какие операции допускаются для этих ресурсов.

### <a name="application-access"></a>Доступ к приложениям

#### <a name="dynamic-data-masking"></a>Динамическое маскирование данных

Представитель службы поддержки в центре обработки вызовов может идентифицировать абонентов по нескольким цифрам номера социального страхования или кредитной карты. Но он не должен полностью видеть эти элементы данных.

Можно определить правило маскирования таким образом, чтобы в результатах выполнения запросов маскировалось все, кроме последних четырех цифр номера социального страхования или кредитной карты.

![Маскирование с чисел, передаваемых между базой данных SQL и бизнес-приложениями](./media/database-security-overview/azure-database-fig3.png)

Еще один пример: можно определить соответствующую маску данных для защиты личных сведений. В этом случае разработчик сможет отправлять запросы к рабочей среде для устранения неполадок, не нарушая требований соответствия нормативам.

[Динамическая маскировка данных в базе данных SQL](/azure/sql-database/sql-database-dynamic-data-masking-get-started) ограничивает возможность раскрытия конфиденциальных данных, маскируя их для обычных пользователей. Динамическое маскирование данных поддерживается в версии 12 Базы данных SQL Azure.

[Динамическое маскирование данных](/sql/relational-databases/security/dynamic-data-masking) помогает предотвратить несанкционированный доступ к конфиденциальным данным, позволяя вам самостоятельно определить, какой объем конфиденциальных данных следует раскрывать с минимальным влиянием на уровне приложения. Эта функция работает на основе политики безопасности, скрывая конфиденциальные данные в результирующем наборе запроса по заданным полям базы данных, не меняя сами данные в базе данных.

> [!Note]
> Динамическую маскировку данных может настраивать администратор базы данных Azure, администратор сервера или сотрудник службы безопасности.

#### <a name="row-level-security"></a>Безопасность на уровне строк

Другим распространенным требованием безопасности для многопользовательских баз данных является [безопасность на уровне строк](https://msdn.microsoft.com/library/dn765131.aspx). Эта функция позволяет управлять доступом к строкам в таблице базы данных в зависимости от характеристик пользователя, выполняющего запрос. (Например, это может быть членство в группе или контекст выполнения).

![Безопасность на уровне строк позволяет пользователю обращаться к строкам в таблице при помощи клиентского приложения](./media/database-security-overview/azure-database-fig4.png)

Логика ограничения доступа находится на уровне базы данных, а не на другом уровне приложения отдельно от данных. Система базы данных применяет ограничения доступа при каждой попытке получения доступа к данным независимо от уровня. Это делает систему безопасности более надежной и устойчивой за счет уменьшения ее контактной зоны.

Безопасность на уровне строк включает управление доступом на основе предикатов. Она поддерживает гибкую централизованную оценку, которая может учитывать метаданные или другие критерии, определяемые администратором по необходимости. Предикат используется как критерий для определения того, имеет ли пользователь соответствующий доступ к данным на основе атрибутов пользователя. Управление доступом на основе меток можно реализовать с помощью управления доступом на основе предикатов.

## <a name="proactive-monitoring"></a>Упреждающий мониторинг

База данных SQL помогает обеспечить защиту данных, предоставляя возможности *аудита* и *обнаружения угроз*.

### <a name="auditing"></a>Аудит

[Аудит базы данных SQL Azure](/azure/sql-database/sql-database-auditing-get-started) повышает возможность получения аналитических сведений о событиях и изменениях, которые произошли в базе данных. Примерами являются обновления и запросы к данным.

Аудит базы данных SQL позволяет отслеживать события базы данных и записывать их в журнал аудита в учетной записи хранения Azure. Аудит может помочь вам соблюсти стандарты, проанализировать работу с базой данных и получить аналитические сведения о расхождениях и аномалиях, которые могут указывать на бизнес-проблемы или предполагаемые нарушения безопасности. Средства аудита способствуют соблюдению стандартов соответствия, но не гарантируют их выполнение.

Используйте аудит базы данных SQL, чтобы выполнять следующие действия:

- **Сохранить** журнал аудита выбранных событий. Вы можете указать, какие категории действий базы данных должны проходить аудит.
- **Создавать отчеты** по действиям, производимым с базой данных. Вы можете использовать предварительно настроенные отчеты и панель мониторинга для быстрого начала работы с отчетностью по действиям и событиям.
- **Анализировать** отчеты. Вы можете искать подозрительные события, необычную деятельность и тенденции.

Существуют два метода аудита:

-   **Аудит больших двоичных объектов**. Журналы записываются в хранилище BLOB-объектов Azure. Это более новый метод аудита. Он обеспечивает более высокую производительность, поддерживает более высокую детализацию аудита уровня объекта и является экономически более эффективным.
-   **Аудит таблиц**. Журналы записываются в Табличное хранилище Azure.

### <a name="threat-detection"></a>Обнаружение угроз

[Расширенная защита от угроз Azure для Базы данных SQL Azure](/azure/sql-database/sql-advanced-threat-protection) выявляет подозрительные действия, которые указывают на потенциальные угрозы безопасности. Обнаружение угроз позволяет реагировать на подозрительные события в базе данных, например атаки путем внедрения кода SQL, при их возникновении. Эта служба предоставляет оповещения и позволяет использовать аудит базы данных SQL Azure для изучения подозрительных событий.

![Обнаружение угроз для базы данных SQL и веб-приложения, создаваемых внешним злоумышленником и злоумышленником внутри организации](./media/database-security-overview/azure-database-fig5.jpg)

Служба "Расширенная защита от угроз SQL" (ATP) предоставляет набор расширенных функций безопасности SQL, включая обнаружение и классификацию данных, оценку уязвимостей и обнаружение угроз. 

- [Обнаружение и классификация данных](/azure/sql-database/sql-database-data-discovery-and-classification)
- [Оценка уязвимостей](/azure/sql-database/sql-vulnerability-assessment)  
- [Обнаружение угроз](/azure/sql-database/sql-database-threat-detection)

Отображая оповещения системы безопасности о подозрительных действиях, [Расширенная защита от угроз Azure для Базы данных Azure для PostgreSQL](/azure/postgresql/concepts-data-access-and-security-threat-protection) предоставляет дополнительный уровень защиты, позволяя клиентам определять и реагировать на потенциальные угрозы по мере возникновения. Пользователи получают оповещения о подозрительных действиях с базами данных, потенциальных уязвимостях и аномальных закономерностях в доступе к базам данных и шаблонам запросов. Расширенная защита от угроз для Базы данных Azure для PostgreSQL интегрирует оповещения с центром безопасности Azure. Ниже приведены типы оповещений.

- Доступ из незнакомого расположения.
- Доступ из стороннего центра обработки данных Azure. 
- Доступ из незнакомого субъекта. 
- Доступ из потенциально опасного приложения. 
- Подбор учетных данных Базы данных Azure для PostgreSQL. 

[Расширенная защита от угроз Azure для Базы данных Azure для MySQL](/azure/mysql/concepts-data-access-and-security-threat-protection) обеспечивает защиту, аналогичную Расширенную защиту для PostgreSQL.  

## <a name="centralized-security-management"></a>Централизованное управление защитой

[Центр безопасности Azure](https://azure.microsoft.com/documentation/services/security-center/) позволяет предотвращать, обнаруживать угрозы и реагировать на них. Он включает в себя встроенные функции мониторинга безопасности и управления политиками для подписок Azure. Он помогает обнаруживать угрозы, которые в противном случае могут остаться незамеченными, и работает с широким спектром решений по обеспечению безопасности.

[Центр безопасности](../../security-center/security-center-alerts-data-services.md) помогает защитить данные в базе данных SQL, обеспечивая представление безопасности всех серверов и баз данных. Ниже перечислены возможности центра безопасности:

- определение политик для шифрования и аудита базы данных SQL;
- мониторинг безопасности ресурсов базы данных SQL во всех ваших подписках;
- быстрое выявление и устранение проблем безопасности;
- интеграция оповещений об [обнаружении угроз для базы данных SQL Azure](/azure/sql-database/sql-database-threat-detection).

Центр безопасности поддерживает доступ на основе ролей.

## <a name="sql-information-protection"></a>SQL Information Protection

[SQL Information Protection](/azure/sql-database/sql-database-data-discovery-and-classification) автоматически обнаруживает и классифицирует потенциально конфиденциальные данные, предоставляет механизм работы с метками для постоянного маркирования конфиденциальных данных атрибутами классификации и предоставляет подробную панель мониторинга, на которой отображается состояние классификации базы данных.  

Кроме того, эта служба вычисляет результирующий набор конфиденциальности запросов SQL, чтобы запросы, которые извлекают конфиденциальные данные, можно было проверить явным образом и обеспечить защиту данных. Дополнительные сведения о политике SQL Information Protection см. в разделе "Обнаружение и классификация данных в службе "База данных SQL Azure"".

В центре безопасности Azure можно настроить [политики SQL Information Protection](/azure/security-center/security-center-info-protection-policy).

## <a name="azure-marketplace"></a>Azure Marketplace

Azure Marketplace — это интернет-магазин приложений и служб, который позволяет независимым поставщикам программного обеспечения (ISV) и разработчикам, чьи проекты находятся на начальном этапе развития, предлагать свои решения клиентам Azure по всему миру.
Azure Marketplace объединяет экосистемы партнеров Microsoft Azure в унифицированную платформу для повышения качества обслуживания клиентов и партнеров. Вы можете [выполнить поиск](https://azuremarketplace.microsoft.com/marketplace/apps?search=Database%20Security&page=1), чтобы просмотреть продукты безопасности базы данных, доступные в Azure Marketplace.

## <a name="next-steps"></a>Следующие шаги

- [Защита базы данных SQL Azure](/azure/sql-database/sql-database-security-tutorial)
- [Центр безопасности Azure и служба "База данных SQL Azure"](/azure/security-center/security-center-sql-database)
- [Обнаружение угроз для баз данных SQL](/azure/sql-database/sql-database-threat-detection)
- [Устранение проблем с производительностью и оптимизация базы данных](/azure/sql-database/sql-database-performance-tutorial)
