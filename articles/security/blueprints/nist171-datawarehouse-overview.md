---
title: Схема безопасности и соответствия требованиям Azure. Хранилище данных для NIST SP 800-171
description: Схема безопасности и соответствия требованиям Azure. Хранилище данных для NIST SP 800-171
services: security
author: jomolesk
ms.assetid: dbc9cafe-115d-4965-b0d4-fcf235a064c8
ms.service: security
ms.topic: article
ms.date: 07/31/2018
ms.author: jomolesk
ms.openlocfilehash: a1850ecfbb21eb9495bb0e6de362dc8dee3026a2
ms.sourcegitcommit: 3102f886aa962842303c8753fe8fa5324a52834a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "60609587"
---
# <a name="azure-security-and-compliance-blueprint---data-warehouse-for-nist-sp-800-171"></a>Схема безопасности и соответствия требованиям Azure. Хранилище данных для NIST SP 800-171

## <a name="overview"></a>Обзор
[Специальная публикация NIST 800-171](https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf) содержит рекомендации по защите контролируемой несекретной информации (CUI), которая находится в нефедеральных информационных системах и организациях. NIST SP 800-171 устанавливает 14 семейств требований безопасности для защиты конфиденциальности CUI.

Эта схема безопасности и соответствия требованиям Azure содержит руководство для помощи клиентам в развертывании архитектуры хранилища данных в Azure, которое реализует подмножество управления NIST SP 800-171. В этом решении демонстрируются способы, с помощью которых клиенты могут выполнять конкретные требования к безопасности и нормативные требования. Кроме того, оно служит основой, позволяющей клиентам создавать и настраивать собственные решения для хранилищ данных в Azure.

Эта эталонная архитектура, связанное руководство по реализации и модель рисков призваны служить основой, которую клиенты должны адаптировать для собственных потребностей. Их не следует использовать "как есть" в рабочей среде. Клиенты несут ответственность за выполнение надлежащей оценки безопасности и соответствия любого решения, созданного с использованием этой архитектуры. Требования могут варьироваться в зависимости от специфики реализации каждого клиента.

## <a name="architecture-diagram-and-components"></a>Схема и компоненты архитектуры
Это решение предоставляет эталонную архитектуру, которая необходима для реализации высокопроизводительного и безопасного облачного хранилища данных. В этой архитектуре есть два отдельных уровня данных. На одном уровне осуществляется импорт, хранение и промежуточное хранение данных в кластеризованной среде SQL. Другой уровень предназначен для хранилища данных SQL. Сюда данные загружаются с помощью инструмента извлечения, преобразования и загрузки (например, запросов T-SQL [PolyBase](https://docs.microsoft.com/azure/sql-data-warehouse/load-data-from-azure-blob-storage-using-polybase)) для обработки. После сохранения данных в Хранилище данных SQL можно выполнять аналитику в большом масштабе.

Azure предоставляет клиентам множество различных служб отчетности и аналитики. Это решение включает в себя службы SQL Server Reporting Services для быстрого создания отчетов из хранилища данных SQL. Весь трафик SQL шифруется с помощью SSL и самозаверяющих сертификатов. Мы рекомендуем использовать доверенный центр сертификации для повышенной безопасности.

Хранилище данных SQL Azure сохраняет данные в реляционных таблицах с хранением по столбцам. Этот формат значительно снижает затраты на хранение данных и одновременно повышает производительность запросов. В зависимости от требований потребления вычислительные ресурсы Хранилища данных SQL можно масштабировать или полностью отключать при отсутствии активных процессов, для которых они требуются.

Подсистема балансировки нагрузки SQL Server управляет трафиком SQL, обеспечивая высокую производительность. Все виртуальные машины в этой эталонной архитектуре развертываются в группе доступности с помощью экземпляров SQL Server, настроенных в группе доступности AlwaysOn. Такая конфигурация обеспечит высокий уровень доступности и аварийное восстановление.

Эта эталонная архитектура хранилища данных также включает уровень Active Directory, предназначенный для управления ресурсами в рамках архитектуры. Подсеть Active Directory обеспечивает простое внедрение в структуру крупного леса Active Directory. Это гарантирует непрерывную работу среды, даже если доступ к крупному лесу отсутствует. Все виртуальные машины присоединены к домену на уровне Active Directory. Они используют групповые политики Active Directory для применения конфигураций безопасности и соответствия на уровне операционной системы.

В решении используются учетные записи хранения Azure, в которых клиенты могут настроить использование Шифрования службы хранилища, чтобы обеспечить конфиденциальность неактивных данных. Azure хранит три копии данных в выбранном клиентом центре обработки данных для обеспечения устойчивости. Геоизбыточное хранилище гарантирует, что данные будут реплицированы в дополнительный центр обработки данных, который находится в сотнях километров, и снова сохранены в виде трех копий в этом центре обработки данных. Такой подход позволяет избежать потери данных в случае серьезных неполадок в основном центре обработки данных клиента.

Для повышения уровня безопасности все ресурсы в этом решении управляются как группа ресурсов с помощью Azure Resource Manager. Управление доступом на основе ролей Azure Active Directory используется для контроля доступа к развернутым ресурсам. В том числе к ключам в Azure Key Vault. Мониторинг работоспособности системы осуществляется через центр безопасности Azure и Azure Monitor. Клиенты могут настроить обе службы мониторинга для ведения журналов. Работоспособность системы отображается на единой панели мониторинга с удобной навигацией.

Виртуальная машина выступает управляющим узлом-бастионом. Узел-бастион предоставляет безопасное подключение для администраторов, позволяющее получить доступ к развернутым ресурсам. Данные загружаются в промежуточную область через этот управляющий узел-бастион. *Мы рекомендуем настроить подключение VPN или Azure ExpressRoute для управления и импорта данных в подсеть эталонной архитектуры.*

![Схема эталонной архитектуры хранилища данных для NIST SP 800-171](images/nist171-dw-architecture.png "Схема эталонной архитектуры хранилища данных для NIST SP 800-171")

Это решение использует следующие службы Azure. Дополнительные сведения см. в разделе [Архитектура развертывания](#deployment-architecture).

- Группы доступности
    - Контроллеры домена Active Directory
    - узлы кластера и следящий сервер SQL Server.
- Azure Active Directory
- Каталог данных Azure
- Хранилище Azure Key Vault
- Azure Monitor (журналы)
- Центр безопасности Azure
- Балансировщик нагрузки Azure
- Хранилище Azure
- Виртуальные машины Azure
    - (1) Узел-бастион
    - (2) контроллер домена Active Directory;
    - (2) узел кластера SQL Server;
    - (1) следящий сервер SQL Server.
- Виртуальная сеть Azure
    - (1) Сеть /16
    - (4) Сети /24
    - (4) Группы безопасности сети
- Хранилище служб восстановления
- Хранилище данных SQL
- службы SQL Server Reporting Services

## <a name="deployment-architecture"></a>Архитектура развертывания
В следующем разделе подробно описываются компоненты развертывания и реализации.

**Хранилище данных Azure SQL**: [Хранилище данных SQL](https://docs.microsoft.com/azure/sql-data-warehouse/sql-data-warehouse-overview-what-is) — это корпоративное хранилище данных, в котором используются преимущества расширенной параллельной обработки для быстрого выполнения сложных запросов на несколько петабайт данных. Пользователи могут применять простые запросы T-SQL PolyBase для импорта больших данных в хранилище данных SQL и задействовать возможности массовой параллельной обработки для выполнения высокопроизводительной аналитики.

**SQL Server Reporting Services**: [SQL Server Reporting Services](https://docs.microsoft.com/sql/reporting-services/report-data/sql-azure-connection-type-ssrs) предоставляет быстрого создания отчетов с помощью таблицы, диаграммы, карты, датчики, матрицы и более для хранилища данных SQL.

**Каталог данных Azure**. Благодаря [Каталогу данных Azure](https://docs.microsoft.com/azure/data-catalog/data-catalog-what-is-data-catalog) источники данных легко обнаруживаются и являются понятными для пользователей, которые управляют данными. Общие источники данных можно регистрировать, снабжать тегами и использовать для поиска данных. Эти данные остаются в существующем расположении, но копия соответствующих метаданных добавляется в Каталог данных вместе со ссылкой на расположение источника данных. Метаданные индексируются, чтобы облегчить обнаружение каждого источника данных с помощью функции поиска. Индексация также делает их понятными для пользователей.

**Узел-бастион**. Узел-бастион является единственной точкой входа, пользователи могут использовать для доступа к ресурсам, развернутых в этой среде. Узел-бастион предоставляет безопасное подключение к развернутым ресурсам, разрешая удаленный трафик только с общедоступных IP-адресов из надежного списка. Для разрешения трафика по протоколу удаленного рабочего стола источник трафика должен быть определен в группе безопасности сети.

Это решение создает виртуальную машину в виде присоединенного к домену узла-бастиона со следующими настройками:
-   [Расширение защиты от вредоносных программ](https://docs.microsoft.com/azure/security/azure-security-antimalware).
-   [Расширение системы диагностики Azure](https://docs.microsoft.com/azure/virtual-machines/virtual-machines-windows-extensions-diagnostics-template).
-   [Шифрование дисков Azure](https://docs.microsoft.com/azure/security/azure-security-disk-encryption) с помощью хранилища ключей Azure Key Vault.
-   [Политика автоматического завершения работы](https://azure.microsoft.com/blog/announcing-auto-shutdown-for-vms-using-azure-resource-manager/) для уменьшения степени потребления ресурсов виртуальной машины во время простоя.
-   Функция [Credential Guard в Защитнике Windows](https://docs.microsoft.com/windows/access-protection/credential-guard/credential-guard) должна быть включена, чтобы учетные данные и другие секретные сведения обрабатывались в защищенной среде, изолированной от работающей операционной системы.

### <a name="virtual-network"></a>Виртуальная сеть
Эта эталонная архитектура определяет частную виртуальную сеть с пространством адресов 10.0.0.0/16.

**Группы безопасности сети**. [Группы безопасности сети](https://docs.microsoft.com/azure/virtual-network/virtual-networks-nsg) (NSG) содержат списки управления доступом, которые разрешают или запрещают трафик в виртуальной сети. Группы безопасности сети можно использовать для защиты трафика на уровне отдельных виртуальных машин или подсети. Существуют следующие группы безопасности сети:
  - группа безопасности сети на уровне данных (кластеры SQL Server, следящий сервер SQL Server и подсистема балансировки нагрузки SQL);
  - группа безопасности сети для управляющего узла-бастиона;
  - группа безопасности сети для Active Directory;
  - группа безопасности сети для SQL Server Reporting Services.

В каждой NSG открыты определенные порты и протоколы, чтобы решение могло работать безопасно и правильно. Кроме того, для каждой NSG настроены следующие конфигурации:
  - включены [журналы диагностики и события](https://docs.microsoft.com/azure/virtual-network/virtual-network-nsg-manage-log), которые хранятся в учетной записи хранения;
  - Журналы Azure Monitor подключен к [диагностики NSG](https://github.com/krnese/AzureDeploy/blob/master/AzureMgmt/AzureMonitor/nsgWithDiagnostics.json).

**Подсети**. Каждая подсеть связана с соответствующей NSG.

### <a name="data-at-rest"></a>Неактивные данные
Архитектура защищает неактивные данные с помощью ряда мер. Эти меры включают шифрование и аудит баз данных.

**Служба хранилища Azure**. Для выполнения требований к шифрованию неактивных данных во всей [Службе хранилища](https://azure.microsoft.com/services/storage/) используется [Шифрование службы хранилища](https://docs.microsoft.com/azure/storage/storage-service-encryption). Эта функция помогает защищать и охранять данные в рамках корпоративных обязательств по безопасности и соответствия требованиям.

**Шифрование дисков Azure**. [Шифрование дисков](https://docs.microsoft.com/azure/security/azure-security-disk-encryption) использует возможность BitLocker Windows, чтобы обеспечить шифрование тома для операционной системы и дисков данных. Решение интегрируется с Key Vault, что помогает управлять ключами шифрования дисков.

**База данных SQL Azure**. В экземпляре базы данных SQL Azure используются следующие меры безопасности базы данных.
-   [Использование Active Directory для аутентификации и авторизации](https://docs.microsoft.com/azure/sql-database/sql-database-aad-authentication) обеспечивает централизованное управление удостоверениями для пользователей баз данных и других служб Майкрософт.
-   [Аудит Базы данных SQL](https://docs.microsoft.com/azure/sql-database/sql-database-auditing-get-started) позволяет отслеживать события базы данных и записывать их в журнал аудита в учетной записи хранения Azure.
-   База данных SQL настроена для использования [прозрачного шифрования данных](https://docs.microsoft.com/sql/relational-databases/security/encryption/transparent-data-encryption-azure-sql). Оно выполняет шифрование и дешифрование базы данных в реальном времени, связанных с ней резервных копий и файлов журнала транзакций для защиты неактивной информации. Прозрачное шифрование данных позволяет защитить сохраненные данные от несанкционированного доступа.
-   [Правила брандмауэра](https://docs.microsoft.com/azure/sql-database/sql-database-firewall-configure) предотвращают любой доступ к серверам баз данных без надлежащих разрешений. Брандмауэр предоставляет доступ к базам данным на основе исходного IP-адреса каждого запроса.
-   Система [обнаружения угроз SQL](https://docs.microsoft.com/azure/sql-database/sql-database-threat-detection-get-started) обеспечивает обнаружение потенциальных угроз по мере их возникновения и реагирование на них. Пользователи получают оповещения безопасности о подозрительных действиях с базами данных, потенциальных уязвимостях, атаках путем внедрения кода SQL и аномальных закономерностях в доступе к базам данных.
-   [Зашифрованные столбцы](https://docs.microsoft.com/azure/sql-database/sql-database-always-encrypted-azure-key-vault) гарантируют, что конфиденциальные данные никогда не отобразятся как открытый текст внутри системы баз данных. После включения шифрования данных получить доступ к данным в виде открытого текста смогут только клиентские приложения и серверы приложений, у которых есть доступ к ключам.
- [Расширенные свойства](https://docs.microsoft.com/sql/relational-databases/system-stored-procedures/sp-addextendedproperty-transact-sql) могут применяться для прекращения обработки субъектов данных. Пользователи могут добавлять настраиваемые свойства к объектам баз данных. Они также могут помечать данные как "Неподдерживаемые" для поддержки логики приложений, предотвращающей обработку связанных финансовых данных.
- [Безопасность на уровне строк](https://docs.microsoft.com/sql/relational-databases/security/row-level-security) позволяет пользователям определять политики для ограничения доступа к данным, чтобы прекращать их обработку.
- [Динамическое маскирование данных Базы данных SQL](https://docs.microsoft.com/azure/sql-database/sql-database-dynamic-data-masking-get-started) ограничивает возможность раскрытия конфиденциальных данных, маскируя их для непривилегированных пользователей или приложений. Эта функция может автоматически обнаруживать потенциально конфиденциальные данные и предлагать применение соответствующих масок. Динамическое маскирование данных помогает сократить доступ к конфиденциальным данным таким образом, чтобы они не извлекались из базы данных с помощью несанкционированного доступа. *Клиенты несут ответственность за настройку параметров в соответствии со своей схемой базы данных.*

### <a name="identity-management"></a>Управление удостоверениями
Следующие технологии обеспечивают возможности управления доступом к данным в среде Azure.
-   [Azure Active Directory](https://azure.microsoft.com/services/active-directory/) — это мультитенантный облачный каталог и служба управления удостоверениями корпорации Майкрософт. Все пользователи этого решения создаются в Azure Active Directory, включая пользователей, обращающихся к Базе данных SQL.
-   Аутентификация приложения выполняется с использованием Azure Active Directory. Дополнительные сведения см. в разделах, посвященных [интеграции приложений с Azure Active Directory](https://docs.microsoft.com/azure/active-directory/develop/active-directory-integrating-applications). Azure Active Directory используется при шифровании столбцов базы данных для аутентификации приложения в Базе данных SQL. Дополнительные сведения см. в статье о [защите конфиденциальных данных в Базе данных SQL](https://docs.microsoft.com/azure/sql-database/sql-database-always-encrypted-azure-key-vault).
-   [Azure RBAC](https://docs.microsoft.com/azure/active-directory/role-based-access-control-configure) может использоваться администраторами для определения детальных разрешений доступа. С помощью RBAC можно предоставлять пользователям доступ, необходимый только для выполнения поставленных перед ними задач. Вместо предоставления каждому пользователю неограниченного доступа на ресурсы Azure администраторы могут разрешить только определенные действия для доступа к ресурсам и данным. Доступ к подписке есть только у администратора подписки.
- [Azure Active Directory Privileged Identity Management](https://docs.microsoft.com/azure/active-directory/active-directory-privileged-identity-management-getting-started) позволяет клиентам свести к минимуму число пользователей, имеющих доступ к определенной информации, такой как данные. Администраторы могут использовать Azure AD Privileged Identity Management для обнаружения, ограничения и отслеживания привилегированных удостоверений, а также их доступа к ресурсам. Эту функцию можно также задействовать для получения административного JIT-доступа по требованию, когда это необходимо.
- [Защита идентификации Azure Active Directory](https://docs.microsoft.com/azure/active-directory/active-directory-identityprotection) определяет потенциальные уязвимости, влияющие на удостоверения организации. Она настраивает автоматическое реагирование на обнаруженные подозрительные действия, связанные с удостоверениями организации, а также исследует подозрительные инциденты для принятия соответствующих действий по их устранению.

### <a name="security"></a>Безопасность
**Управление секретами**. Для управления ключами и секретами в решении используется [Azure Key Vault](https://azure.microsoft.com/services/key-vault/). Key Vault помогает защитить криптографические ключи и секреты, используемые облачными приложениями и службами. Приведенные ниже возможности Key Vault помогают клиентам защитить данные.
- Политики расширенного доступа настраиваются по мере необходимости.
- Политики доступа к Key Vault определены с минимальными необходимыми разрешениями на использование ключей и секретов.
- Все ключи и секреты в Key Vault имеют срок действия.
- Все ключи в Key Vault защищены специализированными аппаратными модулями безопасности. Тип ключа — 2048-разрядный ключ RSA, защищенный аппаратным модулем безопасности.
- Всем пользователям и удостоверениям предоставляются минимальные необходимые разрешения с помощью RBAC.
- Для журналов диагностики хранилища ключей включен срок хранения не менее 365 дней.
- Допустимые операции шифрования для ключей доступны только тем пользователям, которым они нужны.

**Управление исправлениями**. Виртуальные машины Windows, развернутые как часть этой эталонной архитектуры настраиваются по умолчанию для получения автоматических обновлений из службы Центра обновления Windows. Это решение также включает службу [автоматизации Azure](https://docs.microsoft.com/azure/automation/automation-intro), с помощью которой при необходимости можно создавать обновленные развертывания для исправления виртуальных машин.

**Защита от вредоносных программ**. [Антивредоносное по Майкрософт](https://docs.microsoft.com/azure/security/azure-security-antimalware) для виртуальных машин обеспечивает возможность защиты в реальном времени, обнаружения и удаления вирусов, шпионских и других вредоносных программ. Пользователи могут настроить предупреждения, которые создаются при попытках установки или запуска известных вредоносных или нежелательных программ на защищенных виртуальных машинах.

**Центр безопасности Azure**. С помощью [Центра безопасности Azure](https://docs.microsoft.com/azure/security-center/security-center-intro) клиенты могут централизованно применять политики безопасности и управлять ими в рабочих нагрузках, ограничивать подверженность системы угрозам, а также выявлять атаки и реагировать на них. Центр безопасности также обращается к существующей конфигурации служб Azure и предоставляет конфигурацию и рекомендации по службам для повышения уровня безопасности и защиты данных.

В центре безопасности используются различные возможности обнаружения, чтобы оповещать клиентов о потенциальных атаках на их среды. Эти оповещения содержат важные сведения о причине их активации, ресурсах, на которые нацелена атака, и ее источнике. Центр безопасности имеет ряд [предопределенных оповещений безопасности](https://docs.microsoft.com/azure/security-center/security-center-alerts-type), которые активируются при возникновении угрозы или подозрительной активности. Пользователи могут использовать [настраиваемые правила генерации оповещений](https://docs.microsoft.com/azure/security-center/security-center-custom-alert) для определения новых оповещений безопасности на основе данных, собранных из их среды.

Центр безопасности предоставляет приоритетные оповещения безопасности и инциденты. Он упрощает для пользователей процедуры обнаружения и устранения потенциальных проблем безопасности. Для каждой обнаруженной угрозы создается [отчет об исследовании угроз](https://docs.microsoft.com/azure/security-center/security-center-threat-report). Команды реагирования на инциденты могут использовать эти отчеты при исследовании и устранении угроз.

Эта эталонная архитектура также использует функцию [оценки уязвимости](https://docs.microsoft.com/azure/security-center/security-center-vulnerability-assessment-recommendations) в центре безопасности. После настойки агент партнера (например, Qualys) начнет отправку сведений об уязвимостях на платформу управления партнера. которая, в свою очередь, возвращает данные мониторинга уязвимостей и работоспособности в центр безопасности. Клиенты могут использовать эти сведения, чтобы быстро определить уязвимые виртуальные машины.

### <a name="business-continuity"></a>Непрерывная работа
**Высокий уровень доступности**. Рабочие нагрузки сервера группируются в [доступности](https://docs.microsoft.com/azure/virtual-machines/virtual-machines-windows-manage-availability?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json) для обеспечения высокой доступности виртуальных машин в Azure. Во время планового или внепланового технического обслуживания доступна как минимум одна виртуальная машина, что соответствует Соглашению об уровне обслуживания Azure, гарантирующему доступность в течение 99,95 % времени.

**Хранилище служб восстановления**: [Хранилище служб восстановления](https://docs.microsoft.com/azure/backup/backup-azure-recovery-services-vault-overview) резервного копирования данных и защищает все конфигурации виртуальных машин в этой архитектуре. С помощью хранилища Служб восстановления клиенты могут восстановить отдельные файлы и папки виртуальной машины IaaS, а не всю виртуальную машину. Это сокращает время восстановления.

### <a name="logging-and-auditing"></a>Ведение журналов и аудит

Службы Azure обеспечивают детальную запись системных и пользовательских действий, а также сведений о работоспособности системы.
- **Журналы действий**. [Журналы действий](https://docs.microsoft.com/azure/monitoring-and-diagnostics/monitoring-overview-activity-logs) предоставляют информацию об операциях, которые выполнялись с ресурсами в подписке. Журналы действий помогают определить инициатора операции, время события и состояние.
- **Журналы диагностики**. [Журналы диагностики](https://docs.microsoft.com/azure/monitoring-and-diagnostics/monitoring-overview-of-diagnostic-logs) включают в себя все журналы, создаваемые ресурсами. К этим журналам относятся системные журналы событий Windows, журналы службы хранилища, журналы аудита Key Vault, а также журналы брандмауэра и доступа к Шлюзу приложений Azure. Все журналы диагностики обеспечивают запись данных в централизованную и зашифрованную учетную запись Azure для архивирования. Пользователи могут настроить срок хранения до 730 дней в соответствии с конкретными требованиями.

**Журналы Azure Monitor**. Эти журналы объединяются в [журналы Azure Monitor](https://azure.microsoft.com/services/log-analytics/) для обработки, хранения и создания отчетов информационной панели. Собранные данные объединяются в отдельные таблицы для каждого типа данных в рабочих областях Log Analytics. Таким образом, все данные могут анализироваться вместе независимо от исходного источника. Центр безопасности интегрируется с журналами Azure Monitor. Клиенты могут использовать запросов Kusto получить доступ к данным событий безопасности и использовать ее в сочетании с данными из других служб.

Следующие Azure [решения для мониторинга](https://docs.microsoft.com/azure/log-analytics/log-analytics-add-solutions) включены как часть этой архитектуры:
-   [Оценка Active Directory](https://docs.microsoft.com/azure/log-analytics/log-analytics-ad-assessment). Решение проверки работоспособности Active Directory оценивает риск и состояние серверной среды на регулярной основе. Это решение предоставляет приоритетный список рекомендаций, относящихся к развернутой серверной инфраструктуре.
- [Оценка SQL](https://docs.microsoft.com/azure/log-analytics/log-analytics-sql-assessment). Решение проверки работоспособности SQL оценивает риск и состояние серверной среды на регулярной основе. Это решение предоставляет пользователям приоритетный список рекомендаций, относящихся к развернутой серверной инфраструктуре.
- [Работоспособность агентов](https://docs.microsoft.com/azure/operations-management-suite/oms-solution-agenthealth). Решение агента работоспособности сообщает количество развернутых агентов и их географическое распределение. Оно также сообщает количество перестающих отвечать на запросы агентов и число агентов, которые отправляют операционные данные.
-   [Activity Log Analytics](https://docs.microsoft.com/azure/log-analytics/log-analytics-activity). Решение Azure Activity Log Analytics помогает анализировать журналы действий Azure во всех подписках Azure для клиента.

**Служба автоматизации Azure**. [Служба автоматизации Azure](https://docs.microsoft.com/azure/automation/automation-hybrid-runbook-worker) обеспечивает хранение и выполнение модулей runbook, а также управление ими. В этом решении модули runbook помогают собирать журналы из Базы данных SQL. Клиенты могут использовать решение [Отслеживание изменений](https://docs.microsoft.com/azure/automation/automation-change-tracking) службы автоматизации, чтобы легко определять изменения в среде.

**Azure Monitor**. [Azure Monitor](https://docs.microsoft.com/azure/monitoring-and-diagnostics/) помогает пользователям отслеживать производительность, обеспечивать безопасность и определять тенденции. Организации могут использовать эту службу для аудита, создания оповещений и архивирования данных. Они также могут отслеживать вызовы API в своих ресурсах Azure.

## <a name="threat-model"></a>Модель рисков

Схему потока данных для этой эталонной архитектуры можно [скачать](https://aka.ms/nist171-dw-tm) или просмотреть здесь. Используя эту модель, клиенты могут выявить зоны потенциального риска в инфраструктуре системы при внесении изменений.

![Модель угроз хранилища данных для NIST SP 800-171](images/nist171-dw-threat-model.png "Модель угроз хранилища данных для NIST SP 800-171")

## <a name="compliance-documentation"></a>Документация по соответствию
В документе [Схема безопасности и соответствия требованиям Azure. Таблица обязанностей клиента NIST SP 800-171](https://aka.ms/nist171-crm) указаны все принципы безопасности NIST SP 800-171. В этой таблице указано, кто отвечает за управление каждого принципа: корпорация Майкрософт, клиент или все вместе.

В документе [Схема безопасности и соответствия требованиям Azure. Таблица реализации управления хранилищем данных для NIST SP 800-171](https://aka.ms/nist171-dw-cim) содержатся сведения о том, какие элементы управления NIST SP 800-171 охватываются архитектурой хранилища данных. Документ содержит подробные описания того, как реализация соответствует требованиям каждого охваченного средства управления.

## <a name="guidance-and-recommendations"></a>Инструкции и рекомендации

### <a name="vpn-and-expressroute"></a>VPN и ExpressRoute
Чтобы установить защищенное подключение к ресурсам, которые развертываются в рамках этой эталонной архитектуры хранилища данных, необходимо настроить защищенный VPN-туннель или [ExpressRoute](https://docs.microsoft.com/azure/expressroute/expressroute-introduction). Правильно настроив VPN-подключение или ExpressRoute, клиенты могут добавить уровень защиты передаваемых данных.

При реализации защищенного VPN-туннеля с помощью Azure можно создать виртуальное частное подключение между локальной сетью и виртуальной сетью Azure. Это подключение осуществляется через Интернет. Клиенты могут использовать это соединение для безопасной передачи данных по "туннелю" внутри зашифрованного канала между сетью клиента и Azure. VPN типа "сеть — сеть" представляет собой безопасную проверенную технологию, которая десятилетиями применяется на предприятиях всех размеров. [Режим туннеля IPsec](https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2003/cc786385(v=ws.10)) используется в этом решении как механизм шифрования.

Так как трафик в VPN-туннеле проходит через Интернет с VPN типа "сеть — сеть", корпорация Майкрософт предлагает другой, еще более защищенный вариант подключения. ExpressRoute — это выделенный канал связи в глобальной сети между Azure и локальной средой или поставщиком услуг размещения Exchange. Подключения ExpressRoute устанавливаются напрямую к поставщику услуг связи клиента. Таким образом, данные не проходят через Интернет и недоступны через него. Такие подключения отличаются повышенной надежностью, более высокой скоростью, меньшей задержкой и дополнительной безопасностью по сравнению с обычными подключениями.

См. [рекомендации](https://docs.microsoft.com/azure/architecture/reference-architectures/dmz/secure-vnet-hybrid) по реализации защищенной гибридной сети, расширяющей локальную сеть в Azure.

### <a name="extract-transform-load-process"></a>Процесс извлечения, преобразования и загрузки
[PolyBase](https://docs.microsoft.com/sql/relational-databases/polybase/polybase-guide) может загружать данные в Хранилище данных SQL без использования отдельного инструмента для извлечения, преобразования и загрузки или импорта. PolyBase поддерживает доступ к данным с помощью запросов T-SQL. С PolyBase можно использовать бизнес-аналитику и стек аналитики Майкрософт, а также сторонние инструменты, совместимые с SQL Server.

### <a name="azure-ad-setup"></a>Установка Azure AD
Служба [Azure Active Directory](https://docs.microsoft.com/azure/active-directory/active-directory-whatis) играет важную роль в управлении развертыванием и подготовкой доступа для персонала, взаимодействующего со средой. Локальную службу Active Directory можно интегрировать с Azure Active Directory [с помощью четырех простых действий](https://docs.microsoft.com/azure/active-directory/connect/active-directory-aadconnect-get-started-express). Клиенты также могут привязать развернутую инфраструктуру Active Directory (контроллеры домена) к Azure Active Directory. Чтобы сделать это, сделайте развернутую инфраструктуру Active Directory дочерним доменом леса Azure Active Directory.

### <a name="optional-services"></a>Дополнительные службы
Azure предлагает широкий набор служб для помощи в хранении и промежуточной обработке форматированных и неформатированных данных. В зависимости от требований клиента в эталонную архитектуру можно добавить следующие службы:
-   [Фабрика данных Azure](https://docs.microsoft.com/azure/data-factory/introduction) — это управляемая облачная служба, созданная для сложных гибридных проектов извлечения, преобразования и загрузки, а также интеграции данных. Фабрика данных обладает возможностями, помогающими отслеживать и находить данные. Инструменты визуализации и мониторинга определяют время поступления данных и их источник. Пользователи могут создавать и включать в расписание управляемые данными рабочие процессы (конвейеры), которые принимают данные из разнородных хранилищ данных. Они могут использовать эти конвейеры, чтобы принимать данные из внутренних и внешних источников. Затем клиенты могут обрабатывать данные и преобразовывать их для вывода в хранилища данных, такие как Хранилище данных SQL.
- На промежуточном этапе клиенты могут направлять неструктурированные данные в [Azure Data Lake Store](https://docs.microsoft.com/azure/data-lake-store/data-lake-store-overview), чтобы централизованно сохранять данные любого размера, любого типа и с любой скоростью приема для эксплуатационной и исследовательской аналитики. Azure Data Lake обладает возможностями, обеспечивающими извлечение и преобразование данных. Служба Data Lake Store совместима с большинством компонентов с открытым кодом в экосистеме Hadoop. Также она хорошо интегрируется с другими службами Azure, например Хранилищем данных SQL.

## <a name="disclaimer"></a>Заявление об отказе

 - Этот документ является исключительно информационным. МАЙКРОСОФТ НЕ ПРЕДОСТАВЛЯЕТ НИКАКИХ ГАРАНТИЙ, ЯВНЫХ, КОСВЕННЫХ ИЛИ ПРЕДУСМОТРЕННЫХ ЗАКОНОМ, В ОТНОШЕНИИ ИНФОРМАЦИИ В ЭТОМ ДОКУМЕНТЕ. Данный документ предоставляется "как есть". Сведения и мнения, представленные в данном документе, включая URL-адреса и ссылки на другие веб-сайты, могут быть изменены без предварительного уведомления. Клиенты, читающие этот документ, берут ответственность за его использование на себя.
 - Настоящий документ не предоставляет клиентам юридических прав на интеллектуальную собственность в отношении продуктов или решений корпорации Майкрософт.
 - Клиенты могут скопировать и использовать данный документ для внутренних справочных целей.
 - Выполнение некоторых рекомендаций в этом документе может привести к более интенсивному использованию данных, а также сетевых и вычислительных ресурсов в Azure, а значит и к дополнительным затратам на лицензии или подписки Azure.
 - Эта архитектура призвана служить основой, которую клиенты должны адаптировать для конкретных требований, и не должна использоваться "как есть" в рабочей среде.
 - Этот документ разработан в качестве справочного материала и не определяет все способы, с помощью которых клиент может отвечать нормам и стандартам соответствия. Клиентам следует обратиться в юридический отдел своей организации, чтобы получить одобренные варианты пользовательских реализаций.
