---
title: Высокая доступность и аварийное восстановление
description: Узнайте, как разработать приложение пакетной службы при региональном простое.
ms.topic: how-to
ms.date: 01/29/2019
ms.openlocfilehash: c77e6fa672d26545af47b262a982a7d0d7303eec
ms.sourcegitcommit: 1b47921ae4298e7992c856b82cb8263470e9e6f9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/14/2020
ms.locfileid: "92058018"
---
# <a name="design-your-application-for-high-availability"></a>Обеспечение высокого уровня доступности при проектировании приложения

Пакетная служба Azure является региональной службой. Пакетная служба доступна во всех регионах Azure, но при создании учетной записи пакетной службы ее необходимо связать с регионом. Все операции для учетной записи пакетной службы затем применяются к этому региону. Например, пулы и связанные виртуальные машины создаются в том же регионе, что и учетная запись пакетной службы.

При разработке приложения, использующего пакетную службу, необходимо учитывать возможность недоступности пакетной службы в регионе. Возможны ситуации, когда существует проблема с регионом в целом, всей пакетной службой в регионе или с вашей конкретной учетной записью пакетной службы.

Чтобы приложение или решение, использующее пакетную службу, всегда было доступным, его необходимо спроектировать так, чтобы оно либо переключалось на другой регион, либо всегда распределяло рабочую нагрузку между двумя или более регионами. Для обоих подходов требуется как минимум две учетные записи пакетной службы, причем каждая учетная запись расположена в своем регионе.

## <a name="multiple-batch-accounts-in-multiple-regions"></a>Несколько учетных записей пакетной службы в нескольких регионах

Использование нескольких учетных записей пакетной службы в разных регионах позволяет вашему приложению продолжать работу, если учетная запись пакетной службы в другом регионе становится недоступной. Использование нескольких учетных записей особенно важно, чтобы ваше приложение было высокодоступным.

В некоторых случаях приложение можно спроектировать так, чтобы всегда использовать два или несколько регионов. Например, когда вам требуется значительный объем емкости, использование нескольких регионов может понадобиться для обработки либо крупномасштабного приложения, либо для удовлетворения будущего роста.

## <a name="design-considerations-for-providing-failover"></a>Рекомендации по проектированию для обеспечения отработки отказа

Ключевой момент, который следует учитывать при предоставлении возможности переключения при сбое в альтернативный регион, заключается в том, что необходимо учитывать все компоненты в решении; недостаточно просто иметь вторую учетную запись пакетной службы. Например, в большинстве приложений пакетной службы требуется учетная запись хранения Azure, а учетная запись хранения и учетная запись пакетной службы должны находиться в одном регионе для обеспечения приемлемой производительности.

При разработке решения, способного обеспечить отработку отказа, необходимо учитывать следующее.

- Предварительно создайте все необходимые учетные записи в каждом регионе, например учетную запись пакетной службы и учетную запись хранения. За создание учетных записей часто не взимается плата, только когда хранятся данные или используется учетная запись.
- Убедитесь, что квоты установлены для учетных записей заранее, чтобы вы могли выделить необходимое количество ядер с помощью учетной записи пакетной службы.
- Используйте шаблоны и (или) сценарии для автоматизации развертывания приложения в регионе.
- Постоянно обновляйте двоичные файлы приложения и эталонные данные во всех регионах. Постоянное обновление позволит быстро подключить регион к сети, не дожидаясь загрузки и развертывания файлов. Например, если пользовательское приложение хранится для установки на узлах пула и на него ссылаются с помощью приложений пакетной службы, то при создании новой версии приложения его необходимо загрузить на каждую учетную запись пакетной службы и на него должна ссылаться конфигурация пула (или необходимо сделать новую версию по умолчанию).
- В приложении, вызывающем пакетные службы, хранилище и любых других службах можно легко переключать клиентов или загружать данные в другой регион.
- Наилучшим способом обеспечения успешного переключения при сбое является частое переключение на альтернативный регион в рамках нормальной работы. Например, при двух развертываниях в отдельных регионах переключайтесь на альтернативный регион каждый месяц.

## <a name="next-steps"></a>Дальнейшие действия

- Дополнительные сведения см. в статьях [Создание учетной записи пакетной службы на портале Azure](batch-account-create-portal.md), [Примеры использования Azure CLI для пакетной службы Azure](./scripts/batch-cli-sample-create-account.md), [Управление ресурсами пакетной службы с помощью командлетов PowerShell](batch-powershell-cmdlets-get-started.md) или [Управление учетными записями и квотами пакетной службы с помощью клиентской библиотеки .NET для управления пакетной службой](batch-management-dotnet.md).
- Квоты по умолчанию связаны с учетной записью пакетной службы. В [этой статье](batch-quota-limit.md) подробно описываются значения квот по умолчанию и то, как их можно увеличить.
