---
title: Анализ затрат и бюджет — Пакетная служба Azure
description: Узнайте, как получить анализ затрат и задать бюджет для базовых ресурсов вычислений и лицензий на программное обеспечение, используемых для выполнения рабочих нагрузок пакетной службы.
services: batch
author: LauraBrenner
manager: evansma
ms.service: batch
ms.topic: article
ms.tgt_pltfrm: vm-windows
ms.workload: big-compute
ms.date: 07/19/2019
ms.author: labrenne
ms.openlocfilehash: 819b5e16f4730e9a1998234288e181772f7c1996
ms.sourcegitcommit: 21e33a0f3fda25c91e7670666c601ae3d422fb9c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/05/2020
ms.locfileid: "77022721"
---
# <a name="cost-analysis-and-budgets-for-azure-batch"></a>Анализ затрат и бюджеты для пакетной службы Azure

Плата за пакетную службу Azure не взимается, только базовые ресурсы вычислений и лицензии на программное обеспечение, используемые для выполнения пакетных рабочих нагрузок. На высоком уровне стоимость взимается из виртуальных машин в пуле, передает данные из виртуальной машины или любые входные или выходные данные, хранящиеся в облаке. Рассмотрим некоторые ключевые компоненты пакетной службы, чтобы понять, откуда берутся затраты, как задать бюджет для пула или учетной записи, а также некоторые методы повышения эффективности рабочих нагрузок пакета.

## <a name="batch-resources"></a>Ресурсы пакетной службы

Виртуальные машины — это наиболее важный ресурс, используемый для пакетной обработки. Стоимость использования виртуальных машин для пакетной службы вычисляется на основе типа, количества и продолжительности использования. Варианты выставления счетов за виртуальную машину включают [оплату по мере](https://azure.microsoft.com/offers/ms-azr-0003p/) использования или [резервирование](../cost-management-billing/reservations/save-compute-costs-reservations.md) (Предварительная оплата). Оба варианта оплаты имеют разные преимущества в зависимости от рабочей нагрузки, и обе модели оплаты будут повлиять на счет по-разному.

При развертывании приложений на узлах пакетной службы (ВМ) с помощью [пакетов приложений](batch-application-packages.md)выставляются счета за ресурсы службы хранилища Azure, используемые пакетами приложений. Кроме того, выставляются счета за хранение любых входных или выходных файлов, таких как файлы ресурсов и другие данные журнала. Как правило, стоимость данных хранилища, связанных с пакетной службой, значительно ниже, чем стоимость ресурсов вычислений. Каждая виртуальная машина в пуле, созданная с помощью **VirtualMachineConfiguration** , имеет связанный диск ОС, использующий диски, управляемые Azure. Диски, управляемые Azure, имеют дополнительную стоимость, и другие уровни производительности диска также имеют разные затраты.

Пулы пакетной службы используют сетевые ресурсы. В частности, для пулов **VirtualMachineConfiguration** используются стандартные подсистемы балансировки нагрузки, для которых требуются статические IP-адреса. Подсистемы балансировки нагрузки, используемые пакетом, видимы для учетных записей **подписки пользователя** , но не отображаются для учетных записей **пакетной службы** . Плата за стандартные подсистемы балансировки нагрузки взимается за все данные, передаваемые в виртуальные машины пула пакетной службы и из нее. Выберите API пакетной службы, которые извлекают данные из узлов пула (например, получение файла задачи или узла), пакеты приложений задач, файлы ресурсов и выходных данных, а также образы контейнеров, которые будут взиматься.

### <a name="additional-services"></a>Дополнительные службы

Службы, не включающие виртуальные машины и хранилище, могут поднестися к стоимости учетной записи пакета.

Другие службы, обычно используемые с пакетной службой, могут включать:

- Application Insights
- Фабрика данных
- Azure Monitor
- Виртуальная сеть
- Виртуальные машины с графическими приложениями

В зависимости от служб, используемых в решении пакетной службы, может взиматься дополнительная плата. Чтобы определить стоимость каждой дополнительной службы, обратитесь к [калькулятору цен](https://azure.microsoft.com/pricing/calculator/) .

## <a name="cost-analysis-and-budget-for-a-pool"></a>Анализ затрат и бюджет для пула

С помощью портал Azure вы можете создавать бюджеты и тратить предупреждения для пулов или учетной записи пакетной службы. Бюджеты и оповещения полезны для уведомления заинтересованных лиц о любых рисках чрезмерной траты. Может возникнуть задержка при расходе предупреждений и немного превысить бюджет. В этом примере мы продемонстрируем анализ затрат для отдельного пула пакетной службы.

1. В портал Azure выберите **Управление затратами + выставление счетов** на панели навигации слева.
1. Выберите подписку в разделе " **Мои подписки** ".
1. Перейдите к **анализу затрат** в разделе " **Управление затратами** " левой панели навигации, в котором будет показано такое представление:
1. Выберите **Добавить фильтр**. В первом раскрывающемся списке выберите **ресурс** ![выберите фильтр ресурсов](./media/batch-budget/resource-filter.png)
1. Во втором раскрывающемся списке выберите пул пакетной службы. При выборе пула анализ затрат будет выглядеть примерно так, как в следующем анализе.
    ![анализ затрат для пула](./media/batch-budget/pool-cost-analysis.png)

В результате анализа затрат отображается стоимость пула, а также ресурсы, влияющие на эту стоимость. В этом примере виртуальные машины, используемые в пуле, являются наиболее дорогостоящим ресурсом.

Чтобы создать бюджет для пула, выберите **бюджет: нет**, а затем выберите **создать новый бюджет >** . Теперь используйте окно для настройки бюджета, специально предназначенного для пула.

Дополнительные сведения о настройке бюджета см. в статье [создание бюджетов Azure и управление ими](../cost-management-billing/costs/tutorial-acm-create-budgets.md).

> [!NOTE]
> Пакетная служба Azure основана на технологии виртуальных машин Azure и облачных служб Azure. При выборе **конфигурации облачных служб**плата выставляются на основе структуры ценообразования облачных служб. При выборе **конфигурации виртуальной машины**плата насчитывается на основе структуры ценообразования виртуальных машин. В примере на этой странице используется **Конфигурация виртуальной машины**.

## <a name="minimize-cost"></a>Снижение затрат

Использование нескольких виртуальных машин и служб Azure в течение продолжительного периода времени может быть дорогостоящим. К счастью, существуют службы, помогающие снизить затраты, а также стратегии увеличения эффективности рабочей нагрузки.

### <a name="low-priority-virtual-machines"></a>Виртуальные машины с низким приоритетом

Виртуальные машины с низким приоритетом снижают затраты на рабочие нагрузки пакетной службы, используя преимущества избыточных вычислительных ресурсов в Azure. При указании виртуальных машин с низким приоритетом в пулах Пакетная обработка использует этот излишек для выполнения рабочей нагрузки. При использовании виртуальных машин с низким приоритетом на месте выделенных виртуальных машин сохраняется существенная стоимость.

Дополнительные сведения о настройке виртуальных машин с низким приоритетом для рабочей нагрузки см. в статье [Использование виртуальных машин с низким приоритетом с пакетной службой](batch-low-pri-vms.md).

### <a name="virtual-machine-os-disk-type"></a>Тип диска ОС виртуальной машины

Существует несколько [типов дисков ОС виртуальной машины](../virtual-machines/windows/disks-types.md). Большинство серий виртуальных машин имеют размеры, поддерживающие хранилище уровня "Премиум" и "Стандартный". Если для пула выбран размер виртуальной машины, пакетная Настройка дисков с ОС SSD класса Premium. При выборе размера виртуальной машины "не-s" используется более дешевый тип диска "Стандартный HDD". Например, диски ТВЕРДОТЕЛЬной ОС уровня "Премиум" используются для `Standard_D2s_v3` и диски с ОС стандартного жесткого диска используются для `Standard_D2_v3`.

SSD (цен. категория "Премиум") диски ОС более дороги, но они имеют более высокую производительность, а виртуальные машины с дисками уровня "Премиум" могут запускаться немного быстрее, чем виртуальные машины с дисковыми накопителями Standard HDD. При использовании пакетной службы диск ОС часто не используется, так как приложения и файлы задач расположены на временном НАКОПИТЕЛе виртуальных машин. Поэтому во многих случаях нет необходимости платить за увеличенные затраты на твердотельный SSD уровня "Премиум", подготовленный при указании размера виртуальной машины.

### <a name="reserved-virtual-machine-instances"></a>Зарезервированные экземпляры виртуальных машин

Если вы планируете использовать пакет в течение длительного периода времени, вы можете сэкономить на стоимости виртуальных машин, используя [резервирование Azure](../cost-management-billing/reservations/save-compute-costs-reservations.md) для рабочих нагрузок. Ставка резервирования значительно ниже, чем ставка с оплатой по мере использования. Для экземпляров виртуальных машин, используемых без резервирования, взимается оплата по мере использования. Если вы приобретаете резервирование, применяется скидка на резервирование и вы не оплачиваете оплату по мере использования.

### <a name="automatic-scaling"></a>Автоматическое масштабирование

[Автоматическое масштабирование](batch-automatic-scaling.md) динамически масштабирует количество виртуальных машин в пуле пакетной службы в зависимости от требований текущего задания. При масштабировании пула на основе времени существования задания автоматическое масштабирование гарантирует, что виртуальные машины масштабируются и используются только при выполнении задания. После завершения задания или отсутствия заданий виртуальные машины автоматически масштабируются для сохранения ресурсов вычислений. Масштабирование позволяет снизить общую стоимость решения пакетной службы, используя только необходимые ресурсы.

Дополнительные сведения об автоматическом масштабировании см. [в статье Автоматическое масштабирование вычислений узлов в пуле пакетной службы Azure](batch-automatic-scaling.md).

## <a name="next-steps"></a>Дальнейшие действия

- Узнайте больше о [API-интерфейсах и средствах пакетной](batch-apis-tools.md) службы, доступных для создания и мониторинга решений пакетной службы.  

- Узнайте о [виртуальных машинах с низким приоритетом с помощью пакетной](batch-low-pri-vms.md)службы.
