---
title: Проверка на наличие ошибок заданий и задач
description: Ошибки для проверки и устранения неполадок заданий и задач
author: mscurrell
ms.topic: article
ms.date: 03/10/2019
ms.author: markscu
ms.openlocfilehash: 0c58bdf50f3e69b2b7d18f750f94fecdb512af85
ms.sourcegitcommit: f7d057377d2b1b8ee698579af151bcc0884b32b4
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/24/2020
ms.locfileid: "82116032"
---
# <a name="job-and-task-error-checking"></a>Проверка ошибок заданий и задач

Существуют различные ошибки, которые могут возникнуть при добавлении заданий и задач. Обнаружение сбоев для этих операций является простым, так как все сбои возвращаются API, интерфейсом командной строки или интерфейсом пользователя.  Однако существуют сбои, которые могут произойти позже, когда задания и задачи планируются и выполняются.

В этой статье рассматриваются ошибки, которые могут возникнуть после отправки заданий и задач. В нем перечисляются и объясняются ошибки, которые необходимо проверить и обработать.

## <a name="jobs"></a>Задания

Задание — это группирование одной или нескольких задач. задачи фактически указывают командные строки для выполнения.

При добавлении задания можно указать следующие параметры, которые могут влиять на то, как может произойти сбой задания.

- [Ограничения задания](https://docs.microsoft.com/rest/api/batchservice/job/add#jobconstraints)
  - Кроме `maxWallClockTime` того, можно указать свойство, чтобы задать максимальное количество времени, в течение которого задание может быть активным или работающим. Если превышено, задание будет завершено `terminateReason` свойством, заданным в [executionInfo](https://docs.microsoft.com/rest/api/batchservice/job/get#cloudjob) для задания.
- [Задача подготовки задания](https://docs.microsoft.com/rest/api/batchservice/job/add#jobpreparationtask)
  - Если указано, задача подготовки задания выполняется при первом запуске задачи на узле. Задача подготовки задания может завершиться ошибкой, что приведет к невыполнению задачи, а задание не будет завершено.
- [Задача выпуска задания](https://docs.microsoft.com/rest/api/batchservice/job/add#jobreleasetask)
  - Задачу снятия задания можно указать только в том случае, если настроена задача подготовки задания. При завершении задания задание выпуска задания выполняется на каждом узле пула, где выполнялась задача подготовки задания. Задача выпуска задания может завершиться ошибкой, но задание по-прежнему будет перемещено в `completed` состояние.

### <a name="job-properties"></a>Свойства задания

Следующие свойства задания должны проверяться на наличие ошибок:

- "[executionInfo](https://docs.microsoft.com/rest/api/batchservice/job/get#jobexecutioninformation)":
  - `terminateReason` Свойство может иметь значения, указывающие, что `maxWallClockTime`значение, указанное в ограничениях задания, было превышено, и поэтому задание было завершено. Его также можно задать, чтобы указать, что задача завершилась ошибкой `onTaskFailure` , если свойство задания было задано соответствующим образом.
  - Свойство [счедулинжеррор](https://docs.microsoft.com/rest/api/batchservice/job/get#jobschedulingerror) устанавливается при возникновении ошибки планирования.
 
### <a name="job-preparation-tasks"></a>Задачи подготовки задания

Если для задания задана задача подготовки задания, то экземпляр этой задачи будет выполняться при первом запуске задачи для этого задания на узле. Задачу подготовки задания, настроенную в задании, можно рассматривать как шаблон задачи, при этом выполняется несколько экземпляров задач подготовки заданий, вплоть до количества узлов в пуле.

Экземпляры задачи подготовки задания должны быть проверены на наличие ошибок.
- При выполнении задачи подготовки задания будет перемещена задача, вызвавшая задачу подготовки задания, в [состояние](https://docs.microsoft.com/rest/api/batchservice/task/get#taskstate) `preparing`. Если задача подготовки задания завершается неудачно, задача, вызывающая срабатывание `active` , вернется к состоянию и не будет выполняться.  
- Все экземпляры задачи подготовки задания, которые были запущены, можно получить из задания, используя API [подготовки списка и задачи выпуска](https://docs.microsoft.com/rest/api/batchservice/job/listpreparationandreleasetaskstatus) . Как и в случае с любой задачей, доступны [сведения о выполнении](https://docs.microsoft.com/rest/api/batchservice/job/listpreparationandreleasetaskstatus#jobpreparationandreleasetaskexecutioninformation) со свойствами `failureInfo`, `exitCode`такими как `result`, и.
- Если задачи подготовки задания завершаются неудачно, то задачи, запускающющие задание, не будут выполняться, задание не будет завершено и будет задержано. Пул может не использоваться, если нет других заданий с задачами, которые можно запланировать.

### <a name="job-release-tasks"></a>Задачи выпуска задания

Если для задания задано задание выпуска задания, то при завершении задания на каждом из узлов пула, где выполнялась задача подготовки задания, выполняется экземпляр задачи выпуска задания.  Экземпляры задачи "выпуск задания" должны быть проверены на наличие ошибок.
- Все экземпляры выполняемой задачи выпуска задания можно получить из задания с помощью функции [подготовки списка API и состояния задачи выпуска](https://docs.microsoft.com/rest/api/batchservice/job/listpreparationandreleasetaskstatus). Как и в случае с любой задачей, доступны [сведения о выполнении](https://docs.microsoft.com/rest/api/batchservice/job/listpreparationandreleasetaskstatus#jobpreparationandreleasetaskexecutioninformation) со свойствами `failureInfo`, `exitCode`такими как `result`, и.
- Если одна или несколько задач выпуска задания завершаются сбоем, задание по-прежнему будет завершено и переходить `completed` в состояние.

## <a name="tasks"></a>Задания

Задачи заданий могут завершаться сбоем по нескольким причинам:

- Командная строка задачи завершается неудачно, возвращая с ненулевым кодом выхода.
- Для задачи `resourceFiles` указано, но произошла ошибка, из-за которой не удалось загрузить один или несколько файлов.
- Для задачи `outputFiles` задано значение, но произошла ошибка, которая означала, что один или несколько файлов не были отправлены.
- Превышено затраченное время для задачи, заданное `maxWallClockTime` свойством в [ограничениях](https://docs.microsoft.com/rest/api/batchservice/task/add#taskconstraints)задачи.

Во всех случаях необходимо проверить следующие свойства на наличие ошибок и сведений об ошибках.
- Свойство Tasks [executionInfo](https://docs.microsoft.com/rest/api/batchservice/task/get#taskexecutioninformation) содержит несколько свойств, которые предоставляют сведения об ошибке. [результат](https://docs.microsoft.com/rest/api/batchservice/task/get#taskexecutionresult) указывает, завершилась ли задача по какой либо причине `exitCode` неудачно, и `failureInfo` предоставляет дополнительные сведения о сбое.
- Задача всегда переходит в `completed` [состояние](https://docs.microsoft.com/rest/api/batchservice/task/get#taskstate)независимо от успешности ее выполнения или сбоя.

Влияние сбоев задач на задание и всех зависимостей задач должно быть рассмотрено.  Свойство [екситкондитионс](https://docs.microsoft.com/rest/api/batchservice/task/add#exitconditions) можно указать для задачи, чтобы настроить действие для зависимостей и для задания.
- Для зависимостей [DependencyAction](https://docs.microsoft.com/rest/api/batchservice/task/add#dependencyaction) определяет, блокируются или выполняются задачи, зависящие от невыполненной задачи.
- Для задания [жобактион](https://docs.microsoft.com/rest/api/batchservice/task/add#jobaction) определяет, будет ли невыполненная задача приводить к отключению, завершению или оставлению неизмененного задания.

### <a name="task-command-line-failures"></a>Сбои командной строки задачи

При выполнении командной строки задачи выходные данные записываются в `stderr.txt` и. `stdout.txt` Кроме того, приложение может выполнять запись в файлы журналов, относящиеся к приложению.

Если узел пула, на котором выполняется задача, все еще существует, то файлы журнала можно получить и просмотреть. Например, портал Azure список и может просматривать файлы журнала для задачи или узла пула. Несколько интерфейсов API также позволяют получать и получать список файлов задач, например [получить из задачи](https://docs.microsoft.com/rest/api/batchservice/file/getfromtask).

Так как пулы и узлы пула часто являются временными, при этом узлы постоянно добавляются и удаляются, поэтому рекомендуется сохранять файлы журналов. [Выходные файлы задач](https://docs.microsoft.com/azure/batch/batch-task-output-files) — это удобный способ сохранения файлов журнала в службе хранилища Azure.

### <a name="output-file-failures"></a>Ошибки выходного файла
В каждом сеансе передачи файла пакетная служба записывает в вычислительный узел два файла журнала: `fileuploadout.txt` и `fileuploaderr.txt`. Для получения дополнительных сведений о конкретной ошибке можно проанализировать файлы журнала. В случаях, когда передача файла никогда не выполнялась, например из-за невозможности выполнения задачи, эти файлы журналов не будут существовать.  

## <a name="next-steps"></a>Дальнейшие шаги

Убедитесь, что приложение реализует комплексную проверку ошибок. для немедленного обнаружения и диагностики проблем может быть очень важно.
