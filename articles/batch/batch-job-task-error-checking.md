---
title: Проверка на наличие ошибок в работе и задачах - Azure Batch Документы Майкрософт
description: Ошибки для проверки и устранения неполадок и задач
services: batch
author: mscurrell
ms.service: batch
ms.topic: article
ms.date: 03/10/2019
ms.author: markscu
ms.openlocfilehash: 4ace0de6d252680eb64990277b9478adf752f54d
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "79087001"
---
# <a name="job-and-task-error-checking"></a>Проверка ошибок и ошибок выполнения задач

Существуют различные ошибки, которые могут возникнуть при добавлении заданий и задач. Обнаружение сбоев для этих операций является простым, поскольку любые сбои немедленно возвращаются API, CLI или UI.  Однако есть сбои, которые могут произойти позже, когда задания и задачи запланированы и выполняются.

В этой статье рассматриваются ошибки, которые могут возникнуть после отправки заданий и задач. Он перечисляет и объясняет ошибки, которые необходимо проверить и обрабатывать.

## <a name="jobs"></a>Задания

Задание — это группировка одной или нескольких задач, задач, фактически определяющих задачи выполнения командных строк.

При добавлении задания могут быть указаны следующие параметры, которые могут повлиять на то, как задание может выполнить неудачу:

- [Ограничения задания](https://docs.microsoft.com/rest/api/batchservice/job/add#jobconstraints)
  - Свойство `maxWallClockTime` может быть дополнительно указано, чтобы установить максимальное количество времени, в течение которого задание может быть активным или запущенным. В случае превышения задание будет `terminateReason` прекращено с свойством, установленным в [исполненииInfo](https://docs.microsoft.com/rest/api/batchservice/job/get#cloudjob) для задания.
- [Задание по подготовке к работе](https://docs.microsoft.com/rest/api/batchservice/job/add#jobpreparationtask)
  - При указании задача подготовки к заданию выполнить первый раз, когда задача заранее выполнена для задания на узлах. Задание по подготовке к заданию может выйти из строя, что приведет к тому, что задача не будет выполнена, а задание не выполнено.
- [Задание по освобождению рабочих мест](https://docs.microsoft.com/rest/api/batchservice/job/add#jobreleasetask)
  - Задача выпуска заданий может быть определена только в том случае, если настроена задача подготовки к заданию. При завершении выполнения задачи по выпуску задания на каждом из узлов пуля, где была выполнена задача подготовки к заданиям, выполнить задачу завершения задания. Задача высвобождения задания может выйти `completed` из строя, но задание все равно перейдет в состояние.

### <a name="job-properties"></a>Свойства задания

Следующие свойства задания должны быть проверены на наличие ошибок:

- '[executionInfo](https://docs.microsoft.com/rest/api/batchservice/job/get#jobexecutioninformation)':
  - Свойство `terminateReason` может иметь значения, `maxWallClockTime`указывающие на то, что, указанные в ограничениях работы, был превышен, и поэтому задание было прекращено. Он также может быть установлен для указания `onTaskFailure` задачи не удалось, если свойство задачи было установлено надлежащим образом.
  - Свойство [schedulingError](https://docs.microsoft.com/rest/api/batchservice/job/get#jobschedulingerror) устанавливается в случае ошибки в планировании.
 
### <a name="job-preparation-tasks"></a>Задачи по подготовке к заданиям

Если задача подготовки к заданию указана для задания, то экземпляр этой задачи будет выполнен при первом выполнении задачи для задания на узлах. Задание подготовки к заданиям, настроенное на задании, можно рассматривать как шаблон задачи, при этом запускаются несколько экземпляров задач подготовки к работе, вплоть до количества узлов в пуле.

Экземпляры задачи подготовки к заданиям должны быть проверены, чтобы определить, были ли ошибки:
- При выполнении задачи подготовки к задания задача, которая привела к `preparing`выполнению задачи подготовки задания, перейдет в [состояние;](https://docs.microsoft.com/rest/api/batchservice/task/get#taskstate) если задача подготовки к задания завершается неудачей, задача запуска вернется в `active` состояние и не будет выполнена.  
- Все экземпляры задачи подготовки к задании, которые были выполнены, могут быть получены из задания с помощью API [по подготовке к подготовке и выпуску задач.](https://docs.microsoft.com/rest/api/batchservice/job/listpreparationandreleasetaskstatus) Как и в любой задаче, есть `failureInfo` `exitCode` [информация об исполнении,](https://docs.microsoft.com/rest/api/batchservice/job/listpreparationandreleasetaskstatus#jobpreparationandreleasetaskexecutioninformation) доступная с такими свойствами, как , и `result`.
- Если задачи по подготовке к заданию не выполняются, то задачи запуска не будут выполняться, задание не будет завершено и будет застревать. Бассейн может стать неиспользованным, если нет других заданий с задачами, которые могут быть запланированы.

### <a name="job-release-tasks"></a>Задачи по освобождению заданий

Если задача высвобождения заданий указана для задания, то при завершении выполнения задачи выделения заданий на каждом из узлов пула, где была выполнена задача подготовки к заданию, выполнить сяочку.  Экземпляры задачи выпуска задачи выполнения задач должны быть проверены, чтобы определить, были ли ошибки:
- Все экземпляры выполнения задачи по выпуску задания могут быть получены из задания с помощью [статуса подготовки и задачи](https://docs.microsoft.com/rest/api/batchservice/job/listpreparationandreleasetaskstatus)API. Как и в любой задаче, есть `failureInfo` `exitCode` [информация об исполнении,](https://docs.microsoft.com/rest/api/batchservice/job/listpreparationandreleasetaskstatus#jobpreparationandreleasetaskexecutioninformation) доступная с такими свойствами, как , и `result`.
- Если одна или несколько задач по выпуску заданий не `completed` выполняются, то задание все равно будет прекращено и перейдет в состояние.

## <a name="tasks"></a>Задания

Задачи заданий могут выполнить неудачу по нескольким причинам:

- Строка команды задачи выходит из строя, возвращаясь с ненулевым кодом выхода.
- Есть `resourceFiles` указанные для задачи, но произошел сбой, что означает, что один или несколько файлов не загружаются.
- Есть `outputFiles` указанные для задачи, но был сбой, что означает, что один или несколько файлов не загружаются.
- Истек время выполнения задачи, указанной `maxWallClockTime` свойством в [ограничениях](https://docs.microsoft.com/rest/api/batchservice/task/add#taskconstraints)задачи, было превышено.

Во всех случаях необходимо проверить следующие свойства на наличие ошибок и информацию об ошибках:
- Свойство [выполнения задачInfo](https://docs.microsoft.com/rest/api/batchservice/task/get#taskexecutioninformation) содержит несколько свойств, которые предоставляют информацию об ошибке. [результат](https://docs.microsoft.com/rest/api/batchservice/task/get#taskexecutionresult) указывает, если задача не `exitCode` удалось `failureInfo` по какой-либо причине, с и предоставление дополнительной информации о сбое.
- Задача всегда будет двигаться к `completed` [государству,](https://docs.microsoft.com/rest/api/batchservice/task/get#taskstate)независимо от того, удалось это или не удалось.

Необходимо учитывать влияние сбоев задач на задание и любые зависимости задач.  Свойство [exitConditions](https://docs.microsoft.com/rest/api/batchservice/task/add#exitconditions) может быть определено для задачи настройки действия для зависимостей и для задания.
- Для зависимостей [Зависимость использует,](https://docs.microsoft.com/rest/api/batchservice/task/add#dependencyaction) блокируются или выполняются ли задачи, зависящие от неисчерченной задачи, или выполняются.
- Для выполнения задания [JobAction](https://docs.microsoft.com/rest/api/batchservice/task/add#jobaction) контролирует, приводит ли невыполненная задача к отключению, завершению или оставлению без изменений задания.

### <a name="task-command-line-failures"></a>Сбои в работе строки задач

При выполнении строки команд задачи `stderr.txt` вывод `stdout.txt`напишется и под засечен Кроме того, приложение может записываться в файлы журнала, специфичные для приложений.

Если узел пула, на котором выполнена задача, все еще существует, можно получить и просмотреть файлы журнала. Например, портал Azure перечисляет и может просматривать файлы журнала для задачи или узла пула. Несколько AA также позволяют перечислять и получать файлы задач, такие как [Get From Task.](https://docs.microsoft.com/rest/api/batchservice/file/getfromtask)

Из-за того, что пулы и узлы пула часто эфемерны, а узлы постоянно добавляются и удаляются, рекомендуется сохранять файлы журнала. [Выводные файлы задач](https://docs.microsoft.com/azure/batch/batch-task-output-files) являются удобным способом сохранения файлов журнала в Хранилище Azure.

### <a name="output-file-failures"></a>Сбои в работе файла вывода
В каждом сеансе передачи файла пакетная служба записывает в вычислительный узел два файла журнала: `fileuploadout.txt` и `fileuploaderr.txt`. Для получения дополнительных сведений о конкретной ошибке можно проанализировать файлы журнала. В тех случаях, когда загрузка файла никогда не была предпринята, например, из-за того, что сама задача не могла выполниться, эти файлы журнала не будут существовать.  

## <a name="next-steps"></a>Дальнейшие действия

Убедитесь, что приложение реализует комплексную проверку ошибок; это может иметь решающее значение для оперативного обнаружения и диагностики проблем.
