---
title: Масштабирование Центра Интернета вещей в Azure | Документация Майкрософт
description: Масштабирование Центра Интернета вещей для поддержки ожидаемой пропускной способности сообщений и необходимых компонентов. Эта статья содержит сводку по поддерживаемой пропускной способности для каждого уровня и параметров сегментирования.
author: wesmc7777
manager: timlt
ms.service: iot-hub
services: iot-hub
ms.topic: conceptual
ms.date: 06/28/2019
ms.author: wesmc
ms.openlocfilehash: ea7b38f509fcdaa4e41ce17db3beca44b05a59b2
ms.sourcegitcommit: 6cb4dd784dd5a6c72edaff56cf6bcdcd8c579ee7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/02/2019
ms.locfileid: "67514476"
---
# <a name="choose-the-right-iot-hub-tier-for-your-solution"></a>Выбор правильного уровня Центра Интернета вещей для решения

Все решения Интернета вещей различны, поэтому Центр Интернета вещей предлагает несколько вариантов, основанных на ценах и масштабе. Эта статья предназначена для оценки потребностей вашего Центра Интернета вещей. Сведения о ценах на уровни Центра Интернета вещей см. на [этой странице](https://azure.microsoft.com/pricing/details/iot-hub).

Чтобы решить, какой уровень Центра Интернета вещей подходит для решения, задайте себе два вопроса:

**Какие функции планируется использовать?**

Центр Интернета вещей предлагает два уровня — "Базовый" и "Стандартный", которые отличаются количеством поддерживаемых компонентов. Если в основе решения Интернета вещей лежит сбор данных с устройств и их централизованный анализ, тогда вам подойдет уровень "Базовый". Если вам необходимо использовать более сложные конфигурации для управления устройствами Центра Интернета вещей удаленно или распределить часть рабочих нагрузок на сами устройства, тогда следует рассмотреть возможность использования уровня "Стандартный". Подробный разбор компонентов, которые включены в каждый уровень, см. в разделе [Уровни "Базовый" и "Стандартный"](#basic-and-standard-tiers).

**Какой объем данных планируется перемещать ежедневно?**

Каждый уровень Центра Интернета вещей доступен в трех размерах на основе пропускной способности данных, которую он может обрабатывать каждый день. Эти размеры численно обозначены как 1, 2 и 3. Например, каждая единица Центра Интернета вещей 1-го уровня может обработать 400 тысяч сообщений в день, тогда как единица 3-го уровня может обработать 300 миллионов. Дополнительные сведения о рекомендациях по данным см. в разделе [Пропускная способность сообщений](#message-throughput).

## <a name="basic-and-standard-tiers"></a>Уровни "Базовый" и "Стандартный"

Уровень "Стандартный" Центра Интернета вещей включает все компоненты и необходим для любых решений Интернета вещей, где предполагается использование возможностей двухсторонней связи. Уровень "Базовый" включает подмножество компонентов и предназначен для решений Интернета вещей, которым требуется только однонаправленная связь с устройствами в облаке. Оба уровня предоставляют одинаковые компоненты безопасности и аутентификации.

В пределах уровня для Центра Интернета вещей можно выбрать только один тип [выпуска](https://azure.microsoft.com/pricing/details/iot-hub/). Например, можно создать центр Интернета вещей с несколькими единицами уровня S1, но не с комбинацией единиц из разных выпусков, например S1 и B3 или S1 и S2.

| Функция | Уровень Basic | Уровня "бесплатно" или "стандартный" |
| ---------- | ---------- | ------------- |
| [Телеметрия "С устройства в облако"](iot-hub-devguide-messaging.md) | Да | Да |
| [Удостоверение для каждого устройства](iot-hub-devguide-identity-registry.md) | Да | Да |
| [Маршрутизация сообщений](iot-hub-devguide-messages-read-custom.md) и [интеграция службы "Сетка событий"](iot-hub-event-grid.md) | Да | Да |
| [Протоколы HTTP, AMQP и MQTT](iot-hub-devguide-protocols.md) | Да | Да |
| [Служба подготовки устройств](../iot-dps/about-iot-dps.md) | Да | Да |
| [Мониторинг и диагностика](iot-hub-monitor-resource-health.md) | Да | Да |
| [Передача сообщений из облака на устройство](iot-hub-devguide-c2d-guidance.md) |   | Да |
| [Двойники устройств](iot-hub-devguide-device-twins.md), [двойники модулей](iot-hub-devguide-module-twins.md) и [управление устройствами](iot-hub-device-management-overview.md) |   | Да |
| [Потоки устройств (предварительная версия)](iot-hub-device-streams-overview.md) |   | Да |
| [Azure IoT Edge](../iot-edge/about-iot-edge.md) |   | Да |

Центр Интернета вещей также предлагает уровень "Бесплатный", который предназначен для тестирования и оценки. Он обладает всеми возможностями уровня "Стандартный", но ограничен квотами на сообщения. С уровня "Бесплатный" нельзя обновиться до уровня "Базовый" или "Стандартный".

## <a name="partitions"></a>Разделы

Центры Интернета вещей Azure содержат несколько основных компонентов [Центров событий Azure](../event-hubs/event-hubs-features.md), включая [секции](../event-hubs/event-hubs-features.md#partitions). Потоки событий для Центров Интернета вещей обычно заполняются входящими данными телеметрии, которые сообщают различные устройства Интернета вещей. Секционирование потока событий используется для сокращения конфликтов, возникающих при одновременном считывании потоков событий и записи в эти потоки.

При создании Центра Интернета вещей выбирается ограничение секции, и его нельзя изменить. Максимальный предел для уровня "базовый" центра Интернета вещей "и" стандартный "центра Интернета вещей — 32. Для большинства центров Интернета вещей достаточно четырех секций. Дополнительные сведения об определении секций см. в разделе часто задаваемых вопросов о Центрах событий Azure [Сколько секций мне нужно?](../event-hubs/event-hubs-faq.md#how-many-partitions-do-i-need)

## <a name="tier-upgrade"></a>Обновление уровня

После создания Интернета вещей уровень "Базовый" можно обновить до уровня "Стандартный", не прерывая имеющихся операций. Дополнительные сведения см. в статье [Как обновить Центр Интернета вещей](iot-hub-upgrade.md).

Конфигурация секции сохраняется при переходе с уровня "Базовый" на уровень "Стандартный".

> [!NOTE]
> Уровень "бесплатный" не поддерживает обновление до basic или standard.

## <a name="iot-hub-rest-apis"></a>Интерфейсы REST API для Центра Интернета вещей

Разница в поддерживаемых возможностях между Центрами Интернета вещей уровня "Базовый" и "Стандартный" означает, что некоторые вызовы API не работают с концентраторами уровня "Базовый". В следующей таблице показаны доступные API:

| API | Уровень Basic | Уровня "бесплатно" или "стандартный" |
| --- | ---------- | ------------- |
| [Удаление устройства](https://docs.microsoft.com/rest/api/iothub/service/deletedevice) | Да | Да |
| [Получение устройства](https://docs.microsoft.com/rest/api/iothub/service/getdevice) | Да | Да |
| [Удалить модуль](https://docs.microsoft.com/rest/api/iothub/service/deletemodule) | Да | Да |
| [Получение модуля](https://docs.microsoft.com/rest/api/iothub/service/getmodule) | Да | Да |
| [Получение статистики реестра](https://docs.microsoft.com/rest/api/iothub/service/getdeviceregistrystatistics) | Да | Да |
| [Получение статистики службы](https://docs.microsoft.com/rest/api/iothub/service/getservicestatistics) | Да | Да |
| [Создание или обновление устройства](https://docs.microsoft.com/rest/api/iothub/service/createorupdatedevice) | Да | Да |
| [Создание или обновление модуля](https://docs.microsoft.com/rest/api/iothub/service/createorupdatemodule) | Да | Да |
| [Отправка запроса в Центр Интернета вещей](https://docs.microsoft.com/rest/api/iothub/service/queryiothub) | Да | Да |
| [Создание URI SAS отправки файла](https://docs.microsoft.com/rest/api/iothub/device/createfileuploadsasuri) | Да | Да |
| [Получение связанного с устройством уведомления](https://docs.microsoft.com/rest/api/iothub/device/receivedeviceboundnotification) | Да | Да |
| [Отправка события устройства](https://docs.microsoft.com/rest/api/iothub/device/senddeviceevent) | Да | Да |
| Отправка события модуля | AMQP и MQTT только | AMQP и MQTT только |
| [Обновление состояния отправки устройства](https://docs.microsoft.com/rest/api/iothub/device/updatefileuploadstatus) | Да | Да |
| [Массовые операции устройств](https://docs.microsoft.com/rest/api/iothub/service/bulkcreateorupdatedevices) | Да, за исключением возможностей IoT Edge | Да |
| [Очистка очереди команд](https://docs.microsoft.com/rest/api/iothub/service/purgecommandqueue) |   | Да |
| [Получение двойника устройства](https://docs.microsoft.com/rest/api/iothub/service/gettwin) |   | Да |
| [Получить двойник модуля](https://docs.microsoft.com/rest/api/iothub/service/getmoduletwin) |   | Да |
| [Вызов метода устройства](https://docs.microsoft.com/rest/api/iothub/service/invokedevicemethod) |   | Да |
| [Обновление двойников устройств](https://docs.microsoft.com/rest/api/iothub/service/updatetwin) |   | Да |
| [Обновить двойник модуля](https://docs.microsoft.com/rest/api/iothub/service/updatemoduletwin) |   | Да |
| [Отказ от связанного с устройством уведомления](https://docs.microsoft.com/rest/api/iothub/device/abandondeviceboundnotification) |   | Да |
| [Полное связанное с устройством уведомление](https://docs.microsoft.com/rest/api/iothub/device/completedeviceboundnotification) |   | Да |
| [Отмена задания](https://docs.microsoft.com/rest/api/iothub/service/canceljob) |   | Да |
| [Создание задания](https://docs.microsoft.com/rest/api/iothub/service/createjob) |   | Да |
| [Получение задания](https://docs.microsoft.com/rest/api/iothub/service/getjob) |   | Да |
| [Запрос заданий](https://docs.microsoft.com/rest/api/iothub/service/queryjobs) |   | Да |

## <a name="message-throughput"></a>Пропускная способность сообщений

Лучший способ определить размер решения Центра Интернета вещей — оценить трафик в пересчете на одну единицу. В частности, необходимо учитывать требования к пиковой пропускной способности для таких категорий операций:

* Отправка сообщений с устройства в облако
* Получение сообщений из облака на устройство
* операции с реестром удостоверений.

Трафик измеряется в пересчете на одну единицу, а не на концентратор. С экземпляром Центра Интернета вещей уровня 1 и 2 можно связать до 200 единиц измерения, а с экземпляром Центра Интернета вещей уровня 3 — до 10 единиц измерения. После создания Центра Интернета вещей можно изменить число единиц или изменять размеры (1, 2 и 3) в рамках определенного уровня, не прерывая имеющиеся операции. Дополнительные сведения см. в статье [Как обновить Центр Интернета вещей](iot-hub-upgrade.md).

В качестве примера возможностей трафика каждого уровня для сообщений, передаваемых с устройства в облако, следует соблюдать такие правила.

| Уровень | Непрерывная пропускная способность | Непрерывная скорость отправки |
| --- | --- | --- |
| B1, S1 |До 1111 КБ/мин на единицу<br/>(1,5 ГБ/день на единицу) |В среднем 278 сообщений/мин на единицу<br/>(400 000 сообщений/день на единицу) |
| B2, S2 |До 16 МБ/мин на единицу<br/>(22,8 ГБ/день на единицу) |В среднем 4167 сообщений/мин на единицу<br/>(6 миллионов сообщений/день на единицу) |
| B3, S3 |До 814 МБ/мин на единицу<br/>(1144,4 ГБ/день на единицу). |В среднем 208 333 сообщения/мин на единицу<br/>(300 млн сообщений/день на единицу). |

Помимо этих сведений о пропускной способности, изучите документ [Квоты и ограничения Центра Интернета вещей](iot-hub-devguide-quotas-throttling.md) и спроектируйте свое решение соответствующим образом.

### <a name="identity-registry-operation-throughput"></a>Пропускная способность для операций с реестром удостоверений

Операции с реестром удостоверений Центра Интернета вещей не должны выполняться в среде выполнения, так как они в основном связаны с подготовкой устройств.

Конкретные показатели пиковой пропускной способности см. в документе [Квоты и ограничения Центра Интернета вещей](iot-hub-devguide-quotas-throttling.md).

## <a name="auto-scale"></a>Автомасштабирование

Если вы приближаетесь к ограничению на количество разрешенных сообщений в Центре Интернета вещей, выполните [эти действия для автоматического масштабирования](https://azure.microsoft.com/resources/samples/iot-hub-dotnet-autoscale/), чтобы увеличить единицы Центра Интернета вещей на этом же уровне.

## <a name="sharding"></a>Сегментирование

Хотя один центр IoT может обслуживать миллионы устройств, иногда для существующего решения требуются особые характеристики производительности. Такие, которые не может гарантировать один центр IoT. В этом случае устройства можно разделить по нескольким Центрам Интернета вещей. Использование нескольких центров IoT сглаживает пики трафика и обеспечивает необходимую пропускную способность или скорость операций.

## <a name="next-steps"></a>Дальнейшие действия

* Дополнительные сведения о возможностях центра Интернета вещей и сведения о производительности, см. в разделе [цены на центр Интернета вещей](https://azure.microsoft.com/pricing/details/iot-hub) или [квоты и ограничения центра Интернета вещей](iot-hub-devguide-quotas-throttling.md).

* Чтобы изменить уровень Центра Интернета вещей, выполните действия, описанные в статье [Как обновить Центр Интернета вещей](iot-hub-upgrade.md).
