---
title: Устранение неполадок центра Интернета вещей Azure 403004 Девицемаксимумкуеуедепсексцеедед
description: Сведения об исправлении ошибки 403004 Девицемаксимумкуеуедепсексцеедед
author: jlian
manager: briz
ms.service: iot-hub
services: iot-hub
ms.topic: troubleshooting
ms.date: 01/30/2020
ms.author: jlian
ms.custom:
- amqp
- mqtt
ms.openlocfilehash: 5cc8bae0f0245f5c4b45ca0cd446582b04788c21
ms.sourcegitcommit: 877491bd46921c11dd478bd25fc718ceee2dcc08
ms.contentlocale: ru-RU
ms.lasthandoff: 07/02/2020
ms.locfileid: "81758758"
---
# <a name="403004-devicemaximumqueuedepthexceeded"></a>403004 DeviceMaximumQueueDepthExceeded

В этой статье описываются причины и решения для ошибок **403004 девицемаксимумкуеуедепсексцеедед** .

## <a name="symptoms"></a>Симптомы

При попытке отправить сообщение из облака на устройство происходит сбой запроса с ошибкой **403004** или **девицемаксимумкуеуедепсексцеедед**.

## <a name="cause"></a>Причина:

Основная причина заключается в том, что количество сообщений, поставленных в очередь для устройства, превышает [ограничение очереди (50)](./iot-hub-devguide-quotas-throttling.md#other-limits).

Наиболее вероятной причиной этого является то, что вы используете протокол HTTPS для получения сообщения, что ведет к непрерывному опросу с помощью `ReceiveAsync` , что приводит к регулированию запроса центром Интернета вещей.

## <a name="solution"></a>Решение

Схема сообщений, передаваемых из облака на устройство с помощью HTTPS, может использоваться на периодически подключаемых устройствах, которые редко проверяют наличие новых сообщений (реже, чем раз в 25 минут). Чтобы уменьшить вероятность выполнения ограничения очереди, переключитесь на AMQP или MQTT для сообщений, отправляемых из облака на устройство.

Кроме того, можно улучшить логику устройства, чтобы быстро завершить, отклонять или отменять сообщения в очереди, сократить время жизни или отсылать меньше сообщений. См. о [сроке жизни сообщений, отправляемых из облака на устройство](./iot-hub-devguide-messages-c2d.md#message-expiration-time-to-live).

Наконец, рассмотрите возможность использования [API очистки очереди](https://docs.microsoft.com/rest/api/iothub/service/registrymanager/purgecommandqueue) для периодической очистки ожидающих сообщений до достижения предела.