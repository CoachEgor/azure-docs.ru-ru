---
title: Сравнение маршрутизации с помощью Центра Интернета вещей до и после интеграции со службой "Сетка событий" | Документация Майкрософт
description: Центр Интернета вещей предусматривает собственную службу маршрутизации сообщений, но его можно интегрировать со службой "Сетка событий", чтобы публиковать события. Сравните эти две службы.
author: kgremban
manager: philmea
ms.service: iot-hub
services: iot-hub
ms.topic: conceptual
ms.date: 02/20/2019
ms.author: kgremban
ms.openlocfilehash: 0b17a87fa02c382ae19cca6e4abcfff2ec475450
ms.sourcegitcommit: d4dfbc34a1f03488e1b7bc5e711a11b72c717ada
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/13/2019
ms.locfileid: "66252693"
---
# <a name="compare-message-routing-and-event-grid-for-iot-hub"></a>Сравнение маршрутизации сообщений со службой "Сетка событий" и без нее для Центра Интернета вещей

Центр Интернета вещей Azure позволяет выполнять потоковую передачу данных с подключенных устройств и интегрировать эти данные в бизнес-приложений. Центр Интернета вещей поддерживает два метода интеграции событий Интернета вещей в другие службы Azure или бизнес-приложения. В этой статье описаны такие возможности, что позволяет выбрать, какой вариант больше всего подходит для вашего сценария.

[!INCLUDE [iot-hub-basic](../../includes/iot-hub-basic-partial.md)]

**[Маршрутизация сообщений центра Интернета вещей](iot-hub-devguide-messages-d2c.md)** : Эта функция центра Интернета вещей позволяет маршрутизировать сообщения с устройства в облако в конечные точки служб, таких как контейнеры службы хранилища Azure, концентраторов событий, очереди служебной шины и разделы служебной шины. Маршрутизация также обеспечивает возможность выполнения запросов для фильтрации данных перед их отправкой на конечные точки. Помимо данных телеметрии устройств можно также отправлять [нетелеметрические события](iot-hub-devguide-messages-d2c.md#non-telemetry-events), которые можно использовать для вызова действий. 

**Интеграция центра Интернета вещей с помощью сетки событий**: Сетка событий Azure — это полностью управляемая служба маршрутизации событий, использующая модель публикации и подписки. Две службы работают вместе, чтобы [интегрировать события Центра Интернета в службы Azure и другие службы](iot-hub-event-grid.md) практически в реальном времени. Центр Интернета вещей публикует [события устройства](iot-hub-event-grid.md#event-types), который обычно доступны и теперь также публикует события телеметрии, который находится в общедоступной предварительной версии.

## <a name="differences"></a>Различия

Маршрутизация сообщений и Сетка событий обеспечивают конфигурацию оповещений, хотя между ними есть кардинальные отличия. Дополнительные сведения см. в таблице ниже.

| Компонент | Маршрутизация сообщений с помощью Центра Интернета вещей | Интеграция Центра Интернета вещей со службой "Сетка событий" |
| ------- | --------------- | ---------- |
| **Сообщения устройства и события** | Да, маршрутизацию сообщений можно использовать для данных телеметрии и сообщать об изменениях двойников и событиях жизненного цикла устройств. | Да, можно использовать для данных телеметрии "Сетка событий", но также может сообщать, когда устройства создан, удален, подключаются и подключен к центру Интернета вещей |
| **Упорядочение** | Да, упорядочение событий поддерживается.  | Нет, порядок событий не гарантируется. | 
| **Фильтрация** | Расширенная фильтрация свойств приложений для обмена сообщениями, свойств системы обмена сообщениями, основной части сообщения, меток и свойств двойников устройства. См. примеры в разделе [Синтаксис запросов маршрутизации сообщений](iot-hub-devguide-routing-query-syntax.md). | Фильтрация на основе типа события, тип субъекта и атрибутов в каждом событии. Примеры, см. в разделе [понять фильтрации событий в подписки сетки событий](../event-grid/event-filtering.md). При подписке на события телеметрии, можно применить дополнительные фильтры на данные фильтра для свойств сообщений, сообщения текст и двойник устройств в центре Интернета вещей, перед публикацией "Сетка событий". См. в разделе [процесса фильтрации событий](../iot-hub/iot-hub-event-grid.md#filter-events). |
| **Конечные точки** | <ul><li>Центры событий;</li> <li>Хранилище BLOB-объектов Azure</li> <li>Очередь служебной шины</li> <li>Разделы служебной шины</li></ul><br>Для платных номеров SKU Центра Интернета вещей (S1, S2 и S3) действует ограничение: до 10 пользовательских конечных точек. Для Центра Интернета вещей можно создать 100 маршрутов. | <ul><li>Функции Azure</li> <li>Служба автоматизации Azure</li> <li>Центры событий;</li> <li>Logic Apps</li> <li>Большой двоичный объект хранилища</li> <li>Пользовательские разделы</li> <li>Хранилище очередей</li> <li>Microsoft Flow</li> <li>Сторонние службы с использованием веб-перехватчиков</li></ul><br>поддерживаются 500 конечные точки для центра Интернета вещей. Самый новый список конечных точек см. в разделе об [обработчиках событий для службы "Сетка событий"](../event-grid/overview.md#event-handlers). |
| **Стоимость** | За маршрутизацию сообщений отдельная плата не взимается. Оплачиваются только данные телеметрии, входящие в Центр Интернета вещей. Например, если сообщение направлено в три различные конечные точки, плата взимается только за одно сообщение. | Центр Интернета вещей не взимает плату. "Сетка событий" предлагает первые 100 000 операций в месяц бесплатно и затем 0,60 долл. США за миллион операций позже. |

## <a name="similarities"></a>Сходства

У службы "Сетка событий" и маршрутизации сообщений с помощью Центра Интернета вещей много сходств, некоторые из которых представлены в таблице ниже:

| Компонент | Маршрутизация сообщений с помощью Центра Интернета вещей | Интеграция Центра Интернета вещей со службой "Сетка событий" |
| ------- | --------------- | ---------- |
| **Максимальный размер сообщения** | 256 КБ (с устройства в облако). | 256 КБ (с устройства в облако). |
| **Надежность** | Высокий: Каждое сообщение доставляется в конечную точку по крайней мере один раз для каждого маршрута. У всех сообщений, недоставленных в течение одного часа, истекает срок действия. | Высокий: Каждое сообщение доставляется веб-перехватчику по крайней мере один раз для каждой подписки. У всех событий, недоставленных в течение 24 часов, истекает срок действия. | 
| **Масштабируемость** | Высокий: Оптимизированы для поддержки миллионов одновременно подключенных устройств, которые отправляют миллиарды сообщений. | Высокий: Возможность маршрутизации 10 000 000 событий в секунду для каждого региона. |
| **Задержка** | Низкий: Практически в реальном времени. | Низкий: Практически в реальном времени. |
| **Отправка в несколько конечных точек** | Да, одно сообщение можно отправить в несколько конечных точек. | Да, одно сообщение можно отправить в несколько конечных точек.  
| **Безопасность** | Центр Интернета вещей обеспечивает идентификацию каждого устройства и управление доступом с возможностью отзыва. Дополнительные сведения см. в статье об [управлении доступом в Центре Интернета вещей](iot-hub-devguide-security.md). | "Сетка событий" обеспечивает проверку трех пунктов: подписки на событие, публикации событий и доставки событий веб-перехватчику. Дополнительные сведения см. в разделе [Сетка событий: безопасность и проверка подлинности](../event-grid/security-authentication.md). |

## <a name="how-to-choose"></a>Как выбрать

Маршрутизация сообщений Центра Интернета вещей и его интегрированная версия со службой "Сетка событий" выполняют разные действия для достижения одинаковых результатов. Они принимают сведения из вашего решения Центра Интернета вещей и передают их, чтобы могли отреагировать другие службы. Как же решить, какой компонент использовать? Ответьте на следующие вопросы для принятия решения: 

* **Какие данные следует отправлять в конечные точки?**

   Маршрутизацию сообщений с помощью Центра Интернета вещей лучше использовать, если нужно отправлять данные телеметрии в другие службы. Маршрутизация сообщений также позволяет адресовать запросы приложению для обмена сообщениями и свойствам системы обмена сообщениями, основной части сообщения, меткам и свойствам двойников устройств.

   Центр Интернета вещей, интегрированный со службой "Сетка событий", работает с событиями, происходящими в службе "Центр Интернета вещей". Эти события центра Интернета вещей включают данные телеметрии, устройство создан, удален, подключенных и отключен. При подписке на события телеметрии, можно применить дополнительные фильтры на данные фильтра для свойств сообщений, сообщения текст и двойник устройств в центре Интернета вещей, перед публикацией "Сетка событий". См. в разделе [процесса фильтрации событий](../iot-hub/iot-hub-event-grid.md#filter-events).

* **Какие конечные точки должны получать эти сведения?**

   Маршрутизация сообщений центра Интернета вещей поддерживает ограниченное число уникальными конечными точками и типы конечных точек, но можно создать соединители, чтобы перенаправлять данные и события в дополнительные конечные точки. Полный список поддерживаемых конечных точек см. в таблице в разделе выше. 

   Интеграция центра Интернета вещей с помощью сетки событий поддерживает 500 конечных точек на центр Интернета вещей и более широкий типы конечных точек. Наивно интегрируется с функциями Azure, Logic Apps, хранилища и очереди служебной шины она также работает с веб-перехватчики для расширения отправка данных за пределы экосистемы служб Azure и в сторонним бизнес-приложения.

* **Важен ли порядок получения данных?**

   Центр поддерживает порядок отправки сообщений при их маршрутизации.

   Сетка событий не гарантирует, что конечные точки получат события в порядке их возникновения. В тех случаях, когда важен абсолютный порядок сообщений и/или в котором потребителю нужен доверенный уникальный идентификатор для сообщений рекомендуется использовать маршрутизацию сообщений. 

## <a name="next-steps"></a>Дальнейшие действия

* Узнайте больше о [маршрутизации сообщений с помощью центра Интернета вещей](iot-hub-devguide-messages-d2c.md) и [конечных точках центра Интернета вещей](iot-hub-devguide-endpoints.md).
* Дополнительные сведения о службе "Сетка событий" Azure см. [здесь](../event-grid/overview.md).
* Дополнительные сведения о создании маршрутов сообщений см. в статье [Руководство. Настройка маршрутизации сообщений с Центром Интернета вещей](../iot-hub/tutorial-routing.md).
* Опробовать интеграцию "Сетка событий" by [отправка по электронной почте уведомлений о событиях центра Интернета вещей Azure с помощью приложений логики](../event-grid/publish-iot-hub-events-to-logic-apps.md).