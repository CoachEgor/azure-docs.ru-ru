---
title: Сравнение маршрутизации с помощью Центра Интернета вещей до и после интеграции со службой "Сетка событий" | Документация Майкрософт
description: Центр Интернета вещей предусматривает собственную службу маршрутизации сообщений, но его можно интегрировать со службой "Сетка событий", чтобы публиковать события. Сравните эти две службы.
author: kgremban
manager: philmea
ms.service: iot-hub
services: iot-hub
ms.topic: conceptual
ms.date: 02/20/2019
ms.author: kgremban
ms.openlocfilehash: 877467b65d346c871dd93f4b3f96b2c1664fa4b9
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/27/2020
ms.locfileid: "73906789"
---
# <a name="compare-message-routing-and-event-grid-for-iot-hub"></a>Сравнение маршрутизации сообщений со службой "Сетка событий" и без нее для Центра Интернета вещей

Azure IoT Hub предоставляет возможность потоковой передачи данных с подключенных устройств и интеграции этих данных в бизнес-приложения. Центр Интернета вещей поддерживает два метода интеграции событий Интернета вещей в другие службы Azure или бизнес-приложения. В этой статье описаны такие возможности, что позволяет выбрать, какой вариант больше всего подходит для вашего сценария.

[!INCLUDE [iot-hub-basic](../../includes/iot-hub-basic-partial.md)]

**[Маршрутизирование сообщений Концентратора IoT:](iot-hub-devguide-messages-d2c.md)** Эта функция IoT Hub позволяет пользователям направлять сообщения от устройства к облаку в конечные точки обслуживания, такие как контейнеры хранения Azure, концентраторы событий, очереди в автобусах служб и темы «Сервисный автобус». Маршрутизация также обеспечивает возможность выполнения запросов для фильтрации данных перед их отправкой на конечные точки. Помимо данных телеметрии устройств можно также отправлять [нетелеметрические события](iot-hub-devguide-messages-d2c.md#non-telemetry-events), которые можно использовать для вызова действий. 

**Интеграция Центра Интернета вещей со службой "Сетка событий".** "Сетка событий Azure" — это полностью управляемая служба маршрутизации событий, использующая принцип "публикации — подписки". Две службы работают вместе, чтобы [интегрировать события Центра Интернета в службы Azure и другие службы](iot-hub-event-grid.md) практически в реальном времени. IoT Hub публикует как [события устройства,](iot-hub-event-grid.md#event-types) так и события телеметрии.

## <a name="differences"></a>Различия

Маршрутизация сообщений и Сетка событий обеспечивают конфигурацию оповещений, хотя между ними есть кардинальные отличия. Дополнительные сведения см. в таблице ниже.

| Компонент | Маршрутизация сообщений с помощью Центра Интернета вещей | Интеграция Центра Интернета вещей со службой "Сетка событий" |
| ------- | --------------- | ---------- |
| **Сообщения и события устройств** | Да, маршрутизирование сообщений может быть использовано для телеметрических данных, отчета о двойных изменениях устройства, событиях жизненного цикла устройства и цифровых событиях изменения близнецов (часть [публичного предварительного просмотра IoT Plug and Play).](../iot-pnp/overview-iot-plug-and-play.md) | Да, Event Grid может использоваться для телеметрических данных, но также может сообщать, когда устройства создаются, удаляются, подключены и отключены от IoT Hub |
| **Упорядочение** | Да, упорядочение событий поддерживается.  | Нет, порядок событий не гарантируется. | 
| **Фильтрация** | Расширенная фильтрация свойств приложений для обмена сообщениями, свойств системы обмена сообщениями, основной части сообщения, меток и свойств двойников устройства. Фильтрация не применяется к цифровым событиям двойного изменения. См. примеры в разделе [Синтаксис запросов маршрутизации сообщений](iot-hub-devguide-routing-query-syntax.md). | Фильтрация в зависимости от типа события, типа объекта и атрибутов в каждом событии. Например, [см. Понимание событий фильтрации в подписках Event Grid.](../event-grid/event-filtering.md) При подписке на события телеметрии можно применить дополнительные фильтры на данных для фильтрации свойств сообщений, тела сообщений и близнеца устройства в вашем концентраторе IoT, прежде чем опубликовать в Event Grid. [Узнайте, как фильтровать события.](../iot-hub/iot-hub-event-grid.md#filter-events) |
| **Конечные точки** | <ul><li>Центры событий</li> <li>хранилище BLOB-объектов Azure</li> <li>Очередь служебной шины</li> <li>Разделы служебной шины</li></ul><br>Для платных номеров SKU Центра Интернета вещей (S1, S2 и S3) действует ограничение: до 10 пользовательских конечных точек. Для Центра Интернета вещей можно создать 100 маршрутов. | <ul><li>Проверка</li> <li>Служба автоматизации Azure</li> <li>Центры событий</li> <li>Logic Apps</li> <li>Большой двоичный объект хранилища</li> <li>Пользовательские разделы</li> <li>Хранилище очередей</li> <li>Microsoft Flow</li> <li>Сторонние службы с использованием веб-перехватчиков</li></ul><br>Поддерживаются 500 конечных точек на один концентратор IoT. Самый новый список конечных точек см. в разделе об [обработчиках событий для службы "Сетка событий"](../event-grid/overview.md#event-handlers). |
| **Стоимость** | За маршрутизацию сообщений отдельная плата не взимается. Оплачиваются только данные телеметрии, входящие в Центр Интернета вещей. Например, если сообщение направлено в три различные конечные точки, плата взимается только за одно сообщение. | Центр Интернета вещей не взимает плату. Event Grid предлагает первые 100 000 операций в месяц бесплатно, а затем $0,60 за миллион операций после этого. |

## <a name="similarities"></a>Сходства

У службы "Сетка событий" и маршрутизации сообщений с помощью Центра Интернета вещей много сходств, некоторые из которых представлены в таблице ниже:

| Компонент | Маршрутизация сообщений с помощью Центра Интернета вещей | Интеграция Центра Интернета вещей со службой "Сетка событий" |
| ------- | --------------- | ---------- |
| **Максимальный размер сообщения** | 256 КБ (с устройства в облако). | 256 КБ (с устройства в облако). |
| **Надежность** | Высокая. Каждое сообщение доставляется в конечную точку по крайней мере единожды для каждого маршрута. У всех сообщений, недоставленных в течение одного часа, истекает срок действия. | Высокая. Каждое сообщение доставляется веб-перехватчику по крайней мере один раз для каждой подписки. У всех событий, недоставленных в течение 24 часов, истекает срок действия. | 
| **Масштабируемость** | Высокая. Оптимизирована для поддержки миллионов одновременно подключенных устройств. | Высокая. Поддерживается маршрутизация 10 000 000 событий в секунду для каждого региона. |
| **Задержки** | Малая. Практически в реальном времени. | Малая. Практически в реальном времени. |
| **Отправка в несколько конечных точек** | Да, одно сообщение можно отправить в несколько конечных точек. | Да, одно сообщение можно отправить в несколько конечных точек.  
| **Безопасность** | Центр Интернета вещей обеспечивает идентификацию каждого устройства и управление доступом с возможностью отзыва. Дополнительные сведения см. в статье об [управлении доступом в Центре Интернета вещей](iot-hub-devguide-security.md). | "Сетка событий" обеспечивает проверку трех пунктов: подписки на событие, публикации событий и доставки событий веб-перехватчику. Дополнительные сведения см. в разделе [Сетка событий: безопасность и проверка подлинности](../event-grid/security-authentication.md). |

## <a name="how-to-choose"></a>Как выбрать

Маршрутизация сообщений Центра Интернета вещей и его интегрированная версия со службой "Сетка событий" выполняют разные действия для достижения одинаковых результатов. Они принимают сведения из вашего решения Центра Интернета вещей и передают их, чтобы могли отреагировать другие службы. Как же решить, какой компонент использовать? Рассмотрим следующие вопросы, которые помогут вам принять решение: 

* **Какие данные следует отправлять в конечные точки?**

   Маршрутизацию сообщений с помощью Центра Интернета вещей лучше использовать, если нужно отправлять данные телеметрии в другие службы. Маршрутизация сообщений также позволяет адресовать запросы приложению для обмена сообщениями и свойствам системы обмена сообщениями, основной части сообщения, меткам и свойствам двойников устройств.

   Центр Интернета вещей, интегрированный со службой "Сетка событий", работает с событиями, происходящими в службе "Центр Интернета вещей". Эти события IoT Hub включают данные телеметрии, созданные устройства, удаленные, подключенные и отключенные. При подписке на события телеметрии можно применить дополнительные фильтры на данных для фильтрации свойств сообщений, тела сообщений и близнеца устройства в вашем концентраторе IoT, прежде чем опубликовать в Event Grid. [Узнайте, как фильтровать события.](../iot-hub/iot-hub-event-grid.md#filter-events)

* **Какие конечные точки должны получать эти сведения?**

   Маршрутирование сообщений IoT Hub поддерживает ограниченное количество уникальных конечных точек и типов конечных точек, но можно построить разъемы для перенаправления данных и событий в дополнительные конечные точки. Полный список поддерживаемых конечных точек см. в таблице в разделе выше. 

   Интеграция Концентратора IoT с Event Grid поддерживает 500 конечных точек на IoT Концентратор и большее разнообразие типов конечных точек. Он интегрируется с очередями Azure Functions, Logic Apps, Storage и Service Bus, а также работает с веб-крючками, чтобы расширить отправку данных за пределами экосистемы обслуживания Azure и в сторонние бизнес-приложения.

* **Важен ли порядок получения данных?**

   Центр поддерживает порядок отправки сообщений при их маршрутизации.

   Сетка событий не гарантирует, что конечные точки получат события в порядке их возникновения. В тех случаях, когда абсолютный порядок сообщений значителен и/или в которых потребителю необходим надежный уникальный идентификатор для сообщений, мы рекомендуем использовать реаутирование сообщений. 

## <a name="next-steps"></a>Дальнейшие действия

* Узнайте больше о [маршрутизации сообщений с помощью центра Интернета вещей](iot-hub-devguide-messages-d2c.md) и [конечных точках центра Интернета вещей](iot-hub-devguide-endpoints.md).
* Дополнительные сведения о службе "Сетка событий" Azure см. [здесь](../event-grid/overview.md).
* Дополнительные сведения о создании маршрутов сообщений см. в статье [Руководство. Настройка маршрутизации сообщений с Центром Интернета вещей](../iot-hub/tutorial-routing.md).
* Попробуйте интеграцию Event Grid, [отправив уведомления по электронной почте о событиях Azure IoT Hub с помощью logic Apps.](../event-grid/publish-iot-hub-events-to-logic-apps.md)
