---
title: Общие сведения о квотах и регулировании в Центре Интернета вещей | Документация Майкрософт
description: Руководство разработчика. Описание квот, применимых к Центру Интернета вещей, и ожидаемого поведения регулирования.
author: robinsh
ms.author: robinsh
ms.service: iot-hub
services: iot-hub
ms.topic: conceptual
ms.date: 08/08/2019
ms.openlocfilehash: 71a5737434e78bc39bccdfeb950e0dbc32ed0052
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "79284698"
---
# <a name="reference---iot-hub-quotas-and-throttling"></a>Руководство. Квоты и регулирование в Центре Интернета вещей

В этой статье разъясняется квоты для концентратора IoT и приводится информация, которая поможет вам понять, как работает регулирование.

## <a name="quotas-and-throttling"></a>Квоты и регулирование

Каждая подписка Azure может использовать не более 50 Центров Интернета вещей и не более 1 центра уровня "Бесплатный".

Каждый центр Интернета вещей подготавливается с определенным количеством единиц для каждого конкретного уровня. Уровень и число единиц определяют максимальную дневную квоту сообщений, которые вы можете отправить. Размер сообщения, используемый для расчета дневной квоты, составляет 0,5 КБ для центра уровня "Бесплатный" и 4 КБ для других уровней. Для получения дополнительной [Azure IoT Hub Pricing](https://azure.microsoft.com/pricing/details/iot-hub/)информации см.

Уровень также определяет пределы регулирования, устанавливаемые Центром Интернета вещей для выполнения всех операций.

### <a name="iot-plug-and-play"></a>IoT Plug and Play

Во время публичного предварительного просмотра устройства IoT Plug и Play будут отправлять отдельные сообщения на интерфейс, что может увеличить количество сообщений, учитываемых в вашей квоте сообщений.

## <a name="operation-throttles"></a>Регулирование операций

Операции дроссельной заслонки являются ограничениями скорости, которые применяются в мельчайших диапазонах и предназначены для предотвращения злоупотреблений. Они также подлежат [формированию трафика.](#traffic-shaping)

В следующей таблице показаны варианты принудительного регулирования. Значения обозначают тот или иной концентратор.

| Регулирование | Бесплатный, B1 и S1 | В2 и S2 | B3 и S3 | 
| -------- | ------- | ------- | ------- |
| [Операции реестра идентификационных данных](#identity-registry-operations-throttle) (создание, извлечение, список, обновление, удаление) | 1,67 операций в секунду на единицу (100 операций в минуту на единицу) | 1,67 операций в секунду на единицу (100 операций в минуту на единицу) | 83.33/sec/unit (5000/мин/единица) |
| [Соединения нового устройства](#device-connections-throttle) (это ограничение распространяется на скорость _новых подключений,_ а не общее количество соединений) | Более 100 в секунду или 12 в секунду на единицу <br/> Например, две единицы S1 — это 2\*12 = 24 новых подключений в секунду, но для ваших единиц имеется не менее 100 новых подключений в секунду. Для девяти единиц S1 мы получим 108 новых подключений в секунду (9\*12) для всех единиц. | 120 новых подключений/с/ед. | 6000 новых подключений/сек/единица |
| Передачи с устройства в облако | Более высокие 100 операций отправки/сек или 12 операций отправки/сек/единица <br/> Например, два блока S1 2\*12 и 24/sec, но у вас есть по крайней мере 100 операций отправки / сек через ваши подразделения. С девятью единицами S1, у вас есть\*108 отправить операций / сек (9 12) через ваши подразделения. | 120 отправки операций/сек/единица | 6000 отправки операций/сек/единица |
| Передачи из облака на устройство <sup>1</sup> | 1.67 Отправить операции/сек/единицу (100 сообщений/мин/единица) | 1.67 отправка операций/сек/единица (100 операций отправки/мин/единица) | 83.33 Отправка операций/сек/единица (5000 операций отправки/мин/единица) |
| Прием из облака на устройство <sup>1</sup> <br/> (только если устройство использует HTTPS)| 16.67 Получать операции/сек/единицу (1000 получаемых операций/мин/единица) | 16.67 Получать операции/сек/единицу (1000 получаемых операций/мин/единица) | 833.33 Получать операции/сек/единица (50 000 операций/мин/единица) |
| Передача файла | 1.67 файл загрузить посвящения / сек / единица (100/мин/ единица) | 1.67 файл загрузить посвящения / сек / единица (100/мин/ единица) | 83.33 Посвящение файла/сек/единица (5000/мин/единица) |
| Прямые методы<sup>1</sup> | 160 КБ/сек/единицу<sup>2</sup> | 480 КБ/сек/единицу<sup>2</sup> | 24 МБ/сек/единицу<sup>2</sup> | 
| Запросы | 20/мин/единица | 20/мин/единица | 1000/мин/единица |
| Операции чтения двойников устройств и модулей<sup>1</sup> | 100/сек | Более 100/сек или 10/сек/единица | 500/сек/единица |
| Обновление двойников устройств и двойников модулей<sup>1</sup> | 50/сек | Более 50/сек или 5/сек/единица | 250/сек/единица |
| Операции с заданиями<sup>1</sup> <br/> (создание, обновление, перечисление и удаление) | 1,67 операций в секунду на единицу (100 операций в минуту на единицу) | 1,67 операций в секунду на единицу (100 операций в минуту на единицу) | 83.33/sec/unit (5000/мин/единица) |
| Операции с заданиями на устройстве<sup>1</sup> <br/> (обновление двойника, вызов прямого метода) | 10 в секунду | Более 10 в секунду или 1 в секунду на единицу | 50 в секунду на единицу |
| Конфигурации и развертывания Edge<sup>1</sup> <br/> (создание, обновление, перечисление и удаление) | 0,33/с/ед. (мин/20/ед.) | 0,33/с/ед. (мин/20/ед.) | 0,33/с/ед. (мин/20/ед.) |
| Скорость инициирования потока устройств<sup>1</sup> | 5 новых потоков в секунду | 5 новых потоков в секунду | 5 новых потоков в секунду |
| Максимальное количество одновременно подключенных потоков устройств<sup>1</sup> | 50 | 50 | 50 |
| Максимальная передача данных потока устройств<sup>1</sup> (общий объем в день) | 300 МБ | 300 МБ | 300 МБ |

<sup>1</sup>Эта функция недоступна на базовом уровне Центра Интернета вещей. Дополнительные сведения см. в статье [Масштабирование решения для Центра Интернета вещей](iot-hub-scaling.md). <br/><sup>2</sup> Размер дроссельного счетчика составляет 4 КБ.

### <a name="throttling-details"></a>Детали дроссельной заслонки

* Размер метра определяет, при каких приращениях потребляется ваш предел регулирования. Если полезная нагрузка вашего прямого вызова составляет от 0 до 4 кБ, она засчитывается как 4 КБ. Вы можете сделать до 40 вызовов в секунду на единицу, прежде чем нажимать предел 160 КБ / сек / единица.

   Аналогичным образом, если ваша полезная нагрузка составляет от 4 кБ и 8 КБ, каждый вызов приходится 8 КБ, и вы можете сделать до 20 вызовов в секунду на единицу, прежде чем ударить максимальный предел.

   Наконец, если ваш размер полезной нагрузки составляет от 156КБ до 160 кБ, вы сможете сделать только 1 вызов в секунду на единицу в вашем концентраторе, прежде чем ударить предел 160 КБ / сек / единица.

*  Для *операций устройства Jobs (обновление двойного, вызвать прямой метод)* для уровня S2, 50/sec/unit применяется только при использовании методов с использованием заданий. Если вы ссылаетесь непосредственно методы непосредственно, исходный предел регулирования 24 МБ / сек / единица (для S2) применяется.

*  **Квота** — это общее количество сообщений, которые можно отправлять в концентраторе *в день.* Лимит квот ы вашего концентратора под столбцом **Общее количество сообщений/день** на [странице ценообразования IoT Hub.](https://azure.microsoft.com/pricing/details/iot-hub/)

*  Ваши отоблака к устройству и от устройства к облаку дроссели определить максимальную *скорость,* с которой вы можете отправлять сообщения - количество сообщений, независимо от 4 КБ куски. Каждое сообщение может быть до 256 КБ, что является [максимальным размером сообщения.](iot-hub-devguide-quotas-throttling.md#other-limits)

*  Это хорошая практика, чтобы задушить ваши звонки, так что вы не попали / превысить границы регулирования. Если вы достигли предела, IoT Концентронет отвечает кодом ошибки 429, и клиент должен отступить и повторить попытку. Эти ограничения на один концентратор (или в некоторых случаях на концентратор/единицу). Для получения дополнительной информации обратитесь к [управлению подключением и надежными шаблонами обмена сообщениями/повтора.](iot-hub-reliability-features-in-sdks.md#retry-patterns)

### <a name="traffic-shaping"></a>Формирование трафика

Чтобы учесть взрывной трафик, IoT Концентрон принимает запросы выше дроссельной заслонки в течение ограниченного времени. Первые несколько из этих запросов обрабатываются немедленно. Однако, если количество запросов продолжает нарушать дроссельный промысел, IoT Концентрон начинает размещать запросы в очереди и обрабатываться по предельному тарифу. Этот эффект называется *формированием трафика.* Кроме того, размер этой очереди ограничен. Если нарушение дроссельной заслонки продолжается, в конечном итоге `429 ThrottlingException`очередь заполняется, и IoT Концентронист начинает отклонять запросы с помощью .

Например, вы используете смоделированное устройство для отправки 200 сообщений от устройства к облаку в секунду в ваш концентратор S1 IoT (который имеет лимит 100/sec D2C. В течение первой минуты или двух сообщений обрабатываются немедленно. Однако, поскольку устройство продолжает отправлять больше сообщений, чем предел дроссельной заслонки, IoT Hub начинает обрабатывать только 100 сообщений в секунду и ставит остальные в очередь. Вы начинаете замечать увеличение задержки. В конце концов, вы начинаете получать, `429 ThrottlingException` как очередь заполняется, и "количество ошибок дроссельной заслонки" в [метриках IoT концентратора](iot-hub-metrics.md) начинает увеличиваться.

### <a name="identity-registry-operations-throttle"></a>Операции реестра идентификационных данных заслоняемы

Операции реестра идентификационных данных устройств предназначены для использования в течение времени в сценариях управления устройствами и подготовки устройств. Чтение или обновление большого количества удостоверений устройств поддерживается с помощью [заданий импорта и экспорта](iot-hub-devguide-identity-registry.md#import-and-export-device-identities).

### <a name="device-connections-throttle"></a>Соединения устройств дроссельной заслонки

Регулирование *подключений устройств* определяет скорость, с которой можно установить новые подключения устройства к Центру Интернета вещей. Регулирование *подключений устройства* не влияет на максимальное число одновременно подключенных устройств. Регулирование скорости *подключений устройства* зависит от числа единиц, подготовленных для Центра Интернета вещей.

Например, если вы приобретаете одну единицу S1, то получаете регулирование 100 соединений в секунду. Таким образом, чтобы подключить 100 000 устройств, требуется не менее 1000 секунд (примерно 16 минут). Однако вы можете иметь столько одновременно подключенных устройств, сколько устройств зарегистрировано в вашем реестре удостоверений.

## <a name="other-limits"></a>Другие ограничения

Центр Интернета вещей применяет другие операционные ограничения:

| Операция | Ограничение |
| --------- | ----- |
| Устройства | Общее количество устройств плюс модули, которые могут быть зарегистрированы в одном концентраторе IoT, ограничено 1 000 000. Единственный способ увеличить этот лимит — связаться с [службой поддержки Майкрософт.](https://azure.microsoft.com/support/options/)|
| Передача файлов | 10 одновременных загрузок файлов на устройство. |
| Задания<sup>1</sup> | Максимальная одновременные задания : 1 (для free и S1), 5 (для S2) и 10 (для S3). Тем не менее, максимальное одновременное [устройство импорта / экспорта рабочих мест](iot-hub-bulk-identity-mgmt.md) составляет 1 для всех уровней. <br/>История работы сохраняется до 30 дней. |
| Дополнительные конечные точки | Платные центры SKU могут иметь 10 дополнительных конечных точек. Бесплатные центры SKU могут иметь одну дополнительную конечную точку. |
| Запросы на разгром сообщений | Платные концентраторы SKU могут иметь 100 запросов на выгоду. Бесплатные концентраторы SKU могут иметь пять запросов на выдвижение. |
| Обогащение сообщений | Платные концентраторы SKU могут иметь до 10 сообщений обогащения. Бесплатные концентраторы SKU могут иметь до 2 сообщений обогащения.|
| Передача сообщений с устройства в облако | Максимальный размер сообщения — 256 КБ |
| Передача сообщений из облака на устройство<sup>1</sup> | Максимальный размер сообщения — 64 КБ. Максимальное количество ожидающих сообщений для доставки составляет 50 на устройство. |
| Прямой метод<sup>1</sup> | Максимальный размер полезных данных прямого метода — 128 КБ. |
| Конфигурации автоматического устройства и модуля<sup>1</sup> | 100 конфигураций на платный центр SKU. 20 конфигураций на бесплатный центр SKU. |
| Автоматическое развертывание IoT Edge<sup>1</sup> | 50 модулей на развертывание. 100 развертываний (включая многоуровневые развертывания) на платный концентратор SKU. 10 развертываний на бесплатный концентратор SKU. |
| Двойники<sup>1</sup> | Максимальный размер желаемых свойств и заявленных разделов свойств составляет 32 КБ каждый. Максимальный размер раздела тегов составляет 8 КБ. |
| Политики общего доступа | Максимальное количество политик общего доступа составляет 16 |

<sup>1</sup>Эта функция недоступна на базовом уровне Центра Интернета вещей. Дополнительные сведения см. в статье [Масштабирование решения для Центра Интернета вещей](iot-hub-scaling.md).

## <a name="increasing-the-quota-or-throttle-limit"></a>Увеличение лимита квоты или дроссельной заслонки

В любой момент времени можно увеличить квоты или ограничения заслонки, [увеличив количество подготовленных единиц в концентраторе IoT.](iot-hub-upgrade.md)

## <a name="latency"></a>Задержка

Центр Интернета вещей стремится обеспечить малую задержку при выполнении всех операций. Однако из-за сетевых условий и других непредсказуемых факторов он не может гарантировать определенную задержку. При разработке решения учитывайте следующее:

* Не делайте никаких предположений о максимально низкой задержке любой операции Центра Интернета вещей.
* Подготовьте Центр Интернета вещей в ближайшем к вашим устройствам регионе Azure.
* Рассмотрите возможность использования Azure IoT Edge для выполнения чувствительных к задержке операций на устройстве или в шлюзе рядом с устройством.

Несколько единиц Центра Интернета вещей влияют на регулирование, как описано выше, но не обеспечивают дополнительные преимущества или гарантии относительно задержки.

Обратитесь в [службу поддержки Майкрософт](https://azure.microsoft.com/support/options/) в случае непредвиденного увеличения задержки операций.

## <a name="next-steps"></a>Дальнейшие действия

В записи блога, посвященной [регулированию в Центре Интернета вещей](https://azure.microsoft.com/blog/iot-hub-throttling-and-you/), приводится подробное описание стратегии регулирования в Центре Интернета вещей.

Другие справочные статьи в руководстве разработчика для Центра Интернета вещей:

* [IoT Hub endpoints](iot-hub-devguide-endpoints.md) (Конечные точки Центра Интернета вещей)
