---
title: Поддержка виртуальных сетей в центре Интернета вещей Azure
description: Использование шаблона подключения к виртуальным сетям с помощью Центра Интернета вещей
services: iot-hub
author: jlian
ms.service: iot-fundamentals
ms.topic: conceptual
ms.date: 09/24/2020
ms.author: jlian
ms.openlocfilehash: 6c562f7a5d9c7c02c737898821eef5ee5271eea4
ms.sourcegitcommit: 829d951d5c90442a38012daaf77e86046018e5b9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/09/2020
ms.locfileid: "91613906"
---
# <a name="iot-hub-support-for-virtual-networks-with-private-link-and-managed-identity"></a>Поддержка Центра Интернета вещей для виртуальных сетей с Приватным каналом и управляемым удостоверением

По умолчанию имена узлов центра Интернета вещей сопоставляются с общедоступной конечной точкой с общедоступным IP-адресом через Интернет. Разные клиенты совместно используют эту общедоступную конечную точку Центра Интернета вещей, и получить к ней доступ могут все устройства Интернета вещей в глобальных и локальных сетях.

![Общедоступная конечная точка Центра Интернета вещей](./media/virtual-network-support/public-endpoint.png)

Для работы функции Центра Интернета вещей, включая [маршрутизацию сообщений](./iot-hub-devguide-messages-d2c.md), [отправку файлов](./iot-hub-devguide-file-upload.md) и [импорт/экспорт устройств](./iot-hub-bulk-identity-mgmt.md), также требуется подключение из Центра Интернета вещей к ресурсу Azure, принадлежащему клиенту, через общедоступную конечную точку. Эти пути подключения формируют исходящий трафик из Центра Интернета вещей на ресурсы клиента.

Может потребоваться ограничить возможности подключения к ресурсам Azure (включая Центр Интернета вещей) через виртуальную сеть, которой вы владеете. Некоторые из причин:

* Обеспечение сетевой изоляции для Центра Интернета вещей за счет предотвращения подключения к общедоступному Интернету.

* Включение частного подключения от локальных сетевых ресурсов, гарантирующих передачу данных и трафика непосредственно в магистральную сеть Azure.

* Предотвращение атак, связанных с кражей данных из конфиденциальных локальных сетей. 

* Соблюдение шаблонов подключения, заданных на уровне Azure, с помощью [частных конечных точек](../private-link/private-endpoint-overview.md).

В этой статье описывается, как добиться этих целей с помощью [Приватного канала Azure](../private-link/private-link-overview.md) для входящего подключения к Центру Интернета вещей и использования доверенных служб Майкрософт для исходящего подключения из Центра Интернета вещей к другим ресурсам Azure.

## <a name="ingress-connectivity-to-iot-hub-using-azure-private-link"></a>Входящее подключение к Центру Интернета вещей с помощью Приватного канала Azure

Частная конечная точка — это частный IP-адрес, выделенный внутри виртуальной сети клиента, с помощью которого ресурс Azure становится доступным. С помощью Приватного канала Azure можно настроить частную конечную точку для Центра Интернета вещей, чтобы разрешить службам в виртуальной сети доступ к Центру Интернета вещей без необходимости отправлять трафик в общедоступную конечную точку Центра Интернета вещей. Аналогичным образом локальные устройства могут использовать [виртуальную частную сеть (VPN)](../vpn-gateway/vpn-gateway-about-vpngateways.md) или пиринг [ExpressRoute](https://azure.microsoft.com/services/expressroute/), чтобы получить возможность подключения к виртуальной сети и Центру Интернета вещей (через его частную конечную точку). В результате вы можете ограничить или полностью заблокировать подключение к общедоступным конечным точкам Центра Интернета вещей с помощью [фильтра IP-адресов Центра Интернета вещей](./iot-hub-ip-filtering.md) и [маршрутизации, исключающей отправку каких-либо данных во встроенную конечную точку](#built-in-event-hub-compatible-endpoint-doesnt-support-access-over-private-endpoint). Такой подход обеспечивает подключение к Центру с помощью частной конечной точки для устройств. Основной задачей этой установки является наличие устройств в локальной сети. Такая схема не рекомендуется для устройств, развернутых в глобальной сети.

![Енгресс виртуальной сети центра Интернета вещей](./media/virtual-network-support/virtual-network-ingress.png)

Прежде чем продолжать, убедитесь, что выполняются следующие необходимые условия.

* Вы [создали виртуальную сеть Azure](../virtual-network/quick-create-portal.md) с подсетью, в которой будет создана частная конечная точка.

* Для устройств, которые работают в локальных сетях, настройте [виртуальную частную сеть (VPN)](../vpn-gateway/vpn-gateway-about-vpngateways.md) или частный пиринг [ExpressRoute](https://azure.microsoft.com/services/expressroute/) в виртуальную сеть Azure.

### <a name="set-up-a-private-endpoint-for-iot-hub-ingress"></a>Настройка частной конечной точки для входящего трафика Центра Интернета вещей

Частная конечная точка работает для API устройств центра Интернета вещей (например, для сообщений, отправляемых с устройства в облако), а также API службы (например, для создания и обновления устройств).

1. На портале Azure выберите **Сеть**, **Подключения частных конечных точек** и нажмите **+ Частная конечная точка**.

    :::image type="content" source="media/virtual-network-support/private-link.png" alt-text="Снимок экрана: добавление частной конечной точки для Центра Интернета вещей":::

1. Укажите подписку, группу ресурсов, имя и регион для создания новой частной конечной точки. В идеале частная конечная точка должна быть создана в том же регионе, что и центр.

1. Щелкните **Далее: ресурс** и укажите подписку для ресурса Центра Интернета вещей, а затем выберите **"Microsoft.Devices/IotHubs"** в качестве типа ресурса, имя своего Центра Интернета вещей в качестве **ресурса** и **iotHub** в качестве целевого подресурса.

1. Щелкните **Далее: конфигурация** и укажите виртуальную сеть и подсеть для создания частной конечной точки. При необходимости выберите параметр для интеграции с частной зоной DNS Azure.

1. Щелкните **Далее: теги** и при необходимости укажите теги для ресурса.

1. Нажмите **Проверить и создать**, чтобы создать ресурс частной связи.

### <a name="built-in-event-hub-compatible-endpoint-doesnt-support-access-over-private-endpoint"></a>Встроенная совместимая с концентратором событий конечная точка не поддерживает доступ к частной конечной точке

[Встроенная совместимая с концентратором событий конечная точка](iot-hub-devguide-messages-read-builtin.md) не поддерживает доступ к частной конечной точке. Если настроена, частная конечная точка Центра Интернета вещей предназначена только для входящего подключения. Использование данных из встроенной совместимой с концентратором событий конечной точки возможно только через общедоступный Интернет. 

[Фильтр IP-адресов](iot-hub-ip-filtering.md) Центра Интернета вещей также не контролирует общий доступ ко встроенной конечной точке. Чтобы полностью заблокировать доступ к Центру Интернета вещей из общедоступной сети, необходимо выполнить следующие действия. 

1. Настройте доступ частной конечной точки к Центру Интернета вещей.
1. [Отключите доступ к общедоступной сети](iot-hub-public-network-access.md) или используйте IP-фильтр для блокировки всех IP-адресов.
1. Отключите использование встроенной конечной точки концентратора событий, [настроив маршрутизацию, чтобы она не отправляла в нее данные](iot-hub-devguide-messages-d2c.md) .
1. Отключите [резервный маршрут](iot-hub-devguide-messages-d2c.md#fallback-route).
1. Настройте исходящее подключение для других ресурсов Azure с помощью [доверенной службы Майкрософт](#egress-connectivity-from-iot-hub-to-other-azure-resources).

### <a name="pricing-for-private-link"></a>Расценки на Приватный канал Azure

Дополнительные сведения о ценах см. на [странице цен на службу "Приватный канал" Azure](https://azure.microsoft.com/pricing/details/private-link).

## <a name="egress-connectivity-from-iot-hub-to-other-azure-resources"></a>Исходящие подключения из Центра Интернета вещей к другим ресурсам Azure

Центр Интернета вещей может подключаться к хранилищу BLOB-объектов Azure, концентратору событий, ресурсам служебной шины для [маршрутизации сообщений](./iot-hub-devguide-messages-d2c.md), [отправки файлов](./iot-hub-devguide-file-upload.md) и [импорта/экспорта устройств](./iot-hub-bulk-identity-mgmt.md) с помощью общедоступной конечной точки ресурсов. Привязка ресурса к виртуальной сети блокирует подключение к ресурсу по умолчанию. В результате такая конфигурация предотвращает отправку данных из Центра Интернета вещей на ресурсы. Чтобы устранить эту проблему, включите подключение из ресурса Центра Интернета вещей к учетной записи хранения, концентратору событий или ресурсам служебной шины с помощью **доверенной службы Майкрософт**.

### <a name="turn-on-managed-identity-for-iot-hub"></a>Включение управляемого удостоверения для Центра Интернета вещей

Чтобы другие службы рассматривали Центр Интернета вещей как доверенную службу Майкрософт, ему следует назначить управляемое удостоверение.

1. Перейдите в раздел **Удостоверение** на портале Центра Интернета вещей.

1. В разделе **Состояние**выберите **Включить**, а затем нажмите **Сохранить**.

    :::image type="content" source="media/virtual-network-support/managed-identity.png" alt-text="Снимок экрана: добавление частной конечной точки для Центра Интернета вещей":::

### <a name="assign-managed-identity-to-your-iot-hub-at-creation-time-using-arm-template"></a>Назначение управляемого удостоверения для центра Интернета вещей во время создания с помощью шаблона ARM

Чтобы назначить управляемое удостоверение для центра Интернета вещей во время подготовки ресурсов, используйте шаблон ARM ниже:

```json
{
  "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "resources": [
    {
      "type": "Microsoft.Devices/IotHubs",
      "apiVersion": "2020-03-01",
      "name": "<provide-a-valid-resource-name>",
      "location": "<any-of-supported-regions>",
      "identity": {
        "type": "SystemAssigned"
      },
      "sku": {
        "name": "<your-hubs-SKU-name>",
        "tier": "<your-hubs-SKU-tier>",
        "capacity": 1
      }
    },
    {
      "type": "Microsoft.Resources/deployments",
      "apiVersion": "2018-02-01",
      "name": "updateIotHubWithKeyEncryptionKey",
      "dependsOn": [
        "<provide-a-valid-resource-name>"
      ],
      "properties": {
        "mode": "Incremental",
        "template": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "contentVersion": "0.9.0.0",
          "resources": [
            {
              "type": "Microsoft.Devices/IotHubs",
              "apiVersion": "2020-03-01",
              "name": "<provide-a-valid-resource-name>",
              "location": "<any-of-supported-regions>",
              "identity": {
                "type": "SystemAssigned"
              },
              "sku": {
                "name": "<your-hubs-SKU-name>",
                "tier": "<your-hubs-SKU-tier>",
                "capacity": 1
              }
            }
          ]
        }
      }
    }
  ]
}
```

После замены значений для ресурса, `name` `location` `SKU.name` и `SKU.tier` можно использовать Azure CLI для развертывания ресурса в существующей группе ресурсов с помощью:

```azurecli-interactive
az deployment group create --name <deployment-name> --resource-group <resource-group-name> --template-file <template-file.json>
```

После создания ресурса можно получить управляемое удостоверение службы, назначенное концентратору, с помощью Azure CLI:

```azurecli-interactive
az resource show --resource-type Microsoft.Devices/IotHubs --name <iot-hub-resource-name> --resource-group <resource-group-name>
```

### <a name="pricing-for-managed-identity"></a>Расценки на управляемое удостоверение

Функция исключения доверенных служб Майкрософт предоставляется бесплатно. Подготовленные учетные записи хранения, концентраторы событий или ресурсы служебной шины оплачиваются отдельно.

### <a name="egress-connectivity-to-storage-account-endpoints-for-routing"></a>Исходящее подключение к конечным точкам учетной записи хранения для маршрутизации

Центр Интернета вещей может маршрутизировать сообщения в учетную запись хранения, принадлежащую заказчику. Чтобы разрешить функции маршрутизации доступ к учетной записи хранения при наличии ограничений брандмауэра, Центру Интернета вещей требуется [управляемое](#turn-on-managed-identity-for-iot-hub) удостоверение. После подготовки управляемого удостоверения выполните приведенные ниже действия, чтобы предоставить разрешение RBAC удостоверению ресурса центра, чтобы получить доступ к учетной записи хранения.

1. На портале Azure перейдите на вкладку **Управление доступом (IAM)** своей учетной записи хранения и в разделе **Добавление назначения роли** нажмите **Добавить**.

2. Выберите **роль** **Участник для данных BLOB-объектов хранилища** ([*не* "Участник" или "Участник учетных записей хранения"](../storage/common/storage-auth-aad-rbac-portal.md#azure-roles-for-blobs-and-queues)), и **пользователя Azure AD, группу или субъект-службу** в качестве **назначения доступа** и выберите имя ресурса Центра Интернета вещей в раскрывающемся списке. Нажмите кнопку **Сохранить** .

3. Перейдите на вкладку **Брандмауэры и виртуальные сети** в учетной записи хранения и включите параметр **Разрешить доступ из выбранных сетей**. В разделе **Исключения** установите флажок **Разрешить доверенным службам Майкрософт доступ к этой учетной записи хранения**. Нажмите кнопку **Сохранить** .

4. На странице ресурсов Центра Интернета вещей перейдите на вкладку **Маршрутизация сообщений**.

5. Перейдите в раздел **Пользовательские конечные точки** и щелкните **Добавить**. В качестве типа конечной точки выберите **Хранилище**.

6. На появившейся странице укажите имя конечной точки, выберите контейнер, который вы хотите использовать в хранилище BLOB-объектов, укажите кодировку и формат имени файла. Выберите **удостоверение на основе удостоверения** в качестве **типа проверки подлинности** для конечной точки хранилища. Нажмите кнопку **Создать** .

Теперь пользовательская конечная точка хранилища настроена на использование удостоверения, назначенного системой концентратора, и имеет разрешение на доступ к ресурсу хранилища, несмотря на ограничения брандмауэра. Теперь эту конечную точку можно использовать для настройки правила маршрутизации.

### <a name="egress-connectivity-to-event-hubs-endpoints-for-routing"></a>Исходящее подключение к конечным точкам концентраторов событий для маршрутизации

Центр Интернета вещей можно настроить для маршрутизации сообщений в пространство имен концентраторов событий, принадлежащее заказчику. Чтобы разрешить функции маршрутизации доступ к ресурсу концентраторов событий при наличии ограничений брандмауэра, Центру Интернета вещей требуется управляемое удостоверение. После создания управляемого удостоверения выполните приведенные ниже действия, чтобы предоставить разрешение RBAC удостоверению ресурса центра, чтобы получить доступ к концентраторам событий.

1. На портале Azure перейдите на вкладку **Управление доступом (IAM)** своих концентраторов событий и в разделе **Добавление назначения роли** нажмите **Добавить**.

2. Выберите **роль** **Отправитель данных Центров событий** и **пользователя Azure AD, группу или субъект-службу** в качестве **назначения доступа** и выберите имя ресурса Центра Интернета вещей в раскрывающемся списке. Нажмите кнопку **Сохранить** .

3. Перейдите на вкладку **Брандмауэры и виртуальные сети** в концентраторах событий и включите параметр **Разрешить доступ из выбранных сетей**. В разделе **Исключения** установите флажок **Разрешить доверенным службам Майкрософт доступ к этим концентраторам событий**. Нажмите кнопку **Сохранить** .

4. На странице ресурсов Центра Интернета вещей перейдите на вкладку **Маршрутизация сообщений**.

5. Перейдите в раздел **Пользовательские конечные точки** и щелкните **Добавить**. Выберите **Концентраторы событий** в качестве типа конечной точки.

6. На появившейся странице укажите имя конечной точки, выберите пространство имен концентраторов событий и экземпляр, а затем нажмите кнопку **Создать**.

Теперь пользовательская конечная точка концентраторов событий настроена на использование удостоверения, назначенного системой концентратора, и имеет разрешение на доступ к ресурсу концентраторов событий, несмотря на ограничения брандмауэра. Теперь эту конечную точку можно использовать для настройки правила маршрутизации.

### <a name="egress-connectivity-to-service-bus-endpoints-for-routing"></a>Исходящее подключение к конечным точкам служебной шины для маршрутизации

Центр Интернета вещей можно настроить для маршрутизации сообщений в пространство имен служебной шины, принадлежащее заказчику. Чтобы разрешить функции маршрутизации доступ к ресурсу служебной шины при наличии ограничений брандмауэра, Центру Интернета вещей требуется управляемое удостоверение. После подготовки управляемого удостоверения выполните приведенные ниже действия, чтобы предоставить разрешение RBAC удостоверению ресурса центра, чтобы получить доступ к служебной шине.

1. На портале Azure перейдите на вкладку **Управление доступом (IAM)** своей служебной шины и в разделе **Добавление назначения роли** нажмите **Добавить**.

2. Выберите **роль** **Отправитель данных служебной шины** и **пользователя Azure AD, группу или субъект-службу** в качестве **назначения доступа** и выберите имя ресурса Центра Интернета вещей в раскрывающемся списке. Нажмите кнопку **Сохранить** .

3. Перейдите на вкладку **Брандмауэры и виртуальные сети** в служебной шине и включите параметр **Разрешить доступ из выбранных сетей**. В разделе **Исключения** установите флажок **Разрешить доверенным службам Майкрософт доступ к этой служебной шине**. Нажмите кнопку **Сохранить** .

4. На странице ресурсов Центра Интернета вещей перейдите на вкладку **Маршрутизация сообщений**.

5. Перейдите в раздел **Пользовательские конечные точки** и щелкните **Добавить**. Выберите **Очередь служебной шины** или **Раздел служебной шины** в качестве типа конечной точки.

6. На появившейся странице укажите имя конечной точки, выберите пространство имен служебной шины и очередь или раздел. Нажмите кнопку **Создать** .

Теперь пользовательская конечная точка служебной шины настроена на использование удостоверения, назначенного системой концентратора, и имеет разрешение на доступ к ресурсу служебной шины, несмотря на ограничения брандмауэра. Теперь эту конечную точку можно использовать для настройки правила маршрутизации.

### <a name="egress-connectivity-to-storage-accounts-for-file-upload"></a>Исходящие подключения к учетным записям хранения для передачи файлов

Функция отправки файлов в Центре Интернета вещей позволяет устройствам передавать файлы в учетную запись хранения, принадлежащую заказчику. Чтобы разрешить функцию отправки файла, устройства и Центр Интернета вещей должны иметь подключение к учетной записи хранения. Если в учетной записи хранения установлены ограничения брандмауэра, устройствам необходимо использовать любой поддерживаемый механизм учетной записи хранения (включая [частные конечные точки](../private-link/create-private-endpoint-storage-portal.md), [конечные точки службы](../virtual-network/virtual-network-service-endpoints-overview.md) или [прямую конфигурацию брандмауэра](../storage/common/storage-network-security.md)) для получения подключения. Аналогично, если в учетной записи хранения установлены ограничения брандмауэра, Центр Интернета вещей должен быть настроен для доступа к ресурсу хранилища через исключение доверенных служб Майкрософт. Для этого Центру Интернета вещей требуется управляемое удостоверение. После подготовки управляемого удостоверения выполните приведенные ниже действия, чтобы предоставить разрешение RBAC удостоверению ресурса центра, чтобы получить доступ к учетной записи хранения.

[!INCLUDE [iot-hub-include-x509-ca-signed-file-upload-support-note](../../includes/iot-hub-include-x509-ca-signed-file-upload-support-note.md)]

1. На портале Azure перейдите на вкладку **Управление доступом (IAM)** своей учетной записи хранения и в разделе **Добавление назначения роли** нажмите **Добавить**.

2. Выберите **роль** **Участник для данных BLOB-объектов хранилища** ([*не* "Участник" или "Участник учетных записей хранения"](../storage/common/storage-auth-aad-rbac-portal.md#azure-roles-for-blobs-and-queues)), и **пользователя Azure AD, группу или субъект-службу** в качестве **назначения доступа** и выберите имя ресурса Центра Интернета вещей в раскрывающемся списке. Нажмите кнопку **Сохранить** .

3. Перейдите на вкладку **Брандмауэры и виртуальные сети** в учетной записи хранения и включите параметр **Разрешить доступ из выбранных сетей**. В разделе **Исключения** установите флажок **Разрешить доверенным службам Майкрософт доступ к этой учетной записи хранения**. Нажмите кнопку **Сохранить** .

4. На странице ресурсов Центра Интернета вещей перейдите на вкладку **Отправка файлов**.

5. На появившейся странице выберите контейнер, который вы планируете использовать в хранилище BLOB-объектов, настройте параметры уведомлений**Настройки уведомлений о файлах**, **Срок жизни SAS**, **Срок жизни по умолчанию** и **Максимальное число доставок** требуемым образом. Выберите **удостоверение на основе удостоверения** в качестве **типа проверки подлинности** для конечной точки хранилища. Нажмите кнопку **Создать** . Если на этом этапе появляется сообщение об ошибке, временно настройте учетную запись хранения, разрешающую доступ из **всех сетей**, а затем повторите попытку. Вы можете настроить брандмауэр в учетной записи хранения после завершения настройки передачи файла.

Теперь конечная точка для отправки файлов настроена на использование удостоверения, назначенного системой концентратора, и имеет разрешение на доступ к ресурсу хранилища, несмотря на ограничения брандмауэра.

### <a name="egress-connectivity-to-storage-accounts-for-bulk-device-importexport"></a>Исходящие подключения к учетным записям хранения для массового импорта и экспорта устройств

Центр Интернета вещей поддерживает массовый [импорт и экспорт](./iot-hub-bulk-identity-mgmt.md) сведений об устройствах из предоставленного клиентом большого двоичного объекта или в него. Чтобы разрешить функцию массового импорта/экспорта, устройства и Центр Интернета вещей должны иметь подключение к учетной записи хранения.

Для использования этой функции требуется подключение из Центра Интернета вещей к учетной записи хранения. Чтобы получить доступ к ресурсу служебной шины при наличии ограничений брандмауэра, Центру Интернета вещей требуется управляемое удостоверение. После подготовки управляемого удостоверения выполните приведенные ниже действия, чтобы предоставить разрешение RBAC удостоверению ресурса центра, чтобы получить доступ к служебной шине.

1. На портале Azure перейдите на вкладку **Управление доступом (IAM)** своей учетной записи хранения и в разделе **Добавление назначения роли** нажмите **Добавить**.

2. Выберите **роль** **Участник для данных BLOB-объектов хранилища** ([*не* "Участник" или "Участник учетных записей хранения"](../storage/common/storage-auth-aad-rbac-portal.md#azure-roles-for-blobs-and-queues)), и **пользователя Azure AD, группу или субъект-службу** в качестве **назначения доступа** и выберите имя ресурса Центра Интернета вещей в раскрывающемся списке. Нажмите кнопку **Сохранить** .

3. Перейдите на вкладку **Брандмауэры и виртуальные сети** в учетной записи хранения и включите параметр **Разрешить доступ из выбранных сетей**. В разделе **Исключения** установите флажок **Разрешить доверенным службам Майкрософт доступ к этой учетной записи хранения**. Нажмите кнопку **Сохранить** .

Теперь вы можете использовать REST API службы Интернета вещей Azure для [создания заданий импорта/экспорта](https://docs.microsoft.com/rest/api/iothub/service/jobs/getimportexportjobs) для получения сведений об использовании функций массового импорта и экспорта. В тексте запроса необходимо указать `storageAuthenticationType="identityBased"` и использовать `inputBlobContainerUri="https://..."` и `outputBlobContainerUri="https://..."` в качестве входного и выходного URL-адресов учетной записи хранения, соответственно.

Пакеты SDK для Центра Интернета вещей Azure также поддерживают эту функцию в диспетчере реестра клиента службы. В следующем фрагменте кода показано, как инициировать задание импорта или экспорта в с помощью пакета SDK для C#.

```csharp
// Call an import job on the IoT Hub
JobProperties importJob = 
await registryManager.ImportDevicesAsync(
  JobProperties.CreateForImportJob(inputBlobContainerUri, outputBlobContainerUri, null, StorageAuthenticationType.IdentityBased), 
  cancellationToken);

// Call an export job on the IoT Hub to retrieve all devices
JobProperties exportJob = 
await registryManager.ExportDevicesAsync(
    JobProperties.CreateForExportJob(outputBlobContainerUri, true, null, StorageAuthenticationType.IdentityBased),
    cancellationToken);
```

Использование этой версии пакетов SDK для Центра Интернета вещей Azure IoT с поддержкой виртуальных сетей для C#, Java и Node.js

1. Создайте переменную среды с именем `EnableStorageIdentity` и присвойте ей значение `1`.

2. Скачайте пакет SDK:  [Java](https://aka.ms/vnetjavasdk) | [C#](https://aka.ms/vnetcsharpsdk) | [Node.js](https://aka.ms/vnetnodesdk)
 
Для Python скачайте ограниченную версию с сайта GitHub.

1. Перейдите на [страницу выпуска GitHub](https://aka.ms/vnetpythonsdk).

2. Скачайте следующий файл, который находится в нижней части страницы выпуска в разделе **Assets** (Ресурсы).
    > *azure_iot_hub-2.2.0_limited-py2.py3-none-any.whl*

3. Откройте терминал и перейдите в папку с скачанным файлом.

4. Выполните следующую команду, чтобы установить пакет SDK для службы Python с поддержкой виртуальных сетей:
    > pip install ./azure_iot_hub-2.2.0_limited-py2.py3-none-any.whl


## <a name="next-steps"></a>Дальнейшие действия

Используйте приведенные ниже ссылки для получения дополнительных сведений о функциях Центра Интернета вещей:

* [Маршрутизация сообщений](./iot-hub-devguide-messages-d2c.md)
* [Отправка файлов](./iot-hub-devguide-file-upload.md)
* [Массовый импорт и экспорт устройств](./iot-hub-bulk-identity-mgmt.md) 
