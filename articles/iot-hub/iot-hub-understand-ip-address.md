---
title: Понимание IP-адреса вашего концентратора IoT Документы Майкрософт
description: Понять, как заставить запонимать IP-адрес концентратора IoT и его свойства. IP-адрес вашего концентратора IoT может меняться во время определенных сценариев, таких как аварийное восстановление или региональный сбой.
author: philmea
ms.author: philmea
ms.service: iot-hub
services: iot-hub
ms.topic: conceptual
ms.date: 11/21/2019
ms.openlocfilehash: c609f2a3843481442e97061739a806de60a680b5
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "79367573"
---
# <a name="iot-hub-ip-addresses"></a>IP-адреса Концентратора IoT

Приставки IP-адреса публичных конечных точек IoT Hub периодически публикуются под [тегом службы](../virtual-network/service-tags-overview.md) _AzureIoTHub._

> [!NOTE]
> Для устройств, развернутых внутри закрытых сетей, Azure IoT Hub поддерживает интеграцию подключения VNET с частными конечными точками. Дополнительную информацию можно узнать [в поддержке IoT Hub для VNET.](./virtual-network-support.md#ingress-connectivity-to-iot-hub-using-private-endpoints)


Эти префиксы IP-адреса можно использовать для управления подключением между IoT Hub и вашими устройствами или сетевыми активами для реализации различных целей сетевой изоляции:

| Цель | Применимые сценарии | Подход |
|------|-----------|----------|
| Убедитесь, что ваши устройства и службы общаются только с конечными точками IoT Hub | [Устройство к облаку](./iot-hub-devguide-messaging.md) [и](./iot-hub-devguide-messages-c2d.md) облачные сообщения, [прямые методы, близнецы](./iot-hub-devguide-direct-methods.md) [устройств и модулей](./iot-hub-devguide-device-twins.md) и [потоки устройств](./iot-hub-device-streams-overview.md) | Используйте теги служб _AzureIoTHub_ и _EventHub,_ чтобы обнаружить ip-адреса IoT и IP-адреса Событий и настроить правила ALLOW в настройках брандмауэра ваших устройств и служб для этих префиксов IP-адресов соответственно; отбросить трафик на другие IP-адреса назначения, с помощью чего вы не хотите, чтобы устройства или службы общались. |
| Убедитесь, что конечная точка устройства IoT Hub получает соединения только с ваших устройств и сетевых ресурсов | [Устройство к облаку](./iot-hub-devguide-messaging.md) [и](./iot-hub-devguide-messages-c2d.md) облачные сообщения, [прямые методы, близнецы](./iot-hub-devguide-direct-methods.md) [устройств и модулей](./iot-hub-devguide-device-twins.md) и [потоки устройств](./iot-hub-device-streams-overview.md) | Используйте [функцию IP-фильтра](iot-hub-ip-filtering.md) IoT Hub, чтобы разрешить соединения с ваших устройств и IP-адресов сетевых активов (см. раздел [ограничений).](#limitations-and-workarounds) | 
| Убедитесь, что пользовательские конечные ресурсы ваших маршрутов (учетные записи хранения, автобусы обслуживания и центры событий) доступны только из сетевых ресурсов | [Маршрутизация сообщений](./iot-hub-devguide-messages-d2c.md) | Следуйте указаниям вашего ресурса об ограничении подключения (например, с помощью [правил брандмауэра,](../storage/common/storage-network-security.md) [частных ссылок](../private-link/private-endpoint-overview.md)или [конечных точек обслуживания);](../virtual-network/virtual-network-service-endpoints-overview.md) Используйте теги _службы AzureIoTHub,_ чтобы обнаружить префиксы IP-адреса Концентратора IoT и добавить правила ALLOW для этих ip-префиксов в конфигурации брандмауэра вашего ресурса (см. раздел [ограничений).](#limitations-and-workarounds) |



## <a name="best-practices"></a>Рекомендации

* При добавлении правил ALLOW в конфигурацию брандмауэра ваших устройств лучше всего предоставлять определенные [порты, используемые применимыми протоколами.](./iot-hub-devguide-protocols.md#port-numbers)

* Префиксы IP-адреса концентратора IoT могут быть изменены. Эти изменения периодически публикуются через теги услуг до вступления в силу. Поэтому важно, чтобы вы разрабатывали процессы для регулярного извлечения и использования новейших сервисных тегов. Этот процесс можно автоматизировать с помощью [API обнаружения тегов службы.](../virtual-network/service-tags-overview.md#service-tags-on-premises) Обратите внимание, что API обнаружения тегов службы все еще находится в предварительном просмотре и в некоторых случаях может не привести полный список тегов и IP-адресов. До тех пор, пока API обнаружения, как правило, доступны, рассмотреть возможность использования [теги услуг в загружаемом формате JSON](../virtual-network/service-tags-overview.md#discover-service-tags-by-using-downloadable-json-files). 

* Используйте *AzureIoTHub. *Тег названия региона для определения префиксов IP, используемых конечными точками концентратора IoT в определенном регионе. Учет аварийного восстановления центра обработки данных или [регионального сбоя](iot-hub-ha-dr.md) также обеспечивает подключение к ip-префиксам геопарной области концентратора IoT.

* Настройка правил брандмауэра в Концентраторе IoT может блокировать подключение, необходимое для выполнения команд Azure CLI и PowerShell против вашего концентратора IoT. Чтобы избежать этого, вы можете добавить правила ALLOW для префиксов IP-адресов ваших клиентов, чтобы повторно включить клиентов CLI или PowerShell для связи с вашим IoT Hub.  


## <a name="limitations-and-workarounds"></a>Ограничения и обходные решения

* Функция IP-фильтра IoT Hub имеет ограничение в 10 правил. Этот лимит может быть поднят с помощью запросов через службу поддержки клиентов Azure. 

* Настроенные [правила фильтрации IP](iot-hub-ip-filtering.md) применяются только на конечных точках IOT Hub IP, а не на встроенной в исключительную конечную точку Концентратора событий. Если вы также требуете, чтобы фильтрация IP была применена в концентраторе событий, где хранятся ваши сообщения, вы можете сделать это, приведя свой собственный ресурс Event Hub, где вы можете настроить желаемые правила фильтрации IP напрямую. Для этого необходимо предоставить свой собственный ресурс Event Hub и настроить [передачу сообщений](./iot-hub-devguide-messages-d2c.md) для отправки сообщений на этот ресурс вместо встроенного концентратора событий IoT. Наконец, как указано в таблице выше, для включения функциональности разгрома сообщений необходимо также разрешить подключение от префиксов IP-адреса IoT Hub к подготовленному ресурсу Event Hub.

* При переадресовке на учетную запись хранилища разрешение трафика с префиксов IP-адреса IoT Hub возможно только в том случае, если учетная запись хранилища находится в другом регионе, как ваш IoT Hub.

## <a name="support-for-ipv6"></a>Поддержка IPv6 

IPv6 в настоящее время не поддерживается на IoT Концентратор.
