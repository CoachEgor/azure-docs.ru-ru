---
title: Общие сведения о встроенной конечной точке Центра Интернета вещей Azure | Документация Майкрософт
description: В этом руководстве разработчика описано, как читать сообщения, отправляемые с устройства в облако, с помощью встроенной конечной точки, совместимой с концентратором событий.
author: wesmc7777
manager: philmea
ms.author: wesmc
ms.service: iot-hub
services: iot-hub
ms.topic: conceptual
ms.date: 02/26/2019
ms.openlocfilehash: 827d7d9a3d584342703a84dd2a42e5cda9b3a656
ms.sourcegitcommit: 3102f886aa962842303c8753fe8fa5324a52834a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "61364079"
---
# <a name="read-device-to-cloud-messages-from-the-built-in-endpoint"></a>Чтение сообщений, пересылаемых с устройства в облако, из встроенной конечной точки

По умолчанию сообщения направляются во встроенную конечную точку, доступную для службы (**/messages/events**), которая совместима с [Центрами событий](https://azure.microsoft.com/documentation/services/event-hubs/). Сейчас эта конечная точка предоставляется только по протоколу [AMQP](https://www.amqp.org/) на порте 5671. Центр Интернета вещей позволяет управлять встроенной конечной точкой обмена сообщениями **messages/events**, совместимой с концентраторами событий, с помощью приведенных ниже свойств.

| Свойство            | Описание |
| ------------------- | ----------- |
| **Количество секций** | Это свойство задается во время создания, чтобы определить количество [разделов](../event-hubs/event-hubs-features.md#partitions) для приема событий, отправляемых с устройства в облако. |
| **Время хранения**  | Это свойство задает время в днях, в течение которого сообщения хранятся в Центре Интернета вещей. Значение по умолчанию — один день, но это значение можно увеличить до семи дней. |

Центр Интернета вещей обеспечивает хранение данных в встроенные концентраторов событий не более 7 дней. Можно задать время хранения во время создания центра Интернета вещей. Время хранения данных в центре Интернета вещей зависит от уровня центра Интернета вещей и тип единицы измерения. С точки зрения размера встроенные концентраторов событий можно сохранить сообщения максимальный размер сообщения до менее 24 часов квоты. Например за 1 единицу S1, центр Интернета вещей предоставляет достаточный объем хранилища, чтобы сохранить по крайней мере 400 тысяч сообщений из 4 k размеры каждого. Если устройства отправляют меньшего размера сообщения, они могут сохраняться дольше (показатель для 7 дней) в зависимости от того, какой объем хранилища используется. Мы гарантируем, сохраняя данные для указанного времени как минимум.

Центр Интернета вещей также предоставляет возможность управлять группами потребителей во встроенной конечной точке, которая получает сообщения, отправляемые с устройства в облако.

Если вы используете [маршрутизации сообщений](iot-hub-devguide-messages-d2c.md) и [резервный маршрут](iot-hub-devguide-messages-d2c.md#fallback-route) — включена, все сообщения, которые не соответствуют запрос по какой-либо маршрут перейдите во встроенную конечную точку. Если отключить этот резервный маршрут, сообщения, которые не соответствуют любого запроса будут удаляться.

Период хранения можно изменить на [портале Azure](https://portal.azure.com) или программно (с помощью [интерфейсов REST API поставщика ресурсов Центра Интернета вещей](/rest/api/iothub/iothubresource)).

Центр Интернета вещей предоставляет встроенную конечную точку **messages/events**, с помощью которой внутренние службы считывают сообщения, отправляемые в Центр с устройства в облако. Эта конечная точка совместима с концентраторами событий, поэтому можно использовать любой из механизмов для чтения сообщений, который поддерживает служба "Центры событий".

## <a name="read-from-the-built-in-endpoint"></a>Считывание данных из встроенной конечной точки

Некоторые интеграции продуктов и пакетов SDK для концентраторов событий поддерживают Центр Интернета вещей и позволяют использовать строки подключения службы центра Интернета вещей для подключения к встроенной конечной точки.

При использовании пакетов SDK для концентраторов событий или интеграции продуктов, которые не поддерживают Центр Интернета вещей, требуется совместимая с концентратором событий конечную точку и имя совместимая с концентратором событий. Эти значения на портале можно получить следующим образом:

1. Войдите на [портал Azure](https://portal.azure.com) и перейдите к своему Центру Интернета вещей.

2. Щелкните **Встроенные конечные точки**.

3. **События** раздел содержит следующие значения: **Секции**, **совместимая с концентратором событий имя**, **совместимая с концентратором событий конечную точку**, **время хранения**, и **групп потребителей**.

    ![Параметры раздела "Из устройства в облако"](./media/iot-hub-devguide-messages-read-builtin/eventhubcompatible.png)

На портале в поле конечной точки совместимая с концентратором событий содержит полные строки подключения концентраторов событий, которая выглядит следующим образом: **Endpoint=sb://abcd1234namespace.servicebus.windows.net/;SharedAccessKeyName=iothubowner;SharedAccessKey=keykeykeykeykeykey=;EntityPath=iothub-ehub-abcd-1234-123456**. Если вы используете пакет SDK требует другие значения, затем они будут:

| ИМЯ | Value |
| ---- | ----- |
| Конечная точка | sb://abcd1234namespace.servicebus.windows.net/ |
| Имя узла | abcd1234namespace.servicebus.windows.net |
| Пространство имен | abcd1234namespace |

Затем можно использовать любую политику общего доступа с разрешениями **ServiceConnect**, которые позволяют подключаться к указанному концентратору событий.

Пакеты SDK, которые можно использовать для подключения к встроенную совместимую с концентратором событий конечную точку, центр Интернета вещей предоставляет включают:

| Язык | SDK | Пример | Примечания |
| -------- | --- | ------ | ----- |
| .NET | https://github.com/Azure/azure-event-hubs-dotnet | [Краткое руководство](quickstart-send-telemetry-dotnet.md) | Использует информацию, совместимую с концентраторами событий |
 Java | https://github.com/Azure/azure-event-hubs-java | [Краткое руководство](quickstart-send-telemetry-java.md) | Использует информацию, совместимую с концентраторами событий |
| Node.js | https://github.com/Azure/azure-event-hubs-node | [Краткое руководство](quickstart-send-telemetry-node.md) | Использует строку подключения центра Интернета вещей |
| Python | https://github.com/Azure/azure-event-hubs-python | https://github.com/Azure/azure-event-hubs-python/blob/master/examples/iothub_recv.py | Использует строку подключения центра Интернета вещей |

Интеграции продуктов, которые можно использовать с встроенную совместимую с концентратором событий конечную точку, центр Интернета вещей предоставляет включают:

* [Функции Azure](https://docs.microsoft.com/azure/azure-functions/). См. в разделе [обработки данных из центра Интернета вещей с помощью функций Azure](https://azure.microsoft.com/resources/samples/functions-js-iot-hub-processing/).
* [Azure Stream Analytics](https://docs.microsoft.com/azure/stream-analytics/). См. в разделе [Stream данных в качестве входных данных в Stream Analytics](../stream-analytics/stream-analytics-define-inputs.md#stream-data-from-iot-hub).
* [Time Series Insights](https://docs.microsoft.com/azure/time-series-insights/). См. в разделе [добавить источник событий центра Интернета вещей в среду Time Series Insights](../time-series-insights/time-series-insights-how-to-add-an-event-source-iothub.md).
* [Воронка Apache Storm](../hdinsight/storm/apache-storm-develop-csharp-event-hub-topology.md). Вы можете просмотреть [источник воронки](https://github.com/apache/storm/tree/master/external/storm-eventhubs) на портале GitHub.
* [интеграция Apache Spark.](../hdinsight/spark/apache-spark-eventhub-streaming.md)
* [Azure Databricks](https://docs.microsoft.com/azure/azure-databricks/).

## <a name="next-steps"></a>Дальнейшие действия

* Дополнительные сведения о конечных точках Центра Интернета вещей см. в статье [Руководство. Конечные точки Центра Интернета вещей](iot-hub-devguide-endpoints.md).

* В [кратких руководствах](quickstart-send-telemetry-node.md) рассказывается, как отправлять сообщения с имитированных устройств в облако и читать их из встроенной конечной точки. 

Дополнительные сведения см. в руководстве [Настройка маршрутизации сообщений с Центром Интернета вещей](tutorial-routing.md).

* Сведения о перенаправлении сообщений, отправляемых с устройства в облако, на пользовательские конечные точки см. в статье [Использование правил маршрутизации и пользовательских конечных точек для сообщений, отправляемых с устройства в облако](iot-hub-devguide-messages-read-custom.md).
