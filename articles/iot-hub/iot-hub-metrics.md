---
title: Использование метрик для мониторинга Центра Интернета вещей Azure | Документация Майкрософт
description: Использование метрик Центра Интернета вещей Azure для оценки и отслеживания общей работоспособности центров Интернета вещей.
author: jlian
ms.service: iot-hub
services: iot-hub
ms.topic: conceptual
ms.date: 04/24/2019
ms.author: jlian
ms.openlocfilehash: c448d7e5a5e0bea29063930bed3a59a0461b8cf5
ms.sourcegitcommit: 829d951d5c90442a38012daaf77e86046018e5b9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/09/2020
ms.locfileid: "91767629"
---
<!--for build: for each metric, if you understand what it is, it's ok. otw add more info.  -->
# <a name="understand-iot-hub-metrics"></a>Общие сведения о метриках Центра Интернета вещей

Метрики центра Интернета вещей предоставляют сведения о состоянии ресурсов Azure IoT в подписке Azure. Метрики центра Интернета вещей помогают оценить общую работоспособность службы центра Интернета вещей и подключенных к ней устройств. Эти статистические данные позволяют увидеть, что происходит с центром Интернета вещей и помогает выполнять анализ основных причин проблем без необходимости обращения в службу поддержки Azure.

Метрики включены по умолчанию. Метрики Центра Интернета вещей можно просмотреть на портале Azure.

> [!NOTE]
> Вы можете использовать метрики центра Интернета вещей для просмотра сведений об устройствах [IoT Plug and Play](../iot-pnp/overview-iot-plug-and-play.md) , подключенных к центру Интернета вещей.

## <a name="how-to-view-iot-hub-metrics"></a>Как просмотреть метрики Центра Интернета вещей

1. Создайте Центр Интернета вещей. Инструкции по созданию Центра Интернета вещей см. в руководстве [Краткое руководство. Отправка данных телеметрии с устройства в Центр Интернета вещей и чтение данных телеметрии из центра с помощью внутреннего приложения (C#)](quickstart-send-telemetry-dotnet.md).

2. Откройте колонку центра IoT. Щелкните **Метрики**.
   
    ![Снимок экрана, показывающий расположение параметра метрики на странице ресурсов центра Интернета вещей](./media/iot-hub-metrics/enable-metrics-1.png)

3. В колонке метрик можно просмотреть метрики Центра Интернета вещей и создать настраиваемые представления на их основе. 
   
    ![Снимок экрана со страницей метрик для Центра Интернета вещей](./media/iot-hub-metrics/enable-metrics-2.png)
    
4. Вы можете отправить данные метрик в конечную точку концентраторов событий или учетную запись хранения Azure, щелкнув **параметры диагностики**, а затем **добавив параметр диагностики**.

   ![Снимок экрана, показывающий, где находится кнопка "Параметры диагностики"](./media/iot-hub-metrics/enable-metrics-3.png)

## <a name="iot-hub-metrics-and-how-to-use-them"></a>Метрики Центра Интернета вещей и их использование

Центр Интернета вещей предоставляет несколько метрик для получения представления о состоянии работоспособности центра и общем количестве подключенных устройств. Для формирования более полной картины о состоянии центра IoT можно объединить данные из нескольких метрик. В следующей таблице описаны метрики, отслеживаемые центром IoT, а также связь каждой метрики с общим состоянием центра IoT.

|Метрика|Отображаемое имя метрики|Unit|Тип статистической обработки|Описание|Измерения|
|---|---|---|---|---|---|
|раутингделивериес | Попытки доставки в маршрутизацию (Предварительная версия) | Count | Итог |Это метрика доставки маршрутизации. Используйте измерения, чтобы указать состояние доставки для определенной конечной точки или для конкретного источника маршрутизации.| Идентификатора<br>Результат:<br>Раутингсаурце,<br>EndpointType<br>Фаилуререасонкатегори,<br>EndpointName<br>*Дополнительные сведения об измерениях см. [**здесь**](#dimensions)*. |
|раутингделиверилатенци| Задержка маршрутизации (Предварительная версия) | Миллисекунды | Среднее |Это метрика задержки доставки маршрутизации. Используйте измерения, чтобы указать задержку для определенной конечной точки или для конкретного источника маршрутизации.| Идентификатора<br>Раутингсаурце,<br>EndpointType<br>EndpointName<br>*Дополнительные сведения об измерениях см. [**здесь**](#dimensions)*.|
|раутингдатасизеинбитесделиверед| Размер данных доставки для маршрутизации в байтах (Предварительная версия)| Байты | Итог |Общее число байтов, направляемых центром Интернета вещей в пользовательскую конечную точку и встроенную конечную точку. Используйте измерения, чтобы указать размер данных, направляемых в определенную конечную точку или для конкретного источника маршрутизации.| Идентификатора<br>Раутингсаурце,<br>EndpointType<br>EndpointName<br>*Дополнительные сведения об измерениях см. [**здесь**](#dimensions)*.|
|D2C. телеметрии. входящий.<br>allProtocol|Число предпринятых попыток отправки сообщений телеметрии.|Count|Итог|Число предпринятых попыток отправки в Центр Интернета вещей сообщений телеметрии из устройства в облако.|Нет|
|D2C. телеметрии. входящий.<br>Успешное завершение|Число отправленных сообщений телеметрии.|Count|Итог|Число успешно отправленных в Центр Интернета вещей сообщений телеметрии из устройства в облако.|Нет|
|C2D. Commands. выходной.<br>завершено. успешное завершение|Доставленные сообщения из облака на устройство (C2D)|Count|Итог|Число попыток доставки сообщений, отправленных из облака на устройство, успешно завершено устройством|Нет|
|C2D. Commands. выходной.<br>прирвать. успешное завершение|Отброшенные сообщения из облака на устройство (C2D)|Count|Итог|Число сообщений, отправленных из облака на устройство, которые отброшены устройством|Нет|
|C2D. Commands. выходной.<br>отклонено. успешное завершение|Отклоненные сообщения из облака на устройство (C2D)|Count|Итог|Число сообщений, отправленных из облака на устройство, отклоненных устройством|Нет|
|C2DMessagesExpired|Сообщения из облака на устройство (C2D) с истекшим сроком действия (предварительная версия)|Count|Итог|Число сообщений, отправленных из облака на устройство с истекшим сроком действия|Нет|
|devices.totalDevices|Total devices (deprecated) (Всего устройств (не рекомендуется))|Count|Итог|Число устройств, зарегистрированных в Центре Интернета вещей.|Нет|
|Devices. Коннектеддевицес.<br>allProtocol|Connected devices (deprecated) (Подключенные устройства (не рекомендуется)) |Count|Итог|Число устройств, подключенных к Центру Интернета вещей.|Нет|
|D2C. телеметрии. исходящего трафика.<br>Успешное завершение|Routing: telemetry messages delivered (Маршрутизация: доставлено сообщений телеметрии)|Count|Итог|Количество раз, когда сообщения были успешно доставлены на все конечные точки с помощью маршрутизации Центра Интернета вещей. Если сообщение направляется на несколько конечных точек, это значение увеличивается на единицу для каждой успешной доставки. Если сообщение доставлено несколько раз на одну конечную точку, это значение увеличивается на единицу для каждой успешной доставки.|Нет|
|D2C. телеметрии. исходящего трафика.<br>рывает|Routing: telemetry messages dropped (Маршрутизация: отброшено сообщений телеметрии) |Count|Итог|Количество раз, когда сообщения удалялись подсистемой маршрутизации Центра Интернета вещей из-за неработоспособности конечных точек. В этом значении не учитываются сообщения, доставленные через резервный маршрут, так как отброшенные сообщения туда не доставляются.|Нет|
|D2C. телеметрии. исходящего трафика.<br>утратившие связь с учетной записью|Routing: telemetry messages orphaned (Маршрутизация: потеряно сообщений телеметрии) |Count|Итог|Количество случаев, когда маршрутизация сообщений была потеряна при маршрутизации центра Интернета вещей, так как они не совпали с каким-либо запросом маршрутизации, при отключенном резервном маршруте.|Нет|
|D2C. телеметрии. исходящего трафика.<br>недопустимо|Routing: telemetry messages incompatible (Маршрутизация: несовместимых сообщений телеметрии)|Count|Итог|Количество раз, когда подсистеме маршрутизации Центра Интернета вещей не удалось доставить сообщения из-за несовместимости с конечной точкой. Сообщение несовместимо с конечной точкой, когда центр Интернета вещей пытается доставить сообщение в конечную точку и завершается с ошибкой, не являющейся временной. Недопустимые сообщения не повторяются повторно. В это значение не входят повторные попытки.|Нет|
|D2C. телеметрии. исходящего трафика.<br>fallback|Routing: messages delivered to fallback (Маршрутизация: доставлено сообщений на резервный маршрут)|Count|Итог|Количество раз, когда подсистема маршрутизации Центра Интернета вещей доставляла сообщения на конечную точку, связанную с резервным маршрутом.|Нет|
|D2C. Endpoints. исходящем.<br>eventHubs|Routing: messages delivered to Event Hub (Маршрутизация: доставлено сообщений в концентратор событий)|Count|Итог|Количество успешно доставленных сообщений в пользовательские конечные точки концентратора событий при маршрутизации в центре Интернета вещей. Это не относится к сообщениям, которые перенаправляются во встроенную конечную точку (события).|Нет|
|D2C. Endpoints. задержка.<br>eventHubs|Routing: message latency for Event Hub (Маршрутизация: задержка сообщений для концентратора событий)|Миллисекунды|Среднее|Средняя задержка (в миллисекундах) между поступлением сообщения в центр Интернета вещей и входом сообщений в пользовательские конечные точки типа "концентратор событий". Это не относится к сообщениям, которые перенаправляются во встроенную конечную точку (события).|Нет|
|D2C. Endpoints. исходящем.<br>сервицебускуеуес|Routing: messages delivered to Service Bus Queue (Маршрутизация: доставлено сообщений в очередь служебной шины)|Count|Итог|Количество раз, когда подсистема маршрутизации Центра Интернета вещей успешно доставила сообщения на конечные точки очереди служебной шины.|Нет|
|D2C. Endpoints. задержка.<br>сервицебускуеуес|Routing: message latency for Service Bus Queue (Маршрутизация: задержка сообщений для очереди служебной шины)|Миллисекунды|Среднее|Средняя задержка (в миллисекундах) между поступлением сообщения в центр Интернета вещей и входом сообщений в конечную точку очереди служебной шины.|Нет|
|D2C. Endpoints. исходящем.<br>сервицебустопикс|Routing: messages delivered to Service Bus Topic (Маршрутизация: доставлено сообщений в раздел служебной шины)|Count|Итог|Количество раз, когда подсистема маршрутизации Центра Интернета вещей успешно доставила сообщения на конечные точки раздела служебной шины.|Нет|
|D2C. Endpoints. задержка.<br>сервицебустопикс|Routing: message latency for Service Bus Topic (Маршрутизация: задержка сообщений для раздела служебной шины)|Миллисекунды|Среднее|Средняя задержка (в миллисекундах) между поступлением сообщения в центр Интернета вещей и входом сообщений в конечную точку раздела служебной шины.|Нет|
|D2C. Endpoints. исходящем.<br>Встроенные события|Routing: messages delivered to messages/events (Маршрутизация: доставлено сообщений на конечную точку messages/events)|Count|Итог|Количество успешно доставленных сообщений в встроенную конечную точку (сообщения или события) и резервный маршрут в службе маршрутизации центра Интернета вещей.|Нет|
|D2C. Endpoints. задержка.<br>Встроенные события|Routing: message latency for messages/events (Маршрутизация: задержка сообщений для messages/events)|Миллисекунды|Среднее|Средняя задержка (в миллисекундах) между поступлением сообщения в центр Интернета вещей и поступлением сообщения во встроенную конечную точку (сообщения или события) и резервный маршрут.|Нет|
|D2C. Endpoints. исходящем.<br>носителей.|Routing: messages delivered to storage (Маршрутизация: доставлено сообщений в хранилище)|Count|Итог|Количество раз, когда подсистема маршрутизации Центра Интернета вещей успешно доставила сообщения на конечные точки хранилища.|Нет|
|D2C. Endpoints. задержка.<br>носителей.|Routing: message latency for storage (Маршрутизация: задержка сообщений для хранилища)|Миллисекунды|Среднее|Средняя задержка (в миллисекундах) между поступлением сообщения в центр Интернета вещей и входом сообщений в конечную точку хранилища.|Нет|
|D2C. Endpoints. исходящем.<br>Storage. bytes|Routing: data delivered to storage (Маршрутизация: доставлено данных в хранилище)|Байты|Итог|Объем данных (в байтах), доставленных подсистемой маршрутизации Центра Интернета вещей на конечные точки хранилища.|Нет|
|D2C. Endpoints. исходящем.<br>Storage. blobs|Routing: blobs delivered to storage (Маршрутизация: доставлено BLOB-объектов в хранилище)|Count|Итог|Количество раз, когда подсистема маршрутизации Центра Интернета вещей доставила BLOB-объекты на конечные точки хранилища.|Нет|
|EventGridDeliveries|Доставки сетки событий (предварительная версия)|Count|Итог|Число событий центра Интернета вещей, опубликованных в сетке событий. Используйте измерение результат для количества успешных и неудачных запросов. Измерение EventType показывает тип события ( https://aka.ms/ioteventgrid) .|Идентификатора<br/>Результат:<br/>EventType|
|EventGridLatency|Задержка сетки событий (предварительная версия)|Миллисекунды|Среднее|Средняя задержка (в миллисекундах) от момента создания события центра Интернета вещей до публикации события в сетке событий. Это число является средним значением между всеми типами событий. Используйте измерение EventType для просмотра задержки определенного типа события.|Идентификатора<br/>EventType|
|d2c.twin.read.success|Успешные операции чтения с двойников, инициированные устройством.|Count|Итог|Число всех успешных операций чтения с двойников, инициированных устройством.|Нет|
|d2c.twin.read.failure|Неудачные операции чтения с двойников, инициированные устройством.|Count|Итог|Число всех неудачных операций чтения с двойников, инициированных устройством.|Нет|
|d2c.twin.read.size|Размер ответа операций чтения с двойников, инициированных устройством.|Байты|Среднее|Число всех успешных операций чтения, инициированных устройством, двойника.|Нет|
|d2c.twin.update.success|Успешные обновления двойников, инициированные устройством.|Count|Итог|Число всех успешных обновлений двойников, инициированных устройством.|Нет|
|d2c.twin.update.failure|Неудачные обновления двойников, инициированные устройством.|Count|Итог|Число всех неудачных обновлений двойников, инициированных устройством.|Нет|
|d2c.twin.update.size|Размер обновлений двойников, инициированных устройством.|Байты|Среднее|Общий размер всех успешных обновлений двойника, инициированных устройством.|Нет|
|c2d.methods.success|Успешные вызовы прямых методов.|Count|Итог|Число всех успешных вызовов прямых методов.|Нет|
|c2d.methods.failure|Неудачные вызовы прямых методов.|Count|Итог|Число всех неудачных вызовов прямых методов.|Нет|
|c2d.methods.requestSize|Размер запроса вызовов прямых методов.|Байты|Среднее|Число всех успешных запросов прямых методов.|Нет|
|c2d.methods.responseSize|Размер ответа вызовов прямых методов.|Байты|Среднее|Число всех успешных ответов прямых методов.|Нет|
|c2d.twin.read.success|Успешные операции чтения с двойников, инициированные из серверной части.|Count|Итог|Число всех успешных операций чтения с двойников, инициированных из серверной части.|Нет|
|c2d.twin.read.failure|Неудачные операции чтения с двойников, инициированные из серверной части.|Count|Итог|Число всех неудачных операций чтения с двойников, инициированных из серверной части.|Нет|
|c2d.twin.read.size|Размер ответа операций чтения с двойников, инициированных из серверной части.|Байты|Среднее|Число всех успешных операций чтения с двойников, инициированных из серверной части.|Нет|
|c2d.twin.update.success|Успешные обновления двойников, инициированные из серверной части.|Count|Итог|Число всех успешных обновлений двойников, инициированных из серверной части.|Нет|
|c2d.twin.update.failure|Неудачные обновления двойников, инициированные из серверной части.|Count|Итог|Число всех неудачных обновлений двойников, инициированных из серверной части.|Нет|
|c2d.twin.update.size|Размер обновлений двойников, инициированных из серверной части.|Байты|Среднее|Общий размер всех успешных обновлений двойника, инициированных в серверной части.|Нет|
|twinQueries.success|Успешные запросы двойников.|Count|Итог|Число всех успешных запросов двойников.|Нет|
|twinQueries.failure|Неудачные запросы двойников.|Count|Итог|Количество всех неудачных запросов двойников.|Нет|
|twinQueries.resultSize|Размер результатов запросов двойников.|Байты|Среднее|Суммарный размер результатов всех успешных запросов двойника.|Нет|
|jobs. Креатетвинупдатежоб.<br>Успешное завершение|Успешные операции создания заданий обновления двойников.|Count|Итог|Количество всех успешных созданий заданий обновления двойников.|Нет|
|jobs. Креатетвинупдатежоб.<br>ошибка|Неудачные операции создания заданий обновления двойников.|Count|Итог|Количество всех неудачных операций создания заданий обновления двойников.|Нет|
|jobs. Креатедиректмесоджоб.<br>Успешное завершение|Успешные операции создания заданий вызова методов.|Count|Итог|Количество всех успешных операций создания заданий вызова прямых методов.|Нет|
|jobs. Креатедиректмесоджоб.<br>ошибка|Неудачные операции создания заданий вызова методов.|Count|Итог|Количество всех неудачных операций создания заданий вызова прямых методов.|Нет|
|jobs.listJobs.success|Успешные вызовы получения списка заданий.|Count|Итог|Количество всех успешных вызовов для получения списка заданий.|Нет|
|jobs.listJobs.failure|Неудачные вызовы получения списка заданий.|Count|Итог|Количество всех неудачных вызовов для получения списка заданий.|Нет|
|jobs.cancelJob.success|Успешные отмены заданий.|Count|Итог|Количество всех успешных вызовов для отмены заданий.|Нет|
|jobs.cancelJob.failure|Неудачные отмены заданий.|Count|Итог|Количество всех неудачных вызовов для отмены заданий.|Нет|
|jobs.queryJobs.success|Успешные запросы заданий.|Count|Итог|Количество всех успешных вызовов для запроса заданий.|Нет|
|jobs.queryJobs.failure|Неудачные запросы заданий.|Count|Итог|Количество всех неудачных вызовов для запроса заданий.|Нет|
|jobs.completed|Завершенные задания|Count|Итог|Количество всех выполненных заданий.|Нет|
|jobs.failed|Неудачные задания.|Count|Итог|Количество всех неудачных заданий.|Нет|
|D2C. телеметрии. входящий.<br>сендсроттле|Количество ошибок регулирования|Count|Итог|Количество ошибок регулирования из-за регулирования пропускной способности устройства|Нет|
|dailyMessageQuotaUsed|Общее количество используемых сообщений|Count|Среднее|Количество сообщений, использованных сегодня. Это совокупное значение, которое сбрасывается до нуля в 00:00 UTC каждый день.|Нет|
|deviceDataUsage|Общий объем использования данных устройствами|Байты|Итог|Байты, переданные на любые устройства, подключенные к Центру Интернета вещей, и с них|Нет|
|deviceDataUsageV2|Total device data usage (preview) (Общий объем использования данных устройствами (предварительная версия))|Байты|Итог|Байты, переданные на любые устройства, подключенные к Центру Интернета вещей, и с них|Нет|
|totalDeviceCount|Total devices (preview) (Всего устройств (предварительная версия))|Count|Среднее|Число устройств, зарегистрированных в Центре Интернета вещей.|Нет|
|connectedDeviceCount|Connected devices (preview) (Подключенных устройств (предварительная версия))|Count|Среднее|Число устройств, подключенных к Центру Интернета вещей.|Нет|
|конфигурации|Configuration Metrics (Метрики конфигурации)|Count|Итог|Общее число операций CRUD, выполненных для конфигурации устройства и развертывания IoT Edge, на наборе целевых устройств. Сюда также входит количество операций, изменяющих двойникаов устройств или двойника модуля из-за этих конфигураций.|Нет|

### <a name="dimensions"></a>Измерения
Измерения помогают определить дополнительные сведения о метриках. Некоторые метрики маршрутизации предоставляют сведения для каждой конечной точки. В таблице ниже перечислены возможные значения для этих измерений.

|Измерение|Значения|
|---|---|
|ResourceID|ресурс центра Интернета вещей|
|Результат|Успешное завершение<br>ошибка|
|раутингсаурце|Сообщения устройства<br>События изменения двойника<br>События жизненного цикла устройства|
|EndpointType|eventHubs<br>сервицебускуеуес<br>cosmosDB<br>сервицебустопикс<br>Builtin<br>блобстораже|
|фаилуререасонкатегори|недопустимо<br>рывает<br>утратившие связь с учетной записью<br>null|
|EndpointName|имя конечной точки;|

## <a name="next-steps"></a>Дальнейшие шаги

Вы ознакомились с общими сведениями о метриках Центра Интернета вещей. Чтобы узнать больше об управлении Центром Интернета вещей Azure, перейдите по этой ссылке:

* [Настройка журналов диагностики](iot-hub-monitor-resource-health.md)

* [Сведения об устранении неполадок маршрутизации сообщений](troubleshoot-message-routing.md)

Для дальнейшего изучения возможностей Центра Интернета вещей см. следующие статьи:

* [Руководство разработчика для Центра Интернета вещей](iot-hub-devguide.md)

* [Краткое руководство. Развертывание первого модуля IoT Edge на устройстве под управлением 64-разрядной ОС Linux](../iot-edge/tutorial-simulate-device-linux.md)
