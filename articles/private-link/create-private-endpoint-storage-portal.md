---
title: Подключение в частном порядке к учетной записи хранения с помощью частной конечной точки Azure
description: Узнайте, как подключаться к учетной записи хранения в Azure с помощью частной конечной точки.
services: private-link
author: asudbring
ms.service: private-link
ms.topic: article
ms.date: 09/16/2019
ms.author: allensu
ms.openlocfilehash: cfe0caaf199821358f8a66ac65ae75c38336c725
ms.sourcegitcommit: d6b68b907e5158b451239e4c09bb55eccb5fef89
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/20/2019
ms.locfileid: "74228093"
---
# <a name="connect-privately-to-a-storage-account-using-azure-private-endpoint"></a>Подключение в частном порядке к учетной записи хранения с помощью частной конечной точки Azure
Частная конечная точка Azure — это фундаментальный Стандартный блок для частной ссылки в Azure. Она позволяет ресурсам Azure, таким как виртуальные машины, обмениваться данными с частными ресурсами.

В этом кратком руководстве вы узнаете, как создать виртуальную машину в виртуальной сети Azure, учетную запись хранения с частной конечной точкой, используя портал Azure. Затем вы можете безопасно получить доступ к учетной записи хранения из виртуальной машины.


## <a name="sign-in-to-azure"></a>Вход в Azure

Войдите на портал Azure по адресу https://portal.azure.com.

## <a name="create-a-vm"></a>Создание виртуальной машины
В этом разделе вы создадите виртуальную сеть и подсеть для размещения виртуальной машины, которая используется для доступа к ресурсу частной ссылки (учетная запись хранения в этом примере).

### <a name="create-the-virtual-network"></a>Создание виртуальной сети

В этом разделе вы создадите виртуальную сеть и подсеть для размещения виртуальной машины, которая используется для доступа к ресурсу частной ссылки.

1. Вверху с левой стороны экрана последовательно выберите **Создать ресурс** > **Сети** > **Виртуальная сеть**.
1. В подменю **Создать виртуальную сеть** введите или выберите следующую информацию:

    | Настройка | Значение |
    | ------- | ----- |
    | имя | Введите *myVirtualNetwork*. |
    | Пространство адресов | Введите *10.1.0.0/16*. |
    | подписку | Выберите свою подписку.|
    | Группа ресурсов | Выберите **Создать**, а затем введите *myResourceGroup* и нажмите кнопку **ОК**. |
    | Место проведения | Выберите **WestCentralUS**.|
    | Имя подсети | Введите *mySubnet*. |
    | Диапазон адреса подсети | Введите *10.1.0.0/24*. |
    |||
1. Оставьте без изменений значения остальных параметров и выберите **Создать**.


### <a name="create-virtual-machine"></a>Создание виртуальной машины

1. В верхней левой части экрана портал Azure выберите **создать ресурс** > **вычислений** > **Виртуальная машина**.

1. В окне **Создание виртуальной машины — Основы** введите или выберите следующую информацию:

    | Настройка | Значение |
    | ------- | ----- |
    | **Сведения о проекте** | |
    | подписку | Выберите свою подписку. |
    | Группа ресурсов | Выберите **myResourceGroup**. Вы создали ее в предыдущем разделе.  |
    | **Подробности об экземпляре** |  |
    | Имя виртуальной машины | Введите *myVm*. |
    | Регион | Выберите **WestCentralUS**. |
    | Параметры доступности | Оставьте значение по умолчанию **No infrastructure redundancy required** (Избыточность инфраструктуры не требуется). |
    | Образ — | Выберите **Центр обработки данных Windows Server 2019**. |
    | Размер | Оставьте значение по умолчанию **Standard DS1 v2**. |
    | **Учетная запись администратора** |  |
    | Имя пользователя | Введите выбранное имя пользователя. |
    | Пароль | Введите выбранный пароль. Пароль должен включать минимум 12 символов и соответствовать [определенным требованиям к сложности](../virtual-machines/windows/faq.md?toc=%2fazure%2fvirtual-network%2ftoc.json#what-are-the-password-requirements-when-creating-a-vm).|
    | Подтверждение пароля | Введите пароль еще раз. |
    | **Правила входящего порта** |  |
    | Общедоступные входящие порты | Оставьте значение по умолчанию **Отсутствует**. |
    | **Экономия** |  |
    | Already have a Windows license? (У вас уже есть лицензия Windows?) | Оставьте значение по умолчанию **Нет**. |
    |||

1. Выберите **Далее: диски**.

1. В окне **Создание виртуальной машины — диски**оставьте значения по умолчанию и нажмите кнопку **Далее: Сетевые подключения**.

1. В окне **Создание виртуальной машины — Сети** выберите такую информацию:

    | Настройка | Значение |
    | ------- | ----- |
    | виртуальную сеть | Оставьте значение по умолчанию **myVirtualNetwork**.  |
    | Пространство адресов | Оставьте значение по умолчанию **10.1.0.0/24**.|
    | Подсеть | Оставьте значение по умолчанию **mySubnet (10.1.0.0/24)** .|
    | Общедоступный IP-адрес | Оставьте значение по умолчанию **(new) myVm-ip**. |
    | Общедоступные входящие порты | Выберите **Разрешить выбранные порты**. |
    | Выбрать входящие порты | Выберите **HTTP** и **RDP**.|
    ||

1. Выберите **Review + create** (Просмотреть и создать). Вы будете перенаправлены на страницу **Просмотр и создание**, где Azure проверит вашу конфигурацию.

1. При появлении сообщения **Проверка пройдена** нажмите кнопку **Создать**.

## <a name="create-your-private-endpoint"></a>Создание частной конечной точки
В этом разделе вы создадите закрытую учетную запись хранения, используя для нее закрытую конечную точку. 

1. В верхней левой части экрана портал Azure выберите **создать ресурс** > **хранилище** > **учетная запись хранения**.

1. В статье **Создание учетной записи хранения — основные**сведения введите или выберите следующую информацию:

    | Настройка | Значение |
    | ------- | ----- |
    | **Сведения о проекте** | |
    | подписку | Выберите свою подписку. |
    | Группа ресурсов | Выберите **myResourceGroup**. Вы создали ее в предыдущем разделе.|
    | **Подробности об экземпляре** |  |
    | Имя учетной записи хранения  | Введите *mystorageaccount*. Если это имя используется, создайте уникальное имя. |
    | Регион | Выберите **WestCentralUS**. |
    | Производительность| Оставьте значение по умолчанию **Стандартная**. |
    | Тип учетной записи | Оставьте хранилище по умолчанию **(общее назначение версии 2)** . |
    | Репликация | Выберите **геоизбыточное хранилище с доступом для чтения (RA-GRS)** . |
    |||
  
3. Выберите **Далее: сети**.
4. В окне **Создание учетной записи хранения —** подключение к сети, метод подключения выберите **Частная конечная точка**.
5. В окне **Создание учетной записи хранения — сеть**выберите **Добавить частную конечную точку**. 
6. В окне **Создание частной конечной точки**введите или выберите следующие сведения:

    | Настройка | Значение |
    | ------- | ----- |
    | **Сведения о проекте** | |
    | подписку | Выберите свою подписку. |
    | Группа ресурсов | Выберите **myResourceGroup**. Вы создали ее в предыдущем разделе.|
    |Место проведения|Выберите **WestCentralUS**.|
    |имя|Введите *миприватиндпоинт*.  |
    |Подресурс хранилища|Оставьте **большой двоичный объект**по умолчанию. |
    | **СЕТИ** |  |
    | виртуальную сеть  | Выберите *MyVirtualNetwork* из группы ресурсов *myResourceGroup*. |
    | Подсеть | Выберите *mySubnet*. |
    | **ЧАСТНАЯ ИНТЕГРАЦИЯ DNS**|  |
    | Интеграция с частной зоной DNS  | Оставьте значение по умолчанию **Да**. |
    | Частная зона DNS  | Оставьте значение по умолчанию * * (новое) privatelink.blob.core.windows.net * *. |
    |||
7. Нажмите кнопку **ОК**. 
8. Выберите **Review + create** (Просмотреть и создать). Вы будете перенаправлены на страницу **Просмотр и создание**, где Azure проверит вашу конфигурацию. 
9. При появлении сообщения **Проверка пройдена** нажмите кнопку **Создать**. 
10. Перейдите к только что созданному ресурсу учетной записи хранения.
11. Выберите **ключи доступа** в меню с содержимым слева.
12. Выберите **Копировать** в строке подключения для key1.
 
## <a name="connect-to-a-vm-from-the-internet"></a>Подключение к виртуальной машине из Интернета

Подключитесь к виртуальной машине *myVm* из Интернета следующим образом:

1. На портале в строке поиска введите *myVm*.

1. Нажмите кнопку **Подключиться**. После нажатия кнопки **Подключиться** откроется окно **Connect to virtual machine** (Подключение к виртуальной машине).

1. Щелкните **Скачать RDP-файл**. Azure создаст и скачает на ваш компьютер файл протокола удаленного рабочего стола (*RDP*).

1. Откройте скачанный RDP-файл*.

    1. При появлении запроса выберите **Подключиться**.

    1. Введите имя пользователя и пароль, указанные при создании виртуальной машины.

        > [!NOTE]
        > Возможно, потребуется выбрать **More choices** > **Use a different account** (Дополнительные варианты > Использовать другую учетную запись), чтобы указать учетные данные, введенные при создании виртуальной машины.

1. Нажмите кнопку **ОК**.

1. При входе в систему может появиться предупреждение о сертификате. В таком случае выберите **Да** или **Продолжить**.

1. Когда появится рабочий стол виртуальной машины, сверните его, чтобы вернуться на локальный рабочий стол.  

## <a name="access-storage-account-privately-from-the-vm"></a>Доступ к учетной записи хранения в частном порядке с виртуальной машины

В этом разделе вы будете подключаться к учетной записи хранения с помощью частной конечной точки.

> [!IMPORTANT]
> Конфигурации DNS для хранилища требуется ручное изменение файла hosts для включения полного доменного имени конкретной учетной записи. Измените следующий файл с помощью разрешений администратора в Windows: c:\Windows\System32\Drivers\etc\hosts или Linux/etc/hosts Включите сведения DNS для учетной записи из предыдущего шага в следующем формате [частный IP-адрес] myaccount.blob.core.windows.net

1. На удаленном рабочем столе  *myVm* откройте PowerShell.
2. Введите `nslookup mystorageaccount.blob.core.windows.net` вы получите примерно следующее сообщение:
    ```azurepowershell
    Server:  UnKnown
    Address:  168.63.129.16
    Non-authoritative answer:
    Name:    mystorageaccount123123.privatelink.blob.core.windows.net
    Address:  10.0.0.5
    Aliases:  mystorageaccount.blob.core.windows.net
    ```
3. Установите [Обозреватель службы хранилища Microsoft Azure](https://docs.microsoft.com/azure/vs-azure-tools-storage-manage-with-storage-explorer?toc=%2Fazure%2Fstorage%2Fblobs%2Ftoc.json&tabs=windows).
4. Выберите **учетные записи хранения** с помощью щелчка правой кнопкой мыши.
5. Выберите **подключиться к службе хранилища Azure**.
6. Выберите **использовать строку подключения**.
7. Нажмите кнопку **Далее**.
8. Введите строку подключения, вставляя скопированную ранее информацию.
9. Нажмите кнопку **Далее**.
10. Нажмите кнопку **Подключиться**.
11. Просмотр контейнеров больших двоичных объектов из mystorageaccount 
12. При необходимости Создание папок и/или отправка файлов в *mystorageaccount*. 
13. Закройте подключение к удаленному рабочему столу *myVM*. 

Дополнительные параметры для доступа к учетной записи хранения:
- Обозреватель службы хранилища Microsoft Azure — это автономное бесплатное приложение от корпорации Майкрософт, позволяющее визуально работать с данными службы хранилища Azure в Windows, macOS и Linux. Вы можете установить приложение, чтобы в частном порядке просмотреть содержимое учетной записи хранения. 
 
- Служебная программа AzCopy — это еще один вариант для высокопроизводительной передаваемой данных с поддержкой скриптов для службы хранилища Azure. С помощью AzCopy можно передавать данные из хранилища BLOB-объектов, таблиц и файлов и обратно. 


## <a name="clean-up-resources"></a>Очистка ресурсов 
Когда вы закончите использовать закрытую конечную точку, учетную запись хранения и виртуальную машину, удалите группу ресурсов и все содержащиеся в ней ресурсы. 
1. Введите *myResourceGroup* в поле **Поиск** в верхней части портала и выберите *myResourceGroup* в результатах поиска. 
2. Выберите **Удалить группу ресурсов**. 
3. Введите *myResourceGroup* **в поле введите имя группы ресурсов** и выберите **Удалить**. 

## <a name="next-steps"></a>Дополнительная информация
В этом кратком руководстве вы создали виртуальную машину в виртуальной сети, учетной записи хранения и частной конечной точке. Вы подключились к одной виртуальной машине из Интернета и безопасно взаимодействовали с учетной записью хранения, используя закрытую ссылку. Дополнительные сведения о частных конечных точках см. в статье [что такое частная конечная точка Azure?](private-endpoint-overview.md).
