---
title: Управление частными конечными точками в Azure
description: Сведения о создании частной конечной точки с помощью портала Azure
services: private-link
author: KumudD
ms.service: private-link
ms.topic: quickstart
ms.date: 09/16/2019
ms.author: kumud
ms.openlocfilehash: 15b4d3208be693a5b8d858d30b663347515f5a68
ms.sourcegitcommit: 2ed6e731ffc614f1691f1578ed26a67de46ed9c2
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/19/2019
ms.locfileid: "71130292"
---
# <a name="create-a-private-endpoint-using-azure-portal"></a>Создание частной конечной точки с помощью портала Azure

Частная конечная точка — ключевой компонент для построения частной ссылки в Azure. Это позволяет ресурсам Azure, таким как виртуальные машины (VM), обмениваться данными в частном порядке с ресурсами частной ссылки. В этом кратком руководстве вы узнаете, как создать виртуальную машину в виртуальной сети Azure и сервер базы данных SQL с частной конечной точкой Azure, используя Azure PowerShell. Затем вы сможете безопасно получить доступ к серверу базы данных SQL с виртуальной машины.

Если у вас еще нет подписки Azure, [создайте бесплатную учетную запись Azure](https://azure.microsoft.com/free/?WT.mc_id=A261C142F), прежде чем начинать работу.

## <a name="sign-in-to-azure"></a>Вход в Azure

Войдите на портал Azure по адресу https://portal.azure.com.

## <a name="create-a-vm"></a>Создание виртуальной машины
В этом разделе вы создадите виртуальную сеть и подсеть для размещения виртуальной машины, которая используется для доступа к ресурсу "Приватный канал" (в этом примере — сервер SQL в Azure).

### <a name="create-the-virtual-network"></a>Создание виртуальной сети


В этом разделе вы создадите виртуальную сеть и подсеть для размещения виртуальной машины, которая используется для доступа к ресурсу "Приватный канал".

1. Вверху с левой стороны экрана последовательно выберите **Создать ресурс** > **Сети** > **Виртуальная сеть**.
1. В подменю **Создать виртуальную сеть** введите или выберите следующую информацию:

    | Параметр | Значение |
    | ------- | ----- |
    | ИМЯ | Введите *myVirtualNetwork*. |
    | Пространство адресов | Введите *10.1.0.0/16*. |
    | Subscription | Выберите свою подписку.|
    | группа ресурсов. | Выберите **Создать**, а затем введите *myResourceGroup* и нажмите кнопку **ОК**. |
    | Location | Выберите **WestCentralUS**.|
    | Имя подсети | Введите *mySubnet*. |
    | Диапазон адреса подсети | Введите *10.1.0.0/24*. |
    |||
1. Оставьте без изменений значения остальных параметров и выберите **Создать**.


### <a name="create-virtual-machine"></a>Создание виртуальной машины

1. В верхнем левом углу экрана на портале Azure выберите **Создать ресурс** > **Вычисления** > **Виртуальная машина**.

1. В окне **Создание виртуальной машины — Основы** введите или выберите следующую информацию:

    | Параметр | Значение |
    | ------- | ----- |
    | **Сведения о проекте** | |
    | Subscription | Выберите свою подписку. |
    | группа ресурсов. | Выберите **myResourceGroup**. Вы создали ее в предыдущем разделе.  |
    | **Подробности об экземпляре** |  |
    | Имя виртуальной машины | Введите *myVm*. |
    | Регион | Выберите **WestCentralUS**. |
    | Параметры доступности | Оставьте значение по умолчанию **No infrastructure redundancy required** (Избыточность инфраструктуры не требуется). |
    | Образ — | Выберите **Центр обработки данных Windows Server 2019**. |
    | Размер | Оставьте значение по умолчанию **Standard DS1 v2**. |
    | **Учетная запись администратора** |  |
    | Имя пользователя | Введите выбранное имя пользователя. |
    | Пароль | Введите выбранный пароль. Пароль должен включать минимум 12 символов и соответствовать [определенным требованиям к сложности](../virtual-machines/windows/faq.md?toc=%2fazure%2fvirtual-network%2ftoc.json#what-are-the-password-requirements-when-creating-a-vm).|
    | Подтверждение пароля | Введите пароль еще раз. |
    | **Правила входящего порта** |  |
    | Общедоступные входящие порты | Оставьте значение по умолчанию **Отсутствует**. |
    | **Экономия** |  |
    | Already have a Windows license? (У вас уже есть лицензия Windows?) | Оставьте значение по умолчанию **Нет**. |
    |||

1. По завершении выберите **Next: Диски**.

1. В окне **Создание виртуальной машины — Диски** оставьте значения по умолчанию и выберите **Далее: Сети**.

1. В окне **Создание виртуальной машины — Сети** выберите такую информацию:

    | Параметр | Значение |
    | ------- | ----- |
    | Виртуальная сеть | Оставьте значение по умолчанию **myVirtualNetwork**.  |
    | Пространство адресов | Оставьте значение по умолчанию **10.1.0.0/24**.|
    | Подсеть | Оставьте значение по умолчанию **mySubnet (10.1.0.0/24)** .|
    | Общедоступный IP-адрес | Оставьте значение по умолчанию **(new) myVm-ip**. |
    | Общедоступные входящие порты | Выберите **Разрешить выбранные порты**. |
    | Выбрать входящие порты | Выберите **HTTP** и **RDP**.|
    |||


1. Выберите **Review + create** (Просмотреть и создать). Вы будете перенаправлены на страницу **Просмотр и создание**, где Azure проверит вашу конфигурацию.

1. При появлении сообщения **Проверка пройдена** нажмите кнопку **Создать**.

## <a name="create-a-sql-database-server"></a>Создание сервера базы данных SQL
В этом разделе вы создадите сервер базы данных SQL в Azure. 

1. В верхнем левом углу экрана на портале Azure выберите **Создать ресурс** > **Базы данных** > **База данных SQL**.

1. В окне **Создать базу данных SQL — Основы** введите или выберите следующую информацию:

    | Параметр | Значение |
    | ------- | ----- |
    | **Сведения о базе данных** | |
    | Subscription | Выберите свою подписку. |
    | группа ресурсов. | Выберите **myResourceGroup**. Вы создали ее в предыдущем разделе.|
    | **Подробности об экземпляре** |  |
    | Имя базы данных  | Введите *mydatabase*. Если это имя используется, создайте уникальное имя. |
    |||
5. На вкладке  **Сервер** выберите **Создать**. 
6. В окне  **Новый сервер** введите или выберите следующую информацию:

    | Параметр | Значение |
    | ------- | ----- |
    |Имя сервера  | Введите *myserve*. Если это имя используется, создайте уникальное имя.|
    | учетные данные администратора сервера для входа;| Введите выбранное имя администратора. |
    | Пароль | Введите выбранный пароль. Пароль должен включать минимум 8 символов и соответствовать определенным требованиям. |
    | Location | Выберите регион Azure, в котором необходимо разместить SQL Server. |
    
7. Выберите **OK**. 
8. Выберите  **Review + Create** (Просмотреть и создать). Вы будете перенаправлены на страницу  **Просмотр и создание** , где Azure проверит вашу конфигурацию. 
9. При появлении сообщения "Проверка пройдена" нажмите кнопку  **Создать**. 
10. При появлении сообщения "Проверка пройдена" выберите "Создать". 

## <a name="create-a-private-endpoint"></a>Создание частной конечной точки

В этом разделе вы создадите сервер SQL и добавите в него закрытую конечную точку. 

1. В верхнем левом углу экрана на портале Azure выберите **Создать ресурс** > **Сеть** > **Центр приватных каналов (предварительная версия)** .
2. В окне **Центр приватных каналов — Обзор**, для опции  **Создание частного подключения к службе**, выберите  **Начать**.
1. В окне **Создание частной конечной точки (предварительная версия) — Основы** введите или выберите следующую информацию:

    | Параметр | Значение |
    | ------- | ----- |
    | **Сведения о проекте** | |
    | Subscription | Выберите свою подписку. |
    | группа ресурсов. | Выберите **myResourceGroup**. Вы создали ее в предыдущем разделе.|
    | **Подробности об экземпляре** |  |
    | ИМЯ | Введите * myPrivateEndpoint*. Если это имя используется, создайте уникальное имя. |
    |Регион|Выберите **WestCentralUS**.|
    |||
5. Выберите **Далее: Ресурс**.
6. В окне  **Создание частной конечной точки — Ресурсы** введите или выберите следующую информацию:

    | Параметр | Значение |
    | ------- | ----- |
    |Способ подключения  | Выберите "подключиться к ресурсу Azure в моем каталоге".|
    | Subscription| Выберите свою подписку. |
    | Тип ресурса | Выберите **Microsoft.Sql/servers**. |
    | Ресурс |Выберите *MyServer*|
    |Целевой подресурс |Выберите *sqlServer*|
    |||
7. Выберите **Далее: Конфигурация**.
8. В окне **Создание частной конечной точки (предварительная версия) — Конфигурация** введите или выберите следующую информацию:

    | Параметр | Значение |
    | ------- | ----- |
    |**СЕТИ**| |
    | Виртуальная сеть| Выберите *MyVirtualNetwork*. |
    | Подсеть | Выберите *mySubnet*. |
    |**ЧАСТНАЯ ИНТЕГРАЦИЯ DNS**||
    |Интеграция с частной зоной DNS |Выберите **Да**. |
    |Частная зона DNS |Выберите *(New)privatelink.database.windows.net* |
    |||

1. Выберите  **Review + Create** (Просмотреть и создать). Вы будете перенаправлены на страницу  **Просмотр и создание** , где Azure проверит вашу конфигурацию. 
2. При появлении сообщения  **Проверка пройдена**  выберите  **Создать**. 
 
## <a name="connect-to-a-vm-using-remote-desktop-rdp"></a>Подключение к виртуальной машине с помощью удаленного рабочего стола (RDP)


После создания **myVm*, подключитесь к ней через интернет следующим образом: 

1. На портале в строке поиска введите *myVm*.

1. Нажмите кнопку **Подключиться**. После нажатия кнопки **Подключиться** откроется окно **Connect to virtual machine** (Подключение к виртуальной машине).

1. Щелкните **Скачать RDP-файл**. Azure создаст и скачает на ваш компьютер файл протокола удаленного рабочего стола (*RDP*).

1. Откройте скачанный RDP-файл*.

    1. При появлении запроса выберите **Подключиться**.

    1. Введите имя пользователя и пароль, указанные при создании виртуальной машины.

        > [!NOTE]
        > Возможно, потребуется выбрать **More choices** > **Use a different account** (Дополнительные варианты > Использовать другую учетную запись), чтобы указать учетные данные, введенные при создании виртуальной машины.

1. Нажмите кнопку **ОК**.

1. При входе в систему может появиться предупреждение о сертификате. В таком случае выберите **Да** или **Продолжить**.

1. Когда появится рабочий стол виртуальной машины, сверните его, чтобы вернуться на локальный рабочий стол.  

## <a name="access-the-sql-database-server-privately-from-the-vm"></a>Доступ к серверу базы данных SQL в частном порядке с виртуальной машины

1. На удаленном рабочем столе  *myVm* откройте PowerShell.

2. Введите `nslookup myserver.database.windows.net`. 

    Должно появиться сообщение следующего вида:
    ```azurepowershell
    Server:  UnKnown
    Address:  168.63.129.16
    Non-authoritative answer:
    Name:    myserver.privatelink.database.windows.net
    Address:  10.0.0.5
    Aliases:   myserver.database.windows.net
3. Install [SQL Server Management Studio](https://docs.microsoft.com/sql/ssms/download-sql-server-management-studio-ssms?view=sql-server-2017).

4. In **Connect to server**, enter or select this information:

    | Setting | Value |
    | ------- | ----- |
    | Server type| Select **Database Engine**.|
    | Server name| Select *myserver.database.windows.net* |
    | User name | Enter a password provided during the SQL server creation. |
    |Password |Enter a password provided during the SQL server creation. |
    |Remember password|Select **Yes**.|
    |||
1. Select **Connect**.
2. Browse databases from left menu.
3. (Optionally) Create or query information from mydatabase.
4. Close the remote desktop connection to *myVm*. 

## Clean up resources 
When you're done using the private endpoint, SQL server, and the VM, delete the resource group and all of the resources it contains: 
1. Enter *myResourceGroup* in the **Search** box at the top of the portal and select *myResourceGroup* from the search results. 
2. Select **Delete resource group**. 
3. Enter myResourceGroup for **TYPE THE RESOURCE GROUP NAME** and select **Delete**.

## Next steps

In this quickstart, you created a VM on a virtual network, a SQL database server, and a private endpoint for private access. You connected to one VM from the internet and securely communicated to the SQL database server using Private Link. To learn more about private endpoints, see [What is Azure private endpoint?](private-endpoint-overview.md).

