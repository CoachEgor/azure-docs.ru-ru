---
title: Подключайтесь к веб-приложению с помощью частной конечной точки Azure (Предварительная версия)
description: В этой статье объясняется, как с помощью частной конечной точки Azure (Предварительная версия) подключаться к веб-приложению в частном порядке.
author: ericgre
ms.assetid: b8c5c7f8-5e90-440e-bc50-38c990ca9f14
ms.topic: how-to
ms.date: 09/08/2020
ms.author: ericg
ms.service: app-service
ms.workload: web
ms.openlocfilehash: ccbcdbe9204120e1cf181136f566556ec30be871
ms.sourcegitcommit: 814778c54b59169c5899199aeaa59158ab67cf44
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2020
ms.locfileid: "90054540"
---
# <a name="connect-privately-to-a-web-app-by-using-azure-private-endpoint-preview"></a>Подключайтесь к веб-приложению с помощью частной конечной точки Azure (Предварительная версия)

Частная конечная точка Azure (Предварительная версия) является основным стандартным блоком для частной связи Azure. С помощью частной конечной точки можно подключаться к веб-приложению в частном порядке. В этой статье вы узнаете, как развернуть веб-приложение с помощью частной конечной точки и подключиться к веб-приложению из виртуальной машины.

Дополнительные сведения см. в статье [использование частных конечных точек для веб-приложения Azure][privateendpointwebapp].

> [!Note]
> Частная конечная точка (Предварительная версия) доступна в общедоступных регионах для веб-приложений Windows уровня категории премиум v2, веб-приложений Linux и плана функций Azure Premium (иногда это называется планом эластичного уровня "Премиум"). 

## <a name="sign-in-to-the-azure-portal"></a>Вход на портал Azure

Прежде чем начать, войдите в [портал Azure](https://portal.azure.com).

## <a name="create-a-virtual-network-and-virtual-machine"></a>Создание виртуальной сети и виртуальной машины

В этом разделе вы создадите виртуальную сеть и подсеть для размещения виртуальной машины, которая будет использоваться для доступа к веб-приложению через закрытую конечную точку.

### <a name="create-the-virtual-network"></a>Создание виртуальной сети

Чтобы создать виртуальную сеть и подсеть, выполните следующие действия.

1. На левой панели выберите **создать ресурс**  >  **сети**  >  **Виртуальная сеть**.

1. На панели **создать виртуальную сеть** перейдите на вкладку **основы** и введите сведения, показанные здесь:

   > [!div class="mx-imgBorder"]
   > ![Снимок экрана: область "Создание виртуальной сети" в портал Azure.][1]

1. Перейдите на вкладку **IP-адреса** и введите сведения, показанные здесь:

   > [!div class="mx-imgBorder"]
   > ![Снимок экрана вкладки "IP-адреса" в области "Создание виртуальной сети".][2]

1. В разделе **подсеть** выберите **добавить подсеть**, введите сведения, показанные здесь, а затем нажмите кнопку **добавить**.

   > [!div class="mx-imgBorder"]
   > ![Снимок экрана: панель "Добавление подсети".][3]

1. Выберите **Review + create** (Просмотреть и создать).

1. После успешной проверки выберите **создать**.

### <a name="create-the-virtual-machine"></a>Создание виртуальной машины

Чтобы создать виртуальную машину, выполните следующие действия.

1. В портал Azure на левой панели выберите **создать ресурс**  >  **вычислений**  >  **Виртуальная машина**.

1. На панели **Создание виртуальной машины — основы** введите сведения, показанные здесь:

   > [!div class="mx-imgBorder"]
   > ![Снимок экрана: область "Создание виртуальной машины".][4]

1. По завершении выберите **Next: Диски**.

1. В области **диски** сохраните параметры по умолчанию, а затем нажмите кнопку **Далее: Сетевые подключения**.

1. В области **сети** введите сведения, показанные здесь:

   > [!div class="mx-imgBorder"]
   > ![Снимок экрана: вкладка "Сетевые подключения" на панели "Создание виртуальной машины".][5]

1. Выберите **Review + create** (Просмотреть и создать).

1. После успешной проверки выберите **создать**.

## <a name="create-a-web-app-and-a-private-endpoint"></a>Создание веб-приложения и частной конечной точки

В этом разделе вы создадите частное веб-приложение, использующее закрытую конечную точку.

> [!Note]
> Функция закрытой конечной точки доступна только для уровня категории премиум v2.

### <a name="create-the-web-app"></a>Создание веб-приложения

1. В портал Azure на левой панели выберите **создать ресурс**  >  **веб**  >  **-приложение**.

1. В области **веб-приложение** перейдите на вкладку " **основы** " и введите сведения, показанные здесь:

   > [!div class="mx-imgBorder"]
   > ![Снимок экрана: вкладка "Основные сведения" в области "веб-приложение".][6]

1. Выберите **Review + create** (Просмотреть и создать).

1. После успешной проверки выберите **создать**.

### <a name="create-the-private-endpoint"></a>Создание частной конечной точки

1. В свойствах веб-приложения в разделе **Параметры**выберите **сети**, а затем в разделе **подключения к частной конечной точке (Предварительная версия)** выберите **Настройка подключений к частным конечным точкам**.

   > [!div class="mx-imgBorder"]
   > ![Снимок экрана со ссылкой "Настройка подключений к частным конечным точкам" в области "сеть веб-приложений".][7]

1. В мастере **подключения к закрытой конечной точке (Предварительная версия)** выберите **Добавить**.

   > [!div class="mx-imgBorder"]
   > ![Снимок экрана кнопки "Добавить" в мастере "подключения к частным конечным точкам (Предварительная версия)".][8]

1. Выберите правильные сведения в раскрывающихся списках **Подписка**, **Виртуальная сеть**и **подсеть** , а затем нажмите кнопку **ОК**.

   > [!div class="mx-imgBorder"]
   > ![Снимок экрана: панель "Добавление частной конечной точки (Предварительная версия)".][9]

1. Отслеживайте ход создания закрытой конечной точки.

   > [!div class="mx-imgBorder"]
   > ![Снимок экрана хода выполнения добавления частной конечной точки. ][10]
   >  ![ Снимок экрана созданной закрытой конечной точки.][11]

## <a name="connect-to-the-vm-from-the-internet"></a>Подключение к виртуальной машине из Интернета

1. В поле **поиска** портал Azure введите **myVm**.
1. Нажмите кнопку **подключить**, а затем выберите **RDP**.

   > [!div class="mx-imgBorder"]
   > ![Снимок экрана: кнопка "RDP" на панели "myVM".][12]

1. На панели **Подключение к RDP** выберите **скачать RDP-файл**.  

   > [!div class="mx-imgBorder"]
   > ![Снимок экрана: кнопка "скачать RDP-файл" в области "подключение через RDP".][13]

   Azure создаст файл протокол удаленного рабочего стола (RDP) и загрузит его на компьютер.   

1. Откройте загруженный RDP-файл.

   а. В командной строке выберите **подключить**.  
   b. Введите имя пользователя и пароль, которые вы указали при создании виртуальной машины.

     > [!Note]
     > Чтобы использовать эти учетные данные, может потребоваться выбрать **другие варианты**  >  **использовать другую учетную запись**.

1. Щелкните **ОК**.

   > [!Note]
   > Если во время входа в систему появится предупреждение сертификата, выберите **Да** или **продолжить**.

1. Когда появится окно ВМ VM (Рабочий стол), сократите его, чтобы вернуться к локальному рабочему столу.

## <a name="access-the-web-app-privately-from-the-vm"></a>Доступ к веб-приложению в частном порядке с виртуальной машины

В этом разделе вы подключаетесь к веб-приложению через закрытую конечную точку.

1. Чтобы получить частный IP-адрес частной конечной точки, в поле **поиска** введите **Private Link** , а затем в списке результатов выберите **Private Link**.

   > [!div class="mx-imgBorder"]
   > ![Снимок экрана: ссылка "Частная ссылка" в списке результатов поиска.][14]

1. В области "частный центр ссылок" на левой панели выберите **частные конечные точки** , чтобы отобразить частные конечные точки.

   > [!div class="mx-imgBorder"]
   > ![Снимок экрана со списком частных конечных точек в частном центре ссылок.][15]

1. Выберите частную конечную точку, которая ссылается на ваше веб-приложение и подсеть.

   > [!div class="mx-imgBorder"]
   > ![Снимок экрана: панель свойств для закрытой конечной точки.][16]

1. Скопируйте частный IP-адрес частной конечной точки и полное доменное имя (FQDN) приложения. В предыдущем примере закрытым ИДЕНТИФИКАТОРом является *`webappdemope.azurewebsites.net 10.10.2.4`* .

1. В области **myVM** убедитесь, что веб-приложение недоступно через общедоступный IP-адрес. Для этого откройте браузер и вставьте имя веб-приложения. Страница должна отображать сообщение "Ошибка 403-запрещено".

   > [!div class="mx-imgBorder"]
   > ![Снимок экрана со страницей ошибок "Ошибка 403-запрещено".][17]

   > [!Important]
   > Так как эта функция находится на этапе предварительной версии, необходимо вручную управлять записью службы доменных имен (DNS).

   Для DNS выполните одно из следующих действий.
 
   - Используйте службу Azure DNS частной зоны.  

     а. Создайте закрытую зону DNS с именем *`privatelink.azurewebsites.net`* и свяжите ее с виртуальной сетью.  
     b. Создайте две записи A (то есть имя приложения и имя диспетчера управления службами [SCM]) с IP-адресом частной конечной точки.  
     > [!div class="mx-imgBorder"]
     > ![Снимок экрана записей частной зоны DNS.][21]  

   - Используйте файл *hosts* виртуальной машины.  

     а. Создайте запись узлы, откройте проводник и найдите файл *hosts* .  
     > [!div class="mx-imgBorder"]
     > ![Снимок экрана, показывающий файл hosts в проводнике.][18]  
     b. Добавьте запись, содержащую частный IP-адрес и общедоступное имя веб-приложения, изменив файл *hosts* в текстовом редакторе.  
     > [!div class="mx-imgBorder"]
     > ![Снимок экрана с текстом файла hosts.][19]  
     c. Сохраните файл.

1. В браузере введите URL веб-приложения.

   > [!div class="mx-imgBorder"]
   > ![Снимок экрана браузера, отображающего веб-приложение.][20]

Теперь вы обращаетесь к веб-приложению через закрытую конечную точку.

## <a name="clean-up-resources"></a>Очистка ресурсов

Когда вы закончите использовать закрытую конечную точку, веб-приложение и виртуальную машину, удалите группу ресурсов и все содержащиеся в ней ресурсы.

1. В портал Azure в поле **поиска** введите **Ready-RG**, а затем выберите **Ready-RG** в списке результатов.

1. Выберите **Удалить группу ресурсов**.

1. В поле **введите имя группы ресурсов**введите **Ready-RG**, а затем выберите **Удалить**.

## <a name="next-steps"></a>Дальнейшие действия

В этой статье вы создали виртуальную машину в виртуальной сети, веб-приложении и частной конечной точке. Вы подключились к виртуальной машине из Интернета и безопасно взаимодействовали с веб-приложением с помощью частной ссылки. 

Дополнительные сведения о закрытой конечной точке (Предварительная версия) см. в статье [что такое частная конечная точка Azure?][privateendpoint].

<!--Image references-->
[1]: ./media/create-private-endpoint-webapp-portal/createnetwork.png
[2]: ./media/create-private-endpoint-webapp-portal/ipaddresses.png
[3]: ./media/create-private-endpoint-webapp-portal/subnet.png
[4]: ./media/create-private-endpoint-webapp-portal/virtual-machine.png
[5]: ./media/create-private-endpoint-webapp-portal/vmnetwork.png
[6]: ./media/create-private-endpoint-webapp-portal/webapp.png
[7]: ./media/create-private-endpoint-webapp-portal/webappnetworking.png
[8]: ./media/create-private-endpoint-webapp-portal/webapppe.png
[9]: ./media/create-private-endpoint-webapp-portal/webapppenetwork.png
[10]: ./media/create-private-endpoint-webapp-portal/inprogress.png
[11]: ./media/create-private-endpoint-webapp-portal/webapppefinal.png
[12]: ./media/create-private-endpoint-webapp-portal/rdp.png
[13]: ./media/create-private-endpoint-webapp-portal/rdpdownload.png
[14]: ./media/create-private-endpoint-webapp-portal/pl.png
[15]: ./media/create-private-endpoint-webapp-portal/plcenter.png
[16]: ./media/create-private-endpoint-webapp-portal/privateendpointproperties.png
[17]: ./media/create-private-endpoint-webapp-portal/forbidden.png
[18]: ./media/create-private-endpoint-webapp-portal/explorer.png
[19]: ./media/create-private-endpoint-webapp-portal/hosts.png
[20]: ./media/create-private-endpoint-webapp-portal/webappwithpe.png
[21]: ./media/create-private-endpoint-webapp-portal/dns-private-zone-records.png


<!--Links-->
[privateendpointwebapp]: https://docs.microsoft.com/azure/app-service/networking/private-endpoint
[privateendpoint]: https://docs.microsoft.com/azure/private-link/private-endpoint-overview
