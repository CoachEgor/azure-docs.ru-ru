---
title: Диагностические журналы Azure Service Bus Документы Майкрософт
description: В этой статье приводится обзор всех журналов оперативной и диагностики, доступных для Azure Service Bus.
keywords: ''
documentationcenter: .net
services: service-bus-messaging
author: axisc
manager: timlt
editor: spelluru
ms.assetid: ''
ms.service: service-bus-messaging
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: data-services
ms.date: 01/24/2020
ms.author: aschhab
ms.openlocfilehash: a80fb97810fee04a4eb50c43178c168e66f29173
ms.sourcegitcommit: bc738d2986f9d9601921baf9dded778853489b16
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/02/2020
ms.locfileid: "80618729"
---
# <a name="enable-diagnostics-logs-for-service-bus"></a>Включить журналы диагностики для сервисного автобуса

При запуске пространства имен Azure Service Bus может потребоваться отслеживать, как и когда создается, удаляется или к нему доступ к пространству имен. В этой статье приводится обзор всех доступных журналов оперативной и диагностической диагностики.

В настоящее время Azure Service Bus поддерживает журналы активности и эксплуатации, которые фиксируют *операции управления,* выполняемые в пространстве имен Azure Service Bus. В частности, в эти журналы записывается тип операции, включая создание очереди, используемые ресурсы и состояние операции.

## <a name="operational-logs-schema"></a>Схема операционных журналов

Все журналы хранятся в формате JavaScript Object Notation (JSON) в следующих двух местах:

- **AzureActivity:** Отображает журналы из операций и действий, которые проводятся против вашего пространства имен на портале Azure или через развертывания шаблонов шаблонов управления ресурсами Azure.
- **AzureDiagnostics**: Отображает журналы из операций и действий, которые проводятся против вашего пространства имен с помощью API, или через клиентов управления на языке SDK.

Строки оперативного журнала JSON включают элементы, перечисленные в следующей таблице:

| name | Описание |
| ------- | ------- |
| ActivityId | Внутренний идентификатор, используемый для определения указанного действия |
| EventName | Имя операции |
| ResourceId | Идентификатор ресурса Azure Resource Manager |
| SubscriptionId | Идентификатор подписки |
| EventTimeString | Время операции |
| EventProperties | Свойства операции |
| Состояние | Состояние операции |
| Caller | Вызов компании (портал Azure или клиент управления) |
| Категория | OperationalLogs |

Ниже приведен пример строки JSON операционного журнала.

```json
{
  "ActivityId": "6aa994ac-b56e-4292-8448-0767a5657cc7",
  "EventName": "Create Queue",
  "resourceId": "/SUBSCRIPTIONS/1A2109E3-9DA0-455B-B937-E35E36C1163C/RESOURCEGROUPS/DEFAULT-SERVICEBUS-CENTRALUS/PROVIDERS/MICROSOFT.SERVICEBUS/NAMESPACES/SHOEBOXEHNS-CY4001",
  "SubscriptionId": "1a2109e3-9da0-455b-b937-e35e36c1163c",
  "EventTimeString": "9/28/2016 8:40:06 PM +00:00",
  "EventProperties": "{\"SubscriptionId\":\"1a2109e3-9da0-455b-b937-e35e36c1163c\",\"Namespace\":\"shoeboxehns-cy4001\",\"Via\":\"https://shoeboxehns-cy4001.servicebus.windows.net/f8096791adb448579ee83d30e006a13e/?api-version=2016-07\",\"TrackingId\":\"5ee74c9e-72b5-4e98-97c4-08a62e56e221_G1\"}",
  "Status": "Succeeded",
  "Caller": "ServiceBus Client",
  "category": "OperationalLogs"
}
```

## <a name="events-and-operations-captured-in-operational-logs"></a>События и операции, запечатленные в эксплуатационных журналах

Оперативные журналы фиксируют все операции управления, выполняемые в пространстве имен Azure Service Bus. Операции данных не фиксируются из-за большого объема операций данных, которые проводятся на автобусе службы Azure.

> [!NOTE]
> Чтобы помочь вам лучше отслеживать операции с данными, мы рекомендуем использовать отслеживание клиентской стороны.

Следующие операции управления запечатлены в эксплуатационных журналах: 

| Область | Операция|
|-------| -------- |
| Пространство имен | <ul> <li> Создание пространства имен</li> <li> Обновление именного пространства </li> <li> Удалить пространство имен </li> <li> Обновление политики общего доступа к названию </li> </ul> | 
| Очередь | <ul> <li> Создать очередь</li> <li> Обновление очереди</li> <li> Удаление очереди. </li> <li> Очередь автоматического удаления </li> </ul> | 
| Раздел | <ul> <li> Создание раздела </li> <li> Обновление раздела </li> <li> Удалить раздел </li> <li> Тема удаления автоудалить </li> </ul> |
| Подписка | <ul> <li> Создавать подписку </li> <li> Обновлять подписку </li> <li> Удалять подписку </li> <li> Подписка на удаление автоудалить </li> </ul> |

> [!NOTE]
> В настоящее время операции *Чтения* не отслеживаются в операционных журналах.

## <a name="enable-operational-logs"></a>Включить эксплуатационные журналы

Оперативные журналы отключены по умолчанию. Для включения журналов диагностики сделайте следующее:

1. На [портале Azure](https://portal.azure.com)перейдите в пространство имен Azure Service Bus, а затем, под **мониторингом,** выберите **настройки диагностики.**

   ![Ссылка "Диагностические настройки"](./media/service-bus-diagnostic-logs/image1.png)

1. В **настройках диагностики** панели, выберите **Добавить диагностическую настройку.**  

   ![Ссылка "Добавить диагностическую настройку"](./media/service-bus-diagnostic-logs/image2.png)

1. Настройте настройки диагностики следующим образом:

   а. В поле **Name** введите имя для настроек диагностики.  

   b. Выберите один из следующих трех направлений для журналов диагностики:  
   - Если вы выберете **Архив для учетной записи хранилища,** вам необходимо настроить учетную запись хранения, где будут храниться журналы диагностики.  
   - При выборе **Stream в концентратор событий**необходимо настроить концентратор событий, в который необходимо настроить журналы диагностики.
   - При выборе **аналитики журнала**необходимо указать, в какой экземпляр Log Analytics будет отправлена диагностика.  

   c. Выберите флажок **OperationalLogs.**

    ![Панель "Настройки диагностики"](./media/service-bus-diagnostic-logs/image3.png)

1. Щелкните **Сохранить**.

Новые настройки всняут в силу примерно через 10 минут. Бревна отображаются в настроенной архивной цели, в панели **журналов Диагностика.**

Для получения дополнительной информации о настройке [overview of Azure diagnostics logs](../azure-monitor/platform/diagnostic-logs-overview.md)параметров диагностики см.

## <a name="next-steps"></a>Следующие шаги

Чтобы узнать больше о Сервисный автобус, см.:

* [Основные сведения о служебной шине](service-bus-messaging-overview.md)
* [Приступая к работе со служебной шиной](service-bus-dotnet-get-started-with-queues.md)
