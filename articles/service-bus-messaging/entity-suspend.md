---
title: Служебная шина Azure — приостановка сущностей обмена сообщениями
description: В этой статье объясняется, как временно приостановить и повторно активировать объекты сообщений служебной шины Azure (очереди, разделы и подписки).
ms.topic: article
ms.date: 09/29/2020
ms.openlocfilehash: f89e17e494cc777691b7f7ca47538cd29114d2dc
ms.sourcegitcommit: a422b86148cba668c7332e15480c5995ad72fa76
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/30/2020
ms.locfileid: "91575264"
---
# <a name="suspend-and-reactivate-messaging-entities-disable"></a>Приостановка и повторная активация сущностей обмена сообщениями (отключение)

Очереди, разделы и подписки можно временно приостанавливать. Приостановка помещает сущность в отключенное состояние, при котором все сообщения остаются в хранилище. Однако удалить или добавить сообщения нельзя, а соответствующие операции протокола выдают ошибки.

Приостановка сущности обычно осуществляется, если нужно срочно выполнить какие-либо задачи администрирования. Одним из сценариев является наличие неисправного приемника, который принимает сообщения из очереди, не может их обработать и при этом неправильно завершает сообщения и удаляет их. Если обнаружено такое поведение, для очереди можно отключить операции получения до тех пор, пока не будет развернут исправленный код и дальнейшую потерю данных из-за неправильного кода можно будет предотвратить.

Приостановку или повторную активацию может выполнить либо пользователь, либо система. Система приостанавливает сущности только из-за серьезных причин, связанных с администрированием, например при достижении предельной суммы расходов на подписку. Отключенные системой сущности не могут быть повторно активированы пользователем, но восстанавливаются, когда причина приостановки устранена.

## <a name="queue-status"></a>Состояние очереди 
Для очереди можно установить следующие состояния.

-   **Active** (активно): очередь активна.
-   **Disabled** (отключено): очередь приостановлена. Это эквивалентно установке **сенддисаблед** и **рецеиведисаблед**. 
-   **SendDisabled** (отправка отключена): очередь частично приостановлена, при этом получение разрешено.
-   **ReceiveDisabled** (получение отключено): очередь частично приостановлена, при этом отправка разрешена.

### <a name="change-the-queue-status-in-the-azure-portal"></a>Измените состояние очереди в портал Azure: 

1. В портал Azure перейдите к пространству имен служебной шины. 
1. Выберите очередь, для которой необходимо изменить состояние. Очереди отображаются в нижней области в середине. 
1. На странице **очередь служебной шины** просмотрите текущее состояние очереди в виде гиперссылки. Если **Обзор** не выбран в меню слева, выберите его, чтобы просмотреть состояние очереди. Выберите текущее состояние очереди, чтобы изменить его. 

    :::image type="content" source="./media/entity-suspend/select-state.png" alt-text="Выберите состояние очереди":::
4. Выберите новое состояние очереди и нажмите кнопку **ОК**. 

    :::image type="content" source="./media/entity-suspend/entity-state-change.png" alt-text="Выберите состояние очереди":::
    
Портал позволяет отключать очереди только полностью. Также можно отключить операции отправки и получения по отдельности, используя API служебной шины [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager) в пакете SDK для .NET Framework, или с помощью шаблона Azure Resource Manager через Azure CLI или Azure PowerShell.

### <a name="change-the-queue-status-using-azure-powershell"></a>Изменение состояния очереди с помощью Azure PowerShell
В следующем примере показана команда PowerShell для отключения очереди. Команда повторной активации эквивалентна установке значения **Active** для параметра `Status`.

```powershell
$q = Get-AzServiceBusQueue -ResourceGroup mygrp -NamespaceName myns -QueueName myqueue

$q.Status = "Disabled"

Set-AzServiceBusQueue -ResourceGroup mygrp -NamespaceName myns -QueueName myqueue -QueueObj $q
```

## <a name="topic-status"></a>Состояние раздела
Изменение состояния раздела в портал Azure похоже на изменение состояния очереди. При выборе текущего состояния раздела отображается следующая страница, которая позволяет изменить состояние. 

:::image type="content" source="./media/entity-suspend/topic-state-change.png" alt-text="Выберите состояние очереди":::

Для раздела можно задать следующие состояния.
- **Активный**: раздел активен.
- **Отключено**. раздел приостановлен.
- **Сенддисаблед**: тот же результат, что и **отключено**.

## <a name="subscription-status"></a>Состояние подписки
Изменение состояния подписки в портал Azure похоже на изменение состояния раздела или очереди. При выборе текущего состояния подписки отображается следующая страница, которая позволяет изменить состояние. 

:::image type="content" source="./media/entity-suspend/subscription-state-change.png" alt-text="Выберите состояние очереди":::

Для раздела можно задать следующие состояния.
- **Активный**: раздел активен.
- **Отключено**. раздел приостановлен.
- **Рецеиведисаблед**: тот же результат, что и **отключено**.

## <a name="other-statuses"></a>Другие состояния
Перечисление [EntityStatus](/dotnet/api/microsoft.servicebus.messaging.entitystatus) также определяет набор переходных состояний, которые могут устанавливаться только системой. 


## <a name="next-steps"></a>Дальнейшие действия

Дополнительные сведения об обмене сообщениями через служебную шину см. в следующих статьях:

* [Очереди, разделы и подписки служебной шины](service-bus-queues-topics-subscriptions.md)
* [Начало работы с очередями служебной шины](service-bus-dotnet-get-started-with-queues.md)
* [Как использовать разделы и подписки служебной шины](service-bus-dotnet-how-to-use-topics-subscriptions.md)

[1]: ./media/entity-suspend/entity-state-change.png

