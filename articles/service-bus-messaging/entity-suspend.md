---
title: Служебная шина Azure — приостановка сущностей обмена сообщениями
description: В этой статье объясняется, как временно приостановить и повторно активировать объекты сообщений служебной шины Azure (очереди, разделы и подписки).
ms.topic: article
ms.date: 06/23/2020
ms.openlocfilehash: 4c4e554ada8c66b56d5d466c7becfc813701402a
ms.sourcegitcommit: 877491bd46921c11dd478bd25fc718ceee2dcc08
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/02/2020
ms.locfileid: "85339997"
---
# <a name="suspend-and-reactivate-messaging-entities-disable"></a>Приостановка и повторная активация сущностей обмена сообщениями (отключение)

Очереди, разделы и подписки можно временно приостанавливать. Приостановка помещает сущность в отключенное состояние, при котором все сообщения остаются в хранилище. Однако удалить или добавить сообщения нельзя, а соответствующие операции протокола выдают ошибки.

Приостановка сущности обычно осуществляется, если нужно срочно выполнить какие-либо задачи администрирования. Одним из сценариев является наличие неисправного приемника, который принимает сообщения из очереди, не может их обработать и при этом неправильно завершает сообщения и удаляет их. Если обнаружено такое поведение, для очереди можно отключить операции получения до тех пор, пока не будет развернут исправленный код и дальнейшую потерю данных из-за неправильного кода можно будет предотвратить.

Приостановку или повторную активацию может выполнить либо пользователь, либо система. Система приостанавливает сущности только из-за серьезных причин, связанных с администрированием, например при достижении предельной суммы расходов на подписку. Отключенные системой сущности не могут быть повторно активированы пользователем, но восстанавливаются, когда причина приостановки устранена.

На портале раздел **свойств** соответствующей сущности позволяет изменить состояние. на следующем снимке экрана показан переключатель для очереди:

![][1]

Портал позволяет отключать очереди только полностью. Также можно отключить операции отправки и получения по отдельности, используя API служебной шины [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager) в пакете SDK для .NET Framework, или с помощью шаблона Azure Resource Manager через Azure CLI или Azure PowerShell.

[!INCLUDE [updated-for-az](../../includes/updated-for-az.md)]

## <a name="suspension-states"></a>Состояния приостановки

Для очереди можно установить следующие состояния.

-   **Active** (активно): очередь активна.
-   **Disabled** (отключено): очередь приостановлена.
-   **SendDisabled** (отправка отключена): очередь частично приостановлена, при этом получение разрешено.
-   **ReceiveDisabled** (получение отключено): очередь частично приостановлена, при этом отправка разрешена.

Для подписок и разделов можно задать только состояния **Active** и **Disabled**.

Перечисление [EntityStatus](/dotnet/api/microsoft.servicebus.messaging.entitystatus) также определяет набор переходных состояний, которые могут устанавливаться только системой. В следующем примере показана команда PowerShell для отключения очереди. Команда повторной активации эквивалентна установке значения **Active** для параметра `Status`.

```powershell
$q = Get-AzServiceBusQueue -ResourceGroup mygrp -NamespaceName myns -QueueName myqueue

$q.Status = "Disabled"

Set-AzServiceBusQueue -ResourceGroup mygrp -NamespaceName myns -QueueName myqueue -QueueObj $q
```

## <a name="next-steps"></a>Дальнейшие шаги

Дополнительные сведения об обмене сообщениями через служебную шину см. в следующих статьях:

* [Очереди, разделы и подписки служебной шины](service-bus-queues-topics-subscriptions.md)
* [Начало работы с очередями служебной шины](service-bus-dotnet-get-started-with-queues.md)
* [Как использовать разделы и подписки служебной шины](service-bus-dotnet-how-to-use-topics-subscriptions.md)

[1]: ./media/entity-suspend/queue-disable.png

