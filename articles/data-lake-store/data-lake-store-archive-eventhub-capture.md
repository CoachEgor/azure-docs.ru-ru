---
title: Запись данных из концентраторов событий в Azure Data Lake Storage 1-го поколения
description: Используйте Azure Data Lake Storage 1-го поколения для записи данных, получаемых концентраторами событий Azure.
author: twooley
ms.service: data-lake-store
ms.topic: how-to
ms.date: 05/29/2018
ms.author: twooley
ms.openlocfilehash: 9d663c2e95ee94811d70a0602b35842a789dd9b3
ms.sourcegitcommit: 877491bd46921c11dd478bd25fc718ceee2dcc08
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/02/2020
ms.locfileid: "85515771"
---
# <a name="use-azure-data-lake-storage-gen1-to-capture-data-from-event-hubs"></a>Сбор данных из Центров событий с помощью Azure Data Lake Storage 1-го поколения

В этой статье приведены сведения о сборе данных, полученных Центрами событий Azure, с помощью Azure Data Lake Storage 1-го поколения.

## <a name="prerequisites"></a>Предварительные условия

* **Подписка Azure**. См. страницу [бесплатной пробной версии Azure](https://azure.microsoft.com/pricing/free-trial/).

* **Учетная запись Azure Data Lake Storage 1-го поколения**. За инструкциями по созданию учетной записи обращайтесь к статье [Начало работы с Azure Data Lake Storage 1-го поколения](data-lake-store-get-started-portal.md).

*  **Пространство имен концентраторов событий**. Дополнительные сведения см. в разделе [Создание пространства имен Центров событий](../event-hubs/event-hubs-create.md#create-an-event-hubs-namespace). Убедитесь, что учетная запись Data Lake Storage 1-го поколения и пространство имен Центров событий находятся в одной подписке Azure.


## <a name="assign-permissions-to-event-hubs"></a>Назначение разрешений Центрам событий

В этом разделе вы создадите папку в учетной записи, в которой необходимо собрать данные из Центров событий. Вы также можете назначить разрешения Центрам событий. Это позволит им записывать данные в учетную запись Data Lake Storage 1-го поколения. 

1. Откройте учетную запись Data Lake Storage 1-го поколения, в которую необходимо собрать данные из Центров событий, и щелкните **Обозреватель данных**.

    ![Data Lake Storage 1-го поколения обозреватель данных](./media/data-lake-store-archive-eventhub-capture/data-lake-store-open-data-explorer.png "Data Lake Storage 1-го поколения обозреватель данных")

1.  Выберите **Создать папку** и введите имя папки, в которую необходимо сохранять данные.

    ![Создание новой папки в Data Lake Storage 1-го поколения](./media/data-lake-store-archive-eventhub-capture/data-lake-store-create-new-folder.png "Создание новой папки в Data Lake Storage 1-го поколения")

1. Назначьте разрешения в корневой папке Data Lake Storage 1-го поколения. 

    а. Щелкните **Обозреватель данных**, выберите корневую папку учетной записи Data Lake Storage 1-го поколения, а затем — **Доступ**.

    ![Назначение разрешений для корневого Data Lake Storage 1-го поколения](./media/data-lake-store-archive-eventhub-capture/data-lake-store-assign-permissions-to-root.png "Назначение разрешений для корневого Data Lake Storage 1-го поколения")

    b. В разделе **Доступ** выберите **Добавить**, щелкните **Выберите пользователя или группу**, а затем найдите `Microsoft.EventHubs`. 

    ![Назначение разрешений для корневого Data Lake Storage 1-го поколения](./media/data-lake-store-archive-eventhub-capture/data-lake-store-assign-eventhub-sp.png "Назначение разрешений для корневого Data Lake Storage 1-го поколения")
    
    Нажмите кнопку **Выбрать**.

    c. В разделе **Назначение разрешений** выберите **Выбор разрешений**. Задайте для параметра **Разрешения** значение **Выполнить**. Задайте для параметра **Добавить к** значение **К этой папке и всем вложенным элементам**. Задайте для параметра **Add as** (Добавить как) значение **Запись разрешений доступа и запись разрешений по умолчанию**.

    > [!IMPORTANT]
    > Это простой способ обеспечения доступа к целевой папке при создании новой иерархии папок для записи данных, поступающих в Центры событий Azure.  Однако добавление разрешений для всех дочерних элементов папки верхнего уровня с многочисленными дочерними файлами и папками может занять много времени.  Если корневая папка содержит большое число файлов и папок, возможно, быстрее будет добавить разрешения на **выполнение** для `Microsoft.EventHubs` по отдельности в каждую папку в пути к конечной целевой папке. 

    ![Назначение разрешений для корневого Data Lake Storage 1-го поколения](./media/data-lake-store-archive-eventhub-capture/data-lake-store-assign-eventhub-sp1.png "Назначение разрешений для корневого Data Lake Storage 1-го поколения")

    Нажмите кнопку **ОК**.

1. Назначьте разрешения папке в учетной записи Data Lake Storage 1-го поколения, в которой необходимо сохранить данные.

    а. Щелкните **Обозреватель данных**, выберите папку в учетной записи Data Lake Storage 1-го поколения, а затем — **Доступ**.

    ![Назначение разрешений для папки Data Lake Storage 1-го поколения](./media/data-lake-store-archive-eventhub-capture/data-lake-store-assign-permissions-to-folder.png "Назначение разрешений для папки Data Lake Storage 1-го поколения")

    b. В разделе **Доступ** выберите **Добавить**, щелкните **Выберите пользователя или группу**, а затем найдите `Microsoft.EventHubs`. 

    ![Назначение разрешений для папки Data Lake Storage 1-го поколения](./media/data-lake-store-archive-eventhub-capture/data-lake-store-assign-eventhub-sp.png "Назначение разрешений для папки Data Lake Storage 1-го поколения")
    
    Нажмите кнопку **Выбрать**.

    c. В разделе **Назначение разрешений** выберите **Выбор разрешений**. Для параметра **Разрешения** установите флажки **Чтение, Запись** и **Выполнить**. Задайте для параметра **Добавить к** значение **К этой папке и всем вложенным элементам**. Наконец, задайте для параметра **Add as** (Добавить как) значение **Запись разрешений доступа и запись разрешений по умолчанию**.

    ![Назначение разрешений для папки Data Lake Storage 1-го поколения](./media/data-lake-store-archive-eventhub-capture/data-lake-store-assign-eventhub-sp-folder.png "Назначение разрешений для папки Data Lake Storage 1-го поколения")
    
    Нажмите кнопку **ОК**. 

## <a name="configure-event-hubs-to-capture-data-to-data-lake-storage-gen1"></a>Настройка Центров событий для сбора данных в Data Lake Storage 1-го поколения

В этом разделе вы создаете концентратор событий в пространстве имен Центров событий. Кроме того, вы также настроите концентратор событий для записи данных в учетную запись Azure Data Lake Storage 1-го поколения. В этом разделе предполагается, что вы уже создали пространство имен Центров событий.

1. В области **Обзор** пространства имен Центров событий выберите **+Концентратор событий**.

    ![Создание концентратора событий](./media/data-lake-store-archive-eventhub-capture/data-lake-store-create-event-hub.png "Создание концентратора событий")

1. Чтобы настроить Центры событий для сбора данных в Data Lake Storage 1-го поколения, укажите приведенные ниже значения.

    ![Создание концентратора событий](./media/data-lake-store-archive-eventhub-capture/data-lake-store-configure-eventhub.png "Создание концентратора событий")

    а. Укажите имя концентратора событий.
    
    b. В этом руководстве задайте для параметров **Количество разделов** и **Хранение сообщений** значения по умолчанию.
    
    c. Установите для параметра **Запись** значение **Включено**. Задайте **окно времени** (частота выполнения записи) и **окно размера** (размер данных для записи). 
    
    d. Для параметра **Capture Provider** (Поставщик сбора) задайте значение **Azure Data Lake Store** и выберите учетную запись Data Lake Storage 1-го поколения, созданную ранее. В качестве значения параметра **Data Lake Path** (Путь к Data Lake) введите имя папки, созданной в учетной записи Data Lake Storage 1-го поколения. Необходимо только указать относительный путь к папке.

    д) Оставьте стандартное значение параметра **Воспользуйтесь поиском, чтобы отфильтровать репликации**. Этот параметр определяет структуру папки, созданной в папке записи.

    е) Нажмите кнопку **Создать**.

## <a name="test-the-setup"></a>Тестирование настройки

Теперь вы можете протестировать решение, отправив данные в концентратор событий Azure. Инструкции см. в статье [Отправка событий в Центры событий Azure с помощью платформы .NET Framework](../event-hubs/event-hubs-dotnet-framework-getstarted-send.md). Отправляемые данные отобразятся в Data Lake Storage 1-го поколения с использованием указанной структуры папок. Например, на снимке экрана ниже приведена структура папок, в которой отобразятся данные в учетной записи Data Lake Storage 1-го поколения.

![Пример данных EventHub в Data Lake Storage 1-го поколения](./media/data-lake-store-archive-eventhub-capture/data-lake-store-eventhub-data-sample.png "Пример данных EventHub в Data Lake Storage 1-го поколения")

> [!NOTE]
> Даже если в Центры событий не поступают сообщения, они записывают пустые файлы лишь с заголовками в учетную запись Data Lake Storage 1-го поколения. Файлы записываются с интервалом времени, указанным при создании концентраторов событий.
> 
>

## <a name="analyze-data-in-data-lake-storage-gen1"></a>Анализ данных в Data Lake Storage 1-го поколения

Когда данные появятся в Data Lake Storage 1-го поколения, вы можете выполнить задания аналитики, чтобы обработать их. Сведения об использовании Azure Data Lake Analytics для выполнения этих действий см. в [примере USQL Avro](https://github.com/Azure/usql/tree/master/Examples/AvroExamples).
  

## <a name="see-also"></a>См. также
* [Защита данных в Data Lake Storage Gen1](data-lake-store-secure-data.md)
* [Копирование данных из больших двоичных объектов хранилища Azure в хранилище озера данных](data-lake-store-copy-data-azure-storage-blob.md)
