---
title: Управление параллелизмом — Azure Marketplace
description: Стратегии управления параллелизмом для API-интерфейсов публикации на портале Cloud Partner.
author: dsindona
ms.service: marketplace
ms.subservice: partnercenter-marketplace-publisher
ms.topic: conceptual
ms.date: 04/08/2020
ms.author: dsindona
ms.openlocfilehash: dec18daea2f4f257e3bb21ee0477e3629b2e630b
ms.sourcegitcommit: 877491bd46921c11dd478bd25fc718ceee2dcc08
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/02/2020
ms.locfileid: "85516138"
---
# <a name="concurrency-control"></a>Управление параллелизмом

> [!NOTE]
> Программные интерфейсы Портала Cloud Partner интегрированы с Центром партнеров и продолжат работать после миграции предложений в Центр партнеров. Интеграция включает небольшие изменения. Ознакомьтесь с изменениями, приведенными в [справочнике по портал Cloud Partner API](./cloud-partner-portal-api-overview.md) , чтобы убедиться, что код будет продолжать работать после перехода в центр партнеров.

При каждом вызове API-интерфейсов публикации на портале Cloud Partner необходимо явно указать, какую стратегию управления параллелизмом использовать. Если заголовок **If-Match** не предоставлен, это приведет к появлению сообщения об ошибке HTTP 400. Мы предлагаем две стратегии для управления параллелизмом.

-   **Оптимистичный**. Клиент, выполняющий обновления, проверяет, не изменились ли данные с момента последнего чтения данных.
-   **Приоритет последнего**. Клиент непосредственно обновляет данные, независимо от изменений, внесенных другим приложением с момента последнего чтения.

<a name="optimistic-concurrency-workflow"></a>Рабочий процесс оптимистичного параллелизма
-------------------------------

Стратегию оптимистичного параллелизма рекомендуется использовать, чтобы гарантировано избежать непредвиденных изменений ресурсов.

1.  Получите сущность с помощью API-интерфейсов. Ответ содержит значение ETag, которое определяет текущую хранимую версию сущности (во время ответа).
2.  Во время обновления добавьте это значение ETag в обязательный заголовок запроса **If-Match**.
3.  API сравнивает значение ETag, полученное в запросе с текущим значением ETag сущности в атомарной транзакции.
    *   Если значения ETag не совпадают, API возвращает ответ HTTP `412 Precondition Failed`. Эта ошибка означает, что другой процесс выполнил обновление сущности с момента его последнего получения клиента или что в запросе указано неверное значение ETag.
    *  Если значения ETag совпадают, или заголовок **If-Match** содержит подстановочный символ звездочки (`*`), API выполняет запрошенную операцию. Операция API также обновляет хранимое значение ETag сущности.


> [!NOTE]
> Если указать подстановочный знак (*) в заголовке **If-Match**, API будет использовать стратегию параллелизма "Приоритет последнего". В этом случае сравнение значений ETag не происходит и ресурс обновляется без каких-либо проверок. 
