---
title: Создание виртуального жесткого диска, совместимого с Azure, для Azure Marketplace
description: В этой статье объясняется, как создать виртуальный жесткий диск для предложения виртуальной машине в Azure Marketplace.
services: Azure, Marketplace, Cloud Partner Portal,
author: pbutlerm
ms.service: marketplace
ms.subservice: partnercenter-marketplace-publisher
ms.topic: article
ms.date: 08/27/2018
ms.author: pabutler
ms.openlocfilehash: 37fecb8100ec40ace02960a4f3390420a8bfc735
ms.sourcegitcommit: ac56ef07d86328c40fed5b5792a6a02698926c2d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/08/2019
ms.locfileid: "73816807"
---
# <a name="create-an-azure-compatible-vhd"></a>Создание виртуального жесткого диска, совместимого с Azure

В этой статье описываются действия по созданию виртуального жесткого диска для предложения виртуальной машины в Azure Marketplace.  Здесь также содержатся рекомендации касательно различных аспектов, таких как использование протокола удаленного рабочего стола, выбор размера для виртуальной машины, установка последних обновлений Windows и обобщение образа виртуального жесткого диска.  Следующие разделы главным образом сосредоточены на виртуальных жестких дисках на платформе Windows. Дополнительные сведения о создании виртуальных жестких дисков на платформе Linux см. в статье [Дистрибутивы Linux, рекомендованные для использования в Azure](../../../virtual-machines/linux/endorsed-distros.md). 

> [!WARNING]
> Настоятельно рекомендуется следовать инструкциям в этом разделе, чтобы с использованием Azure создать виртуальную машину, содержащую предварительно настроенную рекомендуемую операционную систему.  Если это несовместимо с решением, можно создать и настроить локальную виртуальную машину с помощью утвержденной операционной системы.  Затем ее можно настроить и подготовить к отправке, как описано в статье [Подготовка диска VHD или VHDX для Windows к отправке в Azure](https://docs.microsoft.com/azure/virtual-machines/windows/prepare-for-upload-vhd-image).


## <a name="select-an-approved-base"></a>Выбор утвержденной базы
Виртуальный жесткий диск с ОС для вашего образа виртуальной машины должен быть основан на базовом образе, одобренном для Azure и содержащем Windows Server или SQL Server.
Для начала создайте виртуальную машину из одного из следующих образов, расположенных на портале Microsoft Azure:

-   Windows Server ([2016](https://www.microsoft.com/evalcenter/evaluate-windows-server-2016), [2012 R2 Datacenter](https://azuremarketplace.microsoft.com/marketplace/apps/microsoftwindowsserver.windowsserver?tab=Overview), [2012 Datacenter](https://azuremarketplace.microsoft.com/marketplace/apps/microsoftwindowsserver.windowsserver?tab=Overview), [2008 R2 SP1](https://azuremarketplace.microsoft.com/marketplace/apps/microsoftwindowsserver.windowsserver?tab=Overview));
-   [SQL Server 2014](https://docs.microsoft.com/azure/virtual-machines/windows/sql/virtual-machines-windows-sql-server-pricing-guidance) (Enterprise, Standard, Web);
-   [SQL Server 2012 SP2](https://docs.microsoft.com/azure/virtual-machines/windows/sql/virtual-machines-windows-sql-server-pricing-guidance) (Enterprise, Standard, Web).

> [!TIP]
> Если вы используете текущую версию портала Azure или PowerShell, используйте образы Windows Server, опубликованные 8 сентября 2014 г. или позднее, одобренные для Azure.

Кроме того, Azure предлагает широкий диапазон утвержденных дистрибутивов Linux.  Текущий список см. в статье [Дистрибутивы Linux, рекомендованные для использования в Azure](https://docs.microsoft.com/azure/virtual-machines/linux/endorsed-distros).


## <a name="create-vm-in-the-azure-portal"></a>Создание виртуальной машины с помощью портала Azure 

Чтобы создать базовый образ на [портале Microsoft Azure](https://ms.portal.azure.com/), сделайте следующее:

1. Войдите на портал, используя учетную запись Майкрософт для подписки Azure, в которой нужно опубликовать свое предложение виртуальной машины.
2. Создайте группу ресурсов и укажите **имя**, **расположение группы ресурсов** и **подписку**.  Дополнительные рекомендации см. в разделе [Управление группами ресурсов](https://docs.microsoft.com/azure/azure-resource-manager/resource-group-portal).
3. Выберите **Виртуальные машины** в строке меню слева для отображения страницы сведений о виртуальных машинах. 
4. На этой новой странице щелкните **+ Добавить**, чтобы отобразить колонку **Вычисления**.  Если на начальном экране не отображается тип виртуальной машины, можно найти имя базовой виртуальной машины, например:

    ![Колонка вычисления новой виртуальной машины](./media/publishvm_014.png)

5. После выбора правильного виртуального образа введите следующие значения:
   * В колонке **Основные сведения** укажите **имя** виртуальной машины длиной от 1 до 15 буквенно-цифровых символов. (В этом примере используется `DemoVm009`.)
   * Введите в соответствующих полях **имя пользователя** и надежный **пароль**, которые будут использоваться для создания локальной учетной записи на виртуальной машине.  (Здесь `adminUser` используется.)  Пароль должен содержать 8-123 символов и соответствовать трем из четырех следующих требований сложности: одна строчная буква, одна прописная буква, одна цифра и один специальный символ. Дополнительные сведения см. в разделе [Какие требования к имени пользователя при создании виртуальной машины?](https://docs.microsoft.com/azure/virtual-machines/virtual-machines-windows-faq#what-are-the-username-requirements-when-creating-a-vm)
   * Выберите созданную группу ресурсов (здесь используется `DemoResourceGroup`).
   * Выберите **расположение** центра обработки данных Azure (здесь используется `West US`).
   * Нажмите кнопку **ОК**, чтобы сохранить эти значения. 

6. Выберите размер развертываемой виртуальной машины, используя следующие рекомендации:
   * Если вы планируете локальную разработку VHD, размер не имеет значения. Мы рекомендуем использовать виртуальные машины небольшого размера.
   * Если вы планируете разработку образа в среде Azure, лучше использовать один из рекомендуемых размеров виртуальной машины для выбранного образа.
   * С ценами можно ознакомиться в разделе **Рекомендуемые ценовые категории** на портале. В этом разделе можно найти три рекомендуемых размера, предоставленных издателем. (Издателем является Майкрософт.)

   ![Размер колонки новой виртуальной машины](./media/publishvm_015.png)

7. В колонке **Параметры** задайте для параметра **Use Managed Disk** (Использование управляемого диска) значение **Нет**.  Так вы сможете вручную управлять новым виртуальным жестким диском. (В колонке **Параметры** также можно изменить другие параметры хранилища и сети, например выбрать **Premium (SSD)** в **поле Тип диска**).  Нажмите кнопку **ОК** , чтобы продолжить.

    ![Колонка "Параметры" новой виртуальной машины](./media/publishvm_016.png)

8. Щелкните **Сводка** , чтобы просмотреть выбранные значения. При появлении сообщения **Проверка пройдена** нажмите кнопку **ОК**.

    ![Колонка "Сводка" новой виртуальной машины](./media/publishvm_017.png)

Azure начнет подготовку указанной вами виртуальной машины.  Ход выполнения можно отслеживать, щелкнув вкладку **Виртуальные машины** слева.  После создания виртуальной машины ее состояние изменится на **Выполняется**.  На этом этапе можно [подключиться к виртуальной машине](./cpp-connect-vm.md).


## <a name="next-steps"></a>Дальнейшие действия

Если во время создания нового VHD на платформе Azure возникли сложности, обратитесь к статье [Common issues during VHD creation (FAQ)](./cpp-common-vhd-creation-issues.md). (Вопросы и ответы о распространенных проблемах во время создания VHD).  В противном случае необходимо [подключиться к виртуальным машинам](./cpp-connect-vm.md), созданным в Azure. 
