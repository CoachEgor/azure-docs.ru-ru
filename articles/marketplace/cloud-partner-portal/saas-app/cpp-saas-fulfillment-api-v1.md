---
title: API V1 SaaS выполнения | Azure Marketplace
description: Объясняется, как создать предложение SaaS в Azure Marketplace с помощью связанных исполнение V1 API-интерфейсы.
services: Azure, Marketplace, Cloud Partner Portal,
author: v-miclar
ms.service: marketplace
ms.topic: reference
ms.date: 03/28/2019
ms.author: pabutler
ROBOTS: NOINDEX
ms.openlocfilehash: 816bdc61f85fdf171870a5b552661b816ec65e2f
ms.sourcegitcommit: c53a800d6c2e5baad800c1247dce94bdbf2ad324
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/30/2019
ms.locfileid: "64943141"
---
# <a name="saas-fulfillment-apis-version-1--deprecated"></a>SaaS реализации API-интерфейсов версии 1 (устаревшая версия)

В этой статье объясняется, как создать предложение SaaS через API-интерфейсы. API-интерфейсы, состоит из REST-методы и конечные точки, необходимы разрешения подписки на предложение SaaS, если имеют продать через Azure выбран.  

> [!WARNING]
> Этот начальной версии API SaaS выполнения устарел. Вместо этого используйте [API V2 SaaS выполнения](./cpp-saas-fulfillment-api-v2.md).  Этот API в настоящее время поддерживается только для того, для обслуживания существующих издателей. 

Чтобы помочь вам интегрировать службу SaaS с Azure, мы предоставляем следующие API:

-   Разрешить
-   Подписаться
-   Convert
-   Unsubscribe (отмена подписки).


## <a name="api-methods-and-endpoints"></a>Методы API и конечных точек

В следующих разделах описаны методы и конечные точки API, которые позволяют настраивать подписки для работы с предложением SaaS.


### <a name="marketplace-api-endpoint-and-api-version"></a>Конечная точка API Marketplace и версия API

Конечная точка для API Azure Marketplace имеет адрес `https://marketplaceapi.microsoft.com`.

Текущая версия API — `api-version=2017-04-15`.


### <a name="resolve-subscription"></a>Разрешение подписки

Действие POST для конечной точки разрешения позволяет пользователям разрешать токен marketplace постоянному идентификатору ресурса.  Идентификатор ресурса — это уникальный идентификатор для подписки SAAS. 

Когда пользователь перенаправляется на веб-сайт ISV, URL-адрес содержит токен в параметрах запроса. Ожидается, что ISV будет использовать этот токен и отправит запрос на его разрешение. Ответ содержит уникальный идентификатор подписки SAAS, имя, идентификатор предложения и план для ресурса. Этот токен действителен только в течение часа.

*Запрос*

**POST**

**https://marketplaceapi.microsoft.com/api/saas/subscriptions/resolve?api-version=2017-04-15**

|  **Имя параметра** |     **Описание**                                      |
|  ------------------ |     ---------------------------------------------------- |
|  api-version        |  Версия операции, используемой для этого запроса.   |
|  |  |


*Заголовки*

| **Ключ заголовка**     | **Обязательный** | **Описание**                                                                                                                                                                                                                  |
|--------------------|--------------|-----------------------------------------------------------|
| x-ms-requestid     | Нет            | Уникальное строковое значение для отслеживания запроса клиента, желательно GUID. Если это значение не указано, оно создается случайным образом и возвращается в заголовке ответа.  |
| x-ms-correlationid | Нет            | Уникальное строковое значение для операции на стороне клиента. Это значение позволяет сопоставить все события клиентской операции с событиями на стороне сервера. Если это значение не указано, оно создается случайным образом и возвращается в заголовке ответа. |
| Content-type       | Yes          | `application/json`                                        |
| authorization      | Yes          | Токен носителя JSON Web Token (JWT).                    |
| x-ms-marketplace-token| Yes| Параметр токена запроса в URL-адресе при перенаправлении пользователя из Azure на веб-сайт SaaS независимого поставщика программного обеспечения. **Примечание.** Этот маркер является действительным только на протяжении 1 часа. Кроме того, URL-адрес декодирует полученное из браузера значение токена, прежде чем использовать его.|
|  |  |  |
  

*Текст ответа*

``` json
{
    "id": "",
    "subscriptionName": "",
    "offerId": "",
    "planId": "",
}
```

| **Имя параметра** | **Тип данных** | **Описание**                       |
|--------------------|---------------|---------------------------------------|
| id                 | Строка        | Идентификатор подписки SaaS          |
| subscriptionName| Строка| Имя подписки SaaS, которое пользователь указал в Azure при подписке на службу SaaS.|
| OfferId            | Строка        | Идентификатор предложения, на которое подписан пользователь. |
| planId             | Строка        | Идентификатор плана, на который подписан пользователь.  |
|  |  |  |


*Коды отклика*

| **Код состояния HTTP** | **Код ошибки**     | **Описание**                                                                         |
|----------------------|--------------------| --------------------------------------------------------------------------------------- |
| 200                  | `OK`                 | Токен успешно разрешен.                                                            |
| 400                  | `BadRequest`         | Отсутствуют необходимые заголовки, или указано недопустимое значение api-version. Не удалось разрешить токен, так как он имеет неправильный формат или у него истек срок действия (маркер является действительным только на протяжении 1 часа после создания). |
| 403                  | `Forbidden`          | У вызывающей стороны нет прав на выполнение этой операции.                                 |
| 429                  | `RequestThrottleId`  | Служба занята обработкой запросов. Повторите попытку позже.                                |
| 503                  | `ServiceUnavailable` | Служба временно недоступна. Повторите попытку позже.                                        |
|  |  |  |


*Заголовки ответов*

| **Ключ заголовка**     | **Обязательный** | **Описание**                                                                                        |
|--------------------|--------------|--------------------------------------------------------------------------------------------------------|
| x-ms-requestid     | Yes          | Полученный от клиента идентификатор запроса.                                                                   |
| x-ms-correlationid | Yes          | Идентификатор корреляции, если клиент предоставил его. В противном случае — идентификатор корреляции сервера.                   |
| x-ms-activityid    | Yes          | Уникальное строковое значение для отслеживания запроса от службы. Этот идентификатор используется для любого выверки. |
| Retry-After        | Нет            | Это значение устанавливается только для ответов с кодом 429.                                                                   |
|  |  |  |


### <a name="subscribe"></a>Подписаться

Конечная точка подписки позволяет пользователям создать подписку на службу SaaS с определенным планом и настроить в коммерческой системе выставление счетов.

**PUT**

**https://marketplaceapi.microsoft.com/api/saas/subscriptions/*{идентификатор_подписки}*?api-version=2017-04-15**

| **Имя параметра**  | **Описание**                                       |
|---------------------|-------------------------------------------------------|
| subscriptionId      | Уникальный идентификатор SaaS подписка, которая получается после устранения маркер с помощью API устранения.                              |
| api-version         | Версия операции, используемой для этого запроса. |
|  |  |

*Заголовки*

|  **Ключ заголовка**        | **Обязательный** |  **Описание**                                                  |
| ------------------     | ------------ | --------------------------------------------------------------------------------------- |
| x-ms-requestid         |   Нет          | Уникальное строковое значение для отслеживания запроса клиента, желательно GUID. Если не указано, создается случайным образом и возвращается в заголовке ответа. |
| x-ms-correlationid     |   Нет          | Уникальное строковое значение для операции на стороне клиента. Это значение позволяет сопоставить все события клиентской операции с событиями на стороне сервера. Если не указано, создается случайным образом и возвращается в заголовке ответа. |
| If-Match или If-None-Match |   Нет          |   Значение ETag сильного проверяющего серверного элемента управления.                                                          |
| content-type           |   Yes        |    `application/json`                                                                   |
|  authorization         |   Yes        |    Токен носителя JSON Web Token (JWT).                                               |
| x-ms-marketplace-session-mode| Нет  | Флаг, позволяющий включить режим пробного запуска при подписке на предложение SaaS. Если установлен, плата за подписку не начисляется. Независимые поставщики программного обеспечения могут использовать этот флаг для тестирования. Установите значение **dryrun**.|
|  |  |  |

*Текст*

``` json
{
    "lanId": "",
}
```

| **Имя элемента** | **Тип данных** | **Описание**                      |
|------------------|---------------|--------------------------------------|
| planId           | Строковое значение (обязательное)        | Идентификатор плана, на который подписывается пользователь службы SaaS.  |
|  |  |  |

*Коды отклика*

| **Код состояния HTTP** | **Код ошибки**     | **Описание**                                                           |
|----------------------|--------------------|---------------------------------------------------------------------------|
| 202                  | `Accepted`           | Активация подписки SaaS подтверждается для указанного плана.                   |
| 400                  | `BadRequest`         | Отсутствуют обязательные заголовки, или текст JSON имеет неправильный формат. |
| 403                  | `Forbidden`          | У вызывающей стороны нет прав на выполнение этой операции.                   |
| 404                  | `NotFound`           | Подписка с указанным идентификатором не найдена.                                  |
| 409                  | `Conflict`           | Выполняется другая операция для этой подписки.                     |
| 429                  | `RequestThrottleId`  | Служба занята обработкой запросов. Повторите попытку позже.                  |
| 503                  | `ServiceUnavailable` | Служба временно недоступна. Повторите попытку позже.                          |
|  |  |  |

При получении кода отклика 202 отследите состояние операции по заголовку "Operation-location". Аутентификация выполняется так же, как для других API Marketplace.

*Заголовки ответов*

| **Ключ заголовка**     | **Обязательный** | **Описание**                                                                                        |
|--------------------|--------------|--------------------------------------------------------------------------------------------------------|
| x-ms-requestid     | Yes          | Полученный от клиента идентификатор запроса.                                                                   |
| x-ms-correlationid | Yes          | Идентификатор корреляции, если клиент предоставил его. В противном случае — идентификатор корреляции сервера.                   |
| x-ms-activityid    | Yes          | Уникальное строковое значение для отслеживания запроса от службы. Это значение используется для сверок любого рода. |
| Retry-After        | Yes          | Интервал, в течение которого клиент может проверить состояние.                                                       |
| Operation-Location | Yes          | Ссылка на ресурс для получения состояния операции.                                                        |
|  |  |  |

### <a name="change-plan-endpoint"></a>Конечная точка изменения плана

Конечная точка изменения плана позволяет пользователю преобразовать план, на который он подписан, в новый план.

**PATCH**

**https://marketplaceapi.microsoft.com/api/saas/subscriptions/*{идентификатор_подписки}*?api-version=2017-04-15**

| **Имя параметра**  | **Описание**                                       |
|---------------------|-------------------------------------------------------|
| subscriptionId      | Идентификатор подписки на SaaS                              |
| api-version         | Версия операции, используемой для этого запроса. |
|  |  |

*Заголовки*

| **Ключ заголовка**          | **Обязательный** | **Описание**                                                                                                                                                                                                                  |
|-------------------------|--------------|---------------------------------------------------------------------------------------------------------------------|
| x-ms-requestid          | Нет            | Уникальное строковое значение для отслеживания запроса от клиента. Мы рекомендуем использовать GUID. Если не указано, создается случайным образом и возвращается в заголовке ответа.   |
| x-ms-correlationid      | Нет            | Уникальное строковое значение для операции на стороне клиента. Это значение позволяет сопоставить все события клиентской операции с событиями на стороне сервера. Если не указано, создается случайным образом и возвращается в заголовке ответа. |
| If-Match или If-None-Match | Нет            | Значение ETag сильного проверяющего серверного элемента управления.                              |
| content-type            | Yes          | `application/json`                                        |
| authorization           | Yes          | Токен носителя JSON Web Token (JWT).                    |
|  |  |  |

*Текст*

```json
{
    "planId": ""
}
```

|  **Имя элемента** |  **Тип данных**  | **Описание**                              |
|  ---------------- | -------------   | --------------------------------------       |
|  planId           |  Строковое значение (обязательное)         | Идентификатор плана, на который подписывается пользователь службы SaaS.          |
|  |  |  |

*Коды отклика*

| **Код состояния HTTP** | **Код ошибки**     | **Описание**                                                           |
|----------------------|--------------------|---------------------------------------------------------------------------|
| 202                  | `Accepted`           | Активация подписки SaaS подтверждается для указанного плана.                   |
| 400                  | `BadRequest`         | Отсутствуют обязательные заголовки, или текст JSON имеет неправильный формат. |
| 403                  | `Forbidden`          | У вызывающей стороны нет прав на выполнение этой операции.                   |
| 404                  | `NotFound`           | Подписка с указанным идентификатором не найдена.                                  |
| 409                  | `Conflict`           | Выполняется другая операция для этой подписки.                     |
| 429                  | `RequestThrottleId`  | Служба занята обработкой запросов. Повторите попытку позже.                  |
| 503                  | `ServiceUnavailable` | Служба временно недоступна. Повторите попытку позже.                          |
|  |  |  |

*Заголовки ответов*

| **Ключ заголовка**     | **Обязательный** | **Описание**                                                                                        |
|--------------------|--------------|--------------------------------------------------------------------------------------------------------|
| x-ms-requestid     | Yes          | Полученный от клиента идентификатор запроса.                                                                   |
| x-ms-correlationid | Yes          | Идентификатор корреляции, если клиент предоставил его. В противном случае — идентификатор корреляции сервера.                   |
| x-ms-activityid    | Yes          | Уникальное строковое значение для отслеживания запроса от службы. Это значение используется для сверок любого рода. |
| Retry-After        | Yes          | Интервал, в течение которого клиент может проверить состояние.                                                       |
| Operation-Location | Yes          | Ссылка на ресурс для получения состояния операции.                                                        |
|  |  |  |

### <a name="delete-subscription"></a>Удаление подписки

Действие удаления на конечной точке подписки позволяет пользователю удалить подписку с определенным идентификатором.

*Запрос*

**DELETE**

**https://marketplaceapi.microsoft.com/api/saas/subscriptions/*{идентификатор_подписки}*?api-version=2017-04-15**

| **Имя параметра**  | **Описание**                                       |
|---------------------|-------------------------------------------------------|
| subscriptionId      | Идентификатор подписки на SaaS                              |
| api-version         | Версия операции, используемой для этого запроса. |
|  |  |

*Заголовки*

| **Ключ заголовка**     | **Обязательный** | **Описание**                                                                                                                                                                                                                  |
|--------------------|--------------| ----------------------------------------------------------|
| x-ms-requestid     | Нет            | Уникальное строковое значение для отслеживания запроса от клиента. Мы рекомендуем использовать GUID. Если это значение не указано, оно создается случайным образом и возвращается в заголовке ответа.                                                           |
| x-ms-correlationid | Нет            | Уникальное строковое значение для операции на стороне клиента. Это значение позволяет сопоставить все события клиентской операции с событиями на стороне сервера. Если не указано, создается случайным образом и возвращается в заголовке ответа. |
| authorization      | Yes          | Токен носителя JSON Web Token (JWT).                    |
|  |  |  |

*Коды отклика*

| **Код состояния HTTP** | **Код ошибки**     | **Описание**                                                           |
|----------------------|--------------------|---------------------------------------------------------------------------|
| 202                  | `Accepted`           | Активация подписки SaaS подтверждается для указанного плана.                   |
| 400                  | `BadRequest`         | Отсутствуют обязательные заголовки, или текст JSON имеет неправильный формат. |
| 403                  | `Forbidden`          | У вызывающей стороны нет прав на выполнение этой операции.                   |
| 404                  | `NotFound`           | Подписка с указанным идентификатором не найдена.                                  |
| 429                  | `RequestThrottleId`  | Служба занята обработкой запросов, повторите попытку позже.                  |
| 503                  | `ServiceUnavailable` | Служба временно недоступна. Повторите попытку позже.                          |
|  |  |  |

При получении кода отклика 202 отследите состояние операции по заголовку "Operation-location". Аутентификация выполняется так же, как для других API Marketplace.

*Заголовки ответов*

| **Ключ заголовка**     | **Обязательный** | **Описание**                                                                                        |
|--------------------|--------------|--------------------------------------------------------------------------------------------------------|
| x-ms-requestid     | Yes          | Полученный от клиента идентификатор запроса.                                                                   |
| x-ms-correlationid | Yes          | Идентификатор корреляции, если он предоставлен клиентом, в противном случае идентификатор корреляции сервера                   |
| x-ms-activityid    | Yes          | Уникальное строковое значение для отслеживания запроса от службы. Используется для сверок любого рода. |
| Retry-After        | Yes          | Интервал, в течение которого клиент может проверить состояние.                                                       |
| Operation-Location | Yes          | Ссылка на ресурс для получения состояния операции.                                                        |
|   |  |  |

### <a name="get-operation-status"></a>Получение состояния операции

Эта конечная точка позволяет отслеживать состояние запущенной асинхронной операции (подписка, отмена подписки, изменение плана).

*Запрос*

**GET**

**https://marketplaceapi.microsoft.com/api/saas/operations/*{идентификатор_операции}*?api-version=2017-04-15**

| **Имя параметра**  | **Описание**                                       |
|---------------------|-------------------------------------------------------|
| operationId         | Уникальный идентификатор запущенной операции.                |
| api-version         | Версия операции, используемой для этого запроса. |
|  |  |

*Заголовки*

| **Ключ заголовка**     | **Обязательный** | **Описание**                                                                                                                                                                                                                  |
|--------------------|--------------|--------------------------------------------------------------------------------------------------------------------------|
| x-ms-requestid     | Нет            | Уникальное строковое значение для отслеживания запроса от клиента. Мы рекомендуем использовать GUID. Если это значение не указано, оно создается случайным образом и возвращается в заголовке ответа.   |
| x-ms-correlationid | Нет            | Уникальное строковое значение для операции на стороне клиента. Это значение позволяет сопоставить все события клиентской операции с событиями на стороне сервера. Если это значение не указано, оно создается случайным образом и возвращается в заголовке ответа.  |
| authorization      | Yes          | Токен носителя JSON Web Token (JWT).                    |
|  |  |  | 

*Текст ответа*

```json
{
    "id": "",
    "status": "",
    "resourceLocation": "",
    "created": "",
    "lastModified": ""
}
```

| **Имя параметра** | **Тип данных** | **Описание**                                                                                                                                               |
|--------------------|---------------|-------------------------------------------------------------------------------------------|
| id                 | Строка        | Идентификатор операции.                                                                      |
| status             | Перечисление.          | Состояние операции: `In Progress`, `Succeeded` или `Failed`.          |
| resourceLocation   | Строка        | Ссылка на созданную или измененную подписку. Она позволяет клиенту получить обновленное состояние после операции. Это значение не задается для операций `Unsubscribe`. |
| created            | DateTime      | Время создания операции в формате UTC.                                                           |
| lastModified       | DateTime      | Последнее обновление операции в формате UTC.                                                      |
|  |  |  |

*Коды отклика*

| **Код состояния HTTP** | **Код ошибки**     | **Описание**                                                              |
|----------------------|--------------------|------------------------------------------------------------------------------|
| 200                  | `OK`                 | Запрос GET разрешен успешно, текст ответа содержит требуемую информацию.    |
| 400                  | `BadRequest`         | Отсутствуют необходимые заголовки, или указано недопустимое значение api-version. |
| 403                  | `Forbidden`          | У вызывающей стороны нет прав на выполнение этой операции.                      |
| 404                  | `NotFound`           | Подписка с указанным идентификатором не найдена.                                     |
| 429                  | `RequestThrottleId`  | Служба занята обработкой запросов. Повторите попытку позже.                     |
| 503                  | `ServiceUnavailable` | Служба временно недоступна. Повторите попытку позже.                             |
|  |  |  |

*Заголовки ответов*

| **Ключ заголовка**     | **Обязательный** | **Описание**                                                                                        |
|--------------------|--------------|--------------------------------------------------------------------------------------------------------|
| x-ms-requestid     | Yes          | Полученный от клиента идентификатор запроса.                                                                   |
| x-ms-correlationid | Yes          | Идентификатор корреляции, если он предоставлен клиентом, в противном случае идентификатор корреляции сервера                   |
| x-ms-activityid    | Yes          | Уникальное строковое значение для отслеживания запроса от службы. Используется для сверок любого рода. |
| Retry-After        | Yes          | Интервал, в течение которого клиент может проверить состояние.                                                       |
|  |  |  |

### <a name="get-subscription"></a>Получение подписки

Действие получения на конечной точке подписки позволяет пользователю получить подписку по определенному идентификатору ресурса.

*Запрос*

**GET**

**https://marketplaceapi.microsoft.com/api/saas/subscriptions/*{идентификатор_подписки}*?api-version=2017-04-15**

| **Имя параметра**  | **Описание**                                       |
|---------------------|-------------------------------------------------------|
| subscriptionId      | Идентификатор подписки на SaaS                              |
| api-version         | Версия операции, используемой для этого запроса. |
|  |  |

*Заголовки*

| **Ключ заголовка**     | **Обязательный** | **Описание**                                                                                           |
|--------------------|--------------|-----------------------------------------------------------------------------------------------------------|
| x-ms-requestid     | Нет            | Уникальное строковое значение для отслеживания запроса клиента, желательно GUID. Если это значение не указано, оно создается случайным образом и возвращается в заголовке ответа.                                                           |
| x-ms-correlationid | Нет            | Уникальное строковое значение для операции на стороне клиента. Это значение позволяет сопоставить все события клиентской операции с событиями на стороне сервера. Если это значение не указано, оно создается случайным образом и возвращается в заголовке ответа. |
| authorization      | Yes          | Токен носителя JSON Web Token (JWT).                                                                    |
|  |  |  |

*Текст ответа*

```json
{
    "id": "",
    "saasSubscriptionName": "",
    "offerId": "",
    "planId": "",
    "saasSubscriptionStatus": "",
    "created": "",
    "lastModified": ""
}
```

| **Имя параметра**     | **Тип данных** | **Описание**                               |
|------------------------|---------------|-----------------------------------------------|
| id                     | Строка        | Идентификатор ресурса подписки на SaaS в Azure.    |
| offerId                | Строка        | Идентификатор предложения, на которое подписан пользователь.         |
| planId                 | Строка        | Идентификатор плана, на который подписан пользователь.          |
| saasSubscriptionName   | Строка        | Имя подписки на SaaS.                |
| saasSubscriptionStatus | Перечисление.          | Состояние операции.  Один из следующих типов:  <br/> - `Subscribed`: подписка активна;  <br/> - `Pending`: пользователь создал ресурс, но независимый поставщик программного обеспечения еще не активировал его;   <br/> - `Unsubscribed`: пользователь отменил подписку;   <br/> - `Suspended`: пользователь приостановил подписку;   <br/> - `Deactivated`:  подписка Azure отключена.  |
| created                | DateTime      | Значение времени создания подписки в формате UTC. |
| lastModified           | DateTime      | Значение времени изменения подписки в формате UTC. |
|  |  |  |

*Коды отклика*

| **Код состояния HTTP** | **Код ошибки**     | **Описание**                                                              |
|----------------------|--------------------|------------------------------------------------------------------------------|
| 200                  | `OK`                 | Запрос GET разрешен успешно, текст ответа содержит требуемую информацию.    |
| 400                  | `BadRequest`         | Отсутствуют необходимые заголовки, или указано недопустимое значение api-version. |
| 403                  | `Forbidden`          | У вызывающей стороны нет прав на выполнение этой операции.                      |
| 404                  | `NotFound`           | Подписка с указанным идентификатором не найдена.                                     |
| 429                  | `RequestThrottleId`  | Служба занята обработкой запросов. Повторите попытку позже.                     |
| 503                  | `ServiceUnavailable` | Служба временно недоступна. Повторите попытку позже.                             |
|  |  |  |

*Заголовки ответов*

| **Ключ заголовка**     | **Обязательный** | **Описание**                                                                                        |
|--------------------|--------------|--------------------------------------------------------------------------------------------------------|
| x-ms-requestid     | Yes          | Полученный от клиента идентификатор запроса.                                                                   |
| x-ms-correlationid | Yes          | Идентификатор корреляции, если он предоставлен клиентом, в противном случае идентификатор корреляции сервера                   |
| x-ms-activityid    | Yes          | Уникальное строковое значение для отслеживания запроса от службы. Используется для сверок любого рода. |
| Retry-After        | Нет            | Интервал, в течение которого клиент может проверить состояние.                                                       |
| eTag               | Yes          | Ссылка на ресурс для получения состояния операции.                                                        |
|  |  |  |

### <a name="get-subscriptions"></a>Получение подписок

Действие получения на конечной точке подписки позволяет пользователю получить список подписок для всех предложений этого поставщика программного обеспечения.

*Запрос*

**GET**

**https://marketplaceapi.microsoft.com/api/saas/subscriptions?api-version=2017-04-15**

| **Имя параметра**  | **Описание**                                       |
|---------------------|-------------------------------------------------------|
| api-version         | Версия операции, используемой для этого запроса. |
|  |  |

*Заголовки*

| **Ключ заголовка**     | **Обязательный** | **Описание**                                           |
|--------------------|--------------|-----------------------------------------------------------|
| x-ms-requestid     | Нет            | Уникальное строковое значение для отслеживания запроса от клиента. Мы рекомендуем использовать GUID. Если это значение не указано, оно создается случайным образом и возвращается в заголовке ответа.             |
| x-ms-correlationid | Нет            | Уникальное строковое значение для операции на стороне клиента. Это значение позволяет сопоставить все события клиентской операции с событиями на стороне сервера. Если это значение не указано, оно создается случайным образом и возвращается в заголовке ответа. |
| authorization      | Yes          | Токен носителя JSON Web Token (JWT).                    |
|  |  |  |

*Текст ответа*

```json
{
    "id": "",
    "saasSubscriptionName": "",
    "offerId": "",
    "planId": "",
    "saasSubscriptionStatus": "",
    "created": "",
    "lastModified": ""
}
```

| **Имя параметра**     | **Тип данных** | **Описание**                               |
|------------------------|---------------|-----------------------------------------------|
| id                     | Строка        | Идентификатор ресурса подписки на SaaS в Azure.    |
| offerId                | Строка        | Идентификатор предложения, на которое подписан пользователь.         |
| planId                 | Строка        | Идентификатор плана, на который подписан пользователь.          |
| saasSubscriptionName   | Строка        | Имя подписки на SaaS.                |
| saasSubscriptionStatus | Перечисление.          | Состояние операции.  Один из следующих типов:  <br/> - `Subscribed`: подписка активна;  <br/> - `Pending`: пользователь создал ресурс, но независимый поставщик программного обеспечения еще не активировал его;   <br/> - `Unsubscribed`: пользователь отменил подписку;   <br/> - `Suspended`: пользователь приостановил подписку;   <br/> - `Deactivated`:  подписка Azure отключена.  |
| created                | DateTime      | Значение времени создания подписки в формате UTC. |
| lastModified           | DateTime      | Значение времени изменения подписки в формате UTC. |
|  |  |  |

*Коды отклика*

| **Код состояния HTTP** | **Код ошибки**     | **Описание**                                                              |
|----------------------|--------------------|------------------------------------------------------------------------------|
| 200                  | `OK`                 | Запрос GET разрешен успешно, текст ответа содержит требуемую информацию.    |
| 400                  | `BadRequest`         | Отсутствуют необходимые заголовки, или указано недопустимое значение api-version. |
| 403                  | `Forbidden`          | У вызывающей стороны нет прав на выполнение этой операции.                      |
| 404                  | `NotFound`           | Подписка с указанным идентификатором не найдена.                                     |
| 429                  | `RequestThrottleId`  | Служба занята обработкой запросов, повторите попытку позже.                     |
| 503                  | `ServiceUnavailable` | Служба временно недоступна. Повторите попытку позже.                             |
|  |  |  |

*Заголовки ответов*

| **Ключ заголовка**     | **Обязательный** | **Описание**                                                                                        |
|--------------------|--------------|--------------------------------------------------------------------------------------------------------|
| x-ms-requestid     | Yes          | Полученный от клиента идентификатор запроса.                                                                   |
| x-ms-correlationid | Yes          | Идентификатор корреляции, если он предоставлен клиентом, в противном случае идентификатор корреляции сервера                   |
| x-ms-activityid    | Yes          | Уникальное строковое значение для отслеживания запроса от службы. Используется для сверок любого рода. |
| Retry-After        | Нет            | Интервал, в течение которого клиент может проверить состояние.                                                       |
|  |  |  |

### <a name="saas-webhook"></a>Веб-перехватчик SaaS

Веб-перехватчик SaaS используется для предварительного уведомления об изменениях в службе SaaS. Ожидается, что этот API POST не прошел проверку подлинности и будет вызываться службой Майкрософт. Ожидается, что служба SaaS вызовет операции API для проверки и авторизации, прежде чем выполнять какие-либо действия над уведомлениями веб-перехватчика. 

*Текст*

``` json
  {
    "id": "be750acb-00aa-4a02-86bc-476cbe66d7fa",
    "activityId": "be750acb-00aa-4a02-86bc-476cbe66d7fa",
    "subscriptionId":"cd9c6a3a-7576-49f2-b27e-1e5136e57f45",
    "action": "Subscribe", // Subscribe/Unsubscribe/ChangePlan
    "operationRequestSource":"Azure",
    "timeStamp":"2018-12-01T00:00:00"
  }
```

| **Имя параметра**     | **Тип данных** | **Описание**                               |
|------------------------|---------------|-----------------------------------------------|
| id  | Строка       | Уникальный идентификатор запущенной операции.                |
| activityId   | Строка        | Уникальное строковое значение для отслеживания запроса от службы. Используется для сверок любого рода.               |
| subscriptionId                     | Строка        | Идентификатор ресурса подписки на SaaS в Azure.    |
| offerId                | Строка        | Идентификатор предложения, на которое подписан пользователь. Предоставляется только с действием "Обновить".        |
| publisherid                | Строка        | Идентификатор издателя предложения SaaS         |
| planId                 | Строка        | Идентификатор плана, на который подписан пользователь. Предоставляется только с действием "Обновить".          |
| action                 | Строка        | Событие, которое запускает это уведомление. Допустимые значения: Activate, Delete, Suspend, Reinstate, Update          |
| timeStamp (метка времени)                 | Строка        | Значение метки времени в формате UTC, когда это уведомление было активировано.          |
|  |  |  |


## <a name="next-steps"></a>Дальнейшие действия

Разработчикам можно получить программным способом и обработку рабочих нагрузок, предложения и издателе профили с помощью [API-интерфейсов REST портал Cloud Partner](https://docs.microsoft.com/azure/marketplace/cloud-partner-portal-orig/cloud-partner-portal-api-overview).
