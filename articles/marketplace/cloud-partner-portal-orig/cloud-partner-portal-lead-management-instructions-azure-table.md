---
title: Хранилище таблиц Azure | Azure Marketplace
description: Настройка управления интересами в хранилище таблиц Azure.
author: dsindona
ms.service: marketplace
ms.subservice: partnercenter-marketplace-publisher
ms.topic: conceptual
ms.date: 05/22/2019
ms.author: dsindona
ms.openlocfilehash: cee28c65b97d4ac163f78b746dc7be9ee210843c
ms.sourcegitcommit: 849bb1729b89d075eed579aa36395bf4d29f3bd9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2020
ms.locfileid: "80280360"
---
# <a name="lead-management-instructions-for-table-storage"></a>Инструкции по управлению интересами для хранилища таблиц

В этой статье описывается, как настроить хранилище таблиц Azure для управления интересами к продажам. Хранилище таблиц помогает хранить и изменять сведения о клиентах.

## <a name="configure-table-storage"></a>Настройка табличного хранилища

1. Если у вас нет учетной записи Azure, [Создайте бесплатную пробную учетную запись](https://azure.microsoft.com/pricing/free-trial/).
1. Когда ваша учетная запись будет активна, войдите в [портал Azure](https://portal.azure.com).
1. В портал Azure выполните следующие действия.  
    1. Выберите **+ создать ресурс** на панели слева. Откроется **Новая** панель.
    1. В области **создать** выберите **хранилище**. В правой части откроется список **популярных** .
    1. Выберите **учетная запись хранения**. Затем следуйте инструкциям в разделе [Создание учетной записи хранения](https://docs.microsoft.com/azure/storage/common/storage-quickstart-create-account?tabs=azure-portal).

    ![Создание учетной записи хранения Azure](./media/cloud-partner-portal-lead-management-instructions-azure-table/azurestoragecreate.png)

    Дополнительные сведения об учетных записях хранения см. в разделе [краткие руководства](https://docs.microsoft.com/azure/storage/). Сведения о ценах см. на странице цен на службу [хранилища Azure](https://azure.microsoft.com/pricing/details/storage/).

1. Подождите, пока ваша учетная запись хранения не будет подготовлена, что обычно займет несколько минут. Затем откройте учетную запись на домашней странице портал Azure: выберите **Просмотреть все ресурсы** или **все ресурсы** в области навигации.

    ![Доступ к учетной записи хранения Azure](./media/cloud-partner-portal-lead-management-instructions-azure-table/azure-storage-access.png)

1. В области учетной записи хранения скопируйте строку подключения учетной записи хранения для ключа. Вставьте его в поле **строка подключения** для учетной записи хранения в портал Cloud Partner.

    Пример строки подключения:

    ```sql
    DefaultEndpointsProtocol=https;AccountName=myAccountName;AccountKey=myAccountKey;EndpointSuffix=core.windows.net
    ```

      ![Ключ к хранилищу Azure](./media/cloud-partner-portal-lead-management-instructions-azure-table/azurestoragekeys.png)

Для просмотра данных в хранилище таблиц можно использовать [Обозреватель службы хранилища Azure](https://azurestorageexplorer.codeplex.com/) или аналогичное средство. Можно также экспортировать данные из него.

## <a name="use-microsoft-flow-with-table-storage-optional"></a>Использование Microsoft Flow с хранилищем таблиц (*необязательно*)

[Microsoft Flow](https://docs.microsoft.com/flow/) можно использовать для автоматической отправки уведомлений при добавлении интереса в хранилище таблиц. Если у вас нет учетной записи Microsoft Flow, зарегистрируйтесь, чтобы [получить бесплатную учетную запись](https://flow.microsoft.com/).

### <a name="lead-notification-example"></a>Пример уведомления о потенциальном клиенте

В этом примере показано, как создать базовый поток. При добавлении новых интересов в хранилище таблиц последовательность автоматически отправляет уведомление по электронной почте.

1. Войдите в учетную запись Microsoft Flow.
1. В области навигации слева выберите **мои потоки**.
1. На верхней панели навигации выберите **+ создать**.  
1. В раскрывающемся списке выберите **+ создать из пустого**списка.
1. В разделе **создать поток из пустого**поля выберите **создать из пустых**.

   ![Создание нового потока с нуля](./media/cloud-partner-portal-lead-management-instructions-azure-table/msflow-create-from-blank.png)

1. На странице поиска соединителей и триггеров выберите **Триггеры**.
1. В разделе **Триггеры**выберите **Повторение**.
1. В окне **повторение** установите значение по умолчанию **1** для параметра **интервал**. В раскрывающемся списке **Частота** выберите **час**.

   >[!NOTE] 
   >В этом примере используется интервал в 1 час. Однако можно выбрать интервал и частоту, которые лучше подходят для бизнес-нужд.

   ![Задайте 1-часовую частоту повторения](./media/cloud-partner-portal-lead-management-instructions-azure-table/msflow-recurrence-dropdown.png)

1. Выберите **+ новый шаг**.
1. Выполните поиск за **прошедшее время**, а затем выберите пункт **получить время** начала в разделе **Выбор действия**.

    ![Поиск и выбор действия "получить предыдущее время"](./media/cloud-partner-portal-lead-management-instructions-azure-table/msflow-search-getpasttime.png)

1. В окне **Получение времени в прошлом** задайте для параметра **интервал** значение **1**.  В раскрывающемся списке **единица времени** выберите значение **час**.
    >[!IMPORTANT] 
    >Убедитесь, что **интервал** и **единица времени** соответствуют интервалу и частоте, настроенным для повторения (шаг 8).

    ![Задание интервала получения данных за прошлый период](./media/cloud-partner-portal-lead-management-instructions-azure-table/msflow-getpast-time.png)

    >[!TIP] 
    >Вы можете в любое время проверить последовательность, чтобы убедиться, что каждый шаг настроен правильно: выберите **средство проверки потоков** в строке меню "поток".

В следующем наборе действий вы подключаетесь к таблице хранилища и настроите логику обработки для обработки новых интересов.

1. После шага **получить в прошлом** выберите **+ новый шаг**и выполните поиск по запросу **получить сущности**.
1. В разделе **Действия** выберите **Получить записи**, а затем выберите **Показать расширенные параметры**.
1. В окне **Получение сущностей** заполните следующие поля:

   - **Table**: имя хранилища таблиц. На следующем рисунке показано, что указан "Маркетплацелеадс":

     ![Выбор пользовательского значения для имени таблицы Azure](./media/cloud-partner-portal-lead-management-instructions-azure-table/msflow-getentities-table-name.png)

   - **Фильтрация запроса**. при выборе этого поля в всплывающем окне отображается значок **получить время** работы. Выберите **время в прошлом** , чтобы использовать это значение в качестве метки времени для фильтрации запроса. Также можно вставить в поле следующую функцию:
   
      `CreatedTime Timestamp gt datetime'@{body('Get_past_time')}'` 

     ![Настройка функции фильтрации запросов](./media/cloud-partner-portal-lead-management-instructions-azure-table/msflow-getentities-filterquery.png)

1. Выберите **новый шаг** , чтобы добавить условие для проверки хранилища таблиц на предмет новых интересов.

   ![Используйте "новый шаг", чтобы добавить условие для проверки хранилища таблиц](./media/cloud-partner-portal-lead-management-instructions-azure-table/msflow-add-filterquery-new-step.png)

1. В окне **Выбор действия** выберите **действия**, а затем выберите **элемент Управление условием**.

     ![Добавление элемента управления условием](./media/cloud-partner-portal-lead-management-instructions-azure-table/msflow-action-condition-control.png)

1. В окне **условие** выберите **выбрать значение**, а затем во всплывающем окне выберите **выражение** .
1. Вставьте `length(body('Get_entities')?['value'])` в поле ***FX*** . Нажмите **ОК** для добавления этой функции. 



     ![Добавление функции в условие](./media/cloud-partner-portal-lead-management-instructions-azure-table/msflow-condition-fx0.png)

1. Задайте действие, которое будет выполняться в зависимости от значения условия.

    1. Выберите **значение больше, чем** в раскрывающемся списке.
   1. Введите **0** в качестве значения.

     ![Настройка действия на основе результатов условий](./media/cloud-partner-portal-lead-management-instructions-azure-table/msflow-condition-pick-action.png)

1. Если условие разрешается в «если нет», ничего делать не нужно.

    Если условие разрешается в значение "Да", активируйте действие, которое подключает учетную запись Office 365 для отправки сообщения электронной почты:
   1. Выберите **Добавить действие**.
   1. Выберите **Отправить электронное письмо**.
   1. В окне **Отправить сообщение электронной почты** введите сведения в следующих полях:

      - **Кому**: адрес электронной почты для всех, кто получит уведомление.
      - **Subject**: Тема сообщения электронной почты. Например: *новые интересы!*
      - **Текст: текст**, который необходимо включить в каждый адрес электронной почты (необязательно). Также вставьте в `body('Get_entities')?['value']` качестве функции, чтобы вставить сведения о интересе.

        >[!NOTE] 
        >В текст сообщения электронной почты можно вставить дополнительные статические или динамические точки данных.

      ![Настройка электронной почты для уведомления о потенциальных клиентах](./media/cloud-partner-portal-lead-management-instructions-azure-table/msflow-emailbody-fx.png)

1. Выберите **Сохранить**, чтобы сохранить поток. Microsoft Flow будет автоматически проверять их на наличие ошибок. Если ошибок нет, поток начнет выполняться после сохранения.

    На следующем рисунке показан пример того, как должен выглядеть окончательный поток.

    [![Итоговая последовательность потока](./media/cloud-partner-portal-lead-management-instructions-azure-table/msflow-end-to-end-thmb.png)](./media/cloud-partner-portal-lead-management-instructions-azure-table/msflow-end-to-end.png)

    (*Выберите изображение, чтобы увеличить его.*)

### <a name="manage-your-flow"></a>Управление ходом выполнения

Вы можете легко управлять потоком после его выполнения. Вы его полностью контролируете. Например, вы можете его остановить или изменить, просмотреть журнал его выполнения и получить аналитику. На следующем рисунке показаны параметры управления потоком.

 ![Параметры управления потоком](./media/cloud-partner-portal-lead-management-instructions-azure-table/msflow-manage-completed.png)

Поток продолжает выполняться, пока не будет выбран параметр **отключить поток**.

Если вы не получаете уведомления по электронной почте, новые интересы не добавлялись в хранилище таблиц.
Если происходит сбой потока, вы получите сообщение электронной почты, как в следующем примере:

 ![Уведомление по электронной почте о сбое потока](./media/cloud-partner-portal-lead-management-instructions-azure-table/msflow-failure-note.png)

## <a name="next-steps"></a>Дальнейшие шаги

[Настройка потенциальных клиентов](https://docs.microsoft.com/azure/marketplace/cloud-partner-portal-orig/cloud-partner-portal-get-customer-leads)
