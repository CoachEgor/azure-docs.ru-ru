---
title: Управление параллелизмом | Документация Майкрософт
description: Стратегии управления параллелизмом для API-интерфейсов публикации на портале Cloud Partner.
services: Azure, Marketplace, Cloud Partner Portal,
documentationcenter: ''
author: v-miclar
manager: Patrick.Butler
editor: ''
ms.assetid: ''
ms.service: marketplace
ms.workload: ''
ms.tgt_pltfrm: ''
ms.devlang: ''
ms.topic: conceptual
ms.date: 09/13/2018
ms.author: pbutlerm
ms.openlocfilehash: ecf0bb6ac7fc77e804c9fc8d62aba52810de5640
ms.sourcegitcommit: 3102f886aa962842303c8753fe8fa5324a52834a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "60625012"
---
<a name="concurrency-control"></a>Управление параллелизмом
===================

При каждом вызове API-интерфейсов публикации на портале Cloud Partner необходимо явно указать, какую стратегию управления параллелизмом использовать. Если заголовок **If-Match** не предоставлен, это приведет к появлению сообщения об ошибке HTTP 400. Мы предлагаем две стратегии для управления параллелизмом.

-   **Оптимистичный**. Клиент, выполняющий обновления, проверяет, не изменились ли данные с момента последнего чтения данных.
-   **Приоритет последнего**. Клиент непосредственно обновляет данные, независимо от изменений, внесенных другим приложением с момента последнего чтения.

<a name="optimistic-concurrency-workflow"></a>Рабочий процесс оптимистичного параллелизма
-------------------------------

Стратегию оптимистичного параллелизма рекомендуется использовать, чтобы гарантировано избежать непредвиденных изменений ресурсов.

1.  Получите сущность с помощью API-интерфейсов. Ответ содержит значение ETag, которое определяет текущую хранимую версию сущности (во время ответа).
2.  Во время обновления добавьте это значение ETag в обязательный заголовок запроса **If-Match**.
3.  API сравнивает значение ETag, полученное в запросе с текущим значением ETag сущности в атомарной транзакции.
    *   Если значения ETag не совпадают, API возвращает ответ HTTP `412 Precondition Failed`. Эта ошибка означает, что другой процесс выполнил обновление сущности с момента его последнего получения клиента или что в запросе указано неверное значение ETag.
    *  Если значения ETag совпадают, или заголовок **If-Match** содержит подстановочный символ звездочки (`*`), API выполняет запрошенную операцию. Операция API также обновляет хранимое значение ETag сущности.


> [!NOTE]
> Если указать подстановочный знак (*) в заголовке **If-Match**, API будет использовать стратегию параллелизма "Приоритет последнего". В этом случае сравнение значений ETag не происходит и ресурс обновляется без каких-либо проверок. 
