---
title: Частные СКУ и планы Лазурный рынок
description: Как использовать частные номера SKU для управления доступностью предложений.
author: dsindona
ms.service: marketplace
ms.subservice: partnercenter-marketplace-publisher
ms.topic: conceptual
ms.date: 08/15/2019
ms.author: dsindona
ms.openlocfilehash: ee3ab7be4d15b13a3c0bb014a3ca4d4096299b4c
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "80280394"
---
<a name="private-skus-and-plans"></a>Частные номера SKU и планы
============

Частные номера SKU являются доступными для конкретных клиентов. Когда номер SKU помечается как частный, он недоступен в любом общедоступном каталога, включая [Azure Marketplace](https://azuremarketplace.microsoft.com) и [портал Azure](https://portal.azure.com). На портале Azure его могут видеть только клиенты, имеющие доступ к нему. Кроме того, им будет предложено подтвердить, что у них есть доступ к частным предложениям.

>[!NOTE]
>У частных номеров SKU должны быть новые уникальные идентификаторы SKU или плана во избежание конфликта с общедоступными SKU.

Частные номера SKU можно использовать для обработки следующих сценариев:

1.  Публикация программного обеспечения, которое должно быть доступно только для определенных клиентов, а не общедоступно.
2.  Публикация вариантов открытого программного обеспечения по цене, определенной для конкретных клиентов.
3.  Публикация вариантов открытого программного обеспечения с настроенным описанием и условиями использования (через новое предложение).

Если вы хотите изменить только цену, можно повторно использовать диски из другого номера SKU в том же предложении. При использовании частных номеров SKU не нужно повторно отправлять диски между разными номерами SKU.

<a name="mark-a-sku-private"></a>Пометка номера SKU как частного
---------------------

Чтобы пометить номера SKU как частные, установите положительное значение для параметра, определяющего, является ли номер SKU частным:

![Пометка номера SKU как частного](./media/cloud-partner-portal-publish-virtual-machine/markingskuprivate.png)

Можно повторно использовать диски в другом номере SKU и изменять цену и описание. Для повторного использования дисков выберите **«Да»** в качестве ответа на запрос «Делает ли это повторное использование изображений SKU из публичного SKU».

Если SKU помечен как частный и в предложении есть другие SKU с многократно используемыми дисками, необходимо указать, что номер SKU повторно использует диски из другого номера SKU. Кроме того, для частного номера SKU необходимо указать целевую аудиторию.

>[!NOTE]
>После публикации общедоступный номер SKU нельзя сделать частным.

<a name="select-an-image"></a>Выбор образа
------------------

Вы можете предоставить новые диски для частного SKU или повторно использовать те же диски, которые уже представлены в другом SKU, изменив только цены или описание. Для повторного использования дисков выберите **«Да»** в качестве ответа на запрос «Является ли это изображение SKU повторному использованию из публичного SKU».

![Укажите повторное использование изображения](./media/cloud-partner-portal-publish-virtual-machine/selectimage1.png)

Подтвердив, что SKU повторно использует изображения, выберите источник или *базу* SKU для изображений:

![Выбор образа](./media/cloud-partner-portal-publish-virtual-machine/selectimage2.png)

Когда вы опубликуете предложение, образы выбранного номера SKU станут доступны под идентификатором частного номера SKU с настроенными ценами и условиями. Частный номер SKU будет видим только для целевой аудитории.

Для обновления образа необходимо обновить только образ базового номера SKU. При этом также автоматически обновляется образ для частного номера SKU. Аналогичным образом при удалении образа из базового номера SKU также будет удален образ частного номера SKU.

<a name="restricting-the-audience"></a>Ограничение аудитории
------------------------

Искать и развертывать частные предложения могут только целевые пользователи.
В настоящее время мы поддерживаем целевых пользователей на основе идентификаторов подписок.

Эти подписки можно указать вручную (**до 10 подписок**) или путем отправки CSV-файла (**до 20 000 подписок**).

Ввод вручную для ограниченной аудитории:

![Ограничение аудитории вручную](./media/cloud-partner-portal-publish-virtual-machine/restrictaudience1.png)

Отправка CSV-файла для ограниченной аудитории:

![Использование CSV-файла для ограничения аудитории](./media/cloud-partner-portal-publish-virtual-machine/restrictaudience2.png)

Пример содержимого CSV-файла:

            Type,Id,Description
            SubscriptionId,7738d703-3135-4e8d-8b81-1e70379abd9d,Private Customer

При переключении представления с ручного ввода на отправку CSV-файла или наоборот старый список идентификаторов подписок с доступом к номерам SKU не сохраняется. Появится предупреждение, а список будет перезаписан только при сохранении предложения.

<a name="managing-private-audiences"></a>Управление частной аудиторией
-------------------------

**Для обновления аудитории без повторного опубликования всего предложения вы вносят необходимые изменения в аудиторию (используя либо uI или API), а затем инициируете действие "Sync Private Audiences".**

Если ваша аудитория составляет 10 или меньше подписок, вы можете управлять ею полностью с помощью uI CPP.

Если ваша аудитория превышает 10 подписок, вы можете управлять ею с помощью файла CSV, который можно загрузить в UI CPP или с помощью API.

Если вы используете API и не хотите поддерживать файл CSV, вы можете управлять аудиторией непосредственно с помощью API в инструкциях ниже.

> [!NOTE]
> Используйте идентификатор подписки Azure (Планы и SKUs) или Идентификатор арендатора (только планы), чтобы добавить аудиторию к вашему частному предложению.

###  <a name="managing-subscriptions-with-the-api"></a>Управление подписками с Помощью API

Вы можете использовать API для загрузки CSV или управлять аудиторией напрямую (без использования CSV). Как правило, вам просто нужно получить ваше `restrictedAudience` предложение, обновить объект, а затем представить эти изменения обратно в ваше предложение для того, чтобы добавить или удалить членов аудитории.

Вот как программно обновить список аудитории:

1. [Извлекайте](cloud-partner-portal-api-retrieve-specific-offer.md) данные о предложении:

    ```
    GET https://cloudpartner.azure.com/api/publishers//offers/?api-version=2017-10-31&includeAllPricing=true
    ```

2. Найти объекты ограниченной аудитории в каждом SKU предложения с помощью этого запроса JPath:

    ```
    $.definition.plans[*].restrictedAudience
    ```
3. Обновление объекта ограниченной аудитории (ы) для вашего предложения.

    **Если вы изначально загрузили список подписок для вашего частного предложения из файла CSV:**

    Ваш объект *ограниченной аудитории* (ы) будет выглядеть следующим образом.
    ```
    "restrictedAudience": {
                  "uploadedCsvUri": "{SasUrl}"
    }
    ```

    Для каждого объекта ограниченной аудитории:

    а. Скачать содержимое `restrictedAudience.uploadedCsvUri`. Содержимое — это просто файл CSV с заголовками. Пример:

        type,id,description
        subscriptionId,541a269f-3df2-486e-8fe3-c8f9dcf28205,sub1
        subscriptionId,c0da499c-25ec-4e4b-a42a-6e75635253b9,sub2

    b. Добавить или удалять подписки в загруженном файле CSV по мере необходимости.

    c. Загрузите обновленный файл CSV в место, например [хранилище Azure Blob](../../storage/blobs/storage-blobs-overview.md) или [OneDrive,](https://onedrive.live.com)и создайте ссылку только на чтение к файлу. Это будет ваш новый *SasUrl*.

    d. Обновление `restrictedAudience.uploadedCsvUri` ключа с новым *SasUrl*.

    **Если вы вручную ввели исходный список подписок на ваше личное предложение с портала Cloud Partner:**

    Ваш объект *ограниченной аудитории* (ы) будет выглядеть примерно так:

    ```
    "restrictedAudience": {
        "manualEntries": [{
            "type": "subscriptionId",
            "id": "541a269f-3df2-486e-8fe3-c8f9dcf28205",
            "description": "sub1"
            }, {
            "type": "subscriptionId",
            "id": "c0da499c-25ec-4e4b-a42a-6e75635253b9",
            "description": "sub2"
            }
        ]}
    ```

    а. Для каждого объекта ограниченной аудитории, `restrictedAudience.manualEntries` добавить или удалить записи в списке по мере необходимости.

4. После завершения обновления всех объектов *ограниченной аудитории* для каждого SKU вашего личного предложения, [обновите предложение:](cloud-partner-portal-api-creating-offer.md)

    ```
    PUT https://cloudpartner.azure.com/api/publishers/<publisherId>/offers/<offerId>?api-version=2017-10-31
    ```
    С этим, ваш обновленный список аудитории в настоящее время в силе.

<a name="previewing-private-offers"></a>Предварительный просмотр частных предложений
-------------------------

В режиме предварительного просмотра или в промежуточной среде доступ к номеру SKU имеют только подписки с правами предварительного просмотра на уровне предложения. На этом этапе тестирования вы можете просмотреть предложение, как это будет выглядеть для ваших целевых клиентов.

Подписки с правами предварительного просмотра на уровне предложения для получения доступа к промежуточным предложениям:

![Preview Subscription Ids (Идентификаторы подписок для предварительного просмотра)](./media/cloud-partner-portal-publish-virtual-machine/previewoffer1.png)

Как только предложение станет активным, только ограниченное число пользователей подписок (указанных вручную или через CSV-файл) смогут просматривать и развертывать частный номер SKU. В целях проверки для частного номера SKU рекомендуется **всегда указывать собственные подписки в список ограниченной аудитории**.

>[!NOTE]
>В целях отладки служба поддержки Майкрософт и команды разработчиков также будут иметь доступ к этим частным предложениям.
