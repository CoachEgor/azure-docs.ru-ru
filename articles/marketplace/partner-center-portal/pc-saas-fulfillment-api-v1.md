---
title: API-интерфейсы выполнения SaaS v1 | Azure Marketplace
description: В этой статье объясняется, как создать предложение SaaS и управлять им в Azure Marketplace с помощью связанных API-интерфейсов выполнения версии 1.
services: Azure, Marketplace, Cloud Partner Portal,
author: v-miclar
ms.service: marketplace
ms.subservice: partnercenter-marketplace-publisher
ms.topic: reference
ms.date: 05/23/2019
ms.author: evansma
ROBOTS: NOINDEX
ms.openlocfilehash: f56e9b4f6c3db6fb47452c7478f5a27445955e87
ms.sourcegitcommit: f52ce6052c795035763dbba6de0b50ec17d7cd1d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/24/2020
ms.locfileid: "76715387"
---
# <a name="saas-fulfillment-apis-version-1-deprecated"></a>API выполнения SaaS версии 1 (не рекомендуется)

В этой статье объясняется, как создать предложение SaaS через API-интерфейсы. API-интерфейсы, состоящие из методов и конечных точек, необходимы для предоставления подписок на предложение SaaS, если вы продаете выборку данных Azure.  

> [!WARNING]
> Эта начальная версия API выполнения SaaS устарела; Вместо этого используйте [API выполнения SaaS версии 2](./pc-saas-fulfillment-api-v2.md).  Эта первоначальная версия API в настоящее время поддерживается только для обслуживания существующих издателей. 

Чтобы помочь вам интегрировать службу SaaS с Azure, мы предоставляем следующие API:

-   Разрешить
-   Подписаться
-   Convert
-   Unsubscribe (отмена подписки).


## <a name="api-methods-and-endpoints"></a>Методы API и конечные точки

В следующих разделах описаны методы и конечные точки API, которые позволяют настраивать подписки для работы с предложением SaaS.


### <a name="marketplace-api-endpoint-and-api-version"></a>Конечная точка API Marketplace и версия API

Конечная точка для API Azure Marketplace имеет адрес `https://marketplaceapi.microsoft.com`.

Текущая версия API — `api-version=2017-04-15`.


### <a name="resolve-subscription"></a>Разрешение подписки

Действие POST для конечной точки разрешения позволяет пользователям разрешать токен marketplace постоянному идентификатору ресурса.  Идентификатор ресурса — это уникальный идентификатор для подписки SAAS. 

Когда пользователь перенаправляется на веб-сайт ISV, URL-адрес содержит маркер в параметрах запроса. Ожидается, что ISV будет использовать этот токен и отправит запрос на его разрешение. Ответ содержит уникальный идентификатор подписки SAAS, имя, идентификатор предложения и план для ресурса. Этот токен действителен только в течение часа.

*Запрос*

**POST**

**https://marketplaceapi.microsoft.com/api/saas/subscriptions/resolve?api-version=2017-04-15**

|  **Имя параметра** |     **Описание**                                      |
|  ------------------ |     ---------------------------------------------------- |
|  api-version        |  Версия операции, используемой для этого запроса.   |
|  |  |


*Заголовки*

| **Ключ заголовка**     | **Обязательно** | **Описание**                                                                                                                                                                                                                  |
|--------------------|--------------|-----------------------------------------------------------|
| x-ms-requestid     | нет           | Уникальное строковое значение для отслеживания запроса клиента, желательно GUID. Если это значение не указано, оно создается случайным образом и возвращается в заголовке ответа.  |
| x-ms-correlationid | нет           | Уникальное строковое значение для операции на стороне клиента. Это поле сопоставляет все события от клиентской операции с событиями на стороне сервера. Если это значение не указано, оно создается случайным образом и возвращается в заголовке ответа. |
| Content-type       | Да          | `application/json`                                        |
| авторизация      | Да          | Токен носителя JSON Web Token (JWT).                    |
| x-ms-marketplace-token| Да| Параметр запроса маркера в URL-адресе, когда пользователь перенаправляется на веб-сайт независимого поставщика программного обеспечения SaaS из Azure. **Примечание.** Этот токен действителен только в течение 1 часа. Кроме того, URL-адрес декодирует полученное из браузера значение токена, прежде чем использовать его.|
|  |  |  |
  

*Текст ответа*

``` json
{
    "id": "",
    "subscriptionName": "",
    "offerId": "",
    "planId": "",
}
```

| **Имя параметра** | **Data type** | **Описание**                       |
|--------------------|---------------|---------------------------------------|
| идентификатор                 | String        | Идентификатор подписки SaaS          |
| subscriptionName| String| Имя подписки SaaS, которое пользователь указал в Azure при подписке на службу SaaS.|
| OfferId            | String        | Идентификатор предложения, на которое подписан пользователь. |
| planId             | String        | Идентификатор плана, на который подписан пользователь.  |
|  |  |  |


*Коды отклика*

| **Код состояния HTTP** | **Код ошибки**     | **Описание**                                                                         |
|----------------------|--------------------| --------------------------------------------------------------------------------------- |
| 200                  | `OK`                 | Токен успешно разрешен.                                                            |
| 400                  | `BadRequest`         | Отсутствуют необходимые заголовки, или указано недопустимое значение api-version. Не удалось разрешить токен, так как он имеет неправильный формат или у него истек срок действия (маркер является действительным только на протяжении 1 часа после создания). |
| 403                  | `Forbidden`          | У вызывающей стороны нет прав на выполнение этой операции.                                 |
| 429                  | `RequestThrottleId`  | Служба занята обработкой запросов. Повторите попытку позже.                                |
| 503                  | `ServiceUnavailable` | Служба временно недоступна. Повторите попытку позже.                                        |
|  |  |  |


*Заголовки ответов*

| **Ключ заголовка**     | **Обязательно** | **Описание**                                                                                        |
|--------------------|--------------|--------------------------------------------------------------------------------------------------------|
| x-ms-requestid     | Да          | Полученный от клиента идентификатор запроса.                                                                   |
| x-ms-correlationid | Да          | Идентификатор корреляции, если клиент предоставил его. В противном случае — идентификатор корреляции сервера.                   |
| x-ms-activityid    | Да          | Уникальное строковое значение для отслеживания запроса от службы. Этот идентификатор используется для любых выверки. |
| Retry-After        | нет           | Это значение устанавливается только для ответов с кодом 429.                                                                   |
|  |  |  |


### <a name="subscribe"></a>Подписаться

Конечная точка подписки позволяет пользователям создать подписку на службу SaaS с определенным планом и настроить в коммерческой системе выставление счетов.

**PUT**

**https://marketplaceapi.microsoft.com/api/saas/subscriptions/ *{идентификатор_подписки}* ?api-version=2017-04-15**

| **Имя параметра**  | **Описание**                                       |
|---------------------|-------------------------------------------------------|
| subscriptionId      | Уникальный идентификатор подписки SaaS, полученной после разрешения маркера через API-интерфейс разрешения.                              |
| api-version         | Версия операции, используемой для этого запроса. |
|  |  |

*Заголовки*

|  **Ключ заголовка**        | **Обязательно** |  **Описание**                                                  |
| ------------------     | ------------ | --------------------------------------------------------------------------------------- |
| x-ms-requestid         |   нет         | Уникальное строковое значение для отслеживания запроса клиента, желательно GUID. Если не указано, создается случайным образом и возвращается в заголовке ответа. |
| x-ms-correlationid     |   нет         | Уникальное строковое значение для операции на стороне клиента. Это значение позволяет сопоставить все события клиентской операции с событиями на стороне сервера. Если не указано, создается случайным образом и возвращается в заголовке ответа. |
| If-Match или If-None-Match |   нет         |   Значение ETag сильного проверяющего серверного элемента управления.                                                          |
| content-type           |   Да        |    `application/json`                                                                   |
|  авторизация         |   Да        |    Токен носителя JSON Web Token (JWT).                                               |
| x-ms-marketplace-session-mode| нет | Флаг, позволяющий включить режим пробного запуска при подписке на предложение SaaS. Если установлен, плата за подписку не начисляется. Независимые поставщики программного обеспечения могут использовать этот флаг для тестирования. Задайте для него значение **"дрирун"** .|
|  |  |  |

*Текст*

``` json
{
    "lanId": "",
}
```

| **Имя элемента** | **Data type** | **Описание**                      |
|------------------|---------------|--------------------------------------|
| planId           | Строковое значение (обязательное)        | ИДЕНТИФИКАТОР плана пользователя службы SaaS, на который подписывается подписка.  |
|  |  |  |

*Коды отклика*

| **Код состояния HTTP** | **Код ошибки**     | **Описание**                                                           |
|----------------------|--------------------|---------------------------------------------------------------------------|
| 202                  | `Accepted`           | Активация подписки SaaS подтверждается для указанного плана.                   |
| 400                  | `BadRequest`         | Отсутствуют обязательные заголовки, или текст JSON имеет неправильный формат. |
| 403                  | `Forbidden`          | У вызывающей стороны нет прав на выполнение этой операции.                   |
| 404                  | `NotFound`           | Подписка с указанным идентификатором не найдена.                                  |
| 409                  | `Conflict`           | Выполняется другая операция для этой подписки.                     |
| 429                  | `RequestThrottleId`  | Служба занята обработкой запросов. Повторите попытку позже.                  |
| 503                  | `ServiceUnavailable` | Служба временно недоступна. Повторите попытку позже.                          |
|  |  |  |

Ответ 202 см. в подстроке состояния операции запроса в заголовке "Operation-Location". Аутентификация выполняется так же, как для других API Marketplace.

*Заголовки ответов*

| **Ключ заголовка**     | **Обязательно** | **Описание**                                                                                        |
|--------------------|--------------|--------------------------------------------------------------------------------------------------------|
| x-ms-requestid     | Да          | Полученный от клиента идентификатор запроса.                                                                   |
| x-ms-correlationid | Да          | Идентификатор корреляции, если клиент предоставил его. В противном случае — идентификатор корреляции сервера.                   |
| x-ms-activityid    | Да          | Уникальное строковое значение для отслеживания запроса от службы. Это значение используется для сверок любого рода. |
| Retry-After        | Да          | Интервал, в течение которого клиент может проверить состояние.                                                       |
| Operation-Location | Да          | Ссылка на ресурс для получения состояния операции.                                                        |
|  |  |  |

### <a name="change-plan-endpoint"></a>Конечная точка изменения плана

Конечная точка изменения плана позволяет пользователю преобразовать план, на который он подписан, в новый план.

**PATCH**

**https://marketplaceapi.microsoft.com/api/saas/subscriptions/ *{идентификатор_подписки}* ?api-version=2017-04-15**

| **Имя параметра**  | **Описание**                                       |
|---------------------|-------------------------------------------------------|
| subscriptionId      | Идентификатор подписки на SaaS                              |
| api-version         | Версия операции, используемой для этого запроса. |
|  |  |

*Заголовки*

| **Ключ заголовка**          | **Обязательно** | **Описание**                                                                                                                                                                                                                  |
|-------------------------|--------------|---------------------------------------------------------------------------------------------------------------------|
| x-ms-requestid          | нет           | Уникальное строковое значение для отслеживания запроса от клиента. Мы рекомендуем использовать GUID. Если не указано, создается случайным образом и возвращается в заголовке ответа.   |
| x-ms-correlationid      | нет           | Уникальное строковое значение для операции на стороне клиента. Это значение позволяет сопоставить все события клиентской операции с событиями на стороне сервера. Если не указано, создается случайным образом и возвращается в заголовке ответа. |
| If-Match или If-None-Match | нет           | Значение ETag сильного проверяющего серверного элемента управления.                              |
| content-type            | Да          | `application/json`                                        |
| авторизация           | Да          | Токен носителя JSON Web Token (JWT).                    |
|  |  |  |

*Текст*

```json
{
    "planId": ""
}
```

|  **Имя элемента** |  **Data type**  | **Описание**                              |
|  ---------------- | -------------   | --------------------------------------       |
|  planId           |  Строковое значение (обязательное)         | ИДЕНТИФИКАТОР плана пользователя службы SaaS, на который подписывается подписка.          |
|  |  |  |

*Коды отклика*

| **Код состояния HTTP** | **Код ошибки**     | **Описание**                                                           |
|----------------------|--------------------|---------------------------------------------------------------------------|
| 202                  | `Accepted`           | Активация подписки SaaS подтверждается для указанного плана.                   |
| 400                  | `BadRequest`         | Отсутствуют обязательные заголовки, или текст JSON имеет неправильный формат. |
| 403                  | `Forbidden`          | У вызывающей стороны нет прав на выполнение этой операции.                   |
| 404                  | `NotFound`           | Подписка с указанным идентификатором не найдена.                                  |
| 409                  | `Conflict`           | Выполняется другая операция для этой подписки.                     |
| 429                  | `RequestThrottleId`  | Служба занята обработкой запросов. Повторите попытку позже.                  |
| 503                  | `ServiceUnavailable` | Служба временно недоступна. Повторите попытку позже.                          |
|  |  |  |

*Заголовки ответов*

| **Ключ заголовка**     | **Обязательно** | **Описание**                                                                                        |
|--------------------|--------------|--------------------------------------------------------------------------------------------------------|
| x-ms-requestid     | Да          | Полученный от клиента идентификатор запроса.                                                                   |
| x-ms-correlationid | Да          | Идентификатор корреляции, если клиент предоставил его. В противном случае — идентификатор корреляции сервера.                   |
| x-ms-activityid    | Да          | Уникальное строковое значение для отслеживания запроса от службы. Это значение используется для сверок любого рода. |
| Retry-After        | Да          | Интервал, в течение которого клиент может проверить состояние.                                                       |
| Operation-Location | Да          | Ссылка на ресурс для получения состояния операции.                                                        |
|  |  |  |

### <a name="delete-subscription"></a>Удаление подписки

Действие удаления на конечной точке подписки позволяет пользователю удалить подписку с определенным идентификатором.

*Запрос*

**DELETE**

**https://marketplaceapi.microsoft.com/api/saas/subscriptions/ *{идентификатор_подписки}* ?api-version=2017-04-15**

| **Имя параметра**  | **Описание**                                       |
|---------------------|-------------------------------------------------------|
| subscriptionId      | Идентификатор подписки на SaaS                              |
| api-version         | Версия операции, используемой для этого запроса. |
|  |  |

*Заголовки*

| **Ключ заголовка**     | **Обязательно** | **Описание**                                                                                                                                                                                                                  |
|--------------------|--------------| ----------------------------------------------------------|
| x-ms-requestid     | нет           | Уникальное строковое значение для отслеживания запроса от клиента. Мы рекомендуем использовать GUID. Если это значение не указано, оно создается случайным образом и возвращается в заголовке ответа.                                                           |
| x-ms-correlationid | нет           | Уникальное строковое значение для операции на стороне клиента. Это значение позволяет сопоставить все события клиентской операции с событиями на стороне сервера. Если не указано, создается случайным образом и возвращается в заголовке ответа. |
| авторизация      | Да          | Токен носителя JSON Web Token (JWT).                    |
|  |  |  |

*Коды отклика*

| **Код состояния HTTP** | **Код ошибки**     | **Описание**                                                           |
|----------------------|--------------------|---------------------------------------------------------------------------|
| 202                  | `Accepted`           | Активация подписки SaaS подтверждается для указанного плана.                   |
| 400                  | `BadRequest`         | Отсутствуют обязательные заголовки, или текст JSON имеет неправильный формат. |
| 403                  | `Forbidden`          | У вызывающей стороны нет прав на выполнение этой операции.                   |
| 404                  | `NotFound`           | Подписка с указанным идентификатором не найдена.                                  |
| 429                  | `RequestThrottleId`  | Служба занята обработкой запросов, повторите попытку позже.                  |
| 503                  | `ServiceUnavailable` | Служба временно недоступна. Повторите попытку позже.                          |
|  |  |  |

Ответ 202 см. в подстроке состояния операции запроса в заголовке "Operation-Location". Аутентификация выполняется так же, как для других API Marketplace.

*Заголовки ответов*

| **Ключ заголовка**     | **Обязательно** | **Описание**                                                                                        |
|--------------------|--------------|--------------------------------------------------------------------------------------------------------|
| x-ms-requestid     | Да          | Полученный от клиента идентификатор запроса.                                                                   |
| x-ms-correlationid | Да          | Идентификатор корреляции, если он предоставлен клиентом, в противном случае идентификатор корреляции сервера                   |
| x-ms-activityid    | Да          | Уникальное строковое значение для отслеживания запроса от службы. Используется для сверок любого рода. |
| Retry-After        | Да          | Интервал, в течение которого клиент может проверить состояние.                                                       |
| Operation-Location | Да          | Ссылка на ресурс для получения состояния операции.                                                        |
|   |  |  |

### <a name="get-operation-status"></a>Получение состояния операции

Эта конечная точка позволяет отслеживать состояние запущенной асинхронной операции (подписка, отмена подписки, изменение плана).

*Запрос*

**GET**

**https://marketplaceapi.microsoft.com/api/saas/operations/ *{идентификатор_операции}* ?api-version=2017-04-15**

| **Имя параметра**  | **Описание**                                       |
|---------------------|-------------------------------------------------------|
| operationId         | Уникальный идентификатор запущенной операции.                |
| api-version         | Версия операции, используемой для этого запроса. |
|  |  |

*Заголовки*

| **Ключ заголовка**     | **Обязательно** | **Описание**                                                                                                                                                                                                                  |
|--------------------|--------------|--------------------------------------------------------------------------------------------------------------------------|
| x-ms-requestid     | нет           | Уникальное строковое значение для отслеживания запроса от клиента. Мы рекомендуем использовать GUID. Если это значение не указано, оно создается случайным образом и возвращается в заголовке ответа.   |
| x-ms-correlationid | нет           | Уникальное строковое значение для операции на стороне клиента. Это значение позволяет сопоставить все события клиентской операции с событиями на стороне сервера. Если это значение не указано, оно создается случайным образом и возвращается в заголовке ответа.  |
| авторизация      | Да          | Токен носителя JSON Web Token (JWT).                    |
|  |  |  | 

*Текст ответа*

```json
{
    "id": "",
    "status": "",
    "resourceLocation": "",
    "created": "",
    "lastModified": ""
}
```

| **Имя параметра** | **Data type** | **Описание**                                                                                                                                               |
|--------------------|---------------|-------------------------------------------------------------------------------------------|
| идентификатор                 | String        | Идентификатор операции.                                                                      |
| status             | Перечисление.          | Состояние операции: `In Progress`, `Succeeded` или `Failed`.          |
| resourceLocation   | String        | Ссылка на созданную или измененную подписку. Она позволяет клиенту получить обновленное состояние после операции. Это значение не задается для операций `Unsubscribe`. |
| created            | Дата и время      | Время создания операции в формате UTC.                                                           |
| lastModified       | Дата и время      | Последнее обновление операции в формате UTC.                                                      |
|  |  |  |

*Коды отклика*

| **Код состояния HTTP** | **Код ошибки**     | **Описание**                                                              |
|----------------------|--------------------|------------------------------------------------------------------------------|
| 200                  | `OK`                 | Запрос GET разрешен успешно, текст ответа содержит требуемую информацию.    |
| 400                  | `BadRequest`         | Отсутствуют необходимые заголовки, или указано недопустимое значение api-version. |
| 403                  | `Forbidden`          | У вызывающей стороны нет прав на выполнение этой операции.                      |
| 404                  | `NotFound`           | Подписка с указанным ИДЕНТИФИКАТОРом не найдена.                                     |
| 429                  | `RequestThrottleId`  | Служба занята обработкой запросов. Повторите попытку позже.                     |
| 503                  | `ServiceUnavailable` | Служба временно недоступна. Повторите попытку позже.                             |
|  |  |  |

*Заголовки ответов*

| **Ключ заголовка**     | **Обязательно** | **Описание**                                                                                        |
|--------------------|--------------|--------------------------------------------------------------------------------------------------------|
| x-ms-requestid     | Да          | Полученный от клиента идентификатор запроса.                                                                   |
| x-ms-correlationid | Да          | Идентификатор корреляции, если он предоставлен клиентом, в противном случае идентификатор корреляции сервера                   |
| x-ms-activityid    | Да          | Уникальное строковое значение для отслеживания запроса от службы. Используется для сверок любого рода. |
| Retry-After        | Да          | Интервал, в течение которого клиент может проверить состояние.                                                       |
|  |  |  |

### <a name="get-subscription"></a>Получение подписки

Действие получения на конечной точке подписки позволяет пользователю получить подписку по определенному идентификатору ресурса.

*Запрос*

**GET**

**https://marketplaceapi.microsoft.com/api/saas/subscriptions/ *{идентификатор_подписки}* ?api-version=2017-04-15**

| **Имя параметра**  | **Описание**                                       |
|---------------------|-------------------------------------------------------|
| subscriptionId      | Идентификатор подписки на SaaS                              |
| api-version         | Версия операции, используемой для этого запроса. |
|  |  |

*Заголовки*

| **Ключ заголовка**     | **Обязательно** | **Описание**                                                                                           |
|--------------------|--------------|-----------------------------------------------------------------------------------------------------------|
| x-ms-requestid     | нет           | Уникальное строковое значение для отслеживания запроса клиента, желательно GUID. Если это значение не указано, оно создается случайным образом и возвращается в заголовке ответа.                                                           |
| x-ms-correlationid | нет           | Уникальное строковое значение для операции на стороне клиента. Это значение позволяет сопоставить все события клиентской операции с событиями на стороне сервера. Если это значение не указано, оно создается случайным образом и возвращается в заголовке ответа. |
| авторизация      | Да          | Токен носителя JSON Web Token (JWT).                                                                    |
|  |  |  |

*Текст ответа*

```json
{
    "id": "",
    "saasSubscriptionName": "",
    "offerId": "",
    "planId": "",
    "saasSubscriptionStatus": "",
    "created": "",
    "lastModified": ""
}
```

| **Имя параметра**     | **Data type** | **Описание**                               |
|------------------------|---------------|-----------------------------------------------|
| идентификатор                     | String        | Идентификатор ресурса подписки на SaaS в Azure.    |
| offerId                | String        | Идентификатор предложения, на которое подписан пользователь.         |
| planId                 | String        | Идентификатор плана, на который подписан пользователь.          |
| saasSubscriptionName   | String        | Имя подписки на SaaS.                |
| saasSubscriptionStatus | Перечисление.          | Состояние операции.  Это может быть:  <br/> - `Subscribed`: подписка активна;  <br/> - `Pending`: пользователь создал ресурс, но независимый производитель программного обеспечения еще не активировал его;   <br/> - `Unsubscribed`: пользователь отменил подписку;   <br/> - `Suspended`: пользователь приостановил подписку;   <br/> - `Deactivated`: подписка Azure отключена.  |
| created                | Дата и время      | Значение времени создания подписки в формате UTC. |
| lastModified           | Дата и время      | Значение времени изменения подписки в формате UTC. |
|  |  |  |

*Коды отклика*

| **Код состояния HTTP** | **Код ошибки**     | **Описание**                                                              |
|----------------------|--------------------|------------------------------------------------------------------------------|
| 200                  | `OK`                 | Запрос GET разрешен успешно, текст ответа содержит требуемую информацию.    |
| 400                  | `BadRequest`         | Отсутствуют необходимые заголовки, или указано недопустимое значение api-version. |
| 403                  | `Forbidden`          | У вызывающей стороны нет прав на выполнение этой операции.                      |
| 404                  | `NotFound`           | Подписка с указанным идентификатором не найдена.                                     |
| 429                  | `RequestThrottleId`  | Служба занята обработкой запросов. Повторите попытку позже.                     |
| 503                  | `ServiceUnavailable` | Служба временно недоступна. Повторите попытку позже.                             |
|  |  |  |

*Заголовки ответов*

| **Ключ заголовка**     | **Обязательно** | **Описание**                                                                                        |
|--------------------|--------------|--------------------------------------------------------------------------------------------------------|
| x-ms-requestid     | Да          | Полученный от клиента идентификатор запроса.                                                                   |
| x-ms-correlationid | Да          | Идентификатор корреляции, если он предоставлен клиентом, в противном случае идентификатор корреляции сервера                   |
| x-ms-activityid    | Да          | Уникальное строковое значение для отслеживания запроса от службы. Используется для сверок любого рода. |
| Retry-After        | нет           | Интервал, в течение которого клиент может проверить состояние.                                                       |
| eTag               | Да          | Ссылка на ресурс для получения состояния операции.                                                        |
|  |  |  |

### <a name="get-subscriptions"></a>Получение подписок

Действие получения на конечной точке подписки позволяет пользователю получить список подписок для всех предложений этого поставщика программного обеспечения.

*Запрос*

**GET**

**https://marketplaceapi.microsoft.com/api/saas/subscriptions?api-version=2017-04-15**

| **Имя параметра**  | **Описание**                                       |
|---------------------|-------------------------------------------------------|
| api-version         | Версия операции, используемой для этого запроса. |
|  |  |

*Заголовки*

| **Ключ заголовка**     | **Обязательно** | **Описание**                                           |
|--------------------|--------------|-----------------------------------------------------------|
| x-ms-requestid     | нет           | Уникальное строковое значение для отслеживания запроса от клиента. Мы рекомендуем использовать GUID. Если это значение не указано, оно создается случайным образом и возвращается в заголовке ответа.             |
| x-ms-correlationid | нет           | Уникальное строковое значение для операции на стороне клиента. Это значение позволяет сопоставить все события клиентской операции с событиями на стороне сервера. Если это значение не указано, оно создается случайным образом и возвращается в заголовке ответа. |
| авторизация      | Да          | Токен носителя JSON Web Token (JWT).                    |
|  |  |  |

*Текст ответа*

```json
{
    "id": "",
    "saasSubscriptionName": "",
    "offerId": "",
    "planId": "",
    "saasSubscriptionStatus": "",
    "created": "",
    "lastModified": ""
}
```

| **Имя параметра**     | **Data type** | **Описание**                               |
|------------------------|---------------|-----------------------------------------------|
| идентификатор                     | String        | Идентификатор ресурса подписки SaaS в Azure    |
| offerId                | String        | Идентификатор предложения, на который подписан пользователь         |
| planId                 | String        | ИДЕНТИФИКАТОР плана, на который подписан пользователь          |
| saasSubscriptionName   | String        | Имя подписки SaaS                |
| saasSubscriptionStatus | Перечисление.          | Состояние операции.  Это может быть:  <br/> - `Subscribed`: подписка активна;  <br/> - `Pending`: пользователь создал ресурс, но независимый производитель программного обеспечения еще не активировал его;   <br/> - `Unsubscribed`: пользователь отменил подписку;   <br/> - `Suspended`: пользователь приостановил подписку;   <br/> - `Deactivated`: подписка Azure отключена.  |
| created                | Дата и время      | Значение метки времени создания подписки в формате UTC |
| lastModified           | Дата и время      | Значение метки времени изменено подпиской в формате UTC |
|  |  |  |

*Коды отклика*

| **Код состояния HTTP** | **Код ошибки**     | **Описание**                                                              |
|----------------------|--------------------|------------------------------------------------------------------------------|
| 200                  | `OK`                 | Запрос GET разрешен успешно, текст ответа содержит требуемую информацию.    |
| 400                  | `BadRequest`         | Отсутствуют необходимые заголовки, или указано недопустимое значение api-version. |
| 403                  | `Forbidden`          | У вызывающей стороны нет прав на выполнение этой операции.                      |
| 404                  | `NotFound`           | Подписка с указанным идентификатором не найдена.                                     |
| 429                  | `RequestThrottleId`  | Служба занята обработкой запросов, повторите попытку позже.                     |
| 503                  | `ServiceUnavailable` | Служба временно недоступна. Повторите попытку позже.                             |
|  |  |  |

*Заголовки ответов*

| **Ключ заголовка**     | **Обязательно** | **Описание**                                                                                        |
|--------------------|--------------|--------------------------------------------------------------------------------------------------------|
| x-ms-requestid     | Да          | Полученный от клиента идентификатор запроса.                                                                   |
| x-ms-correlationid | Да          | Идентификатор корреляции, если он предоставлен клиентом, в противном случае идентификатор корреляции сервера                   |
| x-ms-activityid    | Да          | Уникальное строковое значение для отслеживания запроса от службы. Используется для сверок любого рода. |
| Retry-After        | нет           | Интервал, в течение которого клиент может проверить состояние.                                                       |
|  |  |  |

### <a name="saas-webhook"></a>Веб-перехватчик SaaS

Веб-перехватчик SaaS используется для предварительного уведомления об изменениях в службе SaaS. Ожидается, что этот API POST не прошел проверку подлинности и будет вызываться службой Майкрософт. Ожидается, что служба SaaS вызовет операции API для проверки и авторизации, прежде чем выполнять какие-либо действия над уведомлениями веб-перехватчика. 

*Текст*

``` json
  {
    "id": "be750acb-00aa-4a02-86bc-476cbe66d7fa",
    "activityId": "be750acb-00aa-4a02-86bc-476cbe66d7fa",
    "subscriptionId":"cd9c6a3a-7576-49f2-b27e-1e5136e57f45",
    "action": "Subscribe", // Subscribe/Unsubscribe/ChangePlan
    "operationRequestSource":"Azure",
    "timeStamp":"2018-12-01T00:00:00"
  }
```

| **Имя параметра**     | **Data type** | **Описание**                               |
|------------------------|---------------|-----------------------------------------------|
| идентификатор  | String       | Уникальный идентификатор запущенной операции.                |
| activityId   | String        | Уникальное строковое значение для отслеживания запроса от службы. Используется для сверок любого рода.               |
| subscriptionId                     | String        | Идентификатор ресурса подписки на SaaS в Azure.    |
| offerId                | String        | Идентификатор предложения, на которое подписан пользователь. Предоставляется только с действием "Обновить".        |
| publisherid                | String        | Идентификатор издателя предложения SaaS         |
| planId                 | String        | Идентификатор плана, на который подписан пользователь. Предоставляется только с действием "Обновить".          |
| action                 | String        | Событие, которое запускает это уведомление. Допустимые значения: Activate, Delete, Suspend, Reinstate, Update          |
| timeStamp (метка времени)                 | String        | Значение метки времени в формате UTC, когда это уведомление было активировано.          |
|  |  |  |


## <a name="next-steps"></a>Дальнейшие действия

Разработчики также могут программно получать и манипулировать рабочими нагрузками, предложениями и профилями издателей с помощью [API-интерфейсов портал Cloud Partner](https://docs.microsoft.com/azure/marketplace/cloud-partner-portal-orig/cloud-partner-portal-api-overview).
