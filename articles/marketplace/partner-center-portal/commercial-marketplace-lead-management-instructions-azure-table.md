---
title: Таблица Azure | Azure Marketplace
description: Настройте управление интересами для Хранилища таблиц Azure.
services: Azure, Marketplace, commercial marketplace, Partner Center
author: qianw211
ms.service: marketplace
ms.subservice: partnercenter-marketplace-publisher
ms.topic: conceptual
ms.date: 07/30/2019
ms.author: evansma
ms.openlocfilehash: 9b24e6eb714c531b49ba08591bf4ed33d0f10101
ms.sourcegitcommit: ac56ef07d86328c40fed5b5792a6a02698926c2d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/08/2019
ms.locfileid: "73812343"
---
# <a name="configure-lead-management-using-an-azure-table"></a>Настройка управления интересами с помощью таблицы Azure

Если система управления отношениями с клиентами (CRM) не поддерживается явно в центре партнеров для получения Azure Marketplace и AppSource интересов, вы можете использовать таблицу Azure для обработки этих интересов. Затем можно выбрать экспорт данных и их импорт в систему CRM. Инструкции в этой статье помогут вам создать учетную запись хранения Azure и таблицу Azure под этой учетной записью. Кроме того, можно создать новый поток с помощью Microsoft Flow, чтобы отправить уведомление по электронной почте, когда ваше предложение получит интерес.

## <a name="configure-azure-table"></a>Настройка таблицы Azure

1. Если у вас нет учетной записи Azure, вы можете [создать бесплатную пробную учетную запись](https://azure.microsoft.com/pricing/free-trial/).
2. Когда учетная запись Azure будет активна, войдите в [портал Azure](https://portal.azure.com).
3. В портал Azure создайте учетную запись хранения, выполнив следующую процедуру.  
    1. Выберите **+ создать ресурс** в левой строке меню.  Справа появится **Новая** панель (колонка).
    2. В области **создать** выберите **хранилище** .  Справа отображается список с **описанием** .
    3. Выберите **учетную запись хранения** , чтобы начать создание учетной записи.  Следуйте инструкциям в статье [Создание учетной записи хранения](https://docs.microsoft.com/azure/storage/common/storage-quickstart-create-account?tabs=azure-portal).

        ![Шаги по созданию учетной записи хранения Azure](./media/commercial-marketplace-lead-management-instructions-azure-table/azure-storage-create.png)

        Для получения дополнительных сведений об учетных записях хранения выберите [Краткое руководство](https://docs.microsoft.com/azure/storage/).  Дополнительные сведения о ценах на службу хранилища см. на странице [Обзор цен на хранилище Azure](https://azure.microsoft.com/pricing/details/storage/).

4. Подождите, пока ваша учетная запись хранения не будет подготовлена, процесс, который обычно занимает несколько минут.  Затем откройте учетную запись хранения на **домашней** странице портал Azure, выбрав **Просмотреть все ресурсы** или выбрав **все ресурсы** в левой строке меню навигации портал Azure.

    ![Доступ к учетной записи хранения Azure](./media/commercial-marketplace-lead-management-instructions-azure-table/azure-storage-access.png)

5. В области Учетная запись хранения выберите **ключи доступа** и скопируйте значение *строки подключения* для ключа. Сохраните это значение, так как это значение *строки подключения к учетной записи хранения* , которое потребуется предоставить на портале публикации, чтобы получить интересы для вашего предложения Marketplace. 

    Пример соединения проверочного:

    ```sql
    DefaultEndpointsProtocol=https;AccountName=myAccountName;AccountKey=myAccountKey;EndpointSuffix=core.windows.net
    ```

    ![Ключ к хранилищу Azure](./media/commercial-marketplace-lead-management-instructions-azure-table/azure-storage-keys.png)

6. В области Учетная запись хранения выберите **таблицы** и щелкните **+ Таблица** , чтобы создать таблицу. Введите имя таблицы и нажмите кнопку **ОК**. Сохраните это значение, так как оно потребуется, если вы хотите настроить MS Flow для получения уведомлений по электронной почте при получении интересов.

    ![Таблицы Azure](./media/commercial-marketplace-lead-management-instructions-azure-table/azure-tables.png)

    Вы можете использовать [обозреватель службы хранилища Azure](https://archive.codeplex.com/?p=azurestorageexplorer) или любое другое средство для просмотра данных в таблице хранилища. Вы также можете экспортировать данные в таблицу Azure. 

## <a name="optional-use-microsoft-flow-with-an-azure-table"></a>Используемых Использование Microsoft Flow с таблицей Azure  

[Microsoft Flow](https://docs.microsoft.com/flow/) можно использовать для автоматизации уведомления при каждом добавлении потенциального клиента в таблицу Azure. Если у вас нет учетной записи, вы можете [зарегистрироваться для бесплатной учетной записи](https://flow.microsoft.com/).

### <a name="lead-notification-example"></a>Пример уведомления о потенциальном клиенте

Этот пример можно использовать как руководство по созданию простого потока, который автоматически отправляет уведомление по электронной почте при добавлении нового потенциального клиента в таблицу Azure. В этом примере при обновлении табличного хранилища настраивается повторение для отправки сведений об интересах каждый час.

1. Войдите в учетную запись Microsoft Flow.
2. На панели навигации слева выберите **Мои потоки**.
3. На панели навигации сверху выберите **+ Создать**.  
4. В раскрывающемся списке выберите **+ по расписанию — с пустого** значения.

   ![Мои потоки * * + по расписанию — с пустого * *](./media/commercial-marketplace-lead-management-instructions-azure-table/ms-flow-scheduled-from-blank.png)

5.  В окне *Создание запланированного потока* в разделе *Повторять каждые* выберите "1" для интервала и "час" для параметра "частота". Кроме того, при желании присвойте потоку имя. Нажмите кнопку **Создать**.

    >[!Note]
    >Хотя в этом примере используется интервал в 1 час, можно выбрать интервал и частоту, которые лучше подходят для бизнес-нужд.

    ![Создание запланированного потока.](./media/commercial-marketplace-lead-management-instructions-azure-table/build-scheduled-flow.png)

6. Выберите **+ Новый шаг**.
7. В окне *Выбор действия* выполните поиск по фразе "получить предыдущее время", а затем выберите пункт **получить предыдущее время** в разделе действия.

   ![Выберите действие.](./media/commercial-marketplace-lead-management-instructions-azure-table/choose-an-action.png)

8. В окне **Получение времени в прошлом** в поле **Интервал** укажите 1. Из раскрывающегося списка **Единица времени** выберите **Час**.

    >[!Important]
    >Убедитесь, что этот интервал и единица времени соответствуют интервалу и частоте, настроенным для повторения на шаге 5.

    ![Настройка интервала в разделе "Получение времени в прошлом"](./media/commercial-marketplace-lead-management-instructions-azure-table/ms-flow-getpast-time.png)

>[!TIP] 
>Чтобы убедиться в правильности каждого шага, можно в любое время проверить поток. Чтобы проверить ваш поток, выберите **Средство проверки потоков**  в строке меню Flow.

В следующем наборе действий вы будете подключаться к таблице Azure и настроили логику обработки для обработки новых интересов.

9. После шага получить в прошлом выберите **+ новый шаг**, а затем выполните поиск по запросу "получить сущности" в окне *Выбор действия* .
10. В разделе **действия**выберите **получить сущности (хранилище таблиц Azure)** .
11. В окне **хранилище таблиц Azure** введите сведения для следующих полей и выберите **создать**:

    * *Имя подключения* — укажите понятное имя для установленного подключения между этим потоком и таблицей Azure.
    * *Имя учетной записи хранения* — укажите имя учетной записи хранения для таблицы Azure. Его можно найти на странице **ключи доступа** учетной записи хранения.
    * *Общий ключ хранилища* — укажите значение ключа для вашей учетной записи хранения в таблице Azure. Его можно найти на странице **ключи доступа** учетной записи хранения.

        ![хранилище таблиц Azure.](./media/commercial-marketplace-lead-management-instructions-azure-table/azure-table-storage.png)

    После нажатия кнопки Создать появится окно *Получение сущностей* . Здесь выберите **отобразить дополнительные параметры** и укажите сведения для следующих полей:

       * *Таблица* — выберите имя хранилища таблиц Azure (из шага 6 инструкций по настройке таблицы Azure). На следующем снимке экрана отображается запрос, когда для этого примера выбрана таблица "маркетплацелеадс".

            ![Получение сущностей в таблице Azure.](./media/commercial-marketplace-lead-management-instructions-azure-table/azure-table-get-entities.png)

        * *Фильтрация запроса* . Выберите это поле и вставьте эту функцию в поле: `Timestamp gt datetime'@{body('Get_past_time')}'`

            ![Таблица Get сущностей Azure Куерри.](./media/commercial-marketplace-lead-management-instructions-azure-table/azure-table-get-entities-filter-query.png)

12. После завершения настройки подключения к таблице Azure выберите **новый шаг** , чтобы добавить условие для проверки таблицы Azure на предмет новых интересов. 

13. В окне **Выбор действия** выберите **действия**, а затем выберите **элемент управления условие**.

    ![Таблица Azure. Выберите действие.](./media/commercial-marketplace-lead-management-instructions-azure-table/azure-table-choose-an-action.png)

14. В окне **Условие** перейдите в поле **Выберите значение**, а затем выберите **Выражение** во всплывающем окне.

15. Вставьте `length(body('Get_entities')?['value'])` в поле ***fx***. Нажмите **ОК** для добавления этой функции. 

16. Чтобы завершить настройку условия:
    1. В раскрывающемся списке выберите "больше чем".
    2. Введите 0 в качестве значения.

        ![Условие таблицы Azure.](./media/commercial-marketplace-lead-management-instructions-azure-table/azure-table-condition.png)

В следующих шагах вы настроите действие, которое будет выполняться в зависимости от результата условия.

* Если условие разрешается в, **Если нет**, ничего делать не нужно.
* Если условие возвращает **Если "да"** , активируется действие подключения к учетной записи Office 365 для отправки сообщения электронной почты. 

17. Выберите **Добавить действие** в поле **Если да**.

    ![Таблица Azure — условие, * * если да * *.](./media/commercial-marketplace-lead-management-instructions-azure-table/azure-table-condition-if-yes.png)

18. Выберите **Отправить сообщение электронной почты (Office 365 Outlook)** .

    ![Таблица Azure — условие, * * если да * *, отправить сообщение электронной почты.](./media/commercial-marketplace-lead-management-instructions-azure-table/azure-table-condition-if-yes-send-email.png)

    >[!Note]
    >Если вы хотите использовать другой поставщик электронной почты, выполните поиск по адресу и выберите Отправить уведомление по электронной почте (mail) в качестве действия. В инструкциях показано, как настроить с помощью Office 365 Outlook, но инструкции аналогичны для другого поставщика электронной почты.

19. В окне **Office 365 Outlook** введите сведения для следующих полей:

    1. **Кому** — введите адреса электронной почты всех пользователей, которые должны получить это уведомление.
    1. **Тема** — укажите тему сообщения электронной почты. Например: новые интересы!
    1. **Текст.** добавьте текст, который необходимо включить в каждый адрес электронной почты (необязательно), а затем вставьте текст `body('Get_entities')?['value']`.

    >[!Note]
    >В текст сообщения можно вставить дополнительные статические или динамические точки данных.

    ![Таблица Azure — условие, * * если да * *, окно Office 365 Outlook.](./media/commercial-marketplace-lead-management-instructions-azure-table/azure-table-condition-if-yes-outlook.png)

20. Выберите **Сохранить**, чтобы сохранить поток. Microsoft Flow автоматически проверит поток на наличие ошибок. Если ошибок нет, поток начнет выполняться после сохранения.

На следующем снимке экрана показан пример того, как в итоге должен выглядеть поток.

![Пример окончательного потока.](./media/commercial-marketplace-lead-management-instructions-azure-table/final-flow.png)

### <a name="manage-your-flow"></a>Управление ходом выполнения

Управление потоком после его выполнения упрощается. Вы его полностью контролируете. Например, вы можете его остановить или изменить, просмотреть журнал его выполнения и получить аналитику. На следующем снимке экрана показаны доступные параметры для управления потоком. 

 ![Управление потоком](./media/commercial-marketplace-lead-management-instructions-azure-table/ms-flow-manage-completed.png)

Поток продолжает выполняться, пока вы не остановите его с помощью параметра **Отключить поток**.

Если вы не получаете уведомления по электронной почте, это означает, что новые интересы не были добавлены в таблицу Azure. При возникновении сбоев в потоке вы получите сообщение электронной почты, как в примере на следующем снимке экрана.

 ![Уведомление по электронной почте о сбое потока](./media/commercial-marketplace-lead-management-instructions-azure-table/ms-flow-failure-note.png)

## <a name="configure-your-offer-to-send-leads-to-the-azure-table"></a>Настройка предложения для отправки интересов в таблицу Azure

Когда вы будете готовы к настройке сведений об управлении интересами для вашего предложения на портале публикации, выполните следующие действия:

1. Перейдите на страницу **настройки предложения** для вашего предложения.
2. Выберите **Подключиться** в разделе Управление интересами.
3. Во всплывающем окне сведения о подключении выберите **Таблица Azure** для **назначения интереса**и вставьте строку подключения из учетной записи хранения Azure, созданной на предыдущих шагах, в **строку подключения к учетной записи хранения** . полями.
4. Щелкните **Сохранить**. 

>[!Note]
>Необходимо завершить настройку остальной части предложения и опубликовать его, прежде чем вы сможете получить интересы для предложения.

Когда интересы создаются, корпорация Майкрософт отправляет интересы в таблицу Azure. Если вы настроили последовательность, в настроенный адрес электронной почты также будет отправлено электронное письмо.

![Lead management (Управление потенциальными клиентами)](./media/commercial-marketplace-lead-management-instructions-azure-table/lead-management.png)

![Управление интересами — сведения о подключении](./media/commercial-marketplace-lead-management-instructions-azure-table/connection-details.png)

![Управление интересами — учетная запись хранения сведений о подключении](./media/commercial-marketplace-lead-management-instructions-azure-table/azure-table-connection-details.png)

