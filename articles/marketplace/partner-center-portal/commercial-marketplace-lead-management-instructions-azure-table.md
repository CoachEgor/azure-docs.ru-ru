---
title: Настройка управления интересами для коммерческого рынка Майкрософт с помощью таблицы Azure
description: Узнайте, как использовать таблицу Azure для управления интересами из Microsoft AppSource и Azure Marketplace.
author: qianw211
ms.service: marketplace
ms.subservice: partnercenter-marketplace-publisher
ms.topic: conceptual
ms.date: 03/30/2020
ms.author: dsindona
ms.openlocfilehash: 9814b03e348fc807c04364afbf027369f917670a
ms.sourcegitcommit: 849bb1729b89d075eed579aa36395bf4d29f3bd9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2020
ms.locfileid: "82131142"
---
# <a name="configure-lead-management-by-using-an-azure-table"></a>Настройка управления интересами с помощью таблицы Azure

Если система управления отношениями с клиентами (CRM) не поддерживается в центре партнеров для получения Microsoft AppSource и интересов Azure Marketplace, можно использовать таблицу Azure для обработки этих интересов. Затем можно выбрать экспорт данных и их импорт в систему CRM. В этой статье приведены инструкции по созданию учетной записи хранения Azure и таблицы Azure под этой учетной записью. Кроме того, вы можете создать новый поток с помощью Power автоматизиру, чтобы отправить уведомление по электронной почте, когда ваше предложение получит интерес.

## <a name="configure-an-azure-table"></a>Настройка таблицы Azure

1. Если у вас нет учетной записи Azure, вы можете [создать бесплатную пробную учетную запись](https://azure.microsoft.com/pricing/free-trial/).
1. Когда учетная запись Azure будет активна, войдите в [портал Azure](https://portal.azure.com).
1. В портал Azure создайте учетную запись хранения, выполнив следующую процедуру:

    1. Выберите **+ создать ресурс** в левой строке меню. Справа появится **Новая** панель.
    1. В области **создать** выберите **хранилище** . Справа появится список **популярных** .
    1. Выберите **учетную запись хранения** , чтобы начать создание учетной записи. Следуйте инструкциям в разделе [Создание учетной записи хранения](https://docs.microsoft.com/azure/storage/common/storage-quickstart-create-account?tabs=azure-portal).

        ![Шаги по созданию учетной записи хранения Azure](./media/commercial-marketplace-lead-management-instructions-azure-table/azure-storage-create.png)

        Дополнительные сведения об учетных записях хранения см. в разделе [Краткое руководство](https://docs.microsoft.com/azure/storage/). Дополнительные сведения о ценах на хранилище см. в разделе [цены на хранилище](https://azure.microsoft.com/pricing/details/storage/).

1. Дождитесь подготовки учетной записи хранения. Этот процесс обычно занимает несколько минут. Затем откройте учетную запись хранения на **домашней** странице портал Azure, выбрав **Просмотреть все ресурсы**. Также можно выбрать **все ресурсы** в левой строке меню портал Azure.

    ![Доступ к учетной записи хранения Azure](./media/commercial-marketplace-lead-management-instructions-azure-table/azure-storage-access.png)

1. В области Учетная запись хранения выберите **ключи доступа** и скопируйте значение **строки подключения** для ключа. Сохраните это значение, так как это значение **строки подключения к учетной записи хранения** , которое необходимо указать на портале публикации для получения интересов для вашего предложения Azure Marketplace. 

    Ниже приведен пример строки подключения.

    ```sql
    DefaultEndpointsProtocol=https;AccountName=myAccountName;AccountKey=myAccountKey;EndpointSuffix=core.screens.net
    ```

    ![Ключ к хранилищу Azure](./media/commercial-marketplace-lead-management-instructions-azure-table/azure-storage-keys.png)

1. В области Учетная запись хранения выберите **таблицы**и щелкните **+ Таблица** , чтобы создать таблицу. Введите имя таблицы и нажмите кнопку **ОК**. Сохраните это значение, так как оно понадобится, если вы хотите настроить последовательность для получения уведомлений по электронной почте при получении интересов.

    ![Таблицы Azure](./media/commercial-marketplace-lead-management-instructions-azure-table/azure-tables.png)

    Для просмотра данных в таблице хранилища можно использовать [Обозреватель службы хранилища Azure](https://archive.codeplex.com/?p=azurestorageexplorer) или любое другое средство. Вы также можете экспортировать данные в таблицу Azure. 

## <a name="optional-use-power-automate-with-an-azure-table"></a>Используемых Использование Power автоматизиру с таблицей Azure 

Вы можете использовать [автоматизацию](https://docs.microsoft.com/flow/) , чтобы автоматизировать уведомления при каждом добавлении интереса в таблицу Azure. Если у вас нет учетной записи, вы можете [зарегистрироваться для бесплатной учетной записи](https://flow.microsoft.com/).

### <a name="lead-notification-example"></a>Пример уведомления о потенциальном клиенте

Этот пример можно использовать как руководство по созданию простого потока, который автоматически отправляет уведомление по электронной почте при добавлении нового потенциального клиента в таблицу Azure. В этом примере при обновлении табличного хранилища настраивается повторение для отправки сведений об интересах каждый час.

1. Войдите в учетную запись Power автоматизировать.
1. На левой панели выберите **мои потоки**.
1. На верхней панели щелкните **+ создать**. 
1. В раскрывающемся списке выберите **+ по расписанию — с пустого**места.

   ![Мои последовательности + по расписанию — с пустого](./media/commercial-marketplace-lead-management-instructions-azure-table/ms-flow-scheduled-from-blank.png)

1. В окне **Построение потока по расписанию** для **каждой операции повторить каждые**выберите **1** для интервала и **часа** для частоты. Кроме того, при необходимости присвойте потоку имя. Щелкните **Создать**.

   >[!NOTE]
   >Хотя в этом примере используется интервал в один час, можно выбрать интервал и частоту, которые лучше подходят для бизнес-нужд.

   ![Создание запланированного потока](./media/commercial-marketplace-lead-management-instructions-azure-table/build-scheduled-flow.png)

1. Выберите **+ новый шаг**.
1. В окне **Выбор действия** выполните поиск по запросу **получить время в прошлом**. Затем в разделе **действия**выберите **получить время последнего**.

   ![Выбор действия](./media/commercial-marketplace-lead-management-instructions-azure-table/choose-an-action.png)

1. В окне **Получение времени в прошлом** задайте для параметра **интервал** значение **1**. В раскрывающемся списке **единица времени** выберите значение **час**.

    >[!IMPORTANT]
    >Убедитесь, что интервал и единица времени, отправленные на шаге 8, соответствуют интервалу и частоте, настроенным для повторения на шаге 5.

    ![Задание получения временного интервала](./media/commercial-marketplace-lead-management-instructions-azure-table/ms-flow-getpast-time.png)

   >[!TIP] 
   >Чтобы убедиться в правильности каждого шага, можно в любое время проверить поток. Чтобы проверить последовательность, выберите **средство проверки потоков** в строке меню " **поток** ".

   В следующем наборе действий вы будете подключаться к таблице Azure и настроили логику обработки для обработки новых интересов.

1. После шага 8 выберите **+ новый шаг**. Затем найдите в окне **Выбор действия пункт** **получить сущности** .
1. В разделе **действия**выберите **получить сущности (хранилище таблиц Azure)**.
1. В окне **хранилище таблиц Azure** введите сведения для следующих полей и выберите **создать**:

    * **Имя подключения**: Укажите понятное имя для установленного подключения между этим потоком и таблицей Azure.
    * **Имя учетной записи хранения**: укажите имя учетной записи хранения для таблицы Azure. Это имя можно найти на странице **ключи доступа** учетной записи хранения.
    * **Общий ключ хранилища**: Укажите значение ключа для вашей учетной записи хранения в таблице Azure. Это значение можно найти на странице **ключи доступа** учетной записи хранения.

      ![Окно хранилища таблиц Azure](./media/commercial-marketplace-lead-management-instructions-azure-table/azure-table-storage.png)

   После нажатия **создать**появится окно **получить сущности** . Выберите **параметр Показывать дополнительные параметры**и укажите сведения для следующих полей:

   * **Таблица**: выберите имя хранилища таблиц Azure (из шага 6 инструкций из раздела "Настройка таблицы Azure"). На следующем рисунке показан запрос, когда для этого примера выбрана таблица "маркетплацелеадс".

     ![Получить окно сущностей](./media/commercial-marketplace-lead-management-instructions-azure-table/azure-table-get-entities.png)

   * **Фильтрация запроса**: Установите это поле и вставьте эту функцию в поле:`Timestamp gt datetime'@{body('Get_past_time')}'`

     ![Получение сущностей, фильтрация поля запроса](./media/commercial-marketplace-lead-management-instructions-azure-table/azure-table-get-entities-filter-query.png)

1. После завершения настройки подключения к таблице Azure выберите **новый шаг** , чтобы добавить условие для проверки таблицы Azure на предмет новых интересов.

1. В окне **Выбор действия** выберите **действия**. Выберите **элемент Управление условием**.

    ![Окно "Выберите действие"](./media/commercial-marketplace-lead-management-instructions-azure-table/azure-table-choose-an-action.png)

1. В окне **условие** выберите **выбрать значение**. Затем во всплывающем окне выберите **выражение** .

1. Вставьте `length(body('Get_entities')?['value'])` в поле **FX** . Нажмите **ОК** для добавления этой функции. 

1. Чтобы завершить настройку условия:
    1. Выберите **значение больше, чем** в раскрывающемся списке.
    2. Введите **0** в качестве значения.

        ![Окно условий](./media/commercial-marketplace-lead-management-instructions-azure-table/azure-table-condition.png)

   В следующих шагах вы настроите действие, которое будет выполняться в зависимости от результата условия:

   * Если условие разрешается в, **Если нет**, ничего делать не нужно.
   * Если условие возвращает **Если "да"**, активируется действие подключения к учетной записи Office 365 для отправки сообщения электронной почты. 

1. Выберите **Добавить действие** в поле **Если да**.

    ![Окно условий, если да, добавить действие](./media/commercial-marketplace-lead-management-instructions-azure-table/azure-table-condition-if-yes.png)

1. Выберите **Отправить сообщение электронной почты (Office 365 Outlook)**.

    ![Окно условий, если да, отправить сообщение электронной почты](./media/commercial-marketplace-lead-management-instructions-azure-table/azure-table-condition-if-yes-send-email.png)

    >[!NOTE]
    >Чтобы использовать другой поставщик электронной почты, найдите и выберите **отправить по электронной почте уведомление (почта)** в качестве действия. В инструкциях показано, как настроить с помощью Office 365 Outlook, но эти инструкции похожи на разные поставщики электронной почты.

1. В окне Office 365 Outlook введите сведения для следующих полей:

    1. **Кому**: введите адрес электронной почты для всех, кто будет получать это уведомление.
    1. **Тема**: Укажите тему сообщения электронной почты. Пример — **новые интересы!**
    1. **Текст**: Добавьте текст, который необходимо включить в каждый адрес электронной почты (необязательно), а затем вставьте `body('Get_entities')?['value']`в.

    >[!NOTE]
    >В текст сообщения можно вставить дополнительные статические или динамические точки данных.

    ![Окно условий, если да, окно Office 365 Outlook](./media/commercial-marketplace-lead-management-instructions-azure-table/azure-table-condition-if-yes-outlook.png)

1. Выберите **Сохранить**, чтобы сохранить поток. Power автоматизирует автоматически проверит последовательность на наличие ошибок. Если ошибок нет, поток начнет выполняться после сохранения.

На следующем рисунке показан пример того, как должен выглядеть окончательный поток.

![Пример окончательного потока](./media/commercial-marketplace-lead-management-instructions-azure-table/final-flow.png)

### <a name="manage-your-flow"></a>Управление ходом выполнения

Управление потоком после его выполнения упрощается. Вы его полностью контролируете. Например, вы можете его остановить или изменить, просмотреть журнал его выполнения и получить аналитику. На следующем рисунке показаны параметры, доступные для управления потоком.

 ![Управление потоком](./media/commercial-marketplace-lead-management-instructions-azure-table/ms-flow-manage-completed.png)

Поток продолжает выполняться, пока вы не остановите его с помощью параметра **Отключить поток**.

Если вы не получаете уведомления по электронной почте, это означает, что новые интересы не были добавлены в таблицу Azure. При возникновении сбоев в потоке вы получите сообщение электронной почты, как в этом примере.

 ![Уведомление по электронной почте о сбое потока](./media/commercial-marketplace-lead-management-instructions-azure-table/ms-flow-failure-note.png)

## <a name="configure-your-offer-to-send-leads-to-the-azure-table"></a>Настройка предложения для отправки интересов в таблицу Azure

Когда вы будете готовы к настройке сведений об управлении интересами для вашего предложения на портале публикации, выполните следующие действия.

1. Перейдите на страницу **настройки предложения** для вашего предложения.
1. Выберите **Подключиться** в разделе **управление интересами** .
1. Во всплывающем окне **сведения о подключении** выберите **Таблица Azure** для **назначения интереса**. Вставьте строку подключения из учетной записи хранения Azure, созданной на предыдущих шагах, в поле **строка подключения учетной записи хранения** .
1. **Контактный адрес электронной почты**. Укажите сообщения электронной почты для людей в вашей компании, которые должны получать уведомления при получении нового интереса. Можно указать несколько сообщений электронной почты, разделяя их точкой с запятой.
1. Нажмите кнопку **OK**.

Чтобы убедиться, что вы успешно подключились к цели назначения, нажмите кнопку **проверить** . В случае успеха вы получите руководителя тестирования в целевом месте назначения.

>[!NOTE]
>Необходимо завершить настройку остальной части предложения и опубликовать его, прежде чем вы сможете получить интересы для предложения.

Когда интересы создаются, корпорация Майкрософт отправляет интересы в таблицу Azure. Если вы настроили последовательность, в настроенный адрес электронной почты также будет отправлено электронное письмо.

![Управление потенциальными клиентами](./media/commercial-marketplace-lead-management-instructions-azure-table/lead-management.png)

![Управление интересами, сведения о подключении](./media/commercial-marketplace-lead-management-instructions-azure-table/connection-details.png)

![Управление интересами, учетная запись хранения сведений о подключении](./media/commercial-marketplace-lead-management-instructions-azure-table/azure-table-connection-details.png)

