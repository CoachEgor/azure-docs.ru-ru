---
title: Регистрация приложения SaaS | Azure Marketplace
description: Объясняется, как зарегистрировать приложение SaaS, с помощью портала Azure.
services: Azure, Marketplace, Cloud Partner Portal, Azure portal
author: v-miclar
ms.service: marketplace
ms.topic: conceptual
ms.date: 05/23/2019
ms.author: evansma
ms.openlocfilehash: abe499c081c73d42e712d5872e121262a1a50197
ms.sourcegitcommit: 25a60179840b30706429c397991157f27de9e886
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/28/2019
ms.locfileid: "66259169"
---
# <a name="register-a-saas-application"></a>Регистрация приложения SaaS

В этой статье объясняется, как зарегистрировать приложения SaaS, использующего Microsoft [портала Azure](https://portal.azure.com/).  После успешной регистрации вы получите маркер безопасности Azure Active Directory (Azure AD), который можно использовать для доступа к API выполнения SaaS.  Дополнительные сведения о Azure AD, см. в разделе [что такое проверка подлинности?](https://docs.microsoft.com/azure/active-directory/develop/authentication-scenarios)


## <a name="service-to-service-authentication-flow"></a>Поток проверки подлинности в службе

На следующей диаграмме показана последовательность действий при подписке нового клиента, а также этапы, на которых используются эти API:

![Процесс использования API для предложения SaaS](./media/saas-offer-publish-api-flow-v1.png)

Azure не налагает никаких ограничений на аутентификацию, которую служба SaaS предоставляет своим пользователям. Тем не менее, проверка подлинности с интерфейсами API SaaS выполнения выполняется с маркером безопасности Azure AD, как правило, реализуется путем регистрации приложения SaaS с помощью портала Azure. 


## <a name="register-an-azure-ad-secured-app"></a>Регистрация приложения Azure AD защищены

Все приложения, которые будут использовать возможности Azure AD, сначала следует зарегистрировать в клиенте Azure AD. Этот процесс регистрации включает в себя предоставление Azure AD сведений о приложении (например, URL-адрес, по которому расположено приложение, URL-адрес для отправки ответов после проверки подлинности пользователя, идентифицирующий приложение код URI и др.).  Чтобы зарегистрировать новое приложения с помощью портала Azure, сделайте следующее:

1.  Войдите на [портале Azure](https://portal.azure.com/).
2.  Если учетная запись предоставляет доступ к нескольким клиентам, щелкните свою учетную запись в правом верхнем углу и присвоено сеанса работы с порталом требуемой Azure AD клиента.
3.  В области навигации слева щелкните службу **Azure Active Directory**, а затем выберите **Регистрация приложений** и щелкните **Регистрация нового приложения**.

    ![Регистрации приложений AD для SaaS](./media/saas-offer-app-registration-v1.png)

4.  На странице создания введите сведения о регистрации приложения.
    -   **Имя.** Введите понятное имя для приложения.
    -   **Тип приложения**. 
        - Выберите **Машинный код** для [клиентских приложений](https://docs.microsoft.com/azure/active-directory/develop/active-directory-dev-glossary#client-application), которые установлены локально на устройстве. Этот параметр используется для общедоступных [собственных клиентов](https://docs.microsoft.com/azure/active-directory/develop/active-directory-dev-glossary#native-client) OAuth.
        - Выберите **Веб-приложение или API** для [клиентских приложений](https://docs.microsoft.com/azure/active-directory/develop/active-directory-dev-glossary#client-application) и [приложений-ресурсов / приложений API](https://docs.microsoft.com/azure/active-directory/develop/active-directory-dev-glossary#resource-server), установленных на защищенном сервере. Этот параметр используется для конфиденциальных [веб-клиентов](https://docs.microsoft.com/azure/active-directory/develop/active-directory-dev-glossary#web-client) и общедоступных [клиентов с агентом пользователя](https://docs.microsoft.com/azure/active-directory/develop/active-directory-dev-glossary#user-agent-based-client), использующих OAuth.
        То же приложение может также предоставлять клиент и ресурс или API.
    -   **URL-адрес для входа.** Для веб или API приложений необходимо указать основной URL-адрес приложения. Например, выполняемое на локальном компьютере веб-приложение может иметь адрес **http://localhost:31544** . Пользователи будут использовать этот URL-адрес для входа в приложение веб-клиента.
    -   **URI перенаправления.** Для собственных приложений укажите URI, который использует AAD для возвращения ответов маркера. Укажите значение, используемое в вашем приложении, например **http://MyFirstAADApp** .

        ![Регистрации приложений AD для SaaS](./media/saas-offer-app-registration-v1-2.png)

        Конкретные примеры веб-приложений или собственных приложений, извлечение быстрого запуска интерактивной настройки, которые доступны в *приступить к работе* раздел [руководство для разработчиков Azure AD](https://docs.microsoft.com/azure/active-directory/develop/active-directory-developers-guide).

5.  По завершении нажмите кнопку **Создать**. Azure AD назначает уникальный *идентификатор приложения* ваших приложений, и вы\'повторно, необходимое для приложения\'s главной странице регистрации. В зависимости от того, является ли ваше приложение веб-приложением или собственным приложением, будут предоставлены различные параметры для добавления дополнительных возможностей в приложение.

>[!Note]
>По умолчанию только что зарегистрированное приложение настраивается могли только пользователи из того клиента для входа приложение.


## <a name="using-the-azure-ad-security-token"></a>С помощью токена безопасности Azure AD

После регистрации приложения, вы можете программно запросить маркер безопасности Azure AD.  Издатель должен использовать этот маркер и сделать запрос на ее устранения.  При использовании различных API выполнения, параметр маркера запроса находится в URL-адрес, если пользователь перенаправляется на веб-сайт SaaS с Azure.  Этот маркер действителен только на один час.  Кроме того, должен быть URL-адрес декодировать значение токена из браузера перед его использованием.

Дополнительные сведения о токенах см. в разделе [маркеры доступа Azure Active Directory](https://docs.microsoft.com/azure/active-directory/develop/access-tokens).


### <a name="get-a-token-based-on-the-azure-ad-app"></a>Получение токена для приложения Azure AD

Метод HTTP

`GET`

*Request URL* (URL-адрес запроса)

**https://login.microsoftonline.com/ *{идентификатор_клиента}* /oauth2/token**

*Параметр универсального кода ресурса*

|  **Имя параметра**  | **Обязательный**  | **Описание**                               |
|  ------------------  | ------------- | --------------------------------------------- |
| tenantId             | Истина          | Идентификатор клиента для зарегистрированного приложения AAD   |
|  |  |  |


*Заголовок запроса*

|  **Имя заголовка**  | **Обязательный** |  **Описание**                                   |
|  --------------   | ------------ |  ------------------------------------------------- |
|  Content-Type     | Истина         | Связанный с этим запросом тип содержимого. По умолчанию используется значение `application/x-www-form-urlencoded`.  |
|  |  |  |


*Текст запроса*

| **Имя свойства**   | **Обязательный** |  **Описание**                                                          |
| -----------------   | -----------  | ------------------------------------------------------------------------- |
|  Grant_type         | Истина         | Тип предоставления разрешения. По умолчанию используется значение `client_credentials`.                    |
|  Client_id          | Истина         |  Идентификатор клиента или приложения, связанный с приложением Azure AD.                  |
|  client_secret      | Истина         |  Пароль, связанный с приложением Azure AD.                               |
|  Ресурс           | Истина         |  Целевой ресурс, для которого запрашивается токен. По умолчанию используется значение `62d94f6c-d599-489b-a797-3e10e42fbe22`. |
|  |  |  |


*Ответ*

|  **Имя**  | **Тип**       |  **Описание**    |
| ---------- | -------------  | ------------------- |
| 200 ОК    | TokenResponse  | Запрос успешно выполнен   |
|  |  |  |

*TokenResponse*

Пример токена ответа.

``` json
  {
      "token_type": "Bearer",
      "expires_in": "3600",
      "ext_expires_in": "0",
      "expires_on": "15251…",
      "not_before": "15251…",
      "resource": "62d94f6c-d599-489b-a797-3e10e42fbe22",
      "access_token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6ImlCakwxUmNxemhpeTRmcHhJeGRacW9oTTJZayIsImtpZCI6ImlCakwxUmNxemhpeTRmcHhJeGRacW9oTTJZayJ9…"
  }               
```


## <a name="next-steps"></a>Дальнейшие действия

Теперь можно использовать приложение Azure AD защищены [SaaS реализации API версии 2](./pc-saas-fulfillment-api-v2.md).
