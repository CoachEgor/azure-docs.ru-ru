---
title: Известные проблемы/ограничения миграции с использованием гибридного режима
description: Узнайте об известных проблемах/ограничениях миграции с помощью службы миграции баз данных Azure в гибридном режиме.
services: database-migration
author: pochiraju
ms.author: rajpo
manager: craigg
ms.reviewer: craigg
ms.service: dms
ms.workload: data-services
ms.custom: mvc
ms.topic: article
ms.date: 02/20/2020
ms.openlocfilehash: aedc7ea3d778d52f6f348837430987568af188ef
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "77649608"
---
# <a name="known-issuesmigration-limitations-with-using-hybrid-mode"></a>Известные проблемы/ограничения миграции с использованием гибридного режима

Известные проблемы и ограничения, связанные с использованием службы миграции баз данных Azure в гибридном режиме, описаны в следующих разделах.

## <a name="installer-fails-to-authenticate"></a>Установщик не может проверить подлинность

После загрузки сертификата в AdApp, есть задержка до нескольких минут, прежде чем он может проверить подлинность с Azure. Установщик попытается повторить попытку с некоторой задержкой, но задержка распространения может быть длиннее, чем повторная попытка, и вы увидите **сообщение FailedToGetAccessTokenException.** Если сертификат был загружен в правильный AdApp и правильный AppId был предоставлен в dmsSettings.json, попробуйте запустить команду установки снова.

## <a name="service-offline-after-successful-installation"></a>Сервис "оффлайн" после успешной установки

Если служба показывает, как в автономном режиме после завершения процесса установки успешно, попробуйте использовать следующие шаги.

1. На портале Azure в экземпляре службы миграции базы данных Azure перейдите на вкладку **«Гибридные** настройки», а затем удостоверитесь, что работник зарегистрирован, проверяя сетку зарегистрированных работников.

    Статус этого работника должен быть **онлайн,** но он может отображаться как **оффлайн,** если есть проблемы.

2. На компьютере рабочего проверьте состояние службы, запустив следующую команду PowerShell:

    ```
    Get-Service Scenario*
    ```

    Эта команда дает вам статус службы Windows, работающего с работником. Должен быть только один результат. Если работник остановлен, можно попытаться перезапустить его, используя следующую команду PowerShell:

    ```
    Start-Service Scenario*
    ```

    Вы также можете проверить службу в ui служб ы windows Services.

3. Если циклы службы Windows между запуском и прекращением работы, то у рабочего возникли проблемы со запуском. Проверьте гибридные журналы работников службы миграции базы данных Azure, чтобы определить проблему.

    - Системы процесса установки хранятся в папке "журналы" в папке, из которой был запущен исполняемый установщик.
    - Гибридные журналы работы службы миграции Базы данных Azure хранятся в папке **«Рабочие журналы»** в папке, в которой установлен рабочий. Местоположение по умолчанию для гибридных файлов журнала рабочего работника является **C: »Файлы программы »DatabaseMigrationServiceHybrid»WorkerLogs**.

## <a name="using-your-own-signed-certificate"></a>Использование собственного подписанного сертификата

Сертификат, созданный действием GenerateCert, является сертификатом, подписанным самостоятельно, который может быть неприемлемым на основе внутренних политик безопасности. Вместо использования этого сертификата, вы можете предоставить свой собственный сертификат и предоставить отпечаток пальца в dmsSettings.json. Этот сертификат должен быть загружен в AdApp и установлен на компьютере, на котором вы устанавливаете гибридный работник миграционной службы Лазурного приложения. Затем установите этот сертификат с закрытым ключом в хранилище сертификатов Local Machine.

## <a name="running-the-worker-service-as-a-low-privilege-account"></a>Запуск службы работников в качестве учетной записи с низким уровнем привилегий

По умолчанию служба работы службы миграции базы данных Azure database работает как учетная запись локальной системы. Вы можете изменить учетную запись, используемую для этой службы, до тех пор, пока у используемой учетной записи есть сетевые разрешения. Чтобы изменить учетную запись "Запуск" службы, используйте следующий процесс.

1. Остановите службу либо с помощью служб windows, либо с помощью команды Stop-Service в PowerShell.

2. Обновление службы для использования другой учетной записи логона.

3. В certmgr для сертификатов локального компьютера, дать частные ключевые разрешения на новую учетную запись для **DMS Гибридный ключ app key** и **DMS сценарий двигателя ключ пара** сертификатов.

    а. Откройте certmgr для просмотра следующих клавиш:

    - DMS Гибридный ключ приложения
    - Ключ настройки гибридного рабочего работника DMS
    - DMS Сценарий двигателя ключ пара

    b. Право нажмите **на DMS Гибридный App Key** вступления, указать на все **задачи**, а затем выберите **Управление частными ключами**.

    c. На вкладке **безопасности** выберите **Добавить,** а затем введите имя учетной записи.

    d. Используйте те же шаги, чтобы предоставить разрешение на получение закрытого ключа для новой учетной записи сертификату **DMS Scenario Engine Key Pair.**

## <a name="unregistering-the-worker-manually"></a>Отменить регистрацию работника вручную

Если у вас больше нет доступа к компьютеру рабочего, можно отменить регистрацию работника и повторно использовать экземпляр службы миграции базы данных Azure, выполнив следующие действия:

1. На портале Azure перейдите на экземпляр службы миграции базы данных Azure, а затем перейдите на страницу **гибридных** настроек.

   Запись рабочего отображается в списке, а статус отображается как **оффлайн.**

2. В правом направлении объявления о вступлении работника выберите эллипсы, а затем выберите **Unregister.**

## <a name="addressing-issues-for-specific-migration-scenarios"></a>Решение вопросов для конкретных сценариев миграции

В приведенных ниже разделах описывались специфические проблемы, связанные с использованием гибридного режима службы миграции базы данных Azure для выполнения онлайн-миграции.

### <a name="online-migrations-to-azure-sql-database-managed-instance"></a>Онлайн-миграция в управляемый экземпляр базы данных Azure S'L

**Высокая загрузка ЦП**

**Проблема:** Для онлайн-миграций в управляемый экземпляр базы данных S'L компьютер, работающий с гибридным работником, столкнется с высоким использованием процессора, если резервное копирование слишком велико или резервное копирование слишком велико.

**Смягчение:** Чтобы смягчить эту проблему, используйте сжатые резервные копирования, разделите миграцию так, чтобы она использовала несколько акций, или масштабируйте компьютер, работающий с гибридным работником.
