---
title: Общая база данных Azure Synapse Analytics
description: Azure Synapse Analytics предоставляет общую модель метаданных, где создание базы данных в Apache Spark делает ее доступной из ядер SQL по запросу (предварительной версии) и пулов SQL.
services: synapse-analytics
author: MikeRys
ms.service: synapse-analytics
ms.topic: overview
ms.subservice: ''
ms.date: 04/15/2020
ms.author: mrys
ms.reviewer: jrasnick
ms.openlocfilehash: e3651467de86d3b026ab348675249f93ebf3a86a
ms.sourcegitcommit: b80aafd2c71d7366838811e92bd234ddbab507b6
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/16/2020
ms.locfileid: "81420218"
---
# <a name="azure-synapse-analytics-shared-database"></a>Общая база данных Azure Synapse Analytics

Azure Synapse Analytics позволяет различным вычислительным системам рабочих областей использовать базы данных и таблицы совместно с пулами Spark (предварительной версии), ядром SQL по запросу (предварительной версии) и пулами SQL.

[!INCLUDE [synapse-analytics-preview-terms](../../../includes/synapse-analytics-preview-terms.md)]

База данных, созданная с помощью задания Spark, станет видимой с одним и тем же именем для всех текущих и будущих пулов Spark (предварительной версии) в рабочей области, а также для ядра SQL по запросу.

Если в рабочей области есть пулы SQL со включенной синхронизацией метаданных или если вы создаете еще один пул SQL со включенной синхронизацией метаданных, эти базы данных, созданные Spark, автоматически сопоставляются со специальными схемами в базе данных пулов SQL. 

Каждая схема именуется по имени базы данных Spark с дополнительным префиксом `$`. Как внешние, так и управляемые таблицы в базе данных, созданной с помощью Spark, предоставляются в качестве внешней таблицы в соответствующей специальной схеме.

База данных Spark по умолчанию с именем `default` также будет отображаться в контексте SQL по запросу как база данных с именем `default` и в любой из баз данных пулов SQL со включенной синхронизацией метаданных в качестве схемы `$default`.

Базы данных синхронизируются с SQL по запросу и пулами SQL асинхронно, поэтому будет задержка, которая продлится до появления.

## <a name="manage-a-spark-created-database"></a>Управление созданной базой данных Spark

Используйте Spark для управления созданными в Spark базами данных. Например, можно удалить базу данных из задания пула Spark или создать в ней таблицы средствами Spark.

Если вы создадите объекты в созданной в Spark базе данных, используя SQL по требованию, или попытаетесь удалить базу данных, операция будет выполнена. Но исходная база данных Spark не изменится.

Если вы попытаетесь удалить синхронизированную схему в пуле SQL или создать в ней таблицу, Azure возвратит ошибку.

## <a name="handling-of-name-conflicts"></a>Обработка конфликтов имен

Если имя базы данных Spark конфликтует с именем существующей базы данных SQL по запросу, к имени базы данных Spark в SQL по требованию будет добавлен суффикс. Суффикс в SQL по запросу — `_<workspace name>-ondemand-DefaultSparkConnector`.

Например, если база данных Spark с именем `mydb` создается в рабочей области Azure Synapse `myws` и база данных SQL по запросу с таким именем уже существует, то в SQL по требованию будет добавлена ссылка на базу данных Spark с использованием имени `mydb_myws-ondemand-DefaultSparkConnector`.

> [!CAUTION]
> Внимание! Не допускайте зависимостей от такого поведения.

## <a name="security-model"></a>Модель безопасности

Базы данных и таблицы Spark вместе с синхронизированными представлениями в ядрах SQL будут защищены на базовом уровне хранилища.

Субъект безопасности, создающий базу данных, считается владельцем этой базы данных и имеет все права на нее и ее объекты.

Чтобы предоставить субъекту безопасности, такому как пользователь или группа безопасности, доступ к базе данных, предоставьте соответствующей папке и файлам POSIX соответствующие разрешения для папок и файлов в каталоге `warehouse`. 

Например, чтобы субъект безопасности мог читать таблицу в базе данных, все папки, начиная с папки базы данных в каталоге `warehouse`, должны иметь разрешения `X` и `R`, назначенные этому субъекту безопасности. Кроме того, для файлов (например, базовых файлов данных таблицы) требуются разрешения `R`. 

Если субъекту безопасности требуется возможность создавать или удалять объекты в базе данных, для папок и файлов в папке `warehouse` требуются дополнительные разрешения `W`.

## <a name="examples"></a>Примеры

### <a name="create--connect-to-spark-database---sql-on-demand"></a>Создание базы данных Spark и подключение к ней для SQL по запросу

Сначала создайте базу данных Spark с именем `mytestdb`, используя кластер Spark, который уже создан в рабочей области. Это можно сделать, например, с помощью записной книжки Spark C# со следующей инструкцией .NET для Spark:

```csharp
spark.Sql("CREATE DATABASE mytestdb")
```

После короткой задержки можно просмотреть базу данных из SQL по запросу. Для нашего примера выполните указанную ниже инструкцию из SQL по запросу.

```sql
SELECT * FROM sys.databases;
```

Убедитесь, что `mytestdb` есть в результатах.

### <a name="exposing-a-spark-database-in-a-sql-pool"></a>Предоставление базы данных Spark в пуле SQL

После создания базы данных в предыдущем примере создайте в рабочей области пул SQL с именем `mysqlpool`, который обеспечивает синхронизацию метаданных.

Выполните следующую инструкцию для пула SQL `mysqlpool`:

```sql
SELECT * FROM sys.schema;
```

Проверьте схему на наличие созданной базы данных в результатах.

## <a name="next-steps"></a>Дальнейшие действия

- Ознакомьтесь со статьей [Общие метаданные Azure Synapse Analytics](overview.md)
- Ознакомьтесь со статьей [Общие таблицы метаданных Azure Synapse Analytics](table.md)

<!-- - [Learn more about the Synchronization with SQL Analytics on-demand](overview.md)
- [Learn more about the Synchronization with SQL Analytics pools](overview.md)-->
