---
title: Рекомендации по рекомендациям по запросу (предварительный просмотр) в Azure Synapse Analytics
description: Рекомендации и рекомендации, которые вы должны знать, работая с S'L по требованию (предварительный просмотр).
services: synapse-analytics
author: mlee3gsd
manager: craigg
ms.service: synapse-analytics
ms.topic: conceptual
ms.subservice: ''
ms.date: 04/15/2020
ms.author: martinle
ms.reviewer: igorstan
ms.openlocfilehash: 1d4203141973c10fe7673f6ab9dedbc3bfdc8999
ms.sourcegitcommit: b80aafd2c71d7366838811e92bd234ddbab507b6
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/16/2020
ms.locfileid: "81429074"
---
# <a name="best-practices-for-sql-on-demand-preview-in-azure-synapse-analytics"></a>Рекомендации по рекомендациям по запросу (предварительный просмотр) в Azure Synapse Analytics

В этой статье вы найдете подборку рекомендаций по использованию S'L по требованию (предварительный просмотр). По требованию S'L является дополнительным ресурсом в Azure Synapse Analytics.

## <a name="general-considerations"></a>Общие рекомендации

По требованию S'L позволяет загоните файлы в учетных записях хранения Azure. Он не имеет возможности локального хранения или приема. Таким образом, все файлы, которые цели запроса являются внешними для S'L по требованию. Все, что связано с чтением файлов из хранилища, может повлиять на производительность запроса.

## <a name="colocate-azure-storage-account-and-sql-on-demand"></a>Переместите учетную запись хранения Azure и S'L по требованию

Чтобы свести к минимуму задержку, свиная учетная запись хранения Azure и конечная точка s'L по требованию. Учетные записи хранения данных и конечные точки, подготовленные при создании рабочего пространства, расположены в одном регионе.

Для оптимальной производительности, если вы получаете доступ к другим учетным записям хранения данных с помощью S'L по требованию, убедитесь, что они находятся в том же регионе. Если они не находятся в одном регионе, будет увеличена задержка передачи сети данных между удаленными и конечными областями.

## <a name="azure-storage-throttling"></a>Регулирование хранения azure

Несколько приложений и служб могут получить доступ к вашей учетной записи хранения. Регулирование хранилища происходит, когда комбинированные IOPS или пропускная мощность, генерируемые приложениями, службами и рабочей нагрузкой по требованию, превышают пределы учетной записи хранилища. В результате вы будете испытывать значительное негативное влияние на производительность запроса.

После обнаружения регулирования, S'L по требованию имеет встроенный в обработке этого сценария. По требованию S'L будет делать запросы на хранение более медленными темпами до тех пор, пока регулирование не будет решена.

> [!TIP]
> Для оптимального выполнения запроса не следует подчеркивать учетную запись хранилища другими рабочими нагрузками во время выполнения запроса.

## <a name="prepare-files-for-querying"></a>Подготовка файлов к запросу

Если это возможно, вы можете подготовить файлы для повышения производительности:

- Преобразование CSV в паркет - Паркет является форматом columnar. Так как он сжат, его размеры файлов меньше, чем CSV файлов с теми же данными. Для его прочтения потребуется меньше времени и запросов на хранение.
- Если запрос нацелен на один большой файл, вы получите выгоду от его разделения на несколько меньших файлов.
- Старайтесь держать размер файла CSV ниже 10 ГБ.
- Лучше иметь файлы одинакового размера для одного пути OPENROWSET или внешней таблицы LOCATION.
- Разделив данные путем хранения разделов на разные папки или имена файлов - проверьте [использование файловых имен и функций файлового пути для целевой целевой специфии.](#use-fileinfo-and-filepath-functions-to-target-specific-partitions)

## <a name="use-fileinfo-and-filepath-functions-to-target-specific-partitions"></a>Используйте функции fileinfo и filepath для таргетинга на конкретные разделы

Данные часто организуются в разделах. Вы можете поручить S'L по требованию задать запрос определенных папок и файлов. Эта функция уменьшит количество файлов и объем данных, необходимых для чтения и обработки запроса. Дополнительным бонусом является то, что вы достигнете лучшей производительности.

Для получения дополнительной информации проверьте [функции имени файла](develop-storage-files-overview.md#filename-function) и [файла](develop-storage-files-overview.md#filepath-function) и примеры того, как [запросить определенные файлы.](query-specific-files.md)

Если сохраненные данные не разделены, подумайте о его разделении, чтобы можно было использовать эти функции для оптимизации запросов, ориентированных на эти файлы. При [запросе разделенных таблиц Spark](develop-storage-files-spark-tables.md) из таблиц S'L по требованию запрос автоматически будет нацелен только на необходимые файлы.

## <a name="use-cetas-to-enhance-query-performance-and-joins"></a>Используйте CETAS для повышения производительности запроса и соединения

[CETAS](develop-tables-cetas.md) является одной из наиболее важных функций, доступных по требованию. CETAS — это параллельная операция, которая создает внешние метаданные таблицы и экспортирует результаты запроса SELECT в набор файлов в учетной записи хранилища.

CETAS можно использовать для хранения часто используемых частей запросов, таких как объединенные справочные таблицы, в новый набор файлов. Далее можно присоединиться к этой единой внешней таблице, а не повторять общие соединения в нескольких запросах.

По мере того как CETAS генерирует файлы паркета, статистика будет автоматически создаваться, когда первый запрос нацелен на эту внешнюю таблицу, что приведет к повышению производительности.

## <a name="next-steps"></a>Дальнейшие действия

Просмотрите статью [Troubleshooting](../sql-data-warehouse/sql-data-warehouse-troubleshoot.md?toc=/azure/synapse-analytics/toc.json&bc=/azure/synapse-analytics/breadcrumb/toc.json) для общих проблем и решений. Если вы работаете с пулом S'L, а не с S'L по требованию, пожалуйста, ознакомьтесь с рекомендациями по пулу [Для S'L](best-practices-sql-pool.md) для получения конкретных рекомендаций.
