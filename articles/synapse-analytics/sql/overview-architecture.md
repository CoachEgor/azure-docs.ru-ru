---
title: Архитектура Azure Synapse S'L
description: Узнайте, как Azure Synapse S'L сочетает в себе массовую параллельную обработку (MPP) с хранилищем Azure для достижения высокой производительности и масштабируемости.
services: synapse-analytics
author: mlee3gsd
manager: rothja
ms.service: synapse-analytics
ms.topic: conceptual
ms.subservice: ''
ms.date: 04/15/2020
ms.author: martinle
ms.reviewer: igorstan
ms.openlocfilehash: 570e84b3a545736aad6983c7f0d8c0f0296ca589
ms.sourcegitcommit: b80aafd2c71d7366838811e92bd234ddbab507b6
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/16/2020
ms.locfileid: "81431817"
---
# <a name="azure-synapse-sql-architecture"></a>Архитектура Azure Synapse S'L 

В этой статье описаны архитектурные компоненты Synapse S'L.

[!INCLUDE [preview](../includes/note-preview.md)]

## <a name="synapse-sql-architecture-components"></a>Компоненты архитектуры Synapse S'L

Synapse S'L использует архитектуру масштабирования для распределения вычислительной обработки данных по нескольким узлам. Вычисление отделено от хранилища, что позволяет масштабировать вычисления независимо от данных в вашей системе. 

Для пула S'L единица масштаба представляет собой абстракцию вычислительной мощности, которая известна как [единица хранилища данных.](resource-consumption-models.md) 

Для S'L по требованию, будучи без сервера, масштабирование выполняется автоматически с учетом требований к ресурсам запроса. По мере изменения топологии с течением времени путем добавления, удаления узлов или отказов, она адаптируется к изменениям и гарантирует, что ваш запрос имеет достаточно ресурсов и успешно завершается. Например, на рисунке ниже показаны си-Л по требованию, используя 4 вычислительных узла для выполнения запроса.

![Архитектура Synapse S'L](./media//overview-architecture/sql-architecture.png)

Synapse S'L использует архитектуру на основе узлов. Приложения соединяют и выдают команды T-S'L к узлам управления, который является единственной точкой входа для Synapse S'L. 

Узл управления пулом S'L использует движок MPP для оптимизации запросов для параллельной обработки, а затем передает операции вычислительным узлам, чтобы выполнять свою работу параллельно. 

Узл управления по требованию использует механизм распределенной обработки запросов (ДЗП) для оптимизации и организации распределенного исполнения пользовательского запроса путем разделения его на более мелкие запросы, которые будут выполняться на узлах Compute. Каждый небольшой запрос называется задачой и представляет собой блок распределенного исполнения. Он считывает файл (ы) из хранилища, объединяет результаты других задач, групп или заказов данных, извлеченных из других задач. 

Вычислительные узлы хранят все данные пользователей в службе хранилища Azure и выполняют параллельные запросы. Служба перемещения данных (DMS) представляет собой внутреннюю службу на уровне системы, которая перемещает данные между узлами, что необходимо для выполнения параллельных запросов и возвращения точных результатов. 

При разъединении системы хранения и вычислениях при использовании Synapse S'L можно извлечь выгоду из независимого размера вычислительной мощности независимо от ваших потребностей в хранении. Для масштабирования по требованию S'L выполняется автоматически, в то время как для бассейна S'L можно:

* Выращивайте или сокращайте вычислительную мощность в пуле S'L (хранилище данных), не перемещая данные.
* приостановка вычислений без изменения данных (вы платите только за хранилище);
* возобновление вычислений во время рабочих часов.

## <a name="azure-storage"></a>Хранилище Azure

Synapse S'L использует хранилище Azure, чтобы сохранить ваши пользовательские данные в безопасности. Поскольку ваши данные хранятся и управляются Azure Storage, для потребления хранилища взимается отдельная плата. 

По требованию S'L позволяет заготавливать файлы в озере данных только в режиме чтения, в то время как пул S'L также позволяет глотать данные. При попадании данных в пул S'L данные врезаются в **дистрибутивы** для оптимизации производительности системы. При определении таблицы вы можете выбрать шаблон сегментирования, который будет использоваться для распределения данных. Эти осколки поддерживаются:

* Хэш
* Циклический перебор
* Репликация

## <a name="control-node"></a>Управляющий узел

Контрольный узла является мозгом архитектуры. Это внешний интерфейс, который взаимодействует со всеми приложениями и подключениями. 

В пуле S'L движок MPP работает на узле управления для оптимизации и координации параллельных запросов. При отправке запроса T-S'L в пул S'L узло управления преобразует его в запросы, которые параллельно работают с каждым распределением.

В s'L по требованию движок D'P работает на узло управления для оптимизации и координации распределенного выполнения пользовательского запроса путем разделения его на более мелкие запросы, которые будут выполняться на узлах Compute. Он также назначает наборы файлов для обработки каждым узлам.

## <a name="compute-nodes"></a>Вычислительные узлы

Вычислительные узлы обеспечивают вычислительную мощность. 

В пуле S'L дистрибутивы отображаемые до распределительных узлов для обработки. По мере того как вы платите за больше вычислительных ресурсов, пул переотображает дистрибутивы к имеющимся узлам Compute. Количество вычислительных узлов колеблется от 1 до 60 и определяется уровнем обслуживания пула S'L. У каждого вычислительного узла есть идентификатор узла, который видно в представлениях системы. Идентификатор вычислительного узла можно увидеть в столбце node_id в системных представлениях, имена которых начинаются с sys.pdw_nodes. Список системных представлений см. в [системном представлении MPP](/sql/relational-databases/system-catalog-views/sql-data-warehouse-and-parallel-data-warehouse-catalog-views?view=azure-sqldw-latest).

В S'L по требованию каждому узелу Compute назначается задача и набор файлов для выполнения задачи. Задача — это распределенная единица выполнения запроса, которая фактически является частью отправки пользователя запроса. Автоматическое масштабирование действует, чтобы убедиться, что достаточно вычислительных узлов используются для выполнения запроса пользователя.

## <a name="data-movement-service"></a>Служба перемещения данных

Служба перемещения данных (DMS) — это технология передачи данных в пуле S'L, которая координирует перемещение данных между вычислительными узлами. Некоторым запросам требуется перемещение данных, чтобы параллельные запросы вернули точные результаты. При необходимости перемещения данных DMS гарантирует, что нужные данные окажутся в нужном расположении.

> [!VIDEO https://www.youtube.com/embed/PlyQ8yOb8kc]

## <a name="distributions"></a>Дистрибутивы

Распределение является основной единицей хранения и обработки параллельных запросов, которые работают на распределенных данных в пуле S'L. При запуске запроса в пуле S'L работа делится на 60 меньших запросов, которые работают параллельно. 

Каждый из этих 60 небольших запросов выполняется в одном из распределений данных. Каждый вычислительный узел управляет одним или несколькими из 60 распределений. Пул с максимальным объемом вычислительных ресурсов имеет одно распределение на вычислительный узл. Пул с минимальными вычислительными ресурсами имеет все дистрибутивы на одном вычислительном узлах. 

## <a name="hash-distributed-tables"></a>Таблицы с хэш-распределением
С помощью распределенной хэш-таблицы можно обеспечить наибольшую производительность запроса для операций объединения и агрегирования для больших таблиц. 

Для того чтобы осколки данных в таблицу распределения хэш-распределенных данных, пул S'L использует функцию хэша для детерминированного присвоения каждой строке одному распределению. В определении таблицы один из столбцов определяется как столбец распределения. Хэш-функция использует значения в столбце распределения для присвоения каждой строки распределению.

На следующей схеме показано, как полная (нераспределенная) таблица хранится в качестве хэш-распределенной. 

![Распределенная таблица](media//overview-architecture/hash-distributed-table.png "Распределенная таблица") 

* Каждая строка относится к одному распределению. 
* Детерминированный хэш-алгоритм присваивает каждую строку одному распределению. 
* Количество строк таблицы в распределении зависит от размеров таблиц (как показано на схеме).

Существуют влияющие на производительность факторы, которые учитываются при выборе столбца распределения. Например, определенность, неравномерное смещение данных и типы запросов, выполняемых в системе.

## <a name="round-robin-distributed-tables"></a>Таблицы с распределением методом циклического перебора

Таблица с распределением методом циклического перебора — это самая простая таблица для создания и обеспечения высокой производительности, если ее использовать как промежуточную таблицу для нагрузок.

В таблице с распределением методом циклического перебора данные распределяются равномерно, но без какой-либо последующей оптимизации. Распределение сначала выбирается случайным образом, а затем буферы строк назначаются распределениям последовательно. Вы можете быстро загрузить данные в таблицу с распределением методом циклического перебора, но производительность запроса будет лучше, если использовать распределенные хэш-таблицы. Соединения на круглых столах требуют перетасовки данных, что требует дополнительного времени.

## <a name="replicated-tables"></a>Реплицированные таблицы
Реплицированная таблица обеспечивает наилучшую производительность запросов для небольших таблиц.

Полная копия реплицированной таблицы хранится на каждом вычислительном узле. В результате репликация таблицы устраняет необходимость передавать данные между вычислительными узлами перед операциями соединения или агрегирования. Реплицированные таблицы лучше всего использовать для небольших таблиц. Требуется дополнительное хранилище и дополнительные накладные расходы, которые возникает при написании данных, что делает большие таблицы непрактичными. 

На приведенной ниже диаграмме показана реплицированная таблица, кэшированная на первом распределении на каждом вычислительном узлах. 

![Реплицированная таблица](media/overview-architecture/replicated-table.png "Реплицированная таблица") 

## <a name="next-steps"></a>Дальнейшие действия

Теперь, когда вы знаете немного о Synapse S'L, узнайте, как быстро [создать пул S'L](../quickstart-create-sql-pool.md) и [загрузить выборочные данные](../sql-data-warehouse/sql-data-warehouse-load-from-azure-blob-storage-with-polybase.md) (./sql-data-warehouse-load-sample-databases.md). Или вы [начинаете использовать S'L по требованию.](../quickstart-sql-on-demand.md) Если вы раньше не работали с Azure, используйте [глоссарий Azure](../../azure-glossary-cloud-terminology.md), чтобы узнать значение новых терминов. 
