---
title: Архитектура Azure Synapse Analytics (ранее — Хранилище данных SQL)
description: Узнайте, как в Azure Synapse Analytics (ранее — Хранилище данных SQL) с помощью массового параллелизма (MPP) и возможностей хранилища Azure можно достичь высокой производительности и масштабируемости.
services: synapse-analytics
author: mlee3gsd
manager: craigg
ms.service: synapse-analytics
ms.topic: conceptual
ms.subservice: sql-dw
ms.date: 11/04/2019
ms.author: martinle
ms.reviewer: igorstan
ms.openlocfilehash: cde6cb514b6f87315400b3c40d8b86bcb7ff0adb
ms.sourcegitcommit: 877491bd46921c11dd478bd25fc718ceee2dcc08
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/02/2020
ms.locfileid: "85210972"
---
# <a name="azure-synapse-analytics-formerly-sql-dw-architecture"></a>Архитектура Azure Synapse Analytics (ранее — Хранилище данных SQL)

Azure Synapse — это служба аналитики без ограничений, которая объединяет корпоративные хранилища данных и аналитику больших данных. Служба позволяет вам запрашивать данные на своих условиях, используя бессерверные ресурсы по запросу или подготовленные ресурсы в любом масштабе. Azure Synapse объединяет эти две возможности вместе, предоставляя единый интерфейс для приема, подготовки, контроля и обслуживания данных для насущных потребностей бизнес-аналитики и машинного обучения.

 В Azure Synapse есть четыре компонента.

- SQL Synapse: Выполнение аналитики на основе T-SQL

  - Пул SQL (оплата за DWU по мере подготовки) — общедоступная версия
  - SQL по запросу (оплата за обработанные ТБ) — (Предварительная версия)
- Spark. Глубокая интегрированная Apache Spark (предварительная версия)
- Интеграция данных. Гибридная интеграция данных (предварительная версия)
- Studio: унифицированное взаимодействие с пользователем.  (предварительная версия)

> [!VIDEO https://www.youtube.com/embed/PlyQ8yOb8kc]

## <a name="synapse-sql-mpp-architecture-components"></a>Компоненты архитектуры Synapse SQL MPP

[Synapse SQL](sql-data-warehouse-overview-what-is.md#synapse-sql-pool-in-azure-synapse) использует архитектуру с горизонтальным увеличением масштаба для распределения вычислительной обработки данных на нескольких узлах. Единица масштабирования представляет собой абстракцию вычислительной мощности, известную как [единица использования хранилища данных](what-is-a-data-warehouse-unit-dwu-cdwu.md). Вычислительные ресурсы отделены от ресурсов хранилища, что дает возможность масштабировать вычислительные ресурсы независимо от данных в системе.

![Архитектура Synapse SQL](./media/massively-parallel-processing-mpp-architecture/massively-parallel-processing-mpp-architecture.png)

В Synapse SQL используется архитектура на основе узлов. Приложения подключаются к управляющему узлу и выполняют команды T-SQL. Этот узел представляет собой единую точку входа для Synapse SQL. Управляющий узел запускает механизм MPP, который оптимизирует запросы для параллельной обработки, а затем перенаправляет операции на вычислительные узлы, чтобы обеспечить параллельную работу.

Вычислительные узлы хранят все данные пользователей в службе хранилища Azure и выполняют параллельные запросы. Служба перемещения данных (DMS) представляет собой внутреннюю службу на уровне системы, которая перемещает данные между узлами, что необходимо для выполнения параллельных запросов и возвращения точных результатов.

Благодаря отделению ресурсов хранилища от вычислительных ресурсов использование пула Synapse SQL обеспечивает следующие возможности:

- определение объема вычислительных ресурсов независимого от потребностей хранилища;
- увеличение или уменьшение вычислительной мощности в пуле SQL (хранилище данных) без перемещения данных;
- приостановка вычислений без изменения данных (вы платите только за хранилище);
- возобновление вычислений во время рабочих часов.

### <a name="azure-storage"></a>Хранилище Azure

В Synapse SQL используется служба хранилища Azure для безопасного хранения данных пользователя.  Так как ваши данные хранятся в службе хранилища Azure и управляются ею, предусмотрена отдельная плата за использование хранилища. Для оптимизации производительности системы данные сегментированы по **областям распределения**. При определении таблицы вы можете выбрать шаблон сегментирования, который будет использоваться для распределения данных. Поддерживаются следующие шаблоны сегментирования:

- Хэш
- Циклический перебор
- Репликация

### <a name="control-node"></a>Управляющий узел

Управляющий узел в этой архитектуре отвечает за все решения. Это внешний интерфейс, который взаимодействует со всеми приложениями и подключениями. Механизм MPP запускается на управляющем узле, чтобы оптимизировать и координировать параллельные запросы. При отправке запроса T-SQL управляющий узел преобразует его в запросы, которые будут выполняться на каждом вычислительном узле в параллельном режиме.

### <a name="compute-nodes"></a>Вычислительные узлы

Вычислительные узлы обеспечивают вычислительную мощность. Чтобы выполнить обработку, дистрибутивы сопоставляются с вычислительными узлами. Когда вы оплачиваете увеличение вычислительных ресурсов, распределения повторно сопоставляются с доступными вычислительными узлами. Число вычислительных узлов колеблется от 1 до 60 и определяется уровнем обслуживания Synapse SQL.

У каждого вычислительного узла есть идентификатор узла, который видно в представлениях системы. Идентификатор вычислительного узла можно увидеть в столбце node_id в системных представлениях, имена которых начинаются с sys.pdw_nodes. Список системных представлений см. в [системном представлении MPP](/sql/relational-databases/system-catalog-views/sql-data-warehouse-and-parallel-data-warehouse-catalog-views?toc=/azure/synapse-analytics/sql-data-warehouse/toc.json&bc=/azure/synapse-analytics/sql-data-warehouse/breadcrumb/toc.json&view=azure-sqldw-latest).

### <a name="data-movement-service"></a>Служба перемещения данных

Служба перемещения данных (DMS) — это технология перемещения данных, которая координирует перемещение данных между вычислительными узлами. Некоторым запросам требуется перемещение данных, чтобы параллельные запросы вернули точные результаты. При необходимости перемещения данных DMS гарантирует, что нужные данные окажутся в нужном расположении.

## <a name="distributions"></a>Дистрибутивы

Распределение представляет собой базовую единицу хранения и обработки параллельных запросов, выполняемых для распределенных данных. При выполнении запроса в Synapse SQL формируются 60 небольших запросов, которые выполняются параллельно.

Каждый из этих 60 небольших запросов выполняется в одном из распределений данных. Каждый вычислительный узел управляет одним или несколькими из 60 распределений. Пул SQL с максимальным количеством вычислительных ресурсов содержит одно распределение на каждом вычислительном узле. Пул SQL с минимальным количеством вычислительных ресурсов содержит все распределения на одном вычислительном узле.  

## <a name="hash-distributed-tables"></a>Таблицы с хэш-распределением

С помощью распределенной хэш-таблицы можно обеспечить наибольшую производительность запроса для операций объединения и агрегирования для больших таблиц.

Чтобы сегментировать данные в распределенную хэш-таблицу, используется хэш-функция для детерминированного назначения каждой строки отдельному распределению. В определении таблицы один из столбцов определяется как столбец распределения. Хэш-функция использует значения в столбце распределения для присвоения каждой строки распределению.

На следующей схеме показано, как полная (нераспределенная) таблица хранится в качестве хэш-распределенной.

![Распределенная таблица](./media/massively-parallel-processing-mpp-architecture/hash-distributed-table.png "Распределенная таблица")  

- Каждая строка относится к одному распределению.  
- Детерминированный хэш-алгоритм присваивает каждую строку одному распределению.  
- Количество строк таблицы в распределении зависит от размеров таблиц (как показано на схеме).

Существуют влияющие на производительность факторы, которые учитываются при выборе столбца распределения. Например, определенность, неравномерное смещение данных и типы запросов, выполняемых в системе.

## <a name="round-robin-distributed-tables"></a>Таблицы с распределением методом циклического перебора

Таблица с распределением методом циклического перебора — это самая простая таблица для создания и обеспечения высокой производительности, если ее использовать как промежуточную таблицу для нагрузок.

В таблице с распределением методом циклического перебора данные распределяются равномерно, но без какой-либо последующей оптимизации. Распределение сначала выбирается случайным образом, а затем буферы строк назначаются распределениям последовательно. Вы можете быстро загрузить данные в таблицу с распределением методом циклического перебора, но производительность запроса будет лучше, если использовать распределенные хэш-таблицы. Для объединения таблиц с распределением методом циклического перебора требуется перегруппировка данных, что требует дополнительного времени.

## <a name="replicated-tables"></a>Реплицированные таблицы

Реплицированная таблица обеспечивает наилучшую производительность запросов для небольших таблиц.

Полная копия реплицированной таблицы хранится на каждом вычислительном узле. В результате репликация таблицы устраняет необходимость передавать данные между вычислительными узлами перед операциями соединения или агрегирования. Реплицированные таблицы лучше всего использовать для небольших таблиц. При записи данных требуются дополнительное хранилище и дополнительные расходы, что делает использование больших таблиц нецелесообразным.  

На следующей схеме представлена реплицированная таблица, которая кэшируется при первом распределении на каждом вычислительном узле.  

![Реплицированная таблица](./media/massively-parallel-processing-mpp-architecture/replicated-table.png "Реплицированная таблица")

## <a name="next-steps"></a>Дальнейшие действия

Теперь, когда вы немного ознакомились с Azure Synapse, узнайте о том, как быстро [создать пул SQL](create-data-warehouse-portal.md) и [загрузить демонстрационные данные](load-data-from-azure-blob-storage-using-polybase.md). Если вы раньше не работали с Azure, используйте [глоссарий Azure Глоссарий](../../azure-glossary-cloud-terminology.md?toc=/azure/synapse-analytics/sql-data-warehouse/toc.json&bc=/azure/synapse-analytics/sql-data-warehouse/breadcrumb/toc.json) , чтобы узнать значение новых терминов. Или ознакомьтесь со следующими ресурсами, посвященными Azure Synapse.  

- [Истории успеха клиентов](https://azure.microsoft.com/case-studies/?service=sql-data-warehouse)
- [Блоги](https://azure.microsoft.com/blog/tag/azure-sql-data-warehouse/)
- [Запросы функций](https://feedback.azure.com/forums/307516-sql-data-warehouse)
- [Видео](https://azure.microsoft.com/documentation/videos/index/?services=sql-data-warehouse)
- [Создание запроса в службу поддержки](sql-data-warehouse-get-started-create-support-ticket.md)
- [Раздел вопросов и ответов на сайте Майкрософт](https://docs.microsoft.com/answers/topics/azure-synapse-analytics.html)
- [Форум Stack Overflow](https://stackoverflow.com/questions/tagged/azure-sqldw)
- [Twitter](https://twitter.com/hashtag/SQLDW)
