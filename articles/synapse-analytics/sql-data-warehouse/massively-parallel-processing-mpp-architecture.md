---
title: Архитектура Azure синапсе Analytics (ранее — хранилище данных SQL)
description: Узнайте, как Azure синапсе Analytics (ранее — хранилище данных SQL) сочетает в себе массовую параллельную обработку (MPP) с хранилищем Azure для достижения высокой производительности и масштабируемости.
services: synapse-analytics
author: mlee3gsd
manager: craigg
ms.service: synapse-analytics
ms.topic: conceptual
ms.subservice: ''
ms.date: 11/04/2019
ms.author: martinle
ms.reviewer: igorstan
ms.openlocfilehash: d204477818ce2733d9f6d1e3dcc7455018456bcb
ms.sourcegitcommit: 849bb1729b89d075eed579aa36395bf4d29f3bd9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2020
ms.locfileid: "80884838"
---
# <a name="azure-synapse-analytics-formerly-sql-dw-architecture"></a>Архитектура Azure синапсе Analytics (ранее — хранилище данных SQL)

Azure Synapse — это служба аналитики без ограничений, которая объединяет корпоративные хранилища данных и аналитику больших данных. Служба позволяет вам запрашивать данные на своих условиях, используя бессерверные ресурсы по запросу или подготовленные ресурсы в любом масштабе. Azure Synapse объединяет эти две возможности вместе, предоставляя единый интерфейс для приема, подготовки, контроля и обслуживания данных для насущных потребностей бизнес-аналитики и машинного обучения.

 В Azure Synapse есть четыре компонента.

- Аналитика SQL: полная аналитика на основе T-SQL

  - Пул SQL (оплата по DWU подготовлен) — общедоступная версия
  - SQL по запросу (оплата за обработанные ТБ) — (Предварительная версия)
- Spark. Глубокая интегрированная Apache Spark (предварительная версия)
- Интеграция данных. Гибридная интеграция данных (предварительная версия)
- Studio: унифицированное взаимодействие с пользователем.  (предварительная версия)

> [!VIDEO https://www.youtube.com/embed/PlyQ8yOb8kc]

## <a name="synapse-sql-mpp-architecture-components"></a>Компоненты архитектуры SQL MPP синапсе

[СИНАПСЕ SQL](sql-data-warehouse-overview-what-is.md#synapse-sql-pool-in-azure-synapse) использует архитектуру масштабирования для распределения вычислительной обработки данных между несколькими узлами. Единица масштабирования представляет собой абстракцию вычислений, которая называется [единицей хранилища данных](what-is-a-data-warehouse-unit-dwu-cdwu.md). Расчеты отделены от хранилища, что позволяет масштабировать вычисление независимо от данных в системе.

![Архитектура Synapse SQL](./media/massively-parallel-processing-mpp-architecture/massively-parallel-processing-mpp-architecture.png)

В SQL Analytics используется архитектура на основе узлов. Приложения подключаются и выдают команды T-SQL управляющему узлу, который является единственной точкой входа для SQL Analytics. Управляющий узел запускает подсистему MPP, которая оптимизирует запросы для параллельной обработки, а затем передает операции вычислительным узлам для параллельной работы.

Вычислительные узлы хранят все данные пользователей в службе хранилища Azure и выполняют параллельные запросы. Служба перемещения данных (DMS) представляет собой внутреннюю службу на уровне системы, которая перемещает данные между узлами, что необходимо для выполнения параллельных запросов и возвращения точных результатов.

В случае с несвязанным хранилищем и вычислением при использовании пула SQL синапсе один может:

- определение объема вычислительных ресурсов независимого от потребностей хранилища;
- Увеличение или уменьшение мощности вычислений в пуле SQL (хранилище данных) без перемещения данных.
- приостановка вычислений без изменения данных (вы платите только за хранилище);
- возобновление вычислений во время рабочих часов.

### <a name="azure-storage"></a>Хранилище Azure

Синапсе SQL использует службу хранилища Azure для защиты данных пользователей.  Так как ваши данные хранятся и управляются службой хранилища Azure, за использование хранилища взимается отдельная плата. Данные сегментированы на **распределения** , чтобы оптимизировать производительность системы. При определении таблицы вы можете выбрать шаблон сегментирования, который будет использоваться для распределения данных. Поддерживаются следующие шаблоны сегментирования:

- Хэш
- Циклический перебор
- Репликация

### <a name="control-node"></a>Управляющий узел

Управляющий узел является мозгом архитектуры. Это внешний интерфейс, который взаимодействует со всеми приложениями и подключениями. Механизм MPP запускается на управляющем узле, чтобы оптимизировать и координировать параллельные запросы. При отправке запроса T-SQL управляющий узел преобразует его в запросы, выполняемые для каждого распределения параллельно.

### <a name="compute-nodes"></a>Вычислительные узлы

Вычислительные узлы обеспечивают вычислительную мощность. Чтобы выполнить обработку, дистрибутивы сопоставляются с вычислительными узлами. По мере оплаты за дополнительные ресурсы вычислений распределения передаются в доступные расчетные узлы. Число расчетных узлов в диапазоне от 1 до 60 и определяется уровнем обслуживания для синапсе SQL.

У каждого вычислительного узла есть идентификатор узла, который видно в представлениях системы. Идентификатор вычислительного узла можно увидеть в столбце node_id в системных представлениях, имена которых начинаются с sys.pdw_nodes. Список системных представлений см. в [системном представлении MPP](/sql/relational-databases/system-catalog-views/sql-data-warehouse-and-parallel-data-warehouse-catalog-views?toc=/azure/synapse-analytics/sql-data-warehouse/toc.json&bc=/azure/synapse-analytics/sql-data-warehouse/breadcrumb/toc.json&view=azure-sqldw-latest).

### <a name="data-movement-service"></a>Служба перемещения данных

Служба перемещения данных (DMS) — это технология перемещения данных, которая координирует перемещение данных между вычислительными узлами. Некоторым запросам требуется перемещение данных, чтобы параллельные запросы вернули точные результаты. При необходимости перемещения данных DMS гарантирует, что нужные данные окажутся в нужном расположении.

## <a name="distributions"></a>Дистрибутивы

Распределение представляет собой базовую единицу хранения и обработки параллельных запросов, выполняемых для распределенных данных. Когда SQL Analytics выполняет запрос, работа делится на 60 небольших запросов, выполняемых параллельно.

Каждый из этих 60 небольших запросов выполняется в одном из распределений данных. Каждый вычислительный узел управляет одним или несколькими из 60 распределений. Пул SQL с максимальными ресурсами вычислений имеет по одному распределению на каждый узел вычислений. Пул SQL с минимальными ресурсами вычислений имеет все распределения на одном кластерном узле.  

## <a name="hash-distributed-tables"></a>Таблицы с хэш-распределением

С помощью распределенной хэш-таблицы можно обеспечить наибольшую производительность запроса для операций объединения и агрегирования для больших таблиц.

Для сегментирования данных в таблицу, распределенную по хэш-коду, используется хэш-функция для детерминированного назначения каждой строки одному распределению. В определении таблицы один из столбцов определяется как столбец распределения. Хэш-функция использует значения в столбце распределения для присвоения каждой строки распределению.

На следующей схеме показано, как полная (нераспределенная) таблица хранится в качестве хэш-распределенной.

![Распределенная таблица](./media/massively-parallel-processing-mpp-architecture/hash-distributed-table.png "Распределенная таблица")  

- Каждая строка относится к одному распределению.  
- Детерминированный хэш-алгоритм присваивает каждую строку одному распределению.  
- Количество строк таблицы в распределении зависит от размеров таблиц (как показано на схеме).

Существуют влияющие на производительность факторы, которые учитываются при выборе столбца распределения. Например, определенность, неравномерное смещение данных и типы запросов, выполняемых в системе.

## <a name="round-robin-distributed-tables"></a>Таблицы с распределением методом циклического перебора

Таблица с распределением методом циклического перебора — это самая простая таблица для создания и обеспечения высокой производительности, если ее использовать как промежуточную таблицу для нагрузок.

В таблице с распределением методом циклического перебора данные распределяются равномерно, но без какой-либо последующей оптимизации. Распределение сначала выбирается случайным образом, а затем буферы строк назначаются распределениям последовательно. Вы можете быстро загрузить данные в таблицу с распределением методом циклического перебора, но производительность запроса будет лучше, если использовать распределенные хэш-таблицы. Для соединений с таблицами с циклическим перебором требуются данные перегруппировка, что занимает дополнительное время.

## <a name="replicated-tables"></a>Реплицированные таблицы

Реплицированная таблица обеспечивает наилучшую производительность запросов для небольших таблиц.

Полная копия реплицированной таблицы хранится на каждом вычислительном узле. В результате репликация таблицы устраняет необходимость передавать данные между вычислительными узлами перед операциями соединения или агрегирования. Реплицированные таблицы лучше всего использовать для небольших таблиц. Требуется дополнительное хранилище, и при записи данных возникают дополнительные издержки, которые делают большие таблицы непрактичными.  

На приведенной ниже схеме показана реплицированная таблица, которая кэшируется в первом распределении на каждом из этих кластерных узлов.  

![Реплицированная таблица](./media/massively-parallel-processing-mpp-architecture/replicated-table.png "Реплицированная таблица")

## <a name="next-steps"></a>Дальнейшие шаги

Теперь, когда вы уже знакомы с Azure синапсе, Узнайте, как быстро [создать пул SQL](create-data-warehouse-portal.md) и [загрузить демонстрационные данные](load-data-from-azure-blob-storage-using-polybase.md). Если вы раньше не работали с Azure, используйте [глоссарий Azure](../../azure-glossary-cloud-terminology.md?toc=/azure/synapse-analytics/sql-data-warehouse/toc.json&bc=/azure/synapse-analytics/sql-data-warehouse/breadcrumb/toc.json), чтобы узнать значение новых терминов. Или просмотрите некоторые из этих ресурсов Azure синапсе.  

- [Истории успеха клиентов](https://azure.microsoft.com/case-studies/?service=sql-data-warehouse)
- [Блоги](https://azure.microsoft.com/blog/tag/azure-sql-data-warehouse/)
- [Запросы функций](https://feedback.azure.com/forums/307516-sql-data-warehouse)
- [Видео](https://azure.microsoft.com/documentation/videos/index/?services=sql-data-warehouse)
- [Создание запроса в службу поддержки](sql-data-warehouse-get-started-create-support-ticket.md)
- [Форум MSDN](https://social.msdn.microsoft.com/Forums/azure/home?forum=AzureSQLDataWarehouse)
- [Форум Stack Overflow](https://stackoverflow.com/questions/tagged/azure-sqldw)
- [Twitter](https://twitter.com/hashtag/SQLDW)
