---
title: Управляемость и мониторинг - активность запросов, использование ресурсов
description: Узнайте, какие возможности доступны для управления и мониторинга Azure Synapse Analytics. Используйте портал Azure и динамические административные представления (DMV), чтобы понять действия запросов и использование ресурсов хранилища данных.
services: synapse-analytics
author: kevinvngo
manager: craigg-msft
ms.service: synapse-analytics
ms.topic: conceptual
ms.subservice: ''
ms.date: 03/11/2020
ms.author: kevin
ms.reviewer: jrasnick
ms.custom: azure-synapse
ms.openlocfilehash: 85457b62c905cb30ca22264eff1b6c677473f9b9
ms.sourcegitcommit: bd5fee5c56f2cbe74aa8569a1a5bce12a3b3efa6
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/06/2020
ms.locfileid: "80745303"
---
# <a name="monitoring-resource-utilization-and-query-activity-in-azure-synapse-analytics"></a>Мониторинг использования ресурсов и активности запросов в Azure Synapse Analytics

Azure Synapse Analytics предоставляет богатый опыт мониторинга в портале Azure для анализа рабочей нагрузки хранилища данных. Портал Azure — рекомендуемый инструмент мониторинга хранилища данных, так как он предоставляет настраиваемые периоды хранения, оповещения, рекомендации, индивидуальные диаграммы и панели мониторинга для метрик и журналов. Портал также позволяет интегрироваться с другими службами мониторинга Azure, такими как Azure Monitor (журналы) с аналитикой журнала, чтобы обеспечить целостный опыт мониторинга не только для вашего хранилища данных, но и для всей вашей платформы аналитики Azure для интегрированного мониторинга. В этой документации описывается, какие возможности мониторинга доступны для оптимизации и управления платформой аналитики с помощью S'L Analytics.

## <a name="resource-utilization"></a>Использование ресурсов

Следующие метрики доступны на портале Azure для аналитики S'L. Эти метрики отслеживаются с помощью [Azure Monitor](../../azure-monitor/platform/data-collection.md?toc=/azure/synapse-analytics/sql-data-warehouse/toc.json&bc=/azure/synapse-analytics/sql-data-warehouse/breadcrumb/toc.json#metrics).

| Имя метрики             | Описание                                                  | Тип статистической обработки |
| ----------------------- | ------------------------------------------------------------ | ---------------- |
| Процент использования ЦП          | Загрузка ЦП во всех узлах хранилища данных      | Авг, Мин, Макс    |
| Процент операций ввода/вывода данных      | Использование операций ввода-вывода во всех узлах хранилища данных       | Авг, Мин, Макс    |
| Процент памяти       | Использование памяти (сервер S'L) во всех узлах для хранилища данных | Авг, Мин, Макс   |
| Активные запросы          | Количество активных запросов, исполняемых в системе             | SUM              |
| Запросы в очереди          | Количество запросов в очереди, ожидающих начала выполнения          | SUM              |
| Успешные подключения  | Количество успешных подключений к данным                 | Сумма, граф       |
| Неудачные подключения      | Количество неудачных попыток подключения к хранилищу данных           | Сумма, граф       |
| Заблокировано брандмауэром     | Количество заблокированных операций входа в хранилище данных     | Сумма, граф       |
| Лимит DWU               | Целевой уровень обслуживания хранилища данных                | Авг, Мин, Макс    |
| DWU percentage          | Максимальная разница между процентом использования ЦП и процентом операций ввода-вывода данных        | Авг, Мин, Макс    |
| DWU used                | Лимит DWU * процент DWU                                   | Авг, Мин, Макс    |
| Cache hit percentage (Процент попаданий в кэш)    | (попадания в кэш / промахи кэша) * 100, где попадания в кэш — это сумма всех попаданий сегментов columnstore в локальный кэш SSD, а промах кэша — это промахи сегментов columnstore в локальный кэш SSD, суммированные по всем узлам | Авг, Мин, Макс    |
| Cache used percentage (Процент использования кэша)   | (кэш использований / кэш емкости) * 100, где кэш использований представляет собой сумму всех байтов в локальном кэше SSD на всех узлах, а кэш емкости — сумму объема локального диска SSD, кэшированную на всех узлах. | Авг, Мин, Макс    |
| Local tempdb percentage (Процент использования локальной базы данных tempdb) | Использование локальной базы данных tempdb на всех вычислительных узлах (значения генерируются каждые пять минут) | Авг, Мин, Макс    |
| Размер хранилища данных (GB) | Общий размер данных, загруженных в базу данных. Это включает данные, в которых находятся в таблицах ТПП и не-ТПП, где размер таблиц, не относящейся к ТКИ, измеряется общим размером файла базы данных | SUM |
| Размер аварийного восстановления (GB) | Общий размер гео-резервного копирования, взятого каждые 24 часа | SUM |
| Размер хранения моментального снимка (GB) | Общий размер моментальных снимков, сделанных для обеспечения точек восстановления базы данных. Это включает в себя автоматические и пользовательские моментальные снимки. | SUM |

Что следует учитывать при просмотре метрик и настройке оповещений:

- Используемый DWU представляет собой лишь **высокоуровневое представление использования** в пуле S'L и не является всеобъемлющим индикатором использования. Чтобы определить, следует ли масштабировать вверх или вниз, рассмотрим все факторы, которые могут быть затронуты DWU, такие как параллелизм, память, tempdb, и адаптивная емкость кэша. Мы рекомендуем [выполнять рабочую нагрузку в различных настройках DWU,](sql-data-warehouse-manage-compute-overview.md#finding-the-right-size-of-data-warehouse-units) чтобы определить, что лучше всего подходит для достижения ваших бизнес-целей.
- Сообщается о неудачных и успешных подключениях для конкретного хранилища данных, а не для логического сервера
- Процент памяти отражает использование, даже если хранилище данных находится в простое состояние - он не отражает активное потребление памяти рабочей нагрузки. Используйте и отслеживайте эту метрику вместе с другими (tempdb, gen2 кэш), чтобы принять целостное решение о том, увеличит ли масштабирование дополнительных емкостей кэша производительность рабочей нагрузки в соответствии с вашими требованиями.

## <a name="query-activity"></a>Активность запросов

Для программного опыта при мониторинге S'L Analytics через T-S'L, услуга предоставляет набор динамических представлений управления (DMVs). Эти представления полезны в том случае, если вы активно устраняете неполадки и выявляете узкие места производительности в рабочей нагрузке.

Для просмотра списка DMV, предоставляемого S'L Analytics, обратитесь к этой [документации.](sql-data-warehouse-reference-tsql-system-views.md#sql-data-warehouse-dynamic-management-views-dmvs)

## <a name="metrics-and-diagnostics-logging"></a>Метрики и журналы диагностики

Как метрики, так и журналы могут быть экспортированы в Azure Monitor, в частности компонент [журналов Azure Monitor,](../../azure-monitor/log-query/log-query-overview.md?toc=/azure/synapse-analytics/sql-data-warehouse/toc.json&bc=/azure/synapse-analytics/sql-data-warehouse/breadcrumb/toc.json) и к ним можно программно доступьться через [журналы.](../../azure-monitor/log-query/get-started-portal.md?toc=/azure/synapse-analytics/sql-data-warehouse/toc.json&bc=/azure/synapse-analytics/sql-data-warehouse/breadcrumb/toc.json) Задержка в журнале для аналитики S'L составляет около 10-15 минут. Для получения более подробной информации о факторах, влияющих на задержку, посетите следующую документацию.

## <a name="next-steps"></a>Дальнейшие действия

В следующем практическом руководстве описаны распространенные сценарии и варианты использования при мониторинге хранилища данных и управлении им:

- [Мониторинг рабочей нагрузки с помощью динамических административных представлений](sql-data-warehouse-manage-monitor.md)
