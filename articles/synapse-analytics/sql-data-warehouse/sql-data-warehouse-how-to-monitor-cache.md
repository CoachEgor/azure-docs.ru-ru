---
title: Оптимизация кэша Gen2
description: Узнайте, как выполнять мониторинг кэша 2-го поколения на портале Azure.
services: synapse-analytics
author: kevinvngo
manager: craigg
ms.service: synapse-analytics
ms.subservice: sql-dw
ms.topic: conceptual
ms.date: 09/06/2018
ms.author: kevin
ms.reviewer: igorstan
ms.custom: azure-synapse
ms.openlocfilehash: fa5025e0a2bd260adeb23b4ab7c4d5f8bd83a43a
ms.sourcegitcommit: daab0491bbc05c43035a3693a96a451845ff193b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/29/2020
ms.locfileid: "93026808"
---
# <a name="how-to-monitor-the-gen2-cache"></a>Мониторинг кэша 2-го поколения

В этой статье описывается выполнение мониторинга и устранение неполадок с низкой производительностью запросов путем определения оптимального использования кэша 2-го поколения рабочей нагрузкой.

Архитектура хранилища 2-го поколения автоматически распределяет наиболее часто запрашиваемые сегменты columnstore в кэше, размещенные на твердотельных накопителях NVMe, разработанных для хранилищ данных 2-го поколения. Производительность повышается, когда запросы получают сегменты, размещенные в кэше.
 
## <a name="troubleshoot-using-the-azure-portal"></a>Устранение неполадок с помощью портала Azure

Вы можете использовать Azure Monitor для просмотра метрик кэша 2-го поколения, чтобы решить проблемы с производительностью запросов. Сначала перейдите к портал Azure и щелкните **монитор** , **метрики** и **+ Выбор области** :

![Снимок экрана — выберите область, выбранную из метрик в портал Azure.](./media/sql-data-warehouse-how-to-monitor-cache/cache-0.png)

Используйте полосы поиска и раскрывающиеся панели, чтобы найти хранилище данных. Затем нажмите кнопку Применить.

![На снимке экрана показана панель Выбор области, на которой можно выбрать хранилище данных.](./media/sql-data-warehouse-how-to-monitor-cache/cache-1.png)

Ключевые метрики для устранения неполадок с кэшем 2-го поколения — это **Cache hit percentage** (Процент попаданий в кэш) и **Cache used percentage** (Процент использования кэша). Выберите **Процент попаданий в кэш** и нажмите кнопку **Добавить метрику** , чтобы добавить **процент использования кэша** . 

![Метрики кэша](./media/sql-data-warehouse-how-to-monitor-cache/cache-2.png)

## <a name="cache-hit-and-used-percentage"></a>Процент попаданий и процент использования кэша

В матрице ниже описаны сценарии,основанные на значениях метрик кэша:

|                                | **Высокий процент попаданий в кэш** | **Низкий процент попаданий в кэш** |
| :----------------------------: | :---------------------------: | :--------------------------: |
| **Высокий процент использования кэша** |          Сценарий 1           |          Сценарий 2          |
| **Низкий процент использования кэша**  |          Сценарий 3           |          Сценарий 4          |

**Сценарий 1.** Вы оптимально используете кэш. [Устранение неполадок](sql-data-warehouse-manage-monitor.md) в других областях, которые могут замедлить выполнение запросов.

**Сценарий 2.** Текущий рабочий набор данных не помещается в кэш, что приводит к низкому проценту попаданий в кэш из-за физических операций чтения. Попробуйте увеличить уровень производительности и повторно запустите рабочую нагрузку для заполнения кэша.

**Сценарий 3.** Вполне вероятно, что запрос выполняется медленно из-за причин, которые не относятся к кэшу. [Устранение неполадок](sql-data-warehouse-manage-monitor.md) в других областях, которые могут замедлить выполнение запросов. Вы можете также рассмотреть [уменьшение масштаба экземпляра](sql-data-warehouse-manage-monitor.md), чтобы уменьшить размер кэша для сокращения затрат. 

**Сценарий 4** . У вас есть холодный кэш, который может быть причиной медленного выполнения запроса. Подумайте о том, чтобы повторно выполнить свой запрос, так как ваш рабочий набор данных теперь должен быть в режиме кэширования. 

> [!IMPORTANT]
> Если процент попаданий в кэш или процент использования кэша не обновляется после повторного выполнения рабочей нагрузки, Рабочий набор может уже находиться в памяти. Кэшируются только кластеризованные таблицы columnstore.

## <a name="next-steps"></a>Дальнейшие действия
Дополнительные сведения о настройке производительности общих запросов см. в разделе [Наблюдение за выполнением запросов](sql-data-warehouse-manage-monitor.md#monitor-query-execution).
