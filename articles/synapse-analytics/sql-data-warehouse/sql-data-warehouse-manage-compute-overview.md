---
title: Управление вычислительным ресурсом для пула S'L
description: Узнайте о возможностях масштабирования производительности в пуле Azure Synapse Analytics S'L. Вы можете выполнять горизонтальное масштабирование, настраивая количество единиц использования хранилища данных (DWU), или снижать затраты, приостанавливая работу хранилища данных.
services: synapse-analytics
author: ronortloff
manager: craigg
ms.service: synapse-analytics
ms.topic: conceptual
ms.subservice: ''
ms.date: 11/12/2019
ms.author: rortloff
ms.reviewer: igorstan
ms.custom: seo-lt-2019, azure-synapse
ms.openlocfilehash: daf57c7e6ef40f75eac070c06547cf2a28338f21
ms.sourcegitcommit: d597800237783fc384875123ba47aab5671ceb88
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/03/2020
ms.locfileid: "80633246"
---
# <a name="manage-compute-in-azure-synapse-analytics-data-warehouse"></a>Управление вычислением в хранилище данных Azure Synapse Analytics

Узнайте об управлении вычислительными ресурсами в пуле Azure Synapse Analytics S'L. Снижение затрат за счет приостановки пула S'L или масштабирования хранилища данных для удовлетворения требований к производительности.

## <a name="what-is-compute-management"></a>Что такое управление вычислительными ресурсами?

Архитектура хранилища данных отделяет систему хранения данных и вычислений, что позволяет каждому из них масштабироваться независимо. В результате можно масштабировать вычислительные ресурсы в соответствии с потребностями в производительности независимо от хранилища данных. Кроме того, можно приостанавливать и возобновлять работу вычислительных ресурсов. При такой архитектуре [выставление счетов](https://azure.microsoft.com/pricing/details/sql-data-warehouse/) за вычислительные ресурсы и ресурсы хранилища осуществляется отдельно. Если не нужно использовать хранилище данных в течение какого-то времени, то можно сократить затраты, приостановив вычислительные ресурсы.

## <a name="scaling-compute"></a>Масштабирование вычислительных ресурсов

Вы можете масштабировать или масштабировать вычисления, настраивая [настройки единиц хранилища данных](what-is-a-data-warehouse-unit-dwu-cdwu.md) для пула S'L. Добавление единиц использования хранилища данных позволяет линейно повышать производительность загрузки и запросов.

Инструкции по горизонтальному масштабированию приведены в кратких руководствах для [портала Azure](quickstart-scale-compute-portal.md), [PowerShell](quickstart-scale-compute-powershell.md) и [T-SQL](quickstart-scale-compute-tsql.md). Можно также выполнять операции горизонтального масштабирования с помощью [REST API](sql-data-warehouse-manage-compute-rest-api.md#scale-compute).

Для выполнения операции масштабирования пул S'L сначала убивает все входящие запросы, а затем откатывает транзакции, чтобы обеспечить согласованное состояние. Масштабирование происходит только после завершения отката транзакций. Для операции масштаба система отделяет слой хранилища от вычислительных узлов, добавляет вычислительные узлы, а затем прикрепляет слой хранилища к слою вычислений. Каждый пул S'L хранится в виде 60 дистрибутивов, которые равномерно распределены по вычислительным узлам. Добавление большего количества вычислительных узлов увеличивает вычислительную мощность. По мере увеличения количества вычислительных узлов количество дистрибутивов на вычислительный узлы уменьшается, обеспечивая больше вычислительной мощности для запросов. Аналогичным образом уменьшение единиц хранилища данных сокращает количество вычислительных узлов, что сокращает вычислительные ресурсы для запросов.

В следующей таблице показано, как изменяется количество распределений на вычислительный узел при изменении количества единиц использования хранилища данных.  DW30000c обеспечивает 60 вычислительных узлов и обеспечивает гораздо более высокую производительность запроса, чем DW100c.

| Единицы использования хранилища данных  | \#вычислительных узлов | \# распределений на узел |
| -------- | ---------------- | -------------------------- |
| DW100c   | 1                | 60                         |
| DW200c   | 1                | 60                         |
| DW300c   | 1                | 60                         |
| DW400c   | 1                | 60                         |
| DW500c   | 1                | 60                         |
| DW1000c  | 2                | 30                         |
| DW1500c  | 3                | 20                         |
| DW2000c  | 4                | 15                         |
| DW2500c  | 5                | 12                         |
| DW3000c  | 6                | 10                         |
| DW5000c  | 10               | 6                          |
| DW6000c  | 12               | 5                          |
| DW7500c  | 15               | 4                          |
| DW10000c | 20               | 3                          |
| DW15000c | 30               | 2                          |
| DW30000c | 60               | 1                          |

## <a name="finding-the-right-size-of-data-warehouse-units"></a>Поиск правильного размера единиц использования хранилища данных

Чтобы ознакомиться с преимуществами производительности, обеспечиваемыми горизонтальным масштабированием, особенно для более крупных единиц использования хранилища данных, следует использовать по крайней мере набор данных размером в 1 ТБ. Чтобы найти лучшее количество единиц хранилища данных для вашего пула S'L, попробуйте масштабирование вверх и вниз. Выполните несколько запросов с различным количеством единиц использования хранилища данных после загрузки данных. Так как масштабирование выполняется достаточно быстро, попробуйте использовать разные уровни производительности не дольше одного часа.

Рекомендации по поиску оптимального количества единиц использования хранилища данных:

- Для вразработки пула S'L начните с выбора меньшего количества единиц хранилища данных.  Хорошей отправной точкой является DW400c или DW200c.
- Отслеживайте производительность приложения, сравнивая ее с количеством выбранных единиц использования хранилища данных.
- Исходя из того, что масштаб изменяется линейно, определите, как необходимо увеличить или уменьшить число единиц использования хранилища данных.
- Вносите изменения, пока не достигнете уровня производительности, который оптимально отвечает вашим бизнес-требованиям.

## <a name="when-to-scale-out"></a>Когда требуется масштабирование

Горизонтальное масштабирование единиц использования хранилища данных влияет на следующие аспекты производительности:

- Линейное увеличение производительности системы для операций сканирования, агрегирования и инструкций CTAS.
- Увеличение количества модулей чтения и записи при загрузке данных.
- Максимальное количество параллельных запросов и слотов выдачи.

Рекомендации по тому, когда следует использовать горизонтальное масштабирование единиц использования хранилища данных:

- Прежде чем выполнять ресурсоемкую загрузку данных или их преобразование, выполните горизонтальное масштабирование, чтобы быстрее получать доступ к данным.
- Во время рабочих часов наибольшей нагрузки выполните горизонтальное масштабирование, чтобы обработать большое количество одновременных запросов.

## <a name="what-if-scaling-out-does-not-improve-performance"></a>Что делать, если горизонтальное масштабирование не повышает производительность?

Добавление единиц использования хранилища данных усиливает параллелизм. Если работа равномерно разделена между вычислительными узлами, усиление параллелизма повышает производительность запросов. Если горизонтальное масштабирование не изменяет производительность, этому может быть несколько причин. Возможно, данные неравномерно разделены между распределениями или запросы вызывают много операций перемещения данных. Чтобы изучить проблемы производительности запросов, ознакомьтесь с разделом [Устранение неполадок хранилища данных SQL Azure](sql-data-warehouse-troubleshoot.md#performance).

## <a name="pausing-and-resuming-compute"></a>Приостановка и возобновление вычислительных ресурсов

Приостановка вычислительных ресурсов приводит к отключению уровня хранилища от вычислительных узлов. Ресурсы вычислений освобождаются из вашей учетной записи. Пока вычислительные ресурсы приостановлены, плата за их использование не взимается. При возобновлении работы вычислительных ресурсов хранилище подключается к вычислительным узлам и начинает взиматься плата за вычисления.
При приостановке вбассейна S'L:

- Вычислительные ресурсы и ресурсы памяти возвращаются в пул доступных ресурсов в центре данных.
- В течение периода приостановки затраты на единицы использования хранилища данных отсутствуют.
- Хранилище данных не затрагивается, и ваши данные остаются без изменений.
- Все запущенные или в очереди операции отменяются.

При возобновлении вхольного пула S'L:

- Пуля S'L приобретает ресурсы вычислений и памяти для настройки единиц хранилища данных.
- Возобновляется оплата единиц использования хранилища данных.
- Данные становятся доступными.
- После того, как пул S'L будет работать в режиме онлайн, необходимо перезапустить запросы рабочей нагрузки.

Если вы всегда хотите, чтобы ваш пул S'L был доступен, подумайте о его масштабировании до наименьшего размера, а не приостанавливайте.

Инструкции по приостановке и возобновлению работы приведены в кратких руководствах для [портала Azure](pause-and-resume-compute-portal.md) и [PowerShell](pause-and-resume-compute-powershell.md). Можно также использовать [REST API приостановки](sql-data-warehouse-manage-compute-rest-api.md#pause-compute) или [REST API возобновления](sql-data-warehouse-manage-compute-rest-api.md#resume-compute).

## <a name="drain-transactions-before-pausing-or-scaling"></a>Очистка транзакций перед приостановкой использования и масштабированием вычислительных ресурсов

Мы рекомендуем дождаться завершения текущих транзакций, прежде чем начать приостановку или масштабирование.

При приостановке или масштабирования пула S'L за кулисами ваши запросы отменяются при инициировании запроса на паузу или масштабирование. Отмена типичного запроса SELECT выполняется очень быстро и почти не влияет на время, необходимое для приостановки работы или масштабирования экземпляра.  Однако остановка транзакционных запросов, с помощью которых изменяются данные или их структура, занимает длительное время. **Транзакционные запросы по определению должны полностью завершиться или выполнить откат изменений.**  На откат изменений, выполненных с помощью транзакционных запросов, требуется столько же времени (или даже больше), как и на выполнение самих изменений. Например, если отменить запрос на удаление строк, который уже выполняется в течение часа, системе понадобится столько же времени, чтобы вставить удаленные строки обратно. Процесс приостановки работы и масштабирования ресурсов во время выполнения транзакционных запросов займет более длительное время, так как он не начнется, пока не будет выполнен откат изменений.

Дополнительные сведения см. в статьях [Транзакции в хранилище данных SQL](sql-data-warehouse-develop-transactions.md) и [Оптимизация транзакций для хранилища данных SQL](sql-data-warehouse-develop-best-practices-transactions.md).

## <a name="automating-compute-management"></a>Автоматизация управления вычислительными ресурсами

Автоматизация операций управления вычислительным ресурсами описывается в разделе [Использование службы "Функции Azure" для автоматизации управления уровнями вычислений в хранилище данных SQL](manage-compute-with-azure-functions.md).

Каждая операция горизонтального масштабирования, приостановки или возобновления работы может длиться несколько минут. Если операции масштабирования, приостановки и возобновления выполняются автоматически, мы рекомендуем реализовать логику, позволяющую приступать к выполнению другого действия только после завершения определенных операций. Проверка состояния пула с помощью различных конечных точек позволяет правильно внедрять автоматизацию таких операций.

Чтобы проверить состояние пула, смотрите быстрый запуск [PowerShell](quickstart-scale-compute-powershell.md#check-data-warehouse-state) или [T-S'L.](quickstart-scale-compute-tsql.md#check-data-warehouse-state) Вы также можете проверить состояние пула s'L с помощью [REST API.](sql-data-warehouse-manage-compute-rest-api.md#check-database-state)

## <a name="permissions"></a>Разрешения

Масштабирование пула S'L требует разрешений, описанных в [ALTER DATABASE.](/sql/t-sql/statements/alter-database-azure-sql-data-warehouse?toc=/azure/synapse-analytics/sql-data-warehouse/toc.json&bc=/azure/synapse-analytics/sql-data-warehouse/breadcrumb/toc.json&view=azure-sqldw-latest)  Чтобы приостановить и возобновить работу, нужны разрешения [Участник баз данных SQL](../../role-based-access-control/built-in-roles.md?toc=/azure/synapse-analytics/sql-data-warehouse/toc.json&bc=/azure/synapse-analytics/sql-data-warehouse/breadcrumb/toc.json#sql-db-contributor), в частности Microsoft.Sql/servers/databases/action.

## <a name="next-steps"></a>Дальнейшие действия

Узнайте, как управлять [вычислением,](manage-compute-with-azure-functions.md) можно увидеть, как распределять различные вычислительные ресурсы для отдельных запросов. Дополнительные сведения см. в разделе [Классы ресурсов для управления рабочими нагрузками](resource-classes-for-workload-management.md).
