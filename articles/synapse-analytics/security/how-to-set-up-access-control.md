---
title: Защита рабочей области Synapse (предварительная версия)
description: Из этой статьи вы узнаете, как использовать роли и элементы управления доступом для управления действиями и доступом к данным в рабочей области Synapse.
services: synapse-analytics
author: matt1883
ms.service: synapse-analytics
ms.topic: how-to
ms.subservice: ''
ms.date: 04/15/2020
ms.author: mahi
ms.reviewer: jrasnick
ms.openlocfilehash: d02cd12552b3664dd7acaae0142fc939ee57f5f6
ms.sourcegitcommit: bb0afd0df5563cc53f76a642fd8fc709e366568b
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/19/2020
ms.locfileid: "83591987"
---
# <a name="secure-your-synapse-workspace-preview"></a>Защита рабочей области Synapse (предварительная версия)

Из этой статьи вы узнаете, как использовать роли и элементы управления доступом для управления действиями и доступом к данным. Следуя этим инструкциям, можно упростить управление доступом в Azure Synapse Analytics. Вам нужно только добавить пользователей в одну из трех групп безопасности или удалить их из нее.

## <a name="overview"></a>Обзор

Чтобы защитить рабочую область Synapse (предварительная версия), необходимо следовать шаблону настройки следующих элементов:

- Роли Azure (например, встроенные роли владельца, участника и т. д.).
- Роли Synapse — эти роли уникальны для Synapse и не основаны на ролях Azure. Существует три вида этих ролей:
  - администратор рабочей области Synapse;
  - администратор Synapse SQL;
  - администратор Apache Spark для Azure Synapse Analytics.
- Управление доступом к данным в Azure Data Lake Storage 2-го поколения (ADLSGEN2).
- Управление доступом для баз данных Synapse SQL и Spark.

## <a name="steps-to-secure-a-synapse-workspace"></a>Действия по обеспечению безопасности рабочей области Synapse

В этой документации для упрощения инструкций используются стандартные имена. Замените их любыми именами по своему усмотрению.

|Параметр | Пример значения | Описание |
| :------ | :-------------- | :---------- |
| **Рабочая область Synapse** | WS1 |  Имя, которое будет иметь рабочая область Synapse. |
| **Учетная запись ADLSGEN2** | STG1 | Учетная запись ADLS для использования с рабочей областью. |
| **Контейнер** | CNT1 | Контейнер в STG1, который будет использоваться по умолчанию рабочей областью. |
| **Клиент Active Directory** | contoso | Имя клиента Active Directory.|
||||

## <a name="step-1-set-up-security-groups"></a>Шаг 1. Настройка групп безопасности

Создайте и заполните три группы безопасности для рабочей области:

- **WS1\_WSAdmins** — для пользователей, которым необходим полный контроль над рабочей областью.
- **WS1\_SparkAdmins** — для тех пользователей, которым необходим полный контроль над аспектами Spark рабочей области.
- **WS1\_SQLAdmins** — для пользователей, которым необходим полный контроль над аспектами SQL рабочей области.
- Добавьте **WS1\_WSAdmins** в **WS1\_SQLAdmins**.
- Добавьте **WS1\_WSAdmins** в **WS1\_SparkAdmins**.

## <a name="step-2-prepare-your-data-lake-storage-gen2-account"></a>Шаг 2. Подготовка учетной записи Data Lake Storage 2-го поколения

Определите следующие сведения о вашем хранилище:

- Учетную запись ADLSGEN2, используемую для рабочей области. В этой документации она называется STG1.  STG1 считается первичной учетной записью хранения для вашей рабочей области.
- Контейнер в WS1, который будет использоваться рабочей областью Synapse по умолчанию. В этой документации он называется CNT1.  Этот контейнер используется для:
  - хранения резервных файлов данных для таблиц Spark;
  - журналов выполнения для заданий Spark.

- С помощью портала Azure назначьте группам безопасности следующие роли в CNT1:

  - назначьте **WS1\_WSAdmins** для роли **участника данных больших двоичных объектов хранилища**;
  - назначьте **WS1\_SparkAdmins** для роли **участника данных больших двоичных объектов хранилища**;
  - назначьте **WS1\_SQLAdmins** роли **участника данных больших двоичных объектов хранилища**.

## <a name="step-3-create-and-configure-your-synapse-workspace"></a>Шаг 3. Создание и настройка рабочей области Synapse

На портале Azure создайте рабочую область Synapse:

- Присвойте рабочей области имя WS1.
- Выберите STG1 для учетной записи хранения.
- Выберите CNT1 для контейнера, который используется в качестве файловой системы.
- Откройте WS1 в Synapse Studio.
- Выберите **Управление** > **Управление доступом**. Назначьте группы безопасности следующим ролям Synapse:
  - назначьте **WS1\_WSAdmins** администраторам рабочей области Synapse;
  - назначьте **WS1\_SparkAdmins** администраторам Synapse Spark;
  - назначьте **WS1\_SQLAdmins** администраторам Synapse SQL.

## <a name="step-4-configuring-data-lake-storage-gen2-for-use-by-synapse-workspace"></a>Шаг 4. Настройка Data Lake Storage 2-го поколения для использования рабочей областью Synapse

Для рабочей области Synapse требуется доступ к STG1 и CNT1, чтобы она могла запускать конвейеры и выполнять системные задачи.

- Откройте портал Azure.
- Найдите STG1.
- Перейдите в CNT1.
- Убедитесь, что MSI (управляемое удостоверение службы) для WS1 назначена роль **участника данных больших двоичных объектов хранилища** в CNT1.
  - Если роль не назначена, назначьте ее.
  - Имя MSI совпадает с именем рабочей области. В этом случае это будет &quot;WS1&quot;.

## <a name="step-5-configure-admin-access-for-sql-pools"></a>Шаг 5. Настройка доступа администратора для пулов SQL

- Откройте портал Azure.
- Перейдите к WS1.
- В разделе **Параметры** выберите **Администратор Active Directory для SQL**.
- Щелкните **Задать администратора** и выберите WS1\_SQLAdmins.

## <a name="step-6-maintaining-access-control"></a>Шаг 6. Обеспечение управления доступом

Настройка завершена.

Теперь для управления доступом пользователей можно добавить в три группы безопасности или удалить их из них.

Хотя вы можете вручную назначить пользователей ролям Synapse, в этом случае конфигурация не будет согласованной. Вместо этого только добавьте пользователей в группы безопасности или удалите их из них.

## <a name="step-7-verify-access-for-users-in-the-roles"></a>Шаг 7. Проверка доступа для пользователей с ролями

Пользователям в каждой роли необходимо выполнить следующие действия:

|   | Шаг | Администраторы рабочей области | Администраторы Spark | Администраторы SQL |
| --- | --- | --- | --- | --- |
| 1 | Отправка файла Parquet в CNT1 | YES | YES | YES |
| 2 | Чтение файла Parquet с помощью SQL по запросу | YES | NO | YES |
| 3 | Создание пула Spark | YES [1] | YES [1] | NO  |
| 4 | Чтение файла Parquet с помощью Notebook | YES | YES | NO |
| 5 | Создание конвейера из Notebook и моментальный запуск конвейера | YES | NO | NO |
| 6 | Создание пула SQL и запуск скрипта SQL, например &quot;SELECT 1&quot; | YES [1] | NO | YES[1] |

> [!NOTE]
> [1] Для создания пулов SQL или Spark пользователь должен иметь по крайней мере роль участника в рабочей области Synapse.
> [!TIP]
>
> - В зависимости от роли некоторые шаги намеренно не будут разрешены.
> - Помните, что выполнение некоторых задач может завершиться ошибкой, если безопасность не была полностью настроена. Эти задачи указаны в таблице.

## <a name="step-8-network-security"></a>Шаг 8. Безопасность сети

Для настройки брандмауэра рабочей области, виртуальной сети и [Приватного канала](../../sql-database/sql-database-private-endpoint-overview.md).

## <a name="step-9-completion"></a>Шаг 9. Completion

Теперь ваша рабочая область полностью настроена и защищена.

## <a name="how-roles-interact-with-synapse-studio"></a>Взаимодействие ролей с Synapse Studio

Synapse Studio ведет себя по-разному в зависимости от ролей пользователей. Некоторые элементы могут быть скрыты или отключены, если пользователю не назначены роли, которые предоставляют соответствующий доступ. В следующей таблицы указаны сводные данные о влиянии на Synapse Studio.

| Задача | Администраторы рабочей области | Администраторы Spark | Администраторы SQL |
| --- | --- | --- | --- |
| Открытие Synapse Studio | YES | YES | YES |
| Просмотр домашнего центра | YES | YES | YES |
| Просмотр центра данных | YES | YES | YES |
| Центр данных / см. связанные учетные записи ADLS 2-го поколения и контейнеры | YES [1] | YES[1] | YES[1] |
| Центр данных / см. базы данных | YES | YES | YES |
| Центр данных / см. объекты в базах данных | YES | YES | YES |
| Центр данных / доступ к данным в базах данных пула SQL | YES   | NO   | YES   |
| Центр данных / доступ к данным в базах данных SQL по запросу | YES [2]  | NO  | YES [2]  |
| Центр данных / доступ к данным в базах данных Spark | YES [2] | YES [2] | YES [2] |
| Использование центра разработки | YES | YES | YES |
| Центр разработки / создание скриптов SQL | YES | NO | YES |
| Центр разработки / создание определений заданий Spark | YES | YES | NO |
| Центр разработки / создание Записных книжек | YES | YES | NO |
| Центр разработки / создание потоков данных | YES | NO | NO |
| Использование центра оркестрации | YES | YES | YES |
| Центр оркестрации / использование конвейеров | YES | NO | NO |
| Использование центра управления | YES | YES | YES |
| Центр управления / пулы SQL | YES | NO | YES |
| Центр управления / пулы Spark | YES | YES | NO |
| Центр управления / триггеры | YES | NO | NO |
| Центр управления / связанные службы | YES | YES | YES |
| Центр управления / управление доступом (назначение пользователей для ролей рабочей области Synapse) | YES | NO | NO |
| Центр управления / среды выполнения интеграции | YES | YES | YES |
| Использование центра мониторинга | YES | YES | YES |
| Центр мониторинга / оркестрация / запуски конвейера  | YES | NO | NO |
| Центр мониторинга / оркестрация / запуски триггера  | YES | NO | NO |
| Центр мониторинга / оркестрация / среды выполнения интеграции  | YES | YES | YES |
| Центр мониторинга / действия / приложения Spark | YES | YES | NO  |
| Центр мониторинга / действия / запросы SQL | YES | NO | YES |
| Центр мониторинга / действия / пулы Spark | YES | YES | NO  |
| Центр мониторинга / триггеры | YES | NO | NO |
| Центр управления / связанные службы | YES | YES | YES |
| Центр управления / управление доступом (назначение пользователей для ролей рабочей области Synapse) | YES | NO | NO |
| Центр управления / среды выполнения интеграции | YES | YES | YES |


> [!NOTE]
> [1] Доступ к данным в контейнерах зависит от управления доступом в ADLS 2-го поколения. </br>
> [2] Таблицы SQL по запросу и Spark хранят данные в ADLS 2-го поколения, для доступа к ним требуется наличие соответствующих разрешений в ADLS 2-го поколения.

## <a name="next-steps"></a>Дальнейшие действия

Создание [рабочей области Synapse](../quickstart-create-workspace.md).
