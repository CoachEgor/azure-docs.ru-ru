---
title: Замена выпуска SQL Server на месте
description: Узнайте, как изменить выпуск виртуальной машины SQL Server в Azure.
services: virtual-machines-windows
documentationcenter: na
author: MashaMSFT
tags: azure-resource-manager
ms.service: virtual-machines-sql
ms.topic: article
ms.tgt_pltfrm: vm-windows-sql-server
ms.workload: iaas-sql-server
ms.date: 01/14/2020
ms.author: mathoma
ms.reviewer: jroth
ms.custom: seo-lt-2019
ms.openlocfilehash: 228f76c9ecb262ffca7851f4339b73c5574f09dc
ms.sourcegitcommit: 877491bd46921c11dd478bd25fc718ceee2dcc08
ms.contentlocale: ru-RU
ms.lasthandoff: 07/02/2020
ms.locfileid: "84669174"
---
# <a name="in-place-change-of-sql-server-edition-on-azure-vm"></a>Замена выпуска SQL Server на месте на виртуальной машине Azure
[!INCLUDE[appliesto-sqlvm](../../includes/appliesto-sqlvm.md)]

Эта статья содержит сведения об изменении выпуска SQL Server на виртуальной машине Windows в Azure. 

Выпуск SQL Server определяется ключом продукта и указывается в процессе установки с помощью установочного носителя. Этот выпуск определяет, какие [функции](/sql/sql-server/editions-and-components-of-sql-server-2017) доступны в продукте SQL Server. Изменить выпуск SQL Server можно с помощью установочного носителя. Вы можете либо перейти к более ранней версии, чтобы сократить затраты, либо обновить версию, чтобы включить дополнительные функции.

После того как выпуск SQL Server будет изменен внутри виртуальной машины SQL Server, необходимо обновить свойство выпуска SQL Server на портале Azure для выставления счетов. 

## <a name="prerequisites"></a>Предварительные требования

Чтобы выполнить замену выпуска SQL Server на месте, вам потребуется следующее: 

- [Подписка Azure](https://azure.microsoft.com/free/).
- [Виртуальная машина SQL Server под управлением Windows](https://docs.microsoft.com/azure/virtual-machines/windows/sql/virtual-machines-windows-portal-sql-server-provision), зарегистрированная с помощью [поставщика ресурсов виртуальных машин SQL](sql-vm-resource-provider-register.md).
- Установочный носитель с **требуемым выпуском** SQL Server. Клиенты, у которых есть программа [Software Assurance](https://www.microsoft.com/licensing/licensing-programs/software-assurance-default), установочный носитель могут получить в [Центре корпоративного лицензирования](https://www.microsoft.com/Licensing/servicecenter/default.aspx). Клиенты, у которых нет программы Software Assurance, могут воспользоваться установочным носителем из образа виртуальной машины SQL Server в Azure Marketplace, который содержит нужный выпуск (обычно находятся по адресу `C:\SQLServerFull`). 


## <a name="upgrade-an-edition"></a>Обновление выпуска

> [!WARNING]
> После обновления выпуска SQL Server служба для SQL Server и все связанные службы, такие как Analysis Services и службы R, будут перезапущены. 

Чтобы обновить выпуск SQL Server, получите установочный носитель SQL Server с нужным выпуском SQL Server, а затем выполните следующие действия:

1. Откройте файл Setup.exe с установочного носителя SQL Server. 
1. Перейдите в раздел **Обслуживание** и выберите параметр **Обновление выпуска**. 

   ![Выбор параметра для обновления выпуска SQL Server](./media/change-sql-server-edition/edition-upgrade.png)

1. Выберите **Далее** пока не откроется страница **Все готово для обновления выпуска**, а затем щелкните **Обновить**. Окно установки может не отвечать на запросы в течение нескольких минут, пока изменение вступит в силу. Откроется страница **Завершено**, которая подтвердит, что обновление выпуска завершено. 

После обновления выпуска SQL Server измените свойство выпуска виртуальной машины SQL Server на портале Azure. При этом будут обновлены метаданные и данные для выставления счетов, связанные с этой виртуальной машиной.

## <a name="downgrade-an-edition"></a>Переход на более раннюю версию выпуска

Чтобы использовать более раннюю версию выпуска SQL Server, необходимо полностью удалить SQL Server и повторно установить его с помощью нужного установочного носителя выпуска. 

> [!WARNING]
> Удаление SQL Server может вызвать дополнительное время простоя. 

Чтобы перейти на более раннюю версию выпуска SQL Server, выполните следующие действия:

1. Создайте резервную копию всех баз данных, включая системные. 
1. Переместите системные базы данных (master, model и msdb) в новое расположение. 
1. Полностью удалите SQL Server и все связанные службы. 
1. Перезапустите виртуальную машину. 
1. Установите SQL Server, используя носитель с нужным выпуском SQL Server.
1. Установите актуальные пакеты обновления и накопительные обновления.  
1. Замените новые системные базы данных, созданные во время установки, на системные базы данных, которые ранее были перемещены в другое расположение. 

После перехода на более раннюю версию выпуска SQL Server измените свойство выпуска виртуальной машины SQL Server на портале Azure. При этом будут обновлены метаданные и данные для выставления счетов, связанные с этой виртуальной машиной.

## <a name="change-edition-in-portal"></a>Изменение выпуска на портале 

После изменения выпуска SQL Server с помощью установочного носителя и регистрации виртуальной машины SQL Server в [поставщике ресурсов виртуальной машины SQL](sql-vm-resource-provider-register.md) вы можете использовать портал Azure, чтобы изменить свойства выпуска виртуальной машины SQL Server для выставления счетов. Для этого выполните следующие действия. 

1. Войдите на [портал Azure](https://portal.azure.com). 
1. Перейдите к ресурсу виртуальной машины SQL Server. 
1. В разделе **Параметры** выберите **Конфигурация**. Затем выберите нужный выпуск SQL Server из раскрывающегося списка в разделе **Выпуск**. 

   ![Изменение метаданных выпуска](./media/change-sql-server-edition/edition-change-in-portal.png)

1. Обратите внимание на предупреждение о том, что сначала необходимо изменить выпуск SQL Server, а свойство выпуска должно соответствовать выпуску SQL Server. 
1. Для применения изменений метаданных выпуска выберите **Применить**. 


## <a name="remarks"></a>Remarks

- Свойство выпуска для виртуальной машины SQL Server должно соответствовать выпуску экземпляра SQL Server, установленного для всех виртуальных машин SQL Server, включая лицензии с оплатой по мере использования и с использованием собственной лицензии.
- Если вы удалите ресурс виртуальной машины SQL Server, параметры выпуска будут возвращены к состоянию, которое прописано в коде для соответствующего образа.
- Изменение выпуска — это возможность поставщика ресурсов виртуальной машины SQL. Развертывание образа из Azure Marketplace через портал Azure предусматривает автоматическую регистрацию виртуальной машины SQL Server в поставщике ресурсов. Тем не менее клиентам, которые самостоятельно устанавливают SQL Server, нужно будет вручную [зарегистрировать виртуальные машины SQL Server](sql-vm-resource-provider-register.md).
- Для добавления виртуальной машины SQL Server в группу доступности необходимо повторно создать эту виртуальную машину. Все добавленные в группу доступности виртуальные машины будут использовать выпуск по умолчанию. Вам потребуется заново изменить выпуск.

## <a name="next-steps"></a>Дальнейшие действия

Дополнительные сведения см. в следующих статьях: 

* [Обзор SQL Server на виртуальных машинах Windows](sql-server-on-azure-vm-iaas-what-is-overview.md).
* [Вопросы и ответы об SQL Server на виртуальных машинах Windows](frequently-asked-questions-faq.md)
* [Руководство по ценам для виртуальных машин SQL Server в Azure](pricing-guidance.md)
* [Заметки о выпуске SQL Server на виртуальных машинах Windows](doc-changes-updates-release-notes.md)


