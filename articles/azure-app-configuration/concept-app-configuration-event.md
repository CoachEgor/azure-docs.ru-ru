---
title: Реагирование на события ключ значение конфигурации приложения Azure | Документация Майкрософт
description: Используйте "Сетка событий Azure" для подписки на события конфигурации приложения.
services: azure-app-configuration,event-grid
author: jimmyca
ms.author: jimmyca
ms.date: 05/30/2019
ms.topic: article
ms.service: azure-app-configuration
ms.openlocfilehash: 601124aef37d2b285db71130f5c63b3620c7768f
ms.sourcegitcommit: d4dfbc34a1f03488e1b7bc5e711a11b72c717ada
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/13/2019
ms.locfileid: "66735651"
---
# <a name="reacting-to-azure-app-configuration-events"></a>Реагирование на события конфигурации приложения Azure

События конфигурации приложения Azure позволяют приложениям реагировать на изменения в значениях ключа. Это делается без необходимости написания сложного кода или дорогостоящие и неэффективные службы опроса. Вместо этого события отправляются через службу [Сетка событий Azure](https://azure.microsoft.com/services/event-grid/) подписчикам, таким как [Функции Azure](https://azure.microsoft.com/services/functions/), [Azure Logic Apps](https://azure.microsoft.com/services/logic-apps/), или даже в настраиваемый вами прослушиватель HTTP. При этом вы оплачиваете только то, что используете.

"Сетка событий" Azure, которая предоставляет надежную доставку служб приложений за счет мощных функций повторов, политики и доставки недоставленных отправляются события конфигурации приложения Azure. Дополнительные сведения см. в разделе [доставки сообщений сетки событий и повторите попытку](https://docs.microsoft.com/azure/event-grid/delivery-and-retry).

К распространенным сценариям событий конфигурации приложения включают обновление конфигурации приложения, активируя развертывания, и все рабочие процессы, ориентированные на конфигурации. Когда изменения вносятся редко, а сценарий требует немедленного реагирования, архитектура на основе событий может быть особенно эффективной.

Взгляните на [Конфигурация приложения Azure маршрут события для пользовательского веб-endpoint - CLI](./howto-app-configuration-event.md) краткий пример. 

![Модель Сетки событий](./media/event-grid-functional-model.png)

## <a name="available-azure-app-configuration-events"></a>Доступные события конфигурации приложения Azure
Сетка событий использует [подписки на события](../event-grid/concepts.md#event-subscriptions) для маршрутизации сообщений о событиях подписчикам. Azure подписки на события конфигурации приложения могут включать два типа событий:  

> |Название мероприятия|Описание|
> |----------|-----------|
> |`Microsoft.AppConfiguration.KeyValueModified`|Возникает при создании или замене значения ключа|
> |`Microsoft.AppConfiguration.KeyValueDeleted`|Возникает при удалении значения ключа|

## <a name="event-schema"></a>Схема событий
События конфигурации приложения Azure содержат все сведения, необходимые для реагирования на изменения в данных. Можно определить события конфигурации приложения, так как свойство eventType начинается с «Microsoft.AppConfiguration». Дополнительные сведения об использовании свойств событий Сетки событий приводятся в статье [Схема событий службы "Сетка событий Azure"](../event-grid/event-schema.md).  

> |Свойство|type|ОПИСАНИЕ|
> |-------------------|------------------------|-----------------------------------------------------------------------|
> |topic|string|Полный идентификатор Azure Resource Manager в конфигурации приложения, которая создает событие.|
> |subject|string|URI ключ значение, который является темой события.|
> |eventTime|string|Дата и время создания события, в формате ISO 8601.|
> |eventType|string|«Microsoft.AppConfiguration.KeyValueModified» или «Microsoft.AppConfiguration.KeyValueDeleted».|
> |Идентификатор|string|Уникальный идентификатор этого события.|
> |dataVersion|строка|Версия схемы для объекта данных.|
> |metadataVersion|string|Версия схемы свойств верхнего уровня.|
> |data|object|Сбор данных определенного события конфигурации приложения Azure|
> |Data.key|string|Ключ, ключ-значение, которая была изменена или удалена.|
> |Data.Label|string|Метка, если таковое имеется, ключ-значение, которая была изменена или удалена.|
> |Data.eTag|string|Для `KeyValueModified` etag новый ключ значение. Для `KeyValueDeleted` etag ключ значение, который был удален.|

Ниже приведен пример события KeyValueModified:
```json
[{
  "id": "84e17ea4-66db-4b54-8050-df8f7763f87b",
  "topic": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/testrg/providers/microsoft.appconfiguration/configurationstores/contoso",
  "subject": "https://contoso.azconfig.io/kv/Foo?label=FizzBuzz",
  "data": {
    "key": "Foo",
    "label": "FizzBuzz",
    "etag": "FnUExLaj2moIi4tJX9AXn9sakm0"
  },
  "eventType": "Microsoft.AppConfiguration.KeyValueModified",
  "eventTime": "2019-05-31T20:05:03Z",
  "dataVersion": "1",
  "metadataVersion": "1"
}]

```

Дополнительные сведения см. в разделе [схема события конфигурации приложения Azure](../event-grid/event-schema-app-configuration.md).

## <a name="practices-for-consuming-events"></a>Рекомендации по потреблению событий
В приложениях, которые обрабатывают события конфигурации приложения следует использовать нескольким рекомендациям:
> [!div class="checklist"]
> * Как можно настроить несколько подписок для маршрутизации событий тот же обработчик событий, важно не следует предполагать, что события поступают из определенного источника, но необходимо проверять тему сообщения, чтобы убедиться, что они поступают из ожидаемой конфигурации приложения.
> * Подобным образом убедитесь, что вы готовы к обработке этого типа событий (eventType), а также не следует предполагать, что все получаемые события будут иметь ожидаемый тип.
> * Так как сообщения могут поступать не по порядку и после некоторой задержки, используйте поля ETag, чтобы понять, являются ли сведения об объектах актуальными.  Используйте поля sequencer для понимания последовательности событий для каждого отдельного объекта.
> * Используйте поле темы для доступа к значению ключ, который был изменен.


## <a name="next-steps"></a>Дальнейшие действия

Дополнительные сведения о сетке событий и Испытайте события настройки приложения Azure:

- [An introduction to Azure Event Grid](../event-grid/overview.md) (Общие сведения о службе "Сетка событий Azure")
- [Перенаправление событий Конфигурация приложения Azure пользовательские сетевую конечную точку](./howto-app-configuration-event.md)