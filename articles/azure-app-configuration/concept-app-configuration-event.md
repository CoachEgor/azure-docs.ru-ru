---
title: Реагирование на события "ключ — значение" конфигурации приложения Azure | Документация Майкрософт
description: Используйте службу "Сетка событий Azure" для подписки на события конфигурации приложений.
services: azure-app-configuration,event-grid
author: jimmyca
ms.author: jimmyca
ms.date: 05/30/2019
ms.topic: article
ms.service: azure-app-configuration
ms.openlocfilehash: 5da64155f2823712eee7a60427b1c1e80abec068
ms.sourcegitcommit: dbde4aed5a3188d6b4244ff7220f2f75fce65ada
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/19/2019
ms.locfileid: "74185302"
---
# <a name="reacting-to-azure-app-configuration-events"></a>Реагирование на события настройки приложения Azure

События настройки приложений Azure позволяют приложениям реагировать на изменения в значениях ключа. Это делается без необходимости в сложном коде или дорогостоящих и неэффективных службах опроса. Вместо этого события отправляются через службу [Сетка событий Azure](https://azure.microsoft.com/services/event-grid/) подписчикам, таким как [Функции Azure](https://azure.microsoft.com/services/functions/), [Azure Logic Apps](https://azure.microsoft.com/services/logic-apps/), или даже в настраиваемый вами прослушиватель HTTP. При этом вы оплачиваете только то, что используете.

События настройки приложений Azure отправляются в службу "Сетка событий Azure", которая обеспечивает надежную работу служб доставки для приложений с помощью многофункциональных политик повтора и доставки недоставленных сообщений. Дополнительные сведения см. в разделе [Доставка сообщений в сетке событий и повторная попытка](https://docs.microsoft.com/azure/event-grid/delivery-and-retry).

Типичные сценарии событий конфигурации приложений включают обновление конфигурации приложения, запуск развертываний или любой рабочий процесс, ориентированный на конфигурацию. Когда изменения вносятся редко, а сценарий требует немедленного реагирования, архитектура на основе событий может быть особенно эффективной.

Краткий пример см. в статьях о [маршрутизации событий конфигурации приложений Azure в настраиваемую веб-конечную точку (CLI)](./howto-app-configuration-event.md) . 

![Модель Сетки событий](./media/event-grid-functional-model.png)

## <a name="available-azure-app-configuration-events"></a>Доступные события конфигурации приложения Azure
Сетка событий использует [подписки на события](../event-grid/concepts.md#event-subscriptions) для маршрутизации сообщений о событиях подписчикам. Подписки на события конфигурации приложений Azure могут включать два типа событий:  

> |Название мероприятия|ОПИСАНИЕ|
> |----------|-----------|
> |`Microsoft.AppConfiguration.KeyValueModified`|Возникает при создании или замене ключевого значения|
> |`Microsoft.AppConfiguration.KeyValueDeleted`|Возникает при удалении значения ключа|

## <a name="event-schema"></a>Схема событий
События настройки приложения Azure содержат всю информацию, необходимую для реагирования на изменения в данных. Можно задать событие конфигурации приложения, так как свойство eventType начинается с "Microsoft. Аппконфигуратион". Дополнительные сведения об использовании свойств событий Сетки событий приводятся в статье [Схема событий службы "Сетка событий Azure"](../event-grid/event-schema.md).  

> |Свойство|введите|ОПИСАНИЕ|
> |-------------------|------------------------|-----------------------------------------------------------------------|
> |Раздел|строка|Полный идентификатор Azure Resource Manager конфигурации приложения, которая создает событие.|
> |subject|строка|Универсальный код ресурса (URI) ключевого значения, который является темой события.|
> |eventTime|строка|Дата и время создания события в формате ISO 8601.|
> |eventType|строка|"Microsoft. Аппконфигуратион. Кэйвалуемодифиед" или "Microsoft. Аппконфигуратион. Кэйвалуеделетед".|
> |id|строка|Уникальный идентификатор этого события.|
> |dataVersion|строка|Версия схемы для объекта данных.|
> |metadataVersion|строка|Версия схемы свойств верхнего уровня.|
> |data|object|Сбор данных о событиях конфигурации приложений Azure|
> |Data. key|строка|Ключ измененного или удаленного ключевого значения.|
> |Data. Label|строка|Метка, если таковая имеется, для измененного или удаленного ключевого значения.|
> |Data. ETag|строка|Для `KeyValueModified` тег eTag нового ключевого значения. Для `KeyValueDeleted` тег eTag удаленного ключевого значения.|

Ниже приведен пример события Кэйвалуемодифиед.
```json
[{
  "id": "84e17ea4-66db-4b54-8050-df8f7763f87b",
  "topic": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/testrg/providers/microsoft.appconfiguration/configurationstores/contoso",
  "subject": "https://contoso.azconfig.io/kv/Foo?label=FizzBuzz",
  "data": {
    "key": "Foo",
    "label": "FizzBuzz",
    "etag": "FnUExLaj2moIi4tJX9AXn9sakm0"
  },
  "eventType": "Microsoft.AppConfiguration.KeyValueModified",
  "eventTime": "2019-05-31T20:05:03Z",
  "dataVersion": "1",
  "metadataVersion": "1"
}]

```

Дополнительные сведения см. в статье [схема событий конфигурации приложений Azure](../event-grid/event-schema-app-configuration.md).

## <a name="practices-for-consuming-events"></a>Рекомендации по потреблению событий
Приложения, обрабатывающие события конфигурации приложения, должны следовать следующим рекомендациям:
> [!div class="checklist"]
> * Так как несколько подписок можно настроить для маршрутизации событий в один и тот же обработчик событий, важно, чтобы события из определенного источника не предполагались, а проверить раздел сообщения, чтобы убедиться, что он поступает из ожидаемой конфигурации приложения.
> * Подобным образом убедитесь, что вы готовы к обработке этого типа событий (eventType), а также не следует предполагать, что все получаемые события будут иметь ожидаемый тип.
> * Так как сообщения могут поступать не по порядку и после некоторой задержки, используйте поля ETag, чтобы понять, являются ли сведения об объектах актуальными.  Используйте поля sequencer для понимания последовательности событий для каждого отдельного объекта.
> * Используйте поле Тема для доступа к измененному ключу-value.


## <a name="next-steps"></a>Дополнительная информация

Дополнительные сведения о службе "Сетка событий" и о событиях настройки приложений Azure см. в этой статье.

- [An introduction to Azure Event Grid](../event-grid/overview.md) (Общие сведения о службе "Сетка событий Azure")
- [Маршрутизация событий конфигурации приложения Azure в пользовательскую веб-конечную точку](./howto-app-configuration-event.md)