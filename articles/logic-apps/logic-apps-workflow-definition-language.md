---
title: Ссылка на схему определения языка рабочего процесса
description: Справочник по схеме JSON и синтаксису для языка определения рабочего процесса, описывающего рабочие процессы в приложениях логики Azure
services: logic-apps
ms.suite: integration
ms.reviewer: klam, logicappspm
ms.topic: conceptual
ms.date: 05/13/2019
ms.openlocfilehash: ff2267c2d03076d3abc44d0bd1dddc64577cc7f1
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "79283866"
---
# <a name="schema-reference-guide-for-the-workflow-definition-language-in-azure-logic-apps"></a>Справочник Schema для языка определения рабочего процесса в приложениях логики Azure

При создании приложения логики в [приложениях Логики Azure](../logic-apps/logic-apps-overview.md)приложение логики имеет базовое определение рабочего процесса, описывая фактическую логику, которая выполняется в приложении логики. Это определение рабочего процесса использует [JSON](https://www.json.org/) и следует структуре, подтвержденной схемой определения языка рабочего процесса. Эта ссылка содержит обзор этой структуры и того, как схема определяет атрибуты в определении рабочего процесса.

## <a name="workflow-definition-structure"></a>Структура определения рабочего процесса

Определение рабочего процесса всегда включает триггер для мгновенного получения приложения логики, а также одно или несколько действий, которые работают после срабатывания триггера.

Ниже приведена высокоуровневая структура определения рабочего процесса.

```json
"definition": {
  "$schema": "<workflow-definition-language-schema-version>",
  "actions": { "<workflow-action-definitions>" },
  "contentVersion": "<workflow-definition-version-number>",
  "outputs": { "<workflow-output-definitions>" },
  "parameters": { "<workflow-parameter-definitions>" },
  "staticResults": { "<static-results-definitions>" },
  "triggers": { "<workflow-trigger-definitions>" }
}
```

| Атрибут | Обязательно | Описание |
|-----------|----------|-------------|
| `definition` | Да | Начальный элемент определения рабочего процесса. |
| `$schema` | Только в случае использования внешней ссылки на определение рабочего процесса | Расположение файла схемы JSON, который описывает версию языка определения рабочих процессов: <p>`https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json`</p> |
| `actions` | нет | Определения для одного или нескольких действий для выполнения во время выполнения рабочего процесса. Для получения дополнительной [информации см.](#triggers-actions) <p><p>Максимальное количество действий: 250. |
| `contentVersion` | нет | Номер версии для вашего определения рабочего процесса (по умолчанию — 1.0.0.0). Чтобы помочь определить и подтвердить правильное определение при развертывании рабочего процесса, укажите значение для использования. |
| `outputs` | нет | Определения возврата выводов из выполнения рабочего процесса. Для получения дополнительной [информации см.](#outputs) <p><p>Максимальное количество типов выходных данных: 10. |
| `parameters` | нет | Определения для одного или нескольких параметров, которые передают значения для использования во время выполнения приложения логики. Дополнительные сведения см. в разделе [Параметры](#parameters). <p><p>Максимальное количество параметров: 50. |
| `staticResults` | нет | Определения одного или нескольких статических результатов, возвращающиеся действиями в виде макетных выходов, когда в этих действиях включены статические результаты. В каждом определении `runtimeConfiguration.staticResult.name` действия атрибут ссылается `staticResults`на соответствующее определение внутри. Для получения дополнительной информации [см.](#static-results) |
| `triggers` | нет | Определения для одного или нескольких триггеров, которые создают рабочий процесс Вы можете определить более одного триггера, но только, используя язык определения рабочих процессов, а не визуально через конструктор логических приложений. Для получения дополнительной [информации см.](#triggers-actions) <p><p>Максимальное количество триггеров: 10. |
||||

<a name="triggers-actions"></a>

## <a name="triggers-and-actions"></a>Триггеры и действия

В определении рабочего процесса разделы `triggers` и `actions` определяют вызовы, которые происходят во время выполнения рабочего процесса. Синтаксис и дополнительные сведения об этих разделах см. в статье [Triggers and actions for workflow definitions in Azure Logic Apps](../logic-apps/logic-apps-workflow-actions-triggers.md) (Триггеры и действия для определений рабочих процессов в Azure Logic Apps).

<a name="parameters"></a>

## <a name="parameters"></a>Параметры

Срок службы развертывания обычно имеет различные среды для разработки, тестирования, постановки и производства. При развертывании логических приложений в различных средах, вероятно, требуется использовать различные значения, такие как строки соединения, в зависимости от потребностей развертывания. Или у вас могут быть значения, которые вы хотите повторно использовать в приложении логики без жесткого кодирования или которые часто меняются. В `parameters` разделе определения рабочего процесса можно определить или отсеивать параметры значений, которые приложение логики использует во время выполнения. Прежде всего необходимо определить эти параметры, прежде чем можно будет ссылаться на эти параметры в другом месте определения рабочего процесса.

Ниже приведена общая структура определения параметров:

```json
"parameters": {
   "<parameter-name>": {
      "type": "<parameter-type>",
      "defaultValue": <default-parameter-value>,
      "allowedValues": [ <array-with-permitted-parameter-values> ],
      "metadata": {
         "description": "<parameter-description>"
      }
   }
},
```

| Атрибут | Обязательно | Тип | Описание |
|-----------|----------|------|-------------|
| <*параметр-имя*> | Да | Строка | Имя параметра, который вы хотите определить |
| <*параметр-типа*> | Да | int, float, строка, bool, массив, объект, securestring, secureobject <p><p>**Примечание:** Для всех паролей, ключей `securestring` и `secureobject` секретов `GET` используйте или типы, потому что операция не возвращает эти типы. Для получения дополнительной информации о безопасности параметров, [см.](../logic-apps/logic-apps-securing-a-logic-app.md#secure-action-parameters) | Тип параметра. |
| <*значение параметра по умолчанию*> | Да | То же, что `type` | Значение параметра по умолчанию для использования, если значение не указывается при моменте момента работы. Атрибут `defaultValue` необходим для того, чтобы разработчик Logic App мог правильно показать параметр, но можно указать пустое значение. |
| <*массив-с-разрешенными-параметр-значениями*> | нет | Array | Массив со значениями, которые может принимать параметр. |
| <*параметр-описание*> | нет | Объект JSON | Любые другие детали параметра, такие как описание параметра |
||||

Затем создайте [шаблон Azure Resource Manager](../azure-resource-manager/templates/overview.md) для определения рабочего процесса, определите параметры шаблона, которые принимают значения, которые вы хотите при развертывании, заменить жесткие значения ссылками на параметры шаблона или определения рабочего процесса по мере необходимости и храните значения для использования при развертывании в отдельном [файле параметров.](../azure-resource-manager/templates/parameter-files.md) Таким образом, вы можете легче изменять эти значения через файл параметров без необходимости обновления и передислокации приложения логики. Для получения конфиденциальной или необходимой информации, например имен пользователей, паролей и секретов, можно хранить эти значения в Хранилище ключей Azure и получить файл параметра из хранилища ключей. Для получения дополнительной информации и примеров определения параметров на уровнях шаблона и определения рабочего процесса [см.](../logic-apps/logic-apps-azure-resource-manager-templates-overview.md)

<a name="static-results"></a>

## <a name="static-results"></a>Статические результаты

В `staticResults` атрибуте определите макет `outputs` действия `status` и то, что действие возвращается при включении элементатической настройки результата действия. В определении действия `runtimeConfiguration.staticResult.name` атрибут ссылается на имя для статического определения результата внутри. `staticResults` Узнайте, как можно [тестировать логические приложения с помощью макетных данных, настраивая статические результаты.](../logic-apps/test-logic-apps-mock-data-static-results.md)

```json
"definition": {
   "$schema": "<...>",
   "actions": { "<...>" },
   "contentVersion": "<...>",
   "outputs": { "<...>" },
   "parameters": { "<...>" },
   "staticResults": {
      "<static-result-definition-name>": {
         "outputs": {
            <output-attributes-and-values-returned>,
            "headers": { <header-values> },
            "statusCode": "<status-code-returned>"
         },
         "status": "<action-status>"
      }
   },
   "triggers": { "<...>" }
}
```

| Атрибут | Обязательно | Тип | Описание |
|-----------|----------|------|-------------|
| <*статическое-результат-определение-имя*> | Да | Строка | Название статического определения результата, на которое `runtimeConfiguration.staticResult` определение действия может ссылаться через объект. Дополнительные сведения см. в разделе [Настройки конфигурации среды выполнения](../logic-apps/logic-apps-workflow-actions-triggers.md#runtime-config-options). <p>Вы можете использовать любое уникальное имя, которое вы хотите. По умолчанию это уникальное имя прикрепится с числом, которое приращается по мере необходимости. |
| <*выход-атрибуты-и-значения-возврат*> | Да | Различается | Требования к этим атрибутам варьируются в зависимости от различных условий. Например, когда `status` `Succeeded`это `outputs` значение, атрибут включает атрибуты и значения, возвращенные как макеты выходов в действии. Если `status` это, `Failed` `outputs` атрибут включает `errors` в себя атрибут, который представляет `message` собой массив с одним или более объектами ошибки, которые имеют информацию об ошибке. |
| <*значения заголовка*> | нет | JSON | Любые значения заголовка, возвращенные действием |
| <*статус-код-возвращается*> | Да | Строка | Код состояния, возвращенный действием |
| <*действие-статус*> | Да | Строка | Статус действия, например, `Succeeded` или`Failed` |
|||||

Например, в этом определении `runtimeConfiguration.staticResult.name` действия `HTTP0` HTTP `staticResults` ссылки атрибута внутри атрибута, где определены выводы макета для действия. Атрибут `runtimeConfiguration.staticResult.staticResultOptions` указывает, что настройка статического `Enabled` результата находится в действии HTTP.

```json
"actions": {
   "HTTP": {
      "inputs": {
         "method": "GET",
         "uri": "https://www.microsoft.com"
      },
      "runAfter": {},
      "runtimeConfiguration": {
         "staticResult": {
            "name": "HTTP0",
            "staticResultOptions": "Enabled"
         }
      },
      "type": "Http"
   }
},
```

Действие HTTP возвращает выходы `HTTP0` в `staticResults`определении внутри . В этом примере для кода состояния `OK`вывод макета — это . Для значений заголовка вывод `"Content-Type": "application/JSON"`макета . Для состояния действия вывод макета `Succeeded`.

```json
"definition": {
   "$schema": "<...>",
   "actions": { "<...>" },
   "contentVersion": "<...>",
   "outputs": { "<...>" },
   "parameters": { "<...>" },
   "staticResults": {
      "HTTP0": {
         "outputs": {
            "headers": {
               "Content-Type": "application/JSON"
            },
            "statusCode": "OK"
         },
         "status": "Succeeded"
      }
   },
   "triggers": { "<...>" }
},
```

<a name="expressions"></a>

## <a name="expressions"></a>Выражения

При работе с JSON вы можете иметь литеральные значения, которые существуют во время разработки, например:

```json
"customerName": "Sophia Owen",
"rainbowColors": ["red", "orange", "yellow", "green", "blue", "indigo", "violet"],
"rainbowColorsCount": 7
```

Вы также можете использовать значения, которые не существуют до начала времени выполнения. Чтобы представить эти значения, можно использовать *выражения*, которые вычисляются во время выполнения. Выражение представляет собой последовательность, которая может содержать одну или несколько [функций](#functions), [операторов](#operators), переменных, явных значений или констант. В определении рабочего процесса вы можете использовать выражение в любом месте в строчном значении JSON, указав его вместе с префиксом (\@). При вычислении выражения, представляющего значение JSON, тело выражения извлекается без символа \@ и всегда приводит к другому значению JSON.

Например, вы можете получить значение для ранее определенного свойства `customerName`, используя функцию [parameters()](../logic-apps/workflow-definition-language-functions-reference.md#parameters) в выражении, и присвоить это значение свойству `accountName`:

```json
"customerName": "Sophia Owen",
"accountName": "@parameters('customerName')"
```

*Интерполяция строк* также позволяет использовать несколько выражений внутри строк, которые начинаются символом \@ и заключены в фигурные скобки ({}). Ниже приведен синтаксис.

```json
@{ "<expression1>", "<expression2>" }
```

Результат всегда является строкой, что делает эту функцию аналогичной функции `concat()`, например: 

```json
"customerName": "First name: @{parameters('firstName')} Last name: @{parameters('lastName')}"
```

Если у вас есть строковый литерал, начинающийся с символа \@, добавьте перед символом \@ другой символ \@ в качестве escape-символа: \@\@.

В примерах ниже показано, как вычисляются выражения.

| Значение JSON | Результат |
|------------|--------|
| "Sophia Owen" | Возвращаются символы: "Sophia Owen". |
| "array[1]" | Возвращаются символы: "array[1]". |
| "\@\@" | Эти символы возвращаются в виде строки с одним символом: "\@". |
| " \@" | Эти символы возвращаются в виде строки с двумя символами: " \@". |
|||

Для этих примеров предположим, что вы определяете "myBirthMonth" равным "January", а "myAge" равным числу 42:

```json
"myBirthMonth": "January",
"myAge": 42
```

В примерах ниже показано, как вычисляются выражения.

| Выражение JSON | Результат |
|-----------------|--------|
| "\@parameters('myBirthMonth')" | Возвращается строка: "January". |
| "\@{parameters('myBirthMonth')}" | Возвращается строка: "January". |
| "\@parameters('myAge')" | Возвращается число: 42. |
| "\@{parameters('myAge')}" | Возвращается число как строка: "42". |
| "My age is \@{parameters('myAge')}" | Возвращается строка: "My age is 42". |
| "\@concat('My age is ', string(parameters('myAge')))" | Возвращается строка: "My age is 42". |
| "My age is \@\@{parameters('myAge')}" | Возвращается строка, содержащая выражение: "My age is \@{parameters('myAge')}". |
|||

При работе с визуальными элементами в конструкторе Logic Apps вы можете создавать выражения с помощью построителя выражений, например:

![Конструктор Logic Apps > Построитель выражений](./media/logic-apps-workflow-definition-language/expression-builder.png)

Когда вы закончите, выражение появится для соответствующего свойства в определении рабочего процесса, например свойства `searchQuery`:

```json
"Search_tweets": {
  "inputs": {
    "host": {
      "connection": {
        "name": "@parameters('$connections')['twitter']['connectionId']"
      }
    }
  },
  "method": "get",
  "path": "/searchtweets",
  "queries": {
    "maxResults": 20,
    "searchQuery": "Azure @{concat('firstName','', 'LastName')}"
  }
},
```

<a name="outputs"></a>

## <a name="outputs"></a>Выходные данные

В разделе `outputs` определите данные, которые ваш рабочий процесс может вернуть при завершении работы. Например, чтобы отслеживать определенное состояние или значение из каждого выполнения, укажите, что в возвращенных выходных данных рабочего процесса должны содержаться такие данные.

> [!NOTE]
> При ответе на входящие запросы из REST API службы не используйте `outputs`. Вместо этого используйте тип действия `Response`. Дополнительные сведения см. в статье [Triggers and actions for workflow definitions in Azure Logic Apps](../logic-apps/logic-apps-workflow-actions-triggers.md) (Триггеры и действия для определений рабочих процессов в Azure Logic Apps).

Ниже приведена общая структура определения выходных данных.

```json
"outputs": {
  "<key-name>": {
    "type": "<key-type>",
    "value": "<key-value>"
  }
}
```

| Атрибут | Обязательно | Тип | Описание |
|-----------|----------|------|-------------|
| <*имя ключа*> | Да | Строка | Имя ключа для возвращаемого значения в выходных данных. |
| <*ключевой тип*> | Да | int, float, string, securestring, bool, массив, объект JSON | Тип возвращаемого значения в выходных данных. |
| <*ключевая стоимость*> | Да | То же <*типключа ключа*> | Возвращаемое значение в выходных данных. |
|||||

Чтобы получить выход из выполнения рабочего процесса, просмотрите историю выполнения приложения логики и сведения на портале Azure или воспользуйтесь [API Workflow REST.](https://docs.microsoft.com/rest/api/logic/workflows) Также можно передать выходные данные во внешние системы, например Power BI, для создания панели мониторинга.

<a name="operators"></a>

## <a name="operators"></a>Операторы

В [выражениях](#expressions) и [функциях](#functions) операторы выполняют определенные задачи, такие как ссылка на свойство или значение в массиве.

| Оператор | Задача |
|----------|------|
| ' | Чтобы использовать строковый литерал как входные данные или указать его в выражениях и функциях, поместите строку в одинарные кавычки, например `'<myString>'`. Не используйте двойные кавычки (""), так как они конфликтуют с форматированием JSON вокруг всего выражения. Пример: <p>**Правильно**: length('Hello'). </br>**Неправильно**: length("Hello"). <p>Когда вы передаете массивы или числа, их не нужно заключать в какие-либо символы. Пример: <p>**Правильно**: length([1, 2, 3]). </br>**Неправильно**: length("[1, 2, 3]"). |
| [] | Чтобы указать ссылку на значение в определенной позиции (индексе) в массиве, используйте квадратные скобки. Например, чтобы получить второй элемент в массиве: <p>`myArray[1]` |
| . | Для указания ссылки на свойство в объекте используйте оператор "точка". Например, чтобы получить свойство `name` объекта JSON `customer`: <p>`"@parameters('customer').name"` |
| ? | Оператор "вопросительный знак" позволяет ссылаться на отсутствующие свойства объекта без ошибок времени выполнения. Например, следующее выражение можно использовать для обработки отсутствующих выходных данных триггера: <p>`@coalesce(trigger().outputs?.body?.<someProperty>, '<property-default-value>')` |
|||

<a name="functions"></a>

## <a name="functions"></a>Функции

Некоторые выражения получают свои значения из действий времени выполнения, которые могут еще не существовать при запуске определения рабочего процесса. Чтобы работать с этими значениями или ссылаться на них в выражениях, можно использовать [*функции*](../logic-apps/workflow-definition-language-functions-reference.md), предоставляемые языком определения рабочего процесса.

## <a name="next-steps"></a>Дальнейшие действия

* Дополнительные сведения о [действиях и триггерах языка определения рабочих процессов](../logic-apps/logic-apps-workflow-actions-triggers.md).
* Дополнительные сведения, о том как программным способом создавать приложения логики и управлять ими с помощью [REST API рабочих процессов](https://docs.microsoft.com/rest/api/logic/workflows).
