---
title: Справочник по схеме языка определения рабочих процессов
description: Справочное руководство по схеме JSON и синтаксису для языка определения рабочего процесса, который описывает рабочие процессы в Azure Logic Apps
services: logic-apps
ms.suite: integration
ms.reviewer: klam, logicappspm
ms.topic: conceptual
ms.date: 05/13/2019
ms.openlocfilehash: ff2267c2d03076d3abc44d0bd1dddc64577cc7f1
ms.sourcegitcommit: f4f626d6e92174086c530ed9bf3ccbe058639081
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/25/2019
ms.locfileid: "75428667"
---
# <a name="schema-reference-guide-for-the-workflow-definition-language-in-azure-logic-apps"></a>Справочник по схемам для языка определения рабочего процесса в Azure Logic Apps

При создании приложения логики в [Azure Logic Apps](../logic-apps/logic-apps-overview.md)приложение логики имеет базовое определение рабочего процесса, описывающее реальную логику, выполняемую в приложении логики. Определение рабочего процесса использует [JSON](https://www.json.org/) и соответствует структуре, проверенной схемой языка определения рабочих процессов. Этот справочник содержит общие сведения об этой структуре и о том, как схема определяет атрибуты в определении рабочего процесса.

## <a name="workflow-definition-structure"></a>Структура определения рабочего процесса

Определение рабочего процесса всегда включает триггер для создания экземпляра приложения логики, а также одно или несколько действий, которые выполняются после срабатывания триггера.

Ниже приведена высокоуровневая структура определения рабочего процесса.

```json
"definition": {
  "$schema": "<workflow-definition-language-schema-version>",
  "actions": { "<workflow-action-definitions>" },
  "contentVersion": "<workflow-definition-version-number>",
  "outputs": { "<workflow-output-definitions>" },
  "parameters": { "<workflow-parameter-definitions>" },
  "staticResults": { "<static-results-definitions>" },
  "triggers": { "<workflow-trigger-definitions>" }
}
```

| attribute | Обязательно для заполнения | Description |
|-----------|----------|-------------|
| `definition` | Да | Начальный элемент определения рабочего процесса. |
| `$schema` | Только в случае использования внешней ссылки на определение рабочего процесса | Расположение файла схемы JSON, который описывает версию языка определения рабочих процессов: <p>`https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json`</p> |
| `actions` | Нет | Определения для одного или нескольких действий, выполняемых в среде выполнения рабочего процесса. Дополнительные сведения см. в разделе [триггеры и действия](#triggers-actions). <p><p>Максимальное количество действий: 250. |
| `contentVersion` | Нет | Номер версии для вашего определения рабочего процесса (по умолчанию — 1.0.0.0). Чтобы помочь определить и подтвердить правильное определение при развертывании рабочего процесса, укажите значение для использования. |
| `outputs` | Нет | Определения выходных данных, возвращаемых из запуска рабочего процесса. Дополнительные сведения см. в разделе [выходные данные](#outputs). <p><p>Максимальное количество типов выходных данных: 10. |
| `parameters` | Нет | Определения для одного или нескольких параметров, которые передают значения для использования в среде выполнения приложения логики. Дополнительные сведения см. в разделе [Параметры](#parameters). <p><p>Максимальное количество параметров: 50. |
| `staticResults` | Нет | Определения для одного или нескольких статических результатов, возвращаемых действиями в качестве макетных выходных данных, когда для этих действий включены статические результаты. В определении каждого действия атрибут `runtimeConfiguration.staticResult.name` ссылается на соответствующее определение в `staticResults`. Дополнительные сведения см. в разделе [статические результаты](#static-results). |
| `triggers` | Нет | Определения для одного или нескольких триггеров, которые создают рабочий процесс Вы можете определить более одного триггера, но только, используя язык определения рабочих процессов, а не визуально через конструктор логических приложений. Дополнительные сведения см. в разделе [триггеры и действия](#triggers-actions). <p><p>Максимальное количество триггеров: 10. |
||||

<a name="triggers-actions"></a>

## <a name="triggers-and-actions"></a>Триггеры и действия

В определении рабочего процесса разделы `triggers` и `actions` определяют вызовы, которые происходят во время выполнения рабочего процесса. Синтаксис и дополнительные сведения об этих разделах см. в статье [Triggers and actions for workflow definitions in Azure Logic Apps](../logic-apps/logic-apps-workflow-actions-triggers.md) (Триггеры и действия для определений рабочих процессов в Azure Logic Apps).

<a name="parameters"></a>

## <a name="parameters"></a>Параметры

Жизненный цикл развертывания обычно имеет различные среды для разработки, тестирования, промежуточного хранения и производства. При развертывании приложений логики в различных средах, скорее всего, потребуется использовать разные значения, например строки подключения, в зависимости от потребностей развертывания. Вы также можете иметь значения, которые вы хотите повторно использовать в приложении логики без прописано или частое изменение. В разделе `parameters` определения рабочего процесса можно определить или изменить параметры для значений, которые приложение логики использует во время выполнения. Прежде чем можно будет ссылаться на эти параметры в любом расположении в определении рабочего процесса, необходимо сначала определить эти параметры.

Ниже приведена общая структура определения параметров:

```json
"parameters": {
   "<parameter-name>": {
      "type": "<parameter-type>",
      "defaultValue": <default-parameter-value>,
      "allowedValues": [ <array-with-permitted-parameter-values> ],
      "metadata": {
         "description": "<parameter-description>"
      }
   }
},
```

| attribute | Обязательно для заполнения | Тип | Description |
|-----------|----------|------|-------------|
| <*parameter-name*> | Да | String | Имя параметра, который требуется определить |
| <*parameter-type*> | Да | int, float, String, bool, массив, Object, SecureString, secureobject <p><p>**Примечание**. для всех паролей, ключей и секретов используйте типы `securestring` или `secureobject`, так как операция `GET` не возвращает эти типы. Дополнительные сведения о защите параметров см. в разделе [рекомендации по безопасности для действий и входных параметров](../logic-apps/logic-apps-securing-a-logic-app.md#secure-action-parameters). | Тип параметра. |
| <*default-parameter-value*> | Да | То же, что `type` | Значение параметра по умолчанию, используемое, если при создании экземпляра рабочего процесса не указано значение. Атрибут `defaultValue` является обязательным, чтобы конструктор приложений логики мог правильно отобразить параметр, но можно указать пустое значение. |
| <*array-with-permitted-parameter-values*> | Нет | Array | Массив со значениями, которые может принимать параметр. |
| <*parameter-description*> | Нет | Объект JSON | Любые другие сведения о параметрах, например описание параметра. |
||||

Затем создайте [шаблон Azure Resource Manager](../azure-resource-manager/templates/overview.md) для определения рабочего процесса, определите параметры шаблона, которые принимают значения, необходимые при развертывании, замените жестко зафиксированные значения ссылками на параметры определения шаблона или рабочего процесса и сохраните значения для использования при развертывании в отдельном [файле параметров](../azure-resource-manager/templates/parameter-files.md). Таким образом, эти значения можно легко изменить с помощью файла параметров, не требуя обновления и повторного развертывания приложения логики. Для получения конфиденциальной информации или защиты, например имен пользователей, паролей и секретов, можно сохранить эти значения в Azure Key Vault и получить эти значения из хранилища ключей. Дополнительные сведения и примеры определения параметров на уровнях определения шаблона и рабочего процесса см. в разделе [Обзор: Автоматизация развертывания для приложений логики с помощью шаблонов Azure Resource Manager](../logic-apps/logic-apps-azure-resource-manager-templates-overview.md).

<a name="static-results"></a>

## <a name="static-results"></a>Статические результаты

В атрибуте `staticResults` определите макет действия `outputs` и `status`, что действие возвращает, когда параметр статического результата действия включен. В определении действия атрибут `runtimeConfiguration.staticResult.name` ссылается на имя статического определения результата в `staticResults`. Узнайте [, как тестировать приложения логики с помощью макетов данных, настроив статические результаты](../logic-apps/test-logic-apps-mock-data-static-results.md).

```json
"definition": {
   "$schema": "<...>",
   "actions": { "<...>" },
   "contentVersion": "<...>",
   "outputs": { "<...>" },
   "parameters": { "<...>" },
   "staticResults": {
      "<static-result-definition-name>": {
         "outputs": {
            <output-attributes-and-values-returned>,
            "headers": { <header-values> },
            "statusCode": "<status-code-returned>"
         },
         "status": "<action-status>"
      }
   },
   "triggers": { "<...>" }
}
```

| attribute | Обязательно для заполнения | Тип | Description |
|-----------|----------|------|-------------|
| <*static-result-definition-name*> | Да | String | Имя статического определения результата, на которое может ссылаться определение действия через объект `runtimeConfiguration.staticResult`. Дополнительные сведения см. в разделе [Настройки конфигурации среды выполнения](../logic-apps/logic-apps-workflow-actions-triggers.md#runtime-config-options). <p>Можно использовать любое уникальное имя. По умолчанию к этому уникальному имени добавляется номер, который увеличивается при необходимости. |
| <*output-attributes-and-values-returned*> | Да | Различается | Требования к этим атрибутам зависят от различных условий. Например, если `status` `Succeeded`, атрибут `outputs` содержит атрибуты и значения, возвращаемые действием в качестве фиктивных выходных данных. Если `status` имеет `Failed`, атрибут `outputs` включает атрибут `errors`, который представляет собой массив с одной или несколькими ошибками `message` объектов, которые содержат сведения об ошибке. |
| <*header-values*> | Нет | JSON | Все значения заголовка, возвращаемые действием |
| <*status-code-returned*> | Да | String | Код состояния, возвращенный действием |
| <*action-status*> | Да | String | Состояние действия, например `Succeeded` или `Failed` |
|||||

Например, в этом определении действия HTTP атрибут `runtimeConfiguration.staticResult.name` ссылается `HTTP0` в атрибуте `staticResults`, где определены макеты выходных данных для действия. Атрибут `runtimeConfiguration.staticResult.staticResultOptions` указывает, что статический параметр результата `Enabled` в действии HTTP.

```json
"actions": {
   "HTTP": {
      "inputs": {
         "method": "GET",
         "uri": "https://www.microsoft.com"
      },
      "runAfter": {},
      "runtimeConfiguration": {
         "staticResult": {
            "name": "HTTP0",
            "staticResultOptions": "Enabled"
         }
      },
      "type": "Http"
   }
},
```

Действие HTTP возвращает выходные данные в определении `HTTP0` в `staticResults`. В этом примере для кода состояния макет выходных данных `OK`. Для значений заголовков макет выходных данных `"Content-Type": "application/JSON"`. Для состояния действия макет выводится `Succeeded`.

```json
"definition": {
   "$schema": "<...>",
   "actions": { "<...>" },
   "contentVersion": "<...>",
   "outputs": { "<...>" },
   "parameters": { "<...>" },
   "staticResults": {
      "HTTP0": {
         "outputs": {
            "headers": {
               "Content-Type": "application/JSON"
            },
            "statusCode": "OK"
         },
         "status": "Succeeded"
      }
   },
   "triggers": { "<...>" }
},
```

<a name="expressions"></a>

## <a name="expressions"></a>Выражения

При работе с JSON вы можете иметь литеральные значения, которые существуют во время разработки, например:

```json
"customerName": "Sophia Owen",
"rainbowColors": ["red", "orange", "yellow", "green", "blue", "indigo", "violet"],
"rainbowColorsCount": 7
```

Вы также можете использовать значения, которые не существуют до начала времени выполнения. Чтобы представить эти значения, можно использовать *выражения*, которые вычисляются во время выполнения. Выражение представляет собой последовательность, которая может содержать одну или несколько [функций](#functions), [операторов](#operators), переменных, явных значений или констант. В определении рабочего процесса вы можете использовать выражение в любом месте в строчном значении JSON, указав его вместе с префиксом (\@). При вычислении выражения, представляющего значение JSON, тело выражения извлекается без символа \@ и всегда приводит к другому значению JSON.

Например, вы можете получить значение для ранее определенного свойства `customerName`, используя функцию [parameters()](../logic-apps/workflow-definition-language-functions-reference.md#parameters) в выражении, и присвоить это значение свойству `accountName`:

```json
"customerName": "Sophia Owen",
"accountName": "@parameters('customerName')"
```

*Интерполяция строк* также позволяет использовать несколько выражений внутри строк, которые начинаются символом \@ и заключены в фигурные скобки ({}). Ниже приведен синтаксис.

```json
@{ "<expression1>", "<expression2>" }
```

Результат всегда является строкой, что делает эту функцию аналогичной функции `concat()`, например: 

```json
"customerName": "First name: @{parameters('firstName')} Last name: @{parameters('lastName')}"
```

Если у вас есть строковый литерал, начинающийся с символа \@, добавьте перед символом \@ другой символ \@ в качестве escape-символа: \@\@.

В примерах ниже показано, как вычисляются выражения.

| Значение JSON | Результат |
|------------|--------|
| "Sophia Owen" | Возвращаются символы: "Sophia Owen". |
| "array[1]" | Возвращаются символы: "array[1]". |
| "\@\@" | Эти символы возвращаются в виде строки с одним символом: "\@". |
| " \@" | Эти символы возвращаются в виде строки с двумя символами: " \@". |
|||

Для этих примеров предположим, что вы определяете "myBirthMonth" равным "January", а "myAge" равным числу 42:

```json
"myBirthMonth": "January",
"myAge": 42
```

В примерах ниже показано, как вычисляются выражения.

| Выражение JSON | Результат |
|-----------------|--------|
| "\@parameters('myBirthMonth')" | Возвращается строка: "January". |
| "\@{parameters('myBirthMonth')}" | Возвращается строка: "January". |
| "\@parameters('myAge')" | Возвращается число: 42. |
| "\@{parameters('myAge')}" | Возвращается число как строка: "42". |
| "My age is \@{parameters('myAge')}" | Возвращается строка: "My age is 42". |
| "\@concat('My age is ', string(parameters('myAge')))" | Возвращается строка: "My age is 42". |
| "My age is \@\@{parameters('myAge')}" | Возвращается строка, содержащая выражение: "My age is \@{parameters('myAge')}". |
|||

При работе с визуальными элементами в конструкторе Logic Apps вы можете создавать выражения с помощью построителя выражений, например:

![Конструктор Logic Apps > Построитель выражений](./media/logic-apps-workflow-definition-language/expression-builder.png)

Когда вы закончите, выражение появится для соответствующего свойства в определении рабочего процесса, например свойства `searchQuery`:

```json
"Search_tweets": {
  "inputs": {
    "host": {
      "connection": {
        "name": "@parameters('$connections')['twitter']['connectionId']"
      }
    }
  },
  "method": "get",
  "path": "/searchtweets",
  "queries": {
    "maxResults": 20,
    "searchQuery": "Azure @{concat('firstName','', 'LastName')}"
  }
},
```

<a name="outputs"></a>

## <a name="outputs"></a>Выходные данные

В разделе `outputs` определите данные, которые ваш рабочий процесс может вернуть при завершении работы. Например, чтобы отслеживать определенное состояние или значение из каждого выполнения, укажите, что в возвращенных выходных данных рабочего процесса должны содержаться такие данные.

> [!NOTE]
> При ответе на входящие запросы из REST API службы не используйте `outputs`. Вместо этого используйте тип действия `Response`. Дополнительные сведения см. в статье [Triggers and actions for workflow definitions in Azure Logic Apps](../logic-apps/logic-apps-workflow-actions-triggers.md) (Триггеры и действия для определений рабочих процессов в Azure Logic Apps).

Ниже приведена общая структура определения выходных данных.

```json
"outputs": {
  "<key-name>": {
    "type": "<key-type>",
    "value": "<key-value>"
  }
}
```

| attribute | Обязательно для заполнения | Тип | Description |
|-----------|----------|------|-------------|
| <*key-name*> | Да | String | Имя ключа для возвращаемого значения в выходных данных. |
| <*key-type*> | Да | int, float, string, securestring, bool, массив, объект JSON | Тип возвращаемого значения в выходных данных. |
| <*значение ключа*> | Да | Совпадение с кодом <*key-type*> | Возвращаемое значение в выходных данных. |
|||||

Чтобы получить выходные данные выполнения рабочего процесса, изучите историю выполнения приложения логики и сведения в портал Azure или используйте [REST API рабочего процесса](https://docs.microsoft.com/rest/api/logic/workflows). Также можно передать выходные данные во внешние системы, например Power BI, для создания панели мониторинга.

<a name="operators"></a>

## <a name="operators"></a>Операторы

В [выражениях](#expressions) и [функциях](#functions) операторы выполняют определенные задачи, такие как ссылка на свойство или значение в массиве.

| Оператор | Задача |
|----------|------|
| ' | Чтобы использовать строковый литерал как входные данные или указать его в выражениях и функциях, поместите строку в одинарные кавычки, например `'<myString>'`. Не используйте двойные кавычки (""), так как они конфликтуют с форматированием JSON вокруг всего выражения. Пример. <p>**Правильно**: length('Hello'). </br>**Неправильно**: length("Hello"). <p>Когда вы передаете массивы или числа, их не нужно заключать в какие-либо символы. Пример. <p>**Правильно**: length([1, 2, 3]). </br>**Неправильно**: length("[1, 2, 3]"). |
| [] | Чтобы указать ссылку на значение в определенной позиции (индексе) в массиве, используйте квадратные скобки. Например, чтобы получить второй элемент в массиве: <p>`myArray[1]` |
| . | Для указания ссылки на свойство в объекте используйте оператор "точка". Например, чтобы получить свойство `name` объекта JSON `customer`: <p>`"@parameters('customer').name"` |
| ? | Оператор "вопросительный знак" позволяет ссылаться на отсутствующие свойства объекта без ошибок времени выполнения. Например, следующее выражение можно использовать для обработки отсутствующих выходных данных триггера: <p>`@coalesce(trigger().outputs?.body?.<someProperty>, '<property-default-value>')` |
|||

<a name="functions"></a>

## <a name="functions"></a>Функции

Некоторые выражения получают значения из действий среды выполнения, которые могут еще не существовать при запуске определения рабочего процесса. Чтобы работать с этими значениями или ссылаться на них в выражениях, можно использовать [*функции*](../logic-apps/workflow-definition-language-functions-reference.md), предоставляемые языком определения рабочего процесса.

## <a name="next-steps"></a>Дальнейшие действия

* Дополнительные сведения о [действиях и триггерах языка определения рабочих процессов](../logic-apps/logic-apps-workflow-actions-triggers.md).
* Дополнительные сведения, о том как программным способом создавать приложения логики и управлять ими с помощью [REST API рабочих процессов](https://docs.microsoft.com/rest/api/logic/workflows).
