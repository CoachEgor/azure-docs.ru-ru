---
title: Отправка и получение сообщений AS2 для B2B
description: Обмен сообщениями AS2 для сценариев интеграции предприятий B2B с помощью приложений логики Azure с пакетом корпоративной интеграции
services: logic-apps
ms.suite: integration
author: divyaswarnkar
ms.author: divswa
ms.reviewer: jonfan, estfan, logicappspm
ms.topic: article
ms.date: 02/27/2020
ms.openlocfilehash: 0e7c34e42d0ab68a5dab9718075f02a85322ce6c
ms.sourcegitcommit: b55d7c87dc645d8e5eb1e8f05f5afa38d7574846
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/16/2020
ms.locfileid: "81458834"
---
# <a name="exchange-as2-messages-for-b2b-enterprise-integration-in-azure-logic-apps-with-enterprise-integration-pack"></a>Обмен сообщениями AS2 для интеграции с предприятием B2B в Azure Logic Apps с помощью Пакета интеграции Enterprise

> [!IMPORTANT]
> Оригинальный разъем AS2 в настоящее время унижается, поэтому убедитесь, что вы используете **РАЗъем AS2 (v2)** вместо. Эта версия обеспечивает те же возможности, что и оригинальная версия, является родиной времени выполнения logic Apps и обеспечивает значительное улучшение производительности с точки зрения пропускной способности и размера сообщений. Кроме того, родной разъем v2 не требует создания подключения к учетной записи интеграции. Вместо этого, как описано в предпосылках, убедитесь, что вы связываете учетную запись интеграции с логическим приложением, где вы планируете использовать разъем.

Для работы с сообщениями AS2 в приложениях Azure Logic Apps можно использовать разъем AS2, который обеспечивает триггеры и действия для управления связью AS2. Например, для установления безопасности и надежности при передаче сообщений можно использовать следующие действия:

* [ **As2 Encode** действий](#encode) для предоставления шифрования, цифровой подписания и подтверждения через уведомления о предоставлении сообщений (MDN), которые помогают поддерживать неотказ. Например, это действие применяется AS2/HTTP заголовки и выполняет эти задачи при настройке:

  * Подписывает исходящие сообщения.
  * Шифрует исходящие сообщения.
  * Сжимает сообщение.
  * Передает имя файла в заголовке MIME.

* [ **Действия AS2 Декодируют** ](#decode) для предоставления расшифровки, цифровой подписи и подтверждения через Уведомления об отправке сообщений (MDN). Например, это действие выполняет следующие задачи:

  * Процессы AS2/HTTP заголовки.
  * Примирения получили MDNs с исходными исходящими сообщениями.
  * Обновления и соотнесения записей в базе данных о неотказе.
  * Записи записей для отчетности о состоянии AS2.
  * Выводы содержимого полезной нагрузки как базовое64-кодированное.
  * Определяет, требуются ли MDN. На основе соглашения AS2 определяет, должны ли MDN быть синхронными или асинхронными.
  * Генерирует синхронные или асинхронные MDN на основе соглашения AS2.
  * Устанавливает токены корреляции и свойства на MDNs.

  Это действие также выполняет следующие задачи при настройке:

  * Проверяет подпись.
  * Расшифровывает сообщения.
  * Разгермяет сообщение.
  * Проверьте и запретите дубликаты идентификатора сообщений.

В этой статье показано, как добавить действия кодирования и декодирования AS2 в существующее приложение логики.

## <a name="prerequisites"></a>Предварительные требования

* Подписка Azure. Если у вас еще нет подписки Azure, [получите бесплатную учетную запись Azure](https://azure.microsoft.com/free/).

* Логическое приложение, откуда вы хотите использовать разъем AS2 и триггер, который запускает рабочий процесс приложения логики. Разъем AS2 предоставляет только действия, а не триггеры. Если вы не работали с приложениями логики, см. руководства по [Azure Logic Apps](../logic-apps/logic-apps-overview.md) и [созданию первого приложения логики](../logic-apps/quickstart-create-first-logic-app-workflow.md).

* [Интеграционная учетная запись,](../logic-apps/logic-apps-enterprise-integration-create-integration-account.md) связанная с подпиской Azure и связанная с логическим приложением, в котором планируется использовать разъем AS2. Приложение логики и учетная запись интеграции должны существовать в одном месте или в регионе Azure.

* По крайней мере, два [торговых партнера,](../logic-apps/logic-apps-enterprise-integration-partners.md) которые вы уже определили в вашей интеграционной учетной записи, используя квалификационный турнир AS2.

* Прежде чем использовать разъем AS2, необходимо создать [соглашение](../logic-apps/logic-apps-enterprise-integration-agreements.md) AS2 между вашими торговыми партнерами и хранить это соглашение на вашем интеграционном счете.

* Если вы используете [Azure Key Vault](../key-vault/general/overview.md) для управления сертификатами, убедитесь, что ключи хранилища разрешают операции **шифрования** и **расшифровки.** В противном случае действия кодирования и декодирования не удается.

  На портале Azure перейдите к ключу в хранилище ключей, просмотрите **разрешенные операции**ключа и подтвердите, что, например, выбраны операции **шифрования** и **расшифровки:**

  ![Проверка ключевых операций хранилища](media/logic-apps-enterprise-integration-as2/key-vault-permitted-operations.png)

<a name="encode"></a>

## <a name="encode-as2-messages"></a>Кодирование сообщений AS2

1. Если вы еще не сделали этого, на [портале Azure,](https://portal.azure.com)откройте свое логическое приложение в Logic App Designer.

1. В дизайнере добавьте новое действие в приложение логики.

1. В разделе **Выберите действие** под полем поиска выберите **Все**. В поле поиска введите "as2 кодирования" и убедитесь, что вы выбираете as2 (v2) действие: **AS2 Encode**

   ![Выберите "AS2 Кодирование"](./media/logic-apps-enterprise-integration-as2/select-as2-encode.png)

1. Теперь предоставьте информацию по этим свойствам:

   | Свойство | Описание |
   |----------|-------------|
   | **Сообщение для кодирования** | Полезная нагрузка сообщения |
   | **AS2 от** | Идентификатор отправителя сообщений, указанный в соглашении AS2 |
   | **AS2 в** | Идентификатор приемника сообщений, указанный в соглашении AS2 |
   |||

   Пример:

   ![Свойства кодирования сообщений](./media/logic-apps-enterprise-integration-as2/as2-message-encoding-details.png)

> [!TIP]
> Если у вас возникли проблемы при отправке подписанных или зашифрованных сообщений, подумайте о том, чтобы попробовать различные форматы алгоритмов SHA256. Спецификация AS2 не предоставляет никакой информации о форматах SHA256, поэтому каждый поставщик использует свою собственную реализацию или формат.

<a name="decode"></a>

## <a name="decode-as2-messages"></a>Декодирование сообщений AS2

1. Если вы еще не сделали этого, на [портале Azure,](https://portal.azure.com)откройте свое логическое приложение в Logic App Designer.

1. В дизайнере добавьте новое действие в приложение логики.

1. В разделе **Выберите действие** под полем поиска выберите **Все**. В поле поиска введите "as2 декодирование" и убедитесь, что вы выберете действие AS2 (v2): **AS2 Decode**

   ![Выберите "AS2 Декодирование"](media/logic-apps-enterprise-integration-as2/select-as2-decode.png)

1. Для **кодирования Сообщения** и свойств **заголовков сообщений** выберите эти значения из предыдущих выводов триггеров или действий.

   Например, предположим, что приложение логики получает сообщения через триггер Запроса. Можно выбрать выходы из этого триггера.

   ![Выберите текст и заголовки из выходных данных запроса](media/logic-apps-enterprise-integration-as2/as2-message-decoding-details.png)

## <a name="sample"></a>Пример

Чтобы попробовать развернуть полностью рабочее приложение логики и пример сценария AS2, см. [шаблон и сценарий приложения логики AS2](https://azure.microsoft.com/documentation/templates/201-logic-app-as2-send-receive/).

## <a name="connector-reference"></a>Справочник по соединителям

Для получения более подробной информации об этом разъеме, таких как действия и ограничения, описанные в файле Swagger разъема, смотрите [страницу ссылки разъема.](https://docs.microsoft.com/connectors/as2/) 

> [!NOTE]
> Для логических приложений в [среде служб интеграции (ISE)](../logic-apps/connect-virtual-network-vnet-isolated-environment-overview.md)оригинальная версия, маркированная ISE, использует вместо этого [ограничения сообщений ISE.](../logic-apps/logic-apps-limits-and-config.md#message-size-limits)

## <a name="next-steps"></a>Следующие шаги

* См. дополнительные сведения о других [соединителях Logic Apps](../connectors/apis-list.md).
