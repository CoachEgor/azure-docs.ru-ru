---
title: Что такое брандмауэр Azure веб-приложения для входной двери Azure? (предварительная версия)
description: Узнайте как Azure брандмауэр веб-приложения для службы двери Azure защищает веб-приложений от атак злоумышленников.
services: frontdoor
documentationcenter: ''
author: KumudD
ms.service: frontdoor
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 05/31/2019
ms.author: kumud;tyao
ms.openlocfilehash: 122e9687ee313edff34e5a4fd9a44b1026a63811
ms.sourcegitcommit: d4dfbc34a1f03488e1b7bc5e711a11b72c717ada
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/13/2019
ms.locfileid: "66478784"
---
# <a name="what-is-azure-web-application-firewall-for-azure-front-door"></a>Что такое брандмауэр Azure веб-приложения для входной двери Azure?

Брандмауэр веб-приложения Azure (WAF) обеспечивает централизованную защиту веб-приложений, которые доставляются на глобальном уровне с помощью Azure Front Door. Он разработан и предназначен для защиты веб-служб от распространенных эксплойтов и уязвимостей, обеспечения высокой доступности службы для пользователей и соблюдения требований соответствия.


Веб-приложений часто направлены вредоносные атаки, например отказ службы наводнения, атаки путем внедрения кода SQL и атак с использованием межузловых сценариев. Эти вредоносных атак может привести к потере данных и сбоя службы, значительные угрозу владельцам веб-приложений.

Предотвращение таких атак в коде приложения может быть сложной задачей, требующей неукоснительного обслуживания, установки исправлений и мониторинга на различных уровнях топологии приложения. Централизованный брандмауэр веб-приложения значительно упрощает управление безопасностью и помогает администраторам защищать приложение от угроз вторжения. Кроме того решение WAF может реагировать на угрозы безопасности быстрее по установке исправлений известных уязвимостей в центральном расположении, а не защитой каждого отдельного веб-приложения.

WAF для входной двери — это глобальный, так и централизованное решение. Он развертывается в сети Azure граничных расположениях по всему миру и каждого входящего запроса для веб-приложения включенным WAF, доставленных двери проверяется на границе сети. Это позволяет WAF для предотвращения атак злоумышленников, близкое к источникам атаки, прежде чем попасть в виртуальной сети, а также предлагает глобальной защиты в нужном масштабе без ущерба для производительности. Можно легко связать политику WAF любому профилю двери в вашей подписке, и новые правила могут развертываться в течение минут, что позволяет быстро реагировать на изменяющиеся шаблоны угроз.

![Брандмауэр Azure веб-приложения](./media/waf-overview/web-application-firewall-overview2.png)

Также можно включить с помощью шлюза приложений Azure WAF. Дополнительные сведения см. в разделе [брандмауэр веб-приложения](../application-gateway/waf-overview.md).

## <a name="waf-policy-and-rules"></a>WAF политики и правил

Можно настроить политику WAF и связать политики, чтобы один или несколько двери внешних интерфейсов для защиты. Политика WAF состоит из двух типов правил безопасности:

- Настраиваемые правила, созданные пользователем клиента.

- наборы правил для управляемого кода, которые представляют собой коллекцию управляемых Azure предварительно настроенный набор правил.

Если они присутствуют, настраиваемые правила обрабатываются перед обработкой правила в наборе правил для управляемого кода. Правило состоит из условия соответствия, приоритет и действие. Поддерживает следующие типы действий:: Разрешить, блок, ЖУРНАЛА и ПЕРЕНАПРАВЛЕНИЯ. Можно создать полностью настраиваемого политику, которая соответствует вашим требованиям защиты конкретного приложения, объединяя управляемых и настраиваемых правил.

Правила, в рамках политики обрабатываются в порядке приоритета, где приоритет — уникальное целое число, которое определяет порядок обработки правил. Меньше целочисленное значение обозначает более высокий приоритет, и те, проверяются перед правилами с более высоким значением целое число. После сопоставляется правило, соответствующее действие, которая была определена в правиле применяется к запросу. После обработки такого сопоставления правил с более низким приоритетом дальнейшей не обрабатываются.

Веб-приложения, предоставленные двери может иметь только одну политику WAF, связанные с ним одновременно. Тем не менее может иметь конфигурацию двери без политикам WAF, связанные с ней. Если присутствует политику WAF, они реплицируются на все наши граничных расположениях, чтобы обеспечить согласованность в политиках безопасности по всему миру.

## <a name="waf-modes"></a>Режимы WAF

WAF политики можно настроить для запуска в двух режимов:

- **Режим обнаружения:** При запуске в режиме обнаружения, WAF выполняет только всех остальных действий, отличных от мониторов и записывает запрос и его из этих правил WAF журналы WAF. Вы можете включить ведение журнала диагностики для входной двери (Если вы используете портал, это можно сделать, выбрав **диагностики** на портале Azure).

- **Режим предотвращения:** При настройке для работы в режиме предотвращения WAF принимает указанное действие, если запрос соответствует правилу, и если соответствие найдено, вычисляются все остальные правила с более низким приоритетом. Любые соответствующие запросы также записываются в журналы WAF.

## <a name="waf-actions"></a>Действия WAF

WAF клиенты могут выбрать для выполнения в одно из действий, если запрос удовлетворяет условиям правила:

- **Разрешить:**  Запрос проходит через брандмауэр веб-приложения и будут перенаправлены в серверной части. Дальнейшая ниже правила приоритета можно заблокировать запрос.
- **Блок:** Запрос заблокирован и WAF отправляет ответ клиенту, если Пересылка запроса на серверной стороне.
- **Журнал:**  Запрос записывается в журналы WAF и WAF продолжает вычислять ниже приоритет правила.
- **Перенаправления:** WAF перенаправляет запрос на указанный URI. URI, указанный — это параметр уровня политики. После настройки все запросы, которые соответствуют **перенаправления** действие будет отправляться этот URI.

## <a name="waf-rules"></a>Правила WAF

Политика WAF может состоять из двух типов правил безопасности - настраиваемые правила, созданные пользователем клиента и управляемые наборы правил, управляемые Azure предварительно настроенный набор правил.

### <a name="custom-authored-rules"></a>Настраиваемые правила, созданные

Настраиваемые правила WAF можно настроить следующим образом:

- **И черный списки разрешенных IP-адресов:** Можно настроить пользовательские правила для управления доступом к веб-приложений на основе списка клиентских IP-адресов или диапазонов IP-адресов. Поддерживаются типы адресов IPv4 и IPv6. Этот список можно настроить так, чтобы блокировать или разрешать эти запросы, в которых исходный IP-адрес соответствует IP-адрес в списке.

- **Управление доступом географических на основе:** Можно настроить пользовательские правила для управления доступом к веб-приложений на основе кода страны, связанный с IP-адрес клиента.

- **Управление доступом на основе параметров HTTP.** Можно настроить пользовательские правила на основе строки, соответствующие параметры запроса HTTP/HTTPS, например строки запроса, args POST, URI запроса, заголовок запроса и тексте запроса.

- **Запросить управление доступом на основе метода:** Можно настроить пользовательские правила на основе метода запроса HTTP запроса, такой как GET, HEAD или PUT.

- **Ограничение размера:** Можно настроить пользовательские правила, исходя из длины определенные части запроса, например строку запроса, Uri, или текст запроса.

- **Правила ограничения частоты:** Правило управления скоростью позволяет ограничить аномально интенсивный трафик, поступающий с какого-либо IP-адреса клиента. Можно настроить пороговое значение на количество веб-запросов из IP-адрес клиента разрешены за период до минуты. Это отличается от IP-адрес на основе списка разрешенных и запрещенных пользовательских правило, в котором либо разрешает все или блоки, которые все запросов от IP-адрес клиента. Ограничение скорости могут сочетаться с дополнительные условия соответствия например параметры HTTP (S), которые соответствуют для детального скорость элемента управления.

### <a name="azure-managed-rule-sets"></a>Наборы правил, управляемая Azure

Наборы правил, управляемые Azure предоставляют простой способ развернуть защиту от общего набора угроз безопасности. Так как такие наборы правил, которые управляются Azure, при необходимости для защиты от новых атак подписей обновляются правила. В общедоступной предварительной версии управляемые Azure по умолчанию набором правил содержит правила для следующих категорий угроз:

- Межузловых сценариев
- Атаки на Java
- Включение локального файла
- Атаки путем внедрения кода PHP
- Удаленное выполнение команды
- Включение удаленных файлов
- Фиксация сеанса
- Защита от внедрения кода SQL.
- Злоумышленники протокола

Значение по умолчанию правило номер версии будет увеличиваться при добавлении новых подписей атаки в набор правил.
Набор правил по умолчанию включена по умолчанию в режиме обнаружения в ваших политиках WAF. Вы можете включить или отключить отдельные правила в набор по умолчанию правила в соответствии с требованиями приложения. Можно также задать определенные действия (Разрешить/блок/REDIRECT/LOG) для каждого правила. Действие по умолчанию — блок. Кроме того настраиваемые правила можно настроить в одну и ту же политику WAF, если вы хотите пропустить любой из предварительно настроенных правил в набор по умолчанию правило.
Настраиваемые правила всегда применяются до оценки правила в набор по умолчанию правило. Если запрос соответствует настраиваемое правило, соответствующее действие правило применяется и заблокированы или передать серверной части, без вызова все дополнительные пользовательские правила или правила в набор по умолчанию правила запроса. Кроме того вы можете удалить набор правил по умолчанию на основе политик WAF.


### <a name="bot-protection-rule-preview"></a>Правила защиты программ-роботов (Предварительная версия)

Набор правил защиты управляемых программ-роботов можно включить для вашего WAF выполнять пользовательские действия для запросов от известных вредоносных IP-адресов. IP-адреса предоставляются из функции анализа угроз Майкрософт веб-канала. [Intelligent Security Graph](https://www.microsoft.com/security/operations/intelligence) лежащих в основе анализа угроз Майкрософт и используется несколько служб, включая Центр безопасности Azure.

![Набор правил защиты программ-роботов](./media/waf-front-door-configure-bot-protection/BotProtect2.png)

> [!IMPORTANT]
> Набор правил защиты программ-роботов в настоящее время находится в общедоступной предварительной версии и предоставляется с соглашением об уровне обслуживания предварительной версии. Некоторые функции могут не поддерживаться или их возможности могут быть ограничены.  См. [дополнительные условия использования для предварительных версий Microsoft Azure](https://azure.microsoft.com/support/legal/preview-supplemental-terms/).

Если включена защита от программ-роботов, входящие запросы, которые соответствуют IP-адреса клиентов вредоносных программ-роботов регистрируются в журнале FrontdoorWebApplicationFirewallLog. Вы может получить доступ к журналам WAF из учетной записи хранения, концентратор или log analytics событий. 

## <a name="configuration"></a>Параметр Configuration

Настройка и развертывание всех типов правил WAF, полностью поддерживаются с помощью портала Azure, интерфейсов REST API, шаблонов Azure Resource Manager и Azure PowerShell.

## <a name="monitoring"></a>Мониторинг

Мониторинг WAF во входной двери интегрируется с Azure Monitor для отслеживания предупреждений и легко отслеживать тенденции трафика.

## <a name="next-steps"></a>Дальнейшие действия

- Узнайте, как [настроить политику на WAF двери с помощью портала Azure](waf-front-door-create-portal.md)