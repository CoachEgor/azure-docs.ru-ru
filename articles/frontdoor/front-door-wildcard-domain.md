---
title: Передняя дверь Azure - Поддержка доменов подстановочных знаков
description: Эта статья поможет вам понять, как Azure Front Door поддерживает отображение и управление доменами подстановочных знаков в списке пользовательских доменов.
services: frontdoor
author: sharad4u
ms.service: frontdoor
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 03/10/2020
ms.author: sharadag
ms.openlocfilehash: 6d8a6d6f0b05b9b7fd0144959c82b6a2c9e659a3
ms.sourcegitcommit: d57d2be09e67d7afed4b7565f9e3effdcc4a55bf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/22/2020
ms.locfileid: "81768302"
---
# <a name="wildcard-domains"></a>Домены Wildcard

Помимо доменов и поддоменов вершины, вы можете сопоставить доменное имя подстановочных знаков в список передних хостов или пользовательских доменов в профиле Azure Front Door. Наличие доменов подстановочных знаков в конфигурации Azure Front Door упрощает поведение трафика для нескольких поддоменов для API, приложения или веб-сайта из одного и того же правила трассировки. Вам не нужно изменять конфигурацию, чтобы добавить или указать каждый поддомен отдельно. В качестве примера можно определить область `customer1.contoso.com` `customer2.contoso.com`наклона `customerN.contoso.com` для, и с помощью того же `*.contoso.com`правила разгрома и добавления домена подстановочных знаков.

Ключевые сценарии, которые улучшаются при поддержке доменов подстановочных знаков, включают:

- Вам не нужно на борту каждого поддона в профиле Azure Front Door, а затем включить HTTPS, чтобы связать сертификат для каждого поддона.
- Вам больше не требуется менять конфигурацию производственной двери Azure Front Door, если приложение добавляет новый поддомен. Ранее необходимо было добавить поддомен, привязать к нему сертификат, прикрепить политику брандмауэра веб-приложений (WAF), а затем добавить домен в различные правила разгрома.

> [!NOTE]
> В настоящее время домены подстановочных знаков поддерживаются только через API, PowerShell и Azure CLI. Поддержка добавления и управления доменами подстановочных знаков на портале Azure недоступна.

## <a name="adding-wildcard-domains"></a>Добавление доменов подстановочных знаков

Вы можете добавить домен подстановочного знака под разделом для передних хостов или доменов. Как и в поддоменах, Azure Front Door подтверждает, что для вашего домена подстановочных знаков имеется отображение записей CNAME. Это dNS отображение может быть `*.contoso.com` прямым CNAME запись отображение, как отображены `contoso.azurefd.net`на . Или вы можете использовать временное отображение afdverify. Например, `afdverify.contoso.com` отображается для `afdverify.contoso.azurefd.net` проверки карты записи CNAME для подстановочного знака.

> [!NOTE]
> Azure DNS поддерживает записи с подстановочными знаками.

Вы можете добавить как можно больше одноуровневых поддоменов домена подстановочных знаков в передних хостах, вплоть до пределов передних хостов. Эта функциональность может потребоваться для:

- Определение другого маршрута для поддомена, чем остальные домены (из домена подстановочных знаков).

- Наличие другой политики WAF для конкретного поддомена. Например, `*.contoso.com` позволяет `foo.contoso.com` добавлять без необходимости снова доказать право собственности на домены. Но это не `foo.bar.contoso.com` позволяет, потому что это не `*.contoso.com`один уровень поддомена . Чтобы `foo.bar.contoso.com` добавить без дополнительной `*.bar.contosonews.com` проверки владения доменом, необходимо добавить.

Вы можете добавить домены подстановочных знаков и их поддомены с определенными ограничениями:

- Если домен подстановочного знака добавлен в профиль Azure Front Door:
  - Домен подстановочного знака не может быть добавлен в любой другой профиль Azure Front Door.
  - Поддомены первого уровня домена подстановочных знаков не могут быть добавлены в другой профиль Azure Front Door или профиль сети доставки содержимого Azure.
- Если поддомен домена подстановочных знаков добавляется в профиль Azure Front Door или профиль Сети доставки содержимого Azure, то домен подстановочных знаков не может быть добавлен в другие профили Azure Front Door.
- Если два профиля (Azure Front Door или Azure Content Delivery Network) имеют различные поддомены корневого домена, то домены подстановочных знаков не могут быть добавлены ни к одному из профилей.

## <a name="certificate-binding"></a>Связывание сертификата

Для принятия трафика HTTPS на домене подстановочных знаков необходимо включить HTTPS в домене подстановочных знаков. Привязка сертификата для домена подстановочных знаков требует сертификата подстановочного знака. То есть, имя предмета сертификата также должно иметь домен подстановочного знака.

> [!NOTE]
> В настоящее время для включения HTTPS для доменов подстановочных знаков доступен только пользовательский сертификат SSL. Управляемые сертификаты Azure Front Door не могут использоваться для доменов подстановочных знаков.

Вы можете использовать тот же сертификат подстановочного знака из Azure Key Vault или из управляемых сертификатов Azure Front Door для поддоменов.

Если субдомен добавляется для домена подстановочных знаков, у которого уже есть сертификат, связанный с ним, то HTTPS для поддомена не может быть отключен. В поддомене используется привязка сертификата для домена подстановочных знаков, если только другой сертификат Key Vault или Azure Front Door не переопределяет его.

## <a name="waf-policies"></a>Политики WAF

Политики WAF могут быть прикреплены к доменам подстановочных знаков, как и к другим доменам. К поддомену домена подстановочных знаков может быть применена другая политика WAF. Для поддоменов необходимо указать политику WAF, которая будет использоваться, даже если это та же политика, что и домен подстановочных знаков. Поддомены *автоматически не* наследуют политику WAF из домена подстановочных знаков.

Если вы не хотите, чтобы политика WAF запускались для поддона, можно создать пустую политику WAF без управляемых или пользовательских правил.

## <a name="routing-rules"></a>Правила маршрутизации

При настройке правила разгрома можно выбрать домен подстановочного знака в качестве переднего узла. Вы также можете иметь различное поведение маршрута для доменов подстановочных знаков и поддоменов. Как описано в [How Azure Front Door делает маршрут соответствия](front-door-route-matching.md), наиболее конкретные соответствие для домена через различные правила маршрутизации выбирается во время выполнения.

> [!IMPORTANT]
> Вы должны иметь соответствующие шаблоны путей через правила маршрутизании, или ваши клиенты будут видеть сбои. Например, у вас есть два правила`*.foo.com/*` маршрутизания, такие как Route 1`bar.foo.com/somePath/*` (отображено в пуле A) и Route 2 (отображено к пулу B). Затем поступает запрос на `bar.foo.com/anotherPath/*`. Azure Front Door выбирает Route 2 на основе более конкретного совпадения домена, только чтобы найти не совпадающие шаблоны путей на маршрутах.

## <a name="next-steps"></a>Следующие шаги

- Узнайте, как [создать профиль Передней двери Azure.](quickstart-create-front-door.md)
- Узнайте, как [добавить пользовательский домен на передней двери Azure.](front-door-custom-domain.md)
- Узнайте, как [включить HTTPS на пользовательском домене.](front-door-custom-domain-https.md)
