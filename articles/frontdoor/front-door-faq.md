---
title: Лазурная передняя дверь - Часто задаваемые вопросы
description: Эта страница дает ответы на часто задаваемые вопросы о передней двери Azure
services: frontdoor
documentationcenter: ''
author: sohamnchatterjee
ms.service: frontdoor
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 04/13/2020
ms.author: sohamnc
ms.openlocfilehash: e2785baab27f5bfc996b57607816062195a19b2b
ms.sourcegitcommit: 7e04a51363de29322de08d2c5024d97506937a60
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81313757"
---
# <a name="frequently-asked-questions-for-azure-front-door"></a>Часто задаваемые вопросы для передней двери Azure

В этой статье ответы на общие вопросы об особенностях и функциональности Azure Front Door. Если вы не нашли ответ на свой вопрос, свяжитесь с нами, используя следующие каналы (в порядке эскалации):

1. Раздел комментариев этой статьи.
2. [Azure Передняя дверь UserVoice](https://feedback.azure.com/forums/217313-networking?category_id=345025).
3. **Поддержка майкрософт:** Чтобы создать новый запрос на поддержку на портале Azure на вкладке **Справка,** выберите кнопку **поддержки Справка** и затем выберите **новый запрос на поддержку.**

## <a name="general"></a>Общие сведения

### <a name="what-is-azure-front-door"></a>Что такое Azure Front Door

Azure Front Door — это сеть доставки приложений (ADN) как сервис, предлагающий различные возможности балансировки нагрузки 7 уровня 7 для ваших приложений. Он обеспечивает динамическое ускорение сайта (DSA) наряду с глобальной балансировкой нагрузки с практически в режиме реального времени. Это высокодоступная и масштабируемая служба, которая полностью управляется Azure.

### <a name="what-features-does-azure-front-door-support"></a>Какие функции поддерживает Azure Front Door?

Azure Front Door поддерживает динамическое ускорение сайта (DSA), разгрузку TLS/SSL и отогивание до конца TLS, веб-приложение Firewall, сродство сеансов на основе файлов cookie, маршрутирование на основе URL-маршрутов, бесплатные сертификаты и управление несколькими доменами и другие. Полный список поддерживаемых функций можно ознакомьтесь с [обзором передней двери Azure.](front-door-overview.md)

### <a name="what-is-the-difference-between-azure-front-door-and-azure-application-gateway"></a>В чем разница между Azure Front Door и Azure Application Gateway?

В то время как Front Door и Application Gateway являются балансисаторами нагрузки уровня 7 (HTTP/HTTPS), основное различие заключается в том, что Front Door является глобальной службой, в то время как Application Gateway — это региональная служба. В то время как Front Door может загружать баланс между различными единицами масштаба/кластерами/штампами в разных регионах, Application Gateway позволяет загружать баланс между вашими VMs/контейнерами и т.д., что находится в пределах единицы масштаба.

### <a name="when-should-we-deploy-an-application-gateway-behind-front-door"></a>Когда мы должны развернуть шлюз приложения за передней дверью?

Ключевыми сценариями, почему следует использовать шлюз приложения за передней дверью:

- Front Door может выполнять балансировки нагрузки на основе путей только на глобальном уровне, но если кто-то хочет загрузить баланс трафика еще дальше в пределах своей виртуальной сети (VNET), то они должны использовать приложение gateway.
- Так как Front Door не работает на уровне VM/контейнера, поэтому он не может сделать соединение draining. Тем не менее, приложение шлюз позволяет делать подключение слива. 
- С помощью шлюза приложений, стоящего за AFD, можно достичь 100% разгрузки TLS/SSL и маршрутировать только запросы HTTP в пределах своей виртуальной сети (VNET).
- Передняя дверь и приложение шлюз как поддержка сессии сродство. В то время как Front Door может направлять последующий трафик из сеанса пользователя в тот же кластер или бэкэнд в данном регионе, Application Gateway может направлять affinitize трафик на тот же сервер в кластере.  

### <a name="can-we-deploy-azure-load-balancer-behind-front-door"></a>Можем ли мы развернуть балансер загрузки Azure за передней дверью?

Azure Front Door нуждается в публичном VIP или общедоступном имени DNS для маршрутизации трафика. Развертывание баланса загрузки Azure за передней дверью является обычным примером использования.

### <a name="what-protocols-does-azure-front-door-support"></a>Какие протоколы поддерживает Azure Front Door?

Передняя дверь Azure поддерживает HTTP, HTTPS и HTTP/2.

### <a name="how-does-azure-front-door-support-http2"></a>Как Azure Front Door поддерживает HTTP/2?

Поддержка протокола HTTP/2 доступна только клиентам, подключающимся к передней двери Azure. Связь с бэкэндами в пуле бэкэнда более HTTP/1.1. Поддержка HTTP/2 включена по умолчанию.

### <a name="what-resources-are-supported-today-as-part-of-backend-pool"></a>Какие ресурсы сейчас поддерживаются как часть серверного пула?

Пулы бэкэнда могут состоять из экземпляров Storage, Web App, Kubernetes или любого другого пользовательского хоста, который имеет общедоступное подключение. Передняя дверь Azure требует, чтобы бэкэнды определялись либо через общедоступный IP- и публично разрешимый хост-имя DNS. Члены бэкэнд-пулов могут находиться в разных зонах, регионах или даже за пределами Azure, если они имеют общедоступную связь.

### <a name="what-regions-is-the-service-available-in"></a>В каких регионах доступна служба?

Azure Front Door — это глобальная служба, которая не привязана к какому-либо конкретному региону Azure. Единственное место, которое необходимо указать при создании передней двери, это местоположение группы ресурсов, которое в основном указывает, где будут храниться метаданные для группы ресурсов. Ресурс Front Door сам по себе создается как глобальный ресурс, и конфигурация развернута глобально для всех СОЗ (Точка присутствия). 

### <a name="what-are-the-pop-locations-for-azure-front-door"></a>Что такое pop-локации для передней двери Azure?

Azure Front Door имеет тот же список POP (Точка присутствия) местах, как Azure CDN от Microsoft. Для получения полного списка наших СОЗ, любезно обратитеся [Azure CDN POP местах от Microsoft.](https://docs.microsoft.com/azure/cdn/cdn-pop-locations)

### <a name="is-azure-front-door-a-dedicated-deployment-for-my-application-or-is-it-shared-across-customers"></a>Является ли Azure Front Door выделенным развертыванием для моего приложения или оно является общим для всех клиентов?

Azure Front Door — это глобально распределенная мультитенантная служба. Таким образом, инфраструктура для Front Door является общей для всех своих клиентов. Однако, создавая профиль Front Door, вы определяете конкретную конфигурацию, необходимую для вашего приложения, и никакие изменения, внесенные в вашу переднюю дверь, не влияют на другие конфигурации передней двери.

### <a name="is-http-https-redirection-supported"></a>Поддерживается ли перенаправление протоколов HTTP -> HTTPS?

Да. На самом деле, Azure Front Door поддерживает перенаправление строки хоста, пути и строки запроса, а также часть перенаправления URL-адресов. Подробнее о [перенаправлении URL.](front-door-url-redirect.md) 

### <a name="in-what-order-are-routing-rules-processed"></a>В каком порядке обрабатываются правила разгрома?

Маршруты для вашей передней двери не заказываются, и на основе наилучшего соответствия выбирается определенный маршрут. Подробнее о [том, как Front Door соответствует запросам с правилом разгрома.](front-door-route-matching.md)

### <a name="how-do-i-lock-down-the-access-to-my-backend-to-only-azure-front-door"></a>Как заблокировать доступ к бэкэнду только к двери Azure Front Door?

Чтобы заблокировать приложение, чтобы принимать трафик только с вашей конкретной передней двери, вам нужно настроить IP ACLs для бэкэнда, а затем ограничить трафик на бэкэнде к конкретному значению заголовка 'X-Azure-FDID', отправленного Front Door. Эти шаги подробно описаны ниже:

- Направьте IP ACLing для бэкэндов, чтобы принимать трафик из пространства IP-адреса Backend От Azure Front и только инфраструктурных служб Azure. Ссылайтесь на сведения IP ниже для ACLing бэкэнда:
 
    - Обратитесь в раздел *AzureFrontDoor.Backend* в [azure IP Ranges и теги служб](https://www.microsoft.com/download/details.aspx?id=56519) для линейки IP-адресов Для бэкэнда Front Door или вы также можете использовать тег службы *AzureFrontDoor.Backend* в [группах сетевой безопасности](https://docs.microsoft.com/azure/virtual-network/security-overview#security-rules) или с [помощью Azure Firewall.](https://docs.microsoft.com/azure/firewall/service-tags)
    - Ip-пространство бэкэнда **IPv6** переднего двери, охватываемое в теге обслуживания, не перечислено в файле JSON-диапазона Ip-класса Azure. Если вы ищете явный диапазон адресов IPv6, он в настоящее время ограничен`2a01:111:2050::/44`
    - [Основные инфраструктурные услуги](https://docs.microsoft.com/azure/virtual-network/security-overview#azure-platform-considerations) Azure через `168.63.129.16` виртуализированные IP-адреса хоста:`169.254.169.254`

    > [!WARNING]
    > Backend IP-пространство Front Door может измениться позже, однако, мы гарантируем, что до того, как это произойдет, что мы бы интегрированы с [Azure IP диапазонов и услуг и теги.](https://www.microsoft.com/download/details.aspx?id=56519) Мы рекомендуем вам подписаться на [Azure IP Ranges и теги служб](https://www.microsoft.com/download/details.aspx?id=56519) для любых изменений или обновлений.

-    Выполните операцию GET на передней `2020-01-01` двери с версией API или выше. В вызове API `frontdoorID` ищите поле. Фильтр на входящий заголовок '**X-Azure-FDID**' отправлен опередоввой двери `frontdoorID`в бэкэнд со значением поля. 

### <a name="can-the-anycast-ip-change-over-the-lifetime-of-my-front-door"></a>Может ли любой IP-адрес измениться в течение всего срока службы моей передней двери?

Фронтенд anycast IP для передней двери, как правило, не должны меняться и могут оставаться статичными в течение всего срока службы передней двери. Тем не менее, нет **никаких гарантий** на то же самое. Любезно не принимать каких-либо прямых зависимостей от ИС.

### <a name="does-azure-front-door-support-static-or-dedicated-ips"></a>Поддерживает ли Azure Front Door статические или выделенные испытательные iPs?

Нет, Azure Front Door в настоящее время не поддерживает статические или выделенные передние I-среды. 

### <a name="does-azure-front-door-support-x-forwarded-for-headers"></a>Поддерживает ли Azure Front Door X-forwarded для заголовков?

Да, Azure Front Door поддерживает заголовки X-Forwarded-For, X-Forwarded-Host и X-Forwarded-Proto. Для X-Forwarded-For, если заголовок уже присутствовал, то Front Door прикладывает клиентскую розетку IP к нему. В противном конце же значение добавляется заголовок с IP-адресом клиента. Для X-Forwarded-Host и X-Forwarded-Proto значение переопределяется.

Узнайте больше о [поддерживаемых заголовках HTTP.](front-door-http-headers-protocol.md)  

### <a name="how-long-does-it-take-to-deploy-an-azure-front-door-does-my-front-door-still-work-when-being-updated"></a>Сколько времени занимает развертывание передней двери Azure? Ли моя передняя дверь по-прежнему работают при обновлении?

Новое создание front Door или любые обновления существующей передней двери занимает около 3 до 5 минут для глобального развертывания. Это означает, что примерно через 3-5 минут конфигурация Front Door будет развернута во всех наших СОЗ по всему миру.

Примечание - Пользовательские обновления сертификатов TLS/SSL занимают около 30 минут, чтобы быть развернуты во всем мире.

Любые обновления маршрутов или бэкэнд бассейнов и т.д. являются бесшовными и вызовет нулевой простой (если новая конфигурация является правильным). Обновления сертификата также являются атомарными и не вызовут сбой, если только переход от 'AFD Managed' к 'Использовать свой собственный сертификат' или наоборот.


## <a name="configuration"></a>Конфигурация

### <a name="can-azure-front-door-load-balance-or-route-traffic-within-a-virtual-network"></a>Может ли Azure Front Door загрузить баланс или трафик маршрута в виртуальной сети?

Azure Front Door (AFD) требует публичного IP или публично разрешимого имени DNS для маршрутного трафика. Таким образом, ответ не AFD непосредственно не может маршрут в рамках виртуальной сети, но с помощью шлюза приложения или Azure Load Balancer между ними будет решить этот сценарий.

### <a name="what-are-the-various-timeouts-and-limits-for-azure-front-door"></a>Каковы различные тайм-ауты и ограничения для передней двери Azure?

Узнайте обо всех задокументированных [тайм-аутах и ограничениях для передней двери Azure.](https://docs.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits#azure-front-door-service-limits)

## <a name="performance"></a>Производительность

### <a name="how-does-azure-front-door-support-high-availability-and-scalability"></a>Как Azure Front Door поддерживает высокую доступность и масштабируемость?

Azure Front Door — это глобально распределенная мультитенантная платформа с огромными объемами емкости для удовлетворения потребностей в масштабируемости приложения. Поставляется с края глобальной сети Microsoft, Front Door обеспечивает глобальную возможность балансировки нагрузки, что позволяет вам потерпеть неудачу в течение всего приложения или даже отдельных микрослужб в разных регионах или различных облаках.

## <a name="tls-configuration"></a>Конфигурация TLS

### <a name="what-tls-versions-are-supported-by-azure-front-door"></a>Какие версии TLS поддерживаются Azure Front Door?

Все профили Front Door, созданные после сентября 2019 года, используют TLS 1.2 в качестве минимума по умолчанию.

Front Door поддерживает версии TLS 1.0, 1.1 и 1.2. TLS 1.3 пока не поддерживается.

### <a name="what-certificates-are-supported-on-azure-front-door"></a>Какие сертификаты поддерживаются на передней двери Azure?

Для обеспечения безопасности предоставления содержимого в пользовательском домене Front Door можно использовать сертификат, управляемый Azure Front Door, или использовать собственный сертификат.
Front Door управляемый вариант положения стандартный сертификат TLS /SSL через Digicert и хранится в ключе Убежище переднего двери. Если вы решите использовать свой собственный сертификат, то вы можете на борту сертификата из поддерживаемого CA и может быть стандартным TLS, расширенным сертификатом проверки или даже сертификатом подстановочного знака. Самоподписанные сертификаты не поддерживаются. [Узнайте, как включить HTTPS для пользовательского домена.](https://aka.ms/FrontDoorCustomDomainHTTPS)

### <a name="does-front-door-support-autorotation-of-certificates"></a>Поддерживает ли Front Door автоматическую ротацию сертификатов?

Для опции сертификата Front Door сертификаты автоматически отравлены передней дверью. Если вы используете сертификат, управляемый Front Door, и видите, что срок действия сертификата составляет менее 60 дней, подайте билет на поддержку.
</br>Для пользовательского сертификата TLS/SSL авторотация не поддерживается. Подобно тому, как он был настроен в первый раз для данного пользовательского домена, вам нужно будет указать Front Door на правильную версию сертификата в вашем Key Vault и убедиться, что директор службы для Front Door по-прежнему имеет доступ к Key Vault. Эта обновленная операция развертывания сертификата Front Door является атомной и не вызывает никакого производственного воздействия при условии, что имя объекта или SAN для сертификата не изменится.

### <a name="what-are-the-current-cipher-suites-supported-by-azure-front-door"></a>Какие текущие наборы шифров поддерживаются Azure Front Door?

Для TLS1.2 поддерживаются следующие наборы шифров

TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 TLS_DHE_RSA_WITH_AES_256_GCM_SHA384 TLS_DHE_RSA_WITH_AES_128_GCM_SHA256

При использовании пользовательских доменов с включенными TLS1.0/1.1 поддерживаются следующие наборы шифров:

- TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256
- TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384
- TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256
- TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384
- TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256
- TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384
- TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256
- TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384
- TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA
- TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA
- TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA
- TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA
- TLS_RSA_WITH_AES_256_GCM_SHA384
- TLS_RSA_WITH_AES_128_GCM_SHA256
- TLS_RSA_WITH_AES_256_CBC_SHA256
- TLS_RSA_WITH_AES_128_CBC_SHA256
- TLS_RSA_WITH_AES_256_CBC_SHA
- TLS_RSA_WITH_AES_128_CBC_SHA
- TLS_DHE_RSA_WITH_AES_128_GCM_SHA256
- TLS_DHE_RSA_WITH_AES_256_GCM_SHA384

### <a name="can-i-configure-tls-policy-to-control-tls-protocol-versions"></a>Могу ли я настроить политику TLS для управления версиями протокола TLS?

Можно настроить минимальную версию TLS в передней двери Azure в настройках пользовательского домена HTTPS через портал Azure или [API Azure REST.](https://docs.microsoft.com/rest/api/frontdoorservice/frontdoor/frontdoors/createorupdate#minimumtlsversion) В настоящее время вы можете выбрать между 1.0 и 1.2.

### <a name="can-i-configure-front-door-to-only-support-specific-cipher-suites"></a>Можно ли настроить Front Door, чтобы поддерживать только определенные наборы шифров?

Нет, настройка Front Door для конкретных наборов шифров не поддерживается. Тем не менее, вы можете получить свой собственный пользовательский сертификат TLS/SSL от вашего сертификата (нам. Verisign, Entrust, или Digicert) и иметь специальные наборы шифров, отмеченные в сертификате, когда он генерируется. 

### <a name="does-front-door-support-ocsp-stapling"></a>Поддерживает ли Front Door скрепку OCSP?

Да, скрепка OCSP поддерживается по умолчанию Передней дверью, и конфигурация не требуется.

### <a name="does-azure-front-door-also-support-re-encryption-of-traffic-to-the-backend"></a>Поддерживает ли Azure Front Door повторное шифрование трафика в бэкэнде?

Да, Azure Front Door поддерживает разгрузку TLS/SSL и заканчивает сяритоге tLS, которая перешифровывает трафик в бэкэнд. В самом деле, так как соединения с бэкэндом происходят над его общедоступной IP, рекомендуется настроить front Door для использования HTTPS в качестве протокола пересылки.

### <a name="does-front-door-support-self-signed-certificates-on-the-backend-for-https-connection"></a>Поддерживает ли Front Door самоподписанные сертификаты на бэкэнде для подключения HTTPS?

Нет, самоподписанные сертификаты не поддерживаются на передней двери и ограничение распространяется на обоих:

1. **Бэкэндс**: Вы не можете использовать самоподписанные сертификаты при переадресации трафика в качестве зондов работы HTTPS или HTTPS или заполнения кэша для от происхождения для правил конвирования с включенным кэшированием.
2. **Frontend**: Вы не можете использовать самоподписанные сертификаты при использовании собственного пользовательского сертификата TLS/SSL для включения HTTPS в пользовательский домен.

### <a name="why-is-https-traffic-to-my-backend-failing"></a>Почему трафик HTTPS на мой бэкэнд не удается?

За успешное подключение HTTPS к бэкэнду, будь то для зондов работоспособности или для запросов на пересылку, может быть две причины, по которым трафик HTTPS может выйти из строя:

1. **Несоответствие имени объекта сертификата**: Для соединений HTTPS Front Door ожидает, что ваш бэкэнд представляет сертификат от действительного CA с именем предмета (ы), соответствующим именем бэкэнда. Например, если ваше бэкэнд-хост-имя `myapp-centralus.contosonews.net` установлено и сертификат, который ваш `myapp-centralus.contosonews.net` бэкэнд представляет во время рукопожатия TLS, не имеет и `*myapp-centralus*.contosonews.net` не имеет и имени субъекта, передняя дверь откажется от подключения и приведет к ошибке. 
    1. **Решение**: Хотя это не рекомендуется с точки зрения соответствия, вы можете обойти эту ошибку, отключив проверку имени объекта сертификата для вашей передней двери. Это присутствует в настройках на портале Azure и под BackendPoolsSettings в API.
2. **Бэкэнд хостинг сертификат от недействительных CA**: Только сертификаты от [действительных ЦО](/azure/frontdoor/front-door-troubleshoot-allowed-ca) могут быть использованы в бэкэндс с передней двери. Сертификаты от внутренних CAs или самоподписанные сертификаты не допускаются.

## <a name="diagnostics-and-logging"></a>Диагностика и ведение журнала

### <a name="what-types-of-metrics-and-logs-are-available-with-azure-front-door"></a>Какие типы метрик и журналов доступны с Azure Front Door?

Для получения информации о журналах и других диагностических возможностях, [см.](front-door-diagnostics.md)

### <a name="what-is-the-retention-policy-on-the-diagnostics-logs"></a>Что такое политика хранения журналов диагностики?

Журналы диагностики находятся в учетных записях хранения клиентов, и клиенты могут задать политику хранения в зависимости от своих предпочтений. Журналы диагностики также можно отправить в концентратор событий или журналы Azure Monitor. Для получения дополнительной [информации](front-door-diagnostics.md)см.

### <a name="how-do-i-get-audit-logs-for-azure-front-door"></a>Как получить журналы аудита для двери Azure Front Door?

Для передней двери Azure доступны журналы аудита. На портале нажмите **«Вход активности»** в лезвие меню передней двери, чтобы получить доступ к журналу аудита. 

### <a name="can-i-set-alerts-with-azure-front-door"></a>Можно ли настроить оповещения с помощью передней двери Azure?

Да, Azure Front Door поддерживает оповещения. Оповещения настраиваются на основе метрик. 

## <a name="next-steps"></a>Следующие шаги

- Дополнительные сведения о [создании Front Door](quickstart-create-front-door.md).
- Дополнительные сведения о том, [как работает Front Door](front-door-routing-architecture.md).
