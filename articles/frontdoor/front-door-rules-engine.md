---
title: Azure Front Door
description: В этой статье описана функция обработчика правил для Azure Front Door.
services: frontdoor
documentationcenter: ''
author: megan-beatty
editor: ''
ms.service: frontdoor
ms.devlang: na
ms.topic: overview
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 4/30/2020
ms.author: mebeatty
ms.openlocfilehash: ee981d08e53765003e88870d35b291a5802e6848
ms.sourcegitcommit: 01cd19edb099d654198a6930cebd61cae9cb685b
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/24/2020
ms.locfileid: "85322009"
---
# <a name="what-is-rules-engine-for-azure-front-door"></a>Что такое обработчик правил для Azure Front Door? 

Обработчик правил позволяет настроить обработку HTTP-запросов в пограничной среде, а также обеспечивает более полный контроль над поведением веб-приложения. Обработчик правил для Azure Front Door включает несколько ключевых функций, в том числе:

- Применение протокола HTTPS, чтобы все пользователи могли взаимодействовать с вашим содержимым через безопасное подключение.
- Реализация заголовков безопасности, чтобы предотвратить возникновение уязвимостей в браузере, как например HTTP Strict-Transport-Security (HSTS), X-XSS-Protection, Content-Security-Policy и X-Frame-Options, а также Access-Control-Allow-Origin в сценариях CORS. Атрибуты для системы безопасности можно также определять с помощью файлов cookie.
- Направление запросов к мобильным или настольным версиям приложения на основе шаблонов содержимого заголовков запросов, файлов cookie или строк запросов.
- Использование возможностей перенаправления для возврата перенаправлений 301, 302, 307 и 308 клиенту, чтобы перенаправить их на новые имена узлов, пути или протоколы.
- Динамическое изменение конфигурации кэширования маршрута на основе входящих запросов.
- Перезапись пути URL-адреса запроса и пересылка запроса в соответствующую серверную часть в настроенном внутреннем пуле.

## <a name="architecture"></a>Architecture 

Обработчик правил обрабатывает запросы в пограничной среде. После настройки обработчика правил, когда запрос достигает конечной точки Front Door, сначала будет запущен WAF, за которым следует конфигурация обработчика правил, связанная с интерфейсом или доменом. Если выполняется конфигурация обработчика правил, то родительское правило маршрутизации уже совпадает. Выполнение действий в каждом из правил конфигурации обработчика правил зависит от того, удовлетворяются ли условия соответствия в этом правиле. Если запрос не соответствует ни одному из условий в конфигурации подсистемы правил, выполняется правило маршрутизации по умолчанию. 

Например, в приведенной ниже конфигурации обработчик правил настраивается для добавления заголовка ответа, который изменяет максимальный возраст элемента управления кэшем, если условие соответствия выполняется. 

![действие заголовка ответа](./media/front-door-rules-engine/rules-engine-architecture-3.png)

В другом примере мы видим, что обработчик правил настроен на отправку пользователю мобильной версии сайта, если условие соответствия, тип устройства, имеет значение true. 

![переопределение конфигурации маршрута](./media/front-door-rules-engine/rules-engine-architecture-1.png)

В обоих примерах, когда ни одно из условий соответствия не соблюдается, указанное правило маршрута будет выполняться. 

## <a name="terminology"></a>Терминология 

С помощью обработчика правил AFD можно создать ряд конфигураций обработчика правил, каждая из которых состоит из набора правил. Ниже приведена полезная терминология, которую вы будете использовать при настройке обработчика правил. 

- *Конфигурации обработчика правил*. Набор правил, применяемых к одному правилу маршрутизации. Каждая конфигурация ограничена 25 правилами. Вы можете создать до 10 конфигураций. 
- *Правило обработчика правил*. Правило, состоящее из не более 10 условий соответствия и 5 действий.
- *Условие соответствия* Существует множество условий соответствия, которые можно использовать для анализа входящих запросов. Правило может содержать до 10 условий соответствия. Условия соответствия оцениваются с помощью оператора **AND**. Полный список условий соответствия можно найти [здесь](front-door-rules-engine-match-conditions.md). 
- *Action* (Действие). Действия определяют, что происходит с вашими входящими запросами. Действия в заголовке запроса или ответа, переадресация, перенаправление и перезапись доступны уже сегодня. Правило может содержать до 5 действий. Однако правило может содержать только 1 переопределение конфигурации маршрутов.  Полный список действий можно найти [здесь](front-door-rules-engine-actions.md).


## <a name="next-steps"></a>Дальнейшие действия

- Узнайте, как настроить первую [конфигурацию обработчика правил](front-door-tutorial-rules-engine.md). 
- Дополнительные сведения о [создании Front Door](quickstart-create-front-door.md).
- Дополнительные сведения о том, [как работает Front Door](front-door-routing-architecture.md).
