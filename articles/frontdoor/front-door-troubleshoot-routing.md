---
title: Устранение неполадок в конфигурации Azure Front Door Service | Документация Майкрософт
description: В этом руководстве вы узнаете, как самостоятельно устранить некоторые из распространенных проблем, с которыми вы можете столкнуться при использовании Front Door.
services: frontdoor
documentationcenter: ''
author: sharad4u
editor: ''
ms.service: frontdoor
ms.workload: infrastructure-services
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 09/22/2018
ms.author: sharadag
ms.openlocfilehash: 7a261d65a7bd3eea150dd764c65b94ddd47466b3
ms.sourcegitcommit: d4dfbc34a1f03488e1b7bc5e711a11b72c717ada
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/13/2019
ms.locfileid: "60736128"
---
# <a name="troubleshooting-common-routing-issues"></a>Устранение распространенных проблем маршрутизации
В этой статье описывается, как устранять некоторые распространенные проблемы маршрутизации, которые могут возникнуть при использовании конфигурации Azure Front Door Service. 

## <a name="hostname-not-routing-to-backend-and-returns-400-status-code"></a>При отправке запроса на имя узла трафик не перенаправляется на внутренний сервер и возвращается код состояния 400


### <a name="symptom"></a>Симптом
- Вы создали службу Front Door, но запрос к интерфейсному узлу возвращает код состояния HTTP 400.

  - Вы создали сопоставление DNS личного домена с настроенным интерфейсным узлом. Тем не менее при отправке запроса на имя узла личного домена возвращается код состояния HTTP 400 и трафик не перенаправляется на настроенные внутренние серверы.

### <a name="cause"></a>Причина:
- Эта проблема может произойти, если вы не настроили правило маршрутизации для личного домена, который был добавлен в качестве интерфейсного узла. Необходимо явно добавить правило маршрутизации для этого интерфейсного узла, даже если оно уже было настроено для интерфейсного узла в поддомене Front Door (*.azurefd.net), с которым настроено сопоставление DNS для личного домена.

### <a name="troubleshooting-steps"></a>Действия по устранению неполадок
- Добавьте правило маршрутизации из личного домена в требуемый внутренний пул.

## <a name="request-to-frontend-hostname-returns-404-status-code"></a>Запрос к интерфейсному узлу возвращает код состояния 404

### <a name="symptom"></a>Симптом
- Вы создали службу Front Door, затем настроили интерфейсный узел, внутренний пул как минимум с одним внутренним сервером и правило маршрутизации, которое подключает интерфейсный узел к внутреннему пулу. По-видимому, содержимое недоступно при отправке запроса к настроенному интерфейсному узлу, так как возвращается код состояния HTTP 404.

### <a name="cause"></a>Причина:
Данный симптом мог возникнуть по нескольким причинам.
 - Внутренний сервер не является общедоступным и не доступен для службы Front Door.

- Внутренний сервер настроен неправильно, поэтому Front Door отправляет неправильный запрос (то есть внутренний сервер принимает только HTTP-запросы, но вы еще не отключили параметр, разрешающий HTTPS-запросы, из-за чего Front Door пытается пересылать HTTPS-запросы).
- Внутренний сервер отклоняет заголовок узла, который был переслан вместе с запросом на внутренний сервер.
- Конфигурация внутреннего сервера не полностью развернута.

### <a name="troubleshooting-steps"></a>Действия по устранению неполадок
1. Время развертывания
    - Убедитесь, что прошло около 10 минут, необходимых для развертывания конфигурации.

2. Проверка параметров внутреннего сервера
   - Перейдите во внутренний пул, в который должен быть перенаправлен запрос (он зависит от настройки правила маршрутизации), и убедитесь, что _тип узла внутреннего сервера_ и имя узла внутреннего сервера указаны правильно. Если внутренний сервер является настраиваемым узлом, убедитесь, что он указан правильно. 

   - Проверьте порты HTTP и HTTPS. В большинстве случаев порты 80 и 443 (соответственно) указаны правильно и изменения не потребуются. Тем не менее существует вероятность того, что внутренний сервер настроен иначе и ожидает передачи данных через другой порт.

     - Проверьте _заголовок узла внутреннего сервера_, настроенный для внутренних серверов, на которые должен перенаправляться трафик интерфейсного узла. В большинстве случаев этот заголовок должен совпадать с _именем узла внутреннего сервера_. Тем не менее неправильное значение может привести к отображению различных кодов состояния HTTP 4xx, если внутренний сервер ожидает другое значение. Если вы указываете IP-адрес внутреннего сервера, может потребоваться задать имя узла внутреннего сервера в качестве _заголовка узла внутреннего сервера_.


3. Проверка параметров правила маршрутизации
     - Перейдите к правилу маршрутизации, которое должно направлять трафик по рассматриваемому имени интерфейсного узла во внутренний пул. Убедитесь, что принимаемые протоколы настроены правильно. Если это не так, убедитесь, что протокол, который Front Door будет использовать при пересылке запроса, настроен правильно. Параметр _Accepted protocols_ (Принимаемые протоколы) определяет, какие запросы службе Front Door следует принимать, а параметр _Forwarding protocol_ (Протокол пересылки) на вкладке _Advanced_ (Дополнительно) определяет, какой протокол службе Front Door следует использовать для пересылки запроса на внутренний сервер.
          - Например, если внутренний сервер принимает только HTTP-запросы, приведенная ниже конфигурация будет допустимой.
               - _Accepted protocols_ (Принимаемые протоколы): HTTP и HTTPS. _Forwarding protocol_ (Протокол пересылки): HTTP. Соответствующий запрос не будет выполнен, так как протокол HTTPS разрешен, и если поступит HTTPS-запрос, служба Front Door попытается переслать его с помощью протокола HTTPS.

               - _Accepted protocols_ (Принимаемые протоколы): HTTP. _Forwarding protocol_ (Протокол пересылки): соответствующий запрос или HTTPS.

   - Щелкните вкладку _Advanced_ (Дополнительно) вверху области настройки правила маршрутизации. Параметр _Url Rewrite_ (Перезапись URL-адресов) отключен по умолчанию. Его следует использовать только в том случае, если требуется сузить область размещенных на внутреннем сервере ресурсов, которые требуется сделать доступными. Если этот параметр отключен, служба Front Door будет пересылать запросы по полученному пути. Вполне возможно, что это поле настроено неправильно и Front Door запрашивает ресурс на внутреннем сервере, который недоступен, возвращая код состояния HTTP 404.

