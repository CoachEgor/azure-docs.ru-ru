---
title: Создание передней дверцы с перенаправлением HTTP-HTTPS с помощью портал Azure
description: Узнайте, как создать переднюю дверь с перенаправленным трафиком из HTTP в HTTPS с помощью портал Azure.
services: front-door
author: duongau
ms.service: frontdoor
ms.topic: how-to
ms.date: 5/21/2019
ms.author: duau
ms.openlocfilehash: fe2159f0eeb9d01081e6a25e7a88ceff4f1e361c
ms.sourcegitcommit: 5a3b9f35d47355d026ee39d398c614ca4dae51c6
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/02/2020
ms.locfileid: "89399696"
---
# <a name="create-a-front-door-with-http-to-https-redirection-using-the-azure-portal"></a>Создание передней дверцы с перенаправлением HTTP-HTTPS с помощью портал Azure

Вы можете использовать портал Azure, чтобы создать [переднюю дверцу](front-door-overview.md) с сертификатом для завершения TLS. Правило маршрутизации используется для перенаправления трафика HTTP в HTTPS.

Вы узнаете, как выполнять следующие задачи:

> [!div class="checklist"]
> * Создание передней дверцы с помощью существующего ресурса веб-приложения
> * Добавление личного домена с сертификатом TLS/SSL 
> * Настройка HTTPS Redirect в пользовательском домене

Если у вас еще нет подписки Azure, [создайте бесплатную учетную запись](https://azure.microsoft.com/free/?WT.mc_id=A261C142F), прежде чем начинать работу.

## <a name="create-a-front-door-with-an-existing-web-app-resource"></a>Создание передней дверцы с помощью существующего ресурса веб-приложения

1. Войдите на портал Azure по адресу [https://portal.azure.com](https://portal.azure.com).
2. Выберите **Создать ресурс** в верхнем левом углу окна на портале Azure.
3. Найдите **переднюю дверцу** с помощью панели поиска и найдите тип ресурса, нажав кнопку **создать**.
4. Выберите подписку, а затем либо используйте существующую группу ресурсов, либо создайте новую. Обратите внимание, что расположение, запрошенное в пользовательском интерфейсе, предназначено только для группы ресурсов. Конфигурация передней дверцы будет развернута во всех [расположениях POP передней дверцы Azure](front-door-faq.md#what-are-the-pop-locations-for-azure-front-door).

    ![Настройка основ для новой передней дверцы](./media/front-door-url-redirect/front-door-create-basics.png)

5. Нажмите кнопку **Далее** , чтобы перейти на вкладку Конфигурация. Настройка передней дверцы выполняется в три этапа: Добавление внешнего узла по умолчанию, Добавление серверной части в внутренний пул и последующее создание правил маршрутизации для отображения поведения маршрутизации для внешнего узла. 

     ![Конструктор конфигурации передней дверцы](./media/front-door-url-redirect/front-door-designer.png)

6. Щелкните значок " **+** " на _интерфейсных узлах_ , чтобы создать интерфейсный узел, введите глобально уникальное имя для внешнего узла по умолчанию для передней дверцы ( `\<**name**\>.azurefd.net` ). Нажмите кнопку **Добавить** , чтобы перейти к следующему шагу.

     ![Добавление внешнего узла](./media/front-door-url-redirect/front-door-create-fehost.png)

7. Щелкните значок "" **+** на _серверных пулах_ , чтобы создать серверный пул. Укажите имя для внутреннего пула и нажмите кнопку "**Добавить серверную**часть".
8. Выберите тип узла серверной части в качестве _службы приложений_. Выберите подписку, в которой размещается ваше веб-приложение, а затем выберите конкретное веб-приложение из раскрывающегося списка для **имени узла внутреннего сервера**.
9. Нажмите кнопку **Добавить** , чтобы сохранить серверную часть и еще раз нажать кнопку **Добавить** , чтобы сохранить конфигурацию серверного пула.   ![Добавление серверной части в серверный пул](./media/front-door-url-redirect/front-door-create-backendpool.png)

10. Щелкните значок " **+** " в _правилах маршрутизации_ , чтобы создать маршрут. Укажите имя маршрута, скажите "Хттптохттпсредирект", а затем установите в поле _принятые протоколы_ значение **"только HTTP"**. Убедитесь, что выбран соответствующий _интерфейсный узел_ .  
11. В разделе _сведения о маршруте_ задайте для параметра _тип маршрута_ значение **Перенаправление**, убедитесь, что для параметра _тип перенаправления_ установлено значение **найдено (302)** и _протоколу перенаправления_ задано значение **только HTTPS**. 
12. Нажмите кнопку Добавить, чтобы сохранить правило маршрутизации для перенаправления HTTP в HTTPS.
     ![Добавление маршрута перенаправления HTTP в HTTPS](./media/front-door-url-redirect/front-door-redirect-config-example.png)
13. Добавьте еще одно правило маршрутизации для обработки трафика HTTPS. Щелкните знак " **+** " в _правилах маршрутизации_ и укажите имя маршрута, скажите "дефаултфорвардинграуте", а затем установите в поле _принятые протоколы_ значение **"только HTTPS"**. Убедитесь, что выбран соответствующий _интерфейсный узел_ .
14. В разделе сведения о маршруте задайте для параметра _тип маршрута_ значение **Перенаправление**, убедитесь, что выбран правильный внутренний пул, а _протокол переадресации_ имеет значение **только HTTPS**. 
15. Нажмите кнопку Добавить, чтобы сохранить правило маршрутизации для перенаправления запроса.
     ![Добавление прямого маршрута для трафика HTTPS](./media/front-door-url-redirect/front-door-forward-route-example.png)
16. Щелкните **проверить + создать** , а затем **создать**, чтобы создать профиль передней дверцы. Перейдите к ресурсу после создания.

## <a name="add-a-custom-domain-to-your-front-door-and-enable-https-on-it"></a>Добавление личного домена в переднюю дверцу и включение протокола HTTPS
Следующие шаги демонстрируют, как можно добавить личный домен в существующий ресурс передней дверцы, а затем включить перенаправление HTTP в HTTPS. 

### <a name="add-a-custom-domain"></a>Добавление личного домена

В этом примере вы добавите запись CNAME для `www` поддомена (например, `www.contosonews.com` ).

#### <a name="create-the-cname-record"></a>Создание записи CNAME

Добавьте запись CNAME для сопоставления поддомена с интерфейсным узлом по умолчанию на передней дверце ( `<name>.azurefd.net` , где `<name>` — имя профиля передней дверцы).

В `www.contoso.com` качестве примера для домена добавьте запись CNAME, которая сопоставляет имя `www` с `<name>.azurefd.net` .

После добавления этой записи страница управления записями DNS выглядит так:

![Пользовательский домен CNAME для передней дверцы](./media/front-door-url-redirect/front-door-dns-cname.png)

#### <a name="onboard-the-custom-domain-on-your-front-door"></a>Подключение пользовательского домена на передней дверце

1. На вкладке "конструктор передней дверцы" щелкните значок "+" в разделе "интерфейсные узлы", чтобы добавить новый личный домен. 
2. Введите полное пользовательское DNS-имя в поле имя пользовательского узла, например `www.contosonews.com` . 
3. После проверки сопоставления CNAME из домена с доменом к передней дверце нажмите кнопку **Добавить** , чтобы добавить личный домен.
4. Нажмите кнопку **сохранить** , чтобы отправить изменения.

![Меню личных доменов](./media/front-door-url-redirect/front-door-add-custom-domain.png)

### <a name="enable-https-on-your-custom-domain"></a>Включение протокола HTTPS в пользовательском домене

1. Щелкните личный домен, который был добавлен, и в разделе " **пользовательский домен HTTPS**" измените состояние на " **включено**".
2. Вы можете оставить для **типа управления сертификатом** значение " _Передняя дверь", управляемое_ для бесплатного обслуживаемого сертификата, управляемого и перевернутого с помощью передней дверцы. Вы также можете использовать собственный настраиваемый сертификат TLS/SSL, хранящийся в Azure Key Vault. В этом учебнике предполагается, что используется управляемый сертификат с внешней дверцей.
![Включение HTTPS для пользовательского домена](./media/front-door-url-redirect/front-door-custom-domain-https.png)

3. Щелкните **Обновить** , чтобы сохранить выбор, а затем нажмите кнопку **сохранить**.
4. Нажмите кнопку **Обновить** через пару минут, а затем снова щелкните личный домен, чтобы увидеть ход подготовки сертификата. 

> [!WARNING]
> Включение HTTPS для личного домена может занять несколько минут, а также зависит от проверки владельца домена, если запись CNAME не сопоставлена напрямую с узлом передней дверцы `<name>.azurefd.net` . Узнайте больше о [том, как включить протокол HTTPS для личного домена](./front-door-custom-domain-https.md).

## <a name="configure-the-routing-rules-for-the-custom-domain"></a>Настройка правил маршрутизации для пользовательского домена

1. Щелкните созданное ранее правило маршрутизации перенаправления.
2. Щелкните раскрывающееся меню для интерфейсных узлов и выберите личный домен, чтобы применить этот маршрут к домену.
3. Нажмите кнопку **Обновить**.
4. Выполните ту же операцию для других правил маршрутизации, а именно для маршрута перенаправления, чтобы добавить личный домен.
5. Нажмите кнопку **сохранить** , чтобы отправить изменения.

## <a name="next-steps"></a>Дальнейшие действия

- Дополнительные сведения о [создании Front Door](quickstart-create-front-door.md).
- Дополнительные сведения о том, [как работает Front Door](front-door-routing-architecture.md).
- Дополнительные сведения о [перенаправлении URL-адресов на передней дверце](front-door-url-redirect.md).
