---
title: Мониторинг метрик и журналов в передней двери Azure Документы Майкрософт
description: В этой статье описаны различные метрики и журналы доступа, которые поддерживает Azure Front Door
services: frontdoor
documentationcenter: ''
author: sharad4u
ms.service: frontdoor
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 09/18/2018
ms.author: sharadag
ms.openlocfilehash: b935355cce36a6e26b168db286ab40248f8f0f68
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "79471733"
---
# <a name="monitoring-metrics-and-logs-in-azure-front-door"></a>Мониторинг метрик и журналов в передней двери Azure

Используя переднюю дверь Azure, вы можете отслеживать ресурсы следующим образом:

- **Метрика**. В настоящее время Azure Front Door имеет семь метрик для просмотра счетчиков производительности.
- **Входы**. Системы активности и диагностики позволяют сохранять или потреблять другие данные из ресурса для целей мониторинга.

### <a name="metrics"></a>Метрики

Метели являются функцией для определенных ресурсов Azure, которая позволяет просматривать счетчики производительности на портале. Приведены ниже приведены метрики передней двери:

| Метрика | Отображаемое имя метрики | Единицы | Измерения | Описание |
| --- | --- | --- | --- | --- |
| RequestCount | Число запросов | Count | HttpStatus</br>HttpStatusGroup</br>ClientRegion</br>ClientCountry | Число клиентских запросов, обслуженных службой Front Door.  |
| RequestSize | Размер запроса | Байты | HttpStatus</br>HttpStatusGroup</br>ClientRegion</br>ClientCountry | Число байт, отправленных в качестве запросов от клиентов в службу Front Door. |
| ResponseSize | Размер ответа | Байты | HttpStatus</br>HttpStatusGroup</br>ClientRegion</br>ClientCountry | Число байт, отправленных клиентам в качестве ответов из службы Front Door. |
| TotalLatency | Total Latency (Общая задержка) | Миллисекунды | HttpStatus</br>HttpStatusGroup</br>ClientRegion</br>ClientCountry | Время, рассчитанное из запроса клиента, полученного Front Door, пока клиент не признал последний ответ байтом от Front Door. |
| BackendRequestCount | Число запросов к серверному компоненту | Count | HttpStatus</br>HttpStatusGroup</br>Серверная часть | Число запросов, отправленных из службы Front Door к серверным частям. |
| BackendRequestLatency | Backend Request Latency (Задержка запросов к серверным частям) | Миллисекунды | Серверная часть | Время с момента отправки запроса службой Front Door к серверной части до получения Front Door последнего байта ответа от серверной части. |
| BackendHealthPercentage | Работоспособность серверного компонента (в процентах) | Процент | Серверная часть</br>BackendPool | Процент успешных проб работоспособности от службы Front Door к серверным частям. |
| WebApplicationFirewallRequestCount | Web Application Firewall Request Count (Число запросов к брандмауэру веб-приложения) | Count | PolicyName</br>RuleName</br>Действие | Количество клиентских запросов, обрабатываемых механизмом безопасности на прикладном уровне службы Front Door. |

## <a name="activity-logs"></a><a name="activity-log"></a>Журналы активности

В журналах активности предоставляется информация об операциях, выполненных на Front Door. Они также определяют, что, кто и когда для любых операций записи (положить, разместить или удалить), принятых на передней двери.

>[!NOTE]
>В журналы активности не включаются операции чтения (получения). Они также не включают операции, выполняемые с помощью портала Azure или исходного API управления.

Доступ к журналам активности в передней двери или во всех журналах ресурсов Azure в Azure Monitor. Чтобы просмотреть журналы действий, сделайте следующее:

1. Выберите экземпляр Front Door.
2. Выберите **журнал активности**.

    ![Журнал действий](./media/front-door-diagnostics/activity-log.png)

3. Выберите область фильтрации, а затем выберите **Apply**.

## <a name="diagnostic-logs"></a><a name="diagnostic-logging"></a>Диагностические журналы
Диагностические журналы предоставляют богатую информацию об операциях и ошибках, которые важны для аудита и устранения неполадок. Диагностические журналы отличаются от журналов активности.

Журналы активности дают представление об операциях, выполненных на ресурсах Azure. Диагностические журналы дают представление об операциях, выполняемых вашим ресурсом. Для получения дополнительной информации смотрите [диагностические журналы Azure Monitor.](../azure-monitor/platform/platform-logs-overview.md)

![Журналы диагностики](./media/front-door-diagnostics/diagnostic-log.png)

Для настройки диагностических журналов для передней двери:

1. Выберите переднюю дверь Azure.

2. Выберите **настройки диагностики.**

3. Выберите **Включить диагностику**. Архивдиагностическые журналы вместе с метриками в учетную запись хранилища, потоковая их потоковая часть в концентратор событий или отправка в журналы Azure Monitor.

Front Door в настоящее время предоставляет диагностические журналы (пакетные ежечасно). Диагностические журналы предоставляют индивидуальные запросы API с каждой записью, имеющей следующую схему:

| Свойство  | Описание |
| ------------- | ------------- |
| BackendHostname | Если запрос был перенаправлен в бэкэнд, это поле представляет собой хост-имя бэкэнда. Это поле будет пустым, если запрос был перенаправлен или перенаправлен в региональный кэш (при включении кэширования для правила реуктора). |
| КэшАСтайн | Для сценариев кэширования это поле определяет хит/промах кэша в POP |
| ClientIp | IP-адрес отправившего запрос клиента. Если в запросе был заголовок X-Forwarded-For, то иС клиента выбирается из того же. |
| КлиентПорт | IP-порт клиента, который сделал запрос. |
| HttpMethod | Метод HTTP, используемый для запроса. |
| HttpStatusCode | Код состояния HTTP вернулся из прокси- |
| HttpstatusDetails | Состояние результатов в запросе. Значение этого значения строки можно найти в таблице рекомендаций «Статус». |
| HttpVersion | Тип запроса или соединения. |
| POP | Короткое название края, на котором приземлился запрос. |
| ЗапросBytes | Размер сообщения запроса HTTP в байтах, включая заголовки запросов и орган запроса. |
| ЗапросУри | URI полученного запроса. |
| ОтветBytes | Байты, отправленные сервером бэкэнда в качестве ответа.  |
| RoutingRuleName | Имя правила разгрома, совпадающего с запросом. |
| Протокол безопасности | Версия протокола TLS/SSL, используемая запросом или null, если нет шифрования. |
| SentToOriginShield | Поле Boolean, представляющее, если в первой среде был промах кэша, и запрос был отправлен в региональный кэш. Игнорировать это поле, если правило разгрома является перенаправлением или когда не включено кэширование. |
| TimeTaken | Продолжительность времени, которое было зашло в действие, в миллисекундах. |
| ОтслеживаниеСправка | Уникальная строка, идентифицируя запрос, обслуживаемый Front Door, также отправлена клиенту в качестве заголовка X-Azure-Ref. Требуется для поиска деталей в журналах доступа для конкретного запроса. |
| UserAgent | Тип браузера, который использовал клиент. |

**Примечание:** Для различных конфигураций реаутирования и поведения трафика некоторые поля, такие как backendHostname, cacheStatus, sentToOriginShield и POP-поле, могут отвечать с различными значениями. В приведенной ниже таблице разъясняются различные значения, эти поля будут иметь для различных сценариев:

| Сценарии | Подсчет записей журналов | POP | BackendHostname | SentToOriginShield | КэшАСтайн |
| ------------- | ------------- | ------------- | ------------- | ------------- | ------------- |
| Правило реуктора без включения кэширования | 1 | Код Edge POP | Бэкэнд, где запрос был перенаправлен | False | CONFIG_NOCACHE |
| Правило routing с включенным кэшированием. Кэш ударил по краю POP | 1 | Код Edge POP | Empty | False | Ударил |
| Правило routing с включенным кэшированием. Кэш пропустить на краю POP, но кэш ударил в родительском кэше POP | 2 | 1. Код Эдж ПОП</br>2. Родительский кэш POP код | 1. Родительский кэш POP хостимя</br>2. Пустой | 1. Правда</br>2. Ложные | 1. МИСС</br>2. PARTIAL_HIT |
| Правило routing с включенным кэшированием. Кэш промах и по краю, и родительский кэш POP | 2 | 1. Код Эдж ПОП</br>2. Родительский кэш POP код | 1. Родительский кэш POP хостимя</br>2. Бэкэнд, который помогает заселить кэш | 1. Правда</br>2. Ложные | 1. МИСС</br>2. МИСС |


## <a name="next-steps"></a>Дальнейшие действия

- [Создание профиля Front Door](quickstart-create-front-door.md)
- [Как работает передняя дверь](front-door-routing-architecture.md)
