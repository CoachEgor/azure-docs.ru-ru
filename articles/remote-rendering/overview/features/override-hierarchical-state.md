---
title: Переопределение иерархического состояния
description: Описывает концепцию компонентов иерархического переопределения состояния.
author: florianborn71
ms.author: flborn
ms.date: 02/10/2020
ms.topic: article
ms.openlocfilehash: f3be073857cc8583669ab26f306760478479e2ae
ms.sourcegitcommit: 849bb1729b89d075eed579aa36395bf4d29f3bd9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2020
ms.locfileid: "80680795"
---
# <a name="hierarchical-state-override"></a>Переопределение иерархического состояния

Во многих случаях необходимо динамически изменять внешний вид частей [модели](../../concepts/models.md), например скрытие вложенных диаграмм или переключение частей в прозрачную визуализацию. Изменение материалов каждой части не является практичным, так как для этого требуется выполнить итерацию по всему графу сцены, а также управлять клонированием и назначением материалов на каждом узле.

Для выполнения этого варианта использования с минимально возможными издержками используйте `HierarchicalStateOverrideComponent`. Этот компонент реализует иерархическое обновление состояния для произвольных ветвей графа сцены. Это означает, что состояние может быть определено на любом уровне в графе сцены и функциях вниз по иерархии до тех пор, пока оно не будет переопределено новым состоянием или применено к конечному объекту.

В качестве примера рассмотрим модель автомобиля и необходимо переключить весь автомобиль на прозрачный, за исключением части внутреннего механизма. Этот вариант использования включает только два экземпляра компонента:

* Первый компонент назначается корневому узлу модели и включает прозрачную отрисовку для всего автомобиля.
* Второй компонент назначается корневому узлу подсистемы и снова переопределяет состояние, явным образом отключив режим просмотра "в режиме".

## <a name="features"></a>Функции

Фиксированный набор состояний, которые могут быть переопределены:

* **Скрыто**. соответствующие сетки в графе сцены скрыты или показаны.
* **Цвет оттенка**. подготовленный к просмотру объект можно оттенок цветом с индивидуальным цветом оттенка и насыщенностью оттенка. На рисунке ниже показана цветовая оттенок rimа колеса.
  
  ![Оттенок цвета](./media/color-tint.png)

* **Прочтите**: геометрическая геометрия отображается полупрозрачным образом, например для отображения внутренних частей объекта. На следующем рисунке показан весь автомобиль, отображаемый в режиме просмотра, за исключением красного тормоза Калипер:

  ![Сквозная](./media/see-through.png)

  > [!IMPORTANT]
  > Этот принцип работы работает только при использовании [режима рендеринга](../../concepts/rendering-modes.md) *тилебаседкомпоситион* .

* **Выбрано**: геометрия отображается с [контуром выделения](outlines.md).

  ![Структура выбора](./media/selection-outline.png)

* **Дисаблеколлисион**: геометрия исключена из [пространственных запросов](spatial-queries.md). Флаг **Hidden** не отключает конфликты, поэтому эти два флага часто устанавливаются вместе.

## <a name="hierarchical-overrides"></a>Иерархические переопределения

`HierarchicalStateOverrideComponent` Можно присоединить к нескольким уровням иерархии объектов. Так как в сущности может быть только один компонент каждого типа, каждый из них `HierarchicalStateOverrideComponent` управляет состояниями для скрытых, сквозных, выбранных, цветовых оттенков и конфликтов.

Таким образом, каждому состоянию можно присвоить одно из следующих:

* `ForceOn`— состояние включено для всей сетки на узле и ниже этого узла.
* `ForceOff`— Состояние отключено для всех сеток на узле и ниже этого узла.
* `InheritFromParent`— Это состояние не влияет на этот компонент переопределения

Состояния можно изменять напрямую или с помощью `SetState` функции:

```cs
HierarchicalStateOverrideComponent component = ...;

// set one state directly
component.HiddenState = HierarchicalEnableState.ForceOn;

// set a state with the SetState function
component.SetState(HierarchicalStates.SeeThrough, HierarchicalEnableState.InheritFromParent);

// set multiple states at once with the SetState function
component.SetState(HierarchicalStates.Hidden | HierarchicalStates.DisableCollision, HierarchicalEnableState.ForceOff);
```

### <a name="tint-color"></a>Цвет оттенка

Переопределение цвета оттенка немного особенно полезно в том, что есть и свойство «вкл./выкл.», и «цвет оттенка». Альфа-часть цвета оттенка определяет весовой коэффициент оттенка: Если задано значение 0,0, цвет оттенка не отображается, а если задано значение 1,0, то объект будет подготовлен к просмотру с чистым цветом оттенка. Для сквозных значений цвет окончательного цвета будет смешиваться с цветом оттенка. Цвет оттенка можно изменить для каждого фрейма, чтобы получить цветовую анимацию.

## <a name="performance-considerations"></a>Вопросы производительности

Экземпляр сам по `HierarchicalStateOverrideComponent` себе не добавляет много ресурсов времени выполнения. Однако рекомендуется, чтобы количество активных компонентов оставалось низким. Например, при реализации системы выбора, которая выделяет выбранный объект, рекомендуется удалить компонент при удалении выделения. Хранение компонентов с помощью нейтральных функций может быстро сложиться.

Прозрачная визуализация помещает больше рабочей нагрузки на GPU сервера, чем стандартная отрисовка. Если большие части графа сцены переключены на *Просмотр*с отображением многих уровней геометрии, это может стать узким местом производительности. То же самое допустимо для объектов с [контурами выделения](../../overview/features/outlines.md#performance).

## <a name="next-steps"></a>Дальнейшие шаги

* [Описывается](../../overview/features/outlines.md)
* [Режимы отрисовки](../../concepts/rendering-modes.md)
* [Пространственные запросы](../../overview/features/spatial-queries.md)
