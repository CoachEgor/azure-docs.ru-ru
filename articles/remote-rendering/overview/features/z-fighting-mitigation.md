---
title: Устранение Z-конфликтов
description: Описывает методики устранения артефактов борьбы с z
author: florianborn71
ms.author: flborn
ms.date: 02/06/2020
ms.topic: article
ms.openlocfilehash: bc06deafe3f589fce9a9178fefdb22388254929d
ms.sourcegitcommit: 849bb1729b89d075eed579aa36395bf4d29f3bd9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2020
ms.locfileid: "80680457"
---
# <a name="z-fighting-mitigation"></a>Устранение Z-конфликтов

При перекрытии двух поверхностей не ясно, какая из них должна быть отображена поверх другой. Результат даже меняется на пиксель, что приводит к артефактам, зависящим от представления. Таким образом, при перемещении камеры или сетки эти закономерности заметно замерцаться. Этот артефакт называется « *борьба за z*». Для приложений AR и VR проблема увеличивается из-за того, что подключенные к головным устройствам всегда перемещаются. Чтобы предотвратить возможность устранения проблем с отработкой дискомфорт в средстве просмотра в Azure Remote Rendering.

## <a name="z-fighting-mitigation-modes"></a>Режимы устранения рисков по Z

|Ситуация                        | Результат                               |
|---------------------------------|:-------------------------------------|
|Обычная отборьба от z               |![Борьба с Z](./media/zfighting-0.png)|
|Включено устранение проблем с Z    |![Борьба с Z](./media/zfighting-1.png)|
|Выделение в шахматных клетках включено|![Борьба с Z](./media/zfighting-2.png)|

Следующий код включает устранение проблем с z:

``` cs
void EnableZFightingMitigation(AzureSession session, bool highlight)
{
    ZFightingMitigationSettings settings = session.Actions.ZFightingMitigationSettings;

    // enabling z-fighting mitigation
    settings.Enabled = true;

    // enabling checkerboard highlighting of z-fighting potential
    settings.Highlighting = highlight;
}
```

> [!NOTE]
> Устранение рисков по Z — это глобальный параметр, влияющий на все отрисованные сетки.

## <a name="reasons-for-z-fighting"></a>Причины для борьбы с z

Отборьба от Z происходит в основном по двум причинам:

1. Когда поверхности находятся на расстоянии от камеры, точность их значений глубины снижается, и значения становятся неразличимыми.
1. Когда поверхности в сетке физически пересекаются

Первая проблема всегда может возникнуть, и ее трудно исключить. Если это происходит в приложении, убедитесь, что отношение расстояния между *ближайшими плоскостями* к *дальней плоскости* не отличается от практического уровня. Например, близкая плоскость на расстоянии 0,01 и дальнего расстояния 1000 создаст эту проблему гораздо раньше, чем близкая плоскость в 0,1 и far на расстоянии 20.

Вторая проблема является индикатором для плохо созданного содержимого. В реальной жизни два объекта не могут находиться в одном и том же месте одновременно. В зависимости от приложения пользователям может потребоваться определить, существуют ли пересекающиеся поверхности и где они находятся. Например, сцена САПР здания, которая является основанием для реальной жизни, не должна содержать физически невозможное пересечения поверхностей. Чтобы обеспечить визуальную проверку, доступен режим выделения, который отображает потенциальное борьба с z как анимированный шаблон шахматной доски.

## <a name="limitations"></a>Ограничения

В этом случае лучше использовать указанные решения по устранению проблем с z. Нет никакой гарантии, что она удаляет все возможности борьбы с z. Кроме того, он автоматически предпочитает одну поверхность на другую. Поэтому при наличии поверхностей, которые находятся слишком близко друг к другу, может произойти, что поверхность "неправильная" заканчивается поверх. Типичная проблема заключается в том, что текст и другие декалс применяются к поверхности. Благодаря тому, что устранение проблем с z включено, эти сведения можно легко отфильтровать.

## <a name="performance-considerations"></a>Вопросы производительности

* Включение защиты от применения z снижает нагрузку на производительность.
* Кроме того, включение наложения с z-отправкой приводит к нетривиальным затратам на производительность, хотя это может зависеть от сцены.

## <a name="next-steps"></a>Дальнейшие шаги

* [Режимы отрисовки](../../concepts/rendering-modes.md)
* [Перепроецирование на позднем этапе](late-stage-reprojection.md)
