---
title: Требования к сертификатам и устранение неполадок с помощью Azure Stack пограничных устройств | Документация Майкрософт
description: Описание требований к сертификатам и устранение ошибок сертификатов с помощью Azure Stack пограничных устройств.
services: databox
author: alkohli
ms.service: databox
ms.subservice: edge
ms.topic: article
ms.date: 08/12/2020
ms.author: alkohli
ms.openlocfilehash: 8c4203e820946509290f3bbbe6d6309646903883
ms.sourcegitcommit: 656c0c38cf550327a9ee10cc936029378bc7b5a2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/28/2020
ms.locfileid: "89085119"
---
# <a name="certificate-requirements"></a>Требования к сертификатам

В этой статье описаны требования к сертификатам, которые должны быть выполнены, прежде чем сертификаты можно будет установить на Azure Stack пограничном устройстве. Требования относятся к сертификатам PFX, центру выдачи, имени субъекта сертификата и альтернативному имени субъекта, а также поддерживаемым алгоритмам сертификатов.

## <a name="certificate-issuing-authority"></a>Центр сертификации сертификатов

Требования к выдаче сертификата приведены ниже.

* Сертификаты должны быть выданы внутренним или общедоступным центром сертификации.

* Использование самозаверяющих сертификатов не поддерживается.

* Поле " *Кому выдан* " сертификата не должно совпадать с именем *, выданным в поле "кем выдан"* , за исключением сертификатов корневого ЦС.



## <a name="certificate-algorithms"></a>Алгоритмы сертификатов

Алгоритмы сертификатов должны иметь следующие требования.

* Сертификаты должны использовать алгоритм ключа RSA.

* Алгоритм подписи сертификата не может быть SHA1.

* Минимальный размер ключа — 4096.

## <a name="certificate-subject-name-and-subject-alternative-name"></a>Имя субъекта сертификата и альтернативное имя субъекта

Сертификаты должны иметь следующие требования к имени субъекта и альтернативному имени субъекта:

* Можно либо использовать один сертификат, охватывающий все пространства имен в полях "альтернативное имя субъекта" (SAN) сертификата. Кроме того, можно использовать отдельные сертификаты для каждого пространства имен. Оба подхода требуют использования подстановочных карт для конечных точек, где это необходимо, например больших двоичных объектов (BLOB).

* Убедитесь, что имена субъектов (общее имя в имени субъекта) являются частью альтернативных имен субъектов в расширении альтернативного имени субъекта.

* Можно использовать один подстановочный сертификат, охватывающий все пространства имен в полях SAN сертификата.

* При создании сертификата конечной точки используйте следующую таблицу:

    |Тип |Имя субъекта (SN)  |Альтернативное имя субъекта (SAN)  |Пример имени субъекта |
    |---------|---------|---------|---------|
    |Azure Resource Manager|`management.<Device name>.<Dns Domain>`|`login.<Device name>.<Dns Domain>`<br>`management.<Device name>.<Dns Domain>`|`management.mydevice1.microsoftdatabox.com` |
    |Хранилище BLOB-объектов|`*.blob.<Device name>.<Dns Domain>`|`*.blob.< Device name>.<Dns Domain>`|`*.blob.mydevice1.microsoftdatabox.com` |
    |Локальный пользовательский интерфейс| `<Device name>.<DnsDomain>`|`<Device name>.<DnsDomain>`| `mydevice1.microsoftdatabox.com` |
    |Один сертификат с несколькими SAN для обеих конечных точек|`<Device name>.<dnsdomain>`|`<Device name>.<dnsdomain>`<br>`login.<Device name>.<Dns Domain>`<br>`management.<Device name>.<Dns Domain>`<br>`*.blob.<Device name>.<Dns Domain>`|`mydevice1.microsoftdatabox.com` |
    |Узел|`<NodeSerialNo>.<DnsDomain>`|`*.<DnsDomain>`<br><br>`<NodeSerialNo>.<DnsDomain>`|`mydevice1.microsoftdatabox.com` |
    |VPN|`AzureStackEdgeVPNCertificate.<DnsDomain>`<br><br> * Азурестаккеджевпнцертификате жестко закодирована.  | `*.<DnsDomain>`<br><br>`<AzureStackVPN>.<DnsDomain>` | `edgevpncertificate.microsoftdatabox.com`|
    
## <a name="pfx-certificate"></a>Сертификат PFX

Сертификаты PFX, установленные на устройстве Azure Stack погранично, должны соответствовать следующим требованиям.

* При получении сертификатов из центра SSL убедитесь, что вы получаете полную цепочку подписывания для сертификатов.

* При экспорте сертификата PFX убедитесь, что выбран параметр **включить все сертификаты в цепочку, если возможно** .

* Используйте сертификат PFX для конечной точки, локального пользовательского интерфейса, узла, VPN и Wi-Fi, так как открытый и закрытый ключи требуются для Azure Stackного периметра. Для закрытого ключа должен быть установлен атрибут ключа локального компьютера.

* В сертификате должен использоваться алгоритм шифрования PFX 3DES. Это шифрование по умолчанию, используемое при экспорте из клиента Windows 10 в хранилище сертификатов Windows Server 2016. Дополнительные сведения о 3DES см. в разделе [тройной алгоритм DES](https://en.wikipedia.org/wiki/Triple_DES).

* PFX-файлы сертификата должны иметь действительную *цифровую подпись* и *KeyEncipherment* значения в поле *использования ключа* .

* В поле " *Расширенное использование ключа* " для PFX-файлов сертификата должны быть заданы значения *Проверка подлинности сервера (1.3.6.1.5.5.7.3.1)* и *Проверка подлинности клиента (1.3.6.1.5.5.7.3.2)* .

* Если используется средство проверки готовности Azure Stack, пароли для всех PFX-файлов сертификатов должны быть одинаковыми во время развертывания. Дополнительные сведения см. в статье [Создание сертификатов для Azure Stack пограничных устройств с помощью средства проверки готовности центра Azure Stack](azure-stack-edge-j-series-create-certificates-tool.md).

* Пароль для PFX-файла сертификата должен быть сложным паролем. Запишите этот пароль, так как он используется в качестве параметра развертывания.

Дополнительные сведения см. [в статье экспорт сертификатов PFX с помощью закрытого ключа](azure-stack-edge-j-series-manage-certificates.md#export-certificates-as-pfx-format-with-private-key).

## <a name="next-steps"></a>Дальнейшие действия

[Использование сертификатов с Azure Stack ребром](azure-stack-edge-j-series-manage-certificates.md)

[Создание сертификатов для Azure Stack пограничных устройств с помощью средства проверки готовности центра Azure Stack](azure-stack-edge-j-series-create-certificates-tool.md)

[Экспорт сертификатов PFX с закрытым ключом](azure-stack-edge-j-series-manage-certificates.md#export-certificates-as-pfx-format-with-private-key)

[Устранение ошибок сертификата](azure-stack-edge-j-series-certificate-troubleshooting.md)