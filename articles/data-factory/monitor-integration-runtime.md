---
title: Мониторинг среды выполнения интеграции в фабрике данных Azure
description: Узнайте, как отслеживать различные типы сред выполнения интеграции в фабрике данных Azure.
services: data-factory
documentationcenter: ''
ms.service: data-factory
ms.workload: data-services
ms.topic: conceptual
ms.date: 07/25/2018
author: djpmsft
ms.author: daperlov
manager: anandsub
ms.openlocfilehash: a65bb119994e8bb56eecc730774535d7c0a4d8b6
ms.sourcegitcommit: a5ebf5026d9967c4c4f92432698cb1f8651c03bb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/08/2019
ms.locfileid: "74928427"
---
# <a name="monitor-an-integration-runtime-in-azure-data-factory"></a>Мониторинг среды выполнения интеграции в фабрике данных Azure  
**Среда выполнения интеграции** — это инфраструктура вычислений, которую фабрика данных Azure использует для обеспечения интеграции данных в разных сетевых средах. В фабрике данных предусмотрено три типа сред выполнения интеграции:

- Среда выполнения интеграции Azure
- Локальная среда IR
- Azure-SSIS Integration Runtime

[!INCLUDE [updated-for-az](../../includes/updated-for-az.md)]

Чтобы получить сведения о состоянии экземпляра среды выполнения интеграции, выполните следующую команду PowerShell: 

```powershell
Get-AzDataFactoryV2IntegrationRuntime -DataFactoryName MyDataFactory -ResourceGroupName MyResourceGroup -Name MyAzureIR -Status
``` 

Командлет возвращает различные сведения для разных типов сред выполнения интеграции. В этой статье объясняются свойства и состояния для каждого из них.  

## <a name="azure-integration-runtime"></a>Среда выполнения интеграции Azure
Вычислительным ресурсом для среды выполнения интеграции Azure полностью управляет Azure в гибком режиме. В следующей таблице приведены описания свойств, возвращаемых командой **Get-AzDataFactoryV2IntegrationRuntime** .

### <a name="properties"></a>properties
В следующей таблице приведены описания свойств, возвращаемых командлетом для среды выполнения интеграции Azure:

| Свойство | Описание |
-------- | ------------- | 
| Name | Имя среды выполнения интеграции Azure. |  
| Состояние | Состояние среды выполнения интеграции Azure. | 
| Location | Расположение среды выполнения интеграции Azure. Дополнительные сведения о расположении среды выполнения интеграции Azure см. в статье [Integration runtime in Azure Data Factory](concepts-integration-runtime.md) (Среда выполнения интеграции в фабрике данных Azure). |
| DataFactoryName | Имя фабрики данных, к которой принадлежит среда выполнения интеграции Azure. | 
| ResourceGroupName | Имя группы ресурсов, к которой принадлежит фабрика данных.  |
| Описание | Описание среды выполнения интеграции.  |

### <a name="status"></a>Status
В следующей таблице приведены возможные состояния среды выполнения интеграции Azure:

| Status | Комментарии и сценарии | 
| ------ | ------------------ |
| В сети | Среда выполнения интеграции Azure подключена к сети и готова к использованию. | 
| Автономно | Среда выполнения интеграции Azure находится в автономном режиме из-за внутренней ошибки. |

## <a name="self-hosted-integration-runtime"></a>Локальная среда IR
В этом разделе приводятся описания свойств, возвращаемых командлетом Get-AzDataFactoryV2IntegrationRuntime. 

> [!NOTE] 
> В возвращенных свойствах и состояниях содержатся общие сведения о локальной среде выполнения интеграции и каждом узле в среде выполнения.  

### <a name="properties"></a>properties

В следующей таблице приведены описания свойств наблюдения **каждого узла**:

| Свойство | Описание | 
| -------- | ----------- | 
| Name | Имя локальной среды выполнения интеграции и узлов, связанных с ней. Узел — это локальный компьютер с Windows, на котором установлена локальная среда выполнения интеграции. |  
| Status | Состояние локальной среды выполнения интеграции и каждого узла. Пример: оперативный/автономный/ограниченный/т. д. Сведения об этих состояниях см. в следующем разделе. | 
| Версия | Версия локальной среды выполнения интеграции и каждого узла. Она определяется с учетом версии большинства узлов в группе. Если в локальной среды выполнения интеграции есть узлы разных версий, должным образом будут работать только те, версия которых совпадает с версией среды выполнения интеграции. Другие узлы находятся в ограниченном режиме и их необходимо обновлять вручную (только при сбое автоматического обновления). | 
| Объем доступной памяти | Объем доступной памяти на узле среды выполнения интеграции. Это значение соответствует моментальному снимку в режиме, близком к реальному времени. | 
| загрузка ЦП; | Использование ЦП на узле среды выполнения интеграции. Это значение соответствует моментальному снимку в режиме, близком к реальному времени. |
| Networking (In/Out) (Сеть (входящий и исходящий трафик)) | Использование сети на узле среды выполнения интеграции. Это значение соответствует моментальному снимку в режиме, близком к реальному времени. | 
| Concurrent Jobs (Running/Limit) (Одновременные задания (выполняемые и ограниченные)) | **Выполняется**. Число заданий или задач, выполняющихся на каждом узле. Это значение соответствует моментальному снимку в режиме, близком к реальному времени. <br/><br/>**Ограничение**. Ограничение означает максимальное количество одновременно выполняемых заданий для каждого узла. Это значение определяется на основе размера компьютера. Ограничение можно увеличить, чтобы увеличить масштаб параллельных заданий в сложных сценариях, где действия превышают время ожидания, даже когда ЦП, память или сеть мало используются. Эта возможность доступна также для среды выполнения интеграции с одним узлом. |
| Роль | В среде выполнения интеграции с нескольким узлами существует два типа ролей — диспетчер и рабочая роль. Все узлы являются рабочими, то есть их можно использовать для выполнения заданий. Только один узел выполняет роль диспетчера, который используется для извлечения задачи или задания из облачных служб и отправки в разные рабочие узлы. Узел-диспетчера также является рабочим узлом. |

Некоторые параметры свойств имеют смысл при наличии двух или более узлов в локальной среде выполнения интеграции (то есть в сценарии развертывания).

#### <a name="concurrent-jobs-limit"></a>Ограничение количества одновременных заданий

Значение по умолчанию для предельного числа одновременно выполняемых заданий установлено на основе размера компьютера. Факторы, используемые для вычисления этого значения, зависят от объема оперативной памяти и количества ядер ЦП компьютера. Поэтому чем больше количество ядер и объем памяти, тем выше предельное число одновременных заданий по умолчанию.

Увеличьте масштаб, увеличив количество узлов. При увеличении количества узлов предельным числом одновременно выполняемых заданий является сумма предельных значений одновременных заданий всех доступных узлов.  Например, если один узел позволяет запускать не более двенадцати одновременно выполняемых заданий, то добавив три похожих узла, вы сможете выполнять 48 одновременных заданий (то есть 4 x 12). Предельное число одновременно выполняемых заданий рекомендуется увеличить, только если на каждом узле прослеживается низкое потребление ресурсов при использовании значений по умолчанию.

Вы можете переопределить полученное значение по умолчанию на портале Azure. Выберите "Создать" > "Подключения" > "Среды выполнения интеграции" > "Изменить" > "Узлы" > "Изменить число параллельных заданий на каждом узле". Можно также использовать команду PowerShell [Update-Azdatafactoryv2integrationruntimenode](https://docs.microsoft.com/powershell/module/az.datafactory/update-Azdatafactoryv2integrationruntimenode#examples) .
  
### <a name="status-per-node"></a>Состояние (на одном узле)
В следующей таблице приведены возможные состояния узла локальной среды выполнения интеграции:

| Status | Описание |
| ------ | ------------------ | 
| В сети | Узел подключен к службе фабрики данных. |
| Автономно | Узел находится в автономном режиме. |
| Обновление | Узел автоматически обновляется. |
| Ограниченная | Это состояние появляется при проблемах с подключением. Возможно, из-за проблем с портом 8050 HTTP, подключением к служебной шине или синхронизацией учетных данных. |
| Неактивно | Конфигурация узла отличается от конфигурации большинства других узлов. |

Узел может быть неактивным, если он не может подключиться к другим узлам.

### <a name="status-overall-self-hosted-integration-runtime"></a>Состояние (общая локальная среда выполнения интеграции)
В следующей таблице приведены возможные состояния локальной среды выполнения интеграции. Это состояние зависит от состояния всех узлов среде выполнения. 

| Status | Описание |
| ------ | ----------- | 
| Требуется регистрация | В этой локальной среде выполнения интеграции не зарегистрирован ни один узел. |
| В сети | Все узлы подключены к сети. |
| Автономно | Узлы не подключены к сети. |
| Ограниченная | Не все узлы в этой локальной среде выполнения интеграции находятся в работоспособном состоянии. Это состояние является предупреждением о том, что определенный узел не работает. Возможно, это произошло из-за проблемы с синхронизацией учетных данных на узле-диспетчера или на рабочем узле. |

Используйте командлет **Get-AzDataFactoryV2IntegrationRuntimeMetric** , чтобы получить полезные данные JSON, содержащие подробные свойства локальной среды выполнения интеграции, и значения моментальных снимков во время выполнения командлета.

```powershell
Get-AzDataFactoryV2IntegrationRuntimeMetric -name $integrationRuntimeName -ResourceGroupName $resourceGroupName -DataFactoryName $dataFactoryName  | | ConvertTo-Json 
```

Пример выходных данных (предполагается, что с этой локальной средой выполнения интеграции связаны два узла):

```json
{
    "IntegrationRuntimeName":  "<Name of your integration runtime>",
    "ResourceGroupName":  "<Resource Group Name>",
    "DataFactoryName":  "<Data Factory Name>",
    "Nodes":  [
        {
            "NodeName":  "<Node Name>",
            "AvailableMemoryInMB":  <Value>,
            "CpuUtilization":  <Value>,
            "ConcurrentJobsLimit":  <Value>,
            "ConcurrentJobsRunning":  <Value>,
            "MaxConcurrentJobs":  <Value>,
            "SentBytes":  <Value>,
            "ReceivedBytes":  <Value>
        },
        {
            "NodeName":  "<Node Name>",
            "AvailableMemoryInMB":  <Value>,
            "CpuUtilization":  <Value>,
            "ConcurrentJobsLimit":  <Value>,
            "ConcurrentJobsRunning":  <Value>,
            "MaxConcurrentJobs":  <Value>,
            "SentBytes":  <Value>,
            "ReceivedBytes":  <Value>
        }

    ]
} 
```


## <a name="azure-ssis-integration-runtime"></a>Azure-SSIS Integration Runtime
Среда выполнения интеграции Azure SSIS — это полностью управляемый кластер виртуальных машин (или узлов) Azure, выделенных для выполнения пакетов SSIS. В ней не выполняются другие действия фабрики данных Azure. После подготовки можно запросить ее свойства и отслеживать общее состояние и состояние определенного узла.

### <a name="properties"></a>properties

| Свойство или состояние | Описание |
| --------------- | ----------- |
| CreateTime | Время создания среды выполнения интеграции SSIS Azure в формате UTC. |
| Узлы | Выделенные и доступные узлы среды выполнения интеграции SSIS Azure с состояниями определенных узлов ("Запуск", "Доступно", "Перезапуск", "Недоступно") и ошибками, которые можно устранить. |
| OtherErrors | Ошибки, не связанные с конкретными узлами в среде выполнения интеграции SSIS Azure. |
| LastOperation | Результат последнего выполнения операции запуска и остановки в среде выполнения интеграции SSIS Azure с ошибками, которые можно устранить (в случае сбоя). |
| Состояние | Общее состояние ("Начальное", "Запуск", "Запущено", "Остановка", "Остановлено") среды выполнения интеграции SSIS Azure. |
| Location | Расположение среды выполнения интеграции SSIS Azure. |
| NodeSize | Размер каждого узла среды выполнения интеграции SSIS Azure. |
| NodeCount | Количество узлов в среде выполнения интеграции SSIS Azure. |
| MaxParallelExecutionsPerNode | Число параллельных выполнений на каждом узле в среде выполнения интеграции SSIS Azure. |
| CatalogServerEndpoint | Конечная точка имеющегося сервера Базы данных SQL Azure или Управляемого экземпляра для размещения SSISDB. |
| CatalogAdminUserName | Имя пользователя администратора имеющегося сервера Базы данных SQL Azure или управляемого экземпляра. Служба фабрики данных использует эти сведения для подготовки SSISDB и управления ею от вашего имени. |
| CatalogAdminPassword | Пароль администратора имеющегося сервера Базы данных или управляемого экземпляра SQL Azure. |
| CatalogPricingTier | Ценовая категория для SSISDB, размещенной на имеющемся сервере Базы данных SQL Azure.  Неприменимо к Управляемому экземпляру Базы данных SQL Azure, на котором размещена SSISDB. |
| VNetId | Идентификатор ресурса виртуальной сети, к которой нужно присоединить среду выполнения интеграции SQL Server Integration Services Azure. |
| Подсеть | Имя подсети, к которой нужно присоединить среду выполнения интеграции SSIS Azure. |
| ИД | Идентификатор ресурса среды выполнения интеграции SSIS Azure. |
| Тип | Тип (управляемая или локальная) среды выполнения интеграции SSIS Azure. |
| ResourceGroupName | Имя группы ресурсов Azure, в котором были созданы фабрика данных и среда выполнения интеграции SSIS Azure. |
| DataFactoryName | Имя фабрики данных Azure. |
| Name | Имя среды выполнения интеграции SSIS Azure. |
| Описание | Описание среды выполнения интеграции SSIS Azure. |

  
### <a name="status-per-node"></a>Состояние (на одном узле)

| Status | Описание |
| ------ | ----------- | 
| Запуск | Этот узел будет подготовлен. |
| Доступно | Этот узел готов к развертыванию и выполнению пакетов служб SSIS. |
| Перезапуск | Этот узел восстанавливается или перезапускается. |
| Рекомендации недоступны | Этот узел не готов к развертыванию и выполнения пакетов служб SSIS и в нем обнаружены ошибки или проблемы, которые можно устранить. |

### <a name="status-overall-azure-ssis-integration-runtime"></a>Состояние (общее для среды выполнения интеграции SSIS Azure)

| Общее состояние | Описание | 
| -------------- | ----------- | 
| Initial | Узлы среды выполнения интеграции SSIS Azure не выделены или не подготовлены. | 
| Запуск | Узлы среды выполнения интеграции SSIS Azure выделяются или подготавливаются, выставления счетов запущено. |
| Started | Узлы среды выполнения интеграции SSIS Azure выделены или подготовлены и готовы к развертыванию и выполнению пакетов служб SSIS. |
| Остановлено.  | Узлы среды выполнения интеграции SSIS Azure освобождаются. |
| Остановлена | Узлы среды выполнения интеграции SSIS Azure выпущены, выставления счетов остановлено. |

### <a name="monitor-the-azure-ssis-integration-runtime-in-the-azure-portal"></a>Мониторинг среды выполнения интеграции Azure SSIS в портале Azure

На приведенных ниже скриншотах показано, как выбрать среду выполнения интеграции Azure-SSIS для мониторинга, и предоставлен пример отображаемых данных.

![Выбор среды выполнения интеграции Azure SSIS для мониторинга](media/monitor-integration-runtime/monitor-azure-ssis-ir-image1.png)

![Просмотр сведений о среде выполнения интеграции Azure SSIS](media/monitor-integration-runtime/monitor-azure-ssis-ir-image2.png)

### <a name="monitor-the-azure-ssis-integration-runtime-with-powershell"></a>Мониторинг среды выполнения интеграции Azure SSIS с помощью PowerShell

Для проверки состояния в среде выполнения интеграции Azure SSIS используйте сценарий, аналогичный следующему примеру.

```powershell
Get-AzDataFactoryV2IntegrationRuntime -DataFactoryName $DataFactoryName -Name $AzureSSISName -ResourceGroupName $ResourceGroupName -Status
```

### <a name="more-info-about-the-azure-ssis-integration-runtime"></a>Дополнительная информация о среде выполнения интеграции Azure-SSIS

Дополнительные сведения о среде выполнения интеграции SSIS Azure см. в следующих разделах:

- [Среда выполнения интеграции Azure SSIS](concepts-integration-runtime.md#azure-ssis-integration-runtime). В этой статье содержатся общие сведения о средах выполнения интеграции в целом, включая Azure SSIS IR. 
- [Развертывание пакетов служб интеграции SQL Server (SSIS) в Azure](tutorial-create-azure-ssis-runtime-portal.md). Эта статья содержит пошаговые инструкции для создания Azure SSIS IR и использует базу данных SQL Azure для размещения каталога SSIS. 
- [Создание среды выполнения интеграции Azure SSIS](create-azure-ssis-integration-runtime.md). Эта статья дополняет соответствующее руководство, а также предоставляет инструкции по использованию Управляемого экземпляра Базы данных SQL Azure и присоединению среды выполнения интеграции к виртуальной сети. 
- [Управление средой выполнения интеграции Azure SSIS](manage-azure-ssis-integration-runtime.md). В этой статье показано, как остановить, запустить или удалить Azure SSIS IR. В ней также показано, как развернуть Azure SSIS IR путем добавления дополнительных узлов в среду выполнения интеграции. 
- [Присоединение среды выполнения интеграции Azure SSIS к виртуальной сети](join-azure-ssis-integration-runtime-virtual-network.md) В этой статье содержатся общие сведения о присоединении среды выполнения интеграции Azure–SSIS к виртуальной сети Azure. Из статьи вы также узнаете, как настроить виртуальную сеть, чтобы присоединить среду выполнения интеграции SQL Server Integration Services Azure к виртуальной сети с помощью портала Azure. 

## <a name="next-steps"></a>Дальнейшие действия
В следующих статьях представлены сведения о способах мониторинга конвейеров: 

- [Create a data factory and pipeline using .NET SDK](quickstart-create-data-factory-dot-net.md) (Создание фабрики данных и конвейера с помощью пакета SDK для .NET)
- [Monitor data factories using Azure Monitor](monitor-using-azure-monitor.md) (Мониторинг фабрик данных с помощью Azure Monitor)
