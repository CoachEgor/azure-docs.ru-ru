---
title: Загрузка данных из Office 365 с помощью Фабрики данных Azure | Документация Майкрософт
description: Использование Фабрики данных Azure для копирования данных из Office 365
services: data-factory
documentationcenter: ''
author: linda33wj
manager: craigg
ms.reviewer: douglasl
ms.service: data-factory
ms.workload: data-services
ms.topic: conceptual
ms.date: 10/22/2018
ms.author: jingwang
ms.openlocfilehash: fe3a3b673f6512856f3640b3e103db8623570a88
ms.sourcegitcommit: 41ca82b5f95d2e07b0c7f9025b912daf0ab21909
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/13/2019
ms.locfileid: "60548292"
---
# <a name="load-data-from-office-365-by-using-azure-data-factory"></a>Загрузка данных из Office 365 с помощью Фабрики данных Azure

В этой статье показано, как использовать Фабрику данных для _загрузки данных из Office 365 в хранилище BLOB-объектов Azure_. Эти шаги применяются и для копирования данных в Azure Data Lake 1-го и 2-го поколения. Общие сведения о копировании данных из Office 365 см. в статье [о соединителе Office 365](connector-office-365.md).

## <a name="create-a-data-factory"></a>Создание фабрики данных

1. В меню слева выберите **Создать ресурс** > **Данные и аналитика** > **Фабрика данных**. 
   
   ![Выбор фабрики данных в области "Создать"](./media/quickstart-create-data-factory-portal/new-azure-data-factory-menu.png)

2. В полях на странице **Новая фабрика данных** задайте значения, как показано на следующем изображении:
      
   ![Страница "Новая фабрика данных"](./media/load-office-365-data/new-azure-data-factory.png)
 
    * **Имя.** Введите глобальное уникальное имя фабрики данных Azure. Если отобразится сообщение об ошибке "Имя \"LoadFromOffice365Demo\" фабрики данных недоступно", введите другое имя. Например, вы можете использовать имя _**ваше_имя**_ **LoadFromOffice365Demo**. Попробуйте создать фабрику данных еще раз. Правила именования артефактов службы "Фабрика данных" см. в [этой](naming-rules.md) статье.
    * **Подписка**: Выберите подписку Azure, в рамках которой нужно создать фабрику данных. 
    * **Группа ресурсов.** Выберите существующую группу ресурсов из раскрывающегося списка или щелкните вариант **Создать новую** и введите имя группы ресурсов. Сведения о группах ресурсов см. в статье, где описывается [использование групп ресурсов для управления ресурсами Azure](../azure-resource-manager/resource-group-overview.md).  
    * **Версия.** Выберите **V2**.
    * **Расположение.** Укажите расположение фабрики данных. В раскрывающемся списке отображаются только поддерживаемые расположения. Хранилища данных, используемые в фабрике данных, могут находиться в других расположениях и регионах. К этим хранилищам относятся Azure Data Lake Store, служба хранилища Azure, база данных SQL Azure и т. д.

3. Нажмите кнопку **Создать**.
4. После создания перейдите к фабрике данных. Вы увидите домашнюю страницу **фабрики данных**, как показано на следующем изображении:
   
   ![Домашняя страница фабрики данных](./media/load-office-365-data/data-factory-home-page.png)

5. Выберите плитку **Создание и мониторинг**, чтобы открыть на отдельной вкладке приложение интеграции данных.

## <a name="create-a-pipeline"></a>Создание конвейера

1. На странице "Начало работы" выберите **Create pipeline** (Создать конвейер).
 
    ![Создание конвейера](./media/load-office-365-data/create-pipeline-entry.png)

2. На вкладке **Общие** для конвейера введите "CopyPipeline" в качестве **имени** конвейера.

3. На панели элементов "Действия" разверните категорию Move & Transform (Переместить и преобразовать) и перетащите действие **Копирование** из панели элементов в область конструктора конвейера. В качестве имени действия укажите CopyFromOffice365ToBlob.

### <a name="configure-source"></a>Настройка источника

1. Перейдите в конвейере на вкладку **Источник** и нажмите кнопку **+ Создать**, чтобы создать исходный набор данных. 

2. В окне "Новый набор данных" выберите **Office 365** и нажмите кнопку **Готово**.

    ![Новый набор данных Office 365](./media/load-office-365-data/new-office-365-dataset.png)
 
3. Откроется новая вкладка для набора данных Office 365. На вкладке **Общие** в нижней части окна "Свойства" в поле "Имя" введите SourceOffice365Dataset.

    ![Общая настройка набора данных Office 365](./media/load-office-365-data/config-office-365-dataset-general.png)
 
4. Перейдите на вкладку **Подключение** в окне "Свойства". Щелкните **+ Создать** рядом с текстовым полем "Связанная служба".
 
    ![Настройка подключения к набору данных Office 365](./media/load-office-365-data/config-office-365-dataset-connection.png)

5. В окне New Linked Service (Новая связанная служба) введите Office365LinkedService в качестве имени, введите идентификатор и ключ субъекта-службы, а затем нажмите кнопку "Сохранить", чтобы развернуть связанную службу.

    ![Новая связанная служба Office 365](./media/load-office-365-data/new-office-365-linked-service.png)
 
6. После создания связанной службы снова откроются параметры набора данных. Рядом с полем "Таблица" щелкните стрелку вниз, чтобы открыть раскрывающийся список доступных наборов данных Office 365, и выберите BasicDataSet_v0. Contact_v0 из списка:

    ![Настройка таблицы набора данных Office 365](./media/load-office-365-data/config-office-365-dataset-table.png)
 
7. Перейдите на вкладку **Схема** в окне "Свойства" и нажмите кнопку **Импорт схемы**.  Обратите внимание, что отображаются схема и примеры значений для набора данных контактов.

    ![Настройка схемы набора данных Office 365](./media/load-office-365-data/config-office-365-dataset-schema.png)

8. Теперь вернитесь в конвейер, откройте вкладку "Источник" и убедитесь, что выбран вариант SourceBlobDataset.
 
### <a name="configure-sink"></a>Настройка приемника

1. Перейдите на вкладку конвейера **Приемник** и выберите **+ Создать**, чтобы создать целевой набор данных.
 
2. В окне "Новый набор данных" обратите внимание, что при копировании из Office 365 выбрано только поддерживаемое место назначения. Выберите **Хранилище BLOB-объектов Azure**, а затем нажмите кнопку **Готово**.  В этом руководстве вы скопируете данные Office 365 в хранилище BLOB-объектов Azure.

    ![Новый набор данных большого двоичного объекта](./media/load-office-365-data/new-blob-dataset.png)

4. Перейдите на вкладку **Общие** в окне свойств и введите OutputBlobDataset в поле "Имя".

5. Перейдите на вкладку **Подключение** в окне "Свойства". Рядом с текстовым полем "Связанная служба" нажмите кнопку **+ Создать**.

    ![Настройка подключения к набору данных большого двоичного объекта](./media/load-office-365-data/config-blob-dataset-connection.png) 

6. В окне новой связанной службы введите AzureStorageLinkedService в качестве имени, выберите "Субъект-служба" из раскрывающегося списка методов проверки подлинности, укажите конечную точку службы, идентификатор субъекта-службы клиента и ключ субъекта-службы, а затем нажмите кнопку "Сохранить", чтобы развернуть связанную службу.  Дополнительные сведения о настройке проверки подлинности субъекта-службы для хранилища BLOB-объектов Azure см. [здесь](connector-azure-blob-storage.md#service-principal-authentication).

    ![Новая связанная служба больших двоичных объектов](./media/load-office-365-data/new-blob-linked-service.png)

7. После создания связанной службы снова откроются параметры набора данных. Рядом с полем "Путь к файлу" щелкните **Просмотр**, чтобы выбрать выходную папку, в которую будут извлечены данные Office 365.  В разделе File Format Settings (Параметры формата файла) в поле File Format (Формат файла) выберите **JSON format** (Формат JSON), а в поле File Pattern (Шаблон файла) выберите**Set of objects** (Набор объектов).

    ![Настройка формата и пути к набору данных большого двоичного объекта](./media/load-office-365-data/config-blob-dataset-path-and-format.png) 

8. Вернитесь в конвейер, откройте вкладку "Приемник" и убедитесь, что выбран вариант OutputBlobDataset.

## <a name="validate-the-pipeline"></a>Проверка конвейера

Чтобы проверить параметры конвейера, на панели инструментов выберите **Проверить**.

Чтобы отобразить код JSON, соответствующий конвейеру, щелкните "Код" в правом верхнем углу.

## <a name="publish-the-pipeline"></a>Публикация конвейера

В верхней части панели инструментов щелкните **Опубликовать все**. Это действие опубликует созданные сущности (наборы данных и конвейеры) в фабрике данных.

![Публикация изменений](./media/load-office-365-data/publish-changes.png) 

## <a name="trigger-the-pipeline-manually"></a>Aктивация конвейера вручную

Выберите **Trigger** (Запустить) на панели инструментов, а затем **Trigger Now** (Запустить сейчас). На странице Pipeline Run (Запуск конвейера) нажмите кнопку **Готово**. 

## <a name="monitor-the-pipeline"></a>Мониторинг конвейера

Перейдите на вкладку **Мониторинг** слева. Вы увидите выполнение конвейера, которое вы только что активировали вручную. Ссылки в столбце **Действия** позволят вам просмотреть подробные сведения о действиях и (или) повторно выполнить конвейер.

![Отслеживание конвейера](./media/load-office-365-data/pipeline-monitoring.png) 

Чтобы просмотреть запуски действий, связанные с этим запуском конвейера, щелкните ссылку **View Activity Runs** (Просмотр запусков действий) в столбце "Действия". В нашем примере определено только одно действие, поэтому в списке вы увидите только одну запись. Чтобы увидеть сведения об операции копирования, щелкните ссылку **Сведения** (значок очков) в столбце "Действия".

![Мониторинг действий](./media/load-office-365-data/activity-monitoring.png) 

Если вы впервые запрашиваете данные для этого контекста (представляющего комбинацию из таблицы данных, к которой осуществляется доступ, целевой учетной записи, в которую загружаются данные, и идентификатора пользователя, используемого для запроса доступа к данным), для действия копирования будет отображаться состояние **Выполняется** и, только когда вы щелкните ссылку "Подробности" в разделе"Действия", вы увидите состояние **RequesetingConsent** (Запрос на получение согласия).  Участник группы одобрения доступа к данным должен утвердить запрос в Privileged Access Management до того, как можно будет продолжить извлечение данных.

_Состояние RequesetingConsent (Запрос на получение согласия):_ 
![Сведения о выполнении действия — запрос на получение согласия](./media/load-office-365-data/activity-details-request-consent.png) 

_Состояние ExtractingData (Извлечение данных):_

![Сведения о выполнении действия — извлечение данных](./media/load-office-365-data/activity-details-extract-data.png) 

Как только согласие будет предоставлено, извлечение данных продолжится, и через некоторое запуск конвейера отобразится как завершенный.

![Отслеживание конвейера — успешно](./media/load-office-365-data/pipeline-monitoring-succeeded.png) 

Теперь перейдите в целевое хранилище BLOB-объектов Azure и убедитесь, что данные Office 365 были извлечены в формате JSON.

## <a name="next-steps"></a>Дальнейшие действия

Перейдите к следующей статье, чтобы узнать о поддержке хранилища данных SQL Azure: 

> [!div class="nextstepaction"]
>[Соединитель Office 365](connector-office-365.md)