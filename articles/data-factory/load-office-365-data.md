---
title: Загрузка данных из Office 365 с помощью Фабрики данных Azure
description: Использование Фабрики данных Azure для копирования данных из Office 365
services: data-factory
documentationcenter: ''
author: linda33wj
manager: shwang
ms.reviewer: douglasl
ms.service: data-factory
ms.workload: data-services
ms.topic: conceptual
ms.date: 10/22/2018
ms.author: jingwang
ms.openlocfilehash: 3422176ed89b7f575c11cc40e5be8420da0018b0
ms.sourcegitcommit: b80aafd2c71d7366838811e92bd234ddbab507b6
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/16/2020
ms.locfileid: "81415797"
---
# <a name="load-data-from-office-365-by-using-azure-data-factory"></a>Загрузка данных из Office 365 с помощью Фабрики данных Azure

[!INCLUDE[appliesto-adf-xxx-md](includes/appliesto-adf-xxx-md.md)]

В этой статье показано, как использовать Фабрику данных для _загрузки данных из Office 365 в хранилище BLOB-объектов Azure_. Эти шаги применяются и для копирования данных в Azure Data Lake 1-го и 2-го поколения. Общие сведения о копировании данных из Office 365 см. в статье [о соединителе Office 365](connector-office-365.md).

## <a name="create-a-data-factory"></a>Создание фабрики данных

1. В левом меню выберите Создать**Analytics** > **фабрику аналитики данных** **ресурсов:** >  
   
   ![Выбор фабрики данных в области "Создать"](./media/quickstart-create-data-factory-portal/new-azure-data-factory-menu.png)

2. В полях на странице **Новая фабрика данных** задайте значения, как показано на следующем изображении:
      
   ![Страница "Новая фабрика данных"](./media/load-office-365-data/new-azure-data-factory.png)
 
    * **Имя.** Введите глобальное уникальное имя фабрики данных Azure. Если вы получили ошибку "Имя фабрики данных *LoadFromOffice365Demo* недоступно", введите другое название для фабрики данных. Например, вы можете использовать имя _**ваше_имя**_**LoadFromOffice365Demo**. Попробуйте создать фабрику данных еще раз. Правила именования артефактов службы "Фабрика данных" см. в [этой](naming-rules.md) статье.
    * **Подписка.** Выберите подписку Azure, в рамках которой нужно создать фабрику данных. 
    * **Группа ресурсов.** Выберите имеющуюся группу ресурсов из раскрывающегося списка или щелкните параметр **Create new** (Создать) и введите имя группы ресурсов. Сведения о группах ресурсов см. в статье, где описывается [использование групп ресурсов для управления ресурсами Azure](../azure-resource-manager/management/overview.md).  
    * **Версия.** Выберите значение **V2**.
    * **Расположение.** Выберите расположение фабрики данных. В раскрывающемся списке отображаются только поддерживаемые расположения. Хранилища данных, используемые в фабрике данных, могут находиться в других расположениях и регионах. К этим хранилищам относятся Azure Data Lake Store, служба хранилища Azure, база данных SQL Azure и т. д.

3. Нажмите кнопку **создания**.
4. После создания перейдите к фабрике данных. Вы увидите домашнюю страницу **фабрики данных**, как показано на следующем изображении:
   
   ![Домашняя страница фабрики данных](./media/load-office-365-data/data-factory-home-page.png)

5. Выберите плитку **Создание и мониторинг**, чтобы открыть на отдельной вкладке приложение интеграции данных.

## <a name="create-a-pipeline"></a>Создание конвейера

1. На странице «Давайте начнем» выберите **«Создайте конвейер».**
 
    ![Создание конвейера](./media/load-office-365-data/create-pipeline-entry.png)

2. В **общей вкладке** для конвейера введите "CopyPipeline" для **названия** конвейера.

3. На панели элементов "Действия" разверните категорию Move & Transform (Переместить и преобразовать) и перетащите действие **Копирование** из панели элементов в область конструктора конвейера. В качестве имени действия укажите CopyFromOffice365ToBlob.

### <a name="configure-source"></a>Настройка источника

1. Перейдите в конвейере на вкладку **Источник** и нажмите кнопку **+ Создать**, чтобы создать исходный набор данных. 

2. В новом окне набора данных выберите **Office 365,** а затем выберите **Продолжить**.
 
3. Теперь вы находитесь в вкладке конфигурации активности копирования. Нажмите на кнопку **"Отредит** рядом с набором данных Office 365", чтобы продолжить конфигурацию данных.

    ![Общая настройка набора данных Office 365](./media/load-office-365-data/transition-to-edit-dataset.png)
 
4. Откроется новая вкладка для набора данных Office 365. В **общей вкладке** в нижней части окна Свойств введите название "SourceOffice365Dataset".
 
5. Перейдите на **вкладку Подключения** окна Свойств. Щелкните **+ Создать** рядом с текстовым полем "Связанная служба".

6. В новом окне службы Linked Введите "Office365LinkedService" в качестве имени, введите идентификатор службы и ключевой ключ службы, затем проверьте соединение и выберите **Создать** для развертывания связанной службы.

    ![Новая связанная служба Office 365](./media/load-office-365-data/new-office-365-linked-service.png)
 
7. После создания связанной службы снова откроются параметры набора данных. Рядом с **таблицей**выберите вниз-стрелка, чтобы расширить список доступных наборов данных Office 365, и выбрать "BasicDataSet_v0. Message_v0" из списка выпадающих:

    ![Настройка таблицы набора данных Office 365](./media/load-office-365-data/edit-dataset.png)

8. Теперь вернитесь к**вкладке «Источник** **конвейера»,** > чтобы продолжить настройку дополнительных свойств для извлечения данных Office 365.  Область действия пользователя и фильтр сферы действия пользователя являются дополнительными предикатами, которые можно определить, чтобы ограничить данные, которые вы хотите извлечь из Office 365. О том, как настроить эти настройки, можно ознакомиться в разделе [свойства набора данных Office 365.](https://docs.microsoft.com/azure/data-factory/connector-office-365#dataset-properties)

9. Вы должны выбрать один из фильтров даты и обеспечить время начала и значения времени окончания.

10. Нажмите на вкладку **«Импорт схема»,** чтобы импортировать схему для набора данных сообщений.

    ![Настройка схемы набора данных Office 365](./media/load-office-365-data/edit-source-properties.png)

### <a name="configure-sink"></a>Настройка приемника

1. Перейдите на вкладку конвейера **Приемник** и выберите **+ Создать**, чтобы создать целевой набор данных.
 
2. В окне нового набора данных обратите внимание, что при копировании из Office 365 выбираются только поддерживаемые направления. Выберите **Хранилище Azure Blob,** выберите двоичный формат, а затем выберите **Продолжить**.  В этом руководстве вы скопируете данные Office 365 в хранилище BLOB-объектов Azure.

3. Нажмите на кнопку **«Отредит»** рядом с набором данных хранилища Azure Blob, чтобы продолжить конфигурацию данных.

4. Перейдите на вкладку **Общие** в окне свойств и введите OutputBlobDataset в поле "Имя".

5. Перейдите на **вкладку Подключения** окна Свойств. Рядом с текстовым полем Связанная служба нажмите кнопку **+ Создать**.

6. В новом окне службы Linked, введите "AzureStorageLinkedService" в качестве имени, выберите "Основной службы" из списка выпадающих методов проверки подлинности, заполните конечную точку службы, арендатора, идентификатора основного обслуживания и ключевой ключ службы, а затем выберите Сохранить для развертывания связанной службы.  Дополнительные сведения о настройке проверки подлинности субъекта-службы для хранилища BLOB-объектов Azure см. [здесь](connector-azure-blob-storage.md#service-principal-authentication).

    ![Новая связанная служба больших двоичных объектов](./media/load-office-365-data/configure-blob-linked-service.png)


## <a name="validate-the-pipeline"></a>Проверка конвейера

Чтобы проверить параметры конвейера, на панели инструментов выберите **Проверить**.

Чтобы отобразить код JSON, соответствующий конвейеру, щелкните "Код" в правом верхнем углу.

## <a name="publish-the-pipeline"></a>Публикация конвейера

В верхней части панели инструментов щелкните **Опубликовать все**. Это действие опубликует созданные сущности (наборы данных и конвейеры) в фабрике данных.

![Публикация изменений](./media/load-office-365-data/publish-changes.png) 

## <a name="trigger-the-pipeline-manually"></a>Aктивация конвейера вручную

Выберите **Добавить триггер** на панели инструментов, а затем **Trigger Now** (Запустить сейчас). На странице Pipeline Run (Запуск конвейера) нажмите кнопку **Готово**. 

## <a name="monitor-the-pipeline"></a>Мониторинг конвейера

Перейдите на вкладку **Мониторинг** слева. Вы увидите выполнение конвейера, которое вы только что активировали вручную. Можно использовать ссылки в столбце **«Действия»** для просмотра деталей деятельности и повторного запуска конвейера.

![Отслеживание конвейера](./media/load-office-365-data/pipeline-status.png) 

Чтобы просмотреть запуски действий, связанные с этим запуском конвейера, щелкните ссылку **View Activity Runs** (Просмотр запусков действий) в столбце Действия. В нашем примере определено только одно действие, поэтому в списке вы увидите только одну запись. Чтобы увидеть сведения об операции копирования, щелкните ссылку **Сведения** (значок очков) в столбце Действия.

![Мониторинг действий](./media/load-office-365-data/activity-status.png) 

Если это первый раз, когда вы запрашиваете данные для этого контекста (комбинация, к которой находится доступ к таблице данных, в какой учетной записи назначения является загрузка данных и какой пользовательский тип пользователя делает запрос на доступ к данным), вы увидите статус действия копирования как **In Progress**, и только при нажатии на ссылку "Подробности" в рамках Акции вы увидите статус **RequesetingConsent.**  Участник группы лиц, утверждающих доступ к данным, должен утвердить запрос в Privileged Access Management, прежде чем можно будет продолжить извлечение данных.

_Статус как запрашиваемый согласие:_
![Детали выполнения действия - согласие запроса](./media/load-office-365-data/activity-details-request-consent.png) 

_Состояние ExtractingData (Извлечение данных):_

![Сведения о выполнении действия — извлечение данных](./media/load-office-365-data/activity-details-extract-data.png) 

Как только согласие будет предоставлено, извлечение данных будет продолжено, и через некоторое время запуск трубопровода будет показан как успешно.

![Отслеживание конвейера — успешно](./media/load-office-365-data/pipeline-monitoring-succeeded.png) 

Теперь перейдите к месту назначения Azure Blob Storage и убедитесь, что данные Office 365 были извлечены в двоичном формате.

## <a name="next-steps"></a>Дальнейшие действия

Перейдите к следующей статье, чтобы узнать о поддержке хранилища данных SQL Azure: 

> [!div class="nextstepaction"]
>[Соединитель Office 365](connector-office-365.md)