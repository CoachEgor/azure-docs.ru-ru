---
title: Картирование потока данных Выберите Трансформацию
description: Отображение потока данных Azure Data Factory Выберите Преобразование
author: kromerm
ms.author: makromer
ms.service: data-factory
ms.topic: conceptual
ms.custom: seo-lt-2019
ms.date: 03/18/2020
ms.openlocfilehash: cfa15f5424dcd5d52b03fb65afe051444127f5ed
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "80065213"
---
# <a name="select-transformation-in-mapping-data-flow"></a>Выберите преобразование в потоке карт данных

Используйте выбранное преобразование для переименования, падения или перепорядка столбцов. Это преобразование не изменяет данные строки, но выбирает, какие столбцы распространяются ниже по течению. 

В выбранном преобразовании пользователи могут указывать фиксированные отображения, использовать шаблоны для картирования на основе правил или включать автоматическое отображение. Фиксированные и основанные на правилах отображения могут использоваться в рамках одного и того же преобразования выбора. Если столбец не соответствует одному из определенных карт, он будет удален.

## <a name="fixed-mapping"></a>Фиксированное отображение

Если в проекции определено менее 50 столбцов, то все определенные столбцы будут иметь фиксированное отображение по умолчанию. Фиксированное отображение принимает определенный, входящий столбец и отображает его точное имя.

![Фиксированное отображение](media/data-flow/fixedmapping.png "Фиксированное отображение")

> [!NOTE]
> Нельзя отобразить или переименовать дрейфующий столбец с помощью фиксированного отображения

### <a name="mapping-hierarchical-columns"></a>Картирование иерархических столбцов

Фиксированные отображения могут использоваться для отображения подколонны иерархической колонки с столбцей верхнего уровня. Если у вас определенная иерархия, используйте выпадение столбца, чтобы выбрать подколонку. Выбранное преобразование создаст новый столбец со значением и типом данных подкола.

![иерархическое отображение](media/data-flow/select-hierarchy.png "иерархическое отображение")

## <a name="rule-based-mapping"></a>Rule-based mapping (Выбор преобразования: сопоставление на основе правил)

Если вы хотите сопоставить множество столбцов одновременно или пройти дрейфующие столбцы вниз по течению, используйте картографическое на основе правил, чтобы определить ваши отображения с помощью шаблонов столбцов. Матч на `name`основе `type` `stream`, `position` и, и столбцов. Вы можете иметь любую комбинацию фиксированных и основанных на правилах карт. По умолчанию все проекции с более чем 50 столбцов будут по умолчанию для картирования на основе правил, которое совпадает с каждым столбецом и выводит вводимое имя. 

Чтобы добавить картографическое отображение на основе правил, щелкните **отображение добавить** и выберите **отображение на основе правил.**

![картирование на основе правил](media/data-flow/rule2.png "Rule-based mapping (Выбор преобразования: сопоставление на основе правил)")

Каждое картографическое на основе правил требует двух входов: условие, на котором можно сопоставить, и как назвать каждый сопоставленный столбец. Оба значения ввелись через [конструктор выражения.](concepts-data-flow-expression-builder.md) В левой поле выражения, введите ваш boolean условия соответствия. В нужном поле выражения укажите, на что будет отображаться соответствующий столбец.

![картирование на основе правил](media/data-flow/rule-based-mapping.png "Rule-based mapping (Выбор преобразования: сопоставление на основе правил)")

Используйте `$$` синтаксис для ссылки на имя ввода совмещенных столбцов. Используя приведенное выше изображение в качестве примера, например, можно сказать, что пользователь хочет сопоставить на всех строках столбцов, имена которых короче шести символов. Если один входящий `test`столбец `$$ + '_short'` был назван, `test_short`выражение переименует столбец. Если это единственное сопоставление, которое существует, все столбцы, которые не соответствуют состоянию, будут удалены из выдвитых данных.

Шаблоны соответствуют как дрейфуным, так и определенным столбикам. Чтобы увидеть, какие определенные столбцы отображаются по правилу, щелкните значок очков рядом с правилом. Проверьте вывод с помощью предварительного просмотра данных.

### <a name="regex-mapping"></a>Регекс отображение

При нажатии на значок chevron вниз, вы можете указать условие отображения regex. Условие отображения regex совпадает со всеми именами столбцов, которые соответствуют указанному состоянию regex. Это может быть использовано в сочетании со стандартными картографами на основе правил.

![картирование на основе правил](media/data-flow/regex-matching.png "Rule-based mapping (Выбор преобразования: сопоставление на основе правил)")

Приведенный выше пример совпадает с шаблоном `(r)` regex или любым названием столбца, содержащим нижний корпус r. Подобно стандартному картографии на основе правил, все соответствующие столбцы `$$` изменяются условием справа с помощью синтаксиса.

Если у вас есть несколько совпадений regex `$n` в названии столбца, вы можете обратиться к определенным совпадениям, используя, где 'n' относится к которому совпадают. Например, '$2' относится ко второму совпадению в названии столбца.

### <a name="rule-based-hierarchies"></a>Иерархии, основанные на правилах

Если определенная проекция имеет иерархию, можно использовать картографическое отображение на основе правил для картирования подколов иерархий. Укажите соответствующее состояние и сложную колонку, подколонки которых вы хотите сопоставить. Каждая соответствующая подколонка будет вывезначна с использованием правила "Имя как", указанное справа.

![картирование на основе правил](media/data-flow/rule-based-hierarchy.png "Rule-based mapping (Выбор преобразования: сопоставление на основе правил)")

Приведенный выше пример совпадает со `a`всеми подколонками сложной колонки. `a`содержит два подколонки `b` и `c`. Схема вывода будет включать в `b` себя `c` два столбца и `$$`как условие "Имя как" .

### <a name="parameterization"></a>Определение параметров

Можно параметризировать имена столбцов с помощью картографирования на основе правил. Используйте ключевое слово ```name``` для сопоставления входящих имен столбцов с параметром. Например, если у вас ```mycolumn```есть параметр потока данных, можно создать ```mycolumn```правило, которое соответствует любому имени столбца, равному. Можно переименовать столбец в жестко закодированную строку, такую как «бизнес-ключ», и прямо ссылаться на него. В этом примере условие ```name == $mycolumn``` соответствия, а состояние имени — «бизнес-ключ». 

## <a name="auto-mapping"></a>Автоматическое отображение

При добавлении выбранного преобразования **автоматическое отображение** может быть включено путем переключения ползунка отображения Auto. С автоматическим отображением, выбрать преобразование карты всех входящих столбцов, за исключением дубликатов, с тем же именем, как их входной. Это будет включать в себя дрейфуные столбцы, что означает, что выходные данные могут содержать столбцы, не определенные в вашей схеме. Для получения дополнительной информации о дрейфующих столбцов, [см.](concepts-data-flow-schema-drift.md)

![Автоматическое отображение](media/data-flow/automap.png "Автоматическое отображение")

При автоматическом отображении, выбранное преобразование будет соблюдать настройки пропустить дубликаты и предоставитновый новый псевдоним для существующих столбцов. Прозвище полезно при выполнении нескольких соединений или поисков в одном потоке и в сценариях самостоятельного соединения. 

## <a name="duplicate-columns"></a>Дублирование столбцов

По умолчанию выбранное преобразование отбрасывает дубликаты столбцов как в входному, так и в проекцию вывода. Двойные столбцы ввода часто происходят из преобразований соединения и поиска, где имена столбцов дублируются по обе стороны соединения. Дублирование выходных столбцов может произойти, если сопоставить два разных столбца ввода с тем же именем. Выберите, следует ли отказаться или передать дубликаты столбцов, пережавая флажок.

![Пропустить дубликаты](media/data-flow/select-skip-dup.png "Пропустить дубликаты")

## <a name="ordering-of-columns"></a>Заказ колонн

Порядок картографирования определяет порядок выходных столбцов. Если столбец ввода отображается несколько раз, будет выполнено только первое отображение. Для любого дублирующего столбца снижается, первый матч будет сохранен.

## <a name="data-flow-script"></a>Скрипт потока данных

### <a name="syntax"></a>Синтаксис

```
<incomingStream>
    select(mapColumn(
        each(<hierarchicalColumn>, match(<matchCondition>), <nameCondition> = $$), ## hierarchical rule-based matching
        <fixedColumn>, ## fixed mapping, no rename
        <renamedFixedColumn> = <fixedColumn>, ## fixed mapping, rename
        each(match(<matchCondition>), <nameCondition> = $$), ## rule-based mapping
        each(patternMatch(<regexMatching>), <nameCondition> = $$) ## regex mapping
    ),
    skipDuplicateMapInputs: { true | false },
    skipDuplicateMapOutputs: { true | false }) ~> <selectTransformationName>
```

### <a name="example"></a>Пример

Ниже приведен пример выбранного отображения и сценария потока данных:

![Выберите пример сценария](media/data-flow/select-script-example.png "Выберите пример сценария")

```
DerivedColumn1 select(mapColumn(
        each(a, match(true())),
        movie,
        title1 = title,
        each(match(name == 'Rating')),
        each(patternMatch(`(y)`),
            $1 + 'regex' = $$)
    ),
    skipDuplicateMapInputs: true,
    skipDuplicateMapOutputs: true) ~> Select1
```

## <a name="next-steps"></a>Дальнейшие действия
* После использования Select для переименования, изменения порядка и псевдонимов, используйте [преобразование sink](data-flow-sink.md) для передачи данных в хранилище данных.
