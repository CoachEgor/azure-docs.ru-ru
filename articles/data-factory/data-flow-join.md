---
title: Преобразование соединения в потоках данных Фабрики данных Azure
description: Преобразование соединения в потоках данных Фабрики данных Azure
author: kromerm
ms.author: makromer
ms.reviewer: douglasl
ms.service: data-factory
ms.topic: conceptual
ms.date: 02/07/2019
ms.openlocfilehash: 48cf9d58c8acd85e545a5bcb5104d7069670e349
ms.sourcegitcommit: 11265f4ff9f8e727a0cbf2af20a8057f5923ccda
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/08/2019
ms.locfileid: "72029320"
---
# <a name="mapping-data-flow-join-transformation"></a>Сопоставление преобразования «соединение потока данных»



С помощью преобразования соединения можно объединить данные из двух таблиц в потоке данных. Щелкните преобразование, которое будет левой связью, и добавьте преобразование соединения, выбрав его на панели элементов. Внутри преобразования соединения нужно выбрать другой поток данных из своего потока данных в качестве правой связи.

![Преобразование соединения](media/data-flow/join.png "соединение")

## <a name="join-types"></a>Типы соединений

Для преобразования «соединение» требуется выбрать тип объединения.

### <a name="inner-join"></a>Внутреннее соединение

Внутреннее соединение будет проходить только по строкам, которые соответствуют условиям столбца из обеих таблиц.

### <a name="left-outer"></a>Левое внешнее соединение

Левое внешнее соединение устанавливается по записям левого потока, которые не соответствуют условию соединения, и записям, возвращенным внутренним соединением. Для выходных столбцов другой таблицы устанавливается значение NULL.

### <a name="right-outer"></a>Правое внешнее соединение

Правое внешнее соединение устанавливается по записям правого потока, которые не соответствуют условию соединения, и записям, возвращенным внутренним соединением. Для выходных столбцов другой таблицы устанавливается значение NULL.

### <a name="full-outer"></a>Полное внешнее соединение

Полное внешнее выдает все столбцы и строки с обеих сторон со значениями NULL для столбцов, отсутствующих в другой таблице.

### <a name="cross-join"></a>Перекрестное соединение

Укажите перекрестное произведение двух потоков с помощью выражения. Его можно использовать для создания пользовательских условий объединения.

## <a name="specify-join-conditions"></a>Указание условий соединения

Условие левого соединения относится к потоку данных, присоединенному слева от соединения. Условие правого соединения — это второй поток данных, присоединенный к соединению снизу, который будет либо прямым соединением с другим потоком, либо ссылкой на другой поток.

Необходимо ввести как минимум условие соединения 1 (1..n). Это могут быть поля, на которые есть прямые ссылки, которые выбраны из раскрывающегося меню или являются выражениями.

## <a name="join-performance-optimizations"></a>Оптимизация производительности соединений

В отличие от таких инструментов, как SQL Server Integration Services, соединение в Потоке данных ADF необязательно является операцией соединения слиянием. Поэтому ключи соединения не нужно изначально сортировать. Операция JOIN будет выполнена на основе оптимальной операции JOIN в Spark: широковещательное соединение или соединение на стороне сопоставления.

![Оптимизация преобразования соединения](media/data-flow/joinoptimize.png "оптимизация соединения")

Если набор данных может поместиться в память рабочего узла, можно оптимизировать производительность присоединений. Вы также можете указать секционирование своих данных в операции соединения, чтобы создавать наборы данных оптимального размера для объема памяти на один рабочий узел.

## <a name="self-join"></a>Самосоединение

Вы можете настроить условия самосоединения в Потоке данных ADF, используя преобразование выбора для добавления псевдонима к существующему потоку. Сначала создайте ветвь из потока, а затем добавьте преобразование выбора для добавления псевдонима ко всему исходному потоку.

![Самосоединение](media/data-flow/selfjoin.png "самосоединение")

В приведенной выше схеме преобразование выбора показано сверху. Оно присваивает исходному потоку псевдоним "OrigSourceBatting". В выделенном ниже преобразовании соединения этот поток с псевдонимом используется в качестве правой ветви соединения, что позволяет ссылаться на один и тот же ключ в левой и правой ветви внутреннего соединения.

## <a name="composite-and-custom-keys"></a>Составные и пользовательские ключи

Можно создавать настраиваемые и составные ключи в режиме реального времени внутри преобразования «соединение». Добавьте строки для дополнительных столбцов объединения со знаком "плюс" (+) рядом со строкой связи. Или Вычислите новое значение ключа в построителе выражений для значения объединения "на лету".

## <a name="next-steps"></a>Следующие шаги

После объединения данных можно [создать новые столбцы](data-flow-derived-column.md) и присоединить [данные к целевому хранилищу данных](data-flow-sink.md).
