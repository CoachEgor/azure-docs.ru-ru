---
title: Преобразование соединения в потоках данных Фабрики данных Azure
description: Преобразование соединения в потоках данных Фабрики данных Azure
author: kromerm
ms.author: makromer
ms.reviewer: douglasl
ms.service: data-factory
ms.topic: conceptual
ms.date: 02/07/2019
ms.openlocfilehash: 18f713198ef9aa45cb72a6718c0f7b086c019258
ms.sourcegitcommit: 3102f886aa962842303c8753fe8fa5324a52834a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "61348583"
---
# <a name="mapping-data-flow-join-transformation"></a>Преобразование «соединение» потока данных сопоставления

[!INCLUDE [notes](../../includes/data-factory-data-flow-preview.md)]

С помощью преобразования соединения можно объединить данные из двух таблиц в потоке данных. Щелкните преобразование, которое будет левой связью, и добавьте преобразование соединения, выбрав его на панели элементов. Внутри преобразования соединения нужно выбрать другой поток данных из своего потока данных в качестве правой связи.

![Преобразование соединения](media/data-flow/join.png "соединение")

## <a name="join-types"></a>Типы соединений

Выберите тип соединения является обязательным для преобразования «соединение».

### <a name="inner-join"></a>Внутреннее соединение

Внутреннее соединение будут переданы только те строки, удовлетворяющие условиям столбца из обеих таблиц.

### <a name="left-outer"></a>Левое внешнее соединение

Левое внешнее соединение устанавливается по записям левого потока, которые не соответствуют условию соединения, и записям, возвращенным внутренним соединением. Для выходных столбцов другой таблицы устанавливается значение NULL.

### <a name="right-outer"></a>Правое внешнее соединение

Правое внешнее соединение устанавливается по записям правого потока, которые не соответствуют условию соединения, и записям, возвращенным внутренним соединением. Для выходных столбцов другой таблицы устанавливается значение NULL.

### <a name="full-outer"></a>Полное внешнее соединение

Полное внешнее выдает все столбцы и строки из обеих сторон, со значениями NULL для столбцов, которые отсутствуют в другой таблице.

### <a name="cross-join"></a>Перекрестное соединение

Укажите перекрестное произведение двух потоков с помощью выражения. Это можно использовать для создания пользовательского соединения условий.

## <a name="specify-join-conditions"></a>Указание условий соединения

Условие левого соединения относится к потоку данных, присоединенному слева от соединения. Условие правого соединения — это второй поток данных, присоединенный к соединению снизу, который будет либо прямым соединением с другим потоком, либо ссылкой на другой поток.

Необходимо ввести как минимум условие соединения 1 (1..n). Это могут быть поля, на которые есть прямые ссылки, которые выбраны из раскрывающегося меню или являются выражениями.

## <a name="join-performance-optimizations"></a>Оптимизация производительности соединений

В отличие от таких инструментов, как SQL Server Integration Services, соединение в Потоке данных ADF необязательно является операцией соединения слиянием. Поэтому ключи соединения не нужно изначально сортировать. Операция соединения будет происходить в Spark с использованием Databricks на основе оптимальной операции соединения в Spark: широковещательное соединение или соединение на стороне сопоставления.

![Оптимизация преобразования соединения](media/data-flow/joinoptimize.png "оптимизация соединения")

Если размер набора данных не превышает объем памяти рабочего узла Databricks, мы можем оптимизировать производительность соединения. Вы также можете указать секционирование своих данных в операции соединения, чтобы создавать наборы данных оптимального размера для объема памяти на один рабочий узел.

## <a name="self-join"></a>Самосоединение

Вы можете настроить условия самосоединения в Потоке данных ADF, используя преобразование выбора для добавления псевдонима к существующему потоку. Сначала создайте ветвь из потока, а затем добавьте преобразование выбора для добавления псевдонима ко всему исходному потоку.

![Самосоединение](media/data-flow/selfjoin.png "самосоединение")

В приведенной выше схеме преобразование выбора показано сверху. Оно присваивает исходному потоку псевдоним "OrigSourceBatting". В выделенном ниже преобразовании соединения этот поток с псевдонимом используется в качестве правой ветви соединения, что позволяет ссылаться на один и тот же ключ в левой и правой ветви внутреннего соединения.

## <a name="composite-and-custom-keys"></a>Составные и пользовательские ключи

Вы можете создавать пользовательские и составные ключи на лету в преобразование «соединение». Добавление строк для столбцов дополнительные соединения со знаком плюса (+) рядом с каждой строки связи. Вычислений или новое значение ключа в списке построителя выражений для значения соединения в режиме реального времени.

## <a name="next-steps"></a>Дальнейшие действия

После объединения данных, можно затем [создавать новые столбцы](data-flow-derived-column.md) и [приемника данных в хранилище данных назначения](data-flow-sink.md).
