---
title: Изменение преобразования строки в потоке данных отображения
description: Как обновить цель базы данных с помощью преобразования строки изменения в потоке данных отображения
author: kromerm
ms.author: makromer
ms.reviewer: daperlov
ms.service: data-factory
ms.topic: conceptual
ms.custom: seo-lt-2019
ms.date: 01/08/2020
ms.openlocfilehash: 0798a3f9ab45ce68086681e7aea96deeb9639f94
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/27/2020
ms.locfileid: "75834544"
---
# <a name="alter-row-transformation-in-mapping-data-flow"></a>Изменение преобразования строки в потоке данных отображения

Используйте преобразование Alter Row для установки политики вставки, удаления, обновления и обновления на строках. В качестве выражений можно добавить условия от одного к немногим. Эти условия должны быть указаны в порядке приоритета, так как каждая строка будет отмечена политикой, соответствующей первому выражению. Каждое из этих условий может привести к вставке, обновлению, удалению или перенаправлению строки (или строк). Alter Row может производить как DDL & DML действия против вашей базы данных.

![Параметры строки alter](media/data-flow/alter-row1.png "Настройки строки Alter")

Преобразования Alter Row будут работать только в базе данных или в потоке данных. Действия, которые вы назначаете строкам (вставить, обновить, удалить, upsert) не будет происходить во время сеансов отладки. Запустите действие «Поток данных» в конвейере, чтобы ввести политики изменения строки в таблицах баз данных.

## <a name="specify-a-default-row-policy"></a>Указать политику строки по умолчанию

Создайте преобразование Alter Row и укажите политику строки `true()`с условием . Каждая строка, не совпадает ни с одной из ранее определенных выражений, будет помечена для указанной политики строки. По умолчанию каждая строка, не совпадает `Insert`с любым условным выражением, будет помечена для.

![Политика изменения строки](media/data-flow/alter-row4.png "Политика изменения строки")

> [!NOTE]
> Чтобы отметить все строки одной политикой, можно создать условие для `true()`этой политики и указать условие как.

## <a name="view-policies-in-data-preview"></a>Просмотр политик в предварительном просмотре данных

Используйте [режим отладки](concepts-data-flow-debug-mode.md) для просмотра результатов политики изменения строки в панели предварительного просмотра данных. Предварительный просмотр данных преобразования строки изменения не приведет к действиям DDL или DML против вашей цели.

![Изменение политик строк](media/data-flow/alter-row3.png "Политики Alter Row")

Каждая политика строки изменения представлена иконой, которая указывает, будет ли происходить вставка, обновление, upsert или удаленное действие. Верхний заголовок показывает, сколько строк зависит от каждой политики в предварительном просмотре.

## <a name="allow-alter-row-policies-in-sink"></a>Разрешить изменять политики строки в раковине

Для работы политики изменения строки поток данных должен записываться в базу данных или раковину Cosmos. В **вкладке "Настройки"** в раковине включите правила изменения строки для этой раковины.

![Раковина строки Alter](media/data-flow/alter-row2.png "Альтер строка раковина")

 Поведение по умолчанию позволяет только вставки. Чтобы позволить обновления, upserts, или удаляет, проверьте окно в раковине, соответствующей этому условию. Если включены обновления, upserts или, удаляет, необходимо указать, какие ключевые столбцы в раковине совпадают.

> [!NOTE]
> Если вставки, обновления или upserts изменить схему целевой таблицы в раковине, поток данных будет неудався. Чтобы изменить целевую схему в базе данных, выберите **Воссоздание таблицы** в качестве действия таблицы. Это позволит упасть и воссоздать таблицу с новым определением схемы.

## <a name="data-flow-script"></a>Скрипт потока данных

### <a name="syntax"></a>Синтаксис

```
<incomingStream>
    alterRow(
           insertIf(<condition>?),
           updateIf(<condition>?),
           deleteIf(<condition>?),
           upsertIf(<condition>?),
        ) ~> <alterRowTransformationName>
```

### <a name="example"></a>Пример

Ниже приведена преобразование `CleanData` строки alter, `SpecifyUpsertConditions` которое занимает входящий поток и создает три условия изменения строки. В предыдущем преобразовании `alterRowCondition` вычисляется столбец, который определяет, вставляется, обновляется или удаляется строка в базу данных. Если значение столбца имеет значение строки, совпадает с правилом строки alter, ему присваивается эта строка.

В Data Factory UX это преобразование выглядит как приведенное ниже изображение:

![Пример строки Alter](media/data-flow/alter-row4.png "Пример строки Alter")

Сценарий потока данных для этого преобразования находится в фрагменте ниже:

```
SpecifyUpsertConditions alterRow(insertIf(alterRowCondition == 'insert'),
    updateIf(alterRowCondition == 'update'),
    deleteIf(alterRowCondition == 'delete')) ~> AlterRow
```

## <a name="next-steps"></a>Дальнейшие действия

После преобразования Alter Row может потребоваться [погрузить данные в хранилище данных назначения.](data-flow-sink.md)
