---
title: Подготовка Integration Runtime Azure–SSIS | Документация Майкрософт
description: Узнайте, как подготовить среду выполнения интеграции Azure–SSIS в Фабрике данных Azure, чтобы запускать и развертывать пакеты SSIS в Azure.
services: data-factory
documentationcenter: ''
ms.service: data-factory
ms.workload: data-services
ms.tgt_pltfrm: ''
ms.devlang: ''
ms.topic: tutorial
ms.date: 06/26/2019
author: swinarko
ms.author: sawinark
ms.reviewer: douglasl
manager: craigg
ms.openlocfilehash: bd2c055d2f7f1e90918cb160cfdebfe88f7f8ea4
ms.sourcegitcommit: 9b80d1e560b02f74d2237489fa1c6eb7eca5ee10
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/01/2019
ms.locfileid: "67484793"
---
# <a name="provision-the-azure-ssis-integration-runtime-in-azure-data-factory"></a>Подготовка Integration Runtime Azure–SSIS в Фабрике данных Azure

В этом учебнике представлены шаги по подготовке с помощью портала Azure среды выполнения интеграции Azure SQL Server Integration Services (SSIS) в Фабрике данных Azure (ADF). Azure-SSIS IR поддерживает запуск пакетов, развернутых в каталоге SSIS (SSISDB), который размещен на сервере Базы данных SQL Azure или Управляемом экземпляре (модель развертывания проекта), а также развернутых в файловых системах, общих папках или Файлах Azure (модель развертывания пакетов). После подготовки Azure-SSIS IR вы можете использовать привычные средства, такие как SQL Server Data Tools (SSDT) или SQL Server Management Studio (SSMS), и программы командной строки, такие как `dtinstall`/`dtutil`/`dtexec`, для развертывания и запуска пакетов в Azure. См. дополнительные сведения о [среде выполнения интеграции Azure SSIS](concepts-integration-runtime.md#azure-ssis-integration-runtime).

В этом руководстве выполняются следующие шаги:

> [!div class="checklist"]
> * Создали фабрику данных.
> * Подготовка среды выполнения интеграции Azure SSIS.

## <a name="prerequisites"></a>Предварительные требования

[!INCLUDE [updated-for-az](../../includes/updated-for-az.md)]

- **Подписка Azure**. Если у вас еще нет подписки Azure, [создайте бесплатную учетную запись Azure](https://azure.microsoft.com/free/), прежде чем начинать работу.
- **Сервер Базы данных SQL Azure (необязательно)** . Если у вас еще нет сервера базы данных, создайте его на портале Azure перед началом работы. ADF, в свою очередь, создаст SSISDB на этом сервере базы данных. Мы рекомендуем создать сервер базы данных в одном регионе Azure со средой интеграции. Эта конфигурация позволяет среде выполнения интеграции записывать журналы выполнения в SSISDB, не пересекая регионы Azure. 
    - В зависимости от выбранного сервера базы данных SSISDB может быть создана от вашего имени как отдельная база данных, а также как часть эластичного пула или Управляемого экземпляра. Доступ к ней можно получить через общедоступную сеть или после присоединения к виртуальной сети. Инструкции по выбору типа сервера базы данных для размещения SSISDB см. в разделе [Сравнение отдельной базы данных, эластичного пула и Управляемого экземпляра Базы данных SQL Azure](../data-factory/create-azure-ssis-integration-runtime.md#compare-sql-database-single-databaseelastic-pool-and-sql-database-managed-instance). Если сервер Базы данных SQL Azure используется с конечными точками служб для виртуальной сети или Управляемым экземпляром в виртуальной сети с целью размещения SSISDB или требования доступа к локальным данным, необходимо присоединить к виртуальной сети вашу среду выполнения интеграции Azure SSIS. Сведения об этом см. в статье [Create Azure-SSIS Integration Runtime in Azure Data Factory](https://docs.microsoft.com/azure/data-factory/create-azure-ssis-integration-runtime) (Создание среды выполнения интеграции Azure SSIS в службе "Фабрика данных Azure").
    - Убедитесь, что для сервера базы данных включен параметр **Разрешить доступ к службам Azure**. Он не применяется, когда сервер Базы данных SQL Azure используется с конечными точками служб для виртуальной сети или Управляемым экземпляром в виртуальной сети с целью размещения базы данных SSISDB. Дополнительные сведения см. в разделе [Создание правила брандмауэра на уровне сервера с помощью портала Azure](../sql-database/sql-database-security-tutorial.md#create-firewall-rules). Сведения о включении этого параметра с помощью PowerShell см. в статье [New-AzSqlServerFirewallRule](/powershell/module/az.sql/new-azsqlserverfirewallrule).
    - Добавьте IP-адрес клиентского компьютера или диапазон IP-адресов, который включает IP-адрес клиентского компьютера, в список IP-адресов клиента в параметрах брандмауэра для сервера базы данных. Дополнительные сведения см. в разделе [Правила брандмауэра уровня сервера Базы данных SQL Azure и уровня базы данных SQL Azure](../sql-database/sql-database-firewall-configure.md).
    - К серверу базы данных можно подключиться с использованием аутентификации SQL и учетных данных администратора сервера или аутентификации Azure Active Directory (AAD) и управляемого удостоверения ADF. Для последнего варианта управляемое удостоверение ADF нужно добавить в группу AAD, которая обладает разрешениями на доступ к серверу базы данных. См.статью [Создание среды выполнения интеграции Azure SSIS в службе "Фабрика данных Azure"](https://docs.microsoft.com/azure/data-factory/create-azure-ssis-integration-runtime).
    - Убедитесь, что на сервере базы данных уже нет SSISDB. При подготовке Azure-SSIS IR не поддерживается использование имеющейся SSISDB.

> [!NOTE]
> - Список регионов Azure, в которых сейчас доступны ADF и среда Azure-SSIS IR, см. на странице [Доступность продуктов по регионам](https://azure.microsoft.com/global-infrastructure/services/?products=data-factory&regions=all). 

## <a name="create-a-data-factory"></a>Создание фабрики данных

1. Запустите веб-браузер **Microsoft Edge** или **Google Chrome**. Сейчас только эти браузеры поддерживают пользовательский интерфейс фабрики данных. 
1. Войдите на [портале Azure](https://portal.azure.com/). 
1. В меню слева выберите **Создать**, **Данные+аналитика**, **Фабрика данных**. 

   ![Выбор фабрики данных в области "Создать"](./media/tutorial-create-azure-ssis-runtime-portal/new-data-factory-menu.png)

1. На странице **Новая фабрика данных** введите **MyAzureSsisDataFactory** в поле **Имя**. 

   ![Страница "Новая фабрика данных"](./media/tutorial-create-azure-ssis-runtime-portal/new-azure-data-factory.png)

   Имя фабрики данных Azure должно быть *глобально уникальным*. Если вы получите указанную ниже ошибку, введите другое имя фабрики данных (например, **&lt;ваше_имя&gt;MyAzureSsisDataFactory**) и попробуйте создать фабрику данных снова. Правила именования для артефактов службы "Фабрика данных" см. в [этой](naming-rules.md) статье. 

   `Data factory name “MyAzureSsisDataFactory” is not available`

1. В поле **Подписка** выберите подписку Azure, в рамках которой вы хотите создать фабрику данных. 
1. Для **группы ресурсов** выполните одно из следующих действий: 

   - Выберите **Use existing** (Использовать имеющуюся) и выберите имеющуюся группу ресурсов в списке. 
   - Выберите **Создать новую**и укажите имя группы ресурсов. 

   Сведения о группах ресурсов см. в статье, где описывается [использование групп ресурсов для управления ресурсами Azure](../azure-resource-manager/resource-group-overview.md). 
1. Для **версии** выберите **V2 (предварительная версия)** . 
1. В поле **Расположение** выберите расположение фабрики данных. В списке отображаются только те расположения, в которых можно создать фабрики данных. 
1. Кроме того, установите флажок **Закрепить на панели мониторинга**. 
1. Нажмите кнопку **Создать**. 
1. На панели мониторинга вы увидите приведенный ниже элемент с состоянием **Deploying data factory** (Развертывание фабрики данных): 

   ![Элемент Deploying data factory (Развертывание фабрики данных)](media/tutorial-create-azure-ssis-runtime-portal/deploying-data-factory.png)

1. Когда создание завершится, откроется страница **Фабрика данных**. 

   ![Домашняя страница фабрики данных](./media/tutorial-create-azure-ssis-runtime-portal/data-factory-home-page.png)

1. Выберите **Мониторинг и управление**, чтобы открыть на отдельной вкладке пользовательский интерфейс фабрики данных. 

## <a name="create-an-azure-ssis-integration-runtime"></a>Создание среды выполнения интеграции Azure SSIS.

### <a name="from-the-data-factory-overview"></a>В Фабрике данных Azure

1. На странице **начала работы** щелкните плитку **Configure SSIS Integration Runtime** (Настройка среды выполнения интеграции SSIS). 

   ![Плитка настройки среды выполнения интеграции SSIS](./media/tutorial-create-azure-ssis-runtime-portal/configure-ssis-integration-runtime-tile.png)

1. Остальные шаги описаны в разделе [Подготовка среды выполнения интеграции Azure SSIS](#provision-an-azure-ssis-integration-runtime). 

### <a name="from-the-authoring-ui"></a>В пользовательском интерфейсе разработки

1. В пользовательском интерфейсе фабрики данных Azure перейдите на вкладку **Изменить**, выберите **Подключения**, а затем откройте вкладку **Integration Runtimes** (Среды выполнения интеграции), чтобы просмотреть все имеющиеся в фабрике данных среды выполнения интеграции. 

   ![Выбранные элементы для просмотра существующих сред выполнения интеграции](./media/tutorial-create-azure-ssis-runtime-portal/view-azure-ssis-integration-runtimes.png)

1. Выберите **Создать**, чтобы создать среду выполнения интеграции Azure SSIS. 

   ![Доступ к среде выполнения интеграции через меню](./media/tutorial-create-azure-ssis-runtime-portal/edit-connections-new-integration-runtime-button.png)

1. В окне **Integration Runtime Setup** (Настройка среды выполнения интеграции) выберите **Lift-and-shift existing SSIS packages to execute in Azure** (Перенос имеющихся пакетов служб SSIS по методике lift-and-shift для выполнения в Azure), а затем щелкните **Далее**. 

   ![Указание типа среды выполнения интеграции](./media/tutorial-create-azure-ssis-runtime-portal/integration-runtime-setup-options.png)

1. Остальные шаги описаны в разделе [Подготовка среды выполнения интеграции Azure SSIS](#provision-an-azure-ssis-integration-runtime). 

## <a name="provision-an-azure-ssis-integration-runtime"></a>Подготовка среды выполнения интеграции Azure SSIS

1. На странице **General Settings** (Общие параметры) для **настройки среды выполнения интеграции** выполните следующие действия: 

   ![Общие параметры](./media/tutorial-create-azure-ssis-runtime-portal/general-settings.png)

   a. В поле **Имя** введите имя среды выполнения интеграции. 

   b. В поле **Описание** введите описание среды выполнения интеграции. 

   c. В поле **Расположение** введите расположение среды выполнения интеграции. Здесь отображаются только поддерживаемые расположения. Для узла SSISDB сервера базы данных рекомендуется выбирать одинаковые расположения. 

   d. В раскрывающемся списке **Размер узла** выберите размер узла кластера среды выполнения интеграции. Отображаются только поддерживаемые размеры узла. Если планируется использовать большое количество компьютеров или памяти ресурсоемких пакетов, необходимо выбрать большой размер узла (увеличение масштаба). 

   д. В поле **Номер узла** введите количество узлов в кластере среды выполнения интеграции. Отображается только поддерживаемое число узлов. Если в параллельном режиме требуется запустить несколько пакетов, необходимо выбрать больной кластер с большим числом узлов (с поддержкой горизонтального масштабирования). 

   Е. В раскрывающемся списке **Edition/License** (Выпуск/лицензия) выберите выпуск SQL Server или лицензию SQL Server для среды выполнения интеграции: Standard или Enterprise. Если в среде выполнения интеграции необходимо использовать дополнительные функции или функции, которые доступны в версии "Премиум", выберите SQL Server Enterprise. 

   ж. В поле **Экономия** для параметра "Преимущество гибридного использования Azure" выберите один из вариантов: "Да" или "Нет". Если для получения преимуществ и экономии затрат необходимо использовать собственную лицензию SQL Server вместе с программой Software Assurance, выберите "Да". 

   h. Щелкните **Далее**. 

1. На странице **SQL Settings** (Параметры SQL) сделайте следующее: 

   ![Раздел "SQL Settings" (Параметры SQL)](./media/tutorial-create-azure-ssis-runtime-portal/sql-settings.png)

   a. С помощью флажка в поле **Create SSIS catalog...** (Создать каталог SSIS...) выберите модель развертывания для запуска пакетов в Azure-SSIS IR: модель развертывания проекта, где пакеты развернуты в SSISDB, размещенной на сервере базы данных, или модель развертывания пакетов, где пакеты развернуты в файловых системах, общих файлах или в службе "Файлы Azure". Если флажок установлен, вам нужно будет предоставить собственный сервер базы данных для размещения SSISDB, которую мы создадим и будем управлять ею от вашего имени.
   
   b. В раскрывающемся списке **Подписка** выберите подписку Azure, которая соответствует серверу базы данных узла SSISDB. 

   c. В раскрывающемся списке **Расположение** выберите расположение сервера базы данных узла SSISDB. Для среды выполнения интеграции рекомендуется выбирать одинаковые расположения. 

   d. В раскрывающемся списке **Catalog Database Server Endpoint** (Конечная точка сервера базы данных каталога) выберите конечную точку сервера базы данных узла SSISDB. В зависимости от выбранного сервера базы данных SSISDB может быть создана от вашего имени как отдельная база данных, а также как часть эластичного пула или Управляемого экземпляра. Доступ к ней можно получить через общедоступную сеть или после присоединения к виртуальной сети. Инструкции по выбору типа сервера базы данных для размещения SSISDB см. в разделе [Сравнение отдельной базы данных, эластичного пула и Управляемого экземпляра Базы данных SQL Azure](../data-factory/create-azure-ssis-integration-runtime.md#compare-sql-database-single-databaseelastic-pool-and-sql-database-managed-instance). Если сервер Базы данных SQL Azure был выбран вместе с конечными точками служб для виртуальной сети или Управляемым экземпляром в виртуальной сети с целью размещения SSISDB или требования доступа к локальным данным, необходимо присоединить к виртуальной сети вашу Azure-SSIS IR. Сведения об этом см. в статье [Create Azure-SSIS Integration Runtime in Azure Data Factory](https://docs.microsoft.com/azure/data-factory/create-azure-ssis-integration-runtime) (Создание среды выполнения интеграции Azure SSIS в службе "Фабрика данных Azure"). 

   д. С помощью флажка в поле **Use AAD authentication...** (Использовать проверку подлинности AAD...) выберите метод проверки подлинности для сервера базы данных, на котором будет размещаться SSISDB: аутентификация SQL или аутентификация AAD с управляемым удостоверением для ADF. Если флажок установлен, управляемое удостоверение ADF нужно добавить в группу AAD, которая обладает разрешениями на доступ к серверу базы данных. Ознакомьтесь со статьей [Create Azure-SSIS Integration Runtime in Azure Data Factory](https://docs.microsoft.com/azure/data-factory/create-azure-ssis-integration-runtime) (Создание среды выполнения интеграции Azure SSIS в службе "Фабрика данных Azure"). 

   Е. В поле **Имя администратора** введите имя входа SQL для проверки подлинности базы данных сервера узла SSISDB. 

   ж. В поле **Пароль администратора** введите пароль входа SQL для проверки подлинности базы данных сервера узла SSISDB. 

   h. В поле **Catalog Database Service Tier** (Каталог уровней служб базы данных) выберите уровень служб для сервера базы данных, на котором будет размещаться SSISDB: Basic (Базовый), Standard (Стандартный), Premium (Премиум) или укажите имя эластичного пула. 

   i. Нажмите копку **Проверить подключение**, и если проверка прошла успешно, щелкните **Далее**. 

1. На странице **Дополнительные параметры** сделайте следующее: 

   ![Дополнительные параметры](./media/tutorial-create-azure-ssis-runtime-portal/advanced-settings.png)

   a. В раскрывающемся списке **Maximum Parallel Executions Per Node** (Максимальное количество параллельных выполнений на каждом узле) выберите максимальное количество пакетов, которые будут выполняться одновременно на один узел кластера интегрированной среды выполнения. Отображается только поддерживаемое число пакетов. Если возникла необходимость использовать больше чем одно ядро для запуска одного большого пакета или пакета, обработка которого отнимает много вычислительных ресурсов или памяти, выберите меньшее число. Если возникла необходимость запуска одного или нескольких небольших пакетов, которые не потребляют много ресурсов при запуске одним ядром, выберите число побольше. 

   b. Дополнительные сведения о необязательном для заполнения поле **Custom Setup Container SAS URI** (Пользовательская настройка контейнера URI SAS), в которое можно ввести подписанный URL-адрес универсального кода ресурса (URI) контейнера Azure Storage Blob, в котором хранятся связанные с ним файлы, можно узнать из статьи [Пользовательская установка для среды выполнения интеграции Azure MSSQL Integration Services](https://docs.microsoft.com/azure/data-factory/how-to-configure-azure-ssis-ir-custom-setup). 

   c. После установки флажка в поле **Select a VNet...** (Выбрать виртуальную сеть) необходимо определиться, будет ли среда выполнения интеграции присоединена к виртуальной сети. Кроме того, чтобы убедиться, что для размещения SSISDB или требований доступа к локальным данным используется сервер Базы данных SQL Azure с конечными точками служб для виртуальной сети или Управляемым экземпляром в виртуальной сети, см. статью [Create Azure-SSIS Integration Runtime in Azure Data Factory](https://docs.microsoft.com/azure/data-factory/create-azure-ssis-integration-runtime) (Создание среды выполнения интеграции Azure SSIS в службе "Фабрика данных Azure"). 

1. Чтобы начать создание среды выполнения интеграции, нажмите кнопку **Готово**. 

   > [!NOTE]
   > За исключением времени для выполнения пользовательской настройки, этот процесс должен завершиться в течение пяти минут.
   >
   > Если вы используете SSISDB, служба ADF подключится к серверу базы данных для подготовки SSISDB. 
   > 
   > При подготовке Azure-SSIS IR также устанавливается распространяемый компонент Access и пакет функций Azure для служб SSIS. Эти компоненты обеспечивают подключение к файлам Excel и Access и другим источникам данных Azure в дополнение к тем, которые уже поддерживаются встроенными компонентами. Вы также можете установить дополнительные компоненты (см. статью [Customize setup for the Azure-SSIS integration runtime](how-to-configure-azure-ssis-ir-custom-setup.md) (Пользовательская установка для среды выполнения интеграции Azure-SSIS)).

1. На вкладке **Подключения** перейдите к **среде выполнения интеграции**. Щелкните **Обновить**, чтобы обновить состояние. 

   ![Состояние создания с кнопкой "Обновить"](./media/tutorial-create-azure-ssis-runtime-portal/azure-ssis-ir-creation-status.png)

1. С помощью ссылок в столбце **Действия** вы можете остановить, запустить, изменить или удалить среду выполнения интеграции. Последняя из этих ссылок позволяет просмотреть код JSON для среды выполнения интеграции. Кнопки изменения и удаления действуют только в том случае, если среда выполнения интеграции остановлена. 

   ![Связи в столбце "Действия"](./media/tutorial-create-azure-ssis-runtime-portal/azure-ssis-ir-actions.png) 

## <a name="deploy-ssis-packages"></a>Развертывание пакетов служб SSIS.

Если вы используете SSISDB, то можете развернуть в ней пакеты и запустить их в Azure-SSIS IR с помощью инструментов SSDT или SSMS, которые подключаются к серверу базы данных через его конечную точку сервера. Для сервера Базы данных SQL Azure или Управляемого экземпляра с общедоступной конечной точкой формат конечной точки сервера будет `<server name>.database.windows.net`/`<server name>.public.<dns prefix>.database.windows.net,3342` соответственно. Если вы не используете SSISDB, то можете развернуть пакеты в файловых системах, общих папках или в службе "Файлы Azure" и запустить их в Azure-SSIS IR с помощью программ командной строки `dtinstall`/`dtutil`/`dtexec`. Дополнительные сведения см. в разделе [Развертывание пакетов на сервере служб Integration Services](/sql/integration-services/packages/deploy-integration-services-ssis-projects-and-packages#deploy-packages-to-integration-services-server). В обоих случаях вы также можете запустить развернутые пакеты в Azure-SSIS IR, используя действие "Выполнение пакетов служб SSIS" в конвейерах ADF (см. статью [Run an SSIS package with the Execute SSIS Package activity in Azure Data Factory](https://docs.microsoft.com/azure/data-factory/how-to-invoke-ssis-package-ssis-activity) (Запуск пакета Integration Services с помощью действия выполнения пакета SSIS в Фабрике данных Azure)). 

Кроме того, ознакомьтесь со следующими статьями из документации по SSIS: 

- [Руководство. Развертывание и выполнение пакета служб SQL Server Integration Services (SSI) в Azure](/sql/integration-services/lift-shift/ssis-azure-deploy-run-monitor-tutorial) 
- [Подключение к каталогу SSIS (SSISDB) в Azure](/sql/integration-services/lift-shift/ssis-azure-connect-to-catalog-database) 
- [Планирование выполнения пакетов служб SQL Server Integration Services (SSIS), развернутых в Azure](/sql/integration-services/lift-shift/ssis-azure-schedule-packages) 
- [Connect to on-premises data sources with Windows Authentication](/sql/integration-services/lift-shift/ssis-azure-connect-with-windows-auth) (Подключение к локальным источникам данных с помощью аутентификации Windows) 

## <a name="next-steps"></a>Дополнительная информация

Из этого руководства вы узнали, как выполнить следующие задачи: 

> [!div class="checklist"]
> * Создали фабрику данных.
> * Подготовка среды выполнения интеграции Azure SSIS.
> * Развертывание пакетов служб SSIS.

Дополнительные сведения о настройке Azure-SSIS Integration Runtime см. в следующей статье: 

> [!div class="nextstepaction"]
> [Настройка Azure-SSIS IR](https://docs.microsoft.com/azure/data-factory/how-to-configure-azure-ssis-ir-custom-setup)