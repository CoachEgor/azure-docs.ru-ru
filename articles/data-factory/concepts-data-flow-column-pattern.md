---
title: Шаблоны столбцов в картографии data Flow Azure Data Factory
description: Создание обобщенных шаблонов преобразования данных с помощью шаблонов столбцов в потоках данных Azure Data Factory
author: kromerm
ms.author: makromer
ms.reviewer: daperlov
ms.service: data-factory
ms.topic: conceptual
ms.date: 10/21/2019
ms.openlocfilehash: bfb4eeef482c4944e75b7805642bc93c23195208
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "80065523"
---
# <a name="using-column-patterns-in-mapping-data-flow"></a>Использование шаблонов столбцов при картировании потока данных

Несколько преобразований потока данных для отображения позволяют ссылаться на столбцы шаблонов на основе шаблонов, а не на названия столбцов с жестким кодом. Это соответствие известно как *шаблоны столбцов.* Можно определить шаблоны для сопоставления столбцов на основе имени, типа данных, потока или положения вместо того, чтобы требовать точных названий полей. Есть два сценария, где шаблоны столбцов полезны:

* При частом изменении входящих исходных полей, например в случае изменения столбцов в текстовых файлах или базах данных NoS'L. Этот сценарий известен как [дрейф схемы.](concepts-data-flow-schema-drift.md)
* Если вы хотите сделать общую операцию на большой группе столбцов. Например, желание бросить каждый столбец, который имеет имя столбца "всего" в двойном.

Шаблоны столбцов в настоящее время доступны в производных столбцах, агрегате, выборе и преобразованиях раковины.

## <a name="column-patterns-in-derived-column-and-aggregate"></a>Шаблоны столбцов в производных столбцах и агрегате

Чтобы добавить шаблон столбца в производный столбец или вкладку Агрегаты совокупного преобразования, щелкните значок плюс справа от существующего столбца. Выберите **шаблон столбца Добавить**. 

![шаблоны столбцов](media/data-flow/columnpattern.png "Шаблоны столбцов")

Используйте [конструктор выражения](concepts-data-flow-expression-builder.md) для ввода состояния соответствия. Создайте выражение boolean, которое `name`соответствует `type` `stream`столбикам в зависимости от, и `position` столбец. Шаблон будет влиять на любой столбец, дрейфующих или определенных, где условие возвращается верно.

В двух коробках выражения ниже условия соответствия указаны новые имена и значения затронутых столбцов. Используется `$$` для ссылки на существующее значение совмещенное поле. Левая коробка выражения определяет имя, а правое поле выражения определяет значение.

![шаблоны столбцов](media/data-flow/columnpattern2.png "Шаблоны столбцов")

Шаблон вышевышей колонки совпадает с каждым столбе тома томаком в два раза и создает один агрегированный столбец на матч. Название новой колонки — это название столбца, совпадаемое с _total. Значение нового столбца представляет собой округленную, агрегированную сумму существующего двойного значения.

Чтобы проверить правильное условие соответствия, можно проверить схему вывода определенных столбцов во вкладке **«Проверка»** или получить снимок данных во вкладке **предварительного просмотра данных.** 

![шаблоны столбцов](media/data-flow/columnpattern3.png "Шаблоны столбцов")

## <a name="rule-based-mapping-in-select-and-sink"></a>Отображение на основе правил в выборе и раковине

При отображении столбцов в исходных и выбранных преобразованиях можно добавить либо фиксированные отображения, либо картографические отображения на основе правил. Матч на `name`основе `type` `stream`, `position` и, и столбцов. Вы можете иметь любую комбинацию фиксированных и основанных на правилах карт. По умолчанию все проекции с более чем 50 столбцов будут по умолчанию для картирования на основе правил, которое совпадает с каждым столбецом и выводит вводимое имя. 

Чтобы добавить картографическое отображение на основе правил, щелкните **отображение добавить** и выберите **отображение на основе правил.**

![картирование на основе правил](media/data-flow/rule2.png "Rule-based mapping (Выбор преобразования: сопоставление на основе правил)")

Каждое картографическое на основе правил требует двух входов: условие, на котором можно сопоставить, и как назвать каждый сопоставленный столбец. Оба значения ввелись через [конструктор выражения.](concepts-data-flow-expression-builder.md) В левой поле выражения, введите ваш boolean условия соответствия. В нужном поле выражения укажите, на что будет отображаться соответствующий столбец.

![картирование на основе правил](media/data-flow/rule-based-mapping.png "Rule-based mapping (Выбор преобразования: сопоставление на основе правил)")

Используйте `$$` синтаксис для ссылки на имя ввода совмещенных столбцов. Используя приведенное выше изображение в качестве примера, например, можно сказать, что пользователь хочет сопоставить на всех строках столбцов, имена которых короче шести символов. Если один входящий `test`столбец `$$ + '_short'` был назван, `test_short`выражение переименует столбец. Если это единственное сопоставление, которое существует, все столбцы, которые не соответствуют состоянию, будут удалены из выдвитых данных.

Шаблоны соответствуют как дрейфуным, так и определенным столбикам. Чтобы увидеть, какие определенные столбцы отображаются по правилу, щелкните значок очков рядом с правилом. Проверьте вывод с помощью предварительного просмотра данных.

### <a name="regex-mapping"></a>Регекс отображение

При нажатии на значок chevron вниз, вы можете указать условие отображения regex. Условие отображения regex совпадает со всеми именами столбцов, которые соответствуют указанному состоянию regex. Это может быть использовано в сочетании со стандартными картографами на основе правил.

![картирование на основе правил](media/data-flow/regex-matching.png "Rule-based mapping (Выбор преобразования: сопоставление на основе правил)")

Приведенный выше пример совпадает с шаблоном `(r)` regex или любым названием столбца, содержащим нижний корпус r. Подобно стандартному картографии на основе правил, все соответствующие столбцы `$$` изменяются условием справа с помощью синтаксиса.

### <a name="rule-based-hierarchies"></a>Иерархии, основанные на правилах

Если определенная проекция имеет иерархию, можно использовать картографическое отображение на основе правил для картирования подколов иерархий. Укажите соответствующее состояние и сложную колонку, подколонки которых вы хотите сопоставить. Каждая соответствующая подколонка будет вывезначна с использованием правила "Имя как", указанное справа.

![картирование на основе правил](media/data-flow/rule-based-hierarchy.png "Rule-based mapping (Выбор преобразования: сопоставление на основе правил)")

Приведенный выше пример совпадает со `a`всеми подколонками сложной колонки. `a`содержит два подколонки `b` и `c`. Схема вывода будет включать в `b` себя `c` два столбца и `$$`как условие "Имя как" .

## <a name="pattern-matching-expression-values"></a>Шаблон, соответствующий значениям выражения.

* `$$`переводится с именем или значением каждого матча во время выполнения
* `name`представляет имя каждого входящего столбца
* `type`представляет тип данных каждого входящего столбца
* `stream`представляет имя, связанное с каждым потоком, или преобразование в потоке
* `position`является облава столбцов в потоке данных

## <a name="next-steps"></a>Дальнейшие действия
* Подробнее о [языке выражения](data-flow-expression-functions.md) потоков данных для преобразований данных
* Используйте шаблоны столбцов в [преобразовании раковины](data-flow-sink.md) и [выберите преобразование](data-flow-select.md) с помощью картирования на основе правил
