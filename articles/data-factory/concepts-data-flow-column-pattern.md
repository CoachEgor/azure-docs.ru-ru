---
title: Шаблоны столбцов в потоках данных сопоставления фабрики данных Azure
description: Создание обобщенных шаблонов преобразования данных с помощью шаблонов столбцов фабрики данных Azure в сопоставлении потоков данных
author: kromerm
ms.author: makromer
ms.service: data-factory
ms.topic: conceptual
ms.date: 01/30/2019
ms.openlocfilehash: a95bbb726f8c391270d3f60ed769d9475004b1e4
ms.sourcegitcommit: bb65043d5e49b8af94bba0e96c36796987f5a2be
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/16/2019
ms.locfileid: "72388024"
---
# <a name="mapping-data-flows-column-patterns"></a>Сопоставление шаблонов столбцов для потоков данных



Несколько преобразований Потока данных Фабрики данных Azure поддерживают идею "Шаблоны столбцов", так что вы можете создавать столбцы на основе шаблонов вместо жестко закодированных имен столбцов. Эту функцию можно использовать в построителе выражений для определения шаблонов, соответствующих столбцам для преобразования, а не для указания точных, конкретных имен полей. Шаблоны полезны, если входящие поля источника изменяются часто, особенно в случае изменения столбцов в текстовых файлах или базах данных NoSQL. Это условие иногда называют «смещением схемы».

Эта "гибкая схема" в настоящее время находится в производном столбце и агрегатных преобразованиях, а также преобразование выбора и приемника как "сопоставление на основе правил".

![шаблоны столбцов](media/data-flow/columnpattern2.png "Шаблоны столбцов")

## <a name="column-patterns"></a>Шаблоны столбцов
Шаблоны столбцов можно использовать для обработки как сценариев смещения схемы, так и общих сценариев. Этот вариант подходит для условий, когда вы не можете полностью знать имя каждого столбца. Вы можете сопоставить шаблон по имени столбца и типу данных столбца и выполнить сборку выражения для преобразования, которое будет выполнять эту операцию в любом поле потока данных, которое соответствует вашим шаблонам `name` & `type`.

При добавлении выражения в преобразование, которое принимают шаблоны, выберите "Add Column Pattern" (Добавить шаблон столбца). Шаблоны столбцов позволяют использовать шаблоны сопоставления столбца смещения схемы.

При создании шаблона шаблонов столбцов используйте `$$` в выражении для представления ссылки на каждое сопоставленное поле из потока входных данных.

Если вы решите использовать одну из функций регулярного выражения построителя выражений, вы можете впоследствии использовать $1, $2, $3... для ссылки на подшаблоны, соответствующие вашему выражению регулярного выражения.

Примером сценария шаблона столбца является использование SUM с серией входящих полей. Статистические вычисления SUM находятся в статистическом преобразовании. Затем можно использовать SUM при каждом совпадении типов полей, совпадающих с "integer", а затем использовать $ $ для ссылки на каждое совпадение в выражении.

## <a name="match-columns"></a>Сопоставление столбцов
![типы шаблонов столбцов](media/data-flow/pattern2.png "Типы шаблонов")

Для построения шаблонов, основанных на столбцах, можно сопоставить имя столбца, тип, поток или расположение и использовать любое сочетание функций выражений и регулярных выражений.

![Расположение столбца](media/data-flow/position.png "Расположение столбца")

## <a name="rule-based-mapping"></a>Сопоставление на основе правил
При сопоставлении столбцов в источнике и выборе преобразований можно выбрать вариант "фиксированное сопоставление" или "сопоставление на основе правил". Когда вы узнаете схему данных и предполагаете, что определенные столбцы из исходного набора данных всегда соответствуют определенным статическим именам, можно использовать фиксированное сопоставление. Но при работе с гибкими схемами используйте сопоставление на основе правил. Вы сможете создать сопоставление шаблонов с помощью описанных выше правил.

![сопоставление на основе правил](media/data-flow/rule2.png "Сопоставление на основе правил")

Создайте правила с помощью построителя выражений. Выражения возвращают логическое значение либо для сопоставления столбцов (true), либо для исключения столбцов (false).

## <a name="pattern-matching-special-columns"></a>Специальные столбцы, совпадающие с шаблоном

* `$$` будет преобразовываться в имя каждого совпадения во время разработки в режиме отладки и при выполнении во время выполнения.
* `name` представляет имя каждого входящего столбца.
* `type` представляет тип данных каждого входящего столбца
* `stream` представляет имя, связанное с каждым потоком или преобразованием в потоке
* `position` — порядковый номер столбцов в потоке данных

## <a name="next-steps"></a>Дальнейшие действия
* Дополнительные сведения о [языке выражений](https://aka.ms/dataflowexpressions) потока данных сопоставления ADF для преобразований данных
* Использование шаблонов столбцов в [преобразовании приемника](data-flow-sink.md) и [Выбор преобразования](data-flow-select.md) с сопоставлением на основе правил
