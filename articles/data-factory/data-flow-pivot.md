---
title: Преобразование поворота в картировании потока данных
description: Данные от строк до столбцов с помощью картографического потока данных Azure Data Factory преобразование
author: kromerm
ms.author: makromer
ms.service: data-factory
ms.topic: conceptual
ms.custom: seo-lt-2019
ms.date: 01/30/2019
ms.openlocfilehash: a58444f81f60b48f9c2c76f13257a6a2431158a8
ms.sourcegitcommit: acb82fc770128234f2e9222939826e3ade3a2a28
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/21/2020
ms.locfileid: "81686440"
---
# <a name="pivot-transformation-in-mapping-data-flow"></a>Преобразование поворота в картировании потока данных


[!INCLUDE[appliesto-adf-asa-md](includes/appliesto-adf-asa-md.md)]

Используйте преобразование поворота для создания нескольких столбцов из уникальных значений строки одного столбца. Pivot — это преобразование агрегации, в котором вы выбираете группу по столбику и генерируете поворотные столбцы с использованием [агрегированных функций.](data-flow-expression-functions.md#aggregate-functions)

## <a name="configuration"></a>Конфигурация

Преобразование поворота требует трех различных входов: группы по столбики, ключа поворота и способов создания поворотных столбцов

### <a name="group-by"></a>Group by

![Группировка по параметрам](media/data-flow/pivot2.png "«Группа по опционам")

Выберите, какие столбцы объединяют поворотные столбцы. Данные вывода будут группировать все строки с одной и той же группой по значениям в одну строку. Агрегация, выполненная в поворотных столбцах, будет происходить по каждой группе.

Это необязательный раздел. Если не выбрана группа по столбики, весь поток данных будет агрегирован и будет выводиться только одна строка.

### <a name="pivot-key"></a>Ключ поворота

![Ключ поворота](media/data-flow/pivot3.png "Ключ поворота")

Ключом поворота является столбец, значения строки которой вращаются в новые столбцы. По умолчанию преобразование поворота создаст новую колонку для каждого уникального значения строки.

В разделе с пометкой **Значение**можно ввести определенные значения строки для поворота. Только значения строки, введенные в этом разделе, будут поворачиваться. Включение **значения Null** создаст поворотный столбец для нулевых значений в столбце.

### <a name="pivoted-columns"></a>Pivoted столбцы

![Pivoted столбцы](media/data-flow/pivot4.png "Pivoted столбцы")

Для каждого уникального значения ключа ключа ключа ключа, который становится столбцом, создается агрегированное значение строки для каждой группы. Можно создать несколько столбцов на ключ поворота. Каждая опорная колонка должна содержать по крайней мере одну [агрегированную функцию.](data-flow-expression-functions.md#aggregate-functions)

**Шаблон названия столбца:** Выберите, как отформатировать имя столбца каждого столбца. Выдвешенное имя столбца будет сочетанием значения ключа поворота, префикса столбца и факультативной приставки, достаточного среднего символа. 

**Расположение колонны:** Если вы генерируете несколько поворотных столбцов на ключ поворота, выберите, как вы хотите, чтобы столбцы были заказаны. 

**Префикс столбца:** Если вы генерируете несколько поворотных столбцов на ключ поворота, введите префикс столбца для каждого столбца. Эта настройка не является обязательной, если у вас есть только один поворотный столбец.

## <a name="help-graphic"></a>Справка графический

Ниже справка графический показывает, как различные компоненты поворота взаимодействуют друг с другом

![Pivot помочь графике](media/data-flow/pivot5.png "Pivot помочь графический")

## <a name="pivot-metadata"></a>Метаданные Pivot

Если значения не указаны в конфигурации ключа поворота, поворотные столбцы будут динамически сгенерированы во время выполнения. Количество поворотных столбцов будет равен числу уникальных ключевых значений поворота, умноженных на количество поворотных столбцов. Поскольку это может быть меняющимся числом, UX не будет отображать метаданные столбца во вкладке **Inspect** и не будет распространения столбца. Для преобразования этих столбцов используйте возможности [шаблона столбцов](concepts-data-flow-column-pattern.md) для картирования потока данных. 

При установке определенных ключевых значений поворота поворотные столбцы будут отображаться в metadata.e Названия столбцов будут доступны для вас в отображении Inspect и Sink.

### <a name="generate-metadata-from-drifted-columns"></a>Создание метаданных из дрейфующих столбцов

Pivot генерирует новые названия столбцов, динамически основанные на значениях строки. Эти новые столбцы можно добавить в метаданные, на которые можно ссылаться позже в потоке данных. Для этого воспользуйтесь [картой дрейфовал](concepts-data-flow-schema-drift.md#map-drifted-columns-quick-action) быстрое действие в предварительном просмотре данных. 

![Колонки pivot](media/data-flow/newpivot1.png "Карта дрейфовала pivot колонны")

### <a name="sinking-pivoted-columns"></a>Тонущие поворотные столбцы

Хотя поворотные столбцы являются динамическими, они все еще могут быть записаны в хранилище данных назначения. Включить **Разрешить схему дрейфа** в настройках раковины. Это позволит писать столбцы, которые не включены в метаданные. метаданные столбца, но опция дрейфа схемы позволит вам приземлиться данные.

### <a name="rejoin-original-fields"></a>Воссоединиться с оригинальными полями

Преобразование поворота будет проецировать только группу по и поворотным столбиками. Если вы хотите, чтобы выходные данные включали другие столбцы ввода, используйте шаблон [соединения самостоятельно.](data-flow-join.md#self-join)

## <a name="data-flow-script"></a>Скрипт потока данных

### <a name="syntax"></a>Синтаксис

```
<incomingStreamName>
    pivot(groupBy(Tm),
        pivotBy(<pivotKeyColumn, [<specifiedColumnName1>,...,<specifiedColumnNameN>]),
        <pivotColumnPrefix> = <pivotedColumnValue>,
        columnNaming: '< prefix >< $N | $V ><middle >< $N | $V >< suffix >',
        lateral: { 'true' | 'false'}
    ) ~> <pivotTransformationName
```
### <a name="example"></a>Пример

Экраны, отображаемые в разделе конфигурации, имеют следующий сценарий потока данных:

```
BasketballPlayerStats pivot(groupBy(Tm),
    pivotBy(Pos),
    {} = count(),
    columnNaming: '$V$N count',
    lateral: true) ~> PivotExample

```

## <a name="next-steps"></a>Следующие шаги

Попробуйте [преобразование unpivot](data-flow-unpivot.md) превратить значения столбцов в значения строки. 
