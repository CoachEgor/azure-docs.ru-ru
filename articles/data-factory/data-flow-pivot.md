---
title: Преобразование «сведение» в потоке данных сопоставления
description: Сведение данных из строк в столбцы с помощью преобразования «сводка потока данных сопоставления фабрики данных Azure»
author: kromerm
ms.author: makromer
ms.service: data-factory
ms.topic: conceptual
ms.custom: seo-lt-2019
ms.date: 01/30/2019
ms.openlocfilehash: a58444f81f60b48f9c2c76f13257a6a2431158a8
ms.sourcegitcommit: 849bb1729b89d075eed579aa36395bf4d29f3bd9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2020
ms.locfileid: "81686440"
---
# <a name="pivot-transformation-in-mapping-data-flow"></a>Преобразование «сведение» в потоке данных сопоставления


[!INCLUDE[appliesto-adf-asa-md](includes/appliesto-adf-asa-md.md)]

Используйте преобразование «сведение», чтобы создать несколько столбцов из уникальных значений строк одного столбца. Pivot — это преобразование «Статистическая обработка», в котором выбираются столбцы группировки и создаются столбцы сведения с помощью [агрегатных функций](data-flow-expression-functions.md#aggregate-functions).

## <a name="configuration"></a>Конфигурация

Преобразование «Сведение» требует трех различных входных данных: Группировка по столбцам, ключ сведения и создание сведенных столбцов.

### <a name="group-by"></a>Group by

![Группировка по параметрам](media/data-flow/pivot2.png "[Параметры группировки")

Выберите столбцы для статистической обработки сведенных столбцов. Выходные данные будут группировать все строки с одинаковыми значениями Group By в одну строку. Статистическая обработка, выполненная в сведенном столбце, будет выполняться для каждой группы.

Это необязательный раздел. Если столбцы Group By не выбраны, то весь поток данных будет агрегирован и будет выведена только одна строка.

### <a name="pivot-key"></a>Ключ сведения

![Ключ сведения](media/data-flow/pivot3.png "Ключ сведения")

Ключ сведения — это столбец, значения строк которого сведены в новые столбцы. По умолчанию преобразование «Сведение» создаст новый столбец для каждого уникального значения строки.

В разделе **значение**можно ввести конкретные значения строк, которые будут сведены. Будут сведены только значения строк, указанные в этом разделе. Включение **значения NULL** приведет к созданию сведенного столбца для значений NULL в столбце.

### <a name="pivoted-columns"></a>Сведенные столбцы

![Сведенные столбцы](media/data-flow/pivot4.png "Сведенные столбцы")

Для каждого уникального значения ключа сведения, которое преобразуется в столбец, формируется агрегированное значение строки для каждой группы. Можно создать несколько столбцов для каждого ключа сведения. Каждый столбец сведения должен содержать по крайней мере одну [агрегатную функцию](data-flow-expression-functions.md#aggregate-functions).

**Шаблон имени столбца:** Выберите способ форматирования имени столбца для каждого столбца сведения. Имя столбца выводимых данных будет представлять собой комбинацию значения ключа сведения, префикса столбца и необязательного префикса, достаточного среднего числа символов. 

**Упорядочение столбцов:** Если для каждого ключа сведения создается более одного сводного столбца, выберите способ упорядочивания столбцов. 

**Префикс столбца:** Если для каждого ключа сведения создается более одного столбца сведения, введите префикс столбца для каждого столбца. Этот параметр является необязательным, если имеется только один сведенный столбец.

## <a name="help-graphic"></a>Рисунок справки

На приведенном ниже рисунке справки показано, как различные компоненты сводной таблицы взаимодействуют друг с другом.

![Сводные рисунки справки](media/data-flow/pivot5.png "Сводный рисунок справки")

## <a name="pivot-metadata"></a>Сводные метаданные

Если в конфигурации ключа сведения не указаны значения, сводные столбцы будут динамически создаваться во время выполнения. Число сведенных столбцов будет равным числу уникальных значений ключа сведения, умноженному на число столбцов Pivot. Так как это может быть изменяющееся число, UX не будет отображать метаданные столбца на вкладке **Проверка** , и распространение столбцов не будет выполнено. Для преобразования этих столбцов используйте возможности [шаблона столбцов](concepts-data-flow-column-pattern.md) сопоставления потока данных. 

Если заданы конкретные значения ключа сведения, то сведенные столбцы будут отображаться в метаданных. e имена столбцов будут доступны в сопоставлении проверки и приемника.

### <a name="generate-metadata-from-drifted-columns"></a>Создать метаданные из смещенных столбцов

Pivot динамически создает имена новых столбцов на основе значений строк. Эти новые столбцы можно добавить в метаданные, к которым можно будет обращаться позднее в потоке данных. Для этого воспользуйтесь быстрым действием [Map с несмещенным отображением](concepts-data-flow-schema-drift.md#map-drifted-columns-quick-action) в предварительной версии данных. 

![Столбцы сведения](media/data-flow/newpivot1.png "Сопоставлять смещенные столбцы сводной таблицы")

### <a name="sinking-pivoted-columns"></a>Приемник сведенных столбцов

Хотя сведенные столбцы являются динамическими, они по-прежнему могут быть записаны в целевое хранилище данных. Включите параметр **Разрешить смещение схемы** в настройках приемника. Это позволит вам создавать столбцы, не включаемые в метаданные. метаданные столбца, но параметр «смещение схемы» позволит разместить данные.

### <a name="rejoin-original-fields"></a>Повторное присоединение исходных полей

Преобразование «Сведение» будет использоваться только для проектов «группировать по» и «сведенные столбцы». Если вы хотите, чтобы выходные данные включали другие входные столбцы, используйте шаблон [самосоединения](data-flow-join.md#self-join) .

## <a name="data-flow-script"></a>Скрипт потока данных

### <a name="syntax"></a>Синтаксис

```
<incomingStreamName>
    pivot(groupBy(Tm),
        pivotBy(<pivotKeyColumn, [<specifiedColumnName1>,...,<specifiedColumnNameN>]),
        <pivotColumnPrefix> = <pivotedColumnValue>,
        columnNaming: '< prefix >< $N | $V ><middle >< $N | $V >< suffix >',
        lateral: { 'true' | 'false'}
    ) ~> <pivotTransformationName
```
### <a name="example"></a>Пример

Экраны, показанные в разделе конфигурации, имеют следующий сценарий потока данных:

```
BasketballPlayerStats pivot(groupBy(Tm),
    pivotBy(Pos),
    {} = count(),
    columnNaming: '$V$N count',
    lateral: true) ~> PivotExample

```

## <a name="next-steps"></a>Дальнейшие шаги

Выполните [Преобразование отмены свертывания](data-flow-unpivot.md) , чтобы преобразовать значения столбца в значения строк. 
