---
title: Копирование новых и измененных файлов LastModifiedDate
description: Узнайте, как использовать шаблон решения для копирования новых и измененных файлов lastModifiedDate с Azure Data Factory.
services: data-factory
author: dearandyxu
ms.author: yexu
ms.reviewer: ''
manager: shwang
ms.service: data-factory
ms.workload: data-services
ms.topic: conceptual
ms.custom: seo-lt-2019
ms.date: 3/8/2019
ms.openlocfilehash: 971d311dfb54d417a8f66f504d01f08f8bcfc48b
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/27/2020
ms.locfileid: "74942093"
---
# <a name="copy-new-and-changed-files-by-lastmodifieddate-with-azure-data-factory"></a>Копирование новых и измененных файлов lastModifiedDate с помощью фабрики данных Azure

В этой статье описывается шаблон решения, который можно использовать для копирования новых и измененных файлов только с помощью LastModifiedDate из файлохранилища в магазин назначения. 

## <a name="about-this-solution-template"></a>Информация о шаблоне решения

Этот шаблон сначала выбирает новые и измененные файлы только по их атрибутам **LastModifiedDate,** а затем копирует выбранные файлы из хранилища источников данных в хранилище назначения данных.

Шаблон содержит одно действие:
- **Копировать** для копирования новых и измененных файлов только с помощью LastModifiedDate из файлохранилища в магазин назначения.

Шаблон определяет шесть параметров:
-  *FolderPath_Source* — это путь папки, по которому можно прочитать файлы из исходного магазина. Необходимо заменить значение по умолчанию собственным способом папки.
-  *Directory_Source* — это путь субфолдера, по которому можно прочитать файлы из исходного магазина. Необходимо заменить значение по умолчанию собственным способом субфолдера.
-  *FolderPath_Destination* — это путь папки, по которому требуется скопировать файлы в магазин назначения. Необходимо заменить значение по умолчанию собственным способом папки.
-  *Directory_Destination* — это путь субфолдера, по которому требуется копирование файлов в магазин назначения. Необходимо заменить значение по умолчанию собственным способом субфолдера.
-  *LastModified_From* используется для выбора файлов, чей атрибут LastModifiedDate после или равен этому значению времени дат.  Для того, чтобы выбрать только новые файлы, которые не были скопированы в прошлый раз, это значение времени дат может быть время, когда конвейер был запущен в последний раз. Вы можете заменить значение по умолчанию '2019-02-01T00:00:00' на ожидаемое LastModifiedDate в часовом поясе UTC. 
-  *LastModified_To* используется для выбора файлов, атрибут lastModifiedDate находится до этого значения времени даты. Для того, чтобы выбрать только новые файлы, которые не были скопированы в прошлый раз, это значение времени даты может быть настоящим временем.  Вы можете заменить значение по умолчанию '2019-02-01T00:00:00' на ожидаемое LastModifiedDate в часовом поясе UTC. 

## <a name="how-to-use-this-solution-template"></a>Использование шаблона решения

1. Перейти к шаблону **Копировать новые файлы только lastModifiedDate**. Создайте **новое** соединение с хранилищем исходного хранилища. Хранилище исходного хранилища — это место, откуда требуется копировать файлы.

    ![Создание нового подключения к источнику](media/solution-template-copy-new-files-lastmodifieddate/copy-new-files-lastmodifieddate1.png)
    
2. Создайте **новое** соединение с магазином назначения. Магазин назначения — это место, где вы хотите скопировать файлы. 

    ![Создание нового подключения к целевому хранилищу](media/solution-template-copy-new-files-lastmodifieddate/copy-new-files-lastmodifieddate3.png)

3. Выберите **Использовать этот шаблон**.

    ![Использовать этот шаблон](media/solution-template-copy-new-files-lastmodifieddate/copy-new-files-lastmodifieddate4.png)
    
4. На панели откроется доступный конвейер, как показано в следующем примере:

    ![Отображение конвейера](media/solution-template-copy-new-files-lastmodifieddate/copy-new-files-lastmodifieddate5.png)

5. Выберите **Debug,** напишите значение для **параметров** и выберите **Отделку.**  На рисунке ниже мы устанавливаем параметры следующим образом.
   - **FolderPath_Source** источник и источник
   - **Directory_Source** и субфолдер
   - **FolderPath_Destination** - пункт назначения
   - **Directory_Destination** и субфолдер
   - **LastModified_From** No 2019-02-01T00:00:00
   - **LastModified_To** No 2019-03-01T00:00:00
    
    Пример указывает на то, что файлы, которые были в последний раз изменены в течение периода времени **(2019-02-01T00:00",** до **2019-03-01T00:00:00**) будут скопированы с исходного источника/ **субфолдера** к направлению **назначения.**  Вы можете заменить их своими собственными параметрами.

    ![Запуск конвейера](media/solution-template-copy-new-files-lastmodifieddate/copy-new-files-lastmodifieddate6.png)

6. Просмотрите результаты. Вы увидите только файлы, которые были изменены в пределах настроенного периода времени, были скопированы в магазин назначения.

    ![Просмотр результатов](media/solution-template-copy-new-files-lastmodifieddate/copy-new-files-lastmodifieddate7.png)
    
7. Теперь вы можете добавить акробатика окна триггера для автоматизации этого конвейера, так что конвейер всегда может копировать новые и измененные файлы только LastModifiedDate периодически.  Выберите **Добавить триггер,** и выберите **Новый / Отменить**.

    ![Просмотр результатов](media/solution-template-copy-new-files-lastmodifieddate/copy-new-files-lastmodifieddate8.png)
    
8. В окне **Add Triggers** (Добавление триггеров) выберите **+ Создать**.

9. Выберите **Tumbling Window** для типа триггера, установите **каждые 15 минут (ы)** в качестве повторения (вы можете измениться на любое время интервала). Выберите **«Да»** для активированного окна, а затем выберите **OK**.

    ![Создание триггера](media/solution-template-copy-new-files-lastmodifieddate/copy-new-files-lastmodifieddate10.png)    
    
10. Установите значение **параметров триггерного запуска** следующим образом, и выберите **Finish.**
    - **FolderPath_Source** = **источник.**  Можно заменить папку в хранилище исходных данных.
    - **Directory_Source** = **subfolder**.  Вы можете заменить субфолдера в хранилище исходных данных.
    - **FolderPath_Destination** = **пункт назначения.**  Вы можете заменить папку в хранилище данных назначения.
    - **Directory_Destination** = **subfolder**.  Вы можете заменить субфолдера в хранилище данных назначения.
    - **LastModified_From** =  **LastModified_From\@триггера().выходы.windowStartTime**.  Это системная переменная от триггера, определяющая время, когда конвейер был запущен в прошлый раз.
    - **LastModified_To** = **LastModified_To\@триггера().выходы.windowEndTime**.  Это системная переменная от триггера, определяющая время срабатывания конвейера на этот раз.
    
    ![Входные параметры](media/solution-template-copy-new-files-lastmodifieddate/copy-new-files-lastmodifieddate11.png)
    
11. Выберите **Опубликовать все**.
    
    ![Опубликовать все](media/solution-template-copy-new-files-lastmodifieddate/copy-new-files-lastmodifieddate12.png)

12. Создавайте новые файлы в исходной папке хранилища исходных данных.  Теперь вы ждете автоматического срабатывания конвейера, и только новые файлы будут скопированы в магазин назначения.

13. Выберите вкладку **Monitor** в левой панели навигации и подождите около 15 минут, если повторение триггера было установлено каждые 15 минут. 

14. Просмотрите результаты. Вы увидите, что ваш конвейер будет срабатывать автоматически каждые 15 минут, и только новые или измененные файлы из исходного магазина будут скопированы в магазин назначения в каждом запуске конвейера.

    ![Просмотр результатов](media/solution-template-copy-new-files-lastmodifieddate/copy-new-files-lastmodifieddate15.png)
    
## <a name="next-steps"></a>Дальнейшие действия

- [Знакомство с Фабрикой данных Azure](introduction.md)
