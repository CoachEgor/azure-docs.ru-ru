---
title: Преобразование "Производный столбец" в потоке данных для сопоставления
description: Узнайте, как преобразовать данные в большом масштабе в Фабрике данных Azure с помощью преобразования "Производный столбец" в потоке данных для сопоставления.
author: kromerm
ms.author: makromer
ms.service: data-factory
ms.topic: conceptual
ms.custom: seo-lt-2019
ms.date: 10/15/2019
ms.openlocfilehash: 38ec2d4619f47bf9fc4d1815cb6e9990cef72dcf
ms.sourcegitcommit: 849bb1729b89d075eed579aa36395bf4d29f3bd9
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2020
ms.locfileid: "81606508"
---
# <a name="derived-column-transformation-in-mapping-data-flow"></a>Преобразование "Производный столбец" в потоке данных для сопоставления

[!INCLUDE[appliesto-adf-asa-md](includes/appliesto-adf-asa-md.md)]

Для создания новых столбцов в потоке данных или для изменения существующих полей используйте преобразование "Производный столбец".

## <a name="derived-column-settings"></a>Параметры производного столбца

Чтобы переопределить существующий столбец, выберите его с помощью раскрывающегося списка. В противном случае используйте поле выбора столбца в качестве текстового поля и введите имя нового столбца. Чтобы создать выражение производного столбца, щелкните поле "Введите выражение", чтобы открыть [построитель выражений потока данных](concepts-data-flow-expression-builder.md).

![Параметры производного столбца](media/data-flow/dc1.png "Параметры производного столбца")

Чтобы добавить дополнительные производные столбцы, наведите указатель мыши на существующий производный столбец и щелкните значок плюса. Выберите **Добавить столбец** или **Добавить шаблон столбца**. Шаблоны столбцов могут быть полезны, если имена столбцов являются переменными из источников. Дополнительные сведения см. в статье [Шаблоны столбцов](concepts-data-flow-column-pattern.md).

![Выбор нового производного столбца](media/data-flow/columnpattern.png "Выбор нового производного столбца")

## <a name="build-schemas-in-output-schema-pane"></a>Схемы сборки в области "Выходная схема"

Столбцы, которые вы изменяете и добавляете в схему, перечислены в области "Выходная схема". Здесь можно в интерактивном режиме создавать простые и сложные структуры данных. Чтобы добавить дополнительные поля, выберите **Добавить столбец**. Чтобы создать иерархии, выберите **Добавить подчиненный столбец**.

![Добавление подчиненного столбца](media/data-flow/addsubcolumn.png "Добавление подчиненного столбца")

Дополнительные сведения об обработке сложных типов в потоке данных см. в разделе [Обработка JSON в потоке данных для сопоставления](format-json.md#mapping-data-flow-properties).

![Добавление сложного столбца](media/data-flow/complexcolumn.png "Добавление столбцов")

## <a name="data-flow-script"></a>Скрипт потока данных

### <a name="syntax"></a>Синтаксис

```
<incomingStream>
    derive(
           <columnName1> = <expression1>,
           <columnName2> = <expression2>,
           each(
                match(matchExpression),
                <metadataColumn1> = <metadataExpression1>,
                <metadataColumn2> = <metadataExpression2>
               )
          ) ~> <deriveTransformationName>
```

### <a name="example"></a>Пример

Ниже приведен производный столбец с именем `CleanData`, который принимает входящий поток `MoviesYear` и создает два производных столбца. Первый производный столбец заменяет столбец `Rating` значением рейтинга в виде целочисленного типа. Второй производный столбец — это шаблон, который соответствует каждому столбцу, имя которого начинается с "movies". Для каждого сопоставленного столбца создается столбец `movie`, равный значению сопоставленного столбца с префиксом "movie_". 

В интерфейсе Фабрики данных это преобразование выглядит следующим образом:

![Пример производного](media/data-flow/derive-script1.png "Пример производного")

Скрипт потока данных для этого преобразования представлен в следующем фрагменте кода:

```
MoviesYear derive(
                Rating = toInteger(Rating),
                each(
                    match(startsWith(name,'movies')),
                    'movie' = 'movie_' + toString($$)
                )
            ) ~> CleanData
```

## <a name="next-steps"></a>Дальнейшие действия

- Узнайте подробнее о языке [выражений потока данных для сопоставления](data-flow-expression-functions.md).
