---
title: Среда выполнения интеграции в фабрике данных Azure
description: Сведения о среде выполнения интеграции в фабрике данных Azure.
services: data-factory
documentationcenter: ''
author: nabhishek
manager: craigg
ms.reviewer: douglasl
ms.service: data-factory
ms.workload: data-services
ms.tgt_pltfrm: na
ms.topic: conceptual
ms.date: 05/31/2019
ms.author: abnarain
ms.openlocfilehash: 0b137edbfb5ca439d4ba15614225ec0973511763
ms.sourcegitcommit: d6b68b907e5158b451239e4c09bb55eccb5fef89
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/20/2019
ms.locfileid: "74218813"
---
# <a name="integration-runtime-in-azure-data-factory"></a>Среда выполнения интеграции в фабрике данных Azure
Среда выполнения интеграции (IR) — это инфраструктура вычислений, которую фабрика данных Azure использует для обеспечения перечисленных ниже возможностей интеграции данных в разных сетевых средах.

- **Поток данных**. выполняет [поток данных](concepts-data-flow-overview.md) в управляемой среде вычислений Azure.  
- **Перемещение данных**. копирование данных между хранилищами данных в общедоступной сети и хранилищах данных в частной сети (локальной или виртуальной частной сети). Поддерживаются встроенные соединители, преобразование форматов, сопоставление столбцов, высокопроизводительная и масштабируемая передача данных.
- **Отправка**действий. действия по отправке и мониторингу, выполняемые в различных службах вычислений, таких как Azure Databricks, Azure HDInsight, машинное обучение Azure, база данных SQL azure, SQL Server и многое другое.
- **Выполнение пакетов служб SSIS**. Выполнение пакетов служб SQL Server Integration Services (SSIS) в собственном коде в управляемой вычислительной среде Azure.

В фабрике данных действия определяют выполняемые операции. Связанная служба обозначает целевое хранилище данных или службу вычислений. Среда выполнения интеграции соединяет между собой действия и связанные службы.  На него ссылается связанная служба или действие, а также среда вычислений, в которой действие запускается или отправляется из. Такая схема позволяет выполнять действия в регионе, который максимально близко расположен к целевому хранилищу данных или службе вычислений, обеспечивает высокую производительность и соблюдение требований по безопасности и соответствию.

## <a name="integration-runtime-types"></a>Типы сред выполнения интеграции
Фабрика данных предлагает три типа сред выполнения интеграции. Вы можете выбрать тот, который отвечает вашим потребностям в интеграции данных и сетевой среде.  Эти три типа перечислены ниже.

- Таблицы Azure
- Локальное размещение
- Службы SSIS Azure

В следующей таблице описаны возможности и поддержка сетей для каждого типа интеграции среды выполнения.

Тип IR | Общедоступная сеть | Частная сеть
------- | -------------- | ---------------
Таблицы Azure | Поток данных<br/>Перемещение данных<br/>Диспетчеризация действий | &nbsp;
Локальное размещение | Перемещение данных<br/>Диспетчеризация действий | Перемещение данных<br/>Диспетчеризация действий
Службы SSIS Azure | Выполнение пакетов служб SSIS | Выполнение пакетов служб SSIS

На следующей схеме показано, как сочетать разные среды выполнения интеграции, чтобы обеспечить максимальные возможности по интеграции данных и поддержку сетей.

![Разные типы среды выполнения интеграции](media/concepts-integration-runtime/different-integration-runtimes.png)

## <a name="azure-integration-runtime"></a>Среда выполнения интеграции Azure
В среде выполнения интеграции Azure доступны следующие возможности.

- Выполнение потоков данных в Azure 
- Выполнение действия копирования между облачными хранилищами данных
- Отправка следующих действий преобразования в общедоступной сети: действия "Записная книжка/JAR-файл/Python", действие Hive HDInsight, действие Pig HDInsight, действие MapReduce hdinsight, действие HDInsight Spark, действие потоковой передачи HDInsight, компьютер Действие "Обучение выполнению пакета", Машинное обучение обновления действий с ресурсами, действия хранимой процедуры, Data Lake Analytics действия U-SQL, настраиваемого действия .NET, веб-действия, действия поиска и действия "получить метаданные".

### <a name="azure-ir-network-environment"></a>Сетевая среда Azure IR
Azure Integration Runtime поддерживает подключение к хранилищам данных и службам вычислений с общедоступными конечными точками. Для среды виртуальных сетей Azure следует использовать локально размещенную среду выполнения интеграции.

### <a name="azure-ir-compute-resource-and-scaling"></a>Вычислительные ресурсы и масштабирование Azure IR
Среда выполнения интеграции Azure предоставляет полностью управляемые вычисления в Azure без использования серверов.  Вам не нужно подготавливать инфраструктуру, устанавливать программное обеспечение, применять исправления и масштабировать емкость.  Кроме того, вы платите только за фактическое время использования.

Среда выполнения интеграции Azure предоставляет вычисления в собственном коде для безопасного, надежного и высокопроизводительного перемещения данных между облачными хранилищами данных.  Вам достаточно указать, сколько единиц интеграции данных нужно использовать для действия копирования, и среда Azure IR гибко увеличит объем вычислительных ресурсов соответствующим образом. Вам не нужно явно изменять размеры Integration Runtime. 

Диспетчеризация действий не требует больших ресурсов, поскольку лишь перенаправляет действие на целевую службу вычислений. В этом сценарии вам не нужно увеличивать объем вычислительных ресурсов.

Сведения о создании и настройке Azure IR см. в руководстве по созданию и настройке Azure IR. 

> [!NOTE] 
> Среда выполнения интеграции Azure имеет свойства, связанные со средой выполнения потока данных, которая определяет базовую инфраструктуру вычислений, которая будет использоваться для выполнения потоков данных. 

## <a name="self-hosted-integration-runtime"></a>Локальная среда IR
В локальной среде IR доступны следующие возможности.

- Выполнение действия копирования между облачными хранилищами данных и хранилищем данных в частной сети.
- Отправка следующих действий преобразования в ресурсы вычислений в локальной или виртуальной сети Azure: действие Hive в HDInsight (BYOC — создание собственного кластера), действие HDInsight Pig (BYOC), действие MapReduce HDInsight (BYOC), HDInsight Spark действие (BYOC), действие потоковой передачи HDInsight (BYOC), действие выполнения пакета Машинное обучение, Машинное обучение обновление действий с ресурсами, действие хранимой процедуры, Data Lake Analytics действие U-SQL, настраиваемое действие (выполняется в пакетной службе Azure), подстановка действие и получение метаданных.

> [!NOTE] 
> Используйте локальную среду выполнения интеграции для поддержки хранилищ данных, для которых требуется собственный драйвер, например SAP Hana, MySQL и т. д.  Дополнительные сведения см. в разделе [Поддерживаемые хранилища данных](copy-activity-overview.md#supported-data-stores-and-formats).

> [!NOTE] 
> Среда выполнения Java (JRE) — это зависимость саморазмещенного IR. Убедитесь, что на том же узле установлен JRE.

### <a name="self-hosted-ir-network-environment"></a>Локальная сетевая среда IR
Если вы хотите безопасно выполнять интеграцию данных в среде частной сети, которая не связана напрямую с общедоступной облачной средой, вы можете установить локальную IR в локальной среде за корпоративным брандмауэром или внутри виртуальной частной сети.  Локальная среда выполнения интеграции использует только исходящие HTTP-соединения во внешнюю сеть.

### <a name="self-hosted-ir-compute-resource-and-scaling"></a>Вычислительные ресурсы и масштабирование локальной среды IR
Локальная IR устанавливается на локальном компьютере или виртуальной машине в частной сети. В настоящее время локальная IR может выполняться только в операционной системе Windows.  

Чтобы получить высокий уровень доступности и масштабируемости, разверните локальную IR. Для этого следует связать логический экземпляр с несколькими локальными компьютерами в режиме "активный — активный".  Дополнительные сведения см. в статье [Создание и настройка](create-self-hosted-integration-runtime.md) локальной среды IR в разделе руководства для получения дополнительных сведений.

## <a name="azure-ssis-integration-runtime"></a>Среда выполнения интеграции Azure SSIS
Чтобы переместить уже существующую рабочую нагрузку SSIS, создайте Azure SSIS IR для выполнения пакетов служб SSIS в собственной среде.

### <a name="azure-ssis-ir-network-environment"></a>Сетевая среда Azure-SSIS IR
Среда выполнения интеграции Azure SSIS может быть подготовлена в общедоступной сети или частной сети.  Доступ к локальным данным обеспечивается за счет присоединения среды выполнения интеграции Azure SSIS к виртуальной сети, подключенной к локальной сети.  

### <a name="azure-ssis-ir-compute-resource-and-scaling"></a>Вычислительные ресурсы и масштабирование Azure-SSIS IR
Azure SSIS IR — это полностью управляемый кластер виртуальных машин Azure, выделенный для выполнения пакетов служб SSIS. Для размещения подключаемого каталога проектов и (или) пакетов служб SSIS (SSISDB) вы можете использовать собственную базу данных SQL Azure или сервер Управляемого экземпляра. Чтобы увеличить или уменьшить масштаб вычислительных ресурсов, укажите соответствующее количество узлов в кластере. Чтобы снизить расходы на среду выполнения интеграции служб SSIS Azure, вы можете в любой момент останавливать ее и снова запускать.

Дополнительные сведения см. в руководстве по созданию и настройке Azure SSIS IR.  После создания среды вы сможете развернуть существующие пакеты служб SSIS и управлять ими практически так же, как при использовании локальной SSIS, с помощью привычных средств, например SQL Server Data Tools (SSDT) и SQL Server Management Studio (SSMS).

Дополнительные сведения о среде выполнения Azure SSIS см. в следующих статьях: 

- [Развертывание пакетов служб интеграции SQL Server (SSIS) в Azure](tutorial-create-azure-ssis-runtime-portal.md). Эта статья содержит пошаговые инструкции для создания Azure SSIS IR и использует базу данных SQL Azure для размещения каталога SSIS. 
- [Создание среды выполнения интеграции Azure SSIS](create-azure-ssis-integration-runtime.md). Эта статья дополняет соответствующее руководство, а также предоставляет инструкции по использованию Управляемого экземпляра Базы данных SQL Azure и присоединению среды выполнения интеграции к виртуальной сети. 
- [Мониторинг среды выполнения интеграции в фабрике данных Azure](monitor-integration-runtime.md#azure-ssis-integration-runtime). В этом статье показано, как извлечь сведения о среде выполнения интеграции Azure SSIS и описания состояний из возвращаемых данных. 
- [Управление средой выполнения интеграции Azure SSIS](manage-azure-ssis-integration-runtime.md). В этой статье показано, как остановить, запустить или удалить Azure SSIS IR. В ней также показано, как развернуть Azure SSIS IR путем добавления дополнительных узлов в среду выполнения интеграции. 
- [Присоединение среды выполнения интеграции Azure SSIS к виртуальной сети](join-azure-ssis-integration-runtime-virtual-network.md). В этой статье содержатся общие сведения о присоединении среды выполнения интеграции SQL Server Integration Services Azure к виртуальной сети Azure. В ней также показано, как настроить виртуальную сеть, чтобы присоединить среду выполнения интеграции Azure–SSIS к виртуальной сети с помощью портала Azure. 

## <a name="integration-runtime-location"></a>Расположение среды выполнения интеграции
Расположение фабрики данных — это место, в котором хранятся метаданные этой фабрики данных и из которого инициируется конвейер. Сейчас, чтобы переместить данные между хранилищами данных или обработать данные с помощью служб вычислений, фабрика данных может обращаться к хранилищам данных и службам вычислений в других регионах Azure. Это поведение реализуется через [глобально доступную среду IR](https://azure.microsoft.com/global-infrastructure/services/) для обеспечения соответствия данных, эффективности и снижения расходов на исходящий трафик.

Расположение среды IR определяет расположение ее вычислительных ресурсов, то есть, по сути, место выполнения всех операций по перемещению данных, диспетчеризации действий и выполнению пакета SSIS. Расположение IR может отличаться от расположения фабрики данных, которой она принадлежит. 

### <a name="azure-ir-location"></a>Расположение Azure IR
Вы можете задать определенное расположение Azure IR. При этом перемещение данных или диспетчеризация действий будет происходить в этом конкретном регионе. 

Если вы решили использовать **Автоматическое разрешение Azure IR** , которое является значением по умолчанию, 

- Для действия копирования в ADF прилагается максимум усилий, чтобы автоматически определить хранилище данных приемника и источника и выбрать наилучшее расположение — по возможности в том же регионе или ближайшем регионе в той же географической области. Если же не удается обнаружить такое расположение, как альтернатива используется регион фабрики данных.

- Для выполнения операции Lookup/-Metadata/Delete (также называемых действиями конвейера), диспетчеризации действий преобразования (также называемых внешними действиями) и операций создания (проверка соединения, просмотр списка папок и таблицы, предварительная версия данных), ADF будет использовать IR в области фабрики данных.

- Для потока данных ADF будет использовать IR в регионе фабрики данных. 

  > [!TIP] 
  > Рекомендуется убедиться, что поток данных выполняется в том же регионе, что и соответствующие хранилища данных (если это возможно). Это можно сделать, выполнив автоматическую разрешающую Azure IR (если расположение хранилища данных совпадает с расположением фабрики данных) или создав новый экземпляр Azure IR в том же регионе, в котором хранятся данные, а затем выполнить на нем поток данных. 

Вы можете отслеживать, какие расположения IR используются во время выполнения действия, в представлении мониторинга действий конвейера в пользовательском интерфейсе или в полезных данных мониторинга действий.

>[!TIP]
>Если применяются строгие требования к соответствию данных и нужно, чтобы данные не покидали определенную географическую область, вы можете явным образом создать среду Azure IR в конкретном регионе и направить связанную службу в эту среду IR с помощью свойства ConnectVia. Например, если нужно скопировать данные из большого двоичного объекта в южной части Соединенного Королевства в хранилище данных SQL в южной части Соединенного Королевства и чтобы при этом данные не покидали Соединенного Королевства, создайте среду Azure IR в южной части Соединенного Королевства и добавьте ссылку на эту среду IR в обе связанные службы.

### <a name="self-hosted-ir-location"></a>Расположение локальной среды IR
Локальная IR логически регистрируется в фабрике данных, а вычислительные ресурсы для ее работы вы предоставляете самостоятельно. Поэтому для локальных IR нельзя явно задать свойство расположения. 

Если локальная IR используется для перемещения данных, она извлекает данные из источника и записывает их в приемник.

### <a name="azure-ssis-ir-location"></a>Расположение среды Azure-SSIS IR
От выбора расположения для службы Azure SSIS IR зависит производительность рабочих процессов извлечения, преобразования и загрузки.

- Расположение Azure SSIS IR может не совпадать с расположением фабрики данных, но должно совпадать с расположением сервера Базы данных SQL Azure или Управляемого экземпляра, на которых размещается база данных SSIS. Это позволит среде выполнения интеграции Azure SSIS легко обращаться к базе данных SSIS, не генерируя лишний трафик между расположениями.
- Если для размещения базы данных SSIS вы используете источники и назначения данных в локальной сети, а не существующий сервер Базы данных SQL Azure или Управляемого экземпляра, создайте новый сервер Базы данных SQL Azure или Управляемого экземпляра в том же расположении, где находится виртуальная сеть, подключенная к этой локальной сети.  Таким образом вы можете создать среду выполнения интеграции Azure SSIS, использующую новый сервер Базы данных SQL Azure или Управляемого экземпляра, и присоединить ее к виртуальной сети. Так как все эти ресурсы находятся в одном расположении, перемещение данных между разными расположениями будет минимальным.
- Иногда расположение существующего сервера Базы данных SQL Azure или Управляемого экземпляра, на котором размещается база данных SSIS, не совпадает с расположением виртуальной сети, подключенной к локальной сети. В этом случае сначала создайте среду выполнения интеграции Azure SSIS, использующую существующий сервер Базы данных SQL Azure или Управляемого экземпляра, и присоедините ее к другой виртуальной сети в том же расположении, а затем настройте подключение между виртуальными сетями из разных расположений.

На следующей схеме показаны параметры расположения фабрики данных и ее среды выполнения интеграции.

![Расположение среды выполнения интеграции](media/concepts-integration-runtime/integration-runtime-location.png)

## <a name="determining-which-ir-to-use"></a>Выбор IR для использования

### <a name="copy-activity"></a>Действие копирования

Для действия копирования нужны связанные службы источника и приемника данных, которые определяют направление потока данных. Далее описан алгоритм выбора экземпляра среды выполнения интеграции, который будет выполнять копирование. 

- **Копирование между двумя источниками данных в облаке.** Когда службы источника и приемника используют Azure IR, ADF будет использовать региональную среду Azure IR, если она указана. Либо же расположение Azure IR будет определяться автоматически, если вы выберете автоматическое разрешение IR (по умолчанию), как описано в разделе о [расположении среды выполнения интеграции](#integration-runtime-location).
- **Копирование между облачным источником данных и источником данных в частной сети**. Если связанная служба источника или приемника использует локальную IR, действие копирования выполняется в среде в этой локальной среде.
- **Копирование между двумя источниками данных в частной сети.** Обе связанные службы источника и приемника должны указывать на один экземпляр среды выполнения интеграции, и именно эта среда используется для выполнения действия копирования.

### <a name="lookup-and-getmetadata-activity"></a>Действие поиска и получения метаданных

Действие поиска и получения метаданных выполняется в среде выполнения интеграции, ассоциированной со связанной службой хранилища данных.

### <a name="transformation-activity"></a>Действие преобразования

Для каждого действия преобразования задается целевая связанная служба вычислений, которая указывает на определенную среду выполнения интеграции. Этот экземпляр среды выполнения интеграции будет отвечать за диспетчеризацию действия преобразования.

### <a name="data-flow-activity"></a>Действие потока данных

Действие потока данных выполняется в связанной с ним среде выполнения интеграции. 

## <a name="next-steps"></a>Дополнительная информация
Ознакомьтесь со следующими статьями:

- [Создание среды выполнения интеграции Azure](create-azure-integration-runtime.md)
- [Создание и настройка локальной среды выполнения интеграции](create-self-hosted-integration-runtime.md)
- [Создание среды выполнения интеграции Azure SSIS в фабрике данных Azure](create-azure-ssis-integration-runtime.md). Эта статья дополняет соответствующее руководство, а также предоставляет инструкции по использованию Управляемого экземпляра Базы данных SQL Azure и присоединению среды выполнения интеграции к виртуальной сети. 
