---
title: Преобразование приемника в потоке данных сопоставления
description: Узнайте, как настроить преобразование приемника в потоке данных сопоставления.
author: kromerm
ms.author: makromer
ms.reviewer: daperlov
manager: anandsub
ms.service: data-factory
ms.topic: conceptual
ms.custom: seo-lt-2019
ms.date: 06/03/2020
ms.openlocfilehash: 49cfc4899379698cab78a5e22fcffacb60636052
ms.sourcegitcommit: f844603f2f7900a64291c2253f79b6d65fcbbb0c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/10/2020
ms.locfileid: "86223641"
---
# <a name="sink-transformation-in-mapping-data-flow"></a>Преобразование приемника в потоке данных сопоставления

[!INCLUDE[appliesto-adf-asa-md](includes/appliesto-adf-asa-md.md)]

После завершения преобразования данных запишите их в целевое хранилище, используя преобразование приемника. Для каждого потока данных требуется по крайней мере одно преобразование приемника, но при необходимости можно выполнить запись в любое количество приемников для завершения потока преобразования. Для записи в дополнительные приемники создайте новые потоки с помощью новых ветвей и условных разбиений.

Каждое преобразование приемника связано только с одним объектом набора данных фабрики данных Azure или связанной службой. Преобразование «приемник» определяет форму и расположение данных, в которые необходимо выполнить запись.

## <a name="inline-datasets"></a>Встроенные наборы данных

При создании преобразования «приемник» укажите, определяются ли сведения о приемнике внутри объекта DataSet или в преобразовании приемника. Большинство форматов доступны только в одном или другом. Чтобы узнать, как использовать конкретный соединитель, ознакомьтесь с соответствующим документом соединителя.

Если формат поддерживается как для встроенного, так и для объекта DataSet, то оба имеют преимущества. Объекты DataSet — это многократно используемые сущности, которые можно использовать в других потоках данных и действиях, таких как копирование. Они особенно полезны при использовании зафиксированной схемы. Наборы данных не основаны на Spark и иногда может потребоваться переопределить некоторые параметры или проекции схемы в преобразовании приемника.

Встроенные наборы данных рекомендуются при использовании гибких схем, одноразовых экземпляров приемников или параметризованных приемников. Если ваш приемник сильно параметризован, встроенные наборы данных позволяют не создавать фиктивные объекты. Встроенные наборы данных основаны на Spark, а их свойства являются собственными для потока данных.

Чтобы использовать встроенный набор данных, выберите нужный формат в селекторе **типа приемника** . Вместо выбора набора данных приемника выберите связанную службу, к которой нужно подключиться.

![Встроенный набор данных](media/data-flow/inline-selector.png "Встроенный набор данных")

##  <a name="supported-sink-types"></a><a name="supported-sinks"></a>Поддерживаемые типы приемников

Поток данных сопоставления соответствует подходу "извлечь", "Загрузка", "преобразование" (ELT) и работает с *промежуточными* наборами DataSet, которые находятся в Azure. В настоящее время в преобразовании источника можно использовать следующие наборы данных:

| Соединитель | Формат | Набор данных или встраивание |
| --------- | ------ | -------------- |
| [Хранилище BLOB-объектов Azure](connector-azure-blob-storage.md#mapping-data-flow-properties) | [JSON](format-json.md#mapping-data-flow-properties) <br> [Avro](format-avro.md#mapping-data-flow-properties) <br> [Текст с разделителями](format-delimited-text.md#mapping-data-flow-properties) <br> [Дельта (Предварительная версия)](format-delta.md) <br> [Parquet](format-parquet.md#mapping-data-flow-properties) | ✓/- <br> ✓/- <br> ✓/- <br> -/✓ <br> ✓/- |
| [Azure Data Lake Storage 1-го поколения](connector-azure-data-lake-store.md#mapping-data-flow-properties) | [JSON](format-json.md#mapping-data-flow-properties) <br> [Avro](format-avro.md#mapping-data-flow-properties) <br> [Текст с разделителями](format-delimited-text.md#mapping-data-flow-properties) <br> [Parquet](format-parquet.md#mapping-data-flow-properties)  | ✓/- <br> ✓/- <br> ✓/- <br> ✓/- |
| [Azure Data Lake Storage 2-го поколения](connector-azure-data-lake-storage.md#mapping-data-flow-properties) | [JSON](format-json.md#mapping-data-flow-properties) <br> [Avro](format-avro.md#mapping-data-flow-properties) <br> [Текст с разделителями](format-delimited-text.md#mapping-data-flow-properties) <br> [Дельта (Предварительная версия)](format-delta.md) <br> [Parquet](format-parquet.md#mapping-data-flow-properties)  <br> [Общая модель данных (Предварительная версия)](format-common-data-model.md#sink-properties) | ✓/- <br> ✓/- <br> ✓/- <br> -/✓ <br> ✓/- <br> -/✓ |
| [Azure Synapse Analytics](connector-azure-sql-data-warehouse.md#mapping-data-flow-properties) | | ✓/- |
| [База данных SQL Azure](connector-azure-sql-database.md#mapping-data-flow-properties) | | ✓/- |
| [Azure CosmosDB (API SQL)](connector-azure-cosmos-db.md#mapping-data-flow-properties) | | ✓/- |

Параметры, характерные для этих соединителей, находятся на вкладке " **Параметры** ". примеры скриптов для данных и потоковой передачи в этих параметрах находятся в документации по соединителю. 

Фабрике данных Azure доступно более [90 собственных соединителей](connector-overview.md). Чтобы записать данные в другие источники из потока данных, используйте действие копирования для загрузки этих данных из поддерживаемого приемника.

## <a name="sink-settings"></a>Параметры приемника

После добавления приемника настройте его с помощью вкладки **приемник** . Здесь можно выбрать или создать набор данных, в который будет записываться приемник. Ниже приведен видеоролик, объясняющий ряд различных параметров приемника для типов файлов с разделителями текста:

> [!VIDEO https://www.microsoft.com/videoplayer/embed/RE4tf7T]

![Параметры приемника](media/data-flow/sink-settings.png "Параметры приемника")

Отклонение **схемы.** [смещение схемы](concepts-data-flow-schema-drift.md) — это способность фабрики данных в собственном коде управлять гибкими схемами в потоках данных без необходимости явно определять изменения столбцов. Включите параметр **Разрешить смещение схемы** , чтобы записать дополнительные столбцы поверх того, что определено в схеме данных приемника.

**Проверить схему:** Если выбран параметр проверить схему, поток данных завершится ошибкой, если какой-либо столбец входящей исходной схемы не найден в исходной проекции или если типы данных не совпадают. Используйте этот параметр, чтобы обеспечить соответствие исходных данных контракту определенной проекции. В сценариях источника базы данных очень удобно, чтобы сообщить, что имена или типы столбцов изменились.

## <a name="field-mapping"></a>Сопоставление полей

Аналогично преобразованию «выбор» на вкладке « **сопоставление** » приемника можно выбрать, какие входящие столбцы будут записаны. По умолчанию сопоставляются все входные столбцы, включая смещенные столбцы. Это называется **автосопоставлением**.

При отключении автоматического сопоставления можно добавить либо фиксированные сопоставления на основе столбцов, либо сопоставления на основе правил. Сопоставления на основе правил позволяют писать выражения с сопоставлением шаблонов, в то время как фиксированное сопоставление будет сопоставлять логические и физические имена столбцов. Дополнительные сведения о сопоставлении на основе правил см. [в разделе Шаблоны столбцов в потоке данных сопоставления](concepts-data-flow-column-pattern.md#rule-based-mapping-in-select-and-sink).

## <a name="custom-sink-ordering"></a>Заказ настраиваемых приемников

По умолчанию данные записываются в несколько приемников в недетерминированном порядке. Подсистема выполнения будет записывать данные параллельно по мере завершения логики преобразования, и порядок приемников может меняться при каждом запуске. Чтобы задать и точное упорядочение приемников, включите **заказ настраиваемых приемников** на вкладке Общие потока данных. Если этот флажок включен, приемники будут записываться последовательно в порядке возрастания.

![Заказ настраиваемых приемников](media/data-flow/custom-sink-ordering.png "Заказ настраиваемых приемников")

## <a name="data-preview-in-sink"></a>Предварительный просмотр данных в приемнике

При выборке предварительной версии данных в отладочном кластере данные в приемник не записываются. Будет возвращен моментальный снимок данных, которые выглядят, но в назначение ничего не будет записано. Чтобы проверить запись данных в приемник, запустите отладку конвейера из холста конвейера.

## <a name="next-steps"></a>Дальнейшие действия
Теперь, когда вы создали поток данных, добавьте [в конвейер действие потока данных](concepts-data-flow-overview.md).
