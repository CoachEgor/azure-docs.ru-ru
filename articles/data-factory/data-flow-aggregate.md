---
title: Преобразование "Статистическая обработка" в потоке данных сопоставления — фабрика данных Azure | Документация Майкрософт
description: Узнайте, как агрегировать данные в фабрике данных Azure с помощью преобразования «Статистическая обработка потока данных сопоставления».
author: kromerm
ms.author: makromer
ms.service: data-factory
ms.topic: conceptual
ms.date: 02/01/2019
ms.openlocfilehash: 1dcc28313d1d8e59024fbc70738567cb59585d20
ms.sourcegitcommit: 1d0b37e2e32aad35cc012ba36200389e65b75c21
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/15/2019
ms.locfileid: "72326461"
---
# <a name="aggregate-transformation-in-mapping-data-flow"></a>Преобразование "Статистическая обработка" в потоке данных сопоставления 



Статистическое преобразование — это место, где вы будете определять объединения столбцов в ваших потоках данных. С помощью построителя выражений можно определить различные типы агрегатов, такие как SUM, MIN, MAX и COUNT, которые могут быть сгруппированы по существующим или вычисляемым столбцам.

## <a name="group-by"></a>Группировать по
Выберите существующий столбец или создайте новый вычисляемый столбец для использования в качестве предложения GROUP BY для статистической обработки. Чтобы использовать существующий столбец, выберите нужный столбец из раскрывающегося списка. Чтобы создать новый вычисляемый столбец, наведите указатель мыши на предложение и щелкните "вычисляемый столбец". Откроется [Построитель выражений потока данных](concepts-data-flow-expression-builder.md). После создания вычисляемого столбца введите имя выходного столбца в поле "имя как". Если вы хотите добавить дополнительное предложение GROUP BY, наведите указатель мыши на существующее предложение и нажмите кнопку "+".

![Статистическая обработка группы преобразования по параметрам](media/data-flow/agg.png "Статистическая обработка группы преобразования по параметрам")

> [!NOTE]
> Предложение GROUP BY является необязательным в преобразовании «Статистическая обработка».

## <a name="aggregate-column"></a>Статистический столбец 
Выберите вкладку "статистические выражения" для построения статистических выражений. Можно выбрать существующий столбец и перезаписать значение агрегатом или создать новое поле с новым именем. Выражение статистической обработки указывается в правом поле рядом с селектором имени столбца. Чтобы изменить выражение, щелкните текстовое поле, чтобы открыть построитель выражений. Чтобы добавить дополнительный агрегат, наведите указатель мыши на существующее выражение и нажмите кнопку "+", чтобы создать новый столбец статистической обработки или [шаблон столбца](concepts-data-flow-column-pattern.md).

Статистическая обработка агрегатных ![параметров преобразования](media/data-flow/agg2.png "статистические параметры") статистической обработки

> [!NOTE]
> Каждое статистическое выражение должно содержать по крайней мере одну агрегатную функцию.

> [!NOTE]
> В режиме отладки построитель выражений не может создавать предварительные представления данных с агрегатными функциями. Чтобы просмотреть предварительные данные для преобразований «Статистическая обработка», закройте построитель выражений и просмотрите данные на вкладке «Предварительный просмотр данных».

## <a name="reconnect-rows-and-columns"></a>Повторное соединение строк и столбцов
Агрегатные преобразования тесно эквивалентны статистическим запросам SELECT SQL. Столбцы, не входящие в предложение GROUP BY или агрегатные функции, не будут передаваться в выходные данные преобразования «Статистическая обработка». Если имеются другие столбцы, которые необходимо включить с выходными данными агрегированных строк, необходимо выполнить одно из следующих действий.

* Используйте агрегатную функцию для включения дополнительного столбца, например Last () или First ()
* Повторное соединение столбцов перед статистическим выражением с помощью [шаблона самосоединения](https://mssqldude.wordpress.com/2018/12/20/adf-data-flows-self-join/).

## <a name="data-flow-script"></a>Сценарий потока данных

Статистический сценарий статистического(media/data-flow/aggdfs1.png "потока данных") ![скрипта потока данных]

* ```MoviesYear```: производный столбец, определяющий столбцы year и Title
* ```AvgComedyRatingByYear```: преобразование «Статистическая обработка» для средней оценки комедиес, сгруппированных по годам
* ```avgrating```: имя создаваемого столбца для хранения агрегированного значения

```
MoviesYear aggregate(groupBy(year),
    avgrating = avg(toInteger(Rating))) ~> AvgComedyRatingByYear
```
  
## <a name="next-steps"></a>Дальнейшие действия

* Определение агрегирования на основе окон с помощью [преобразования «окно»](data-flow-window.md)
