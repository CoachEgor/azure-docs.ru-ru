---
title: Учебник для настройки времени выполнения интеграции Azure-SSIS для присоединения к виртуальной сети
description: Узнайте, как присоединиться к моменту выполнения интеграции Azure-SSIS в виртуальной сети Azure.
services: data-factory
documentationcenter: ''
author: chugugrace
ms.author: chugu
ms.reviewer: ''
manager: ''
ms.service: data-factory
ms.workload: data-services
ms.topic: conceptual
ms.date: 1/10/2020
ms.openlocfilehash: 7470af23059ccd07e48050e6dc34521e299a986f
ms.sourcegitcommit: b80aafd2c71d7366838811e92bd234ddbab507b6
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/16/2020
ms.locfileid: "81418615"
---
# <a name="configure-an-azure-sql-server-integration-services-ssis-integration-runtime-ir-to-join-a-virtual-network"></a>Нанастройка службы интеграции серверов Azure-S'L (SSIS) для присоединения к виртуальной сети

[!INCLUDE[appliesto-adf-asa-md](includes/appliesto-adf-asa-md.md)]

В этом уроке содержатся основные шаги для использования портала Azure для настройки службы интеграции серверов Azure-S'L Server (SSIS) для присоединения к виртуальной сети.

Для этого нужно выполнить следующие действия:

- Назначь виртуальную сеть.
- Присоединитесь к ИК Azure-SSIS к виртуальной сети с портала Azure Data Factory.

## <a name="prerequisites"></a>Предварительные требования

- **Время выполнения интеграции Azure-SSIS**. Если у вас нет времени выполнения интеграции Azure-SSIS, [увеличение времени выполнения интеграции Azure-SSIS в Фабрике данных Azure](tutorial-deploy-ssis-packages-azure.md) перед началом.

- **Разрешение пользователя**. Пользователь, создающий ИК Azure-SSIS, должен иметь [назначение ролей,](https://docs.microsoft.com/azure/role-based-access-control/role-assignments-list-portal#list-role-assignments-for-a-user-at-a-scope) по крайней мере, на ресурсе Azure Data Factory с одним из вариантов ниже:

    - Использовать встроенную роль Участник сетей. Эта роль предоставляет разрешение _Microsoft.Network/\*_, область применения которого намного шире, чем требуется для этой задачи.
    - Создать настраиваемую роль, которая включает только нужное разрешение _Microsoft.Network/virtualNetworks/\*/join/action_. Если вы также хотите принести свои собственные общедоступные IP-адреса для Azure-SSIS IR, присоединившись к виртуальной сети Azure Resource Manager, пожалуйста, также включите в роль _Microsoft.Network/publicIPAddresses//join/action_ permission.

- **Виртуальная сеть**.

    - Если у вас нет виртуальной сети, [создайте виртуальную сеть с помощью портала Azure.](https://docs.microsoft.com/azure/virtual-network/quick-create-portal)

    - Убедитесь, что группа ресурсов виртуальной сети может создавать и удалять определенные сетевые ресурсы Azure.
    
        Среда выполнения интеграции Azure SSIS должна создать определенные сетевые ресурсы в той же группе ресурсов, в которой находится виртуальная сеть. Эти ресурсы включают в себя:
        - Балансизатор нагрузки Azure с именем * \<Guid>-azurebatch-cloudserviceloadloadr*
        - Группа сетевой безопасности,\<с именем - Guid>-azurebatch-cloudservicenetworksecuritygroupgroupgroup
        - Общедоступный IP-адрес Azure с именем -azurebatch-cloudservicepublicip
    
        Эти ресурсы будут созданы после запуска ИК Azure-SSIS. Они будут удалены, когда ваш ИК Azure-SSIS прекратится. Чтобы не блокировать икобову Azure-SSIS, не используйте эти сетевые ресурсы в других ресурсах.

    - Убедитесь, что у вас нет [блокировки ресурсов](https://docs.microsoft.com/azure/azure-resource-manager/management/lock-resources) на группе ресурсов / подписке, к которой принадлежит виртуальная сеть. Если вы наверснете блокировку только для чтения/удаления, запуск и остановка ИК Azure-SSIS не удастся, или он перестанет отвечать.

    - Убедитесь, что у вас нет политики Azure, которая предотвращает создание следующих ресурсов в группе ресурсов/подписке, к которой принадлежит виртуальная сеть:
        - Microsoft.Network/LoadBalancers
        - Microsoft.Network/NetworkSecurityGroups

- Ниже **сценарии конфигурации сети** не рассматриваются в этом учебнике:
    - Если вы приносите свои собственные общедоступные IP-адреса для ИК Azure-SSIS.
    - Если вы используете свой собственный сервер системы доменных имен (DNS).
    - Если вы используете группу сетевой безопасности (NSG) в подсети.
    - Если вы используете Azure ExpressRoute или маршрут, определяемый пользователем (UDR).
    - Если вы используете настраиваемый ИК Azure-SSIS.
    
    Для получения дополнительной информации проверьте [конфигурацию виртуальной сети.](join-azure-ssis-integration-runtime-virtual-network.md#virtual-network-configuration)

## <a name="configure-a-virtual-network"></a>Настройка виртуальной сети

Используйте портал Azure для настройки виртуальной сети, прежде чем пытаться присоединиться к ИК Azure-SSIS.

1. Запустите Microsoft Edge или Google Chrome. В настоящее время только эти веб-браузеры поддерживают uI Data Factory.

1. Войдите на [портал Azure](https://portal.azure.com).

1. Выберите **дополнительные услуги**. Примените фильтр и выберите **Виртуальные сети**.

1. Примените фильтр и выберите в списке свою виртуальную сеть.

1. На странице **Виртуальная сеть** выберите **Свойства**.

1. Нажмите кнопку копирования напротив поля **Идентификатор ресурса**, чтобы скопировать идентификатор ресурса для виртуальной сети в буфер обмена. Сохраните идентификатор из буфера обмена в OneNote или в файле.

1. В левом меню выберите **подсети.**

    - Убедитесь, что выбранная подсеть имеет достаточно доступное адресное пространство для использования ИК Azure-SSIS. Оставьте доступные IP-адреса по крайней мере в два раза больше номера ИК-узла. Azure резервирует некоторые IP-адреса в каждой подсети. Эти адреса не могут быть использованы. Первый и последний IP-адреса подсетей зарезервированы для соответствия протокола, а еще три адреса используются для служб Azure. Дополнительные сведения см. в разделе [Существуют ли ограничения на использование IP-адресов в пределах этих подсетей?](../virtual-network/virtual-networks-faq.md#are-there-any-restrictions-on-using-ip-addresses-within-these-subnets)
    - Не выбирайте GatewaySubnet для развертывания ИК Azure-SSIS. Он предназначен для виртуальных сетевых шлюзов.
    - Не используйте подсеть, которая исключительно занята другими службами Azure (например, служба управляемых данных базы данных S'L, служба приложений и так далее).

1. Убедитесь, что поставщик пакетной службы Azure зарегистрирован в подписке Azure, которая содержит виртуальную сеть. Или зарегистрируйте поставщика Azure Batch. Если в подписке уже есть учетная запись Azure Batch, ваша подписка зарегистрирована на Azure Batch. (При создании Azure-SSIS IR на портале фабрики данных поставщик пакетной службы Azure регистрируется автоматически.)

   1. На портале Azure, в левом меню, выберите **Подписки**.

   1. Выберите свою подписку.

   1. Слева выберите **поставщиков ресурсов**и подтвердите, что **Microsoft.Batch** является зарегистрированным поставщиком.

   ![Подтверждение состояния "Зарегистрировано"](media/join-azure-ssis-integration-runtime-virtual-network/batch-registered-confirmation.png)

   Если поставщик **Microsoft.Batch** не отображается в списке, то для его регистрации [создайте в своей подписке пустую учетную запись пакетной службы Azure](../batch/batch-account-create-portal.md). Затем ее можно будет удалить.

## <a name="join-the-azure-ssis-ir-to-a-virtual-network"></a>Присоединение среды выполнения интеграции Azure SSIS к виртуальной сети

После настройки виртуальной сети Azure Resource Manager или классической виртуальной сети можно присоединиться к ИК Azure-SSIS в виртуальную сеть:

1. Запустите Microsoft Edge или Google Chrome. В настоящее время только эти веб-браузеры поддерживают uI Data Factory.

1. На [портале Azure](https://portal.azure.com)( в левом меню, выберите **data заводы**. Если вы не видите **фабрики данных** в меню, выберите **дополнительные услуги,** а затем в разделе **INTELLIGENCE и ANALYTICS,** выберите **фабрики данных.**

   ![Список фабрик данных](media/join-azure-ssis-integration-runtime-virtual-network/data-factories-list.png)

1. Выберите фабрику данных с ИК Azure-SSIS в списке. После этого откроется домашняя страница фабрики данных. Выберите плитку **«Автор & монитор».** На отдельной вкладке откроется пользовательский интерфейс фабрики данных.

   ![Домашняя страница фабрики данных](media/join-azure-ssis-integration-runtime-virtual-network/data-factory-home-page.png)

1. В пользовательском интерфейсе фабрики данных перейдите на вкладку **Правка**, щелкните **Подключения**, а затем выберите вкладку **сред выполнения интеграции**.

   ![Вкладка сред выполнения интеграции](media/join-azure-ssis-integration-runtime-virtual-network/integration-runtimes-tab.png)

1. Если ваш ИК Azure-SSIS работает в списке **«Время выполнения интеграции»** в столбце **«Действия»,** выберите кнопку **«Стоп»** для ИК Azure-SSIS. Вы не можете отсечь иСР Azure-SSIS до тех пор, пока не прекратите его.

   ![Остановка среды выполнения интеграции](media/join-azure-ssis-integration-runtime-virtual-network/stop-ir-button.png)

1. В списке **«Интеграция Runtimes»** в столбце **«Действия»** выберите кнопку **«Отображение»** для ИК Azure-SSIS.

   ![Изменение среды выполнения интеграции](media/join-azure-ssis-integration-runtime-virtual-network/integration-runtime-edit.png)

1. На панели настройки времени выполнения интеграции продвигайся по общим параметрам **и** **секциям настроек S'L,** выбрав кнопку **«Следующая».**

1. В разделе **Расширенные настройки:**
   1. Выберите **VNet для вашего Времени интеграции Azure-SSIS, чтобы присоединиться, позвольте ADF создавать определенные сетевые ресурсы и по желанию принести свой собственный статический общедоступный ip-адрес.**

   1. В поле **Подписка** выберите подписку Azure, в которой расположена виртуальная сеть.

   1. В поле **Расположение** введите то же расположение среды выполнения интеграции.

   1. Для **type**выберите тип виртуальной сети: классический или Azure Resource Manager. Мы рекомендуем выбрать виртуальную сеть Azure Resource Manager, поскольку классические виртуальные сети вскоре будут утиханы.

   1. В поле **Имя виртуальной сети** выберите имя вашей виртуальной сети. Это должен быть тот же, который используется для вашего сервера базы данных Azure S'L с виртуальными конечными точками сетевого обслуживания или управляемым экземпляром с частной конечной точкой для размещения SSISDB. Или он должен быть таким же, как и к вашей сети. В противном случае, это может быть любая виртуальная сеть, чтобы принести свои собственные статические общедоступные IP-адреса для Azure-SSIS ИК.

   1. В поле **Имя подсети** выберите имя подсети в виртуальной сети. Это должно быть то же самое, что используется для вашего сервера базы данных Azure S'L с виртуальными конечными точками сетевого обслуживания для размещения SSISDB. Или это должна быть другая подсеть, чем та, которая используется для управляемого экземпляра с частной конечной точкой для размещения SSISDB. В противном случае, это может быть любая подсеть, чтобы принести свои собственные статические общедоступные IP-адреса для Azure-SSIS ИК.

   1. Выберите **валидацию VNet**. Если проверка удалась, выберите **Продолжить**.

   ![Дополнительные параметры с использованием виртуальной сети](./media/tutorial-create-azure-ssis-runtime-portal/advanced-settings-vnet.png)

1. В разделе **Резюме** просмотрите все настройки для ИК Azure-SSIS. Затем выберите **обновление**.

1. Запустите ИК Azure-SSIS, выбрав кнопку **«Пуск»** в столбце **«Действия»** для ИК Azure-SSIS. Запуск ИК Azure-SSIS, который присоединяется к виртуальной сети, занимает от 20 до 30 минут.

## <a name="next-steps"></a>Next Steps

Узнайте больше о [присоединении Azure-SSIS IR к виртуальной сети.](join-azure-ssis-integration-runtime-virtual-network.md)
