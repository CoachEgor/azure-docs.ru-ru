---
title: Выполнение пакетов служб SSIS в фабрике данных Azure из SSDT | Документация Майкрософт
description: Узнайте, как выполнять пакеты служб SSIS в Azure из SSDT.
services: data-factory
documentationcenter: ''
ms.service: data-factory
ms.workload: data-services
ms.tgt_pltfrm: na
ms.topic: conceptual
ms.date: 07/31/2019
author: swinarko
ms.author: sawinark
ms.reviewer: douglasl
manager: craigg
ms.openlocfilehash: 9ddf427d7d749dff1af45b3f6f83d20a89e1aae0
ms.sourcegitcommit: 13d5eb9657adf1c69cc8df12486470e66361224e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/31/2019
ms.locfileid: "68678403"
---
# <a name="execute-ssis-packages-in-azure-from-ssdt"></a>Выполнение пакетов служб SSIS в Azure из SSDT
В этой статье описывается функция проектов SQL Server Integration Services (SSIS) с поддержкой Azure в SQL Server Data Tools (SSDT), которая позволяет выполнять пакеты в Azure-SSIS Integration Runtime (IR) в фабрике данных Azure (ADF).  Эту функцию можно использовать для тестирования существующих пакетов служб SSIS, прежде чем претянуть & Shift/перенести их в Azure или разрабатывать новые пакеты служб SSIS для работы в Azure.

С помощью этой функции можно создать новую среду выполнения интеграции Azure SSIS или присоединить существующую среду к проектам служб SSIS, а затем выполнить на ней пакеты.  Мы поддерживаем запуск пакетов для развертывания в каталоге служб SSIS (SSISDB) в модели развертывания проекта, а также для развертывания в файловых системах, файловых ресурсах или файлах Azure в модели развертывания пакетов. 

## <a name="prerequisites"></a>предварительные требования
Чтобы использовать эту функцию, скачайте и установите последнюю версию SSDT с расширением проектов SSIS для Visual Studio [отсюда или как](https://marketplace.visualstudio.com/items?itemName=SSIS.SqlServerIntegrationServicesProjects) автономный установщик [отсюда.](https://docs.microsoft.com/sql/ssdt/download-sql-server-data-tools-ssdt?view=sql-server-2017#ssdt-for-vs-2017-standalone-installer)

## <a name="azure-enable-ssis-projects"></a>Включение проектов служб SSIS в Azure
В SSDT можно создать новые проекты служб SSIS с поддержкой Azure с помощью шаблона **Integration Services проекта (Azure с возможностью использования)** .

![Новый проект служб SSIS с поддержкой Azure](media/how-to-invoke-ssis-package-ssdt/ssdt-azure-enabled-new-project.png)

Кроме того, можно включить существующие проекты служб SSIS в Azure, щелкнув правой кнопкой мыши узел проекта на панели обозреватель решений SSDT, чтобы открыть меню и выбрать пункт меню **с поддержкой Azure** .

![Azure — Включение существующего проекта служб SSIS](media/how-to-invoke-ssis-package-ssdt/ssdt-azure-enabled-existing-project.png)

Для включения в Azure существующих проектов служб SSIS необходимо задать версию целевого сервера, которая будет последней версией, поддерживаемой Azure SSIS IR, которая в настоящее время **SQL Server 2017**, поэтому, если вы еще не сделали это, откроется диалоговое окно.

## <a name="connect-azure-enabled-projects-to-ssis-in-azure-data-factory"></a>Подключение проектов с поддержкой Azure к службам SSIS в фабрике данных Azure
Подключив проекты с поддержкой Azure к службам SSIS в ADF, вы можете передать пакеты в службу файлов Azure и запустить их в среде IR Azure SSIS.  Для этого выполните следующие действия.

1. Щелкните правой кнопкой мыши проект или **связанный узел ресурсов Azure** на панели Обозреватель решений SSDT, чтобы открыть меню, и выберите пункт меню **Подключение к службам SSIS в фабрике данных Azure** , чтобы запустить **Мастер подключения служб SSIS в ADF**.

   ![Подключение к службам SSIS в ADF](media/how-to-invoke-ssis-package-ssdt/ssdt-azure-enabled-existing-project2.png)

2. На странице **Общие сведения о службах SSIS в ADF** ознакомьтесь с введением и нажмите кнопку **Далее** , чтобы продолжить.

   ![Общие сведения о службах SSIS в ADF](media/how-to-invoke-ssis-package-ssdt/ssis-in-adf-connection-wizard.png)

3. На странице **Выбор среды IR в службе ADF** выберите существующий ADF-файл и среду выполнения интеграции Azure SSIS для запуска пакетов или создайте новые, если их нет.
   - Чтобы выбрать существующую среду выполнения интеграции Azure SSIS, сначала выберите соответствующую подписку Azure и ADF-файл.
   - Если вы выбрали существующий ADF-файл, у которого нет среды выполнения интеграции Azure SSIS, нажмите кнопку **CREATE SSIS IR (создать** ), чтобы создать новую службу на портале или приложении ADF.
   - Если вы выберете существующую подписку Azure, в которой нет ADF, нажмите кнопку **CREATE SSIS IR (создание** среды выполнения интеграции), чтобы запустить **Мастер создания Integration Runtime**, где можно ввести расположение и префикс, чтобы автоматически создать новый Azure. Группа ресурсов, фабрика данных и службы SSIS IR от вашего имени, указанные в следующем шаблоне: **Йоурпрефикс-RG/DF/IR-йоуркреатионтиме**.
   
   ![Выбор служб SSIS IR в ADF](media/how-to-invoke-ssis-package-ssdt/ssis-in-adf-connection-wizard2.png)

4. На странице **Выбор хранилища Azure** выберите существующую учетную запись хранения Azure для отправки пакетов в службу файлов Azure или создайте новую, если у вас нет.
   - Чтобы выбрать существующую учетную запись хранения Azure, сначала выберите соответствующую подписку Azure.
   - Если вы выбрали ту же подписку Azure, что и для среды выполнения интеграции Azure SSIS без учетной записи хранения Azure, нажмите кнопку " **создать хранилище Azure** ", чтобы автоматически создать новое имя от вашего имени в том же расположении, где находится среда Azure SSIS IR, с именем объединение префикса своего имени и даты создания Azure SSIS IR.
   - Если вы выбрали другую подписку Azure без учетной записи хранения Azure, нажмите кнопку " **создать хранилище Azure** ", чтобы создать ее на портал Azure.
   
   ![Выбор службы хранилища Azure](media/how-to-invoke-ssis-package-ssdt/ssis-in-adf-connection-wizard3.png)

5. Нажмите кнопку **подключить** , чтобы завершить подключение.  Выбранная учетная запись хранения Azure SSIS и служба хранилища Azure будут отображены в узле **связанные ресурсы Azure** на панели Обозреватель решений SSDT.  Мы также обновляем состояние среды выполнения интеграции Azure SSIS, и вы можете управлять им, щелкнув его узел правой кнопкой мыши, чтобы открыть меню, а затем выбрав пункт меню **старт\стоп\манаже** , который переводит вас на портал или приложение ADF.

## <a name="execute-ssis-packages-in-azure"></a>Выполнение пакетов служб SSIS в Azure
### <a name="starting-package-executions"></a>Запуск выполнения пакетов
После подключения проектов к службам SSIS в ADF-файле вы можете выполнять пакеты в среде IR Azure SSIS.  Существует два варианта запуска выполнения пакета:
-  Нажмите кнопку **Пуск** на панели инструментов SSDT, чтобы раскрывающийся список и выбрать пункт меню **выполнить в Azure** . 

   ![Выполнение в Azure](media/how-to-invoke-ssis-package-ssdt/ssdt-azure-enabled-execute-package.png)

-  Щелкните правой кнопкой мыши узел пакета на панели обозреватель решений SSDT, чтобы открыть меню и выбрать пункт **выполнить пакет в Azure** .

   ![Выполнение пакета в Azure](media/how-to-invoke-ssis-package-ssdt/ssdt-azure-enabled-execute-package2.png)

> [!NOTE]
> Для выполнения пакетов в Azure требуется работающая среда выполнения интеграции Azure SSIS, поэтому если среда IR Azure SSIS остановлена, откроется диалоговое окно для запуска.  За исключением каких-либо пользовательских настроек, этот процесс должен выполняться в течение 5 минут, но может занять примерно 20-30 минут для подключения к виртуальной сети Azure SSIS IR.  После выполнения пакетов в Azure вы можете отключить среду выполнения интеграции Azure SSIS, чтобы управлять ее выполнением, щелкнув правой кнопкой мыши узел на обозреватель решений панели SSDT, чтобы открыть меню, а затем выбрать пункт меню **старт\стоп\манаже** , чтобы перейти к порталу ADF/ приложение.

### <a name="checking-package-execution-logs"></a>Проверка журналов выполнения пакетов
При запуске пакета выполняется форматирование и отображение журнала в окне хода выполнения SSDT.  Для долго выполняющегося пакета мы периодически будем обновлять свой журнал с учетом минут.  Вы можете остановить выполнение пакета, нажав кнопку **остановить** на панели инструментов SSDT, которая немедленно отменит ее.  Кроме того, можно временно найти необработанные данные журнала в пути UNC: `\\<YourConnectedAzureStorage>.file.core.windows.net\ssdtexecution\<YourProjectName-FirstConnectTime>\<YourPackageName-tmp-ExecutionTime>\logs`, но мы будем очищать его через один день.

### <a name="switching-package-protection-level"></a>Переключение уровня защиты пакета
Исполнение пакетов служб SSIS в Azure не поддерживает уровни защиты **EncryptSensitiveWithUserKey**/**EncryptAllWithUserKey** .  Следовательно, если вы настроили пакеты с их помощью, мы временно переключим их в **EncryptSensitiveWithPassword**/**EncryptAllWithPassword**, используя случайным образом созданные пароли при отправке пакеты в службу файлов Azure для выполнения в среде IR Azure SSIS.

> [!NOTE]
> Если пакеты содержат задачи «Выполнение пакета», которые ссылаются на другие пакеты, настроенные с помощью уровней защиты **EncryptSensitiveWithUserKey**/**EncryptAllWithUserKey** , необходимо вручную перенастроить эти пакеты на перед выполнением пакетов используйте **EncryptSensitiveWithPassword**/**EncryptAllWithPassword**соответственно.

Если в пакетах уже настроены уровни защиты **EncryptSensitiveWithPassword**/**EncryptAllWithPassword** , то они останутся без изменений, но будут по-прежнему использовать созданные случайным образом пароли при передаче пакеты в службу файлов Azure для выполнения в среде IR Azure SSIS.

### <a name="using-package-configuration-file"></a>Использование файла конфигурации пакета
Если вы используете файлы конфигурации пакета в модели развертывания пакетов для изменения значений переменных во время выполнения, мы автоматически отправляем эти файлы пакетами в службу файлов Azure для выполнения в среде IR Azure SSIS.

### <a name="using-execute-package-task"></a>Использование задачи «Выполнение пакета»
Если пакеты содержат задачи «Выполнение пакета», которые ссылаются на другие пакеты, хранящиеся в локальных файловых системах, необходимо выполнить следующие дополнительные настройки.

1. Отправьте другие пакеты в службу файлов Azure в той же учетной записи хранения Azure, которая подключена к проектам, и получите новый UNC-путь, например`\\test.file.core.windows.net\ssdtexecution\Package1.dtsx`

2. Замените пути к файлам этих пакетов в диспетчере подключения файлов для задач «Выполнение пакета» на новый UNC-путь.
   - Если компьютер, на котором работает SSDT, не может получить доступ к новому UNC-пути, можно изменить путь к файлу на панели свойств диспетчера подключения файлов.
   - Кроме того, можно использовать переменную для пути к файлу, чтобы назначить правильное значение во время выполнения.

Если пакеты содержат задачи «Выполнение пакета», которые ссылаются на другие пакеты в том же проекте, дополнительная настройка не требуется.

## <a name="next-steps"></a>Следующие шаги
Когда вы удовлетворены выполнением пакетов в Azure из SSDT, вы можете развернуть и запустить их как выполнение действий пакета служб SSIS в конвейерах ADF. см. раздел [Запуск пакетов служб SSIS как выполнение действий пакета SSIS в конвейерах ADF](https://docs.microsoft.com/azure/data-factory/how-to-invoke-ssis-package-ssis-activity).
