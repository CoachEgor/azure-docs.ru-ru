---
title: Устранение неполадок выполнения пакетов в среде выполнения интеграции SSIS | Документация Майкрософт
description: Эта статья содержит рекомендации по устранению неполадок для выполнения пакета служб SSIS в среде выполнения интеграции SSIS
services: data-factory
documentationcenter: ''
ms.service: data-factory
ms.workload: data-services
ms.tgt_pltfrm: na
ms.topic: conceptual
ms.date: 04/15/2019
author: wenjiefu
ms.author: wenjiefu
ms.reviewer: sawinark
manager: craigg
ms.openlocfilehash: 68a5d5278e1181695695647cff187d4b95624b40
ms.sourcegitcommit: 084630bb22ae4cf037794923a1ef602d84831c57
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/03/2019
ms.locfileid: "67537637"
---
# <a name="troubleshoot-package-execution-in-the-ssis-integration-runtime"></a>Устранение неполадок выполнения пакетов в среде выполнения интеграции SSIS

Эта статья содержит наиболее распространенные ошибки, которые могут возникать при при выполнении пакетов служб SQL Server Integration Services (SSIS) в среде выполнения интеграции SSIS. Он описывает возможные причины и действия для устранения ошибки.

## <a name="where-to-find-logs-for-troubleshooting"></a>Где найти журналы для устранения неполадок

Проверьте выходные данные действия выполнения пакета служб SSIS с помощью портала фабрики данных Azure. Выходные данные содержат результат выполнения, сообщения об ошибках и идентификатор операции. Дополнительные сведения см. в разделе [мониторинг конвейера](how-to-invoke-ssis-package-ssis-activity.md#monitor-the-pipeline).

Использование каталога служб SSIS (SSISDB) для проверки сведений журналов для выполнения. Дополнительные сведения см. в разделе [наблюдение за выполнением пакетов и других операций](https://docs.microsoft.com/sql/integration-services/performance/monitor-running-packages-and-other-operations?view=sql-server-2017).

## <a name="common-errors-causes-and-solutions"></a>Распространенные ошибки, причины и решения

### <a name="error-message-connection-timeout-expired-or-the-service-has-encountered-an-error-processing-your-request-please-try-again"></a>Сообщение об ошибке: «Время ожидания подключения истекло» или «Служба обнаружила ошибку при обработке вашего запроса. Повторите попытку.»

Ниже приведены возможные причины и рекомендуемые действия.
* Повторная загрузка данных-источнике или назначении. Проверьте нагрузку на источник данных или назначения и см. в разделе, имеет ли она Недостаточно емкости. Например если вы использовали базу данных SQL Azure, попробуйте увеличить масштаб, если база данных, скорее всего, время ожидания.
* Сетевое соединение между среды выполнения интеграции SSIS и данных-источнике или назначении нестабильна, особенно в том случае, если подключение установлено между регионами и между локальной сетью и Azure. Примените шаблон повторных попыток в пакете служб SSIS, выполнив следующие действия:
  * Убедитесь, что пакетов служб SSIS можно повторно запустить в случае сбоя без побочных эффектов (например, потери данных или дублирования данных).
  * Настройка **повторите** и **интервал повторных попыток** из **выполнение пакета служб SSIS** действия на **Общие** вкладки. ![Задать свойства на вкладке "Общие"](media/how-to-invoke-ssis-package-ssis-activity/ssis-activity-general.png)
  * ADO.NET и OLE DB компоненте источника или назначения, задайте **ConnectRetryCount** и **ConnectRetryInterval** в диспетчере соединений в пакет служб SSIS или действия SSIS.

### <a name="error-message-ado-net-source-has-failed-to-acquire-the-connection--with-a-network-related-or-instance-specific-error-occurred-while-establishing-a-connection-to-sql-server-the-server-was-not-found-or-was-not-accessible"></a>Сообщение об ошибке: «Источник ADO NET не удалось получить соединение «...»» с помощью «с сетью или с определенным экземпляром ошибка при установлении соединения с SQL Server. Сервер не найден или недоступен.»

Эта проблема обычно означает, что источник данных или назначения является недоступным из среды выполнения интеграции SSIS. Причины могут различаться. Попытайтесь выполните следующие действия:
* Убедитесь, что передается данных-источнике или назначении имя или IP-адрес правильно.
* Убедитесь, что брандмауэр настроен должным образом.
* Убедитесь, что виртуальная сеть настроена правильно, если источник данных или приемник находится в локальной:
  * Чтобы узнать, является ли неполадка из конфигурации виртуальной сети путем подготовки виртуальной Машины Azure в той же виртуальной сети. Затем проверьте ли источник данных или назначение может осуществляться из виртуальной Машины Azure.
  * Дополнительные сведения об использовании среды выполнения интеграции SSIS в виртуальной сети [присоединить среду выполнения интеграции Azure SSIS к виртуальной сети](join-azure-ssis-integration-runtime-virtual-network.md).

### <a name="error-message-ado-net-source-has-failed-to-acquire-the-connection--with-could-not-create-a-managed-connection-manager"></a>Сообщение об ошибке: «Источник ADO NET не удалось получить соединение «...»» с помощью «Не удалось создать управляемое соединение диспетчера.»

Возможной причиной является то, что поставщик ADO.NET, используемые в пакете не установлен в среде выполнения интеграции SSIS. Поставщик можно установить с помощью пользовательской установки. Дополнительные сведения о пользовательской установки в [настроить программу установки для среды выполнения интеграции Azure SSIS](how-to-configure-azure-ssis-ir-custom-setup.md).

### <a name="error-message-the-connection--is-not-found"></a>Сообщение об ошибке: «Подключение «...» не найден»

Эта ошибка может возникать известная проблема в более старых версий из SQL Server Management Studio (SSMS). Если пакет содержит пользовательский компонент (например, компоненты пакета дополнительных компонентов Azure SSIS или партнер), которая не была установлена на компьютере, где используется среда SSMS для развертывания, среда SSMS удаления компонента и вызывает ошибку. Обновление [SSMS](https://docs.microsoft.com/sql/ssms/download-sql-server-management-studio-ssms) до последней версии, проблема устранена.

### <a name="error-message-there-is-not-enough-space-on-the-disk"></a>Сообщение об ошибке: «Не достаточно места на диске»

Эта ошибка означает, что локальный диск используется в узел integration runtime служб SSIS. Проверьте, является ли пакет или пользовательской установки потребляет много места на диске:
* Если диск используется пакет, он будет освободить после завершения выполнения пакета.
* Если диск используется пользовательской установки, вы будете требуется для остановки среды выполнения интеграции SSIS, измените скрипт и снова запустить среду выполнения интеграции. Контейнер BLOB-объектов совершенно Azure, указанной для пользовательской установки будут скопированы в узел integration runtime служб SSIS, поэтому убедитесь в отсутствии все ненужное в этом контейнере.

### <a name="error-message-cannot-open-file-"></a>Сообщение об ошибке: «Не удается открыть файл «...»»

Эта ошибка возникает, когда выполнение пакета не удается найти файл на локальном диске в среде выполнения интеграции SSIS. Попытайтесь выполните следующие действия:
* Не используйте абсолютный путь в пакете, который выполняется в среде выполнения интеграции SSIS. Использовать текущий рабочий каталог выполнения (.) или временной папки (% TEMP %) Вместо этого.
* Если нужно сохранить некоторые файлы на узлы среды выполнения интеграции SSIS, подготовить файлы, как описано в разделе [настроить процесс установки](how-to-configure-azure-ssis-ir-custom-setup.md). После завершения выполнения, будут удалены все файлы в рабочий каталог.
* Используйте службу файлов Azure, вместо сохранения файла в узле среды выполнения интеграции SSIS. Дополнительные сведения см. в разделе [файловых ресурсов Azure используйте](https://docs.microsoft.com/sql/integration-services/lift-shift/ssis-azure-files-file-shares?view=sql-server-2017#use-azure-file-shares).

### <a name="error-message-the-database-ssisdb-has-reached-its-size-quota"></a>Сообщение об ошибке: ««SSISDB» база данных достигла предельного размера»

Возможная причина-, что база данных SSISDB, созданные в базе данных Azure SQL или управляемого экземпляра, при создании среды выполнения интеграции SSIS была достигнута квота. Попытайтесь выполните следующие действия:
* Попробуйте увеличить DTU базы данных. Вы можете найти подробную информацию в [ограничения ресурсов базы данных SQL для сервера базы данных SQL Azure](https://docs.microsoft.com/azure/sql-database/sql-database-resource-limits-logical-server).
* Проверьте, будет ли пакет создавать многие журналы. Если Да, можно настроить задание обработки эластичных БД для очистки этих журналов. Дополнительные сведения см. в разделе [очистки журналов SSISDB с помощью заданий эластичной базы данных Azure](how-to-clean-up-ssisdb-logs-with-elastic-jobs.md).

### <a name="error-message-the-request-limit-for-the-database-is--and-has-been-reached"></a>Сообщение об ошибке: «Количество запросов для базы данных —... и он достигнут.»

Если многие пакеты выполняются в параллельном режиме в среде выполнения интеграции SSIS, эта ошибка может возникать, поскольку SSISDB достиг максимального числа запросов. Рассмотрите возможность увеличения DTC SSISDB для устранения этой проблемы. Вы можете найти подробную информацию в [ограничения ресурсов базы данных SQL для сервера базы данных SQL Azure](https://docs.microsoft.com/azure/sql-database/sql-database-resource-limits-logical-server).

### <a name="error-message-ssis-operation-failed-with-unexpected-operation-status-"></a>Сообщение об ошибке: «Сбой операции служб SSIS с состояние операции Непредвиденная:...»

Ошибка главным образом вызвана временным сбоем, так что повторно запустите выполнения пакета. Примените шаблон повторных попыток в пакете служб SSIS, выполнив следующие действия:

* Убедитесь, что пакетов служб SSIS можно повторно запустить в случае сбоя без побочных эффектов (например, потери данных или дублирования данных).
* Настройка **повторите** и **интервал повторных попыток** из **выполнение пакета служб SSIS** действия на **Общие** вкладки. ![Задать свойства на вкладке "Общие"](media/how-to-invoke-ssis-package-ssis-activity/ssis-activity-general.png)
* ADO.NET и OLE DB компоненте источника или назначения, задайте **ConnectRetryCount** и **ConnectRetryInterval** в диспетчере соединений в пакет служб SSIS или действия SSIS.

### <a name="error-message-there-is-no-active-worker"></a>Сообщение об ошибке: «Есть нет активных рабочих».

Эта ошибка обычно означает, что среда выполнения интеграции SSIS имеет неработоспособное состояние. Перейдите на портал Azure, для состояния и подробные сведения об ошибках. Дополнительные сведения см. в разделе [среды выполнения интеграции Azure SSIS](https://docs.microsoft.com/azure/data-factory/monitor-integration-runtime#azure-ssis-integration-runtime).

### <a name="error-message-your-integration-runtime-cannot-be-upgraded-and-will-eventually-stop-working-since-we-cannot-access-the-azure-blob-container-you-provided-for-custom-setup"></a>Сообщение об ошибке: «Среды выполнения интеграции не могут быть обновлены и в конечном итоге перестанет работать, так как мы не доступ к контейнеру BLOB-объектов Azure, заданное для пользовательской установки.»

Эта ошибка возникает, когда среда выполнения интеграции SSIS нет доступа к конфигурации для настройки хранилища. Проверьте ли подписанные URL-адреса (SAS) URI, который вы указали является допустимым и еще не истек.

### <a name="error-message-microsoft-ole-db-provider-for-analysis-services-hresult-0x80004005-description-com-error-com-error-mscorlib-exception-has-been-thrown-by-the-target-of-an-invocation"></a>Сообщение об ошибке: «Поставщик Microsoft OLE DB для служб Analysis Services. "Hresult: 0x80004005 Описание: " Ошибка COM: Ошибка COM: mscorlib; Исключения по целевому объекту вызова»

Одной из возможных причин является то, что имя пользователя или пароля с включенной многофакторной проверкой подлинности Azure настроено для проверки подлинности служб Azure Analysis Services. Эта проверка подлинности не поддерживается в среде выполнения интеграции SSIS. Попробуйте использовать субъект-службу для проверки подлинности служб Azure Analysis Services:
1. Подготовьте субъект-службу, как описано в [автоматизации с помощью субъектов](https://docs.microsoft.com/azure/analysis-services/analysis-services-service-principal).
2. Настройка в диспетчере соединений **использовать указанные имя пользователя и пароль**: задать **AppID** как имя пользователя и **clientSecret** в качестве пароля.

### <a name="error-message-adonet-source-has-failed-to-acquire-the-connection-guid-with-the-following-error-message-login-failed-for-user-nt-authorityanonymous-logon-when-using-a-managed-identity"></a>Сообщение об ошибке: «Источник ADONET не смог установить подключение {GUID} сообщение об ошибке: Ошибка входа пользователя 'NT AUTHORITY\ANONYMOUS LOGON'» при использовании управляемого удостоверения

Убедитесь, что вы не настраиваете метод проверки подлинности диспетчера подключений как **проверку пароля Active Directory** при параметре *ConnectUsingManagedIdentity* является **True** . Можно настроить его как **проверки подлинности SQL** вместо этого, который учитывается, если *ConnectUsingManagedIdentity* имеет значение.

### <a name="package-execution-takes-too-long"></a>Выполнение пакетов занимает слишком много времени

Ниже приведены возможные причины и рекомендуемые действия.
* Слишком много операций выполнения пакетов запланирована на среду выполнения интеграции SSIS. Все выполнения будет ожидать в очереди для очереди.
  * Определите максимально с помощью следующей формулы: 
    
    Максимальное количество параллельных выполнений на IR = число узлов * максимальное количество параллельных выполнения на каждом узле
  * Чтобы узнать, как задать количество узлов и максимальное параллельного выполнения на каждом узле, см. в разделе [создания среды выполнения интеграции Azure SSIS в фабрике данных Azure](create-azure-ssis-integration-runtime.md).
* Среда выполнения интеграции SSIS остановлена или находится в неработоспособном состоянии. Чтобы узнать, как проверить состояние среды выполнения интеграции SSIS и ошибки, см. в разделе [среды выполнения интеграции Azure SSIS](monitor-integration-runtime.md#azure-ssis-integration-runtime).

Мы также рекомендуем установить время ожидания на **Общие** вкладке: ![Задать свойства на вкладке "Общие"](media/how-to-invoke-ssis-package-ssis-activity/ssis-activity-general.png).

### <a name="poor-performance-in-package-execution"></a>Низкая производительность при выполнении пакета

Попытайтесь выполните следующие действия:

* Убедитесь, что среда выполнения интеграции SSIS, — в том же регионе, в качестве источника данных и назначения.

* Установите уровень ведения журнала выполнения пакета для **производительности** собирать сведения о продолжительности для каждого компонента в среде выполнения. Дополнительные сведения см. в разделе [ведения журналов Integration Services (SSIS)](https://docs.microsoft.com/sql/integration-services/performance/integration-services-ssis-logging).

* Проверьте производительность узла среды выполнения Интеграции на портале Azure:
  * Сведения о мониторинге среды выполнения интеграции SSIS см. в разделе [среды выполнения интеграции Azure SSIS](monitor-integration-runtime.md#azure-ssis-integration-runtime).
  * Журнал ЦП и памяти для среды выполнения интеграции SSIS можно найти, просмотрев метрики фабрики данных на портале Azure.
    ![Мониторинг метрик среды выполнения интеграции SSIS](media/ssis-integration-runtime-ssis-activity-faq/monitor-metrics-ssis-integration-runtime.png)
