---
title: Устранение неполадок при выполнении пакетов в среде выполнения интеграции SSIS | Документация Майкрософт
description: В этой статье содержатся рекомендации по устранению неполадок при выполнении пакетов служб SSIS в среде выполнения интеграции SSIS.
services: data-factory
documentationcenter: ''
ms.service: data-factory
ms.workload: data-services
ms.tgt_pltfrm: na
ms.topic: conceptual
ms.date: 04/15/2019
author: wenjiefu
ms.author: wenjiefu
ms.reviewer: sawinark
manager: craigg
ms.openlocfilehash: a7ad0f3be754029c654b04d19750aab7bbcd210d
ms.sourcegitcommit: 13a289ba57cfae728831e6d38b7f82dae165e59d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/09/2019
ms.locfileid: "68933634"
---
# <a name="troubleshoot-package-execution-in-the-ssis-integration-runtime"></a>Устранение неполадок при выполнении пакетов в среде выполнения интеграции SSIS

Эта статья содержит наиболее распространенные ошибки, которые могут возникнуть при выполнении пакетов SQL Server Integration Services (SSIS) в среде выполнения интеграции SSIS. В нем описываются возможные причины и действия по устранению ошибок.

## <a name="where-to-find-logs-for-troubleshooting"></a>Где найти журналы для устранения неполадок

Используйте портал фабрики данных Azure для проверки выходных данных действия выполнения пакета служб SSIS. Выходные данные включают результат выполнения, сообщения об ошибках и идентификатор операции. Дополнительные сведения см. [в разделе Мониторинг конвейера](how-to-invoke-ssis-package-ssis-activity.md#monitor-the-pipeline).

Используйте каталог SSIS (SSISDB) для проверки подробных журналов выполнения. Дополнительные сведения см. в разделе [мониторинг выполняемых пакетов и других операций](https://docs.microsoft.com/sql/integration-services/performance/monitor-running-packages-and-other-operations?view=sql-server-2017).

## <a name="common-errors-causes-and-solutions"></a>Распространенные ошибки, причины и решения

### <a name="error-message-connection-timeout-expired-or-the-service-has-encountered-an-error-processing-your-request-please-try-again"></a>Сообщение об ошибке: "Истекло время ожидания подключения" или "Служба обнаружила ошибку при обработке запроса. Повторите попытку ".

Ниже приведены возможные причины и рекомендуемые действия.
* Источник данных или назначение перегружены. Проверьте загрузку источника данных или назначения и убедитесь, что у него достаточно ресурсов. Например, если вы использовали базу данных SQL Azure, рассмотрите возможность увеличения масштаба, если база данных, скорее всего, истекает время ожидания.
* Сеть между средой выполнения интеграции SSIS и источником данных или назначением нестабильна, особенно если подключение осуществляется между регионами или между локальными сетями и Azure. Примените шаблон повтора в пакете служб SSIS, выполнив следующие действия.
  * Убедитесь, что пакеты служб SSIS могут быть повторно запущены при сбое без побочных эффектов (например, потери данных или дублирование данных).
  * Настройте **Повтор** и **интервал повтора** для действия " **выполнение пакета служб SSIS** " на вкладке " **Общие** ". ![Задание свойств на вкладке «Общие»](media/how-to-invoke-ssis-package-ssis-activity/ssis-activity-general.png)
  * Для ADO.NET и OLE DB компонента источника или назначения задайте **ConnectRetryCount** и **ConnectRetryInterval** в диспетчере соединений в пакете служб SSIS или в действии служб SSIS.

### <a name="error-message-ado-net-source-has-failed-to-acquire-the-connection--with-a-network-related-or-instance-specific-error-occurred-while-establishing-a-connection-to-sql-server-the-server-was-not-found-or-was-not-accessible"></a>Сообщение об ошибке: "Источнику ADO NET не удалось получить подключение"... "" при установлении соединения с SQL Server возникла ошибка, связанная с сетью или с конкретным экземпляром. Сервер не найден или недоступен ".

Причина этой проблемы обычно заключается в том, что источник данных или назначение недоступны из среды выполнения интеграции MSSQL Integration Services. Причины могут быть разными. Попробуйте выполнить следующие действия:
* Убедитесь, что источник данных или имя назначения или IP-адрес правильно передаются.
* Убедитесь, что брандмауэр настроен правильно.
* Убедитесь, что виртуальная сеть настроена правильно, если источник данных или назначение находятся в локальной среде.
  * Определить, связана ли эта ошибка с конфигурацией виртуальной сети, можно, выполнив подготовку виртуальной машины Azure в той же виртуальной сети. Затем проверьте, можно ли получить доступ к источнику данных или назначению с виртуальной машины Azure.
  * Дополнительные сведения об использовании виртуальной сети со средой выполнения интеграции SSIS см. в статье [Присоединение среды выполнения интеграции Azure SSIS к виртуальной сети](join-azure-ssis-integration-runtime-virtual-network.md).

### <a name="error-message-ado-net-source-has-failed-to-acquire-the-connection--with-could-not-create-a-managed-connection-manager"></a>Сообщение об ошибке: "Источнику ADO NET не удалось получить подключение"... "" с "не удалось создать управляемый диспетчер соединений".

Возможная причина заключается в том, что поставщик ADO.NET, используемый в пакете, не установлен в среде выполнения интеграции SSIS. Поставщик можно установить с помощью пользовательской установки. Дополнительные сведения о пользовательской установке см. в статье [Настройка установки для среды выполнения интеграции Azure SSIS](how-to-configure-azure-ssis-ir-custom-setup.md).

### <a name="error-message-the-connection--is-not-found"></a>Сообщение об ошибке: "Подключение"... не найден "

Эту ошибку может вызывать известная проблема, существующая в предыдущих версиях SQL Server Management Studio (SSMS). Если пакет содержит пользовательский компонент (например, пакет дополнительных компонентов Azure для MSSQL Integration Services или компоненты партнера), который не установлен на компьютере, на котором используется среда SSMS для развертывания, эта среда удалит компонент и выдаст сообщение об ошибке. Обновите [среду SSMS](https://docs.microsoft.com/sql/ssms/download-sql-server-management-studio-ssms) до последней версии с исправленной проблемой.

### <a name="error-messagessis-executor-exit-code--1073741819"></a>Сообщение об ошибке: "код выхода исполнителя служб SSIS:-1073741819".

* Возможная причина & рекомендуемое действие:
  * Эта ошибка может быть вызвана ограничением для источника и назначения Excel, когда несколько источников или назначений Excel выполняются параллельно в многопоточной работе. Чтобы устранить это ограничение, измените компоненты Excel так, чтобы они выполнялись последовательно, или разделите их на разные пакеты и активируйте с помощью "выполнение задачи пакета", задав для свойства параметр ExecuteOutOfProcess значение true.

### <a name="error-message-there-is-not-enough-space-on-the-disk"></a>Сообщение об ошибке: "Недостаточно места на диске"

Эта ошибка означает, что локальный диск используется в узле среды выполнения интеграции SSIS. Проверьте, использует ли ваш пакет или пользовательскую установку много места на диске:
* Если диск занят пакетом, он будет освобожден после завершения выполнения пакета.
* Если диск используется настраиваемой программой установки, необходимо отключить среду выполнения интеграции SSIS, изменить скрипт и снова запустить среду выполнения интеграции. Весь контейнер больших двоичных объектов Azure, указанный для пользовательской установки, будет скопирован на узел среды выполнения интеграции SSIS, поэтому проверьте наличие ненужных данных в этом контейнере.

### <a name="error-message-failed-to-retrieve-resource-from-master-microsoftsqlserverintegrationservicesscalescaleoutcontractcommonmasterresponsefailedexception-code300004-descriptionload-file--failed"></a>Сообщение об ошибке: «Не удалось получить ресурс из главного сервера. Microsoft. SqlServer. IntegrationServices. Scale. Скалеаутконтракт. Common. Мастерреспонсефаиледексцептион: Код: 300004. Описание: не удалось загрузить файл "* * *".

* Возможная причина & рекомендуемое действие:
  * Если действие SSIS выполняется пакет из файловой системы (файла пакета или файла проекта), эта ошибка возникает, если проект, пакет или файл конфигурации недоступен с пакетными учетными данными, предоставленными в действии служб SSIS.
    * Если вы используете файл Azure, сделайте следующее:
      * Путь к файлу должен начинаться \\с\> \< \\имени учетной записи\\хранения. File.Core.Windows.NET\<путь к общей папке\>
      * Домен должен иметь значение "Azure".
      * Имя пользователя должно быть \<именем учетной записи хранения\>
      * Пароль должен быть \<ключом доступа к хранилищу\>
    * Если вы используете локальный файл, убедитесь, что виртуальная сеть, учетные данные для доступа к пакету и разрешения настроены правильно, чтобы среда выполнения интеграции Azure SSIS могла получить доступ к локальной общей папке.

### <a name="error-message-the-file-name--specified-in-the-connection-was-not-valid"></a>Сообщение об ошибке: "Имя файла"... " указано недопустимое в соединении

* Возможная причина & рекомендуемое действие:
  * Указано недопустимое имя файла
  * Убедитесь, что вместо короткого времени в диспетчере соединений используется полное доменное имя (FQDN).

### <a name="error-message-cannot-open-file-"></a>Сообщение об ошибке: "Не удается открыть файл"... ""

Эта ошибка возникает, когда при выполнении пакета не удается найти файл на локальном диске в среде выполнения интеграции SSIS. Попробуйте выполнить следующие действия:
* Не используйте абсолютный путь в пакете, который выполняется в среде выполнения интеграции SSIS. Использовать текущий рабочий каталог выполнения (.) или временную папку (% TEMP%) Используйте.
* Если необходимо сохранить некоторые файлы на узлах среды выполнения интеграции SSIS, подготовьте их, как описано в разделе [Настройка установки](how-to-configure-azure-ssis-ir-custom-setup.md). После завершения выполнения все файлы в рабочем каталоге будут очищены.
* Используйте службу файлов Azure вместо хранения файла в узле среды выполнения интеграции SSIS. Дополнительные сведения см. в статье [Использование файловых ресурсов Azure](https://docs.microsoft.com/sql/integration-services/lift-shift/ssis-azure-files-file-shares?view=sql-server-2017#use-azure-file-shares).

### <a name="error-message-the-database-ssisdb-has-reached-its-size-quota"></a>Сообщение об ошибке: "База данных" SSISDB "достигла квоты на размер"

Возможная причина заключается в том, что база данных SSISDB, созданная в базе данных SQL Azure или управляемом экземпляре при создании среды выполнения интеграции MSSQL Integration Services, достигла своей квоты. Попробуйте выполнить следующие действия:
* Попробуйте увеличить число единиц транзакций базы данных. См. подробнее об [ограничениях ресурсов для сервера Базы данных SQL Azure](https://docs.microsoft.com/azure/sql-database/sql-database-resource-limits-logical-server).
* Проверьте, создает ли ваш пакет много журналов. В этом случае можно настроить задание обработки эластичных баз данных для очистки этих журналов. См. подробнее об [очистке журналов SSISDB с помощью заданий обработки эластичных баз данных Azure](how-to-clean-up-ssisdb-logs-with-elastic-jobs.md).

### <a name="error-message-the-request-limit-for-the-database-is--and-has-been-reached"></a>Сообщение об ошибке: "Предельное число запросов для базы данных —... и достигнут ".

Если в среде выполнения интеграции SSIS выполняется параллельное выполнение множества пакетов, эта ошибка может возникать из-за того, что SSISDB достигнет предельного количества запросов. Чтобы устранить эту проблему, попробуйте увеличить DTC в SSISDB. См. подробнее об [ограничениях ресурсов для сервера Базы данных SQL Azure](https://docs.microsoft.com/azure/sql-database/sql-database-resource-limits-logical-server).

### <a name="error-message-ssis-operation-failed-with-unexpected-operation-status-"></a>Сообщение об ошибке: "Сбой операции служб SSIS с непредвиденным состоянием операции:..."

Эта ошибка в основном вызвана временной проблемой, поэтому попробуйте повторить выполнение пакета. Примените шаблон повтора в пакете служб SSIS, выполнив следующие действия.

* Убедитесь, что пакеты служб SSIS могут быть повторно запущены при сбое без побочных эффектов (например, потери данных или дублирование данных).
* Настройте **Повтор** и **интервал повтора** для действия " **выполнение пакета служб SSIS** " на вкладке " **Общие** ". ![Задание свойств на вкладке «Общие»](media/how-to-invoke-ssis-package-ssis-activity/ssis-activity-general.png)
* Для ADO.NET и OLE DB компонента источника или назначения задайте **ConnectRetryCount** и **ConnectRetryInterval** в диспетчере соединений в пакете служб SSIS или в действии служб SSIS.

### <a name="error-message-there-is-no-active-worker"></a>Сообщение об ошибке: "Нет активного рабочего процесса".

Эта ошибка обычно означает, что среда выполнения интеграции SSIS имеет неработоспособное состояние. Проверьте портал Azure состояния и подробных сведений об ошибках. Дополнительные сведения см. в разделе [Среда выполнения интеграции Azure SSIS](https://docs.microsoft.com/azure/data-factory/monitor-integration-runtime#azure-ssis-integration-runtime).

### <a name="error-message-your-integration-runtime-cannot-be-upgraded-and-will-eventually-stop-working-since-we-cannot-access-the-azure-blob-container-you-provided-for-custom-setup"></a>Сообщение об ошибке: "Не удается обновить среду выполнения интеграции, и в конечном итоге она перестанет работать, так как мы не можем получить доступ к контейнеру больших двоичных объектов Azure, предоставленному для выборочной установки".

Эта ошибка возникает, когда среда выполнения интеграции SSIS не может получить доступ к хранилищу, настроенному для пользовательской установки. Проверьте, является ли указанный URI подписанного URL-адресом (SAS) действительным, и срок его действия не истек.

### <a name="error-message-microsoft-ole-db-provider-for-analysis-services-hresult-0x80004005-description-com-error-com-error-mscorlib-exception-has-been-thrown-by-the-target-of-an-invocation"></a>Сообщение об ошибке: "Поставщик OLE DB Майкрософт для Analysis Services. Состав Описание 0x80004005: " Ошибка COM: Ошибка COM: mscorlib; Исключение вызвано целевым объектом вызова "

Одна из возможных причин заключается в том, что имя пользователя или пароль с включенной многофакторной идентификацией Azure настроены для проверки подлинности Azure Analysis Services. Эта проверка подлинности не поддерживается в среде выполнения интеграции SSIS. Попробуйте использовать субъект-службу для проверки подлинности Azure Analysis Services:
1. Подготовьте субъект-службу, как описано в статье [Автоматизация с помощью субъектов-служб](https://docs.microsoft.com/azure/analysis-services/analysis-services-service-principal).
2. В диспетчере соединений настройте **использовать указанные имя пользователя и пароль**: задайте **AppID** в качестве имени пользователя и **clientSecret** в качестве пароля.

### <a name="error-message-adonet-source-has-failed-to-acquire-the-connection-guid-with-the-following-error-message-login-failed-for-user-nt-authorityanonymous-logon-when-using-a-managed-identity"></a>Сообщение об ошибке: "Источнику АДОНЕТ не удалось получить подключение {GUID} со следующим сообщением об ошибке: Пользователю "NT AUTHORITY\ANONYMOUS logon» LOGON" не удалось войти в систему при использовании управляемого удостоверения

Убедитесь, что метод проверки подлинности диспетчера соединений не настроен как **Active Directory проверки** подлинности с помощью пароля, если параметр *Коннектусингманажедидентити* имеет **значение true**. Вместо этого можно настроить **проверку подлинности SQL** , что не учитывается, если задан параметр *коннектусингманажедидентити* .

### <a name="multiple-package-executions-are-triggered-unexpectedly"></a>Несколько запусков пакета вызываются неожиданно

* Возможная причина & рекомендуемое действие:
  * Действие хранимой процедуры ADF используется для запуска выполнения пакета служб SSIS. Команда t-SQL может вызвать временную ошибку и запустить повторное выполнение, что приведет к выполнению нескольких пакетов.
  * Вместо этого используйте действие Ексекутессиспаккаже, которое гарантирует, что выполнение пакета не будет выполняться повторно, если число повторных попыток не задается пользователем. Подробные сведения можно найти по адресу[https://docs.microsoft.com/azure/data-factory/how-to-invoke-ssis-package-ssis-activity](https://docs.microsoft.com/azure/data-factory/how-to-invoke-ssis-package-ssis-activity)

### <a name="package-execution-takes-too-long"></a>Выполнение пакета занимает слишком много времени

Ниже приведены возможные причины и рекомендуемые действия.

* В среде выполнения интеграции SSIS запланировано слишком много выполнений пакетов. Все эти выполнения будут ожидать в очереди на свою очередь.
  * Определите максимум, используя следующую формулу:

    Максимальное число параллельных выполнений на IR = число узлов * максимальное параллельное выполнение на узел
  * Сведения о том, как задать количество узлов и максимальное параллельное выполнение на каждом узле, см. [в статье Создание среды выполнения интеграции Azure SSIS в фабрике данных Azure](create-azure-ssis-integration-runtime.md).
* Среда выполнения интеграции служб SSIS остановлена или имеет неработоспособное состояние. Сведения о проверке состояния и ошибок среды выполнения интеграции SSIS см. в разделе [Среда выполнения интеграции Azure SSIS](monitor-integration-runtime.md#azure-ssis-integration-runtime).

Также рекомендуется установить время ожидания на вкладке **Общие** : ![Задайте свойства на вкладке](media/how-to-invoke-ssis-package-ssis-activity/ssis-activity-general.png)общие.

### <a name="poor-performance-in-package-execution"></a>Низкая производительность при выполнении пакета

Попробуйте выполнить следующие действия:

* Убедитесь, что среда выполнения интеграции SSIS находится в том же регионе, что и источник данных и назначение.

* Задайте уровень ведения журнала выполнения пакета для **производительности** , чтобы получить сведения о продолжительности каждого компонента во время выполнения. Дополнительные сведения см. в разделе [ведение журнала Integration Services (SSIS)](https://docs.microsoft.com/sql/integration-services/performance/integration-services-ssis-logging).

* Проверьте производительность узла IR в портал Azure:
  * Сведения о мониторинге среды выполнения интеграции SSIS см. в разделе [Среда выполнения интеграции Azure SSIS](monitor-integration-runtime.md#azure-ssis-integration-runtime).
  * Журнал ЦП и памяти для среды выполнения интеграции служб SSIS можно найти, просмотрев метрики фабрики данных в портал Azure.
    ![Мониторинг метрик среды выполнения интеграции SSIS](media/ssis-integration-runtime-ssis-activity-faq/monitor-metrics-ssis-integration-runtime.png)
