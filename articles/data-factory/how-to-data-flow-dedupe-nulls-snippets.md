---
title: Декопия строк и поиск значений NULL с помощью фрагментов потока данных
description: Узнайте, как легко выпустить строки и найти значения NULL с помощью фрагментов кода в потоках данных.
services: data-factory
author: kromerm
ms.service: data-factory
ms.workload: data-services
ms.topic: conceptual
ms.date: 09/30/2020
ms.author: makromer
ms.openlocfilehash: 1c630cdd66fa4f8e609524feb9c3f0bcad9711a0
ms.sourcegitcommit: 9b8425300745ffe8d9b7fbe3c04199550d30e003
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/23/2020
ms.locfileid: "92458172"
---
# <a name="dedupe-rows-and-find-nulls-by-using-data-flow-snippets"></a>Декопия строк и поиск значений NULL с помощью фрагментов потока данных

[!INCLUDE [appliesto-adf-asa-md](includes/appliesto-adf-asa-md.md)]

С помощью фрагментов кода при сопоставлении потоков данных можно легко выполнять такие распространенные задачи, как дедупликация данных и фильтрация значений NULL. В этой статье объясняется, как легко добавить эти функции в конвейеры с помощью фрагментов сценариев потока данных.
<br>
> [!VIDEO https://www.microsoft.com/en-us/videoplayer/embed/RE4GnhH]

## <a name="create-a-pipeline"></a>Создание конвейера

1. Выберите **Новый конвейер**.

1. Добавьте действие потока данных.

1. Перейдите на вкладку **Параметры источника** , добавьте преобразование источник, а затем подключите его к одному из наборов данных.

    ![Снимок экрана: панель "Параметры источника" для добавления типа источника.](media/data-flow/snippet-adf-2.png)

    Фрагменты проверки дедупликации и NULL используют универсальные шаблоны, использующие преимущества смещения схемы потока данных. Фрагменты кода работают с любой схемой из набора данных или с наборами, не имеющими предварительно определенных схем.

1. В разделе "разные строки с использованием всех столбцов" [скрипта потока данных (DFS)](https://docs.microsoft.com/azure/data-factory/data-flow-script#distinct-row-using-all-columns)Скопируйте фрагмент кода для дистинктровс.

1. В пользовательском интерфейсе конструктора потока данных нажмите кнопку **Скрипт** в правом верхнем углу, чтобы открыть редактор скриптов, лежащий в основе диаграммы потока данных.

    ![Снимок экрана исходного фрагмента кода.](media/data-flow/snippet-adf-3.png)

1. В скрипте после определения `source1` нажмите клавишу ВВОД и вставьте фрагмент кода.

1. Выполните одно из следующих действий.

   * Подключите вставленный фрагмент кода к преобразованию источника, созданному ранее на графике, введя **Source1** перед вставленным кодом.

   * Кроме того, можно подключить новое преобразование в конструкторе, выбрав входящий поток из нового узла преобразования в графе.

     ![Снимок экрана: панель "Параметры условного разбиения".](media/data-flow/snippet-adf-4.png)

   Теперь поток данных удалит из источника дублирующиеся строки, используя преобразование «Статистическая обработка», которое группирует по всем строкам, используя общий хэш для всех значений столбцов.
    
1. Добавьте фрагмент кода для разбиения данных в один поток, содержащий строки со значениями NULL и другим потоком без значений NULL. Для этого:

   а. Вернитесь к [библиотеке фрагментов](https://docs.microsoft.com/azure/data-factory/data-flow-script#check-for-nulls-in-all-columns)кода и скопируйте код для проверки значений NULL.

   b. В конструкторе потоков данных снова выберите **Скрипт** , а затем вставьте новый код преобразования в нижней части. Это действие подключает скрипт к предыдущему преобразованию, помещая имя этого преобразования перед вставленным фрагментом.

   Теперь граф потока данных должен выглядеть примерно так:

    ![Снимок экрана: диаграмма потока данных.](media/data-flow/snippet-adf-1.png)

  Теперь вы создали рабочий поток данных с общими проверками дедупинг и NULL, используя существующие фрагменты кода из библиотеки сценариев потока данных и добавляя их в существующую структуру.

## <a name="next-steps"></a>Дальнейшие действия

* Создайте оставшуюся часть логики потока данных с помощью [преобразования потоков данных](concepts-data-flow-overview.md)сопоставления.
