---
title: Декопия строк и поиск значений NULL с помощью фрагментов потока данных
description: Узнайте, как легко выпустить строки и найти значения NULL с помощью фрагментов кода в потоках данных.
services: data-factory
author: kromerm
ms.service: data-factory
ms.workload: data-services
ms.topic: conceptual
ms.date: 09/30/2020
ms.author: makromer
ms.openlocfilehash: 841484a647d2737d621c75ebe63f65f2de829a26
ms.sourcegitcommit: 829d951d5c90442a38012daaf77e86046018e5b9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/09/2020
ms.locfileid: "91666515"
---
# <a name="dedupe-rows-and-find-nulls-using-data-flow-snippets"></a>Декопия строк и поиск значений NULL с помощью фрагментов потока данных

[!INCLUDE[appliesto-adf-asa-md](includes/appliesto-adf-asa-md.md)]

С помощью фрагментов кода при сопоставлении потоков данных можно легко выполнять стандартные задачи, такие как дедупликация данных и фильтрация значений NULL. В этом пошаговом руководство объясняется, как добавлять эти функции в конвейеры очень просто с помощью фрагментов сценариев потока данных.

> [!VIDEO https://www.microsoft.com/en-us/videoplayer/embed/RE4GnhH]

## <a name="create-a-pipeline"></a>Создание конвейера

1. Выберите **+ создать конвейер** , чтобы создать новый конвейер.

2. Добавьте действие потока данных.

3. Добавьте преобразование источника и подключите его к одному из наборов данных.

    ![Исходный фрагмент 2](media/data-flow/snippet-adf-2.png)

4. Фрагменты проверки дедупликации и значения NULL используют общие шаблоны, которые используют смещение схемы потока данных, чтобы они работали с любой схемой из набора данных или с наборами, не имеющими предварительно определенных схем.

5. [Перейдите на страницу документации по скрипту потока данных и скопируйте фрагмент кода для отдельных строк.](https://docs.microsoft.com/azure/data-factory/data-flow-script#distinct-row-using-all-columns)

6. В пользовательском интерфейсе конструктора потока данных нажмите кнопку Скрипт в правом верхнем углу, чтобы открыть редактор скриптов, лежащий в основе диаграммы потока данных.

    ![Исходный фрагмент 3](media/data-flow/snippet-adf-3.png)

7. После определения ```source1``` в скрипте нажмите клавишу ВВОД, а затем вставьте фрагмент кода.

8. Этот фрагмент кода будет подключаться к предыдущему преобразованию источника, созданному на графике, введя «Source1» перед вставленным кодом.

9. Кроме того, можно подключить новое преобразование в конструкторе, выбрав входящий поток из нового узла преобразования в графе.

    ![Исходный фрагмент 4](media/data-flow/snippet-adf-4.png)

10. Теперь поток данных удалит из источника дублирующиеся строки, используя преобразование «Статистическая обработка», которое группирует по всем строкам, используя общий хэш для всех значений столбцов.
    
11. Далее мы добавим фрагмент кода для разбиения данных в поток, содержащий строки со значениями NULL и потоком, не имеющим значений NULL.

12. [Вернитесь к библиотеке фрагментов кода, и на этот раз скопируйте код для проверки значений NULL.](https://docs.microsoft.com/azure/data-factory/data-flow-script#check-for-nulls-in-all-columns)

13. В конструкторе потоков данных снова щелкните сценарий и вставьте новый код преобразования в нижней части, подключив его к предыдущему преобразованию, введя имя этого преобразования перед вставленным фрагментом.

14. Теперь граф потока данных должен выглядеть примерно так:

    ![Исходный фрагмент 1](media/data-flow/snippet-adf-1.png)

  Теперь у вас есть рабочий поток данных с общими проверками дедупинг и NULL, используя существующие фрагменты кода из библиотеки сценариев потока данных и добавляя их в существующую структуру.

## <a name="next-steps"></a>Дальнейшие шаги

* Создайте оставшуюся часть логики потока данных с помощью [преобразования потоков данных](concepts-data-flow-overview.md)сопоставления.
