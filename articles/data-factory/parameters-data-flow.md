---
title: Параметризация потоков данных для сопоставления
description: Узнайте, как параметризовать поток данных сопоставления из конвейеров фабрики данных.
author: kromerm
ms.author: makromer
ms.reviewer: daperlov
ms.service: data-factory
ms.topic: conceptual
ms.date: 05/01/2020
ms.openlocfilehash: 8e88e5e8a9fbe1881959c5183dc01b11ac681bdf
ms.sourcegitcommit: 31236e3de7f1933be246d1bfeb9a517644eacd61
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/04/2020
ms.locfileid: "82780404"
---
# <a name="parameterizing-mapping-data-flows"></a>Параметризация потоков данных для сопоставления

[!INCLUDE[appliesto-adf-asa-md](includes/appliesto-adf-asa-md.md)] 

Сопоставление потоков данных в фабрике данных Azure поддерживает использование параметров. Определите параметры в определении потока данных и используйте их во всех выражениях. Значения параметров задаются вызывающим конвейером через действие "выполнение потока данных". Задать значения в выражениях действия потока данных можно тремя способами:

* Использование языка выражений потока управления конвейера для задания динамического значения
* Использование языка выражений потока данных для задания динамического значения
* Использовать любой язык выражений для установки статического литерального значения

Используйте эту возможность, чтобы потоки данных были общими, гибкими и пригодными для многократного использования. С помощью этих параметров можно параметризовать параметры потока данных и выражения.

## <a name="create-parameters-in-a-mapping-data-flow"></a>Создание параметров в потоке данных сопоставления

Чтобы добавить параметры в поток данных, щелкните пустую часть холста потока данных, чтобы просмотреть общие свойства. В области Параметры появится вкладка с именем **параметр**. Выберите **создать** , чтобы создать новый параметр. Для каждого параметра необходимо назначить имя, выбрать тип и при необходимости задать значение по умолчанию.

![Создание параметров потока данных](media/data-flow/create-params.png "Создание параметров потока данных")

## <a name="use-parameters-in-a-mapping-data-flow"></a>Использование параметров в потоке данных сопоставления 

На параметры можно ссылаться в любом выражении потока данных. Параметры начинаются с $ и являются неизменяемыми. Список доступных параметров можно найти в построителе выражений на вкладке **Параметры** .

![Выражение параметра потока данных](media/data-flow/parameter-expression.png "Выражение параметра потока данных")

Можно быстро добавить дополнительные параметры, выбрав **новый параметр** и указав имя и тип.

![Выражение параметра потока данных](media/data-flow/new-parameter-expression.png "Выражение параметра потока данных")

## <a name="assign-parameter-values-from-a-pipeline"></a>Назначение значений параметров из конвейера

После создания потока данных с параметрами его можно выполнить из конвейера с помощью действия "выполнение потока данных". После добавления действия на холст конвейера вы увидите доступные параметры потока данных на вкладке **Параметры** действия.

При назначении значений параметров можно использовать язык [выражений конвейера](control-flow-expression-language-functions.md) или [язык выражений потока данных](data-flow-expression-functions.md) на основе типов Spark. Каждый поток данных сопоставления может иметь любое сочетание параметров конвейера и выражения потока данных.

![Задание параметра потока данных](media/data-flow/parameter-assign.png "Задание параметра потока данных")

### <a name="pipeline-expression-parameters"></a>Параметры выражения конвейера

Параметры выражений конвейера позволяют ссылаться на системные переменные, функции, параметры конвейера и переменные, аналогичные другим действиям конвейера. Если щелкнуть **выражение конвейера**, откроется Боковая навигационная, позволяющая ввести выражение с помощью построителя выражений.

![Задание параметра потока данных](media/data-flow/parameter-pipeline.png "Задание параметра потока данных")

При ссылке параметры конвейера оцениваются, а затем их значения используются в языке выражений потока данных. Тип выражения конвейера не должен соответствовать типу параметра потока данных. 

#### <a name="string-literals-vs-expressions"></a>Выражения VS для строковых литералов

При назначении параметра выражения конвейера типа String по умолчанию добавляются кавычки, и значение будет оцениваться как литерал. Чтобы считать значение параметра в виде выражения потока данных, установите флажок выражение рядом с параметром.

![Задание параметра потока данных](media/data-flow/string-parameter.png "Задание параметра потока данных")

Значение, если параметр `stringParam` потока данных ссылается на параметр конвейера со значением `upper(column1)`. 

- Если выбрано выражение, `$stringParam` вычисляется значение Столбец1 все прописные.
- Если выражение не проверяется (поведение по умолчанию `$stringParam` ), результатом вычисления будет`'upper(column1)'`

#### <a name="passing-in-timestamps"></a>Передача меток времени

В языке выражений конвейера системные переменные, такие как `pipeline().TriggerTime` и, например `utcNow()` , возвращают метки времени в виде строк в формате "гггг-\'мм\'-дд T чч: мм: СС". ССССССЗ ". Чтобы преобразовать их в параметры потока данных типа timestamp, используйте интерполяцию строк для включения в `toTimestamp()` функцию нужной метки времени. Например, чтобы преобразовать время срабатывания конвейера в параметр потока данных, можно использовать `toTimestamp(left('@{pipeline().TriggerTime}', 23), 'yyyy-MM-dd\'T\'HH:mm:ss.SSS')`. 

![Задание параметра потока данных](media/data-flow/parameter-timestamp.png "Задание параметра потока данных")

> [!NOTE]
> Потоки данных могут поддерживать только до 3 миллисекунд. `left()` Функция используется для усечения дополнительных цифр.

#### <a name="pipeline-parameter-example"></a>Пример параметра конвейера

Предположим, что у вас есть `intParam` целочисленный параметр, ссылающийся на параметр конвейера `@pipeline.parameters.pipelineParam`типа String,. 

![Задание параметра потока данных](media/data-flow/parameter-pipeline-2.png "Задание параметра потока данных")

`@pipeline.parameters.pipelineParam`присваивается значение `abs(1)` во время выполнения.

![Задание параметра потока данных](media/data-flow/parameter-pipeline-4.png "Задание параметра потока данных")

При `$intParam` указании ссылки в выражении, например в производном столбце, будет `abs(1)` вычислено значение Return `1`. 

![Задание параметра потока данных](media/data-flow/parameter-pipeline-3.png "Задание параметра потока данных")

### <a name="data-flow-expression-parameters"></a>Параметры выражения потока данных

Выберите **выражение потока данных** , чтобы открыть построитель выражений потока данных. Вы сможете ссылаться на функции, другие параметры и любой определенный столбец схемы по всему потоку данных. Это выражение будет оцениваться так, как если бы оно ссылалось на.

> [!NOTE]
> Если передать недопустимое выражение или создать ссылку на столбец схемы, который не существует в этом преобразовании, параметр будет иметь значение null.


### <a name="passing-in-a-column-name-as-a-parameter"></a>Передача имени столбца в качестве параметра

Распространенным шаблоном является передача имени столбца в качестве значения параметра. Если столбец определен в схеме потока данных, вы можете ссылаться на него непосредственно в виде строкового выражения. Если столбец не определен в схеме, используйте `byName()` функцию. Не забудьте привести столбец к соответствующему типу с помощью функции приведения, `toString()`такой как.

Например, если требуется сопоставлять строковый столбец на основе параметра `columnName`, можно добавить преобразование «Производный столбец `toString(byName($columnName))`», равное.

![Передача имени столбца в качестве параметра](media/data-flow/parameterize-column-name.png "Передача имени столбца в качестве параметра")

## <a name="next-steps"></a>Дальнейшие действия
* [Выполнение действия потока данных](control-flow-execute-data-flow-activity.md)
* [Выражения потока управления](control-flow-expression-language-functions.md)
