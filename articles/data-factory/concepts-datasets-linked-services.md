---
title: Наборы данных
description: Сведения о наборах данных в фабрике. Наборы данных представляют входные и выходные данные.
services: data-factory
documentationcenter: ''
author: djpmsft
ms.author: daperlov
manager: jroth
ms.reviewer: maghan
ms.service: data-factory
ms.workload: data-services
ms.topic: conceptual
ms.custom: seo-lt-2019
ms.date: 04/25/2019
ms.openlocfilehash: 878ad98b118fa02a6659584ac60e3343a948cd20
ms.sourcegitcommit: a5ebf5026d9967c4c4f92432698cb1f8651c03bb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/08/2019
ms.locfileid: "74928482"
---
# <a name="datasets-in-azure-data-factory"></a>Наборы данных в фабрике данных Azure
> [!div class="op_single_selector" title1="Выберите используемую версию службы "Фабрика данных":"]
> * [Версия 1](v1/data-factory-create-datasets.md)
> * [Текущая версия](concepts-datasets-linked-services.md)

В этой статье описывается, какие бывают наборы данных, каким образом они определяются в формате JSON, а также как они используются в конвейерах фабрики данных Azure.

Чтобы получить общие представления о фабрике данных, ознакомьтесь со статьей [Общие сведения о службе фабрики данных Azure, службе интеграции данных в облаке](introduction.md).

## <a name="overview"></a>Краткое описание
Фабрика данных может иметь один или несколько конвейеров. **Конвейер** — это логическая группа **действий**, которые вместе выполняют задачу. Действия в конвейере определяют операции с данными. Теперь **набор данных** — это именованное представление данных, которое указывает данные, необходимые для использования в **действиях**, разделяя их на входные и выходные. Наборы данных представляют данные в разных хранилищах, например в таблицах, файлах, папках и документах. Например, набор данных больших двоичных объектов Azure указывает контейнер больших двоичных объектов и папку в хранилище BLOB-объектов, из которой действие должно считывать данные.

Перед созданием набора данных необходимо создать [**связанную службу**](concepts-linked-services.md) , чтобы связать хранилище данных с фабрикой данных. Связанные службы напоминают строки подключения, определяющие сведения о подключении, необходимые для подключения фабрики данных к внешним ресурсам. Таким образом, набор данных представляет структуру данных в связанных хранилищах данных, а связанная служба определяет подключение к источнику данных. Например, связанная служба хранилища Azure связывает учетную запись хранения с фабрикой данных. Набор данных больших двоичных объектов Azure представляет контейнер больших двоичных объектов и папку в учетной записи хранения Azure, содержащую входные большие двоичные объекты для обработки.

Ниже приведен пример сценария. Чтобы скопировать данные из хранилища BLOB-объектов в базу данных SQL, создайте две связанные службы: службу хранилища Azure и Базу данных SQL Azure. Затем создайте два набора данных: набор данных больших двоичных объектов Azure (для связанной службы хранилища Azure) и набор данных таблицы SQL Azure (для связанной службы "База данных SQL Azure"). Связанные службы хранилища Azure и Базы данных SQL Azure содержат строки подключения, которые фабрика данных использует во время выполнения для подключения к службе хранилища Azure и Базе данных Azure SQL соответственно. Набор данных больших двоичных объектов Azure указывает контейнер и папку больших двоичных объектов, содержащие входные большие двоичные объекты в хранилище BLOB-объектов. Набор данных таблицы SQL Azure указывает таблицу SQL в базе данных SQL, в которую будут копироваться данные.

На следующей схеме показана связь между конвейером, действием, набором данных и связанной службой в фабрике данных.

![Связь между конвейером, действием, набором данных и связанными службами](media/concepts-datasets-linked-services/relationship-between-data-factory-entities.png)


## <a name="dataset-json"></a>JSON набора данных
Набор данных в фабрике данных определяется в следующем формате JSON:

```json
{
    "name": "<name of dataset>",
    "properties": {
        "type": "<type of dataset: AzureBlob, AzureSql etc...>",
        "linkedServiceName": {
                "referenceName": "<name of linked service>",
                "type": "LinkedServiceReference",
        },
        "structure": [
            {
                "name": "<Name of the column>",
                "type": "<Name of the type>"
            }
        ],
        "typeProperties": {
            "<type specific property>": "<value>",
            "<type specific property 2>": "<value 2>",
        }
    }
}
```
В следующей таблице описаны свойства приведенного выше объекта JSON.

Свойство | Описание | Обязательно для заполнения |
-------- | ----------- | -------- |
name | Имя набора данных. Дополнительные сведения см. в статье [Фабрика данных Azure — правила именования](naming-rules.md). |  ДА |
Тип | Тип набора данных. Укажите один из типов, которые поддерживает фабрика данных (например: AzureBlob, AzureSqlTable). <br/><br/>Дополнительные сведения см. в разделе [о типах наборов данных](#dataset-type). | ДА |
structure | Схема набора данных. Дополнительные сведения см. в разделе [схема набора данных](#dataset-structure-or-schema). | Нет |
typeProperties | Свойства каждого типа отличаются (например, свойства большого двоичного объекта Azure и таблицы SQL Azure). Сведения о поддерживаемых типах и их свойствах см. в разделе [Тип набора данных](#dataset-type). | ДА |

### <a name="data-flow-compatible-dataset"></a>Совместимый с потоком данных набор данных



Список типов наборов данных, совместимых с [потоком данных](concepts-data-flow-overview.md) , см. в разделе [Поддерживаемые типы наборов](#dataset-type) данных. Для наборов данных, совместимых с потоками данных, для преобразований требуются детализированные определения DataSet. Таким же определение JSON немного отличается. Вместо свойства _структуры_ наборы данных, являющиеся совместимыми с данными, имеют свойство _схемы_ .

В потоке данных наборы DataSet используются в преобразованиях исходного кода и приемника. Наборы данных определяют базовые схемы. Если в данных нет схемы, можно использовать смещение схемы для источника и приемника. Схема в наборе данных представляет физический тип данных и форму.

Определив схему из набора данных, вы получите связанные с ней типы данных, форматы данных, расположение файлов и сведения о соединении из связанной службы. Метаданные из наборов данных отображаются в исходном преобразовании в качестве исходной *проекции*. Проекция в преобразовании «источник» представляет данные потока данных с определенными именами и типами.

При импорте схемы набора данных потока данных нажмите кнопку **Импорт схемы** и выберите Импорт из источника или из локального файла. В большинстве случаев схема импортируется непосредственно из источника. Но если у вас уже есть локальный файл схемы (файл Parquet или CSV с заголовками), можно направить фабрику данных на основу схемы для этого файла.


```json
{
    "name": "<name of dataset>",
    "properties": {
        "type": "<type of dataset: AzureBlob, AzureSql etc...>",
        "linkedServiceName": {
                "referenceName": "<name of linked service>",
                "type": "LinkedServiceReference",
        },
        "schema": [
            {
                "name": "<Name of the column>",
                "type": "<Name of the type>"
            }
        ],
        "typeProperties": {
            "<type specific property>": "<value>",
            "<type specific property 2>": "<value 2>",
        }
    }
}
```

В следующей таблице описаны свойства приведенного выше объекта JSON.

Свойство | Описание | Обязательно для заполнения |
-------- | ----------- | -------- |
name | Имя набора данных. Дополнительные сведения см. в статье [Фабрика данных Azure — правила именования](naming-rules.md). |  ДА |
Тип | Тип набора данных. Укажите один из типов, которые поддерживает фабрика данных (например: AzureBlob, AzureSqlTable). <br/><br/>Дополнительные сведения см. в разделе [о типах наборов данных](#dataset-type). | ДА |
schema | Схема набора данных. Дополнительные сведения см. в разделе [наборы данных, совместимые с Data Flow](#dataset-type). | Нет |
typeProperties | Свойства каждого типа отличаются (например, свойства большого двоичного объекта Azure и таблицы SQL Azure). Сведения о поддерживаемых типах и их свойствах см. в разделе [Тип набора данных](#dataset-type). | ДА |


## <a name="dataset-example"></a>Пример набора данных
В следующем примере набор данных представляет таблицу с именем MyTable в базе данных SQL.

```json
{
    "name": "DatasetSample",
    "properties": {
        "type": "AzureSqlTable",
        "linkedServiceName": {
                "referenceName": "MyAzureSqlLinkedService",
                "type": "LinkedServiceReference",
        },
        "typeProperties":
        {
            "tableName": "MyTable"
        },
    }
}

```
Обратите внимание на следующие моменты.

- для параметра type задано значение AzureSqlTable;
- свойство типа tableName (используется только для типа AzureSqlTable) имеет значение MyTable;
- параметр linkedServiceName ссылается на связанную службу типа AzureSqlDatabase, определение которой указано во фрагменте кода JSON ниже;

## <a name="dataset-type"></a>Тип набора данных
Существует множество различных типов наборов данных в зависимости от используемого хранилища данных. Список сохраненных данных, поддерживаемых фабрикой данных, можно найти в статье [Обзор соединителя](connector-overview.md) . Щелкните хранилище данных, чтобы узнать, как для него создать связанную службу и набор данных.

В примере в предыдущем разделе задан тип набора данных **AzureSqlTable**. Аналогично для набора данных больших двоичных объектов Azure задается тип **AzureBlob**, как показано в следующем фрагменте JSON.

```json
{
    "name": "AzureBlobInput",
    "properties": {
        "type": "AzureBlob",
        "linkedServiceName": {
                "referenceName": "MyAzureStorageLinkedService",
                "type": "LinkedServiceReference",
        },

        "typeProperties": {
            "fileName": "input.log",
            "folderPath": "adfgetstarted/inputdata",
            "format": {
                "type": "TextFormat",
                "columnDelimiter": ","
            }
        }
    }
}
```

## <a name="dataset-structure-or-schema"></a>Структура набора данных или схема
Набор данных раздела **структуры** или **схемы** (совместимый с потоком данных) является необязательным. Он определяет схему набора данных. В нем содержится коллекция имен и типов данных столбцов. Используйте этот раздел, чтобы указать сведения о типах, которые используются для преобразования типов и сопоставления столбцов из источника в приемник.

В каждом столбце раздела structure содержатся следующие свойства.

Свойство | Описание | Обязательно для заполнения
-------- | ----------- | --------
name | Имя столбца. | ДА
Тип | Тип данных столбца. Фабрика данных поддерживает следующие промежуточные типы данных в качестве допустимых значений: **Int16, Int32, Int64, Single, Double, Decimal, Byte[], Boolean, String, Guid, Datetime, Datetimeoffset и Timespan**. | Нет
culture | Язык и региональные параметры на основе .NET, используемые, если указан тип .NET `Datetime` или `Datetimeoffset`. Значение по умолчанию — `en-us`. | Нет
свойства | Строка формата будет использоваться, если указан тип .NET `Datetime` или `Datetimeoffset`. Сведения о формате даты и времени см. в статье [Строки настраиваемых форматов даты и времени](https://docs.microsoft.com/dotnet/standard/base-types/custom-date-and-time-format-strings). | Нет

### <a name="example"></a>Пример
В следующем примере предполагается, что исходные данные большого двоичного объекта представлены в формате таблицы CSV, которая содержит три столбца: userid, name и lastlogindate. Они имеют типы Int64, String и Datetime. Данные представлены в пользовательском формате даты и времени (используются французские сокращения дней недели).

Определите структуру набора данных большого двоичного объекта и укажите определения типов столбцов, как показано ниже:

```json
"structure":
[
    { "name": "userid", "type": "Int64"},
    { "name": "name", "type": "String"},
    { "name": "lastlogindate", "type": "Datetime", "culture": "fr-fr", "format": "ddd-MM-YYYY"}
]
```

### <a name="guidance"></a>Руководство

Используйте приведенные ниже рекомендации и узнайте, когда следует включать сведения о структуре, а также что должен содержать раздел **structure**. Ознакомьтесь со статьей [Сопоставление схем в действии копирования](copy-activity-schema-and-type-mapping.md), чтобы узнать больше о том, как фабрика данных сопоставляет исходные данные с данными приемника и когда необходимо указывать сведения о структуре.

- **Для жестко структурированных источников данных** добавьте раздел structure только в том случае, если нужно сопоставить столбцы источника со столбцами приемника и если их имена отличаются. Этот тип структурированного источника данных хранит схему данных и сведения о типе, а также сами данные. Примерами структурированных источников данных являются SQL Server, Oracle и база данных SQL Azure.<br/><br/>Для структурированных источников данных информация о типах уже доступна, поэтому ее не следует включать при добавлении раздела structure.
- **Для источников данных без схемы или частично структурированных источников данных (например, текстовых файлов в хранилище BLOB-объектов)** добавьте этот раздел, если в наборе содержатся входные данные для действия копирования и типы данных исходного набора нужно преобразовать в собственные типы для приемника. Кроме того, раздел structure добавляется, если нужно сопоставить столбцы источника со столбцами приемника.

## <a name="create-datasets"></a>Создание наборов данных
Наборы данных можно создавать с помощью таких инструментов и пакетов SDK: [API .NET](quickstart-create-data-factory-dot-net.md), [PowerShell](quickstart-create-data-factory-powershell.md), [REST API](quickstart-create-data-factory-rest-api.md), шаблон Azure Resource Manager, портал Azure.

## <a name="current-version-vs-version-1-datasets"></a>Наборы данных текущей версии и версии 1

Ниже приведены некоторые различия между наборами данных службы "Фабрика данных" текущей версии и версии 1.

- Внешнее свойство не поддерживается в текущей версии. Оно заменено [триггером](concepts-pipeline-execution-triggers.md).
- Политики и свойства доступности не поддерживаются в текущей версии. Время начала конвейера зависит от [триггеров](concepts-pipeline-execution-triggers.md).
- Наборы данных с заданной областью (наборы данных, определенные в конвейере) не поддерживаются в текущей версии.

## <a name="next-steps"></a>Дальнейшие действия
Пошаговые инструкции по созданию конвейеров и наборов данных с помощью одного из указанных ниже инструментов или пакетов SDK приведены в указанных ниже руководствах.

- [Создание фабрики данных и конвейера с помощью пакета SDK для .NET](quickstart-create-data-factory-dot-net.md)
- [Создание фабрики данных и конвейера с помощью пакета PowerShell](quickstart-create-data-factory-powershell.md)
- [Создание фабрики данных Azure и конвейера с помощью REST API](quickstart-create-data-factory-rest-api.md)
- [Краткое руководство. Создание фабрики данных с помощью портал Azure](quickstart-create-data-factory-portal.md)
