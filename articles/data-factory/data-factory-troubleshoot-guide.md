---
title: Устранение неполадок фабрики данных Azure | Документация Майкрософт
description: Узнайте, как устранять неполадки действий внешнего управления в фабрике данных Azure.
services: data-factory
author: nabhishek
ms.service: data-factory
ms.topic: troubleshooting
ms.date: 8/26/2019
ms.author: abnarain
ms.reviewer: craigg
ms.openlocfilehash: f35a3567ae4ae7c3e2d59f776d3a3bc00ec2be3e
ms.sourcegitcommit: d200cd7f4de113291fbd57e573ada042a393e545
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/29/2019
ms.locfileid: "70142385"
---
# <a name="troubleshoot-azure-data-factory"></a>Устранение неполадок фабрики данных Azure

В этой статье рассматриваются распространенные методы устранения неполадок для действий внешнего управления в фабрике данных Azure.

## <a name="connector-and-copy-activity"></a>Действие соединителя и копирования

Сведения о проблемах с соединителем, например ошибка при использовании действия копирования, см. в статье [Устранение неполадок соединителей фабрики данных Azure](connector-troubleshoot-guide.md).

## <a name="azure-databricks"></a>Azure Databricks

| Код ошибки | Сообщение об ошибке                                          | Описание                             | Рекомендация                             |
| -------------- | ----------------------------------------------------- | --------------------------------------------------------------| :----------------------------------------------------------- |
| 3200           | Ошибка 403.                                                    | Истек срок действия маркера доступа к модулям.                         | По умолчанию маркер доступа к модулям данные действителен в течение 90 дней.  Создайте новый токен и обновите связанную службу. |
| 3201           | Отсутствует обязательное поле: Settings. Task. notebook_task. notebook_path | Неплохая разработка: Путь к записной книжке указан неправильно. | Укажите путь к записной книжке в действии "кирпичы". |
| 3201           | Кластер... не существует.                                 | Ошибка создания: Кластер кирпичей не существует или был удален. | Убедитесь, что кластер кирпичей существует. |
| 3201           | Недопустимый URI файла Python... Поддерживаемые схемы URI см. в разделе "справочные сведения о модулях. | Неплохая разработка.                                                | Укажите абсолютные пути для схем адресации рабочей области или `dbfs:/folder/subfolder/foo.py` для файлов, хранящихся в файловой системе "кирпичы". |
| 3201           | {0}В качестве обязательных свойств для LinkedService должны быть заданы Domain и accessToken. | Неплохая разработка.                                                | Проверьте [определение связанной службы](compute-linked-services.md#azure-databricks-linked-service). |
| 3201           | {0}Для создания LinkedService необходимо указать либо существующий идентификатор кластера, либо сведения о новом кластере. | Неплохая разработка.                                                | Проверьте [определение связанной службы](compute-linked-services.md#azure-databricks-linked-service). |
| 3201           | Тип узла Standard_D16S_v3 не поддерживается. Поддерживаемые типы узлов:   Standard_DS3_v2, Standard_DS4_v2, Standard_DS5_v2, Standard_D8s_v3, Standard_D16s_v3, Standard_D32s_v3, Standard_D64s_v3, Standard_D3_v2, Standard_D8_v3, Standard_D16_v3, Standard_D32_v3, Standard_D64_v3, Standard_D12_v2, Standard_D13_v2, Standard_D14_v2, Standard_D15_v2, Standard_DS12_v2, Standard_DS13_v2, Standard_DS14_v2, Standard_DS15_v2, Standard_E8s_v3, Standard_E16s_v3, Standard_E32s_v3, Standard_E64s_v3, Standard_L4s, Standard_L8s, Standard_L16s, Standard_L32s, Standard_F4s, Standard_F8s, Standard_F16s, Standard_H16, Standard_F4s_v2, Standard_F8s_v2, Standard_F16s_v2, Standard_F32s_v2, Standard_F64s_v2, Standard_F72s_v2, Standard_NC12, Standard_NC24, Standard_NC6s_v3, Standard_NC12s_v3, Standard_ NC24s_v3, Standard_L8s_v2, Standard_L16s_v2, Standard_L32s_v2, Standard_L64s_v2, Standard_L80s_v2. | Неплохая разработка.                                                | См. сообщение об ошибке.                                          |
| 3201           | Недопустимый notebook_path:... В настоящее время поддерживаются только абсолютные пути. Пути должны начинаться с "/". | Неплохая разработка.                                                | См. сообщение об ошибке.                                          |
| 3202           | Уже 1000 заданий создано за последние 3600 секунд, что превышает предел скорости:   1000. Создание заданий в 3600 секунд. | Слишком много блоков, выполняемых в течение часа.                         | Проверьте все конвейеры, использующие эту рабочую область блоков, для их частоты создания заданий.  Если конвейеры запустили слишком много блоков обработки в статистическом модуле, перенесите некоторые конвейеры в новую рабочую область. |
| 3202           | Не удалось проанализировать объект запроса: Ожидалось, что "Key" и "value" должны быть заданы для поля base_parameters в карте JSON, получено "ключ:"... "" Используйте. | Ошибка создания: Не указано значение для параметра.         | Проверьте JSON конвейера и убедитесь, что все параметры в записной книжке Басепараметерс указывают непустое значение. |
| 3202           | Пользователь: `SimpleUserContext{userId=..., name=user@company.com, orgId=...}` не имеет прав доступа к кластеру. | Пользователь, создавший маркер доступа, не может получить доступ к кластеру кирпичей данных, указанному в связанной службе. | Убедитесь, что пользователь имеет необходимые разрешения в рабочей области.   |
| 3203           | Кластер находится в состоянии завершения, недоступен для получения заданий. Исправьте кластер или повторите попытку позже. | Работа кластера завершена.    Для интерактивных кластеров это может быть условие состязания. | Лучший способ избежать этой ошибки — использовать кластеры заданий.             |
| 3204           | Сбой выполнения задания.  | Сообщения об ошибках указывают на различные проблемы, например непредвиденное состояние кластера или определенное действие. Чаще всего сообщение об ошибке не отображается.                                                          | Н/Д                                                          |



## <a name="azure-data-lake-analytics"></a>Azure Data Lake Analytics

Следующая таблица относится к U-SQL.

| Код ошибки         | Сообщение об ошибке                                                | Описание                                          | Рекомендация                            |
| -------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 2709                 | Маркер доступа относится к неправильному клиенту.                    | Недопустимый клиент Azure Active Directory (Azure AD).                                         | Субъект-служба, используемый для доступа к Azure Data Lake Analytics, принадлежит другому клиенту Azure AD. Создайте новый субъект-службу в том же клиенте, что и учетная запись Data Lake Analytics. |
| 2711, 2705, 2704 | Запрещено. ACL verification failed. Либо ресурс не существует, либо пользователь не имеет права выполнять запрошенную операцию.<br/><br/>Пользователь не может получить доступ к Data Lake Store.  <br/><br/>У пользователя нет права использовать Data Lake Analytics. | Субъект-служба или сертификат не имеет доступа к файлу в хранилище. | Убедитесь, что субъект-служба или сертификат, предоставляемый пользователем для заданий Data Lake Analytics, имеет доступ к учетной записи Data Lake Analytics и экземпляру Data Lake Storage по умолчанию из корневой папки. |
| 2711                 | Не удается найти файл или папку "Azure Data Lake Store".       | Неверный путь к файлу U-SQL, или учетные данные связанной службы не имеют доступа. | Проверьте путь и учетные данные, указанные в связанной службе. |
| 2707                 | Не удается разрешить учетную запись AzureDataLakeAnalytics. Проверьте "AccountName" и "Даталакеаналитиксури". | Неверная учетная запись Data Lake Analytics в связанной службе.                  | Убедитесь, что указана правильная учетная запись.             |
| 2703                 | Идентификатор ошибки: E_CQO_SYSTEM_INTERNAL_ERROR (или любая ошибка, которая начинается с "Идентификатор ошибки:"). | Ошибка связана с Data Lake Analytics.                                    | Ошибка, аналогичная примеру, означает, что задание было отправлено в Data Lake Analytics и Скрипт завершился неудачно. Исследование в Data Lake Analytics. На портале перейдите к учетной записи Data Lake Analytics и найдите задание с помощью идентификатора запуска действия фабрики данных (не идентификатора запуска конвейера). Задание содержит дополнительные сведения об ошибке и поможет вам устранить неполадки. Если разрешение неясно, обратитесь в службу поддержки Data Lake Analytics и укажите URL-адрес задания, включающий имя учетной записи и идентификатор задания. |
| 2709                 | В данный момент невозможно принять ваше задание. Максимальное число заданий в очереди для вашей учетной записи — 200. | Эта ошибка вызвана регулированием Data Lake Analytics.                                           | Сократите число отправленных заданий, чтобы Data Lake Analytics, изменив триггеры фабрики данных и параметры параллелизма для действий. Или увеличьте ограничения на Data Lake Analytics. |
| 2709                 | Это задание было отклонено, так как для него требуется 24 Австралия. Политика, определяемая администратором этой учетной записи, не дает заданиям более 5 единиц использования. | Эта ошибка вызвана регулированием Data Lake Analytics.                                           | Сократите число отправленных заданий, чтобы Data Lake Analytics, изменив триггеры фабрики данных и параметры параллелизма для действий. Или увеличьте ограничения на Data Lake Analytics. |



## <a name="azure-functions"></a>Функции Azure

| Код ошибки | Сообщение об ошибке                           | Описание                                                  | Рекомендация                           |
| ------------ | --------------------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 3600         | Содержимое ответа не является допустимым JObject. | Вызванная функция Azure не вернула полезные данные JSON в ответе. Действие функции Azure в фабрике данных поддерживает только содержимое ответа JSON. | Обновите функцию Azure, чтобы она возвращала допустимые полезные данные JSON. Например, C# функция может возвращать `(ActionResult)new<OkObjectResult("{` \"идентификатор\":\"123.\"`}");` |
| 3600         | Недопустимый HttpMethod: "...".               | Метод HTTP, указанный в полезных данных действия, не поддерживается действием функции Azure. | Используйте поддерживаемый метод HTTP, такой как размещение, публикация, получение, удаление, параметры, ГОЛОВной элемент или ТРАССИРОВКа. |



## <a name="custom"></a>Настраиваемый

Следующая таблица относится к пакетной службе Azure.

| Код ошибки | Сообщение об ошибке                                                | Описание                                                  | Рекомендация                          |
| ------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 2500         | Возникло непредвиденное исключение, и выполнение завершилось с ошибкой.             | Не удается запустить команду, или программа вернула код ошибки. | Убедитесь, что исполняемый файл существует. Если программа запущена, убедитесь, что *stdout. txt* и *stderr. txt* были переданы в учетную запись хранения. Рекомендуется создавать в коде журналы копиаус для отладки. |
| 2501         | Не удается получить доступ к пользовательской учетной записи пакетной службы; Проверьте параметры учетной записи пакетной службы. | Неверный ключ доступа пакетной службы или имя пула.            | Проверьте имя пула и ключ доступа пакетной службы в связанной службе. |
| 2502         | Не удается получить доступ к учетной записи хранения пользователя; Проверьте параметры учетной записи хранения. | Неправильное имя учетной записи хранения или ключ доступа.       | Проверьте имя учетной записи хранения и ключ доступа в связанной службе. |
| 2504         | Операция вернула недопустимый код состояния "BadRequest".     | Слишком много файлов в folderPath для настраиваемого действия. Общий размер resourceFiles не может превышать 32 768 символов. | Удалите ненужные файлы. Или ZIP, и добавьте команду unzip, чтобы извлечь их. Например, используйте`powershell.exe -nologo -noprofile   -command "& { Add-Type -A 'System.IO.Compression.FileSystem';   [IO.Compression.ZipFile]::ExtractToDirectory($zipFile, $folder); }" ;  $folder\yourProgram.exe` |
| 2505         | Невозможно создать подпись общего доступа, если не используются учетные данные ключа учетной записи. | Пользовательские действия поддерживают только учетные записи хранения, использующие ключ доступа. | См. описание ошибки.                                            |
| 2507         | Путь к папке не существует или пуст:...            | В учетной записи хранения нет файлов по указанному пути.       | Путь к папке должен содержать исполняемые файлы, которые требуется запустить. |
| 2508         | В папке ресурсов имеются дублирующиеся файлы.               | Несколько файлов с одинаковыми именами находятся в разных вложенных папках folderPath. | Структура папок с нестандартными действиями в разделе folderPath.  Если необходимо сохранить структуру папок, ZIP-файлы и извлечь их в пакетной службе Azure с помощью команды unzip. Например, используйте`powershell.exe -nologo -noprofile   -command "& { Add-Type -A 'System.IO.Compression.FileSystem';   [IO.Compression.ZipFile]::ExtractToDirectory($zipFile, $folder); }" ;   $folder\yourProgram.exe` |
| 2509         | URL-адрес пакета... является недопустимым; Он должен быть в формате URI.         | URL-адреса пакетной службы должны быть похожи на`https://mybatchaccount.eastus.batch.azure.com` | См. описание ошибки.                                            |
| 2510         | При отправке запроса произошла ошибка.               | Недопустимый URL-адрес пакета.                                         | Проверьте URL-адрес пакета.                                            |

## <a name="hdinsight"></a>HDInsight

Следующая таблица применяется к потоковой передаче Spark, Hive, MapReduce, Pig и Hadoop.

| Код ошибки | Сообщение об ошибке                                                | Описание                                                  | Рекомендация                           |
| ------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 2300, 2310 | Не удалось отправить задание Hadoop. Ошибка: удаленное имя не удалось разрешить". <br/><br/>Кластер не найден. | Указан недопустимый URI кластера.                              | Убедитесь, что кластер не удален и предоставлен правильный URI. При открытии URI в браузере должен отобразиться пользовательский интерфейс Ambari. Если кластер находится в виртуальной сети, URI должен быть частным URI. Чтобы открыть его, используйте виртуальную машину, которая является частью той же виртуальной сети. Дополнительные сведения см. [в разделе прямое подключение к службам Apache Hadoop](https://docs.microsoft.com/azure/hdinsight/hdinsight-extend-hadoop-virtual-network#directly-connect-to-apache-hadoop-services). |
| 2300         | Не удалось отправить задание Hadoop. Задание:..., кластер:.../. Ошибка: Задача была отменена. | Истекло время ожидания отправки задания.                         | Проблема может быть либо общим подключением HDInsight, либо сетевым подключением. Сначала убедитесь, что пользовательский интерфейс HDInsight Ambari доступен из любого браузера. Убедитесь, что учетные данные все еще действительны. Если вы используете локальную среду выполнения (IR), убедитесь, что это делается с виртуальной машины или с компьютера, на котором установлено локальное IR-соединение. Затем попробуйте отправить задание из фабрики данных еще раз. Если по-прежнему происходит сбой, обратитесь за поддержкой к группе фабрики данных. |
| 2300         | Запрещен   Неверное имя пользователя или пароль Ambari  <br/><br/>Запрещен   Администратор пользователя заблокирован в Ambari.   <br/><br/>403-запрещено: Отказано в доступе". | Учетные данные для HDInsight неверны или истек срок их действия. | Исправьте учетные данные и повторно разверните связанную службу. Сначала убедитесь, что учетные данные работают в HDInsight, открыв универсальный код ресурса (URI) кластера в любом браузере и пытаясь войти в систему. Если учетные данные не работают, их можно сбросить с портал Azure. |
| 2300, 2310 | 502 — веб-сервером в качестве шлюза или прокси-сервера получен недопустимый ответ.       <br/>Неверный шлюз. | Эта ошибка возникла в HDInsight.                               | Эта ошибка связана с кластером HDInsight. Дополнительные сведения см. в разделе [AMBARI UI 502 Error](https://hdinsight.github.io/ambari/ambari-ui-502-error.html), [502 Errors Connect to Spark Thrift Server](https://hdinsight.github.io/spark/spark-thriftserver-errors.html), [502 Errors Connected to Spark Thrift Server](https://hdinsight.github.io/spark/spark-thriftserver-errors.html)и [Устранение ошибок шлюза в шлюзе приложений](https://docs.microsoft.com/azure/application-gateway/application-gateway-troubleshooting-502). |
| 2300         | Не удалось отправить задание Hadoop. Задание:..., кластер:... Ошибка: {\"ошибка\":\"не удалось обслужить запрос на отправку задания, так как служба Templeton занята со слишком большим количеством запросов на задание отправки. Подождите некоторое время и повторите операцию. Сведения о настройке параллельных запросов см. в файле config Templeton. параллеллисм. job. Submit.  <br/><br/>Не удалось отправить задание Hadoop. Должно 161da5d4-6fa8-4ef4-A240-6b6428c5ae2f, кластер: `https://abc-analytics-prod-hdi-hd-trax-prod01.azurehdinsight.net/`.   Ошибка: {\"Error\":\"Java. IO. IOException: org. Apache. Hadoop. Yarn. Exceptions. ярнексцептион: Не удалось отправить application_1561147195099_3730 в YARN: org. Apache. Hadoop. Security. Акцессконтролексцептион: Очередь root. joblauncher уже содержит приложения 500, не может принимать передачу приложения: application_1561147195099_3730 \ | Слишком много заданий отправляются в HDInsight одновременно. | Попробуйте ограничить количество параллельных заданий, отправляемых в HDInsight. См. сведения о параллелизме действий фабрики данных, если задания отправляются одним действием. Измените триггеры, чтобы параллельные запуски конвейера были распределены по времени. Сведения об ошибке см. `templeton.parallellism.job.submit` в документации по HDInsight. |
| 2303, 2347 | Сбой задания Hadoop с кодом выхода "5". Дополнительные сведенияwasbs://adfjobs@adftrialrun.blob.core.windows.net/StreamingJobs/da4afc6d-7836-444e-bbd5-635fce315997/18_06_2019_05_36_05_050/stderrсм. в разделе "".  <br/><br/>Сбой выполнения Hive с кодом ошибки "Усереррорхивеодбккоммандексекутионфаилуре".   Дополнительные сведенияwasbs://adfjobs@eclsupplychainblobd.blob.core.windows.net/HiveQueryJobs/16439742-edd5-4efe-adf6-9b8ff5770beb/18_06_2019_07_37_50_477/Status/hive.outсм. в разделе "". | Задание было отправлено в HDInsight и завершилось сбоем в HDInsight. | Задание успешно отправлено в HDInsight. Произошел сбой в кластере. Откройте задание и журналы в пользовательском интерфейсе Ambari HDInsight или откройте файл из хранилища, как было предложено в сообщении об ошибке. В файле отображаются сведения об ошибке. |
| 2328         | Во время обработки запроса произошла внутренняя ошибка сервера. Повторите запрос или обратитесь в службу поддержки. | Эта ошибка возникает в HDInsight по запросу.                              | Эта ошибка получена из службы HDInsight при сбое подготовки HDInsight. Обратитесь в службу HDInsight и укажите имя кластера по запросу. |
| 2310         | Java. lang. Нуллпоинтерексцептион                               | Эта ошибка возникает при отправке задания в кластер Spark.      | Это исключение поступает из HDInsight. Она скрывает фактическую ошибку. Обратитесь в службу поддержки по HDInsight. Укажите имя кластера и диапазон времени выполнения действия. |
|              | Все остальные ошибки                                             |                                                              | Дополнительные сведения об устранении неполадок см. в статье [вопросы и ответы](https://hdinsight.github.io/) [по hdinsight](../hdinsight/hdinsight-troubleshoot-guide.md) и hdinsight. |



## <a name="web-activity"></a>Веб-действие

| Код ошибки | Сообщение об ошибке                                                | Описание                                                  | Рекомендация                          |
| ------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 2108         | Недопустимый HttpMethod: "...".                                    | Веб-действие не поддерживает метод HTTP, указанный в полезных данных действия. | Поддерживаемые методы HTTP: WHERE, POST, GET и DELETE. |
| 2108         | Недопустимая ошибка сервера 500.                                     | Внутренняя ошибка в конечной точке.                               | Используйте Fiddler или POST для проверки функциональных возможностей URL-адреса. |
| 2108         | Несанкционированный 401.                                             | Отсутствует допустимая проверка подлинности для запроса.                      | Возможно, истек срок действия маркера. Укажите допустимый метод проверки подлинности. Используйте Fiddler или POST для проверки функциональных возможностей URL-адреса. |
| 2108         | Запрещено 403.                                                | Отсутствуют необходимые разрешения.                                 | Проверьте разрешения пользователя на доступ к ресурсу. Используйте Fiddler или POST для проверки функциональных возможностей URL-адреса.  |
| 2108         | Недопустимый запрос 400.                                              | Недопустимый HTTP-запрос.                                         | Проверьте URL-адрес, глагол и текст запроса. Используйте Fiddler или POST для проверки запроса.  |
| 2108         | Не найдено 404.                                                | Ресурс не найден.                                       | Используйте Fiddler или POST для проверки запроса.  |
| 2108         | Служба недоступна.                                          | Служба недоступна.                                       | Используйте Fiddler или POST для проверки запроса.  |
| 2108         | Неподдерживаемый тип носителя.                                       | Тип содержимого не соответствует тексту веб-действия.           | Укажите тип содержимого, соответствующий формату полезных данных. Используйте Fiddler или POST для проверки запроса. |
| 2108         | Ресурс, который вы ищете, был удален, его имя изменилось или временно недоступно. | Ресурс недоступен.                                | Чтобы проверить конечную точку, используйте Fiddler или POST. |
| 2108         | Запрашиваемая страница не может быть отображена, так как используется недопустимый метод (глагол HTTP). | В запросе указан недопустимый метод веб-действия.   | Чтобы проверить конечную точку, используйте Fiddler или POST. |
| 2108         | invalid_payload                                              | Неверный текст веб-действия.                       | Чтобы проверить конечную точку, используйте Fiddler или POST. |

Чтобы использовать Fiddler для создания сеанса HTTP отслеживаемого веб-приложения, выполните следующие действия.

1. Скачайте, установите и откройте [Fiddler](https://www.telerik.com/download/fiddler).

1. Если веб-приложение использует протокол HTTPS, перейдите в **меню Сервис** > **Fiddler параметры** > **HTTPS**. Выберите **захват HTTPS подключение** и **расшифровка трафика HTTPS**. 
   
   ![Параметры Fiddler](media/data-factory-troubleshoot-guide/fiddler-options.png)

1. Если приложение использует SSL-сертификаты, добавьте сертификат Fiddler на устройство. Последовательно выберите **пункты Сервис** > **Fiddler параметры** > **HTTPS** > действияЭкспорт > корневого**сертификата на Рабочий стол**.

1. Отключите захват, перейдя к**трафику записи** **файлов** > . Или нажмите клавишу **F12**.

1. Очистите кэш браузера, чтобы все кэшированные элементы были удалены и их нужно было снова скачать.

1. Создайте запрос: 

   1\. Перейдите на вкладку **Composer** .

   2\. Задайте метод HTTP и URL-адрес.

   В. При необходимости добавьте заголовки и текст запроса.

   Г. Нажмите кнопку **Выполнить**.

9. Включите повторную запись трафика и завершите проблемную транзакцию на странице.

10. Выберите **файл** > сохранитьвсе > **сеансы**.

Дополнительные сведения см. в статье Приступая к [работе с Fiddler](https://docs.telerik.com/fiddler/Configure-Fiddler/Tasks/ConfigureFiddler).

## <a name="next-steps"></a>Следующие шаги

Для получения дополнительных сведений об устранении неполадок воспользуйтесь следующими ресурсами:

*  [Блог фабрики данных](https://azure.microsoft.com/blog/tag/azure-data-factory/)
*  [Запросы функций фабрики данных](https://feedback.azure.com/forums/270578-data-factory)
*  [Видеоролики по Azure](https://azure.microsoft.com/resources/videos/index/?sort=newest&services=data-factory)
*  [Форум MSDN](https://social.msdn.microsoft.com/Forums/home?sort=relevancedesc&brandIgnore=True&searchTerm=data+factory)
*  [Форум Stack Overflow для фабрики данных](https://stackoverflow.com/questions/tagged/azure-data-factory)
*  [Сведения о фабрике данных в Twitter](https://twitter.com/hashtag/DataFactory)



