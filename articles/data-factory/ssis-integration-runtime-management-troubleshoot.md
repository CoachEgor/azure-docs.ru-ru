---
title: Устранение неполадок управления Integration Runtime SSIS в фабрике данных Azure | Документация Майкрософт
description: В этой статье содержатся рекомендации по устранению неполадок управления службами SSIS Integration Runtime (службы SSIS IR).
services: data-factory
documentationcenter: ''
ms.service: data-factory
ms.workload: data-services
ms.tgt_pltfrm: na
ms.topic: conceptual
ms.date: 07/08/2019
author: chinadragon0515
ms.author: dashe
ms.reviewer: sawinark
manager: craigg
ms.openlocfilehash: 17fe8d9ed02156b8fe9aafd7adca946531895883
ms.sourcegitcommit: a6873b710ca07eb956d45596d4ec2c1d5dc57353
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/16/2019
ms.locfileid: "68253017"
---
# <a name="troubleshoot-ssis-integration-runtime-management-in-azure-data-factory"></a>Устранение неполадок управления Integration Runtime SSIS в фабрике данных Azure

В этом документе содержатся руководства по устранению неполадок, связанных с управлением Integration Runtime SSIS (службы SSIS IR).

## <a name="overview"></a>Обзор

На портале ADF появится сообщение об ошибке или возвращено командлетом PowerShell, если возникли какие-либо проблемы при подготовке или отмене интеграции служб SSIS IR. Ошибка всегда имеет формат в виде кода ошибки с подробным сообщением об ошибке.

Это означает, что служба имеет несколько временных проблем, если код ошибки — InternalServerError. Вы можете повторить операцию позже. Если повторная попытка не помогает, обратитесь в службу поддержки фабрики данных Azure.

Существуют три основные внешние зависимости, которые могут вызвать ошибки: Сервер или Управляемый экземпляр базы данных SQL Azure, Пользовательский скрипт установки и Конфигурация виртуальной сети, если код ошибки не InternalServerError.

## <a name="azure-sql-database-server-or-managed-instance-issues"></a>Проблемы с сервером базы данных SQL Azure или управляемым экземпляром

Сервер базы данных SQL Azure или Управляемый экземпляр требуется при подготовке служб SSIS IR с базой данных каталога SSIS. Сервер базы данных SQL Azure или Управляемый экземпляр должен быть доступен для среды выполнения интеграции SSIS. Учетная запись сервера базы данных SQL Azure или Управляемый экземпляр должна иметь разрешение на создание базы данных каталога SSIS (SSISDB). Если возникли какие-либо ошибки, на портале ADF будет отображаться код ошибки с подробным сообщением об исключении SQL. Выполните следующие действия, чтобы устранить ошибки в кодах.

### <a name="azuresqlconnectionfailure"></a>азуресклконнектионфаилуре

Эта проблема может возникнуть при подготовке нового IR-порта служб SSIS или во время выполнения IR.

Это может быть вызвано следующими причинами, если вы видите ошибку во время подготовки ИК-связи, и в сообщении об ошибке можно получить подробные сведения о SqlException сообщении.

* Проблемы с сетевым подключением. Убедитесь, что имя узла SQL Server или Управляемый экземпляр доступно, а брандмауэр или NSG блокирует IR для доступа к серверу.
* Ошибка входа в систему, используется проверка подлинности SQL. Это означает, что указанная учетная запись не может войти в SQL Server. Убедитесь, что указана правильная учетная запись пользователя.
* Вход не выполнен, и используется проверка подлинности AAD (управляемое удостоверение). Добавьте управляемое удостоверение фабрики в группу AAD и предоставьте управляемому удостоверению разрешения на доступ к серверу базы данных каталога.
* Время ожидания соединения всегда связано с конфигурацией, связанной с безопасностью. Рекомендуется создать новую виртуальную машину, чтобы виртуальная машина присоединяется к той же виртуальной сети IR, если она находится в виртуальной сети, а затем установите SSMS и проверьте состояние сервера базы данных SQL Azure или Управляемый экземпляр.

Другие проблемы см. в сообщении об ошибке "подробное исключение SQL" и устранении проблемы, указанной в сообщении об ошибке. Если у вас по-прежнему возникают проблемы, обратитесь к серверу базы данных SQL Azure или к группе поддержки Управляемый экземпляр.

Скорее всего, есть некоторые изменения в группе безопасности сети или брандмауэре, если вы видите ошибку во время выполнения IR, что приводит к тому, что узел "IR" служб SSIS не может получить доступ к серверу базы данных SQL Azure или Управляемый экземпляр больше. Разблокируйте узел ИНФРАКРАСной рабочей роли служб SSIS для доступа к серверу базы данных SQL Azure или Управляемый экземпляр.

### <a name="catalogcapacitylimiterror"></a>каталогкапаЦитилимитеррор

Сообщение об ошибке имеет следующий формат: "база данных" SSISDB "достигла квоты на размер. Разбейте или удаляйте данные, удалите индексы или обратитесь к документации, чтобы получить возможные решения ". Возможные решения:
* Увеличьте квоту размера SSISDB.
* Измените конфигурации SSISDB, чтобы уменьшить размер, например:
   * Уменьшение срока хранения и количества версий проекта.
   * Уменьшение срока хранения журнала.
   * Изменение уровня по умолчанию для журнала и т. д.

### <a name="catalogdbbelongstoanotherir"></a>каталогдббелонгстоаносерир

Эта ошибка означает, что на сервере базы данных SQL Azure или Управляемый экземпляр уже имеется SSISDB, созданная и используемая другим IR. Необходимо либо указать другой сервер базы данных SQL Azure или Управляемый экземпляр, либо удалить имеющийся SSISDB и перезапустить новый IR.

### <a name="catalogdbcreationfailure"></a>каталогдбкреатионфаилуре

Эта ошибка может быть вызвана по следующим причинам.

* Учетная запись пользователя, настроенная для среды выполнения интеграции служб SSIS, не имеет разрешения на создание базы данных. Можно предоставить пользователю разрешение на создание базы данных.
* Время ожидания для создания базы данных, например время ожидания выполнения, время ожидания операции с БД и т. д. Вы можете повторить попытку позже, чтобы узнать, решена ли эта ошибка. Если повторная попытка не работает, обратитесь к серверу базы данных SQL Azure или к группе поддержки Управляемый экземпляр.

Для устранения других проблем проверьте сообщение об ошибке SQL Exception и устраните проблему, описанную в сообщении об ошибке. Если у вас по-прежнему возникают проблемы, обратитесь в службу поддержки сервера базы данных SQL Azure или Управляемый экземпляр.

### <a name="invalidcatalogdb"></a>инвалидкаталогдб

Сообщение об ошибке похоже на "Недопустимое имя объекта" Catalog. catalog_properties ".", это означает, что у вас уже есть база данных с именем SSISDB, но она не создана службой SSIS IR, либо база данных находится в недопустимом состоянии, что вызвано ошибками во время последней подготовки служб SSIS IR. Можно удалить существующую базу данных с именем SSISDB или настроить новый сервер базы данных SQL Azure или Управляемый экземпляр для IR.

## <a name="custom-setup"></a>Выборочная установка

Пользовательская установка предоставляет интерфейс для добавления собственных шагов установки во время подготовки или перенастройки службы SSIS IR. Дополнительные сведения см. [в статье Настройка программы установки для среды выполнения интеграции Azure SSIS](https://docs.microsoft.com/azure/data-factory/how-to-configure-azure-ssis-ir-custom-setup).

Убедитесь, что контейнер содержит только необходимые файлы пользовательской установки, так как все файлы в контейнере будут скачаны на узел IR Worker служб SSIS. Рекомендуется протестировать сценарий пользовательской установки на локальном компьютере, чтобы устранить все проблемы, связанные с выполнением скрипта, перед запуском скрипта в службах SSIS IR.

Контейнер скрипта настраиваемой установки будет проверяться при условии, что среда выполнения интеграции служб SSIS является регулярно обновляемой, что требует повторного доступа к контейнеру для загрузки пользовательского скрипта установки и повторной установки. В ходе проверки будет указано, доступен ли контейнер и существует ли главный CMD-файл.

Любая ошибка при использовании пользовательской установки, вы увидите ошибку с кодом Кустомсетупскриптфаилуре, проверьте сообщение об ошибке с кодом подпрограммы.  Выполните следующие действия, чтобы устранить неполадки с кодами вспомогательных ошибок.  

### <a name="customsetupscriptblobcontainerinaccessible"></a>кустомсетупскриптблобконтаинеринакцессибле

Это означает, что служба SSIS IR не может получить доступ к контейнеру больших двоичных объектов Azure для пользовательской установки. Убедитесь, что URI SAS контейнера доступен, и срок его действия не истек.

Если IR находится в запущенном состоянии, отключите IR. перенастройте IR с новым URI SAS контейнера настраиваемой установки, а затем снова запустите IR.

### <a name="customsetupscriptnotfound"></a>кустомсетупскриптнотфаунд

Это означает, что службы SSIS IR не могут найти пользовательский сценарий установки (Main. cmd) в контейнере больших двоичных объектов. Убедитесь, что Main. cmd существует в контейнере, который является точкой входа для выборочной установки установки.

### <a name="customsetupscriptexecutionfailure"></a>кустомсетупскриптексекутионфаилуре

Это означает, что при выполнении сценария пользовательской установки (Main. cmd) произошел сбой, вы можете попробовать выполнить сценарий на локальном компьютере или проверить журналы выполнения пользовательской установки в контейнере больших двоичных объектов.

### <a name="customsetupscripttimeout"></a>кустомсетупскрипттимеаут

Это означает, что время ожидания выполнения сценария пользовательской установки истекло. Убедитесь, что контейнер больших двоичных объектов содержит только необходимые пользовательские файлы установки. Вы также можете проверить журналы выполнения пользовательской установки в контейнере больших двоичных объектов. Максимальный период для пользовательской установки задается через 45 минут до истечения времени ожидания, а максимальный период включает время на загрузку всех файлов из контейнера и их установку на среду SSIS IR. Если требуется более длительный период, создайте запрос в службу поддержки.

### <a name="customsetupscriptloguploadfailure"></a>кустомсетупскриптлогуплоадфаилуре

Это означает, что отправка журналов выполнения пользовательской установки в контейнер больших двоичных объектов завершилась сбоем, так как у службы SSIS IR нет разрешения на запись в контейнер больших двоичных объектов или некоторые проблемы с хранилищем или сетью. Если пользовательская установка выполнена успешно, эта ошибка не влияет на функцию служб SSIS, но журналы отсутствуют. Если пользовательская установка завершилась с другой ошибкой, и мы не можем отправить журнал, мы поможем сообщить об этой ошибке, чтобы журнал можно было отправить для анализа и после устранения этой проблемы мы выпустим указанную проблему. Если после повторной попытки эта проблема не устранена, обратитесь в службу поддержки фабрики данных Azure.

## <a name="virtual-network-configuration"></a>Конфигурация виртуальной сети

При присоединении служб SSIS IR к виртуальной сети она использует виртуальную сеть в подписке пользователя. Дополнительные сведения см. [в статье присоединение среды выполнения интеграции Azure SSIS к виртуальной сети](https://docs.microsoft.com/azure/data-factory/join-azure-ssis-integration-runtime-virtual-network).

При возникновении проблемы, связанной с виртуальной сетью, вы увидите сообщение об ошибке, как показано ниже.

### <a name="invalidvnetconfiguration"></a>инвалидвнетконфигуратион

Это может быть вызвано причинами по вариантам. Выполните следующие действия, чтобы устранить неполадки с кодами вспомогательных ошибок.

### <a name="forbidden"></a>Запрещено

Сообщение об ошибке выглядит следующим образом: "subnetId не включен для текущей учетной записи. Поставщик ресурсов Microsoft. Batch не зарегистрирован в той же подписке виртуальной сети ".

Это означает, что Пакетная служба Azure не может получить доступ к виртуальной сети. Зарегистрируйте поставщик ресурсов Microsoft. Batch в той же подписке, что и виртуальная сеть.

### <a name="invalidpropertyvalue"></a>инвалидпропертивалуе

Сообщение об ошибке выглядит так: "либо указанная виртуальная сеть не существует, либо Пакетная служба не имеет доступа к ней" или "Указанная подсеть XXX не существует".

Это означает, что виртуальная сеть не существует, или Пакетная служба Azure не может получить к ней доступ или указанная подсеть не существует. Убедитесь, что виртуальная сеть и подсети существуют, и пакетная служба Azure может получить к ним доступ.

### <a name="misconfigureddnsserverornsgsettings"></a>мисконфигуредднссерверорнсгсеттингс

Сообщение выглядит так: "не удалось выполнить инициализацию Integration Runtime в виртуальной сети. Если параметры DNS-сервера или NSG настроены, убедитесь, что DNS-сервер доступен и NSG настроен правильно.

Скорее всего, у вас есть настроенная Настройка DNS-сервера или параметров NSG, что приводит к тому, что имя сервера Azure, необходимое для работы служб SSIS IR, не может быть разрешено или недоступно. Дополнительные сведения см. в статье документ [настройки IR-виртуальной сети служб SSIS](https://docs.microsoft.com/azure/data-factory/join-azure-ssis-integration-runtime-virtual-network) . Если у вас по-прежнему возникают проблемы, обратитесь в службу поддержки фабрики данных Azure.

### <a name="vnetresourcegrouplockedduringupgrade"></a>внетресаурцеграуплоккеддурингупграде

Служба SSIS IR будет автоматически обновляться на регулярной основе, а новый пул пакетной службы Azure будет создан во время обновления, а старый пул пакетных служб Azure удаляется, ресурс, связанный с виртуальной сетью для старого пула, будет удален, а новый ресурс, связанный с виртуальной сетью, будет создан в подписчик. Эта ошибка означает, что не удалось удалить ресурс, связанный с виртуальной сетью, для старого пула из-за блокировки удаления на уровне подписки или группы ресурсов. Справка по удалению блокировки удаления.

### <a name="vnetresourcegrouplockedduringstart"></a>внетресаурцеграуплоккеддурингстарт

Подготовка IR для служб SSIS может быть неудачной из-за определенных причин, и если происходит сбой, все созданные ресурсы будут удалены. Однако ресурсы виртуальной сети не удалось удалить из-за блокировки удаления ресурсов на уровне подписки или группы ресурсов. Удалите блокировку удаления и перезапустите IR.

### <a name="vnetresourcegrouplockedduringstop"></a>внетресаурцеграуплоккеддурингстоп

При остановке служб SSIS IR все ресурсы, связанные с виртуальной сетью, будут удалены, но удаление завершилось сбоем из-за блокировки удаления ресурсов на уровне подписки или группы ресурсов. Удалите блокировку удаления и повторите попытку.

### <a name="nodeunavailable"></a>нодеунаваилабле

Эта ошибка возникает во время выполнения инфракрасной связи. Это означает, что ИК-сигнал является работоспособным до и становится неработоспособным. это всегда происходит из-за того, что сервер DNS или Конфигурация NSG изменились и причиной того, что служба SSIS IR не может подключиться к зависимой службе, помогая устранить проблемы конфигурации DNS-сервера или NSG Дополнительные сведения см. в статье [Настройка IR-виртуальной сети служб SSIS](https://docs.microsoft.com/azure/data-factory/join-azure-ssis-integration-runtime-virtual-network). Если у вас по-прежнему возникают проблемы, обратитесь в службу поддержки фабрики данных Azure.
