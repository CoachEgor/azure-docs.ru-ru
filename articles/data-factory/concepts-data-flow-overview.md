---
title: Сопоставление потоков данных
description: Общие сведения о сопоставлении потоков данных в фабрике данных Azure
author: kromerm
ms.author: makromer
ms.reviewer: daperlov
ms.service: data-factory
ms.topic: conceptual
ms.custom: seo-lt-2019
ms.date: 06/09/2020
ms.openlocfilehash: 850879675d4554329f24c86f2ac28660b303084c
ms.sourcegitcommit: 5f7b75e32222fe20ac68a053d141a0adbd16b347
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/31/2020
ms.locfileid: "87475572"
---
# <a name="what-are-mapping-data-flows"></a>Сведения о сопоставлении потоков данных

[!INCLUDE[appliesto-adf-asa-md](includes/appliesto-adf-asa-md.md)]

Сопоставление потоков данных — это визуально спроектированные преобразования данных в фабрике данных Azure. Потоки данных позволяют инженерам данных разрабатывать логику преобразования графических данных без написания кода. Результирующие потоки данных выполняются как действия в конвейерах фабрики данных Azure, использующие кластеры с горизонтальным масштабированием Apache Spark. Действия потока данных могут осуществляться через существующие возможности планирования фабрики данных, управления, потока и мониторинга.

Сопоставление потоков данных обеспечивает полностью визуальный интерфейс без необходимости написания кода. Потоки данных выполняются в кластере выполнения для обработки масштабируемых данных. Фабрика данных Azure обрабатывает все операции перевода кода, оптимизации пути и выполнения заданий потока данных.

![Архитектура](media/data-flow/adf-data-flows.png "Архитектура")

## <a name="getting-started"></a>Начало работы

Чтобы создать поток данных, выберите знак "плюс" в разделе " **ресурсы фабрики**", а затем выберите **поток данных**. 

![Новый поток данных](media/data-flow/newdataflow2.png "новый поток данных")

Это действие выполняет переход к холсту потока данных, где можно создать логику преобразования. Выберите **Добавить источник** , чтобы начать настройку преобразования источника. Дополнительные сведения см. в разделе [Преобразование источника](data-flow-source.md).

## <a name="data-flow-canvas"></a>Холст потока данных

Холст потока данных разделяется на три части: Верхняя панель, диаграмма и панель конфигурации. 

![Элемент Canvas](media/data-flow/canvas1.png "Элемент Canvas")

### <a name="graph"></a>Graph

Граф отображает поток преобразования. Он показывает журнал преобразований источника данных по мере их последовательного в один или несколько приемников. Чтобы добавить новый источник, выберите **Добавить источник**. Чтобы добавить новое преобразование, выберите знак "плюс" в правом нижнем углу существующего преобразования.

![Элемент Canvas](media/data-flow/canvas2.png "Элемент Canvas")

### <a name="azure-integration-runtime-data-flow-properties"></a>Свойства потока данных среды выполнения интеграции Azure

![Кнопка отладки](media/data-flow/debugbutton.png "Кнопка отладки")

После начала работы с потоками данных в ADF необходимо включить параметр "Отладка" для потоков данных в верхней части пользовательского интерфейса браузера. Это позволяет использовать кластер Spark для интерактивной отладки, предварительного просмотра данных и выполнения отладки конвейера. Вы можете задать размер кластера, выбрав пользовательский [Azure Integration Runtime](concepts-integration-runtime.md). Сеанс отладки остается активным до 60 минут после последней предварительной версии данных или выполнения конвейера последней отладки.

Когда вы эксплуатацию конвейеры с действиями потока данных, ADF использует Azure Integration Runtime, связанный с [действием](control-flow-execute-data-flow-activity.md) в свойстве "Запуск в".

Azure Integration Runtime по умолчанию — небольшой кластер однорабочих узлов с четырьмя ядрами, который позволяет просматривать данные и быстро выполнять конвейеры отладки с минимальными затратами. Задайте более крупную конфигурацию Azure IR при выполнении операций с большими наборами данных.

Вы можете указать ADF-файл для поддержки пула ресурсов кластера (ВМ), установив TTL в Azure IR свойства потока данных. Это действие приводит к ускорению выполнения задания для последующих действий.

#### <a name="azure-integration-runtime-and-data-flow-strategies"></a>Среда выполнения интеграции Azure и стратегии потока данных

##### <a name="execute-data-flows-in-parallel"></a>Параллельное выполнение потоков данных

При параллельном выполнении потоков данных в конвейере ADF-файл начинает работать с отдельными кластерами Spark для каждого выполнения действия на основе параметров в Azure Integration Runtime, прикрепленных к каждому действию. Для разработки параллельных выполнений в конвейерах ADF добавьте в пользовательский интерфейс действия потока данных без ограничений очередностью.

Эти три параметра, скорее всего, будут выполняться в кратчайшее время. Однако каждый параллельный поток данных одновременно выполняется в разных кластерах, поэтому упорядочение событий не является детерминированным.

При параллельном запуске действий потока данных внутри конвейеров рекомендуется не использовать TTL. Это действие связано с тем, что параллельное выполнение потока данных с использованием одного и того же Azure Integration Runtime приводит к использованию нескольких экземпляров горячего пула для фабрики данных.

##### <a name="overload-single-data-flow"></a>Перегрузка одного потока данных

Если вся логика помещается в один поток данных, ADF выполняет тот же контекст выполнения задания в одном экземпляре кластера Spark.

Этот вариант может оказаться более трудным для выполнения и устранения неполадок, так как бизнес-правила и бизнес-логика могут быть жумблед вместе. Этот вариант также не обеспечивает существенного повторного использования.

##### <a name="execute-data-flows-sequentially"></a>Последовательно выполнять потоки данных

Если вы выполняете действия потока данных в последовательности в конвейере и установили TTL для конфигурации Azure IR, ADF будет повторно использовать вычислительные ресурсы (ВМ), что приведет к более быстрому последующему времени выполнения. Для каждого выполнения по-прежнему будет получен новый контекст Spark.

Из этих трех вариантов это действие, скорее всего, займет самое длинное время для выполнения сквозной операции. Но он обеспечивает четкое разделение логических операций на каждом шаге потока данных.

### <a name="configuration-panel"></a>Панель конфигурации

На панели конфигурация отображаются параметры, относящиеся к текущему выбранному преобразованию. Если преобразование не выбрано, то отображается поток данных. В общей конфигурации потока данных можно изменить имя и описание на вкладке **Общие** или добавить параметры с помощью вкладки **Параметры** . Дополнительные сведения см. в разделе [Сопоставление параметров потока данных](parameters-data-flow.md).

Каждое преобразование содержит по крайней мере четыре вкладки конфигурации.

#### <a name="transformation-settings"></a>Параметры преобразования

Первая вкладка в области конфигурации каждого преобразования содержит параметры, относящиеся к этому преобразованию. Дополнительные сведения см. на странице документации по преобразованию.

![Вкладка "Параметры источника"](media/data-flow/source1.png "Вкладка "Параметры источника"")

#### <a name="optimize"></a>Оптимизация

Вкладка **Оптимизация** содержит параметры для настройки схем секционирования. Чтобы узнать больше о том, как оптимизировать потоки данных, см. [руководство по повышению производительности потока данных сопоставления](concepts-data-flow-performance.md).

![Optimize](media/data-flow/optimize.png "Оптимизация") (Оптимизация)

#### <a name="inspect"></a>Изучение

На вкладке **Проверка** представлено представление метаданных потока данных, для которого выполняется преобразование. Можно увидеть количество столбцов, изменить столбцы, добавить столбцы, типы данных, порядок столбцов и ссылки на столбцы. **Проверка** — это представление метаданных, доступное только для чтения. Для просмотра метаданных в области **проверки** не нужно включать режим отладки.

![Проверить](media/data-flow/inspect1.png "Изучение")

При изменении формы данных с помощью преобразований в области **проверки** будут отображаться потоки изменений метаданных. Если в преобразовании источника не определена схема, метаданные не будут отображаться в области **проверки** . Отсутствие метаданных является распространенным в сценариях смещения схемы.

#### <a name="data-preview"></a>Предварительный просмотр данных

Если режим отладки включен, вкладка **Предварительный просмотр данных** предоставляет интерактивный моментальный снимок данных при каждом преобразовании. Дополнительные сведения см. [в разделе Предварительный просмотр данных в режиме отладки](concepts-data-flow-debug-mode.md#data-preview).

### <a name="top-bar"></a>Верхняя панель

Верхняя панель содержит действия, влияющие на весь поток данных, например сохранение и проверку. Можно также переключаться между режимами графика и конфигурации с помощью кнопок **Показать диаграмму** и **Скрыть граф** .

![Скрытие графика](media/data-flow/hideg.png "Скрытие графика")

Если скрыть диаграмму, вы сможете просматривать узлы преобразования позже с помощью кнопок **назад** и **Далее** .

![Кнопки «назад» и «далее»](media/data-flow/showhide.png "кнопки «назад» и «далее»")

## <a name="next-steps"></a>Дальнейшие действия

* Узнайте, как создать [Преобразование источника](data-flow-source.md).
* Узнайте, как создавать потоки данных в [режиме отладки](concepts-data-flow-debug-mode.md).
