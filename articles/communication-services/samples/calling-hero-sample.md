---
title: Пример функции группового вызова
titleSuffix: An Azure Communication Services sample overview
description: Сведения о принципе работы примера функции группового вызова с использованием Служб коммуникации Azure для разработчиков.
author: ddematheu
manager: nimag
services: azure-communication-services
ms.author: dademath
ms.date: 07/20/2020
ms.topic: overview
ms.service: azure-communication-services
ms.openlocfilehash: caee5686695594604f49dcbade54342a9134abc0
ms.sourcegitcommit: 53acd9895a4a395efa6d7cd41d7f78e392b9cfbe
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/22/2020
ms.locfileid: "90945460"
---
# <a name="get-started-with-the-group-calling-hero-sample"></a>Начало работы с примером функции группового вызова

[!INCLUDE [Public Preview Notice](../includes/public-preview-include.md)]

<!----
> [!WARNING]
> Add links to our Hero Sample repo when the sample is publicly available.
---->

Пример **Group Calling Hero Sample** Служб коммуникации Azure демонстрирует, как использовать клиентскую библиотеку веб-вызовов Служб коммуникации для создания группового вызова.

Из краткого руководства мы узнаем, как работает пример и запустим его на локальном компьютере. Затем мы развернем пример в Azure с помощью собственных ресурсов Служб коммуникации Azure.

> [!IMPORTANT]
> [Скачайте пример с GitHub.](https://github.com/Azure/Communication/tree/master/samples)

## <a name="overview"></a>Обзор

Пример содержит клиентское и серверное приложения. **Клиентское приложение** — это веб-приложение React/Redux, использующее платформу пользовательского интерфейса Fluent от Майкрософт. Это приложение отправляет запросы в **серверное приложение** ASP.NET Core, которое помогает клиентскому приложению подключаться к Azure. 

Вот как выглядит этот пример:

:::image type="content" source="./media/calling/landing-page.png" alt-text="Снимок экрана: целевая страница примера приложения.":::

При нажатии кнопки "Start a call" (Начать вызов) веб-приложение получает маркер доступа пользователя из серверного приложения. Затем этот маркер используется для подключения клиентского приложения к Службам коммуникации Azure. После получения маркера вам будет предложено указать камеру и микрофон, которые вы хотите использовать. Вы сможете отключать и включать устройства с помощью переключателей.

:::image type="content" source="./media/calling/pre-call.png" alt-text="Снимок экрана: экран примера приложения перед звонком.":::

Настройте отображаемое имя и устройства, а затем присоединитесь к сеансу вызова. Теперь вы увидите основной холст с основными возможностями вызова.

:::image type="content" source="./media/calling/main-app.png" alt-text="Снимок экрана: главный экран примера приложения.":::

Ниже перечислены компоненты главного экрана вызова.

- **Коллекция мультимедиа.** Основная область, в которой отображаются участники. Если у участника есть камера и она включена, здесь отображается видеопоток. Для каждого участника создается отдельная плитка, на которой отображаются его отображаемое имя и видеопоток (если он есть).
- **Заголовок**: Здесь находятся основные элементы управления звонками, которые позволяют включать и отключать боковую панель с параметрами и участниками, включать и отключать видео и смешение, а также предоставлять экран в общий доступ и покидать вызов.
- **Боковая панель.** Здесь отображаются участники и сведения о параметрах при переключении с помощью элементов управления в заголовке. Этот компонент можно закрыть, щелкнув "X" в правом верхнем углу. На боковой панели с участниками отображается список участников и ссылка для приглашения в чат дополнительных пользователей. Боковая панель с параметрами позволяет настроить параметры микрофона и камеры.

Ниже перечислены предварительные требования, инструкции по настройке примера и пошаговые руководства для ознакомления с его компонентами.

## <a name="prerequisites"></a>Предварительные требования

- Создайте учетную запись Azure с активной подпиской. Дополнительные сведения см. в разделе [Создание учетной записи бесплатно](https://azure.microsoft.com/free/?WT.mc_id=A261C142F).
- [Node.js (12.18.4 и более поздние версии).](https://nodejs.org/en/download/)
- [Visual Studio (2019 и более поздние версии).](https://visualstudio.microsoft.com/vs/)
- [.NET Core 2.2](https://dotnet.microsoft.com/download/dotnet-core/2.2) (установите 32- или 64-разрядную версию в соответствии с экземпляром Visual Studio).
- Создайте ресурс Служб коммуникации Azure. Дополнительные сведения см. в статье [Краткое руководство по созданию ресурсов Служб коммуникации и управлению ими](../quickstarts/create-communication-resource.md). Для этого краткого руководства необходимо записать **строку подключения** к ресурсу.

## <a name="locally-deploy-the-service--client-applications"></a>Локальное развертывание клиентского приложения и приложения службы

Пример группового вызова по сути состоит из двух приложений: ClientApp и Service.NET.

Если мы хотим создать развертывание в локальной среде, нам нужно запустить оба приложения. При входе в серверное приложение с помощью браузера для взаимодействия с пользователем будет использоваться локально развернутое клиентское приложение ClientApp.

Вы можете проверить пример локально, открыв несколько сеансов браузера с URL-адресом вызова, чтобы имитировать вызов с несколькими пользователями.

### <a name="before-running-the-sample-for-the-first-time"></a>Действия перед первым запуском примера

1. Откройте экземпляр PowerShell, Терминал Windows, командную строку или аналогичную среду и перейдите к каталогу, в который вы хотите клонировать пример.
2. `git clone`
3. Перейдите в папку **Calling/ClientApp** и выполните `npm run setup`.
   1. Если отображается сообщение об ошибке 1, найдите в представленных выше выходных данных URL-адрес, по которому нужно перейти для авторизации клиента. (Этот URL-адрес имеет такой вид: `app.vssps.visualstudio.com/oauth2/authorize?clientid=...`.) Перейдя по URL-адресу в браузере, скопируйте команду из окна браузера и выполните ее.
   2. Снова выполните команду `npm run setup-vsts-auth` после завершения предыдущего шага.
4. Получите `Connection String` на портале Azure. Дополнительные сведения о строках подключения см. в статье [Создание ресурсов Служб коммуникации Azure и управление ими](../quickstarts/create-communication-resource.md).
5. Получив строку подключения, добавьте ее в файл **Calling/appsetting.json**, который расположен в папке .NET службы. Сохраните строку подключения в переменную: `ResourceConnectionString`.

### <a name="local-run"></a>Запуск в локальной среде

1. Перейдите к папке Calling.
2. Откройте решение `Calling.csproj` в Visual Studio.
2. Запустите проект `Calling`*.

* Браузер откроет страницу по адресу `localhost:5000` (где узел разворачивает клиентское приложение). Приложение не поддерживается в Internet Explorer.

#### <a name="troubleshooting"></a>Диагностика

- Решение не компилируется, а выдает ошибки во время установки или сборки NPM.

   Попробуйте очистить и перестроить проекты.

## <a name="publish-the-sample-to-azure"></a>Публикация примера в Azure

1. Щелкните правой кнопкой мыши проект `Calling` и выберите команду "Опубликовать".
2. Создайте профиль публикации и выберите подписку Azure.
3. Перед публикацией добавьте строку подключения с `Edit App Service Settings`, а затем укажите `ResourceConnectionString` в качестве ключа и строку подключения (скопированную из appsettings.json) в качестве значения.

## <a name="clean-up-resources"></a>Очистка ресурсов

Если вы хотите очистить и удалить подписку на Службы коммуникации, вы можете удалить ресурс или группу ресурсов. При этом удаляются все ресурсы, связанные с ней. См. сведения об [очистке ресурсов](../quickstarts/create-communication-resource.md#clean-up-resources).

## <a name="next-steps"></a>Дальнейшие действия

Дополнительные сведения см. в следующих статьях:

- Изучите, как правильно [использовать клиентскую библиотеку вызовов](../quickstarts/voice-video-calling/calling-client-samples.md).
- Изучите [возможности клиентской библиотеки для вызовов](../quickstarts/voice-video-calling/calling-client-samples.md).
- Узнайте больше о [принципе работы функции вызовов](../concepts/voice-video-calling/about-call-types.md).

## <a name="additional-reading"></a>Дополнительные материалы

- [Предварительная версия Служб коммуникации Azure](https://github.com/Azure/communication-preview) — дополнительные сведения о веб-пакете SDK для вызовов.
- [Redux](https://redux.js.org/) — управление состоянием на стороне клиента.
- [FluentUI](https://developer.microsoft.com/fluentui#/) — библиотека пользовательского интерфейса, поддерживаемая корпорацией Майкрософт.
- [React](https://reactjs.org/) — библиотека для создания пользовательских интерфейсов.
- [ASP.NET Core](https://docs.microsoft.com/aspnet/core/introduction-to-aspnet-core?view=aspnetcore-3.1&preserve-view=true) — платформа для создания веб-приложений.
