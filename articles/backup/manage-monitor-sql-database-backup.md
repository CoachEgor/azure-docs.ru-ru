---
title: Управление и мониторинг баз данных SQL Server на виртуальной Машине Azure, подвергаемого резервному копированию службой Azure Backup | Документация Майкрософт
description: В этой статье описывается, как управлять и отслеживать работу баз данных SQL Server, работающих под управлением на виртуальной Машине Azure.
services: backup
author: rayne-wiselman
manager: carmonm
ms.service: backup
ms.topic: conceptual
ms.date: 03/14/2018
ms.author: raynew
ms.openlocfilehash: d850cb222b0028f862cdba302140ce12af8576db
ms.sourcegitcommit: d4dfbc34a1f03488e1b7bc5e711a11b72c717ada
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/13/2019
ms.locfileid: "66492743"
---
# <a name="manage-and-monitor-backed-up-sql-server-databases"></a>Мониторинг резервных копий баз данных SQL Server и управление ими

В этой статье описаны распространенные задачи, для мониторинга баз данных SQL Server, запущенных на виртуальной машине Azure (VM) и, резервные копии создаются на архивации служб восстановления Azure и управления ими хранилища с [Azure Backup](backup-overview.md) службы. Вы узнаете, как мониторинг заданий и оповещений, остановить и возобновить защиту базы данных, выполнения заданий резервного копирования и Отмена регистрации виртуальной Машины из резервных копий.

Если вы еще не настроили резервные копии баз данных SQL Server, см. в разделе [резервное копирование баз данных SQL Server на виртуальных машинах Azure](backup-azure-sql-database.md)

## <a name="monitor-manual-backup-jobs-in-the-portal"></a>Отслеживать выполняемые вручную задания резервного копирования на портале

Служба архивации Azure отображаются все задания, запускаемые вручную в **задания резервного копирования** портала. Задания, см. в этом портала включить обнаружение баз данных и регистрации и резервного копирования и восстановления.

![На портале заданий резервного копирования](./media/backup-azure-sql-database/jobs-list.png)

> [!NOTE]
> **Задания резервного копирования** портал не отображает запланированные задания резервного копирования. Используйте SQL Server Management Studio для отслеживания запланированных заданий резервного копирования, как описано в следующем разделе.
>

Сведения о сценарии мониторинга, см. в статье [мониторинга на портале Azure](backup-azure-monitoring-built-in-monitor.md) и [мониторинг с помощью Azure Monitor](backup-azure-monitoring-use-azuremonitor.md).  


## <a name="view-backup-alerts"></a>Просмотр оповещений о резервном копировании

Так как резервные копии журналов создаются каждые 15 минут, мониторинг заданий резервного копирования может быть утомительным. Служба архивации Azure упрощает мониторинг путем отправки оповещений по электронной почте. Оповещения по электронной почте:

- Инициировано для всех ошибок резервного копирования.
- Консолидированные на уровне базы данных с кодом ошибки.
- Отправляются только для первого сбоя резервного копирования базы данных.

Чтобы отслеживать оповещения о резервном копировании базы данных:

1. Войдите на [портале Azure](https://portal.azure.com).

2. На панели мониторинга хранилища выберите **Предупреждения и события**.

   ![Выбор "Alerts and Events" (Оповещения и события)](./media/backup-azure-sql-database/vault-menu-alerts-events.png)

3. В области **Предупреждения и события** выберите **Оповещения, связанные с архивацией**.

   ![Выбор "Оповещения, связанные с архивацией"](./media/backup-azure-sql-database/backup-alerts-dashboard.png)

## <a name="stop-protection-for-a-sql-server-database"></a>Остановка защиты базы данных SQL Server

Вы можете остановить создание резервных копий базы данных SQL Server двумя способами:

* остановить все будущие задания резервного копирования и удалить все точки восстановления;
* Остановить все будущие операции резервного копирования и сохранить точки восстановления без изменений.

Если вы решили сохранить точки восстановления, учитывайте следующие сведения:

* Все точки восстановления не будут затронуты неограниченно долго, все очистки должен остановиться остановить защиту хранящихся данных.
* Вам будет взиматься плата за защищенный экземпляр и использованный объем хранилища. Дополнительные сведения см. в разделе [цены на Azure Backup](https://azure.microsoft.com/pricing/details/backup/).
* При удалении источника данных без остановки резервного копирования, новое резервное копирование завершится ошибкой.

Чтобы остановить защиту базы данных, выполните следующие действия.

1. На панели мониторинга хранилища выберите **архивные элементы**.

2. В разделе **типом управления архивацией**выберите **SQL на виртуальной Машине Azure**.

    ![Выбор "SQL in Azure VM" (SQL на виртуальной машине Azure)](./media/backup-azure-sql-database/sql-restore-backup-items.png)

3. Выберите базу данных, для которой нужно остановить защиту.

    ![Выбор базы данных для остановки защиты](./media/backup-azure-sql-database/sql-restore-sql-in-vm.png)

4. В меню базы данных выберите **Остановить архивацию**.

    ![Выбор "Остановить архивацию"](./media/backup-azure-sql-database/stop-db-button.png)


5. На **остановить архивацию** меню, выберите, следует ли сохранить или удалить данные. Если требуется, укажите причину и комментарий.

    ![Сохранить или удалить данные в меню остановки резервного копирования](./media/backup-azure-sql-database/stop-backup-button.png)

6. Выберите **остановить архивацию**.

>
> [!NOTE]
См. ниже дополнительные сведения о вариант удаления данных: часто задаваемые вопросы: <br/>
* [Если удалить базу данных из экземпляра autoprotected, что произойдет с резервные копии?](faq-backup-sql-server.md#if-i-delete-a-database-from-an-autoprotected-instance-what-will-happen-to-the-backups)<br/>
* [Когда я останавливаю операции резервного копирования базы данных autoprotected каким будет ее поведение?](faq-backup-sql-server.md#if-i-change-the-name-of-the-database-after-it-has-been-protected-what-will-be-the-behavior)
>
>


## <a name="resume-protection-for-a-sql-database"></a>возобновление защиты базы данных SQL;

При остановке защиты для базы данных SQL, при выборе **данные резервного копирования** параметр, можно позднее возобновить защиту. Если вы не сохраните резервные копии данных, не удается возобновить защиту.

Для возобновления защиты для базы данных SQL:

1. Откройте элемент резервного копирования и выберите **возобновить резервное копирование**.

    ![Выбор "Возобновить резервное копирование" для возобновления защиты базы данных](./media/backup-azure-sql-database/resume-backup-button.png)

2. В меню **Политика архивации** выберите политику и нажмите кнопку **Сохранить**.

## <a name="run-an-on-demand-backup"></a>Выполнение резервного копирования по требованию

Вы можете выполнить различные типы резервного копирования по требованию:

* Полная резервная копия
* полная резервная копия (только копирование);
* разностная резервная копия;
* Резервное копирование журналов

Вам нужно указать длительность хранения для полных резервных копий только для копирования, диапазон хранения для других типов резервных копий автоматически присваивается 30 дней от текущего времени. <br/>
Дополнительные сведения см. в разделе [типы резервного копирования SQL Server](backup-architecture.md#sql-server-backup-types).

## <a name="unregister-a-sql-server-instance"></a>Отмена регистрации экземпляра SQL Server

После отключения защиты, но прежде чем удалить хранилище, зарегистрировать экземпляр SQL Server:

1. На панели мониторинга хранилища в разделе **управление**выберите **инфраструктура резервного копирования**.  

   ![Выбор "Инфраструктура резервного копирования"](./media/backup-azure-sql-database/backup-infrastructure-button.png)

2. В разделе **Серверы управления** выберите **Защищенные серверы**.

   ![Выбор "Защищенные серверы"](./media/backup-azure-sql-database/protected-servers.png)

3. В меню **Защищенные серверы** выберите сервер, для которого необходимо отменить регистрацию. Чтобы удалить хранилище, необходимо отменить регистрацию всех серверов.

4. Щелкните правой кнопкой мыши на защищенном сервере и выберите **Unregister**.

   ![Выбор "Удалить"](./media/backup-azure-sql-database/delete-protected-server.jpg)

## <a name="re-register-extension-on-the-sql-server-vm"></a>Повторно зарегистрировать расширение на виртуальной Машине SQL Server

В некоторых случаях расширение рабочей нагрузки на виртуальной Машине, может получить так по той или другой. В таком случае все операции на виртуальной Машине будет давать сбой. Вам может потребоваться повторно зарегистрировать расширение на виртуальной Машине. **Повторно зарегистрируйте** операции переустановит его рабочей нагрузки резервного копирования на виртуальной Машине для операций продолжить.  <br>

Рекомендуется использовать этот параметр с осторожностью. При запуске на виртуальной Машине с расширением уже работоспособное, эта операция приведет к расширение, чтобы получить перезапуска. Это может привести все задания выполняется переход на другой. Сбое проверьте для одного или нескольких [Симптомы](backup-sql-server-azure-troubleshoot.md#symptoms) перед запуском операции повторной регистрации.

## <a name="next-steps"></a>Дальнейшие действия

Дополнительные сведения см. в разделе [Устранение неполадок резервного копирования в базе данных SQL Server](backup-sql-server-azure-troubleshoot.md).
