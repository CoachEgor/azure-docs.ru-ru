---
title: Часто задаваемые вопросы - Резервное копирование баз данных серверов S'L на M-подобии Azure
description: Найдите ответы на распространенные вопросы о резервном копировании баз данных сервера S'L на MMs Azure с помощью резервного копирования Azure.
ms.reviewer: vijayts
ms.topic: conceptual
ms.date: 04/23/2019
ms.openlocfilehash: a973761bf16e2d271d718e4a8b29e08624276987
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "79247713"
---
# <a name="faq-about-sql-server-databases-that-are-running-on-an-azure-vm-backup"></a>Часто задаваемые вопросы о базах данных сервера S'L, работающих на резервном копировании Azure VM

В этой статье ответы на общие вопросы о резервном копировании баз данных сервера S'L Server, которые работают на виртуальных машинах Azure (VM) и используют службу [резервного копирования Azure.](backup-overview.md)

## <a name="can-i-use-azure-backup-for-iaas-vm-as-well-as-sql-server-on-the-same-machine"></a>Могу ли я использовать резервное копирование Azure для IaaS VM, а также сервера S'L на той же машине?

Да, вы можете иметь как резервное копирование VM, так и резервное копирование S'L на одном и том же VM. В этом случае мы внутренне запускаем копию только полную резервную копию на VM, чтобы не усеивать журналы.

## <a name="does-the-solution-retry-or-auto-heal-the-backups"></a>Ли решение повторить или автоматического исцеления резервных ups?

При некоторых случаях служба резервного копирования Azure запускает резервные копирования исправлений. Авто-исцеление может произойти для любого из шести условий, упомянутых ниже:

- Если резервное копирование журнала или дифференциала завершается неудачей из-за ошибки проверки LSN, следующий журнал или резервное копирование дифференциала вместо этого преобразуется в полное резервное копирование.
- Если полная резервная копия не произошла до создания журнала или дифференциала, то резервное копирование журнала или дифференциала вместо этого преобразуется в полное резервное копирование.
- Если точка последнего резервного копирования старше 15 дней старше 15 дней, следующий журнал или резервное копирование дифференциала вместо этого преобразуется в полное резервное копирование.
- Все задания резервного копирования, которые отменяются из-за обновления расширения, повторно срабатывают после завершения обновления и запуска расширения.
- Если вы решите перезаписать базу данных во время восстановления, следующий журнал / дифференциальный резервного копирования не удается, и полное резервное копирование срабатывает вместо.
- В тех случаях, когда требуется полное резервное копирование для сбросить цепочки журналов из-за изменения модели восстановления базы данных, полный вызов автоматически запускается в следующем графике.

Авто-исцеление как возможность включена для всех пользователей по умолчанию; Однако в случае, если вы решите отказаться от него, а затем выполнить ниже:

- В экземпляре сервера S'L в папке *C:'Program Files-Azure Workload Backup-bin* создайте или отодвинетфайлный файл **ExtensionSettingsOverrides.json.**
- В **ExtensionSettingsOverrides.json**, набор *"EnableAutoHealer": ложный .*
- Сохраните изменения и закройте файл.
- В экземпляре сервера S'L откройте **службу управления задачами,** а затем перезапустите службу **AzureWLBackUpCoordinatorSvc.**

## <a name="can-i-control-how-many-concurrent-backups-run-on-the-sql-server"></a>Могу ли я контролировать, сколько одновременных резервных ups, запускаемых на сервере S'L?

Да. Вы можете регулировать частоту, с которой выполняется политика резервного копирования, чтобы свести к минимуму влияние на экземпляр SQL Server. Чтобы изменить этот параметр:

1. В экземпляре сервера S'L в папке *C:'Program Files-Azure Workload Backup-bin* создайте файл *ExtensionSettingsOverrides.json.*
2. В файле *ExtensionSettingsOverrides.json* измените настройку **По умолчаниюBackupTasksThreshold** на более низкое значение (например, 5). <br>
  `{"DefaultBackupTasksThreshold": 5}`
<br>
Значение по умолчанию по умолчанию DefaultBackupTasksThreshold составляет **20**.

3. Сохраните изменения и закройте файл.
4. На экземпляре SQL Server откройте **диспетчер задач**. Перезагрузите службу **AzureWLBackupCoordinatorSvc**.<br/> <br/>
 Хотя этот метод помогает, если приложение резервного копирования потребляет большое количество ресурсов, s'L Server [Resource Governor](https://docs.microsoft.com/sql/relational-databases/resource-governor/resource-governor?view=sql-server-2017) является более общим способом указать ограничения на количество процессора, физического итогового и входящего запроса, которые могут использоваться входящими запросами приложений.

> [!NOTE]
> В UX вы все еще можете идти вперед и планировать столько резервных копирования в любой момент времени, однако они будут обрабатываться в раздвижном окне, скажем, 5, в том, в приведенном выше примере.

## <a name="can-i-run-a-full-backup-from-a-secondary-replica"></a>Можно ли запустить полное резервное копирование из вторичной реплики?

В соответствии с ограничениями S'L можно запустить копию только полной резервной копии на вторичной реплике; однако полная резервная часть не допускается.

## <a name="can-i-protect-availability-groups-on-premises"></a>Могу ли я защитить группы доступности в помещениях?

Нет. Резервное копирование Azure защищает базы данных серверов S'L Server, работающие в Azure. Если группа доступности (AG) распределена между Azure и припредски, AG может быть защищена только в том случае, если основная реплика работает в Azure. Кроме того, резервное копирование Azure защищает только узлы, которые работают в том же регионе Azure, что и хранилище служб восстановления.

## <a name="can-i-protect-availability-groups-across-regions"></a>Можно ли защитить группы доступности в разных регионах?

Хранилище служб восстановления резервного копирования Azure может обнаруживать и защищать все узлы, намиевающиеся в той же области, что и хранилище. Если группа s'L Server Always On availability охватывает несколько областей Azure, навяжжьте резервное копирование из региона с основным узелом. Azure Backup может обнаруживать и защищать все базы данных в группе доступности в соответствии с установленным параметром резервного копирования. Когда ваши предпочтения резервного копирования не выполнены, резервные ожидания не сбой, и вы получите отказ оповещения.

## <a name="do-successful-backup-jobs-create-alerts"></a>Отправляются ли оповещения об успешно выполненных заданиях резервного копирования?

Нет. Для успешно выполненных заданий резервного копирования не создаются оповещения. Оповещения отправляются только в случае сбоя. Подробное поведение для уведомлений портала задокументировано [здесь](backup-azure-monitoring-built-in-monitor.md). Однако, если вы заинтересованы есть оповещения даже для успешной работы, вы можете использовать [мониторинг с помощью Azure Monitor](backup-azure-monitoring-use-azuremonitor.md).

## <a name="can-i-see-scheduled-backup-jobs-in-the-backup-jobs-menu"></a>Могу ли я видеть запланированные задания резервного копирования в меню резервных заданий?

Меню **«Работа резервного копирования»** будет отображаться только по требованию задания резервного копирования. Для планового использования рабочих мест [Мониторинг с помощью Azure Monitor](backup-azure-monitoring-use-azuremonitor.md).

## <a name="are-future-databases-automatically-added-for-backup"></a>Добавляются ли автоматически будущие базы данных в резервное копирование?

Да, вы можете достичь этой возможности с [автоматической защитой.](backup-sql-server-database-azure-vms.md#enable-auto-protection)  

## <a name="if-i-delete-a-database-from-an-autoprotected-instance-what-will-happen-to-the-backups"></a>Если я удалю базу данных из авторидарного экземпляра, что произойдет с резервными ожиданиями?

Если база данных удалена из автоматическо защищенного экземпляра, резервное копирование базы данных по-прежнему пытается. Это означает, что удаленная база данных начинает отображаться как неработоспособная под **элементами резервного копирования** и по-прежнему защищена.

Правильный способ остановить защиту этой базы данных — сделать **Stop Backup** с **удалением данных** в этой базе данных.  

## <a name="if-i-do-stop-backup-operation-of-an-autoprotected-database-what-will-be-its-behavior"></a>Если я остановиоперацию резервной системой автоматической базы данных, каково будет ее поведение?

Если вы **прекратите резервное копирование с сохранением данных,** никаких будущих резервных upups не будет происходить, и существующие точки восстановления останутся нетронутыми. База данных по-прежнему будет считаться защищенной и отображаться под **элементами резервного копирования.**

Если вы **прекратите резервное копирование с удалением данных,** никаких будущих резервных upups не будет иметь место, и существующие точки восстановления также будут удалены. База данных будет считаться незащищенной и отображаться в экземпляре в резервной базе Configure. Однако, в отличие от других защищенных баз данных, которые могут быть выбраны вручную или которые могут быть автоматически защищены, эта база данных выглядит серой и не может быть выбрана. Единственный способ повторно защитить эту базу данных — отключить автоматическую защиту на экземпляре. Теперь вы можете выбрать эту базу данных и настроить защиту на ней или повторно включить автоматическую защиту на экземпляре снова.

## <a name="if-i-change-the-name-of-the-database-after-it-has-been-protected-what-will-be-the-behavior"></a>Если я изменю название базы данных после того, как она была защищена, каково будет поведение?

Переименованная база данных рассматривается как новая база данных. Таким образом, служба будет рассматривать эту ситуацию, как если бы база данных не была найдена и с отказом резервных upups.

Можно выбрать базу данных, которая теперь переименована, и настроить защиту на ней. В случае включения автоматической защиты в экземпляре переименованная база данных будет автоматически обнаружена и защищена.

## <a name="why-cant-i-see-an-added-database-for-an-autoprotected-instance"></a>Почему я не могу увидеть добавленную базу данных для автозащищенного экземпляра?

База данных, [добавленная в автоматически защищенный экземпляр,](backup-sql-server-database-azure-vms.md#enable-auto-protection) может не сразу появиться под защищенными элементами. Это обусловлено тем, что обнаружение обычно выполняется раз в 8 часов. Тем не менее, вы можете обнаружить и защитить новые базы данных немедленно, если вы вручную запустите открытие, выбрав **Rediscover DBs**, как показано на следующем изображении:

  ![Вручную откройте для себя недавно добавленную базу данных](./media/backup-azure-sql-database/view-newly-added-database.png)

## <a name="next-steps"></a>Дальнейшие действия

Узнайте, как [создать резервную резервную связь в базе данных сервера S'L Server,](backup-azure-sql-database.md) работая на VM Azure.
