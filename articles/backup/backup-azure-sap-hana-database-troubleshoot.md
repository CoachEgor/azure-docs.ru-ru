---
title: Устранение ошибок резервного копирования SAP HANA баз данных
description: Описание способов устранения распространенных ошибок, которые могут возникнуть при использовании Azure Backup для резервного копирования SAP HANA баз данных.
ms.topic: conceptual
ms.date: 11/7/2019
ms.openlocfilehash: b4c39c631963a358dcdc9d1eafe954a85a9499ad
ms.sourcegitcommit: 428fded8754fa58f20908487a81e2f278f75b5d0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/27/2019
ms.locfileid: "74554857"
---
# <a name="troubleshoot-backup-of-sap-hana-databases-on-azure"></a>Устранение неполадок резервного копирования баз данных SAP HANA в Azure

В этой статье содержатся сведения об устранении неполадок при резервном копировании баз данных SAP HANA на виртуальных машинах Azure. Дополнительные сведения о сценариях резервного копирования SAP HANA, которые сейчас поддерживаются, см. в разделе [Поддержка сценариев](sap-hana-backup-support-matrix.md#scenario-support).

## <a name="prerequisites-and-permissions"></a>Необходимые условия и разрешения

Дополнительные сведения см. в разделах [Предварительные требования](tutorial-backup-sap-hana-db.md#prerequisites) и [Настройка разрешений](tutorial-backup-sap-hana-db.md#setting-up-permissions) перед настройкой резервных копий.

## <a name="common-user-errors"></a>Распространенные ошибки пользователей

###  <a name="usererrorinopeninghanaodbcconnection"></a>усерерроринопенингханаодбкконнектион 

| Сообщение об ошибке      | Не удалось подключиться к системе HANA                             |
| ------------------ | ------------------------------------------------------------ |
| Возможные причины    | Возможно, экземпляр SAP HANA не работает.<br/>Не заданы необходимые разрешения для службы архивации Azure для взаимодействия с базой данных HANA. |
| Рекомендуемое действие | Проверьте, работает ли SAP HANAная база данных. Если база данных запущена и работает, проверьте, установлены ли все необходимые разрешения. Если какие либо разрешения отсутствуют, запустите сценарий с [предрегистрацией](https://aka.ms/scriptforpermsonhana) , чтобы добавить недостающие разрешения. |

###  <a name="usererrorhanainstancenameinvalid"></a>усереррорханаинстанценамеинвалид 

| Сообщение об ошибке      | Указанный экземпляр SAP HANA является недопустимым или не может быть найден |
| ------------------ | ------------------------------------------------------------ |
| Возможные причины    | Невозможно создать резервную копию нескольких экземпляров SAP HANA на одной виртуальной машине Azure. |
| Рекомендуемое действие | Запустите [скрипт с предрегистрацией](https://aka.ms/scriptforpermsonhana) на экземпляре SAP Hana, для которого необходимо создать резервную копию. Если проблема сохраняется, обратитесь в службу поддержки Майкрософт. |

###  <a name="usererrorhanaunsupportedoperation"></a>UserErrorHanaUnsupportedOperation 

| Сообщение об ошибке      | Указанная операция SAP HANA не поддерживается             |
| ------------------ | ------------------------------------------------------------ |
| Возможные причины    | Служба архивации Azure для SAP HANA не поддерживает добавочное резервное копирование и действия, выполняемые на SAP HANA собственных клиентах (Studio, панели или панели администратора) |
| Рекомендуемое действие | Дополнительные сведения см. [здесь](https://docs.microsoft.com/azure/backup/sap-hana-backup-support-matrix#scenario-support). |

###  <a name="usererrorhanapodoesnotsupportbackuptype"></a>усереррорханаподоеснотсуппортбаккуптипе 

| Сообщение об ошибке      | Эта база данных SAP HANA не поддерживает запрошенный тип резервного копирования |
| ------------------ | ------------------------------------------------------------ |
| Возможные причины    | Служба архивации Azure не поддерживает добавочное резервное копирование и резервное копирование с помощью моментальных снимков |
| Рекомендуемое действие | Дополнительные сведения см. [здесь](https://docs.microsoft.com/azure/backup/sap-hana-backup-support-matrix#scenario-support). |

###  <a name="usererrorhanalsnvalidationfailure"></a>усереррорханалснвалидатионфаилуре 

| Сообщение об ошибке      | Цепочка журналов резервного копирования разорвана                                   |
| ------------------ | ------------------------------------------------------------ |
| Возможные причины    | Возможно, расположение резервной копии журнала было изменено с backint) создание на файловую систему, либо backint) создание исполняемый файл |
| Рекомендуемое действие | Активация полной резервной копии для устранения проблемы                   |

###  <a name="usererrorincomaptiblesrctargetsystsemsforrestore"></a>усерерроринкомаптиблесрктаржетсистсемсфорресторе 

| Сообщение об ошибке      | Исходная и Целевая системы для восстановления несовместимы   |
| ------------------ | ------------------------------------------------------------ |
| Возможные причины    | Целевая система для восстановления несовместима с источником |
| Рекомендуемое действие | Дополнительные сведения о типах восстановления, поддерживаемых сегодня, см. в примечании SAP [1642148](https://launchpad.support.sap.com/#/notes/1642148) . |

###  <a name="usererrorsdctomdcupgradedetected"></a>усереррорсдктомдкупградедетектед 

| Сообщение об ошибке      | Обнаружено обновление SDC до MDC                                  |
| ------------------ | ------------------------------------------------------------ |
| Возможные причины    | Экземпляр SAP HANA был обновлен с SDC до MDC. После обновления произойдет сбой резервного копирования. |
| Рекомендуемое действие | Выполните действия, описанные в [разделе Обновление с SAP HANA 1,0 до 2,0](https://docs.microsoft.com/azure/backup/backup-azure-sap-hana-database-troubleshoot#upgrading-from-sap-hana-10-to-20) , чтобы устранить проблему. |

###  <a name="usererrorinvalidbackintconfiguration"></a>усерерроринвалидбаккинтконфигуратион 

| Сообщение об ошибке      | Обнаружена недопустимая конфигурация backint) создание                       |
| ------------------ | ------------------------------------------------------------ |
| Возможные причины    | Параметры резервного копирования неправильно указаны для службы архивации Azure |
| Рекомендуемое действие | Проверьте, установлены ли следующие параметры (backint) создание):<br/>\* [catalog_backup_using_backint: true]<br/>\* [enable_accumulated_catalog_backup: false]<br/>\* [parallel_data_backup_backint_channels: 1]<br/>\* [log_backup_timeout_s: 900)]<br/>\* [backint_response_timeout: 7200]<br/>Если в узле имеются параметры на основе backint) создание, удалите их. Если параметры отсутствуют на уровне узла, но были изменены вручную на уровне базы данных, верните их к соответствующим значениям, как описано выше. Или запустите команду " [Отключить защиту" и сохраните данные резервных копий](https://docs.microsoft.com/azure/backup/sap-hana-db-manage#stop-protection-for-an-sap-hana-database) из портал Azure, а затем выберите **возобновить резервное копирование**. |

## <a name="restore-checks"></a>Проверки восстановления

### <a name="single-container-database-sdc-restore"></a>Восстановление базы данных одного контейнера (SDC)

Следите за входными данными при восстановлении одной базы данных контейнера (SDC) для HANA на другой компьютер SDC. Имя базы данных должно быть указано в нижнем регистре, а в скобках — "SDC". Экземпляр HANA будет отображаться прописными буквами.

Предположим, что создается резервная копия экземпляра SDC HANA "H21". На странице архивные элементы отобразится имя элемента резервного копирования **"H21 (SDC)"** . При попытке восстановления этой базы данных на другой целевой SDC, скажем H11, необходимо предоставить следующие входные данные.

![Входные данные для восстановления SDC](media/backup-azure-sap-hana-database/hana-sdc-restore.png)

Обратите внимание на следующие моменты.

- По умолчанию восстановленное имя базы данных будет заполнено именем элемента резервного копирования, т. е., H21 (SDC).
- Выбор целевого объекта в качестве H11 не приведет к автоматическому изменению имени восстановленной базы данных. **Его следует изменить на H11 (SDC)** . В отношении SDC восстанавливаемое имя базы данных будет ИДЕНТИФИКАТОРом целевого экземпляра с строчными буквами и символом "SDC", добавленным в квадратные скобки.
- Поскольку SDC может иметь только одну базу данных, необходимо также установить флажок, чтобы разрешить переопределение существующих данных базы данных с данными точек восстановления.
- В Linux учитывается регистр. Поэтому будьте внимательны, чтобы сохранить регистр.

### <a name="multiple-container-database-mdc-restore"></a>Восстановление базы данных нескольких контейнеров (MDC)

В нескольких базах данных контейнеров для HANA Стандартная конфигурация — СИСТЕМДБ + 1 или более баз данных клиента. Восстановление всего экземпляра SAP HANA означает восстановление как СИСТЕМДБ, так и баз данных клиента. Сначала восстанавливается СИСТЕМДБ, а затем продолжается для базы данных клиента. По сути, системная база данных переопределяет сведения о системе для выбранного целевого объекта. Это восстановление также переопределяет сведения, связанные с Backint) создание, в целевом экземпляре. Поэтому после восстановления системной базы данных на целевом экземпляре необходимо повторно запустить сценарий предварительной регистрации. Только последующие восстановления базы данных клиента будут выполнены.

## <a name="upgrading-from-sap-hana-10-to-20"></a>Обновление с SAP HANA 1,0 до 2,0

Если вы защищаете базы данных SAP HANA 1,0 и хотите выполнить обновление до 2,0, выполните действия, описанные ниже.

- [Отключите защиту](sap-hana-db-manage.md#stop-protection-for-an-sap-hana-database) , оставив данные для старой базы данных SDC.
- Повторно запустите [Скрипт предварительной регистрации](https://aka.ms/scriptforpermsonhana) с правильными сведениями (SID и MDC).
- Повторно зарегистрируйте расширение (> Просмотр сведений о резервном копировании. > выберите соответствующую виртуальную машину Azure — > Повторная регистрация).
- Щелкните повторно обнаружить баз данных для той же виртуальной машины. Это действие должно показывать новые баз данных на шаге 2 с правильными сведениями (СИСТЕМДБ и база данных клиента, а не SDC).
- Защитите эти новые базы данных.

## <a name="upgrading-without-an-sid-change"></a>Обновление без изменения SID

Обновление операционной системы или SAP HANA, которые не вызывают изменения SID, можно обработать, как описано ниже.

- [Отключение защиты](sap-hana-db-manage.md#stop-protection-for-an-sap-hana-database) с помощью средства "хранить данные" для базы данных
- Повторно запустите [сценарий предварительной регистрации](https://aka.ms/scriptforpermsonhana)
- Снова [возобновите защиту](sap-hana-db-manage.md#resume-protection-for-an-sap-hana-database) базы данных

## <a name="next-steps"></a>Дальнейшие действия

- Ознакомьтесь с [часто задаваемыми вопросами](https://docs.microsoft.com/azure/backup/sap-hana-faq-backup-azure-vm) о резервном копировании SAP HANA баз данных на виртуальных машинах Azure]
