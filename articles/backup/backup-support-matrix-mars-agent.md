---
title: Матрица поддержки для агента Службы восстановления Microsoft Azure (MARS)
description: В этой статье приводится сводка Azure Backup поддержки при резервном копировании компьютеров, на которых выполняется агент Службы восстановления Microsoft Azure (MARS).
author: dcurwin
ms.service: backup
ms.date: 08/30/2019
ms.topic: conceptual
ms.author: dacurwin
manager: carmonm
ms.openlocfilehash: 1559bb096baaa8f19718bf0c3bcd6b2dc767235b
ms.sourcegitcommit: d470d4e295bf29a4acf7836ece2f10dabe8e6db2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/02/2019
ms.locfileid: "70210128"
---
# <a name="support-matrix-for-backup-with-the-microsoft-azure-recovery-services-mars-agent"></a>Матрица поддержки для резервного копирования с помощью агента Служб восстановления Microsoft Azure (MARS)

[Службу Azure Backup](backup-overview.md) можно использовать для резервного копирования локальных компьютеров и приложений, а также для резервного копирования виртуальных машин Azure. В этой статье перечислены параметры и ограничения поддержки при использовании агента Службы восстановления Microsoft Azure (MARS) для резервного копирования компьютеров.

## <a name="the-mars-agent"></a>Агент MARS

Azure Backup использует агент MARS для резервного копирования данных с локальных компьютеров и виртуальных машин Azure в хранилище резервных копий служб восстановления в Azure. Агент MARS может:
- Запускайте на локальных компьютерах под управлением Windows, чтобы они могли выполнять резервное копирование непосредственно в хранилище служб восстановления резервных копий в Azure.
- Запустите на виртуальных машинах Windows, чтобы они могли выполнять резервное копирование непосредственно в хранилище.
- Выполните команду на сервере Microsoft Azure Backup Server (MABS) или System Center Data Protection Manager (DPM). В этом сценарии компьютеры и рабочие нагрузки архивируются в MABS или на сервер DPM. Затем агент MARS создает резервную копию этого сервера в хранилище в Azure.

Параметры резервного копирования зависят от того, где установлен агент. Дополнительные сведения см. [в разделе архитектура Azure Backup с помощью агента Mars](backup-architecture.md#architecture-direct-backup-of-on-premises-windows-server-machines-or-azure-vm-files-or-folders). Сведения об архитектуре резервного копирования MABS и DPM см. [в статье резервное копирование в DPM или MABS](backup-architecture.md#architecture-back-up-to-dpmmabs). См. также [требования](backup-support-matrix-mabs-dpm.md) к архитектуре резервного копирования.

**Установка** | **Сведения**
--- | ---
Скачайте последнюю версию агента MARS | Последнюю версию агента можно скачать из хранилища или [напрямую](https://aka.ms/azurebackup_agent).
Установка непосредственно на компьютере | Агент MARS можно установить непосредственно на локальном сервере Windows Server или на виртуальной машине Windows, работающей под управлением любой из [поддерживаемых операционных систем](https://docs.microsoft.com/azure/backup/backup-support-matrix-mabs-dpm#supported-mabs-and-dpm-operating-systems).
Установка на резервном сервере | При настройке сервера DPM или MABS для резервного копирования в Azure нужно скачать и установить агент MARS на этом сервере. Агент можно установить в [поддерживаемых операционных системах](backup-support-matrix-mabs-dpm.md#supported-mabs-and-dpm-operating-systems) в матрице поддержки Backup Server.

> [!NOTE]
> По умолчанию для виртуальных машин Azure, для которых включена резервная копия, устанавливается Azure Backup расширение. Это расширение создает резервную копию всей виртуальной машины. Вы можете установить и запустить агент MARS на виртуальной машине Azure вместе с расширением, если хотите выполнить резервное копирование определенных папок или файлов, а не всей виртуальной машины.
> При запуске агента MARS на виртуальной машине Azure выполняется резервное копирование файлов или папок, которые находятся во временном хранилище на виртуальной машине. Резервное копирование завершается сбоем, если файлы или папки удаляются из временного хранилища или если временное хранилище удалено.


## <a name="cache-folder-support"></a>Поддержка папок кэширования

При использовании агента MARS для резервного копирования данных агент создает моментальный снимок данных и сохраняет их в папке локального кэша перед отправкой данных в Azure. Папка для кэша (Рабочая область) имеет несколько требований:

**Кэш.** | **Сведения**
--- | ---
Size |  Объем свободного места в папке кэша должен составлять от 5 до 10 процентов от общего размера данных резервных копий.
Местоположение | Папка кэша должна храниться локально на компьютере, на котором создается резервная копия, и должна находиться в режиме в сети. Папка кэша не должна находиться в общей сетевой папке, на съемном носителе или на автономном томе.
Папка | Папка кэша должна быть зашифрована на диске с дедупликацией или в сжатой папке, быть разреженной или иметь точку повторного анализа.
Изменения расположения | Чтобы изменить расположение кэша, остановите модуль архивации (`net stop bengine`) и скопируйте папку кэша на новый диск. (Убедитесь, что на новом диске достаточно места.) Затем обновите две записи реестра в **HKLM\SOFTWARE\Microsoft\Windows Azure Backup** (**config/ScratchLocation** и **config/клаудбаккуппровидер/ScratchLocation**) в новом расположении и перезапустите подсистему.

## <a name="networking-and-access-support"></a>Поддержка сети и доступа

### <a name="url-access"></a>Доступ к URL-адресам

Агенту MARS требуется доступ к таким URL-адресам:

- http://www.msftncsi.com/ncsi.txt
- *.Microsoft.com
- *.WindowsAzure.com
- *.MicrosoftOnline.com
- *.Windows.net

### <a name="throttling-support"></a>Поддержка регулирования

**Возможность** | **Сведения**
--- | ---
Управление пропускной способностью | Поддерживается. В агенте MARS используйте **Свойства изменить** , чтобы настроить пропускную способность.
Регулирование сети | Недоступно для резервных копий компьютеров под управлением Windows Server 2008 R2, Windows Server 2008 SP2 или Windows 7.

## <a name="support-for-direct-backups"></a>Поддержка прямого резервного копирования

Агент MARS можно использовать для резервного копирования непосредственно в Azure в некоторых операционных системах, работающих на локальных компьютерах и виртуальных машинах Azure. Операционные системы должны иметь 64 бит и должны работать с последними пакетами и обновлениями служб. В следующей таблице перечислены эти операционные системы.

**Операционная система** | **Файлы, папки** | **Состояние системы** | **Требования к программному обеспечению и модулям**
--- | --- | --- | ---
Windows 10 (Корпоративная, Pro, Домашняя) | Да | Нет |  Проверьте соответствующую версию сервера на наличие требований к программному обеспечению или модулю
Windows 8.1 (Корпоративная, Pro)| Да |Нет | Проверьте соответствующую версию сервера на наличие требований к программному обеспечению или модулю
Windows 8 (Корпоративная, Pro) | Да | Нет | Проверьте соответствующую версию сервера на наличие требований к программному обеспечению или модулю
Windows 7 (Максимальная, Корпоративная, Pro, Домашняя расширенная, Домашняя базовая, Начальная) | Да | Нет | Проверьте соответствующую версию сервера на наличие требований к программному обеспечению или модулю
Windows Server 2016 (Standard, Datacenter и Essentials) | Да | Да | — .NET 4,5 <br> — Windows PowerShell <br> — Последний совместимый распространяемый пакет Microsoft VC + + <br> — Консоль управления Microsoft (MMC) 3,0
Windows Server 2012 R2 (Standard, Datacenter, Foundation и Essentials) | Да | Да | — .NET 4,5 <br> — Windows PowerShell <br> — Последний совместимый распространяемый пакет Microsoft VC + + <br> — Консоль управления Microsoft (MMC) 3,0
Windows Server 2012 (Standard, Datacenter, Foundation) | Да | Да |— .NET 4,5 <br> — Windows PowerShell <br> — Последний совместимый распространяемый пакет Microsoft VC + + <br> — Консоль управления Microsoft (MMC) 3,0 <br> — Обслуживание образов развертывания и управление ими (DISM. exe)
Windows Server 2008 R2 (Standard, Enterprise, Datacenter, Foundation) | Да | Да | — .NET 3,5, .NET 4,5 <br> — Windows PowerShell <br> -Совместимый распространяемый пакет Microsoft VC + + <br> — Консоль управления Microsoft (MMC) 3,0 <br> — Обслуживание образов развертывания и управление ими (DISM. exe)
Windows Server 2008 с пакетом обновления 2 (Standard, Datacenter, Foundation) | Да | Нет | — .NET 3,5, .NET 4,5 <br> — Windows PowerShell <br> -Совместимый распространяемый пакет Microsoft VC + + <br> — Консоль управления Microsoft (MMC) 3,0 <br> — Обслуживание образов развертывания и управление ими (DISM. exe) <br> — Виртуальный сервер 2005, базовый + KB KB948515
Windows Storage Server 2016/2012 R2/2012 (стандартная, Рабочая группа) | Да | Нет | — .NET 4,5 <br> — Windows PowerShell <br> — Последний совместимый распространяемый пакет Microsoft VC + + <br> — Консоль управления Microsoft (MMC) 3,0
Windows Server 2019 (Standard, Datacenter и Essentials); | Да | Да | — .NET 4,5 <br> — Windows PowerShell <br> — Последний совместимый распространяемый пакет Microsoft VC + + <br> — Консоль управления Microsoft (MMC) 3,0

Дополнительные сведения см. в разделе [ПОДДЕРЖИВАЕМЫЕ MABS и операционные системы DPM](backup-support-matrix-mabs-dpm.md#supported-mabs-and-dpm-operating-systems).


## <a name="backup-limits"></a>Ограничения резервного копирования

Azure Backup ограничивает размер источника данных файла или папки, резервную копию которого можно создать. Элементы, которые вы создаете из одного тома, не могут превышать размеры, приведенные в этой таблице:

**Операционная система** | **Ограничение размера**
--- | ---
Windows Server 2012 или более поздней версии; |  54 400 ГБ
Windows Server 2008 R2 с пакетом обновления 1 |    1 700 ГБ
Windows Server 2008 с пакетом обновления 2 (SP2) | 1 700 ГБ
Windows 8 или более поздняя версия  | 54 400 ГБ
Windows 7   | 1 700 ГБ


## <a name="supported-file-types-for-backup"></a>Поддерживаемые типы файлов для резервного копирования

**Тип** | **Поддержка**
--- | ---
Зашифровано   | Поддерживается.
сжатые; | Поддерживается.
Разреженный | Поддерживается.
Сжатые и разреженные | Поддерживается.
Жесткие связи.  | Не поддерживается. Пропущено.
Точка повторного анализа   | Не поддерживается. Пропущено.
Зашифрованные и разреженные |  Не поддерживается. Пропущено.
Сжатые потоки данных   | Не поддерживается. Пропущено.
Разреженные потоки данных   | Не поддерживается. Пропущено.
OneDrive (синхронизированные файлы — это разреженные потоки)  | Не поддерживается.

## <a name="supported-drives-or-volumes-for-backup"></a>Поддерживаемые диски или тома для резервного копирования

**Дикс/том** | **Поддержка** | **Сведения**
--- | --- | ---
Тома только для чтения   | Не поддерживается | Служба теневого копирования томов (VSS) работает только в том случае, если том доступен для записи.
Автономные тома | Не поддерживается |   Служба VSS работает, только если том находится в режиме «в сети».
Сетевая папка   | Не поддерживается |   Том должен быть локальным на сервере.
Тома, защищенные BitLocker | Не поддерживается |   Перед началом резервного копирования том должен быть разблокирован.
Идентификация файловой системы  | Не поддерживается |   Поддерживается только файловая система NTFS.
Съемные носители | Не поддерживается |   Все источники элементов резервного копирования должны иметь фиксированное состояние.
Дедуплицированные диски | Поддерживается | Azure Backup преобразует дедуплицированные данные в обычные. Он оптимизирует, шифрует, сохраняет и отправляет данные в хранилище.

## <a name="support-for-initial-offline-backup"></a>Поддержка начального автономного резервного копирования

Azure Backup поддерживает *автономное заполнение* для перемещения данных начального резервного копирования в Azure с помощью дисков. Эта поддержка полезна, если начальная резервная копия, скорее всего, будет находиться в диапазоне размера терабайт (TBs). Автономное резервное копирование поддерживается для:

- Непосредственная Архивация файлов и папок на локальных компьютерах, на которых выполняется агент MARS.
- резервного копирования рабочих нагрузок и файлов с сервера DPM или MABS;

Автономное резервное копирование не может использоваться для файлов состояния системы.

## <a name="support-for-data-restoration"></a>Поддержка восстановления данных

С помощью функции [мгновенного восстановления](backup-instant-restore-capability.md) Azure Backup можно восстановить данные перед их копированием в хранилище. На компьютере, на котором выполняется резервное копирование, должна быть запущена .NET Framework 4.5.2 или более поздней версии.

Резервные копии не могут быть восстановлены на целевом компьютере, на котором работает более ранняя версия операционной системы. Например, резервная копия, созданная с компьютера под Windows 7, может быть восстановлена в Windows 8 или более поздней версии. Но резервная копия, созданная с компьютера под Windows 8, не может быть восстановлена на компьютере под Windows 7.

## <a name="next-steps"></a>Следующие шаги
- Дополнительные сведения об [архитектуре резервного копирования, использующей агент Mars](backup-architecture.md#architecture-direct-backup-of-on-premises-windows-server-machines-or-azure-vm-files-or-folders).
- Узнайте, что поддерживается при [запуске агента Mars на сервере MABS или DPM](backup-support-matrix-mabs-dpm.md).
