---
title: Удаление TLS 1,0 и 1,1 из использования с кэшем Azure для Redis
description: Узнайте, как удалить TLS 1,0 и 1,1 из приложения при взаимодействии с кэшем Azure для Redis
author: yegu-ms
ms.service: cache
ms.topic: conceptual
ms.date: 10/22/2019
ms.author: yegu
ms.openlocfilehash: efb9e8b8abdcb442e2c5c4d8bfd1b2e1e60865ce
ms.sourcegitcommit: a8ee9717531050115916dfe427f84bd531a92341
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/12/2020
ms.locfileid: "83197855"
---
# <a name="remove-tls-10-and-11-from-use-with-azure-cache-for-redis"></a>Удаление TLS 1,0 и 1,1 из использования с кэшем Azure для Redis

В рамках всей отрасли в отношении эксклюзивного использования протокола TLS версии 1,2 или более поздней. Известно, что протоколы TLS версий 1,0 и 1,1 подвержены атакам, таким как МОНСТРУ и пудель, и имеют другие распространенные слабости и уязвимости (CVE). Кроме того, они не поддерживают современные методы шифрования и комплекты шифров, Рекомендуемые в соответствии со стандартами соответствия требованиям индустрии платежных карт (PCI). Этот [блог по безопасности TLS](https://www.acunetix.com/blog/articles/tls-vulnerabilities-attacks-final-part/) подробно описывает некоторые из этих уязвимостей.

В рамках этих усилий мы будем вносить следующие изменения в кэш Azure для Redis:

* **Этап 1.** Мы настроим в качестве минимальной версии по умолчанию для протокола TLS значение 1,2 для вновь создаваемых экземпляров кэша (ранее TLS 1,0).  На этом этапе существующие экземпляры кэша обновляться не будут. При необходимости вы можете [изменить минимальную версию TLS](cache-configure.md#access-ports) на 1,0 или 1,1 для обратной совместимости. Это изменение можно выполнить с помощью портал Azure или других API-интерфейсов управления.
* **Этап 2.** Мы будем прекращать поддержку TLS версий 1,0 и 1,1. После этого изменения приложение должно будет использовать TLS 1,2 или более поздней версии для взаимодействия с кэшем.

Кроме того, в рамках этого изменения будет удалена поддержка старых и небезопасных шифр пакетов.  Наши Поддерживаемые наборы шифр будут ограничены следующими, если для кэша настроена минимальная версия TLS 1,2.

* TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384_P384
* TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256_P256

В этой статье содержатся общие рекомендации по обнаружению зависимостей от предыдущих версий TLS и их удаление из приложения.

Дата вступления этих изменений в силу:

| Облако               | Начальная дата первого этапа | Дата начала фазы 2      |
|---------------------|--------------------|-------------------------|
| Azure (глобальная)      |  13 января 2020 г.  | 11 мая, 2020            |
| Azure для государственных организаций    |  13 марта 2020 г.    | 11 мая, 2020            |
| Azure для Германии       |  13 марта 2020 г.    | 11 мая, 2020            |
| Azure для Китая         |  13 марта 2020 г.    | 11 мая, 2020            |

## <a name="check-whether-your-application-is-already-compliant"></a>Проверьте, соответствует ли ваше приложение требованиям

Самый простой способ узнать, будет ли приложение работать с TLS 1,2, — установить значение **минимальной версии TLS** для TLS 1,2 в тестируемом или промежуточном кэше, который он использует. Параметр **минимальной версии TLS** находится в [дополнительных параметрах](cache-configure.md#advanced-settings) экземпляра кэша в портал Azure. Если после этого изменения приложение продолжит работать должным образом, это, вероятно, соответствует требованиям. Может потребоваться настроить некоторые клиентские библиотеки Redis, используемые приложением специально для включения TLS 1,2, чтобы они могли подключаться к кэшу Azure для Redis по протоколу безопасности.

## <a name="configure-your-application-to-use-tls-12"></a>Настройка приложения для использования TLS 1,2

Большинство приложений используют клиентские библиотеки Redis для управления связью с их кэшами. Ниже приведены инструкции по настройке некоторых популярных клиентских библиотек, в различных языках программирования и платформах, для использования TLS 1,2.

### <a name="net-framework"></a>.NET Framework

Клиенты Redis .NET по умолчанию используют самую раннюю версию TLS в .NET Framework 4.5.2 или более ранней версии и используют последнюю версию TLS на .NET Framework 4,6 или более поздней версии. Если вы используете более старую версию .NET Framework, TLS 1,2 можно включить вручную.

* **StackExchange. Redis:** Задайте `ssl=true` и `sslprotocols=tls12` в строке подключения.
* **ServiceStack. Redis:** Следуйте инструкциям [ServiceStack. Redis](https://github.com/ServiceStack/ServiceStack.Redis#servicestackredis-ssl-support) , и для них требуется по меньшей мере версия ServiceStack. Redis версии 5.6.

### <a name="net-core"></a>.NET Core

Клиенты Redis .NET Core по умолчанию используют последнюю версию TLS.

### <a name="java"></a>Java

Клиенты Redis Java используют протокол TLS 1,0 в Java версии 6 или более ранней. Jedis, салат и Редиссон не могут подключиться к кэшу Azure для Redis, если TLS 1,0 отключен в кэше. Обновите платформу Java, чтобы использовать новые версии TLS.

Для Java 7 Клиенты Redis не используют TLS 1,2 по умолчанию, но могут быть настроены для него. Jedis позволяет указать базовые параметры TLS с помощью следующего фрагмента кода:

``` Java
SSLSocketFactory sslSocketFactory = (SSLSocketFactory) SSLSocketFactory.getDefault();
SSLParameters sslParameters = new SSLParameters();
sslParameters.setEndpointIdentificationAlgorithm("HTTPS");
sslParameters.setProtocols(new String[]{"TLSv1.2"});
 
URI uri = URI.create("rediss://host:port");
JedisShardInfo shardInfo = new JedisShardInfo(uri, sslSocketFactory, sslParameters, null);
 
shardInfo.setPassword("cachePassword");
 
Jedis jedis = new Jedis(shardInfo);
```

Клиенты салат и Редиссон пока не поддерживают указание версии TLS, поэтому они будут прерываться, если кэш принимает только подключения TLS 1,2. Исправляются исправления для этих клиентов, поэтому проверьте наличие в этих пакетах обновленной версии с такой поддержкой.

В Java 8 протокол TLS 1,2 используется по умолчанию и не должен требовать обновления конфигурации клиента в большинстве случаев. Чтобы обеспечить безопасность, протестируйте приложение.

### <a name="nodejs"></a>Node.js

Узлы Redis и Иоредис по умолчанию используют TLS 1,2.

### <a name="php"></a>PHP

#### <a name="predis"></a>предис
 
* Версии, предшествующие PHP 7: Предис поддерживает только TLS 1,0. Эти версии не работают с TLS 1,2; необходимо выполнить обновление до использования TLS 1,2.
 
* PHP 7,0 to PHP 7.2.1: по умолчанию Предис использует только TLS 1,0 или 1,1. Для использования TLS 1,2 можно использовать следующий обходной путь. При создании экземпляра клиента укажите TLS 1,2.

  ``` PHP
  $redis=newPredis\Client([
      'scheme'=>'tls',
      'host'=>'host',
      'port'=>6380,
      'password'=>'password',
      'ssl'=>[
          'crypto_type'=>STREAM_CRYPTO_METHOD_TLSv1_2_CLIENT,
      ],
  ]);
  ```

* PHP 7,3 и более поздние версии: Предис использует последнюю версию TLS.

#### <a name="phpredis"></a>фпредис

Фпредис не поддерживает TLS в любой версии PHP.

### <a name="python"></a>Python

Redis-копировать по умолчанию использует TLS 1,2.

### <a name="go"></a>GO

По умолчанию редиго использует TLS 1,2.

## <a name="additional-information"></a>Дополнительные сведения

- [Настройка кэша Azure для Redis](cache-configure.md)
