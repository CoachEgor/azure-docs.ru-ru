---
title: Высокий уровень доступности кэша Azure для Redis
description: Дополнительные сведения о кэше Azure для функций и параметров высокой доступности Redis
author: yegu-ms
ms.service: cache
ms.topic: conceptual
ms.date: 08/19/2020
ms.author: yegu
ms.openlocfilehash: 145be11436eb4d0c4f6b892e5239ccacd838d780
ms.sourcegitcommit: 829d951d5c90442a38012daaf77e86046018e5b9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/09/2020
ms.locfileid: "91654168"
---
# <a name="high-availability-for-azure-cache-for-redis"></a>Высокий уровень доступности кэша Azure для Redis

Кэш Azure для Redis имеет встроенную высокую доступность. Цель своей архитектуры высокого уровня доступности заключается в том, чтобы убедиться, что управляемый экземпляр Redis работает, даже если его базовые виртуальные машины (ВМ) оказывают влияние на запланированные или незапланированные простои. Он предоставляет гораздо более большие процентные ставки, чем достижимый объемом размещения Redis на одной виртуальной машине.

Кэш Azure для Redis реализует высокий уровень доступности с помощью нескольких виртуальных машин, называемых *узлами*, для кэша. Он настраивает эти узлы таким образом, чтобы репликация данных и отработка отказа выполнялась в соответствии с согласованными принципами. Он также координирует операции обслуживания, такие как исправление Redis программного обеспечения. В уровнях "Стандартный" и "Премиум" доступны различные варианты высокого уровня доступности.

| Параметр | Описание | Доступность | Standard | Premium |
| ------------------- | ------- | ------- | :------: | :---: |
| [Стандартная репликация](#standard-replication)| Реплицированная конфигурация с двумя узлами в одном центре обработки данных или зоне доступности (AZ) с автоматической отработкой отказа | 99,9 % |✔|✔|
| [Несколько реплик](#multiple-replicas) | Многоузловая Конфигурация репликации в одном или нескольких AZs с автоматической отработкой отказа | 99,95% (с избыточностью зоны) |-|✔|
| [Избыточность в пределах зоны](#zone-redundancy) | Многоузловая Конфигурация репликации в AZs с автоматической отработкой отказа | 99,95% (с несколькими репликами) |-|✔|
| [Георепликация](#geo-replication) | Экземпляры связанного кэша в двух регионах с управляемой пользователем отработкой отказа | 99,9% (для одного региона) |-|✔|

## <a name="standard-replication"></a>Стандартная репликация

Кэш Azure для Redis на уровне "Стандартный" или "Премиум" по умолчанию работает на паре серверов Redis. Два сервера размещаются на выделенных виртуальных машинах. Redis с открытым исходным кодом позволяет только одному серверу обслуживать запросы на запись данных. Этот сервер является *основным* узлом, а другой *репликой*. После того как сервер подготавливает узлы, кэш Azure для Redis назначает им роли первичной и реплики. Основной узел обычно отвечает за обслуживание записи и запросов на чтение от клиентов Redis. При операции записи он фиксирует новый ключ и обновляет его внутреннюю память и немедленно отправляет ответ клиенту. Она перенаправляет операцию в реплику асинхронно.

:::image type="content" source="media/cache-high-availability/replication.png" alt-text="Настройка репликации данных":::
   
>[!NOTE]
>Как правило, клиент Redis взаимодействует с основным узлом в кэше Redis для всех запросов на чтение и запись. Некоторые клиенты Redis могут быть настроены для чтения с узла реплики.
>
>

Если основной узел в кэше Redis недоступен, реплика будет достигать новой первичной роли автоматически. Этот процесс называется *отработкой отказа*. Реплика будет ожидать достаточно долгого времени, прежде чем переключаться в случае, если основной узел быстро восстанавливается. Когда происходит отработка отказа, кэш Azure для Redis подготавливает новую виртуальную машину и присоединяет ее к кэшу в качестве узла реплики. Реплика выполняет полную синхронизацию данных с первичным экземпляром, чтобы иметь другую копию данных кэша.

Основной узел может выходить из службы в рамках запланированного обслуживания, такого как Redis программное обеспечение или обновление операционной системы. Это также может привести к сбою в связи с незапланированными событиями, такими как сбои в базовом оборудовании, программном обеспечении или сети. [Отработка отказа и исправление для кэша Azure для Redis](cache-failover.md) содержит подробное описание типов отработки отказа Redis. В течение времени существования кэша Azure для Redis будет проходить много отработок отказа. Архитектура высокого уровня доступности разработана таким образом, чтобы эти изменения в кэше были как можно более прозрачными для клиентов.

## <a name="multiple-replicas"></a>Несколько реплик

>[!NOTE]
>Он доступен в виде предварительной версии.
>
>

Кэш Azure для Redis позволяет создавать дополнительные узлы реплик на уровне Premium. Для [кэша с несколькими репликами](cache-how-to-multi-replicas.md) можно настроить до трех узлов реплики. Наличие большего количества реплик обычно повышает устойчивость из-за дополнительных узлов, резервная копия которых является первичной. Даже если у вас больше реплик, кэш Azure для экземпляра Redis по-прежнему может серьезно повлиять на сбой центра обработки данных или AZ. Доступность кэша можно увеличить, используя несколько реплик в сочетании с [избыточностью зоны](#zone-redundancy).

## <a name="zone-redundancy"></a>Избыточность в пределах зоны

>[!NOTE]
>Он доступен в виде предварительной версии.
>
>

Кэш Azure для Redis поддерживает избыточные конфигурации зоны на уровне Premium. [Кэш, избыточный](cache-how-to-zone-redundancy.md) в пределах зоны, может размещать узлы в разных [зоны доступности Azure](https://docs.microsoft.com/azure/availability-zones/az-overview) в одном регионе. Она исключает центр обработки данных или AZ Failure как единую точку отказа и увеличивает общую доступность кэша.

На следующей схеме показана конфигурация, избыточная в зоне.

:::image type="content" source="media/cache-high-availability/zone-redundancy.png" alt-text="Настройка репликации данных":::
   
Кэш Azure для Redis распространяет узлы в избыточном кэше с циклическим перебором по сравнению с выбранным AZs. Он также определяет, какой узел будет изначально выступать в качестве основного.

Кэш, избыточный в зоне, обеспечивает автоматический переход на другой ресурс. Если текущий основной узел недоступен, одна из реплик будет принимать участие. Приложение может столкнуться с более высоким временем ответа кэша, если новый основной узел находится в другом AZ. AZs разделяются географически. При переключении с одного AZ на другое изменяется физическое расстояние между размещением приложения и кэша. Это изменение влияет на задержки при обмене данными между приложением и кэшем. Ожидается, что задержка будет попадать в допустимый диапазон для большинства приложений. Рекомендуется протестировать приложение, чтобы убедиться, что оно может нормально работать с кэшем, избыточным в зоне.

## <a name="geo-replication"></a>Георепликация

Георепликация разработана главным образом для аварийного восстановления. Она дает возможность настроить кэш Azure для экземпляра Redis в другом регионе Azure, чтобы создать резервную копию основного кэша. [Настройка георепликации для кэша Azure для Redis](cache-how-to-geo-replication.md) дает подробное объяснение того, как работает Георепликация.

## <a name="next-steps"></a>Дальнейшие шаги

Дополнительные сведения о настройке кэша Azure для Redis высокого уровня доступности см. здесь.

* [Кэш Azure для уровней службы Redis Premium](cache-overview.md#service-tiers)
* [Добавление реплик в кэш Azure для Redis](cache-how-to-multi-replicas.md)
* [Включение избыточности зоны для кэша Azure для Redis](cache-how-to-zone-redundancy.md)
* [Настройка георепликации для кэша Azure для Redis](cache-how-to-geo-replication.md)
