---
title: Кэш Azure для Redis с помощью частной связи Azure (Предварительная версия)
description: Частная конечная точка Azure — это сетевой интерфейс, который обеспечивает безопасное подключение к кэшу Azure для Redis с помощью частной ссылки Azure. В этой статье вы узнаете, как создать кэш Azure, виртуальную сеть Azure и закрытую конечную точку с помощью портал Azure.
author: curib
ms.author: cauribeg
ms.service: cache
ms.topic: conceptual
ms.date: 10/14/2020
ms.openlocfilehash: efba69372f46c9b8a7f2857e37b34ec8c88654a0
ms.sourcegitcommit: d767156543e16e816fc8a0c3777f033d649ffd3c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/26/2020
ms.locfileid: "92546285"
---
# <a name="azure-cache-for-redis-with-azure-private-link-public-preview"></a>Кэш Azure для Redis с помощью частной связи Azure (общедоступная Предварительная версия)
В этой статье вы узнаете, как создать виртуальную сеть и кэш Azure для экземпляра Redis с помощью частной конечной точки, используя портал Azure. Вы также узнаете, как добавить частную конечную точку в существующий кэш Azure для экземпляра Redis.

Частная конечная точка Azure — это сетевой интерфейс, который обеспечивает безопасное подключение к кэшу Azure для Redis с помощью частной ссылки Azure. 

## <a name="prerequisites"></a>Предварительные требования
* Подписка Azure — [создайте бесплатную учетную запись](https://azure.microsoft.com/free/).

> [!IMPORTANT]
> Чтобы использовать частные конечные точки, необходимо создать кэш Azure для экземпляра Redis после 28 июля 2020.
> В настоящее время Георепликация, правила брандмауэра, поддержка консоли портала, несколько конечных точек на кластеризованный кэш, сохранение в брандмауэре и внедренные кэши не поддерживаются. 
>
>

## <a name="create-a-private-endpoint-with-a-new-azure-cache-for-redis-instance"></a>Создание частной конечной точки с новым кэшем Azure для экземпляра Redis 

В этом разделе вы создадите новый кэш Azure для экземпляра Redis с закрытой конечной точкой.

### <a name="create-a-virtual-network"></a>Создание виртуальной сети 

1. Войдите на [портал Azure](https://portal.azure.com) и выберите **Создать ресурс** .

    :::image type="content" source="media/cache-private-link/1-create-resource.png" alt-text="Выберите Создать ресурс.&quot;:::

2. На странице **Создание** выберите **сети** и щелкните **Виртуальная сеть** .

3. Нажмите кнопку **Добавить** , чтобы создать виртуальную сеть.

4. В подменю **Создать виртуальную сеть** введите или выберите следующую информацию на вкладке **Основные сведения** :

   | Параметр      | Рекомендуемое значение  | Описание |
   | ------------ |  ------- | -------------------------------------------------- |
   | **Подписка** | Раскройте список и выберите нужную подписку. | Подписка, в которой будет создана эта виртуальная сеть. | 
   | **Группа ресурсов** | Раскройте список и выберите группу ресурсов или нажмите **Создать** и введите имя для новой группы ресурсов. | Имя группы ресурсов, в которой будет создана виртуальная сеть и другие ресурсы. Поместив все ресурсы приложения в одну группу ресурсов, вы сможете легко управлять ими и/или удалить их вместе. | 
   | **Имя** | Введите имя виртуальной сети. | Имя должно начинаться с буквы или цифры, заканчиваться буквой, цифрой или символом подчеркивания и может содержать только буквы, цифры, символы подчеркивания, точки или дефисы. | 
   | **Регион** | Раскрывающийся список и выберите регион. | Выберите [регион](https://azure.microsoft.com/regions/) рядом с другими службами, которые будут использовать виртуальную сеть. |

5. Перейдите на вкладку **IP-адреса** или нажмите кнопку **Далее: IP-адреса** в нижней части страницы.

6. На вкладке **IP-адреса** укажите **адресное пространство IPv4** в виде одного или нескольких префиксов адресов в нотации CIDR (например, 192.168.1.0/24).

7. В разделе **имя подсети** щелкните **по умолчанию** , чтобы изменить свойства подсети.

8. В области **Изменение подсети** укажите **имя** подсети, а также **диапазон адресов подсети** . Диапазон адресов подсети должен быть в нотации CIDR (например, 192.168.1.0/24). Он должен содержаться в адресном пространстве виртуальной сети.

9. Нажмите кнопку **Сохранить** .

10. Перейдите на вкладку &quot; **Проверка и создание** &quot; или нажмите кнопку " **проверить и создать** ".

11. Убедитесь, что все сведения указаны правильно, и нажмите кнопку **создать** , чтобы подготавливает виртуальную сеть.

### <a name="create-an-azure-cache-for-redis-instance-with-a-private-endpoint"></a>Создание кэша Azure для экземпляра Redis с закрытой конечной точкой
Чтобы создать экземпляр кэша, выполните следующие действия.

1. Вернитесь на домашнюю страницу портал Azure или откройте меню боковой панели, а затем выберите **создать ресурс** . 
   
1. На странице **Создание** выберите **Базы данных** , а затем **Кэш Azure для Redis** .

    :::image type="content" source="media/cache-private-link/2-select-cache.png" alt-text="Выберите Создать ресурс.&quot;:::

2. На странице **Создание** выберите **сети** и щелкните **Виртуальная сеть** .

3. Нажмите кнопку **Добавить** , чтобы создать виртуальную сеть.

4. В подменю **Создать виртуальную сеть** введите или выберите следующую информацию на вкладке **Основные сведения** :

   | Параметр      | Рекомендуемое значение  | Описание |
   | ------------ |  ------- | -------------------------------------------------- |
   | **Подписка** | Раскройте список и выберите нужную подписку. | Подписка, в которой будет создана эта виртуальная сеть. | 
   | **Группа ресурсов** | Раскройте список и выберите группу ресурсов или нажмите **Создать** и введите имя для новой группы ресурсов. | Имя группы ресурсов, в которой будет создана виртуальная сеть и другие ресурсы. Поместив все ресурсы приложения в одну группу ресурсов, вы сможете легко управлять ими и/или удалить их вместе. | 
   | **Имя** | Введите имя виртуальной сети. | Имя должно начинаться с буквы или цифры, заканчиваться буквой, цифрой или символом подчеркивания и может содержать только буквы, цифры, символы подчеркивания, точки или дефисы. | 
   | **Регион** | Раскрывающийся список и выберите регион. | Выберите [регион](https://azure.microsoft.com/regions/) рядом с другими службами, которые будут использовать виртуальную сеть. |

5. Перейдите на вкладку **IP-адреса** или нажмите кнопку **Далее: IP-адреса** в нижней части страницы.

6. На вкладке **IP-адреса** укажите **адресное пространство IPv4** в виде одного или нескольких префиксов адресов в нотации CIDR (например, 192.168.1.0/24).

7. В разделе **имя подсети** щелкните **по умолчанию** , чтобы изменить свойства подсети.

8. В области **Изменение подсети** укажите **имя** подсети, а также **диапазон адресов подсети** . Диапазон адресов подсети должен быть в нотации CIDR (например, 192.168.1.0/24). Он должен содержаться в адресном пространстве виртуальной сети.

9. Нажмите кнопку **Сохранить** .

10. Перейдите на вкладку &quot; **Проверка и создание** &quot; или нажмите кнопку " выберите **Частная конечная точка** для метода подключения.

1. Нажмите кнопку **Добавить** , чтобы создать закрытую конечную точку.

    :::image type="content" source="media/cache-private-link/3-add-private-endpoint.png" alt-text="Выберите Создать ресурс.&quot;:::

2. На странице **Создание** выберите **сети** и щелкните **Виртуальная сеть** .

3. Нажмите кнопку **Добавить** , чтобы создать виртуальную сеть.

4. В подменю **Создать виртуальную сеть** введите или выберите следующую информацию на вкладке **Основные сведения** :

   | Параметр      | Рекомендуемое значение  | Описание |
   | ------------ |  ------- | -------------------------------------------------- |
   | **Подписка** | Раскройте список и выберите нужную подписку. | Подписка, в которой будет создана эта виртуальная сеть. | 
   | **Группа ресурсов** | Раскройте список и выберите группу ресурсов или нажмите **Создать** и введите имя для новой группы ресурсов. | Имя группы ресурсов, в которой будет создана виртуальная сеть и другие ресурсы. Поместив все ресурсы приложения в одну группу ресурсов, вы сможете легко управлять ими и/или удалить их вместе. | 
   | **Имя** | Введите имя виртуальной сети. | Имя должно начинаться с буквы или цифры, заканчиваться буквой, цифрой или символом подчеркивания и может содержать только буквы, цифры, символы подчеркивания, точки или дефисы. | 
   | **Регион** | Раскрывающийся список и выберите регион. | Выберите [регион](https://azure.microsoft.com/regions/) рядом с другими службами, которые будут использовать виртуальную сеть. |

5. Перейдите на вкладку **IP-адреса** или нажмите кнопку **Далее: IP-адреса** в нижней части страницы.

6. На вкладке **IP-адреса** укажите **адресное пространство IPv4** в виде одного или нескольких префиксов адресов в нотации CIDR (например, 192.168.1.0/24).

7. В разделе **имя подсети** щелкните **по умолчанию** , чтобы изменить свойства подсети.

8. В области **Изменение подсети** укажите **имя** подсети, а также **диапазон адресов подсети** . Диапазон адресов подсети должен быть в нотации CIDR (например, 192.168.1.0/24). Он должен содержаться в адресном пространстве виртуальной сети.

9. Нажмите кнопку **Сохранить** .

10. Перейдите на вкладку &quot; **Проверка и создание** &quot; или нажмите кнопку " зеленого цвета, выберите **Создать** .

На создание кэша требуется некоторое время. Вы можете отслеживать ход выполнения на странице **обзорных сведений** кэша Azure для Redis. Когда **Состояние** примет значение **Running** (Выполняется), кэш будет готов к использованию. 
    
> [!IMPORTANT]
> 
> Существует флаг, `publicNetworkAccess` который `Enabled` по умолчанию имеет значение. 
> Этот флаг позволяет разрешить доступ к кэшу как к открытым, так и к частным конечным точкам, если он имеет значение `Enabled` . Если задано значение `Disabled` , доступ к закрытой конечной точке разрешен только для частных конечных точек. Можно задать значение `Disabled` с помощью следующего запроса PATCH.
> ```http
> PATCH  https://management.azure.com/subscriptions/{subscription}/resourceGroups/{resourcegroup}/providers/Microsoft.Cache/Redis/{cache}?api-version=2020-06-01
> {    "properties": {
>        "publicNetworkAccess":"Disabled"
>    }
> }
> ```
>

> [!IMPORTANT]
> 
> Для подключения к кластеризованному кэшу необходимо `publicNetworkAccess` задать значение, `Disabled` и может существовать только одно подключение к частной конечной точке. 
>

## <a name="create-a-private-endpoint-with-an-existing-azure-cache-for-redis-instance"></a>Создание частной конечной точки с существующим кэшем Azure для экземпляра Redis 

В этом разделе вы добавите закрытую конечную точку в существующий кэш Azure для экземпляра Redis. 

### <a name="create-a-virtual-network"></a>Создание виртуальной сети 
Чтобы создать виртуальную сеть, выполните следующие действия.

1. Войдите на [портал Azure](https://portal.azure.com) и выберите **Создать ресурс** .

2. На странице **Создание** выберите **сети** и щелкните **Виртуальная сеть** .

3. Нажмите кнопку **Добавить** , чтобы создать виртуальную сеть.

4. В подменю **Создать виртуальную сеть** введите или выберите следующую информацию на вкладке **Основные сведения** :

   | Параметр      | Рекомендуемое значение  | Описание |
   | ------------ |  ------- | -------------------------------------------------- |
   | **Подписка** | Раскройте список и выберите нужную подписку. | Подписка, в которой будет создана эта виртуальная сеть. | 
   | **Группа ресурсов** | Раскройте список и выберите группу ресурсов или нажмите **Создать** и введите имя для новой группы ресурсов. | Имя группы ресурсов, в которой будет создана виртуальная сеть и другие ресурсы. Поместив все ресурсы приложения в одну группу ресурсов, вы сможете легко управлять ими и/или удалить их вместе. | 
   | **Имя** | Введите имя виртуальной сети. | Имя должно начинаться с буквы или цифры, заканчиваться буквой, цифрой или символом подчеркивания и может содержать только буквы, цифры, символы подчеркивания, точки или дефисы. | 
   | **Регион** | Раскрывающийся список и выберите регион. | Выберите [регион](https://azure.microsoft.com/regions/) рядом с другими службами, которые будут использовать виртуальную сеть. |

5. Перейдите на вкладку **IP-адреса** или нажмите кнопку **Далее: IP-адреса** в нижней части страницы.

6. На вкладке **IP-адреса** укажите **адресное пространство IPv4** в виде одного или нескольких префиксов адресов в нотации CIDR (например, 192.168.1.0/24).

7. В разделе **имя подсети** щелкните **по умолчанию** , чтобы изменить свойства подсети.

8. В области **Изменение подсети** укажите **имя** подсети, а также **диапазон адресов подсети** . Диапазон адресов подсети должен быть в нотации CIDR (например, 192.168.1.0/24). Он должен содержаться в адресном пространстве виртуальной сети.

9. Нажмите кнопку **Сохранить** .

10. Перейдите на вкладку " **Проверка и создание** " или нажмите кнопку " **проверить и создать** ".

11. Убедитесь, что все сведения указаны правильно, и нажмите кнопку **создать** , чтобы подготавливает виртуальную сеть.

### <a name="create-a-private-endpoint"></a>Создание частной конечной точки 

Чтобы создать частную конечную точку, выполните следующие действия.

1. В портал Azure найдите **кэш Azure для Redis** и нажмите клавишу ВВОД или выберите его из вариантов поиска.

    :::image type="content" source="media/cache-private-link/4-search-for-cache.png" alt-text="Выберите Создать ресурс.&quot;:::

2. На странице **Создание** выберите **сети** и щелкните **Виртуальная сеть** .

3. Нажмите кнопку **Добавить** , чтобы создать виртуальную сеть.

4. В подменю **Создать виртуальную сеть** введите или выберите следующую информацию на вкладке **Основные сведения** :

   | Параметр      | Рекомендуемое значение  | Описание |
   | ------------ |  ------- | -------------------------------------------------- |
   | **Подписка** | Раскройте список и выберите нужную подписку. | Подписка, в которой будет создана эта виртуальная сеть. | 
   | **Группа ресурсов** | Раскройте список и выберите группу ресурсов или нажмите **Создать** и введите имя для новой группы ресурсов. | Имя группы ресурсов, в которой будет создана виртуальная сеть и другие ресурсы. Поместив все ресурсы приложения в одну группу ресурсов, вы сможете легко управлять ими и/или удалить их вместе. | 
   | **Имя** | Введите имя виртуальной сети. | Имя должно начинаться с буквы или цифры, заканчиваться буквой, цифрой или символом подчеркивания и может содержать только буквы, цифры, символы подчеркивания, точки или дефисы. | 
   | **Регион** | Раскрывающийся список и выберите регион. | Выберите [регион](https://azure.microsoft.com/regions/) рядом с другими службами, которые будут использовать виртуальную сеть. |

5. Перейдите на вкладку **IP-адреса** или нажмите кнопку **Далее: IP-адреса** в нижней части страницы.

6. На вкладке **IP-адреса** укажите **адресное пространство IPv4** в виде одного или нескольких префиксов адресов в нотации CIDR (например, 192.168.1.0/24).

7. В разделе **имя подсети** щелкните **по умолчанию** , чтобы изменить свойства подсети.

8. В области **Изменение подсети** укажите **имя** подсети, а также **диапазон адресов подсети** . Диапазон адресов подсети должен быть в нотации CIDR (например, 192.168.1.0/24). Он должен содержаться в адресном пространстве виртуальной сети.

9. Нажмите кнопку **Сохранить** .

10. Перейдите на вкладку &quot; **Проверка и создание** &quot; или нажмите кнопку ":::

2. Выберите экземпляр кэша, в который нужно добавить закрытую конечную точку.

3. В левой части экрана выберите **(Предварительная версия) частная конечная точка** .

4. Нажмите кнопку **закрытая конечная точка** , чтобы создать закрытую конечную точку.

    :::image type="content" source="media/cache-private-link/5-add-private-endpoint.png" alt-text="Выберите Создать ресурс.&quot;:::

2. На странице **Создание** выберите **сети** и щелкните **Виртуальная сеть** .

3. Нажмите кнопку **Добавить** , чтобы создать виртуальную сеть.

4. В подменю **Создать виртуальную сеть** введите или выберите следующую информацию на вкладке **Основные сведения** :

   | Параметр      | Рекомендуемое значение  | Описание |
   | ------------ |  ------- | -------------------------------------------------- |
   | **Подписка** | Раскройте список и выберите нужную подписку. | Подписка, в которой будет создана эта виртуальная сеть. | 
   | **Группа ресурсов** | Раскройте список и выберите группу ресурсов или нажмите **Создать** и введите имя для новой группы ресурсов. | Имя группы ресурсов, в которой будет создана виртуальная сеть и другие ресурсы. Поместив все ресурсы приложения в одну группу ресурсов, вы сможете легко управлять ими и/или удалить их вместе. | 
   | **Имя** | Введите имя виртуальной сети. | Имя должно начинаться с буквы или цифры, заканчиваться буквой, цифрой или символом подчеркивания и может содержать только буквы, цифры, символы подчеркивания, точки или дефисы. | 
   | **Регион** | Раскрывающийся список и выберите регион. | Выберите [регион](https://azure.microsoft.com/regions/) рядом с другими службами, которые будут использовать виртуальную сеть. |

5. Перейдите на вкладку **IP-адреса** или нажмите кнопку **Далее: IP-адреса** в нижней части страницы.

6. На вкладке **IP-адреса** укажите **адресное пространство IPv4** в виде одного или нескольких префиксов адресов в нотации CIDR (например, 192.168.1.0/24).

7. В разделе **имя подсети** щелкните **по умолчанию** , чтобы изменить свойства подсети.

8. В области **Изменение подсети** укажите **имя** подсети, а также **диапазон адресов подсети** . Диапазон адресов подсети должен быть в нотации CIDR (например, 192.168.1.0/24). Он должен содержаться в адресном пространстве виртуальной сети.

9. Нажмите кнопку **Сохранить** .

10. Перейдите на вкладку &quot; **Проверка и создание** &quot; или нажмите кнопку " выберите **создать** .


## <a name="next-steps"></a>Дальнейшие действия

Дополнительные сведения о частной ссылке Azure см. в [документации по частной ссылке Azure](../private-link/private-link-overview.md).