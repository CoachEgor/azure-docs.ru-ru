---
title: Заметки о выпуске агента службы "Синхронизация файлов Azure" | Документация Майкрософт
description: Заметки о выпуске агента службы "Синхронизация файлов Azure".
services: storage
author: wmgries
ms.service: storage
ms.topic: conceptual
ms.date: 6/26/2020
ms.author: wgries
ms.subservice: files
ms.openlocfilehash: 54a7f3f50de27747ab15f6895ebfb4f65faf5fdf
ms.sourcegitcommit: 877491bd46921c11dd478bd25fc718ceee2dcc08
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/02/2020
ms.locfileid: "85484066"
---
# <a name="release-notes-for-the-azure-file-sync-agent"></a>Заметки о выпуске агента службы "Синхронизация файлов Azure"
Служба "Синхронизация файлов Azure" позволяет централизованно хранить файловые ресурсы организации в службе файлов Azure, обеспечивая гибкость, производительность и совместимость локального файлового сервера. Установки серверов Windows Server преобразовываются в быстрый кэш общего файлового ресурса Azure. Для локального доступа к данным вы можете использовать любой протокол, доступный в Windows Server (в том числе SMB, NFS и FTPS). Кроме того, вы можете создать любое количество кэшей.

В этой статье рассматриваются заметки о выпуске для поддерживаемых версий агента службы "Синхронизация файлов Azure".

## <a name="supported-versions"></a>Поддерживаемые версии
Служба "Синхронизация файлов Azure" поддерживает следующие версии агента:

| Веха | Номер версии агента | Дата выпуска | Состояние |
|----|----------------------|--------------|------------------|
| Версия 10.1 — [KB4522411](https://support.microsoft.com/en-us/help/4522411)| 10.1.0.0 | 5 июня 2020 г. | Поддерживается — перелет |
| Накопительный пакет обновлений за май 2020 г. — [KB4522412](https://support.microsoft.com/help/4522412)| 10.0.2.0 | 19 мая 2020 г. | Поддерживается |
| Выпуск версии 10 — [KB4522409](https://support.microsoft.com/en-us/help/4522409)| 10.0.0.0 | 9 апреля 2020 г. | Поддерживается |
| Накопительный пакет обновлений за декабрь 2019 г. — [KB4522360](https://support.microsoft.com/help/4522360)| 9.1.0.0 | 12 декабря 2019 г. | Поддерживается |
| Выпуск версии 9 — [KB4522359](https://support.microsoft.com/help/4522359)| 9.0.0.0 | 2 декабря 2019 г. | Поддерживается |
| Выпуск версии 8 — [KB4511224](https://support.microsoft.com/help/4511224)| 8.0.0.0 | 8 октября 2019 г. | Поддерживается |
| Накопительный пакет обновлений за июль 2019 г. — [KB4490497](https://support.microsoft.com/help/4490497)| 7.2.0.0 | 24 июля 2019 г. | Поддерживается. срок действия версии агента истекает 1 сентября 2020 г. |
| Накопительный пакет обновлений за июль 2019 г. — [KB4490496](https://support.microsoft.com/help/4490496)| 7.1.0.0 | 12 июля 2019 г. | Поддерживается. срок действия версии агента истекает 1 сентября 2020 г. |
| Выпуск версии 7 — [KB4490495](https://support.microsoft.com/help/4490495)| 7.0.0.0 | 19 июня 2019 г. | Поддерживается. срок действия версии агента истекает 1 сентября 2020 г. |
| Выпуск версии 6 | 6.0.0.0–6.3.0.0 | Недоступно | Не поддерживается. Срок действия версий агента истек 21 апреля 2020 г. |
| Выпуск версии 5 | 5.0.2.0–5.2.0.0 | Недоступно | Не поддерживается. Срок действия версий агента истек 18 марта 2020 г. |
| Выпуск версии 4 | 4.0.1.0–4.3.0.0 | Недоступно | Не поддерживается. Срок действия версий агента истек 6 ноября 2019 г. |
| Выпуск версии 3 | 3.1.0.0–3.4.0.0 | Недоступно | Не поддерживается. Срок действия версий агента истек 19 августа 2019 г. |
| Агенты общедоступной предварительной версии | 1.1.0.0 — 3.0.13.0 | Недоступно | Не поддерживается. Версии агента истекли 1 октября 2018 г. |

### <a name="azure-file-sync-agent-update-policy"></a>Политика обновления агента службы синхронизации файлов Azure
[!INCLUDE [storage-sync-files-agent-update-policy](../../../includes/storage-sync-files-agent-update-policy.md)]

## <a name="agent-version-10100"></a>Версия агента 10.1.0.0
Следующие заметки о выпуске предназначены для версии 10.1.0.0 агента Синхронизация файлов Azure, выпущенного 5 июня 2020 г. Эти примечания являются дополнением к заметкам о выпуске, указанным для версии 10.0.0.0 и 10.0.2.0.

### <a name="improvements-and-issues-that-are-fixed"></a>Улучшения и решенные проблемы

- Поддержка частных конечных точек Azure
    - Трафик синхронизации в службу синхронизации хранилища теперь можно отправить в закрытую конечную точку. Это обеспечивает туннелирование через подключение ExpressRoute или VPN. Дополнительные сведения см. в разделе [Настройка сетевых конечных точек синхронизация файлов Azure](https://docs.microsoft.com/azure/storage/files/storage-sync-files-networking-endpoints).
- Синхронизированная метрика файлов теперь будет отображать ход выполнения при выполнении большой синхронизации, а не в конце.
- Различные улучшения надежности установки агентов, распределения по уровням облака, синхронизации и телеметрии

## <a name="agent-version-10020"></a>Версия агента 10.0.2.0
Приведенные ниже заметки о выпуске предназначены для агента службы "Синхронизация файлов Azure" версии 10.0.2.0 (выпущено 19 мая 2020 г.). Они являются дополнением к заметкам о выпуске для версии 10.0.0.0.

Исправление в этом выпуске:  
- Агент синхронизации хранилища (FileSyncSvc) часто аварийно завершает работу после установки агента службы "Синхронизация файлов Azure" версии 10.

> [!Note]  
>Этот выпуск не был отправлен на серверы, которые настроены на автоматическое обновление при появлении новой версии. Чтобы установить это обновление, воспользуйтесь Центром обновления Майкрософт или каталогом Центра обновления Майкрософт (инструкции по установке см. на [этой странице](https://support.microsoft.com/help/4522412)).

## <a name="agent-version-10000"></a>Версия агента 10.0.0.0
Приведенные ниже заметки о выпуске предназначены для агента службы "Синхронизация файлов Azure" версии 10.0.0.0 (выпущено 9 апреля 2020 г.).

### <a name="improvements-and-issues-that-are-fixed"></a>Улучшения и решенные проблемы

- Улучшен ход выполнения синхронизации на портале
    - С выпуском агента версии 10 на портале Azure в скором времени начнет отображаться тип выполняемого сеанса синхронизации. Пример: первоначальное скачивание, регулярное скачивание, фоновый отзыв (случаи быстрого аварийного восстановления) и т. д. 

- Улучшен интерфейс портала с распределением по уровням в облаке
    - Если у вас есть файлы, которые не удается распределить по уровням или отозвать, можно просмотреть ошибки распределения по уровням в свойствах конечной точки сервера.
    - Дополнительные сведения о распределении по уровням в облаке доступны для конечной точки сервера:
        - размер локального кэша;
        - эффективность использования кэша;
        - сведения о политике распределения по уровням в облаке: размер тома, текущее свободное пространство или время последнего обращения к самому старому файлу в локальном кэше.
    - Эти изменения будут отправлены на портал Azure вскоре после начального выпуска агента версии 10.

- Поддержка перемещения службы синхронизации хранилища и (или) учетной записи хранения в другой клиент Azure Active Directory (AAD)
    - Синхронизация файлов Azure теперь поддерживает перемещение службы синхронизации хранилища и (или) учетной записи хранения в другую группу ресурсов или подписку, а также в другой клиент Azure AD.
    
- Различные улучшения производительности и надежности
    - Обнаружение изменений в общей папке Azure может завершиться ошибкой, если правила виртуальной сети (VNET) и брандмауэра настроены для учетной записи хранения.
    - Уменьшено потребление памяти, связанное с отзывом. 
    - Повышена производительность при использовании командлета [Invoke-AzStorageSyncChangeDetection](https://docs.microsoft.com/powershell/module/az.storagesync/invoke-azstoragesyncchangedetection).
    - Прочие улучшения надежности. 
    
### <a name="evaluation-tool"></a>Средство оценки
Прежде чем развертывать службу "Синхронизация файлов Azure", следует оценить, совместима ли она с вашей системой, с помощью средства оценки этой службы. Это средство является командлетом Azure PowerShell, который проверяет наличие потенциальных проблем с файловой системой и набором данных, таких как неподдерживаемые символы или неподдерживаемая версия операционной системы. Инструкции по установке и использованию см. в разделе о [средстве оценки](https://docs.microsoft.com/azure/storage/files/storage-sync-files-planning#evaluation-cmdlet) руководства по планированию. 

### <a name="agent-installation-and-server-configuration"></a>Установка агента и конфигурация сервера
Дополнительные сведения о том, как установить и настроить агент службы "Синхронизация файлов Azure" с помощью Windows Server, см. в статье о [планировании развертывания службы "Синхронизация файлов Azure"](storage-sync-files-planning.md) и [практическом руководстве по развертыванию службы "Синхронизация файлов Azure"](storage-sync-files-deployment-guide.md).

- Пакет установки агента нужно устанавливать с разрешениями более высокого уровня (администратора).
- Агент не поддерживается в развертывании Nano Server.
- Агент поддерживается только в Windows Server 2019 и Windows Server 2016 и Windows Server 2012 R2.
- Агент требует по крайней мере 2 ГиБ памяти. Если сервер выполняется на виртуальной машине с включенной динамической памятью, в виртуальной машине должна быть настроена память объемом не менее 2048 МиБ.
- Служба агента синхронизации хранилища (FileSyncSvc) не поддерживает конечные точки сервера, которые размещены в томе со сжатым каталогом данных о системном томе (SVI). Использование этой конфигурации может привести к непредвиденным результатам.

### <a name="interoperability"></a>Совместимость
- Антивирусные программы, приложения архивации, а также другие приложения, которые получают доступ к многоуровневым файлам, вызывают нежелательные отзывы, если они не учитывают автономный атрибут и пропускают чтение содержимого этих файлов. Дополнительные сведения см. в статье об [устранении неполадок службы "Синхронизация файлов Azure"](storage-sync-files-troubleshoot.md).
- Фильтры блокировки файлов FSRM могут стать причиной постоянных сбоев синхронизации.
- Выполнение средства sysprep на сервере, где установлен агент службы "Синхронизация файлов Azure", не поддерживается и может привести к непредвиденным результатам. Устанавливать агент Синхронизации файлов Azure нужно после развертывания образа сервера и завершения мини-установки sysprep.

### <a name="sync-limitations"></a>Ограничения синхронизации
Следующие элементы не синхронизируются, но остальная часть системы продолжает работать в обычном режиме:
- Файлы с неподдерживаемыми символами. Со списком неподдерживаемых символов можно ознакомиться в [руководстве по устранению неполадок](storage-sync-files-troubleshoot.md#handling-unsupported-characters).
- Файлы или каталоги, которые оканчиваются точкой.
- Пути длиной более 2048 символов.
- Часть системного списка управления доступом (SACL) в дескрипторе безопасности, который используется для аудита.
- Дополнительные атрибуты.
- Альтернативные потоки данных.
- Точки повторного анализа.
- Жесткие связи.
- Сжатие (для серверного файла) не сохраняется при синхронизации изменений в этом файле из других конечных точек.
- Файлы, зашифрованные с помощью файловой системы EFS (или другого пользовательского режима шифрования). Служба не может считывать такие данные.

    > [!Note]  
    > Служба "Синхронизация файлов Azure" всегда шифрует передаваемые данные. Неактивные данные можно зашифровать в Azure.
 
### <a name="server-endpoint"></a>Конечная точка сервера
- Конечную точку сервера можно создавать только на томе NTFS. Сейчас служба "Синхронизация файлов Azure" не поддерживает ReFS и FAT, FAT32 и другие файловые системы.
- Но для системного тома не поддерживается распределение по уровням облака. Чтобы создать конечную точку сервера на системном томе, отключите распределение по уровням облака при ее создании.
- Отказоустойчивую кластеризацию поддерживают только кластеризованные диски. Общие тома кластера (CSV) ее не поддерживают.
- Конечная точка сервера не может быть вложенной. Она может сосуществовать параллельно с другой конечной точкой на одном томе.
- Не храните файл ОС или файл подкачки приложения в расположении конечной точки сервера.
- В случае переименования сервера его имя на портале не обновляется.

### <a name="cloud-endpoint"></a>Облачная конечная точка
- Служба "Синхронизация файлов Azure" поддерживает внесение изменений непосредственно в файловый ресурс Azure. Однако внесенные изменения сначала должны быть обнаружены заданием обнаружения изменений этой службы. Задание обнаружения изменений инициируется для облачной конечной точки каждые 24 часа. Для немедленной синхронизации файлов, измененных в общей папке Azure, можно использовать командлет PowerShell [Invoke-AzStorageSyncChangeDetection](https://docs.microsoft.com/powershell/module/az.storagesync/invoke-azstoragesyncchangedetection), вручную инициировав обнаружение изменений в общей папке Azure. Кроме того, изменения, внесенные в файловый ресурс Azure с помощью протокола REST, не приведут к обновлению времени последнего изменения SMB и не будут распознаны как изменение службой синхронизации.
- Службу синхронизации хранилища и (или) учетную запись хранения можно переместить в другую группу ресурсов, подписку или клиент Azure AD. После перемещения службы синхронизации хранилища или учетной записи хранения необходимо предоставить приложению Microsoft. StorageSync доступ к учетной записи хранения (см. раздел [обеспечение доступа к учетной записи хранения у синхронизация файлов Azure](https://docs.microsoft.com/azure/storage/files/storage-sync-files-troubleshoot?tabs=portal1%2Cportal#troubleshoot-rbac)).

    > [!Note]  
    > При создании облачной конечной точки служба синхронизации хранилища и учетная запись хранения должны находиться в одном клиенте Azure AD. После создания облачной конечной точки службу синхронизации хранилища и учетную запись хранения можно переместить в другой клиент Azure AD.

### <a name="cloud-tiering"></a>Распределение по уровням облака
- Если многоуровневый файл копируется в другое расположение с помощью Robocopy, полученный файл не будет распределен по уровням. Вы можете задать автономный атрибут, так как Robocopy неправильно включает его в операциях копирования.
- При копировании файлов с помощью robocopy используйте параметр /MIR, чтобы сохранить метки времени файлов. Таким образом, старые файлы будут перемещены на другой уровень раньше, чем файлы, доступ к которым был получен недавно.

## <a name="agent-version-9100"></a>Версия агента 9.1.0.0
Приведенные ниже заметки о выпуске относятся к агенту службы "Синхронизация файлов Azure" версии 9.1.0.0 (выпущено 12 декабря 2019 г.). Они являются дополнением к заметкам о выпуске для версии 9.0.0.0.

Исправление в этом выпуске:  
- Сбой синхронизации с одной из следующих ошибок после обновления агента службы "Синхронизация файлов Azure" до версии 9.0:
    - 0x8e5e044e (JET_errWriteConflict)
    - 0x8e5e0450 (JET_errInvalidSesid)
    - 0x8e5e0442 (JET_errInstanceUnavailable)

## <a name="agent-version-9000"></a>Версия агента 9.0.0.0
Приведенные ниже заметки о выпуске относятся к агенту службы "Синхронизация файлов Azure" версии 9.0.0.0 (выпущено 2 декабря 2019 г.).

### <a name="improvements-and-issues-that-are-fixed"></a>Улучшения и решенные проблемы

- Поддержка автоматического резервного копирования и самостоятельного восстановления
    - Теперь пользователи могут восстанавливать свои файлы с помощью функции предыдущей версии. До выпуска версии 9 функция предыдущей версии не поддерживалась для томов со включенным распределением по уровням в облаке. Эта функция должна быть включена отдельно для каждого тома, на котором имеется конечная точка с включенным распределением по уровням в облаке. Дополнительные сведения см. на следующих ресурсах:  
[Автоматическое резервное копирование и самостоятельное восстановление с помощью предыдущих версий и VSS (служба теневого копирования томов)](https://docs.microsoft.com/azure/storage/files/storage-sync-files-deployment-guide#self-service-restore-through-previous-versions-and-vss-volume-shadow-copy-service). 
 
- Поддержка больших размеров общей папки 
    - Синхронизация файлов Azure теперь поддерживает до 64 ТиБ и 100 млн файлов в одном синхронизированном пространстве имен.  
 
- Поддержка дедупликации данных для Server 2019 
    - Дедупликация данных теперь поддерживается с включенным распределением по уровням в облаке в Windows Server 2019. Для поддержки дедупликации данных в томах с распределением по уровням в облаке необходимо установить обновление Windows [KB4520062](https://support.microsoft.com/help/4520062). 
 
- Оптимизирован минимальный размер для распределения файла по уровню 
    - Минимальный размер файла для распределения файла по уровню теперь зависит от размера кластера файловой системы и составляет два кластера файловой системы. Например, размер кластера файловой системы NTFS по умолчанию равен 4 КБ, а результирующий минимальный размер файла для распределения по уровням равен 8 КБ. 
 
- Командлет проверки возможности подключения к сети 
    - В рамках конфигурации Синхронизации файлов Azure необходимо связаться с несколькими конечными точками службы. У каждой из них есть собственное DNS-имя, которое должно быть доступно серверу. Эти URL-адреса также относятся к региону, в котором зарегистрирован сервер. После регистрации сервера можно использовать командлет проверки подключения (PowerShell и служебная программа регистрации сервера) для тестирования связи со всеми URL-адресами, которые относятся к этому серверу. Этот командлет может быть полезен при устранении неполадок, если незавершенная связь не позволяет серверу в полной мере использовать Синхронизацию файлов Azure. Кроме того, с помощью этого командлета можно настроить конфигурацию прокси-сервера и брандмауэра.  
 
        Чтобы запустить проверку возможности подключения к сети, выполните следующие команды PowerShell: 
 
        Import-Module "C:\Program Files\Azure\StorageSyncAgent\StorageSync.Management.ServerCmdlets.dll"  
        Test-StorageSyncNetworkConnectivity
 
- Улучшение удаления конечной точки сервера при включенном распределении по уровням в облаке 
    - Как и раньше, удаление конечной точки сервера не приводит к удалению файлов в общей папке Azure. Однако поведение точек повторного анализа на локальном сервере изменилось. Точки повторного анализа (указатели на файлы, которые не являются локальными на сервере) теперь удаляются при удалении конечной точки сервера. Полностью кэшированные файлы остаются на сервере. Это улучшение было сделано для предотвращения появления [потерянных многоуровневых файлов](https://docs.microsoft.com/azure/storage/files/storage-sync-files-troubleshoot?tabs=portal1%2Cazure-portal#tiered-files-are-not-accessible-on-the-server-after-deleting-a-server-endpoint) при удалении конечной точки сервера. Если конечная точка сервера создана заново, точки повторного анализа для многоуровневых файлов будут вновь созданы на сервере.  
 
- Улучшения производительности и надежности. 
    - Сокращены сбои при отзыве. Размер отзыва теперь автоматически корректируется в зависимости от пропускной способности сети. 
    - Улучшена производительность скачивания при добавлении нового сервера в группу синхронизации. 
    - Уменьшено число несинхронизированных файлов из-за конфликтов ограничений. 
    - Файлы не удается распределить по уровням или они неожиданно отзываются в определенных сценариях, если путь к конечной точке сервера является точкой подключения тома.
    
### <a name="evaluation-tool"></a>Средство оценки
Прежде чем развертывать службу "Синхронизация файлов Azure", следует оценить, совместима ли она с вашей системой, с помощью средства оценки этой службы. Это средство является командлетом Azure PowerShell, который проверяет наличие потенциальных проблем с файловой системой и набором данных, таких как неподдерживаемые символы или неподдерживаемая версия операционной системы. Инструкции по установке и использованию см. в разделе о [средстве оценки](https://docs.microsoft.com/azure/storage/files/storage-sync-files-planning#evaluation-cmdlet) руководства по планированию. 

### <a name="agent-installation-and-server-configuration"></a>Установка агента и конфигурация сервера
Дополнительные сведения о том, как установить и настроить агент службы "Синхронизация файлов Azure" с помощью Windows Server, см. в статье о [планировании развертывания службы "Синхронизация файлов Azure"](storage-sync-files-planning.md) и [практическом руководстве по развертыванию службы "Синхронизация файлов Azure"](storage-sync-files-deployment-guide.md).

- Пакет установки агента нужно устанавливать с разрешениями более высокого уровня (администратора).
- Агент не поддерживается в развертывании Nano Server.
- Агент поддерживается только в Windows Server 2019 и Windows Server 2016 и Windows Server 2012 R2.
- Агент требует по крайней мере 2 ГиБ памяти. Если сервер выполняется на виртуальной машине с включенной динамической памятью, в виртуальной машине должна быть настроена память объемом не менее 2048 МиБ.
- Служба агента синхронизации хранилища (FileSyncSvc) не поддерживает конечные точки сервера, которые размещены в томе со сжатым каталогом данных о системном томе (SVI). Использование этой конфигурации может привести к непредвиденным результатам.

### <a name="interoperability"></a>Совместимость
- Антивирусные программы, приложения архивации, а также другие приложения, которые получают доступ к многоуровневым файлам, вызывают нежелательные отзывы, если они не учитывают автономный атрибут и пропускают чтение содержимого этих файлов. Дополнительные сведения см. в статье об [устранении неполадок службы "Синхронизация файлов Azure"](storage-sync-files-troubleshoot.md).
- Фильтры блокировки файлов FSRM могут стать причиной постоянных сбоев синхронизации.
- Выполнение средства sysprep на сервере, где установлен агент службы "Синхронизация файлов Azure", не поддерживается и может привести к непредвиденным результатам. Устанавливать агент Синхронизации файлов Azure нужно после развертывания образа сервера и завершения мини-установки sysprep.

### <a name="sync-limitations"></a>Ограничения синхронизации
Следующие элементы не синхронизируются, но остальная часть системы продолжает работать в обычном режиме:
- Файлы с неподдерживаемыми символами. Со списком неподдерживаемых символов можно ознакомиться в [руководстве по устранению неполадок](storage-sync-files-troubleshoot.md#handling-unsupported-characters).
- Файлы или каталоги, которые оканчиваются точкой.
- Пути длиной более 2048 символов.
- Часть списка управления доступом на уровне пользователей (DACL) в дескрипторе безопасности размером более 2 КБ. (Эта проблема возникает только при наличии более 40 записей контроля доступа (ACE) на одном элементе.)
- Часть системного списка управления доступом (SACL) в дескрипторе безопасности, который используется для аудита.
- Дополнительные атрибуты.
- Альтернативные потоки данных.
- Точки повторного анализа.
- Жесткие связи.
- Сжатие (для серверного файла) не сохраняется при синхронизации изменений в этом файле из других конечных точек.
- Файлы, зашифрованные с помощью файловой системы EFS (или другого пользовательского режима шифрования). Служба не может считывать такие данные.

    > [!Note]  
    > Служба "Синхронизация файлов Azure" всегда шифрует передаваемые данные. Неактивные данные можно зашифровать в Azure.
 
### <a name="server-endpoint"></a>Конечная точка сервера
- Конечную точку сервера можно создавать только на томе NTFS. Сейчас служба "Синхронизация файлов Azure" не поддерживает ReFS и FAT, FAT32 и другие файловые системы.
- Многоуровневые файлы станут недоступными для использования, если их не отозвать перед удалением конечной точки сервера. Чтобы восстановить доступ к файлам, повторно создайте конечную точку сервера. Если с момента удаления конечной точки сервера прошло 30 дней или если была удалена конечная точка облака, многоуровневые файлы, которые не были отозваны, станут непригодными для использования. Дополнительные сведения см. в разделе [Распределенные по уровням файлы недоступны на сервере после удаления конечной точки сервера](https://docs.microsoft.com/azure/storage/files/storage-sync-files-troubleshoot?tabs=portal1%2Cazure-portal#tiered-files-are-not-accessible-on-the-server-after-deleting-a-server-endpoint).
- Но для системного тома не поддерживается распределение по уровням облака. Чтобы создать конечную точку сервера на системном томе, отключите распределение по уровням облака при ее создании.
- Отказоустойчивую кластеризацию поддерживают только кластеризованные диски. Общие тома кластера (CSV) ее не поддерживают.
- Конечная точка сервера не может быть вложенной. Она может сосуществовать параллельно с другой конечной точкой на одном томе.
- Не храните файл ОС или файл подкачки приложения в расположении конечной точки сервера.
- В случае переименования сервера его имя на портале не обновляется.

### <a name="cloud-endpoint"></a>Облачная конечная точка
- Служба "Синхронизация файлов Azure" поддерживает внесение изменений непосредственно в файловый ресурс Azure. Однако внесенные изменения сначала должны быть обнаружены заданием обнаружения изменений этой службы. Задание обнаружения изменений инициируется для облачной конечной точки каждые 24 часа. Для немедленной синхронизации файлов, измененных в общей папке Azure, можно использовать командлет PowerShell [Invoke-AzStorageSyncChangeDetection](https://docs.microsoft.com/powershell/module/az.storagesync/invoke-azstoragesyncchangedetection), вручную инициировав обнаружение изменений в общей папке Azure. Кроме того, изменения, внесенные в файловый ресурс Azure с помощью протокола REST, не приведут к обновлению времени последнего изменения SMB и не будут распознаны как изменение службой синхронизации.
- Службу синхронизации хранилища и/или учетную запись хранения можно переместить в другую группу ресурсов или подписку в рамках существующего клиента Azure AD. Если учетная запись хранения перемещена, необходимо предоставить службе Hybrid File Sync доступ к учетной записи хранилища (см. в разделе [Убедитесь, что служба "Синхронизация файлов Azure" имеет доступ к учетной записи хранения](https://docs.microsoft.com/azure/storage/files/storage-sync-files-troubleshoot?tabs=portal1%2Cportal#troubleshoot-rbac)).

    > [!Note]  
    > Служба "Синхронизация файлов Azure" не поддерживает перемещение подписки в другой клиент Azure AD.

### <a name="cloud-tiering"></a>Распределение по уровням облака
- Если многоуровневый файл копируется в другое расположение с помощью Robocopy, полученный файл не будет распределен по уровням. Вы можете задать автономный атрибут, так как Robocopy неправильно включает его в операциях копирования.
- При копировании файлов с помощью robocopy используйте параметр /MIR, чтобы сохранить метки времени файлов. Таким образом, старые файлы будут перемещены на другой уровень раньше, чем файлы, доступ к которым был получен недавно.
- Если файл pagefile.sys находится в томе с включенным распределением по уровням в облаке, возможно, файлы не удастся распределить по уровням. Файл pagefile.sys должен находиться в томе с отключенным распределением по уровням в облаке.

## <a name="agent-version-8000"></a>Версия агента 8.0.0.0
Приведенные ниже заметки о выпуске предназначены для агента службы "Синхронизация файлов Azure" версии 8.0.0.0 (выпущено 8 октября 2019 г.).

### <a name="improvements-and-issues-that-are-fixed"></a>Улучшения и решенные проблемы

- Улучшения производительности восстановления
    - Сокращено время восстановления при использовании Azure Backup. Восстановленные файлы будут синхронизироваться с серверами службы "Синхронизация файлов Azure" гораздо быстрее. 
- Улучшен интерфейс портала с распределением по уровням в облаке  
    - Если у вас есть распределенные по уровням файлы, которые не удается отозвать, можно просмотреть ошибки отзыва в свойствах конечной точки сервера. Кроме того, в сведениях о работоспособности конечной точки сервера теперь будут отображаться ошибки и действия по устранению рисков, если на сервере не загружен драйвер фильтра распределения по уровням в облаке.
- Упрощенная установка агента
    - Модуль Az \ AzureRM PowerShell больше не требуется для регистрации сервера, что ускоряет и упрощает установку.
- Различные улучшения производительности и надежности

### <a name="evaluation-tool"></a>Средство оценки
Прежде чем развертывать службу "Синхронизация файлов Azure", следует оценить, совместима ли она с вашей системой, с помощью средства оценки этой службы. Это средство является командлетом Azure PowerShell, который проверяет наличие потенциальных проблем с файловой системой и набором данных, таких как неподдерживаемые символы или неподдерживаемая версия операционной системы. Инструкции по установке и использованию см. в разделе о [средстве оценки](https://docs.microsoft.com/azure/storage/files/storage-sync-files-planning#evaluation-cmdlet) руководства по планированию. 

### <a name="agent-installation-and-server-configuration"></a>Установка агента и конфигурация сервера
Дополнительные сведения о том, как установить и настроить агент службы "Синхронизация файлов Azure" с помощью Windows Server, см. в статье о [планировании развертывания службы "Синхронизация файлов Azure"](storage-sync-files-planning.md) и [практическом руководстве по развертыванию службы "Синхронизация файлов Azure"](storage-sync-files-deployment-guide.md).

- Пакет установки агента нужно устанавливать с разрешениями более высокого уровня (администратора).
- Агент не поддерживается в развертывании Nano Server.
- Агент поддерживается только в Windows Server 2019 и Windows Server 2016 и Windows Server 2012 R2.
- Агент требует по крайней мере 2 ГиБ памяти. Если сервер выполняется на виртуальной машине с включенной динамической памятью, в виртуальной машине должна быть настроена память объемом не менее 2048 МиБ.
- Служба агента синхронизации хранилища (FileSyncSvc) не поддерживает конечные точки сервера, которые размещены в томе со сжатым каталогом данных о системном томе (SVI). Использование этой конфигурации может привести к непредвиденным результатам.

### <a name="interoperability"></a>Совместимость
- Антивирусные программы, приложения архивации, а также другие приложения, которые получают доступ к многоуровневым файлам, вызывают нежелательные отзывы, если они не учитывают автономный атрибут и пропускают чтение содержимого этих файлов. Дополнительные сведения см. в статье об [устранении неполадок службы "Синхронизация файлов Azure"](storage-sync-files-troubleshoot.md).
- Фильтры блокировки файлов FSRM могут стать причиной постоянных сбоев синхронизации.
- Выполнение средства sysprep на сервере, где установлен агент службы "Синхронизация файлов Azure", не поддерживается и может привести к непредвиденным результатам. Устанавливать агент Синхронизации файлов Azure нужно после развертывания образа сервера и завершения мини-установки sysprep.

### <a name="sync-limitations"></a>Ограничения синхронизации
Следующие элементы не синхронизируются, но остальная часть системы продолжает работать в обычном режиме:
- Файлы с неподдерживаемыми символами. Со списком неподдерживаемых символов можно ознакомиться в [руководстве по устранению неполадок](storage-sync-files-troubleshoot.md#handling-unsupported-characters).
- Файлы или каталоги, которые оканчиваются точкой.
- Пути длиной более 2048 символов.
- Часть списка управления доступом на уровне пользователей (DACL) в дескрипторе безопасности размером более 2 КБ. (Эта проблема возникает только при наличии более 40 записей контроля доступа (ACE) на одном элементе.)
- Часть системного списка управления доступом (SACL) в дескрипторе безопасности, который используется для аудита.
- Дополнительные атрибуты.
- Альтернативные потоки данных.
- Точки повторного анализа.
- Жесткие связи.
- Сжатие (для серверного файла) не сохраняется при синхронизации изменений в этом файле из других конечных точек.
- Файлы, зашифрованные с помощью файловой системы EFS (или другого пользовательского режима шифрования). Служба не может считывать такие данные.

    > [!Note]  
    > Служба "Синхронизация файлов Azure" всегда шифрует передаваемые данные. Неактивные данные можно зашифровать в Azure.
 
### <a name="server-endpoint"></a>Конечная точка сервера
- Конечную точку сервера можно создавать только на томе NTFS. Сейчас служба "Синхронизация файлов Azure" не поддерживает ReFS и FAT, FAT32 и другие файловые системы.
- Многоуровневые файлы станут недоступными для использования, если их не отозвать перед удалением конечной точки сервера. Чтобы восстановить доступ к файлам, повторно создайте конечную точку сервера. Если с момента удаления конечной точки сервера прошло 30 дней или если была удалена конечная точка облака, многоуровневые файлы, которые не были отозваны, станут непригодными для использования. Дополнительные сведения см. в разделе [Распределенные по уровням файлы недоступны на сервере после удаления конечной точки сервера](https://docs.microsoft.com/azure/storage/files/storage-sync-files-troubleshoot?tabs=portal1%2Cazure-portal#tiered-files-are-not-accessible-on-the-server-after-deleting-a-server-endpoint).
- Но для системного тома не поддерживается распределение по уровням облака. Чтобы создать конечную точку сервера на системном томе, отключите распределение по уровням облака при ее создании.
- Отказоустойчивую кластеризацию поддерживают только кластеризованные диски. Общие тома кластера (CSV) ее не поддерживают.
- Конечная точка сервера не может быть вложенной. Она может сосуществовать параллельно с другой конечной точкой на одном томе.
- Не храните файл ОС или файл подкачки приложения в расположении конечной точки сервера.
- В случае переименования сервера его имя на портале не обновляется.

### <a name="cloud-endpoint"></a>Облачная конечная точка
- Служба "Синхронизация файлов Azure" поддерживает внесение изменений непосредственно в файловый ресурс Azure. Однако внесенные изменения сначала должны быть обнаружены заданием обнаружения изменений этой службы. Задание обнаружения изменений инициируется для облачной конечной точки каждые 24 часа. Для немедленной синхронизации файлов, измененных в общей папке Azure, можно использовать командлет PowerShell [Invoke-AzStorageSyncChangeDetection](https://docs.microsoft.com/powershell/module/az.storagesync/invoke-azstoragesyncchangedetection), вручную инициировав обнаружение изменений в общей папке Azure. Кроме того, изменения, внесенные в файловый ресурс Azure с помощью протокола REST, не приведут к обновлению времени последнего изменения SMB и не будут распознаны как изменение службой синхронизации.
- Службу синхронизации хранилища и/или учетную запись хранения можно переместить в другую группу ресурсов или подписку в рамках существующего клиента Azure AD. Если учетная запись хранения перемещена, необходимо предоставить службе Hybrid File Sync доступ к учетной записи хранилища (см. в разделе [Убедитесь, что служба "Синхронизация файлов Azure" имеет доступ к учетной записи хранения](https://docs.microsoft.com/azure/storage/files/storage-sync-files-troubleshoot?tabs=portal1%2Cportal#troubleshoot-rbac)).

    > [!Note]  
    > Служба "Синхронизация файлов Azure" не поддерживает перемещение подписки в другой клиент Azure AD.

### <a name="cloud-tiering"></a>Распределение по уровням облака
- Если многоуровневый файл копируется в другое расположение с помощью Robocopy, полученный файл не будет распределен по уровням. Вы можете задать автономный атрибут, так как Robocopy неправильно включает его в операциях копирования.
- При копировании файлов с помощью robocopy используйте параметр /MIR, чтобы сохранить метки времени файлов. Таким образом, старые файлы будут перемещены на другой уровень раньше, чем файлы, доступ к которым был получен недавно.

## <a name="agent-version-7200"></a>Версия агента 7.2.0.0
Приведенные ниже заметки о выпуске предназначены для агента службы "Синхронизация файлов Azure" версии 7.2.0.0 (выпущено 24 июля 2019 г.). Они являются дополнением к заметкам о выпуске для версии 7.0.0.0.

Список исправлений в этом выпуске:  
- Агент синхронизации хранилища (FileSyncSvc) аварийно завершает работу, если для конфигурация прокси-сервера задано значение null.
- Конечная точка сервера запустит BCDR (ошибка 0x80c80257 — ECS_E_BCDR_IN_PROGRESS), если для нескольких конечных точек на сервере задано одинаковое имя.
- Улучшения надежности распределения по уровням в облаке.

## <a name="agent-version-7100"></a>Версия агента 7.1.0.0
Приведенные ниже заметки о выпуске предназначены для агента службы "Синхронизация файлов Azure" версии 7.1.0.0 (выпущено 12 июля 2019 г.). Они являются дополнением к заметкам о выпуске для версии 7.0.0.0.

Список исправлений в этом выпуске:  
- Получение доступа к расположению конечной точки сервера или его просмотр по протоколу SMB в Windows Server 2012 R2 выполняется очень медленно. 
- Повышение загрузки ЦП после установки агента службы "Синхронизация файлов Azure" версии 6.
- Улучшения телеметрии распределения по уровням в облаке.
- Прочие улучшения надежности при распределении по уровням в облаке и синхронизации.

## <a name="agent-version-7000"></a>Версия агента 7.0.0.0
Приведенные ниже заметки о выпуске предназначены для агента службы "Синхронизация файлов Azure" версии 7.0.0.0 (выпущено 19 июля 2019 г.).

### <a name="improvements-and-issues-that-are-fixed"></a>Улучшения и решенные проблемы

- Поддержка больших размеров общей папки
    - При предварительном просмотре больших общих папок Azure мы также повышаем ограничения поддержки для синхронизации файлов. На этом этапе Синхронизация файлов Azure теперь поддерживает до 25 ТБ и 50 млн файлов в одном синхронизированном пространстве имен. Чтобы подать заявку на использование предварительной версии общей папки большого размера, заполните эту форму https://aka.ms/azurefilesatscalesurvey. 
- Поддержка параметров брандмауэра и виртуальной сети в учетных записях хранения
    - Синхронизация файлов Azure теперь поддерживает параметры брандмауэра и виртуальной сети в учетных записях хранения. Сведения о настройке развертывания для работы с параметрами брандмауэра и виртуальной сети см. в [этом разделе](https://docs.microsoft.com/azure/storage/files/storage-sync-files-deployment-guide?tabs=azure-portal#configure-firewall-and-virtual-network-settings).
- Командлет PowerShell для немедленной синхронизации файлов, измененных в общей папке Azure
    - Для немедленной синхронизации файлов, измененных в общей папке Azure, можно использовать командлет PowerShell Invoke-AzStorageSyncChangeDetection, вручную инициировав обнаружение изменений в общей папке Azure. Этот командлет предназначен для сценариев, в которых определенный тип автоматизированного процесса вносит изменения в общую папку Azure или изменения выполняются администратором (например, перемещение файлов и каталогов в общую папку). Для изменений конечных пользователей рекомендуется установить агент службы "Синхронизация файлов Azure" на виртуальной машине IaaS и предоставить конечным пользователям доступ к общей папке через эту виртуальную машину. Таким образом, все изменения будут быстро синхронизироваться с другими агентами без необходимости использовать командлет Invoke-AzStorageSyncChangeDetection. Дополнительные сведения см. в документации по [Invoke-AzStorageSyncChangeDetection](https://docs.microsoft.com/powershell/module/az.storagesync/invoke-azstoragesyncchangedetection).
- Улучшен интерфейс портала при обнаружении несинхронизированных файлов
    - При наличии файлов, которые не удается синхронизировать, теперь ошибки на портале делятся на временные и постоянные. Временные ошибки обычно устраняются без вмешательства администратора. Например, файл, который используется в данный момент, не будет синхронизироваться до закрытия дескриптора файла. Для постоянных ошибок отображается количество файлов, затронутых определенной ошибкой. Число постоянных ошибок также отображается в столбце несинхронизированных файлов всех конечных точек сервера в группе синхронизации.
- Улучшено восстановление на уровне файлов в Azure Backup
    - Теперь обнаружение и синхронизация с конечной точкой сервера отдельных файлов, восстановленных с помощью Azure Backup, выполняется быстрее.
- Улучшена надежность командлета отзыва распределения по уровням в облаке 
    - Командлет Invoke-StorageSyncFileRecall теперь позволяет клиентам указывать количество повторных попыток и время между попытками для каждого файла, аналогично Robocopy. Ранее этот командлет отзывал все многоуровневые файлы по заданному пути в случайном порядке. С помощью нового параметра -Order этот командлет сначала отзывает самые горячие данные и учитывает политику распределения по уровням в облаке (останавливает отзыв, если выполняется политика даты или объем свободного места тома; в зависимости от того, что происходит раньше).
- Поддержка TLS лишь версии 1.2 (версии TLS 1.0 и 1.1 отключены)
    - Синхронизация файлов Azure теперь поддерживает только использование TLS версии 1.2 на серверах с отключенными версиями TLS 1.0 и 1.1. До этого улучшения регистрация сервера с включенными версиями TLS 1.0 и 1.1 была невозможной.
- Различные улучшения производительности и надежности для синхронизации и распределения по уровням в облаке
    - Этот выпуск содержит несколько улучшений надежности и производительности. Некоторые из них предназначены для повышения эффективности распределения по уровням в облаке и улучшения общего функционирования службы "Синхронизация файлов Azure" в ситуациях с заданным расписанием регулирования полосы пропускания.

### <a name="evaluation-tool"></a>Средство оценки
Прежде чем развертывать службу "Синхронизация файлов Azure", следует оценить, совместима ли она с вашей системой, с помощью средства оценки этой службы. Это средство является командлетом Azure PowerShell, который проверяет наличие потенциальных проблем с файловой системой и набором данных, таких как неподдерживаемые символы или неподдерживаемая версия операционной системы. Инструкции по установке и использованию см. в разделе о [средстве оценки](https://docs.microsoft.com/azure/storage/files/storage-sync-files-planning#evaluation-cmdlet) руководства по планированию. 

### <a name="agent-installation-and-server-configuration"></a>Установка агента и конфигурация сервера
Дополнительные сведения о том, как установить и настроить агент службы "Синхронизация файлов Azure" с помощью Windows Server, см. в статье о [планировании развертывания службы "Синхронизация файлов Azure"](storage-sync-files-planning.md) и [практическом руководстве по развертыванию службы "Синхронизация файлов Azure"](storage-sync-files-deployment-guide.md).

- Пакет установки агента нужно устанавливать с разрешениями более высокого уровня (администратора).
- Агент не поддерживается в развертывании Nano Server.
- Агент поддерживается только в Windows Server 2019 и Windows Server 2016 и Windows Server 2012 R2.
- Агент требует по крайней мере 2 ГиБ памяти. Если сервер выполняется на виртуальной машине с включенной динамической памятью, в виртуальной машине должна быть настроена память объемом не менее 2048 МиБ.
- Служба агента синхронизации хранилища (FileSyncSvc) не поддерживает конечные точки сервера, которые размещены в томе со сжатым каталогом данных о системном томе (SVI). Использование этой конфигурации может привести к непредвиденным результатам.

### <a name="interoperability"></a>Совместимость
- Антивирусные программы, приложения архивации, а также другие приложения, которые получают доступ к многоуровневым файлам, вызывают нежелательные отзывы, если они не учитывают автономный атрибут и пропускают чтение содержимого этих файлов. Дополнительные сведения см. в статье об [устранении неполадок службы "Синхронизация файлов Azure"](storage-sync-files-troubleshoot.md).
- Фильтры блокировки файлов FSRM могут стать причиной постоянных сбоев синхронизации.
- Выполнение средства sysprep на сервере, где установлен агент службы "Синхронизация файлов Azure", не поддерживается и может привести к непредвиденным результатам. Устанавливать агент Синхронизации файлов Azure нужно после развертывания образа сервера и завершения мини-установки sysprep.

### <a name="sync-limitations"></a>Ограничения синхронизации
Следующие элементы не синхронизируются, но остальная часть системы продолжает работать в обычном режиме:
- Файлы с неподдерживаемыми символами. Со списком неподдерживаемых символов можно ознакомиться в [руководстве по устранению неполадок](storage-sync-files-troubleshoot.md#handling-unsupported-characters).
- Файлы или каталоги, которые оканчиваются точкой.
- Пути длиной более 2048 символов.
- Часть списка управления доступом на уровне пользователей (DACL) в дескрипторе безопасности размером более 2 КБ. (Эта проблема возникает только при наличии более 40 записей контроля доступа (ACE) на одном элементе.)
- Часть системного списка управления доступом (SACL) в дескрипторе безопасности, который используется для аудита.
- Дополнительные атрибуты.
- Альтернативные потоки данных.
- Точки повторного анализа.
- Жесткие связи.
- Сжатие (для серверного файла) не сохраняется при синхронизации изменений в этом файле из других конечных точек.
- Файлы, зашифрованные с помощью файловой системы EFS (или другого пользовательского режима шифрования). Служба не может считывать такие данные.

    > [!Note]  
    > Служба "Синхронизация файлов Azure" всегда шифрует передаваемые данные. Неактивные данные можно зашифровать в Azure.
 
### <a name="server-endpoint"></a>Конечная точка сервера
- Конечную точку сервера можно создавать только на томе NTFS. Сейчас служба "Синхронизация файлов Azure" не поддерживает ReFS и FAT, FAT32 и другие файловые системы.
- Многоуровневые файлы станут недоступными для использования, если их не отозвать перед удалением конечной точки сервера. Чтобы восстановить доступ к файлам, повторно создайте конечную точку сервера. Если с момента удаления конечной точки сервера прошло 30 дней или если была удалена конечная точка облака, многоуровневые файлы, которые не были отозваны, станут непригодными для использования.
- Но для системного тома не поддерживается распределение по уровням облака. Чтобы создать конечную точку сервера на системном томе, отключите распределение по уровням облака при ее создании.
- Отказоустойчивую кластеризацию поддерживают только кластеризованные диски. Общие тома кластера (CSV) ее не поддерживают.
- Конечная точка сервера не может быть вложенной. Она может сосуществовать параллельно с другой конечной точкой на одном томе.
- Не храните файл ОС или файл подкачки приложения в расположении конечной точки сервера.
- В случае переименования сервера его имя на портале не обновляется.

### <a name="cloud-endpoint"></a>Облачная конечная точка
- Служба "Синхронизация файлов Azure" поддерживает внесение изменений непосредственно в файловый ресурс Azure. Однако внесенные изменения сначала должны быть обнаружены заданием обнаружения изменений этой службы. Задание обнаружения изменений инициируется для облачной конечной точки каждые 24 часа. Кроме того, изменения, внесенные в файловый ресурс Azure с помощью протокола REST, не приведут к обновлению времени последнего изменения SMB и не будут распознаны как изменение службой синхронизации.
- Службу синхронизации хранилища и/или учетную запись хранения можно переместить в другую группу ресурсов или подписку в рамках существующего клиента Azure AD. Если учетная запись хранения перемещена, необходимо предоставить службе Hybrid File Sync доступ к учетной записи хранилища (см. в разделе [Убедитесь, что служба "Синхронизация файлов Azure" имеет доступ к учетной записи хранения](https://docs.microsoft.com/azure/storage/files/storage-sync-files-troubleshoot?tabs=portal1%2Cportal#troubleshoot-rbac)).

    > [!Note]  
    > Служба "Синхронизация файлов Azure" не поддерживает перемещение подписки в другой клиент Azure AD.

### <a name="cloud-tiering"></a>Распределение по уровням облака
- Если многоуровневый файл копируется в другое расположение с помощью Robocopy, полученный файл не будет распределен по уровням. Вы можете задать автономный атрибут, так как Robocopy неправильно включает его в операциях копирования.
- При копировании файлов с помощью robocopy используйте параметр /MIR, чтобы сохранить метки времени файлов. Таким образом, старые файлы будут перемещены на другой уровень раньше, чем файлы, доступ к которым был получен недавно.

## <a name="agent-version-6300"></a>Версия агента 6.3.0.0
Приведенные ниже заметки о выпуске предназначены для агента службы "Синхронизация файлов Azure" версии 6.3.0.0 (выпущено 27 июня 2019 г.). Они являются дополнением к заметкам о выпуске для версии 6.0.0.0.

Список исправлений в этом выпуске:  
- Получение доступа к расположению конечной точки сервера или его просмотр по протоколу SMB в Windows Server 2012 R2 выполняется очень медленно. 
- Повышение загрузки ЦП после установки агента службы "Синхронизация файлов Azure" версии 6.
- Улучшения телеметрии распределения по уровням в облаке

## <a name="agent-version-6200"></a>Версия агента 6.2.0.0
Приведенные ниже заметки о выпуске предназначены для агента службы "Синхронизация файлов Azure" версии 6.2.0.0 (выпущено 13 июня 2019 г.). Они являются дополнением к заметкам о выпуске для версии 6.0.0.0.

Список исправлений в этом выпуске:  
- После создания конечной точки сервера может наблюдаться высокая загрузка ЦП в случае скачивания файлов при выполнении фонового отзыва.
- Операции синхронизации и распределения по уровням в облаке могут завершаться ошибкой ECS_E_SERVER_CREDENTIAL_NEEDED из-за истечения срока действия токена.
- Отзыв файла может завершиться ошибкой, если URL-адрес для скачивания файла содержит зарезервированные знаки. 

## <a name="agent-version-6100"></a>Версия агента 6.1.0.0
Приведенные ниже заметки о выпуске предназначены для агента службы "Синхронизация файлов Azure" версии 6.1.0.0 (выпущено 6 мая 2019 г.). Они являются дополнением к заметкам о выпуске для версии 6.0.0.0.

Список исправлений в этом выпуске:  
- Центру администрирования Windows не удается отобразить версию агента и конфигурацию конечной точки сервера на серверах с установленным агентом службы "Синхронизация файлов Azure" версии 6.0.

## <a name="agent-version-6000"></a>Версия агента 6.0.0.0
Приведенные ниже заметки о выпуске предназначены для агента службы "Синхронизация файлов Azure" версии 6.0.0.0 (выпущено 22 апреля 2019 г.).

### <a name="improvements-and-issues-that-are-fixed"></a>Улучшения и решенные проблемы

- Поддержка автоматического обновления агента
  - Мы получили ваши отзывы и добавили функцию автоматического обновления в агент сервера службы "Синхронизация файлов Azure". Дополнительные сведения см. в разделе [Политика обновления агента службы "Синхронизация файлов Azure"](https://docs.microsoft.com/azure/storage/files/storage-files-release-notes#azure-file-sync-agent-update-policy).
- Поддержка списков управления доступом (ACL) общей папки Azure
  - Служба "Синхронизация файлов Azure" всегда поддерживала синхронизацию списков ACL между конечными точками сервера, но списки ACL не были синхронизированы с облачной конечной точкой (общая папка Azure). В этом выпуске добавлена поддержка синхронизации списков ACL между серверными и облачными конечными точками.
- Параллельная отправка и скачивание сеансов синхронизации для конечной точки сервера 
  - Конечные точки сервера теперь поддерживают одновременное выполнение отправки и скачивания файлов. Не нужно теперь ждать окончания скачивания, чтобы отправить файлы в общую папку Azure. 
- Новые командлеты распределения по уровням в облаке для получения состояния тома и распределения по уровням
  - Теперь можно использовать два новых командлета PowerShell локального сервера, чтобы получить сведения о распределении по уровням в облаке и отзыве файлов. Они предоставляют доступ к сведениям о журнале из двух каналов событий на сервере:
    - Командлет Get-StorageSyncFileTieringResult выводит список всех файлов и их путей, которые не были распределены по уровням, и причину.
    - Командлет Get-StorageSyncFileRecallResult предоставляет сведения обо всех событиях отзыва файлов. Он выводит список всех отозванных файлов и пути к ним, а также сведения о выполненном или неуспешном отзыве.
  - По умолчанию оба канала событий могут хранить до 1 МБ файлов. Количество файлов, передаваемых в отчет, можно увеличить, увеличив размер канала событий.
- Поддержка режима FIPS
  - Синхронизация файлов Azure теперь поддерживает режим FIPS на серверах с установленным агентом службы "Синхронизация файлов Azure".
    - Перед включением на сервере режима FIPS установите на нем агент службы "Синхронизация файлов Azure" и [модуль PackageManagement ](https://www.powershellgallery.com/packages/PackageManagement/1.1.7.2). Если режим FIPS на сервере уже включен, [скачайте вручную](/powershell/scripting/gallery/how-to/working-with-packages/manual-download) [модуль PackageManagement](https://www.powershellgallery.com/packages/PackageManagement/1.1.7.2) на сервер.
- Прочие улучшения надежности при распределении по уровням в облаке и синхронизации

### <a name="evaluation-tool"></a>Средство оценки
Прежде чем развертывать службу "Синхронизация файлов Azure", следует оценить, совместима ли она с вашей системой, с помощью средства оценки этой службы. Это средство является командлетом Azure PowerShell, который проверяет наличие потенциальных проблем с файловой системой и набором данных, таких как неподдерживаемые символы или неподдерживаемая версия операционной системы. Инструкции по установке и использованию см. в разделе о [средстве оценки](https://docs.microsoft.com/azure/storage/files/storage-sync-files-planning#evaluation-cmdlet) руководства по планированию. 

### <a name="agent-installation-and-server-configuration"></a>Установка агента и конфигурация сервера
Дополнительные сведения о том, как установить и настроить агент службы "Синхронизация файлов Azure" с помощью Windows Server, см. в статье о [планировании развертывания службы "Синхронизация файлов Azure"](storage-sync-files-planning.md) и [практическом руководстве по развертыванию службы "Синхронизация файлов Azure"](storage-sync-files-deployment-guide.md).

- Пакет установки агента нужно устанавливать с разрешениями более высокого уровня (администратора).
- Агент не поддерживается в развертывании Nano Server.
- Агент поддерживается только в Windows Server 2019 и Windows Server 2016 и Windows Server 2012 R2.
- Агент требует по крайней мере 2 ГиБ памяти. Если сервер выполняется на виртуальной машине с включенной динамической памятью, в виртуальной машине должна быть настроена память объемом не менее 2048 МиБ.
- Служба агента синхронизации хранилища (FileSyncSvc) не поддерживает конечные точки сервера, которые размещены в томе со сжатым каталогом данных о системном томе (SVI). Использование этой конфигурации может привести к непредвиденным результатам.

### <a name="interoperability"></a>Совместимость
- Антивирусные программы, приложения архивации, а также другие приложения, которые получают доступ к многоуровневым файлам, вызывают нежелательные отзывы, если они не учитывают автономный атрибут и пропускают чтение содержимого этих файлов. Дополнительные сведения см. в статье об [устранении неполадок службы "Синхронизация файлов Azure"](storage-sync-files-troubleshoot.md).
- Фильтры блокировки файлов FSRM могут стать причиной постоянных сбоев синхронизации.
- Запуск sysprep на сервере, где установлен агент службы "Синхронизация файлов Azure", не поддерживается и может привести к непредвиденным результатам. Устанавливать агент Синхронизации файлов Azure нужно после развертывания образа сервера и завершения мини-установки sysprep.

### <a name="sync-limitations"></a>Ограничения синхронизации
Следующие элементы не синхронизируются, но остальная часть системы продолжает работать в обычном режиме:
- Файлы с неподдерживаемыми символами. Со списком неподдерживаемых символов можно ознакомиться в [руководстве по устранению неполадок](storage-sync-files-troubleshoot.md#handling-unsupported-characters).
- Файлы или каталоги, которые оканчиваются точкой.
- Пути длиной более 2048 символов.
- Часть списка управления доступом на уровне пользователей (DACL) в дескрипторе безопасности размером более 2 КБ. (Эта проблема возникает только при наличии более 40 записей контроля доступа (ACE) на одном элементе.)
- Часть системного списка управления доступом (SACL) в дескрипторе безопасности, который используется для аудита.
- Дополнительные атрибуты.
- Альтернативные потоки данных.
- Точки повторного анализа.
- Жесткие связи.
- Сжатие (для серверного файла) не сохраняется при синхронизации изменений в этом файле из других конечных точек.
- Файлы, зашифрованные с помощью файловой системы EFS (или другого пользовательского режима шифрования). Служба не может считывать такие данные.

    > [!Note]  
    > Служба "Синхронизация файлов Azure" всегда шифрует передаваемые данные. Неактивные данные можно зашифровать в Azure.
 
### <a name="server-endpoint"></a>Конечная точка сервера
- Конечную точку сервера можно создавать только на томе NTFS. Сейчас служба "Синхронизация файлов Azure" не поддерживает ReFS и FAT, FAT32 и другие файловые системы.
- Многоуровневые файлы станут недоступными для использования, если их не отозвать перед удалением конечной точки сервера. Чтобы восстановить доступ к файлам, повторно создайте конечную точку сервера. Если с момента удаления конечной точки сервера прошло 30 дней или если была удалена конечная точка облака, многоуровневые файлы, которые не были отозваны, станут непригодными для использования.
- Но для системного тома не поддерживается распределение по уровням облака. Чтобы создать конечную точку сервера на системном томе, отключите распределение по уровням облака при ее создании.
- Отказоустойчивую кластеризацию поддерживают только кластеризованные диски. Общие тома кластера (CSV) ее не поддерживают.
- Конечная точка сервера не может быть вложенной. Она может сосуществовать параллельно с другой конечной точкой на одном томе.
- Не храните файл ОС или файл подкачки приложения в расположении конечной точки сервера.
- В случае переименования сервера его имя на портале не обновляется.

### <a name="cloud-endpoint"></a>Облачная конечная точка
- Служба "Синхронизация файлов Azure" поддерживает внесение изменений непосредственно в файловый ресурс Azure. Однако внесенные изменения сначала должны быть обнаружены заданием обнаружения изменений этой службы. Задание обнаружения изменений инициируется для облачной конечной точки каждые 24 часа. Кроме того, изменения, внесенные в файловый ресурс Azure с помощью протокола REST, не приведут к обновлению времени последнего изменения SMB и не будут распознаны как изменение службой синхронизации.
- Службу синхронизации хранилища и/или учетную запись хранения можно переместить в другую группу ресурсов или подписку в рамках существующего клиента Azure AD. Если учетная запись хранения перемещена, необходимо предоставить службе Hybrid File Sync доступ к учетной записи хранилища (см. в разделе [Убедитесь, что служба "Синхронизация файлов Azure" имеет доступ к учетной записи хранения](https://docs.microsoft.com/azure/storage/files/storage-sync-files-troubleshoot?tabs=portal1%2Cportal#troubleshoot-rbac)).

    > [!Note]  
    > Служба "Синхронизация файлов Azure" не поддерживает перемещение подписки в другой клиент Azure AD.

### <a name="cloud-tiering"></a>Распределение по уровням облака
- Если многоуровневый файл копируется в другое расположение с помощью Robocopy, полученный файл не будет распределен по уровням. Вы можете задать автономный атрибут, так как Robocopy неправильно включает его в операциях копирования.
- При копировании файлов с помощью robocopy используйте параметр /MIR, чтобы сохранить метки времени файлов. Таким образом, старые файлы будут перемещены на другой уровень раньше, чем файлы, доступ к которым был получен недавно.
- При просмотре свойств файла из клиента SMB автономный атрибут может быть настроен неправильно из-за кэширования метаданных файла по протоколу SMB.

## <a name="agent-version-5200"></a>Версия агента 5.2.0.0
Приведенные ниже заметки о выпуске предназначены для агента службы "Синхронизация файлов Azure" версии 5.2.0.0 (выпущено 4 апреля 2019 г.). Они являются дополнением к заметкам о выпуске для версии 5.0.2.0.

Список исправлений в этом выпуске:  
- Улучшения надежности для функций автономной передачи данных и возобновления передачи данных
- Улучшения синхронизации телеметрии

## <a name="agent-version-5100"></a>Версия агента 5.1.0.0
Приведенные ниже заметки о выпуске предназначены для агента службы "Синхронизация файлов Azure" версии 5.1.0.0 (выпущено 7 марта 2019 г.). Они являются дополнением к заметкам о выпуске для версии 5.0.2.0.

Список исправлений в этом выпуске:  
- Синхронизация файлов может завершаться ошибкой 0x80c8031d (ECS_E_CONCURRENCY_CHECK_FAILED), если на сервере не выполняется перечисление изменений.
- Если файл или сеанс синхронизации получает ошибку 0x80072f78 (WININET_E_INVALID_SERVER_RESPONSE), синхронизация будет выполнять операцию повторно.
- Файлы могут не синхронизироваться с ошибкой 0x80c80203 (ECS_E_SYNC_INVALID_STAGED_FILE).
- При отзыве файлов может наблюдаться использование большого объема памяти.
- Улучшения телеметрии распределения по уровням в облаке 

## <a name="agent-version-5020"></a>Версия агента 5.0.2.0
Следующие заметки о выпуске предназначены для версии агента службы "Синхронизация файлов Azure" 5.0.2.0 (выпущенной 12 февраля 2019 г).

### <a name="improvements-and-issues-that-are-fixed"></a>Улучшения и решенные проблемы

- Поддержка облака Azure для государственных организаций
  - Добавлена поддержка предварительной версии облака Azure для государственных организаций. Для работы с ней требуется разрешенная подписка и специальный агент, скачать который можно с веб-сайта Майкрософт. Чтобы получить доступ к предварительной версии, отправьте письмо на адрес [AzureFiles@microsoft.com](mailto:AzureFiles@microsoft.com).
- Поддержка дедупликации данных
    - Дедупликация данных теперь полностью поддерживается с включенным распределением по уровням в облаке в Windows Server 2016 и Windows Server 2019. Включив дедупликацию в томе с включенным распределением по уровням в облаке, вы можете кэшировать больше файлов локально без выделения дополнительного объема памяти.
- Поддержка передачи данных в автономном режиме (например, с помощью Data Box)
    - Без труда переносите большие объемы данных в службу "Синхронизация файлов" любым удобным способом. Вы можете использовать Azure Data Box, AzCopy и даже сторонние службы миграции. Для получения данных в Azure не требуется высокая пропускная способность — с помощью Data Box достаточно отправить данные по почте. См. дополнительные сведения в статье по [автономной передаче данных](https://aka.ms/AFS/OfflineDataTransfer).
- Повышена скорость синхронизации
    - В версиях, предшествующих этому выпуску, синхронизация для клиентов с несколькими конечными точками сервера в одном и том же томе может выполняться с задержками. Служба "Синхронизация файлов Azure" раз в день создает на сервере временный моментальный снимок VSS для синхронизации файлов с открытыми дескрипторами. Теперь синхронизация нескольких конечных точек в одном и том же томе поддерживается во время активного сеанса синхронизации VSS. Вам больше не нужно ждать завершения сеанса синхронизации VSS, чтобы возобновить синхронизацию на других конечных точках сервера в томе.
- Улучшен мониторинг на портале
    - Теперь на портале службы синхронизации хранилища можно просматривать диаграммы по следующим показателям:
        - количество синхронизированных файлов;
        - размер переданных данных;
        - количество несинхронизированных файлов;
        - размер отозванных данных;
        - состояние подключения к серверу.
    - См. дополнительные сведения в статье [Мониторинг Синхронизации файлов Azure](https://docs.microsoft.com/azure/storage/files/storage-sync-files-monitoring).
- Улучшена масштабируемость и надежность
    - Максимальное число объектов файловой системы (папок и файлов) в каталоге увеличено до 1 000 000. Ранее максимальное количество ограничивалось 200 000.
    - При прерывании передачи больших файлов служба синхронизации попытается возобновить передачу данных вместо их повторной отправки. 

### <a name="evaluation-tool"></a>Средство оценки
Прежде чем развертывать службу "Синхронизация файлов Azure", следует оценить, совместима ли она с вашей системой, с помощью средства оценки этой службы. Это средство является командлетом Azure PowerShell, который проверяет наличие потенциальных проблем с файловой системой и набором данных, таких как неподдерживаемые символы или неподдерживаемая версия операционной системы. Инструкции по установке и использованию см. в разделе о [средстве оценки](https://docs.microsoft.com/azure/storage/files/storage-sync-files-planning#evaluation-cmdlet) руководства по планированию. 

### <a name="agent-installation-and-server-configuration"></a>Установка агента и конфигурация сервера
Дополнительные сведения о том, как установить и настроить агент службы "Синхронизация файлов Azure" с помощью Windows Server, см. в статье о [планировании развертывания службы "Синхронизация файлов Azure"](storage-sync-files-planning.md) и [практическом руководстве по развертыванию службы "Синхронизация файлов Azure"](storage-sync-files-deployment-guide.md).

- Пакет установки агента нужно устанавливать с разрешениями более высокого уровня (администратора).
- Агент не поддерживается в развертываниях Windows Server Core или Nano Server.
- Агент поддерживается только в Windows Server 2019 и Windows Server 2016 и Windows Server 2012 R2.
- Агент требует по крайней мере 2 ГиБ памяти. Если сервер выполняется на виртуальной машине с включенной динамической памятью, в виртуальной машине должна быть настроена память объемом не менее 2048 МиБ.
- Служба агента синхронизации хранилища (FileSyncSvc) не поддерживает конечные точки сервера, которые размещены в томе со сжатым каталогом данных о системном томе (SVI). Использование этой конфигурации может привести к непредвиденным результатам.
- Режим FIPS не поддерживается и должен быть отключен. 

### <a name="interoperability"></a>Совместимость
- Антивирусные программы, приложения архивации, а также другие приложения, которые получают доступ к многоуровневым файлам, вызывают нежелательные отзывы, если они не учитывают автономный атрибут и пропускают чтение содержимого этих файлов. Дополнительные сведения см. в статье об [устранении неполадок службы "Синхронизация файлов Azure"](storage-sync-files-troubleshoot.md).
- Фильтры блокировки файлов FSRM могут стать причиной постоянных сбоев синхронизации.
- Запуск sysprep на сервере, где установлен агент службы "Синхронизация файлов Azure", не поддерживается и может привести к непредвиденным результатам. Устанавливать агент Синхронизации файлов Azure нужно после развертывания образа сервера и завершения мини-установки sysprep.

### <a name="sync-limitations"></a>Ограничения синхронизации
Следующие элементы не синхронизируются, но остальная часть системы продолжает работать в обычном режиме:
- Файлы с неподдерживаемыми символами. Со списком неподдерживаемых символов можно ознакомиться в [руководстве по устранению неполадок](storage-sync-files-troubleshoot.md#handling-unsupported-characters).
- Файлы или каталоги, которые оканчиваются точкой.
- Пути длиной более 2048 символов.
- Часть списка управления доступом на уровне пользователей (DACL) в дескрипторе безопасности размером более 2 КБ. (Эта проблема возникает только при наличии более 40 записей контроля доступа (ACE) на одном элементе.)
- Часть системного списка управления доступом (SACL) в дескрипторе безопасности, который используется для аудита.
- Дополнительные атрибуты.
- Альтернативные потоки данных.
- Точки повторного анализа.
- Жесткие связи.
- Сжатие (для серверного файла) не сохраняется при синхронизации изменений в этом файле из других конечных точек.
- Файлы, зашифрованные с помощью файловой системы EFS (или другого пользовательского режима шифрования). Служба не может считывать такие данные.

    > [!Note]  
    > Служба "Синхронизация файлов Azure" всегда шифрует передаваемые данные. Неактивные данные можно зашифровать в Azure.
 
### <a name="server-endpoint"></a>Конечная точка сервера
- Конечную точку сервера можно создавать только на томе NTFS. Сейчас служба "Синхронизация файлов Azure" не поддерживает ReFS и FAT, FAT32 и другие файловые системы.
- Многоуровневые файлы станут недоступными для использования, если их не отозвать перед удалением конечной точки сервера. Чтобы восстановить доступ к файлам, повторно создайте конечную точку сервера. Если с момента удаления конечной точки сервера прошло 30 дней или если была удалена конечная точка облака, многоуровневые файлы, которые не были отозваны, станут непригодными для использования.
- Но для системного тома не поддерживается распределение по уровням облака. Чтобы создать конечную точку сервера на системном томе, отключите распределение по уровням облака при ее создании.
- Отказоустойчивую кластеризацию поддерживают только кластеризованные диски. Общие тома кластера (CSV) ее не поддерживают.
- Конечная точка сервера не может быть вложенной. Она может сосуществовать параллельно с другой конечной точкой на одном томе.
- Не храните файл ОС или файл подкачки приложения в расположении конечной точки сервера.
- В случае переименования сервера его имя на портале не обновляется.

### <a name="cloud-endpoint"></a>Облачная конечная точка
- Служба "Синхронизация файлов Azure" поддерживает внесение изменений непосредственно в файловый ресурс Azure. Однако внесенные изменения сначала должны быть обнаружены заданием обнаружения изменений этой службы. Задание обнаружения изменений инициируется для облачной конечной точки каждые 24 часа. Кроме того, изменения, внесенные в файловый ресурс Azure с помощью протокола REST, не приведут к обновлению времени последнего изменения SMB и не будут распознаны как изменение службой синхронизации.
- Службу синхронизации хранилища и/или учетную запись хранения можно переместить в другую группу ресурсов или подписку в рамках существующего клиента Azure AD. Если учетная запись хранения перемещена, необходимо предоставить службе Hybrid File Sync доступ к учетной записи хранилища (см. в разделе [Убедитесь, что служба "Синхронизация файлов Azure" имеет доступ к учетной записи хранения](https://docs.microsoft.com/azure/storage/files/storage-sync-files-troubleshoot?tabs=portal1%2Cportal#troubleshoot-rbac)).

    > [!Note]  
    > Служба "Синхронизация файлов Azure" не поддерживает перемещение подписки в другой клиент Azure AD.

### <a name="cloud-tiering"></a>Распределение по уровням облака
- Если многоуровневый файл копируется в другое расположение с помощью Robocopy, полученный файл не будет распределен по уровням. Вы можете задать автономный атрибут, так как Robocopy неправильно включает его в операциях копирования.
- При копировании файлов с помощью robocopy используйте параметр /MIR, чтобы сохранить метки времени файлов. Таким образом, старые файлы будут перемещены на другой уровень раньше, чем файлы, доступ к которым был получен недавно.
- При просмотре свойств файла из клиента SMB автономный атрибут может быть настроен неправильно из-за кэширования метаданных файла по протоколу SMB.
