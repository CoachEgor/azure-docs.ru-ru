---
title: Заметки о выпуске агента службы "Синхронизация файлов Azure" | Документация Майкрософт
description: Заметки о выпуске агента службы "Синхронизация файлов Azure".
services: storage
author: wmgries
ms.service: storage
ms.topic: conceptual
ms.date: 3/16/2020
ms.author: wgries
ms.subservice: files
ms.openlocfilehash: 4cb5a3d471aa3131d3233841cd6450f0a968dfe7
ms.sourcegitcommit: c8a0fbfa74ef7d1fd4d5b2f88521c5b619eb25f8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/05/2020
ms.locfileid: "82800980"
---
# <a name="release-notes-for-the-azure-file-sync-agent"></a>Заметки о выпуске агента службы "Синхронизация файлов Azure"
Служба "Синхронизация файлов Azure" позволяет централизованно хранить файловые ресурсы организации в службе файлов Azure, обеспечивая гибкость, производительность и совместимость локального файлового сервера. Установки серверов Windows Server преобразовываются в быстрый кэш общего файлового ресурса Azure. Для локального доступа к данным вы можете использовать любой протокол, доступный в Windows Server (в том числе SMB, NFS и FTPS). Кроме того, вы можете создать любое количество кэшей.

В этой статье рассматриваются заметки о выпуске для поддерживаемых версий агента службы "Синхронизация файлов Azure".

## <a name="supported-versions"></a>Поддерживаемые версии
Служба "Синхронизация файлов Azure" поддерживает следующие версии агента:

| Веха | Номер версии агента | Дата выпуска | Состояние |
|----|----------------------|--------------|------------------|
| V10, выпуск — [4522409](https://support.microsoft.com/en-us/help/4522409)| 10.0.0.0 | 9 апреля 2020 г. | В полете |
| Накопительный пакет обновления за декабрь 2019 — [KB4522360](https://support.microsoft.com/help/4522360)| 9.1.0.0 | 12 декабря 2019 г. | Поддерживается |
| V9 Release — [KB4522359](https://support.microsoft.com/help/4522359)| 9.0.0.0 | 2 декабря 2019 г. | Поддерживается |
| V8 Release — [KB4511224](https://support.microsoft.com/help/4511224)| 8.0.0.0 | 8 октября 2019 г. | Поддерживается |
| Накопительный пакет обновления за Июль 2019 — [KB4490497](https://support.microsoft.com/help/4490497)| 7.2.0.0 | 24 июля 2019 г. | Поддерживается |
| Накопительный пакет обновления за Июль 2019 — [KB4490496](https://support.microsoft.com/help/4490496)| 7.1.0.0 | 12 июля 2019 г. | Поддерживается |
| Версии 7 Release — [KB4490495](https://support.microsoft.com/help/4490495)| 7.0.0.0 | 19 июня 2019 г. | Поддерживается |
| Накопительный пакет обновления Июнь 2019 — [KB4489739](https://support.microsoft.com/help/4489739)| 6.3.0.0 | 27 июня 2019 г. | Поддерживается — версия агента истечет 21 апреля 2020 г. |
| Накопительный пакет обновления Июнь 2019 — [KB4489738](https://support.microsoft.com/help/4489738)| 6.2.0.0 | 13 июня 2019 г. | Поддерживается — версия агента истечет 21 апреля 2020 г. |
| Пакет обновления 2019 (май) — [KB4489737](https://support.microsoft.com/help/4489737)| 6.1.0.0 | 7 мая, 2019 | Поддерживается — версия агента истечет 21 апреля 2020 г. |
| Выпуск V6 — [KB4489736](https://support.microsoft.com/help/4489736)| 6.0.0.0 | 21 апреля, 2019 | Поддерживается — версия агента истечет 21 апреля 2020 г. |
| Версия V5 | 5.0.2.0 — 5.2.0.0 | Н/Д | Не поддерживается. срок действия версий агента истек 18 марта 2020 г. |
| Выпуск версии 4 | 4.0.1.0 — 4.3.0.0 | Н/Д | Не поддерживается — версии агента истек 6 ноября 2019 |
| V3 выпуск | 3.1.0.0 — 3.4.0.0 | Н/Д | Не поддерживается. срок действия версий агента истек 19 августа, 2019 |
| Агенты с префиксом pre-GA | 1.1.0.0 — 3.0.13.0 | Н/Д | Не поддерживается. Версии агента истекли 1 октября 2018 г. |

### <a name="azure-file-sync-agent-update-policy"></a>Политика обновления агента службы синхронизации файлов Azure
[!INCLUDE [storage-sync-files-agent-update-policy](../../../includes/storage-sync-files-agent-update-policy.md)]

## <a name="agent-version-10000"></a>Версия агента 10.0.0.0
Следующие заметки о выпуске предназначены для версии 10.0.0.0 агента Синхронизация файлов Azure (выпущен 9 апреля 2020).

### <a name="improvements-and-issues-that-are-fixed"></a>Улучшения и решенные проблемы

- Улучшенный ход синхронизации на портале
    - В выпуске агента V10 портал Azure в скором времени начнется отображение типа сеанса синхронизации, который выполняется. Пример: первоначальное скачивание, регулярное скачивание, фоновый отзыв (случаи быстрого аварийного восстановления) и аналогичный. 

- Улучшенный интерфейс портала с распределением по уровням облака
    - Если у вас есть файлы, на которые не удается выполнить отработку отказа или их отзыв, можно просмотреть ошибки уровней в свойствах конечной точки сервера.
    - Дополнительные сведения о распределении по уровням облака доступны для конечной точки сервера.
        - Размер локального кэша
        - Эффективность использования кэша
        - Сведения о политике уровня облака: размер тома, текущее свободное пространство или время последнего обращения к самому старому файлу в локальном кэше.
    - Эти изменения будут поставляться в портал Azure вскоре после первоначального выпуска агента V10.

- Поддержка перемещения службы синхронизации хранилища и (или) учетной записи хранения в другой клиент Azure Active Directory (AAD)
    - Синхронизация файлов Azure теперь поддерживает перемещение службы синхронизации хранилища и (или) учетной записи хранения в другую группу ресурсов, подписку или клиент Azure AD.
    
- Различные улучшения производительности и надежности
    - Обнаружение изменений в файловом ресурсе Azure может завершиться ошибкой, если в учетной записи хранения настроены правила брандмауэра и виртуальной сети.
    - Уменьшение потребления памяти, связанного с отзывом. 
    - Повышение производительности при использовании командлета [Invoke-азсторажесинкчанжедетектион](https://docs.microsoft.com/powershell/module/az.storagesync/invoke-azstoragesyncchangedetection) .
    - Прочие улучшения надежности. 
    
### <a name="evaluation-tool"></a>Средство оценки
Прежде чем развертывать службу "Синхронизация файлов Azure", следует оценить, совместима ли она с вашей системой, с помощью средства оценки этой службы. Это средство является командлетом Azure PowerShell, который проверяет наличие потенциальных проблем с файловой системой и набором данных, таких как неподдерживаемые символы или неподдерживаемая версия операционной системы. Инструкции по установке и использованию см. в разделе о [средстве оценки](https://docs.microsoft.com/azure/storage/files/storage-sync-files-planning#evaluation-cmdlet) руководства по планированию. 

### <a name="agent-installation-and-server-configuration"></a>Установка агента и конфигурация сервера
Дополнительные сведения о том, как установить и настроить агент службы "Синхронизация файлов Azure" с помощью Windows Server, см. в статье о [планировании развертывания службы "Синхронизация файлов Azure"](storage-sync-files-planning.md) и [практическом руководстве по развертыванию службы "Синхронизация файлов Azure"](storage-sync-files-deployment-guide.md).

- Пакет установки агента нужно устанавливать с разрешениями более высокого уровня (администратора).
- Агент не поддерживается при развертывании Nano Server.
- Агент поддерживается только в Windows Server 2019 и Windows Server 2016 и Windows Server 2012 R2.
- Агент требует по крайней мере 2 ГиБ памяти. Если сервер выполняется на виртуальной машине с включенной динамической памятью, в виртуальной машине должна быть настроена память объемом не менее 2048 МиБ.
- Служба агента синхронизации хранилища (FileSyncSvc) не поддерживает конечные точки сервера, которые размещены в томе со сжатым каталогом данных о системном томе (SVI). Использование этой конфигурации может привести к непредвиденным результатам.

### <a name="interoperability"></a>Совместимость
- Антивирусные программы, приложения архивации, а также другие приложения, которые получают доступ к многоуровневым файлам, вызывают нежелательные отзывы, если они не учитывают автономный атрибут и пропускают чтение содержимого этих файлов. Дополнительные сведения см. в статье об [устранении неполадок службы "Синхронизация файлов Azure"](storage-sync-files-troubleshoot.md).
- Фильтры блокировки файлов FSRM могут стать причиной постоянных сбоев синхронизации.
- Запуск программы Sysprep на сервере с установленным агентом Синхронизация файлов Azure не поддерживается и может привести к непредвиденным результатам. Устанавливать агент Синхронизации файлов Azure нужно после развертывания образа сервера и завершения мини-установки sysprep.

### <a name="sync-limitations"></a>Ограничения синхронизации
Следующие элементы не синхронизируются, но остальная часть системы продолжает работать в обычном режиме:
- Файлы с неподдерживаемыми символами. Со списком неподдерживаемых символов можно ознакомиться в [руководстве по устранению неполадок](storage-sync-files-troubleshoot.md#handling-unsupported-characters).
- Файлы или каталоги, которые оканчиваются точкой.
- Пути длиной более 2048 символов.
- Часть системного списка управления доступом (SACL) в дескрипторе безопасности, который используется для аудита.
- Дополнительные атрибуты.
- Альтернативные потоки данных.
- Точки повторного анализа.
- Жесткие связи.
- Сжатие (для серверного файла) не сохраняется при синхронизации изменений в этом файле из других конечных точек.
- Файлы, зашифрованные с помощью файловой системы EFS (или другого пользовательского режима шифрования). Служба не может считывать такие данные.

    > [!Note]  
    > Служба "Синхронизация файлов Azure" всегда шифрует передаваемые данные. Неактивные данные можно зашифровать в Azure.
 
### <a name="server-endpoint"></a>Конечная точка сервера
- Конечную точку сервера можно создавать только на томе NTFS. Сейчас служба "Синхронизация файлов Azure" не поддерживает ReFS и FAT, FAT32 и другие файловые системы.
- Но для системного тома не поддерживается распределение по уровням облака. Чтобы создать конечную точку сервера на системном томе, отключите распределение по уровням облака при ее создании.
- Отказоустойчивую кластеризацию поддерживают только кластеризованные диски. Общие тома кластера (CSV) ее не поддерживают.
- Конечная точка сервера не может быть вложенной. Она может сосуществовать параллельно с другой конечной точкой на одном томе.
- Не храните файл ОС или файл подкачки приложения в расположении конечной точки сервера.
- В случае переименования сервера его имя на портале не обновляется.

### <a name="cloud-endpoint"></a>Облачная конечная точка
- Служба "Синхронизация файлов Azure" поддерживает внесение изменений непосредственно в файловый ресурс Azure. Однако внесенные изменения сначала должны быть обнаружены заданием обнаружения изменений этой службы. Задание обнаружения изменений инициируется для облачной конечной точки каждые 24 часа. Для немедленной синхронизации файлов, измененных в общем файловом ресурсе Azure, можно использовать командлет PowerShell [Invoke-азсторажесинкчанжедетектион](https://docs.microsoft.com/powershell/module/az.storagesync/invoke-azstoragesyncchangedetection) , чтобы вручную инициировать обнаружение изменений в файловом ресурсе Azure. Кроме того, изменения, внесенные в файловый ресурс Azure с помощью протокола REST, не приведут к обновлению времени последнего изменения SMB и не будут распознаны как изменение службой синхронизации.
- Службу синхронизации хранилища и/или учетную запись хранения можно переместить в другую группу ресурсов или подписку в рамках существующего клиента Azure AD. Если учетная запись хранения перемещена, необходимо предоставить службе Hybrid File Sync доступ к учетной записи хранилища (см. в разделе [Убедитесь, что служба "Синхронизация файлов Azure" имеет доступ к учетной записи хранения](https://docs.microsoft.com/azure/storage/files/storage-sync-files-troubleshoot?tabs=portal1%2Cportal#troubleshoot-rbac)).

    > [!Note]  
    > При создании облачной конечной точки служба синхронизации хранилища и учетная запись хранения должны находиться в одном клиенте Azure AD. После создания облачной конечной точки служба синхронизации хранилища и учетная запись хранения могут быть перемещены в разные клиенты Azure AD.

### <a name="cloud-tiering"></a>Распределение по уровням облака
- Если многоуровневый файл копируется в другое расположение с помощью Robocopy, полученный файл не будет распределен по уровням. Вы можете задать автономный атрибут, так как Robocopy неправильно включает его в операциях копирования.
- При копировании файлов с помощью robocopy используйте параметр /MIR, чтобы сохранить метки времени файлов. Таким образом, старые файлы будут перемещены на другой уровень раньше, чем файлы, доступ к которым был получен недавно.

## <a name="agent-version-9100"></a>Версия агента 9.1.0.0
Следующие заметки о выпуске предназначены для версии 9.1.0.0 агента Синхронизация файлов Azure, выпущенного 12 декабря 2019. Эти заметки являются дополнением к заметкам о выпуске, указанным для версии 9.0.0.0.

Проблема исправлена в этом выпуске:  
- Сбой синхронизации с одной из следующих ошибок после обновления до Синхронизация файлов Azure агента версии 9,0:
    - 0x8e5e044e (JET_errWriteConflict)
    - 0x8e5e0450 (JET_errInvalidSesid)
    - 0x8e5e0442 (JET_errInstanceUnavailable)

## <a name="agent-version-9000"></a>Версия агента 9.0.0.0
Следующие заметки о выпуске предназначены для версии 9.0.0.0 агента Синхронизация файлов Azure (выпущено 2 декабря 2019 г.).

### <a name="improvements-and-issues-that-are-fixed"></a>Улучшения и решенные проблемы

- Поддержка самостоятельного восстановления
    - Теперь пользователи могут восстанавливать свои файлы с помощью функции предыдущей версии. До выпуска V9 функция предыдущей версии не поддерживалась на томах с включенным распределением по уровням облака. Эта функция должна быть включена для каждого тома отдельно, на котором существует конечная точка с включенным распределением по уровням облака. Дополнительные сведения см. на следующих ресурсах:  
[Самостоятельное восстановление с помощью предыдущих версий и VSS (служба теневого копирования томов)](https://docs.microsoft.com/azure/storage/files/storage-sync-files-deployment-guide#self-service-restore-through-previous-versions-and-vss-volume-shadow-copy-service). 
 
- Поддержка больших размеров файловых ресурсов 
    - Синхронизация файлов Azure теперь поддерживает до 64TiB и 100 000 000 файлов в одном синхронизированном пространстве имен.  
 
- Поддержка дедупликации данных на сервере 2019 
    - Дедупликация данных теперь поддерживается с включенным распределением по уровням облака в Windows Server 2019. Для поддержки дедупликации данных на томах с распределением по уровням в облаке необходимо установить Windows Update [KB4520062](https://support.microsoft.com/help/4520062) . 
 
- Улучшенный минимальный размер файла для уровня 
    - Минимальный размер файла для уровня теперь определяется размером кластера файловой системы (в два раза размер кластера файловой системы). Например, размер кластера файловой системы NTFS по умолчанию равен 4 КБ, а результирующий минимальный размер файла для уровня равен 8 КБ. 
 
- Командлет проверки сетевого подключения 
    - В рамках конфигурации Синхронизация файлов Azure необходимо связаться с несколькими конечными точками службы. У каждого из них есть собственное DNS-имя, которое должно быть доступно серверу. Эти URL-адреса также относятся к региону, в котором зарегистрирован сервер. После регистрации сервера можно использовать командлет теста подключения (служебную программу для PowerShell и регистрации сервера) для проверки связи со всеми URL-адресами, связанными с этим сервером. Этот командлет может помочь в устранении неполадок, когда незавершенная связь не позволяет серверу полностью работать с Синхронизация файлов Azure и может использоваться для точной настройки конфигурации прокси-сервера и брандмауэра.  
 
        Чтобы запустить проверку сетевого подключения, выполните следующие команды PowerShell: 
 
        Import — Module "C:\Program Филес\азуре\сторажесинкажент\сторажесинк.манажемент.серверкмдлетс.длл"  
        Test-Сторажесинкнетворкконнективити
 
- Удалить серверное улучшение конечной точки при включенном уровне облака 
    - Как и раньше, Удаление конечной точки сервера не приводит к удалению файлов в файловом ресурсе Azure. Однако поведение точек повторного анализа на локальном сервере изменилось. Точки повторного анализа (указатели на файлы, которые не являются локальными на сервере) теперь удаляются при удалении конечной точки сервера. Полностью кэшированные файлы останутся на сервере. Это улучшение было сделано для предотвращения [потерянных многоуровневых файлов](https://docs.microsoft.com/azure/storage/files/storage-sync-files-troubleshoot?tabs=portal1%2Cazure-portal#tiered-files-are-not-accessible-on-the-server-after-deleting-a-server-endpoint) при удалении конечной точки сервера. Если конечная точка сервера создана повторно, точки повторной обработки для многоуровневых файлов будут созданы повторно на сервере.  
 
- Улучшения производительности и надежности. 
    - Сокращены сбои при отзыве. Размер отзыва теперь автоматически корректируется в зависимости от пропускной способности сети. 
    - Улучшена производительность загрузки при добавлении нового сервера в группу синхронизации. 
    - Уменьшено число несинхронизированных файлов из-за конфликтов ограничений. 
    - Файлы не имеют уровня или неожиданно вызываются в определенных сценариях, если путь к конечной точке сервера является точкой подключения тома.
    
### <a name="evaluation-tool"></a>Средство оценки
Прежде чем развертывать службу "Синхронизация файлов Azure", следует оценить, совместима ли она с вашей системой, с помощью средства оценки этой службы. Это средство является командлетом Azure PowerShell, который проверяет наличие потенциальных проблем с файловой системой и набором данных, таких как неподдерживаемые символы или неподдерживаемая версия операционной системы. Инструкции по установке и использованию см. в разделе о [средстве оценки](https://docs.microsoft.com/azure/storage/files/storage-sync-files-planning#evaluation-cmdlet) руководства по планированию. 

### <a name="agent-installation-and-server-configuration"></a>Установка агента и конфигурация сервера
Дополнительные сведения о том, как установить и настроить агент службы "Синхронизация файлов Azure" с помощью Windows Server, см. в статье о [планировании развертывания службы "Синхронизация файлов Azure"](storage-sync-files-planning.md) и [практическом руководстве по развертыванию службы "Синхронизация файлов Azure"](storage-sync-files-deployment-guide.md).

- Пакет установки агента нужно устанавливать с разрешениями более высокого уровня (администратора).
- Агент не поддерживается при развертывании Nano Server.
- Агент поддерживается только в Windows Server 2019 и Windows Server 2016 и Windows Server 2012 R2.
- Агент требует по крайней мере 2 ГиБ памяти. Если сервер выполняется на виртуальной машине с включенной динамической памятью, в виртуальной машине должна быть настроена память объемом не менее 2048 МиБ.
- Служба агента синхронизации хранилища (FileSyncSvc) не поддерживает конечные точки сервера, которые размещены в томе со сжатым каталогом данных о системном томе (SVI). Использование этой конфигурации может привести к непредвиденным результатам.

### <a name="interoperability"></a>Совместимость
- Антивирусные программы, приложения архивации, а также другие приложения, которые получают доступ к многоуровневым файлам, вызывают нежелательные отзывы, если они не учитывают автономный атрибут и пропускают чтение содержимого этих файлов. Дополнительные сведения см. в статье об [устранении неполадок службы "Синхронизация файлов Azure"](storage-sync-files-troubleshoot.md).
- Фильтры блокировки файлов FSRM могут стать причиной постоянных сбоев синхронизации.
- Запуск программы Sysprep на сервере с установленным агентом Синхронизация файлов Azure не поддерживается и может привести к непредвиденным результатам. Устанавливать агент Синхронизации файлов Azure нужно после развертывания образа сервера и завершения мини-установки sysprep.

### <a name="sync-limitations"></a>Ограничения синхронизации
Следующие элементы не синхронизируются, но остальная часть системы продолжает работать в обычном режиме:
- Файлы с неподдерживаемыми символами. Со списком неподдерживаемых символов можно ознакомиться в [руководстве по устранению неполадок](storage-sync-files-troubleshoot.md#handling-unsupported-characters).
- Файлы или каталоги, которые оканчиваются точкой.
- Пути длиной более 2048 символов.
- Часть списка управления доступом на уровне пользователей (DACL) в дескрипторе безопасности размером более 2 КБ. (Эта проблема возникает только при наличии более 40 записей контроля доступа (ACE) на одном элементе.)
- Часть системного списка управления доступом (SACL) в дескрипторе безопасности, который используется для аудита.
- Дополнительные атрибуты.
- Альтернативные потоки данных.
- Точки повторного анализа.
- Жесткие связи.
- Сжатие (для серверного файла) не сохраняется при синхронизации изменений в этом файле из других конечных точек.
- Файлы, зашифрованные с помощью файловой системы EFS (или другого пользовательского режима шифрования). Служба не может считывать такие данные.

    > [!Note]  
    > Служба "Синхронизация файлов Azure" всегда шифрует передаваемые данные. Неактивные данные можно зашифровать в Azure.
 
### <a name="server-endpoint"></a>Конечная точка сервера
- Конечную точку сервера можно создавать только на томе NTFS. Сейчас служба "Синхронизация файлов Azure" не поддерживает ReFS и FAT, FAT32 и другие файловые системы.
- Многоуровневые файлы станут недоступными для использования, если их не отозвать перед удалением конечной точки сервера. Чтобы восстановить доступ к файлам, повторно создайте конечную точку сервера. Если с момента удаления конечной точки сервера прошло 30 дней или если была удалена конечная точка облака, многоуровневые файлы, которые не были отозваны, станут непригодными для использования. Дополнительные сведения см. в разделе [многоуровневые файлы недоступны на сервере после удаления конечной точки сервера](https://docs.microsoft.com/azure/storage/files/storage-sync-files-troubleshoot?tabs=portal1%2Cazure-portal#tiered-files-are-not-accessible-on-the-server-after-deleting-a-server-endpoint).
- Но для системного тома не поддерживается распределение по уровням облака. Чтобы создать конечную точку сервера на системном томе, отключите распределение по уровням облака при ее создании.
- Отказоустойчивую кластеризацию поддерживают только кластеризованные диски. Общие тома кластера (CSV) ее не поддерживают.
- Конечная точка сервера не может быть вложенной. Она может сосуществовать параллельно с другой конечной точкой на одном томе.
- Не храните файл ОС или файл подкачки приложения в расположении конечной точки сервера.
- В случае переименования сервера его имя на портале не обновляется.

### <a name="cloud-endpoint"></a>Облачная конечная точка
- Служба "Синхронизация файлов Azure" поддерживает внесение изменений непосредственно в файловый ресурс Azure. Однако внесенные изменения сначала должны быть обнаружены заданием обнаружения изменений этой службы. Задание обнаружения изменений инициируется для облачной конечной точки каждые 24 часа. Для немедленной синхронизации файлов, измененных в общем файловом ресурсе Azure, можно использовать командлет PowerShell [Invoke-азсторажесинкчанжедетектион](https://docs.microsoft.com/powershell/module/az.storagesync/invoke-azstoragesyncchangedetection) , чтобы вручную инициировать обнаружение изменений в файловом ресурсе Azure. Кроме того, изменения, внесенные в файловый ресурс Azure с помощью протокола REST, не приведут к обновлению времени последнего изменения SMB и не будут распознаны как изменение службой синхронизации.
- Службу синхронизации хранилища и/или учетную запись хранения можно переместить в другую группу ресурсов или подписку в рамках существующего клиента Azure AD. Если учетная запись хранения перемещена, необходимо предоставить службе Hybrid File Sync доступ к учетной записи хранилища (см. в разделе [Убедитесь, что служба "Синхронизация файлов Azure" имеет доступ к учетной записи хранения](https://docs.microsoft.com/azure/storage/files/storage-sync-files-troubleshoot?tabs=portal1%2Cportal#troubleshoot-rbac)).

    > [!Note]  
    > Служба "Синхронизация файлов Azure" не поддерживает перемещение подписки в другой клиент Azure AD.

### <a name="cloud-tiering"></a>Распределение по уровням облака
- Если многоуровневый файл копируется в другое расположение с помощью Robocopy, полученный файл не будет распределен по уровням. Вы можете задать автономный атрибут, так как Robocopy неправильно включает его в операциях копирования.
- При копировании файлов с помощью robocopy используйте параметр /MIR, чтобы сохранить метки времени файлов. Таким образом, старые файлы будут перемещены на другой уровень раньше, чем файлы, доступ к которым был получен недавно.
- Если файл pagefile. sys находится на томе с включенным распределением по уровням облака, возможно, файлы не будут иметь уровень. Файл pagefile. sys должен находиться на томе с отключенным распределением по уровням облака.

## <a name="agent-version-8000"></a>Версия агента 8.0.0.0
Следующие заметки о выпуске предназначены для версии 8.0.0.0 агента Синхронизация файлов Azure (выпущен 8 октября 2019 г.).

### <a name="improvements-and-issues-that-are-fixed"></a>Улучшения и решенные проблемы

- Повышение производительности при восстановлении
    - Более быстрое восстановление после восстановления с помощью Azure Backup. Восстановленные файлы будут синхронизироваться с Синхронизация файлов Azure серверами гораздо быстрее. 
- Улучшенный интерфейс портала с распределением по уровням облака  
    - При наличии многоуровневых файлов, которые не удается отозвать, теперь можно просмотреть ошибки отзыва в свойствах конечной точки сервера. Кроме того, работоспособность конечной точки сервера теперь будет показывать ошибки и меры по устранению рисков, если на сервере не загружен драйвер фильтра по уровням облака.
- Упрощенная установка агента
    - Модуль PowerShell Аз\азурерм больше не требуется для того, чтобы зарегистрировать сервер для упрощения и быстрого выполнения установки.
- Различные улучшения производительности и надежности

### <a name="evaluation-tool"></a>Средство оценки
Прежде чем развертывать службу "Синхронизация файлов Azure", следует оценить, совместима ли она с вашей системой, с помощью средства оценки этой службы. Это средство является командлетом Azure PowerShell, который проверяет наличие потенциальных проблем с файловой системой и набором данных, таких как неподдерживаемые символы или неподдерживаемая версия операционной системы. Инструкции по установке и использованию см. в разделе о [средстве оценки](https://docs.microsoft.com/azure/storage/files/storage-sync-files-planning#evaluation-cmdlet) руководства по планированию. 

### <a name="agent-installation-and-server-configuration"></a>Установка агента и конфигурация сервера
Дополнительные сведения о том, как установить и настроить агент службы "Синхронизация файлов Azure" с помощью Windows Server, см. в статье о [планировании развертывания службы "Синхронизация файлов Azure"](storage-sync-files-planning.md) и [практическом руководстве по развертыванию службы "Синхронизация файлов Azure"](storage-sync-files-deployment-guide.md).

- Пакет установки агента нужно устанавливать с разрешениями более высокого уровня (администратора).
- Агент не поддерживается при развертывании Nano Server.
- Агент поддерживается только в Windows Server 2019 и Windows Server 2016 и Windows Server 2012 R2.
- Агент требует по крайней мере 2 ГиБ памяти. Если сервер выполняется на виртуальной машине с включенной динамической памятью, в виртуальной машине должна быть настроена память объемом не менее 2048 МиБ.
- Служба агента синхронизации хранилища (FileSyncSvc) не поддерживает конечные точки сервера, которые размещены в томе со сжатым каталогом данных о системном томе (SVI). Использование этой конфигурации может привести к непредвиденным результатам.

### <a name="interoperability"></a>Совместимость
- Антивирусные программы, приложения архивации, а также другие приложения, которые получают доступ к многоуровневым файлам, вызывают нежелательные отзывы, если они не учитывают автономный атрибут и пропускают чтение содержимого этих файлов. Дополнительные сведения см. в статье об [устранении неполадок службы "Синхронизация файлов Azure"](storage-sync-files-troubleshoot.md).
- Фильтры блокировки файлов FSRM могут стать причиной постоянных сбоев синхронизации.
- Запуск программы Sysprep на сервере с установленным агентом Синхронизация файлов Azure не поддерживается и может привести к непредвиденным результатам. Устанавливать агент Синхронизации файлов Azure нужно после развертывания образа сервера и завершения мини-установки sysprep.

### <a name="sync-limitations"></a>Ограничения синхронизации
Следующие элементы не синхронизируются, но остальная часть системы продолжает работать в обычном режиме:
- Файлы с неподдерживаемыми символами. Со списком неподдерживаемых символов можно ознакомиться в [руководстве по устранению неполадок](storage-sync-files-troubleshoot.md#handling-unsupported-characters).
- Файлы или каталоги, которые оканчиваются точкой.
- Пути длиной более 2048 символов.
- Часть списка управления доступом на уровне пользователей (DACL) в дескрипторе безопасности размером более 2 КБ. (Эта проблема возникает только при наличии более 40 записей контроля доступа (ACE) на одном элементе.)
- Часть системного списка управления доступом (SACL) в дескрипторе безопасности, который используется для аудита.
- Дополнительные атрибуты.
- Альтернативные потоки данных.
- Точки повторного анализа.
- Жесткие связи.
- Сжатие (для серверного файла) не сохраняется при синхронизации изменений в этом файле из других конечных точек.
- Файлы, зашифрованные с помощью файловой системы EFS (или другого пользовательского режима шифрования). Служба не может считывать такие данные.

    > [!Note]  
    > Служба "Синхронизация файлов Azure" всегда шифрует передаваемые данные. Неактивные данные можно зашифровать в Azure.
 
### <a name="server-endpoint"></a>Конечная точка сервера
- Конечную точку сервера можно создавать только на томе NTFS. Сейчас служба "Синхронизация файлов Azure" не поддерживает ReFS и FAT, FAT32 и другие файловые системы.
- Многоуровневые файлы станут недоступными для использования, если их не отозвать перед удалением конечной точки сервера. Чтобы восстановить доступ к файлам, повторно создайте конечную точку сервера. Если с момента удаления конечной точки сервера прошло 30 дней или если была удалена конечная точка облака, многоуровневые файлы, которые не были отозваны, станут непригодными для использования. Дополнительные сведения см. в разделе [многоуровневые файлы недоступны на сервере после удаления конечной точки сервера](https://docs.microsoft.com/azure/storage/files/storage-sync-files-troubleshoot?tabs=portal1%2Cazure-portal#tiered-files-are-not-accessible-on-the-server-after-deleting-a-server-endpoint).
- Но для системного тома не поддерживается распределение по уровням облака. Чтобы создать конечную точку сервера на системном томе, отключите распределение по уровням облака при ее создании.
- Отказоустойчивую кластеризацию поддерживают только кластеризованные диски. Общие тома кластера (CSV) ее не поддерживают.
- Конечная точка сервера не может быть вложенной. Она может сосуществовать параллельно с другой конечной точкой на одном томе.
- Не храните файл ОС или файл подкачки приложения в расположении конечной точки сервера.
- В случае переименования сервера его имя на портале не обновляется.

### <a name="cloud-endpoint"></a>Облачная конечная точка
- Служба "Синхронизация файлов Azure" поддерживает внесение изменений непосредственно в файловый ресурс Azure. Однако внесенные изменения сначала должны быть обнаружены заданием обнаружения изменений этой службы. Задание обнаружения изменений инициируется для облачной конечной точки каждые 24 часа. Для немедленной синхронизации файлов, измененных в общем файловом ресурсе Azure, можно использовать командлет PowerShell [Invoke-азсторажесинкчанжедетектион](https://docs.microsoft.com/powershell/module/az.storagesync/invoke-azstoragesyncchangedetection) , чтобы вручную инициировать обнаружение изменений в файловом ресурсе Azure. Кроме того, изменения, внесенные в файловый ресурс Azure с помощью протокола REST, не приведут к обновлению времени последнего изменения SMB и не будут распознаны как изменение службой синхронизации.
- Службу синхронизации хранилища и/или учетную запись хранения можно переместить в другую группу ресурсов или подписку в рамках существующего клиента Azure AD. Если учетная запись хранения перемещена, необходимо предоставить службе Hybrid File Sync доступ к учетной записи хранилища (см. в разделе [Убедитесь, что служба "Синхронизация файлов Azure" имеет доступ к учетной записи хранения](https://docs.microsoft.com/azure/storage/files/storage-sync-files-troubleshoot?tabs=portal1%2Cportal#troubleshoot-rbac)).

    > [!Note]  
    > Служба "Синхронизация файлов Azure" не поддерживает перемещение подписки в другой клиент Azure AD.

### <a name="cloud-tiering"></a>Распределение по уровням облака
- Если многоуровневый файл копируется в другое расположение с помощью Robocopy, полученный файл не будет распределен по уровням. Вы можете задать автономный атрибут, так как Robocopy неправильно включает его в операциях копирования.
- При копировании файлов с помощью robocopy используйте параметр /MIR, чтобы сохранить метки времени файлов. Таким образом, старые файлы будут перемещены на другой уровень раньше, чем файлы, доступ к которым был получен недавно.

## <a name="agent-version-7200"></a>Версия агента 7.2.0.0
Следующие заметки о выпуске предназначены для версии 7.2.0.0 агента Синхронизация файлов Azure, выпущенного 24 июля 2019. Эти заметки являются дополнением к заметкам о выпуске, указанным для версии 7.0.0.0.

Список исправлений в этом выпуске:  
- Агент синхронизации хранилища (FileSyncSvc) аварийно завершает работу, если конфигурация прокси-сервера имеет значение null.
- Конечная точка сервера запустится BCDR (ошибка 0x80c80257-ECS_E_BCDR_IN_PROGRESS), если несколько конечных точек на сервере имеют одинаковое имя.
- Улучшения надежности облачных уровней.

## <a name="agent-version-7100"></a>Версия агента 7.1.0.0
Следующие заметки о выпуске предназначены для версии 7.1.0.0 агента Синхронизация файлов Azure, выпущенного 12 июля 2019. Эти заметки являются дополнением к заметкам о выпуске, указанным для версии 7.0.0.0.

Список исправлений в этом выпуске:  
- Доступ или Просмотр расположения конечной точки сервера по протоколу SMB работает очень долго в Windows Server 2012 R2. 
- Повышение загрузки ЦП после установки агента Синхронизация файлов Azure V6.
- Улучшения телеметрии с распределением по уровням облака.
- Прочие улучшения надежности при распределении по уровням в облаке и синхронизации.

## <a name="agent-version-7000"></a>Версия агента 7.0.0.0
Следующие заметки о выпуске предназначены для версии 7.0.0.0 агента Синхронизация файлов Azure (выпущен 19 июня 2019).

### <a name="improvements-and-issues-that-are-fixed"></a>Улучшения и решенные проблемы

- Поддержка больших размеров файловых ресурсов
    - При предварительном просмотре больших файловых ресурсов Azure мы также повышаем ограничения поддержки для синхронизации файлов. В этом первом шаге Синхронизация файлов Azure теперь поддерживает до 25 ТБ и 50 000 000 файлов в одном синхронизированном пространстве имен. Чтобы применить для просмотра большой общей папки, заполните эту форму https://aka.ms/azurefilesatscalesurvey. 
- Поддержка параметров брандмауэра и виртуальной сети в учетных записях хранения
    - Синхронизация файлов Azure теперь поддерживает параметры брандмауэра и виртуальной сети в учетных записях хранения. Сведения о настройке развертывания для работы с брандмауэром и параметром виртуальной сети см. в разделе [Настройка параметров брандмауэра и виртуальной сети](https://docs.microsoft.com/azure/storage/files/storage-sync-files-deployment-guide?tabs=azure-portal#configure-firewall-and-virtual-network-settings).
- Командлет PowerShell для немедленной синхронизации файлов, измененных в общей папке Azure
    - Для немедленной синхронизации файлов, измененных в общем файловом ресурсе Azure, можно использовать командлет PowerShell Invoke-Азсторажесинкчанжедетектион, чтобы вручную инициировать обнаружение изменений в файловом ресурсе Azure. Этот командлет предназначен для сценариев, в которых некоторый тип автоматизированного процесса вносит изменения в общую папку Azure, или изменения выполняются администратором (например, перемещение файлов и каталогов в общую папку). Для изменений конечных пользователей рекомендуется установить агент Синхронизация файлов Azure на виртуальной машине IaaS и предоставить конечным пользователям доступ к общей папке через виртуальную машину IaaS. Таким образом, все изменения будут быстро синхронизироваться с другими агентами без необходимости использовать командлет Invoke-Азсторажесинкчанжедетектион. Дополнительные сведения см. в документации по [Invoke-азсторажесинкчанжедетектион](https://docs.microsoft.com/powershell/module/az.storagesync/invoke-azstoragesyncchangedetection) .
- Улучшенная работа с порталом при обнаружении несинхронизированных файлов
    - При наличии файлов, которые не удается синхронизировать, теперь можно различить временные и постоянные ошибки на портале. Временные ошибки обычно устраняют себя без необходимости вмешательства администратора. Например, файл, который используется в данный момент, не будет синхронизироваться до закрытия этого маркера. Для постоянных ошибок мы видим количество файлов, затронутых каждой ошибкой. Постоянное число ошибок также отображается в столбце файлы не синхронизируются во всех конечных точках сервера в группе синхронизации.
- Улучшен Azure Backup восстановление на уровне файлов
    - Отдельные файлы, восстановленные с помощью Azure Backup, теперь обнаруживаются и синхронизируются с конечной точкой сервера быстрее.
- Улучшена надежность командлета отзыва облачного уровня 
    - Командлет Invoke-Сторажесинкфилерекалл теперь позволяет клиентам указать количество повторных попыток для каждого файла и время повтора для каждого файла, аналогичное Robocopy. Ранее этот командлет отзывает все многоуровневые файлы по заданному пути в случайном порядке. С помощью нового параметра-Order этот командлет сначала отзывает данные активные и учитывает политику распределения по уровням облака (повторный отзыв, если выполняется политика даты или объем свободного места тома; в зависимости от того, что происходит раньше).
- Поддержка только TLS 1,2 (TLS 1,0 и 1,1 отключены)
    - Синхронизация файлов Azure теперь поддерживает использование TLS 1,2 только на серверах с отключенным TLS 1,0 и 1,1. До этого улучшения регистрация сервера не будет выполнена, если TLS 1,0 и 1,1 были отключены на сервере.
- Различные улучшения производительности и надежности для синхронизации и распределения по уровням облака
    - В этом выпуске реализовано несколько улучшений надежности и производительности. Некоторые из них предназначены для повышения эффективности уровня облака и Синхронизация файлов Azure в качестве всей работы в таких ситуациях, когда задано расписание регулирования полосы пропускания.

### <a name="evaluation-tool"></a>Средство оценки
Прежде чем развертывать службу "Синхронизация файлов Azure", следует оценить, совместима ли она с вашей системой, с помощью средства оценки этой службы. Это средство является командлетом Azure PowerShell, который проверяет наличие потенциальных проблем с файловой системой и набором данных, таких как неподдерживаемые символы или неподдерживаемая версия операционной системы. Инструкции по установке и использованию см. в разделе о [средстве оценки](https://docs.microsoft.com/azure/storage/files/storage-sync-files-planning#evaluation-cmdlet) руководства по планированию. 

### <a name="agent-installation-and-server-configuration"></a>Установка агента и конфигурация сервера
Дополнительные сведения о том, как установить и настроить агент службы "Синхронизация файлов Azure" с помощью Windows Server, см. в статье о [планировании развертывания службы "Синхронизация файлов Azure"](storage-sync-files-planning.md) и [практическом руководстве по развертыванию службы "Синхронизация файлов Azure"](storage-sync-files-deployment-guide.md).

- Пакет установки агента нужно устанавливать с разрешениями более высокого уровня (администратора).
- Агент не поддерживается при развертывании Nano Server.
- Агент поддерживается только в Windows Server 2019 и Windows Server 2016 и Windows Server 2012 R2.
- Агент требует по крайней мере 2 ГиБ памяти. Если сервер выполняется на виртуальной машине с включенной динамической памятью, в виртуальной машине должна быть настроена память объемом не менее 2048 МиБ.
- Служба агента синхронизации хранилища (FileSyncSvc) не поддерживает конечные точки сервера, которые размещены в томе со сжатым каталогом данных о системном томе (SVI). Использование этой конфигурации может привести к непредвиденным результатам.

### <a name="interoperability"></a>Совместимость
- Антивирусные программы, приложения архивации, а также другие приложения, которые получают доступ к многоуровневым файлам, вызывают нежелательные отзывы, если они не учитывают автономный атрибут и пропускают чтение содержимого этих файлов. Дополнительные сведения см. в статье об [устранении неполадок службы "Синхронизация файлов Azure"](storage-sync-files-troubleshoot.md).
- Фильтры блокировки файлов FSRM могут стать причиной постоянных сбоев синхронизации.
- Запуск программы Sysprep на сервере с установленным агентом Синхронизация файлов Azure не поддерживается и может привести к непредвиденным результатам. Устанавливать агент Синхронизации файлов Azure нужно после развертывания образа сервера и завершения мини-установки sysprep.

### <a name="sync-limitations"></a>Ограничения синхронизации
Следующие элементы не синхронизируются, но остальная часть системы продолжает работать в обычном режиме:
- Файлы с неподдерживаемыми символами. Со списком неподдерживаемых символов можно ознакомиться в [руководстве по устранению неполадок](storage-sync-files-troubleshoot.md#handling-unsupported-characters).
- Файлы или каталоги, которые оканчиваются точкой.
- Пути длиной более 2048 символов.
- Часть списка управления доступом на уровне пользователей (DACL) в дескрипторе безопасности размером более 2 КБ. (Эта проблема возникает только при наличии более 40 записей контроля доступа (ACE) на одном элементе.)
- Часть системного списка управления доступом (SACL) в дескрипторе безопасности, который используется для аудита.
- Дополнительные атрибуты.
- Альтернативные потоки данных.
- Точки повторного анализа.
- Жесткие связи.
- Сжатие (для серверного файла) не сохраняется при синхронизации изменений в этом файле из других конечных точек.
- Файлы, зашифрованные с помощью файловой системы EFS (или другого пользовательского режима шифрования). Служба не может считывать такие данные.

    > [!Note]  
    > Служба "Синхронизация файлов Azure" всегда шифрует передаваемые данные. Неактивные данные можно зашифровать в Azure.
 
### <a name="server-endpoint"></a>Конечная точка сервера
- Конечную точку сервера можно создавать только на томе NTFS. Сейчас служба "Синхронизация файлов Azure" не поддерживает ReFS и FAT, FAT32 и другие файловые системы.
- Многоуровневые файлы станут недоступными для использования, если их не отозвать перед удалением конечной точки сервера. Чтобы восстановить доступ к файлам, повторно создайте конечную точку сервера. Если с момента удаления конечной точки сервера прошло 30 дней или если была удалена конечная точка облака, многоуровневые файлы, которые не были отозваны, станут непригодными для использования.
- Но для системного тома не поддерживается распределение по уровням облака. Чтобы создать конечную точку сервера на системном томе, отключите распределение по уровням облака при ее создании.
- Отказоустойчивую кластеризацию поддерживают только кластеризованные диски. Общие тома кластера (CSV) ее не поддерживают.
- Конечная точка сервера не может быть вложенной. Она может сосуществовать параллельно с другой конечной точкой на одном томе.
- Не храните файл ОС или файл подкачки приложения в расположении конечной точки сервера.
- В случае переименования сервера его имя на портале не обновляется.

### <a name="cloud-endpoint"></a>Облачная конечная точка
- Служба "Синхронизация файлов Azure" поддерживает внесение изменений непосредственно в файловый ресурс Azure. Однако внесенные изменения сначала должны быть обнаружены заданием обнаружения изменений этой службы. Задание обнаружения изменений инициируется для облачной конечной точки каждые 24 часа. Кроме того, изменения, внесенные в файловый ресурс Azure с помощью протокола REST, не приведут к обновлению времени последнего изменения SMB и не будут распознаны как изменение службой синхронизации.
- Службу синхронизации хранилища и/или учетную запись хранения можно переместить в другую группу ресурсов или подписку в рамках существующего клиента Azure AD. Если учетная запись хранения перемещена, необходимо предоставить службе Hybrid File Sync доступ к учетной записи хранилища (см. в разделе [Убедитесь, что служба "Синхронизация файлов Azure" имеет доступ к учетной записи хранения](https://docs.microsoft.com/azure/storage/files/storage-sync-files-troubleshoot?tabs=portal1%2Cportal#troubleshoot-rbac)).

    > [!Note]  
    > Служба "Синхронизация файлов Azure" не поддерживает перемещение подписки в другой клиент Azure AD.

### <a name="cloud-tiering"></a>Распределение по уровням облака
- Если многоуровневый файл копируется в другое расположение с помощью Robocopy, полученный файл не будет распределен по уровням. Вы можете задать автономный атрибут, так как Robocopy неправильно включает его в операциях копирования.
- При копировании файлов с помощью robocopy используйте параметр /MIR, чтобы сохранить метки времени файлов. Таким образом, старые файлы будут перемещены на другой уровень раньше, чем файлы, доступ к которым был получен недавно.

## <a name="agent-version-6300"></a>Версия агента 6.3.0.0
Следующие заметки о выпуске предназначены для версии 6.3.0.0 агента Синхронизация файлов Azure, выпущенного 27 июня 2019 г. Эти заметки являются дополнением к заметкам о выпуске, указанным для версии 6.0.0.0.

Список исправлений в этом выпуске:  
- Доступ или Просмотр расположения конечной точки сервера по протоколу SMB работает очень долго в Windows Server 2012 R2 
- Повышение загрузки ЦП после установки агента Синхронизация файлов Azure V6
- Улучшения телеметрии с распределением по уровням облака

## <a name="agent-version-6200"></a>Версия агента 6.2.0.0
Следующие заметки о выпуске предназначены для версии 6.2.0.0 агента Синхронизация файлов Azure, выпущенного 13 июня 2019 г. Эти заметки являются дополнением к заметкам о выпуске, указанным для версии 6.0.0.0.

Список исправлений в этом выпуске:  
- После создания конечной точки сервера может произойти высокая загрузка ЦП при скачивании файлов на сервер с помощью фонового отзыва.
- Операции синхронизации и распределения по уровням облака могут завершаться ошибкой ECS_E_SERVER_CREDENTIAL_NEEDED из-за истечения срока действия токена
- Отзыв файла может завершиться ошибкой, если URL-адрес для скачивания файла содержит зарезервированные символы 

## <a name="agent-version-6100"></a>Версия агента 6.1.0.0
Следующие заметки о выпуске предназначены для версии 6.1.0.0 агента Синхронизация файлов Azure, выпущенного 6 мая 2019. Эти заметки являются дополнением к заметкам о выпуске, указанным для версии 6.0.0.0.

Список исправлений в этом выпуске:  
- Центру администрирования Windows не удается отобразить версию агента и конфигурацию конечной точки сервера на серверах с установленным агентом Синхронизация файлов Azure версии 6,0.

## <a name="agent-version-6000"></a>Версия агента 6.0.0.0
Следующие заметки о выпуске предназначены для версии 6.0.0.0 агента Синхронизация файлов Azure (выпущен 22 апреля 2019).

### <a name="improvements-and-issues-that-are-fixed"></a>Улучшения и решенные проблемы

- Поддержка автоматического обновления агентов
  - Мы слышали ваши отзывы и добавили функцию автоматического обновления в агент сервера Синхронизация файлов Azure. Дополнительные сведения см. в разделе [Синхронизация файлов Azure политика обновления агента](https://docs.microsoft.com/azure/storage/files/storage-files-release-notes#azure-file-sync-agent-update-policy).
- Поддержка списков ACL для файловых ресурсов Azure
  - Синхронизация файлов Azure всегда поддерживал синхронизацию списков ACL между конечными точками сервера, но списки ACL не были синхронизированы с облачной конечной точкой (файловый ресурс Azure). В этом выпуске добавлена поддержка синхронизации списков управления доступом между серверными и облачными конечными точками.
- Параллельная отправка и скачивание сеансов синхронизации для конечной точки сервера 
  - Конечные точки сервера теперь поддерживают отправку и загрузку файлов одновременно. Ожидание завершения скачивания не ожидается, поэтому файлы можно отправить в файловый ресурс Azure. 
- Новые командлеты распределения по уровням облака для получения состояния тома и уровня
  - Теперь можно использовать два новых командлета PowerShell для сервера, чтобы получить сведения об уровне облака и отзыве файлов. Они делают данные журнала из двух каналов событий на сервере.
    - Get-Сторажесинкфилетиерингресулт выводит список всех файлов и их путей, которые не были распределены по категориям и по причине.
    - Get-Сторажесинкфилерекаллресулт сообщает обо всех событиях отзыва файлов. В нем перечисляются все отозванные файлы и путь к ним, а также успешный или ошибочный отзыв.
  - По умолчанию оба канала событий могут хранить до 1 МБ каждый — можно увеличить количество файлов, передаваемых в отчет, увеличив размер канала событий.
- Поддержка режима FIPS
  - Синхронизация файлов Azure теперь поддерживает включение режима FIPS на серверах, на которых установлен агент Синхронизация файлов Azure.
    - Перед включением режима FIPS на сервере установите агент Синхронизация файлов Azure и [модуль PackageManagement](https://www.powershellgallery.com/packages/PackageManagement/1.1.7.2) на сервере. Если система FIPS уже включена на сервере, [вручную Скачайте](/powershell/scripting/gallery/how-to/working-with-packages/manual-download) [модуль PackageManagement](https://www.powershellgallery.com/packages/PackageManagement/1.1.7.2) на сервер.
- Различные улучшения надежности для распределения по уровням и синхронизации в облаке

### <a name="evaluation-tool"></a>Средство оценки
Прежде чем развертывать службу "Синхронизация файлов Azure", следует оценить, совместима ли она с вашей системой, с помощью средства оценки этой службы. Это средство является командлетом Azure PowerShell, который проверяет наличие потенциальных проблем с файловой системой и набором данных, таких как неподдерживаемые символы или неподдерживаемая версия операционной системы. Инструкции по установке и использованию см. в разделе о [средстве оценки](https://docs.microsoft.com/azure/storage/files/storage-sync-files-planning#evaluation-cmdlet) руководства по планированию. 

### <a name="agent-installation-and-server-configuration"></a>Установка агента и конфигурация сервера
Дополнительные сведения о том, как установить и настроить агент службы "Синхронизация файлов Azure" с помощью Windows Server, см. в статье о [планировании развертывания службы "Синхронизация файлов Azure"](storage-sync-files-planning.md) и [практическом руководстве по развертыванию службы "Синхронизация файлов Azure"](storage-sync-files-deployment-guide.md).

- Пакет установки агента нужно устанавливать с разрешениями более высокого уровня (администратора).
- Агент не поддерживается при развертывании Nano Server.
- Агент поддерживается только в Windows Server 2019 и Windows Server 2016 и Windows Server 2012 R2.
- Агент требует по крайней мере 2 ГиБ памяти. Если сервер выполняется на виртуальной машине с включенной динамической памятью, в виртуальной машине должна быть настроена память объемом не менее 2048 МиБ.
- Служба агента синхронизации хранилища (FileSyncSvc) не поддерживает конечные точки сервера, которые размещены в томе со сжатым каталогом данных о системном томе (SVI). Использование этой конфигурации может привести к непредвиденным результатам.

### <a name="interoperability"></a>Совместимость
- Антивирусные программы, приложения архивации, а также другие приложения, которые получают доступ к многоуровневым файлам, вызывают нежелательные отзывы, если они не учитывают автономный атрибут и пропускают чтение содержимого этих файлов. Дополнительные сведения см. в статье об [устранении неполадок службы "Синхронизация файлов Azure"](storage-sync-files-troubleshoot.md).
- Фильтры блокировки файлов FSRM могут стать причиной постоянных сбоев синхронизации.
- Запуск sysprep на сервере, где установлен агент службы "Синхронизация файлов Azure", не поддерживается и может привести к непредвиденным результатам. Устанавливать агент Синхронизации файлов Azure нужно после развертывания образа сервера и завершения мини-установки sysprep.

### <a name="sync-limitations"></a>Ограничения синхронизации
Следующие элементы не синхронизируются, но остальная часть системы продолжает работать в обычном режиме:
- Файлы с неподдерживаемыми символами. Со списком неподдерживаемых символов можно ознакомиться в [руководстве по устранению неполадок](storage-sync-files-troubleshoot.md#handling-unsupported-characters).
- Файлы или каталоги, которые оканчиваются точкой.
- Пути длиной более 2048 символов.
- Часть списка управления доступом на уровне пользователей (DACL) в дескрипторе безопасности размером более 2 КБ. (Эта проблема возникает только при наличии более 40 записей контроля доступа (ACE) на одном элементе.)
- Часть системного списка управления доступом (SACL) в дескрипторе безопасности, который используется для аудита.
- Дополнительные атрибуты.
- Альтернативные потоки данных.
- Точки повторного анализа.
- Жесткие связи.
- Сжатие (для серверного файла) не сохраняется при синхронизации изменений в этом файле из других конечных точек.
- Файлы, зашифрованные с помощью файловой системы EFS (или другого пользовательского режима шифрования). Служба не может считывать такие данные.

    > [!Note]  
    > Служба "Синхронизация файлов Azure" всегда шифрует передаваемые данные. Неактивные данные можно зашифровать в Azure.
 
### <a name="server-endpoint"></a>Конечная точка сервера
- Конечную точку сервера можно создавать только на томе NTFS. Сейчас служба "Синхронизация файлов Azure" не поддерживает ReFS и FAT, FAT32 и другие файловые системы.
- Многоуровневые файлы станут недоступными для использования, если их не отозвать перед удалением конечной точки сервера. Чтобы восстановить доступ к файлам, повторно создайте конечную точку сервера. Если с момента удаления конечной точки сервера прошло 30 дней или если была удалена конечная точка облака, многоуровневые файлы, которые не были отозваны, станут непригодными для использования.
- Но для системного тома не поддерживается распределение по уровням облака. Чтобы создать конечную точку сервера на системном томе, отключите распределение по уровням облака при ее создании.
- Отказоустойчивую кластеризацию поддерживают только кластеризованные диски. Общие тома кластера (CSV) ее не поддерживают.
- Конечная точка сервера не может быть вложенной. Она может сосуществовать параллельно с другой конечной точкой на одном томе.
- Не храните файл ОС или файл подкачки приложения в расположении конечной точки сервера.
- В случае переименования сервера его имя на портале не обновляется.

### <a name="cloud-endpoint"></a>Облачная конечная точка
- Служба "Синхронизация файлов Azure" поддерживает внесение изменений непосредственно в файловый ресурс Azure. Однако внесенные изменения сначала должны быть обнаружены заданием обнаружения изменений этой службы. Задание обнаружения изменений инициируется для облачной конечной точки каждые 24 часа. Кроме того, изменения, внесенные в файловый ресурс Azure с помощью протокола REST, не приведут к обновлению времени последнего изменения SMB и не будут распознаны как изменение службой синхронизации.
- Службу синхронизации хранилища и/или учетную запись хранения можно переместить в другую группу ресурсов или подписку в рамках существующего клиента Azure AD. Если учетная запись хранения перемещена, необходимо предоставить службе Hybrid File Sync доступ к учетной записи хранилища (см. в разделе [Убедитесь, что служба "Синхронизация файлов Azure" имеет доступ к учетной записи хранения](https://docs.microsoft.com/azure/storage/files/storage-sync-files-troubleshoot?tabs=portal1%2Cportal#troubleshoot-rbac)).

    > [!Note]  
    > Служба "Синхронизация файлов Azure" не поддерживает перемещение подписки в другой клиент Azure AD.

### <a name="cloud-tiering"></a>Распределение по уровням облака
- Если многоуровневый файл копируется в другое расположение с помощью Robocopy, полученный файл не будет распределен по уровням. Вы можете задать автономный атрибут, так как Robocopy неправильно включает его в операциях копирования.
- При копировании файлов с помощью robocopy используйте параметр /MIR, чтобы сохранить метки времени файлов. Таким образом, старые файлы будут перемещены на другой уровень раньше, чем файлы, доступ к которым был получен недавно.
- При просмотре свойств файла из клиента SMB автономный атрибут может быть настроен неправильно из-за кэширования метаданных файла по протоколу SMB.

## <a name="agent-version-5200"></a>Версия агента 5.2.0.0
Следующие заметки о выпуске предназначены для версии 5.2.0.0 агента Синхронизация файлов Azure, выпущенного 4 апреля 2019 г. Эти заметки являются дополнением к заметкам о выпуске, указанным для версии 5.0.2.0.

Список исправлений в этом выпуске:  
- Улучшения надежности для функций автономной пересылки данных и возобновления пересылки данных
- Усовершенствования синхронизации телеметрии

## <a name="agent-version-5100"></a>Версия агента 5.1.0.0
Следующие заметки о выпуске предназначены для версии 5.1.0.0 агента Синхронизация файлов Azure, выпущенного 7 марта 2019 г. Эти заметки являются дополнением к заметкам о выпуске, указанным для версии 5.0.2.0.

Список исправлений в этом выпуске:  
- Файлы могут не синхронизироваться с ошибкой 0x80c8031d (ECS_E_CONCURRENCY_CHECK_FAILED), если на сервере не выполняется перечисление изменений.
- Если сеанс или файл синхронизации получает ошибку 0x80072F78 (WININET_E_INVALID_SERVER_RESPONSE), синхронизация будет выполнять операцию повторно.
- Файлы могут не синхронизироваться с ошибкой 0x80c80203 (ECS_E_SYNC_INVALID_STAGED_FILE)
- При отзыве файлов может возникнуть высокая степень использования памяти
- Улучшения телеметрии с распределением по уровням облака 

## <a name="agent-version-5020"></a>Версия агента 5.0.2.0
Следующие заметки о выпуске предназначены для версии агента службы "Синхронизация файлов Azure" 5.0.2.0 (выпущенной 12 февраля 2019 г).

### <a name="improvements-and-issues-that-are-fixed"></a>Улучшения и решенные проблемы

- Поддержка облака Azure для государственных организаций
  - Добавлена поддержка предварительной версии облака Azure для государственных организаций. Для работы с ней требуется разрешенная подписка и специальный агент, скачать который можно с веб-сайта Майкрософт. Чтобы получить доступ к предварительной версии, напишите нам непосредственно по [AzureFiles@microsoft.com](mailto:AzureFiles@microsoft.com)адресу.
- Поддержка дедупликации данных
    - Дедупликация данных теперь полностью поддерживается с включенным распределением по уровням в облаке в Windows Server 2016 и Windows Server 2019. Включив дедупликацию в томе с включенным распределением по уровням в облаке, вы можете кэшировать больше файлов локально без выделения дополнительного объема памяти.
- Поддержка передачи данных в автономном режиме (например, с помощью Data Box)
    - Без труда переносите большие объемы данных в службу "Синхронизация файлов" любым удобным способом. Вы можете выбрать Azure Data Box, AzCopy и даже сторонние службы миграции. Для получения данных в Azure не требуется высокая пропускная способность — с помощью Data Box достаточно отправить данные по почте. См. дополнительные сведения в статье по [автономной передаче данных](https://aka.ms/AFS/OfflineDataTransfer).
- Повышена скорость синхронизации
    - В версиях, предшествующих этому выпуску, синхронизация для клиентов с несколькими конечными точками сервера в одном и том же томе может выполняться с задержками. Служба "Синхронизация файлов Azure" раз в день создает на сервере временный моментальный снимок VSS для синхронизации файлов с открытыми дескрипторами. Теперь синхронизация нескольких конечных точек в одном и том же томе поддерживается во время активного сеанса синхронизации VSS. Вам больше не нужно ждать завершения сеанса синхронизации VSS, чтобы возобновить синхронизацию на других конечных точках сервера в томе.
- Улучшен мониторинг на портале
    - Теперь на портале службы синхронизации хранилища можно просматривать диаграммы по следующим показателям:
        - количество синхронизированных файлов;
        - размер переданных данных;
        - количество несинхронизированных файлов;
        - размер отозванных данных;
        - состояние подключения к серверу.
    - См. дополнительные сведения в статье [Мониторинг Синхронизации файлов Azure](https://docs.microsoft.com/azure/storage/files/storage-sync-files-monitoring).
- Улучшена масштабируемость и надежность
    - Максимальное число объектов файловой системы (папок и файлов) в каталоге увеличено до 1 000 000. Ранее максимальное количество ограничивалось 200 000.
    - При прерывании передачи больших файлов служба синхронизации попытается возобновить передачу данных вместо их повторной отправки. 

### <a name="evaluation-tool"></a>Средство оценки
Прежде чем развертывать службу "Синхронизация файлов Azure", следует оценить, совместима ли она с вашей системой, с помощью средства оценки этой службы. Это средство является командлетом Azure PowerShell, который проверяет наличие потенциальных проблем с файловой системой и набором данных, таких как неподдерживаемые символы или неподдерживаемая версия операционной системы. Инструкции по установке и использованию см. в разделе о [средстве оценки](https://docs.microsoft.com/azure/storage/files/storage-sync-files-planning#evaluation-cmdlet) руководства по планированию. 

### <a name="agent-installation-and-server-configuration"></a>Установка агента и конфигурация сервера
Дополнительные сведения о том, как установить и настроить агент службы "Синхронизация файлов Azure" с помощью Windows Server, см. в статье о [планировании развертывания службы "Синхронизация файлов Azure"](storage-sync-files-planning.md) и [практическом руководстве по развертыванию службы "Синхронизация файлов Azure"](storage-sync-files-deployment-guide.md).

- Пакет установки агента нужно устанавливать с разрешениями более высокого уровня (администратора).
- Агент не поддерживается в развертываниях Windows Server Core или Nano Server.
- Агент поддерживается только в Windows Server 2019 и Windows Server 2016 и Windows Server 2012 R2.
- Агент требует по крайней мере 2 ГиБ памяти. Если сервер выполняется на виртуальной машине с включенной динамической памятью, в виртуальной машине должна быть настроена память объемом не менее 2048 МиБ.
- Служба агента синхронизации хранилища (FileSyncSvc) не поддерживает конечные точки сервера, которые размещены в томе со сжатым каталогом данных о системном томе (SVI). Использование этой конфигурации может привести к непредвиденным результатам.
- Режим FIPS не поддерживается и должен быть отключен. 

### <a name="interoperability"></a>Совместимость
- Антивирусные программы, приложения архивации, а также другие приложения, которые получают доступ к многоуровневым файлам, вызывают нежелательные отзывы, если они не учитывают автономный атрибут и пропускают чтение содержимого этих файлов. Дополнительные сведения см. в статье об [устранении неполадок службы "Синхронизация файлов Azure"](storage-sync-files-troubleshoot.md).
- Фильтры блокировки файлов FSRM могут стать причиной постоянных сбоев синхронизации.
- Запуск sysprep на сервере, где установлен агент службы "Синхронизация файлов Azure", не поддерживается и может привести к непредвиденным результатам. Устанавливать агент Синхронизации файлов Azure нужно после развертывания образа сервера и завершения мини-установки sysprep.

### <a name="sync-limitations"></a>Ограничения синхронизации
Следующие элементы не синхронизируются, но остальная часть системы продолжает работать в обычном режиме:
- Файлы с неподдерживаемыми символами. Со списком неподдерживаемых символов можно ознакомиться в [руководстве по устранению неполадок](storage-sync-files-troubleshoot.md#handling-unsupported-characters).
- Файлы или каталоги, которые оканчиваются точкой.
- Пути длиной более 2048 символов.
- Часть списка управления доступом на уровне пользователей (DACL) в дескрипторе безопасности размером более 2 КБ. (Эта проблема возникает только при наличии более 40 записей контроля доступа (ACE) на одном элементе.)
- Часть системного списка управления доступом (SACL) в дескрипторе безопасности, который используется для аудита.
- Дополнительные атрибуты.
- Альтернативные потоки данных.
- Точки повторного анализа.
- Жесткие связи.
- Сжатие (для серверного файла) не сохраняется при синхронизации изменений в этом файле из других конечных точек.
- Файлы, зашифрованные с помощью файловой системы EFS (или другого пользовательского режима шифрования). Служба не может считывать такие данные.

    > [!Note]  
    > Служба "Синхронизация файлов Azure" всегда шифрует передаваемые данные. Неактивные данные можно зашифровать в Azure.
 
### <a name="server-endpoint"></a>Конечная точка сервера
- Конечную точку сервера можно создавать только на томе NTFS. Сейчас служба "Синхронизация файлов Azure" не поддерживает ReFS и FAT, FAT32 и другие файловые системы.
- Многоуровневые файлы станут недоступными для использования, если их не отозвать перед удалением конечной точки сервера. Чтобы восстановить доступ к файлам, повторно создайте конечную точку сервера. Если с момента удаления конечной точки сервера прошло 30 дней или если была удалена конечная точка облака, многоуровневые файлы, которые не были отозваны, станут непригодными для использования.
- Но для системного тома не поддерживается распределение по уровням облака. Чтобы создать конечную точку сервера на системном томе, отключите распределение по уровням облака при ее создании.
- Отказоустойчивую кластеризацию поддерживают только кластеризованные диски. Общие тома кластера (CSV) ее не поддерживают.
- Конечная точка сервера не может быть вложенной. Она может сосуществовать параллельно с другой конечной точкой на одном томе.
- Не храните файл ОС или файл подкачки приложения в расположении конечной точки сервера.
- В случае переименования сервера его имя на портале не обновляется.

### <a name="cloud-endpoint"></a>Облачная конечная точка
- Служба "Синхронизация файлов Azure" поддерживает внесение изменений непосредственно в файловый ресурс Azure. Однако внесенные изменения сначала должны быть обнаружены заданием обнаружения изменений этой службы. Задание обнаружения изменений инициируется для облачной конечной точки каждые 24 часа. Кроме того, изменения, внесенные в файловый ресурс Azure с помощью протокола REST, не приведут к обновлению времени последнего изменения SMB и не будут распознаны как изменение службой синхронизации.
- Службу синхронизации хранилища и/или учетную запись хранения можно переместить в другую группу ресурсов или подписку в рамках существующего клиента Azure AD. Если учетная запись хранения перемещена, необходимо предоставить службе Hybrid File Sync доступ к учетной записи хранилища (см. в разделе [Убедитесь, что служба "Синхронизация файлов Azure" имеет доступ к учетной записи хранения](https://docs.microsoft.com/azure/storage/files/storage-sync-files-troubleshoot?tabs=portal1%2Cportal#troubleshoot-rbac)).

    > [!Note]  
    > Служба "Синхронизация файлов Azure" не поддерживает перемещение подписки в другой клиент Azure AD.

### <a name="cloud-tiering"></a>Распределение по уровням облака
- Если многоуровневый файл копируется в другое расположение с помощью Robocopy, полученный файл не будет распределен по уровням. Вы можете задать автономный атрибут, так как Robocopy неправильно включает его в операциях копирования.
- При копировании файлов с помощью robocopy используйте параметр /MIR, чтобы сохранить метки времени файлов. Таким образом, старые файлы будут перемещены на другой уровень раньше, чем файлы, доступ к которым был получен недавно.
- При просмотре свойств файла из клиента SMB автономный атрибут может быть настроен неправильно из-за кэширования метаданных файла по протоколу SMB.
