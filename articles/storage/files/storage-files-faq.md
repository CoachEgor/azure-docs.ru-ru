---
title: Часто задаваемые вопросы о службе файлов Azure | Документация Майкрософт
description: Получите ответы на некоторые часто задаваемые вопросы о службе "Файлы Azure".
services: storage
author: roygara
ms.service: storage
ms.date: 01/02/2019
ms.author: rogarana
ms.subservice: files
ms.topic: conceptual
ms.openlocfilehash: 4186af31e17acea09e6b3c1a0121d2fcbe63f800
ms.sourcegitcommit: 2028fc790f1d265dc96cf12d1ee9f1437955ad87
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/30/2019
ms.locfileid: "64917610"
---
# <a name="frequently-asked-questions-faq-about-azure-files"></a>Часто задаваемые вопросы о службе файлов Azure
[Служба файлов Azure](storage-files-introduction.md) предоставляет полностью управляемые общие файловые ресурсы в облаке, доступ к которым можно получить с помощью стандартного отраслевого [протокола SMB](https://msdn.microsoft.com/library/windows/desktop/aa365233.aspx). Общие ресурсы службы файлов Azure можно одновременно подключить к облачным или локальным развертываниям Windows, Linux и macOS. Вы также можете кэшировать общие файловые ресурсы Azure на компьютерах под управлением Windows Server с помощью функции "Синхронизация файлов Azure", чтобы получить быстрый доступ из расположения, где используются данные.

В этой статье приведены ответы на часто задаваемые вопросы о возможностях и функциях службы файлов Azure, включая использование синхронизации файлов Azure в отношении этой службы. Если вы не нашли ответ на свой вопрос, свяжитесь с нами, используя следующие каналы (в порядке эскалации):

1. Раздел комментариев этой статьи.
2. [Форум службы хранилища Azure](https://social.msdn.microsoft.com/forums/azure/home?forum=windowsazuredata).
3. [UserVoice службы файлов Azure](https://feedback.azure.com/forums/217298-storage/category/180670-files). 
4. Служба поддержки Майкрософт. Чтобы создать запрос на поддержку на портале Azure, на вкладке **Справка** нажмите кнопку **Справка и поддержка**, а затем выберите **Новый запрос на поддержку**.

## <a name="general"></a>Общие сведения
* <a id="why-files-useful"></a>
  **Чем полезна служба файлов Azure?**  
   Вы можете использовать эту службу, чтобы создавать общие файловые ресурсы в облаке без необходимости управления дополнительными нагрузками физического сервера, устройства или модуля. Всю эту монотонную работу мы делаем за вас, включая обновления ОС и замену неработоспособных дисков. Дополнительные сведения о сценариях, для работы с которыми будет полезна служба файлов Azure, см. в разделе [Зачем нужна служба файлов Azure](storage-files-introduction.md#why-azure-files-is-useful).

* <a id="file-access-options"></a>
  **Какие имеются способы доступа к файлам в службе файлов Azure?**  
    Вы можете подключить общую папку на локальном компьютере с помощью протокола SMB 3.0 или использовать такие средства, как [обозреватель службы хранилища](https://storageexplorer.com/), для доступа к файлам в общей папке. Для доступа к файлам в общем файловом ресурсе Azure из приложения можно использовать клиентские библиотеки хранилища, REST API, PowerShell или Azure CLI.

* <a id="what-is-afs"></a>
  **Что такое служба "Синхронизация файлов Azure"?**  
    Вы можете использовать службу синхронизации файлов Azure, чтобы централизованно хранить файловые ресурсы организации в службе файлов Azure, обеспечивая гибкость, производительность и совместимость локального файлового сервера. Это достигается путем преобразования компьютеров Windows Server в быстрый кэш общего файлового ресурса Azure. Для локального доступа к данным вы можете использовать любой протокол, в том числе SMB, NFS и FTPS, доступный в Windows Server. Кроме того, вы можете создать любое количество кэшей в любом регионе.

* <a id="files-versus-blobs"></a>
  **Почему для хранения данных предпочтительнее использовать файловый ресурс Azure, а не хранилище BLOB-объектов Azure?**  
    Эти службы позволяют хранить большой объем данных в облаке, но их предназначение несколько различно. 
    
    Хранилище BLOB-объектов Azure можно использовать для облачных приложений с широкими возможностями масштабирования для хранения неструктурированных данных. Чтобы добиться максимальной производительности и масштабируемости, лучше не использовать хранилище BLOB-объектов Azure, так как в сравнении с реальной файловой системой оно представляет собой упрощенный вариант хранения. Доступ к хранилищу BLOB-объектов Azure можно получить только с помощью клиентских библиотек на основе REST (или напрямую через протокол REST).

    Служба файлов Azure главным образом представляет собой файловую систему. Служба "Файлы Azure" содержит все известные вам абстракции, связанные с файлами, с которыми вы знакомы в течение длительного времени использования локальных операционных систем. Как и хранилище BLOB-объектов Azure, служба "Файлы Azure" предлагает интерфейс REST и клиентские библиотеки на основе REST. Разница состоит в том, что служба "Файлы Azure" также предлагает доступ к файловым ресурсам Azure по SMB. Используя протокол SMB, можно напрямую подключить файловый ресурс Azure в Windows, Linux, macOS, локально или на виртуальных машинах в облаке без необходимости написания кода или подключения каких-либо специальных драйверов к файловой системе. Вы также можете кэшировать общие файловые ресурсы Azure на локальных файловых серверах с помощью службы "Синхронизация файлов Azure", чтобы получить быстрый доступ из расположения, где используются данные. 
   
    Дополнительные сведения о различиях между службой "Файлы Azure" и хранилищем BLOB-объектов Azure см. в статье [Выбор между большими двоичными объектами Azure, службой файлов Azure и дисками Azure](../common/storage-decide-blobs-files-disks.md). Дополнительные сведения о хранилище BLOB-объектов Azure см. в статье [Общие сведения о хранилище BLOB-объектов](../blobs/storage-blobs-introduction.md).

* <a id="files-versus-disks"></a>**Почему предпочтительнее использовать файловый ресурс Azure, а не диски Azure?**  
    Диски Azure — это обычные диски. Чтобы диск Azure стал полезен, его необходимо подключить к виртуальной машине, работающей в Azure. С дисками Azure можно работать во всех случаях, когда их использование на локальном сервере практично. Диск Azure можно использовать как системный диск ОС, область буфера ОС или выделенное хранилище приложения. Интересный способ использования дисков Azure — это создание файлового сервера в облаке для использования в тех же расположениях, в которых используется файловый ресурс Azure. Развертывание файлового сервера на виртуальных машинах Azure — это эффективный способ получить файловое хранилище в Azure, когда вам требуются параметры развертывания, не поддерживаемые службой "Файлы Azure" по состоянию на текущий момент (например, поддержка протокола NFS или хранилища класса Premium). 

    Тем не менее запуск файлового сервера с помощью дисков Azure, используемых в качестве серверного хранилища, обойдется гораздо дороже, чем использование файлового ресурса Azure. Причины следующие. Первая. Кроме оплаты использования дискового хранилища вам также необходимо будет оплатить стоимость работы одной или нескольких виртуальных машин Azure. Вторая. Вам также придется управлять виртуальными машинами, используемыми для запуска файлового сервера, например обновлять ОС. И третья. Если в конечном счете вам потребуется локальное кэширование данных, то для реализации такого кэширования вы сами должны будете настроить технологии репликации, например репликацию распределенной файловой системы (DFSR), а также управлять ими.

    Один из способов, который вы можете применить (кроме использования дисков Azure в качестве серверного хранилища), чтобы по максимуму использовать возможности службы "Файлы Azure" и файлового сервера, размещенного на виртуальных машинах Azure, — установить службу синхронизации файлов Azure на этом файловом сервере, размещенном на виртуальной машине в облаке. Если файловый ресурс Azure находится в том же регионе, что и файловый сервер, можно включить распределение по уровням облака и задать максимальный процент (99 %) свободного пространства на диске. Это обеспечит минимальное дублирование данных, а вы сможете использовать любые необходимые вам приложения на файловых серверах, например, которым нужно поддерживать протокол NFS.

    Дополнительные сведения о способе настройки высокопроизводительного и высокодоступного файлового сервера в Azure см. в записи блога о [развертывании гостевых кластеров виртуальной машины IaaS в Microsoft Azure](https://blogs.msdn.microsoft.com/clustering/2017/02/14/deploying-an-iaas-vm-guest-clusters-in-microsoft-azure/). Дополнительные сведения о различиях между службой "Файлы Azure" и дисками Azure см. в статье [Выбор между большими двоичными объектами Azure, службой файлов Azure и дисками Azure](../common/storage-decide-blobs-files-disks.md). Дополнительные сведения о дисках Azure см. в статье [Обзор компонента "Управляемые диски" Azure](../../virtual-machines/windows/managed-disks-overview.md).

* <a id="get-started"></a>
  **Как начать работу со службой файлов Azure?**  
   Это очень легко. Сначала необходимо создать [файловый ресурс](storage-how-to-create-file-share.md) и подключить его к операционной системе по своему усмотрению: 

  * [Windows](storage-how-to-use-files-windows.md)
  * [Linux](storage-how-to-use-files-linux.md)
  * [macOS](storage-how-to-use-files-mac.md)

    Более подробные сведения по развертыванию общего файлового ресурса Azure для замены рабочих файловых ресурсов в вашей организации см. в статье [Планирование развертывания службы файлов Azure](storage-files-planning.md).

* <a id="redundancy-options"></a>
  **Какие параметры избыточности хранилища поддерживаются в службе файлов Azure?**  
    В настоящее время служба файлов Azure поддерживает локально избыточное хранилище (LRS), хранилище, избыточное в пределах зоны (ZRS), и геоизбыточное хранилище (GRS). В будущем мы планируем включить поддержку геоизбыточного хранилища с доступом на чтение (RA-GRS), но о конкретных сроках пока говорить рано.

* <a id="tier-options"></a>
  **Какие уровни хранилища поддерживаются службой файлов Azure?**  
    Сейчас служба файлов Azure поддерживает только стандартный уровень хранилища. Мы пока не можем определить конкретные сроки реализации поддержки хранилища класса Premium, а также "холодного" хранилища. 
    
    > [!NOTE]
    > Вы не можете создать общие файловые ресурсы Azure из учетных записей хранения только для больших двоичных объектов или учетных записей хранилища класса Premium.

* <a id="give-us-feedback"></a>
  **Очень хотелось бы, чтобы в службу файлов Azure была включена отдельная функция. Это возможно?**  
    Рабочая группа службы файлов Azure готова рассмотреть все предложения и отзывы в отношении своей работы. Проголосуйте за вариант, который вам понравился, на странице, посвященной [оптимизации службы хранилища Azure](https://feedback.azure.com/forums/217298-storage/category/180670-files). Мы заинтересованы в разработке новых полезных функций.

## <a name="azure-file-sync"></a>Служба синхронизации файлов Azure

* <a id="afs-region-availability"></a>
  **В каких регионах поддерживается функция "Синхронизация файлов Azure"?**  
    Список доступных регионов можно найти в [этом разделе](storage-sync-files-planning.md#region-availability) руководства по планированию развертывания функции "Синхронизация файлов Azure". Мы планируем постоянно добавлять дополнительные регионы, в том числе регионы, не являющиеся общедоступными.

* <a id="cross-domain-sync"></a>
  **Могут ли в одной группе синхронизации находиться серверы, присоединенные к домену, и серверы, независимые от него?**  
    Да. Группа синхронизации может содержать конечные точки сервера, которые могут принадлежать к разным группам Active Directory, даже если они независимы от домена. Хотя технически такая конфигурация работает, мы не рекомендуем ее использовать как стандартную, так как списки ACL, определенные для файлов и папок на одном сервере, могут не учитываться другими серверами в этой же группе синхронизации. Чтобы получить оптимальные результаты, мы рекомендуем выполнить синхронизацию между серверами в одном лесу Active Directory, серверами в разных лесах Active Directory с установленными отношениями доверия или между серверами, независимыми от домена, а не использовать все варианты сразу.

* <a id="afs-change-detection"></a>
  **Если файл был создан непосредственно в файловом ресурсе Azure через SMB или портал, сколько времени займет его синхронизация с серверами в группе синхронизации?**  
    [!INCLUDE [storage-sync-files-change-detection](../../../includes/storage-sync-files-change-detection.md)]

* <a id="afs-conflict-resolution"></a>**Что произойдет при изменении одного файла на двух серверах приблизительно в одно время?**  
    Служба синхронизации файлов Azure использует простую стратегию разрешения конфликта — будут выполнены все изменения. Сохранится имя того файла, который был изменен последним. Файл с более ранними изменениями будет содержать имя исходного компьютера и номер конфликта, добавленный к этому имени на основе таксономии ниже: 
   
    \<имя_файла_без_разрешения\>-\<имя_компьютера\>\[-#\].\<ext\>  

    Например, файл CompanyReport.docx при первом конфликте станет CompanyReport-CentralServer.docx, где CentralServer является расположением, в котором запись изменений произошла раньше. Для второго конфликта соответственно будет использоваться имя CompanyReport-CentralServer-1.docx.

* <a id="afs-storage-redundancy"></a>
  **Поддерживает ли служба "Синхронизация файлов Azure" геоизбыточное хранилище?**  
    Да, служба файлов Azure поддерживает локально избыточное хранилище (LRS) и геоизбыточное хранилище (GRS). Если отработка отказа учетной записи хранения запускается между связанными регионами из учетной записи, настроенной для GRS, корпорация Майкрософт рекомендует рассматривать новую область только как резервную копию данных. Служба синхронизации файлов Azure не запустит автоматическую синхронизацию с новым основным регионом. 

* <a id="sizeondisk-versus-size"></a>
  **Почему свойство файла *Размер на диске* не соответствует свойству *Размер* после использования службы "Синхронизация файлов Azure"?**  
  См. в разделе статьи [Общие сведения о распределении по уровням в облаке](storage-sync-cloud-tiering.md#sizeondisk-versus-size).

* <a id="is-my-file-tiered"></a>
  **Как определить, что файл был перемещен?**  
  См. в разделе статьи [Общие сведения о распределении по уровням в облаке](storage-sync-cloud-tiering.md#is-my-file-tiered).

* <a id="afs-recall-file"></a>**Файл, который мне нужен, был перемещен. Как мне локально отозвать его на диск?**  
  См. в разделе статьи [Общие сведения о распределении по уровням в облаке](storage-sync-cloud-tiering.md#afs-recall-file).

* <a id="afs-force-tiering"></a>
  **Как можно принудительно переместить файл или каталог?**  
  См. в разделе статьи [Общие сведения о распределении по уровням в облаке](storage-sync-cloud-tiering.md#afs-force-tiering).

* <a id="afs-effective-vfs"></a>
  **Как определяется *свободное место в томе*, если в нем используется несколько конечных точек сервера?**  
  См. в разделе статьи [Общие сведения о распределении по уровням в облаке](storage-sync-cloud-tiering.md#afs-effective-vfs).

* <a id="afs-files-excluded"></a>
  **Какие файлы или папки автоматически исключены в службе "Синхронизация файлов Azure"?**  
    По умолчанию служба синхронизации файлов Azure исключает следующие файлы:
  * desktop.ini;
  * thumbs.db;
  * ehthumbs.db;
  * ~$\*.\*;
  * \*.laccdb;
  * \*.tmp;
  * 635D02A9D91C401B97884B82B3BCDAEA\*.

    По умолчанию также исключаются следующие папки:

  * \System Volume Information;
  * \$RECYCLE.BIN;
  * \SyncShareState.

* <a id="afs-os-support"></a>
  **Могу ли я использовать службу "Синхронизация файлов Azure" с Windows Server 2008 R2, Linux или своим запоминающим устройством, подключаемым к сети (NAS)?**  
    Сейчас служба синхронизации файлов Azure поддерживает только Windows Server 2016 и Windows Server 2012 R2. В данный момент мы ничего не планируем, но мы с радостью рассмотрим предложения по поводу поддержки дополнительных платформ, проанализировав потребности клиентов. Сообщите нам о платформах, для которых нужно реализовать поддержку, на портале [UserVoice службы файлов Azure](https://feedback.azure.com/forums/217298-storage/category/180670-files).

* <a id="afs-tiered-files-out-of-endpoint"></a>
  **Почему многоуровневые файлы существуют вне пространства имен конечной точки сервера?**  
    До выпуска агента службы "Синхронизация файлов Azure" версии 3 эта служба блокировала перемещение многоуровневых файлов за пределы конечной точки сервера, но на тот же том, на котором размещена эта конечная точка сервера. Это не затрагивало операции копирования, перемещение файлов без уровней и перемещение многоуровневых файлов на другие тома. Причиной такого поведения было неявное предположение о том, что проводник и другие интерфейсы API Windows обрабатывают эти операции перемещения на тот же том, что и (практически) мгновенные операции переименования. Это означает, что после перемещения с помощью проводника или других методов перемещения (например, командной строки или PowerShell) будет невозможно отозвать данные из облака с помощью службы "Синхронизация файлов Azure". Начиная с [агента службы "Синхронизация файлов Azure" версии 3.0.12.0](storage-files-release-notes.md#supported-versions) эта служба позволяет переместить многоуровневый файл за пределы конечной точки сервера. Мы избегаем упомянутых выше проблем, позволяя многоуровневому файлу существовать в виде многоуровневого файла за пределами конечной точки сервера, а затем отзывая этот файл в фоновом режиме. Это означает, что перемещение в пределах тома выполняется мгновенно, и мы выполняем все действия для отзыва файла на диск после завершения перемещения. 

* <a id="afs-do-not-delete-server-endpoint"></a>
  **У меня возникла проблема со службой "Синхронизация файлов Azure" на сервере (синхронизация, распределение по уровням облака и т. д). Следует ли удалить и создать заново конечную точку сервера?**  
    [!INCLUDE [storage-sync-files-remove-server-endpoint](../../../includes/storage-sync-files-remove-server-endpoint.md)]
    
* <a id="afs-resource-move"></a>
  **Можно ли переместить службу синхронизации хранилища и/или учетную запись хранения в другую группу ресурсов или подписку?**  
   Да, службу синхронизации хранилища и/или учетную запись хранения можно переместить в другую группу ресурсов или подписку в рамках существующего клиента Azure AD. Если учетная запись хранения перемещена, необходимо предоставить службе Hybrid File Sync доступ к учетной записи хранилища (см. в разделе [Убедитесь, что служба "Синхронизация файлов Azure" имеет доступ к учетной записи хранения](https://docs.microsoft.com/azure/storage/files/storage-sync-files-troubleshoot?tabs=portal1%2Cportal#troubleshoot-rbac)).

    > [!Note]  
    > Служба "Синхронизация файлов Azure" не поддерживает перемещение подписки в другой клиент Azure AD.
    
* <a id="afs-ntfs-acls"></a>
  **Сохраняет ли служба синхронизации файлов Azure наряду с данными, хранящимися в службе файлов Azure, списки управления доступом NTFS для каталогов или файлов?**

    Служба синхронизации файлов Azure сохраняет списки управления доступом NTFS, переносимые с локальных файловых серверов, таких как метаданные. Службы файлов Azure не поддерживают проверку подлинности с учетными данными Azure AD для доступа к общим файловым ресурсам, которыми управляет служба синхронизации файлов Azure.
    
## <a name="security-authentication-and-access-control"></a>Безопасность, проверка подлинности и управление доступом
* <a id="ad-support"></a>
**Поддерживает ли служба файлов Azure аутентификацию и управление доступом на основе Active Directory?**  
    
    Да, служба файлов Azure поддерживает проверку подлинности на основе удостоверений и контроль доступа с помощью Azure Active Directory (Azure AD) (предварительная версия). Проверка подлинности Azure AD по протоколу SMB для службы файлов Azure использует доменные службы Azure Active Directory и позволяет виртуальным машинам, присоединенным к домену, получать доступ к общим папкам, каталогам и файлам, используя учетные данные Azure AD. Дополнительные сведения см. в статье [Обзор проверки подлинности Azure Active Directory по протоколу SMB для службы файлов Azure (предварительная версия)](storage-files-active-directory-overview.md). 

    В службе файлов Azure предусмотрено два дополнительных способа управления доступом:

    - Вы можете использовать подписанные URL-адреса (SAS), чтобы создать маркеры со специальными разрешениями, которые будут допустимы для использования в течение определенного интервала времени. Например, вы можете создать маркер с доступом только для чтения для одного конкретного файла со сроком действия 10 минут. Любой пользователь, обладающий этим маркером, пока он действует, получит доступ только для чтения к этому файлу на 10 минут. В настоящее время ключи подписанных URL-адресов поддерживаются только через интерфейс REST API или в клиентских библиотеках. Вам необходимо подключить файловый ресурс Azure через протокол SMB с помощью ключей учетной записи хранения.

    - Служба синхронизации файлов Azure сохранит все дискреционные списки ACL или DACL и выполнит их репликацию (на основе Active Directory или локально) для всех конечных точек сервера, с которыми она синхронизируется. Так как Windows Server уже может пройти аутентификацию с помощью Active Directory, служба синхронизации файлов Azure может предоставить эффективную временную меру до реализации полной поддержки аутентификации на основе Active Directory и ACL.

* <a id="ad-support-regions"></a>
**Доступна ли предварительная версия Azure AD по протоколу SMB для службы файлов Azure во всех регионах Azure?**

    Предварительная версия доступна во всех общедоступных регионах.

* <a id="ad-support-on-premises"></a>
**Поддерживает ли проверка подлинности Azure AD по протоколу SMB для службы файлов Azure (предварительная версия) проверку подлинности с помощью Azure AD с локальных компьютеров?**

    Нет, предварительная версия службы файлов Azure не поддерживает проверку подлинности с помощью Azure AD с локальных компьютеров.

* <a id="ad-support-devices"></a>
**Поддерживает ли проверка подлинности Azure AD по протоколу SMB для службы файлов Azure (предварительная версия) доступ по протоколу SMB под учетными данными Azure AD c устройств, присоединенных к Azure AD или зарегистрированных в Azure AD?**

    Нет, этот сценарий не поддерживается.

* <a id="ad-support-rest-apis"></a>
**Существуют ли API REST, которые поддерживают получение, настройку или копирование списков управления доступом NTFS для каталогов или файлов?**

    Предварительная версия не поддерживает API REST для получения, настройки или копирования списков управления доступом NTFS для каталогов или файлов.

* <a id="ad-vm-subscription"></a>
**Можно ли получить доступ к службе файлов Azure под учетными данными Azure AD с виртуальной машины с другой подпиской?**

    Если подписка, в которой развернута общая папка, связана с тем же клиентом Azure AD, что и развертывание доменных служб Azure AD, к домену которого подключена виртуальная машина, вы сможете получить службу "Файлы Azure" под теми же учетными данными Azure AD. Это ограничение накладывается не на подписку, а на связанный клиент Azure AD.    
    
* <a id="ad-support-subscription"></a>
**Можно ли включить проверку подлинности Azure AD по протоколу SMB для службы файлов Azure с клиентом Azure AD, отличным от основного клиента, с которым связан общий файловый ресурс?**

    Нет, служба файлов Azure поддерживает интеграцию Azure AD только с клиентом Azure AD, который находится в той же подписке, что и общий файловый ресурс. С клиентом Azure AD может быть связана только одна подписка.

* <a id="ad-linux-vms"></a>
**Поддерживает ли проверка подлинности Azure AD по протоколу SMB для службы файлов Azure (предварительная версия) виртуальные машины Linux?**

    Нет, проверка подлинности с виртуальных машин Linux в предварительной версии не поддерживается.

* <a id="ad-aad-smb-afs"></a>
**Можно ли использовать возможности проверки подлинности Azure AD по протоколу SMB в общих файловых ресурсах, управляемых службой синхронизации файлов Azure?**

    Нет, служба файлов Azure не поддерживает сохранение списков управления доступом NTFS в общих файловых ресурсах, управляемых службой синхронизации файлов Azure. Служба синхронизации файлов Azure сохраняет списки управления доступом к файлам, переносимые с локальных файловых серверов. Все списки управления доступом к файлам NTFS, настроенные для службы файлов Azure в собственном коде, служба синхронизации файлов Azure перезапишет. Кроме того, службы файлов Azure не поддерживают проверку подлинности с учетными данными Azure AD для доступа к общим файловым ресурсам, которыми управляет служба синхронизации файлов Azure.

* <a id="encryption-at-rest"></a>
**Как обеспечить шифрование неактивных данных файлового ресурса Azure?**  

    В разработке включение по умолчанию шифрования службы хранилища Azure во всех регионах. Чтобы включить шифрование в этих регионах, не нужно выполнять никаких действий. Сведения о других регионах см. в статье [Шифрование службы хранилища Azure для неактивных данных (предварительная версия)](../common/storage-service-encryption.md?toc=%2fazure%2fstorage%2ffiles%2ftoc.json).

* <a id="access-via-browser"></a>
**Как предоставить доступ к определенному файлу через браузер?**  

    Вы можете использовать подписанные URL-адреса, чтобы создать маркеры со специальными разрешениями, которые будут допустимы для использования в течение определенного интервала времени. Например, вы можете создать маркер с доступом только для чтения к конкретному файлу и задать определенный интервал его действия. Пока маркер действителен, любой пользователь, у которого есть этот URL-адрес, сможет обращаться к файлу непосредственно из любого браузера. Вы можете легко создать ключ подписанного URL-адреса из пользовательского интерфейса, например обозревателя службы хранилища Azure.

* <a id="file-level-permissions"></a>
**Можно ли задать разрешение только для чтения или только для записи в отдельных папках внутри общего ресурса?**  

    При подключении общей папки по протоколу SMB такой уровень контроля над разрешениями недоступен. Тем не менее при создании подписанного URL-адреса с помощью API-интерфейса REST или клиентских библиотек для папок в общем ресурсе можно указать разрешения только для чтения или записи.

* <a id="ip-restrictions"></a>
**Можно ли внедрить ограничения IP-адресов для файлового ресурса Azure?**  

    Да. Доступ к общему файловому ресурсу Azure можно ограничить на уровне учетной записи хранения. Дополнительные сведения см. в статье [Настройка брандмауэров службы хранилища Azure и виртуальных сетей (предварительная версия)](../common/storage-network-security.md?toc=%2fazure%2fstorage%2ffiles%2ftoc.json).

* <a id="data-compliance-policies"></a>
**Какие политики соответствия данных поддерживаются службой файлов Azure?**  

   В основе работы службы файлов Azure лежит та же архитектура хранилища, которая используется и для других служб хранилища в службе хранилища Azure. К этой службе применяются те же политики соответствия данных. Дополнительные сведения о соответствии данных в службе хранилища Azure см. в разделах [Предложения для соответствия требованиям в службе хранилища Azure](https://docs.microsoft.com/azure/storage/common/storage-compliance-offerings) и [Центр управления безопасностью Майкрософт](https://microsoft.com/trustcenter/default.aspx).

## <a name="on-premises-access"></a>Локальный доступ

* <a id="port-445-blocked"></a>
**Подключите Мой поставщик услуг Интернета или ИТ блоки порт 445 которой произошел сбой службы файлов Azure. Что делать?**

    Вы можете узнать о [различные способы обходной путь заблокирован порт 445 здесь](https://docs.microsoft.com/azure/storage/files/storage-troubleshoot-windows-file-connection-problems#cause-1-port-445-is-blocked). Служба файлов Azure разрешает только подключения, с помощью SMB 3.0 (с поддержкой шифрования) из вне региона или центра обработки данных. Протокол SMB 3.0 представила множество функций безопасности, включая шифрование канала, который обеспечивает высокий уровень безопасности для использования через Интернет. Тем не менее его возможно, что порт 445 заблокирован из-за историческим причинам уязвимостей, присущих в более ранние версии SMB. В идеальном случае порт должен быть заблокирован для только для трафика SMB 1.0 и SMB 1.0 должна быть отключена на всех клиентах.

* <a id="expressroute-not-required"></a>
**Нужно ли использовать Azure ExpressRoute для подключения к службе файлов Azure или использования службы "Синхронизация файлов Azure" локально?**  

    № ExpressRoute не требуется для доступа к общему файловому ресурсу Azure. Если файловый ресурс Azure подключается локально, нужен всего лишь открытый порт 445 (исходящий TCP-порт) для доступа к Интернету (это порт, к которому обращается SMB). При использовании службы синхронизации файлов Azure требуется всего лишь порт 443 (исходящий TCP-порт) для доступа к HTTPS (SMB не требуется). Тем не менее для ExpressRoute вы *можете* использовать любой из этих параметров доступа.

* <a id="mount-locally"></a>
**Как подключить файловый ресурс Azure на локальном компьютере?**  

    Если разрешен исходящий TCP-трафик через порт 445 и клиент (например, Windows 10 или Windows Server 2016) поддерживает протокол SMB 3.0, то подключение к общему файловому ресурсу осуществляется по протоколу SMB. Если порт 445 заблокирован политикой организации или поставщиком услуг Интернета, для доступа к общему файловому ресурсу Azure можно использовать службу синхронизации файлов Azure.

## <a name="backup"></a>Azure Backup
* <a id="backup-share"></a>
**Как создать резервную копию файлового ресурса Azure?**  
    Вы можете использовать периодически [создаваемые моментальные снимки общих ресурсов](storage-snapshots-files.md) для защиты от случайного удаления. Вы можете воспользоваться AzCopy, RoboCopy или сторонним средством архивации, с помощью которого можно создать резервную копию подключенной общей папки. Служба Azure Backup позволяет создавать резервные копии файлов Azure. Ознакомьтесь с дополнительными сведениями о [резервном копировании файловых ресурсов Azure службой Azure Backup](https://docs.microsoft.com/azure/backup/backup-azure-files).

## <a name="share-snapshots"></a>Моментальные снимки общих ресурсов

### <a name="share-snapshots-general"></a>Моментальные снимки общих ресурсов Общие сведения
* <a id="what-are-snaphots"></a>
**Что представляют собой моментальные снимки файловых ресурсов?**  
    Моментальные снимки общих файловых ресурсов Azure позволяют создавать версии общих файловых ресурсов только для чтения. Вы также можете использовать службу файлов Azure, чтобы копировать более старую версию содержимого в тот же общий ресурс, альтернативное расположение в Azure или в локальную среду для дальнейших изменений. Дополнительные сведения о моментальных снимках общего ресурса см. в статье [Обзор моментальных снимков для службы файлов Azure (предварительная версия)](storage-snapshots-files.md).

* <a id="where-are-snapshots-stored"></a>
**Где хранятся мои моментальные снимки общих ресурсов?**  
    Моментальные снимки общего ресурса и сам общий файловый ресурс хранятся в одной и той же учетной записи хранения.

* <a id="snapshot-perf-impact"></a>
**Предусмотрены ли ограничения производительности в отношении использования моментальных снимков общих ресурсов?**  
    Моментальные снимки общего ресурса не снижают производительность.

* <a id="snapshot-consistency"></a>
**Согласованы ли моментальные снимки общих ресурсов в разных приложениях?**  
    Нет, моментальные снимки общих ресурсов не согласованы между приложениями. Перед созданием моментального снимка общего ресурса пользователю понадобится очистить операции записи из приложения и перенести их в общий ресурс.

* <a id="snapshot-limits"></a>
**Есть ли ограничения на число моментальных снимков общего ресурса?**  
    Да. Служба файлов Azure позволяет сохранять максимум 200 моментальных снимков общих ресурсов. Моментальные снимки общих ресурсов не учитываются в квоте общих ресурсов, так что общее пространство, занимаемое всеми моментальными снимками общих ресурсов, неограниченно. Ограничения учетной записи хранения по-прежнему применяются. После достижения ограничения в 200 моментальных снимков общих ресурсов вам необходимо удалить старые моментальные снимки, чтобы создать новые.

* <a id="snapshot-cost"></a>
**Сколько нужно платить за моментальные снимки общего ресурса?**  
    Для моментальных снимков действуют стандартные тарифы на транзакции и хранилище. По своей природе моментальные снимки являются добавочными. Базовый моментальный снимок — это сам общий ресурс. Последующие моментальные снимки — добавочные. В них хранятся только отличия от предыдущего моментального снимка. Это означает, что разница в счетах будет минимальной при минимальной обработке рабочей нагрузки. Сведения о тарифах на использование функции "Файлы Azure" уровня "Стандартный" см. на [странице с ценами](https://azure.microsoft.com/pricing/details/storage/files/). Сейчас можно узнать объем пространства, используемый моментальным снимком общего ресурса, сравнив оплачиваемую емкость с используемой. Мы работаем над инструментарием для усовершенствования функции отчетов.

* <a id="ntfs-acls-snaphsots"></a>
**Сохраняются ли списки управления доступом NTFS для каталогов и файлов в моментальных снимках общих ресурсов?**
    Списки управления доступом NTFS для каталогов и файлов сохраняются в моментальных снимках общих ресурсов.

### <a name="create-share-snapshots"></a>Создание моментальных снимков общих ресурсов
* <a id="file-snaphsots"></a>
**Можно ли создать моментальный снимок общего ресурса для отдельных файлов?**  
    Моментальные снимки общих ресурсов создаются на уровне общего файлового ресурса. Вы можете восстановить отдельные файлы из моментальных снимков общего файлового ресурса, но нельзя создать моментальные снимки общего ресурса на уровне файлов. Тем не менее, если вы создали моментальный снимок общих ресурсов на уровне общего ресурса и требуется перечислить моментальные снимки общих ресурсов, в которых изменился конкретный файл, это можно сделать с помощью компонента **Предыдущие версии** на подключенном общем ресурсе Windows. 
    
    Если вам нужна функция моментального снимка файла, сообщите нам об этом на форуме [UserVoice службы файлов Azure](https://feedback.azure.com/forums/217298-storage/category/180670-files).

* <a id="encrypted-snapshots"></a>
**Можно ли создать моментальные снимки зашифрованного файлового ресурса?**  
    Вы можете сделать моментальный снимок общего ресурса общих файловых ресурсов Azure с включенным шифрованием неактивных данных. Вы можете восстановить файлы из моментального снимка общего ресурса в зашифрованном общем файловом ресурсе. Если общий ресурс зашифрован, его моментальный снимок также будет зашифрован.

* <a id="geo-redundant-snaphsots"></a>
**Являются ли мои моментальные снимки общего ресурса геоизбыточными?**  
    Моментальные снимки общего ресурса имеют ту же избыточность, что и соответствующий общий файловый ресурс Azure. При выборе геоизбыточного хранилища для своей учетной записи данные моментального снимка общего ресурса также будут храниться отдельно в парном регионе.

### <a name="manage-share-snapshots"></a>Управление моментальными снимками общих ресурсов
* <a id="browse-snapshots-linux"></a>
**Можно просмотреть мои моментальные снимки общих ресурсов на компьютере Linux?**  
    Azure CLI позволяет создавать, перечислять, просматривать и восстанавливать моментальные снимки общих ресурсов в Linux.

* <a id="copy-snapshots-to-other-storage-account"></a>
**Можно ли скопировать моментальные снимки общедоступного ресурса в другую учетную запись хранения?**  
    Вы можете скопировать файлы из моментальных снимков общего ресурса в другое расположение, но не сами моментальные снимки общего ресурса.

### <a name="restore-data-from-share-snapshots"></a>Восстановление данных из моментальных снимков общих ресурсов
* <a id="promote-share-snapshot"></a>
**Можно ли повысить уровень моментального снимка общедоступного ресурса до базового общедоступного ресурса?**  
    Вы можете скопировать данные из моментального снимка общего ресурса в любое другое место назначения. Вы не можете повысить уровень моментального снимка общего ресурса до базового общего ресурса.

* <a id="restore-snapshotted-file-to-other-share"></a>
**Можно ли восстановить данные из моментального снимка общего ресурса в другую учетную запись хранения?**  
    Да. Вы можете скопировать файлы из моментального снимка общего ресурса в исходное или альтернативное расположение, включающее ту же или другую учетную запись хранения в том же или другом регионе. Можно также скопировать файлы в локальное расположение или любую другую облачную среду.    
  
### <a name="clean-up-share-snapshots"></a>Удаление моментальных снимков общих ресурсов
* <a id="delete-share-keep-snapshots"></a>
**Можно ли удалить общий ресурс, не удаляя его моментальные снимки?**  
    Вам не удастся удалить общий ресурс, если в нем имеются активные моментальные снимки общего ресурса. Вы можете использовать API для удаления моментальных снимков общего ресурса вместе с ресурсом. Вы также можете удалить моментальные снимки общего ресурса и сам ресурс на портале Azure.

* <a id="delete-share-with-snapshots"></a>
**Что случится с моими моментальными снимками общедоступного ресурса при удалении учетной записи хранения?**  
    При удалении учетной записи хранения также удаляются и моментальные снимки общего ресурса.

## <a name="billing-and-pricing"></a>Выставление счетов и цены
* <a id="vm-file-share-network-traffic"></a>
**Включается ли сетевой трафик между виртуальной машиной и файловыми ресурсами Azure в тарифицируемый трафик подписки?**  
    Если общий файловый ресурс и виртуальная машина находятся в одном регионе Azure, дополнительная оплата за трафик между этим ресурсом и виртуальной машиной отсутствует. Если общий файловый ресурс и виртуальная машина находятся в разных регионах, трафик между ними будет тарифицирован как внешний трафик.

* <a id="share-snapshot-price"></a>
**Сколько нужно платить за моментальные снимки общего ресурса?**  
     При использовании предварительной версии плата за моментальные снимки общего ресурса не взимается. Однако применяется стандартная плата за транзакции и исходящий трафик. После выпуска общедоступной версии для подписок будет взиматься плата за ресурсы и транзакции моментальных снимков общих ресурсов.
     
     По своей природе моментальные снимки общих ресурсов являются добавочными. Базовый моментальный снимок общего ресурса — это сам общий ресурс. Последующие моментальные снимки общего ресурса — добавочные. Они хранят только отличия от предыдущего моментального снимка общего ресурса. Тарифицируется только измененное содержимое. Если общий ресурс содержит 100 ГиБ данных, из которых с момента создания последнего моментального снимка общего ресурса изменилось всего лишь 5 ГиБ, моментальный снимок общего ресурса использует только 5 ГиБ дополнительно, и счет будет выставлен только за 105 ГиБ. Дополнительные сведения о стандартных расходах на транзакции и исходящие данные см. на [странице цен](https://azure.microsoft.com/pricing/details/storage/files/).

## <a name="scale-and-performance"></a>Масштаб и производительность
* <a id="files-scale-limits"></a>
**Каковы ограничения на масштабирование службы файлов Azure?**  
    Дополнительные сведения о целевых показателях масштабируемости и производительности службы файлов Azure см. в статье [Целевые показатели масштабируемости и производительности службы файлов Azure](storage-files-scale-targets.md).

* <a id="need-larger-share"></a>
**Мне нужен более крупный файловый ресурс, чем сейчас предлагается в службе файлов Azure. Можно ли увеличить размер файлового ресурса Azure?**  
    № Максимальный размер общего файлового ресурса Azure — 5 ТиБ. Сейчас это жесткое ограничение, которое мы не можем снять. Мы работаем над увеличением размера общего файлового ресурса до 100 TиБ, но о конкретных сроках реализации этой цели пока говорить рано.

* <a id="open-handles-quota"></a>
**Сколько клиентов могут одновременно получить доступ к одному файлу?**   
    Установлена квота в 2000 открытых дескрипторов на один файл. По достижении этого ограничения вы увидите соответствующую ошибку.

* <a id="zip-slow-performance"></a>
**При попытке распаковать файлы в службе файлов Azure снижается производительность. Что делать?**  
    Для передачи большого числа файлов в службу файлов Azure мы рекомендуем использовать AzCopy (для Windows, предварительную версию для Linux и UNIX) или Azure PowerShell, так как эти средства оптимизированы для сетевой передачи файлов.

* <a id="slow-perf-windows-81-2012r2"></a>
**Почему после подключения файлового ресурса Azure в Windows Server 2012 R2 или Windows 8.1 снижается производительность?**  
    Имеется известная проблема при подключении файлового ресурса Azure в Windows Server 2012 R2 и Windows 8.1 с накопительным обновлением за апрель 2014 г. для Windows 8.1 и Windows Server 2012 R2. Для достижения оптимальной производительности убедитесь, что на всех экземплярах Windows Server 2012 R2 и Windows 8.1 есть это исправление. (Мы рекомендуем всегда устанавливать все обновления Windows через Центр обновления Windows.) Дополнительные сведения см. в соответствующей статье базы знаний Майкрософт [Slow performance when you access Azure Files from Windows 8.1 or Server 2012 R2](https://support.microsoft.com/kb/3114025) (Снижение производительности при доступе к службе файлов Azure из Windows 8.1 или Server 2012 R2).

## <a name="features-and-interoperability-with-other-services"></a>Функции и совместимость с другими службами
* <a id="cluster-witness"></a>
**Можно ли использовать файловый ресурс Azure в качестве *файлового ресурса-свидетеля* для отказоустойчивого кластера Windows Server?**  
    Сейчас такая конфигурация не поддерживается для общего файлового ресурса Azure. Дополнительные сведения о способах настройки этой возможности для хранилища BLOB-объектов Azure см. в статье [Deploy a Cloud Witness for a Failover Cluster](https://docs.microsoft.com/windows-server/failover-clustering/deploy-cloud-witness) (Развертывание облака-свидетеля для отказоустойчивого кластера).

* <a id="containers"></a>
**Можно ли подключить файловый ресурс Azure на экземпляре контейнера Azure?**  
    Да, файловые ресурсы Azure оптимальны для сохранения сведений после истечения времени существования экземпляра контейнера. Дополнительные сведения см. в статье [Подключение файлового ресурса Azure с помощью Экземпляров контейнеров Azure](../../container-instances/container-instances-mounting-azure-files-volume.md).

* <a id="rest-rename"></a>
**Существует ли операция переименования в REST API?**  
    На данный момент нет.

* <a id="nested-shares"></a>
**Могу ли я настроить вложенные общие ресурсы? Другими словами — файловый ресурс в файловом ресурсе?**  
    № Общая папка *является* виртуальным драйвером для подключения, поэтому вложенные общие папки не поддерживаются.

* <a id="ibm-mq"></a>
**Как использовать службу файлов Azure с IBM MQ?**  
    Компания IBM выпустила руководство по настройке службы файлов Azure в службе, которую используют пользователи IBM MQ. Дополнительные сведения см. в статье [How to setup IBM MQ Multi instance queue manager with Microsoft Azure File Service](https://github.com/ibm-messaging/mq-azure/wiki/How-to-setup-IBM-MQ-Multi-instance-queue-manager-with-Microsoft-Azure-File-Service) (Настройка службы файлов Microsoft Azure в многоэкземплярном диспетчере очередей IBM MQ).

## <a name="see-also"></a>См. также
* [Устранение неполадок службы файлов Azure в Windows](storage-troubleshoot-windows-file-connection-problems.md)
* [Устранение неполадок службы файлов Azure в Linux](storage-troubleshoot-linux-file-connection-problems.md)
* [Устранение неполадок службы "Синхронизация файлов Azure"](storage-sync-files-troubleshoot.md)
