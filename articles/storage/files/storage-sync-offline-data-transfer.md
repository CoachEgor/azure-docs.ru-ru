---
title: Преобразование данных в синхронизацию файлов Azure с помощью ящика данных Azure
description: Мигрируйте объемные данные таким образом, чтобы это было совместимо с Azure File Sync.
author: roygara
ms.service: storage
ms.topic: conceptual
ms.date: 02/12/2019
ms.author: rogarana
ms.subservice: files
ms.openlocfilehash: 9398aceeb7465392e82aeaa5760f6c0504f8e33d
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "80159529"
---
# <a name="migrate-bulk-data-to-azure-file-sync-with-azure-databox"></a>Перенос объемных данных в синхронизацию файлов Azure с помощью Azure DataBox
Объемные данные можно перенести в синхронизацию файлов Azure двумя способами:

* **Загрузите файлы с помощью синхронизации файлов Azure.** Это самый простой метод. Переместите файлы локально на Windows Server 2012 R2 или позже и установите агент Azure File Sync. После настройки синхронизации ваши файлы будут загружены с сервера. (Наши клиенты в настоящее время испытывают среднюю скорость загрузки 1 TiB примерно каждые два дня.) Чтобы убедиться, что сервер не использует слишком большую пропускную способность для вашего центра обработки данных, может потребоваться настроить [график регулирования пропускной способности.](storage-sync-files-server-registration.md#ensuring-azure-file-sync-is-a-good-neighbor-in-your-datacenter)
* **Передача файлов в автономном режиме.** Если у вас недостаточно пропускной способности, возможно, вы не сможете загрузить файлы в Azure в разумные сроки. Проблема заключается в первоначальной синхронизации всего набора файлов. Чтобы преодолеть эту проблему, используйте автономные инструменты миграции навалом, такие как [семейство Azure Data Box.](https://azure.microsoft.com/services/storage/databox) 

В этой статье объясняется, как перенести файлы в автономный режим таким образом, чтобы это было совместимо с Azure File Sync. Следуйте этим инструкциям, чтобы избежать конфликтов файлов и сохранить списки управления доступом файлов и папок (ACLs) и временные метки после включения синхронизации.

## <a name="migration-tools"></a>Средства миграции
Процесс, который мы описываем в этой статье, работает не только для Data Box, но и для других инструментов автономной миграции. Он также работает для таких инструментов, как AzCopy, Robocopy, или партнерские инструменты и услуги, которые работают прямо через Интернет. Однако для преодоления первоначальной задачи загрузки выполните следующие действия в этой статье, чтобы использовать эти инструменты таким образом, чтобы это было совместимо с Azure File Sync.

В некоторых случаях перед принятием Azure File Sync необходимо перейти с одного Windows-сервера на другой Windows Server. [Служба миграции хранения](https://aka.ms/storagemigrationservice) (SMS) может помочь в этом. Если вам нужно перейти на версию ОС сервера, которая поддерживается Azure File Sync (Windows Server 2012R2 и выше) или вам просто нужно мигрировать, потому что вы покупаете новую систему для синхронизации файлов Azure, SMS имеет множество функций и преимуществ, которые помогут получить ваш миграция осуществляется гладко.

## <a name="benefits-of-using-a-tool-to-transfer-data-offline"></a>Преимущества использования инструмента для передачи данных в автономном режиме
Вот основные преимущества использования инструмента передачи, такого как Data Box для автономной миграции:

- Вам не нужно загружать все файлы по сети. Для больших областей имен этот инструмент может сэкономить значительную пропускную способность сети и время.
- При использовании Azure File Sync независимо от того, какой инструмент передачи используется (Data Box, служба импорта/экспорта Azure и т.д.), ваш живой сервер загружает только файлы, которые изменяются после перемещения данных в Azure.
- Синхронизация файлов Azure Sync синхронизирует акля с файлами и папками, даже если автономный инструмент миграции навалом не транспортирует АКЛ.
- Синхронизация файлов Data Box и Azure не требует простоев. При использовании Data Box для передачи данных в Azure вы эффективно используете пропускную способность сети и сохраняете точность файла. Вы также сохраняете свое пространство имен в актуальном состоянии, загружая только файлы, которые изменяются после перемещения данных в Azure.

## <a name="prerequisites-for-the-offline-data-transfer"></a>Предпосылки для передачи данных в автономном режиме
Не следует включать синхронизацию на перемиграемом сервере до завершения переноса данных в автономном режиме. Другие вещи, чтобы рассмотреть, прежде чем начать являются следующими:

- Если вы планируете использовать Data Box для массовой миграции: Просмотрите [предпосылки развертывания для коробки данных.](../../databox/data-box-deploy-ordered.md#prerequisites)
- Планирование окончательной топологии синхронизации файлов Azure: [Планирование развертывания azure File Sync](storage-sync-files-planning.md)
- Выберите учетные записи хранения Azure, в которых будут храниться общие папки, с которыми нужно выполнить синхронизацию. Убедитесь, что массовое перемещение выполняется во временные общие папки промежуточного хранения в одной и той же учетной записи хранения. Массовое перемещение может быть включено только с использованием конечной общей папки и общей папки промежуточного хранения, которые находятся в одной учетной записи хранения.
- Массовое перемещение возможно только при создании новых связей синхронизации с расположением на сервере. Нельзя включить массовое перемещение с существующими связями синхронизации.


## <a name="process-for-offline-data-transfer"></a>Процесс передачи данных в автономном режиме
Вот как настроить синхронизацию файлов Azure таким образом, чтобы она была совместима с инструментами массового переноса, такими как Azure Data Box:

![Диаграмма, показывающая, как настроить синхронизацию файлов Azure](media/storage-sync-files-offline-data-transfer/data-box-integration-1-600.png)

| Шаг | Описание |
|---|---------------------------------------------------------------------------------------|
| ![Шаг 1](media/storage-sync-files-offline-data-transfer/bullet_1.png) | [Заказ Data Box](../../databox/data-box-deploy-ordered.md). Семейство Data Box предлагает [несколько продуктов](https://azure.microsoft.com/services/storage/databox/data) для удовлетворения ваших потребностей. Когда вы получаете свой ящик данных, следуйте его [документации, чтобы скопировать ваши данные](../../databox/data-box-deploy-copy-data.md#copy-data-to-data-box) на этот путь КООН на box data: * \\<\>\<DeviceIPAddres StorageAccountName_AzFile\>\<ShareName\>*. Здесь *ShareName* — это название долей постановки. Отправьте Data Box обратно в Azure. |
| ![Шаг 2](media/storage-sync-files-offline-data-transfer/bullet_2.png) | Подождите, пока файлы не появятся в файлах Azure, которые вы выбрали в качестве временных плагиат. *Не позволяет синхронизировать эти акции.* |
| ![Шаг 3.](media/storage-sync-files-offline-data-transfer/bullet_3.png) | Создайте новую пустую долю для каждого файла, созданного для вас Box. Эта новая доля должна находиться в той же учетной записи хранения, что и доля Box данных. [Создание общей папки в службе файлов Azure](storage-how-to-create-file-share.md). |
| ![Шаг 4.](media/storage-sync-files-offline-data-transfer/bullet_4.png) | [Создание группы синхронизации](storage-sync-files-deployment-guide.md#create-a-sync-group-and-a-cloud-endpoint) в службе синхронизации хранилища. Справка о пустой доле в качестве конечной точки облака. Повторите этот шаг для каждой общей папки Data Box. [Настройка синхронизации файлов Azure.](storage-sync-files-deployment-guide.md) |
| ![Шаг 5](media/storage-sync-files-offline-data-transfer/bullet_5.png) | [Добавьте каталог своего активного сервера в качестве конечной точки сервера](storage-sync-files-deployment-guide.md#create-a-server-endpoint). В процессе укажите, что вы перенесли файлы в Azure, и ссылку на промежуточные акции. Вы можете включить или отключить многоуровневое облако по мере необходимости. При создании конечной точки сервера на вашем реальном сервере ссылка на плагиатную долю. На blade **endpoint Add Server** под **offline Data Transfer**выберите **Enabled,** а затем выберите долю постановки, которая должна быть в той же учетной записи хранения, что и конечная точка облака. Здесь список доступных акций фильтруется на счет хранения и акции, которые еще не синхронизированы. |

![Скриншот пользовательского интерфейса портала Azure, показывающий, как включить офлайн-передачу данных при создании новой конечной точки сервера](media/storage-sync-files-offline-data-transfer/data-box-integration-2-600.png)

## <a name="syncing-the-share"></a>Синхронизация общих папок
После создания конечной точки сервера синхронизация начнется. Процесс синхронизации определяет, существует ли каждый файл на сервере в промежуточной акции, в которой Data Box депонировал файлы. Если файл существует там, процесс синхронизации копирует файл из промежуточной доли, а не загружает его с сервера. Если файл не существует в постановочной доле или если на локальном сервере доступна новая версия, процесс синхронизации загружает файл с локального сервера.

> [!IMPORTANT]
> Режим миграции навалом можно включить только при создании конечной точки сервера. После создания конечной точки сервера нельзя интегрировать данные с объемной миграции данных с уже синхронизированного сервера в пространство имен.

## <a name="acls-and-timestamps-on-files-and-folders"></a>Списки управления доступом и метки времени для файлов и папок
Azure File Sync гарантирует синхронизацию акпла в файлах и папке с живым сервером, даже если используемый инструмент массовой миграции изначально не перевозил АПл. Из-за этого постановочная доля не должна содержать акфолк для файлов и папок. При включании функции переносного миграции данных при создании новой конечной точки сервера все окворы файлов синхронизируются на сервере. Недавно созданные и измененные метки времени также синхронизируются.

## <a name="shape-of-the-namespace"></a>Схема пространства имен
При синхронизации содержимое сервера определяет форму пространства имен. Если файлы удаляются с локального сервера после завершения моментального снимка и миграции, эти файлы не перемещаются в живое, синхронизирующее пространство имен. Они остаются в постановке доля, но они не скопированы. Это необходимо, поскольку синхронизация сохраняет пространство имен в соответствии с живым сервером. *Снимок* Box data — это всего лишь плацдарм для эффективной копии файлов. Это не авторитет для формы живого пространства имен.

## <a name="cleaning-up-after-bulk-migration"></a>Очистка после массовой миграции 
По мере завершения первоначальной синхронизации сервера сервера файлами Data Box используются промежуточные файлы. На blade **Endpoint Properties сервера** на портале Azure в разделе **Оффлайн-передача данных** статус изменяется от **In Progress** к **Завершенной.** 

![Скриншот лезвия свойств конечных элементов сервера, где расположены статус и отключение элементов управления для передачи данных в автономном режиме](media/storage-sync-files-offline-data-transfer/data-box-integration-3-444.png)

Теперь вы можете очистить постановочную долю, чтобы сэкономить расходы:

1. На лезвии **свойств конечных данных Сервера** при **завершении**состояния выберите **переносную передачу данных в автономном режиме.**
2. Рассмотрите возможность удалять постановочную долю для экономии затрат. Постановочная доля, вероятно, не содержит аклясов файлов и папок, поэтому она вряд ли будет полезна. Для целей резервного копирования в момент времени создайте реальный [снимок совместного использования файлов Azure.](storage-snapshots-files.md) Можно [настроить резервное копирование Azure для создания моментальных снимков]( ../../backup/backup-afs.md) по расписанию.

Отключение автономного режима передачи данных только тогда, когда состояние **завершено** или когда вы хотите отменить из-за неправильной настройки. Если вы отведете режим во время развертывания, файлы начнут загружаться с сервера, даже если ваша постановочная доля по-прежнему доступна.

> [!IMPORTANT]
> После того как вы отключите автономный режим передачи данных, вы не можете включить его снова, даже если постановочная доля от массовой миграции по-прежнему доступна.

## <a name="next-steps"></a>Дальнейшие действия
- [Планирование развертывания службы синхронизации файлов Azure](storage-sync-files-planning.md)
- [Развертывание Синхронизации файлов Azure](storage-sync-files-deployment-guide.md)
