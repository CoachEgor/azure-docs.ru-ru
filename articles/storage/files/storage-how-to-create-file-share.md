---
title: создать файловый ресурс Azure;
titleSuffix: Azure Files
description: Как создать общий файл Azure с помощью портала Azure, PowerShell или ClI Azure.
author: roygara
ms.service: storage
ms.topic: conceptual
ms.date: 2/22/2020
ms.author: rogarana
ms.subservice: files
ms.openlocfilehash: ed6abbac7c5953eaec4fa4584248d0d98b49ba63
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "77596932"
---
# <a name="create-an-azure-file-share"></a>создать файловый ресурс Azure;
Чтобы создать общий файл Azure, необходимо ответить на три вопроса о том, как вы будете использовать его:

- **Каковы требования к производительности для общего файла Azure?**  
    Azure Files предлагает стандартные файлы, которые размещаются на жестком диске на основе (HDD основе) аппаратных средств, и премиум-файл акций, которые размещаются на твердотельных дисков на основе оборудования.

- **Какой размер файла вам нужно?**  
    Стандартные файлы могут охватывать до 100 TiB, однако эта функция не включена по умолчанию; если вам нужна доля файлов, которая больше 5 TiB, вам нужно включить большую функцию общего файла для вашей учетной записи хранения. Премиум файл акций может охватывать до 100 TiB без каких-либо специальных параметров, однако премиум файл акций предусмотрены, а не платить, как вы идете, как стандартные файлы акций. Это означает, что подготовка файла намного больше, чем то, что вам нужно, увеличит общую стоимость хранения.

- **Каковы ваши требования к избыточности для совместной акции файлов Azure?**  
    Стандартные файловые акции предлагают локально-излишние (LRS), зоны избыточные (ЗРС), гео-излишние (GRS), или гео-зоны-излишним (G'S) хранения, однако большая функция обмена файлами поддерживается только локально избыточных и зонных избыточных файлов. Премиум-файлы не поддерживают какую-либо форму геоизбыточности.

    Премиум-файлы доступны с локальной избыточностью в большинстве регионов, которые предлагают учетные записи хранения и с резервом зоны в меньшем подмножестве регионов. Чтобы узнать, доступны ли в настоящее время в вашем регионе акции премиум-файлов, ознакомьтесь с [продуктами, доступными по](https://azure.microsoft.com/global-infrastructure/services/?products=storage) странице Azure по регионам. Для получения информации о регионах, поддерживающих ЗрЗ, [см.](../common/storage-redundancy.md?toc=%2fazure%2fstorage%2ffiles%2ftoc.json)

Для получения дополнительной информации об этих трех вариантах можно ознакомиться на примере [планирования развертывания Azure Files.](storage-files-planning.md)

## <a name="prerequisites"></a>Предварительные требования
- В этой статье предполагается, что вы уже создали подписку Azure. Если у вас еще нет подписки, вы можете [создать бесплатную учетную запись Azure](https://azure.microsoft.com/free/?WT.mc_id=A261C142F), прежде чем начинать работу.
- Если вы собираетесь использовать Azure PowerShell, [установите последнюю версию.](https://docs.microsoft.com/powershell/azure/install-az-ps)
- Если вы собираетесь использовать Azure CLI, [установите последнюю версию.](https://docs.microsoft.com/cli/azure/install-azure-cli?view=azure-cli-latest)

## <a name="create-a-storage-account"></a>Создание учетной записи хранения
Файлы Azure развертываются в *учетные записи хранения*данных, которые представляют собой объекты верхнего уровня, представляющие общий пул хранения. Этот пул хранения может использоваться для развертывания нескольких файлов. 

Azure поддерживает несколько типов учетных записей хранения для различных сценариев хранения, но для файлов Azure есть два основных типа учетных записей. Какой тип учетной записи хранилища необходимо создать, зависит от того, хотите ли вы создать стандартную долю файла или премиум-долю файла: 

- Учетные записи хранения данных общего **назначения 2 (GPv2):** учетные записи хранения GPv2 позволяют развертывать файлы Azure на стандартном/жестком дисковом оборудовании (HDD-основе). Помимо хранения файлов Azure, учетные записи хранения GPv2 могут хранить другие ресурсы хранения, такие как контейнеры с каплями, очереди или таблицы. 

- **Учетные записи хранения FileStorage:** учетные записи хранения файлов File File File позволяют развертывать акции файлов Azure на аппаратном обеспечении на основе премиум-класса/твердого состояния дисков(SSD). Учетные записи FileStorage можно использовать только для хранения файлов Azure; никакие другие ресурсы хранения данных (контейнеры с blob, очереди, таблицы и т.д.) не могут быть развернуты в учетной записи FileStorage.

# <a name="portal"></a>[Портал](#tab/azure-portal)
Чтобы создать учетную запись хранилища через портал Azure, выберите **ресурс** из панели мониторинга. В полученном в результате search window Azure Marketplace ищите **учетную запись хранилища** и выберите полученный результат поиска. Это приведет к обзору страницы для учетных записей хранения; Выберите **Создать,** чтобы продолжить работу с мастером создания учетной записи хранилища.

![Скриншот учетной записи хранения быстро создать опцию в браузере](media/storage-how-to-create-file-share/create-storage-account-0.png)

#### <a name="the-basics-section"></a>Раздел Основы
Первый раздел, который необходимо заполнить для создания учетной записи хранилища, помечен **как Основы.** Это содержит все необходимые поля для создания учетной записи хранилища. Чтобы создать учетную запись хранения GPv2, убедитесь, что кнопка радио **"Производительность"** установлена в *Стандартной,* а список выпадающих данных **учетной записи** выбран для *StorageV2 (общее назначение v2).*

![Скриншот кнопки радиопроизводительности со стандартным выбранным и видом учетной записи с выбранным StorageV2](media/storage-how-to-create-file-share/create-storage-account-1.png)

Чтобы создать учетную запись хранения FileStorage, убедитесь, что радиокнопка **производительности** установлена на *Premium,* а список выпадающих данных **учетной записи** выбран *в FileStorage.*

![Скриншот кнопки радио "Производительность" с выбранным Премиум и видом учетной записи с выбранным FileStorage](media/storage-how-to-create-file-share/create-storage-account-2.png)

Другие базовые поля независимы от выбора учетной записи хранения:
- **Подписка**: Подписка на учетную запись хранения, которая будет развернута. 
- **Группа ресурсов**: Группа ресурсов для учетной записи хранилища, в которая будет развернута. Можно создать новую группу ресурсов или использовать существующую группу ресурсов. Группа ресурсов — это логический контейнер для группирования служб Azure. При создании учетной записи хранения у вас есть возможность создать новую или использовать существующую группу ресурсов.
- **Имя учетной записи хранения**: Имя ресурса учетной записи хранилища, которое будет создано. Это имя должно быть глобально уникальным, но в противном случае может любое имя вы хотите. Имя учетной записи хранилища будет использоваться в качестве имени сервера при установке совместного использования файла Azure через SMB.
- **Расположение**: Область для учетной записи хранилища, в которая будет развернута. Это может быть регион, связанный с группой ресурсов, или любой другой доступный регион.
- **Репликация**: Хотя это помечено репликации, это поле на самом деле означает **избыточность;** это желаемый уровень избыточности: локальноизбыточность (LRS), избыточность зон (ЗРС), геоизбыточность (GRS) и гео-зона-избыточность. Этот список также содержит геоизбыточность с помощью доступа (RA-GRS) и избыточность геозоны с помощью чтения (RA-G'S), которые не распространяются на файлы Azure; любая доля файлов, созданная в учетной записи хранилища с выбранными вами, будет либо геоизмеримым, либо геозон-излишним, соответственно. В зависимости от региона или выбранного типа учетной записи хранилища некоторые варианты избыточности могут быть запрещены.
- **Уровень доступа**: Это поле не применяется к файлам Azure, так что вы можете выбрать одну из радиокнопок.

#### <a name="the-networking-blade"></a>Сетевое лезвие
Сетевой раздел позволяет настроить параметры сетей. Эти настройки не являются обязательными для создания учетной записи хранилища и могут быть настроены позже, если это необходимо. Для получения дополнительной информации [Azure Files networking considerations](storage-files-networking-overview.md)об этих опциях см.

#### <a name="the-advanced-blade"></a>Расширенный лезвие
Расширенный раздел содержит несколько важных параметров для файлов Azure:

- **Требуется безопасная передача**: Это поле указывает, требует ли учетная запись хранилища шифрования при переходе для связи с учетной записью хранилища. Мы рекомендуем это оставлено включенным, однако, если вам требуется поддержка SMB 2.1, вы должны отключить это. Мы рекомендуем отключить шифрование, чтобы вы ограничили доступ учетной записи хранилища к виртуальной сети с конечными точками обслуживания и/или частными конечными точками.
- **Большие доли файлов**: Это поле позволяет учетной записи хранения для файлов акций, охватывающих до 100 TiB. Включение этой функции ограничит учетную запись хранилища только локально избыточными и зонными избыточными вариантами хранения. После включения учетной записи хранилища GPv2 для больших файлов нельзя отключить большую возможность обмена файлами. Учетные записи хранения FileStorage (учетные записи для премиум-файла) не имеют этой опции, так как все премиальные файлы могут масштабироваться до 100 TiB. 

![Скриншот важных расширенных настроек, применимых к файлам Azure](media/storage-how-to-create-file-share/create-storage-account-3.png)

Другие параметры, доступные в расширенной вкладке (blob soft-delete, иерархическое пространство имен для хранения Azure Data Lake 2 и NFSv3 для хранения капли) не применяются к файлам Azure.

#### <a name="tags"></a>Теги
Теги — это пары имен/значений, которые позволяют классифицировать ресурсы и просматривать консолидированный биллинг, применяя один и тот же тег для нескольких ресурсов и групп ресурсов. Они являются необязательными и могут быть применены после создания учетной записи хранилища.

#### <a name="review--create"></a>Отзыв и создание
Последним шагом для создания учетной записи хранилища является выбор кнопки **«Создание»** на вкладке **«Обзор» и «Создание».** Эта кнопка не будет доступна, если все необходимые поля для учетной записи хранилища не будут заполнены.

# <a name="powershell"></a>[PowerShell](#tab/azure-powershell)
Для создания учетной записи хранилища с `New-AzStorageAccount` помощью PowerShell мы будем использовать cmdlet. Этот cmdlet имеет много вариантов; отображаются только необходимые параметры. Чтобы узнать больше о расширенных опциях, см документация [ `New-AzStorageAccount` cmdlet](/powershell/module/az.storage/new-azstorageaccount).

Чтобы упростить создание учетной записи хранилища и последующего обмена файлами, мы будем хранить несколько параметров в переменных. Вы можете заменить содержимое переменной любыми значениями, однако обратите внимание, что имя учетной записи хранилища должно быть глобально уникальным.

```azurepowershell-interactive
$resourceGroupName = "myResourceGroup"
$storageAccountName = "mystorageacct$(Get-Random)"
$region = "westus2"
```

Для создания учетной записи хранения, способной хранить стандартные файлы Azure, мы будем использовать следующую команду. Параметр `-SkuName` относится к типу желаемого избыточности; если вы желаете гео-излишним или гео-зонально-излишним хранилищем, вы также должны удалить `-EnableLargeFileShare` параметр.

```azurepowershell-interactive
$storAcct = New-AzStorageAccount `
    -ResourceGroupName $resourceGroupName `
    -Name $storageAccountName `
    -SkuName Standard_LRS `
    -Location $region `
    -Kind StorageV2 `
    -EnableLargeFileShare
```

Для создания учетной записи хранения, способной хранить премиальные файлы Azure, мы будем использовать следующую команду. Обратите внимание, что `-SkuName` параметр `Premium` изменился, чтобы включить как, так`LRS`и желаемый уровень избыточности локально избыточного (). Параметр, `-Kind` а `StorageV2` не потому, что премиум-файл ы должны быть созданы в учетной записи хранения FileStorage вместо учетной записи хранения GPv2. `FileStorage`

```azurepowershell-interactive
$storAcct = New-AzStorageAccount `
    -ResourceGroupName $resourceGroupName `
    -Name $storageAccountName `
    -SkuName Premium_LRS `
    -Location $region `
    -Kind FileStorage 
```

# <a name="azure-cli"></a>[Лазурный CLI](#tab/azure-cli)
Для создания учетной записи хранения с помощью Azure CLI мы будем использовать команду создания учетной записи на хранении az. Эта команда имеет много вариантов; отображаются только необходимые параметры. Чтобы узнать больше о расширенных опциях, [ `az storage account create` см.](/cli/azure/storage/account)

Чтобы упростить создание учетной записи хранилища и последующего обмена файлами, мы будем хранить несколько параметров в переменных. Вы можете заменить содержимое переменной любыми значениями, однако обратите внимание, что имя учетной записи хранилища должно быть глобально уникальным.

```azurecli-interactive
resourceGroupName="myResourceGroup"
storageAccountName="mystorageacct$RANDOM"
region="westus2"
```

Для создания учетной записи хранения, способной хранить стандартные файлы Azure, мы будем использовать следующую команду. Параметр `--sku` относится к типу желаемого избыточности; если вы желаете гео-излишним или гео-зонально-излишним хранилищем, вы также должны удалить `--enable-large-file-share` параметр.

```azurecli-interactive
az storage account create \
    --resource-group $resourceGroupName \
    --name $storageAccountName \
    --kind StorageV2 \
    --sku Standard_ZRS \
    --enable-large-file-share \
    --output none
```

Для создания учетной записи хранения, способной хранить премиальные файлы Azure, мы будем использовать следующую команду. Обратите внимание, что `--sku` параметр `Premium` изменился, чтобы включить как, так`LRS`и желаемый уровень избыточности локально избыточного (). Параметр, `--kind` а `StorageV2` не потому, что премиум-файл ы должны быть созданы в учетной записи хранения FileStorage вместо учетной записи хранения GPv2. `FileStorage`

```azurecli-interactive
az storage account create \
    --resource-group $resourceGroupName \
    --name $storageAccountName \
    --kind FileStorage \
    --sku Premium_LRS \
    --output none
```

---

## <a name="create-file-share"></a>Создание общей папки
После создания учетной записи хранилища остается только создать свою долю файлов. Этот процесс в основном один и тот же, независимо от того, используете ли вы премиум-файл или стандартную долю файла. Основным отличием является **квота** и то, что она представляет.

Для стандартных файлов это верхняя граница раздела файлов Azure, за которой конечные пользователи не могут пойти. Основная цель квоты на стандартную долю файлов является бюджетной: «Я не хочу, чтобы эта доля файлов росла дальше этой точки». Если квота не указана, стандартная доля файлов может охватывать до 100 TiB (или 5 TiB, если большое свойство акций файла не установлено для учетной записи хранилища).

Для премиальных файлов квота перегружена, чтобы означать **размер.** Предусмотренный размер — это сумма, за которую вам будет выставлен счет, независимо от фактического использования. При предоставлении премиальной доли файла необходимо учитывать два фактора: 1) будущий рост доли с точки зрения использования пространства и 2) IOPS, необходимые для вашей рабочей нагрузки. Каждый подготовленный GiB дает вам право на дополнительные зарезервированные и взрыв IOPS. Для получения дополнительной информации о том, как планировать премиум-файл доля, [см.](storage-files-planning.md#understanding-provisioning-for-premium-file-shares)

# <a name="portal"></a>[Портал](#tab/azure-portal)
Если вы только что создали учетную запись хранения, вы можете перейти к ней с экрана развертывания, выбрав **Перейти к ресурсу**. Если вы ранее создали учетную запись хранилища, вы можете перейти к ней через группу ресурсов, содержащую ее. Оказавшись в учетной записи хранилища, выберите плитку с пометкой **Файл акций** (вы также можете перемещаться по **файлу акций** через таблицу содержимого для учетной записи хранения).

![Скриншот плитки акций файла](media/storage-how-to-create-file-share/create-file-share-1.png)

В объявлении о доле файла вы должны увидеть все файлы, которые вы ранее создали в этой учетной записи; пустой таблицы, если пока не созданы файловые акции. Выберите **совместное файла** для создания новой доли файла.

На экране должно появиться новое лезвие общего файла. Заполните поля в новом лезвии общего файла для создания общего файла:

- **Имя**: имя создаваемого файла.
- **Квота**: Квота доли файла для стандартных акций файла; предусмотренный размер доли файла для премиальных файлов.

Выберите **Создать** для завершения создания новой доли. Обратите внимание, что если ваша учетная запись находится в виртуальной сети, вы не сможете успешно создать общий файл Azure, если ваш клиент также не окажется в виртуальной сети. Вы также можете обойти это ограничение по времени, используя `New-AzRmStorageShare` cmdlet Azure PowerShell.

# <a name="powershell"></a>[PowerShell](#tab/azure-powershell)
Можно создать совместное сфайлом [`New-AzRmStorageShare`](/powershell/module/az.storage/New-AzRmStorageShare) Azure с помощью cmdlet. Следующие команды PowerShell предполагают, что `$resourceGroupName` вы `$storageAccountName` установили переменные и, как определено выше, в создании учетной записи хранилища с разделом Azure PowerShell. 

> [!Important]  
> Для премиальных файлов `-QuotaGiB` параметр относится к объему резервированного файла. Предусмотренный размер доли файла — это сумма, за которую вы будете выставлены счета, независимо от его использования. Стандартные файлы выставляются на основе использования, а не приготовительного размера.

```azurepowershell-interactive
$shareName = "myshare"

New-AzRmStorageShare `
    -ResourceGroupName $resourceGroupName `
    -StorageAccountName $storageAccountName `
    -Name $shareName `
    -QuotaGiB 1024 | Out-Null
```

> [!Note]  
> Имя общей папки должно состоять из символов в нижнем регистре. Для получения подробной информации о наименовании файлов и файлов [см.](https://msdn.microsoft.com/library/azure/dn167011.aspx)

# <a name="azure-cli"></a>[Лазурный CLI](#tab/azure-cli)
Прежде чем мы сможем создать совместное хранилище файлов Azure с помощью Azure CLI, необходимо получить ключ учетной записи хранилища, чтобы авторизовать операцию создания файла. Это можно сделать [`az storage account keys list`](/cli/azure/storage/account/keys) с командой:

```azurecli-interactive
storageAccountKey=$(az storage account keys list \
    --resource-group $resourceGroupName \
    --account-name $storageAccountName \
    --query "[0].value" | tr -d '"')
```

После того, как у вас есть ключ учетной [`az storage share create`](/cli/azure/storage/share) записи хранилища, можно создать совместное хранилище файлов Azure с командой. 

> [!Important]  
> Для премиальных файлов `--quota` параметр относится к объему резервированного файла. Предусмотренный размер доли файла — это сумма, за которую вы будете выставлены счета, независимо от его использования. Стандартные файлы выставляются на основе использования, а не приготовительного размера.

```azurecli-interactive
shareName="myshare"

az storage share create \
    --account-name $storageAccountName \
    --account-key $storageAccountKey \
    --name $shareName \
    --quota 1024 \
    --output none
```

Эта команда выйдет из строя, если учетная запись хранилища содержится в виртуальной сети, а компьютер, с помощью которой вы ссылаетесь, не является частью виртуальной сети. Вы можете обойти это ограничение по времени, используя cmdlet Azure PowerShell, `New-AzRmStorageShare` как описано выше, или исполняя Azure CLI с компьютера, который является частью виртуальной сети, в том числе через VPN соединение.

---

> [!Note]  
> Имя общей папки должно состоять из символов в нижнем регистре. Для получения подробной информации о наименовании файлов и файлов [см.](https://msdn.microsoft.com/library/azure/dn167011.aspx)

## <a name="next-steps"></a>Дальнейшие действия
- [Планирование развертывания файлов Azure](storage-files-planning.md) или [план развертывания синхронизации файлов Azure.](storage-sync-files-planning.md) 
- [Обзор сети](storage-files-networking-overview.md).
- Подключите и установите долю файлов на [Windows,](storage-how-to-use-files-windows.md) [macOS](storage-how-to-use-files-mac.md)и [Linux.](storage-how-to-use-files-linux.md)