---
title: создать файловый ресурс Azure;
titleSuffix: Azure Files
description: Как создать файловый ресурс Azure с помощью портал Azure, PowerShell или Azure CLI.
author: roygara
ms.service: storage
ms.topic: how-to
ms.date: 2/22/2020
ms.author: rogarana
ms.subservice: files
ms.openlocfilehash: ba6f4bcaffbf9fa11c949853362485d524bec23a
ms.sourcegitcommit: 877491bd46921c11dd478bd25fc718ceee2dcc08
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/02/2020
ms.locfileid: "85510022"
---
# <a name="create-an-azure-file-share"></a>создать файловый ресурс Azure;
Чтобы создать файловый ресурс Azure, необходимо ответить на три вопроса о том, как она будет использоваться:

- **Каковы требования к производительности для файлового ресурса Azure?**  
    Службы файлов Azure предлагают стандартные общие папки, размещенные на жестких дисках (на основе жесткого диска) и в общих файловых ресурсах уровня "Премиум", которые размещаются на дисках с твердотельным накопителем (на основе твердотельных накопителей).

- **Какой размер файлового ресурса требуется?**  
    Стандартные общие файловые ресурсы могут охватывать до 100 Тиб, однако эта функция не включена по умолчанию. Если требуется общая папка, размер которой превышает 5 Тиб, необходимо включить функцию большого общего файлового ресурса для вашей учетной записи хранения. Общие файловые ресурсы уровня "Премиум" могут охватывать до 100 Тиб без каких бы то ни было специальных настроек, однако файловые ресурсы уровня "Премиум" подготавливаются к работе, а не по мере использования стандартных файловых ресурсов. Это означает, что подготовка файлового ресурса гораздо больше, чем требуется, увеличит общую стоимость хранилища.

- **Каковы требования к избыточности для файлового ресурса Azure?**  
    Стандартные общие папки предлагают локально избыточное (LRS), избыточное в зоне (ZRS), геоизбыточное (GRS) или геоизбыточное (ГЗРС) хранилище. Однако функция больших файловых ресурсов поддерживается только в локально избыточных файловых ресурсах и избыточных зонах. Файловые ресурсы уровня "Премиум" не поддерживают геоизбыточность.

    Общие файловые ресурсы уровня "Премиум" доступны с локально избыточностью в большинстве регионов, которые предлагают учетные записи хранения и избыточность зоны в меньшем подмножестве регионов. Чтобы узнать, доступны ли в вашем регионе общедоступные файловые ресурсы уровня "Премиум", см. страницу [доступность продуктов по регионам](https://azure.microsoft.com/global-infrastructure/services/?products=storage) для Azure. Сведения о регионах, поддерживающих ZRS, см. в статье [избыточность службы хранилища Azure](../common/storage-redundancy.md?toc=%2fazure%2fstorage%2ffiles%2ftoc.json).

Дополнительные сведения об этих трех вариантах см. в статье [Планирование развертывания службы файлов Azure](storage-files-planning.md).

## <a name="prerequisites"></a>Предварительные требования
- В этой статье подразумевается, что вы уже создали подписку Azure. Если у вас еще нет подписки, вы можете [создать бесплатную учетную запись Azure](https://azure.microsoft.com/free/?WT.mc_id=A261C142F), прежде чем начинать работу.
- Если вы хотите использовать Azure PowerShell, [установите последнюю версию](https://docs.microsoft.com/powershell/azure/install-az-ps).
- Если вы хотите использовать Azure CLI, [установите последнюю версию](https://docs.microsoft.com/cli/azure/install-azure-cli?view=azure-cli-latest).

## <a name="create-a-storage-account"></a>Создание учетной записи хранения
Файловые ресурсы Azure развертываются в *учетных записях хранения*, которые представляют собой объекты верхнего уровня, представляющие общий пул хранилища. Этот пул хранилища можно использовать для развертывания нескольких файловых ресурсов. 

Azure поддерживает несколько типов учетных записей хранения для различных сценариев хранилища, которые могут иметь клиенты, но для службы файлов Azure существуют два основных типа учетных записей хранения. Тип учетной записи хранения, который необходимо создать, зависит от того, хотите ли вы создать стандартный файловый ресурс или общую папку Premium: 

- **Учетные записи хранения общего назначения версии 2 (GPv2)**. учетные записи хранения GPv2 позволяют развертывать файловые ресурсы Azure на оборудовании на основе стандартного или жесткого диска (на основе жестких дисков). Помимо хранения файловых ресурсов Azure, учетные записи хранения GPv2 могут хранить другие ресурсы хранилища, такие как контейнеры больших двоичных объектов, очереди или таблицы. 

- **Учетные записи хранения филестораже**. учетные записи хранения филестораже позволяют развертывать файловые ресурсы Azure на оборудовании уровня "Премиум" или твердотельного накопителя (на основе SSD). Учетные записи Филестораже можно использовать только для хранения файловых ресурсов Azure. другие ресурсы хранилища (контейнеры больших двоичных объектов, очереди, таблицы и т. д.) не могут быть развернуты в учетной записи Филестораже.

# <a name="portal"></a>[Портал](#tab/azure-portal)
Чтобы создать учетную запись хранения с помощью портал Azure, выберите **+ создать ресурс** на панели мониторинга. В результирующем окне поиска Azure Marketplace найдите **учетную запись хранения** и выберите результирующий результат поиска. Это приводит к обзорной странице учетных записей хранения. Выберите **создать** , чтобы продолжить работу с мастером создания учетной записи хранения.

![Снимок экрана с параметром быстрого создания учетной записи хранения в браузере](media/storage-how-to-create-file-share/create-storage-account-0.png)

#### <a name="the-basics-section"></a>Раздел "Основные сведения"
Первый раздел, который необходимо завершить для создания учетной записи хранения, помечен как **базовый**. В нем содержатся все необходимые поля для создания учетной записи хранения. Чтобы создать учетную запись хранения GPv2, убедитесь, что переключатель " **производительность** " установлен в значение " *стандартный* ", а в раскрывающемся списке " **тип учетной записи** " выбрано значение *StorageV2 (общего назначения версии 2)*.

![Снимок экрана с переключателем "производительность" со стандартным выбранным видом и типом учетной записи с выбранным StorageV2](media/storage-how-to-create-file-share/create-storage-account-1.png)

Чтобы создать учетную запись хранения Филестораже, убедитесь, что переключатель " **производительность** " имеет значение " *премиум* ", а в раскрывающемся списке " **тип учетной записи** " выбрано значение *филестораже*.

![Снимок экрана: переключатель "производительность" с выбранным Premium и типом учетной записи с выбранным Филестораже](media/storage-how-to-create-file-share/create-storage-account-2.png)

Другие основные поля не зависят от выбора учетной записи хранения.
- **Подписка**. Подписка на учетную запись хранения, в которую будет выполнено развертывание. 
- **Группа ресурсов**. Группа ресурсов для учетной записи хранения, в которую будет выполнено развертывание. Вы можете либо создать новую группу ресурсов, либо использовать существующую. Группа ресурсов — это логический контейнер для группирования служб Azure. При создании учетной записи хранения у вас есть возможность создать новую или использовать существующую группу ресурсов.
- **Имя учетной записи хранения**: имя создаваемого ресурса учетной записи хранения. Это имя должно быть глобально уникальным, но в противном случае может потребоваться любое имя. Имя учетной записи хранения будет использоваться в качестве имени сервера при подключении общей папки Azure через SMB.
- **Location**— регион для учетной записи хранения, в которой будет выполнено развертывание. Это может быть регион, связанный с группой ресурсов, или любой другой доступный регион.
- **Репликация**. Хотя это и называется репликацией, это поле фактически означает **избыточность**; Это требуемый уровень избыточности: локальное избыточность (LRS), избыточность зоны (ZRS), геоизбыточность (GRS) и геоизбыточность геозоны. В этом раскрывающемся списке также содержатся геоизбыточность с доступом для чтения (RA-GRS) и избыточность геозоны с доступом на чтение (RA-ГЗРС), которая не применяется к файловым ресурсам Azure. любая общая папка, созданная в учетной записи хранения с выбранными данными, будет иметь геоизбыточное значение или геоизбыточную зону соответственно. В зависимости от региона или выбранного типа учетной записи хранения некоторые параметры избыточности могут быть запрещены.
- **Уровень доступа**. это поле не применяется к службе "файлы Azure", поэтому можно выбрать один из переключателей.

#### <a name="the-networking-blade"></a>Колонка "Сетевые подключения"
Раздел "Сетевые подключения" позволяет настроить сетевые параметры. Эти параметры являются необязательными для создания учетной записи хранения и могут быть настроены позже при необходимости. Дополнительные сведения об этих параметрах см. в статье рекомендации по работе с [сетью в службе файлов Azure](storage-files-networking-overview.md).

#### <a name="the-advanced-blade"></a>Колонка "Дополнительно"
Раздел Advanced содержит несколько важных параметров для файловых ресурсов Azure.

- **Требуется безопасное перемещение**: это поле указывает, требуется ли для учетной записи хранения шифрование при передаче для обмена данными с учетной записью хранения. Если требуется поддержка SMB 2,1, мы рекомендуем включить эту функцию. Рекомендуется отключить шифрование, которое ограничивает доступ учетной записи хранения к виртуальной сети с конечными точками службы и (или) частными конечными точками.
- **Большие файловые ресурсы**. это поле включает учетную запись хранения для файловых ресурсов, охватывающих до 100 тиб. При включении этой функции учетная запись хранения будет ограничена только локально избыточными и избыточными параметрами хранения в пределах зоны. После включения учетной записи хранения GPv2 для больших файловых ресурсов невозможно отключить функцию большого общего файлового ресурса. Учетные записи хранения Филестораже (учетные записи хранения для файловых ресурсов уровня "Премиум") не имеют этого параметра, так как все файловые ресурсы уровня "Премиум" могут масштабироваться до 100 тиб. 

![Снимок экрана с важными дополнительными параметрами, которые применяются к службе файлов Azure](media/storage-how-to-create-file-share/create-storage-account-3.png)

Другие параметры, доступные на вкладке Дополнительно (обратимое удаление BLOB-объектов, иерархическое пространство имен для Azure Data Lake хранилища Gen 2 и NFSv3 для хранилища BLOB-объектов), не применяются к службе файлов Azure.

#### <a name="tags"></a>Tags
Теги — это пары имя — значение, которые можно назначать различным ресурсам и группам ресурсов для их категоризации и консолидированного отображения счетов. Они необязательны и могут быть применены после создания учетной записи хранения.

#### <a name="review--create"></a>Отзыв и создание
Последним шагом для создания учетной записи хранения является нажатие кнопки **создать** на вкладке **Проверка и создание** . Эта кнопка будет недоступна, если не заполнены все обязательные поля для учетной записи хранения.

# <a name="powershell"></a>[PowerShell](#tab/azure-powershell)
Чтобы создать учетную запись хранения с помощью PowerShell, мы будем использовать `New-AzStorageAccount` командлет. У этого командлета есть множество параметров. отображаются только необходимые параметры. Дополнительные сведения о дополнительных параметрах см. в [ `New-AzStorageAccount` документации по командлетам](/powershell/module/az.storage/new-azstorageaccount).

Чтобы упростить создание учетной записи хранения и последующего файлового ресурса, в переменных будут храниться несколько параметров. Вы можете заменить содержимое переменной любыми значениями, однако обратите внимание, что имя учетной записи хранения должно быть глобально уникальным.

```azurepowershell-interactive
$resourceGroupName = "myResourceGroup"
$storageAccountName = "mystorageacct$(Get-Random)"
$region = "westus2"
```

Чтобы создать учетную запись хранения, способную хранить стандартные общие файловые ресурсы Azure, мы будем использовать следующую команду. `-SkuName`Параметр относится к требуемому типу избыточности. Если требуется геоизбыточная учетная запись хранения, избыточная или геозона, необходимо также удалить `-EnableLargeFileShare` параметр.

```azurepowershell-interactive
$storAcct = New-AzStorageAccount `
    -ResourceGroupName $resourceGroupName `
    -Name $storageAccountName `
    -SkuName Standard_LRS `
    -Location $region `
    -Kind StorageV2 `
    -EnableLargeFileShare
```

Чтобы создать учетную запись хранения, способную хранить файловые ресурсы Azure уровня "Премиум", мы будем использовать следующую команду. Обратите внимание, что `-SkuName` параметр изменился так, чтобы `Premium` он включал и, и требуемый уровень избыточности локально избыточного ( `LRS` ). `-Kind`Параметр имеет значение, `FileStorage` `StorageV2` так как общие файловые ресурсы уровня "Премиум" должны создаваться в учетной записи хранения филестораже, а не в учетной записи хранения GPv2.

```azurepowershell-interactive
$storAcct = New-AzStorageAccount `
    -ResourceGroupName $resourceGroupName `
    -Name $storageAccountName `
    -SkuName Premium_LRS `
    -Location $region `
    -Kind FileStorage 
```

# <a name="azure-cli"></a>[Azure CLI](#tab/azure-cli)
Чтобы создать учетную запись хранения с помощью Azure CLI, мы будем использовать команду AZ Storage Account Create. Эта команда имеет много параметров. отображаются только необходимые параметры. Дополнительные сведения о дополнительных параметрах см. в [ `az storage account create` документации по командам](/cli/azure/storage/account).

Чтобы упростить создание учетной записи хранения и последующего файлового ресурса, в переменных будут храниться несколько параметров. Вы можете заменить содержимое переменной любыми значениями, однако обратите внимание, что имя учетной записи хранения должно быть глобально уникальным.

```azurecli-interactive
resourceGroupName="myResourceGroup"
storageAccountName="mystorageacct$RANDOM"
region="westus2"
```

Чтобы создать учетную запись хранения, способную хранить стандартные общие файловые ресурсы Azure, мы будем использовать следующую команду. `--sku`Параметр относится к требуемому типу избыточности. Если требуется геоизбыточная учетная запись хранения, избыточная или геозона, необходимо также удалить `--enable-large-file-share` параметр.

```azurecli-interactive
az storage account create \
    --resource-group $resourceGroupName \
    --name $storageAccountName \
    --kind StorageV2 \
    --sku Standard_ZRS \
    --enable-large-file-share \
    --output none
```

Чтобы создать учетную запись хранения, способную хранить файловые ресурсы Azure уровня "Премиум", мы будем использовать следующую команду. Обратите внимание, что `--sku` параметр изменился так, чтобы `Premium` он включал и, и требуемый уровень избыточности локально избыточного ( `LRS` ). `--kind`Параметр имеет значение, `FileStorage` `StorageV2` так как общие файловые ресурсы уровня "Премиум" должны создаваться в учетной записи хранения филестораже, а не в учетной записи хранения GPv2.

```azurecli-interactive
az storage account create \
    --resource-group $resourceGroupName \
    --name $storageAccountName \
    --kind FileStorage \
    --sku Premium_LRS \
    --output none
```

---

## <a name="create-file-share"></a>Создание общей папки
После создания учетной записи хранения остается только создать общую папку. Этот процесс в основном не отличается от того, используется ли общий файловый ресурс уровня "Премиум" или стандартный файловый ресурс. Основным различием является **Квота** и ее представление.

Для стандартных файловых ресурсов это верхний предел общего файлового ресурса Azure, за исключением того, что конечные пользователи не могут переходить. Основная цель квоты для стандартного файлового ресурса — бюджет: "я не хочу, чтобы этот файловый ресурс увеличивался за этот момент". Если квота не указана, Стандартная общая папка может охватывать до 100 Тиб (или 5 Тиб, если для учетной записи хранения не задано свойство больших файловых ресурсов).

Для файловых ресурсов уровня "Премиум" квота перегружается, что означает **подготовленный размер**. Подготовленный размер — это сумма, за которую будет взиматься плата, независимо от фактического использования. При подготовке файлового ресурса уровня "Премиум" необходимо учитывать два фактора: 1) будущее увеличение общей папки с точки зрения использования пространства и 2) операций ввода-вывода, необходимых для рабочей нагрузки. Каждый подготовленный гиб предоставляет вам дополнительные зарезервированные и пакетные операции ввода-вывода. Дополнительные сведения о планировании файлового ресурса уровня "Премиум" см. в разделе [Подготовка файловых ресурсов](storage-files-planning.md#understanding-provisioning-for-premium-file-shares)уровня "Премиум".

# <a name="portal"></a>[Портал](#tab/azure-portal)
Если вы только что создали учетную запись хранения, перейдите к ней на экране развертывания, выбрав пункт **Переход к ресурсу**. Если вы ранее создали учетную запись хранения, вы можете переходить к ней через группу ресурсов, содержащую ее. В учетной записи хранения выберите плитку с метками " **Общие папки** " (вы также можете переходить к **общим файловым ресурсам** через оглавление для учетной записи хранения).

![Снимок экрана с плиткой общих файловых ресурсов](media/storage-how-to-create-file-share/create-file-share-1.png)

В списке общих файловых ресурсов должны отобразиться все общие папки, созданные ранее в этой учетной записи хранения. пустая таблица, если файловые ресурсы еще не созданы. Выберите **+ Общая папка** , чтобы создать новый файловый ресурс.

На экране должна отобразиться Новая колонка с общей папкой. Заполните поля в колонке новый общий файловый ресурс, чтобы создать общую папку:

- **Имя**. имя создаваемой общей папки.
- **Квота**: квота общей папки для стандартных файловых ресурсов. подготовленный размер файлового ресурса для файловых ресурсов уровня "Премиум".

Выберите **создать** , чтобы завершить создание новой общей папки. Обратите внимание, что если ваша учетная запись хранения находится в виртуальной сети, вы не сможете успешно создать файловый ресурс Azure, если клиент также не находится в виртуальной сети. Вы также можете обойти это ограничение на момент времени с помощью `New-AzRmStorageShare` командлета Azure PowerShell.

# <a name="powershell"></a>[PowerShell](#tab/azure-powershell)
Файловый ресурс Azure можно создать с помощью [`New-AzRmStorageShare`](/powershell/module/az.storage/New-AzRmStorageShare) командлета. Следующие команды PowerShell предполагают, что вы установили переменные `$resourceGroupName` и, `$storageAccountName` как указано выше, в разделе Создание учетной записи хранения с Azure PowerShell. 

> [!Important]  
> Для файловых ресурсов уровня "Премиум" `-QuotaGiB` параметр ссылается на подготовленный размер общей папки. Подготовленный размер общей папки — это сумма, за которую будет взиматься плата, независимо от использования. Счета за стандартные общие ресурсы выставляются на основе использования, а не подготовленного размера.

```azurepowershell-interactive
$shareName = "myshare"

New-AzRmStorageShare `
    -ResourceGroupName $resourceGroupName `
    -StorageAccountName $storageAccountName `
    -Name $shareName `
    -QuotaGiB 1024 | Out-Null
```

> [!Note]  
> Имя общей папки должно состоять из символов в нижнем регистре. Полные сведения об именовании файловых ресурсов и файлов см. в разделе [именование и ссылки на общие папки, каталоги, файлы и метаданные](https://msdn.microsoft.com/library/azure/dn167011.aspx).

# <a name="azure-cli"></a>[Azure CLI](#tab/azure-cli)
Прежде чем можно будет создать файловый ресурс Azure с Azure CLI, необходимо получить ключ учетной записи хранения для авторизации операции создания файлового ресурса в. Это можно сделать с помощью [`az storage account keys list`](/cli/azure/storage/account/keys) команды:

```azurecli-interactive
storageAccountKey=$(az storage account keys list \
    --resource-group $resourceGroupName \
    --account-name $storageAccountName \
    --query "[0].value" | tr -d '"')
```

Получив ключ учетной записи хранения, вы можете создать файловый ресурс Azure с помощью [`az storage share create`](/cli/azure/storage/share) команды. 

> [!Important]  
> Для файловых ресурсов уровня "Премиум" `--quota` параметр ссылается на подготовленный размер общей папки. Подготовленный размер общей папки — это сумма, за которую будет взиматься плата, независимо от использования. Счета за стандартные общие ресурсы выставляются на основе использования, а не подготовленного размера.

```azurecli-interactive
shareName="myshare"

az storage share create \
    --account-name $storageAccountName \
    --account-key $storageAccountKey \
    --name $shareName \
    --quota 1024 \
    --output none
```

Эта команда завершится ошибкой, если учетная запись хранения содержится в виртуальной сети, а компьютер, с которого вы вызываете эту команду, не является частью виртуальной сети. Вы можете обойти это ограничение на момент времени с помощью `New-AzRmStorageShare` командлета Azure PowerShell, как описано выше, или путем выполнения Azure CLI с компьютера, который является частью виртуальной сети, включая через VPN-подключение.

---

> [!Note]  
> Имя общей папки должно состоять из символов в нижнем регистре. Полные сведения об именовании файловых ресурсов и файлов см. в разделе [именование и ссылки на общие папки, каталоги, файлы и метаданные](https://msdn.microsoft.com/library/azure/dn167011.aspx).

## <a name="next-steps"></a>Дальнейшие шаги
- [Спланируйте развертывание файлов Azure](storage-files-planning.md) или [запланируйте развертывание синхронизация файлов Azure](storage-sync-files-planning.md). 
- [Обзор сетевых](storage-files-networking-overview.md)возможностей.
- Подключите и подключите общую папку в [Windows](storage-how-to-use-files-windows.md), [macOS](storage-how-to-use-files-mac.md)и [Linux](storage-how-to-use-files-linux.md).