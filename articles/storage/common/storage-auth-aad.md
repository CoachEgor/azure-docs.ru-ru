---
title: Проверки подлинности доступа к BLOB-объекты Azure и очереди, с помощью Azure Active Directory | Документация Майкрософт
description: Проверки подлинности доступа к BLOB-объекты Azure и очереди, с помощью Azure Active Directory.
services: storage
author: tamram
ms.service: storage
ms.topic: article
ms.date: 04/21/2019
ms.author: tamram
ms.subservice: common
ms.openlocfilehash: 2a632ef79c0e9bb925689456d682e7f22504806b
ms.sourcegitcommit: 44a85a2ed288f484cc3cdf71d9b51bc0be64cc33
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2019
ms.locfileid: "64707840"
---
# <a name="authenticate-access-to-azure-blobs-and-queues-using-azure-active-directory"></a>Проверки подлинности доступа к BLOB-объекты Azure и очереди, с помощью Azure Active Directory

Служба хранилища Azure поддерживает аутентификацию и авторизацию с помощью Azure Active Directory (AD) для служб больших двоичных объектов и очередей. С помощью Azure AD вы можете использовать управление доступом на основе ролей (RBAC) для предоставления доступа пользователям, группам или субъектам-службам приложений. 

Аутентификация пользователей или приложений с использованием учетных данных Azure AD обеспечивает превосходную защиту и простоту использования по сравнению с другими средствами авторизации. Хотя вы можете продолжать применять для приложений авторизацию с помощью общего ключа, благодаря использованию Azure AD не нужно хранить ключ доступа к учетной записи с кодом. Вы также можете продолжать использовать подписанные URL-адреса для предоставления доступа с точной настройкой к ресурсам в учетной записи хранения, но Azure AD предлагает аналогичные возможности без необходимости управлять токенами SAS или беспокоиться об отзыве скомпрометированного SAS. Корпорация Майкрософт рекомендует по возможности использовать аутентификацию Azure AD для приложений службы хранилища Azure.

Проверка подлинности и авторизация учетные данные Azure AD доступна для всех общего назначения и BLOB-объектов учетных записей хранения во всех общедоступных регионах и национальных облаках. Только учетные записи хранения с поддержкой модели развертывания Azure Resource Manager авторизации Azure AD.

## <a name="overview-of-azure-ad-for-blobs-and-queues"></a>Обзор Azure AD для больших двоичных объектов и очередей

Когда субъект безопасности (пользователя, группы или приложения) пытается получить доступ к ресурсу большого двоичного объекта или очереди, запрос должен быть авторизован, кроме случаев большой двоичный объект, доступными для анонимного доступа. С помощью Azure AD доступ к ресурсу — это двухэтапный процесс. Во-первых проходит проверку подлинности удостоверения участника безопасности, и возвращается маркер OAuth 2.0. Затем маркер передаются как часть запроса к службе BLOB-объектов или очередей и используются службой для авторизации доступа к определенному ресурсу.

Этап проверки подлинности требует, что приложение запроса маркера доступа OAuth 2.0 во время выполнения. Если приложение выполняется с в сущность Azure, например виртуальной Машины Azure, масштабируемый набор виртуальных машин или приложения функций Azure, можно использовать [управляемого удостоверения](../../active-directory/managed-identities-azure-resources/overview.md) для доступа к BLOB-объектов или очередей. Чтобы узнать, как для авторизации запросов, выполненных управляемое удостоверение для службы BLOB-объектов Azure или очередь, см. в разделе [проверки подлинности доступа к BLOB-объектов и очередей с Azure Active Directory и управляемых удостоверений для ресурсов Azure](storage-auth-aad-msi.md).

На этапе авторизации необходимо назначить одну или несколько ролей RBAC субъекту безопасности. Служба хранилища Azure предоставляет роли RBAC, которые охватывают общие наборы разрешений для данных больших двоичных объектов и очередей. Роли, назначенные субъекту безопасности, определяют разрешения, которые будут иметь участника. Дополнительные сведения о назначении роли RBAC для службы хранилища Azure, см. в разделе [управление права доступа к данным хранилища с помощью RBAC](storage-auth-aad-rbac.md).

Собственные приложения и веб-приложений, отправляющих запросы к службе BLOB-объектов Azure или очередь также позволяет проверять подлинность с помощью Azure AD. Чтобы узнать, как запросить маркер доступа и использовать его для авторизации запросов для данных больших двоичных объектов или очередей, см. в разделе [проверка подлинности с помощью Azure AD из приложения службы хранилища Azure](storage-auth-aad-app.md).

## <a name="assigning-rbac-roles-for-access-rights"></a>Назначение ролей RBAC для прав доступа

Azure Active Directory (Azure AD) разрешает права доступа к защищенным ресурсам с помощью [управления доступом на основе ролей (RBAC)](../../role-based-access-control/overview.md). Служба хранилища Azure определяет набор встроенных ролей RBAC, которые охватывают общие наборы разрешений, используемых для доступа к данным BLOB-объектов и очередей. Также можно определить пользовательские роли для доступа к данным BLOB-объектов и очередей.

При назначении роли RBAC для субъекта безопасности Azure AD, Azure предоставляет доступ к этим ресурсам для этого участника безопасности. Доступ может ограничиваться уровнем подписки, группой ресурсов, учетной записью хранения или отдельным контейнером или очередью. Субъект безопасности Azure AD может быть пользователь, группы, субъекта-службы приложения, или [управляемое удостоверение для ресурсов Azure](../../active-directory/managed-identities-azure-resources/overview.md).

### <a name="built-in-rbac-roles-for-blobs-and-queues"></a>Встроенные роли RBAC для больших двоичных объектов и очередей

[!INCLUDE [storage-auth-rbac-roles-include](../../../includes/storage-auth-rbac-roles-include.md)]

Узнайте, как назначение встроенной роли RBAC для субъекта безопасности, см. в одном из следующих статей:

- [Предоставление доступа к BLOB-объектов и очереди данных Azure с помощью RBAC на портале Azure](storage-auth-aad-rbac-portal.md)
- [Предоставление доступа к Azure данные больших двоичных объектов и очереди с помощью RBAC с помощью Azure CLI](storage-auth-aad-rbac-cli.md)
- [Предоставление доступа к Azure данные больших двоичных объектов и очереди с помощью RBAC с помощью PowerShell](storage-auth-aad-rbac-powershell.md)

Дополнительные сведения о том, как встроенные роли определяются для службы хранилища Azure, см. в статье, посвященной [обзору определений ролей](../../role-based-access-control/role-definitions.md#management-and-data-operations-preview). Сведения о создании настраиваемых ролей RBAC, см. в разделе [Создание пользовательских ролей для управления доступом к](../../role-based-access-control/custom-roles.md).

### <a name="access-permissions-for-data-operations"></a>Разрешения на доступ к операции с данными

Дополнительные сведения о разрешениях, необходимых для вызова определенных операций службы BLOB-объектов или очередей, см. в разделе [разрешения для вызова операции с данными больших двоичных объектов и очереди](https://docs.microsoft.com/rest/api/storageservices/authenticate-with-azure-active-directory#permissions-for-calling-blob-and-queue-data-operations).

## <a name="resource-scope"></a>Область ресурсов

[!INCLUDE [storage-auth-resource-scope-include](../../../includes/storage-auth-resource-scope-include.md)]

## <a name="access-data-with-an-azure-ad-account"></a>Доступ к данным с помощью учетной записи Azure AD

Доступ к данным BLOB-объектов или очередей на портале Azure, PowerShell или интерфейса командной строки Azure можно авторизовать с помощью учетной записи пользователя Azure AD или с помощью ключей доступа учетных записей (проверка подлинности Shared Key).

### <a name="data-access-from-the-azure-portal"></a>Доступ к данным с помощью портала Azure

Портал Azure можно использовать учетную запись Azure AD или ключи доступа учетной записи для доступа к данным BLOB-объектов и очередей в учетной записи хранения Azure. Какие схемы авторизации, на портале Azure используется зависит от роли RBAC, которые назначены вам.

При попытке получить доступ к данным BLOB-объектов или очередей, портал Azure сначала проверяет ли вам назначена роль RBAC с **Microsoft.Storage/storageAccounts/listkeys/action**. Если вам назначена роль с помощью этого действия, а затем на портале Azure используется ключ учетной записи для доступа к данным больших двоичных объектов и очереди с помощью общего ключа разрешения. Если вы не была назначена роль с помощью этого действия, портала Azure пытается получить доступ к данным, используя учетную запись Azure AD.

Для доступа к BLOB-объектов или очередей данных на портале Azure, используя учетную запись Azure AD, вам потребуются разрешения для доступа к данным больших двоичных объектов и очереди и также требуются разрешения для перемещения по ресурсам учетной записи хранения на портале Azure. Встроенные роли, предоставляемой хранилищем Azure предоставлять доступ к ресурсам больших двоичных объектов и очереди, но они не предоставляют разрешения для ресурсов учетной записи хранения. По этой причине доступ к порталу также требует назначения роли Azure Resource Manager например [чтения](../../role-based-access-control/built-in-roles.md#reader) роли, уровня учетной записи хранения или более поздней версии. **Чтения** роль предоставляет самые ограниченные разрешения, но также допускается другой роли Azure Resource Manager, которая предоставляет доступ к ресурсам управления учетной записи хранения. Дополнительные сведения о том, как назначить разрешения пользователям для доступа к данным на портале Azure с учетной записью Azure AD, см. в разделе [предоставить доступ к BLOB-объектов и очереди данных Azure с помощью RBAC на портале Azure](storage-auth-aad-rbac-portal.md).

Портал Azure указывает, какие схемы авторизации используется при переходе в контейнер или очередь. Дополнительные сведения о доступе к данным на портале, см. в разделе [с помощью портала Azure для доступа к данным BLOB-объектов или очередей](storage-access-blobs-queues-portal.md).

### <a name="data-access-from-powershell-or-azure-cli"></a>Доступ к данным из PowerShell или Azure CLI

Azure CLI и PowerShell поддерживают вход с использованием учетных данных Azure AD. После входа, сеанс выполняется в эти учетные данные. Дополнительные сведения см. в разделе [команды запуска интерфейса командной строки Azure или PowerShell учетные данные Azure AD для доступа к данным BLOB-объектов или очередей](storage-auth-aad-script.md).

## <a name="azure-ad-authentication-over-smb-for-azure-files"></a>Проверка подлинности Azure AD по протоколу SMB для службы файлов Azure

Служба файлов Azure поддерживает проверку подлинности с использованием Azure AD по протоколу SMB только для присоединенных к домену виртуальных машин (предварительная версия). Дополнительные сведения об использовании Azure AD по протоколу SMB для службы файлов Azure, см. в разделе [Обзор для аутентификации Azure Active Directory по протоколу SMB для службы файлов Azure (Предварительная версия)](../files/storage-files-active-directory-overview.md).

## <a name="next-steps"></a>Дальнейшие действия

- [Проверки подлинности доступа к BLOB-объектов и очередей с Azure Active Directory и управляемых удостоверений для ресурсов Azure](storage-auth-aad-msi.md)
- [Проверка подлинности с помощью Azure Active Directory из приложения для доступа к BLOB-объектам и очередям](storage-auth-aad-app.md)
- [Поддержка хранилища Azure для Azure Active Directory на основе общедоступная версия контроля доступа](https://azure.microsoft.com/blog/azure-storage-support-for-azure-ad-based-access-control-now-generally-available/)
