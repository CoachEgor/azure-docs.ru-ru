---
title: Использование службы "Импорт и экспорт Azure" для передачи данных в большие двоичные объекты Azure | Документация Майкрософт
description: Сведения о создании заданий импорта и экспорта на портале Azure для передачи данных в большие двоичные объекты Azure и из них.
author: alkohli
services: storage
ms.service: storage
ms.topic: article
ms.date: 03/12/2020
ms.author: alkohli
ms.subservice: common
ms.openlocfilehash: 570c663861361a19190f6fb5d608b6aa029a0885
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "80282500"
---
# <a name="use-the-azure-importexport-service-to-import-data-to-azure-blob-storage"></a>Использование службы "Импорт и экспорт Azure" для импорта данных в хранилище BLOB-объектов Azure

Эта статья содержит пошаговые инструкции по использованию службы "Импорт и экспорт Azure" для безопасного импорта больших объемов данных в хранилище BLOB-объектов Azure. Чтобы служба осуществила импорт данных в большие двоичные объекты Azure, нужно отправить в центр обработки данных Azure зашифрованные диски с данными.  

## <a name="prerequisites"></a>Предварительные требования

Прежде чем создавать задание импорта для передачи данных в хранилище BLOB-объектов Azure, внимательно просмотрите и выполните описанные ниже предварительные требования для этой службы.
Необходимо сделать следующее:

* Активная подписка Azure, которую можно использовать для службы "Импорт и экспорт".
* Хотя бы одна учетная запись хранения Azure с контейнером хранилища. Просмотрите список [поддерживаемых типов хранилища и учетных записей хранения для службы "Импорт и экспорт"](storage-import-export-requirements.md).
  * Сведения о создании учетной записи хранения см. в разделе [Создание учетной записи хранения](storage-account-create.md).
  * Сведения о контейнере хранилища см. в статье [о создании контейнера хранилища](../blobs/storage-quickstart-blobs-portal.md#create-a-container).
* Соответствующее количество дисков [поддерживаемых типов](storage-import-export-requirements.md#supported-disks).
* Система с ОС Windows [поддерживаемой версии](storage-import-export-requirements.md#supported-operating-systems).
* Включить технологию BitLocker в системе Windows. Дополнительные сведения о включении BitLocker см. в [этой статье](https://thesolving.com/storage/how-to-enable-bitlocker-on-windows-server-2012-r2/).
* [Загрузите последнюю версию WAImportExport 1](https://www.microsoft.com/download/details.aspx?id=42659) в системе Windows. Последняя версия инструмента имеет обновления безопасности, чтобы внешний протектор для ключа BitLocker, и обновленная функция режима разблокировки.

  * Распакуйте содержимое в папку по умолчанию: `waimportexportv1`. Например, `C:\WaImportExportV1`.
* Учетная запись FedEx или DHL. Если вы хотите использовать оператора, кроме FedEx/DHL, свяжитесь `adbops@microsoft.com`с командой Azure Data Box Operations в .  
  * Учетная запись должна быть действительной, иметь баланс и возможности возврата.
  * Создайте номер отслеживания для задания экспорта.
  * Каждое задание должно иметь отдельный номер отслеживания. Несколько заданий с одним и тем же номером отслеживания не поддерживаются.
  * Если у вас нет учетной записи оператора, перейдите по ссылке:
    * [Создать учетную запись FedEX](https://www.fedex.com/en-us/create-account.html) или
    * [Создать учетную запись DHL](http://www.dhl-usa.com/en/express/shipping/open_account.html).

## <a name="step-1-prepare-the-drives"></a>Шаг 1. Подготовка дисков

На этом шаге создается файл журнала. В файле журнала хранятся основные сведения, например серийный номер диска, ключ шифрования и сведения об учетной записи хранения.

Выполните следующие действия для подготовки дисков.

1. Подключите свои диски к системе Windows с использованием соединителей SATA.
2. Создайте один том NTFS на каждом диске. Присвойте ему букву диска. Не используйте точки подключения.
3. Включите шифрование BitLocker в томе NTFS. Если используется система Windows Server, используйте инструкции из статьи [о включении BitLocker в Windows Server 2012 R2](https://thesolving.com/storage/how-to-enable-bitlocker-on-windows-server-2012-r2/).
4. Скопируйте данные в зашифрованный том. Используйте перетаскивание, программу Robocopy или аналогичное средство копирования. Файл журнала *(.jrn)* создается в той же папке, где вы запустите инструмент.

   Если диск заблокирован, и вам нужно разблокировать диск, шаги для разблокировки могут быть разными в зависимости от вашего использования случае.

   * Если вы добавили данные в предварительно зашифрованный диск (инструмент WAImportExport не использовался для шифрования), используйте ключ BitLocker (числовой пароль, который вы указываете) во всплывающем окне для разблокировки диска.

   * Если вы добавили данные в диск, который был зашифрован инструментом WAImportExport, используйте следующую команду для разблокировки диска:

        `WAImportExport Unlock /externalKey:<BitLocker key (base 64 string) copied from journal (*.jrn*) file>`

5. Откройте окно PowerShell или окно командной строки с правами администратора. Чтобы перейти в распакованную папку, выполните следующую команду:

    `cd C:\WaImportExportV1`
6. Чтобы получить ключ BitLocker диска, выполните следующую команду:

    `manage-bde -protectors -get <DriveLetter>:`
7. Чтобы подготовить диск, выполните следующую команду. **В зависимости от размера данных это может занять от нескольких часов до нескольких дней.**

    ```powershell
    ./WAImportExport.exe PrepImport /j:<journal file name> /id:session#<session number> /t:<Drive letter> /bk:<BitLocker key> /srcdir:<Drive letter>:\ /dstdir:<Container name>/ /blobtype:<BlockBlob or PageBlob> /skipwrite
    ```

    Файл журнала создается в той же папке, где вы запустили средство. Также создаются два других файла: файл *XML* (папка, в которой выполняется средство) и файл *drive-manifest.xml* (папка, в которой хранятся данные).

    В следующей таблице описаны параметры, используемые в этой команде.

    |Параметр  |Описание  |
    |---------|---------|
    |/j:     |Имя файла журнала с расширением .jrn. Файл журнала создается для каждого диска. Рекомендуем использовать в качестве имени файла журнала серийный номер диска.         |
    |/id:     |Идентификатор сеанса. Используйте уникальный номер сеанса для каждого экземпляра команды.      |
    |/t:     |Буква отправляемого диска. Например, диск `D`.         |
    |/bk:     |Ключ BitLocker для диска. Числовой пароль из выходных данных `manage-bde -protectors -get D:`      |
    |/srcdir:     |Буква отправляемого диска и `:\`. Например, `D:\`.         |
    |/dstdir:     |Имя целевого контейнера в службе хранилища Azure.         |
    |/blobtype:     |Этот параметр определяет тип капли, в которые вы хотите импортировать данные. Для блока капли, `BlockBlob` это и для страницы `PageBlob`капли, это .         |
    |/skipwrite:     |Параметр, который указывает, что новые данные не требуется копировать и что на диске нужно подготовить существующие данные.          |
    |/enablecontentmd5:     |Опция при включении гарантирует, что MD5 `Content-md5` вычисляется и устанавливается в качестве свойства на каждой капли. Используйте эту опцию только `Content-md5` в том случае, если вы хотите использовать поле после загрузки данных в Azure. <br> Эта опция не влияет на проверку целостности данных (что происходит по умолчанию). Настройка увеличивает время загрузки данных в облако.          |
8. Повторите предыдущий шаг для каждого диска, который необходимо отправить. Файл журнала с предоставленным именем создается при каждом запуске командной строки.

    > [!IMPORTANT]
    > * Вместе с файлом журнала в той же папке, где находится средство, также создается файл `<Journal file name>_DriveInfo_<Drive serial ID>.xml`. XML-файл используется вместо файла журнала при создании задания, если файл журнала слишком велик.

## <a name="step-2-create-an-import-job"></a>Шаг 2. Создание задания импорта

Чтобы создать задание импорта на портале Azure, выполните следующие шаги.

1. Войдите в систему по адресу https://portal.azure.com/.
2. Выберите пункты **Все службы > Хранилище > Задания импорта и экспорта**.

    ![Перейдите к разделу "Задания импорта или экспорта"](./media/storage-import-export-data-to-blobs/import-to-blob1.png)

3. Нажмите **Создать Импорт / Экспорт Работа**.

    ![Нажмите кнопку "Создание задания импорта и экспорта".](./media/storage-import-export-data-to-blobs/import-to-blob2.png)

4. В разделе **Основные сведения**:

   * Выберите **Импорт в Azure**.
   * Введите описательное имя для задания импорта. Вы будете использовать его для отслеживания хода выполнения заданий.
       * Имя может содержать только строчные буквы, цифры и дефисы.
       * Имя должно начинаться с буквы и не может содержать пробелы.
   * Выберите подписку.
   * Укажите или выберите группу ресурсов.  

     ![Создание задания импорта — шаг 1](./media/storage-import-export-data-to-blobs/import-to-blob3.png)

5. В разделе **Сведения о задании** сделайте следующее:

   * Передайте файлы журналов диска, полученные на этапе подготовки диска. В случае использования `waimportexport.exe version1` необходимо передать один файл для каждого подготовленного диска. Если размер файла журнала превышает 2 МБ, то можно использовать `<Journal file name>_DriveInfo_<Drive serial ID>.xml`, который также создан с использованием файла журнала.
   * Выберите целевую учетную запись хранения, где будут храниться данные.
   * Расположение места назначения автоматически заполняется с учетом выбранного региона учетной записи хранения.

   ![Создание задания импорта — шаг 2](./media/storage-import-export-data-to-blobs/import-to-blob4.png)

6. В разделе **Сведения о возврате** сделайте следующее:

   * В раскрывающемся списке выберите перевозчика. Если вы хотите использовать оператора, кроме FedEx/DHL, выберите существующий вариант из выпадения. Свяжитесь с группой `adbops@microsoft.com` по работе с коробкой данных Azure, чтобы установить информацию о операторе, который вы планируете использовать.
   * Введите допустимый номер учетной записи, созданный в системе этого перевозчика. Корпорация Майкрософт использует эту учетную запись для отправки дисков обратно после завершения задания импорта. Если у вас нет номера учетной записи, создайте учетную запись перевозчика [FedEx](https://www.fedex.com/us/oadr/) или [DHL](https://www.dhl.com/).
   * Укажите полное и допустимое имя контактного лица, телефон, адрес электронной почты, адрес, город, почтовый индекс, страну (провинцию) и страну (регион).

       > [!TIP]
       > Вместо указания адреса электронной почты для отдельного пользователя укажите электронную почту группы. Это гарантирует, что вы получите уведомления, даже если администратор уйдет.

     ![Создание задание импорта – шаг 3](./media/storage-import-export-data-to-blobs/import-to-blob5.png)

7. В разделе **Сводка** сделайте следующее:

   * Просмотрите сведения о задании, предоставленные в сводке. Запишите имя задания и адрес центра обработки данных Azure для отправки дисков обратно в Azure. Эта информация указывается позже на транспортной этикетке.
   * Нажмите кнопку **ОК**, чтобы создать задание импорта.

     ![Создание задания импорта — шаг 4](./media/storage-import-export-data-to-blobs/import-to-blob6.png)

## <a name="step-3-optional-configure-customer-managed-key"></a>Шаг 3 (необязательно): Настройка управляемого ключом клиента

Пропустите этот шаг и перейдите к следующему шагу, если вы хотите использовать управляемый Microsoft ключ для защиты ключей BitLocker для дисков. Чтобы настроить свой ключ для защиты ключа BitLocker, следуйте инструкциям в [настройке ключей, управляемых клиентами, с помощью Azure Key Vault для импорта/экспорта Azure на портале Azure](storage-import-export-encryption-key-portal.md)

## <a name="step-4-ship-the-drives"></a>Шаг 4: Корабль диски

[!INCLUDE [storage-import-export-ship-drives](../../../includes/storage-import-export-ship-drives.md)]

## <a name="step-5-update-the-job-with-tracking-information"></a>Шаг 5: Обновление задания с информацией о отслеживании

[!INCLUDE [storage-import-export-update-job-tracking](../../../includes/storage-import-export-update-job-tracking.md)]

## <a name="step-6-verify-data-upload-to-azure"></a>Шаг 6: Проверка загрузки данных в Azure

Отслеживание задания до завершения. После завершения задания убедитесь, что данные переданы в Azure. Удалите локальные данные только после подтверждения, что загрузка прошла успешно.

## <a name="next-steps"></a>Дальнейшие действия

* [Просмотр состояния задания и диска](storage-import-export-view-drive-status.md)
* [Сведения о требованиях службы "Импорт и экспорт"](storage-import-export-requirements.md)
