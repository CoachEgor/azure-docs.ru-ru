---
title: Избыточность данных
titleSuffix: Azure Storage
description: Данные в учетной записи хранения Microsoft Azure реплицируются для обеспечения устойчивости и высокого уровня доступности. Конфигурации избыточности включают локально избыточное хранилище (LRS), хранилище, избыточное в зонах (ZRS), геоизбыточное хранилище (GRS), геоизбыточное хранилище с доступом на чтение (RA-GRS), хранилище, избыточное в зонах (ГЗРС) (Предварительная версия) и доступ для чтения хранилище, избыточное в геопоясе (RA-ГЗРС) (Предварительная версия).
services: storage
author: tamram
ms.service: storage
ms.topic: conceptual
ms.date: 02/10/2020
ms.author: tamram
ms.reviewer: artek
ms.subservice: common
ms.openlocfilehash: 038e53251bd81552fd3379f2d7645570fbcda4ef
ms.sourcegitcommit: 64def2a06d4004343ec3396e7c600af6af5b12bb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/19/2020
ms.locfileid: "77471352"
---
# <a name="azure-storage-redundancy"></a>Избыточность хранилища Azure

Служба хранилища Azure всегда хранит несколько копий данных, чтобы защитить их от запланированных и незапланированных событий, включая временные сбои оборудования, сети или перебои электроэнергии, а также крупномасштабные стихийные бедствия. Избыточность гарантирует, что ваша учетная запись хранения будет соответствовать [соглашению об уровне обслуживания (SLA) для службы хранилища Azure](https://azure.microsoft.com/support/legal/sla/storage/) даже в случае сбоев.

При принятии решения о том, какой вариант избыточности лучше всего подходит для вашего сценария, рассмотрите компромиссы между более низкими затратами и высокой доступностью и устойчивостью. Ниже перечислены факторы, которые помогут определить, какой вариант избыточности следует выбрать.  

- Как данные реплицируются в основном регионе
- Реплицируются ли ваши данные в другое расположение, географически отдаленное к основному региону, для защиты от региональных аварий
- Требуется ли приложению доступ на чтение к реплицированным данным в дополнительном регионе, если основной регион по какой-либо причине становится недоступен

## <a name="redundancy-in-the-primary-region"></a>Избыточность в основном регионе

Данные в учетной записи хранения Azure всегда реплицируются три раза в основном регионе. Служба хранилища Azure предлагает два варианта репликации данных в основном регионе:

- **Локально избыточное хранилище (LRS)** копирует данные в три раза в одном физическом расположении в основном регионе. LRS является наименее дорогостоящим вариантом репликации, но не рекомендуется для приложений, требующих высокой доступности.
- **Хранилище, избыточное в пределах зоны (ZRS)** , синхронно копирует данные в трех зонах доступности Azure в основном регионе. Для приложений, которым требуется высокий уровень доступности, корпорация Майкрософт рекомендует использовать ZRS в основном регионе, а также реплицировать их в дополнительный регион.

### <a name="locally-redundant-storage"></a>Локально избыточное хранилище

Локально избыточное хранилище (LRS) реплицирует данные три раза в одном физическом расположении в основном регионе. LRS обеспечивает устойчивость объектов не менее 99,999999999% (11 девяти) в течение заданного года.

LRS — это параметр избыточности с минимальными затратами, обеспечивающий минимальную устойчивость по сравнению с другими вариантами. LRS защищает ваши данные от сбоев в стойках сервера и на диске. Однако если в центре обработки данных происходит сбой, например пожар или переполнение, все реплики учетной записи хранения, использующие LRS, могут быть утрачены или восстановлены. Чтобы устранить этот риск, корпорация Майкрософт рекомендует использовать [хранилище, избыточное в зонах](#zone-redundant-storage) (ZRS), [геоизбыточное хранилище](#geo-redundant-storage) (GRS) или [хранилище с избыточной зоной (Предварительная версия)](#geo-zone-redundant-storage-preview) (гзрс).

Запрос на запись в учетную запись хранения, использующую LRS, выполняется синхронно. Операция записи успешно возвращает данные только после записи данных во все три реплики.

LRS является хорошим выбором для следующих сценариев:

- Если в вашем приложении хранятся данные, которые можно легко воссоздать в случае их потери, можно выбрать LRS.
- Если приложение ограничено репликацией данных только в стране или регионе из-за требований к управлению данными, вы можете выбрать LRS. В некоторых случаях парные регионы, в которых данные географически реплицируются, могут находиться в другой стране или регионе. Дополнительные сведения о парных регионах см. на странице [Регионы Azure](https://azure.microsoft.com/regions/).

### <a name="zone-redundant-storage"></a>Хранилище, избыточное между зонами

Хранилище, избыточное в пределах зоны (ZRS), синхронно реплицирует данные службы хранилища Azure по трем зонам доступности Azure в основном регионе. Каждая зона доступности — это отдельное физическое расположение с независимым питанием, охлаждением и сетью. ZRS предлагает устойчивость для объектов данных службы хранилища Azure по меньшей мере на уровне 99,9999999999% (12 9) в течение указанного года.

С помощью ZRS данные по-прежнему доступны для операций чтения и записи, даже если зона становится недоступной. Если зона становится недоступной, Azure принимает сетевые обновления, такие как повторное указание DNS. Эти обновления могут повлиять на приложение при доступе к данным до завершения обновления. При проектировании приложений для ZRS следуйте рекомендациям по обработке временных сбоев, в том числе к реализации политик повтора с экспоненциальной задержкой.

Запрос на запись в учетную запись хранения, использующую ZRS, выполняется синхронно. Операция записи успешно возвращает данные только после записи данных во все реплики в трех зонах доступности.

Корпорация Майкрософт рекомендует использовать ZRS в основном регионе для сценариев, требующих согласованности, устойчивости и высокой доступности. ZRS обеспечивает отличную производительность, низкую задержку и устойчивость данных, если они становятся временно недоступными. Однако ZRS сама по себе может не защитить ваши данные от региональной аварии, когда несколько зон постоянно затрагиваются. Для защиты от региональных аварий Корпорация Майкрософт рекомендует использовать [хранилище, избыточное](#geo-zone-redundant-storage-preview) в пределах зоны (гзрс), которое использует ZRS в основном регионе, а также георепликацию данных в дополнительный регион.

В следующей таблице показано, какие типы учетных записей хранения поддерживают ZRS в регионах:

|    Тип учетной записи хранения    |    Поддерживаемые регионы    |    Поддерживаемые службы    |
|----------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------|
|    Общего назначения версии<sup>1</sup>    | Юго-восточная Азия<br /> Северная Европа<br />  Западная Европа<br /> Центральная Франция<br /> Восточная Япония<br /> южная часть Соединенного Королевства<br /> Центральная часть США<br /> Восточная часть США<br /> Восточная часть США 2<br /> Западная часть США 2    |    Blob-блоки<br /> Страничные BLOB-объекты<sup>2</sup><br /> Общие файловые ресурсы (Standard)<br /> Таблицы<br /> Очереди<br /> |
|    Блоккблобстораже<sup>1</sup>    | Западная Европа<br /> Восточная часть США    |    Только блочные BLOB-объекты    |
|    филестораже    | Западная Европа<br /> Восточная часть США    |    Только файлы Azure    |

<sup>1</sup> уровень архива в настоящее время не поддерживается для учетных записей ZRS.<br />
<sup>2</sup> диски Azure для виртуальных машин, включая управляемые и неуправляемые диски, поддерживают только LRS. Они не поддерживают ZRS или ГЗРС. Дополнительные сведения об управляемых дисках см. в статье [цены для управляемых дисков Azure](https://azure.microsoft.com/pricing/details/managed-disks/).

Сведения о том, какие регионы поддерживают ZRS, см. в разделе **Поддержка служб по регионам** в [зоны доступности Azure](../../availability-zones/az-overview.md).

## <a name="redundancy-in-a-secondary-region"></a>Избыточность в дополнительном регионе

Для приложений, которым требуется высокий уровень доступности, можно дополнительно скопировать данные из учетной записи хранения в дополнительный регион, который находится в сотнях километров от основного региона. Если ваша учетная запись хранения скопирована в дополнительный регион, данные являются устойчивыми даже в случае полного сбоя в регионе или аварии, в которой основной регион не может быть восстановлен.

При создании учетной записи хранения вы выбираете первичный регион для учетной записи. Парный дополнительный регион определяется на основе основного региона, его невозможно изменить. Дополнительные сведения о регионах, поддерживаемых Azure, см. в разделе [регионы Azure](https://azure.microsoft.com/global-infrastructure/regions/).

Служба хранилища Azure предлагает два варианта копирования данных в дополнительный регион:

- **Геоизбыточное хранилище (GRS)** копирует данные в три раза в одном физическом расположении в основном регионе с помощью LRS. Затем данные копируются асинхронно в одно физическое расположение в дополнительном регионе.
- **Хранилище, избыточное в пределах зоны (гзрс)** (Предварительная версия), синхронно копирует данные в трех зонах доступности Azure в основном регионе с помощью ZRS. Затем данные копируются асинхронно в одно физическое расположение в дополнительном регионе.

Основное различие между GRS и ГЗРС заключается в том, как данные реплицируются в основном регионе. В дополнительном расположении данные всегда реплицируются синхронно три раза с помощью LRS.

При использовании GRS или ГЗРС данные в дополнительном расположении недоступны для чтения или записи, если в дополнительный регион не выполняется отработка отказа. Чтобы получить доступ для чтения к дополнительному расположению, настройте учетную запись хранения для использования геоизбыточного хранилища с доступом на чтение (RA-GRS) или геоизбыточного хранилища в геозону с доступом на чтение (RA-ГЗРС). Дополнительные сведения см. [в статье доступ для чтения к данным в дополнительном регионе](#read-access-to-data-in-the-secondary-region).

Если основной регион становится недоступным, можно выбрать отработку отказа в дополнительный регион (Предварительная версия). После завершения отработки отказа дополнительный регион станет основным, и вы снова сможете считывать и записывать данные. Дополнительные сведения о аварийном восстановлении и о переходе на другой ресурс см. в статье [Аварийное восстановление и отработка отказа учетной записи (Предварительная версия)](storage-disaster-recovery-guidance.md).

> [!IMPORTANT]
> Так как данные реплицируются в дополнительный регион асинхронно, сбой, влияющий на основной регион, может привести к утере данных, если основной регион восстановить нельзя. Интервал между последними операциями записи в основной регион и последней записью в дополнительный регион называется целевой точкой восстановления (RPO). RPO указывает момент времени, до которого данные могут быть восстановлены. Служба хранилища Azure обычно имеет значение RPO менее чем за 15 минут, хотя в настоящее время нет соглашения об уровне обслуживания относительно того, сколько времени занимает репликация данных в дополнительный регион.

### <a name="geo-redundant-storage"></a>Геоизбыточное хранилище

Геоизбыточное хранилище (GRS) копирует данные в три раза в одном физическом расположении в основном регионе с помощью LRS. Затем данные асинхронно копируются в одно физическое расположение в дополнительном регионе, который находится в сотнях миль от основного региона. GRS предлагает устойчивость для объектов данных службы хранилища Azure по меньшей мере 99,99999999999999% (16) в течение заданного года.

Операция записи впервые зафиксирована в основном расположении и реплицируется с помощью LRS. Затем обновление реплицируется асинхронно в дополнительный регион. При записи данных в дополнительное расположение они также реплицируются в этом расположении с использованием LRS.

### <a name="geo-zone-redundant-storage-preview"></a>Хранилище, избыточное в геопоясе (Предварительная версия)

Хранилище, избыточное в геопоясе (ГЗРС) (Предварительная версия), сочетает высокую доступность, обеспечиваемую избыточностью зон доступности, с защитой от региональных простоев, обеспечиваемых георепликацией. Данные в учетной записи хранения ГЗРС копируются в три [зоны доступности Azure](../../availability-zones/az-overview.md) в основном регионе, а также реплицируются в дополнительный географический регион для защиты от региональных аварий. Корпорация Майкрософт рекомендует использовать ГЗРС для приложений, которым необходима максимальная согласованность, устойчивость и доступность, отличная производительность и устойчивость к аварийному восстановлению.

С помощью учетной записи хранения ГЗРС можно продолжить чтение и запись данных, если зона доступности становится недоступной или невосстанавливаемой. Кроме того, ваши данные также устойчивы в случае полного сбоя в регионе или аварии, в которой основной регион не может быть восстановлен. ГЗРС предназначен для предоставления минимума 99,99999999999999% (16) устойчивости объектов в течение заданного года.

ГЗРС и RA-ГЗРС поддерживают только учетные записи хранения общего назначения версии 2. Дополнительные сведения о типах учетных записей хранения см. в статье [Общие сведения об учетной записи хранения](storage-account-overview.md). ГЗРС и RA-ГЗРС поддерживают блочные и страничные BLOB-объекты (за исключением дисков VHD), файлов, таблиц и очередей.

ГЗРС и RA-ГЗРС в настоящее время доступны для предварительного просмотра в следующих регионах:

- Юго-восточная Азия
- Северная Европа
- Западная Европа
- южная часть Соединенного Королевства
- Восточная часть США
- Восточная часть США 2
- Центральная часть США

Корпорация Майкрософт продолжит включать ГЗРС и RA-ГЗРС в дополнительных регионах Azure. Для получения сведений о поддерживаемых регионах регулярно проверяйте страницу [обновлений службы Azure](https://azure.microsoft.com/updates/) .

Сведения о ценах на предварительную версию см. в разделе цены на предварительную версию ГЗРС для [больших двоичных объектов](https://azure.microsoft.com/pricing/details/storage/blobs), [файлов](https://azure.microsoft.com/pricing/details/storage/files/), [очередей](https://azure.microsoft.com/pricing/details/storage/queues/)и [таблиц](https://azure.microsoft.com/pricing/details/storage/tables/).

> [!IMPORTANT]
> Корпорация Майкрософт рекомендует использовать предварительные версии функций для рабочих нагрузок.

## <a name="read-access-to-data-in-the-secondary-region"></a>Доступ для чтения к данным в дополнительном регионе

Геоизбыточное хранилище (с GRS или ГЗРС) реплицирует данные в другое физическое расположение в дополнительном регионе для защиты от региональных простоев. Однако эти данные доступны для чтения только в том случае, если клиент или Майкрософт инициирует отработку отказа из основного или дополнительного региона. При включении доступа для чтения к дополнительному региону данные доступны для чтения, если основной регион становится недоступным. Чтобы получить доступ на чтение к дополнительному региону, включите геоизбыточное хранилище с доступом на чтение (RA-GRS) или геоизбыточное хранилище с доступом на чтение (RA-ГЗРС).

### <a name="design-your-applications-for-read-access-to-the-secondary"></a>Разработайте приложения для доступа на чтение к дополнительной

Если ваша учетная запись хранения настроена для доступа на чтение в дополнительном регионе, вы можете разрабатывать приложения, чтобы легко перемещаться на чтение данных из дополнительного региона, если основной регион по какой-либо причине становится недоступным. Дополнительный регион всегда доступен для чтения, поэтому вы можете протестировать приложение, чтобы убедиться, что оно будет считаться из базы данных-получателя в случае сбоя. Дополнительные сведения о проектировании приложений для обеспечения высокой доступности см. в разделе [Разработка высокодоступных приложений с помощью геоизбыточного хранилища с доступом для чтения](storage-designing-ha-apps-with-ragrs.md).

Когда доступ на чтение к вторичной реплике включен, ваши данные можно считывать из дополнительной конечной точки, а также из основной конечной точки для учетной записи хранения. Вторичная конечная точка добавляет суффикс *— Secondary* к имени учетной записи. Например, если основной конечной точкой для хранилища BLOB-объектов является `myaccount.blob.core.windows.net`, вторичная конечная точка будет `myaccount-secondary.blob.core.windows.net`. Ключи доступа к учетной записи для учетной записи хранения одинаковы для первичной и вторичной конечных точек.

### <a name="check-the-last-sync-time-property"></a>Проверка свойства "Время последней синхронизации"

Так как данные реплицируются в дополнительный регион асинхронно, дополнительный регион часто находится за основным регионом. Если в основном регионе происходит сбой, то, скорее всего, все операции записи в базу данных-источник еще не будут реплицированы на сервер-получатель.

Чтобы определить, какие операции записи были реплицированы в дополнительный регион, приложение может проверить свойство **время последней синхронизации** для вашей учетной записи хранения. Все операции записи, записанные в основной регион до последней синхронизации, были успешно реплицированы в дополнительный регион. Это означает, что они доступны для чтения из базы данных-получателя. Любые операции записи, записанные в основной регион после последней синхронизации, могут быть или не реплицированы в дополнительный регион. Это означает, что они могут быть недоступны для операций чтения.

Вы можете запросить значение свойства **время последней синхронизации** с помощью Azure PowerShell, Azure CLI или одной из клиентских библиотек службы хранилища Azure. **Последнее свойство время синхронизации** — это значение даты и времени по Гринвичу. Дополнительные сведения см. [в статье Проверка свойства времени последней синхронизации для учетной записи хранения](last-sync-time-get.md).

## <a name="summary-of-redundancy-options"></a>Сводка параметров избыточности

В следующей таблице показано, насколько устойчивые и доступные данные находятся в данном сценарии, в зависимости от того, какой тип избыточности действует для учетной записи хранения.

| Сценарий                                                                                                 | LRS                             | ZRS                              | GRS/RA-GRS                                  | ГЗРС/RA-ГЗРС (Предварительная версия)                              |
| :------------------------------------------------------------------------------------------------------- | :------------------------------ | :------------------------------- | :----------------------------------- | :----------------------------------- |
| Узел в центре обработки данных становится недоступным                                                                 | Да                             | Да                              | Да                                  | Да                                  |
| Весь центр обработки данных (зональный или не зональный) становится недоступным                                           | Нет                              | Да                              | Да                                  | Да                                  |
| Происходит сбой на уровне региона                                                                                     | Нет                              | Нет                               | Да                                  | Да                                  |
| Доступ для чтения к данным в дополнительном регионе, если основной регион становится недоступным | Нет                              | Нет                               | Да (с RA-GRS)                                   | Да (с RA-ГЗРС)                                 |
| Процент устойчивости объектов за указанный год<sup>1</sup>                                          | не менее 99,999999999 % (11 девяток) | не менее 99,9999999999 % (12 девяток) | не менее 99,99999999999999 % (16 девяток) | не менее 99,99999999999999 % (16 девяток) |
| Поддерживаемые типы учетных записей хранения<sup>2</sup>                                                                   | GPv2, GPv1, Блоккблобстораже, Блобстораже, Филестораже                | GPv2, Блоккблобстораже, Филестораже                             | GPv2, GPv1, Блобстораже                     | GPv2                     |
| Соглашение об уровне обслуживания для запросов на чтение<sup>1</sup>  | По крайней мере 99,9 % (99 % для холодного уровня доступа) | По крайней мере 99,9 % (99 % для холодного уровня доступа) | Не менее 99,9% (99% для холодного уровня доступа) для GRS<br /><br />Не менее 99,99% (99,9% для холодного уровня доступа) для RA-GRS | Не менее 99,9% (99% для холодного уровня доступа) для ГЗРС<br /><br />Не менее 99,99% (99,9% для холодного уровня доступа) для RA-ГЗРС |
| Уровень обслуживания "доступность" для запросов на запись<sup>1</sup>  | По крайней мере 99,9 % (99 % для холодного уровня доступа) | По крайней мере 99,9 % (99 % для холодного уровня доступа) | По крайней мере 99,9 % (99 % для холодного уровня доступа) | По крайней мере 99,9 % (99 % для холодного уровня доступа) |

<sup>1</sup> сведения о гарантии надежности и доступности службы хранилища Azure см. в статье [соглашение об уровне обслуживания для службы хранилища Azure](https://azure.microsoft.com/support/legal/sla/storage/).

<sup>2</sup> дополнительные сведения о типах учетных записей хранения см. в разделе [Общие сведения об учетной записи хранения](storage-account-overview.md).

Все данные для всех типов учетных записей хранения копируются в соответствии с параметром избыточность учетной записи хранения. Копируются объекты, включая блочные, добавочные, страничные BLOB-объекты, очереди, таблицы и файлы.

Сведения о ценах на каждый вариант избыточности см. в разделе [цены на хранилище Azure](https://azure.microsoft.com/pricing/details/storage/).

> [!NOTE]
> Сейчас Azure Premium Хранилище дисков поддерживает только локально избыточное хранилище (LRS). Учетные записи хранения блочных BLOB-объектов поддерживают локально избыточное хранилище (LRS) и хранилище, избыточное в виде зоны (ZRS) в определенных регионах.

## <a name="data-integrity"></a>Целостность данных

Служба хранилища Azure регулярно проверяет целостность данных, хранимых с помощью циклических проверок избыточности (Кркс). Если обнаружено повреждение данных, оно будет восстановлено с использованием избыточных данных. Служба хранилища Azure также вычисляет контрольные суммы во всем сетевом трафике, чтобы обнаружить повреждение пакетов данных при хранении или извлечении данных.

## <a name="see-also"></a>См. также:

- [Проверка свойства "время последней синхронизации" для учетной записи хранения](last-sync-time-get.md)
- [Изменение параметра избыточности для учетной записи хранения](redundancy-migration.md)
- [Проектирование высокодоступных приложений с использованием RA-GRS](../storage-designing-ha-apps-with-ragrs.md)
- [Аварийное восстановление и переключение учетных записей (Предварительная версия)](storage-disaster-recovery-guidance.md)
