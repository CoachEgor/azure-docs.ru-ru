---
title: Избыточность данных
titleSuffix: Azure Storage
description: Данные в учетной записи хранения Microsoft Azure реплицируются для обеспечения устойчивости и высокого уровня доступности. Избыточные конфигурации включают локально избыточное хранилище (LRS), зонально-избыточное хранилище (ЗРС), геоизбыточное хранилище (GRS), гео-доступ к гео-избыточному хранению (RA-GRS), геозоне избыточного хранилища (ГЗРС) (предварительный просмотр) и геозоне чтения(предварительный просмотр).
services: storage
author: tamram
ms.service: storage
ms.topic: conceptual
ms.date: 02/25/2020
ms.author: tamram
ms.reviewer: artek
ms.subservice: common
ms.openlocfilehash: 78f7c935e64276e7f4862dad966b99bff6bd246d
ms.sourcegitcommit: b55d7c87dc645d8e5eb1e8f05f5afa38d7574846
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/16/2020
ms.locfileid: "81481944"
---
# <a name="azure-storage-redundancy"></a>Избыточность хранилища Azure

Azure Storage всегда хранит несколько копий данных, чтобы они были защищены от запланированных и незапланированных событий, включая временные сбои оборудования, перебои в работе сети или подачи электроэнергии, а также массовые стихийные бедствия. Избыточность гарантирует, что ваша учетная запись хранилища соответствует соглашению об уровне [обслуживания (SLA) для хранения Azure](https://azure.microsoft.com/support/legal/sla/storage/) даже перед лицом сбоев.

При принятии решения о том, какой вариант избыточности лучше всего подходит для вашего сценария, учитывайте компромиссы между более низкими затратами и более высокой доступностью и долговечностью. Факторы, которые помогают определить, какой вариант избыточности вы должны выбрать, включают:  

- Как реплицируются данные в первичном регионе
- Реплицируется ли ваши данные во вторую область, которая географически удалена от основного региона, для защиты от региональных катастроф
- Требуется ли приложению доступ к реплицированным данным во вторичном регионе, если первичный регион по какой-либо причине становится недоступен

## <a name="redundancy-in-the-primary-region"></a>Избыточность в первичном регионе

Данные в учетной записи хранения Azure всегда реплицируются три раза в основной области. Azure Storage предлагает два варианта реплицирования данных в основной области:

- **Локально избыточное хранилище (LRS)** трижды синхронно копирует ваши данные в пределах одного физического местоположения в основной области. LRS является наименее дорогостоящим вариантом репликации, но не рекомендуется для приложений, требующих высокой доступности.
- **Избыточная память (ЗРС)** синхронно копирует ваши данные в трех зонах доступности Azure в основном регионе. Для приложений, требующих высокой доступности, корпорация Майкрософт рекомендует использовать ЗРС в первичном регионе, а также реплицировать их во вторичную область.

### <a name="locally-redundant-storage"></a>Локально избыточное хранилище

Локально избыточное хранилище (LRS) реплицирует ваши данные три раза в пределах одного физического местоположения в основной области. LRS обеспечивает по крайней мере 99.99999999% (11 девятки) долговечность объектов в течение данного года.

LRS является самым дешевым вариантом избыточности и предлагает наименьшую долговечность по сравнению с другими вариантами. LRS защищает ваши данные от сбоев сервера и привода. Однако, если в центре обработки данных происходит такое стечение сбоя или затопления, все копии учетной записи хранения с помощью LRS могут быть потеряны или невозможны. Чтобы уменьшить этот риск, корпорация Майкрософт рекомендует использовать [излишние зоны хранилища](#zone-redundant-storage) (ЗРС), [гео-избыточное хранилище](#geo-redundant-storage) (GRS) или [геозонно-избыточное хранилище (предварительный просмотр)](#geo-zone-redundant-storage-preview) (ГЗРС).

Запрос на запись в учетную запись хранения, используюую LRS, происходит синхронно. Операция записи успешно возвращается только после того, как данные будут записаны на все три реплики.

LRS является хорошим выбором для следующих сценариев:

- Если в вашем приложении хранятся данные, которые можно легко воссоздать в случае их потери, можно выбрать LRS.
- Если приложение ограничено копированием данных только в пределах страны или региона из-за требований к управлению данными, вы можете выбрать LRS. В некоторых случаях парные области, через которые данные реплицируются, могут находиться в другой стране или регионе. Дополнительные сведения о парных регионах см. на странице [Регионы Azure](https://azure.microsoft.com/regions/).

### <a name="zone-redundant-storage"></a>Хранилище, избыточное между зонами

Избыточная память (ЗРС) воспроизводит данные хранилища Azure синхронно в трех зонах доступности Azure в основном регионе. Каждая зона доступности представляет собой отдельное физическое местоположение с независимой мощностью, охлаждением и сетью. За данный год компания «ЗРС» предлагает долговечность для объектов хранения данных Azure, по крайней мере, 99.999999999% (12 9) в течение определенного года.

С помощью zrS ваши данные по-прежнему доступны как для операций чтения, так и для записи, даже если зона становится недоступной. Если зона становится недоступной, Azure проводит обновления сетей, такие как перенаправление DNS. Эти обновления могут повлиять на ваше приложение, если вы получаете доступ к данным до завершения обновлений. При проектировании приложений для ЗРС следуйте методам временного обращения с ошибками, включая реализацию политик повторной попытки с экспоненциальным обратным отработкой.

Запрос на запись в учетную запись хранилища, используюую ЗРС, происходит синхронно. Операция записи успешно возвращается только после того, как данные будут записаны на все реплики в трех зонах доступности.

Корпорация Майкрософт рекомендует использовать зр.Ru в первичном регионе для сценариев, требующих согласованности, долговечности и высокой доступности. В случае временной недоступности данных, если они временно станут недоступными, для данных обеспечивается отличная производительность, низкая задержка и устойчивость. Тем не менее, зрП сам по себе не может защитить ваши данные от региональной катастрофы, когда несколько зон постоянно затронуты. Для защиты от региональных стихийных бедствий корпорация Майкрософт рекомендует использовать [геозонно-излишние хранилища](#geo-zone-redundant-storage-preview) (ГЗРС), которые используют ЗРС в первичном регионе, а также гео-реплицирует ваши данные в второстепенный регион.

В следующей таблице показано, какие типы учетных записей хранения поддерживают ЗРС в каких регионах:

|    Тип учетной записи хранения    |    Поддерживаемые регионы    |    Поддерживаемые службы    |
|----------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------|
|    Общее назначение v2<sup>1</sup>    | Юго-восточная Азия<br /> Восточная Австралия<br /> Северная Европа<br />  Западная Европа<br /> Центральная Франция<br /> Восточная Япония<br /> Северная часть ЮАР;<br /> южная часть Соединенного Королевства<br /> Центральная часть США<br /> Восточная часть США<br /> Восточная часть США 2<br /> Западная часть США 2    |    Blob-блоки<br /> Страница капли<sup>2</sup><br /> Файлакций (стандартный)<br /> Таблицы<br /> Очереди<br /> |
|    BlockBlobStorage<sup>1</sup>    | Западная Европа<br /> Восточная часть США    |    Только блочные BLOB-объекты    |
|    FileStorage    | Западная Европа<br /> Восточная часть США    |    Только файлы Azure    |

<sup>1</sup> Уровень архива в настоящее время не поддерживается для учетных записей ZRS.<br />
<sup>2</sup> Учетные записи хранения, содержащие управляемые дисками Azure для виртуальных машин, всегда используют LRS. Неуправляемые диски Azure также должны использовать LRS. Можно создать учетную запись для хранения неуправляемых дисков Azure, которая использует GRS, но она не рекомендуется из-за потенциальных проблем с согласованностью над асинхронной георепликацией. Ни управляемые, ни неуправляемые диски не поддерживают ЗРС или ГЗРС. Для получения дополнительной информации о управляемых дисках [см.](https://azure.microsoft.com/pricing/details/managed-disks/)

Для получения информации о том, какие регионы поддерживают ЗРС, см. **Службы поддержки по регионам** в [Что такое зоны доступности Azure?](../../availability-zones/az-overview.md).

## <a name="redundancy-in-a-secondary-region"></a>Избыточность во вторичном регионе

Для приложений, требующих высокой доступности, можно дополнительно скопировать данные в учетной записи хранилища во вторичный регион, напротив основного региона. Если ваша учетная запись хранилища скопирована во вторую область, то ваши данные долговечны даже в случае полного регионального сбоя или аварии, при которой основная область не может быть восстановлена.

При создании учетной записи хранения вы выбираете первичный регион для учетной записи. Парный дополнительный регион определяется на основе основного региона, его невозможно изменить. Для получения дополнительной информации о [Azure regions](https://azure.microsoft.com/global-infrastructure/regions/)регионах, поддерживаемых Azure, см.

Azure Storage предлагает два варианта копирования данных в второстепенном регионе:

- **Гео-излишнее хранения (GRS)** копирует ваши данные синхронно три раза в пределах одного физического местоположения в основном регионе с помощью LRS. Затем он асинхронно копирует ваши данные в одном физическом местоположении во вторичном регионе.
- **Гео-зонно-излишним хранилищем (ГЗРС)** (предварительный просмотр) синхронно копирует ваши данные в трех зонах доступности Azure в основном регионе с помощью ЗРС. Затем он асинхронно копирует ваши данные в одном физическом местоположении во вторичном регионе.

Основное различие между GRS и ГЗРС заключается в том, как данные реплицируются в первичном регионе. В вторичном месте данные всегда реппроизводятся синхронно три раза с помощью LRS.

С помощью GRS или G'S данные во вторичном месте недоступны для доступа к чтению или записи, если только не происходит сбоя во вторичном регионе. Для чтения доступа к вторичному местоположению наймите учетную запись хранилища для использования геоизообразуемого хранилища (RA-GRS) или считываемого геозоны-избыточного хранилища (RA-G'S). Для получения дополнительной информации смотрите [Доступ к данным во вторичном регионе](#read-access-to-data-in-the-secondary-region).

Если основная область становится недоступной, можно выбрать недоносящийся во вторичную область (предварительный просмотр). После завершения сбоя, вторичный регион становится основным регионом, и вы можете снова читать и писать данные. Для получения дополнительной информации о аварийном восстановлении и узнать, как потерпеть неудачу в вторичном регионе, [см.](storage-disaster-recovery-guidance.md)

> [!IMPORTANT]
> Поскольку данные реплицируются в вторичный регион асинхронно, сбой, влияющий на первичный регион, может привести к потере данных, если первичный регион не может быть восстановлен. Интервал между последними записами в основной область и последней записью во вторичную область известен как цель точки восстановления (RPO). RPO указывает момент времени, до которого данные могут быть восстановлены. Azure Storage обычно имеет RPO менее 15 минут, хотя в настоящее время нет SLA о том, сколько времени требуется для воспроизведения данных во вторичном регионе.

### <a name="geo-redundant-storage"></a>Геоизбыточное хранилище

Гео-излишнее хранения (GRS) копирует ваши данные синхронно три раза в пределах одного физического местоположения в основном регионе с помощью LRS. Затем он асинхронно копирует ваши данные в одном физическом месте во вторичном регионе, который находится в сотнях миль от основной области. GRS предлагает долговечность для объектов данных Azure Storage не менее 99,999999999999% (16 9) в течение данного года.

Операция записи сначала заверчается в основной местоположении и реплицируется с помощью LRS. Затем обновление асинхронно реплицируется во вторичную область. При записи данных в дополнительное расположение они также реплицируются в этом расположении с использованием LRS.

### <a name="geo-zone-redundant-storage-preview"></a>Гео-зона-избыточное хранилище (предварительный просмотр)

Гео-зонно-излишним хранилищем (ГЗРС) (предварительный просмотр) сочетает в себе высокую доступность, обеспечиваемую избыточностью в зонах доступности, с защитой от региональных отключений, предоставляемых георепликацией. Данные в учетной записи хранения Данных ГЗРС копируются в трех [зонах доступности Azure](../../availability-zones/az-overview.md) в основном регионе, а также реплицируются во вторичный географический регион для защиты от региональных катастроф. Корпорация Майкрософт рекомендует использовать G'S для приложений, требующих максимальной согласованности, долговечности и доступности, отличной производительности и устойчивости к аварийному восстановлению.

С помощью учетной записи хранилища G'S вы можете продолжать читать и писать данные, если зона доступности становится недоступной или невосполнимой. Кроме того, ваши данные также долговечны в случае полного регионального сбоя или аварии, при которой основной регион не может быть восстановлен. ГЗРС предназначен для обеспечения по крайней мере 99,9999999999% (16 9's) долговечность объектов в течение данного года.

Только учетные записи хранения v2 общего назначения поддерживают G'S и RA-G'S. Дополнительные сведения о типах учетных записей хранения см. в статье [Общие сведения об учетной записи хранения](storage-account-overview.md). Поддержка блоков G'S и RA-G'S блокирует капли, капли страниц (кроме дисков VHD), файлы, таблицы и очереди.

В настоящее время для предварительного просмотра в следующих регионах доступны ГЗРС и РАЗ-ГЗРС:

- Юго-восточная Азия
- Северная Европа
- Западная Европа
- Восточная Япония
- южная часть Соединенного Королевства
- Восточная часть США
- Восточная часть США 2
- Центральная часть США
- Западная часть США 2

Корпорация Майкрософт продолжает включать G'S и RA-G-G'S в дополнительных регионах Azure. Регулярно проверяйте страницу [обновления службы Azure](https://azure.microsoft.com/updates/) на наличие информации о поддерживаемых регионах.

Для получения информации о ценах предварительного просмотра, обратитесь к гЗРС предварительные цены для [Blobs](https://azure.microsoft.com/pricing/details/storage/blobs), [Файлы](https://azure.microsoft.com/pricing/details/storage/files/), [Очереди](https://azure.microsoft.com/pricing/details/storage/queues/), и [таблицы](https://azure.microsoft.com/pricing/details/storage/tables/).

> [!IMPORTANT]
> Корпорация Майкрософт рекомендует не использовать функции предварительного просмотра для производственных нагрузок.

## <a name="read-access-to-data-in-the-secondary-region"></a>Читать доступ к данным во вторичном регионе

Геоизулярное хранилище (с GRS или G'S) воспроизводит ваши данные в другое физическое место во вторичном регионе для защиты от региональных отключений. Однако эти данные доступны для чтения только в том случае, если клиент или корпорация Майкрософт инициирует сбой из первичного в вторичный регион. При включании доступа к чтению во вторичном регионе можно считывать данные, если основная область становится недоступной. Для чтения доступа к вторичному региону включите геоизмеривое хранилище (RA-GRS) или геозоне чтения(RA-G'RS).

### <a name="design-your-applications-for-read-access-to-the-secondary"></a>Дизайн приложений для чтения доступа к вторичному

Если учетная запись хранилища настроена для доступа к чтению во вторичном регионе, то можно создать приложения, чтобы легко перейти к данным чтения из вторичного региона, если основная область по какой-либо причине становится недоступной. Вторичный регион всегда доступен для доступа к чтению, так что вы можете проверить приложение, чтобы убедиться, что он будет читать со вторичного в случае простоя. Для получения дополнительной информации о том, как проектировать приложения для высокой доступности, см. [Проектирование высокодоступных приложений с использованием гео-избыточного хранилища с помощью гео-избыточного хранилища.](storage-designing-ha-apps-with-ragrs.md)

При включении доступа к вторичному доступу к вторичной системе, ваши данные можно считывать со вторичной точки, а также с основной точки для учетной записи хранения. Вторичная конечная точка придатков суффикса *- вторичный* к имени учетной записи. Например, если ваша основная конечная `myaccount.blob.core.windows.net`точка для хранения Blob, то вторичная конечная `myaccount-secondary.blob.core.windows.net`точка . Ключи доступа к учетной записи для учетной записи хранилища одинаковы как для основной, так и для вторичных конечных точек.

### <a name="check-the-last-sync-time-property"></a>Проверка свойства "Время последней синхронизации"

Поскольку данные реплицируются в вторичный регион асинхронно, вторичный регион часто отстает от первичного региона. Если сбой происходит в первичном регионе, вполне вероятно, что все записи на первичном еще не были воспроизведены на вторичное.

Чтобы определить, какие операции записи были реплицированы во вторичную область, приложение может проверить свойство **Last Sync Time** для вашей учетной записи хранения. Все операции записи, написанные в основной области до последнего времени синхронизации, были успешно воспроизведены во вторичную область, что означает, что они доступны для чтения из вторичного. Любые операции записи, написанные в основной регион после последнего времени синхронизации, могут или не могут быть воспроизведены во вторичную область, что означает, что они могут быть недоступны для чтения операций.

Вы можете заразиться значением свойства **Последнее время синхронизации** с помощью Azure PowerShell, Azure CLI или одной из клиентских библиотек Хранения Azure. Свойство **«Последнее время синхронизации»** — это значение даты/времени GMT. Для получения дополнительной информации посетите [свойство «Последнее время синхронизации» для учетной записи хранилища.](last-sync-time-get.md)

## <a name="summary-of-redundancy-options"></a>Резюме вариантов избыточности

В следующей таблице показано, насколько долговечны и доступны ваши данные в данном сценарии, в зависимости от типа избыточности для учетной записи хранилища:

| Сценарий                                                                                                 | LRS                             | ZRS                              | GRS/RA-GRS                                  | ГЗРС/РА-ГЗРС (предварительный просмотр)                              |
| :------------------------------------------------------------------------------------------------------- | :------------------------------ | :------------------------------- | :----------------------------------- | :----------------------------------- |
| Узла в центре обработки данных становится недоступным                                                                 | Да                             | Да                              | Да                                  | Да                                  |
| Весь центр обработки данных (зональный или не зональный) становится недоступным                                           | нет                              | Да                              | Да                                  | Да                                  |
| Происходит сбой в масштабах всего региона                                                                                     | нет                              | нет                               | Да                                  | Да                                  |
| Прочитайте доступ к данным во вторичном регионе, если первичный регион становится недоступным | нет                              | нет                               | Да (с RA-GRS)                                   | Да (с РА-ГЗРС)                                 |
| Процентная долговечность объектов в течение данного года<sup>1</sup>                                          | не менее 99,999999999 % (11 девяток) | не менее 99,9999999999 % (12 девяток) | не менее 99,99999999999999 % (16 девяток) | не менее 99,99999999999999 % (16 девяток) |
| Поддерживаемые типы учетных записей хранения<sup>2</sup>                                                                   | GPv2, GPv1, BlockBlobStorage, BlobStorage, FileStorage                | GPv2, BlockBlobStorage, FileStorage                             | GPv2, GPv1, BlobStorage                     | GPv2                     |
| Доступность SLA для чтения запросов<sup>1</sup>  | По крайней мере 99,9 % (99 % для холодного уровня доступа) | По крайней мере 99,9 % (99 % для холодного уровня доступа) | По крайней мере 99.9% (99% для холодного уровня доступа) для GRS<br /><br />По крайней мере 99.99% (99.9% для холодного уровня доступа) для RA-GRS | По крайней мере 99,9% (99% для холодного уровня доступа) для G'S<br /><br />По крайней мере 99,99% (99,9% для холодного уровня доступа) для RA-G'R |
| Доступность SLA для запросов на запись<sup>1</sup>  | По крайней мере 99,9 % (99 % для холодного уровня доступа) | По крайней мере 99,9 % (99 % для холодного уровня доступа) | По крайней мере 99,9 % (99 % для холодного уровня доступа) | По крайней мере 99,9 % (99 % для холодного уровня доступа) |

<sup>1</sup> Для получения информации о гарантиях хранения Azure для долговечности и доступности см. [Azure Storage SLA](https://azure.microsoft.com/support/legal/sla/storage/)

<sup>2</sup> Для получения информации [Storage account overview](storage-account-overview.md)о типах учетных записей хранилища см.

Все данные для всех типов учетных записей хранения и [всех уровней (включая архив)](../blobs/storage-blob-storage-tiers.md) копируются в соответствии с вариантом избыточности для учетной записи хранилища. Скопируются объекты, включая блок-капли, капли приложений, капли страниц, очереди, таблицы и файлы.

Для получения информации о ценах [Azure Storage pricing](https://azure.microsoft.com/pricing/details/storage/)для каждого варианта избыточности см.

> [!NOTE]
> В настоящее время Azure Premium Disk Storage поддерживает только локально избыточное хранилище (LRS). Учетные записи хранения блоков blob поддерживают локально избыточное хранилище (LRS) и резервные хранилища зон (ЗРС) в некоторых регионах.

## <a name="data-integrity"></a>Целостность данных

Azure Storage регулярно проверяет целостность данных, хранящихся с помощью циклических проверок избыточности (CRC). При обнаружении повреждения данных она восстанавливается с использованием избыточных данных. Azure Storage также вычисляет проверки на всем сетевом трафике для обнаружения повреждения пакетов данных при хранении или извлечении данных.

## <a name="see-also"></a>См. также

- [Проверьте свойство «Последнее время синхронизации» для учетной записи хранилища](last-sync-time-get.md)
- [Изменение опции избыточности для учетной записи хранилища](redundancy-migration.md)
- [Разработка высокодоступных приложений с использованием хранилища RA-GRS](../storage-designing-ha-apps-with-ragrs.md)
- [Восстановление аварийного восстановления и сбой учетной записи (предварительный просмотр)](storage-disaster-recovery-guidance.md)
