---
title: Использование эмулятора Азурите для разработки локальных хранилищ Azure
description: Эмулятор Азурите с открытым исходным кодом (Предварительная версия) предоставляет бесплатную локальную среду для тестирования приложений службы хранилища Azure.
author: mhopkins-msft
ms.author: mhopkins
ms.date: 08/31/2019
ms.service: storage
ms.subservice: common
ms.topic: conceptual
ms.openlocfilehash: 5e1fce0852a4e820d7ee0af626ce3fddf6773750
ms.sourcegitcommit: 849bb1729b89d075eed579aa36395bf4d29f3bd9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2020
ms.locfileid: "76029922"
---
# <a name="use-the-azurite-emulator-for-local-azure-storage-development-and-testing-preview"></a>Использование эмулятора Азурите для локальной разработки и тестирования хранилища Azure (Предварительная версия)

Эмулятор Азурите версии 3,2 с открытым исходным кодом (Предварительная версия) предоставляет бесплатную локальную среду для тестирования приложений хранилища больших двоичных объектов и очередей Azure. Если вы удовлетворены работой приложения локально, переключитесь на использование учетной записи хранения Azure в облаке. Эмулятор обеспечивает кросс-платформенную поддержку в Windows, Linux и MacOS. Азурите v3 поддерживает интерфейсы API, реализованные службой BLOB-объектов Azure.

Азурите — это будущая платформа эмулятора хранения. Азурите заменяет [эмулятор хранения Azure](storage-use-emulator.md). Азурите будет по-прежнему обновляться для поддержки последних версий API службы хранилища Azure.

Существует несколько различных способов установки и запуска Азурите в локальной системе:

  1. [Установка и запуск расширения Азурите Visual Studio Code](#install-and-run-the-azurite-visual-studio-code-extension)
  1. [Установка и запуск Азурите с помощью NPM](#install-and-run-azurite-by-using-npm)
  1. [Установка и запуск образа DOCKER Азурите](#install-and-run-the-azurite-docker-image)
  1. [Клонирование, сборка и запуск Азурите из репозитория GitHub](#clone-build-and-run-azurite-from-the-github-repository)

## <a name="install-and-run-the-azurite-visual-studio-code-extension"></a>Установка и запуск расширения Азурите Visual Studio Code

В Visual Studio Code выберите панель **расширения** и найдите *Азурите* в списке **расширения: MARKETPLACE**.

![Visual Studio Code расширений Marketplace](media/storage-use-azurite/azurite-vs-code-extension.png)

В качестве альтернативы перейдите в раздел [VS Code расширение рынка](https://marketplace.visualstudio.com/items?itemName=Azurite.azurite) в браузере. Нажмите кнопку " **установить** ", чтобы открыть Visual Studio Code и перейти непосредственно на страницу расширения азурите.

Вы можете быстро запустить или закрыть Азурите, щелкнув **[Служба BLOB-объектов азурите]** или **[служба очередей азурите]** в строке состояния VS Code или выполнив следующие команды в палитре команд VS Code. Чтобы открыть палитру команд, нажмите клавишу **F1** в VS Code.

Расширение поддерживает следующие Visual Studio Code команды:

   * **Азурите: Start** — запуск всех служб азурите
   * **Азурите: закрыть** — закрыть все службы азурите
   * **Азурите: Clean** — сброс всех данных сохраняемости азурите Services
   * **Азурите: Starting Service BLOB** -Start Service BLOB
   * **Азурите: Close BLOB Service** — Close Service BLOB
   * **Азурите: Очистка службы BLOB** -объектов
   * **Азурите: запуск службы** очередей — запуск службы очередей
   * **Азурите: закрытие службы очередей** — закрытие службы очередей
   * **Азурите: чистая** служба очереди — чистая служба очередей

Чтобы настроить Азурите в Visual Studio Code, выберите Панель расширения. Выберите значок **Управление** (шестеренка) для **азурите**. Выберите **настроить параметры модуля**.

![Настройка параметров модуля азурите](media/storage-use-azurite/azurite-configure-extension-settings.png)

Поддерживаются следующие параметры:

   * **Азурите: узел больших двоичных** объектов — конечная точка для прослушивания службы BLOB-объектов. Значение по умолчанию — 127.0.0.1.
   * **Азурите: порт большого двоичного объекта** — порт прослушивания службы BLOB-объектов. Порт по умолчанию — 10000.
   * **Азурите: Debug** — вывод журнала отладки в канал азурите. Значение по умолчанию — **false**.
   * **Азурите: Location** — путь к расположению рабочей области. Значение по умолчанию — Рабочая папка Visual Studio Code.
   * **Азурите: узел очереди** — конечная точка прослушивания служба очередей. Значение по умолчанию — 127.0.0.1.
   * **Азурите: порт очереди** — порт, прослушиваемый служба очередей. Порт по умолчанию — 10001.
   * **Азурите: автоматический** режим без уведомления отключает журнал доступа. Значение по умолчанию — **false**.

## <a name="install-and-run-azurite-by-using-npm"></a>Установка и запуск Азурите с помощью NPM

Для этого метода установки требуется наличие [node. js версии 8,0 или более поздней](https://nodejs.org) . **NPM** — это средство управления пакетами, включенное в каждую установку Node. js. После установки Node. js выполните следующую команду **NPM** , чтобы установить азурите.

```console
npm install -g azurite
```

После установки Азурите см. раздел [Запуск азурите из командной строки](#run-azurite-from-a-command-line).

## <a name="install-and-run-the-azurite-docker-image"></a>Установка и запуск образа DOCKER Азурите

Используйте [DockerHub](https://hub.docker.com/) для извлечения [последнего образа азурите](https://hub.docker.com/_/microsoft-azure-storage-azurite) с помощью следующей команды:

```console
docker pull mcr.microsoft.com/azure-storage/azurite
```

**Запустите образ DOCKER азурите**:

Следующая команда запускает образ DOCKER Азурите. `-p 10000:10000` Параметр перенаправляет запросы с порта 10000 хоста компьютера на экземпляр DOCKER.

```console
docker run -p 10000:10000 -p 10001:10001 mcr.microsoft.com/azure-storage/azurite
```

**Укажите расположение рабочей области**:

В следующем примере `-v c:/azurite:/data` параметр указывает *c:/азурите* как расположение сохраненных данных азурите. Перед выполнением команды DOCKER необходимо создать каталог *c:/азурите*.

```console
docker run -p 10000:10000 -p 10001:10001 -v c:/azurite:/data mcr.microsoft.com/azure-storage/azurite
```

**Запуск только службы BLOB-объектов**

```console
docker run -p 10000:10000 mcr.microsoft.com/azure-storage/azurite
    azurite-blob --blobHost 0.0.0.0 --blobPort 10000
```

**Задать все параметры азурите**:

В этом примере показано, как задать все параметры командной строки. Все приведенные ниже параметры должны быть помещены в одну командную строку.

```console
docker run -p 8888:8888
           -p 9999:9999
           -v c:/azurite:/workspace mcr.microsoft.com/azure-storage/azurite azurite
           -l /workspace
           -d /workspace/debug.log
           --blobPort 8888
           --blobHost 0.0.0.0
           --queuePort 9999
           --queueHost 0.0.0.0
```

Дополнительные сведения о настройке Азурите при запуске см. в разделе [Параметры командной строки](#command-line-options) .

## <a name="clone-build-and-run-azurite-from-the-github-repository"></a>Клонирование, сборка и запуск Азурите из репозитория GitHub

Этот метод установки требует наличия установленного [Git](https://git-scm.com/) . Клонировать [репозиторий GitHub](https://github.com/azure/azurite) для проекта азурите можно с помощью следующей команды консоли.

```console
git clone https://github.com/Azure/Azurite.git
```

После клонирования исходного кода выполните следующие команды из корня клонированного репозитория, чтобы создать и установить Азурите.

```console
npm install
npm run build
npm install -g
```

После установки и сборки Азурите см. раздел [Запуск азурите из командной строки](#run-azurite-from-a-command-line).

## <a name="run-azurite-from-a-command-line"></a>Запуск Азурите из командной строки

> [!NOTE]
> Азурите невозможно запустить из командной строки, если установлено только расширение Visual Studio Code. Вместо этого используйте палитру команд VS Code. Дополнительные сведения см. [в статье Установка и запуск расширения азурите Visual Studio Code](#install-and-run-the-azurite-visual-studio-code-extension).

Чтобы немедленно приступить к работе с командной строкой, создайте каталог с именем **к:\азурите**, а затем запустите азурите, выполнив следующую команду:

```console
azurite --silent --location c:\azurite --debug c:\azurite\debug.log
```

Эта команда указывает Азурите хранить все данные в определенном каталоге, **к:\азурите**. Если параметр **--Location** не указан, будет использоваться текущий рабочий каталог.

## <a name="command-line-options"></a>Параметры командной строки

В этом разделе описаны параметры командной строки, доступные при запуске Азурите. Все параметры командной строки являются необязательными.

```console
C:\Azurite> azurite [--blobHost <IP address>] [--blobPort <port address>] 
    [-d | --debug <log file path>] [-l | --location <workspace path>]
    [--queueHost <IP address>] [--queuePort <port address>]
    [-s | --silent] [-h | --help]
```

**-D** — это ярлык для параметра-- **Debug**, **-l** — это ярлык для- **-Location**, **-s** — ярлык для-- **Silent**, а **-h** — это ярлык для **--справки**.

### <a name="blob-listening-host"></a>Узел прослушивания BLOB-объектов

**Необязательно** По умолчанию Азурите будет ожидать 127.0.0.1 в качестве локального сервера. Используйте параметр **--блобхост** , чтобы задать адрес в качестве требования.

Принимать запросы только на локальном компьютере:

```console
azurite --blobHost 127.0.0.1
```

Разрешить удаленные запросы:

```console
azurite --blobHost 0.0.0.0
```

> [!CAUTION]
> Разрешение удаленных запросов может сделать систему уязвимой для внешних атак.

### <a name="blob-listening-port-configuration"></a>Конфигурация порта прослушивания BLOB-объектов

**Необязательно** По умолчанию Азурите будет прослушивать службу BLOB-объектов через порт 10000. Используйте параметр **--блобпорт** , чтобы указать требуемый порт прослушивания.

> [!NOTE]
> После использования настроенного порта необходимо обновить строку подключения или соответствующую конфигурацию в средствах хранения Azure или пакетах SDK.

Настройте порт прослушивания службы BLOB-объектов:

```console
azurite --blobPort 8888
```

Разрешить системе автоматический выбор доступного порта:

```console
azurite --blobPort 0
```

Используемый порт отображается во время запуска Азурите.

### <a name="queue-listening-host"></a>Узел, слушающий очередь

**Необязательно** По умолчанию Азурите будет ожидать 127.0.0.1 в качестве локального сервера. Используйте параметр **--куеуехост** , чтобы задать адрес в качестве требования.

Принимать запросы только на локальном компьютере:

```console
azurite --queueHost 127.0.0.1
```

Разрешить удаленные запросы:

```console
azurite --queueHost 0.0.0.0
```

> [!CAUTION]
> Разрешение удаленных запросов может сделать систему уязвимой для внешних атак.

### <a name="queue-listening-port-configuration"></a>Настройка порта для прослушивания очереди

**Необязательно** По умолчанию Азурите будет прослушивать служба очередей через порт 10001. Используйте параметр **--куеуепорт** , чтобы указать требуемый порт прослушивания.

> [!NOTE]
> После использования настроенного порта необходимо обновить строку подключения или соответствующую конфигурацию в средствах хранения Azure или пакетах SDK.

Настройте порт прослушивания служба очередей:

```console
azurite --queuePort 8888
```

Разрешить системе автоматический выбор доступного порта:

```console
azurite --queuePort 0
```

Используемый порт отображается во время запуска Азурите.

### <a name="workspace-path"></a>Путь к рабочей области

**Необязательно** Азурите сохраняет данные на локальный диск во время выполнения. Используйте параметр **--Location** , чтобы указать путь в качестве расположения рабочей области. По умолчанию будет использоваться текущий рабочий каталог процесса.

```console
azurite --location c:\azurite
```

```console
azurite -l c:\azurite
```

### <a name="access-log"></a>журнал доступа;

**Необязательно** По умолчанию журнал доступа отображается в окне консоли. Отключите отображение журнала доступа с помощью параметра **--Silent** .

```console
azurite --silent
```

```console
azurite -s
```

### <a name="debug-log"></a>Журнал отладки

**Необязательно** Журнал отладки содержит подробные сведения о каждой трассировке стека запросов и исключений. Включите журнал отладки, указав допустимый путь к локальному файлу для параметра **--Debug** .

```console
azurite --debug path/debug.log
```

```console
azurite -d path/debug.log
```

### <a name="loose-mode"></a>Несвободный режим

**Необязательно** По умолчанию Азурите применяет режим "в режиме" для блокировки неподдерживаемых заголовков и параметров запросов. Отключите строгий режим с помощью параметра **--свободным** .

```console
azurite --loose
```

Обратите внимание на параметр прописной буквы "L":

```console
azurite -L
```

## <a name="authorization-for-tools-and-sdks"></a>Авторизация для средств и пакетов SDK

Подключайтесь к Азурите из пакетов SDK или средств службы хранилища Azure, например [Обозреватель службы хранилища Azure](https://azure.microsoft.com/features/storage-explorer/), используя любую стратегию проверки подлинности. Требуется проверка подлинности. Азурите поддерживает авторизацию с общим ключом и подписанными URL-адресами (SAS). Азурите также поддерживает анонимный доступ к открытым контейнерам.

### <a name="well-known-storage-account-and-key"></a>Хорошо известная учетная запись хранения и ключ

В Азурите можно использовать следующие имя учетной записи и ключ. Это та же хорошо известная учетная запись и ключ, используемые устаревшим эмулятором хранения Azure.

* Имя учетной записи:`devstoreaccount1`
* Ключ учетной записи:`Eby8vdM02xNOcqFlqUwJPLlmEtlCDXJ1OUzFT50uSRZ6IFsuFq2UVErCz4I6tq/K1SZFPTOtr/KBHBeksoGMGw==`

> [!NOTE]
> Помимо проверки подлинности SharedKey, Азурите поддерживает проверку подлинности с помощью учетной записи и службы SAS. Анонимный доступ также доступен, если контейнер настроен для разрешения общего доступа.

### <a name="connection-string"></a>Строка подключения.

Самый простой способ подключиться к Азурите из приложения — настроить строку подключения в файле конфигурации приложения, который ссылается на ярлык *UseDevelopmentStorage = true*. Ниже приведен пример строки подключения в файле *app. config* :

```xml
<appSettings>
  <add key="StorageConnectionString" value="UseDevelopmentStorage=true" />
</appSettings>
```

Дополнительные сведения см. в статье [Настройка строк подключения службы хранилища Azure](storage-configure-connection-string.md).

### <a name="custom-storage-accounts-and-keys"></a>Пользовательские учетные записи хранения и ключи

Азурите поддерживает пользовательские имена и ключи учетных записей хранения, `AZURITE_ACCOUNTS` задавая переменную среды в следующем `account1:key1[:key2];account2:key1[:key2];...`формате:.

Например, используйте настраиваемую учетную запись хранения с одним ключом:

```cmd
set AZURITE_ACCOUNTS="account1:key1"
```

Или используйте несколько учетных записей хранения с двумя ключами:

```cmd
set AZURITE_ACCOUNTS="account1:key1:key2;account2:key1:key2"
```

По умолчанию азурите обновляет имена пользовательских учетных записей и ключи из переменной среды каждую минуту. С помощью этой функции можно динамически поворачивать ключ учетной записи или добавлять новые учетные записи хранения без перезапуска Азурите.

> [!NOTE]
> При задании пользовательских учетных записей хранения учетная запись хранения по умолчанию `devstoreaccount1` отключена.

> [!NOTE]
> Обновите строку подключения соответствующим образом при использовании настраиваемых имен и ключей учетной записи.

> [!NOTE]
> Используйте `export` ключевое слово для задания переменных среды в среде Linux, используйте `set` в Windows.

### <a name="storage-explorer"></a>Обозреватель службы хранилища

В Обозреватель службы хранилища Azure подключитесь к Азурите, щелкнув значок **Добавить учетную запись** , а затем выберите **подключить к локальному эмулятору** и нажмите кнопку **подключить**.

## <a name="differences-between-azurite-and-azure-storage"></a>Различия между Азурите и хранилищем Azure

Между локальным экземпляром Азурите и учетной записью хранения Azure в облаке существуют функциональные различия.

### <a name="endpoint-and-connection-url"></a>Конечная точка и URL-адрес подключения

Конечные точки службы для Азурите отличаются от конечных точек учетной записи хранения Azure. Локальный компьютер не выполняет разрешение имен доменов, поэтому конечные точки Азурите должны быть локальными адресами.

При адресации ресурса в учетной записи хранения Azure имя учетной записи является частью имени узла URI. Ресурс, к которому выполняется обращение, является частью пути URI:

`<http|https>://<account-name>.<service-name>.core.windows.net/<resource-path>`

Следующий URI является допустимым адресом для большого двоичного объекта в учетной записи хранения Azure:

`https://myaccount.blob.core.windows.net/mycontainer/myblob.txt`

Так как локальный компьютер не выполняет разрешение доменных имен, имя учетной записи является частью пути URI, а не имени узла. Используйте следующий формат URI для ресурса в Азурите:

`http://<local-machine-address>:<port>/<account-name>/<resource-path>`

Для доступа к большому двоичному объекту в Азурите можно использовать следующий адрес:

`http://127.0.0.1:10000/myaccount/mycontainer/myblob.txt`

### <a name="scaling-and-performance"></a>Масштабирование и производительность

Азурите не является масштабируемой службой хранилища и не поддерживает большое количество параллельных клиентов. Гарантия производительности не гарантируется. Азурите предназначен для целей разработки и тестирования.

### <a name="error-handling"></a>Обработка ошибок

Азурите соответствует логике обработки ошибок службы хранилища Azure, но существуют различия. Например, сообщения об ошибках могут отличаться, а коды состояния ошибок выровняйте.

### <a name="ra-grs"></a>RA-GRS

Азурите поддерживает геоизбыточную репликацию с доступом на чтение (RA-GRS). Для ресурсов хранилища получите доступ к дополнительному расположению, добавив **-Secondary** в имя учетной записи. Например, следующий адрес может использоваться для доступа к большому двоичному объекту с помощью вторичной реплики "только для чтения" в Азурите:

`http://127.0.0.1:10000/devstoreaccount1-secondary/mycontainer/myblob.txt`

## <a name="azurite-is-open-source"></a>Азурите является открытым кодом

Публикации и предложения для Азурите — Добро пожаловать. Перейдите на страницу [проекта Азурите GitHub](https://github.com/Azure/Azurite/projects) или [проблемы GitHub](https://github.com/Azure/Azurite/issues) для вех и рабочих элементов, которые отслеживаются для предстоящих компонентов и исправлений ошибок. Подробные рабочие элементы также отправляются в GitHub.

## <a name="next-steps"></a>Дальнейшие действия

* [Используйте эмулятор хранения Azure для разработки и тестирования](storage-use-emulator.md) документов в старом эмуляторе хранения Azure, который заменяется азурите.
* [Настройка строк подключения службы хранилища Azure](storage-configure-connection-string.md) содержит сведения о том, как собрать допустимую строку подключения к службе хранилища Azure.
