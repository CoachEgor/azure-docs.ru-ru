---
title: Используйте портал Azure для настройки ключей, управляемых клиентами
titleSuffix: Azure Storage
description: Узнайте, как использовать портал Azure для настройки ключей, управляемых клиентами, с помощью Azure Key Vault для шифрования Azure Storage.
services: storage
author: tamram
ms.service: storage
ms.topic: how-to
ms.date: 03/19/2020
ms.author: tamram
ms.reviewer: cbrooks
ms.subservice: common
ms.openlocfilehash: e7878cae7bc6aabf1db58bfd63338955b9e830d3
ms.sourcegitcommit: efefce53f1b75e5d90e27d3fd3719e146983a780
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/01/2020
ms.locfileid: "80478242"
---
# <a name="configure-customer-managed-keys-with-azure-key-vault-by-using-the-azure-portal"></a>Налаживание ключей, управляемых клиентами, с помощью портала Azure Key Vault

[!INCLUDE [storage-encryption-configure-keys-include](../../../includes/storage-encryption-configure-keys-include.md)]

В этой статье показано, как настроить Хранилище ключей Azure с помощью ключей, управляемых клиентами, с помощью [портала Azure.](https://portal.azure.com/) Чтобы узнать, как создать хранилище ключей с помощью портала Azure, [см.](../../key-vault/quick-create-portal.md)

## <a name="configure-azure-key-vault"></a>Настройка Azure Key Vault

Использование управляемых клиентом ключей с помощью шифрования Azure Storage требует установки двух свойств на хранилище ключей: **Soft Delete** и Do **Not Purge.** Эти свойства не включены по умолчанию, но могут быть включены с помощью PowerShell или Azure CLI в новом или существующем хранилище ключей.

Чтобы узнать, как включить эти свойства в существующем хранилище ключей, см. разделы под названием **"Включение в мягкое удаление** и **включение защиты от очистки"** в одной из следующих статей:

- [Как использовать мягкое удаление с PowerShell](../../key-vault/key-vault-soft-delete-powershell.md).
- [Как использовать мягкое удаление с CLI](../../key-vault/key-vault-soft-delete-cli.md).

Только 2048-разрядные клавиши RSA и RSA-HSM поддерживаются шифрованием Azure Storage. Для получения дополнительной информации о ключах смотрите **ключи Убежища ключей** в [о клавишах, секретах и сертификатах Azure Key Vault.](../../key-vault/about-keys-secrets-and-certificates.md#key-vault-keys)

## <a name="enable-customer-managed-keys"></a>Включить ключи, управляемые клиентом

Для включения ключей, управляемых клиентами, на портале Azure выполните следующие действия:

1. Войдите в свою учетную запись хранения.
1. В колоне **параметров** для учетной записи хранения выберите **Шифрование**. Выберите опцию **Управляемые ключи клиента,** как показано на следующем изображении.

    ![Скриншот портала, показывающий опцию шифрования](./media/storage-encryption-keys-portal/portal-configure-encryption-keys.png)

## <a name="specify-a-key"></a>Указать ключ

После включения ключей, управляемых клиентом, у вас будет возможность указать ключ для связи с учетной записью хранилища.

### <a name="specify-a-key-as-a-uri"></a>Указание ключа в качестве URI

Чтобы указать ключ как URI, выполните следующие действия:

1. Чтобы найти ключ URI на портале Azure, перейдите к хранилищу ключа и выберите настройки **ключей.** Выберите нужный ключ, а затем нажмите на клавишу, чтобы просмотреть его версии. Выберите ключевую версию для просмотра настроек для этой версии.
1. Копируйте значение поля **идентификатора ключей,** которое обеспечивает URI.

    ![Скриншот, показывающий ключ свода URI](media/storage-encryption-keys-portal/portal-copy-key-identifier.png)

1. В настройках **шифрования** для учетной записи хранилища выберите опцию **Uri ключа Enter.**
1. Вставьте URI, который вы скопировали в поле **Key URI.**

   ![Скриншот, показывающий, как ввести ключ URI](./media/storage-encryption-keys-portal/portal-specify-key-uri.png)

1. Укажите подписку, содержащую хранилище ключей.
1. Сохраните изменения.

### <a name="specify-a-key-from-a-key-vault"></a>Указание ключа из хранилища ключей

Чтобы указать ключ из хранилища ключей, сначала убедитесь, что у вас есть хранилище ключей, содержащее ключ. Чтобы указать ключ из хранилища ключей, выполните следующие действия:

1. Выберите параметр **Выбрать в Key Vault**.
1. Выберите хранилище ключей, содержащее ключ, который вы хотите использовать.
1. Выберите ключ из хранилища ключей.

   ![Скриншот, показывающий ключевой вариант, управляемый клиентами](./media/storage-encryption-keys-portal/portal-select-key-from-key-vault.png)

1. Сохраните изменения.

## <a name="update-the-key-version"></a>Обновление ключевой версии

При создании новой версии ключа обновите учетную запись хранилища, чтобы использовать новую версию. Выполните следующие действия.

1. Перейдите к учетной записи хранилища и отобразите параметры **шифрования.**
1. Введите URI для новой ключевой версии. Кроме того, вы можете выбрать хранилище ключей и ключ снова для обновления версии.
1. Сохраните изменения.

## <a name="use-a-different-key"></a>Используйте другой ключ

Чтобы изменить ключ, используемый для шифрования хранилища Azure, выполните следующие действия:

1. Перейдите к учетной записи хранилища и отобразите параметры **шифрования.**
1. Введите URI для нового ключа. Кроме того, вы можете выбрать хранилище ключей и выбрать новый ключ.
1. Сохраните изменения.

## <a name="disable-customer-managed-keys"></a>Отключить ключи, управляемые клиентом

При отключении ключей, управляемых клиентом, ваша учетная запись хранилища снова шифруется ключами, управляемыми корпорацией Майкрософт. Чтобы отключить ключи, управляемые клиентом, выполните следующие действия:

1. Перейдите к учетной записи хранилища и отобразите параметры **шифрования.**
1. Отменить флажок рядом с настройкой **ключа Используйте свои собственные настройки.**

## <a name="next-steps"></a>Следующие шаги

- [Шифрование хранилища Azure для данных в состоянии покоя](storage-service-encryption.md)
- [Что такое Убежище ключей Azure?](https://docs.microsoft.com/azure/key-vault/key-vault-overview)
