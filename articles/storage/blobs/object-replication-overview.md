---
title: Общие сведения о репликации объектов (предварительная версия)
titleSuffix: Azure Storage
description: Репликация объектов (предварительная версия) асинхронно копирует блочные BLOB-объекты между исходной и целевой учетными записями хранения. Используйте репликацию объектов, чтобы снизить задержку запросов на чтение, повысить эффективность вычислений, оптимизировать распределение данных и сократить затраты.
services: storage
author: tamram
ms.service: storage
ms.topic: conceptual
ms.date: 05/28/2020
ms.author: tamram
ms.subservice: blobs
ms.openlocfilehash: 2d8d4c369cef8bf996628e8c89a424f04dcdbe71
ms.sourcegitcommit: 877491bd46921c11dd478bd25fc718ceee2dcc08
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/02/2020
ms.locfileid: "84888072"
---
# <a name="object-replication-for-block-blobs-preview"></a>Репликация объектов для блочных BLOB-объектов (предварительная версия)

Репликация объектов (предварительная версия) асинхронно копирует блочные BLOB-объекты между исходной и целевой учетными записями хранения. Ниже перечислены некоторые сценарии, поддерживаемые репликацией объектов.

- **Минимизация задержки.** Репликация объектов может сократить задержку запросов на чтение, позволяя клиентам использовать данные из региона, наиболее близкого к их физическому расположению.
- **Повышение эффективности вычислений для рабочих нагрузок.** При репликации объектов рабочие нагрузки вычислений могут обрабатывать одни и те же наборы блочных BLOB-объектов в разных регионах.
- **Оптимизация распределения данных.** Вы можете обрабатывать или анализировать данные в одном месте, а затем просто реплицировать полученные результаты в дополнительные регионы.
- **Оптимизация затрат.** После репликации данных можно уменьшить затраты, переместив их на уровень архива с помощью политик управления жизненным циклом.

На следующей схеме показано, как репликация объектов реплицирует блочные BLOB-объекты из исходной учетной записи хранения в одном регионе в конечные учетные записи в двух разных регионах.

:::image type="content" source="media/object-replication-overview/object-replication-diagram.svg" alt-text="Диаграмма, показывающая, как работает репликация объектов":::

Дополнительные сведения о настройке репликации объектов см. в разделе [Настройка репликации объектов (предварительная версия)](object-replication-configure.md).

## <a name="object-replication-policies-and-rules"></a>Политики и правила репликации объектов

При настройке репликации объектов создается политика репликации, указывающая исходную учетную запись хранения и целевую учетную запись. Политика репликации включает одно или несколько правил, задающих исходный и целевой контейнеры, и указывает, какие блочные BLOB-объекты в исходном контейнере будут реплицированы.

После настройки репликации объектов служба хранилища Azure периодически проверяет канал изменений для исходной учетной записи и асинхронно реплицирует все операции записи или удаления в целевую учетную запись. Задержка репликации зависит от размера реплицируемого блочного BLOB-объекта.

> [!IMPORTANT]
> Так как данные блочного BLOB-объекта реплицируются асинхронно, исходная и целевая учетные записи не синхронизируются немедленно. В настоящее время нет соглашения об уровне обслуживания относительно того, сколько времени должна занимать репликация данных в целевую учетную запись.

### <a name="replications-policies"></a>Политики репликации

При настройке репликации объектов создается политика репликации как для исходной учетной записи, так и для целевой учетной записи, с помощью поставщика ресурсов службы хранилища Azure. Политика репликации определяется по ее идентификатору политики. Чтобы репликация была выполнена, политика на исходной и целевой учетных записях должна иметь одинаковый идентификатор политики.

Учетная запись хранения может выступать в качестве исходной учетной записи для двух целевых учетных записей. У целевой учетной записи может быть не более двух исходных учетных записей. Исходная и целевая учетные записи могут находиться в разных регионах. Можно настроить отдельные политики репликации для репликации данных в каждую из целевых учетных записей.

### <a name="replication-rules"></a>Правила репликации

Правила репликации указывают, как служба хранилища Azure будет реплицировать BLOB-объекты из исходного контейнера в целевой. Для каждой политики репликации можно указать до 10 правил репликации. Каждое правило определяет один исходный и один целевой контейнер, и каждый исходный и целевой контейнер можно использовать только в одном правиле.

При создании правила репликации по умолчанию копируются только новые блочные BLOB-объекты, которые впоследствии добавляются в исходный контейнер. Можно также указать, что будут копироваться новые и существующие блочные BLOB-объекты, или можно определить пользовательскую область копирования, которая будет копировать блочные BLOB-объекты, созданные начиная с указанного момента.

Можно также указать один или несколько фильтров в рамках правила репликации, чтобы фильтровать блочные BLOB-объекты по префиксу. При указании префикса только большие двоичные объекты, соответствующие этому префиксу в исходном контейнере, будут скопированы в целевой контейнер.

Оба контейнера, исходный и целевой, должны существовать, прежде чем их можно будет указать в правиле. После создания политики репликации целевой контейнер станет доступен только для чтения. Любые попытки записи в целевой контейнер завершатся ошибкой с кодом 409 (конфликт). Тем не менее можно вызвать операцию [установить уровень BLOB](/rest/api/storageservices/set-blob-tier) -объекта в конечном контейнере, чтобы переместить его на уровень архива. Дополнительные сведения о уровне архива см. в статье [хранилище BLOB-объектов Azure: горячий, холодный и архивный уровни доступа](storage-blob-storage-tiers.md#archive-access-tier).

## <a name="about-the-preview"></a>Сведения о предварительной версии

Репликация объектов поддерживается только для учетных записей хранения общего назначения версии 2. В предварительной версии глобальная репликация доступна в следующих регионах.

- Центральная Франция
- Восточная Канада
- Центральная Канада

Как исходная, так и целевая учетная запись должны находиться в одном из этих регионов, чтобы можно было использовать репликацию объектов. Учетные записи могут находиться в двух разных регионах.

У предварительной версии нет дополнительных затрат, связанных с репликацией данных между учетными записями хранения.

> [!IMPORTANT]
> Предварительная версия репликации объектов не предназначена для использования в рабочей среде. Соглашения об уровне обслуживания (SLA) для рабочих сред сейчас недоступны.

### <a name="prerequisites-for-object-replication"></a>Необходимые условия для репликации объектов

Для репликации объектов требуется, чтобы были включены следующие функции службы хранилища Azure. 
- [Веб-канал изменений](storage-blob-change-feed.md)
- [Управление версиями](versioning-overview.md)

Перед настройкой репликации объектов включите необходимые ей компоненты. В исходной учетной записи должен быть включен канал изменений, а управление версиями BLOB-объектов должно быть включено как в исходной, так и в целевой учетной записи. Дополнительные сведения о включении этих функций см. в следующих статьях:

- [Включение и отключение канала изменений](storage-blob-change-feed.md#enable-and-disable-the-change-feed)
- [Включение управления версиями BLOB-объектов и работа с ним](versioning-enable.md)

Прежде чем включать предварительные версии для канала изменений и управления версиями BLOB-объектов, обязательно зарегистрируйтесь.

Включение канала изменений и управления версиями BLOB-объектов может повлечь за собой дополнительные затраты. Дополнительные сведения см. на странице [цен на службу хранилища Azure](https://azure.microsoft.com/pricing/details/storage/).

### <a name="register-for-the-preview"></a>Зарегистрируйтесь для использования предварительной версии

Вы можете зарегистрироваться на предварительную версию репликации объектов с помощью PowerShell или Azure CLI. Не забудьте также зарегистрироваться для использования предварительных версий канала изменений и управления версиями BLOB-объектов, если это еще не сделано.

# <a name="powershell"></a>[PowerShell](#tab/powershell)

Чтобы зарегистрироваться для использования предварительной версии с помощью PowerShell, выполните следующие команды:

```powershell
# Register for the object replication preview
Register-AzProviderFeature -FeatureName AllowObjectReplication -ProviderNamespace Microsoft.Storage

# Register for change feed (preview)
Register-AzProviderFeature -FeatureName Changefeed -ProviderNamespace Microsoft.Storage

# Register for blob versioning (preview)
Register-AzProviderFeature -FeatureName Versioning -ProviderNamespace Microsoft.Storage

# Refresh the Azure Storage provider namespace
Register-AzResourceProvider -ProviderNamespace Microsoft.Storage
```

# <a name="azure-cli"></a>[Azure CLI](#tab/azure-cli)

Чтобы зарегистрироваться для использования предварительной версии Azure CLI, выполните следующие команды:

```azurecli
az feature register --namespace Microsoft.Storage --name AllowObjectReplication
az feature register --namespace Microsoft.Storage --name Changefeed
az feature register --namespace Microsoft.Storage --name Versioning
az provider register --namespace 'Microsoft.Storage'
```

---

### <a name="check-registration-status"></a>Проверка состояния регистрации

Вы можете проверить состояние своих запросов на регистрацию с помощью PowerShell или Azure CLI.

# <a name="powershell"></a>[PowerShell](#tab/powershell)

Чтобы проверить состояние запросов на регистрацию с помощью PowerShell, выполните следующие команды:

```powershell
Get-AzProviderFeature -ProviderNamespace Microsoft.Storage `
    -FeatureName AllowObjectReplication

Get-AzProviderFeature -ProviderNamespace Microsoft.Storage `
    -FeatureName Changefeed

Get-AzProviderFeature -ProviderNamespace Microsoft.Storage `
    -FeatureName Versioning
```

# <a name="azure-cli"></a>[Azure CLI](#tab/azure-cli)

Чтобы проверить состояние запросов на регистрацию с помощью Azure CLI, выполните следующие команды:

```azurecli
az feature list -o table --query "[?contains(name, 'Microsoft.Storage/AllowObjectReplication')].{Name:name,State:properties.state}"
az feature list -o table --query "[?contains(name, 'Microsoft.Storage/Changefeed')].{Name:name,State:properties.state}"
az feature list -o table --query "[?contains(name, 'Microsoft.Storage/Versioning')].{Name:name,State:properties.state}"
```

---

## <a name="ask-questions-or-provide-feedback"></a>Где можно задать вопрос или оставить отзыв?

С вопросами или отзывами о предварительной версии репликации объектов обращайтесь в корпорацию Майкрософт по адресу AzureStorageFeedback@microsoft.com. Идеи и предложения о службе хранилища Azure всегда готовы принять [на форуме отзывов о службе хранилища Azure ](https://feedback.azure.com/forums/217298-storage).

## <a name="next-steps"></a>Дальнейшие действия

- [Настройка репликации объектов (предварительная версия)](object-replication-configure.md)
- [Поддержка канала изменений в хранилище BLOB-объектов Azure (предварительная версия)](storage-blob-change-feed.md)
- [Включение управления версиями BLOB-объектов и работа с ним](versioning-enable.md)
