---
title: Неизменяемое хранилище для больших двоичных объектов службы хранилища Azure | Документация Майкрософт
description: Служба хранилища Azure предлагает поддержку WORM для хранения больших двоичных объектов, что позволяет хранить данные в нестираемом и неизменяемом состоянии на протяжении определенного интервала времени.
services: storage
author: tamram
ms.service: storage
ms.topic: article
ms.date: 06/01/2019
ms.author: tamram
ms.reviewer: hux
ms.subservice: blobs
ms.openlocfilehash: d58c596421cec2e69210dd39a5d4a9708c154b44
ms.sourcegitcommit: 600d5b140dae979f029c43c033757652cddc2029
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/04/2019
ms.locfileid: "66492751"
---
# <a name="store-business-critical-data-in-azure-blob-storage"></a>Хранение критически важных для бизнеса данных в хранилище BLOB-объектов Azure

Неизменяемый хранилища BLOB-объектов Azure позволяет пользователям хранить объекты критически важных бизнес-данных в состоянии вирус-ЧЕРВЬ (однократная запись, многократное чтение). Это состояние делает их нестираемыми и неизменяемыми в течение определенного пользователем интервала времени. Объектов BLOB-объектов может быть создано и чтения, но не изменен или удален, в течение этого интервала. Неизменяемый хранилище включается для общего назначения версии 2 и учетные записи хранилища BLOB-объектов во всех регионах Azure.

## <a name="overview"></a>Обзор

Неизменяемый хранилище помогает организации здравоохранения, финансовых учреждений и связанных отраслях — особенно broker раздающий организаций--для безопасного хранения данных. Он также будет доступен в любом сценарии для защиты важных данных, изменение или удаление. 

Распространенные приложения включают следующее.

- **Соответствие нормативным требованиям**: хранение данных в неизменяемом виде в хранилище BLOB-объектов Azure помогает организациям соответствовать SEC 17a-4(f), CFTC 1.31(d), FINRA и другим нормам. Технический документ по Cohasset связывает сведения как неизменяемые адреса хранилища, загружаемые с помощью этих нормативных требований [Microsoft Service Trust Portal](https://aka.ms/AzureWormStorage). [Центр управления безопасностью Azure](https://www.microsoft.com/trustcenter/compliance/compliance-overview) подробными сведениями о наши сертификаты соответствия.

- **Безопасное хранение документов**: Неизменяемый хранилище BLOB-объектов Azure гарантирует, что данных нельзя изменить или удалить любой пользователь, включая пользователей с правами администратора учетной записи.

- **Юридическое удержание**: Неизменяемый хранилища BLOB-объектов Azure позволяет пользователям сохранять конфиденциальные сведения, важные для бизнеса или судебного процесса использования в состоянии защищенное от несанкционированного доступа по желаемой длительности, пока не будет снята блокировка. Этот компонент не ограничивается только варианты использования, юридические, но может также рассматриваться как удержание на основе событий или блокировку enterprise, где требуется защита данных на основе триггеров событий или корпоративной политики.

Неизменяемый хранилища поддерживает следующие функции:

- **[Поддержка политики хранения на основе времени](#time-based-retention)** : Пользователи могут задавать политики для хранения данных в течение указанного интервала времени. Если политика хранения на основе времени задать, большие двоичные объекты можно будут создания и чтения, но не изменены или удалены. После истечения срока хранения больших двоичных объектов можно удалять, но не перезаписываются.

- **[Поддержка политики удержания по юридическим причинам](#legal-holds)** : Если интервал хранения не известна, пользователи могут задавать юридические удержания для хранения данных immutably, пока не снят удержание по юридическим причинам.  Если настроена политика удержания по юридическим причинам, большие двоичные объекты можно будут создания и чтения, но не изменены или удалены. Каждый удержание по юридическим причинам, связанный с пользовательской буквенно-цифровой тег (например, вариантов идентификатор, имя события, т. д.), используемый в качестве строки идентификатора. 

- **Поддержка для всех уровней хранилища BLOB-объектов**: политики WORM не зависят от уровня хранилища BLOB-объектов Azure и применяются ко всем уровням: горячим, холодным и архивным. Это позволяет пользователям переносить данные на наиболее оптимизированный по стоимости уровень для своей рабочей нагрузки, сохраняя их неизменность.

- **Настройка уровня контейнера**: на уровне контейнера пользователи могут настроить временные политики периода удержания и теги юридического удержания. С помощью простых параметров уровня контейнера, пользователи могут создавать и заблокировать политики хранения на основе времени, расширения интервалы хранения, set и снимите юридические содержит и многое другое. Эти политики применяются для всех имеющихся и новых больших двоичных объектов в контейнере.

- **Поддержка ведения журнала аудита**: Каждый контейнер включает журнал аудита политики. Он показывает семь по времени хранения для политики хранения заблокированные по времени и содержит идентификатор пользователя, тип команды, отметки времени и период хранения. Для юридического удержания журнал содержит идентификатор пользователя, тип команды, отметки времени и теги юридического удержания. Этот журнал хранится в течение времени существования политики, в соответствии с требованиями законодательства 17a-4(f) сек. [Журнал действий Azure](../../azure-monitor/platform/activity-logs-overview.md) показан более полный журнал всех действий уровня управления; при включении [журналов диагностики Azure](../../azure-monitor/platform/diagnostic-logs-overview.md) хранения и отображения операции в плоскости данных. Пользователь постоянно несет ответственность за хранение этих журналов в соответствии с нормативами или другими требованиями.

## <a name="how-it-works"></a>Принцип работы

Функция хранения данных в неизменяемом виде хранилища BLOB-объектов Azure поддерживает два типа WORM или неизменяемых политик: период удержания на основе времени и юридическое удержание. При применении политики хранения на основе времени или удержание по юридическим причинам в контейнере в неизменяемом состоянии вирус-ЧЕРВЬ переместить все существующие большие двоичные объекты менее чем за 30 секунд. Все новые большие двоичные объекты, которые передаются в этот контейнер также будут перемещены в неизменяемом состоянии. После того как все большие двоичные объекты были перемещены в неизменяемом состоянии, подтверждается неизменяемый политики и перезаписать или удалить операции для существующих и новых объектов в контейнере неизменяемый не разрешены.

Контейнер и удаление учетной записи также не разрешены при наличии все большие двоичные объекты, защищенные политикой неизменяемый. Операция "Удалить контейнер" не будет выполнена, если в контейнере существует хотя бы один большой двоичный объект с заблокированной политикой хранения на основе времени или юридическим удержанием. Удаление учетной записи хранилища не будет выполнено, если там присутствует хотя бы один WORM-контейнер с юридическим удержанием или BLOB-объект с действующим интервалом периода удержания. 

### <a name="time-based-retention"></a>Хранение на основе времени

> [!IMPORTANT]
> Политика хранения на основе времени должна быть *заблокирован* большого двоичного объекта в совместимых неизменяемый (записи и удаления защищенных) состоянии 17a-4(f) сек и соответствия другим нормативным требованиям. Мы рекомендуем заблокировать политику в течение приемлемого промежутка времени, обычно менее 24 часов. Состояние политики хранения применяются по времени *разблокирован*, что позволяет тестировать эту возможность и внести изменения в политике перед блокирует его. Хотя *разблокирован* состояния обеспечивает неизменность защиту, мы не рекомендуем использовать *разблокирован* состояния для целей, отличных от краткосрочной пробные версии компонента. 

Когда политика хранения на основе времени применяется в контейнере, все большие двоичные объекты контейнера остаются в неизменяемом состоянии в течение *действующего* периода удержания. Разница между время изменения BLOB-объектов и определяемое пользователем интервала равно действующие срок хранения для существующих больших двоичных объектов.

Для новых BLOB-объектов период эффективного удержания равен интервалу удержания, определяемого пользователем. Так как пользователи могут расширять интервал удержания, функция хранения данных в неизменяемом виде будет использовать самое последнее его значение для вычисления периода эффективного удержания.

> [!TIP]
> **Пример.** Пользователь создает политику хранения на основе времени с пятилетним интервалом удержания.
>
> Существующий большой двоичный объект в этом контейнере _testblob1_, был создан один год назад. Действующие срок хранения для _testblob1_ — четыре года.
>
> Новый большой двоичный объект _testblob2_, теперь передается в контейнер. Период эффективного удержания для этого нового большого двоичного объекта составляет пять лет.

Политику разблокирован хранение на основе времени рекомендуется только для тестирования компонентов и политики должна быть заблокирована для соответствия требованиям с 17a-4(f) сек и соответствия другим нормативным требованиям. После блокировки политику хранения на основе времени политику нельзя удалить, и максимальное значение — 5 увеличения действующие срок хранения. Дополнительные сведения о том, как задать и закрепить политики хранения на основе времени, см. в разделе [Приступая к работе](#getting-started) раздел.

### <a name="legal-holds"></a>Юридические удержания

Все имеющиеся и новые большие двоичные объекты, которые находятся в юридическом удержании, остаются в неизменяемом состоянии, пока юридическое удержание не будет снято. Дополнительные сведения о том, как настроить и снять юридические удержания, см. в разделе о [начале работы](#getting-started).

Контейнер может иметь одновременно и юридическое удержание, и политику хранения на основе времени. Все большие двоичные объекты в этом контейнере остаются в неизменяемом состоянии, пока все юридические удержания не будут сняты, даже если период эффективного хранения истек. И наоборот, большой двоичный объект остается в неизменяемом состоянии до тех пор, пока не истечет период эффективного хранения, хотя все юридические удержания сняты.

В следующей таблице показаны типы операций с большими двоичными объектами, которые будут отключены в разных сценариях использования неизменяемых объектов. Дополнительные сведения см. в [документации по API службы BLOB-объектов Azure](https://docs.microsoft.com/rest/api/storageservices/blob-service-rest-api).

|Сценарий  |Состояние больших двоичных объектов  |Недопустимые операции с большими двоичными объектами  |
|---------|---------|---------|
|Эффективный интервал удержания большого двоичного объекта еще не истек, и (или) установлено юридическое удержание     |Неизменяемость: защита от удаления и от записи         | Размещение BLOB-объекта<sup>1</sup>, поместить блок<sup>1</sup>, Вставка списка блокировки<sup>1</sup>, удалить метаданные большого двоичного объекта контейнера, удалить большой двоичный объект набора, страницу, задайте свойства большого двоичного объекта, моментальный снимок BLOB-объектов, добавочного копирования больших двоичных объектов, Добавить блок         |
|Срок действия интервала эффективного хранения большого двоичного объекта истек.     |Защита только от записи (разрешены операции удаления)         |Вставка большого двоичного объекта<sup>1</sup>, вставка блока<sup>1</sup>, вставка списка блоков<sup>1</sup>, установка метаданных большого двоичного объекта, вставка страницы, установка свойства большого двоичного объекта, создание моментального снимка большого двоичного объекта, инкрементное копирование больших двоичных объектов, добавление блока         |
|Все юридические удержания сняты, а в контейнере не задана политика хранения на основе времени     |Изменяемый         |Нет         |
|Политика WORM не создана (период удержания на основе времени или юридическое удержание)     |Изменяемый         |Нет         |

<sup>1</sup> допускает использование этих операций создать новый большой двоичный объект один раз. Все последующие перезаписать операции на существующем контуре BLOB-объектов в контейнере неизменяемый не допускаются.

## <a name="supported-values"></a>Поддерживаемые значения

### <a name="time-based-retention"></a>Хранение на основе времени
- Для учетной записи хранения максимальное число контейнеров с заблокированной неизменяемый политики на основе времени равно 1000.
- Минимальное интервала — 1 день. Максимальное значение — 146,000 дней (400 лет).
- Для контейнера изменения для расширения интервал хранения для заблокированного неизменяемый политики на основе времени не более 5.
- Для контейнера более 7 журналы аудита политики хранения на основе времени сохраняются в течение политики.

### <a name="legal-hold"></a>Удержание по юридическим причинам
- Для учетной записи хранения максимальное количество контейнеров с параметром юридического удержания составляет 1000.
- Для контейнера максимальное количество тегов юридического удержания составляет 10.
- Минимальная длина тега удержание по юридическим причинам — 3 буквенно-цифровые символы. Максимальная длина составляет 23 буквенно-цифровые символы.
- Для контейнера максимум 10 юридические удерживайте политики аудита, журналы сохраняются в течение политики.

## <a name="pricing"></a>Цены

За использование этой функции не взимается дополнительная плата. Неизменяемые данные оценивается так же, как обычные изменяемые данные. Информацию о ценах на хранилище BLOB-объектов Azure см. на [этой странице](https://azure.microsoft.com/pricing/details/storage/blobs/).

## <a name="getting-started"></a>Приступая к работе
Неизменяемый хранилище доступно только для общего назначения версии 2 и учетные записи хранения BLOB-объектов. Эти учетные записи должны управляться [Azure Resource Manager](https://docs.microsoft.com/azure/azure-resource-manager/resource-group-overview). Сведения об обновлении существующей учетной записи хранения общего назначения версии 1, см. в разделе [обновления учетных записей хранилища](../common/storage-account-upgrade.md).

В последних выпусках [портала Azure](https://portal.azure.com), [Azure CLI](https://docs.microsoft.com/cli/azure/install-azure-cli?view=azure-cli-latest), и [Azure PowerShell](https://github.com/Azure/azure-powershell/releases) поддерживают неизменяемый хранилище BLOB-объектов Azure. [Поддержка клиентских библиотек](#client-libraries) также предоставляется.

### <a name="azure-portal"></a>Портал Azure

1. Создайте новый контейнер или выберите существующий контейнер для хранения BLOB-объектов, которые должны храниться в неизменяемом состоянии.
 Контейнер должен находиться в учетной записи хранения общего назначения версии 2 или учетной записи хранилища BLOB-объектов.
2. В параметрах контейнера выберите **Политика доступа**. Затем в разделе **Хранилище неизменяемых BLOB-объектов** щелкните **Добавить политику**.

    ![Параметры контейнера на портале](media/storage-blob-immutable-storage/portal-image-1.png)

3. Чтобы включить временный период удержания, в раскрывающемся меню выберите **Хранение с учетом времени**.

    ![Параметр "Хранение с учетом времени", выбранный в разделе типа политики](media/storage-blob-immutable-storage/portal-image-2.png)

4. Введите интервал хранения в днях (допустимые значения 1 для 146000 дней).

    ![Поле "Изменить срок хранения на"](media/storage-blob-immutable-storage/portal-image-5-retention-interval.png)

    Начальное состояние политики разблокируется, что позволяет тестировать эту возможность и внести изменения в политике перед блокирует его. Политика блокировки, крайне важна для соответствия требованиям, например сек 17a-4.

5. Заблокируйте политику. Щелкните правой кнопкой мыши кнопку с многоточием ( **...** ), и появится следующее меню с дополнительные действия:

    ![Параметр "Политика блокировки" в меню](media/storage-blob-immutable-storage/portal-image-4-lock-policy.png)

6. Выберите **политики блокировки** и подтвердите блокировку. Политика в настоящий момент заблокирован и не может быть удалена, будет разрешен только расширения этого интервала. Удаление BLOB-объектов и переопределений не разрешены. 

    ![Подтвердите «Блокировки политика» в меню](media/storage-blob-immutable-storage/portal-image-5-lock-policy.png)

7. Чтобы включить юридические удержания, нажмите кнопку **Добавить политику**. В раскрывающемся меню выберите **Удержание по юридическим причинам**.

    ![Параметр в меню "Удержание по юридическим причинам" под полем "Тип политики"](media/storage-blob-immutable-storage/portal-image-legal-hold-selection-7.png)

8. Создайте юридическое удержание с одним или несколькими тегами.

    ![Поле "Имя тега" под полем "Тип политики"](media/storage-blob-immutable-storage/portal-image-set-legal-hold-tags.png)

9. Чтобы очистить удержание по юридическим причинам, просто удалите тег идентификатора примененные удержание по юридическим причинам.

### <a name="azure-cli"></a>Инфраструктура CLI Azure

Эта возможность доступна в следующих группах команд: `az storage container immutability-policy` и `az storage container legal-hold`. Запустите в них `-h`, чтобы просмотреть команды.

### <a name="powershell"></a>PowerShell

Модуль Az.Storage поддерживает неизменяемый хранилища.  Чтобы включить эту функцию, сделайте следующее:

1. Установите последнюю версию PowerShellGet: `Install-Module PowerShellGet –Repository PSGallery –Force`.
2. Удалите все предыдущие версии Azure PowerShell.
3. Установка Azure PowerShell: `Install-Module Az –Repository PSGallery –AllowClobber`.

В разделе [примера кода PowerShell](#sample-powershell-code) ниже показано использование функции.

## <a name="client-libraries"></a>Клиентские библиотеки

Следующие клиентские библиотеки поддерживают возможность хранения данных в неизменяемом виде в хранилище BLOB-объектов Azure:

- [Клиентская библиотека .NET (предварительная версия 7.2.0 и более поздние версии)](https://www.nuget.org/packages/Microsoft.Azure.Management.Storage/7.2.0-preview).
- [Клиентская библиотека Node.js (версии 4.0.0 и более поздние версии)](https://www.npmjs.com/package/azure-arm-storage).
- [Клиентская библиотека Python (версии 2.0.0, версия-кандидат 2 и более поздние версии)](https://pypi.org/project/azure-mgmt-storage/2.0.0rc2/).
- [Клиентская библиотека Java](https://github.com/Azure/azure-rest-api-specs/tree/master/specification/storage/resource-manager/Microsoft.Storage/preview/2018-03-01-preview)

## <a name="faq"></a>Часто задаваемые вопросы

**Обеспечить документации вирус-ЧЕРВЬ соответствия?**

Да. Для соответствия документа Microsoft сохраняются ведущая компания независимой оценки, которая специализируется на записи управления и управления информацией, связывает Cohasset, для оценки хранилище неизменяемых BLOB-объектов Azure и его соответствие с требованиями конкретного в отрасли финансовых услуг. Cohasset проверить, что неизменяемый хранилище BLOB-объектов, при использовании для сохранения по времени большие двоичные объекты в состоянии вирус-ЧЕРВЬ, соответствует требованиям соответствующее дисковое 1.31(c)-(d) CFTC правило, правило 4511 FINRA и правило с 17a-4. Microsoft в первую очередь этот набор правил, так как они представляют наиболее предписания глобально для хранения записей для финансовых учреждений. Отчет Cohasset доступен в [Microsoft Service Trust Center](https://aka.ms/AzureWormStorage). Чтобы запросить буквы аттестации от корпорации Майкрософт по соответствию вирус-ЧЕРВЬ, обратитесь в службу поддержки Azure.

**Используется ли эта возможность только для блочных BLOB-объектов или ее можно использовать также для страничных и добавочных BLOB-объектов?**

Хранение данных в неизменяемом виде может использоваться с любым типом больших двоичных объектов, но мы рекомендуем использовать его главным образом для блочных BLOB-объектов. В отличие от блочных BLOB-объектов, страничные и добавочные BLOB-объекты необходимо создавать вне WORM-контейнера, а затем скопировать их в него. После копирования эти большие двоичные объекты в контейнер вирус-ЧЕРВЬ, не дальнейшей *добавляет* добавить допускаются большого двоичного объекта или изменения страничный большой двоичный объект.

**Нужно ли создать новую учетную запись хранения, чтобы использовать эту функцию?**

Нет, неизменяемый хранилища можно использовать с любым существующую или новую общего назначения версии 2 или учетные записи хранения BLOB-объектов. Эта функция предназначена для использования с помощью блочных BLOB-объектов в учетных записях GPv2 и хранилища BLOB-объектов. Учетные записи хранения общего назначения версии 1 не поддерживаются, но можно легко обновить до версии 2 общего назначения. Сведения об обновлении существующей учетной записи хранения общего назначения версии 1, см. в разделе [обновления учетных записей хранилища](../common/storage-account-upgrade.md).

**Можно ли применять политику хранения на основе времени и удержание по юридическим причинам?**

Да, в то же время контейнер может иметь удержание по юридическим причинам и политику хранения на основе времени. Все большие двоичные объекты в этом контейнере остаются в неизменяемом состоянии, пока все юридические удержания не будут сняты, даже если период эффективного хранения истек. И наоборот, большой двоичный объект остается в неизменяемом состоянии до тех пор, пока не истечет период эффективного хранения, хотя все юридические удержания сняты.

**— Это удержание по юридическим причинам политики только для судебного разбирательства или существуют другие сценарии использования?**

Нет, юридические хранения — это просто общий термин, используемый для политики хранения не по времени. Необходимо использовать только для судебного процесса связанные материалы. Юридические политики блокировки можно использовать для отключения перезаписи и удаления по защите важных корпоративных данных вирус-ЧЕРВЬ, где срок неизвестен. Вы можете использовать его как политики предприятия для защитить ваши критически важные вирус-ЧЕРВЬ рабочие нагрузки или использовать его в качестве промежуточной политики, прежде чем триггер пользовательское событие требует применения политики хранения на основе времени. 

**Можно удалить *заблокирован* политику хранения на основе времени или удержание по юридическим причинам?**

Только политики разблокирован хранение на основе времени можно удалить из контейнера. После блокировки политику хранения на основе времени его нельзя удалить; только действующие срок разрешены расширения. Можно удалить теги удержание по юридическим причинам. При удалении все допустимые теги, удаляется удержание по юридическим причинам.

**Что произойдет при попытке удалить контейнер с *заблокированной* политикой хранения на основе времени или юридическим удержанием?**

Операция "Удалить контейнер" не будет выполнена, если в контейнере существует хотя бы один большой двоичный объект с заблокированной политикой хранения на основе времени или юридическим удержанием. Операция "Удалить контейнер" выполнится, если не существует большого двоичного объекта с действующим интервалом периода удержания и нет юридических удержаний. Прежде чем удалить контейнер, необходимо сначала удалить большие двоичные объекты.

**Что произойдет при попытке удалить учетную запись хранения с WORM-контейнером, который имеет *заблокированную* политику хранения на основе времени или юридическое удержание?**

Удаление учетной записи хранилища не будет выполнено, если там присутствует хотя бы один WORM-контейнер с юридическим удержанием или BLOB-объект с действующим интервалом периода удержания. Прежде чем удалить учетную запись хранения, необходимо сначала удалить все контейнеры WORM. Сведения об удалении контейнера см. в предыдущем вопросе.

**Можно ли перемещать данные по различным уровням BLOB-объектов (горячий, прохладный и холодный уровень доступа), когда он находится в неизменяемом состоянии?**

Да, можно использовать команду установки уровня BLOB-объектов для перемещения данных уровней BLOB-объектов, сохраняя данные в совместимые неизменяемое состояние. Функция хранения данных в неизменяемом виде в хранилище поддерживается на горячем, холодном и архивном уровнях хранения больших двоичных объектов.

**Что произойдет, если не внести оплату, при том что срок интервала периода удержания еще не истек?**

В случае неоплаты будут применяться обычные правила хранения данных в соответствии с условиями, указанными в условиях вашего контракта с корпорацией Майкрософт.

**Предлагаете ли вы пробный или льготный период, чтобы просто попробовать эту функцию?**

Да. При создании политики хранения на основе времени, он находится в *разблокирован* состояния. В этом состоянии можно вносить любые нужные изменения, например увеличение или уменьшение, и даже удаление политики. После блокировки политика остается заблокированной до истечения периода удержания. Эта заблокированные политика запрещает удаление и изменение периода хранения. Мы настоятельно рекомендуем использовать *разблокированное* состояние только для пробных целей и заблокировать политику в течение 24 часов, чтобы не подвергать риску соответствие требованиям SEC 17a-4(f) и другим нормам.

**Можно ли использовать обратимое удаление вместе с политиками неизменяемых BLOB-объектов?**

Да. [Обратимое удаление для хранилища BLOB-объектов Azure](storage-blob-soft-delete.md) применяется для всех контейнеров в учетной записи хранения независимо от того, удержание по юридическим причинам или политику хранения на основе времени. Мы рекомендуем включить обратимое удаление для усиления защиты, прежде чем политикам неизменяемый вирус-ЧЕРВЬ применяются и подтверждено. 

**Где доступна функция?**

Неизменяемое хранилище доступно в общедоступных регионах Azure, Azure для Китая и государственных организаций. Если неизменяемый хранилище недоступно в вашем регионе, обратитесь в службу поддержки и адрес электронной почты azurestoragefeedback@microsoft.com.

## <a name="sample-powershell-code"></a>Пример кода PowerShell

[!INCLUDE [updated-for-az](../../../includes/updated-for-az.md)]

Пример сценария PowerShell ниже приводится для справки. Он создает учетную запись хранения и контейнер. Далее в нем показано, как задавать и снимать юридические удержания, создавать и блокировать политику хранения на основе времени (известную как неизменяемая политика), а также продлевать интервал хранения.

Настройка и тестирование учетной записи хранения Azure:

```powershell
$ResourceGroup = "<Enter your resource group>”
$StorageAccount = "<Enter your storage account name>"
$container = "<Enter your container name>"
$container2 = "<Enter another container name>”
$location = "<Enter the storage account location>"

# Log in to the Azure Resource Manager account
Login-AzAccount
Register-AzResourceProvider -ProviderNamespace "Microsoft.Storage"

# Create your Azure resource group
New-AzResourceGroup -Name $ResourceGroup -Location $location

# Create your Azure storage account
New-AzStorageAccount -ResourceGroupName $ResourceGroup -StorageAccountName `
    $StorageAccount -SkuName Standard_LRS -Location $location -Kind StorageV2

# Create a new container
New-AzStorageContainer -ResourceGroupName $ResourceGroup `
    -StorageAccountName $StorageAccount -Name $container

# Create Container 2 with a storage account object
$accountObject = Get-AzStorageAccount -ResourceGroupName $ResourceGroup `
    -StorageAccountName $StorageAccount
New-AzStorageContainer -StorageAccount $accountObject -Name $container2

# Get a container
Get-AzStorageContainer -ResourceGroupName $ResourceGroup `
    -StorageAccountName $StorageAccount -Name $container

# Get a container with an account object
$containerObject = Get-AzStorageContainer -StorageAccount $accountObject -Name $container

# List containers
Get-AzStorageContainer -ResourceGroupName $ResourceGroup `
    -StorageAccountName $StorageAccount

# Remove a container (add -Force to dismiss the prompt)
Remove-AzStorageContainer -ResourceGroupName $ResourceGroup `
    -StorageAccountName $StorageAccount -Name $container2

# Remove a container with an account object
Remove-AzStorageContainer -StorageAccount $accountObject -Name $container2

# Remove a container with a container object
$containerObject2 = Get-AzStorageContainer -StorageAccount $accountObject -Name $container2
Remove-AzStorageContainer -InputObject $containerObject2
```

Установка и удаление юридических удержаний:

```powershell
# Set a legal hold
Add-AzRmStorageContainerLegalHold -ResourceGroupName $ResourceGroup `
    -StorageAccountName $StorageAccount -Name $container -Tag <tag1>,<tag2>,...

# with an account object
Add-AzRmStorageContainerLegalHold -StorageAccount $accountObject -Name $container -Tag <tag3>

# with a container object
Add-AzRmStorageContainerLegalHold -Container $containerObject -Tag <tag4>,<tag5>,...

# Clear a legal hold
Remove-AzRmStorageContainerLegalHold -ResourceGroupName $ResourceGroup `
    -StorageAccountName $StorageAccount -Name $container -Tag <tag2>

# with an account object
Remove-AzRmStorageContainerLegalHold -StorageAccount $accountObject -Name $container -Tag <tag3>,<tag5>

# with a container object
Remove-AzRmStorageContainerLegalHold -Container $containerObject -Tag <tag4>
```

Создание или обновление политик неизменяемости:
```powershell
# with an account name or container name
Set-AzRmStorageContainerImmutabilityPolicy -ResourceGroupName $ResourceGroup `
    -StorageAccountName $StorageAccount -ContainerName $container -ImmutabilityPeriod 10

# with an account object
Set-AzRmStorageContainerImmutabilityPolicy -StorageAccount $accountObject `
    -ContainerName $container -ImmutabilityPeriod 1 -Etag $policy.Etag

# with a container object
$policy = Set-AzRmStorageContainerImmutabilityPolicy -Container `
    $containerObject -ImmutabilityPeriod 7

# with an immutability policy object
Set-AzRmStorageContainerImmutabilityPolicy -ImmutabilityPolicy $policy -ImmutabilityPeriod 5
```

Извлечение политик неизменяемости:
```powershell
# Get an immutability policy
Get-AzRmStorageContainerImmutabilityPolicy -ResourceGroupName $ResourceGroup `
    -StorageAccountName $StorageAccount -ContainerName $container

# with an account object
Get-AzRmStorageContainerImmutabilityPolicy -StorageAccount $accountObject `
    -ContainerName $container

# with a container object
Get-AzRmStorageContainerImmutabilityPolicy -Container $containerObject
```

Блокировка политик неизменяемости (добавление Force для отклонения запроса):
```powershell
# with an immutability policy object
$policy = Get-AzRmStorageContainerImmutabilityPolicy -ResourceGroupName `
    $ResourceGroup -StorageAccountName $StorageAccount -ContainerName $container
$policy = Lock-AzRmStorageContainerImmutabilityPolicy -ImmutabilityPolicy $policy -force

# with an account name or container name
$policy = Lock-AzRmStorageContainerImmutabilityPolicy -ResourceGroupName `
    $ResourceGroup -StorageAccountName $StorageAccount -ContainerName $container `
    -Etag $policy.Etag

# with an account object
$policy = Lock-AzRmStorageContainerImmutabilityPolicy -StorageAccount `
    $accountObject -ContainerName $container -Etag $policy.Etag

# with a container object
$policy = Lock-AzRmStorageContainerImmutabilityPolicy -Container `
    $containerObject -Etag $policy.Etag -force
```

Расширение политик неизменяемости:
```powershell

# with an immutability policy object
$policy = Get-AzRmStorageContainerImmutabilityPolicy -ResourceGroupName `
    $ResourceGroup -StorageAccountName $StorageAccount -ContainerName $container

$policy = Set-AzRmStorageContainerImmutabilityPolicy -ImmutabilityPolicy `
    $policy -ImmutabilityPeriod 11 -ExtendPolicy

# with an account name or container name
$policy = Set-AzRmStorageContainerImmutabilityPolicy -ResourceGroupName `
    $ResourceGroup -StorageAccountName $StorageAccount -ContainerName $container `
    -ImmutabilityPeriod 11 -Etag $policy.Etag -ExtendPolicy

# with an account object
$policy = Set-AzRmStorageContainerImmutabilityPolicy -StorageAccount `
    $accountObject -ContainerName $container -ImmutabilityPeriod 12 -Etag `
    $policy.Etag -ExtendPolicy

# with a container object
$policy = Set-AzRmStorageContainerImmutabilityPolicy -Container `
    $containerObject -ImmutabilityPeriod 13 -Etag $policy.Etag -ExtendPolicy
```

Удаление политики неизменяемости разблокирован (add - Force, чтобы закрыть командной строке):
```powershell
# with an immutability policy object
$policy = Get-AzRmStorageContainerImmutabilityPolicy -ResourceGroupName `
    $ResourceGroup -StorageAccountName $StorageAccount -ContainerName $container
Remove-AzRmStorageContainerImmutabilityPolicy -ImmutabilityPolicy $policy

# with an account name or container name
Remove-AzRmStorageContainerImmutabilityPolicy -ResourceGroupName `
    $ResourceGroup -StorageAccountName $StorageAccount -ContainerName $container `
    -Etag $policy.Etag

# with an account object
Remove-AzRmStorageContainerImmutabilityPolicy -StorageAccount $accountObject `
    -ContainerName $container -Etag $policy.Etag

# with a container object
Remove-AzRmStorageContainerImmutabilityPolicy -Container $containerObject `
    -Etag $policy.Etag

```
