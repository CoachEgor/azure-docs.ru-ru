---
title: Обзор версий среды выполнения для решения "Функции Azure"
description: Решение "Функции Azure" поддерживает разные версии среды выполнения. В этой статье приводятся различия между ними и рекомендации по выбору подходящей для вас версии.
author: ggailey777
manager: gwallace
ms.service: azure-functions
ms.topic: conceptual
ms.date: 10/10/2019
ms.author: glenga
ms.openlocfilehash: 9ca7006bb842cbe235d2e982e611613e1fd74ed9
ms.sourcegitcommit: b4f201a633775fee96c7e13e176946f6e0e5dd85
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/18/2019
ms.locfileid: "72597381"
---
# <a name="azure-functions-runtime-versions-overview"></a>Обзор версий среды выполнения для решения "Функции Azure"

Основные версии среды выполнения функций Azure связаны с версией .NET, на которой основана среда выполнения. В следующей таблице указывается текущая версия среды выполнения, уровень выпуска и связанная версия .NET. 

| Версия среды выполнения | Уровень выпуска<sup>1</sup> | Версия .NET | 
| --------------- | ------------- | ------------ |
| 3.x  | предварительная версия | .NET Core 3. x | 
| 2.x | Общая доступность | .NET Core 2.2 |
| 1.x | Общедоступная версия<sup>2</sup> | .NET Framework 4,6<sup>3</sup> |

<sup>1</sup> В рабочих сценариях поддерживаются общедоступные версии.   
<sup>2</sup> Версия 1. x находится в режиме обслуживания. Усовершенствования предоставляются только в более поздних версиях.   
<sup>3</sup> Поддерживает только разработку на портал Azure или локально на компьютерах Windows.

>[!NOTE]  
> Версия 3. x среды выполнения функций доступна в режиме предварительной версии и не поддерживается в рабочих средах. Дополнительные сведения об попытке выполнить версию 3. x см. в [этом объявлении](https://dev.to/azure/develop-azure-functions-using-net-core-3-0-gcm).

В этой статье описаны некоторые различия между различными версиями, способы создания каждой версии и изменения версий.

## <a name="languages"></a>Языки

Начиная с версии 2. x, среда выполнения использует модель расширяемости языка, и все функции в приложении-функции должны использовать один и тот же язык. Язык функций в приложении-функции выбирается при создании приложения и сохраняется в параметрах [\_WORKER \_RUNTIME](functions-app-settings.md#functions_worker_runtime) . 

Функции Azure 1. x экспериментальные языки не могут использовать новую модель, поэтому они не поддерживаются в 2. x. В следующей таблице перечислены языки программирования, которые в настоящее время поддерживаются для каждой версии среды выполнения.

[!INCLUDE [functions-supported-languages](../../includes/functions-supported-languages.md)]

Дополнительные сведения см. в [списке поддерживаемых языков](supported-languages.md).

## <a name="creating-1x-apps"></a>Запуск в определенной версии

По умолчанию приложения функций, созданные в портал Azure и Azure CLI, имеют значение версии 2. x. По возможности следует использовать эту версию среды выполнения. Но если нужно, вы еще может выполнять приложения-функции в среде выполнения версии 1.x. Версию среды выполнения следует менять только после создания приложения-функции, но до добавления в него функций. Чтобы узнать, как закрепить версию 1.x для среды выполнения, изучите статью [Выбор целевых версий среды выполнения Функций Azure](set-runtime-version.md#view-and-update-the-current-runtime-version).

Кроме того, можно выполнить обновление до версии 3. x среды выполнения, которая находится на этапе предварительного просмотра. Это необходимо сделать, если вам нужно иметь возможность выполнять функции в .NET Core 3. x. Сведения об обновлении до 3. x см. в статье [Просмотр и обновление текущей версии среды выполнения](set-runtime-version.md#view-and-update-the-current-runtime-version).

## <a name="migrating-from-1x-to-later-versions"></a>Переход с версии 1. x на более позднюю версию

Вы можете перенести существующее приложение, написанное для среды выполнения версии 1.x, на новую версию 2.x. Большинство изменений, которые нужно внести в этом случае, связаны с языковой средой выполнения, например с различиями API C# между версиями для .NET Framework 4.7 и .NET Core 2. Также нужно убедиться, что код и библиотеки совместимы с выбранными языковыми средами выполнения. И наконец, обязательно обратите внимание на все изменения в триггерах, привязках и функциях, указанные ниже. Чтобы миграция прошла идеально, создайте новое приложение-функцию для версии 2.x и портируйте код существующей функции версии 1.x в новое приложение.  

### <a name="changes-in-triggers-and-bindings"></a>Изменения в триггерах и привязках

Для версии 2.x вам потребуется установить расширения для конкретных триггеров и привязок, которые используются функциями вашего приложения. Единственное исключение — триггеры HTTP и таймера, для которых не требуется расширение.  Для получения дополнительной информации ознакомьтесь с разделом [Регистрация расширений привязки](./functions-bindings-register.md).

Также при смене версий были внесены некоторые изменения в `function.json` или атрибуты функций. Например, свойство `path` для концентратора событий теперь имеет атрибут `eventHubName`. Для получения ссылок на документацию для каждой привязки см. [таблицу существующих привязок](#bindings).

### <a name="changes-in-features-and-functionality"></a>Изменения в функциях и возможностях

Некоторые возможности в новой версии удалены, обновлены или заменены. В этом разделе описаны изменения, которые вы заметите в версии 2.x после использования версии 1.x.

В версии 2.x внесены следующие изменения.

* Ключи для вызова конечных точек HTTP всегда хранятся в зашифрованном виде в хранилище BLOB-объектов Azure. В версии 1.x эти ключи по умолчанию хранились в хранилище файлов Azure. При обновлении приложения с версии 1.x до версии 2.x выполняется сброс существующих секретных данных, которые находятся в хранилище файлов.

* Среда выполнения версии 2.x не имеет встроенной поддержки для поставщиков веб-перехватчиков. Это изменение внесено для повышения производительности. Вы по-прежнему можете использовать HTTP-триггеры как конечные точки для веб-перехватчиков.

* Файл конфигурации узла (host.json) должен быть пустым или содержать строку `"version": "2.0"`.

* Чтобы улучшить мониторинг, панель веб-заданий на портале с параметром [`AzureWebJobsDashboard`](functions-app-settings.md#azurewebjobsdashboard) замерена Azure Application Insights с параметром [`APPINSIGHTS_INSTRUMENTATIONKEY`](functions-app-settings.md#appinsights_instrumentationkey). Дополнительные сведения см. в разделе [Мониторинг функций Azure](functions-monitoring.md).

* Все функции в приложении-функции должны использовать один язык. При создании приложения-функции необходимо выбрать для приложения стек среды выполнения. Стек среды выполнения указан значением [`FUNCTIONS_WORKER_RUNTIME`](functions-app-settings.md#functions_worker_runtime) в параметрах приложения. Это требование добавлено для уменьшения занимаемого места и ускорения запуска. При локальной разработке также необходимо включить этот параметр в [файл local.settings.json](functions-run-local.md#local-settings-file).

* По умолчанию для функций в плане службы приложений устанавливается время ожидания 30 минут. Вы можете вручную снять это ограничение, изменив параметр [functionTimeout](functions-host-json.md#functiontimeout) в файле host.json.

* Регулирование параллельной обработки HTTP по умолчанию применяется для функций плана потребления, по умолчанию допуская не более 100 одновременных запросов на один экземпляр. Этот параметр можно изменить в параметре [`maxConcurrentRequests`](functions-host-json.md#http) файла host.json.

* Из-за [ограничений .NET Core](https://github.com/Azure/azure-functions-host/issues/3414) удалена поддержка функций в виде скриптов F# (.fsx). Скомпилированные функции F# (.fs) по-прежнему поддерживаются.

* Для веб-перехватчиков триггера сетки событий формат URL-адреса изменен на `https://{app}/runtime/webhooks/{triggerName}`.

### <a name="migrating-a-locally-developed-application"></a>Миграция локально разработанного приложения

Возможно, у вас есть существующие проекты приложений-функций, локально разработанные для среды выполнения версии 1.x. Чтобы обновить их до версии 2.x, создайте локальный проект приложения-функции для версии 2.x и портируйте существующий код в новое приложение. Вы также можете обновить существующий проект и код "на месте", без создания нового проекта. Но в этом случае может потребоваться вручную применить ряд других улучшений, которые различают версии 1.x и 2.x. Например, в C# объект отладки изменен с `TraceWriter` на `ILogger`. Создавая новый проект версии 2.x, вы сразу получаете обновленные функции, основанные на самых свежих шаблонах для версии 2.x.

#### <a name="visual-studio-runtime-versions"></a>Версии среды выполнения Visual Studio

В Visual Studio вы выбираете версию среды выполнения при создании проекта. Средства Функций Azure для Visual Studio поддерживают обе основные версии среды выполнения. При отладке и публикации правильная версия применяется автоматически на основе настроек проекта. Параметры версии определяются в файле `.csproj` в следующих свойствах:

##### <a name="version-1x"></a>Версия 1.x

```xml
<TargetFramework>net461</TargetFramework>
<AzureFunctionsVersion>v1</AzureFunctionsVersion>
```

##### <a name="version-2x"></a>Версия 2.x

```xml
<TargetFramework>netcoreapp2.2</TargetFramework>
<AzureFunctionsVersion>v2</AzureFunctionsVersion>
```

При отладке или публикации проекта используется правильная версия среды выполнения.

#### <a name="vs-code-and-azure-functions-core-tools"></a>Основные инструменты VS Code и Функций Azure

[Основные инструменты службы функции Azure](functions-run-local.md) используются для разработки из командной строки, а также в [расширении Функций Azure](https://marketplace.visualstudio.com/items?itemName=ms-azuretools.vscode-azurefunctions) для Visual Studio Code. Чтобы вести разработку для версии 2.x, установите версию 2.x основных инструментов. Разработка для версии 1.x требует наличия версии 1.x основных инструментов. Дополнительные сведения см. в разделе [Установка основных инструментов Функций Azure](functions-run-local.md#install-the-azure-functions-core-tools).

Для разработки в Visual Studio Code следует также изменить параметры пользователя, чтобы `azureFunctions.projectRuntime` соответствовал версии установленных инструментов.  Этот параметр также обновляет шаблоны и языки, используемые при создании приложения-функции.

### <a name="changing-version-of-apps-in-azure"></a>Изменение версии приложений в Azure

Версия среды выполнения для Функций Azure, используемая опубликованными в Azure приложениями, зависит от параметра приложения [`FUNCTIONS_EXTENSION_VERSION`](functions-app-settings.md#functions_extension_version). Значение `~2` обозначает среду выполнения версии 2.x, а `~1` — среду выполнения версии 1.x. Не изменяйте этот параметр без веских причин, поскольку это потребует и других изменений в параметрах приложения и коде функций. Дополнительные сведения о рекомендациях по миграции приложения-функции на другую версию среды выполнения см. в статье [Выбор целевых версий среды выполнения Функций Azure](set-runtime-version.md).

## <a name="bindings"></a>Привязки

Начиная с версии 2. x среда выполнения использует новую [модель расширяемости привязки](https://github.com/Azure/azure-webjobs-sdk-extensions/wiki/Binding-Extensions-Overview) , которая предоставляет следующие преимущества:

* Поддержка сторонних расширений привязок.

* Разделение среды выполнения и привязок. Это изменение позволяет отдельно управлять версиями расширений привязок и выпускать эти расширения. Например, можно выполнить обновление до версии расширения на основе более новой версии базового пакета SDK.

* Менее ресурсоемкая среда выполнения, где в среде выполнения известны только используемые привязки и только они загружаются в нее.

За исключением триггеров HTTP и таймера, все привязки теперь необходимо вручную добавлять в проект приложения-функции или регистрировать на портале. Для получения дополнительной информации ознакомьтесь с разделом [Регистрация расширений привязки](./functions-bindings-expressions-patterns.md).

В следующей таблице перечислены поддерживаемые привязки для каждой версии среды выполнения.

[!INCLUDE [Full bindings table](../../includes/functions-bindings.md)]

[!INCLUDE [Timeout Duration section](../../includes/functions-timeout-duration.md)]

## <a name="next-steps"></a>Дальнейшие действия

Для получения дополнительных сведений см. следующие ресурсы:

* [Как программировать и тестировать функции Azure в локальной среде](functions-run-local.md)
* [Выбор целевых версий среды выполнения Функций Azure](set-runtime-version.md)
* [Заметки о выпуске](https://github.com/Azure/azure-functions-host/releases)
