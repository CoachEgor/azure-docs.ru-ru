---
title: Способы устранения неполадок, связанных с недоступностью среды выполнения Функций Azure.
description: Узнайте, как устранять неполадки, связанные с недопустимой учетной записью хранения.
author: alexkarcher-msft
ms.topic: article
ms.date: 09/05/2018
ms.author: alkarche
ms.openlocfilehash: 40037252ddf8e505ae7fe734813d598e7de96336
ms.sourcegitcommit: f53cd24ca41e878b411d7787bd8aa911da4bc4ec
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/10/2020
ms.locfileid: "75834238"
---
# <a name="how-to-troubleshoot-functions-runtime-is-unreachable"></a>Способы устранения неполадок, связанных с недоступностью среды выполнения функций.


## <a name="error-text"></a>Текст сообщения об ошибке
Эта статья предназначена для устранения следующих ошибок при отображении на портале функций.

`Error: Azure Functions Runtime is unreachable. Click here for details on storage configuration`

### <a name="summary"></a>Сводка
Эта проблема возникает, когда среду выполнения Функций Azure не удается запустить. Наиболее распространенная причина возникновения этой ошибки связана с тем, что приложение-функция теряет доступ к учетной записи хранения. Дополнительные сведения см. в разделе [Требования к учетной записи хранения](https://docs.microsoft.com/azure/azure-functions/functions-create-function-app-portal#storage-account-requirements).

### <a name="troubleshooting"></a>Устранение неисправностей
Мы рассмотрим четыре наиболее часто встречающиеся ошибки, метод их определения и способы устранения в каждом случае.

1. Учетная запись хранения удалена.
1. Удалены параметры приложения учетной записи хранения.
1. Недопустимые учетные данные учетной записи хранения.
1. Учетная запись хранения недоступна.
1. Исчерпана квота на дневное выполнение
1. Приложение находится за брандмауэром


## <a name="storage-account-deleted"></a>Учетная запись хранения удалена

Для работы каждого приложения-функции нужна учетная запись хранения. Если эта учетная запись удалена, Функция не будет работать.

### <a name="how-to-find-your-storage-account"></a>Как найти учетную запись хранения

Начните с поиска имени учетной записи хранения в параметрах приложения. Параметр `AzureWebJobsStorage` или `WEBSITE_CONTENTAZUREFILECONNECTIONSTRING` будет содержать имя учетной записи хранения, заключенное в строку подключения. Дополнительные сведения см. в [справочнике по параметрам приложения](https://docs.microsoft.com/azure/azure-functions/functions-app-settings#azurewebjobsstorage).

Выполните поиск учетной записи хранения на портале Azure, чтобы проверить, существует ли она. Если она удалена, необходимо повторно создать учетную запись хранения и заменить строки подключения хранилища. Код функции будет потерян, и вам потребуется развернуть его повторно.

## <a name="storage-account-application-settings-deleted"></a>Удалены параметры приложения учетной записи хранения

На предыдущем шаге, если у вас нет строки подключения учетной записи хранения, она, скорее всего, была удалена или перезаписана. Удаление параметров приложения чаще всего происходит при использовании слотов развертывания или сценариев Azure Resource Manager для настройки параметров приложения.

### <a name="required-application-settings"></a>Необходимые параметры приложения

* Обязательно для заполнения
    * [`AzureWebJobsStorage`](https://docs.microsoft.com/azure/azure-functions/functions-app-settings#azurewebjobsstorage)
* Обязательные для Функций плана потребления:
    * [`WEBSITE_CONTENTAZUREFILECONNECTIONSTRING`](https://docs.microsoft.com/azure/azure-functions/functions-app-settings)
    * [`WEBSITE_CONTENTSHARE`](https://docs.microsoft.com/azure/azure-functions/functions-app-settings)

[Дополнительные сведения об этих параметрах приложения](https://docs.microsoft.com/azure/azure-functions/functions-app-settings)см. здесь.

### <a name="guidance"></a>Руководство

* Не устанавливайте флажок "Параметр слота" для любого из этих параметров. При переключении слотов развертывания Функция будет нарушена.
* Не изменяйте эти параметры как часть автоматизированных развертываний.
* Эти параметры должны быть указаны и допустимы во время создания. Если в автоматическом развертывании нет этих параметров, это приведет к неработоспособности приложения, даже если параметры будут добавлены позже.

## <a name="storage-account-credentials-invalid"></a>Недопустимые учетные данные учетной записи хранения

При повторном создании ключей хранилища необходимо обновить указанные выше строки подключения учетной записи хранения. [Дополнительные сведения об управлении ключами хранилища](https://docs.microsoft.com/azure/storage/common/storage-create-storage-account)см. здесь.

## <a name="storage-account-inaccessible"></a>Учетная запись хранения недоступна

Приложение-функция должно иметь доступ к учетной записи хранения. Ниже приведены распространенные проблемы, которые блокируют доступ Функций к учетной записи хранения:

* Приложения-функции развернуты в средах службы приложений без правильных правил сети, разрешающих передачу исходящего и входящего трафика учетной записи хранения.
* Брандмауэр учетной записи хранения включен и не настроен разрешать передачу трафика из службы "Функции" и в нее. Дополнительные сведения о настройке брандмауэра учетной записи хранения см. в статье [Настройка брандмауэров службы хранилища Azure и виртуальных сетей](https://docs.microsoft.com/azure/storage/common/storage-network-security?toc=%2fazure%2fstorage%2ffiles%2ftoc.json).

## <a name="daily-execution-quota-full"></a>Исчерпана квота на дневное выполнение

Если у вас настроена квота на дневное выполнение, приложение-функция будет временно отключено и многие элементы управления портала станут недоступными. 

* Чтобы проверить, откройте функции платформы > Параметры приложение-функция на портале. Если превышена квота, вы увидите следующее сообщение:
    * `The Function App has reached daily usage quota and has been stopped until the next 24 hours time frame.`
* Удалите квоту и перезапустите приложение, чтобы устранить проблему.

## <a name="app-is-behind-a-firewall"></a>Приложение находится за брандмауэром

Среда выполнения функции будет недоступна, если приложение-функция размещается в [Среда службы приложений с балансировкой нагрузки с внутренней нагрузкой](../app-service/environment/create-ilb-ase.md) и настроено для блокировки входящего интернет-трафика, или для него настроены [Входящие ограничения IP](functions-networking-options.md#inbound-ip-restrictions) для блокировки доступа к Интернету. Портал Azure выполняет вызовы непосредственно в работающее приложение для выборки списка функций, а также выполняет HTTP-вызовы к конечной точке KUDU. Параметры уровня платформы на вкладке "`Platform Features`" будут по-прежнему доступны.

* Чтобы проверить конфигурацию ASE, перейдите к NSG подсети, в которой находится ASE, и проверьте правила входящего трафика, чтобы разрешить трафик, поступающий с общедоступного IP-адреса компьютера, на котором выполняется доступ к приложению. Вы также можете использовать портал на компьютере, подключенном к виртуальной сети, где работает приложение, или в виртуальной машине, работающей в виртуальной сети. [Дополнительные сведения о конфигурации правил для входящих подключений см. здесь.](https://docs.microsoft.com/azure/app-service/environment/network-info#network-security-groups)

## <a name="next-steps"></a>Следующие шаги

Теперь, когда приложение-функция опять работоспособно, ознакомьтесь с нашими справочниками для разработчиков, чтобы продолжить работу приложения.

* [Создание первой функции Azure](functions-create-first-azure-function.md)  
  Приступите к созданию первой функции с помощью быстрой настройки Функций Azure. 
* [Справочник разработчика по функциям Azure](functions-reference.md)  
  Дополнительные технические сведения о среде выполнения Функций Azure, а также справочник по программированию функций и определению триггеров и привязок.
* [Тестирование функций Azure](functions-test-a-function.md)  
  (Тестирование функций Azure) Описание различных средств и методов тестирования функций.
* [Масштабирование функций Azure](functions-scale.md)  
  Обсуждение планов обслуживания, доступных для использования с функциями Azure (включая план потребления), а также выбор подходящего плана. 
* [Дополнительные сведения о службе приложений Azure](../app-service/overview.md)  
  Служба "Функции Azure" использует службу приложений Azure для таких базовых операций, как развертывание, диагностика и использование переменных среды. 
