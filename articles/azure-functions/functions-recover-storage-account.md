---
title: Способы устранения неполадок, связанных с недоступностью среды выполнения Функций Azure.
description: Узнайте, как устранять неполадки, связанные с недопустимой учетной записью хранения.
author: alexkarcher-msft
ms.topic: article
ms.date: 09/05/2018
ms.author: alkarche
ms.openlocfilehash: 910b582cb40b9f8aff6a553621b4677d6b019826
ms.sourcegitcommit: 42517355cc32890b1686de996c7913c98634e348
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/02/2020
ms.locfileid: "76963892"
---
# <a name="how-to-troubleshoot-functions-runtime-is-unreachable"></a>Способы устранения неполадок, связанных с недоступностью среды выполнения функций.

Эта статья предназначена для устранения неполадок при отображении в портал Azure сообщения об ошибке "Среда выполнения функций недоступна". При возникновении этой ошибки на портале появится следующая строка ошибки.

`Error: Azure Functions Runtime is unreachable. Click here for details on storage configuration`

Это происходит, когда не удается запустить среда выполнения Функций Azure. Наиболее распространенная причина возникновения этой ошибки связана с тем, что приложение-функция теряет доступ к учетной записи хранения. Дополнительные сведения см. в статье [требования к учетной записи хранения](storage-considerations.md#storage-account-requirements).

Оставшаяся часть этой статьи поможет устранить следующие причины этой ошибки, в том числе способ определения и разрешения каждого случая.

+ [Учетная запись хранения удалена](#storage-account-deleted)
+ [Удалены параметры приложения учетной записи хранения](#storage-account-application-settings-deleted)
+ [Недопустимые данные для входа в учетную запись хранения](#storage-account-credentials-invalid)
+ [Учетная запись хранения недоступна](#storage-account-inaccessible)
+ [Превышена квота ежедневного выполнения](#daily-execution-quota-full)
+ [Приложение находится за брандмауэром](#app-is-behind-a-firewall)


## <a name="storage-account-deleted"></a>Учетная запись хранения удалена

Для работы каждого приложения-функции нужна учетная запись хранения. Если эта учетная запись удалена, Функция не будет работать.

### <a name="how-to-find-your-storage-account"></a>Как найти учетную запись хранения

Начните с поиска имени учетной записи хранения в параметрах приложения. Параметр `AzureWebJobsStorage` или `WEBSITE_CONTENTAZUREFILECONNECTIONSTRING` будет содержать имя учетной записи хранения, заключенное в строку подключения. Дополнительные сведения см. в [справочнике по параметрам приложения](https://docs.microsoft.com/azure/azure-functions/functions-app-settings#azurewebjobsstorage).

Выполните поиск учетной записи хранения на портале Azure, чтобы проверить, существует ли она. Если она удалена, необходимо повторно создать учетную запись хранения и заменить строки подключения хранилища. Код функции будет потерян, и вам потребуется развернуть его повторно.

## <a name="storage-account-application-settings-deleted"></a>Удалены параметры приложения учетной записи хранения

На предыдущем шаге, если у вас нет строки подключения учетной записи хранения, она, скорее всего, была удалена или перезаписана. Удаление параметров приложения чаще всего происходит при использовании слотов развертывания или сценариев Azure Resource Manager для настройки параметров приложения.

### <a name="required-application-settings"></a>Необходимые параметры приложения

* Обязательно для заполнения
    * [`AzureWebJobsStorage`](https://docs.microsoft.com/azure/azure-functions/functions-app-settings#azurewebjobsstorage)
* Обязательные для Функций плана потребления:
    * [`WEBSITE_CONTENTAZUREFILECONNECTIONSTRING`](https://docs.microsoft.com/azure/azure-functions/functions-app-settings)
    * [`WEBSITE_CONTENTSHARE`](https://docs.microsoft.com/azure/azure-functions/functions-app-settings)

[Дополнительные сведения об этих параметрах приложения](https://docs.microsoft.com/azure/azure-functions/functions-app-settings)см. здесь.

### <a name="guidance"></a>Руководство

* Не устанавливайте флажок "параметр слота" для любого из этих параметров. При перестановке слотов развертывания приложение функции останавливается.
* Не изменяйте эти параметры как часть автоматизированных развертываний.
* Эти параметры должны быть указаны и допустимы во время создания. Автоматическое развертывание, которое не содержит этих параметров, приводит к невозможности запуска приложения-функции, даже если эти параметры будут добавлены позже.

## <a name="storage-account-credentials-invalid"></a>Недопустимые учетные данные учетной записи хранения

При повторном создании ключей хранилища необходимо обновить указанные выше строки подключения учетной записи хранения. [Дополнительные сведения об управлении ключами хранилища](https://docs.microsoft.com/azure/storage/common/storage-create-storage-account)см. здесь.

## <a name="storage-account-inaccessible"></a>Учетная запись хранения недоступна

Приложение функции должно иметь доступ к учетной записи хранения. Ниже приведены распространенные проблемы, которые блокируют доступ Функций к учетной записи хранения:

+ приложения-функции, развернутые в средах службы приложений (ASE) без правильных правил сети для разрешения входящего и исходящего трафика в учетной записи хранения.

+ Брандмауэр учетной записи хранения включен и не настроен для разрешения входящего и исходящего трафика функций. Подробнее см. в статье [Настройка брандмауэров службы хранилища Azure и виртуальных сетей (предварительная версия)](../storage/common/storage-network-security.md).

## <a name="daily-execution-quota-full"></a>Квота ежедневного выполнения заполнена

Если настроена квота ежедневного выполнения, приложение-функция временно отключено, что приводит к тому, что многие элементы управления портала становятся недоступными. 

+ Чтобы проверить [портал Azure](https://portal.azure.com), откройте **функции платформы** > **Параметры приложение-функция** в приложении функции. Когда вы настроили заданную **квоту на ежедневное использование** , вы увидите следующее сообщение:

    `The function app has reached daily usage quota and has been stopped until the next 24 hours time frame.`

+ Чтобы устранить эту проблему, удалите или увеличьте дневную квоту и перезапустите приложение. В противном случае выполнение приложения будет заблокировано до следующего дня.

## <a name="app-is-behind-a-firewall"></a>Приложение находится за брандмауэром

Среда выполнения функции будет недоступна, если приложение-функция размещается в [Среда службы приложений с балансировкой нагрузки с внутренней нагрузкой](../app-service/environment/create-ilb-ase.md) и настроено для блокировки входящего интернет-трафика, или для него настроены [Входящие ограничения IP](functions-networking-options.md#inbound-ip-restrictions) для блокировки доступа к Интернету. Портал Azure выполняет вызовы непосредственно в работающее приложение для выборки списка функций, а также выполняет HTTP-вызовы к конечной точке KUDU. Параметры уровня платформы на вкладке "`Platform Features`" будут по-прежнему доступны.

Чтобы проверить конфигурацию ASE, перейдите к NSG подсети, в которой находится ASE, и проверьте правила входящего трафика, чтобы разрешить трафик, поступающий с общедоступного IP-адреса компьютера, на котором выполняется доступ к приложению. Вы также можете использовать портал на компьютере, подключенном к виртуальной сети, где работает приложение, или в виртуальной машине, работающей в виртуальной сети. [Дополнительные сведения о конфигурации правил для входящих подключений см. здесь.](../app-service/environment/network-info.md#network-security-groups)

## <a name="next-steps"></a>Следующие шаги

Сведения о мониторинге приложений функции:

> [!div class="nextstepaction"]
> [Мониторинг функций Azure](functions-monitoring.md)
