---
title: Параметры сети функций Azure
description: Обзор всех возможностей сети, доступных в функциях Azure
author: alexkarcher-msft
manager: gwallace
ms.service: azure-functions
ms.topic: conceptual
ms.date: 4/11/2019
ms.author: alkarche
ms.openlocfilehash: bf5ce8da2ce62a5da821588c8f635bbab04dd3c1
ms.sourcegitcommit: 7efb2a638153c22c93a5053c3c6db8b15d072949
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/24/2019
ms.locfileid: "72881572"
---
# <a name="azure-functions-networking-options"></a>Параметры сети функций Azure

В этой статье описываются сетевые функции, доступные в различных вариантах размещения для функций Azure. Все перечисленные ниже сетевые параметры предоставляют некоторую возможность доступа к ресурсам без использования маршрутизируемых адресов через Интернет или ограничивают доступ к приложению-функции через Интернет.

Модели размещения имеют разные уровни сетевой изоляции. Выбор правильного варианта поможет удовлетворить требования к изоляции сети.

Размещать приложения-функции можно двумя способами:

* Существует набор параметров плана, которые выполняются в многоклиентской инфраструктуре с различными уровнями возможностей подключения и масштабирования виртуальной сети.
    * [План потребления](functions-scale.md#consumption-plan), который динамически масштабируется в ответ на загрузку и предлагает минимальные варианты сетевой изоляции.
    * [План Premium](functions-scale.md#premium-plan), который также динамически масштабируется, обеспечивая более широкие сетевые изоляции.
    * [План службы приложений](functions-scale.md#app-service-plan)Azure, который работает в фиксированном масштабе и предлагает план "Премиум", похожий на сетевую изоляцию.
* Функции можно запускать в [Среда службы приложений](../app-service/environment/intro.md). Этот метод развертывает функцию в виртуальной сети и обеспечивает полный контроль и изоляцию сети.

## <a name="matrix-of-networking-features"></a>Матрица сетевых компонентов

|                |[План потребления](functions-scale.md#consumption-plan)|[План Premium (Предварительная версия)](functions-scale.md#premium-plan)|[План обслуживания приложения](functions-scale.md#app-service-plan)|[Среда службы приложений](../app-service/environment/intro.md)|
|----------------|-----------|----------------|---------|-----------------------|  
|[Ограничения на входящие IP-адреса & доступ к частному сайту](#inbound-ip-restrictions)|✅Yes|✅Yes|✅Yes|✅Yes|
|[Интеграция с виртуальной сетью](#virtual-network-integration)|❌No|✅Yes (региональный)|✅Yes (региональный и шлюз)|✅Yes|
|[Триггеры виртуальной сети (не HTTP)](#virtual-network-triggers-non-http)|❌No| ❌No|✅Yes|✅Yes|
|[гибридных подключений](#hybrid-connections)|❌No|✅Yes|✅Yes|✅Yes|
|[Ограничения исходящих IP-адресов](#outbound-ip-restrictions)|❌No| ❌No|❌No|✅Yes|

## <a name="inbound-ip-restrictions"></a>Ограничения на входящие IP-адреса

Вы можете использовать ограничения IP-адресов, чтобы определить упорядоченный по приоритету IP-адреса, которым разрешен или запрещен доступ к вашему приложению. Список может содержать адреса IPv4 и IPv6. Если имеется одна или несколько записей, в конце списка существует неявный "Deny All". Ограничения IP-адресов работают со всеми вариантами размещения функций.

> [!NOTE]
> С учетом ограничений сети можно использовать только редактор портала в виртуальной сети или список разрешений IP-адрес компьютера, который используется для доступа к портал Azure. Тем не менее вы по-прежнему можете получить доступ к любым функциям на вкладке **функции платформы** на любом компьютере.

Дополнительные сведения см. в статье [ограничения статического доступа в службе приложений Azure](../app-service/app-service-ip-restrictions.md).

## <a name="private-site-access"></a>доступ к частным сайтам;

Доступ к частному сайту означает предоставление доступа к приложению только из частной сети, такой как из виртуальной сети Azure.

* Доступ к частному сайту доступен в плане " [премиум](./functions-premium-plan.md)", " [потребление](functions-scale.md#consumption-plan) " и " [служба приложений](functions-scale.md#app-service-plan) " при настройке **конечных точек службы** .
    * Конечные точки службы можно настроить для каждого приложения в разделе функции платформы > сети > настроить ограничения доступа > Добавить правило. Теперь в качестве типа правила можно выбрать виртуальные сети.
    * Дополнительные сведения см. в разделе [конечные точки службы виртуальной сети](../virtual-network/virtual-network-service-endpoints-overview.md) .
        * Помните, что при использовании конечных точек службы функция по-прежнему имеет полный исходящий доступ к Интернету, даже если настроена интеграция с виртуальной сетью.
* Доступ к частному сайту также доступен с Среда службы приложений, настроенной с внутренней подсистемой балансировки нагрузки (ILB). Дополнительные сведения см. в статье [Создание и использование внутренней подсистемы балансировки нагрузки с среда службы приложений](../app-service/environment/create-ilb-ase.md).

## <a name="virtual-network-integration"></a>Интеграция виртуальной сети

Интеграция виртуальной сети позволяет приложению-функции получить доступ к ресурсам в виртуальной сети. Эта функция доступна как в плане Premium, так и в плане службы приложений. Если приложение находится в Среда службы приложений, оно уже находится в виртуальной сети и не требует использования интеграции с виртуальной сетью для доступа к ресурсам в той же виртуальной сети.

С помощью интеграции с виртуальной сетью можно разрешить доступ из приложений к базам данных и веб-службам, работающим в виртуальной сети. Благодаря интеграции с виртуальной сетью вам не нужно предоставлять общедоступную конечную точку для приложений на виртуальной машине. Вместо этого можно использовать частные адреса, не использующие маршрутизацию в Интернете.

Существует две формы интеграции виртуальной сети:

+ **Интеграция с региональной виртуальной сетью (Предварительная версия)** : включает интеграцию с виртуальными сетями в одном регионе. Для этого типа интеграции требуется подсеть в виртуальной сети в том же регионе. Эта функция по-прежнему доступна в предварительной версии, но она поддерживается для приложений-функций, работающих в Windows, с предупреждениями, указанными ниже.
+ **Интеграция виртуальной сети, требующая шлюза**: включает интеграцию с виртуальными сетями в удаленных регионах или с классическими виртуальными сетями. Для этого типа интеграции требуется развертывание шлюза виртуальной сети в виртуальной сети. Это функция на основе VPN типа "точка — сеть", которая поддерживается только для приложений-функций, работающих в Windows.

Приложение может использовать только один тип функции интеграции с виртуальной сетью за раз. Хотя оба варианта полезны во многих сценариях, в следующей таблице показано, где следует использовать:

| Проблема  | Решение |
|----------|----------|
| Хотите обратиться к адресу RFC 1918 (10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16) в том же регионе | интеграция региональной виртуальной сети |
| Требуется доступ к ресурсам в классической виртуальной сети или виртуальной сети в другом регионе | Интеграция виртуальной сети, требуемой шлюзом |
| Требуется доступ к конечным точкам RFC 1918 в ExpressRoute | интеграция региональной виртуальной сети |
| Требуется доступ к ресурсам в конечных точках службы | интеграция региональной виртуальной сети |

Ни одна из этих функций не позволяет обращаться к адресам, отличным от RFC 1918, в ExpressRoute. Для этого необходимо использовать ASE.

При использовании региональной интеграции виртуальной сети виртуальная сеть не подключается к локальным или настраивается конечные точки служб. Это отдельная конфигурация сети. Интеграция региональной виртуальной сети позволяет приложению выполнять вызовы через эти типы подключений.

Независимо от используемой версии, интеграция с виртуальной сетью предоставляет приложению-функции доступ к ресурсам в виртуальной сети, но не предоставляет частному сайту доступ к приложению-функции из виртуальной сети. Доступ к частным сайтам подразумевает доступность приложения только из частной сети, например из виртуальной сети Azure. Интеграция виртуальной сети предназначена только для исходящих вызовов из приложения в виртуальную сеть. 

Интеграция с виртуальной сетью связана со следующими особенностями:

* Требуется план службы приложений "Стандартный", "Премиум" или "категории премиум v2"
* поддержка TCP и UDP
* работает с приложениями службы приложений и приложениями функций

Функции, не поддерживаемые при интеграции с виртуальной сетью:

* подключение диска;
* Интеграция с AD
* NetBios;

Интеграция виртуальной сети в функции использует общую инфраструктуру с веб-приложениями службы приложений. Дополнительные сведения о двух типах интеграции виртуальной сети см. в следующих статьях:

* [Региональные интеграция с виртуальной сетью](../app-service/web-sites-integrate-with-vnet.md#regional-vnet-integration)
* [Интеграция виртуальной сети, требуемой шлюзом](../app-service/web-sites-integrate-with-vnet.md#gateway-required-vnet-integration)

Дополнительные сведения об использовании интеграции с виртуальной сетью см. в статье [интеграция приложения-функции с виртуальной сетью Azure](functions-create-vnet.md).

## <a name="connecting-to-service-endpoint-secured-resources"></a>Подключение к защищенным ресурсам конечной точки службы

> [!NOTE]
> Временно может потребоваться до 12 часов, пока новые конечные точки службы станут доступными для приложения функции после настройки ограничений доступа к нижестоящим ресурсам. В течение этого времени ресурс будет полностью недоступен для вашего приложения.

Чтобы обеспечить более высокий уровень безопасности, можно ограничить число служб Azure для виртуальной сети с помощью конечных точек службы. Затем необходимо интегрировать приложение функции с этой виртуальной сетью для доступа к ресурсу. Эта конфигурация поддерживается во всех планах, поддерживающих интеграцию виртуальной сети.

[Дополнительные сведения о конечных точках службы виртуальной сети см. здесь.](../virtual-network/virtual-network-service-endpoints-overview.md)

### <a name="restricting-your-storage-account-to-a-virtual-network"></a>Учетная запись хранения должна быть ограничена виртуальной сетью

При создании приложения-функции необходимо создать или связать с учетной записью хранения Azure общего назначения, которая поддерживает хранилище BLOB-объектов, очередей и таблиц. Сейчас невозможно использовать ограничения виртуальной сети для этой учетной записи. Если вы настроили конечную точку службы виртуальной сети в учетной записи хранения, используемой для приложения-функции, это приведет к нарушению работы приложения.

[Дополнительные сведения о требованиях к учетной записи хранения см. здесь.](./functions-create-function-app-portal.md#storage-account-requirements
)

## <a name="virtual-network-triggers-non-http"></a>Триггеры виртуальной сети (не HTTP)

Сейчас, чтобы иметь возможность использовать триггеры функций, отличные от HTTP, в виртуальной сети, приложение-функция следует запускать в плане службы приложений или в Среда службы приложений.

Чтобы предоставить пример, если вы настроили Azure Cosmos DB принимать трафик только из виртуальной сети, вам потребуется развернуть приложение-функцию в плане службы приложений с помощью интеграции виртуальной сети с этой виртуальной сетью для настройки триггеров Azure Cosmos DB. из этого ресурса. В предварительной версии Настройка интеграции виртуальной сети не позволит плану Premium активировать этот Azure Cosmos DB ресурс.

Проверьте [этот список для всех триггеров, отличных от HTTP](./functions-triggers-bindings.md#supported-bindings) , чтобы проверить, какие из них поддерживаются.

## <a name="hybrid-connections"></a>Гибридные подключения

[Гибридные подключения](../service-bus-relay/relay-hybrid-connections-protocol.md) — это функция Azure Relay, которую можно использовать для доступа к ресурсам приложения в других сетях. Они обеспечивают доступ из вашего приложения к конечной точке приложения. Его нельзя использовать для доступа к приложению. Гибридные подключения доступен для функций, которые выполняются во всех планах, кроме плана потребления.

При использовании в функциях Azure каждое гибридное подключение сопоставляется с одним сочетанием узла и порта TCP. Это означает, что конечная точка гибридного подключения может находиться в любой операционной системе и любом приложении, если вы обращаетесь к порту прослушивания TCP. Функция гибридные подключения не знает, что представляет собой протокол приложения или к чему вы обращаетесь. Он просто предоставляет доступ к сети.

Дополнительные сведения см. в [документации по службе приложений для гибридные подключения](../app-service/app-service-hybrid-connections.md), которая поддерживает функции с помощью одних и тех же действий по настройке.

## <a name="outbound-ip-restrictions"></a>Ограничения исходящих IP-адресов

Ограничения исходящих IP-адресов доступны только для функций, развернутых в Среда службы приложений. Вы можете настроить ограничения для исходящего трафика для виртуальной сети, в которой развернута Среда службы приложений.

При интеграции приложения-функции в план Premium или план службы приложений с виртуальной сетью приложение все еще может выполнять исходящие вызовы к Интернету.

## <a name="next-steps"></a>Дальнейшие действия

Дополнительные сведения о работе с сетью и функциях Azure: 

* [Следуйте указаниям в руководстве по началу работы с интеграцией виртуальной сети.](./functions-create-vnet.md)
* [Прочтите вопросы и ответы по функциям сети](./functions-networking-faq.md)
* [Дополнительные сведения об интеграции виртуальной сети со службой приложений и функциями](../app-service/web-sites-integrate-with-vnet.md)
* [Дополнительные сведения о виртуальных сетях в Azure](../virtual-network/virtual-networks-overview.md)
* [Предоставление дополнительных сетевых функций и управление средами службы приложений](../app-service/environment/intro.md)
* [Подключение к отдельным локальным ресурсам без изменения брандмауэра с помощью гибридные подключения](../app-service/app-service-hybrid-connections.md)
