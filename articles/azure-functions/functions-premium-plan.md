---
title: План функций Azure Premium
description: Сведения и параметры конфигурации (VNet, без холодного запуска, длительности выполнения) для плана функций Azure Premium.
author: jeffhollan
ms.topic: conceptual
ms.date: 10/16/2019
ms.author: jehollan
ms.openlocfilehash: dd7f6d0760f2b848435e7c77657e261517d29dd8
ms.sourcegitcommit: 7b25c9981b52c385af77feb022825c1be6ff55bf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/13/2020
ms.locfileid: "79276911"
---
# <a name="azure-functions-premium-plan"></a>План функций Azure Premium

План функций Azure Premium (иногда называемый планом эластичного уровня "Премиум") является вариантом размещения для приложений-функций. План "Премиум" предоставляет такие функции, как подключение к виртуальной сети, без холодного запуска и оборудование уровня "Премиум".  В один и тот же план Premium можно развернуть несколько приложений с функциями, а план позволяет настроить размер вычислительных экземпляров, базовый размер плана и максимальный размер плана.  Сравнение плана Premium и других типов планов и размещения см. в статье [варианты масштабирования и размещения функций](functions-scale.md).

## <a name="create-a-premium-plan"></a>Создание плана "Премиум"

[!INCLUDE [functions-premium-create](../../includes/functions-premium-create.md)]

Вы также можете создать план Premium с помощью команды [AZ functionapp Plan Create](/cli/azure/functionapp/plan#az-functionapp-plan-create) в Azure CLI. В следующем примере создается план уровня _эластичного Premium 1_ :

```azurecli-interactive
az functionapp plan create --resource-group <RESOURCE_GROUP> --name <PLAN_NAME> \
--location <REGION> --sku EP1
```

В этом примере замените `<RESOURCE_GROUP>` своей группой ресурсов и `<PLAN_NAME>` именем вашего плана, который уникален в группе ресурсов. Укажите [поддерживаемый `<REGION>`](https://azure.microsoft.com/global-infrastructure/services/?products=functions). Чтобы создать план Premium, поддерживающий Linux, включите параметр `--is-linux`.

После создания плана можно использовать команду [AZ functionapp Create](/cli/azure/functionapp#az-functionapp-create) , чтобы создать приложение функции. На портале одновременно создаются план и приложение. Пример полного скрипта Azure CLI см. [в разделе Создание приложения-функции в плане Premium](scripts/functions-cli-create-premium-plan.md).

## <a name="features"></a>Компоненты

Следующие функции доступны для приложений-функций, развернутых в плане Premium.

### <a name="pre-warmed-instances"></a>Предварительно заданный экземпляр

Если в плане потребления нет событий и выполнений в настоящее время, приложение может масштабироваться до нулевых экземпляров. Когда поступают новые события, новый экземпляр должен быть специализированным для приложения, работающего на нем.  Специализация новых экземпляров может занять некоторое время в зависимости от приложения.  Эта дополнительная задержка при первом вызове часто называется холодный запуском приложения.

В плане "Премиум" вы можете подготовить приложение на заданное количество экземпляров, вплоть до минимального размера плана.  Предварительно подготовленные экземпляры также позволяют предварительно масштабировать приложение перед высокой нагрузкой. По мере того как приложение масштабируется, оно сначала масштабируется до заранее подготовленных экземпляров. Дополнительные экземпляры продолжают поступить в буфер и немедленно загревается для подготовки к следующей операции масштабирования. Наличие буфера предварительно подготовленных экземпляров позволяет избежать задержек при холодном запуске.  Предварительно подготовленные экземпляры являются функцией плана Premium, поэтому необходимо, чтобы хотя бы один экземпляр работал и был доступен во всех случаях, когда план активен.

Вы можете настроить число предварительно заданных экземпляров в портал Azure, выбрав **приложение-функция**, перейдите на вкладку **функции платформы** и выберите параметры **Scale out** . В окне изменения приложения-функции предварительно заработающие экземпляры относятся только к этому приложению, но минимальное и максимальное экземпляры применяются ко всему плану.

![Параметры эластичного масштабирования](./media/functions-premium-plan/scale-out.png)

Можно также настроить предварительно заданный экземпляр для приложения с Azure CLI.

```azurecli-interactive
az resource update -g <resource_group> -n <function_app_name>/config/web --set properties.preWarmedInstanceCount=<desired_prewarmed_count> --resource-type Microsoft.Web/sites
```

### <a name="private-network-connectivity"></a>Подключение к частной сети

Функции Azure, развернутые в плане Premium, используют преимущества [новой интеграции с виртуальной сетью для веб-приложений](../app-service/web-sites-integrate-with-vnet.md).  При настройке приложение может взаимодействовать с ресурсами в виртуальной сети или защищено с помощью конечных точек службы.  Ограничения IP-адресов также доступны в приложении для ограничения входящего трафика.

При назначении подсети для приложения-функции в плане Premium требуется подсеть с достаточной IP-адресацией для каждого возможного экземпляра. Для этого требуется блок IP-адресов, в котором по меньшей мере 100.

Дополнительные сведения см. в статье [интеграция приложения-функции с виртуальной](functions-create-vnet.md)сетью.

### <a name="rapid-elastic-scale"></a>Быстрое Эластичное масштабирование

Дополнительные расчетные экземпляры автоматически добавляются в приложение с использованием той же логики быстрого масштабирования, что и план потребления.  Дополнительные сведения о том, как работает масштабирование, см. в статье [масштабирование и размещение функций](./functions-scale.md#how-the-consumption-and-premium-plans-work).

### <a name="longer-run-duration"></a>Длительность длительного выполнения

Использование функций Azure в плане потребления ограничено 10 минутами для одного выполнения.  В плане Premium длительность выполнения по умолчанию составляет 30 минут, чтобы предотвратить неконтролируемые выполнения. Однако можно [изменить конфигурацию Host. JSON](./functions-host-json.md#functiontimeout) , чтобы сделать это без ограничений для приложений плана Premium (гарантия 60 минут).

## <a name="plan-and-sku-settings"></a>Параметры плана и номера SKU

При создании плана необходимо настроить два параметра: минимальное число экземпляров (или размер плана) и максимальное количество пакетов.  Минимальное количество экземпляров зарезервировано и всегда выполняется.

> [!IMPORTANT]
> За каждый экземпляр, выделенный в качестве минимального числа экземпляров, выставляются счета независимо от того, выполняются ли функции.

Если приложению требуются экземпляры за пределами вашего плана, можно продолжить масштабирование до тех пор, пока количество экземпляров не достигнет максимального количества пакетов.  Счета выставляются за экземпляры, которые выходят за пределы размера вашего плана, только если они работают и арендованы вам.  Мы сделаем лучшие усилия при масштабировании приложения до заданного максимального предела, в то время как минимальный набор экземпляров плана гарантированно подходит для вашего приложения.

Можно настроить размер и максимум для плана в портал Azure, выбрав параметры **Scale out** в плане или приложение-функцию, развернутое в этом плане (в разделе **функции платформы**).

Кроме того, можно увеличить максимальное число пакетов от Azure CLI:

```azurecli-interactive
az resource update -g <resource_group> -n <premium_plan_name> --set properties.maximumElasticWorkerCount=<desired_max_burst> --resource-type Microsoft.Web/serverfarms 
```

### <a name="available-instance-skus"></a>Номера SKU доступных экземпляров

При создании или масштабировании плана можно выбрать один из трех размеров экземпляра.  Вам будет выставлен счет за общее количество ядер и объем используемой памяти в секунду.  Приложение может автоматически масштабироваться на несколько экземпляров по мере необходимости.  

|номер SKU|Ядра|Память|Память|
|--|--|--|--|
|EP1|1|3,5 ГБ|Гбайт|
|EP2|2|7 ГБ|Гбайт|
|EP3|4|14 ГБ|Гбайт|

### <a name="memory-utilization-considerations"></a>Рекомендации по использованию памяти
Выполнение на компьютере с большим объемом памяти не всегда означает, что приложение-функция будет использовать всю доступную память.

Например, приложение-функция JavaScript ограничено ограничением памяти по умолчанию в Node. js. Чтобы увеличить этот фиксированный предел памяти, добавьте параметр приложения `languageWorkers:node:arguments` со значением `--max-old-space-size=<max memory in MB>`.

## <a name="region-max-scale-out"></a>Максимальный Scale Out региона

Ниже приведены максимальные значения, которые поддерживаются в настоящее время для одного плана в каждом регионе и конфигурации ОС. Чтобы запросить увеличение, отправьте запрос в службу поддержки.

См. полную региональную доступность функций здесь: [Azure.com](https://azure.microsoft.com/global-infrastructure/services/?products=functions)

|Регион| Windows | Linux |
|--| -- | -- |
|Центральная Австралия| 20 | Недоступно |
|Центральная Австралия 2| 20 | Недоступно |
|Восточная Австралия| 100 | 20 |
|Юго-Восточная часть Австралии | 100 | 20 |
|Южная Бразилия| 60 | 20 |
|Центральная Канада| 100 | 20 |
|Центральная часть США| 100 | 20 |
|Восточная Азия| 100 | 20 |
|Восточная часть США | 100 | 20 |
|восточная часть США 2| 100 | 20 |
|Центральная Франция| 100 | 20 |
|Центрально-Западная Германия| 100 | Недоступно |
|Восточная Япония| 100 | 20 |
|Западная Япония| 100 | 20 |
|Республика Корея, центральный регион| 100 | 20 |
|Центрально-северная часть США| 100 | 20 |
|Северная Европа| 100 | 20 |
|Восточная Норвегия;| 20 | 20 |
|Центрально-южная часть США| 100 | 20 |
|Южная Индия | 100 | Недоступно |
|Юго-Восточная Азия| 100 | 20 |
|южная часть Соединенного Королевства| 100 | 20 |
|западная часть Соединенного Королевства| 100 | 20 |
|Западная Европа| 100 | 20 |
|Западная Индия| 100 | 20 |
|центрально-западная часть США| 20 | 20 |
|западная часть США| 100 | 20 |
|западная часть США 2| 100 | 20 |

## <a name="next-steps"></a>Дальнейшие действия

> [!div class="nextstepaction"]
> [Общие сведения о масштабировании и возможностях размещения функций Azure](functions-scale.md)
