---
title: Технологии развертывания в функциях Azure
description: Изучите различные способы развертывания кода в Azure Functions.
author: georgewallace
ms.custom: vs-azure
ms.topic: conceptual
ms.date: 04/25/2019
ms.author: gwallace
ms.openlocfilehash: 43352117d149abbe41ba7bf49a1ffb68e46d2707
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "79277132"
---
# <a name="deployment-technologies-in-azure-functions"></a>Технологии развертывания в функциях Azure

Для развертывания кода проекта Azure Functions можно использовать несколько различных технологий. В этой статье приводится исчерпывающий перечень этих технологий, описывается, какие технологии доступны для которых вкусы функций, объясняется, что происходит при использовании каждого метода, и содержится рекомендации для наилучшего метода для использования в различных сценариях . Различные инструменты, поддерживающие развертывание функций Azure, настроены на правильную технологию, основанную на их контексте. Как правило, развертывание на молнии является рекомендуемой технологией развертывания для Функций Azure.

## <a name="deployment-technology-availability"></a>Доступность технологий развертывания

Azure Functions поддерживает кросс-платформенные локальные разработки и хостинг на Windows и Linux. В настоящее время доступны три хостинговых плана:

+ [Потребление](functions-scale.md#consumption-plan)
+ [Премиум](functions-scale.md#premium-plan)
+ [Выделено (Служба приложений)](functions-scale.md#app-service-plan)

Каждый план имеет различное поведение. Не все технологии развертывания доступны для каждого вкуса функций Azure. На следующей диаграмме показано, какие технологии развертывания поддерживаются для каждой комбинации операционной системы и плана хостинга:

| Технология развертывания | Потребление Windows | Windows Premium | Windows Выделенные  | Потребление Linux | Linux Premium | Linux Посвященный |
|-----------------------|:-------------------:|:-------------------------:|:------------------:|:---------------------------:|:-------------:|:---------------:|
| Внешний пакет URL<sup>1</sup> |✔|✔|✔|✔|✔|✔|
| Развертывание ципа |✔|✔|✔|✔|✔|✔|
| Контейнер Docker | | | | |✔|✔|
| Web Deploy |✔|✔|✔| | | |
| Система управления версиями |✔|✔|✔| |✔|✔|
| Местный Git<sup>1</sup> |✔|✔|✔| |✔|✔|
| Прочная синхронизация<sup>1</sup> |✔|✔|✔| |✔|✔|
| FTP<sup>1</sup> |✔|✔|✔| |✔|✔|
| Редактирование портала |✔|✔|✔| |✔<sup>2</sup>|✔<sup>2</sup>|

<sup>1</sup> Технология развертывания, требующая [синхронизации ручного триггера.](#trigger-syncing)  
<sup>2</sup> Редактирование портала включено только для триггеров HTTP и Timer для функций на Linux с использованием премиум и выделенных планов.

## <a name="key-concepts"></a>Основные понятия

Некоторые ключевые концепции имеют решающее значение для понимания того, как развертывание работает в Функциях Azure.

### <a name="trigger-syncing"></a>Синхронизация триггера

При изменении любого из триггеров инфраструктура функций должна быть в курсе изменений. Синхронизация происходит автоматически для многих технологий развертывания. Однако в некоторых случаях необходимо вручную синхронизировать триггеры. При развертывании обновлений, ссылаясь на URL-адрес внешнего пакета, локальный Git, синхронизацию облаков или FTP, необходимо вручную синхронизировать триггеры. Вы можете синхронизировать триггеры одним из трех способов:

* Перезапустите приложение функции на портале Azure
* Отправить запрос HTTP `https://{functionappname}.azurewebsites.net/admin/host/synctriggers?code=<API_KEY>` POST на использование [основного ключа.](functions-bindings-http-webhook-trigger.md#authorization-keys)
* Отправить запрос HTTP `https://management.azure.com/subscriptions/<SUBSCRIPTION_ID>/resourceGroups/<RESOURCE_GROUP_NAME>/providers/Microsoft.Web/sites/<FUNCTION_APP_NAME>/syncfunctiontriggers?api-version=2016-08-01`POST . Замените заполнителей идентификатором подписки, именем группы ресурсов и названием приложения функции.

### <a name="remote-build"></a>Удаленная сборка

Функции Azure могут автоматически выполнять сборки кода, который он получает после развертывания на молнии. Эти сборки ведут себя немного по-разному в зависимости от того, работает ли ваше приложение на Windows или Linux. Удаленные сборки не выполняются, когда приложение ранее было настроено для запуска в режиме [Run From Package.](run-functions-from-deployment-package.md) Чтобы узнать, как использовать удаленную сборку, перейдите на [развертывание.](#zip-deploy)

> [!NOTE]
> Если у вас возникли проблемы с удаленной сборкой, это может быть связано с тем, что ваше приложение было создано до того, как функция стала доступной (1 августа 2019 года). Попробуйте создать новое приложение `az functionapp update -g <RESOURCE_GROUP_NAME> -n <APP_NAME>` функции или запустить для обновления приложения функции функции. Для успеха этой команды может потребоваться две попытки.

#### <a name="remote-build-on-windows"></a>Удаленная сборка на Windows

Все функциональные приложения, работающие на Windows, имеют небольшое приложение для управления, сайт SCM (или [Kudu).](https://github.com/projectkudu/kudu) Этот сайт обрабатывает большую часть развертывания и логики сборки для функций Azure.

При развертывании приложения в Windows запускаются команды, например `dotnet restore` `npm install` (C) или (JavaScript).

#### <a name="remote-build-on-linux"></a>Удаленная сборка на Linux

Для обеспечения удаленной сборки Linux необходимо настроить [следующие настройки приложений:](functions-how-to-use-azure-function-app-settings.md#settings)

* `ENABLE_ORYX_BUILD=true`
* `SCM_DO_BUILD_DURING_DEPLOYMENT=true`

По умолчанию как [Azure Functions Core Tools,](functions-run-local.md) так и [расширение функций Azure для Visual Studio Code](functions-create-first-function-vs-code.md#publish-the-project-to-azure) выполняют удаленные сборки при развертывании в Linux. Из-за этого оба инструмента автоматически создают эти настройки для вас в Azure. 

Когда приложения строятся удаленно на Linux, они [выходят из пакета развертывания.](run-functions-from-deployment-package.md) 

##### <a name="consumption-plan"></a>План потребления

Приложения функции Linux, работающие в плане потребления, не имеют сайта SCM/Kudu, что ограничивает возможности развертывания. Тем не менее, функциональные приложения на Linux, работающие в плане потребления, поддерживают удаленные сборки.

##### <a name="dedicated-and-premium-plans"></a>Выделенные и премиум-планы

Функциональные приложения, работающие на Linux в [специальном плане (App Service)](functions-scale.md#app-service-plan) и [плане Premium,](functions-scale.md#premium-plan) также имеют ограниченный сайт SCM/Kudu.

## <a name="deployment-technology-details"></a>Детали технологии развертывания

Следующие методы развертывания доступны в Функциях Azure.

### <a name="external-package-url"></a>Url внешнего пакета

Вы можете использовать url-адрес внешнего пакета для ссылки на файл удаленного пакета (.zip), содержащий приложение функции. Файл загружается из предоставленного URL-адреса, а приложение работает в режиме [Run From Package.](run-functions-from-deployment-package.md)

>__Как его использовать:__ Добавьте `WEBSITE_RUN_FROM_PACKAGE` в настройки приложения. Значение этого параметра должно быть URL (местоположение конкретного файла пакета, который вы хотите запустить). Настройки можно добавить либо [на портале,](functions-how-to-use-azure-function-app-settings.md#settings) либо [с помощью Azure CLI.](/cli/azure/functionapp/config/appsettings#az-functionapp-config-appsettings-set) 
>
>Если вы используете хранилище Azure Blob, используйте частный контейнер с [общей подписью доступа (SAS),](../vs-azure-tools-storage-manage-with-storage-explorer.md#generate-a-sas-in-storage-explorer) чтобы предоставить Функциям доступ к пакету. Каждый раз, когда приложение перезапускается, оно получает копию содержимого. Ваша ссылка должна быть действительна в течение всего срока действия приложения.

>__Когда его использовать:__ Внешний URL-адрес пакета — единственный поддерживаемый метод развертывания для функций Azure, работающих на Linux в плане потребления, если пользователь не хочет создания [удаленной сборки.](#remote-build) При обновлении файла пакета, на который ссылается приложение функционального приложения, необходимо [вручную синхронизировать триггеры,](#trigger-syncing) чтобы сообщить Azure, что приложение изменилось.

### <a name="zip-deploy"></a>Развертывание ципа

Используйте развертывание zip для нажатия файла .zip, содержащего приложение функции, в Azure. Дополнительно можно настроить приложение, чтобы начать [работу с пакета,](run-functions-from-deployment-package.md)или указать, что происходит [удаленная сборка.](#remote-build)

>__Как его использовать:__ Развертывание с помощью любимого клиентского инструмента: [Visual Studio Code,](functions-develop-vs-code.md#publish-to-azure) [Visual Studio](functions-develop-vs.md#publish-to-azure)или с командной строки с помощью [основных инструментов Azure Functions.](functions-run-local.md#project-file-deployment) По умолчанию эти инструменты используют развертывание застежки-молнии и [выходят из пакета.](run-functions-from-deployment-package.md) Основные инструменты и расширение кода Visual Studio позволяют [удаленной сборки](#remote-build) при развертывании на Linux. Чтобы вручную развернуть файл .zip в функциональное приложение, следуйте инструкциям в [Развертывании из файла или URL-адреса .zip.](https://github.com/projectkudu/kudu/wiki/Deploying-from-a-zip-file-or-url)

>При развертывании с помощью развертывания на молнии можно настроить приложение для [запуска из пакета.](run-functions-from-deployment-package.md) Чтобы выйти из `WEBSITE_RUN_FROM_PACKAGE` пакета, установите значение настройки приложения до `1`. Мы рекомендуем развертывание на молнии. Это дает более быстрое время загрузки для ваших приложений, и это по умолчанию для VS Code, Visual Studio и Azure CLI. 

>__Когда его использовать:__ Развертывание системы является рекомендуемой технологией развертывания для Функций Azure.

### <a name="docker-container"></a>Контейнер Docker

Можно развернуть изображение контейнера Linux, содержащее функциональное приложение.

>__Как его использовать:__ Создайте приложение функции Linux в плане Premium или Dedicated и укажите, из какого изображения контейнера следует запускать. Это можно сделать двумя способами.
>
>* Создайте приложение функции Linux в плане службы приложений Azure на портале Azure. Для **публикации**, выберите **Docker Image,** а затем настроить контейнер. Введите место, где размещено изображение.
>* Создайте приложение функции Linux в плане Службы Приложений, используя Azure CLI. Чтобы узнать, как, увидеть [Создать функцию на Linux с помощью пользовательского изображения](functions-create-function-linux-custom-image.md#create-supporting-azure-resources-for-your-function).
>
>Чтобы развернуть в существующее приложение с помощью пользовательского контейнера, в [основных инструментах Azure Functions](functions-run-local.md)используйте [`func deploy`](functions-run-local.md#publish) команду.

>__Когда его использовать:__ Используйте опцию контейнера Docker, когда вам нужно больше контроля над средой Linux, где работает приложение функции. Этот механизм развертывания доступен только для функций, работающих на Linux.

### <a name="web-deploy-msdeploy"></a>Веб-развертывание (MSDeploy)

Web Deploy упаковывает пакеты и развертывает приложения Windows на любой сервер IIS, включая функциональные приложения, работающие на Windows в Azure.

>__Как его использовать:__ Используйте [инструменты Visual Studio для функций Azure.](functions-create-your-first-function-visual-studio.md) Очистите **Run от файла пакета (рекомендуемого)** флажка.
>
>Вы также можете скачать Web `MSDeploy.exe` Deploy [3.6](https://www.iis.net/downloads/microsoft/web-deploy) и позвонить напрямую.

>__Когда его использовать:__ Web Deploy поддерживается и не имеет проблем, но предпочтительным механизмом является [развертывание zip с включенным пакетом Run From.](#zip-deploy) Чтобы узнать больше, смотрите [руководство по разработке Visual Studio](functions-develop-vs.md#publish-to-azure).

### <a name="source-control"></a>Система управления версиями

Используйте элемент управления исходом для подключения приложения функции к репозиторию Git. Обновление кода в этом репозитории вызывает развертывание. Для получения дополнительной информации, [см.](https://github.com/projectkudu/kudu/wiki/VSTS-vs-Kudu-deployments)

>__Как его использовать:__ Используйте Центр развертывания в области функций портала для настройки публикации из управления исходным ресурсом. Дополнительные сведения см. в статье [Непрерывное развертывание для функций Azure](functions-continuous-deployment.md).

>__Когда его использовать:__ Использование управления исходными исходами является наилучшей практикой для групп, которые сотрудничают со своими функциональными приложениями. Управление исходным элементом является хорошим вариантом развертывания, который позволяет создавать более сложные конвейеры развертывания.

### <a name="local-git"></a>Локальный репозиторий Git

Можно использовать локальный Git для отодвижения кода от локальной машины к функциям Azure, используя Git.

>__Как его использовать:__ Следуйте инструкциям по [развертыванию локальных Git в службе приложений Azure.](../app-service/deploy-local-git.md)

>__Когда его использовать:__ Как правило, мы рекомендуем использовать другой метод развертывания. При публикации из локального Git необходимо [вручную синхронизировать триггеры.](#trigger-syncing)

### <a name="cloud-sync"></a>Синхронизация облаков

Используйте синхронизацию облаков для синхронизации содержимого с Dropbox и OneDrive в Azure Functions.

>__Как его использовать:__ Следуйте инструкциям в [содержимом Sync из облачной папки.](../app-service/deploy-content-sync.md)

>__Когда его использовать:__ Как правило, мы рекомендуем другие методы развертывания. При публикации с помощью облачной синхронизации необходимо [вручную синхронизировать триггеры.](#trigger-syncing)

### <a name="ftp"></a>FTP

Можно использовать FTP для непосредственной передачи файлов в Функции Azure.

>__Как его использовать:__ Следуйте инструкциям в [содержимом Deploy с помощью FTP/s](../app-service/deploy-ftp.md).

>__Когда его использовать:__ Как правило, мы рекомендуем другие методы развертывания. При публикации с помощью FTP необходимо [вручную синхронизировать триггеры.](#trigger-syncing)

### <a name="portal-editing"></a>Редактирование портала

В редакторе на основе портала можно непосредственно отсеивать файлы, которые находятся в приложении функции (по сути, развертывание каждый раз, когда вы сохраняете изменения).

>__Как его использовать:__ Чтобы иметь возможность редотизировать свои функции на портале Azure, необходимо [создать свои функции на портале.](functions-create-first-azure-function.md) Чтобы сохранить единый источник истины, использование любого другого метода развертывания делает вашу функцию только прочитана и предотвращает дальнейшее редактирование портала. Чтобы вернуться в состояние, в котором можно отсеивать файлы на портале Azure, можно вручную вернуть режим отсечения `Read/Write` и удалить любые настройки приложения, связанные с развертыванием (например). `WEBSITE_RUN_FROM_PACKAGE` 

>__Когда его использовать:__ Портал — это хороший способ начать работу с функциями Azure. Для более интенсивной работы по разработке мы рекомендуем использовать один из следующих клиентских инструментов:
>
>* [Visual Studio Code](functions-create-first-function-vs-code.md)
>* [Основные инструменты Azure Functions (командная линия)](functions-run-local.md)
>* [Visual Studio](functions-create-your-first-function-visual-studio.md)

В следующей таблице показаны операционные системы и языки, поддерживающие редактирование портала:

| | Потребление Windows | Windows Premium | Windows Выделенные | Потребление Linux | Linux Premium | Linux Посвященный |
|-|:-----------------: |:----------------:|:-----------------:|:-----------------:|:-------------:|:---------------:|
| C# | | | | | |
| Скрипт C# |✔|✔|✔| |✔<sup>\*</sup> |✔<sup>\*</sup>|
| F# | | | | | | |
| Java | | | | | | |
| JavaScript (Node.js) |✔|✔|✔| |✔<sup>\*</sup>|✔<sup>\*</sup>|
| Python (предварительная версия) | | | | | | |
| PowerShell (предварительная версия) |✔|✔|✔| | | |
| ТигScript (Node.js) | | | | | | |

<sup>*</sup>Редактирование портала включено только для триггеров HTTP и Timer для функций на Linux с использованием премиум и выделенных планов.

## <a name="deployment-slots"></a>Слоты развертывания

При развертывании приложения функции в Azure можно развернуть в отдельном слоте развертывания, а не непосредственно в производство. Для получения дополнительной информации о слотах развертывания можно ознакомиться с документацией [по развертыванию функций Azure.](../app-service/deploy-staging-slots.md)

## <a name="next-steps"></a>Дальнейшие действия

Прочитайте эти статьи, чтобы узнать больше о развертывании функциональных приложений: 

+ [Непрерывное развертывание для Функций Azure](functions-continuous-deployment.md)
+ [Непрерывная доставка с помощью Azure DevOps](functions-how-to-azure-devops.md)
+ [Развертывание системы «Застегив» для функций Azure](deployment-zip-push.md)
+ [Запуск функций Azure из файла пакета](run-functions-from-deployment-package.md)
+ [Автоматизация развертывания ресурсов приложения-функции для службы "Функции Azure"](functions-infrastructure-as-code.md)
