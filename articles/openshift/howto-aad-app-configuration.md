---
title: Интеграция Azure Active Directory для Azure Red Hat OpenShift | Документация Майкрософт
description: Узнайте, как создать группу безопасности Azure AD и пользователя для тестирования приложений в кластере Microsoft Azure Red Hat OpenShift.
author: jimzim
ms.author: jzim
ms.service: container-service
manager: jeconnoc
ms.topic: conceptual
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 05/13/2019
ms.openlocfilehash: 00609905d09f8d414660c21805c6efca5eb30843
ms.sourcegitcommit: 2e4b99023ecaf2ea3d6d3604da068d04682a8c2d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/09/2019
ms.locfileid: "67669384"
---
# <a name="azure-active-directory-integration-for-azure-red-hat-openshift"></a>Интеграция Azure Active Directory для Azure Red Hat OpenShift

Если вы еще не создали клиент Azure Active Directory (Azure AD), следуйте указаниям, приведенным в [создание клиента Azure AD для Azure Red Hat OpenShift](howto-create-tenant.md) продолжения с помощью этих инструкций.

Microsoft Azure Red Hat OpenShift требуются разрешения на выполнение задачи от имени кластера. Если вашей организации еще нет пользователем Azure AD, группы безопасности Azure AD или зарегистрировать приложение Azure AD для использования в качестве субъекта-службы, выполните следующие действия для их создания.

## <a name="create-a-new-azure-active-directory-user"></a>Создание нового пользователя Azure Active Directory

В [портала Azure](https://portal.azure.com), убедитесь, что клиент отображается под именем пользователя в правом верхнем углу портала:

![Снимок экрана портала с клиентом в списке в верхнем правом углу](./media/howto-create-tenant/tenant-callout.png) Если неправильного клиента отображается, щелкните свое имя пользователя в правом верхнем углу, а затем нажмите кнопку **переключение каталога**и выбрать правильный клиент из **все Каталоги** списка.

Создайте нового пользователя глобального администратора Azure Active Directory для входа в кластер Azure Red Hat OpenShift.

1. Перейдите к [пользователей — все пользователи](https://portal.azure.com/#blade/Microsoft_AAD_IAM/UsersManagementMenuBlade/AllUsers) колонке.
2. Нажмите кнопку **+ новый пользователь** открыть **пользователя** области.
3. Введите **имя** для этого пользователя.
4. Создание **имя пользователя** на основе имени клиента, созданный с помощью `.onmicrosoft.com` в конце. Например, `yourUserName@yourTenantName.onmicrosoft.com`. Запишите это имя пользователя. Он вам понадобится для входа в кластер.
5. Нажмите кнопку **роль каталога** для открытия области роли каталога и выберите **глобального администратора** и нажмите кнопку **ОК** в нижней части области.
6. В **пользователя** панели щелкните **Показать пароль** и запишите временный пароль. После входа в систему в первый раз, вам будет предложено сбросить его.
7. В нижней части панели, щелкните **создать** для создания пользователя.

## <a name="create-an-azure-ad-security-group"></a>Создание группы безопасности Azure AD

Чтобы предоставить доступ администратора кластера, членство в группе безопасности Azure AD, синхронизируются с OpenShift группы «osa--Администраторы клиентов». Если не указан, будут предоставлены нет прав администратора кластера.

1. Откройте [группы Azure Active Directory](https://portal.azure.com/#blade/Microsoft_AAD_IAM/GroupsManagementMenuBlade/AllGroups) колонке.
2. Нажмите кнопку **+ новая группа**.
3. Укажите имя группы и описание.
4. Задайте **тип группы** для **безопасности**.
5. Задайте **тип членства** для **назначено**.

    Добавьте пользователя Azure AD, созданный на предыдущем шаге, в эту группу безопасности.

6. Нажмите кнопку **члены** открыть **Выбор членов** области.
7. В списке элементов выберите пользователя Azure AD, созданной выше.
8. В нижней части портала щелкните **выберите** и затем **создать** Создание группы безопасности.

    Запишите значение идентификатора группы.

9. Если группа создана, вы увидите его в список всех групп. Щелкните новую группу.
10. На появившейся странице скопируйте **идентификатор объекта**. Мы будем называть это значение как `GROUPID` в [создать кластер Azure Red Hat OpenShift](tutorial-create-cluster.md) руководства.

## <a name="create-an-azure-ad-app-registration"></a>Создание регистрации приложения Azure AD

Можно автоматически создавать клиент регистрации приложения Azure Active Directory (Azure AD) во время создания кластера, опустив `--aad-client-app-id` флаг `az openshift create` команды. Этом руководстве показано, как зарегистрировать приложение Azure AD для обеспечения полноты.

Если вашей организации еще нет регистрацию приложения Azure Active Directory (Azure AD) для использования в качестве субъекта-службы, выполните следующие действия, чтобы создать его.

1. Откройте [колонку регистрации приложений](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/RegisteredAppsPreview) и нажмите кнопку **Регистрация нового**.
2. В **зарегистрировать приложение** области, введите имя для регистрации приложения.
3. Убедитесь, что в разделе **поддерживаемые типы учетных записей** , **учетных записей в организации каталога только** выбран. Это наиболее безопасный вариант.
4. Мы будем добавлять URI перенаправления позже, когда мы URI кластера. Нажмите кнопку **зарегистрировать** кнопку, чтобы создать регистрацию приложения Azure AD.
5. На появившейся странице скопируйте **идентификатор приложения (клиент)** . Мы будем называть это значение как `APPID` в [создать кластер Azure Red Hat OpenShift](tutorial-create-cluster.md) руководства.

![Снимок экрана страницы объекта приложения](./media/howto-create-tenant/get-app-id.png)

### <a name="create-a-client-secret"></a>Создание секрета клиента

Создайте секрет клиента для проверки подлинности приложения в Azure Active Directory.

1. В **управление** раздел страницы регистрации приложения, нажмите кнопку **сертификаты и секреты**.
2. На **сертификаты и секреты** панели щелкните **+ новый секрет клиента**.  **Добавление секрета клиента** откроется панель.
3. Укажите **описание**.
4. Задайте **Expires** длительности вы предпочитаете, например **в 2 года**.
5. Нажмите кнопку **добавить** и значение ключа будет отображаться в **секреты клиента** раздел страницы.
6. Скопируйте значение ключа. Мы будем называть это значение как `SECRET` в [создать кластер Azure Red Hat OpenShift](tutorial-create-cluster.md) руководства.

![Снимок экрана области сертификаты и секреты](./media/howto-create-tenant/create-key.png)

Дополнительные сведения об объектах приложения Azure, см. в разделе [объекты приложения и службы субъекта в Azure Active Directory](https://docs.microsoft.com/azure/active-directory/develop/app-objects-and-service-principals).

Дополнительные сведения о создании нового приложения Azure AD, см. в разделе [регистрации приложения с конечной точкой Azure Active Directory версии 1.0](https://docs.microsoft.com/azure/active-directory/develop/quickstart-v1-add-azure-ad-app).

## <a name="add-api-permissions"></a>Добавление разрешений API

1. В **управление** щелкните **разрешения API**.
2. Нажмите кнопку **добавить разрешение** и выберите **Azure Active Directory Graph** затем **делегированные разрешения**
3. Разверните **пользователя** на списка и убедитесь, что **User.Read** включен.
4. Прокрутите страницу вверх и выделите **разрешения приложения**.
5. Разверните **Directory** в списке ниже и включить **Directory.ReadAll**
6. Нажмите кнопку **Добавление разрешений** для принятия изменений.
7. Области разрешений API должно отобразиться оба *User.Read* и *Directory.ReadAll*. Обратите внимание, предупреждения в **требуется согласие администратора** столбца рядом с полем *Directory.ReadAll*.
8. Если вы являетесь *администратором подписки Azure*, нажмите кнопку **предоставления согласия администратора *Имя_подписки***  ниже. Если вы не *администратором подписки Azure*, Запросить согласие администратора.
![Снимок экрана, панели разрешения API. Добавлен User.Read и Directory.ReadAll разрешения, согласие администратора требуется для Directory.ReadAll](./media/howto-aad-app-configuration/permissions-required.png)

> [!IMPORTANT]
> Синхронизация группы Администраторы кластера будет работать только после согласия было предоставлено. Вы увидите зеленый круг с флажком и сообщение «предоставлено для *имя подписки*"в *требуется согласие администратора* столбца.

Дополнительные сведения об управлении администраторов и других ролей, см. в разделе [Добавление или изменение администраторов подписки Azure](https://docs.microsoft.com/azure/billing/billing-add-change-azure-subscription-administrator).

## <a name="resources"></a>Ресурсы

* [Приложения и объектов субъекта-службы в Azure Active Directory](https://docs.microsoft.com/azure/active-directory/develop/app-objects-and-service-principals)
* [Краткое руководство Регистрация приложения с конечной точкой Azure Active Directory версии 1.0](https://docs.microsoft.com/azure/active-directory/develop/quickstart-v1-add-azure-ad-app)

## <a name="next-steps"></a>Следующие шаги

Если соблюдены все [предварительные требования Azure Red Hat OpenShift](howto-setup-environment.md), вы будете готовы создать свой первый кластер!

Ознакомьтесь с учебником:
> [!div class="nextstepaction"]
> [Создание кластера Azure Red Hat OpenShift](tutorial-create-cluster.md)
