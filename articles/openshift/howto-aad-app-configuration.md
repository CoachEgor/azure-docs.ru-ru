---
title: Интеграция Active Directory Azure для Azure Red Hat OpenShift
description: Узнайте, как создать группу безопасности Azure AD и пользователя для тестирования приложений в кластере Microsoft Azure Red Hat OpenShift.
author: jimzim
ms.author: jzim
ms.service: container-service
ms.topic: conceptual
ms.date: 05/13/2019
ms.openlocfilehash: f6c4fb5caf746650f95872d50afe31e5693422be
ms.sourcegitcommit: ea006cd8e62888271b2601d5ed4ec78fb40e8427
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81382916"
---
# <a name="azure-active-directory-integration-for-azure-red-hat-openshift"></a>Интеграция Active Directory Azure для Azure Red Hat OpenShift

Если вы еще не создали наемный каталог Azure Active Directory (Azure AD), следуйте указаниям в [создании ad-нанимательа Azure AD для Azure Red Hat OpenShift,](howto-create-tenant.md) прежде чем продолжить выполнение этих инструкций.

Microsoft Azure Red Hat OpenShift требуется разрешение для выполнения задач от имени кластера. Если у вашей организации еще нет пользователя Azure AD, группы безопасности Azure AD или регистрации приложений Azure AD для использования в качестве основного сервиса, следуйте этим инструкциям для их создания.

## <a name="create-a-new-azure-active-directory-user"></a>Создание нового пользователя Azure Active Directory

На [портале Azure](https://portal.azure.com)убедитесь, что ваш арендатор отображается под именем пользователя в правом верхнем ряде портала:

![Скриншот портала с арендатором,](./media/howto-create-tenant/tenant-callout.png) указанным в правом верхнем положении, если отображается неправильный арендатор, щелкните имя пользователя в правом верхнем ряде, затем нажмите **Switch Directory**и выберите правильного арендатора из списка **All Directories.**

Создайте новый пользователь Azure Active Directory 'Owner' для вхотвора в кластер Azure Red Hat OpenShift.

1. Перейти к лезвию [пользователей - Все пользователи.](https://portal.azure.com/#blade/Microsoft_AAD_IAM/UsersManagementMenuBlade/AllUsers)
2. Нажмите **кнопку «Новый пользователь»,** чтобы открыть панель **пользователя.**
3. Введите **имя** для этого пользователя.
4. Создайте **имя пользователя** на основе имени созданного `.onmicrosoft.com` вами арендатора с приложением в конце. Например, `yourUserName@yourTenantName.onmicrosoft.com`. Запишите это имя пользователя. Он понадобится для входиный в кластер.
5. Нажмите **каталог роль,** чтобы открыть панель роли каталога, и выберите **владельца,** а затем нажмите **Ok** в нижней части панели.
6. В панели **пользователя** нажмите **Show Password** и запишите временный пароль. После того, как вы впишете в первый раз, вам будет предложено сбросить его.
7. В нижней части панели нажмите **Создать** для создания пользователя.

## <a name="create-an-azure-ad-security-group"></a>Создание группы безопасности Azure AD

Чтобы предоставить доступ к кластерным админ-аминтам, членство в группе безопасности Azure AD синхронизируется с группой OpenShift "osa-customer-admins". Если не указано, доступ к кластерным админ-аммину не предоставляется.

1. Откройте лезвие [групп Active Directory Azure.](https://portal.azure.com/#blade/Microsoft_AAD_IAM/GroupsManagementMenuBlade/AllGroups)
2. Нажмите **кнопку «Новая группа».**
3. Предоставьте название группы и описание.
4. Установите **тип группы** в **security.**
5. Установите **тип членства** в **Назначенный**.

    Добавьте в эту группу безопасности пользователь Azure AD, созданный на предыдущем этапе.

6. Нажмите **На кнопку «Члены** Церкви», чтобы открыть панель **Select.**
7. В списке участников выберите созданного выше пользователя Azure AD.
8. В нижней части портала нажмите на **Select,** а затем **создайте** для создания группы безопасности.

    Запишите значение идентификатора группы.

9. Когда группа будет создана, вы увидите ее в списке всех групп. Нажмите на новую группу.
10. На странице, которая появляется, скопируйте **идентификатор объекта.** Мы будем ссылаться `GROUPID` на это значение как в учебнике [кластера Azure Red Hat OpenShift.](tutorial-create-cluster.md)

> [!IMPORTANT]
> Чтобы синхронизировать эту группу с группой Osa-customer-admins OpenShift, создайте кластер с помощью Azure CLI. Портал Azure в настоящее время не имеет поля для установки этой группы.

## <a name="create-an-azure-ad-app-registration"></a>Создание регистрации приложения Azure AD

Вы можете автоматически создать клиент регистрации приложений Azure Active Directory (Azure AD) в рамках создания кластера, опустив `--aad-client-app-id` флаг `az openshift create` в команду. В этом учебнике показано, как создать для полноты регистрацию приложения Azure AD.

Если у вашей организации еще нет регистрации приложения Azure Active Directory (Azure AD) для использования в качестве основного сервиса, следуйте этим инструкциям для ее создания.

1. Откройте [лезвие регистраций приложений](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/RegisteredAppsPreview) и нажмите **кнопку «Новая регистрация**».
2. В **Регистрационном аппарате панели приложения** введите имя для регистрации заявления.
3. Убедитесь, что под **поддерживаемыми типами учетных записей** выбираются **только учетные записи в этом каталоге организации.** Это самый безопасный выбор.
4. Мы добавим перенаправление URI позже, как только мы узнаем URI кластера. Нажмите кнопку **Регистрация,** чтобы создать регистрацию приложения Azure AD.
5. На странице, которая появляется, скопируйте **id application (client)**. Мы будем ссылаться `APPID` на это значение как в учебнике [кластера Azure Red Hat OpenShift.](tutorial-create-cluster.md)

![Скриншот страницы объекта приложения](./media/howto-create-tenant/get-app-id.png)

### <a name="create-a-client-secret"></a>Создание секрета клиента

Создайте секрет клиента для проверки подлинности приложения в Active Directory Azure.

1. В разделе **Управление** страницей регистраций приложений нажмите **Сертификаты & секреты.**
2. На **сертификатах & стеком секретов** щелкните **«Новый секрет клиента**.  **Появляется секретное** стекло клиента.
3. Предоставьте **описание**.
4. Установить **истекает** в срок, который вы предпочитаете, например, **в 2 лет**.
5. Нажмите **Добавить** и ключевое значение появится в разделе **секреты клиента** страницы.
6. Копирование вниз ключевое значение. Мы будем ссылаться `SECRET` на это значение как в учебнике [кластера Azure Red Hat OpenShift.](tutorial-create-cluster.md)

![Скриншот сертификатов и секретной панели](./media/howto-create-tenant/create-key.png)

Для получения дополнительной информации об объектах приложений Azure смотрите [основные объекты приложений и служб ы в каталоге Active](https://docs.microsoft.com/azure/active-directory/develop/app-objects-and-service-principals)

Подробнее о создании нового приложения Azure AD можно узнать в [приложении Azure Active Directory v1.0.](https://docs.microsoft.com/azure/active-directory/develop/quickstart-v1-add-azure-ad-app)

## <a name="add-api-permissions"></a>Добавление разрешений API

[//]: # (Не переоденьитесь в Microsoft Graph. Он не работает с Microsoft Graph.)
1. В разделе **Управление** щелкните **разрешения API**
2. Нажмите **Добавить разрешение** и выберите **график активного каталога Azure,** а затем **делегировать разрешения.**
> [!NOTE]
> Убедитесь, что вы выбрали "Azure Active Directory Graph", а не плитку "Microsoft Graph".

3. Расширьте **список пользователей** в списке ниже и включите разрешение **User.Read.** Если **User.Read** включен по умолчанию, убедитесь, что это разрешение **Найтюра Active Directory Graph** **user.Read**.
4. Прокрутите вверх и выберите **разрешения приложения.**
5. Расширить **каталог** в списке ниже и включить **Directory.ReadAll**.
6. Нажмите **Добавить разрешения,** чтобы принять изменения.
7. Панель разрешений API теперь должна отображать как *User.Read, так* и *Directory.ReadAll*. Обратите внимание на предупреждение в **требуемом согласии Админа, который требуется** рядом с *Directory.ReadAll*.
8. Если вы являетесь *администратором подписки Azure,* нажмите **на согласие администратора Гранта на *название подписки* ** ниже. Если вы не являетесь *администратором подписки Azure,* запросите согласие у администратора.

![Скриншот панели разрешений API. User.Read и Directory.ReadВсе добавленные разрешения, согласие админа, необходимое для Directory.ReadAll](./media/howto-aad-app-configuration/permissions-required.png)

> [!IMPORTANT]
> Синхронизация группы администраторов кластера будет работать только после получения согласия. Вы увидите зеленый круг с галочкой и сообщением "Предоставлено *для названия подписки"* в требуемом столбце *запроса согласия админа.*

Для получения подробной информации об управлении администраторами и других ролях можно [узнать: «Добавить или изменить администраторы подписки Azure](https://docs.microsoft.com/azure/billing/billing-add-change-azure-subscription-administrator).

## <a name="resources"></a>Ресурсы

* [Основные объекты приложений и служб в Active Directory Azure](https://docs.microsoft.com/azure/active-directory/develop/app-objects-and-service-principals)
* [Краткое руководство. Регистрация приложения в конечной точке Azure Active Directory версии 1.0](https://docs.microsoft.com/azure/active-directory/develop/quickstart-v1-add-azure-ad-app)

## <a name="next-steps"></a>Следующие шаги

Если вы выполнили все [предпосылки Azure Red Hat OpenShift,](howto-setup-environment.md)вы готовы создать свой первый кластер!

Попробуйте учебник:
> [!div class="nextstepaction"]
> [Создание кластера Azure Red Hat OpenShift](tutorial-create-cluster.md)
