---
title: включить файл
description: включить файл
services: cognitive-services
author: erindormier
ms.service: cognitive-services
ms.topic: include
ms.date: 03/11/2020
ms.author: egeaney
ms.custom: include
ms.openlocfilehash: e5e1755e6351d308c041de5cefe943e9874c8ebd
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "79372197"
---
### <a name="enable-customer-managed-keys"></a>Включить ключи, управляемые клиентом

Для хранения ключей, управляемых клиентом, необходимо использовать Azure Key Vault. Вы можете создать свои собственные ключи и хранить их в хранилище ключей, либо использовать AA-иносы Azure Key Vault для генерации ключей. Ресурс Когнитивных Служб и хранилище ключей должны находиться в одном регионе и в том же клиенте Azure Active Directory (Azure AD), но они могут быть в разных подписках. Для получения дополнительной информации о [What is Azure Key Vault?](https://docs.microsoft.com/azure/key-vault/key-vault-overview)Убежище ключей Azure см.

Новый ресурс Cognitive Services всегда шифруется с помощью ключей, управляемых корпорацией Майкрософт. Включить управляемые клиентами ключи на момент создания ресурса невозможно. Управляемые клиентом ключи хранятся в Хранилище ключей Azure, и хранилище ключей должно быть подготовлено с помощью политик доступа, которые предоставляют ключевые разрешения управляемому идентификатору, связанного с ресурсом Cognitive Services. Управляемая идентификация доступна только после создания ресурса с использованием уровня ценообразования для CMK.

Чтобы узнать, как использовать управляемые клиентами ключи с помощью Azure Key Vault для шифрования когнитивных служб, см.:

- [Настройка ключей, управляемых клиентами, с помощью шифрования Key Vault для когнитивных услуг с портала Azure](..\articles\cognitive-services\Encryption\cognitive-services-encryption-keys-portal.md)

Включение управляемых ключей клиента также позволит системе, назначенной управляемой идентификации, особенность Azure AD. После включения системы, назначенной управляемой идентификацией, этот ресурс будет зарегистрирован в каталоге Azure Active. После регистрации управляемому удостоверению будет предоставлен доступ к выбранной Key Vault во время установки ключей, управляемой клиентом. Вы можете узнать больше о [управляемых идентификационных данных](https://docs.microsoft.com/azure/active-directory/managed-identities-azure-resources/overview).

> [!IMPORTANT]
> Если вы отключите систему, назначенную управляемые идентификаторы, доступ к хранилищу ключей будет удален, а любые данные, зашифрованные ключами клиента, больше не будут доступны. Любые функции, зависят от этих данных, перестанут работать.

> [!IMPORTANT]
> Сейчас управляемые удостоверения не поддерживаются в сценариях работы с разными каталогами. При настройке ключей, управляемых клиентом, на портале Azure автоматически присваивается управляемый итог под крышками. Если впоследствии вы переведете подписку, группу ресурсов или ресурс из одного каталога Azure AD в другой, управляемая идентификация, связанная с ресурсом, не передается новому арендатору, поэтому ключи, управляемые клиентом, могут больше не работать. Для получения дополнительной информации см. **Передача подписки между каталогами Azure AD** в [часто задаваемых вопросах и известными проблемами с управляемыми идентификаторами для ресурсов Azure.](https://docs.microsoft.com/azure/active-directory/managed-identities-azure-resources/known-issues#transferring-a-subscription-between-azure-ad-directories)  

### <a name="store-customer-managed-keys-in-azure-key-vault"></a>Храните ключи, управляемые клиентами в Хранилище ключей Azure

Для включения ключей, управляемых клиентом, необходимо использовать Хранилище ключей Azure для хранения ключей. Вы должны включить свойства **Soft Delete** и Do **Not Purge** на хранилище ключей.

Только rsA-ключи размера 2048 поддерживаются шифрованием Cognitive Services. Для получения дополнительной информации о ключах смотрите **ключи Убежища ключей** в [о клавишах, секретах и сертификатах Azure Key Vault.](https://docs.microsoft.com/azure/key-vault/about-keys-secrets-and-certificates#key-vault-keys)

### <a name="rotate-customer-managed-keys"></a>Поверните клавиши, управляемые клиентом

Вы можете повернуть ключ, управляемый клиентом, в Azure Key Vault в соответствии с вашими политиками соответствия. При повороте ключа необходимо обновить ресурс Cognitive Services, чтобы использовать новый ключ URI. Чтобы узнать, как обновить ресурс, чтобы использовать новую версию ключа на портале Azure, смотрите раздел под названием **Обновление ключевой версии** в [Настройка клиентоуправляемых ключей для когнитивных услуг с помощью портала Azure](..\articles\cognitive-services\Encryption\cognitive-services-encryption-keys-portal.md).

Вращение ключа не вызывает повторного шифрования данных в ресурсе. От пользователя не требуется никаких дальнейших действий.

### <a name="revoke-access-to-customer-managed-keys"></a>Отмена доступа к ключам, управляемым клиентами

Чтобы отозвать доступ к ключам, управляемым клиентами, используйте PowerShell или Azure CLI. Для получения дополнительной информации смотрите [ВAzure Key Vault PowerShell](https://docs.microsoft.com/powershell/module/az.keyvault//) или [Azure Key Vault CLI.](https://docs.microsoft.com/cli/azure/keyvault) Отмена доступа фактически блокирует доступ ко всем данным на ресурсе Cognitive Services, так как ключ шифрования недоступен Cognitive Services.


