---
author: roygara
ms.service: storage
ms.topic: include
ms.date: 10/26/2018
ms.author: rogarana
ms.openlocfilehash: 55456a6be938411d3c08a0eaa8fdbfb0844e7129
ms.sourcegitcommit: 877491bd46921c11dd478bd25fc718ceee2dcc08
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/02/2020
ms.locfileid: "72391768"
---
Изменения, внесенные в общий файловый ресурс Azure с использованием портала Azure или SMB, сразу не обнаруживаются и не реплицируются, как изменения в конечной точке сервера. В службе файлов Azure пока не предусмотрена возможность уведомлений об изменениях или ведение журнала изменений, поэтому автоматически инициировать сеанс синхронизации при изменении файлов невозможно. На Windows Server служба "Синхронизация файлов Azure" использует [ведение журнала номеров последовательного обновления Windows](https://msdn.microsoft.com/library/windows/desktop/aa363798.aspx) для автоматического запуска сеанса синхронизации при изменении файлов.

Для обнаружения изменений в общем файловом ресурсе Azure служба "Синхронизация файлов Azure" использует запланированное задание с именем *change detection job* (задание обнаружения изменений). Это задание перечисляет все файлы в общем файловом ресурсе и затем сравнивает их с синхронизированными версиями этих же файлов. Если задание обнаруживает, что файлы изменились, служба "Синхронизация файлов Azure" инициирует сеанс синхронизации. Задание обнаружения изменений инициируется каждые 24 часа. Так как задание обнаружения изменений перечисляет все файлы в общем файловом ресурсе Azure, на обнаружение изменений в крупном пространстве имен уходит больше времени, чем в небольшом пространстве. В крупных пространствах обнаружение измененных файлов может длиться больше суток.

Для немедленной синхронизации файлов, измененных в общей папке Azure, можно использовать командлет PowerShell **Invoke-AzStorageSyncChangeDetection**, вручную инициировав обнаружение изменений в общей папке Azure. Этот командлет предназначен для сценариев, в которых определенный тип автоматизированного процесса вносит изменения в общую папку Azure или изменения выполняются администратором (например, перемещение файлов и каталогов в общую папку). Для изменения конечных пользователей рекомендуется установить агент Синхронизация файлов Azure на виртуальной машине IaaS и предоставить конечным пользователям доступ к общей папке через виртуальную машину IaaS. Таким образом, все изменения будут быстро синхронизироваться с другими агентами без необходимости использовать командлет Invoke-AzStorageSyncChangeDetection. Дополнительные сведения см. в документации по [Invoke-AzStorageSyncChangeDetection](https://docs.microsoft.com/powershell/module/az.storagesync/invoke-azstoragesyncchangedetection).

>[!NOTE]
>Изменения, внесенные в файловый ресурс Azure с помощью функции "ОСТАВШАЯся", не обновляют время последнего изменения SMB и не будут рассматриваться как изменения при синхронизации.

Мы рассматриваем возможность добавления функции обнаружения изменений для общего файлового ресурса Azure, которая будет работать аналогично функции USN для томов в Windows Server. Проголосуйте за эту возможность на портале [UserVoice службы файлов Azure](https://feedback.azure.com/forums/217298-storage/category/180670-files), и мы сможем уделить дополнительное внимание ее разработке в будущем.
