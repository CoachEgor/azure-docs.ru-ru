---
author: roygara
ms.service: storage
ms.topic: include
ms.date: 10/26/2018
ms.author: rogarana
ms.openlocfilehash: 55456a6be938411d3c08a0eaa8fdbfb0844e7129
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "72391768"
---
Изменения, внесенные в общий файловый ресурс Azure с использованием портала Azure или SMB, сразу не обнаруживаются и не реплицируются, как изменения в конечной точке сервера. В службе файлов Azure пока не предусмотрена возможность уведомлений об изменениях или ведение журнала изменений, поэтому автоматически инициировать сеанс синхронизации при изменении файлов невозможно. На Windows Server служба "Синхронизация файлов Azure" использует [ведение журнала номеров последовательного обновления Windows](https://msdn.microsoft.com/library/windows/desktop/aa363798.aspx) для автоматического запуска сеанса синхронизации при изменении файлов.

Для обнаружения изменений в общем файловом ресурсе Azure служба "Синхронизация файлов Azure" использует запланированное задание с именем *change detection job* (задание обнаружения изменений). Это задание перечисляет все файлы в общем файловом ресурсе и затем сравнивает их с синхронизированными версиями этих же файлов. Если задание обнаруживает, что файлы изменились, служба "Синхронизация файлов Azure" инициирует сеанс синхронизации. Задание обнаружения изменений инициируется каждые 24 часа. Так как задание обнаружения изменений перечисляет все файлы в общем файловом ресурсе Azure, на обнаружение изменений в крупном пространстве имен уходит больше времени, чем в небольшом пространстве. В крупных пространствах обнаружение измененных файлов может длиться больше суток.

Для немедленной синхронизации файлов, измененных в доле файла Azure, **cmdlet Invoke-AzStorageSyncChangeDetection** PowerShell может быть использован для ручного инициирования обнаружения изменений в доле файла Azure. Этот cmdlet предназначен для сценариев, где некоторый тип автоматизированного процесса вносит изменения в общий доступ файла Azure или изменения выполняются администратором (например, перемещение файлов и каталогов в общую долю). Для изменения конечных пользователей рекомендуется установить агент Azure File Sync в IaaS VM и получить доступ конечных пользователей к файлу через IaaS VM. Таким образом, все изменения будут быстро синхронизированы с другими агентами без необходимости использования cmdlet Invoke-AzStorageSyncChange. Чтобы узнать больше, смотрите документацию [Invoke-AzStorageSyncChangeDetection.](https://docs.microsoft.com/powershell/module/az.storagesync/invoke-azstoragesyncchangedetection)

>[!NOTE]
>Изменения, внесенные в раздел файла Azure с помощью REST, не обновляют последнее измененное время SMB и не будут рассматриваться как изменение по синхронизации.

Мы рассматриваем возможность добавления функции обнаружения изменений для общего файлового ресурса Azure, которая будет работать аналогично функции USN для томов в Windows Server. Проголосуйте за эту возможность на портале [UserVoice службы файлов Azure](https://feedback.azure.com/forums/217298-storage/category/180670-files), и мы сможем уделить дополнительное внимание ее разработке в будущем.
