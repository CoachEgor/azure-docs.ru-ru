---
author: msmimart
ms.service: active-directory-b2c
ms.subservice: B2C
ms.topic: include
ms.date: 03/19/2020
ms.author: mimart
ms.openlocfilehash: af11283f9e9dbd925ec994dcb1d96393332b90fc
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "80116974"
---
## <a name="use-custom-page-content"></a>Использование пользовательского содержимого страницы

С помощью функции настройки пользовательского интерфейса страницы можно настроить оформление любой настраиваемой политики. Кроме того, можно обеспечить согласованность фирменной символики и визуализации в приложении и службе Azure AD B2C.

### <a name="how-it-works"></a>Принцип работы

Azure AD B2C запускает код в браузере клиента с помощью [Cross-Origin Resource Sharing (CORS).](https://www.w3.org/TR/cors/) Во время выполнения содержимое загружается из URL-адреса, указанного в потоке пользователя или пользовательской политике. Каждая страница в пользовательском интерфейсе загружает свое содержимое из URL-адреса, указанного для этой страницы. После загрузки содержимого из URL-адреса он сливается с фрагментом HTML, вставленным ВАшего B2C Azure AD, а затем страница отображается клиенту.

![Пользовательские поля содержания страницы](./media/active-directory-b2c-html-templates/html-content-merging.png)

## <a name="custom-html-page-content"></a>Пользовательский контент HTML-страниц

Создайте страницу HTML с собственным брендингом, чтобы обслуживать пользовательский контент страницы. Эта страница может `*.html` быть статичной страницей или динамической страницей, такой как .NET, Node.js или PHP.

Пользовательский контент страницы может содержать любые HTML-элементы, включая CSS и JavaScript, но не может включать небезопасные элементы, такие как iframes. Единственным необходимым элементом является `id` элемент `api`div с набором, например, этот в вашей `<div id="api"></div>` странице HTML.

```html
<!DOCTYPE html>
<html>
<head>
    <title>My Product Brand Name</title>
</head>
<body>
    <div id="api"></div>
</body>
</html>
```

### <a name="customize-the-default-azure-ad-b2c-pages"></a>Настройка страниц Azure AD B2C по умолчанию

Вместо того, чтобы создавать пользовательский контент страницы с нуля, можно настроить содержимое страницы Azure AD B2C по умолчанию.

В следующей таблице перечислены содержимое страницы по умолчанию, предоставленное Azure AD B2C. Загрузите файлы и используйте их в качестве отправной точки для создания собственных пользовательских страниц.

| Страница по умолчанию | Описание | Идентификатор для определения содержимого<br/>(только таможенная политика) |
|:-----------------------|:--------|-------------|
| [exception.html](https://login.microsoftonline.com/static/tenant/default/exception.cshtml) | **Страница ошибки**. Эта страница отображается при обнаружении исключения или ошибки. | *api.error* |
| [selfasserted.html](https://login.microsoftonline.com/static/tenant/default/selfAsserted.cshtml) |  **Самоасвивленная страница**. Используйте этот файл в качестве пользовательского содержимого страницы для страницы регистрации учетной записи в социальной сети, страницы регистрации учетной записи, страницы регистрации учетной записи, сбросить пароль и многое другое. Форма может содержать разные элементы управления для ввода текста, например: текстовое поле, поле ввода пароля, переключатель, раскрывающийся список с единственным выбором или флажки множественного выбора. | *api.localaccountsignin*, *api.localaccountaccountsignup*, *api.localaccountpasswordreset*, *api.selfasserted* |
| [мультифактор-1.0.0.html](https://login.microsoftonline.com/static/tenant/default/multifactor-1.0.0.cshtml) | **Страница Многофакторной идентификации.** Эта страница позволяет пользователю подтвердить свой номер телефона (с помощью SMS-сообщения или голосового вызова) во время регистрации или входа. | *api.phonefactor* |
| [updateprofile.html](https://login.microsoftonline.com/static/tenant/default/updateProfile.cshtml) | **Страница обновления профиля.** Эта страница содержит форму для обновления профиля пользователя. Эта страница аналогична странице регистрации локальных учетных записей, за исключением полей для ввода пароля. | *api.selfasserted.profileupdate* |
| [unified.html](https://login.microsoftonline.com/static/tenant/default/unified.cshtml) | **Единая страница регистрации или входа.** Эта страница обрабатывает регистрацию и вход пользователей. Пользователи могут использовать поставщики удостоверений организаций, социальных сетей, включая Facebook и Google+, или локальные учетные записи. | *api.signuporsignin* |

## <a name="hosting-the-page-content"></a>Хостинг содержимого страницы

При использовании собственных файлов HTML и CSS для настройки uI размещайте содержимое uI на любой общедоступной конечной точке HTTPS, поддерживающей CORS. Например, [хранилище Azure Blob,](../articles/storage/blobs/storage-blobs-introduction.md) [службы приложений Azure,](/azure/app-service/)веб-серверы, CDN, AWS S3 или системы обмена файлами.

## <a name="guidelines-for-using-custom-page-content"></a>Руководящие принципы использования пользовательского содержимого страницы

- Используйте абсолютный URL, когда вы включаете внешние ресурсы, такие как медиа, CSS и JavaScript файлы в вашем HTML файле.
- Используя [версию макета страницы](../articles/active-directory-b2c/page-layout.md) 1.2.0 `data-preload="true"` и выше, вы можете добавить атрибут в теги HTML для управления заказом нагрузки для CSS и JavaScript. С `data-preload=true`помощью , страница построена перед тем, как быть показаны пользователю. Этот атрибут помогает предотвратить "мерцание" страницы, предварительно загрузив файл CSS, без не-стиле HTML отображается пользователю. Следующий фрагмент кода HTML показывает использование `data-preload` тега.
  ```HTML
  <link href="https://path-to-your-file/sample.css" rel="stylesheet" type="text/css" data-preload="true"/>
  ```
- Мы рекомендуем начать с содержимого страницы по умолчанию и построить сверху.
- Вы можете включить JavaScript в пользовательский контент как для [потоков пользователей,](../articles/active-directory-b2c/user-flow-javascript-overview.md) так и для [пользовательских политик.](../articles/active-directory-b2c/javascript-samples.md)
- Поддерживаемые версии браузеров:
  - Internet Explorer 11, 10 и Microsoft Edge
  - ограниченная поддержка Internet Explorer 9 и Internet Explorer 8;
  - Google Chrome 42.0 и выше
  - Mozilla Firefox 38.0 и выше
  - Safari для iOS и macOS, версия 12 и выше
- Из-за ограничений безопасности Azure AD `frame`B2C не поддерживает `iframe`или `form` HTML-элементы.

## <a name="custom-page-content-walkthrough"></a>Пользовательское пошаг-застое содержимого страницы

Вот обзор процесса:

1. Подготовьте место для размещения пользовательского содержимого страницы (общедоступная конечная точка HTTPS с поддержкой CORS).
1. Например, `unified.html`скачать и настроить файл содержимого страницы по умолчанию.
1. Опубликуйте пользовательский контент страницы своей общедоступной конечной точкой HTTPS.
1. настройка общего доступа к ресурсам независимо от источника (CORS) для своего веб-приложения;
1. Направьте свою политику на пользовательский контент URI.

### <a name="1-create-your-html-content"></a>1. Создайте свой HTML-контент

Создайте пользовательский контент страницы с фирменным наименованием вашего продукта.

1. Скопируйте следующий фрагмент кода HTML. Это хорошо сформировавшийся HTML5 с пустым элементом, называемым * \<div\>\<id'"api" /div,\> * расположенным * \<\> * внутри тегов тела. Этот элемент определяет расположение, в которое будет вставлено содержимое Azure AD B2C.

   ```html
   <!DOCTYPE html>
   <html>
   <head>
       <title>My Product Brand Name</title>
   </head>
   <body>
       <div id="api"></div>
   </body>
   </html>
   ```

1. Вставьте скопированный фрагмент кода в текстовый редактор и сохраните файл как *customize-ui.html*.

> [!NOTE]
> Элементы HTML-формы будут удалены из-за ограничений безопасности, если вы используете login.microsoftonline.com. Если вы хотите использовать элементы HTML формы в пользовательском HTML-контенте, [используйте b2clogin.com.](../articles/active-directory-b2c/b2clogin.md)

### <a name="2-create-an-azure-blob-storage-account"></a>2. Создание учетной записи хранения Azure Blob

В этой статье мы используем хранилище BLOB-объектов Azure для размещения содержимого. Можно выбрать для этого веб-сервер, но тогда нужно [включить для веб-сервера поддержку CORS](https://enable-cors.org/server.html).

Чтобы разместить HTML-контент в хранилище Blob, выполните следующие действия:

1. Войдите на [портал Azure](https://portal.azure.com).
1. В меню **Концентратор** выберите **Создать** > **Хранилище** > **Учетная запись хранения**.
1. Выберите **подписку** для своей учетной записи хранения.
1. Создайте **группу ресурсов** или выберите существующую.
1. Введите уникальное **имя** учетной записи хранения.
1. Выберите **географическое местоположение** для учетной записи хранения.
1. Для параметра **Модель развертывания** можно оставить значение **Диспетчер ресурсов**.
1. Для параметра **Производительность** можно оставить значение **Стандартная**.
1. Измените **тип учетной записи** на **хранилище BLOB-объектов**.
1. Для параметра **Репликация** можно оставить значение **RA-GRS**.
1. Для параметра **Уровень доступа** можно оставить значение **Горячий**.
1. Выберите **Обзор и создать** для создания учетной записи хранилища.
    После завершения развертывания страница **учетной записи хранилища** открывается автоматически.

#### <a name="21-create-a-container"></a>2.1 Создание контейнера

Чтобы создать общедоступный контейнер в хранилище Blob, выполните следующие действия:

1. Под **услугой Blob** в левом меню выберите **Blobs**.
1. Выберите **контейнер**.
1. Для **имени,** введите *корень*. Имя может быть имя по вашему выбору, например *contoso*, но мы используем *корень* в этом примере для простоты.
1. Для **уровня общественного доступа,** выберите **Blob**, затем **OK**.
1. Выберите **корень,** чтобы открыть новый контейнер.

#### <a name="22-upload-your-custom-page-content-files"></a>2.2 Загрузить файлы содержимого специальной страницы

1. Выберите команду **Отправить**.
1. Выберите значок папки рядом с **Выберите файл.**
1. Перейдите на и выберите **настроить-ui.html**, который вы создали ранее в разделе настройки пользовательского ключа Страницы.
1. Если вы хотите загрузить в субфолдер, расширьте **Расширенное** и введите имя папки в **папке Upload в папку.**
1. Выберите команду **Отправить**.
1. Выберите загрузоченную каплю **для настройки-ui.html.**
1. Справа от текстового окна **URL** выберите **значок copy to clipboard,** чтобы скопировать URL-адрес на буфер обмена.
1. В веб-браузере перейдите к URL-адресу, который вы скопировали, чтобы проверить доступ к загружаемой каплей. Если он недоступен, например, `ResourceNotFound` если вы столкнулись с ошибкой, убедитесь, что тип доступа к контейнеру настроен на **blob.**

### <a name="3-configure-cors"></a>3. Настройка CORS

Нанастройка хранилища Blob для совместного использования ресурсов Cross-Origin, выполняя следующие действия:

1. В меню выберите **CORS**.
1. В поле **Допустимые источники** введите `https://your-tenant-name.b2clogin.com`. Замените `your-tenant-name` именем вашего клиента Azure AD B2C. Например, `https://fabrikam.b2clogin.com`. Используйте все буквы в нижнем регистре при вводе имени арендатора.
1. В поле **Допустимые методы** выберите `GET` и `OPTIONS`.
1. В поле **Допустимые заголовки** введите звездочку (*).
1. В поле **Доступные заголовки** введите звездочку (*).
1. В поле **Максимальный возраст** введите 200.
1. Нажмите кнопку **Сохранить**.

#### <a name="31-test-cors"></a>3.1 Тест CORS

Проверка готовности, выполнив следующие действия:

1. Повторите настройку шага CORS. Для **разрешенного происхождения,** введите`https://www.test-cors.org`
1. Перейдите к [www.test-cors.org](https://www.test-cors.org/) 
1. Для **удаленного** окна URL, вставьте URL-адрес вашего HTML файла. Например `https://your-account.blob.core.windows.net/azure-ad-b2c/unified.html`.
1. Выберите **Запрос на отправку**.
    Результат должен `XHR status: 200`быть . 
    Если произошла ошибка, проверьте правильность параметров CORS. Кроме того, вам может потребоваться очистить кэш браузера или открыть закрытый сеанс, нажав CTRL+SHIFT+P.
