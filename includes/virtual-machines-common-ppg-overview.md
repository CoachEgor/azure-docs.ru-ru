---
title: Включить имя файла
description: включить файл
services: virtual-machines
author: cynthn
ms.service: virtual-machines
ms.topic: include
ms.date: 10/30/2019
ms.author: zivr
ms.custom: include file
ms.openlocfilehash: fb2eb2d237a1245627bbdb6f4f2eacbb9966a2c6
ms.sourcegitcommit: 849bb1729b89d075eed579aa36395bf4d29f3bd9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2020
ms.locfileid: "81421881"
---
Размещение виртуальных машин в одном регионе сокращает физическое расстояние между экземплярами. Поместив их в одну зону доступности, вы также объедините их физически ближе друг к другу. Тем не менее, по мере роста объема Azure одна зона доступности может охватывать несколько физических центров обработки данных, что может привести к задержке в сети, влияющей на приложение. 

Чтобы виртуальные машины максимально близки к максимально возможной задержке, следует развернуть их в группе размещения с учетом расположения.

Группа размещения с учетом расположения — это логическая группировка, используемая для того, чтобы ресурсы вычислений Azure физически размещались близко друг к другу. Группы размещения с учетом расположения удобны для рабочих нагрузок, где требуется низкая задержка.


- Низкая задержка между автономными виртуальными машинами.
- Низкая задержка между виртуальными машинами в одной группе доступности или масштабируемом наборе виртуальных машин. 
- Низкая задержка между автономными виртуальными машинами, виртуальными машинами из нескольких групп доступности или несколькими масштабируемыми наборами. Можно использовать несколько ресурсов вычислений в одной группе размещения для объединения многоуровневого приложения. 
- Низкая задержка между несколькими уровнями приложения с использованием различных типов оборудования. Например, запуск серверной части с помощью серии M в группе доступности и внешнего интерфейса в экземпляре серии D в масштабируемом наборе в одной из групп размещения с близкой назначением.


![Рисунок для групп размещения с близкой нарядом](./media/virtual-machines-common-ppg/ppg.png)

## <a name="using-proximity-placement-groups"></a>Использование групп размещения с учетом расположения 

Группа размещения с близкой назначением — это новый тип ресурса в Azure. Необходимо создать его, прежде чем использовать его с другими ресурсами. После создания его можно использовать с виртуальными машинами, группами доступности или масштабируемыми наборами виртуальных машин. Группа размещения с учетом расположения указывается при создании ресурсов вычислений, предоставляющих идентификатор группы размещения близости. 

Можно также переместить существующий ресурс в группу размещения с учетом расположения. При перемещении ресурса в группу размещения с учетом расположения необходимо сначала отменить (освободить) ресурс-контейнер, так как он будет повторно развернут в другом центре обработки данных в регионе, что соответствует ограничению совместного размещения. 

В случае групп доступности и масштабируемых наборов виртуальных машин следует задать группу размещения с учетом расположения на уровне ресурсов, а не на отдельных виртуальных машинах. 

Группа размещения с близкой назначением является ограничением совместного размещения, а не механизмом закрепления. Он закреплен в определенном центре обработки данных с развертыванием первого ресурса для его использования. После того как все ресурсы, использующие группу размещения с учетом расположения, были остановлены (освобождены) или удалены, они больше не фиксируются. Поэтому при использовании группы размещения с несколькими виртуальными машинами важно указать все требуемые типы в начале шаблона, если это возможно, или следовать последовательности развертывания, что повысит вероятность успешного развертывания. В случае сбоя развертывания перезапустите развертывание с размером виртуальной машины, который завершился сбоем в качестве первого развернутого размера.

## <a name="what-to-expect-when-using-proximity-placement-groups"></a>Что следует рассчитывать при использовании групп размещения с учетом расположения 
Группы размещения с близкой назначением предлагают совместное размещение в одном центре обработки данных. Однако, поскольку группы размещения близкого взаимодействия представляют дополнительное ограничение развертывания, могут возникать сбои выделения. Существует несколько вариантов использования, когда при использовании групп размещения с учетом расположения могут возникнуть сбои выделения:

- Когда вы запрашиваете первую виртуальную машину в группе размещения с учетом расположения, центр обработки данных выбирается автоматически. В некоторых случаях второй запрос номера SKU виртуальной машины может завершиться ошибкой, если он не существует в этом центре обработки данных. В этом случае возвращается ошибка **оверконстраинедаллокатионрекуест** . Чтобы избежать этого, попробуйте изменить порядок развертывания номеров SKU или разворачивать оба ресурса с помощью одного шаблона ARM.
-   В случае эластичных рабочих нагрузок, в которых вы добавляете и удаляете экземпляры виртуальных машин, наличие ограничения группы размещения с учетом расположения в развертывании может привести к сбою запроса, что приведет к ошибке **аллокатионфаилуре** . 
- Остановка (освобождение) и запуск виртуальных машин по мере необходимости — это еще один способ достижения эластичности. Так как емкость не сохраняется после завершения (освобождения) виртуальной машины, ее повторный запуск может привести к ошибке **аллокатионфаилуре** .


## <a name="best-practices"></a>Рекомендации 
- Для наименьшей задержки используйте группы размещения близкого взаимодействия с ускоренной сетью. Дополнительные сведения см. в статьях [Создание виртуальной машины Linux с ускоренной сетью](https://docs.microsoft.com/azure/virtual-network/create-vm-accelerated-networking-cli?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json) или [Создание виртуальной машины Windows с ускоренной сетью](/azure/virtual-network/create-vm-accelerated-networking-powershell?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).
- Развертывание всех размеров виртуальных машин в одном шаблоне. Чтобы избежать размещения на оборудовании, которое не поддерживает все требуемые номера SKU и размеры виртуальных машин, включите все уровни приложения в один шаблон, чтобы все они были развернуты одновременно.
- Если вы задаете скрипты развертывания с помощью PowerShell, CLI или пакета SDK, может возникнуть ошибка `OverconstrainedAllocationRequest`выделения памяти. В этом случае следует отменить или освободить все существующие виртуальные машины, а также изменить последовательность в скрипте развертывания, чтобы она начиналась с номера SKU или размеров виртуальной машины, для которых произошел сбой. 
- При повторном использовании существующей группы размещения, из которой были удалены виртуальные машины, дождитесь полного завершения удаления, прежде чем добавлять в него виртуальные машины.
- Если задержка является первым приоритетом, помещайте виртуальные машины в группу размещения с учетом расположения и все решение в зоне доступности. Но если устойчивость является высшим приоритетом, распространение экземпляров между несколькими зонами доступности (одна группа размещения с одинаковым размещением не может охватывать зоны).
