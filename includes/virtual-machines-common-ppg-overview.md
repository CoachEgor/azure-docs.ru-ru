---
title: включить файл
description: включить файл
services: virtual-machines
author: cynthn
ms.service: virtual-machines
ms.topic: include
ms.date: 10/30/2019
ms.author: zivr
ms.custom: include file
ms.openlocfilehash: fb2eb2d237a1245627bbdb6f4f2eacbb9966a2c6
ms.sourcegitcommit: b80aafd2c71d7366838811e92bd234ddbab507b6
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/16/2020
ms.locfileid: "81421881"
---
Размещение водно-мыйобъемов в одном регионе сокращает физическое расстояние между экземплярами. Размещение их в пределах единой зоны доступности также сблизит их физически. Однако по мере роста следа Azure единая зона доступности может охватывать несколько физических центров обработки данных, что может привести к задержке сети, что повлияет на ваше приложение. 

Чтобы максимально приблизить визы, с наименьшими задержками, следует развернуть их в группе размещения.

Группа размещения близости — это логическая группировка, используемая для того, чтобы обеспечить физические расположения ресурсов Azure вычислений близко друг к другу. Группы размещения близости полезны для рабочих нагрузок, где требуется низкая задержка.


- Низкая задержка между автономными VM.
- Низкая задержка между виртуальными машинами в одном наборе доступности или виртуальном наборе масштабов машины. 
- Низкая задержка между автономными VMs, VMs в нескольких наборах доступности или несколькими наборами масштабов. Вы можете иметь несколько вычислительных ресурсов в одной группе размещения, чтобы объединить многоуровневое приложение. 
- Низкая задержка между несколькими уровнями приложений с использованием различных типов оборудования. Например, запуск бэкэнда с использованием M-серии в наборе доступности и переднего конца на экземпляре D-серии, в наборе масштабов, в одной группе размещения близости.


![Графика для групп размещения близости](./media/virtual-machines-common-ppg/ppg.png)

## <a name="using-proximity-placement-groups"></a>Использование групп размещения близости 

Группа размещения близости — это новый тип ресурсов в Azure. Вы должны создать один, прежде чем использовать его с другими ресурсами. После создания его можно использовать с помощью виртуальных машин, наборов доступности или виртуальных наборов масштабов машин. Вы указываете группу размещения при создании вычислительных ресурсов, обеспечивающих идентификатор группы размещения. 

Можно также переместить существующий ресурс в группу размещения. При перемещении ресурса в группу размещения близости следует сначала остановить (делокацию) актив, так как он будет потенциально передислоцирован в другой центр обработки данных в регионе, чтобы удовлетворить ограничение колокации. 

В случае наборов доступности и виртуальных наборов масштабов машин следует установить группу размещения непосредственной близости на уровне ресурсов, а не отдельные виртуальные машины. 

Группа размещения близости является ограничением колокации, а не механизмом закрепления. Он прикрепляется к определенному центру обработки данных с развертыванием первого ресурса для его использования. После того, как все ресурсы, использующие группу размещения близости, были остановлены (удалены) или удалены, они больше не возлагаются. Поэтому при использовании группы размещения непосредственного размещения с несколькими сериями VM важно указать все необходимые типы заранее в шаблоне, когда это возможно, или следовать последовательности развертывания, которая улучшит ваши шансы на успешное развертывание. Если развертывание завершается неудачей, перезапустите развертывание с размером VM, который не сработал в качестве первого размера, который будет развернут.

## <a name="what-to-expect-when-using-proximity-placement-groups"></a>Чего ожидать при использовании групп размещения близости 
Группы размещения близости предлагают совместное размещение в одном центре обработки данных. Однако из-за того, что группы размещения близости представляют собой дополнительное ограничение развертывания, могут возникнуть сбои в распределении. Существует несколько случаев использования, когда при использовании групп размещения ней можно увидеть сбои в распределении:

- Когда вы запрашиваете первую виртуальную машину в группе размещения непосредственной близости, центр обработки данных автоматически выбирается. В некоторых случаях второй запрос на другой виртуальный компьютер SKU может выполнить неудачу, если он не существует в этом центре обработки данных. В этом случае возвращается ошибка **OverconstrainedAllocationRequest.** Чтобы избежать этого, попробуйте изменить порядок развертывания SKUs или развертывание обоих ресурсов с помощью единого шаблона ARM.
-   В случае эластичных рабочих нагрузок, когда вы добавляете и удаляете экземпляры VM, ограничение группы размещения на развертывании может привести к невыполнению запроса, что приведет к ошибке **AllocationFailure.** 
- Остановка (дераспределение) и запуск вашего ВМ по мере необходимости является еще одним способом достижения эластичности. Поскольку емкость не сохраняется после остановки (дераспределения) VM, запуск снова может привести к ошибке **AllocationFailure.**


## <a name="best-practices"></a>Рекомендации 
- Для наименьшей задержки используйте группы размещения непосредственной близости вместе с ускоренными сетями. Для получения дополнительной информации [см. Создать виртуальную машину Linux с ускоренной сети](https://docs.microsoft.com/azure/virtual-network/create-vm-accelerated-networking-cli?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json) или создать [виртуальную машину Windows с ускоренной сети](/azure/virtual-network/create-vm-accelerated-networking-powershell?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).
- Развертывание всех размеров VM в одном шаблоне. Чтобы избежать посадки на оборудование, которое не поддерживает все VM SKUs и требуемые размеры, включите все уровни приложения в единый шаблон, чтобы все они были развернуты в одно и то же время.
- При написании сценариев развертывания с помощью PowerShell, CLI или `OverconstrainedAllocationRequest`SDK может возникнуть ошибка распределения. В этом случае следует остановить/распределить все существующие визы и изменить последовательность в сценарии развертывания, чтобы начать с сбой VM SKU/размеров. 
- При повторном использовании существующей группы размещения, из которой были удалены ВМ, подождите, пока удаление будет полностью завершено, прежде чем добавлять в него ВМ.
- Если задержка является вашим первым приоритетом, поместите ВМ в группу размещения на неподалеку и все решение в зоне доступности. Но, если устойчивость является вашим главным приоритетом, распределите экземпляры по нескольким зонам доступности (одна группа размещения не может охватывать зоны).
