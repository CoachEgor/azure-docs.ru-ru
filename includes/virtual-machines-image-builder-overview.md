---
author: cynthn
ms.author: cynthn
ms.date: 01/23/2020
ms.topic: include
ms.service: virtual-machines-linux
manager: gwallace
ms.openlocfilehash: 00fc3a01e6f42c2704af9dbc807dce193ff2971c
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "80117064"
---
Стандартизированные изображения виртуальных машин (VM) позволяют организациям мигрировать в облако и обеспечивать согласованность в развертывании. Изображения обычно включают предопределенные настройки безопасности и конфигурации и необходимое программное обеспечение. Настройка собственного конвейера изображений требует времени, инфраструктуры и настройки, но с Azure VM Image Builder просто обеспечить простую конфигурацию, описывающую ваше изображение, отправить его в службу, и изображение построено и распределено.
 
A Azure VM Image Builder (Azure Image Builder) позволяет начать с изображения Azure Marketplace на базе Windows или Linux, существующих пользовательских изображений или Red Hat Enterprise Linux (RHEL) ISO и начать добавлять собственные настройки. Поскольку Image Builder построен на [HashiCorp Packer,](https://packer.io/)вы также можете импортировать существующие скрипты обеспечения оболочки Packer. Вы также можете указать, где вы хотели бы, чтобы ваши изображения размещены, в [галерее общих изображений Azure](https://docs.microsoft.com/azure/virtual-machines/windows/shared-image-galleries), как управляемое изображение или VHD.

> [!IMPORTANT]
> В настоящее время Azure Image Builder находится в открытом доступе.
> Эта предварительная версия предоставляется без соглашения об уровне обслуживания и не рекомендована для использования рабочей среде. Некоторые функции могут не поддерживаться или их возможности могут быть ограничены. Дополнительные сведения см. в статье [Дополнительные условия использования предварительных выпусков Microsoft Azure](https://azure.microsoft.com/support/legal/preview-supplemental-terms/).

## <a name="preview-features"></a>Функции предварительной версии

Для предварительного просмотра эти функции поддерживаются:

- Создание золотых базовых изображений, которые включают в себя минимальную безопасность и корпоративные конфигурации, и позволяют отделам настроить его для своих нужд.
- Патчирование существующих изображений, Image Builder позволит вам постоянно патч существующих пользовательских изображений.
- Подключите генератор изображений к существующим виртуальным сетям, чтобы вы могли подключиться к существующим серверам конфигурации (DSC, Chef, Puppet и т.д.), файлоем или любым другим серверам/услугам.
- Интеграция с галереей общих изображений Azure позволяет распространять, просматривать и масштабировать изображения по всему миру и дает вам систему управления изображениями.
- Интеграция с существующими конвейерами сборки изображений просто позвоните в Image Builder из конвейера или воспользуйтесь простой задачей Preview Image Builder Azure DevOps.
- Воспроизвносите существующий конвейер настройки изображений в Azure. Используйте существующие скрипты, команды и процессы для настройки изображений.
- Создание изображений в формате VHD.
 

## <a name="regions"></a>Регионы
Служба поиска изображений Azure будет доступна для предварительного просмотра в этих регионах. Изображения могут быть распределены за пределами этих регионов.
- Восточная часть США
- восточная часть США 2
- центрально-западная часть США
- западная часть США
- западная часть США 2
- Северная Европа
- Западная Европа

## <a name="os-support"></a>Поддержка ОС
AIB будет поддерживать изображения базы ОС Azure Marketplace:
- Ubuntu 18.04
- Ubuntu 16.04
- РХЕ 7,6, 7,7
- CentOS 7.6, 7.7
- SLES 12 SP4
- SLES 15, SLES 15 SP1
- Windows 10 RS5 Предприятие/ Профессиональное/Предприятие для виртуального рабочего стола (EVD) 
- Windows 2016
- Windows 2019

Поддержка RHEL ISOs в настоящее время аунулируется, пожалуйста, ознакомьтесь с документацией шаблона для получения более подробной информации.

## <a name="how-it-works"></a>Принцип работы


![Концептуальный рисунок строителя изображений Azure](./media/virtual-machines-image-builder-overview/image-builder.png)

Развысок Azure Image Builder — это полностью управляемый сервис Azure, доступный поставщику ресурсов Azure. Процесс Azure Image Builder имеет три основные части: исходный, настраиваемый и распространяемый, они представлены в шаблоне. На приведенной ниже диаграмме показаны компоненты с некоторыми их свойствами. 
 


**Процесс строителя изображений** 

![Концептуальный рисунок процесса разработки изображений Azure](./media/virtual-machines-image-builder-overview/image-builder-process.png)

1. Создайте шаблон изображения в виде файла .json. Этот файл .json содержит информацию об источнике изображения, настройках и распределении. В [репозитории Azure Image Builder GitHub](https://github.com/danielsollondon/azvmimagebuilder/tree/master/quickquickstarts)есть несколько примеров.
1. Отправьте его в службу, это создаст артефакт шаблона изображений в группе ресурсов, которые вы указываете. На заднем плане Image Builder загружает исходное изображение или ISO, а также сценарии по мере необходимости. Они хранятся в отдельной группе ресурсов, которая автоматически создается в подписке, в формате: IT_\<DestinationResourceGroup>_\<TemplateName>. 
1. После создания шаблона изображения можно создать изображение. В фоновом режиме Image Builder использует шаблон и исходные файлы для создания VM (размер по\<умолчанию:\<Standard_D1_v2), сети, общественного IP, NSG и хранения в IT_ DestinationResourceGroup>_ TemplateName> группы ресурсов.
1. В рамках создания изображения, Image builder распространяет изображение его в соответствии с\<шаблоном,\<а затем удаляет дополнительные ресурсы в IT_ DestinationResourceGroup>_ TemplateName> группы ресурсов, которая была создана для процесса.


## <a name="permissions"></a>Разрешения

Чтобы разрешить Azure VM Image Builder распространять изображения либо на управляемых изображениях, либо в галерею общих изображений, необходимо предоставить разрешения 'Contributor' для службы "Azure Virtual Machine Image Builder" (идентификатор приложения: cf32a0cc-373c-47c9-9156-0db11f6a6dfc ) на ресурсных группах. 

Если вы используете существующую пользовательскую управляемую версию изображения или изображения, то для вас будет нужен минимальный доступ к группам ресурсов 'Reader'.

Вы можете назначить доступ с помощью Azure CLI:

```azurecli-interactive
az role assignment create \
    --assignee cf32a0cc-373c-47c9-9156-0db11f6a6dfc \
    --role Contributor \
    --scope /subscriptions/$subscriptionID/resourceGroups/<distributeResoureGroupName>
```

Вы можете назначить доступ с помощью PowerShell:

```azurePowerShell-interactive
New-AzRoleAssignment -ObjectId ef511139-6170-438e-a6e1-763dc31bdf74 -Scope /subscriptions/$subscriptionID/resourceGroups/<distributeResoureGroupName> -RoleDefinitionName Contributor
```


Если учетная запись службы не найдена, это может означать, что подписка, в которой вы добавляете назначение ролей, еще не зарегистрирована для поставщика ресурсов.


## <a name="costs"></a>Затраты
При создании, создании и хранении изображений с помощью Azure Image Builder вы понесете затраты на вычисления, сеть и хранение. Эти затраты аналогичны затратам, понесенным при ручном создании пользовательских изображений. За ресурсы с вас будет взиматься плата по тарифам Azure. 

В процессе создания изображения файлы загружаются и хранятся в группе `IT_<DestinationResourceGroup>_<TemplateName>` ресурсов, что понесет небольшие затраты на хранение. Если вы не хотите хранить их, удалите **шаблон изображения** после создания изображения.
 
Image Builder создает VM, используя размер D1v2 VM, а также хранилище и сети, необходимые для VM. Эти ресурсы будут продолжаться в течение всего процесса сборки и будут удалены после того, как Image Builder завершит создание изображения. 
 
Azure Image Builder распространяет изображение по выбранным регионам, что может повлечь за собой сборы за выход из сети.
 
## <a name="next-steps"></a>Дальнейшие действия 
 
Чтобы опробовать Систему изображений Azure, смотрите статьи для создания [изображений Linux](../articles/virtual-machines/linux/image-builder.md) или [Windows.](../articles/virtual-machines/windows/image-builder.md)
 
 
