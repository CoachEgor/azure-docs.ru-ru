---
author: memildin
ms.author: memildin
manager: rkarlin
ms.date: 02/24/2020
ms.topic: include
ms.openlocfilehash: 78bf29a170152666d82ec26504ee8f61ed90636a
ms.sourcegitcommit: acc558d79d665c8d6a5f9e1689211da623ded90a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/30/2020
ms.locfileid: "82616033"
---
## <a name="attack-scenario"></a>Сценарий атаки

Целью атак методом подбора часто становятся порты управления как средство получения доступа к виртуальной машине. В случае успешной атаки злоумышленник может установить контроль над виртуальной машиной и закрепиться в вашей среде.

Один из способов снижения вероятности атаки методом подбора — ограничить количество времени, в течение которого порт открыт. Порты управления не обязательно открывать в любое время. Они должны быть открыты только при подключении к виртуальной машине, например для выполнения задач по управлению или обслуживанию. Если включена JIT, центр безопасности использует [группу безопасности сети](../articles/virtual-network/security-overview.md#security-rules) (NSG) и правила брандмауэра Azure, которые ограничивают доступ к портам управления, чтобы они не могли быть направлены злоумышленниками.

![Сценарий JIT-доступа](../articles/security-center/media/security-center-just-in-time/just-in-time-scenario.png)

## <a name="how-does-jit-access-work"></a>Как работает JIT-доступ?

Если включен JIT-доступ, Центр безопасности создает правило группы безопасности сети для блокирования входящего трафика, поступающего на виртуальную машину Azure. Вы выбираете порты на виртуальной машине, для которых будет заблокирован входящий трафик. Этими портами управляет решение JIT-доступа.

Когда пользователь запрашивает доступ к виртуальной машине, центр безопасности проверяет, имеет ли пользователь разрешения [на управление доступом на основе ролей (RBAC)](../articles/role-based-access-control/role-assignments-portal.md) для этой виртуальной машины. Если запрос утвержден, центр безопасности автоматически настраивает группы безопасности сети (группы безопасности сети) и брандмауэр Azure, чтобы разрешить входящий трафик к выбранным портам и запрошенным исходным IP-адресам или диапазонам, за указанный период времени. После истечения этого времени центр безопасности восстанавливает прежнее состояние групп безопасности сети. Однако это не прерывает установленные подключения.

 > [!NOTE]
 > Если запрос на JIT-доступ утвержден для виртуальной машины за брандмауэром Azure, центр безопасности автоматически изменяет правила политики NSG и брандмауэра. В течение указанного времени правила разрешают входящий трафик на выбранные порты и запрошенные исходные IP-адреса или диапазоны. По истечении этого времени центр безопасности восстанавливает правила брандмауэра и NSG в предыдущие состояния.


## <a name="roles-that-can-read-jit-policies"></a>Роли, которые могут считывать политики JIT

Роли **Reader** и **секуритиреадер** могут считывать политики.

## <a name="permissions-needed-to-configure-and-use-jit"></a>Разрешения, необходимые для настройки и использования JIT-доступа

Если вы хотите создать пользовательские роли, которые могут работать с JIT-компилятором, вам понадобятся следующие сведения:

| Чтобы предоставить пользователю следующие возможности: | Разрешения для установки|
| --- | --- |
| Настройка или изменение политики JIT для виртуальной машины | *Назначьте этой роли следующие действия.*  <ul><li>В области подписки или группы ресурсов, связанной с виртуальной машиной:<br/> `Microsoft.Security/locations/jitNetworkAccessPolicies/write` </li><li> В области подписки или группы ресурсов виртуальной машины: <br/>`Microsoft.Compute/virtualMachines/write`</li></ul> | 
|Запрос JIT-доступа к виртуальной машине | *Назначьте пользователю следующие действия:*  <ul><li>В области подписки или группы ресурсов, связанной с виртуальной машиной:<br/>  `Microsoft.Security/locations/jitNetworkAccessPolicies/initiate/action` </li><li>В области подписки или группы ресурсов, связанной с виртуальной машиной:<br/>  `Microsoft.Security/locations/jitNetworkAccessPolicies/*/read` </li><li>  В области подписки, группы ресурсов или виртуальной машины:<br/> `Microsoft.Compute/virtualMachines/read` </li><li>  В области подписки, группы ресурсов или виртуальной машины:<br/> `Microsoft.Network/networkInterfaces/*/read` </li></ul>|
|Чтение политик JIT| *Назначьте пользователю следующие действия:*  <ul><li>`Microsoft.Security/locations/jitNetworkAccessPolicies/read`</li><li>`Microsoft.Security/locations/jitNetworkAccessPolicies/initiate/action`</li><li>`Microsoft.Security/policies/read`</li><li>`Microsoft.Compute/virtualMachines/read`</li><li>`Microsoft.Network/*/read`</li>|