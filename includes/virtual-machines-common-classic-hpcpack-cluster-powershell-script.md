---
author: cynthn
ms.service: virtual-machines
ms.topic: include
ms.date: 10/26/2018
ms.author: cynthn
ms.openlocfilehash: 6f0d2d59ed50c743adb19027c404bfa83a1886f1
ms.sourcegitcommit: 3102f886aa962842303c8753fe8fa5324a52834a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "61485612"
---
В зависимости от вашей среды и предпочтений скрипт может создать всю инфраструктуру кластера, в том числе виртуальную сеть Azure, учетные записи хранения, облачные службы, контроллер домена, удаленные и локальные базы данных SQL, головной узел и дополнительные узлы кластера. Или скрипт может с помощью уже существующей инфраструктуры Azure ограничиться созданием узлов кластера HPC.

Общие сведения о планировании кластера пакета HPC см. в статьях [Product Evaluation and Planning](https://technet.microsoft.com/library/jj899596.aspx) (Оценка и планирование продукта) и [Getting Started](https://technet.microsoft.com/library/jj899590.aspx) (Приступая к работе), посвященных пакету HPC 2012 R2, в библиотеке TechNet.

## <a name="prerequisites"></a>Технические условия
* **Подписка Azure**: Подписки можно использовать в службе Azure Global или Azure для Китая. Ограничения подписки влияют на количество и тип узлов кластера, которые вы можете развернуть. Дополнительные сведения см. в статье [Подписка Azure, границы, квоты и ограничения службы](../articles/azure-subscription-service-limits.md).
* **Клиентский компьютер Windows с помощью Azure PowerShell 0.8.10 или более поздней версии установлен и настроен**: См. в разделе [приступить к работе с Azure PowerShell](/powershell/azureps-cmdlets-docs) инструкции по установке и действия для подключения к подписке Azure.
* **Сценарий развертывания IaaS пакета HPC**: Загрузите и распакуйте последнюю версию сценария, [центра загрузки Майкрософт](https://www.microsoft.com/download/details.aspx?id=44949). Проверьте версию сценария, запустив `New-HPCIaaSCluster.ps1 –Version`. В этой статье предполагается использование скрипта версии 4.5.2.
* **Файл конфигурации скрипта**: Создайте XML-файл, который использует скрипт для настройки кластера HPC. Информацию и примеры см. в следующих разделах этой статьи и в файле Manual.rtf, сопровождающем скрипт развертывания.

## <a name="syntax"></a>Синтаксис
```powershell
New-HPCIaaSCluster.ps1 [-ConfigFile] <String> [-AdminUserName]<String> [[-AdminPassword] <String>] [[-HPCImageName] <String>] [[-LogFile] <String>] [-Force] [-NoCleanOnFailure] [-PSSessionSkipCACheck] [<CommonParameters>]
```
> [!NOTE]
> Запустите скрипт от имени администратора.
> 
> 

### <a name="parameters"></a>Параметры
* **ConfigFile**: Задает путь файла конфигурации для описания кластера HPC. Дополнительные сведения о файле конфигурации см. в этой статье или в файле Manual.rtf в папке со скриптом.
* **AdminUserName**: Указывает имя пользователя. Если с помощью скрипта создается лес доменов, указанное здесь значение становится именем локального администратора для всех виртуальных машин, а также именем администратора домена. Если доменный лес уже существует, указанное здесь значение становится именем пользователя локального администратора, которое будет использоваться для установки пакета HPC.
* **AdminPassword**: Указывает пароль администратора. Если значение не указано в командной строке, скрипт предложит ввести пароль.
* **HPCImageName** (необязательно): Указывает имя образа виртуальной Машины пакета HPC, используемый для развертывания кластера HPC. Это должен быть образ пакета HPC от корпорации Майкрософт (доступен в Azure Marketplace). Если значение не указано (рекомендуется в большинстве случаев), скрипт выбирает последний опубликованный [образ пакета HPC 2012 R2](https://azure.microsoft.com/marketplace/partners/microsoft/hpcpack2012r2onwindowsserver2012r2/). Последняя версия образа предполагает, что установлена ОС Windows Server 2012 R2 Datacenter с пакетом HPC 2012 R2 с обновлением 3.
  
  > [!NOTE]
  > Если не указать действительный образ пакета HPC, развертывание завершится ошибкой.
  > 
  > 
* **Файл журнала** (необязательно): Указывает путь к файлу журнала развертывания. Если значение не указано, скрипт создаст файл журнала во временной папке на компьютере, на котором выполняется скрипт.
* **Force** (необязательно): Подавляет все запросы подтверждения.
* **NoCleanOnFailure** (необязательно): Указывает, что виртуальные машины Azure, которые не были успешно развернуты, не удаляются. Перед повторным выполнением скрипта следует удалить такие виртуальные машины вручную. В противном случае может произойти сбой развертывания.
* **PSSessionSkipCACheck** (необязательно): Для каждой облачной службы с виртуальными машинами, развернутыми этим скриптом Azure автоматически создает самозаверяющий сертификат, и все виртуальные машины в облачной службе используют этот сертификат как сертификат удаленного управления Windows (WinRM) по умолчанию. Чтобы развернуть компоненты HPC на этих виртуальных машинах Azure, по умолчанию скрипт временно устанавливает эти сертификаты в хранилище "Локальный компьютер\\Доверенные корневые центры сертификации". Это делается для того, чтобы во время выполнения скрипта подавить ошибки безопасности, связанные с ЦС, который не является доверенным. После завершения выполнения скрипта сертификаты удаляются. Если этот параметр задан, сертификаты не устанавливаются на локальный компьютер, а предупреждения системы безопасности подавляются.
  
  > [!IMPORTANT]
  > Не рекомендуется использовать этот параметр для развертывания в рабочей среде.
  > 
  > 

### <a name="example"></a>Пример
В следующем примере создается HPC-кластер с помощью файла конфигурации *MyConfigFile.xml*, а также указываются учетные данные администратора для установки кластера.

```powershell
.\New-HPCIaaSCluster.ps1 –ConfigFile MyConfigFile.xml -AdminUserName <username> –AdminPassword <password>
```

### <a name="additional-considerations"></a>Дополнительные замечания
* Скрипт дополнительно может включать отправку заданий через веб-портал для пакета HPC или с помощью REST API для пакета HPC.
* Скрипт может дополнительно запускать другие скрипты до и после настройки головного узла (если нужно установить дополнительное программное обеспечение или настроить другие параметры).

## <a name="configuration-file"></a>Файл конфигурации
Скрипт развертывания использует файл конфигурации в формате XML. Файл схемы HPCIaaSClusterConfig.xsd находится в папке скрипта развертывания пакета HPC по модели IaaS. **IaaSClusterConfig** — это корневой элемент файла конфигурации. Его дочерние элементы подробно описаны в файле Manual.rtf в папке со скриптом развертывания.

