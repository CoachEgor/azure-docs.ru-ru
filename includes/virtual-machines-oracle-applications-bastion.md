---
author: dlepow
ms.service: virtual-machines-linux
ms.topic: include
ms.date: 07/10/2019
ms.author: danlep
ms.openlocfilehash: 35f506235f698fbcf42308e6f0b0f400e925df29
ms.sourcegitcommit: 829d951d5c90442a38012daaf77e86046018e5b9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/09/2020
ms.locfileid: "68361548"
---
### <a name="bastion-tier"></a>Уровень бастиона

Узел бастиона является дополнительным компонентом, который можно использовать в качестве сервера переходов для доступа к экземплярам приложения и базы данных. Виртуальной машине узла бастиона может быть назначен общедоступный IP-адрес, хотя рекомендуется настроить подключение ExpressRoute или VPN типа "сеть — сеть" с локальной сетью для безопасного доступа. Кроме того, для входящего трафика должны быть открыты только SSH (порт 22, Linux) или RDP (порт 3389, Windows Server). Для обеспечения высокой доступности разверните узел бастиона в двух зонах доступности или в одной группе доступности.

Вы также можете включить пересылку агента SSH на виртуальных машинах, что позволит получить доступ к другим виртуальным машинам в виртуальной сети, пересылая учетные данные с узла бастиона. Или используйте Туннелирование SSH для доступа к другим экземплярам.

Ниже приведен пример перенаправления агента.

```
ssh -A -t user@BASTION_SERVER_IP ssh -A root@TARGET_SERVER_IP`
```

Эта команда подключается к бастиона и сразу же запускается `ssh` снова, поэтому вы получаете терминал на целевом экземпляре. Если кластер настроен иначе, может потребоваться указать пользователя, отличного от корневого, на целевом экземпляре. `-A`Аргумент пересылает подключение агента, чтобы ваш закрытый ключ на локальном компьютере использовался автоматически. Обратите внимание, что перенаправление агента — это цепочка, поэтому вторая `ssh` команда также включает `-A` , чтобы все последующие подключения SSH, инициированные из целевого экземпляра, также использовали локальный закрытый ключ.