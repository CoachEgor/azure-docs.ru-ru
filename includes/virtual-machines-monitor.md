---
title: включить файл
description: включить файл
author: cynthn
ms.service: virtual-machines
ms.topic: include
ms.date: 09/30/2019
ms.author: cynthn
ms.openlocfilehash: feea9696316723a2750be6fc1e13001224320324
ms.sourcegitcommit: af1cbaaa4f0faa53f91fbde4d6009ffb7662f7eb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/22/2020
ms.locfileid: "81865632"
---
При значительном росте числа вс-м внеплановых работ в Azure важно определить проблемы производительности и работоспособности, которые влияют на приложения и инфраструктурные службы, которые они поддерживают. Базовый мониторинг осуществляется по умолчанию с Azure по использованию процессора метрических типов, использованию дисков, использованию памяти и сетевому трафику, собранному гипервизором-хоста. Дополнительные метрические данные и данные журнала могут быть собраны с помощью [расширений](../articles/virtual-machines/windows/extensions-features.md) для настройки диагностики на вс-чатах из гостевой операционной системы.

Чтобы обнаружить и помочь диагностировать проблемы с производительностью и работоспособностью с помощью гостевой операционной системы, компонентов веб-приложений на основе .NET или Java, работающих внутри VM, Azure Monitor предоставляет централизованный мониторинг с помощью комплексных функций, таких как Azure Monitor для вс-карт и application Insights.

## <a name="diagnostics-and-metrics"></a>Диагностика и метрики 

Можно выполнять настройку и мониторинг сбора [данных диагностики](https://docs.microsoft.com/cli/azure/vm/diagnostics) с помощью [метрик](../articles/monitoring-and-diagnostics/monitoring-overview-metrics.md) на портале Azure, а также при помощи Azure CLI, Azure PowerShell и программных интерфейсов (API). Например, администратор может сделать следующее:

- **Отслеживать основные метрики для виртуальной машины.** Основные метрики, представленные на экране обзора на портале Azure, включают показатели использования ЦП и сети, общую емкость диска в байтах и число операций с диском в секунду.

- **Включить сбор диагностических сведений о загрузке и просматривать их с помощью портала Azure.** При передаче собственного образа в Azure или даже при загрузке одного из образов платформ могут возникать проблемы с загрузкой виртуальной машины. Это может происходить по разным причинам. Чтобы включить диагностику загрузки при создании виртуальной машины, нажмите кнопку **Включено** рядом с параметром "Диагностика загрузки" в разделе "Мониторинг" на экране параметров.

    Когда виртуальные машины загружаются, агент системы диагностики записывает выходные данные загрузки и сохраняет их в хранилище Azure. Эти данные можно использовать для устранения неполадок загрузки виртуальной машины. Если вы создаете виртуальную машину с помощью программ командной строки, диагностика загрузки не включается автоматически. Перед включением диагностики загрузки необходимо создать учетную запись хранения для хранения журналов загрузки. Если включить диагностику загрузки на портале Azure, учетная запись хранения создается автоматически.

    Если при создании виртуальной машины вы не включили диагностику загрузки, вы сможете включить ее позже с помощью [Azure CLI](https://docs.microsoft.com/cli/azure/vm/boot-diagnostics), [Azure PowerShell](https://docs.microsoft.com/powershell/module/az.compute/set-azvmbootdiagnostic) или [шаблона Azure Resource Manager](../articles/virtual-machines/windows/extensions-diagnostics-template.md).

- **Включить сбор данных диагностики гостевой ОС.** Когда вы создаете виртуальную машину, можно включить диагностику гостевой ОС на экране параметров. Если включить сбор данных диагностики, в виртуальную машину добавляется [расширение IaaSDiagnostics для Linux](../articles/virtual-machines/linux/diagnostic-extension.md) или [расширение IaaSDiagnostics для Windows](../articles/virtual-machines/windows/ps-extensions-diagnostics.md). Это позволяет собирать дополнительные данные диска, ЦП и памяти.

    При помощи собранных данных диагностики вы можете настроить для виртуальных машин автоматическое масштабирование. Можно также настроить [журналы azure Monitor](../articles/azure-monitor/platform/data-platform-logs.md) для хранения данных и настроить оповещения, чтобы вы знали, когда производительность не является правильной.

## <a name="alerts"></a>Предупреждения

Можно создавать [оповещения](../articles/azure-monitor/platform/alerts-overview.md) на основе определенных показателей производительности. Например, вы можете использовать оповещения для уведомления о том, что средняя загрузка ЦП превышает пороговое значение или показатель свободного места на диске ниже определенного значения. Оповещения можно настроить на [портале Azure,](../articles/azure-monitor/platform/alerts-metric.md#create-with-azure-portal)используя [шаблоны управления ресурсами Azure](../articles/azure-monitor/platform/alerts-metric-create-templates.md)или [Azure CLI.](../articles/azure-monitor/platform/alerts-metric.md#with-azure-cli)

## <a name="azure-service-health"></a>Работоспособность служб Azure

[Служба службы Azure](../articles/service-health/service-health-overview.md) предоставляет персонализированные рекомендации и поддержку, когда проблемы в службах Azure влияют на вас, и помогает вам подготовиться к предстоящему запланированному техническому обслуживанию. Служба работоспособности служб Azure отправляет пользователям и рабочим группам настраиваемые целевые уведомления.

## <a name="azure-resource-health"></a>Служба работоспособности ресурса Azure

Служба [Работоспособность ресурсов Azure](../articles/service-health/resource-health-overview.md) поможет выполнить диагностику и получить необходимую поддержку, если неполадки Azure влияют на ресурсы. Она представляет сведения о текущем состоянии работоспособности ресурсов и о состоянии работоспособности ресурсов за прошедший период, а также помогает устранить проблемы. Служба работоспособности ресурсов обеспечивает поддержку, если вам необходима помощь в решении проблемы со службой Azure.

## <a name="azure-activity-log"></a>Журнал действий Azure

[Журнал действий Azure](../articles/azure-monitor/platform/platform-logs-overview.md) — это журнал подписки с подробными сведениями о событиях на уровне подписки, которые произошли в Azure. В этот журнал входят различные данные: от операционных данных Azure Resource Manager до обновлений в событиях работоспособности службы. Чтобы просмотреть журнал виртуальной машины, щелкните "Журнал действий" на портале Azure.

Ниже описано несколько доступных операций с журналом действий:

- Создайте [оповещение о событии журнала активности.](../articles/azure-monitor/platform/platform-logs-overview.md)
- [Stream it to an Event Hub](../articles/azure-monitor/platform/activity-logs-stream-event-hubs.md) for ingestion by a third-party service or custom analytics solution such as Power BI.
- Проанализируйте его в Power BI с помощью [пакета содержимого Power BI.](https://powerbi.microsoft.com/documentation/powerbi-content-pack-azure-audit-logs/)
- [Сохранение журнала в учетную запись хранения](../articles/azure-monitor/platform/archive-activity-log.md) для архивации или проверки вручную. В профиле журнала можно задать время хранения (в днях).

Кроме того, вы можете ознакомиться с данными журнала действий, воспользовавшись [Azure PowerShell](https://docs.microsoft.com/powershell/module/azurerm.insights/), [Azure CLI](https://docs.microsoft.com/cli/azure/monitor) или [интерфейсами Monitor REST API](https://docs.microsoft.com/rest/api/monitor/).

[Журналы ресурсов Azure](../articles/azure-monitor/platform/platform-logs-overview.md) — это журналы, испускаемые вашим VM, которые предоставляют богатые, частые данные о его работе. Журналы ресурсов отличаются от журналов действий, предоставляя представление об операциях, выполненных в рамках VM.

Ниже описано несколько доступных операций с журналами диагностики:

- Сохранение журналов в [учетную запись хранения](../articles/azure-monitor/platform/archive-diagnostic-logs.md) для аудита или проверки вручную. В параметрах диагностики ресурсов можно задать время хранения (в днях).
- [Stream их в Event Hubs](../articles/azure-monitor/platform/resource-logs-stream-event-hubs.md) для приема в эксплуатацию сторонними службами или пользовательским аналитическим решением, таким как Power BI.
- Проанализируйте их с [помощью Log Analytics](../articles/log-analytics/log-analytics-azure-storage.md).

## <a name="advanced-monitoring"></a>Расширенный мониторинг

Для видимости приложения или сервиса, поддерживаемых наборами Azure VM и виртуальной шкалой машин, выявления проблем с гостевой ОС или рабочей нагрузки, работающей в VM, чтобы понять, влияет ли это на доступность или производительность приложения, или это проблема с приложением, включите как [Azure Monitor для Виртуальных Мывсов,](../articles/azure-monitor/insights/vminsights-overview.md) так и [Application Insight.](../articles/azure-monitor/app/app-insights-overview.md)

Azure Monitor для виртуальных компьютеров отслеживает ваши виртуальные машины Azure (VM) в масштабе, анализируя производительность и работоспособность ваших виртуальных технологий для Windows и Linux, включая различные процессы и взаимосвязанные зависимости от других ресурсов и внешних процессов, которые они обнаруживают. Она включает в себя несколько диаграмм трендовой производительности, чтобы помочь при расследовании проблем и оценить емкость ваших ВМ. Карта зависимости показывает контролируемые и неконтролируемые машины, сбой и активные сетевые соединения между процессами и этими машинами, а также диаграммы тренда со стандартными показателями сетевого соединения. В сочетании с Application Insights вы отслеживаете свое приложение и фиксируете телеметрию, такую как запросы HTTP, исключения и т.д., чтобы можно было соотнести проблемы между вводом и приложением. Нанастройка [предупреждений Azure Monitor,](../articles/azure-monitor/platform/alerts-overview.md) чтобы предупредить вас о важных условиях, обнаруженных на данных мониторинга, собранных Azure Monitor для ВМ.

## <a name="next-steps"></a>Дальнейшие действия

- Выполните инструкции в статьях [Мониторинг виртуальных машин Windows с помощью Azure PowerShell](../articles/virtual-machines/windows/tutorial-monitoring.md) или [Мониторинг виртуальных машин Linux в Azure](../articles/virtual-machines/linux/tutorial-monitoring.md).

- Ознакомьтесь с рекомендациями по [мониторингу и диагностике](https://docs.microsoft.com/azure/architecture/best-practices/monitoring).
