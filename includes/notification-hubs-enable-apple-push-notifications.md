---
title: включить файл
description: включить файл
services: notification-hubs
author: sethmanheim
ms.service: notification-hubs
ms.topic: include
ms.date: 02/10/2020
ms.author: sethm
ms.custom: include file
ms.openlocfilehash: bf2596f5a8e287799285f97f3d1be9f3fe10f644
ms.sourcegitcommit: 7c18afdaf67442eeb537ae3574670541e471463d
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/11/2020
ms.locfileid: "77123148"
---
## <a name="generate-the-certificate-signing-request-file"></a>Создание файла запроса на подписывание сертификата

Служба push-уведомлений Apple (APNs) использует сертификаты для аутентификации push-уведомлений. Следуйте приведенным указаниям, чтобы создать сертификата push-уведомлений, необходимый для отправки и получения уведомлений. Дополнительные сведения об этих понятиях см. в официальной документации по [Службе push-уведомлений Apple](https://developer.apple.com/library/archive/documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/APNSOverview.html).

Создайте файл запроса на подписывание сертификата (CSR), используемый Apple для создания подписанного сертификата push-уведомлений.

1. На компьютере Mac запустите средство Keychain Access. Его можно запустить из папки **Служебные программы** или **Другое** на панели запуска.

1. Нажмите **Связка ключей**, разверните **Помощник по сертификатам**, а затем выберите **Запросить сертификат в центре сертификации**.

    ![Использование Keychain Access для запрашивания нового сертификата](./media/notification-hubs-enable-apple-push-notifications/notification-hubs-request-cert-from-ca.png)

   > [!NOTE]
   > По умолчанию при осуществлении доступа к цепочке ключей выбирается первый элемент списка. Это может вызвать проблемы, если у вас открыта категория **сертификатов** и **центр сертификации Apple Worldwide Developer Relations** не указан в списке первым. Прежде чем создавать CSR (запрос на подписывание сертификата), убедитесь, что выбран элемент, не являющийся ключом, или ключ **центра сертификации Apple Worldwide Developer Relations**.

1. Заполните поля **Адрес электронной почты пользователя** и **Личное имя**, выберите **Сохранено на диск**, а затем — **Продолжить**. Оставьте поле **Адрес электронной почты ЦС** пустым, так как оно является необязательным.

    ![Требуемые сведения о сертификате](./media/notification-hubs-enable-apple-push-notifications/notification-hubs-csr-info.png)

1. Задайте имя CSR-файлу в поле **Сохранить как**, выберите расположение в поле **Где** и нажмите кнопку **Сохранить**.

    ![Выбор имени файла для сертификата](./media/notification-hubs-enable-apple-push-notifications/notification-hubs-save-csr.png)

    При этом CSR-файл сохраняется в выбранном месте. Расположением по умолчанию является **рабочий стол**. Запомните расположение, выбранное для файла.

Теперь вам нужно зарегистрировать приложение в Apple, включить push-уведомления и передать экспортированный CSR-файл для создания сертификата push-уведомлений.

## <a name="register-your-app-for-push-notifications"></a>Регистрация приложения для работы с push-уведомлениями

Чтобы отправлять push-уведомления в приложение iOS, зарегистрируйте приложение в системе Apple, а также зарегистрируйте его для получения push-уведомлений.  

1. Если вы еще не зарегистрировали свое приложение, перейдите на [портал подготовки iOS](https://go.microsoft.com/fwlink/p/?LinkId=272456) в центре разработчиков Apple. Войдите на портал с помощью идентификатора Apple ID и выберите **Identifiers** (Идентификаторы). Затем выберите **+** , чтобы зарегистрировать новое приложение.

    ![Страница с идентификаторами приложения на портале подготовки iOS](./media/notification-hubs-enable-apple-push-notifications/notification-hubs-ios-appids.png)

2. На экране **Register a New Identifier** (Зарегистрировать новый идентификатор) выберите переключатель **App IDs** (Идентификаторы приложений). Затем выберите **Continue** (Продолжить).

    ![Страница регистрации нового идентификатора на портале подготовки iOS](./media/notification-hubs-enable-apple-push-notifications/notification-hubs-ios-appids-new.png)

3. Обновите следующие три значения для нового приложения и нажмите кнопку **Continue** (Продолжить).

   * **Описание**: Введите описательное имя для приложения.

   * **Bundle ID** (Идентификатор пакета). Введите идентификатор пакета в форму **Organization Identifier.Product Name** (Идентификатор организации.Имя продукта), как описано в [руководстве по распространению приложения](https://help.apple.com/xcode/mac/current/#/dev91fe7130a). Значения *Organization Identifier* (Идентификатор организации) и *Product Name* (Имя продукта) должны соответствовать идентификатору организации и имени продукта, указанным при создании проекта Xcode. На следующем снимке экрана значение **NotificationHubs** используется как идентификатор организации, а значение **GetStarted** — как название продукта. Убедитесь, что значение **Bundle Identifier** (Идентификатор пакета) совпадает со значением из проекта Xcode, чтобы в Xcode использовался правильный профиль публикации.

      ![Страница регистрации идентификатора приложения на портале подготовки iOS](./media/notification-hubs-enable-apple-push-notifications/notification-hubs-new-appid-bundle.png)

   * **Push-уведомления**. Проверьте опцию **Push Notifications** (Push-уведомления) в разделе **Capabilities** (Возможности).

      ![Форма для регистрации нового идентификатора приложения](./media/notification-hubs-enable-apple-push-notifications/notification-hubs-new-appid-push.png)

      При этом будет создан идентификатор вашего приложения, а также запрошено подтверждение информации. Выберите **Continue** (Продолжить), а затем нажмите **Register** (Зарегистрировать), чтобы подтвердить новый идентификатор приложения.

      ![Подтверждение нового идентификатора приложения](./media/notification-hubs-enable-apple-push-notifications/notification-hubs-new-appid-register.png)

      После выбора **Register** (Зарегистрировать) вы увидите новый идентификатор приложения в виде элемента строки на странице **Certificates, Identifiers & Profiles** (Сертификаты, идентификаторы и профили).

4. На странице **Certificates, Identifiers & Profiles** (Сертификаты, идентификаторы и профили) в разделе **Identifiers** (Идентификаторы) перейдите к только что созданному элементу строки идентификатора приложения и выберите соответствующую строку, чтобы отобразить окно **Edit your App ID Configuration** (Изменить конфигурацию идентификатора приложения).

5. Прокрутите вниз до отмеченной опции **Push Notifications** (Push-уведомления), а затем выберите **Configure** (Настроить), чтобы создать сертификат.

    ![Страница изменения идентификатора приложения](./media/notification-hubs-enable-apple-push-notifications/notification-hubs-edit-appid.png)

6. Откроется окно **Apple Push Notification service SSL Certificates** (SSL-сертификаты службы push-уведомлений Apple). Нажмите кнопку **Create Certificate** (Создать сертификат) в разделе **Development SSL Certificate** (SSL-сертификат разработки).

    ![Кнопка создания сертификата для идентификатора приложения](./media/notification-hubs-enable-apple-push-notifications/notification-hubs-appid-create-cert.png)

    Появится экран **Create a new Certificate** (Создать новый сертификат).

    > [!NOTE]
    > В этом учебнике используется сертификат разработки. Тот же процесс используется при регистрации сертификата производства. Только убедитесь, что при отправке уведомлений используется тот же тип сертификата.

1. Нажмите **Choose File** (Выбрать файл), перейдите к папке, в которой сохранен CSR-файл, созданный в первом задании, и дважды щелкните по имени сертификата, чтобы загрузить его. Затем выберите **Continue** (Продолжить).

1. После того как сертификат будет создан на портале, нажмите кнопку **Download** (Скачать). Сохраните сертификат и запомните расположение, в котором он сохранен.

    ![Страница скачивания созданного сертификата](./media/notification-hubs-enable-apple-push-notifications/notification-hubs-appid-download-cert.png)

    При этом сертификат будет скачан и сохранен на вашем компьютере в папке **Загрузки**.

    ![Поиск файла сертификата в папке "Загрузки"](./media/notification-hubs-enable-apple-push-notifications/notification-hubs-cert-downloaded.png)

    > [!NOTE]
    > Скачанному сертификату разработки по умолчанию задано имя **aps_development.cer**.

1. Дважды щелкните скачанный сертификат push-уведомлений **aps_development.cer**. При этом новый сертификат устанавливается в Keychain, как на следующем изображении.

    ![Список сертификатов Keychain Access с новым сертификатом](./media/notification-hubs-enable-apple-push-notifications/notification-hubs-cert-in-keychain.png)

    > [!NOTE]
    > Имя вашего сертификата может отличаться, но оно будет начинаться с префикса **Apple Development iOS Push Services**.

1. В программе Keychain Access щелкните правой кнопкой мыши новый сертификат push-уведомлений, созданный в категории **Certificates** (Сертификаты). Щелкните **Export** (Экспорт), укажите имя файла, выберите формат **P12** и нажмите кнопку **Save** (Сохранить).

    ![Экспорт сертификата в формате р12](./media/notification-hubs-enable-apple-push-notifications/notification-hubs-export-cert-p12.png)

    Вы можете выбрать защиту сертификата с помощью пароля, но это необязательно. Нажмите кнопку **ОК**, если хотите обойти создание пароля. Запишите имя файла и расположение экспортируемого сертификата в формате P12. Они нужны для аутентификации с помощью APNs.

    > [!NOTE]
    > Имя файла в формате P12 и его расположение могут отличаться от изображенных в этом учебнике.

## <a name="create-a-provisioning-profile-for-the-app"></a>Создание профиля подготовки для приложения

1. Вернитесь на [портал подготовки iOS](https://go.microsoft.com/fwlink/p/?LinkId=272456), выберите **Certificates, Identifiers & Profiles** (Сертификаты, идентификаторы и профили), нажмите **Profiles** (Профили) в меню слева, а затем выберите **+** , чтобы создать новый профиль. Откроется окно **Register a New Provisioning Profile** (Зарегистрировать новый профиль подготовки).

1. Выберите **iOS App Development** (Разработка приложений для iOS) в разделе **Development** (Разработка) в качестве типа профиля подготовки и нажмите кнопку **Continue** (Продолжить).

    ![Список с профилем подготовки](./media/notification-hubs-enable-apple-push-notifications/notification-hubs-new-provisioning-profile.png)

1. Затем в раскрывающемся списке **App ID** (Идентификатор приложения) выберите созданный идентификатор приложения и нажмите кнопку **Continue** (Продолжить).

    ![Выбор идентификатора приложения](./media/notification-hubs-enable-apple-push-notifications/notification-hubs-select-appid-for-provisioning.png)

1. В окне **Select certificates** (Выбор сертификатов) выберите сертификат для разработки, используемый для подписывания кода, и нажмите кнопку **Continue** (Продолжить). Это не созданный сертификат push-уведомлений. Если он не существует, создайте его. Если сертификат существует, перейдите к следующему шагу. Выполните приведенные ниже действия, чтобы создать сертификат разработки, если он не существует.

    1. Если вы видите **No Certificates are available** (Нет доступных сертификатов), выберите **Create Certificate** (Создать сертификат).
    2. В разделе **Software** (Программное обеспечение) выберите **Apple Development** (Разработка Apple). Затем выберите **Continue** (Продолжить).
    3. Перейдите к экрану **Create a new Certificate** (Создать новый сертификат) и нажмите **Choose File** (Выбрать файл).
    4. Перейдите к сертификату **Certificate Signing Request** (Запрос на подпись сертификата), который вы создали ранее, выберите его, а затем нажмите **Open** (Открыть).
    5. Выберите **Continue** (Продолжить).
    6. Скачайте сертификат разработки и запомните расположение, в котором он сохранен.

1. Вернитесь на страницу **Certificates, Identifiers & Profiles** (Сертификаты, идентификаторы и профили), нажмите **Profiles** (Профили) в меню слева, а затем **+** , чтобы создать новый профиль. Откроется окно **Register a New Provisioning Profile** (Зарегистрировать новый профиль подготовки).

1. В окне **Select certificates** (Выбор сертификатов) выберите сертификат разработки, который вы только что создали. Затем выберите **Continue** (Продолжить).

1. Затем выберите устройства для тестирования и нажмите кнопку **Continue** (Продолжить).

1. Наконец, выберите имя профиля в поле **Provisioning Profile Name** (Имя профиля подготовки) и нажмите кнопку **Generate** (Создать).

    ![Выбор имени профиля подготовки](./media/notification-hubs-enable-apple-push-notifications/notification-hubs-provisioning-name-profile.png)

1. После создания нового профиля подготовки выберите **Download** (Скачать). Запомните расположение, в котором он сохранен.

1. Перейдите в расположение профиля подготовки и дважды щелкните его, чтобы установить его на компьютере разработки Xcode.

## <a name="create-a-notification-hub"></a>Создание концентратора уведомлений

В этом разделе показано, как создать центр уведомлений и настроить аутентификацию с использованием APNs и ранее созданного сертификата push-уведомлений (файл с расширением .p12). Если вы хотите использовать уже созданный центр уведомлений, перейдите к шагу 5.

[!INCLUDE [notification-hubs-portal-create-new-hub](notification-hubs-portal-create-new-hub.md)]

## <a name="configure-your-notification-hub-with-apns-information"></a>Добавление данных об APNs в центр уведомлений

1. В разделе **Notification Services** выберите **Apple (APNS)** .

1. Выберите **Сертификат**.

1. Щелкните значок файла.

1. Выберите экспортированный ранее файл с расширением .p12, а затем нажмите **Open** (Открыть).

1. При необходимости укажите пароль.

1. Выберите режим **Песочница**. Используйте режим **рабочей среды**, только если push-уведомления нужно отправлять пользователям, которые приобрели приложение в магазине.

    ![Настройка сертификации APNs на портале Azure](./media/notification-hubs-enable-apple-push-notifications/notification-hubs-apple-config-cert.png)

1. Щелкните **Сохранить**.

Вы добавили данные об APNs в центр уведомлений. У вас также есть строки подключения для регистрации приложения и отправки push-уведомлений.
