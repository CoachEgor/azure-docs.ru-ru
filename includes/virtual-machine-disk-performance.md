---
title: включить файл
description: включить файл
services: virtual-machines
author: albecker1
ms.service: virtual-machines
ms.topic: include
ms.date: 09/25/2020
ms.author: albecker1
ms.custom: include file
ms.openlocfilehash: 9f5a1010959658e75dcc809b2ee1d6d9222af056
ms.sourcegitcommit: 829d951d5c90442a38012daaf77e86046018e5b9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/09/2020
ms.locfileid: "91540016"
---
Эта статья поможет уточнить производительность диска и способ ее работы при объединении виртуальных машин Azure и дисков Azure. Здесь также описывается, как можно диагностировать узкие места для дисковых операций ввода-вывода и изменения, которые можно сделать для оптимизации производительности.

## <a name="how-does-disk-performance-work"></a>Как работает производительность диска?
В виртуальных машинах Azure ограничения производительности операций ввода-вывода и пропускной способности зависят от типа и размера виртуальной машины. Диски ОС и диски данных, которые можно подключить к виртуальным машинам, имеют собственные ограничения на операции ввода-вывода и пропускную способность. Когда приложение, работающее на виртуальных машинах, запрашивает больше операций ввода-вывода или пропускной способности, чем выделено для виртуальной машины или подключенных дисков, производительность приложения становится ограниченной. В этом случае приложение будет испытывать неоптимальную производительность и может привести к некоторым негативным последствиям, например к увеличению задержки. Давайте рассмотрим несколько примеров, чтобы упрочнить это. Чтобы упростить эти примеры, мы рассмотрим только операции ввода-вывода, но одна и та же логика также применяется к пропускной способности.

## <a name="disk-io-capping"></a>Ограниченное число операций ввода-вывода диска
Настройка.
- Standard_D8s_v3 
    - Некэшированные операции ввода-вывода: 12 800
- Диск ОС E30
    - ОПЕРАЦИЙ ВВОДА-ВЫВОДА: 500 
- 2 E30 диски данных
    - ОПЕРАЦИЙ ВВОДА-ВЫВОДА: 500

![Ограниченный уровень диска](media/vm-disk-performance/disk-level-throttling.jpg)

Приложение, работающее на виртуальной машине, выполняет запрос, который требует 10 000 операций ввода-вывода в секунду для виртуальной машины. Все, разрешенные ВИРТУАЛЬНОЙ машиной, так как виртуальная машина Standard_D8s_v3 может выполнять до 12 800 операций ввода-вывода в секунду. После этого запросы 10 000 операций ввода-вывода в секунду разбиваются на три разных запроса к разным дискам. 1 000 операций ввода-вывода в секунду запрашиваются на диск операционной системы и 4 500 операций ввода-вывода на каждый диск данных. Так как все подключенные диски являются E30 дисками и могут обрабатывать только 500 операций ввода-вывода, они реагируют на 500 операций ввода-вывода в секунду. Производительность приложения затем ограничена подключенными дисками и может обрабатывать только 1 500 операций ввода-вывода в секунду. Она может работать при пиковой производительности в 10 000 операций ввода-вывода, если использовались более эффективные диски, например SSD (цен. категория "Премиум") диски P30.

## <a name="virtual-machine-io-capping"></a>Ограниченное число операций ввода-вывода виртуальной машины
Настройка.
- Standard_D8s_v3 
    - Некэшированные операции ввода-вывода: 12 800
- Диск ОС P30
    - ОПЕРАЦИЙ ВВОДА-ВЫВОДА: 5 000 
- 2 P30 диски данных 
    - ОПЕРАЦИЙ ВВОДА-ВЫВОДА: 5 000

![Ограниченный уровень виртуальной машины](media/vm-disk-performance/vm-level-throttling.jpg)

Приложение, работающее на виртуальной машине, выполняет запрос, который требует 15 000 операций ввода-вывода в секунду. К сожалению, Standard_D8s_v3ная виртуальная машина подготавливается только для обработок 12 800 операций ввода-вывода. В этом случае приложение ограничено ограничениями виртуальной машины и должно выделить выделенные 12 800 операций ввода-вывода в секунду. Эти 12 800 операций ввода-вывода в секунду разбиваются на три разных запроса к разным дискам. 4 267 операций ввода-вывода в секунду запрашиваются на диск операционной системы и 4 266 операций ввода-вывода на каждый диск данных. Так как все подключенные диски являются P30 дисками, которые могут обрабатывать 5 000 операций ввода-вывода в секунду, они реагируют на запрошенные объемы.