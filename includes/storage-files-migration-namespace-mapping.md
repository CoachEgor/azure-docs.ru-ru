---
title: Сопоставьте структуру папок с топологией Синхронизация файлов Azure
description: Сопоставление существующей структуры файлов и папок с файловыми ресурсами Azure для использования с Синхронизация файлов Azure. Общий текстовый блок, совместно используемый в документах миграции.
author: fauhse
ms.service: storage
ms.topic: conceptual
ms.date: 2/20/2020
ms.author: fauhse
ms.subservice: files
ms.openlocfilehash: 948090d0ee956ca1798d7b0f46bb33276c4d6354
ms.sourcegitcommit: 849bb1729b89d075eed579aa36395bf4d29f3bd9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2020
ms.locfileid: "82143591"
---
На этом шаге вы оцениваете количество необходимых файловых ресурсов Azure. Один экземпляр Windows Server (или кластер) может синхронизировать до 30 файловых ресурсов Azure.

У вас может быть больше папок на томах, которые в настоящее время используются локально в качестве общих ресурсов SMB для пользователей и приложений. Самый простой способ — представить локальную общую папку, которая сопоставляет 1:1 с общим файловым ресурсом Azure. При наличии небольшого числа, приведенного ниже 30 для одного экземпляра Windows Server, мы рекомендуем использовать сопоставление 1:1.

Если вы используете больше 30 общих ресурсов, вам часто не нужно сопоставлять локальный общий ресурс 1:1 с общим файловым ресурсом Azure. Рассмотрим следующие варианты.

#### <a name="share-grouping"></a>Группировка общего доступа

Если в вашем отделе кадров (например,) всего 15 общих ресурсов, то можно хранить все данные о КАДРах в одном файловом ресурсе Azure. Хранение нескольких локальных общих ресурсов в одной общей папке Azure не мешает создавать обычные 15 общих ресурсов SMB на локальном экземпляре Windows Server. Это означает, что вы организуете корневые папки этих 15 общих папок в виде вложенных папок в общей папке. Затем вы синхронизируете эту общую папку с общим файловым ресурсом Azure. Таким образом, для этой группы локальных общих ресурсов требуется только один файловый ресурс Azure в облаке.

#### <a name="volume-sync"></a>Синхронизация томов

Синхронизация файлов Azure поддерживает синхронизацию корня тома с общим файловым ресурсом Azure. Если вы синхронизируете корневую папку, все вложенные папки и файлы будут отправлены в тот же общий файловый ресурс Azure.

Синхронизация корня тома не всегда является лучшим ответом. Существует ряд преимуществ синхронизации нескольких расположений. Например, это позволяет сократить количество элементов в каждой области синхронизации. Настройка Синхронизация файлов Azure с меньшим количеством элементов не только может быть полезной для синхронизации файлов. Меньшее количество элементов также предоставляет следующие преимущества:

* Восстановление на стороне облака из моментального снимка файлового ресурса Azure может быть выполнено в качестве резервной копии.
* Аварийное восстановление локального сервера может значительно ускорить работу.
* Изменения, внесенные непосредственно в файловый ресурс Azure (за пределами синхронизации), могут быть обнаружены и синхронизированы быстрее.

#### <a name="a-structured-approach-to-a-deployment-map"></a>Структурированный подход к карте развертывания

Перед развертыванием облачного хранилища на более позднем этапе необходимо создать карту между локальными папками и общими файловыми ресурсами Azure. Это сопоставление позволит сообщить, сколько и какие Синхронизация файлов Azure *синхронизировать ресурсы группы* , которые вы будете подготавливать. Группа синхронизации связывает файловый ресурс Azure и папку на сервере и устанавливает соединение синхронизации.

Чтобы принять решение о количестве необходимых файловых ресурсов Azure, ознакомьтесь с приведенными ниже ограничениями и рекомендациями. Это поможет вам оптимизировать карту.

* Сервер с установленным агентом Синхронизация файлов Azure может синхронизироваться с общим файловым ресурсом Azure до 30.
* Файловый ресурс Azure развертывается в учетной записи хранения. Это делает учетную запись хранения целевым объектом масштабирования для чисел производительности, таких как операции ввода-вывода и пропускная способность. 

  Две стандартные (не премиум) общие файловые ресурсы Azure теоретически могут быть перегружены максимальной производительностью, которую может предоставить учетная запись хранения. Если вы планируете присоединить Синхронизация файлов Azure только к этим общим папкам, то группировка нескольких файловых ресурсов Azure в одной учетной записи хранения не приведет к возникновению проблемы. Просмотрите целевые показатели производительности файлового ресурса Azure, чтобы получить более подробные сведения о важных метриках, которые следует учитывать. 

  Если вы планируете Приподнятие приложения в Azure, которое будет использовать файловый ресурс Azure в собственном режиме, вам может потребоваться дополнительная производительность в файловом ресурсе Azure. Если это возможно даже в будущем, лучше сопоставить файловый ресурс Azure с собственной учетной записью хранения.
* Существует ограничение в 250 учетных записей хранения на подписку в одном регионе Azure.

> [!TIP]
> Учитывая эти сведения, часто бывает необходимо сгруппировать несколько папок верхнего уровня на томах в общий новый корневой каталог. Затем вы синхронизируете этот новый корневой каталог и все папки, сгруппированные в него, в одну общую папку Azure. Эта методика позволяет оставаться в пределах 30 синхронизаций файловых ресурсов Azure на один сервер.
>
> Эта группировка в общем корне не влияет на доступ к данным. Списки ACL остаются неизменными. Вам потребуется скорректировать все пути к общим папкам (например, к общим папкам SMB или NFS) в папках сервера, которые теперь были изменены в общий корень. Другие изменения отсутствуют.

Другим важным аспектом Синхронизация файлов Azure, а также сбалансированной производительностью и опытом является понимание факторов масштабирования для Синхронизация файлов Azureной производительности. Очевидно, что при синхронизации файлов через Интернет большие файлы занимают больше времени и пропускную способность для синхронизации.

> [!IMPORTANT]
> Наиболее важный вектор шкалы для Синхронизация файлов Azure — число элементов (файлов и папок), которые необходимо синхронизировать.

Синхронизация файлов Azure поддерживает синхронизацию до 100 000 элементов в одном общем файловом ресурсе Azure. Это ограничение может быть превышено, и только показывает, как Синхронизация файлов Azure команда тестируется на регулярной основе.

Рекомендуется, чтобы количество элементов в области синхронизации было низким. Это важный фактор, который следует учитывать при сопоставлении папок с файловыми ресурсами Azure.

В вашей ситуации существует возможность логической синхронизации набора папок с одним общим файловым ресурсом Azure (используя новый, распространенный подход с корневыми папками). Но по-прежнему может быть лучше перегруппировать папки так, чтобы они выполняли синхронизацию с двумя, а не с одной общей папкой Azure. Этот подход можно использовать для сохранения количества файлов и папок на общем файловом ресурсе, равномерно распределенном по всему серверу.

#### <a name="create-a-mapping-table"></a>Создание таблицы сопоставления

:::row:::
    :::column:::
        [![](media/storage-files-migration-namespace-mapping/namespace-mapping.png "An example of a mapping table. Download the file below to experience and use the content of this image.")](media/storage-files-migration-namespace-mapping/namespace-mapping-expanded.png#lightbox)
    :::column-end:::
    :::column:::
        Используйте сочетание предыдущих концепций, чтобы определить, сколько файловых ресурсов Azure требуется, и какие части существующих данных будут находиться в общей папке Azure.
        
        Создайте таблицу, которая записывает ваши мысли, чтобы вы могли обратиться к ней на следующем шаге. Упорядоченность важна, так как при подготовке нескольких ресурсов Azure можно легко потерять сведения о плане сопоставления. Для создания полного сопоставления можно загрузить файл Microsoft Excel в качестве шаблона.

[//]: # (HTML является единственным способом добавления вложенной таблицы из двух столбцов с анализом рабочего образа, а также текстом или гиперссылкой на одной строке.)

<br>
<table>
    <tr>
        <td>
            <img src="media/storage-files-migration-namespace-mapping/excel.png" alt="Microsoft Excel file icon that helps to set the context for the type of file download for the link next to it.">
        </td>
        <td>
            <a href="https://download.microsoft.com/download/1/8/D/18DC8184-E7E2-45EF-823F-F8A36B9FF240/Azure File Sync - Namespace Mapping.xlsx">Скачайте шаблон сопоставления пространства имен.</a>
        </td>
    </tr>
</table>
    :::column-end:::
:::row-end:::
