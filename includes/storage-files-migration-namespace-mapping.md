---
title: Карта структуры папок в топологии синхронизации файлов Azure
description: Отображение существующей структуры файлов и папок для файлов Azure для использования в Azure File Sync. Общий текстовый блок, общий между документами миграции.
author: fauhse
ms.service: storage
ms.topic: conceptual
ms.date: 2/20/2020
ms.author: fauhse
ms.subservice: files
ms.openlocfilehash: 25c333aae49bff8d0596d4f5403c18576bf198b3
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2020
ms.locfileid: "80124730"
---
На этом этапе вы оцениваете, сколько нужного количества файлов Azure. Один Windows Server (или кластер) может синхронизировать до 30 файлов Azure.

У вас может быть больше папок на объемах, которые вы в настоящее время поделиться локально, как SMB акций для пользователей и приложений. Проще всего было бы предусмотреть для локтевой доли на карте 1:1 к доле файла Azure. Если у вас достаточно небольшое число, менее 30 для одного Windows Server, рекомендуется отображение 1:1.

Если у вас больше, чем 30, часто нет необходимости отображя долю в предварительном помещении 1:1 к доле файла Azure.
Следуйте приведенным ниже рекомендациям.

#### <a name="share-grouping"></a>Группировка акций

Например, если в отделе управления персоналом в общей сложности 15 акций, то можно рассмотреть возможность хранения всех HR-данных в одной совместной сечек файла Azure. Хранение нескольких локальных долей в одной совместной акции файлов Azure не мешает создавать обычные 15 sMB-акций на локальном Сервере Windows. Это означает только, что вы организуете корневые папки этих 15 акций в виде субфолок под общей папкой. Затем вы синхронизируете эту общую папку с разделом файла Azure. Таким образом, для этой группы акций для локтей требуется только одна доля файлов Azure в облаке.

#### <a name="volume-sync"></a>Синхронизация громкости

Azure File Sync поддерживает синхронизацию корня объема с разделом файла Azure.
Если вы синхронизируете корневую папку, то все субфалеры и файлы будут в конечном итоге в той же совместной стихе файла Azure.

Синхронизации корень объема не всегда будет лучшим ответом. Есть преимущества в синхронизации нескольких местоположений, что позволяет сохранить количество элементов ниже в области синхронизации. Настройка синхронизации файлов Azure с меньшим числом элементов не только полезна для синхронизации файлов. Меньшее количество элементов также приносит пользу другим сценариям, таким как:

* восстановление облачности из снимка совместного файла Azure, сделанного в качестве резервного копирования
* аварийное восстановление внутреннего сервера может значительно ускорить
* изменения, внесенные непосредственно в раздел файла Azure (вне синхронизации), могут быть обнаружены и синхронизированы быстрее

#### <a name="a-structured-approach-to-a-deployment-map"></a>Структурированный подход к карте развертывания

Перед развертыванием облачного хранилища на следующем этапе важно создать карту между папками на местах и файлами Azure. Это отображение будет информировать, сколько и какие Ресурсы Azure File Sync "синхронизации группы" вы будете предоставлять. Группа синхронизации связывает совместное соединение файлов Azure и папку на сервере и устанавливает соединение синхронизации.

Чтобы принять решение о том, сколько нужнох файлов Azure, просмотрите следующие ограничения и рекомендации. Это поможет вам оптимизировать карту:

* Сервер с установленным агентом Azure File Sync может синхронизироваться с до 30 файловых акций Azure.
* Элемент файла Azure развертывается внутри учетной записи хранилища. Это делает учетную запись хранилища целевой целью для показателей производительности, таких как IOPS и пропускная способность. Две стандартные (не премиальные) файлы Azure теоретически могут насытить максимальную производительность, сможемую обеспечить учетная запись хранилища. Если вы планируете прикрепить только синхронизацию файлов Azure к этим файлам, то группировка нескольких файлов Azure в одну учетную запись хранилища не создает проблемы. Просмотрите целевые показатели производительности файла Azure, чтобы глубже ознакомиться с соответствующими показателями для рассмотрения. Если вы планируете отойти от приложения в Azure, которое будет использовать общий файл Azure насвоемн, то, возможно, потребуется дополнительная производительность от общего использования файла Azure. Если это возможно, даже в будущем, то лучше всего отображение доли файла Azure на его собственной учетной записи хранения.
* В одном регионе Azure существует ограничение в 250 учетных записей на одну подписку.

> [!TIP]
> Имея эту информацию в виду, часто становится необходимым группировать несколько папок верхнего уровня на томах в общий, новый корневой каталог. Затем вы синхронизируете этот новый корневой каталог и все папки, в которые вы сгруппировали, с одной долей файла Azure.                                                    

Этот метод позволяет оставаться в пределах 30 azure файла доля синхронизации предела на сервере.
Эта группировка под общим корнем не влияет на доступ к вашим данным. Ваши ACLs остаются как есть, вам нужно будет только настроить любые пути обмена (например, SMB или NFS акций), которые могут иметься на сервере папки, которые теперь изменены в общий корень. Больше ничего не меняется.

Другим важным аспектом синхронизации файлов Azure и сбалансированной производительности и опыта является понимание факторов масштаба производительности Azure File Sync. Очевидно, что при синхронизации файлов через Интернет, большие файлы занимают больше времени и пропускной способности для синхронизации.

> [!IMPORTANT]
> Наиболее важным вектором шкалы для Azure File Sync является количество элементов (файлов и папок), которые необходимо синхронизировать.

Azure File Sync поддерживает синхронизацию до 100 000 элементов с одной долевой кадостью Azure. Этот предел может быть превышен и только изображает то, что команда Azure File Sync тестирует на регулярной основе.

Лучше всего держать низкое количество элементов в области синхронизации. Этот аспект является важным фактором, который следует учитывать при отображении папок к файлам Azure.

Даже если в вашей ситуации набор папок может логически синхронизироваться с той же долей файла Azure (с использованием нового, общего подхода к корневым папкам сверху), все равно может быть лучше перегруппировать папки таким образом, чтобы они синхронизировались с двумя вместо одной доли файла Azure. Этот подход может быть использован для поддержания сбалансированности количества файлов и папок на одну акцию на сервере.

#### <a name="create-a-mapping-table"></a>Создание таблицы отображения

:::row:::
    :::column:::
        [![](media/storage-files-migration-namespace-mapping/namespace-mapping.png "An example of a mapping table. Download the file below to experience and use the content of this image.")](media/storage-files-migration-namespace-mapping/namespace-mapping-expanded.png#lightbox)
    :::column-end:::
    :::column:::
        Используйте комбинацию предыдущих концепций, чтобы определить, сколько файлов Azure вам нужно, и какие части существующих данных в конечном итоге, в которых Azure файл обмена.
        
        Создайте таблицу, которая записывает ваши мысли, так что вы можете обратиться к нему на следующем шаге. Оставаться организованным важно, так как может быть легко потерять детали плана отображения при одновременном подготовке многих ресурсов Azure. Чтобы помочь вам в создании полного отображения, вы можете скачать файл Microsoft Excel в качестве шаблона.

[//]: # (HTML отображается как единственный способ выполнить добавление вложенной таблицы с двумя столбами с рабочим разбором изображений и текстом/гиперссылкой на той же строке.)

<br>
<table>
    <tr>
        <td>
            <img src="media/storage-files-migration-namespace-mapping/excel.png" alt="Microsoft Excel file icon that helps to set the context for the type of file download for the link next to it.">
        </td>
        <td>
            <a href="https://download.microsoft.com/download/1/8/D/18DC8184-E7E2-45EF-823F-F8A36B9FF240/Azure File Sync - Namespace Mapping.xlsx">Скачать шаблон отображения пространства имен.</a>
        </td>
    </tr>
</table>
    :::column-end:::
:::row-end:::
